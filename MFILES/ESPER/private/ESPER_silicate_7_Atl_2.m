function [Y,Xf,Af] = ESPER_silicate_7_Atl_2(X,~,~)
%ESPER_SILICATE_7_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1810997900708413155;-3.1156041519770627524;0.19729531792511170729;-2.2873347093073888026;-1.8559216169882941649;1.6666260262500713907;0.051802147107597840137;-1.3824121994613394193;-0.12655133494429890439;-1.0501206641988518609;-0.28380975057291590868;1.4053587418866522185;-0.12180769401885263581;0.44444227345651232675;-1.7068862555251671509;-2.9623280981566058045;-1.9601875806859967444;1.0360826255963613285;-2.0320924038415966173;1.6193192241858280767];
IW1_1 = [0.48329505741905504079 -0.38389810543703040135 1.7451373073673537295 -0.65193034727568177633 0.20907575958744734068 -2.3830848490266629547 -1.9277516142129846877;-0.10217551778280219155 0.13180702261729315694 -1.3438326694829119123 0.62602240752139304281 -0.23913925854380527203 -3.0727889459103212566 -0.32197539149149667637;1.2585245394985757894 -0.62731210440562623631 -0.13360723311535238622 -1.2062968657096777569 0.018382508239137246991 3.2173217517096004414 1.1029800112906769094;-0.037134737027841736856 0.5812255973182531843 -0.95693392486362849336 -2.4653911914679196293 -1.2999055132912975541 -0.73113717475090589382 -0.10370755160603453704;0.026354562352790968094 -0.73219767153064052589 1.1519365377232133607 0.45395646434266767599 1.0736203077781218962 0.16744360515277792456 0.4333516892232587292;-0.65910557302821193293 -0.45515915040020554772 -0.14026588671994133506 -0.59272015571070835183 -2.2184654691315150998 -1.3121161915460015646 0.98448799102676964878;-0.12337273428174902468 -0.72686084788212979024 1.9636927923217399883 -1.6887586393051785549 0.51084567580944151288 2.1057735932596575168 -0.19414041249932750821;-0.017362224762818255497 -1.0209957846835286954 -1.1286664123475012023 -0.34752009640651276845 1.2566413114140149165 -1.2372905554556619112 0.64794707349316593703;0.34643675304800591874 0.35738692918904552132 0.31069898289578701256 0.73877497207861264616 -1.5892167125109883941 -1.9911524797886452909 -0.15522557045048784863;0.64706732796551613696 0.17620529263321491054 -0.89178109031444963151 -0.092078104046027856033 2.5671975413856924497 0.27763115058739656904 0.15680677293688624618;1.7073490172397098874 -0.46197042510948188587 2.8266976399107708318 -1.8122504724918777619 0.41341629865681389644 1.602859500020078265 1.9030203075344014341;0.19293002193222544283 -0.33749861939777875408 -0.63186677754369413584 0.91232856334352696592 -0.46993099279452621442 1.9687665956975441972 -1.7933635501396698597;0.041276068416472071199 0.20341500877536658476 -1.9961425859600789856 -1.7725891613732336349 -3.5940750385985626991 -2.7452149580279456842 -1.2455679342406253962;-0.23330612423149851842 0.018985052841441054511 0.013857013240786966377 0.75707381090731196149 -3.1633713380678258886 -1.2564102843279303379 2.2006551824792439653;-0.45396321390379601457 1.1291804624978907245 -0.10699189634318288789 0.79774083767963299696 2.9478927457808028478 0.96874159280299898533 2.4802724134206903805;-0.22746033063344647807 1.1055232167479409622 2.1319878076915119713 -0.57416389872779460823 3.2068999502734594209 0.75896538569541449615 -0.0044044860238644789607;-0.91240847220750098678 -0.89510436935273174353 1.997478774791417333 -0.56495346573824734016 1.0950126838230065385 0.86375522570870599814 2.0318741639546655797;-0.24632911059947842913 0.022181122611159967417 -0.91870491615217353409 1.243172416253133461 0.070583321991065831047 -2.3528330347958554825 0.56656212551315821013;0.055411061968352458285 0.73062462139165851305 -0.58221641656249611962 1.1915661830759631812 2.0057004985702828748 -1.2051395308696977171 0.0077953748472204551292;2.1266360660906347135 0.35112137189308567642 0.020801611435933300975 2.0085494426970758042 3.5494968665838753097 -0.73271016526914611866 -0.79768751888926314741];

% Layer 2
b2 = [-1.9028695717234069829;-1.7569278244003028178;1.6097445177275775396;-0.75250527123990285094;-0.5756696710345404755;-1.227396618249255722;-0.67162632200615723921;0.35778694981287767485;0.31755862831747277975;0.13762949521029954614;0.98587295539021413404;2.4282443701004776671;-1.482287885172046682;-0.70035962197261070195;-0.75769587809358984742;-1.2421850165994410276;1.3395307807739942341;1.4385095467644755107;1.1123658303235020028;-2.2136831538693551025];
LW2_1 = [0.27488676270805839641 -0.26929835877062763272 -0.3926825120853369433 -0.24381991433447081086 0.054296139943715106269 0.4023152487927631471 0.010271541489026139379 0.52853742896892907943 0.99658211333106028196 1.2030715665135829351 -0.55518028522535778357 -0.084319262453973004012 0.39906890441175868478 -1.3596901260343479123 -0.6724111455423050776 1.3887531213241584016 -0.70002323888544293329 -1.1957701620775493812 0.96640652212108901775 0.87081168363683447708;1.7278039446031607795 0.3125234024871006433 -1.2665592345872056512 2.171428670471002853 0.89255253977362125628 0.040422977102602508648 -0.9132368317708748906 3.0098283242989842812 -0.96010914210661724155 -1.0168838840456870809 -1.9305457065517941384 0.71396580662495445768 2.5331454715627819141 2.0018229176528343771 1.0458513790958603451 2.5176737017552226483 1.1097150936074484662 0.35351954375636795991 -0.25656209839975208098 0.33414506210675165576;-0.45763532784058630343 -0.054323440223041932762 -0.52571752345737254863 0.33074450663420279506 -0.03237056523130123209 -0.62761376228058429749 0.34013010681264604917 0.46284028051573145035 -0.20392621727338999804 -0.96946842215609974058 0.20990045555591402282 0.73946845534075489326 -1.1528175527877115858 -0.37112146251066724378 -0.61787687280009828683 -0.59886057810755344288 -0.56096528141587820304 0.48786163046269742649 0.11359745958055794679 0.90797359417935963322;0.38501239732254460835 -0.57649946641716875995 -0.94998588236846992494 1.0694886085373727092 0.14181514822599311509 -0.16383570815881290383 -0.79007456110708629282 1.016770275717191252 1.1119230663067145581 0.81097944713537595263 -0.06988081366853149401 0.65954121595027104252 0.056308455263844890692 0.28655433465281188177 -0.16834568536314378773 0.84143362341419969397 1.126025431549925182 -0.56883414462743275841 -0.2527282784251570491 -0.42832505575912654949;-0.25136134030680418183 -1.9650065641468472677 0.48643261739359572315 0.13868917302315902917 -0.91599344812568739282 -0.95007042606107705573 -0.14905437832539189524 1.1831878492977765394 -0.30783212131000414757 -1.1333569397649869703 -0.13852016919649642879 0.9815043486619392521 -0.0082499120117449330214 0.022983815625535530813 0.87208502705753632167 -0.051248145308980447288 -0.14447287435248817866 -0.052073637195880838335 -0.039592344873586503284 0.4901368465845654665;-0.54589362885279724136 1.0427527061177737089 0.27173722448034398624 -1.0203547179364120812 0.095838893127762808666 -0.97955163114830046123 -0.52011506607716295747 0.70265629352441316691 1.3288485823786602147 -0.94741219778490215475 0.612647853847365087 0.42781810656212060362 0.18713035897313190503 0.13925701820369834616 -1.6445014770950971972 0.65637653242535365372 0.24419642568724464482 0.39520321044588274662 -0.010404265169922891077 -0.45669604580002481908;-0.097814249507605449674 0.19337133561430419615 0.20459415783742054828 -0.047294185431998821134 0.083533096588339059152 -0.98827269213917523505 0.73858651715772760671 -0.69823619821252380646 0.59526215673477955725 -1.6000519833889761401 0.22781638789536179379 0.059852851920329915025 -0.26307944816044515068 -0.17343806906479850016 0.23475690128443499338 -0.58909053414102874324 0.16779939318034847728 -0.33006732710001368547 0.027586661004637726136 -0.50371906251026321577;-0.10383155007259131652 1.0334271735070945653 -0.037591370312005691068 0.21285615907017046977 0.80444175794337258179 -0.28711982705801086802 -0.4824161301288156789 0.41900114922610931512 -0.79138470094427681989 0.050912867549083445917 0.54850290446605554084 -0.95726664159308549884 0.33508212046123014849 -0.72338409843912510055 -0.26340016727932635821 0.18701854152212488147 -0.14844084703908527745 0.046901526895369818893 -0.027240150659803168132 0.91747574976579870931;0.1283099721013431227 -0.42071688972083293168 0.32307151582512366739 0.62703240299729579021 0.35846447964426803034 0.06618047138682453534 -0.43721034135287628608 1.2527029178047703883 -0.4119490763585922366 1.3043309427141065449 0.31614098957695596637 0.35370089787107183987 -0.022009273817949297908 0.95346867695227877082 0.15773292489839729758 1.3483176221268409201 0.32433450254315837613 0.55456520020070965149 -0.25491659928006243918 -0.16739402965802563372;0.69712817766681145493 0.11996363691243902561 1.5396825748206026674 -0.78919176512824051883 -0.58801164087314161666 0.40912523008202478225 -0.57515142738037261516 0.1344011429284906467 -0.72501732262687146324 0.37792455542250774636 0.93574218003842446478 0.44716025950953108836 -1.3174060283140691663 -0.7577036056717065815 0.75143858587770984148 0.18424386869238218445 -0.52726472421966597004 1.8476148510316945384 -0.11669708288665590901 1.0153345884257594101;-1.2831579644348383162 1.1618170478091720543 0.011521905787461251408 0.60832862813806798385 0.23542321290058548788 0.39635728277507503714 0.24750940498819187785 -0.18421916832366438954 0.95844191556231805862 0.035663920964567802363 -0.60030357723261806857 -0.63503509255521273236 1.0381415532756985698 1.5509471631963003269 -1.2291049827485820423 -0.28748058322747704896 0.53773798014865747952 0.092537010242539713412 0.09527396473530089227 -1.109158750758267864;1.50453754694663977 0.37702409585946067283 -0.16117686228211669519 -1.3783172739365026072 0.37542797359781038269 0.23555128831153659963 0.95700227990921094001 0.37726845864145164278 0.090600146941021725278 0.15593865362066036684 -0.76221510643924550443 1.2551807685288303151 0.056731271305387902248 -1.0290712981124758851 0.1628805001058837576 -1.7221650643161372507 0.15962015424120834517 -0.94066337998480265004 0.79734626389165652594 -0.73905481304670017639;-1.6465551737720136583 -0.32101529700276820734 -0.84377258128758314548 0.31231891958280860733 0.77719984479755288564 -1.838134477060777261 0.084142086380538258505 0.38926319560454053503 1.7847799709540388413 2.0796894818921236592 -0.13486250523650911148 -1.7534051900184006723 -0.066091072155017430156 0.016444149209312568932 -0.023995524193692874954 -0.092340983521835048875 -0.034908466564360293716 0.24483696153527878536 -1.1612752561252654981 -1.0839156401381191408;0.83690158755313825978 0.51472722623739131098 -0.58560513345239295635 1.8051430512733761535 -0.56045158008064965838 1.2831056826731666032 -1.0568820121047648453 -0.69525450942894551076 -0.10616838054345469067 1.0971232139456006394 1.4089686412246162917 -0.048910427611275529569 -0.50503376901599206228 -1.7783174584200840407 -0.62805528439504132443 0.12696018934725133986 1.3316528450646110127 -0.1576265927971371994 2.8697444262836580009 1.020743280236871886;0.13846293658076594402 0.68739110792462643218 0.11402768300171210736 0.50580361631599679573 0.53586242573460951544 0.90515189158179121254 0.95448609635451631128 1.0706676631885361228 0.3284156421438231277 -0.45236708471440217894 0.46228309782098370162 1.137865116804433363 0.24415144006691053002 0.66294625324057521176 -0.080553907338112934466 0.62987149714631862629 0.9721386950580864772 0.10121400458566537361 -0.097932194554370466388 0.037696825999697203269;-0.44569885850651075332 0.47170509909990210318 0.9584010319950385659 0.74835390464952633582 0.6014251872404381416 0.35623483934720917565 -1.0606888568791801308 -0.62396553385256969815 -1.1032123673081026816 0.3022299953112451143 0.061213531939856118125 -0.28521126790347384183 0.54710938277600085211 -1.0788979186705980329 0.36911528035605811748 0.037586019885222525516 0.3310986459775169255 -1.4093229170908363468 1.7878540662787041349 -0.46974500264624918788;1.0567018238943091113 -1.1442589416128714497 -1.2447493618978999752 0.36883250769609809971 -0.43577472353972940278 -0.65462829611697093135 -0.11910627411230419181 0.22761723006003573011 0.39021417818520526266 0.35613000134916500405 0.29058721433250289667 0.44205461231504566966 -0.48795212911084784313 -0.98704546470317033879 -0.6198062005093611937 0.054733822531228208674 -0.089413246345546704141 -0.31627265782905783498 -0.26236977185308762994 -0.20909245360168968175;0.093327619184842697253 -1.2117837046035697668 -0.23565604594751654588 0.061868012443632013075 0.10782992572889532612 -0.1337413279226520868 -0.072708019669855711298 -0.43052815101695002253 0.13694144970723987065 0.12062767938975152426 0.012451545208309884594 -0.8094085101783540237 0.11849890883882252535 1.0428618186562879089 -0.16521778069710227332 -0.38813966041106973126 -0.23604184803686648064 -0.19019902015008763319 -0.034866783601313941499 0.35790203790179137;0.48649551993375639292 -0.67232764388153898327 -1.0954265526110706919 -0.61460415489718245308 0.87647596146031059305 0.38670540241247797209 -0.092663715251078332402 -0.038643875858982018601 0.39764217497592557748 -0.4258598988149278064 0.49632574061947992705 0.93092620925003477517 -0.24848327464559563649 -0.88372842538032270188 -0.15819237850341394402 -0.41594352990689542615 -0.24057343834719349673 0.0403012403151348092 0.099583428758455591612 -0.0094309420502785897694;0.054019249088643687962 -1.4938310484515013865 0.1131401633354875147 -0.78474911664869573258 1.0326023857400830064 0.48501032801061871869 -0.83074618511605957671 -0.65218995287596437382 1.189514719117209518 0.46907345032406672081 0.58958924152926495132 -0.75130696098074001288 0.21933427719619058571 0.4077312675484811022 0.644618462659431124 0.67696203216719774698 0.18031128817584046731 0.54270088732196264392 -1.6739862616105833926 0.052096538751510754195];

% Layer 3
b3 = 0.77113717145503679617;
LW3_2 = [-0.075759429532612970748 2.398167589269182276 -0.81794518497628165843 -2.5280091748702173682 -0.39579283812108428942 0.5569487310602023733 -0.22431617596527236858 -0.3044900029772873995 0.17556215831964075424 0.53210852271827646653 0.1763918438279930001 -0.13925137157275233046 0.37430904464935138565 -0.15917225487222891323 0.16546765078144556882 1.4212387630979541608 -0.35336124765009646609 1.2388315423575286811 0.43184071867109180554 -0.24048462957603899959];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
