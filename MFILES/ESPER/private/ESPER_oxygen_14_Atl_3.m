function [Y,Xf,Af] = ESPER_oxygen_14_Atl_3(X,~,~)
%ESPER_OXYGEN_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [8.1155463535360148342;-0.80951998611392461669;1.004585574979538487;-1.0354756550474153443;-1.9785142119421301743;-3.8111145608440701871;3.726926759388597965;7.7892480410601727669;9.824449672842671788;-2.0288861220860656687;-0.9208606711192740546;0.74695961984299563685;-0.80260635578436945181;-5.9742960335991126541;-3.1074427097942525222;1.3039208100120285305;-2.9663307110882120021;1.8971948631030033372;-3.9168044833900599322;-1.9539458990305962338;-3.8746112876652047952;-1.8900376836294563443;1.3218439015681349158;0.67884665743387373471;2.3669164453005184789];
IW1_1 = [-2.6049715630832208646 0.089190726968266131891 1.648732795333056389 -0.67152481042186773497 -9.038061765183195817 -1.9198742263296675326;1.9261047395823511774 -0.87698093444486013848 -1.3268463553412292999 0.089272778779740116772 3.2725452852752510147 1.0706207170660899664;1.7136493923824216434 1.1241442125930480866 -0.71791116319951209235 0.71396541184964701365 -3.1135863182288292528 0.12166462459278737374;-2.0269828779091185744 1.6551592372423777899 -1.2876505675697245135 -0.60581571895385488702 3.5231086601679386661 -0.56473113718183876042;0.04769346967340075405 1.0049053683418378569 -0.9929716564466769535 -2.4698143317160892174 0.6300138510430415284 0.32365028597579831304;-0.065425802128209933906 0.1462988908542593447 0.50274553966456281273 -0.048945808782483189725 5.6957738000314845905 0.63757868740150747122;-1.7069128295997852973 -0.21917106239488096109 -0.54982807423366797384 -0.36128296435431689337 -3.1282663640814436512 -0.45962640296424023267;-1.700807968933627734 0.82313936880234273019 0.46793773716685688191 1.7781275261222131423 -6.720242638023468551 0.43991601983601846815;-1.0012341644015749775 0.91037425662340487609 -5.5235565997567777075 0.13887095898429924201 -4.9993949535098254344 0.13141112607554061853;1.2699772799579143179 -0.33647723656400219117 -0.1226370802787278419 -1.1541646277665364995 1.4849497844176917649 0.4541435811935801703;-2.2577183127854505429 1.9665172224582005978 -1.5164486602307614138 -0.38381281488216334452 3.8442982308324360474 -0.45509641514922716254;0.079832864249442622717 0.25379920927254279173 -0.39495431200120562076 0.0079985577910084634801 -0.47670081261587204935 0.14203623993555009042;0.0059611393410908593976 1.3789852925372581005 0.37290628543387166483 0.37272334414739560771 -1.0301089619961358856 -0.95531526024426738353;3.0962864520724582285 -0.43354671950550427439 -1.417487297248908984 0.51994260394826519178 5.1023321205190708127 1.398988241628497553;0.35296897623526096721 -1.1212992261115093395 1.5333505165352487865 -1.1192138095941046583 1.9767434714517797545 -0.048571273292180701386;-1.4415163621208275657 0.82437463515699893613 0.14687926614837587547 -2.8596989624385518169 -3.1598307285031785874 0.4581964456664348595;-0.0365995240943775349 0.53490067619702663659 -0.55579082146880509629 -2.5240583083874454928 1.5672135859044933337 0.72999711604729833336;-0.28838460442857377641 1.0968889042689233815 -0.97991992230190050339 0.46175368967087571104 0.065693499376378805543 -1.2117056055912542867;-0.1759047533367662508 -1.1040021965871475995 1.5436305345916740972 -0.98175932611129934635 6.2053308995840126272 0.42886832719417061766;-0.16266563398343084068 0.29723152359662574629 -0.4267599364600660472 -0.31291297796468064973 3.5800601688381092913 0.60153984519181868951;0.43361293163860464839 -0.19561975469269127226 1.031638240653347971 3.154149130025937886 9.5577349385867300668 0.49720976756311480171;-0.5733622988142633714 -1.3556926012244872037 -0.81620575335856770938 -0.44331000774653023244 1.2703231045979168634 0.94735533059108034681;0.10000156413820215917 -1.0836292930722075667 1.4459318348416299038 -0.110521154274470082 -4.0177841472681476986 1.2560411917846963092;-0.19293694879156372823 0.68995335765311793796 -0.56841854519348378183 0.0024656750767419292891 -2.3101467812311757832 -0.89484984596506733645;-0.77326577284953046387 -0.69616035925032182519 1.4365027502885070465 -0.39894257489508877512 -5.4981579779647491435 -1.9643899592910742946];

% Layer 2
b2 = [-10.767228217717200067;-3.5681210743639684146;0.50905652949248625383;11.560171841170840068;-5.3990751808373520504;-4.126475138864713621;-6.8818443784254474949;2.9988245883501587485;0.43571397271966871845;8.0506791997443478692;-5.2314435381806037029;-33.072005251415134808;-2.1020109902104744393;-12.879648276424001452;14.305583522128490159];
LW2_1 = [8.2688188137960594304 -7.5122166725463257464 -10.616590093873908174 15.735630770399792411 -18.977356244823411657 11.482538575763276967 -9.0724083192167199741 0.88952273563118400279 12.062799633200611993 15.82127713487123799 -12.687731356156264795 7.1534918936988178828 -16.410371934862617138 8.2845166824122209448 -8.9506099761283692828 1.92039974921209744 22.705654904169868757 9.4653635288183810559 15.462459269604643453 -21.637414095093291166 7.189910378361475729 9.6016153885165262949 1.8597613641718027111 38.709510915938601272 6.5338433454217197394;-3.9049119711527668919 4.0670541423109751733 1.489743649908454648 -5.4144629514027524664 17.845394038742089293 -0.64982016866795522247 0.85828262439525737637 0.34986259640671169002 -15.008416607132971876 -3.1435794965440604365 -1.5895711187390286767 10.315073904221074841 5.4484634531906488419 -3.9218129302357791488 -2.3769804959803870759 4.3488088592364677609 -21.638737648066975083 10.271231895155144898 -3.2823937512996388399 11.079059124931463387 0.61113554648586232432 -1.4102354957686948911 3.0091788172499547294 -15.90923555096487263 1.3247058616314242308;-1.1558133638442869007 -2.5505016945445162513 -2.2396184511763927993 -1.2730296695272838026 -3.6639427480011059757 -6.2254607964584787183 -4.3490736970645169635 -0.67520397818741273444 4.7236890988602944219 3.1859330314476763668 0.1102859058363326733 -7.6116281756131387581 2.34829163168458388 -2.3648019512294187194 -3.9903842321242701807 -0.96329296070582626221 6.0247701966009907792 0.4878626806120003323 -2.9273814856123014927 4.1231084263430091141 0.92364364058502634869 -0.55410650164123720351 2.6622664649409553128 -5.2619776795438077954 2.8496842978402883162;-2.3481231905757229406 -34.833603047664148278 -7.8203139591541717124 7.7050026456720326351 -2.7707289421739287327 9.7160457568978610965 -8.5635303996648861613 4.2826523608332749404 -6.3815495934434114389 4.8070592340615485583 -10.067584071510026433 -14.74593927090987755 -31.005780228410344534 -4.7245033736135209068 -4.7176232175641112931 -2.8617747777197473091 2.839214188701197461 -11.29313685629684727 -6.4992680425708186931 -13.526544188495385868 -6.522782208869385201 4.7219259612137181037 -14.881579851493414779 -6.8104437433049049844 0.90316422126692186279;5.5275186653649219792 1.8202981289951190025 -3.4404869099034116608 -10.70570416789052004 1.1838969560992735897 14.884914185544721121 7.4548387163515599241 0.96639447777106224358 7.6786873445017462814 6.1974549374622176501 12.215800132793967592 2.2597658046113400232 3.8910646260500043603 9.4703653922792589981 3.4820334393709866383 -1.0302718249031919129 -6.2811058119255900323 8.7196596552845342387 -6.9476384624479665675 -11.905251634080448397 -5.9244575755408224182 3.5593639623449591092 2.9327449722577556557 3.6743445924266442404 -3.1448172349965988204;2.0625404358412424699 4.4593940993365741576 0.63844672145131786678 -3.4321400961310790656 0.14153523606370485566 -3.9690597123204245378 1.0408796754722959843 0.11347027579528877472 1.6176516654466137624 -3.1842816054069604803 3.4805585986105738172 1.08405099307489583 4.1037301299076043293 3.2456432342453855888 2.1077286690902026223 0.20190152044225945227 0.71215746150830472327 3.7805745692333361241 3.2885393213741402896 6.1601542624676408622 1.9965306361377672673 -1.1235671128779174399 3.4705540741536213822 0.79063462498241510179 0.55101035876507764577;1.1795920125955021707 8.4805464470927649501 3.2374215428171901898 -10.358413267864918339 -0.76752698860876789055 -2.4750022865660610272 0.3635188710026160952 0.033554132520664470274 1.6439261319127800309 7.5614426400729204403 10.46353388439717591 -21.527269799264459493 2.2656984223514160526 1.7636123209306380222 -3.5881994611098533277 2.7744951572695999431 1.9190555043193444629 18.42882557111756725 4.892270244934519674 -0.55598186695377083133 4.7273577495892107336 4.1327964953740607967 8.4215285324545803292 9.5529363754287217603 1.6391331930242061254;9.2738931182267450026 0.78787730403848166283 0.30073943855713647366 9.8202942004137891985 10.339436977475568114 -0.96429964010736157753 -9.7165527544934331416 -4.229906640879966595 0.49944796664756879734 -3.585056264008559701 -10.171250778852526153 -0.22991506519927579211 1.3424672317807397892 8.5661199640732945682 -1.4699749548729899029 2.8411750734392109408 -15.874078056686647287 6.6801942091456174566 -1.1212775442053586339 6.2079922994063094777 -1.6377062449029449187 8.2862154936085303802 3.9320822003938951106 -5.2940842875126516986 1.8673031121777363683;9.8079381015385767029 -3.7823126592041851346 -1.4750953048360389008 2.0858466057496407586 -8.0645398177821885355 -3.3284417199255744713 -2.5464840225793481387 -0.5233915311325437747 5.4214208704088484581 -1.9186043434704687094 -10.517747298239116915 -15.633527270979348245 1.8820946946922307852 2.366323004858246204 -2.7340573679001787255 -5.72528141638153798 14.65382566744839643 -3.033899166574800077 -3.9520497764306896649 -2.4319870717537179772 -3.5568620734520233206 -5.1396302241823628165 -4.3849545679473207471 -10.236441235366458002 -8.0049159916477528043;-7.4045619310632533328 -0.74175615302330799583 4.2050688517941186007 13.00152225135493822 17.452280389801831717 -8.3464111288221598528 5.7565892753031633333 5.8958513727729542353 6.1301861092412046617 0.53786014189389141915 -10.785556882928409195 -11.206301841048780688 -2.835691309675915317 -8.7009755372975998711 14.075904620995268957 -7.6114607411295578387 7.9917271592821208515 -8.5912238942194250058 -2.4404429397021853987 8.0951293402490254181 7.7202551222825723798 -0.32294827818057258995 9.6809298915880468428 6.045051727421263621 5.4520490654122841789;-7.8784602347145291645 -1.8207392198624039459 -0.61639127039122210139 -4.1815928741309846828 0.48100788283890066888 -1.8485484996324288431 -1.8347934583031111355 0.36381604117822013977 4.2633444753126124027 2.5045706284147821741 3.8645579336871689335 -6.4837992084028659434 -4.8619208331836372139 -9.1018587059658599969 -0.8743097597022602141 -0.083352832857917613651 0.92827183378042432693 -2.6572184740144875192 -0.81542110224622699199 -2.9285922814795708469 1.2564359498921264802 -0.74501270183508350176 -3.1928011641828466516 -0.095827720123575516054 0.34071640144675530149;-0.83859923174777428745 11.481162191685562846 -0.96102935447989334961 -3.3909680662572436738 -6.8934043875590109707 3.2115452161766122607 0.25518696693769710171 8.6305375866291829112 8.579683827651191308 1.2155531914550152806 -2.4987315025652612199 -24.803586245607789351 -12.36842297278037961 -1.8822345448128299239 -11.161570120810420548 4.3057681965343110875 9.9021641455238800233 6.1437770415815196046 1.5244789159344263041 39.343553949000444447 -1.5047971284429693117 -4.9615758693967260129 -5.3552556137696436522 7.4644910605164467299 14.191251540363085226;-0.9157315665579064401 -0.22622000181094875648 0.6823479326870861561 -0.0093930706452354205405 0.71387449544112180355 4.6201222439295142053 1.2404186823834575382 -0.48327175700974345229 -0.37622855264838384048 -0.3123793428118822324 0.6711969265396287021 8.51536068080531372 -3.1295294273937037666 -0.93631217813229372648 1.1023851791912413489 0.20695376654453023768 -1.8341871039532651189 -2.2722916979769567369 0.81634483985982542187 -5.46279469418279362 -0.67282958528770986373 0.7677108096006020066 -2.2120279266530200601 1.2332048590790010145 -0.41118365124803857302;-17.983703392112914798 -2.176400183307200642 19.237105254969844026 7.9326064434638325906 -2.1098465953664815586 6.619081773005620839 16.093245983613044814 3.8808412477352578485 -7.2262526724634330577 11.167585105069630202 0.54109174056119146989 -14.572508430296224446 3.2543302142750434314 -8.0765768666571275958 -0.36740390631730712734 2.478405513147974748 7.780505153299706933 -3.2528803054498047764 4.0340709209413256886 -16.48706793170057594 2.9831703753844380778 -15.160407763531120295 10.807819560409818394 -33.145213657885705061 -1.5623779916671709511;0.28829807052760714203 4.1926704833070163048 10.094662990232540878 27.079764857481531948 -2.5554668513298315347 9.3393632849348708902 12.54085405278647869 1.5622390570345354721 -14.673366790269440685 11.29117905346607742 -23.08636451985746163 -5.6631162784825930245 -5.9771992479444753243 21.392292023342040608 -7.5734185597636010101 -6.1457322441023212178 -27.448143066273434698 21.37208824656036299 12.187097366378791818 38.011843836476494118 -14.727489395396306193 -4.6962232367238998521 14.334261971471537578 13.141633875360854589 -6.6157063785150675983];

% Layer 3
b3 = -0.17207492676048971592;
LW3_2 = [0.045215438876228815357 0.05074271568715709585 -0.14345985819849763065 -0.043563836451225960988 0.041373816111707178989 -0.17076304572569389606 0.078120522840419162613 0.033279177178739606513 -0.013502377307561671746 -0.01180951856031528524 0.1868104751414792486 -0.014239423124448244429 -0.67131836821059442943 -0.017943009375501871999 -0.047671629455813831211];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
