function [Y,Xf,Af] = ESPER_silicate_15_Atl_3(X,~,~)
%ESPER_SILICATE_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.1132053749541679366;-0.12255702438249901909;2.3577200119220975694;-3.5439075345626811497;-2.1949831557411645377;-3.1569824875615037918;-6.5913989144802620501;0.26315514463779171583;0.018933856295103503042;-1.2070614238520651629;2.3273921986164052278;-4.0771523544082013402;-6.1565061191808236885;5.0882870804921083163;-2.5954672666224545274;-2.0032567801954468401;-2.098776290595288252;-0.90213074743838939096;0.26479585380497672187;-2.1250244922152110583;3.2595941133106496324;2.9266570284922841516;1.9795370315327045496;-4.103691613478894773;-9.291685045036764734];
IW1_1 = [-2.2432198404116814316 0.39572423977929738204 0.24997607127323379084 -1.929112996172250627 -2.7280399826319707834 0.75203518066597008218;3.978253002550582007 -1.4284300763122437239 2.0662718662353611876 1.0455242304723073588 -5.1907833472043902745 0.51588539619035800321;1.9396553226747692555 -0.55993713348868945356 -0.44982539518053338279 -0.91556070971502601097 -1.9356538494831614372 4.4174961139886841366;-0.77312465718657041869 0.11800572605302454832 0.51799134716465300432 -0.22260014696834060088 4.3656294874563981168 -4.935624881509367512;-0.34740344582376647686 -0.26715195053846019224 -0.3020896957282048767 0.99862628672747799641 3.1727428245097488713 -3.2693966321045939694;1.6938798510358210603 2.4207647999361916469 3.0836662905619629527 0.63142724372406555666 2.0451990336340917231 1.3061293511440126291;1.5499074885512671429 0.44562915695862648224 -4.1247251149423860284 0.32381386247266352729 12.693290221647689719 -0.70796077686994296485;1.6227126284469737261 3.5623660910914618505 -0.14952112385299004549 0.89339479357961704142 -4.2009542568793056816 4.2567255855130223807;-0.88751694791170054888 0.82561299245218533471 2.3810996802701707153 0.76938467203475779943 -0.32973787810259025388 0.52014143432094983588;-0.036203577171826629988 0.18693866210785425874 0.42623015075061232437 0.79717426582923411882 2.691258613675843403 1.5790783337678246934;0.44647045179630506784 -2.7958573063301428441 -3.2849396431623651971 -0.62985583754884999497 -4.1873533829184612642 -1.6379298193050642052;0.050392223975444135065 0.17212234078645577418 0.72597633038103415171 0.15066305395390261479 5.7779312110506495515 1.5136846048164249723;1.5251973103446418989 0.54230692192182305966 -0.45737660884337255629 -0.22214714023701498391 8.131941650201717664 1.4184447074931041399;0.17811961087611663523 0.53950464934363695502 -3.0451276267245224183 0.98289021924682695719 -5.5879909684659541114 -1.0023633608782576143;-0.32136145165621143871 0.70126402617380712012 0.467115404049589511 -2.1902926474115709254 1.0869768523716778486 2.6784604281874182519;-0.37682930661214647516 -0.51809910745156928513 0.55044136176289770734 0.90955427836272806363 2.9397926992795366807 -0.81260555252853616803;0.82588278744510912333 0.1985573009531584332 5.0851082003137397791 -4.0677008385122954692 5.1467040073640220044 -1.3325300861567599409;-0.59476903576058837153 0.66542548328935280377 -0.15054782903023369856 -1.0808107466673331221 3.8140217426492522002 -0.45707416389962357561;-0.62699607174152294231 -0.33343445234941276878 1.0588847924634374742 2.1345534556512077984 -0.016899216151249854545 0.44587485271147536681;4.816452230588343042 1.231138024254432306 -1.2829016492790965565 0.4109432870561056661 -6.0471788428641666258 -0.12072920718718953281;-0.54243970053556855859 0.43060038904370323554 -1.01911316704048871 2.4686252444742402545 -3.0745141677120781942 0.80162194111551587916;6.8337022319079254729 -5.6872458136698833542 8.3488902007229697233 1.086763608834683259 -0.06462746105099323457 -2.775987390398413357;-0.48663917701841957753 1.4916245912263716988 2.2896000043197135554 1.0571073394959198399 -5.9468794315413360252 -2.630732691563375969;-0.44390442099858101743 2.2662932742176122858 0.30716610775662117616 1.134468693953902374 -1.9910190986073459385 0.52076506352159990243;0.097960258073888167862 -0.38827352969653688985 -0.30646694567799687148 1.2158652415217205967 12.275780196359518115 -1.6923519486949702983];

% Layer 2
b2 = [-0.60982048696810453592;-2.1978481303051071727;-0.34880069626185977727;-1.1861050258000449542;4.1456438194628626448;-2.4940698402144794166;4.8167536142970872604;1.4080057763340501076;-1.4531772990235896081;0.27893765092438654873;-0.33011528364990549989;0.41333092225334672198;3.0616738033393153806;-6.9152036220801882394;2.2259113157666590155];
LW2_1 = [-7.6203962705460286386 6.1658889803975558408 -2.1411974045679085243 -1.5396283558019849824 0.71835565536006518172 1.8480537924364803803 1.9353552639165088056 -1.4749840612404128137 4.6416090345051790322 2.3235082600636736139 2.068341781510002253 3.2577536596313731998 -5.8388279634507496141 3.9345295898003698198 -3.2783536399006214523 -6.5322876388517832069 2.8557312357942903347 12.595783424600620393 -0.32040504809368147709 -1.2979616115630205897 -3.4943337767780864311 -5.9457031691578121624 -3.6796414909636299129 1.784980427204048592 -0.82374516088410898451;-3.8156775845666452973 -1.434356032100707834 -0.64897706493683782192 2.8134955598617121808 -3.5806840592356339315 4.5322940971273455446 -0.33231031917285813737 0.60794558700683620778 -3.3722624743160984906 5.2934754223302871168 5.6109786405949568788 -3.2381668201355133796 -2.8315292391952739948 -1.3113999989895077647 -0.60115265902261938447 -3.9092609687344119784 -0.65171181301447644874 -1.5391975193548386169 1.7501973017895438023 -5.7761717180143330452 1.9752744877321113393 -2.5349840777287813154 -2.1470173335394506786 1.062779042840462207 2.7864218899034480792;0.90494956689451866438 -1.1113136194511916699 0.43347960983657746192 -1.3450569866888817394 3.1054481873526382785 1.5898160053176841888 -2.2271569256392700353 -0.96850012636324911419 6.8349057726012976133 0.99228280333919149925 1.5235608689968069829 3.27939716802708503 2.2531891462189008735 2.0904815088693604608 -3.6146674552654332047 0.84035590734062060037 -0.78124252150985840082 4.2535699063513101592 0.88660861660319512101 -0.6025579706727960394 -1.70344691881263266 0.011923999450674217793 -3.0909213377729591876 0.96133994502672315274 -1.4864344876081354574;-2.1355018453485929975 0.74151267494568440242 2.166671617845168818 -0.35562461506657055965 1.5295067402115569699 1.2430212417341672815 -0.44149620228353014806 0.55413609243912953506 2.1749357020678123931 -1.2179530123159145738 1.9900106202849046078 -1.4344961774539215504 1.0775262250680770482 0.36299155354393108919 1.6254360406943300088 0.205337630461214532 0.55292163643377578719 3.4206020721783585437 0.52157933193628036594 -2.3364868683560855445 -0.39300408887365972932 1.5678688405285843288 1.7637393708191366759 2.1421976396771866824 -1.4859567687421975091;-2.1445331242881446876 -1.666902946260662377 5.1463625031192288262 2.8658043636309971092 -1.9244207188279660592 0.73159051268891150954 -1.4883533623685645253 -1.1228836092322942442 -0.64398626978814721422 -7.7066705932527854728 0.45747523658281435965 10.251469193384719958 -0.54302412935146227024 2.1182593102791265061 -0.83643011949599421762 7.2861351854901190706 0.63747790455761355055 4.628424940881425087 -3.8365452976166465326 3.0062315817629530201 0.57818668745141121867 1.0226737729395811716 3.1840816288182778315 -2.1421740120576151512 4.3022835403092205553;0.20952739140617776537 0.79698004442206737963 2.6220549497124716609 2.3948621264182095025 -0.78148936052414263997 -3.0987919834058144097 -1.0629764267611960804 -0.64786709643396112046 -1.9686721115061742715 1.7280600999562154563 -3.4917413034529243276 3.5265322809536834292 -2.6631154390697555634 3.1097781679044982361 -0.030168267304786559185 4.1011038660899661323 0.56932153048779032822 0.15483859497666641047 -2.0403613473334192285 -1.5573529194645232554 1.0959246076909290313 -1.6889240407076999695 2.0227588710344135414 3.6808632161262120341 -1.4432435126337748166;3.5498122415321109457 1.3229034421658469878 -1.0258846907105059199 0.030400335422718704342 3.6683373435681425612 -5.5107952487001226061 0.39870131188968827018 -1.3292105757018128909 4.6408641080682784263 0.75423545184457452262 0.23463637717372767821 9.448276751227041359 -1.0589896117259516295 -1.072860695012769483 -6.3725622037017259913 -12.079907056028877932 1.13407539812443936 -6.6735302554565363309 1.4048435995426169498 9.1500899819841059468 -1.4349216952817098747 0.38404552905706823562 -1.2761852816463554738 -4.1138186081293000029 2.1302784888746399972;-2.8048949013516040196 2.8625710284750827128 -3.900582506418528439 2.4500027274190898652 4.4089527502873933074 -0.63098592118511587223 4.4103256076127621554 -6.4134821869085900659 3.1568398068257561562 9.1589678365942681637 2.9669869114707787539 -4.8223315200637983935 -3.8257738262886054059 4.3807630846345491094 2.6343259785113470883 -0.76640849715462955327 2.6323993720883955838 1.6176466887280998019 -6.3694809387703728021 -4.2395761152943869376 -0.60176285434365450744 -4.3596942437004297943 -2.1581030258104569874 -2.4328290875139839677 5.1098052706378247478;4.1377757940682879934 -0.5726290798314921382 -0.63045743556408717634 -0.29171164265403182192 0.64096802180823664319 -0.45598381466266307838 0.05704489301681842095 -1.8303664450154801813 -3.4883421021907179416 0.70884297562501918932 -1.4129629896734037242 3.1565713754892317233 -0.27732792616871981828 -0.46715875549130331246 -2.6177917413977800365 -0.72703739261360933455 -0.66273033004177361871 -4.9066694056910611366 0.73914911645100245252 6.0441122764016412816 -0.028521242570671370004 1.8165466831645087353 -4.8941848088427279961 1.7759231867475049338 0.63942419782424164687;4.9155081980137262931 2.0783010318202492783 1.1221712275904494049 -1.2630724909277686319 2.301499530279710104 -0.053945846243441425427 -0.78776319867411725983 0.079491025327417613733 -0.44411288853221769779 6.3579993809267492111 -0.55294457598006041543 -8.0506601118573435372 1.4949056077907221241 -4.3372356058535137535 -0.12577584563900487402 -1.0414635831183172154 1.0192992411219710114 -1.5903381448146103327 -0.16243754953249114892 1.8011587895734755271 2.8881367162916364855 1.1446262067299599607 0.071998007720352197314 1.1039282473681413244 1.1189360255901670271;-3.1547842231202536389 -1.7227005884137087666 0.84343851177348339032 0.030707251773611585893 0.25327528897091189375 -1.4213236087666443197 -0.3145416499044300096 0.50886912067238854185 2.5883992193659284275 3.4259434248916087462 -1.0042417639144383124 -3.7446040049527931082 1.3981292610425857248 0.21171641762411710919 -1.1024169340043692422 -0.56058724837569029464 -5.5441991678366555618 2.103593581170618787 -4.7493827804177612961 -0.356453185275331208 3.7827352532964875209 1.2061434665276753453 -4.6833425019580667836 1.074707061923593665 -0.66054885598804558011;-0.13692854155027553431 0.59480270414699010217 -1.107523504868940023 0.051112138099577771044 -0.52568284330034897867 0.023358177269337906945 0.96332670048198210111 -0.27669456970985256694 0.5535859397289614181 2.1100677830881542363 0.43057516513760024646 -1.227260927488367237 -1.2142079492248236683 -0.2986234446357921013 -0.11916995871827715248 -2.6366173699060651003 1.5090211543356455426 0.37183819213070501419 2.5650820289650955175 2.9972670213497369929 -1.3246683211758836229 0.68730060953950522507 0.263241017338341321 -1.2843936425779232113 0.92928564986994255381;-3.8031744784239607249 0.80442619040157381516 -0.18194152434037116906 -0.67753564625945950084 0.43431184869303118834 0.024522957196622705706 0.13810708471597124558 -0.83512900741419160422 1.585572527687481692 -0.17698620533173153868 2.6609840265460982245 0.059615745060016975265 1.0317533346634439884 0.56053636842328957712 0.47720036253259479064 -0.2591535775621940374 1.4985046721279731141 -0.45745680838611979535 0.35240387590915223104 -2.6952004912397380387 -0.3017283586193782452 0.054890860524609043358 -0.12854468334668101015 -1.8523799957960709328 2.673024783940049609;0.1904649921783166111 0.12426001077326347122 -3.3660233134016750434 -4.3236464628652067077 2.7743927333503095589 -0.65012467748941971113 0.063295310801288653946 0.1860862826816056248 0.080432915029567245147 3.0169112257343311256 -0.78072912944963379633 -2.1941539259862903322 0.0091255471799511142517 0.19204503460205235577 -0.23322130042450039955 -0.29736318116616522467 -0.085822397161769620189 -3.1566954494581311863 -0.15469431430431107577 -0.1626452823283673077 -0.39306571533805700902 -0.35366643814839732185 -10.065961979269395954 6.0709619637500367162 -5.1035094596795946842;-3.4693867149407062733 0.69606765138493154055 0.19143696727833126037 -0.75604028655833799277 -0.12679722576439406145 -0.44110263287910000951 -0.0073535991528765947897 -0.83201715472456538869 2.04794442341324201 0.32195665316287069846 2.5795261146928072371 -0.92966777263479072335 1.5630231321750456264 -0.046500619779707437484 -0.3654787801775489231 -0.83946789574533275946 -0.96361223800675066542 2.8799342990743492798 -0.20973035927700495185 -2.6440345498444433048 0.16653153294046030286 0.82227283500318837373 -0.14761646937507674759 -1.0968707228786691577 4.8075427726562143249];

% Layer 3
b3 = 0.026658260797958528709;
LW3_2 = [-0.014060417863041007117 0.031896916979486371335 0.044122995338205191207 -0.12099278477830897882 -0.088282414670041428617 -0.17073779161883875788 0.048632052680042427151 -0.020359234081939143329 -0.086742758088959981411 0.038265390334025595198 0.058518680426081048918 0.075727808659564660454 0.46599086769805525554 1.0446416540523342231 -0.4467484525658719785];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
