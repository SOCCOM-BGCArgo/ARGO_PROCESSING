function [Y,Xf,Af] = ESPER_talk_13_Other_1(X,~,~)
%ESPER_TALK_13_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_13_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.5497236859580346;3.7080506268192619;-5.6371099247191969;-2.6103936546437141;-3.0136797971153588;-0.4044129157384827;50.842924253948446;2.6417109364156341;-1.4093063889073838;-8.8816565299320818;1.7150410582872579;-0.092070103806669024;2.6498166217613415;-1.8931520859263751;-10.566259839343951;-3.1135722871085005;2.2556191038464046;-1.2303418395322128;5.7348059688766559;-2.6211057821437138;0.20794186607149714;0.56699257363500966;-0.64790361730086321;-1.3533243914159092;-0.90579189115672087;-0.57551376348641692;-0.36035591867211286;-6.888473827479503;-0.68278919556808215;1.8324520559401536;0.3426061353792984;-2.501637496850464;-1.8144514795927478;-4.1635666140850418;-0.021121707084495692;7.6370748131961337;-5.3652275678504511;-2.0733113036474236;-1.9411845870080753;0.61116204340332836];
IW1_1 = [-3.900366228627119 -0.18084353887251758 4.5336794408087631 -5.7759886140209584 -21.648734078571856 6.6871195610485819 -3.8101562807024743;0.96018836028485877 -1.0835061602184846 -3.5858069137928976 1.7567576198407533 -0.99342292312133407 0.044910245594654938 2.1666761763995779;-0.56784275978802357 0.57633888140109946 3.226219900064009 -0.6829765733200398 11.722539659060354 2.9873608492977888 0.10396440648365997;0.22526155984272445 0.072245671065804304 -2.1205924506530938 -0.31036792146741721 0.18980383894726024 0.66253528769506498 -0.1461772177757879;-0.33813154761104863 0.27825499401482201 0.63878107018911512 -4.8481463325378842 -0.61232995440412863 -1.6066870683985737 0.29440733405331798;-0.022399725853053911 0.04003772936209455 -0.53877333419841678 0.48063172733833237 -0.11301028751414791 -0.4250297578033575 -0.42754991679788207;9.2378295997524713 1.4519862041477385 15.517901466992912 56.993571497060884 -0.41349275984211836 -14.414952823058464 10.97417848466854;-1.9315181720565076 -1.1729933967981596 5.9134871824683479 -3.8652449168558656 -8.8521189986165307 -5.7542216751375284 6.2245984762129467;0.3314577424349518 -0.34012701865830142 1.6084632240149908 -0.885693171468806 -0.64934893208431022 0.10007907579010526 0.22113693643454149;4.1492562399639503 6.2356102892664609 0.20913581227429318 -11.933638146984785 -11.880427601528528 7.8374251474950665 -12.290400759014698;0.1473968244692643 0.069371400404508302 0.58070448746046965 0.1239459197870539 0.36046490756926558 -0.42356777881071472 -0.16897716735023968;-0.031766434928002282 0.11673498542059495 -1.9636195658503921 1.8496613462839606 1.8490520243563564 0.12187299152811838 -0.0067767303292322195;-0.28610982115538819 -0.14118396697035779 2.138342576494217 0.17122621506578542 -0.064832062526226544 -0.66788063414691212 0.084317458051508476;-0.25660191438064905 1.0569471513104676 0.074516425043936102 -2.3730373655067849 -1.1547855489859562 -0.30391155764287564 0.030404014368134419;2.8278796451789447 4.5138337854322197 -4.5590446974916254 10.992880151602082 55.196007604932014 1.5279432607996282 -3.3883465849494039;-0.92393328919636331 0.6276999402436253 1.3937144707844553 -1.2664734496774441 0.78133022398044294 0.15196083215228975 0.00083880141767540741;0.10986298745254013 0.059256928171715614 0.090702108464849676 1.7313070706659495 0.38844978342215014 0.016277440751292525 2.004048486998788;1.1169588678169839 1.5549251115191134 1.8989600665353179 0.55595743968252986 -3.096288125226458 1.4188484310332488 -0.5593646135807846;6.4985002606166287 -9.2353333750483575 -1.9002593430501364 0.84851050653864013 -6.1457321263155675 3.2111630287692003 0.86711876313724412;2.0808619458877735 2.5523984666159394 -9.0135042504783023 -0.16549026875214268 -11.198012830349811 0.10540103101979849 -1.6304110000901133;0.039818779891612477 -0.093158511689035689 0.19789767034706543 -0.24385136444225067 0.31214169963768285 -0.012989371208948488 0.09852883597101203;0.77433631279887505 -0.22866301722640686 -0.79038130905643889 -1.5695694311512631 2.792269685325838 -0.30949088705577887 -0.15324060096336706;2.1860606434854435 -2.8279281980854232 -0.28005841380830626 0.19782057264970979 -6.8178710062934345 -0.059603025247194158 0.29291504267709778;-0.57093818494628401 0.37548099971468663 2.4166941950724592 0.098383590710100402 -3.1222172607780987 -0.56642127420856592 -0.056346443227015403;-0.098865908408525133 -0.56038089622429188 -1.1945243481871466 0.12276893163160146 0.97368295293244833 -0.44649590099295666 0.23935882380569806;0.076514654245066829 0.016474757851488289 0.30919737953644971 0.85125969293122727 2.2228330880077292 0.67711551008524917 0.60911626542600183;-0.36684482333817175 -1.1518260436609404 -1.6136333439724646 -0.20141127282329191 4.0755838862741225 -0.5456038933428321 -0.15998523013287222;-10.333798574793496 1.4990501147140953 5.527349592869446 3.3763883632678393 -8.3768482004355835 -2.774598061812025 1.5025962233016059;-0.00075446610619964746 0.028830562988393212 -0.48770180048224682 0.43000919575456409 0.15965535299931882 -0.55103712956751816 -0.53712073882098021;-0.39497117113452201 0.14562361141637228 1.5136739451734453 2.285579590172774 -2.2573285518170625 -1.7633144705586929 0.26145340841761938;-1.6316817822973508 -1.2433249128590436 -0.68415394417373254 -0.11355079977614578 -3.8156640052443942 -1.3566894818314301 0.58683484958639143;-1.1842017872582056 0.30996650234133588 0.2952006642353705 2.3218391122940107 2.848602877991619 -1.4937958318185085 2.721824453501132;-2.6421915081034397 0.50681459159817255 -1.2106288330183341 0.76457548985361412 -2.9223144600804978 -2.4217439263026055 0.6362276606349222;-7.4838059968007151 1.1777437808893327 2.343699411976647 4.9466325488371217 0.45884872794320819 0.18666683960291375 0.28444944996721166;0.082597749901732229 0.13064883612329983 2.5511310654586263 -0.77736848843310224 -0.0054843827581518524 -0.93810662787857113 -1.7238108060027335;7.2027894962622456 1.0499690955634162 18.434794606044417 5.1091147561165657 8.6759143062740254 6.7741282063614108 -2.0741550540695179;0.1060255034944244 -1.8574892410229784 -3.0852106999779658 -2.9473413474751431 1.1460646513599551 -2.4378628766201893 1.6518647726477951;-0.054008425252988899 1.2628860858422746 0.049491358687595376 -2.0068403224606275 0.36453039070373933 -0.36181401225011206 0.49014177540192289;-1.0162578115713419 1.5949227624144933 1.2386867046323597 -0.62064626573520731 0.11350234833144443 0.16558621764772469 -0.75264779451316344;-0.063642809206998788 -0.0082687564814880286 0.78649045545013274 0.64633000123644901 -0.26543017239452138 1.0274555391048787 0.53192001264412825];

% Layer 2
b2 = -1.4286738789850233;
LW2_1 = [-0.007658578153446104 -0.11065569722027818 -0.063596465592266727 5.0299559996389718 -0.092621384812688889 -10.105084752279963 0.0045699110085752814 0.026779631826339419 0.59470696172519821 0.0088080519535542554 5.5749639353070277 -0.26904157466984663 4.78327005334463 0.20799622295084769 -0.0074033449258948938 0.3756646115823552 0.22758909117235476 -0.15442150210627373 0.012887495239485122 -0.028577799634944806 -9.3580113679597101 0.64154342180443413 -0.044623052760572025 -0.20674461615811715 0.85279083133216393 0.92433632038863367 0.12781845283949755 0.01395554144833068 7.5686850422808405 -0.13520234892262634 0.08235518061587796 0.23482740890281698 -0.087719009350126512 0.016341901005030812 0.094304338215301028 -0.0080908560996757421 -0.05427608276346646 -0.22035676206052449 -0.13480421574068885 -0.4945528183159818];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
