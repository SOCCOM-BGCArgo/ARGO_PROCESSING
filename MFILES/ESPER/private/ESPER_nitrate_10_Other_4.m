function [Y,Xf,Af] = ESPER_nitrate_10_Other_4(X,~,~)
%ESPER_NITRATE_10_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_10_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5026765764403968717;-7.3377797122496497551;1.1173331280827147882;-0.60991196293277916141;4.3206507937130735897;0.81628994882140970546;2.0479655952459259183;-1.5182852078721940092;-9.0542809756466127169;7.3081351607696625194;1.3292893397412244294;0.57061993519774079076;0.80989151006856441306;-4.8091723295666426452;-1.3047784260610109097;-0.51661736308906869297;0.63936930479778963932;1.1367219309320699683;-0.06925472190615369894;1.2961415732805146028;0.24187631842978093988;0.92994265522197472329;4.6597128421830689149;-1.5395965246266190007;-2.0049984365518338514;-1.3454510577602099008;-0.84397800510872034163;-1.4684661057572494514;-2.817904373617512892;-2.6950105914276494268];
IW1_1 = [0.35275758859990352656 -0.15177943371676191897 -2.0938674341856788885 -0.6284633948618002508 -4.7597425742087802192 -2.7579312058823863829 -4.3388935049851209413;0.32346133273293470323 -0.4170256114870072861 0.15397330252146559926 -4.1800973125017826248 2.4180578411508304448 2.1847287049849977159 -2.948641976476308546;-0.16895055097009339939 0.2371544015505814007 -0.16397701490934774027 0.55654995788518923927 0.33909614107961932872 0.41062646211688730302 0.72762154290292191394;0.55321124283171674296 -0.35476104266242047824 1.8629948769298856348 0.1774345564877931325 -0.76380480737179823336 0.12924611910995648101 0.47371630803849534841;-0.34150692037056018524 0.66833163766003811368 2.5705067867868187648 -0.050837287445643815353 4.9722504638013642619 -0.56698873973843399998 0.80607791474949419541;0.13792031449737618409 -0.11113601878650911092 1.1226524114860620962 0.074252987644247120391 3.1789626480254442598 -0.7510751467438370188 -0.20619271451467752199;-0.41913291251367718049 0.4254124895697455333 3.2604781225732728522 -0.86539617208207675336 7.3954264719250506488 -2.123324749236887854 -0.5993478560618059614;-0.26136316976646550847 0.23422826115525594015 1.0782383068801686399 -0.21471883333906546798 -0.62696768846652450868 1.0291170001877740781 -0.77240837302456388791;-0.098839375601264753413 -0.0049029687317228469803 -0.17850481186714006743 -7.148295742642899242 0.18899665957828098994 -1.2426183490595497094 -0.62476887417582482875;-0.3458436660554675135 0.36670995936423494976 0.46086554115004546572 4.4280545154434873822 -3.2847869936059694851 -2.1990895735587385751 2.4541054639028860862;0.34922324530574500034 -0.33235115122696562429 0.054763435061130356918 -0.049744013853708697603 1.8398751185562467469 0.9379072551762687171 0.3224168845096964664;-0.056689608950483465211 0.22926537064578617064 -0.79482937813716214581 0.24586658013151077573 -0.036876318428607883504 0.032205402989908635258 0.6821782873710612316;0.27329685944718246082 0.054214119090948725832 -0.090084394912677070999 0.51174142389173848944 -0.77431971391089082779 0.14017389460214563224 0.85405914054325637874;-3.0636421390276549204 -0.8458734925396262927 -6.3805529616696041728 0.10609498914560501481 -3.866613999279866043 -1.0289616172217705969 3.6144347715342668437;-0.098982124987123595861 -0.055277303969525098948 1.0445954457172899055 -0.081869028883156891307 1.8693739718565245411 1.4213768422799162305 -0.076389626569205226758;0.57887280628920867454 -0.30167119156828198223 1.5221880845518456216 0.020856845893376357859 0.022569230918618031489 1.2542766785613677083 -0.21051510500866338349;-0.55860374220784902999 -0.37704017483176466285 -2.5475498487169079276 -0.10657996471199333854 2.5453909784466630661 1.2137682257472188763 0.71228661243365298805;0.034534899281457677456 0.13477344968844010009 -1.9444388874145837054 0.32644085524314209179 0.017571429704924021453 0.018669648005889865477 1.3682329054926838374;-0.14917892990887607341 0.46701321127198408556 1.4804604478270351198 0.026424304505120083802 0.50350393505924551096 -0.15824223295140524281 -0.1353757766984362565;0.16811681734145059175 0.040584134616761982639 -1.5707547036449114319 -0.0099881003189462545799 -3.0909762146467945065 -1.1891345988868988748 -0.18550408802763060367;0.53500422756014465175 0.10683766720907822423 -1.2797825367394890517 -0.33548424908270763067 -1.1485168773730474179 1.9417014592420631658 -1.6728127395065484073;0.25799152368572975114 -0.23732574474767750838 -0.51512656578290727527 0.15858017224832215986 -0.30689873005774659376 -0.21575332084396733889 0.61888099957577480392;1.8145745055559898695 1.0620792307079969241 3.7151048738847567421 0.48183630606864419343 -1.4499940359269751777 -0.07871784210373444779 1.8248917341016224203;0.031331583882809134478 -0.14646328846209424879 -0.21690021159659986227 -0.39814661373530363386 -0.19786507488801471921 -1.1222467481341278361 -0.59824159243381691553;0.33641824946772858063 -0.30695795170596368306 -3.9236074797482105581 0.7598789344818553948 -2.0686331870949947742 1.5538751186973536189 0.97516959974725592186;-1.8727569984945728887 0.57986742566383431274 1.8248794122779397053 -0.13523036141102365293 0.11341007487301429935 -1.1007165033520194264 -1.3816138249409675165;-1.398566494748529232 -1.0953389231198671361 -3.0957771473125790251 -0.52156334982755703233 2.1722154412493952513 -0.78600547035822820874 1.9648478042899004681;-0.94120572480429076645 -1.4121984238152758273 2.0465716251119077107 0.12381509271405917449 1.1943924049368446205 -0.44772348666122480099 -3.0849864126218271565;-1.0325312978423779597 -0.34248741555799477876 -2.170513430102547936 -0.5154320933750039524 0.78876603965718228295 0.59483303511260698926 -1.0025724964429680863;0.12120097599624028717 -0.055860753154149900279 1.3656167236336835824 0.60226570568460480182 1.5042546943272181448 -0.62223329189813536555 -2.373811625419738558];

% Layer 2
b2 = [-0.73070962631917479868;-0.41270153349113020136;3.2704333210551532751;3.9355592570864703639;-9.1098676126613149506;4.5515613397777263671;-10.858787232219661689;-0.90608772643493640242;-2.4397770857971852188;1.1698282347605035714];
LW2_1 = [-0.071730112086782982228 2.9128163168557765772 1.1860736812461185608 -0.13055165697137802172 0.40237196443678685531 0.084043924991990898166 -0.50861688530151472065 1.0156907345852839164 -0.16299869229415048233 2.5300980348846988655 -0.21866918112446309674 1.5150655673917932109 -1.2035021237201757316 0.026245535205621436936 -2.5011078330751805865 0.1562365024880276454 0.38218793810893053609 -1.7816893219345448784 0.016062707711457898524 -1.81919663905337603 0.27452557938302757368 2.2943853462221897033 0.33314020428428686715 0.7257455774096097656 -0.56669824805796120692 -0.21531360702570639942 0.047526737108244315744 -0.11207297881267057338 0.23137533328145551415 0.63877811561125930062;-0.016047045868157600729 2.0856921688330616327 -2.5452698025664068915 1.2605128635726419173 1.3094180489031832515 0.55509987693570983502 0.036660370863481145376 -1.8499073696119547883 0.7597910448856635135 1.8468672246016824001 1.5983381840122121709 3.3022355790784354568 0.54399309220993175007 0.30290796437903166893 1.7019539471339619752 -0.50564399412996241523 0.13481769359287781862 -1.4170036101919738503 -1.7702980334611271296 0.81802377669738279842 -0.14730386174003490263 -6.2094826237464033625 -0.79596148175129011193 -0.0038124872068919170472 -0.016727587671518780177 0.11801089356537218522 0.64827484600323037611 -0.078542730319057285637 -1.7470670998118476014 -2.5282611026552119782;-0.190594807281495221 -5.5850589195016109301 4.4102754264818893049 0.58597737663508053796 -2.5413190952590891669 2.1829405477109320444 -1.3881888304951695012 0.38846988381733715823 -0.82336770093366862255 -3.491131834042398463 -3.4426598535816257396 2.9569756083601217433 -6.5051578448353524209 0.10072914143199251935 -2.5516147616580404645 1.3604906513312680083 -0.19808616696753053588 -3.9793772440762489317 -3.5676766316149888247 -8.1466958740003807549 0.35635175159209253604 8.4440978964429529441 -0.97847874608909446437 -4.1374511401806790545 -2.8837486043310485151 -0.46113476849693335602 0.052294467732113124325 -0.29190573765838223608 -1.8961591347755990533 3.1079573804237234924;-0.22020897266590405694 4.6283250447029367081 -1.4802892861074468112 6.5545493621022048458 -3.0029993033235351518 2.343546259729502701 1.8986421939931001912 -0.75745531545182498423 2.0956129673535670577 2.4555932394193695778 1.1351217484307161154 11.718878393865843179 1.2064025873160419966 0.047165246329247942358 2.2276461437574122115 -3.6552485215410217556 0.4493910534723418726 -9.7807680751250121176 -5.9025268578994145585 4.6034985349201571481 0.56474815988816917667 -4.3289666269663875653 0.65471461277671905155 -0.2371382653577505939 -0.84353257840512918531 -0.17057643057253307761 0.032966259324196174607 -0.76348082767301583829 0.1393436567246351121 0.56400101149728132377;-0.47678952033781379916 3.7391643063688895232 1.8772392610288435311 -0.55581820429803630024 1.4949453205691687341 -0.9150450449216277482 -0.74573319253239900295 -4.448011844143805682 -3.561645135980056498 1.9124629531175323383 2.5794385164820683443 0.35398435475709533193 -2.5452500381500557936 -1.1008949984555664869 0.2129387726800406333 0.087808304006879972503 -1.1532056767537979258 1.1009650083839137569 0.005647433068889306032 -2.531093946109272963 0.00056369684240472001449 -3.4724676459946364204 0.14371130093938186412 1.354272701489351638 -0.1884253828039067491 -0.74911143751064113161 -0.21665004997758896543 -0.83148942897530675467 1.0911867904865149015 -3.3053096444615799321;-0.93472511174343864138 -5.8745709293812948815 -5.1915463426095254107 0.70193159717273578835 -3.6732192977224293884 -0.060360965789171897034 -1.3627310461141357578 3.3320538339015404183 -0.77910142459531295245 -3.1830406457649815799 -1.2239798759016535801 2.5586328436732550529 -2.061867303440263921 -0.29985682253825024501 -0.79445951278709259213 0.6007720532920919343 -0.77406658816103335319 1.1243985445665674039 0.39119644958253191325 1.4756007885754940379 0.32065882573028536839 3.9726703130277951637 0.53462152567901999323 -4.7288471309932722519 -1.1971684176950243561 0.39978065803424528424 0.16080377000241907748 0.18323335034350440864 0.14362895519686924573 4.6698327195890154684;-0.014453006518040427408 -0.57974367804890769573 3.2740508182701670847 -0.30128279901897092596 0.7575197590428387473 -1.3305259154525619358 -0.20444132910865167596 -1.3265586135365572407 -6.9582337051267675321 -0.71591373842087646651 -0.44695403607989303563 -4.7874731587658008181 -1.3727801701777315735 -0.15698687609885617067 -1.7210842851415182331 0.094367159220505231199 0.1404352085555230778 1.3632577442187707728 1.1150942072821792284 -2.1293644184889521931 0.11782989422670618607 -0.06916493703404505422 -0.74351667222188877471 0.31165903783861137466 0.46290179284509586077 -0.21991757390494248714 -0.001675191376284910702 -0.28363016462794127248 -1.2266056762980344086 -2.2694103864073995602;-0.025520290068933582095 2.4491898564663951987 1.287980348282888432 -0.22290197354434015953 0.68928358913728715596 -0.11214000618417677146 -0.55708112022517397577 1.266907641654763772 0.2203051022568192352 2.2987544415052627578 -0.32138132616120662632 1.3072822566001334188 -1.6562855436729120306 -9.3995071458247451621e-05 -2.6054823587935045381 0.30487857817889857381 0.32666028866220209181 -1.4666349496230375316 0.19098480689010094435 -1.8729007784302058592 0.14993033664459037846 2.649991002227103376 0.15465975431320411193 0.57650204448415875991 -0.5509014047701202843 -0.2416880384719523045 0.081924905612112144948 -0.12477842619505451205 -0.076255173779424853531 0.56212052791785793726;-0.7772296263937552574 -0.5750384871255859176 14.758193245409660932 -2.5441252991409637474 0.27818460394072508368 -0.13878516732003592926 -1.7749938030466962946 -2.8213123505625001819 3.475545562432658997 3.9414738151171953007 -2.366127114488032479 -14.91401141589712509 -2.2153099221316829848 0.95786885191422888042 -6.398026810439374934 1.4060512090107588623 -0.52968276773374622923 1.688586875214943106 0.93092728164253546463 -5.0491403308351383572 1.6716413095501756469 9.1891299133403272492 1.7514570935795064077 5.3968703162343905078 -0.27093004974567452825 -0.57705327904106973325 -1.9641377087653639766 -2.1285342328628056308 6.0231951494590667551 0.82639906707841337408;-0.015228568513302460918 -2.0487984870202677889 -1.7506542590953004801 0.41310368217153109471 -0.84670198590517442572 0.32230886278728398953 0.60677945991180948226 -1.585562281890946279 -0.42831059587510067477 -2.1046266811676015429 0.51185640237324858681 -0.66249908641089727546 2.1251945884575258461 0.033760639442167644786 3.0402542547079329793 -0.46631352580615886838 -0.27057463935547643175 1.0366710517212591736 -0.46132816091266237724 2.1590397558509812903 -0.094430552593244912463 -3.3205525091063838872 -0.00080159120760918997455 -0.63019140213427415897 0.5160203930909289527 0.26974486883932308201 -0.073651069185891565594 0.14074520462715081615 0.32551510713834536093 -0.65638821314627882053];

% Layer 3
b3 = -0.70286084638569912286;
LW3_2 = [-5.8379554744678481271 -0.4299814309389697331 0.12645315085025074509 -0.15594935916920560359 -0.10619937759291726842 0.38613457786948229833 0.48063980263307953811 12.796485626781057832 -0.050845274672975969421 7.2702352673816177386];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
