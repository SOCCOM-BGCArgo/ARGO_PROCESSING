function [Y,Xf,Af] = ESPER_silicate_12_Atl_2(X,~,~)
%ESPER_SILICATE_12_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.94085571526559563793;-1.9483690395906956283;-1.4541946276437773822;0.4340044336389370927;5.1558498881160854665;-1.610422255576880346;0.99364640497745471137;0.089431330112033885493;1.0068354501797796008;-0.31958095580839601668;-2.4975178537904234588;-1.8964762955694269841;0.66188716643490896896;0.72699655570536758642;2.2500143460821684371;-0.015727611758219788018;-2.347662054348951699;-6.0243565536853198594;-1.2510980782322671523;3.1347407546001813117];
IW1_1 = [-0.78826782151009822108 -0.89067095376810700991 0.30162298286612287956 0.86190755012311359717 3.9420091961147725179 0.19816636452469837959;-0.53322587458785741799 -1.0592194980474387567 -1.2489062949125757651 -0.80173073819784024252 2.173300771616097915 0.029019851670280205624;0.26434367562853977596 0.036034624914326192358 0.7514325872013668528 2.0757471268283751442 5.9910805621930602882 -0.95487240018243446649;-0.082201720520346688303 0.16880890518834573699 -1.5675286932209220314 0.69268140296003333223 -1.3620409167900302538 -0.17561297835970635095;-0.9087362204865667703 0.19394643081802465101 -0.45412365398721876719 0.76474572946322139089 -4.3928621335873989651 1.5025127869073757747;0.095143734934179227669 -0.093712828150702504049 1.916253536673143687 -0.60912189828657847812 1.9854083619690892082 0.76448426406565705982;1.0034485710742202524 -0.77493529640824809768 0.86759300215247470156 -0.44274027160536744141 -3.14914953023424804 0.20430094660008474294;0.28696706670981231291 -0.028777896441389668597 0.47036312753185904878 0.82486969421457512208 0.864452832734257548 0.68077464968987244642;-1.1518596182579758924 0.63678216749281735254 -0.41913291550944620223 -2.5961205529287734173 -1.5468179968748594355 0.29591469453813712409;1.3234101918359615357 1.8866394364542098394 -1.9554678418958568731 -0.24640117148001505765 3.4248679444231093782 1.6979613618151190302;0.13213402267033719228 -0.20485635070036709027 0.15562512285358526265 -0.41372649581631831817 3.4957452605713892346 -0.71757853180332253906;-0.30268332396088287739 0.40571744213441701676 -0.43179288002287058434 -0.86335929737779626425 2.076867863234235223 -0.51349314669584666948;2.0519671282969169646 -0.40877842784798740228 0.98908602292119807142 0.67556383780643158854 -2.5712835201985417832 0.61472707309054075431;0.85813401782632914294 2.1962586628867399874 0.053082184407894174305 0.067308593547273268265 -0.3500925063561610151 -0.95921228923114920661;-0.20607732542515372343 1.5733678826160566455 0.03607658823908574397 2.4530870907871493714 1.2295639174310937225 0.32449868201211246044;-0.9754943415673815732 -2.1385512753904376559 2.994529463178444928 3.4602294308026775305 0.68464412687646691857 0.71077190389402833404;-0.082424621857546134795 0.43916289997161339631 -0.21385650472625455931 0.5142441116581604188 3.2760486266255424148 0.96002470387686067443;-0.37842296045462109344 0.2885586669641058144 -0.78389177668538601029 -3.0330507966822666255 4.1913436517788369429 1.7342734293035819704;-1.3330562336529319101 1.1670689042223831855 0.064001939235951890717 -0.46360378279526182066 0.25801337622334258315 0.3410571750971307381;1.3190384355138216055 0.77267136053785390182 -0.20050491696168934452 -0.85005371135583229769 -2.2520658391773729079 1.313412438030754581];

% Layer 2
b2 = [3.0361339322868756696;2.2472280141819003241;-1.2118567334899028598;-4.6319731502120751188;-0.33071314197407714053;-1.0246368237610394836;0.37699866598618569924;-0.46683733435724933392;0.69119114696457184532;4.0748458849096520495;0.78696142066938945536;1.3780767948183207938;1.9088099445811326227;-0.32512932260738669488;-5.5417020091510593716;2.957677216636850126;5.7742294464437087242;3.0450801818228345752;6.3274417432777418924;-2.2916713094130218842];
LW2_1 = [-1.9788764456436180872 0.35757203109880375536 -4.0003080820093748216 -2.6909110818676054144 0.16602004387579410993 -1.9441028349581226387 -0.89461218101352801835 1.7120764024862056285 -1.1157329388633139278 1.7019014466695672194 5.7655722861887950259 1.5684017424571905508 1.346534887858253926 -1.2226920824516747111 -0.97860116196165392033 0.21694659797632528941 1.1733369545773286724 -3.0056793556904022324 1.7174245719146479239 0.0054563384158950612585;0.37982063376926189502 2.1980209805557868741 -3.2973961542357281829 -0.65168674342130294974 -0.18116911099698715382 -0.33317402656822575624 -0.9934291556509082799 1.317931086061518986 -0.77612408512234165592 -0.66183332650455461987 -0.36095687060363179643 -1.4050647157477895721 -1.1157292797119713335 0.78861260577740865951 0.029825070468696073672 -1.3265846243567234186 0.88701731635435443479 -1.65886872666554952 0.80340756909705712818 -0.20779783793924644364;0.4572150200762986616 1.62679095007446195 -2.7659489101155387836 0.28430860954403597285 -0.078343520397113980414 -1.2002040112399197103 -0.94270313368175540081 -0.1971131821591687594 -1.9586346979488205022 -0.97482641551589499507 2.2014374576754973667 -1.426034451306381845 -0.88399838745305503451 -1.0975082010887062811 0.065119257944311198516 -0.63716256318526465208 -3.268290097585348164 0.44311558593252353688 3.7081082441948081119 0.47499280205846233782;2.0048884955441623745 -1.4003812246103746197 -0.98246728115820736171 -1.5490268052935827203 1.9287104405816741792 0.71684973208430358138 1.7303039431954829741 0.12846840257067546065 0.30616506409934707289 -0.65041220594670234867 -2.5707325798897220359 1.8368514439133591942 -1.6285001841291446567 3.2454303217355264799 -0.17860034712621367103 0.45694261037619254839 2.0897956821644076975 -1.094355845198781152 -4.0022935509467760795 0.93913042607364405345;0.31216661235235843019 -0.21191252636449087188 -0.74702115629000120922 0.79570663350915749046 -1.0461433036086684734 1.5140290921375396671 -0.83261662771998889987 -1.0867791699601019317 2.2266719473915119742 -0.32141279738738620653 -1.7734275526987519633 -1.4063246488431637715 1.1383562956724317949 0.7078226932187082765 1.3475757936855363717 0.33145288916248333289 -5.372017357741599497 2.0026202662932179877 0.99190737848508492291 -0.26809327330273285961;-0.3349346214553286516 -0.70003466962809413054 -2.0082306793821480539 -2.5685628315093036456 -0.063301796958502187795 -0.49005234122640972672 -1.8183522973506063281 0.26615210176809589449 0.67632597563167340393 -0.37540893349456500028 2.7471495790405642268 -0.35486350614326694908 0.97277641693199967676 -0.14670648870393987462 -0.70304872862381850851 0.14807116495943864476 2.377029625746331476 0.14273814606017937168 0.58797916169083075388 2.3563751668058414701;-0.1671724375042944466 2.4307534105715271622 -1.2366834086243034818 4.4413220783504590017 0.93701209125518780674 2.8611254604153182335 -0.11804262590834346813 -2.3475621168080498258 0.01881633069490684651 1.5072506917475203547 -0.10064636326090259377 0.98435904185384859311 -2.1113932626983462626 -0.59213461982559201235 -0.38005720577539425786 1.6677290795349242192 -2.2002814795575926787 0.23671560252451767647 -2.1235145870225924369 -0.6411728837341374998;0.2210855264525489472 -0.5614264441340350853 -0.13315278350600789903 -0.95757006202076011547 -1.2220441916362139168 -1.0577683705693938787 1.3221096481750911344 2.9952770359271219114 1.8629945407159103077 -0.60881261188725621647 -4.6567814688367334952 2.0464253093163389252 0.34853969781596910726 0.33274369304269896253 0.15685180580025634423 0.48122107777907779935 -2.2888366615075530497 -0.67236634129768646506 -0.67719903441116235943 -0.96325758301497521607;-0.33592669013665965583 -0.60345847269145169722 -1.5122759930737927903 -2.2544617588554705101 -1.064331436331180436 -1.1379557128347563832 1.3751268151443427623 1.9833651825135603097 1.0150414165780612397 -0.17265836778882140412 -3.0580191361662221183 1.0777073338878173647 0.21821522630492731776 0.21224237255586425599 0.15377126040072827684 0.79936746793070823092 -1.2197116320954457525 -1.281569992567548999 -0.25340470909620638196 -1.1544047144902875868;-1.4452108638109011363 0.066791089115546126154 -0.095133648543485729854 0.79967110122069018363 -0.22074134301289666249 0.73742216325083509432 0.6527454466965629809 0.62503008635266965598 -0.48058716656091826636 0.56989581855666804344 -0.48022742123242756485 0.71586736319317634258 -1.1161695002079330408 -0.89078455737359207856 0.044340077345486270111 -0.14559518456114275975 2.6175566712347437814 -1.4295763890573891519 2.5435215494043919016 -1.4070812983440899036;0.32439453319283034771 -0.10547900671670965012 1.1651079051467807535 -1.4890089081343136357 -0.50220298171669974785 0.20908340713910508746 0.075920057907509469475 -0.0069409931376694013888 0.027998344153089410602 -0.067209392552030788881 -2.6700314117654548873 1.3726444311830350298 -0.58449266239526931344 -0.13729158380138703488 0.25751299772412572509 0.098523888264743203491 1.2470336337992247167 0.97520362318261666346 0.18368499923218850611 -0.071517468784700638507;0.67378103208398498758 -0.095058961749248688244 -0.73051881412830987905 2.5468757506556496395 -0.69823154066750370284 0.3873031776776402757 -2.7507751403803446522 -0.8339327945094761052 -0.16518482352739444208 0.4059900645875480496 1.7397753998135816467 -4.4036103483551434223 -0.92099465110502520826 -1.2009128739494938642 0.19282941067850203898 -0.51768651048999148045 -4.7778725776096049316 1.4283280550349208848 0.78871931427539543336 -1.4029705165694956737;0.55879702679899034834 0.69104991806887050565 1.2745660629696042854 2.8198508062980911504 -0.3566034752154098042 0.83145336147387560732 0.63142233352079291109 -1.2491764617125258319 -0.40789363305887399447 0.15861107522999079444 -2.3376689576325997422 -0.10875519677039220678 -0.59666837568534536462 0.26071700552991650124 0.74955154939140156145 -0.063695798770338110661 -1.2826251815489648767 0.57891220564145962069 -0.88304008783002829741 -1.3906918078690235774;-0.060035512682264306761 -3.3263759165899342563 0.68088561985657769515 1.213851068460146454 2.4802760235981078374 -1.3069663362875589829 4.6798473177452386551 -2.0604776225311969284 -0.8147412610026667501 1.1127625540416130612 1.9672963733624972971 1.5898001719889287564 -3.0363281640373065429 -1.3813596912105636783 2.8122468594541727427 0.019745045801725157747 5.6182413875882115661 0.15218885640966334227 1.6365237456654058157 1.108087769693117064;-0.52479968605109950097 0.049273743560465446678 0.25507620960780097441 -8.6357286555645327297 -0.49392312849684483211 -1.8108774450676765611 -1.4167568194679360793 0.66146664801804866407 0.17004394175985559912 0.72866710835239290045 -1.6999907791060360207 0.083463023716292661369 0.852990278296615001 -0.27701261722473258242 0.33540352036805448632 0.13848722158187692921 -1.0301358768048836101 1.2814993591169843157 1.5826825215423734328 -0.048818852127728240564;-2.7451628136667820534 -0.4755874421017265985 -5.0375312711785582565 -2.964253438799228757 -2.1320888386157235139 0.099155964146963787575 -4.3616805748735893999 -4.9019148507862926323 0.27859676888782586301 0.58696915761430523695 10.274208861656797254 -8.0112991711339631706 0.84412283936563059505 0.21800992808657360111 -0.91552089438095807239 -0.30262415423704031037 6.0266954796009200024 -3.3486216857868873475 -0.60476534802352044373 2.1945641449400792311;1.1583619853820326107 -2.0701382020905247927 -0.25164061826727568416 3.1039863745175106935 0.54283122187473409337 0.6004813634209176243 2.3431363767923834018 -1.7281909033520068686 -0.0026980903857852997496 -1.730080718441486809 0.8335444365282236312 2.1414125549359916967 0.15297867790988273207 -0.23583458096581497165 -1.5103595264990281599 0.35465621578850414775 3.4934280279216674003 -0.35575489202061044702 -2.1494579209022806054 -0.9970116705698319759;-0.8342312188091766112 0.3999844054194690024 0.25305055519063063274 -0.51746254467886498851 -1.0499938362798446612 -0.67916585641113724758 0.41185533361629655946 -0.65104681570325317885 0.20677006581344198333 9.1271540146534473337 2.3478209377288741244 -1.3125342355564639796 0.94886255877528435931 2.120283941264757388 1.6288516430043205041 2.5804673551626620132 -4.3420188365122225349 -5.8712398661149789447 -3.373057460670202623 1.752504043089341268;-0.45647760590994457264 0.096762935180828790749 -3.7309225925775040267 -0.070067029270142661135 -0.022583451915419522349 1.4570587432579356069 -1.0293954066172374961 -3.7421599600851669365 -0.0014181576078193401831 0.78001445475567110499 6.4088071577368914689 -3.8419100081222592458 0.055104623127476277944 -0.20487640796974210255 0.85282298221876695621 0.097780278602300652047 4.4077082121714425966 -1.2928774312600386232 1.2985619408470900904 -1.3563898061537544848;0.30541325874234975801 1.4540046930462753316 -3.1415464308001235239 1.5184264666346520833 -0.31042027065789984386 0.018303130136157082924 -2.3448720859544720518 0.063358678849999475191 1.5934216950972999172 0.24267392815558605501 1.3407350627906040597 -0.67018490726529755808 0.99337206753824436323 0.012773374382961985574 0.23542891842531538105 0.36626786938384864323 -1.834332143749048516 -0.92053548814295083069 1.2086783024345482129 2.0631403007733077892];

% Layer 3
b3 = 3.8725009578504079322;
LW3_2 = [-0.17000603129956559645 0.10285555577859399612 0.078674808561227618786 -0.070442373652590858923 0.13949320209605831078 -0.35152536945362583554 0.013343658495809613412 -0.32230887982469319519 0.27448319340591970095 -0.34970551773556984854 0.31633589182922416949 -0.10496617463671074899 -0.50984999924828866558 0.16683773250922331877 -0.37121207272469325389 -0.27916455390051519991 -0.20258796784732119312 -1.9741341840195942847 -2.4364635762854511825 0.1660584611212814754];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
