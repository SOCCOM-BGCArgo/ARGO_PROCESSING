function [Y,Xf,Af] = ESPER_pH_4_Other_3(X,~,~)
%ESPER_PH_4_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_4_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.4400532650563757642;3.8844862240818289756;1.6367979670343215659;0.58897160109632551439;-3.4105316508059115854;-1.3901395531027003205;-2.0532423761077605029;-1.1369099777636550996;-1.1857380062564983891;-0.88173818596536179815;-0.51607157434154282694;0.28964563705040469177;-0.084420156369806501062;-0.87406847152157041148;-0.317097579575837063;0.42359175188113323829;-1.8021305450859470554;2.6429908990324277873;-0.94820632294986162414;2.7524588903578526278;0.66397093043201871332;-2.5281762427507477042;3.496823405481003455;-2.3692577197903168518;-2.9181597746463712184];
IW1_1 = [-0.2515563235700027378 1.5216003348915643212 1.9042746494496280985 0.73880543095085937644 -0.42945715786843124961 -1.4740181987362734883 0.51632674645875997754;-0.33195143246821318117 0.053069223136010902631 0.32368571713178051485 2.8353899429324438408 1.3468452413249920596 0.95802533138379031286 -1.1153297653870077877;-1.0828473621728467169 -0.067317877217322852346 2.9315250780789288143 -0.28392678883794458811 -1.0001620636851797919 0.47648721701288576647 0.35168200507021690759;-2.2295686488509836032 1.5317622610498233815 0.4652415099861219594 0.15914234780219954635 0.51308687430291055609 -2.3448884530272708915 -1.4484019477118261765;0.13559715280614137445 -0.49390026421695693015 -2.5961030759179535288 -0.6057847849360985526 1.343292717666545677 1.082194066976465141 -1.1028687938614933906;1.6286170335075496052 1.8024395001872102196 -0.25953689512776884074 0.16782045788056773605 -1.3856121763190984986 0.10422221167199363645 -0.63162179616855085307;0.023733560564534961213 -0.3990502925607812279 0.17114675076961352596 0.12156817035568547036 2.5442700979887264978 -1.7256264674288321892 0.079809386712262730956;0.82030042038873351995 -0.086522292376706874673 0.23925153804868556917 0.3714438061155037607 -0.76178603881514384 -1.2807905813801621075 -1.04450783950482462;-0.7727916774554235424 -0.13610896054875012973 6.6224094740150976079 -0.11355456727878031342 -0.059034678161291313792 0.46284320307039450437 1.1874228225942977666;0.47290853926521003725 0.38114940126886603933 0.60444905777472202058 -0.64341271741870398326 -0.68786388801652298408 -0.19885505822405666332 -1.0311171593598407181;1.9389312508713336669 -1.6117524311587545505 -0.24329833456989227725 0.12664892119424778216 0.39454546345187962997 2.0948673899150773714 0.60142171998559279533;-0.068604988855104506729 0.073653550979078330485 1.0847102885345552004 -0.63946926053561270464 0.19567322102029235942 1.851633499221146506 0.19811132046521895411;-1.8997174412656487874 0.50245118725425130801 -4.3374372409346841906 1.2369392576345961121 1.6431395959673484874 0.32076591515620961337 0.11959756096463254604;1.0279515618984598202 -0.011052224198613616254 -0.29108274922326043965 0.69382310425222060157 0.38841539829804289097 -2.9337802174050273685 -0.12621980896040316256;-0.023537518005262662163 0.89559030400215866585 -0.37298156852942165873 -0.23716790669500328881 -1.5031515038774652115 -0.89582068054630759057 -0.6596026994156717338;-0.20184085586955935465 0.16561487956201592642 -0.35275061686270620109 0.13262272400009042506 -0.02384953170065041983 0.74459996332454303491 1.1672384865682166044;-0.59685843432408047793 -0.7399997604805952367 0.91056142655793115281 0.22436929386366927242 -0.22794785245730120327 -2.721088437413154093 0.24783293349033908015;1.1303401290895924713 0.38449303966397574417 0.34755249620716499592 1.5738550888576006148 0.31691914803635540254 1.3562241676794202228 -0.94072162255302416156;-0.13069407629470558563 -0.72585885666958349649 1.8548802658677394639 -2.1417544302933069211 0.75524490578230263349 1.1130199066602775027 1.0436745208271680507;0.10441037737779287897 0.38192687855580725875 -1.2355421271109743309 2.7703160681992629044 -0.95231250710568438045 -1.3590629276585293184 -0.26039191976959258357;-0.66166511390160631656 0.74685880957248618195 2.8741686012876366263 0.65386745799336443152 -0.071965629817879975261 -0.019142162624940509824 0.0029700937455086730624;0.025852545504882536165 -0.16205378402584225128 0.11949266278652723172 -0.53604400358717618769 -3.1938749961971755198 -1.8167296954954204047 -1.0460523054747645766;-0.2709921710108137427 1.4621062173508991844 -3.2879866991876434135 0.763091285467192737 -0.047292331895635461581 -0.12905800252482296786 0.083038192324518991794;0.52453064571832230811 1.466933825475787101 1.0595198917085648649 -0.076233561829281634714 0.88661011577681358986 -0.15032290535202655346 -1.3846673336450328051;-0.39922072307859451934 -0.021066061333822026086 0.25524971736704143987 -1.0124376976775892878 0.12076303648070900454 0.62261773252185559357 -1.7827864216562452349];

% Layer 2
b2 = [0.38660554138399488844;0.6538051200423258269;-1.559021192878825568;-1.8027697715658559385;1.3011838723588475819;-1.5247853673696762922;0.32990651425607531166;1.0333236634500846396;-1.0588665535418508856;-0.10001664749455480008;0.15125828448896855294;-0.20345993394603092974;0.017426705655233208636;0.28976646042457726571;-1.174516988811401097];
LW2_1 = [-0.00092659141958573339182 -1.578784298886194204 0.31601300235998858179 -0.22234927626887396324 0.28286155303173637909 -0.23518292275018479187 2.1236152578477978103 0.2182639850613412591 -1.4281746407854358782 -1.7353322925017713452 -0.71209383765117462151 -0.038220418924999687016 0.68010471535239991336 -1.0374484755541550918 1.2734197612304380964 0.30427594256471945933 -0.13368530780365631139 0.49478204897414440611 0.88506591571326254098 1.1515725017621385451 -0.46119270923155636366 0.017291371027554493234 -1.7486092118435541121 0.43061190348357725188 1.6460910199915577135;-0.67288770131331954172 0.76268259515440417484 -0.0054257839025313300482 -0.34663616075277842166 -0.35947884635877674908 0.17080872775113770112 0.6285259762196911959 -0.78028534891656797789 -0.43578647554106675344 -0.31514288916789479078 -0.00019575975802763170624 -0.24405380432667417301 -0.15433882533068457588 0.090006889322620978189 0.54993735594745940531 -1.0959489639628006152 -0.095973213846366159374 -0.038256451852036965633 0.14531779320793900001 -0.17673830643135007845 0.1460491250871231439 0.29947511761937967156 -0.29746275267006072607 0.14198078207555456243 0.5727870939581913845;-0.57816115911689236473 -0.28147030616199553155 -0.28074532288366588206 0.33581352848423368096 -1.0742462405952395432 -0.50690107736287726148 -0.235786276607611478 -0.26445235139530975932 0.047395864112106902977 0.87118312025711686086 -0.071976781160126485082 -0.91947760183736770845 0.23281478006965750094 -0.75868564465146615117 -0.55847877034591808521 0.36906069118797107942 0.069280912014167889135 0.28986462271104890265 -0.041997704936788164687 -0.55029581734693711059 0.29657274381203424518 -0.60346629631365111823 -0.62464592090821602355 -0.4703484978761772739 -1.106987826944456188;-0.22045730830398269084 2.2061471603814446496 -0.27454648779274409831 -0.60020762035973007631 -0.57457424411036295275 -0.013797089759290495289 1.8548785186905600852 -0.89445686216129627333 0.070414030909998689967 0.57602575749116502468 -0.40993480637326229488 -0.60885857953906186157 0.19447620347494321003 -0.43290956797000984535 0.76450282792299284473 -0.80095106075891364661 0.29835946693950698982 0.11997559644587417471 0.070159855031506013212 0.14504645350602918263 0.30492546448362217726 0.30012565170139410275 0.81724300540676242388 -0.32464313934455663047 1.5413721346370488074;0.37076437092610325941 -0.47567733745193091499 0.35826099397372479505 -0.00099346761088927497754 1.2661087807884272571 -0.28005865587993139521 0.32346782578964017318 2.1905144498554429688 0.82962970375831301961 0.69371293692798563502 -1.0722628525277195788 -0.12140778808999863614 -0.3356926084447891534 -1.5006481140547944797 -0.20438974946598204019 1.6339632640084544857 0.51434824416824764803 1.4424943951788882224 0.86370370562634335432 0.95743101307497913144 -0.75837777328752886685 0.26454188659218613733 -0.94447969205275250637 0.035421926655532232076 0.96981927261562861364;-0.16448783884969797597 -0.42372843870153187318 0.45224059923584830623 0.096975804701782089556 -0.22950128570019465157 0.46932226891653994194 -1.0671931141764259277 1.0587464660804197791 0.3654946346862933404 0.047110030323621231163 0.62775509109712590572 1.0259859177021597443 0.070109561718224411297 -0.42692080279132127441 -0.012603691614071030336 1.3434200839662575611 0.45085141507328718724 1.1779651900466936443 -1.4944724328784209089 0.43432071664438443026 -0.94701573027959251583 -0.252512040016220074 1.6801023132026895457 -0.50288814049259111805 1.8809641224370992063;-1.4546054651027040538 -0.36768280339113401656 -0.052187193509145336778 -0.25472600445631682353 -0.611182564527983474 0.32427257287459948509 -0.12232715207511160593 -2.3047752638441250106 -0.014726203767361062055 0.35968627361791832842 -0.52997297245767849283 -1.3723968011635547803 0.059613688230123924872 -0.36544716445370734048 0.42662544214921516161 -0.42025076960351903654 0.43108753367253727085 0.0066104025047726191339 0.67233867212869591334 0.14475120018360845831 0.38218923412087391078 0.0015631560016308994158 -1.2679753658371035741 0.4852733790934296576 0.8436833026108732092;-0.60770587377250162575 1.9587426776656504668 -0.028374770483831312368 0.036303330368100350523 -0.70218822328761221208 0.080709019738710946479 0.95083041844971905032 -0.53351820934842786315 -0.048081820307573505668 -0.99314556836539802376 0.23553179972861446045 1.2945952262038793457 0.0026428309328525067048 0.87189537552342388782 0.59469383542084641725 -1.2199191344431279393 -0.47447121637068367939 -0.64317522125632642371 -1.1812285507886441938 -1.1673132563340848922 0.024424397623536112101 0.91885058162189992004 -1.138369580543102666 0.51643967008439861655 0.77792713293378557005;-1.0469882387686164638 -0.83873180174057360148 1.6617445977932039369 -0.57148172894964521795 -1.8927272260676646365 -0.28046953880861819064 -1.2740654821949120024 4.3226853869512211759 -1.3610128985040150784 -2.220653330991658958 -0.91166237947653239182 0.22498915388815937666 -0.83272948689624892715 -1.9498131979021173787 -0.36348138665364604361 -0.85570835691109259358 -1.704304287578497723 -3.8816101846359618577 -0.014869724397808913377 -0.21967938169387682401 0.33220880921812578901 -0.94463138410358349351 -2.0005528867267652338 1.3894259326280011813 1.5646398073071776658;0.48554685969412852975 -1.1117277420785081077 0.10200342852838097107 0.60017749822621169198 0.09354234825716423174 -0.24840937477423244428 -0.28173498679355318819 0.74317719827649530995 0.50653057160390113633 -0.10399096858448417247 0.029858125473305602293 0.49059439802681104048 0.17657354825179510938 -0.010216863228574598124 -0.64680448881077823309 1.1748828956922647837 -0.35495758276617445093 -0.150482300420398174 -0.53071720398975164024 -0.52224871370814107685 -0.26473566843551571415 0.4461075093383313761 0.43016515097737345608 0.10794390689201197042 -1.3345221711081662885;-1.6981167709639637398 -0.98999846690142145889 0.01489757207026814155 -0.79134854766713202956 -0.61138573231093429339 0.44800462421309839023 -0.35122159616389059256 -2.0219327057935405634 -0.10747097660709910294 0.41690876108534824507 -0.94166793776893320533 -1.2907338427225618638 -0.014256185651516119911 -0.11167459396895894341 0.42416725113417097504 -0.74480830877500747711 0.19574086282036826101 0.6935494456592790069 0.31837705035718572022 0.32614986476132101778 0.26461974004731320109 -0.10735250206272838047 -1.07338511760458033 0.49282122056172555924 1.7243785907770960986;-0.3059404565043038482 -0.29376406845436597859 -0.15797308442185942212 -0.03333725774894582411 0.10899586068260608274 -0.3195440655800749763 -0.75176124514198539028 0.32156601022896674769 -0.11955342358958662152 0.43093541889149261648 -0.064641538101485693235 0.61666353270362017636 0.51160639990846534797 0.51836699286518250762 -0.25646362616271312085 -1.3577603449377038114 0.0039447854103273095883 -0.54350124776572972252 -0.67625192728467531378 -0.70514198385821746928 0.35690625308784817982 -0.1233435583575794442 0.16118186020704072803 0.28913736509193327384 0.63942887736021647438;-0.52885393596201102362 -0.082152215792026250796 -0.31220831335090781788 -0.42447844516510707669 -0.010633069673659865939 -0.41584503548770962444 -0.30963034970355818309 0.51502013809746527429 -0.063257923191107595651 0.80361722104332600214 -0.41023365900147873431 0.39766142472430843213 0.59559099060206710519 0.12503423417550835195 -0.030299802887034807397 -0.77607724514854892206 0.091919737183538158254 -0.5584476769799555651 -0.052753969978377383832 -0.4716353993660518662 0.35617003299993199583 0.094484162233047619406 0.74575287094940378996 0.20468184733749875126 0.37534920816910022356;-0.5945730845495178496 1.1714525156686688145 0.13005395374718367596 1.5090103891327912855 -0.33032803482643796622 0.42580479364352030736 -0.38846385026179697242 -1.2371785663284795564 -0.28735802659792764047 -1.2792843667011593034 0.81269032696504128754 -1.1561394355839833548 -1.9664948109708330765e-05 -0.086503313587826743958 -0.037898012750122424264 -1.4694543587284087938 0.59736743080027376873 -0.35157950356835609984 0.23462715290929078704 0.28921380326332885025 0.3282872421240000671 1.1140640366112231074 -0.95777277765757384831 1.1466998334890154965 1.5896935596341750241;-1.2989047684507215585 0.52457274887909055572 0.30822112930163514388 -0.88528336222879033812 -1.7133873968862740611 0.82551955394961940016 0.81721257356126764115 0.26606215237151253916 0.61772979974126751568 -0.96889307285309045348 -0.44155213477686433565 0.12920485196110415016 -0.084670411387101476852 0.80449601332350528793 0.41647933483405186195 0.82966276498062241362 -0.039102448109238144291 0.27728331804808714622 -0.59228570857641615888 0.45024812268835473494 -0.85990640221774650165 2.2008289903361331064 0.010756396059865948669 -0.94561096412497835928 0.58540374631738811839];

% Layer 3
b3 = 0.96821456513583170622;
LW3_2 = [-0.82163766561119844223 3.0089855489723809079 -0.82262412209619817371 1.0026091259169647163 0.49578744014472347912 0.36451636515384511217 1.1030824704784987222 -0.93563987335996934291 2.1091319431969277609 2.3529484093443482351 -1.3373119480415214255 2.3121029515738995563 -1.9920678190630305426 -0.32079819600855385975 -0.42422604749542563995];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
