function [Y,Xf,Af] = ESPER_nitrate_7_Atl_2(X,~,~)
%ESPER_NITRATE_7_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.1678819456618323436;2.3269613211676367648;-3.337503593809474367;-0.87916248688358966668;-2.0860746164827923543;5.5036291020776086924;-0.24776768868741749774;0.72574400329168509138;-0.48302083443743387692;-0.7133277570623989261;-0.069008267280212726158;0.2242573299212683724;0.10947354450548045512;-2.1693710244803674492;-1.5760466246674238455;1.2196141084547200695;-0.20952583368867824798;-2.3850362791021892939;3.0137751019385579099;-1.1048842057452645804];
IW1_1 = [-0.33307715528996417742 -0.33324596076842138981 0.52621514710763828138 0.034715908716342287754 -3.5905807189786917988 -0.56566577398322370751 1.1725544894295769627;-0.10043701301979081342 -0.88457437152320816942 -0.37041825316174709082 -0.70119117272631925619 1.3528329914105838849 -0.96981074813923862088 0.52771702419733590439;1.6598750201477372457 0.30249795980217936142 0.77640604887300568304 -1.4026295949671405694 0.22751395803750426583 -0.24129998009494443845 -0.45419199389078412921;0.3754693246024445874 0.32537929948944699365 -1.1270154426076639531 -0.040254248744470456922 1.1037297180472511737 0.49072469373929294978 0.41370032904781139926;-0.31825987252402793137 -0.92361521587190376081 1.0971215959839750731 0.013800557423126899592 1.1615161596311689429 -0.52674394083706232994 -1.8539981484488101682;-0.25464283493731953989 -0.32133432539411399542 0.73272388206961003299 -0.59204214510761266066 -7.7582816589874026292 2.1795260082032896776 -1.1469693988498317339;-0.00049222252098904406559 0.42551752528810199427 0.77287316299503050487 -0.17535051580566088369 -2.1873413107294741309 -1.7234802922575427342 -1.2249160760313930751;-1.5053831905219565712 -1.0326886359290721185 0.23013325926095198892 -0.31115738258394992632 0.61892690061648214517 -0.79473356042343112904 0.56846646813057710723;-0.59984165516548382246 0.15484621879359955487 0.55143701503343556247 -0.021846570438767975997 2.5538264060098190278 0.51369876408226511355 -0.010711227700327202728;-0.025834520622603791146 0.4097964041090367826 -0.22291068295048055425 -0.510812188623837371 1.5115261847097403169 0.68523218549458508875 -0.6271684711034636317;-0.11302300514602837966 -0.41612424940242570548 1.542039082689791174 0.59045063613916182188 0.73010382825000141871 -0.87875619913006897121 -1.4534928496412331533;-0.27788154376570478599 0.073189268583673111612 -0.064411181293931904501 0.0063371770550336818661 -0.45093799455572119994 1.4238766138493974545 -1.2359769090309895567;-0.67063426986423824161 -0.31685141833776536702 -0.7005443125952515171 0.41865455638846604813 -1.5504999283037721458 -1.3215295123642127884 1.2319676088441904316;-0.66256978931328669447 0.11066538557741073534 1.8203380614786381919 0.23926153395525076584 0.42804516331055247891 -0.66240389594760917813 -0.88864686650974467064;0.10304385568434339115 1.3697820294736722246 -0.21718165090359320413 -4.1355897044229967818 -2.6590637005651864833 0.99383477345576132223 1.9027161448683014289;-0.28595436124550904777 -0.02689119964190005152 -1.6027832981434360082 -0.5070016606057606845 -3.6112770134790861398 -1.2868486090735007377 -0.85310488841722764697;-0.76542634059069425412 -0.1578798367124404356 0.7073699944244196125 0.8612896598628126954 0.0063719847376825997087 1.3523771308660936796 -1.4153446790668282596;-2.1152452867144684312 -1.4399122245617339555 -0.34345935581128439473 1.4424180725965209948 -0.63650391563999519917 1.3381684049300819339 0.16274392768806172915;0.1945713149539552711 0.21990629707748376998 -2.3670223560947047936 2.939032822411022039 1.7062216650362280745 -1.487201991333650275 1.8361524629852437052;0.009386367577942849455 0.37709059191822930091 0.83414191583874042202 0.54955550703224020914 -0.030747582566824478711 0.9567911722193270796 -0.23543023709393814946];

% Layer 2
b2 = [-1.8731624884873285808;0.88628484003362062449;1.1628596004873363867;1.0581322802331880606;1.6187105380590756099;-1.278473655542955445;-1.2068344564168762556;0.51394232378555626539;0.73783136633372781166;-0.083315950749168976586;-0.37176506689204985578;0.57872082412840575305;0.17587010710163905602;-0.63942297625015231954;1.0929764991945087882;0.61614089534259652847;0.72204235289884621807;-1.5000627111937947511;0.98214387057129748371;0.97793138550641389717];
LW2_1 = [0.02257375139391651353 -0.28523818482728047208 0.21023968909770437974 -2.1319973737282231774 -0.69031573421588787731 0.54237476709651089024 -0.95520583970378258876 1.6128833504555168954 -0.26647741309309758151 -2.0808608722921886347 -1.2935969653576830929 0.63757540507995291712 -0.3727833316630701499 1.0234240658223869858 0.21814782008482921927 -0.16314384438123710752 -0.54100513214142254004 0.016373637593225572745 -0.0097976800751612865004 0.047794383814611936245;-1.5455958713558060058 -0.065401218265210406266 -0.33861021124674928195 -0.69590304674824654541 0.32204599320133642237 0.089341548911838833402 0.73241872029669652377 0.060833936309089425842 -0.66383102040301278368 -1.7523361928022143097 0.33022490255453351704 0.72246473199906979801 -0.80417220418672707982 -0.13891906601697431856 -0.077451994383875510941 0.054917943383081563313 -0.26078604756153145328 -0.47505242629266314358 0.35091311304982902852 0.26581216268510976519;-1.0536185007776124323 -0.47841394736828285472 -0.25000026044149026294 -0.36773261401788398528 -0.85480502594085361334 1.1234199942132778727 1.3313733888336163336 -0.75745533288265520788 0.80684716063784878148 -0.64593789048489280713 -1.3585432039735585441 0.28164864149465940191 -0.088807282268057244345 -1.9677036446968192429 -0.39318977850068986823 0.41271147187876960905 0.28372983713979099685 0.24328396703602175877 -0.10038922638455341496 -0.27630937778775122027;0.033280863081518369251 -0.40219700986256878839 0.055532225204336080338 1.3760133515829651163 0.27138059525385765935 0.31333653285741569494 1.4135480742329162851 -0.64475027330977774387 -0.12218606774296482398 0.32447676975048539427 -0.20749470541361286768 -0.81678214387255554385 -0.80183037997210793169 -0.13966813320708904023 -0.33281435217357185907 -0.3565434566954274187 0.60903074200247020453 0.15895751848901440439 -0.43168046592624137459 0.04021999613524920858;-2.035133356691923634 -0.0061072000749867556488 -0.42362520502528616673 -1.0900985340015472147 0.39238139675271571649 0.085342426443186264473 1.3240038495656125672 0.4940276076792090576 -1.515681896679911933 -0.41821602826315928958 -0.3455014077298964037 -0.38980663447242686059 -0.37634276058138188548 -0.48706993019024152902 0.30670253356532106714 -0.43016314323502941042 -0.1432667283564296179 -0.40730700946254660977 0.55873473781834603891 0.42702813648811460689;0.28774029229148823106 -0.066933851508173908273 0.040659213124088801339 -1.6421374224167921696 0.40772721663043476337 0.4323201759408681899 -0.54693308150833697123 -0.033122102885061281696 -0.057806305479518552137 -0.15802346964516600369 -1.4564698659800168201 -1.1266435346001377749 -0.64499006561095384438 -0.31940787086969840702 0.051029284464143127853 0.04760049240072784793 0.18754813658245450547 0.19689144262430263721 -0.47470183006761224043 -0.68653949778090739287;2.657670682867653511 -0.63765323230562809265 0.50264926772569817892 0.035053801590655783715 -0.56823054703091369078 -0.3819469547867238024 0.3226186607283551 -0.1073360990789244962 -0.23180313845896061142 -0.17926105666499431157 -0.097640717959566789008 0.99899124269549222088 0.36580576549337934233 -0.091077389604132474865 -0.094416471415869202 0.051952355102727360014 -1.0715368321084979275 1.2421466474029794202 0.048216046984235261252 -0.40420474327233385514;0.4747355120511415616 -0.35216690180524190534 0.96053443606683353018 0.14652968026105431254 -0.42921138294503929922 0.18655010845791134 -0.38430609461439696473 0.52603526019262580871 -0.3211665149264293917 -1.1402301246657293721 -0.062479393687291502613 -0.4291986650406255932 0.19003315106289425662 0.38756911928043813464 0.49759378550416877296 0.13346191759722483838 0.75857837891533652641 -0.3943058604403618661 -0.12163620851134243628 0.11076764250519167965;-1.2727650314728686798 -0.20326083594405283672 0.035147108476895519424 -2.5802202793921353852 1.0633858145003283191 -1.9281279393083055052 -1.5987092695578741797 -0.22519300856890758777 -0.51368600728163404945 -0.087762923136498457999 -1.9682435572634451315 2.1716959215294435737 -0.6340649079642062258 0.62183788549264118473 0.19292439592910612389 -0.45035757537288378938 -0.98828533355201442223 0.18547349596979753605 0.10194990837437202524 -0.91319245665758297381;1.2011503896888984233 0.54869134535195074331 -0.53753677970744073722 1.8891617685198294208 -0.38577007622255171659 0.074324034449754328158 0.14852739368448258928 0.065447841184618008037 0.18623958317082778269 -1.7867308013387284138 1.4527490560321840718 0.38461969082610281134 -0.551495379252606166 0.81843891953998115785 0.35084617791503908135 -0.90597341064652170406 -0.29065241292153731756 0.46900443798577196031 0.84934870456941180539 -0.15073611079704940519;0.75319641414850002636 -0.62260306364359496722 -0.25208411432142702191 0.54384489915441402985 0.30681836848133087203 2.0052214375883621322 1.5891856337591938608 1.699409897622329968 0.41276284731770007674 -0.25277905144875933985 1.0303915014245657034 -0.26505278444741037225 1.69677343532153313 -0.22023313162126306741 0.25743047633817350839 1.1342940574466575665 -1.0586442542693763613 0.28364963305104623492 -0.762025008154870509 -0.36777482441046538408;0.1201091774929601147 0.093312554701556832404 0.48712936655808880548 1.8373629145199366075 0.035991023849610837004 -0.21130734785755073135 1.3808947640218982578 -0.089184853510261369314 0.27098645242070029671 0.087387448844357590305 0.85981729112529903247 0.16744918746919523755 0.38444469280013271462 -0.6200704630357758429 -0.077244946742779069249 -0.48278507775861267959 -0.054941783794395925022 -0.23264132514963575815 -0.059405257729416995061 -0.23289591463672468241;0.91332878466106959259 -0.19395017230762451321 0.10868224944971197066 -0.59928378460458842092 -1.1654335117264527089 0.92493562045698285434 0.75033863187101745851 -0.54875074283976954526 -0.23153509557845167177 -0.98444568891583561498 0.46106820310285928644 1.3696416783567755271 -0.401664955785479727 -1.893888118777581786 -0.56327334772234616267 0.82081273735700177596 -0.37612423146622625536 0.93993308812362419413 -0.099055763999042659163 0.87819376997938514151;0.36449582538815827881 0.10191317806393507261 1.7393776151106752348 -1.7288499329386604053 0.529826242889472665 0.34258848210250081312 -2.3263197140740197177 0.79335767093451481369 -1.202223578665149617 0.24817765306171288286 -0.82937669034418570746 0.2526098047861922713 -0.001571171146136747564 1.3630200259994986745 0.48619022325695682163 0.14471506398436095875 0.28321393561050284271 -0.2906797546761522022 0.57039791597680311597 0.24421373091908316066;-1.2980963197306032431 0.85723188338475997394 -1.8945238845444449804 1.0924574547963974425 -0.49435124601486840623 -0.44816052379841753162 2.299267051775956805 -0.1387223376906966954 -0.16631768834579838123 0.55863433478859636505 1.1549825875175376844 0.49231771580608413297 0.40799831128987307238 0.096981499627814202191 -0.18919199457463362068 -0.76886569079319655451 -0.036031707739474838625 0.16644893808450544892 -0.1017233753964316284 -0.56189255220511202804;2.274776559162687839 -0.58798072293825165424 0.62280664215721881494 2.3282785220692363559 -0.22691963155732589041 -0.23422996957251096539 -0.71009727572698577713 -0.13427975399307642834 0.58430474840496871014 -0.15182540005869299415 1.6153009758450427302 0.27594431084851472891 -0.33876592724266130219 0.94888562488040739673 -0.041650330442836239198 0.44772337561205471923 0.67530984960938122974 -0.060888444099285218836 0.22421892897149239832 0.72223888625300991517;-0.93892668169012205581 -0.10819149394515847895 0.27720780359349439514 0.9393912400913521088 0.38166242434472025247 -0.1435414098717310849 1.5877301230715663571 -0.050237895034059690258 -2.1955623549325258281 1.2622892362156414858 0.061313967715330611186 -0.99410592310318923737 0.047899846083679017972 0.53990356684651030772 -0.07075796107897815157 -1.5124648482667375493 -0.26443923043399120143 0.96793166725872681333 0.2232404584493662969 -0.48117600402571852891;0.90356779325816072301 -0.67281268070211108778 0.49486277882645435255 0.77692294019805541172 -0.065690092296129071192 -0.99707770573828347072 -1.2405196252666708112 0.2322609478590401122 0.34608396048304135295 -0.16067924651758053178 1.1336788005269200497 -0.17271847737624454466 -0.49898236724882588655 0.84855882126590964631 0.04265104752115723985 -0.028170412050566050188 1.1164514445491331429 0.32954181474114346839 0.8864907748663956033 -0.75164053335403957501;0.22393756495006328366 -0.7894888483602757745 1.3519053548864539138 1.2301502996009834323 -0.16261944773547601373 -0.066665896596704507515 1.3479839309032890515 0.12583334353873762423 0.91760262846206308573 -0.73984536266717748632 0.11021592717273517859 -0.18741019280229914701 -0.87779823879120777441 -0.99827188363718322162 -0.12624384451348213965 -0.017357202700093537356 -0.30983776633409904067 0.013552665398246963382 -0.69222543083878596004 -1.2701561093918500855;-0.024177920935384279028 -0.071754809795613799794 -0.64664845947169480311 0.83491574458937023451 -0.13435724361420572914 0.43751109393577708451 0.054621557683771838898 -0.065072380757681083652 0.78513583834208788836 -0.3211641271227475003 0.58114189659051651571 -0.030885576703494337092 -0.17974628372768156059 -0.58441724586216114989 -0.089001521296038360598 0.45798751265251980147 0.64296294271401310816 0.51331338877805843257 -0.027635463720545663802 0.44071229068118861205];

% Layer 3
b3 = -0.60777515701009676707;
LW3_2 = [0.81432465706374757008 -0.89648884884784141303 -0.72644647987640142972 -0.63865730299837852879 1.2538657541605022772 1.1613749931066306154 1.2408824527294552986 -0.84171039828073135336 0.78074160541590686968 -0.42728353546398739615 -0.20294396731059702321 1.9988814602661981734 0.49656926806537970975 -2.3899340841361365051 -1.3708662786970662317 1.4409652681677851405 0.99231314133409509459 -1.0762223657386695841 -1.4420956543237937186 1.7205045581974198754];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
