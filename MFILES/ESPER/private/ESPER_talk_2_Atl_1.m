function [Y,Xf,Af] = ESPER_talk_2_Atl_1(X,~,~)
%ESPER_TALK_2_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_2_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.787610219057902;3.5794542091783748;1.357717835366502;-1.3034999362878608;2.3296458272713485;-2.8430783545925902;-0.82705161288631523;-2.9419507450775537;1.6928922485388311;-2.4981497491607163;-3.6021165375716908;2.6010096391278426;1.2373440213751017;0.085879839444977124;0.46014045139120036;0.50391942605203133;-1.7270368913198728;0.58505368236618738;-0.41658556663274587;-0.22359072166173946;-0.70303883368045805;-0.19010994006727755;-0.82114121283937025;-1.3908247745005553;0.22648656523699826;0.73876616499245285;-0.27633859698616337;-1.417665208001575;-0.65740345749546658;-0.00043793031616070201;1.3228126688535478;-0.058399855336346257;1.4793361009984611;2.5652157701119274;3.8078822513440649;2.403109778184616;-1.5164195950380357;2.0411585000474237;2.7804567117778212;-1.6188217415438868];
IW1_1 = [0.82116976729598257 -0.3092564524932977 -1.8076147168410905 0.77931882155785925 -0.33067701054941101 -1.8521120299045151 0.22749493112241215 -0.88332638495392013;-2.7841316256759381 -3.1999122839618837 -0.85115174426149109 -0.44839261537083552 2.3841642868805768 -2.8211918222897685 0.5333435220567333 0.36877120008855924;-1.2174858104887081 0.16009794339924335 -0.14560724025618541 -0.41073422123826353 1.6387763207226016 0.10850991718549617 -0.23630381448485538 -0.34146143581329336;0.49645852251402189 -1.4987145711904852 1.6947191859692663 0.072142680733605982 -0.90694680527832316 0.35151777112648391 1.1534452205924897 0.090100583058261838;-0.35274616899894506 -1.3525910517954385 0.59396100884195457 -0.26049206692584587 1.074126711350557 0.56139875473434864 0.48409485488052767 -1.3134166856001068;-0.106544960311814 -0.065681525111618705 0.046582569531069228 0.37410031273871575 -0.072785859749627244 -3.0478081705609896 0.30160679138130242 0.42423003569698409;0.70011388488425264 0.44949103951841701 -0.066641889256440365 -0.5231710508771551 1.4580536643690192 -1.8989806352398024 -1.03433221330518 0.80569829792359993;-0.10316348667210601 1.444457045739646 -1.0395983275579781 0.96373632546741084 -0.98502707453109661 0.65784478810212965 0.59916735053814829 2.2114612763915984;-2.4940772507790916 0.5577309368493808 3.1823711562936308 0.63416407107430273 -0.040262790051443065 -1.249806962199002 -0.58155232818482172 -0.93804458266347723;-0.37489684465653172 0.82689322720786052 0.25907598684664784 0.061979102294486506 -0.34688325226136812 -1.0354202362248064 -1.901794876548182 -1.8660493876522199;0.014816249169964929 -0.20219152796985174 -0.20631985977175751 -0.26092324788834698 2.0617445670905177 -2.6191820745143857 -0.19424255578084498 -0.41953093159420546;-3.1762534531250641 -2.3139686219092792 -1.1213928299903342 -0.71396768587008852 2.5531194443996381 -3.1190693139443906 0.69995474166883076 -1.192717305856057;-0.011789890056655691 0.38875428792395816 -0.056696147309911973 0.22026264840453674 0.87619894136113374 2.0755030564110872 -0.22456236473132934 0.19511521017162164;0.503326087919163 0.0074384981301399093 0.55770546755798744 -0.45986290742114361 -2.471474406504893 -0.48904259634870101 0.37886510365662274 -0.3944290835580459;-2.6652149612046774 -0.37897973328800577 0.40826551545914908 -0.46259776434164379 -1.3028957646499142 0.018915366500166397 0.20698431381767757 0.57098782500019285;0.71766342283737816 1.7536564654703584 -1.0556139247808589 1.0571129785089168 0.46898124967610177 1.2137679816977061 0.80862769301312087 0.081273657362043353;-0.15551270770234024 -0.037514019026618134 0.052632026282125995 0.43849741020405653 -1.3096150523987056 -2.7822612807228304 0.5331261716950132 0.53923047162962079;-0.093535355047907637 2.343575576066967 0.32072767147654452 0.043707775723639646 -1.4175471163120406 -1.1661208865839092 -0.75831681816715413 0.49828086458982584;-2.4189277885447051 -0.4357136306900965 0.36200731578570938 -0.4820525466634149 -0.67293611362447336 -0.28240297147737892 0.071865738347880445 0.29464516856920092;0.17211458140886329 -1.4562488843804469 -0.41224599093114045 -0.30570006502474167 1.5618900013175678 1.3256905328096638 0.20121103646521421 0.12350293858633565;0.24411532498107902 -0.16439162015169498 0.80787002432611399 -1.4735398461142404 -0.17269566069299902 -0.22486054062794386 -0.038760478985438773 1.412909021869583;-0.60468867990606467 0.41279360535991722 -0.25196222917468497 0.053658524100526017 0.32245404574990716 -0.074237858340079857 0.57420160906371709 0.77941485049158943;-0.19355053950220602 0.1437608164756663 -0.087422474660640001 0.20511011811173829 0.89821984611709083 0.35953663563685412 0.3474420607570895 0.10504202230090323;0.062058129441011863 -0.76490649380156672 0.93589995174403051 -0.068681924532641977 1.1582510594369826 0.66334325455190057 0.99061002143399146 0.97364362589069831;0.43366671028641712 -0.15720234687068016 0.071010736389534965 -0.071872054158310231 1.0278882587188396 0.8928028156622474 -0.72201992549925609 -0.66595862920784943;0.7578560378966428 -1.1242434457010737 -2.5292068495632227 0.54365403717161254 0.68626899084634108 1.3371698032720905 0.32244899632645463 0.85057395886286014;-1.2253481559736403 -1.26294748799137 0.4056807471651217 1.3609082695476142 -1.4284021522137269 -0.43595545601267099 -0.59035583855269269 0.052440694837265836;-1.2393778774627324 0.99095449283435122 -0.5055651075232126 0.59531248530800207 2.3618401151063004 1.6813628306185191 0.98609416765024005 0.039826942549853736;-0.77654472294376875 -0.98522143992730893 0.11937451378747904 -3.2715684949344297 0.48438842781758573 0.82120538952512312 -0.44026135734680966 -0.83733092316944246;-0.40405743566772079 0.066620994772211603 -0.18969073572326137 0.33436281406158685 3.0198720351257502 0.84481262974187854 -0.39860478570423308 0.78583093864811215;-0.80053738488339787 -0.31345729804555095 0.21378114972719806 -0.84071170192954969 0.41568398069117102 -0.68025755370591379 -0.48035016830908606 -1.0073936521074323;0.72278075105077266 0.8375009967185203 0.69351290848775315 0.51919320077488507 -0.40836202198100463 -0.1654534065534711 -1.226761262249801 -0.67175803579834015;0.35653198328075442 -0.045767087549942409 0.91208204363772938 -0.58970105983870191 0.60998611570975747 -0.38742756344458101 0.79760763192176165 0.53088528753432096;0.5002737352888984 0.13512832084011292 -0.021463463343254937 0.31126378728644971 -0.02715933740617299 2.6556173385437809 -0.99561118456525233 -0.254495102428625;-2.3982828374969425 -3.654531738776436 0.02102212557308249 -0.22774765170951883 -0.28979149988174291 -2.5011545976536746 -0.045520810975334662 -0.78244448808400802;0.91679402578472036 -0.93424387499593053 0.50478036777719926 -1.7557329827484038 -0.70117781079843977 1.1579041801846486 -0.13303313869690545 0.98186872297363736;0.079044147755100908 -0.1005305816315132 -0.68327036649984307 1.8852147932932528 0.47959057818307055 0.1022917115201748 1.098423945463735 -2.0708776746906485;-0.02394049535398533 -0.41233952945272018 0.38049970285952261 1.1300784921428848 0.82096088778839071 -0.22930482792107923 -1.4891278315088643 -0.88373157355050713;3.020618577296688 -1.8754601704480018 1.1800723305873118 0.62834527614615232 1.9531261368916182 -1.5198068886071334 1.3615230007268853 -1.3400859325474468;-2.3100805994562759 -0.56043650465554007 0.34312531036012422 -0.53527564579609177 0.1608451044985057 -0.67763647110323477 -0.12054257827247908 -0.060697435498289869];

% Layer 2
b2 = 0.25885598290496653;
LW2_1 = [-0.040775362313012778 -2.1461568293854674 -0.67008925135956299 0.14569947997829522 0.13556831302623892 1.1485311095564701 0.11761001060061463 -0.12906148867619829 0.0099181984454289225 0.04604309967611362 0.32937748289277691 1.4502149927881769 0.4324989872771921 -0.53612007791829308 -0.92163079579447749 -0.054705133137513233 -1.2442594037593753 0.10451092605448992 1.8126234228245515 0.20168647242706639 0.17849049255102581 -1.2051550819882915 1.9722241684083495 -0.29742495771213379 -1.8403024208786831 -0.030405217623759171 -0.031420282014159681 -0.26659233346449929 0.004248005355678537 -0.5320272073824992 0.4012830222034377 0.033877443996768584 -0.080199261258092264 0.39399795354537398 0.97859253239873345 0.078962285877555438 -0.065262222539347034 0.13687789254336938 0.77989887221390286 -0.81232652387354254];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
