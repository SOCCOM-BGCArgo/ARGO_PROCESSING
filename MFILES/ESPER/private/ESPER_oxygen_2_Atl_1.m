function [Y,Xf,Af] = ESPER_oxygen_2_Atl_1(X,~,~)
%ESPER_OXYGEN_2_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.2336097869040747455;-12.040979669368043758;-1.8968048188857886682;1.9922054382257121663;-2.5839356680660641175;5.0828845537310591851;4.1300881000241203012;1.9539136846255171776;-9.1151039626773968649;-4.0446530578389729982;-8.2673717128638024576;-4.2494275148064746261;2.2243248684482952449;-3.5135224945562946175;-10.018998755421689495;-0.68512018482738346048;-0.54304727117098228195;0.39029833611705727625;2.0460536407904483802;1.7937864727205043991;-0.34612257280589736608;-4.7756105140521789565;-1.5549437600333906317;-3.1413989149046930294;3.0933901916470150084;1.2212083922440342132;-3.3272032695196731567;3.5583210255629618146;1.2455165922687725377;3.3688538271054930817;-0.2395531959633610819;2.7905073635481851824;0.43709378360421274889;-2.6183887701793011615;-1.8556172466921945219;0.11801996068201854595;3.9948033619871758937;-3.5036844314441806247;1.4957327013562382589;0.35672024367726884453];
IW1_1 = [0.19509008466600352705 -1.0518495826219138589 0.17411857270620673122 -5.8919045884987175654 -1.5844033695375325799 -0.25686139042781835906 -0.059035114684989488387 2.3292087410539492609;1.2182513486705139893 -1.7398696543677600879 4.8638846874968475475 -3.334064276138506866 -3.182831087535229031 2.658924194542104491 0.81556470790829460604 -10.161300659447000783;-1.9262919541049858818 -0.31702022862663548075 -1.9622966424445094091 -1.2210443881050023762 -1.1143541456794832101 -1.0458569115026610241 -0.94710684696392022364 3.0620185958229693135;0.47400365647471148778 -0.19612975587002021149 0.81824922343205097608 2.1508654167755745235 -1.2185697384381213304 -2.0352583778003121573 -0.55081281847169261123 -0.50425507708511474458;1.3031917040495795135 -0.038009121170631036957 0.75387946203485656227 -0.61689188476736167566 -1.7997649802734689839 -0.88182396270303586849 -0.1829626736083505012 -1.9217609102167645396;-0.16013656345782076307 0.86842242499243038623 -0.25139747996946698594 6.393857529441459242 2.2117496274917898269 0.22242548849681620382 -0.02223735718857769092 -2.8900413616124405181;0.050642014372849389336 0.50538527959892332042 0.2655956808019039328 3.5563931286237076002 -2.1019440896096819316 -3.0170412706058420405 -1.9753616706787131552 -0.29049437780381204277;0.023058788111402536702 0.045720736166804484824 -0.23848344338346125215 -0.56156118594836634816 0.41907934518164163817 2.8914685050189175008 2.3972346855983923675 0.23819395798213574555;0.70366709231869017938 1.3753652989477429536 -0.026173524286809059236 -9.4081056974211509925 -4.352453633932512389 3.6942722260483891183 -2.6165462589526260473 -0.65315372990625719662;2.3325167188356106251 -0.61140286062281412605 -0.61112965344861946981 -0.1038733450881676873 -1.0245369581000633996 -2.6445199553607725562 2.1733678500607260808 -0.0044971333326288883553;0.84335067810248609543 1.3110633771177333529 2.5300729395825585222 -1.5571236797050203027 -1.0812837883646200243 1.9724610233302155571 -2.8467332308612713909 -2.8642531996728441968;0.45143975341157838166 0.080001567787986463398 0.45356072925786838912 -3.2463251215015480611 3.1650886190584102131 -0.67083757614746875042 1.7324782396139912777 1.1188983893362898225;-0.25305141919216811441 0.080372719504980955074 0.25867634776646880601 0.83135501368718556225 -6.0346602579226837904 -1.593215105303929624 0.46712679510188964693 -1.3245124744880520939;1.0737305414369329171 -1.5965459429720345597 0.66975612019032693123 -3.2162539467223876244 -4.1276729712361071023 -1.1597119249413854192 0.73307189116475557356 -0.52726202024251533906;2.4000332767232706033 0.88998208533797029673 1.0645941897743667059 -1.0614774815221064141 2.2661835455791803362 -3.2672448751989393578 -1.9190327463647853801 -1.2016025897453914695;1.5182340946156362982 -0.61887727769789657728 2.5314461926534006508 -1.4153086453076950679 2.431447293456042047 2.868585052533982882 0.82267140705267394196 1.6800809783019725607;-0.13830015073445545148 -0.17285962171726657055 -1.7246858847994930297 0.95384667705235315349 1.6319416935312145434 -0.45331532079151304337 1.0394240781623298453 -0.8041487292749671667;-0.27375562014441456871 -0.086996662068856506211 0.89117782407414125601 0.13301947089669646784 -3.9664596433947991727 -1.4941086382699808599 0.61201457601225395244 -0.9873656107703925322;0.27479988555402118378 0.057062052412755567832 -2.6543594770933625071 -0.40010060868386426725 -1.5353046112467043649 -1.226225177190461757 0.025466684081194262967 -0.55356287853704377877;-1.701066239028837801 -0.81808333452208725767 -1.0936848476173133271 -0.50525759277603621289 -0.37111374955812514997 -2.5573522217833075665 1.1064079910894228931 -1.7273004285542510328;-1.5955513601291453352 0.38350005351212118621 -2.5625929244414913377 1.4192260631030306772 -1.7888611623217158808 -3.2739891150121867014 -0.85889989119730247857 -1.8610282248966245611;0.90192072855656757469 0.16015059913035692429 2.3947259316820024289 -2.0700772852558841919 1.9618103742034438408 -3.4490108418953981939 0.39846374068658541034 1.6526030954192012512;-2.2589294095990211098 -0.050389273641710134732 -1.8571789993055702883 -1.209882393287568858 -1.1233601836368145577 -1.2290758499913785329 -1.0274321777533328426 3.0770148815671225506;2.4713395007081921939 1.3764310405403414883 0.40665642197620238685 -0.77253285063122956178 -0.71693137982072718817 0.24055271411362810774 -4.5678890095941202532 2.3569658893741052275;-0.12116780296167217745 0.55752848810700750271 -0.86811583895453503512 -2.1937057816952059142 4.7191390928520906556 -3.7514981894227346082 1.2269665746297286901 0.72814159659192090324;0.082409398206166439849 -0.14958484170987731976 -0.23308137432918968335 -0.79774948338834916761 0.0074843660532022838333 1.1584743758048992035 0.99326268083777602413 0.54890332336602365437;-0.5253466266365827142 -1.0101142059759331548 0.26253435830559213038 -2.654639474668016863 -2.1841861754427420728 -1.1702753919231658752 0.45886402794995095888 -0.66655213142831692963;0.85558690172631712834 0.22976801541887370561 -1.1906239980457138383 1.1578817023108913808 0.17139435992409729481 3.7095015223668910131 0.56596482391368174714 -0.92334149198400694569;0.24766359765612305788 -0.079298623041736598926 -0.51062933742320604225 -1.0255794350600990761 -2.502035714021849433 -1.9904051143520138378 -2.4778870939233579307 1.4008485245682931186;0.35187464518821948145 1.0393178312085793458 -0.39961838572419799975 2.6856333014822388883 2.2853678680289535308 1.1762445686932305744 -0.85824007647554012568 1.0116112699872563674;0.14308668435294916166 2.1504049706689203347 -3.0735296960935167832 0.75240882011884580027 2.9542952066552730095 -0.50740304206196695791 0.65231481586018236207 -1.2373951055170568925;-1.03051532102726906 0.25398128458145785569 -3.6871594548277313308 2.4141123637187646978 5.4074089537333298594 -0.62344841348174218076 2.5074478121397931751 -0.10947826135086365096;-0.90751848459286221793 0.51796898910894373369 0.2066911942161519522 -0.32333709475574468062 -2.8867005342121392353 -0.31485822326910195557 -0.055958459479232371125 -0.11634448015967165102;-0.27897052972707342411 -0.014988897397001991335 0.21251828607665038118 -0.33418474717289320397 -1.6388425796590764261 -1.6942248336930687547 -2.1613385778099667434 -0.15531949651809165425;0.92083741541796038099 -1.5084228703452371434 -2.1662916475034412755 -0.33289252558549109473 -0.63216431114426707705 -2.869927124844778632 -3.0052342441914405846 0.83108915688604789729;0.48884317690209294627 5.4928432339604045254 -2.3001881554546548259 1.7593919461933493764 2.3754095792737364157 -2.967264158540758423 -1.0554919486728557843 -3.5701832340065111637;0.3470473705678399079 -0.3676310297252974868 -3.5597497370545156947 0.065127709865126753863 1.8691945371610159121 0.32700227264267112126 2.7193808708190054801 -0.012415641956832163678;0.073017030942790647763 -2.8526619050827193291 1.6438099055909949353 0.46795518833594296204 -4.4738205091497240673 -1.9926243108042804852 2.9571070179393164068 -2.8433848286660237115;0.083661681437490253987 -0.11388302801102717643 -0.92229422369912095192 -0.2422474836189522085 -0.56472159508466002187 -0.4629431587249256963 -0.13754451738251105564 0.32748533967933479705;-1.373514408048700508 0.92828805063501174111 -0.61987540437787913561 -0.30229387819789665937 -4.1127743024808340877 -1.5906627002641200441 -0.68769982403484408717 0.23232471520638772744];

% Layer 2
b2 = 1.2378979574337858338;
LW2_1 = [2.5637854700161555321 0.084589882824675069473 -1.1429873919961266449 -0.29046889304087852857 0.22832988997239095363 2.0905196579311957628 0.31626252790801079318 -0.41696756571080351161 0.12744504298890710348 0.071815860366846409613 -0.27735227757456509812 -0.11040895773402281677 0.92264910933888821809 -0.3990230655518279268 0.22454122906057563669 0.37758798527394160649 0.52607082769922119958 -1.3901854606869668007 0.45754410455974631189 -0.27914630232593062864 0.33171521417969085377 0.10795077335342932734 1.1590449227212589189 -0.085974728309876249921 1.4411226238627139473 0.93995320359954104283 -1.8523541960055553979 -0.25684475048651289608 0.31636853323040237118 -1.6877478741923279681 -0.076030778228794282381 0.12858518799609214289 1.0240427765025235107 1.0013017506031793857 0.081086099332234137793 0.028423399261915369834 0.26227541005410814901 0.17434286139665045035 -3.3484822390716231233 -0.63513148802344787658];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
