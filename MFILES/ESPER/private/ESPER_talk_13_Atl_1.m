function [Y,Xf,Af] = ESPER_talk_13_Atl_1(X,~,~)
%ESPER_TALK_13_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_13_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.2355347880227945;4.7852300135951715;-10.473454375029499;-1.8660723948758484;-11.127104308765384;-2.4694279358042999;2.5384888327674053;1.130813579152697;-0.27472543237654684;7.5744829312229953;0.21340380533524572;2.8809561984577585;1.9634246838679112;-5.7710349028243968;-5.4811338318009817;6.6772050669724505;0.53594665601262426;7.3490283381950778;3.9500879841860828;-1.2503448589772539;2.7907592055264647;2.7683676041783016;4.1802370731508294;0.33412353446630749;0.72223016469714396;2.3583517341988589;-4.7076541541382797;3.70510435194221;6.8448933112993569;-12.537544057324649;-5.6582996460762587;-0.37942295755781164;4.1337954901744149;-5.3909800781148407;-1.845361220147685;1.0707844966406905;30.616480336290824;4.3846647757770372;0.89140105491983168;2.8267186175743277];
IW1_1 = [-6.8466781174625782 4.244846033156743 3.8068558481398731 4.6379528657801243 12.18020522351283 1.0540429653611141 -1.8541027832751389;0.89423382811727936 1.9135659357405352 0.052243966160406746 -0.023904428359366285 -8.284380320956851 -0.26686951459567076 -0.073129645403045576;-11.207873634417357 2.1631187568676573 6.4830966377065042 2.0678097373590578 -0.6150009306279558 -7.5983075859748617 6.4876260098284213;-1.5264633137827153 -10.367428658402932 -3.4228143565738987 0.86201328074599659 -1.17698523436917 0.72629326340011069 -5.6177312823013423;7.3559747546384333 -4.7517085165203961 -0.10894902716154325 -3.5427329036749371 8.8953266099257231 -9.4800007119007663 -3.418353773150395;-0.46312076452060075 2.4837928697701526 5.506608897129369 1.8308233817962858 10.870499905616219 1.9732504626691574 -3.8715882294572879;-0.017847026343312498 7.1403860812194919 0.72435521547465254 -1.47595005982716 12.802422429722977 7.437069285571499 -11.569905628470966;0.57617516100660671 -0.16718847154873678 -0.077860065899978223 0.4412123533717362 -4.1745483276511131 -0.28477516888592419 -0.61518115656889116;-10.979954950857485 2.5777606709501564 -9.8553339825784168 14.415704007102843 7.9589321936679012 -2.2515967650277986 6.8723076611871869;0.76270890796714663 -1.1200207637541779 -0.24656701528787239 -1.7631982702088149 -13.212721857051136 -2.6410541881980092 -1.4941185582197203;1.56020044518142 4.8145840346442954 -3.57196966896442 4.2081820104386578 0.30405073385267783 -1.3165985221154084 3.1184968874949024;2.7490437150509104 -4.4717164194619041 1.9077418818058272 -0.15504885291584614 -6.5335391252919122 -2.3069087066250469 0.75709504207279377;-4.0483971477985037 1.4375997026332525 0.65277326484802922 1.9940889801247079 7.6474263152449327 9.3137912845505415 -7.9734942824162758;3.5310829051191681 -5.1074379849279223 0.051064945805691569 0.26140997783299891 -0.84844460410634426 -2.7646091259295087 14.621668985517339;-0.41776382778629878 0.021087581653832635 5.6703097658726671 0.091363983439274668 5.4153636252151047 -1.1664053250930422 3.2088901450866376;-1.1048889917066831 1.5209412124447412 -1.5239825285375099 -0.22874569174241197 -6.242178517391122 -0.34188876189646561 -0.38658137527576253;4.8795131507998502 1.6555506028551932 0.83815029504338634 -0.15100967321153783 -6.1995384116328793 0.048533832093585728 -0.60226534256712327;-0.73960358081953814 0.018894711589428251 -2.0745041287622747 -2.5135802255239152 -15.288510306853674 -0.83223795284717417 2.3671158570896806;0.079748429272915325 1.0065184185764868 -1.0217629211899855 0.58153867533753334 -1.7717597246497818 -3.3995213934363275 0.37873243644989113;7.1161356058715857 7.6026919354051845 -8.8611267362787629 -2.9584835965101974 10.686436534493387 -5.143832947944488 -9.718451626565269;-0.29841468133274529 0.64949102539741665 -3.0201794538137698 0.082483192179273385 -0.77458370767715012 -0.25504276273150189 -0.37434346131318691;2.8388526996983625 -4.5971543936028851 1.9677112384436022 -0.14497840893681271 -6.4243097825471569 -2.4241022579725393 0.80034061747894991;2.1630679512936868 0.13319738165654446 -3.7111278025188326 0.41240083269922218 -2.5191100532827106 -1.0439081603277809 0.74972114964807246;4.5297087142262766 3.3476461700488702 -1.7019233736520465 -3.8621682519461724 -1.1736013088004758 -1.0471696428944344 -0.91292248160736322;-0.25095648919945518 0.40433276558422926 0.57376186568624998 0.18637855081989518 -1.9920429362348042 0.79165273533278202 -0.3461066497437123;0.81496909140218399 0.43328418480094955 2.2906461832412042 -0.032229625358147794 -5.6380939874479852 0.80283032943727217 -1.2043246486299093;-1.2487590344092832 -0.59983345364064278 -0.41794275682177418 -3.6219507624061218 2.2284482431866541 1.6392045888902327 -4.4139971150976303;4.994915425515269 5.0289790403094283 -0.79341355343101005 3.1477124524528128 -5.1595991912348724 6.9428769909598556 -2.3529638741420102;-2.6589676448853177 -11.420983853811826 -15.407702878499139 1.1043921512857389 -8.7356578198262689 1.5665988034511136 12.674577355065598;2.0901006180930661 -0.86534079135064124 3.0489881374358001 -0.32899563090287637 13.26652733379149 0.014324219944057297 0.91308948033137483;-0.1927006307795241 1.8821063426341815 -0.69669935141293005 0.038122705400578182 8.8114620428999544 -0.064629031982246773 -0.11736662961287748;-0.16254096167308912 0.71305201488409797 3.007409937786385 -0.023874671851792421 -0.63302017780323816 -0.057331773904421048 0.58731535662090695;10.939736403689565 -6.0400344383559927 -1.2440562762588219 -3.4664335216011635 -7.4221077245927685 -5.1276900826780167 -2.1576449404190994;-2.5557933094840486 4.8775100326087761 0.56072084212824702 -0.024532044198237599 7.9672470758511746 3.5884827672383519 -0.43894693996773509;0.84561987151165741 -6.1234912551604834 5.8285078608072567 0.37983942963172312 -6.05784377660411 -3.1244645067125556 16.999407128441309;0.040170109273425625 -0.049956605741004967 -0.58982397902037964 -0.061674289511666959 0.52571244878846857 -0.32820280505162952 -0.021196773094513902;10.218271594981761 7.5570724618438501 -5.9039187018888182 -13.70020551982372 -19.049488623818501 14.142920957538912 16.436474579696778;-9.4486002198045398 -1.4671081862547126 -9.9837858266085142 5.8283213346427987 -1.0364028360265138 -1.143276595014185 3.7319936102790923;-0.29405388153789919 1.2998647206760576 2.6430765166229584 -0.034199865570305452 -1.5939766792273018 0.045184425184204971 0.28147647843098245;-0.0574174611348542 0.086787524397118745 -1.4734846840226601 -1.4744354109376805 -7.4587736891513892 -0.12935446891609539 0.30047360441552812];

% Layer 2
b2 = -2.1472119697573544;
LW2_1 = [-0.003092094741225931 0.073390744075833209 -0.015678961469373944 0.0064150907327853255 -0.0018905475770623875 0.010054515641863781 0.016590974077419222 -0.22503028846330791 -0.0017663323220878154 -0.011889905339231678 -0.0042819937313190587 0.73506846825882421 0.0012877753879418754 0.0054106048409808729 0.051593484301864272 -0.1700200565963372 -0.046291042092272659 0.030096811284181672 0.013088233815889229 -0.0018171346345247368 -0.30918240439305467 -0.69061462329231793 0.083296221196129436 -0.0062028359631470225 0.58354481749056297 -0.14639518641005461 0.010003594800181721 0.0027249035682084528 -0.002165989169098563 -0.051426062790479198 0.056782730708007809 -1.2309792052953794 0.011275774832099314 0.0363904714686707 0.0021772389059160845 3.270981674377885 -0.0034074192775973735 0.0041031041804423796 1.2068649861718681 -0.092129377522485692];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
