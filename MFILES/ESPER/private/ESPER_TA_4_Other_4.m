function [Y,Xf,Af] = ESPER_TA_4_Other_4(X,~,~)
%ESPER_TA_4_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_4_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.98572588067678612589;0.36790269872329445233;0.73720740681112029158;0.052964930419366534897;2.8148477575087009761;-1.2362497124539129079;-8.5162300921843030466;-0.70283669714676111351;-0.15025491508135149776;-2.0279885400628487879;-0.30961086764942963301;1.4964324237812851592;-1.0327108434444118856;1.2090613942658752222;-0.52156595646775127939;-1.1214641425730944579;0.66962552046110601633;-0.22294832173967776834;0.43263279874155929905;-0.1767982615504732069;6.0939275400213057665;1.3803257233102836921;1.6854898618608171734;0.20686285557964839699;-2.7215610726520038654;1.5801669095758850148;-9.3605272446878959869;1.5728972399094998114;2.6909415555386471119;0.709771422901878557];
IW1_1 = [-0.32976914848270938441 -0.011753186784804376536 0.87552400972059563067 -0.56577452966015939761 -0.99472762051228980074 -2.0001145114461453822 -0.87221351071059727289;-1.8872802919646747277 0.34240799197365301421 0.0097934524707553385903 -0.14702406001643011924 0.27274595160020054241 0.032973324431695309744 -1.1015426176862159746;-0.17546164741804681775 -0.19736777039007055712 -0.44338769834153357596 -0.29799829848373127206 2.4703223893224683927 1.0309544722845676024 -1.330358173108109332;-0.75809320293061033258 0.65005614265722722056 -1.1071999173339843736 0.24201213498801601998 -0.19416833182405393576 0.22504680579332766999 0.29492715734456637078;-1.4821392719353962963 0.72888340318765787451 1.9019411876118128557 -1.6018223237408093507 0.49277288300144311828 0.37728729061343607709 2.1027310083086936388;-0.18779985009491204084 1.6442240506821874657 -3.3583820423335404293 -0.16078327020061844443 -1.9070393468200428355 -3.2773102021383926363 -2.5121401267616585429;0.29752068442351486954 0.14077619357727685911 -0.62994664054896554184 -11.191751630574060528 -4.8858364068926301016 2.3194718213175820054 0.83752255924845409041;-0.2817967818490725862 -0.039249371222291544459 0.02975313615498789005 0.39364123929338534769 1.0513644179601795425 -1.2516762577653761657 0.26897459882036323098;0.37463527802157509106 0.51383603473091177261 0.64180484555461192464 -0.0041336625837823928395 -0.4794544757788415934 0.32234685718750599737 -0.58802923666099382594;0.66926205637785574076 -0.035485711453659897485 -0.10626347923612849966 -0.81447706915680262441 0.78165448433619200141 -0.81526795051923661717 -1.0448862821076145835;0.61176350786652644587 -0.14096503227585011064 -0.12316236880719565183 -0.10286399807713093868 -0.72659817744865928812 -1.2144275038953926682 -0.69547846651986944266;-1.0301705339539017903 -0.0019217571029801884617 -1.0402999618391994829 -0.34369540684720245594 -3.8078808807063939668 0.13577807203082450926 0.82739945727407226972;-0.2602730701608348407 -0.20050513378328035929 -0.58609010168248432127 1.2309091772743532278 2.6631804835604810933 -1.20046732113420207 -0.66439896051498403828;-0.17045865926595379913 -1.0137649172251044227 0.88613637569398873151 -0.60926724311481317287 -0.71957068182798900047 0.64889954306236952153 0.16025296333314106856;-0.97383145707256968393 0.14539287818574200828 0.53470579430976639124 0.39353795518430967348 0.043194468710907714393 -1.0303580968056158529 -0.15247267874470493698;-0.30038506184656854625 -0.068048885308685996831 -0.0047045580550430163291 0.27797917358030543866 1.3325038486868363563 -1.2954507553555778543 -0.057638497960846794832;-0.9493074270631439715 0.22902405742096459962 0.27340326707698792141 0.59341966648269939277 -3.9133678915663239195 1.1296407230862559601 1.1981553226451051586;0.23394357371067864282 0.019064550671231948048 0.32077019482921254045 0.84140137324129871121 -2.3026541888286033988 -0.37211358008227624072 0.81619832833557515173;-0.25416733099128485662 -0.7172537458936532051 -0.51735437107323722916 -0.080046539204454023042 0.59883027109022746171 -0.23471953563453135105 0.45172062848705135663;0.63118219094313321449 -0.23183651564641144516 -0.021955682993212991688 -0.22964075695353611262 -0.75201602840081693824 -0.89932958269497587089 -0.594491718198985164;1.2415045628370018349 -1.0207566154869760489 -2.5174419863111001661 -0.31904940145246657446 -2.8814922999578951313 2.5873687008076120541 1.0426912551478488833;-1.2359363477436018375 0.048588077887284190914 4.9242625915151228 0.50329804122626220497 0.017369059765946874563 0.060184071388947067704 -2.1168958003550830682;2.0152377535077143911 0.047280069156302326205 0.24464071297327016907 0.5703900034411962805 -0.12738501924699963119 -0.321138635705075004 -0.59868218105515991212;0.26307815103069864815 -0.11715943018726379665 -1.7850556239829309391 0.029838072255085924811 -1.2866790145439011006 -0.9100887082558787311 -1.4242409389414105725;0.63589536688084635774 0.20960881666153313718 -2.8110487295119241935 0.35390735849405402513 0.93144938932311083235 -1.0633397027192963424 -0.42972412822676825384;0.32831420882569722908 0.30257939886912399441 0.051096417636825687547 0.14548876330930912704 -1.6173677073390506642 1.2689454530232553431 0.19589710300892343442;0.8424721348471045923 0.63587658046500283859 5.7264566771905682785 1.3840424867679035348 7.7130260898374212175 -4.9512035125716140627 -0.85591749939944328229;-0.6742680406319571107 0.56429874685129555179 0.21941259333152909883 -0.11683733656221874375 0.42314970355438907834 0.06333406526554789806 0.42309050222895366877;-0.79747583626034190818 -1.8963082721181445667 0.85952258746334719852 0.17096798949296201919 1.6991889047202970442 0.022309374480696333304 -0.33639746631295347479;0.82904879819279320152 0.12173517253104079727 -0.15432860459724040414 0.14178811414766839816 0.35839799335021260696 0.17946314413826158773 -0.18264930283278701939];

% Layer 2
b2 = [-0.12114053933624677195;-1.8323263029427223625;-0.023355523577766615362;0.87852579815903175664;0.45369861342874129306;-1.1814119241503646673;2.3856287191505423095;3.3197235339955519784;-1.415133973523726052;9.1421190393207094615];
LW2_1 = [0.1831199685516851916 -0.060206289718467163874 -0.92572954855980293942 0.18152206890380079285 0.19131399701010626258 0.054256681294977383845 -0.0070472016480601397392 -2.5961268980521916561 1.039656465533539853 -0.75261736908722054462 -0.33435603844411937446 -0.0097648746518312484755 0.036870933914982910451 -0.030588614740684125226 -0.86457240336149066007 3.2931145344400074571 -0.0800043518025578132 -0.76002437993602889321 0.74038078951313190945 0.17811830865537145452 0.29787070120363390302 -0.10357684935417554861 0.56624565362562162552 0.31305815654547491933 -0.19314927869894821244 -0.076076458531315435674 0.14523688593556766113 -0.45798261784477950487 -0.44455597176974737117 -0.90546219490663915064;0.42997707988979050331 0.18273375245544451473 -0.45880722466331025355 0.41875138727705907282 0.31580699745690149483 0.060429211586594339112 0.066444805088448494201 -1.2379803660876753657 2.2253131351035224661 -1.106140087491565005 -0.91253179221251712328 -0.013405895250788378917 0.094005673355008076419 0.070307500126909200366 -0.71504565712596135363 0.9627688440838070294 0.032485317690381806943 -0.15967380914959836136 2.0023603840066601656 0.94319069915345199462 0.79440217572881643981 -0.0059839370744455798456 0.34849905803405195615 0.28132080145622018197 0.22592900979541830075 -1.0531338271355406011 0.19316883148885449772 -0.37083052916921438458 -0.20220765143410590614 0.5082929555173438807;1.6035012658146261533 3.1256532883503651554 0.80463652009707176127 0.041399806696570590203 -1.8630942606495197733 -0.34147763579465889583 0.44246345434310774269 1.3836633829483542257 -3.3151926399608617757 1.7593566316285738083 4.2850898487168427309 -3.0091915149068766411 -2.4894905607861446128 -2.5188773340735828299 -0.077440444687035980831 2.0960588353446296672 -0.15163776423634636736 -5.1114434999766951151 4.8325045289401842297 2.4297358646464868315 -3.8774520198887940658 -0.69737491592943878782 2.7728532079789727227 4.1530258220317186613 -3.6603593321616050282 4.0714146439388771981 -2.0872661021786256264 -1.4720959264391983989 1.4578804114046106655 -4.9036123434696552437;1.5927029966394983251 0.15304447443333665801 -0.54516961936405128331 1.121400955674958233 0.43194991273555782829 -0.071293061409839111886 0.068144129528005983887 3.5653349399065601411 1.5371236586520693468 0.18775460633425936074 1.5546774898722590663 -0.11444630354979386244 0.95085817312127607348 0.05763097822166084877 -2.2553036669206374398 -5.0743470158903276612 -0.52747021165521801311 0.63025276914276273654 2.8352319332557831544 -3.0142921292148359136 1.4753214107922185683 0.44168247025990109433 0.9212724603308122262 0.28733842690103383877 0.63927783977124519321 1.6287165825810649977 0.87129410235836834975 -2.8957715359801610155 0.33222505316030026545 -4.1769701859290497836;-0.050264763873134929439 -4.1017996738623567765 -0.13087397591804075803 -1.0151447225345908709 0.34035717774936646851 0.34794161199457379618 0.67121490789688686984 2.3834759903377338297 -0.85325812971380743388 6.4172042058081109062 -3.6561304925138298216 -3.1697655862946922944 0.025204578707384208552 -0.5015204578291321269 0.085843743061337351996 -1.1475234139912153797 0.59922291353453371876 -1.0593895455413113726 -1.3408514728053200216 0.29773556706316867126 -1.2757377679640924395 0.81078809406617957656 -1.3582765466077253436 2.0157825704837071257 0.54632997047245424049 -1.2736133469658521555 -2.1348130018425628407 11.272575412456758315 0.40956259657815125008 1.607662247036069747;-0.70099495047216253685 -0.59127905137958269854 -0.1501024040981429053 0.26818422640986511185 -0.68673161276000693753 -0.081774197628153785788 -0.48534577832826925059 -1.7572151279251753131 -3.4752784716270901377 1.8450032838045475891 -2.9465488511505824043 0.040939725847670069281 0.07922961278910214955 0.68324557878949332412 -1.5226003887166552619 7.9880349016354061931 -0.71462059350557760595 -2.2525773422106425414 -2.1738368236978664605 3.2601248599081800172 0.92036055840671737727 -0.37795998802941010997 1.2199419312460437759 -0.72430687817042360699 -1.7773712249933570906 6.2959698244356792074 0.77309736931026840079 0.92654965277303868998 -0.94359605312379857267 -3.7987775561858359019;0.66547829836971195139 -0.75391222974394322964 1.5314207552806102797 0.13631181491374752546 -0.29005977708227359546 -0.27588089945329441477 0.35547357415757474541 -1.2343366168039278108 -3.3208448745927778845 -0.42148421334511526615 1.5884922795099918336 -0.70773231114313928103 0.61894572060467434316 0.018450257071272371107 1.4991947586363272293 -2.6644157302348854266 0.77722954718121561868 0.080559473941723719337 -2.9814430353597685119 -0.46576890862266062676 -0.84220507750027584493 0.1126439312042228913 -0.22739375988618942825 -0.72360409420300020322 0.41087973075947559209 -1.9935736668941888006 -1.3336361969951722184 -1.5516003162899734136 -0.62686092655955205633 1.4017870634055253909;-2.9787625175702681091 -5.2918337476133192609 2.1232315165299975313 3.2837175300683325574 1.4769294985974237289 4.2518678957560078757 -1.420734278147033347 -6.0078377759042886908 3.5849696871414411525 8.5963042863196061916 -4.7137226884342275923 7.9947660951953594122 -0.39483089329374077003 -2.7678405204481220103 2.3176715845703088625 -8.0235716773821010861 -2.1417706772029756479 7.4418045698603130234 5.0879501353581462197 -8.1380445721150724836 -2.2691298623318632011 3.5948588104532670506 1.5732883686226943887 1.7623445410423659307 1.0070718684777604235 -1.6367174069638315004 3.9702181062093298003 -1.5764898034731653631 3.6546273995515110578 0.71110258808363169258;-0.10679014765725021452 0.65196910069038227498 1.8930527355231108189 -0.055607330913715023735 -0.039493112212823915097 -0.014605739358391716873 0.054475112471780377799 3.2581931790111204883 0.2406799977553187031 0.32535915804884552038 -2.4835149519712924615 0.22890976863150891418 -0.36202286801504990343 0.15160807886007993117 1.0792622714012041207 -3.2450424821668577557 0.60315714989328039763 1.6478850149639812095 0.60820442345581204879 3.5753906236669403818 -0.65161815415315593736 0.26795227383521386111 -1.3991766974169539406 -0.5069357625688912794 0.8382824265680890452 0.21519976481318300876 -0.35742981779420884836 0.0080558765472657795775 1.1791655387322581561 3.7335146969638164371;0.42287498107291809912 -0.02543772868469137971 0.57045676741121509323 -2.4066508527226013747 0.76413713535101124297 0.75781265820351861873 0.52734809988722863849 -5.4548815510466779344 -0.863617346746896275 0.045296421796930663728 2.5488162564648453312 1.3449325581679112407 1.783686344613210073 -3.1010105802148855147 0.057109869509468329241 3.3390064668154448846 2.1236921114612785644 0.92911628400531043326 0.81078141849357365789 -4.0757578609685189974 -6.7622299690066229871 0.029414464373263178587 -2.0381902139978209654 -1.3591608278830791257 -2.1714245554590072551 -2.8734624189026036767 -0.50588501367345140025 0.27273537353296795072 -0.029802540985344842805 4.5561099584902633453];

% Layer 3
b3 = 0.022284415750518819094;
LW3_2 = [-3.6598722065435183026 2.3347355176524766662 -0.012810480002667008065 -0.18749574083780551348 0.054381162255753297263 0.24682168725936354248 -0.16825457432333557062 0.0060923416300774167059 -0.84573712417969326705 0.076262132740024399236];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
