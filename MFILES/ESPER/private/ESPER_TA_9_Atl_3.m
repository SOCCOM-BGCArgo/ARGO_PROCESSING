function [Y,Xf,Af] = ESPER_TA_9_Atl_3(X,~,~)
%ESPER_TA_9_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_9_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7388560542034712242;-3.848921774956384656;2.9859453531022817074;-3.4555503477028475245;-6.2010601295984528747;-1.5555404590508234985;2.0752499445753942453;0.55137410318602197989;0.35985460445446121325;-0.37275875825389731544;0.46826748481809021829;-0.2747123016642931681;-0.11857689297928694638;-0.42726825743063662211;2.572735636320085284;-0.91760693038984830761;0.98898349170349553194;1.7007906231689089438;-2.0621384946624941037;-3.2776797095563017237;-0.0042375510884866962602;4.5256152970799634616;-3.5651263357028124545;-3.1012126395110413135;-1.2837569490842137832];
IW1_1 = [-4.0324539573186077845 -1.5730062267927504838 0.76513293460121145628 0.27221503510415595573 1.2152802496564234502 0.67654103186822511784 -0.43439555479685443284 0.38312919880278623053;1.7244153451154606849 -2.8302106682776071445 0.041744229255236062204 -0.16343553870057042632 1.023106567718278459 0.046661316736315093523 -0.43728193962570294229 0.97968101678041830116;-2.2486842966725655302 0.34434876727430424603 0.2708586448017187287 0.36486970905444127133 -1.855327559064042342 -0.69207432094897325392 0.12385768142730153862 0.079637754438149035985;1.0373199477757713005 -0.70872446261108357213 0.47746103327892175372 -0.26771568339577067608 0.88597876542142384171 -1.5982286635008038367 -0.69275726101262713463 0.621468962478639253;4.53065774093809015 -1.6995315144604301594 -3.8741326993358771169 -1.2784992105038046617 1.0777994981657084139 -0.48161342972607162904 0.18858537563001109838 0.26616338535621647532;-0.15776160743928721586 1.6246410820136552022 0.68153642339326780952 0.57551723633417739556 2.8574714612654927848 0.10786750485153016876 0.37413417751915212239 0.61761480867472184908;-2.7221443548866823825 -1.0908332608531772223 3.0094349349327202958 1.0439033166513167483 0.75538543971013294431 0.28992651010783654364 0.41108561121862591259 0.66632095159951165719;-0.82958485605301446331 -0.81748732019058323317 -0.11775973629215701066 0.78881843722850308875 -1.5561758079425493939 0.6057954614078078226 -0.19478054818105269841 -2.0344767429877981257;0.80425884710532624666 -1.3529298038048069852 0.91480900511137097642 1.0007116718963395829 -3.3218647904519960079 -1.7123578773363452576 -0.98242123940884373834 0.36510324944316291385;-0.19656444430908695531 0.49198465489008696983 0.69220818793763316812 0.60730006908488542994 2.8316087786447052821 0.22235711071714342468 0.70576036357250493403 -1.601585565974632086;0.81879304922335061079 -0.34155248214339256618 -0.1169109901977435223 0.0056726775947128701971 -0.76540326123958968285 -1.017745786575397382 1.1162438693790990296 -0.23038088642016563146;1.3503089545196542698 1.7402765741669825594 -0.28039463306212270011 0.36453229563190753248 1.1642581527701396649 0.21696754583482327772 -0.34213769292604412353 1.9675709551913296291;-0.43993538037072466018 0.21002039260423760458 0.16133465494383314454 -0.06771047123543937063 -1.4991491091953179637 -0.85821777595797188454 0.63955948620669000881 0.42422654392667269452;0.64564874072321531973 -1.7628079208231057784 -0.77744922986104081364 -0.80408452186632162206 0.90541585295818494128 -0.023809842355713532747 -0.11033216047586477671 -0.09454477503973185426;-0.036753961865675935372 0.41151843222445144699 0.041330257300740573523 0.093480924579261590046 -4.5906968145212658783 0.41674931750471255754 -0.36923821330155559561 -0.72297807639317679396;-1.1852055375611429966 -0.93864830510678465281 -1.3261448491319340892 -0.91748660855385866242 -2.2032278057473364541 -0.45207212697134696588 -0.27223730143742752574 1.047754767248760821;-0.71069714218207735712 0.46201448750446083569 0.18664187303708668075 -0.0089362277620336667827 3.0066796425652042579 -0.4363558323336292899 -0.1073179244820546413 1.3006527856794103393;-0.34821475589192141253 1.2842438424272704101 0.87687632620395261629 0.20287518020897118975 0.14324897968653876879 0.40421578462975182866 0.29700621723063358459 -0.88642052816276639682;-3.7540211310170614745 -1.3310195351711289202 -2.866465369562657628 0.4294970630633929698 -0.097128496569598571364 -0.41197702370957489659 0.40350278399853667377 0.785927900457517703;-3.1263183224008366246 -0.31458284564301225439 -0.28391339921396890889 -0.12588920103033607312 0.55378855891180223114 -0.57958804986105805224 0.18440351315283970424 0.93152138676522833194;-0.36020951191634353883 0.89191397768367530752 0.23575589883928158019 -0.20378073489521333905 0.068963825278558571474 0.72238111495702173048 -0.27692866559778495095 0.87256395994034907648;0.35708453902933373625 -0.61625582804383671753 -0.076371596183982523587 0.081644671705203300527 -1.1736073516423046748 0.636969586325933812 0.39386212493319588956 3.1243904118770773337;-0.76121689538441206224 -2.3284443674233088473 -0.69833900374060375871 0.79317828558378167259 0.18715713942358480626 0.22578044461612373217 0.85903658378858693823 -0.45059243437719642689;-0.84152884344637923775 1.1184980021895247759 -0.8765963615550761423 -0.43030537446149735858 -0.65283555124556036375 1.5486990069382569057 -0.30973070308037642384 0.89823714806561272272;-1.4836707535228281785 -1.4667783954119477663 -1.0143061764379290857 0.57915186839371834981 0.47180471437139426261 -0.94154352038152844262 0.35254311079708194887 0.099450823101875848731];

% Layer 2
b2 = [-2.8008896434502563721;-4.00251412122338035;6.2757686859315793271;1.9334685887184566155;0.55588118005806719246;2.065412796444648702;-0.40497008131216094551;-1.0711634534915877026;-0.60001960400891796166;0.43711177933248995808;-1.2524743151185024903;-0.2027130997335319651;-3.7659690122544993152;1.056840474558048637;-2.1280256193676776455];
LW2_1 = [-0.29283055717771239168 1.7290443777962718475 -2.5236952535278183163 0.074690310340789656252 0.26609069310167110523 1.035915952304325538 0.58612442466145331377 0.29720491011720540087 -0.10910738414071222135 -2.4349141050803697617 0.74879911624270178994 -0.20378198973743189004 -1.982174281893696044 0.7982856028923438485 -0.57141295724893748087 5.5087658774708057052 7.2247386145380092515 4.323165464259727031 -1.8670652477177771544 5.6604199149836702532 -2.4716671152897204955 0.17024851070358781868 -1.4420516867346766521 1.3614186298470063452 2.0796418659114488392;-0.43916034229683953427 1.1988998098984591234 -1.2340909995528439591 -0.3134792862231658428 0.30982646118007484137 1.2646169321173998945 0.20737394253754831697 1.2092256760287884987 -0.2066157561456615499 0.39034872984201740564 -1.0181658908001667285 1.1501786969038967356 -0.37834724544889819509 1.8869685513831957469 -2.0002435678102106209 1.1552751704760066964 2.0488758495446339758 1.3579656475783654646 -0.45209615843720157846 -2.7579764992799882251 -1.2483851345068042171 -2.573351887922398884 -0.044141786083295629639 -0.71660339821708463059 0.7047465184945040928;2.4987269957021100986 -0.59845828139645762533 4.503049391388349143 -1.1926265371841227036 4.4674242147939207115 -1.5609489124671689364 -6.994287685755641526 -3.5490502015103664313 -3.0255674332943938154 0.31644259354493703418 -3.8975135304444887829 0.62699479100701849266 6.1508718965693667258 -0.86503091212969429602 3.6601033023616227347 -3.3709776486464693157 -2.0222739094006390026 1.1561337456020974734 0.3232977991555538444 0.47174711121373702483 -1.4629850376867197248 -3.2494231990466113658 -3.6220475681144819191 -4.9647728756075313328 -4.3137046739548638996;-0.57568457333602496284 1.032099663735486228 1.1471955894300158718 0.95323405308878705888 -0.20592520575576533925 -0.64433717830984216235 -0.69581682285322665749 0.86414405155279039317 -0.8862500995184766639 1.73095339090935596 0.36837223833893428804 0.82497612395126829199 -1.4079241899333978516 -0.91299442382552342679 -3.1858343155001969116 -1.4574275342351419305 -1.1773728719066505199 -0.22952959023177346709 0.75748799467234340099 -0.1403976814709466947 1.748206692269268947 -0.85861377552148487879 -0.97704658623874340861 4.8098223155933341744 -0.32384824387929039835;2.2306283763919259044 -2.3618302358868716873 -0.097456148844096340822 -0.037213570082044900023 3.1297249317791364653 -2.4489680094367853869 -1.0951157315203023934 -0.074726823147221052568 4.1141554574937151401 -2.6333139308899529141 1.6882530220225402395 -0.67663201495830560539 0.38329005023166362598 0.046191750545181882448 -0.74862044747827005686 3.6902086715387922844 0.78976729238943987887 1.2374141388559620758 -0.65024792572744927188 -2.0474597680225343765 0.41900548749378663249 6.0255525208349869359 0.49155790150651956782 -3.0464224282538157063 -0.546597666480730493;1.0873033943141712232 -3.0550009354961864538 -2.547096230864941635 -2.2810192074968216325 6.7279596036173918705 0.71841284833630403295 6.0239562556239363289 1.938423242422259829 3.7389346360644934997 -1.2027224645189678043 1.2438945358544970521 3.4668601676125363475 -1.2330404124438494318 -0.42963527516333227529 -0.41409771027201053295 -1.0653428696340034865 0.52556236383437315851 1.8043561338978768571 1.3553651943730065099 0.17573297500411586003 -0.9541427363116643523 -1.0848821154520615906 -2.0266694709709667244 -0.39784114819595395307 -1.6883400232843088773;0.51680266368888794215 2.0542063509476582439 -0.11122028787645719949 -1.0198638829780897197 1.7538633090351352095 1.7106251032172212767 0.33482257984079499824 -4.1623195278589255608 0.0063033481565580133654 1.7653058237439340772 1.118645492517045259 -2.6416350782789108642 -1.8108404879097190765 -0.44622370238778252816 0.62374412209398977236 -1.831729707289769804 0.32523712841854751643 2.509376281166085132 0.84915660151238081532 0.090670509905552851282 -0.5438342220866622112 -1.2592747788084650562 -0.034371552750345715777 0.5634812026103589444 -0.096916199009914105744;-1.7426973100574549846 1.9737180072942519526 3.4626707238063829664 -3.1823043877674175306 -0.90727252668096536325 2.3801688228708908213 -1.9781218939471816309 0.1671158414904891365 0.6343878869625853012 2.2850577216787542056 -1.3600936676367700873 0.23775109069417207919 1.9022461546321016712 0.14230316330044734396 -3.2524951755426942945 0.90978089061978917318 -0.31417657500362972112 0.6522263948797863975 -1.0248823663974988563 0.24660869293576392902 -2.7318125735759370976 -2.6533496865748547044 -3.9587252468187315024 2.7107658184945107038 0.93397149747146790411;0.330753641357874828 1.7468036343900401608 -0.82276822088342660422 0.9479034647096906685 -0.62256583434551948653 -0.61877409822854023691 -1.0685785947764252501 -2.0256887932662177576 1.5116603317030379294 -0.77448697956459422453 -0.91410118857371114309 -2.611409472700439327 -3.1434743666514690652 0.57579375745447847201 -0.42404791478861270093 -3.1826270707294419537 -3.1298660870665133693 -0.51951252648634516085 2.0332737180401649901 0.3630785436461032023 0.65509433061759303474 0.30031965931725168595 -5.9540821051806824826 3.062698651294357699 0.74667282781312416251;1.1521627595460355309 -0.35275422798979139127 -0.23727747133178986316 4.0685538691314206972 0.42819772621475771235 -1.2200024556711417389 0.11481667383712079733 0.56246316751460023742 -1.6662983119245953212 0.028412607898052572725 2.1630173799129539525 0.48397479592666464709 1.5785914035705514991 -2.3063921913153042631 0.72783700828620134793 -2.0978818398683443114 4.1726686598376403481 -1.487880323892161627 0.28503644898122704188 -0.61414212262061806946 -0.93798460130452143702 -3.7881737217578144161 1.5020576110921810553 -0.38271535893189745359 0.094357893179700808028;-7.1465868015425932924 0.10616891335751918457 -0.5716546997560720822 1.5363628339736983275 3.1576757145673903793 -6.9988612717200604507 -3.2426664044204636106 -3.2988575442968759432 5.1014124659873596457 -5.7300674107314222283 -1.2052087120754575444 -2.8905644628731610446 1.6738335323864834692 -6.9874192912778649855 -0.53919137235970926447 4.3572078480363192199 -7.298305358036964563 -3.1428194953624988273 2.3493058302461982123 2.404365411927949836 4.1089099715617036779 2.8812641489606125589 1.262128245412186045 0.3590245253024726968 -2.9595444732280076217;-0.054336185930480535022 -0.30350326366350866003 1.5943182437355525316 2.2966293374289805662 1.640129633171322654 1.1974987291545315937 0.87192663723957031241 -1.1847285080182772266 0.68630852443392531548 2.275825090991349775 -1.5699819260813285826 -0.71817567680594929236 0.17631865543644750782 1.5799173932954335697 -1.6465875774942706489 1.3401853141730013519 2.3205533574631780347 -0.24636674731007046635 -0.64301299223178531861 1.9476797974336521602 -0.27693586946093040613 -0.88220931074366726321 1.975040053502635784 -3.2665674732370466593 -0.049300153175251541782;0.36543066462039641706 -1.2377892837985418062 1.8617093772329142976 0.9808303064158724327 -1.0059866078179209303 -1.15388315083071058 -1.158319401317798425 0.9344989975935278359 -0.40951729364620259588 1.5340869268213372933 -0.94999640013251895887 0.45610830765048610003 2.0840358576615471975 -2.2009519601074756245 -1.2122765181262691314 -1.9607811648356454626 1.620161326529800494 -1.0857603275734051262 -0.026730155255983684137 -0.87357586859572444737 0.89253146043769493456 1.3008671045267305999 1.2055639218642528743 -1.2451741735087047402 -1.4968937763506853234;0.66554865785375927345 -1.9699922529067479537 -1.5585151634340206339 0.23197304790420855691 -0.34536078522086577358 0.66585522912132166784 0.092737758359649397066 0.037036027598010452799 0.034919354511401448637 -1.1798355227808883239 -0.8992893297729955826 0.689053683552083851 -0.58147649001084988907 -0.99823566021476339838 -0.56259174116674015576 -1.6468401068526246078 0.17623583372739140551 -0.11696187669649410479 1.4045946872735421973 -0.82953342615012848338 -2.0866400784135890056 0.57269583047260386177 -0.55508443988836519978 -0.016088398948747664047 0.76791191537698111347;-1.4302083975316723929 0.3912501860466580661 -2.4928104161562805174 0.492512963786056579 -2.0416431854370715726 3.4645685878983529804 0.49263655556803215285 -0.62361601138206357309 -1.3590280717632070573 0.59407138155644878541 -0.91265504887697779246 1.9156072911710120277 0.9481937107241682483 -0.42232564013476570075 -0.64759091718172057117 0.65099760469824652365 -0.35566312193644966655 -3.5177103254467989579 2.2512988693395414863 -4.0116121295824980209 0.1183400974628524005 -0.58333594157224766263 -2.0082561337908941823 -1.3805604110513758354 -1.58404586741373965];

% Layer 3
b3 = -1.1517177383165217996;
LW3_2 = [0.16518715207380499366 0.036879446050981173899 -0.0016331510355101074451 0.080429157388889060964 -0.0063490369634134433824 -0.29138553332448291489 0.038273829389875689555 -0.010113710705073171436 0.010309527515502474662 -0.0083984852597188790202 -0.43276197394379822825 0.013384170952616810876 0.030237822903556841464 1.6487008862024912226 0.0034644077968278060714];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
