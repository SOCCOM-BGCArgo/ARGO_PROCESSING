function [Y,Xf,Af] = ESPER_nitrate_12_Atl_1(X,~,~)
%ESPER_NITRATE_12_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_12_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.8585625652610273661;-9.713831833055269982;-1.9698194083063296222;-3.7001986738762413509;-5.6762079096664708189;8.5039190751984499173;-0.34765963656730597409;5.1459515222634033549;-1.5842787114186682729;-9.42588204234839111;1.3248794140831963162;-0.40728782903165988705;4.2381278364930272673;-2.7794097460429623148;1.7609126285850522642;3.1855651319806748134;1.2900558041059455583;-7.1911078048181407141;-9.3791166920629933657;-0.9137471015399607488;-1.3298830133474566217;1.2544933783243037428;-2.4646915202573738135;-12.653745290020065539;-2.7277081964334382036;0.50281855184011559068;-23.576837887113445191;0.77039384361259199974;4.7293080074657831702;-3.490069921213311499;-6.1453060895644027184;-6.4355507222098404796;1.9024059914023980777;-2.7351040783516782362;1.8897430288410572707;-6.8772141638176913503;-1.6025901886897770954;0.3588847101187614963;7.6019745293998175484;-9.2582599985938340836];
IW1_1 = [-3.8415112051807618343 -1.4015251867309972411 -0.048591916575726153138 -3.2304835431232783449 1.3839871420179350459 1.3401357395442692333;0.069036988080280539681 0.13061240991418174295 -0.086883134609381629243 -0.0088550047410207236021 10.252470116027515346 -2.5017799731576348954;0.54234647462280571872 1.2329051629764342657 0.19523014455568835079 0.7906974248591641663 -3.3928607293685422164 -1.8392490872152991166;2.1042388312438315978 -0.50821152731207330788 4.3595585495143929222 2.5054878117287882056 1.352656133816427797 -2.267821535797554855;-0.2988714752058775348 -0.20244473051727776558 1.995980113063837047 2.5253264599100537779 -3.1000430491868899985 1.5546056474612670595;-0.13303166260214363548 0.031487887052266967658 -0.061858833441804310371 0.095315748754884549454 -12.276141363284054364 0.95400835732653488375;-6.2245325778534654759 9.9404258847963369305 -1.9049820325124096065 0.98552395538142090192 -1.9096003675467378979 -9.0237152621726366419;-6.7298275501451723102 -1.6871799427777691704 -6.438594559711126486 0.82654892961028536558 2.2754989538135070859 -5.9589535562980184835;-0.1644907731114464422 -2.4517975044154129982 0.53175172473913123738 1.4695790601613765158 4.7506739208870802926 2.8110140966693095699;6.5369549531261146313 -1.9603940541432820499 -1.5471370104382489163 0.45012220783752970865 -1.5465248983151618223 -1.1205310149096090466;1.0426442906585411396 -0.45406642493415116935 0.2721193801344232166 1.2160999667618688225 -1.7969667752912641401 0.37570640384247289134;0.039600528771699373964 0.010992852870130740903 0.63534404739126126849 -2.5767826267764317727 -2.9666583275265709929 -1.1437147415147244089;1.9517939473691345853 2.143170010414536808 -0.86168151146614302416 0.48429588997507982961 -4.267538143251679017 0.049983269705522248572;2.6579590600615006224 0.24912835305881420034 -10.982736453876302818 1.8947227552114864757 1.0822316370106599415 -1.7888431910453634899;-2.6650553885115861874 1.9982870064750770656 -5.814660905341085595 2.2093852719848046107 0.35842870509815932811 -2.3042581124380250301;-6.028258774971081202 4.2696007895295942092 -6.9034532344983245977 1.690727187321803715 -1.6841939265928593805 3.378742099373985841;-1.5055599695126737902 2.3086514053425344351 7.3619772315720988232 -2.4904940488051661163 5.5817157074406882344 1.3642425275014000707;0.17405612161551112238 -0.037089876150884278083 -0.5883703355237306365 -1.0324450890120464575 6.1283596364762731312 -2.5829541964363205153;-0.1898528728945545474 -0.47937879455893928071 -1.8493188984715824841 -1.8856615588516925097 0.80543606936018530273 -5.8103325975578599127;0.33818623965725130853 0.0046185279946121711447 0.52821797652648438959 4.1127411284169195227 5.2007684704552961108 -0.81238212088057593085;-1.825054669631620996 -6.2484880907713522546 1.9043700657165880674 -4.2486262892474231379 3.8311380353343529315 -3.536597391441707039;-1.4040007143384918287 2.198062107263413445 7.648303140671566247 -2.5662535164259083764 5.6335279678116529922 1.4914423985540559148;-0.37818033675773615743 0.91887302181932484224 0.78108025857478025067 -2.3895074350586216205 1.6232783530957894946 -0.80010114539744059403;-11.172973432690506357 1.6256569436644057181 -13.32255977506909872 4.5224096675021927538 5.1281912240425926441 -14.403960878088911457;0.096401671879246988994 2.6083704346458160828 -1.4018235379752848058 -0.45071817853798812337 0.024215296702862570966 -5.1332675035021280152;-0.0047400188416097362512 -0.038776347386416255836 1.6105387765209195905 -2.7849061254588707293 -4.7428777341199959139 -0.75442412859254637247;0.34468355289490698601 0.24523107321220791177 -0.44369158859207341594 -24.69692226793243961 -8.0832184957448340867 -4.5078902451561573272;-0.1830371237709390031 0.30273291393648077419 -0.43239934484834108286 3.1473267371385880153 1.2109575378528643075 -0.35155953524679850464;0.74314343232496848923 0.41403848055236458503 -0.45256829769510081851 2.3688790357317048851 -12.890469700017547439 -4.8906441249959184958;-1.2312301234951978923 0.50855081024764881015 0.30239279803316537754 -0.43961579116723858984 1.224112152241175977 0.29199257713508652845;-0.46780332498374677108 1.8341013818476594732 2.5599290651805750585 -3.1870756540548930147 -1.6139752542473309038 -0.34302408870428857668;-0.4943298592500016686 1.8579242216689255685 -0.30799959308017510473 -3.487007400258408385 -0.25759432138412180491 -4.2746361567328339248;4.1334962784761257737 1.013372535143672426 -2.8951630179929597197 0.93215695452668889676 -4.8246001772955846576 -1.8014775129515614438;-0.34903155392863316475 0.94616408169843668752 1.0690890331959221893 -2.6834784182262101382 2.1327343226627131223 -0.38675404784083300402;-0.22120111245609846984 -4.9445719408822652596 -7.9282831965185991407 1.0201780422689756822 -9.5767067753462491453 -2.2618845275305452525;0.19299347374786302023 -0.049376491555797909216 -0.75113045139456435795 -0.90488021050795752753 5.2379144961684627191 -3.0082326351743375881;0.29445894966338981291 0.079007966698457138266 0.34717684056218733879 3.5500722502744133102 6.2155314648860660043 -0.47021594340263356271;-1.0272739063509201962 3.6392274066226510953 -4.3342019537719655986 -11.189847646813232629 -7.1901143330831578382 0.88206947674840840978;5.8575519047993411803 -3.1717321286856918761 -8.9555328197175860794 9.2405435017321728708 -1.4749194150137736603 -2.8317329772211619066;-0.25451862537182035062 -0.50491371094712655943 -2.0056791888837737226 -2.0043189387337005947 0.024859943801371537503 -5.9613677652725947098];

% Layer 2
b2 = 1.838952744401545214;
LW2_1 = [0.092724875083047691993 -0.9098924352492064882 1.0204347321815570027 0.077648668853110086596 -2.3858732670761839678 0.55161978218738627611 0.049158162537092139899 -0.075656215072730625959 0.21280605519605891307 2.6287737341238361921 -0.39651214432846942914 1.4411935046044681563 0.19969884480426519646 0.0997713077639963003 -0.11201292053409253602 -0.031049563702764241407 2.9795351127330187424 4.032953050880626833 -4.9888132886607241545 -2.0662476194085916958 -0.015787624047058135268 -2.8979008060317923423 -2.9296844394091383634 0.029441752999995487311 0.15855659912830377678 -0.88070272053090359332 -0.17374651041466843138 0.51916228329894986704 0.11238579172818873031 2.1630650463966243358 -0.27100278909731811972 -0.32108497761878157517 -0.10615448694446866229 2.5456071642228779162 0.1029121816837050285 -3.4848436365469330767 2.5530707507896108766 0.046388894701534240383 0.048903247216202809511 4.7500217186372282185];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
