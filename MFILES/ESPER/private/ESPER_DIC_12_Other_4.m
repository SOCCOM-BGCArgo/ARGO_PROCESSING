function [Y,Xf,Af] = ESPER_DIC_12_Other_4(X,~,~)
%ESPER_DIC_12_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_12_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.73816093921350578455;0.91651570330412823751;-0.60793718988864819952;0.68998124778735414608;-2.6601215995467066833;-10.426271697120943927;1.2777291376339654505;2.2898033875792758174;2.5297274517481000977;-4.5343967363002537496;-1.8614133384500108903;-2.4924159300142827433;-3.4865266688812197593;-0.13000982045526776609;-0.10145608445896796279;1.7028587216199220222;-1.6015272556719397645;6.2195050105388425266;0.6336911302077233854;-3.6250201197402902586;1.650186468524174499;-9.1924735133728834313;1.4138872116264435963;13.569645894034014333;-5.0928434760776442047;1.5026928122991840553;-8.0966287307850102195;1.2273384110687908244;-0.15019563422380105555;-5.0427221772109032116];
IW1_1 = [-0.021978488085846941552 0.014457821754524768226 -0.085376186535043627202 0.017968272591556089246 -0.11392490492842849426 -0.0071966720728429533355;2.3448183402795232944 2.5767006899308269041 -0.94026215389294454106 0.29015980171729915948 2.4424868269563386747 -0.28874800668571171114;0.66647817620213922751 -0.47323652432077523144 0.27282954416288768273 0.60098600432812798733 2.0366513427843426776 -0.65594086383577632215;-0.26202184104971248946 0.15611441345414184267 0.42317817233006194133 -0.3576301647111913562 -0.39699648430760059448 -0.03696503787162238458;0.24738949397170431621 -0.54805177984186104201 2.1552427895788071055 -2.5400443238591030592 -1.4419184121413928246 -1.7484085215977525074;-0.13601914939018230899 -0.12181926359296858797 5.1405224225257626358 -10.981085170066423373 -2.9597218311702264693 -3.9473465007267138915;-0.77022878338891609395 0.81282707933690911961 1.9884363189910398972 0.12556879522958841466 -0.49620745695946794074 -0.33454393132704984826;0.28575526090355030107 -1.0036852207391395719 1.3060604848106083242 -0.098638247880885362995 -1.2461001415772676726 1.9662339508466684102;-1.6796551837151103559 -2.3465110521810128574 7.0238905876074149148 -4.842142737465482405 1.2304908856811247464 3.1981064016802021044;0.19700555178244577581 -3.5937981435760089077 -2.1054218009761327401 -0.5867149050087205886 -5.7115226400783498661 -1.6050470105367582452;-0.826517154592098513 0.3898138223944260794 -0.063321173154958915186 -0.87905369546431610939 -2.4206653181558297483 2.9626317452109440787;-1.8057669386834005465 0.88569784470180235036 -5.5502573277396773932 -0.7222655373156448011 -2.3716143494725430152 1.1734669460791313789;-2.9470772848839636993 0.77797963175867757002 -1.8236497644262148476 -6.7477250743268770705 0.083296285252162483026 20.901216946859026535;0.083082172518611357992 -0.042519292416821730107 0.48361641279281680772 0.12921747568724750721 0.12054754772128070672 -0.82580330912755439687;-1.6888906497734323953 0.61441680188340286328 -0.43845210743517304408 2.7132973562866307127 8.4061024502992029994 -3.9954733411530574116;-0.17436317081151378461 -0.045417706561022265499 -0.37027207349166346706 -0.17256027332743864577 -4.4074249969270749006 2.0591998094194989832;0.1461434467826542849 0.041663160856192697767 0.42706528432701112985 0.5055493921945466429 4.527887740990310661 -2.2752672927366610622;2.3707251667929276628 6.3239830535249890175 8.4864344853309798822 -1.8287869780845869006 -0.21684813503589703276 1.087673820488880283;0.041546142458703354261 -0.043717900305749887724 0.1656693211171598179 -0.21930331834453825612 0.35884407148607971871 0.31484992295599928402;0.22373097305093528342 0.09555886309941104273 1.4071723485573264245 1.1506299447692087679 0.062461237617094093888 -3.4036510493480607309;-0.16626836964220928494 -0.53260401750231312068 0.06193235766767802436 0.19190525970744121143 -2.7207814941199592873 1.3982421221440155534;-2.9298697546983039075 2.9664892305017698249 -11.280452236282732414 -11.608011179872676166 10.181639060399046315 2.7058850166047041519;0.46784659925956578741 -0.20632538347137180379 -1.902485074987072089 2.7374668495148499758 -11.543569300411608225 5.2636853918643673467;3.0911208257917395237 -0.27815711960309930095 1.3927184057774122383 -1.6775158617062568833 -36.181031579966116851 -4.6517669566691601801;-0.60976464175423739089 -1.6110468753976014966 3.5653859483688519205 -1.2379695822113325754 23.256338061976698839 0.40543211289155950405;-1.5803498392960941832 -6.6561355805683790621 -5.4540866577028799256 4.8095386407769087356 -2.5994137518477180571 -1.7430504079289301789;0.034519570234056273783 -0.17545378557930657593 0.29893069168400421276 -1.7955591542296676089 0.43825538000336861089 -4.0073145132299954341;-1.1808449207679512227 -3.2977502137881851141 -0.47741250700972587273 1.1356988737537532241 2.4393217148383028459 0.83158851504273445521;-0.66366611070303704878 -1.7459541033640970653 1.9266905416170037046 0.088083632726770749732 0.90660718478432900103 -1.461732616500410753;-1.5407045256790850019 -0.11546116438983930474 -1.2001156074100676197 2.0100275863919425667 11.984540442753020884 4.3439820336870056394];

% Layer 2
b2 = [63.357432747976844212;-13.907873889674537082;-28.974607950831870795;-39.505726407960501945;-49.069419246840155324;-0.26071465291749990056;11.430642283261386538;54.560322686699819883;14.483262778192264264;-22.143425193170088505];
LW2_1 = [22.636536378704008143 -2.1046362550125308211 -11.948425186555709843 -8.3960597647915005126 5.2085272288468660307 -0.21360537979924326679 -6.2152671672825574589 -7.4370663445728624197 -1.6145001051772862599 1.1706703195099377179 -7.2970076681676818708 -2.3441312544575638732 -0.50622412309530917529 1.0623707488267033483 2.4483443183299966606 -7.0723455989162955504 7.4833345217241546976 0.3731483425523365316 24.451592585889905251 -5.409318512434590609 22.536912209508809468 0.435831872535949294 -0.071737765483940466038 -17.872224546398527423 2.6735512477698346601 -1.7035396955956434439 53.39205138990075028 0.32675952379875000675 -4.502783029463340192 -2.4996554559098376203;15.539369175181843019 3.6689864820129587386 -10.594111577971379035 35.904892686151072212 9.400007042249818312 -1.1195261022253586436 6.9767376789706485596 -28.572559014251503129 -1.0422441360105372254 3.5319277502775410227 16.09533545543943589 13.882402908443207679 -11.014257545529959614 -2.6289970955424561971 6.2538128535570605138 8.9399794413809203775 -8.9925503227402057149 3.0447920111956596756 14.917235333171497302 -0.58549435494388457624 37.078039246600688728 87.942307534681916081 13.520625391259496695 61.146886260115678624 -22.335915254399555607 0.0028019127037096519008 5.9083798160790328424 8.3532884002005243218 4.4845646094503939239 -0.76522035684449651871;56.574343021898762629 14.918820568555396733 1.193857876303356047 -13.948487030393676989 -11.259467937167233487 -6.9300266835449848557 3.5622669299916118746 -10.869852085864474489 -48.928637025460346877 -53.081286773155611058 -6.5830607535289802357 -15.155960317895745604 -13.53051172274520475 34.3740320675003872 -36.441601055807623766 14.723738241078939026 42.418731114349611744 -27.722719323706812133 -2.4252931221620186442 1.9153634688858294233 1.0635761399597802868 -24.472018684146821244 5.5689672387945909904 -33.762084890116376812 -2.5280075933632017993 -6.8790408965554767917 -30.442267669828794396 4.8948072136308118374 9.8378936540604335903 -0.75417144229303245684;-60.243600877025961893 0.032695602042392725439 -0.13501880591583895197 1.2164031187404673595 -0.17202634206505657 0.10746806607494162333 -0.23494412976804654458 0.28463142728164203543 -0.12474113141119441694 -0.043135504709479764729 1.1650378471791853485 0.14070820784229601252 0.038198607313211459247 -3.2163407278630922193 0.05246665383298766 -1.5075871708000412319 -1.5030537785552855468 -0.031786182317087463556 -11.736981883733909271 -0.29098062592845458374 -0.022051528190288206127 0.028809302761868105236 -0.05530417501826355442 0.00031187504179532884009 -0.016447749911639934772 0.033841254822082292297 -10.478313113369761567 0.038686468069256130242 0.062558289220893903426 -0.076236876994780475303;-2.4844614223580863133 -1.7504839208474338719 -5.7564453587646511323 -11.525287923239257992 -2.2131424248540123578 0.97744025327936412406 1.1154164615822428352 -3.7127915842722205575 -0.04413337527936931487 1.3396888072434465222 -1.2560707771126800036 -1.2219925881552120561 0.54135263421749435508 -2.1517887801392290292 0.85714859598004933261 -8.1995916132019406319 0.31631504722524322881 -0.067363671498540264593 28.202274034414948289 9.2066777134496309287 9.815345529431354521 1.2167041001130267652 9.9718509351132365026 15.940639459090251151 -0.33493463006469675891 -0.40875558318655658141 -39.811398435056233325 -1.8853287618343113063 -1.9449004450232514341 1.1297275082518301037;-103.77285611630405526 6.4165851048795969902 7.0260346236112356522 7.9058878823578782047 -5.8740237480180947927 64.738526025569512967 23.983609892781768025 28.535895336767726604 56.524950264187381777 -18.175956344403900289 32.477022931591214672 -76.615066614494267583 3.3533882319243835113 -38.784986340002852501 64.050363072393082575 41.947834552350890647 -34.828533165195310062 13.215094890085678614 -42.080799351948321885 52.253513480873984065 -24.925679307920653116 -67.81233265772918628 -12.705487759083357702 94.620083066017272699 -18.266692732222608697 5.9573349303343157146 42.814090568755297284 60.450402986566842856 14.3380143112959626 -6.7736287422615228948;62.548777265147606386 -4.0313584260112076407 17.338604236535211101 6.1404928008537913442 -35.861971377294885599 -6.2319578289249770719 18.697808209412137614 -28.558436582972792195 -32.175319036368449588 4.0957149751395238724 -10.62135074130187995 -3.0461827013293145683 6.6872697170274966183 10.185948568971106454 -19.231947888416538461 38.504760995965661152 11.178606398892794616 -2.3620199573376483571 -13.863826093005579665 52.355997255514367339 -4.7224624210332128982 -0.28300542756820806778 -5.0472588055917775307 24.921340752880148273 -10.765387935509458828 6.8068483953399017139 -48.828077019743524545 -11.665322820369453893 26.894571794275478283 9.2059554142573958302;22.373821242968290335 -33.010686110762883061 -2.9969515547700775748 -14.813614405587236078 16.720037725717332933 6.4831105500927046492 9.7265393736310379325 -7.5323834248936112346 7.7783132339930132204 -14.694377455897578599 -35.321768592741861426 -50.717605641311642728 2.2741052890364303884 4.8948144489145537506 -37.871507398017790536 -31.123366576755543633 23.729661784337707786 22.628879914638460491 -79.693267473166798709 -30.973371727271572951 19.492351719567452051 9.2049529472818516496 39.104370368117194801 64.068040766591337842 -21.891599779186481811 10.496549106598278556 45.846574562344223125 -117.8364533545310735 38.376930519844847822 -18.56756543450373087;1.2388067640433955141 0.074681996415985940629 -1.5341487523785832803 -4.3499105325988347559 -0.66101093684677836304 0.23657805600920669975 0.10397020239984811063 1.656663635127022749 -0.26895799080330196063 -0.022850248750903540823 0.051005126501064951272 0.65349681529122738421 0.08975941054716943257 2.4873712005944201842 0.061787614476391118645 2.2906114791232856653 1.5498734054998579701 -0.041064930060221889463 4.1355572391499819673 6.6049836680933227129 -1.2073831928374001432 0.035538333186578001388 -0.27373576936631799361 0.072866994877109486639 -0.16713452779251231073 0.085268077608701919878 7.3353106772192608886 0.075887097881586249026 -0.033388878699280338802 0.27131539888200206789;132.94973694114452201 -52.294828161346444517 -31.453011814111754063 10.540941062143366125 -42.850909992981307539 -37.664040948367620842 -14.767641954107546098 -44.481684190452817518 -60.519441807209922501 9.0923103442888564274 -18.401154859834598199 45.173592716181481421 -10.361708026601833765 -46.855217511246330275 -56.930231331820607465 -33.692335237224838806 43.913319496159900268 33.103459859075734073 15.036151032031378705 12.440564875268734113 -58.681874318154726211 -6.6530836910848059063 83.765271586421192751 5.992085185866955932 41.794244034289810941 -14.505954625801447122 -101.34742565213885257 0.074142895594106791868 -8.1678068682866236117 -36.480107214771514634];

% Layer 3
b3 = -12.508620006394862045;
LW3_2 = [-0.026719974523372207187 0.003776360211793564764 0.0070652155868382755799 13.508678278097653092 0.030661406413485411265 -0.0017749201553773708354 -0.011083412608421609052 0.0034451001862380618498 -0.32833493206442915247 -0.00037341878184402038784];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
