function [Y,Xf,Af] = ESPER_phosphate_13_Atl_2(X,~,~)
%ESPER_PHOSPHATE_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2818462371268406486;2.2628279157937303268;-1.6932817538921289824;1.9438275277747096847;-0.83378446760258451143;0.10506662909829313224;-1.269961195325624681;2.8106227180011353894;-0.43158512751688321574;0.37814979956725097709;0.62412103397612761491;0.095524258922635968405;-0.79020544178877394348;-0.63119083592326896692;2.3811435561351443901;0.18757221344795077522;3.6268715241649971404;-0.98686305133449514493;-1.2622516400868994957;-2.6953124907385523912];
IW1_1 = [-0.77764300826643451003 -0.32043337934652482701 1.7830400489211586379 -0.46418514931141735547 -0.28734276856571083769 0.78947770075461853878 -2.7089566096382631244;-0.566725160026686825 0.27087570283737266719 -0.27484704352147032447 -0.029621198302815277686 -0.15629169928387456889 1.474011393990037444 -0.44020786300054692841;1.0918723332984601182 -0.20981022024813705817 -0.9472687237466302923 0.70911148029142445637 -0.16662984339989059257 -0.57369068940142142754 3.1819616421786420801;-2.3954172481714253173 1.7123787390501943317 -1.7856955598447479261 0.53460132375305924324 4.7091367122195801898 -0.24414254960268161332 -0.80775103293706906893;-0.0097501421982423459867 1.6595872830925493258 -0.80831534130108040337 0.62395587798417828651 1.3458407762414508202 -0.3070227964578740032 1.0195110179669315542;0.30107107945974309615 0.20692998837531484391 0.38413288871378092892 -0.84744661855443437215 -0.88133668756237315556 -0.93632263033518392525 0.52474872050486620623;0.90594671965760897869 -0.32262842008993913856 3.1306267415905812967 0.046524918829505219897 -0.20582323877343050578 0.98965332065774935799 -0.58524119354955861372;-0.14069299953901501232 -0.31503703387916115464 -0.25048578259874970664 -0.19765125069949229797 -5.0858692301345618247 0.61006511757497294823 0.32694327742911727386;0.92826777307603158818 -0.0084956043181495920907 -2.2883384052991435631 0.31410131361053328369 2.8370038623177151749 -0.31607840367305534146 -0.3863565298963528849;-0.6798997001051722 0.28282714260034375053 -1.0719944904444518308 -1.8658768019848330777 -3.2997608610604989288 -0.27724479815354013956 -0.70633712045268892687;1.7232228050881768233 0.34086599588097771241 -0.054288816516621547781 1.0587748437987054562 1.1858388573043274761 -1.1560004260278446964 1.0600266635512696212;0.061900277659601550539 0.5383953930479260519 -0.42516753881149826899 -0.27272154252921310125 3.3976033383963999412 1.9839883319886189028 -0.30108282263589186689;0.3315435512261538098 1.4436592004523689514 0.031646999764092881291 0.7695060751997075954 0.51175048292795466409 0.64167093681542242134 -0.040446200951663291434;-1.298145426502787636 0.63598377022621077614 1.6209437124413599296 -0.34586737828424901631 -0.90333855407970931051 1.8454967514972024922 0.55947739426425469045;1.7409628500981568777 -2.1052225190807778432 2.2069754882403636032 2.0859009386198912317 0.73254310597470684296 0.29982456787395456166 0.26066303009002272928;-0.85459782019753016691 -0.21237003939439266786 -0.38378021888986768584 1.4761567749718669251 0.44367511708377860291 -0.43383207392170008987 0.16509275111023385962;1.6264556387277031568 -0.19584800956685444184 0.1972457184099279115 1.649065958533538323 -1.2812360237534878848 -0.87416468978871619822 -0.71046691168325815102;-2.7097863489721571995 1.6332044848308553409 -1.3559506264881213689 0.024889929238025933905 -2.1062573629772067818 1.1021181218131059776 -1.0725241623522310253;-0.2089302803448290502 -0.52794919840975251812 -0.49265230808162346898 -0.34207272275978556353 0.33829155390143667015 0.94525923163144376371 0.13785261360938996789;-2.061699049518880944 -0.029773876470879589995 -2.3768223216502550876 -2.6248529150756865214 -2.2639366275699988051 -0.84819417662633134203 0.47979628480843794502];

% Layer 2
b2 = [-2.0035616224173420363;1.2747346227328355539;0.92283946882577871929;0.28854987988648572728;-0.54940708102949487035;-1.2743635496776157812;0.19400280352081156199;-0.065333919792847083841;-0.095490935210791771937;-0.49019517577900317828;0.18576323054773943855;-0.19383161777741336751;-0.99931865110582840384;-0.97980817973894218653;-1.0916357252036243963;-1.3354862855595261983;1.3322527321026120806;-0.73567787431641018525;1.0957450980893050918;0.91110255186360022961];
LW2_1 = [0.41735961998891091262 0.37934820634280502771 -0.060240886204158385075 -0.68757612139124513195 0.43912144520145329762 0.43615931631108906252 -0.146415124635766003 0.14985022379128376535 0.7837132660084378255 0.89529971747271097637 0.63298971365524714372 0.75139686845608444354 0.24222736565007724208 -0.31331056388937417179 -0.42001908282147926155 -0.31156273372846238212 -1.0611503494580056817 0.2171798391370199921 0.0073573486277152475021 -0.60897403109057779425;0.13035050289111674293 2.2629220022479721308 1.9608866080022875344 1.0084654357232105681 -0.6291521884880554305 -0.6310159492443031537 1.2357855799891588333 -0.38341411366791461335 -0.1041361514932515886 -0.18671841072907380266 0.72602326444961606811 0.39712128572726157483 0.52653859264067059964 -0.59852656724254005294 -0.33641762484918080744 -0.34134549623039900368 -0.023935316401341912712 -1.470077581131611355 1.7613429743147015483 -0.22777820031153128699;0.053762810370543361038 1.1917698534322238579 -0.86708286066199846687 0.71830690369571448262 0.41370908539123341097 0.40782788631152716574 0.61204132830812441046 0.82441634724922041588 0.58912200364975786382 0.73752506965719011323 -0.67992998545697835855 0.76092182090801219196 -0.45037191095364925708 -0.50825582135631219849 -1.069444123591358986 0.43708852831505246028 -0.41516681444145087099 0.63664383839381843977 0.75246389342421760027 -0.27955006040764918129;-1.0913475237385381611 0.66395373492509912605 -0.5689691900468619723 0.67337687381165045597 -0.55477322591424671483 -0.86207134640727078878 0.094297877544171904152 -0.59675541045712710009 0.35185626609809828036 -0.50460188535639705076 0.54095471146723361766 -0.82587366714383925181 0.1539030808234067571 0.42138203687286329702 -0.15201688834275331463 -0.18379716581659863439 -0.19013187700701084104 0.097132428817512300734 0.31756382963597534763 0.42131210188373785508;0.71314633542855121462 0.56860761939834281176 -0.29981294877135344912 -0.83353809501989484243 0.46116111032042345075 0.56750224555796713322 0.38165923317155880934 -0.53832251538373709909 0.10105267485296980101 -0.62794520010432453017 0.73624211954268314884 -0.74727022690431255114 -0.20701422715842635047 -0.21213756335800865171 -0.25178495659543315144 0.23216610828708367231 0.40461472258887920539 -0.68324989802993352228 1.0247434635710377382 -0.6988669249242662751;0.92788199310649666085 -0.46833863357406374517 0.88147650559060908293 -0.96456290847995207471 0.22714416502954706822 0.95977529458981980515 0.12028317829724631538 0.88128781142614009969 0.11919089127286888741 0.59475303123297817987 -0.42595252894742130501 1.123415462425403577 -0.25755499165975254128 -0.29861549527778530333 0.81251157561656828232 0.15355023678917398278 0.40914582320091330558 0.43667263555615637438 -0.57502810097180123705 -0.53726325193369217637;-1.1758019631479135203 0.19761343962616090275 -0.65301628828243984959 -0.96061211402144541793 -0.096572282302913911578 0.10585584040346181223 0.046373528179554077133 0.11822094882622125045 0.091508525268207130399 -1.1125524854074122505 0.25213440611803067393 0.8571003901130044289 0.30893926207495031599 0.68639991103531305949 -0.69593948750936562853 0.32063621108006146176 0.26866932135358984057 -0.7637905939973299585 -0.03005301885163976644 0.36976069812699552397;0.20942188953448040434 -1.1831839497671348127 -0.5705402987141769966 -1.8365194806015490148 -0.20325151744402633613 -1.5561839977399527513 0.34437986594531178053 -0.11037932740327674463 -0.59817631668578574722 -0.80405330413277154022 0.77602867605238357029 -0.86189702224379072248 -0.69416376269234980612 -0.63239925280789566209 0.63715264578100627713 -0.24207698555718468181 -0.8733301163236617537 -0.50192608287024287339 -0.11268785832572683625 -1.3818283483890765329;-0.90918660368855708231 1.3561214877092739872 0.7295418154684215617 -0.72427164947086897229 -1.1079496704899678416 -0.51287628926556905196 0.87304483464484361477 0.84582593796486549298 0.63867177421922305403 0.5072546002876079374 -0.38854310883123133191 0.7225134389475412755 0.44433135771970899697 -0.52070459063855545345 0.18404659014167831788 -0.20056646560841562277 0.89347953500323062936 -0.20554546103160631354 -0.19816340487586545094 -0.27346644749691928489;0.25435504955856463871 -0.16745387720174750856 0.26361562666948451517 0.34580516587556681118 -0.12338005595267578784 -0.21664209371246517799 0.36780908762457287242 0.78329420194637844332 0.64078219345106979254 -1.0334512709205565528 -0.13932867807846993635 0.42896239147634701583 0.388462581948802399 0.72487757524516205354 -0.89173001084551717366 0.0039748702826394068099 -0.83063872018000239894 0.10613949879550041433 -0.52809047525328089989 -1.0864295792584099942;-1.1475461534543649478 0.45353372013826775966 -0.4642061703147675189 -1.2418126271077667422 -0.19267641262713683381 -0.047863734369152893811 -0.031564067793797362382 -0.57882192941467291991 -0.35406987331597150614 -0.97152350465757042475 0.76792456851467261192 0.40688886970757293104 -0.37129319601509142013 -0.53252785996208684693 -0.19980307635672531208 0.28093792312553966806 -0.44598347602085308683 0.35146412544975497161 0.82578639350656657392 0.22832320381321818958;0.23706924547431790229 0.98219858090364986491 0.27085890309305449275 0.42377743476884793816 0.79805948979032381718 0.11696338576669401688 -0.1689374018931850685 -0.62945059226459931789 1.3335225069594009994 -0.92754840582695918805 0.48119611161239272956 -0.71843062589819584041 -0.89367362774382164137 1.4224637663740706817 -0.048552300531950885742 -0.15421004678621841322 -0.77914516502766839601 0.13759906073531374959 -0.22106683675683699852 0.080848920818404307331;-0.66100499477421992278 0.11379726895825431621 0.0011003321681691082858 -0.41989508685845522429 -0.0079724307470280530996 0.87309500034944553803 0.034448140567013466051 0.93611002198351622727 0.46094107884457935498 0.67264555200972409033 -0.97473250794111587769 1.457618006353725626 -0.39358270545068313462 -0.60523405970343346905 0.47863257128937769513 0.10448947620967473371 1.5748544810433942054 -0.18402464077744434823 -1.041444936819673206 2.2065982123986729313;-0.58712122323778948019 -0.474648493081437306 0.26620346786294907249 1.2274500124610743246 -0.35212671632905045982 -0.84515643856181998927 -0.21974376692009409129 0.55347267362881613639 0.28503211950769186123 0.6448716597750164814 -0.86377901338891394101 0.95029091877278681899 0.12963135077390766647 0.30858216287271034162 0.026549837170248863361 -0.29277347250889029784 -0.3514019150103093736 -0.083564195265612956076 -1.335736713594568581 0.45090985676507411295;-1.1527544364284521006 1.3201508945344806456 -0.58871346764121057493 -1.8342547394782440229 -1.0261956419482860525 0.36835110227922990278 0.41699095053137102962 -0.58124357675329141326 -0.47782305777573835792 0.30114356857754920327 -0.32897708729815150486 0.77562433136812314327 1.4340264977915220257 -0.10539997442994721022 0.72320359972099779178 0.27067872247773722139 1.6441807923272893088 0.90736843537216160804 -1.7178769122070738362 0.56757316896078835455;-0.63506789061050294976 -1.7498991898775928533 -0.76234101972003687209 0.63574450605880483689 -0.23313764668093261978 0.26534853648431211415 0.42645034595593583893 -0.58430610542081184988 0.46247406200248608599 -0.43600364294095977913 -0.79536916632393739324 0.36343644012526865605 -0.050910962835118006575 -0.92160517112444650945 -0.99183984073059816566 0.070535735673823735103 0.60480341225564970831 -1.3894547280753823948 -0.29941621666828266424 0.85156023234513544828;1.024369100371508301 0.40464516625631752333 -0.16751516262478666208 -0.37140907431239122971 0.43072078103605770938 0.43304017395543148439 0.049033905218426265815 1.126472461093066979 -0.19244866232482971125 0.63251648683906058768 0.15702382327024902442 -0.014705434158149191526 -0.49386997932386200727 0.14843497510158326635 0.10144406913439407703 0.021340542501618559729 -0.068644552619595053389 -0.7567384650089375997 -0.17383367052961462562 -0.34410348853619809883;-1.0358756820178705027 1.4745461889016373558 -0.50202685134409708034 0.59820282820478087871 0.91719653388873945143 1.1113522769523320743 0.70140595740980771211 0.62210456983376594131 1.0931265806542935781 0.95138925016047104499 -1.3167912576410705228 1.3217938151189831952 -0.63113209108773915545 0.40574191162521178189 -1.168488285488332501 0.51362744155882700259 0.74331685254667756446 1.0610564628170484625 0.66962250445624160733 -1.4985425107641270337;0.37378009605004086646 1.0543559887080709014 -0.024068050755406831392 -0.74008371733878342003 0.0747106652229089091 0.74183142779979627246 0.3049925080176216774 -1.3657703665420730665 0.13182704373968645584 -0.39637729048180969649 0.6586374008537648761 -1.5355765172523012652 -0.49283751368408090787 -0.23982994477978264447 -0.32392452370394325678 0.084803914847279629474 -0.10134642067233307072 0.44434634589471810884 1.344847787598293154 -0.766455962888734188;-0.84589734668599481093 -0.53411589852700902536 0.47896707934415799768 -1.0709369558852597226 -1.0032693964816499221 0.68960792652515501278 -0.24902279052526898884 -0.48980844209119289712 0.56408774702666608647 0.34256590073816017838 1.3446866871133866805 0.51936656171370942925 -0.014320593884276889077 -0.028245835407448197096 0.93512291309177053567 0.24614069864193260928 0.068444484002636654663 -0.0024114245877235266496 0.56609994635703142496 -0.59363003833169525336];

% Layer 3
b3 = -1.3108680939187107306;
LW3_2 = [1.0696979384762317355 0.97318422781735614002 -0.43801376694772092835 -1.8095619279719419303 -1.5408215028444234296 -2.0634496175008387731 -0.91822169899727679176 0.62220404186278133185 0.44299272403749029303 0.85124827171267036796 0.79818210790071664196 0.61447682099542244583 0.79325414799874593985 -2.2522176706733634255 0.31700301144598103109 -0.62458538220057413515 1.1667697485086856446 0.31370915288849371416 -1.3694416373654281216 0.49186361025672797886];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
