function [Y,Xf,Af] = ESPER_silicate_5_Atl_1(X,~,~)
%ESPER_SILICATE_5_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_5_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.4438778197721058305;-1.6357325306305727786;1.1605612506175166931;-1.3647922400261471854;-3.3706835399667318676;-1.5240115353340291104;0.13480179893239091493;-1.878038718191480827;0.99829954928538022774;0.89339542350705036799;0.9577023828465784927;0.53386770754184109666;1.8241437302130989462;-1.2348168351046771019;0.78255550329091005946;-1.078208848360847405;0.16884834933921211153;-0.68767411797007649277;1.1383594809498092104;-3.2636595868073769999;0.41734080321263539171;1.1768491806979999303;0.37578417231600913517;0.10142419661583418344;-0.15735642705143759734;-0.36575453995547008157;-1.6526082018450547473;0.26494056339128174704;-1.143089417647036532;1.6409951068318306966;-1.3553183891975792985;-2.3965182582785837795;0.60980707279397561305;-0.83076208062172818281;1.8732605064823570906;1.8732711425327954746;2.4312741431835025452;-0.45268330723675120897;1.0255669505424542809;2.2776677190867697931];
IW1_1 = [0.15886089612772999469 -0.02975603358825590003 0.66715408450185698097 -0.52559040777805654532 -0.95346178934814895811 3.7615884958226137869 -0.59075221739891925488 -0.2358642694993564326;-0.0061126084838019935364 -0.0077976792187208999671 0.41578580110414570248 1.0203201654713436319 0.17339657607271455331 -2.1431308773242565557 -0.11112126500117364136 1.4793195280678594905;0.53770033719334453526 1.0178345877100134498 -0.04198977236056489204 0.10354524899570378971 -1.4551837138261489724 -1.5771599755198055792 1.0112126272159258633 1.497194236741638651;0.24926658196925488564 -0.24536971503445034748 0.58043357071752210707 0.11451899911734080006 0.0069598733389123037044 -1.2214926269289940741 -1.0776090016340547084 0.99571369663165543162;0.86040271556648828533 -0.35939716701295137957 1.4297199384067913464 -1.2636343767176041464 1.1131706628880231325 -0.27897821795006055856 0.53343787280772569925 0.93718148812776758128;-0.045457331854714615182 -0.56998583975076688724 0.33597791083154937564 1.347392177616647535 -0.057280529123236854916 -0.32361301998691671677 -2.1792686285653610767 -0.56127602754388916662;-0.68922121532879732086 0.45324794189351763629 -1.2962669508102717675 0.82939197411337084453 1.3842658439054946751 -1.0713567701892565687 -0.47870528049345084654 -0.6253729703650906524;0.63723709451310206475 -0.37303154793167703218 -0.4535217143900190373 -0.84708691908309929897 0.38866214709019197837 -0.45525926519789960967 1.5864861444095310627 0.51245147137696545059;-0.043133306663608886322 0.041120951553273103751 -0.85919774083057354197 -1.2524175127259649098 -0.15262817446770113317 1.4293789989545120367 -0.091021514106029405289 -1.9698777521501547039;-0.50935543846810760193 0.1361815177569604407 0.81012667366954194126 -0.9978224912535842428 -2.222146539315025926 -0.32726613811923382924 -2.6439355778343944792 -0.27973379133705478239;-0.98560377572900059739 0.33177591487400476256 -0.37978686626397223369 -0.96189292643992785337 -3.2999791510004885531 -0.36025931342973344096 1.3754366850567563141 1.0136165284078624271;0.12964938858269631217 0.102113385830374645 1.3460057935706628562 0.88456680584445479543 1.7846020739173249492 1.2097127769506399453 -2.385764914148562621 1.4201092859720145789;-0.59404610413798175639 0.084472412185914627636 0.10164401398474312566 -2.1052416744810713567 -1.4110132180530690071 1.6306808317768761718 2.3047249834460239448 0.89873555998666021516;0.6061411693013500912 -0.57067225842798940949 -2.2759469537139613848 0.23837837805595399332 0.21176514011901426127 -0.48321033259380913316 0.076161134086162304846 -1.8959337406243881308;0.16539962048788431348 0.069286001327487939383 1.5331121940717784558 0.014125158364181685314 -0.66541677542930022238 0.4301926809903526272 -0.30534044762146977936 1.6256616176153670938;0.098389821855594222777 0.15349897011419483261 0.06502680468674389147 0.3860527047919731225 -0.082955572192267471032 -0.89778628073488631056 -1.2972548180262768458 0.16484660913125612214;-1.3276442934176837518 0.71149504940932384311 -1.985557521358137123 0.051662202929556165498 0.082388290800304103678 -0.42337857058282268863 -0.066208933333929881337 -0.282399997640599143;1.6990781155343157582 -1.0927010804947931977 0.52498340875522686577 -0.49573080212087672347 0.10621202720134437225 -0.17445979955803911365 0.43002516996344630762 -1.8828164328042766851;0.74401756139492991604 -0.34581879737518195217 -0.086875389058399601905 -0.51242210942698429577 0.44666815668146875318 -0.98325810748183151144 0.0075594555348931901512 2.4980635428491066996;-0.35472615693815801041 0.085200978089991066811 -1.3296964685732799438 0.55267449787504441261 0.97904949392327655922 -3.3380915842086409384 1.6327452547906544655 -1.1427366343244460545;0.58885210237538021527 0.98138779288089195152 -0.11265274110558279319 -0.37082234983892631286 -1.2005709691682628915 -1.8073669029029837407 0.91316586827455648034 1.6245176090978121763;0.46702336745443218113 -0.092665671722701903334 -2.1047994190013064042 0.38866523640277994556 -0.11949072386796150136 0.53994167672518533774 -0.058367705088075830244 1.1377262889403507717;-0.78213089680208081056 0.24320422960864676587 -1.4150910599409980417 0.67042985504079199988 0.22834716578088293248 -0.0070610887702714612846 -0.023864001783957297653 -0.51526248833396492977;0.43047421373393668365 0.14255734335377087674 -1.1793818975072252186 0.69300767000161189735 1.4909578914480148271 0.32190148886287728303 -0.39637961363224372136 -2.8520477168505364851;0.61165759881602155268 0.28948696899923415105 -0.69425745866254628957 -2.6250380542656110983 0.25459162615216807124 -0.74922080068341734282 2.1772731495890256248 1.4078783436936164186;-0.40129704432561713601 -1.5567293060528386572 1.4940902960850532821 0.82478351872976130021 -0.39222320311840991325 -0.70402241120206365821 -1.1171037684618361219 1.3745378445533995571;-0.69212163053884678821 -0.079221027813208028112 2.8624127437773685401 -0.67390682767770637707 0.66831471104298378894 -0.018747308873305616045 0.43512869027290490553 -1.044071686884123995;0.97663276318777891838 -0.8254046281845496269 0.76044881666758856742 -0.67369276753915396938 -1.515776800479736286 0.6247830876605563466 0.65109787100262561665 0.60898591187126627222;-1.1251715697849349329 0.44578755857377860838 1.0479909405110792164 1.5412663082794983982 0.65613238060214529312 -0.49336170652426664107 1.5456551728169565241 -0.52577824198769107511;0.41658754202517112031 -1.0034274599479773293 -0.39559916325691191208 -1.6862022132399712149 2.269725335210242001 -1.6338834528436489979 0.072371664306982746995 0.84639336651152041746;0.18315019803993881631 -0.0050862939106094944702 1.6391183374350919433 0.65806945713806908049 1.5531373985801628645 -0.70557370503456773303 0.62910267577968403963 1.0579345809467501915;-0.69786024324574313926 0.1987153116197218905 0.78303085339142153298 0.75442494754232003462 0.10492418977208664566 -2.2640768936808441936 0.60499803805428475911 1.3223785119528645993;1.6168269741324565736 -1.2108444409572176603 1.2597534422402114629 -0.33204638885949094851 -0.3477960743193136417 0.28756998776064973677 -0.27445861474109312095 1.1927925220403332585;0.19752366712379113012 0.49560145450783071874 0.1389729490155052205 0.53191018088922814577 -0.87871725972713421449 -0.82994627122374087236 -1.5845622944645199048 0.11911785950006541224;-0.54711836750562048426 0.28173307758321702865 0.14070840875357140676 0.83768593181860950825 -0.12962486676000961605 0.76531182124931862454 -1.1294226412633834311 -0.75508141745305534798;0.1748794793356132915 -0.10854625287389646493 0.56003435801970147256 -0.49750762441023882454 -0.38011927904237108322 1.963012293465464575 -0.53988084949179515615 0.25753702851511972582;0.55701936009080976753 0.2915124243616870614 0.78304694355680493079 2.3200376804712785628 1.6466798929345651814 1.0908048421212666046 -1.3873596235770759844 -1.0032988466058458954;-0.50214622555215127075 0.025478798796232691309 -1.2402614085729135596 0.58088042608366696751 1.0415537510624508499 0.42487496898429161218 0.61624941945551980904 -1.4011920241455340097;1.7232022406040572449 0.40923362977199267965 -1.3123311243700683804 0.025200898276526537134 0.014643227244478944013 0.74439572136745135733 1.375342386045435239 -0.58494417626073458294;0.32938329418418199612 -0.45542920191273983388 -0.40769145009516466471 -1.2092654299247587169 0.13797656660385318461 -1.649736735502466134 -0.35916576889289769658 0.40148467941256077429];

% Layer 2
b2 = 0.42554093968715805962;
LW2_1 = [-1.8152554737235615523 1.2801381914913356752 -0.69210860300561038994 1.0082914038112387178 -0.43512111401847569647 0.26503174551967639827 -0.51589302899225353283 -0.91335890176488820913 0.73627764631757464109 -0.28242602224657537002 0.27533436563245333728 -0.23660036701725056796 -0.1330559972742740571 -0.43972355542536117889 -1.179786102405907311 -1.9083345779233407136 -0.3410981301338239513 -0.13032998335047657479 0.25102529881814955592 0.71497692685759983711 0.64837607470285785194 0.39070449942702056845 0.71811693186419101043 0.12115301230128421028 0.054353072869192643746 -0.12743093639465008504 0.28852924918484534889 -0.33152023441660694036 0.21762770444235446377 -0.33902519318728430164 0.31001026863583736048 -0.31298669832550096714 -0.2973716288002332675 0.68968758534535934412 -0.87191273196686969182 2.6041644642673569265 0.26775500814369890268 -0.88504839065363338779 0.11612911706458590999 -0.25622699555919437042];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
