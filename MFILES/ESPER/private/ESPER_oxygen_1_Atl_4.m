function [Y,Xf,Af] = ESPER_oxygen_1_Atl_4(X,~,~)
%ESPER_OXYGEN_1_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_1_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.6777800184771749503;-1.3528328049451818771;0.62635240195444563671;-0.38626808648720584172;-2.409875787095513644;1.6263104988137584428;-4.5918206795716658419;0.83457438761270807959;-1.5098265683857654551;-0.39460852446160771256;0.35101522157310471872;-1.850977366121487222;4.6905735191275637064;-2.0108298220517006882;1.8820769004996895646;-0.87573515770415655268;0.86337677206060858826;2.1387315924663350408;1.3569765534173636734;0.92759642182302137758;-4.183755753341922734;0.32900874993329820573;-0.11028896655375723668;0.27445324995749209585;0.21622826971245306948;-3.7029110586140809858;0.99374416107922114438;-1.1159557653594902593;2.6509513657058181302;-1.3316366695373591522];
IW1_1 = [-0.90523102659925902547 -0.56844542744583448357 0.98156952631815330701 0.37238813158072769927 2.1137853903227581398 -0.47569481217750408941 -0.64612548020938154192 -1.2689246069286037599 0.33984453208124282275;0.098049186216940309446 -0.19694704975268026437 0.006314660518955012361 -1.2775168473002291858 -1.8417358781941592927 -1.1333048461579640076 -0.0084574495336766815357 -1.4083336535455319716 0.22885575352934989235;0.5656259220449446623 -0.2761200474762241508 -0.41152274295438906471 -0.70072885327291012381 -2.7042796076183779341 -0.32130400373112033563 0.25448509129068441759 1.6728081086860351334 -0.84741287811850729561;0.60860681988562215228 0.19643491989304565082 0.98593275925025003481 0.08664783265606007534 0.58525584367708327616 -1.5278276352324642318 -0.87360294708339025771 -1.6601220511271792546 2.2318405599330497502;0.48451260884423058561 0.67743999650617459096 -0.5081760219848782123 0.41184188393836845821 1.1277830191019195816 -1.4648998901045660048 -0.44338298317348323607 0.59105778187918922573 -0.96605508244104210114;-0.99235959886144131659 1.2227683386443746194 0.59796715474254935607 -0.1594612058742058136 1.7593466624881235472 1.75619637704685716 0.71720061068339402421 -0.44862774719033937654 1.2476628076391240718;0.16977234361623630421 -0.27667799788467312139 1.9956540800717899042 -1.2934703828796139113 2.0183554417695743766 1.5124190978387737072 0.93635207091894279152 -3.1930620226124415417 -1.3334065730670836558;-0.997872999401645977 1.3522504167578250911 -0.2429403743636456281 1.716419996570238693 0.56369678767928876884 -0.0777341120552028364 0.14779388427727752076 1.9507342187827307889 -0.34996450444854615425;0.48731552003547168317 -0.059257091663182152874 -0.54173526288416129493 0.073800954873482843555 0.33848750445728181813 -1.763151833373702404 -1.1232642992925192527 -0.055414061500060556031 -0.19459155071493583478;0.57588582462851767296 -0.46993331879135918916 0.57914456545221337791 -0.39771019414578107076 1.7012665539506506285 -0.16206842639231452963 0.030164411691158944662 2.0837418082104322004 -2.6524186491284349465;0.81596184964818019303 0.21219126967539397866 0.74465971947619280513 0.93115534276984257556 -2.6603925262420506925 0.58613936856085402383 -1.2842256286500219886 -0.73913359084330232385 -0.6398035347563887365;0.88102414035992793195 0.27567037113406100968 -1.3074010948902616835 -1.4371785200761277856 -1.6347320014479371775 -1.0627459653791477834 0.57777646506011826055 -0.1381581317179373658 -2.0949440396422338573;0.1604288466796240098 -0.021277724734965683395 -0.42891078157883244515 5.2754844285091451184 1.1336119823952843788 -0.023368263285706986077 -1.0193588396808508367 2.0582489765138207716 -2.05383674613743894;0.27144552153414852613 0.11136410308518551737 0.9088452411323225677 0.25767135031536891887 1.8490868382311078655 -0.26523293537518632945 -1.4509119016841374172 -1.333935799759293328 0.65990525603738614535;0.19690081964199568354 0.19035533886728267516 0.4332524446905779425 1.0775291985350921031 -2.0014718278364864723 -1.1606104167926563075 0.25900067386304020944 0.75219655732934964654 0.40179127961798699609;0.56815736203861133546 0.43570198603622023459 0.17105760637387931733 -0.71717347225413263789 1.7585836207212472981 2.8446820408071942232 -0.14400093190130311416 0.19777921817947574645 1.4104730451317093465;-0.49433012570251910756 0.28987711370736057859 -0.46461927415761195004 -1.5922632349067380453 -3.182718594191360939 1.3346578680827814178 1.6314317839607415106 1.3487796572838748332 -0.69108027735727861618;1.6837984510387855597 -0.42495091742171536842 -0.30487687251381517806 0.29345402982624313459 -0.29795345378221743671 0.30128558820836925936 -2.2663187107431852496 2.4278594377484532529 -3.9058780374825170512;-1.0333429088560845965 -1.9006468385128081344 1.3604419089342116855 -0.018705067535448191562 0.28447168266126360292 -0.23275073483747429903 0.10775700347048576544 -0.75568444408453749883 0.099294099029434174097;-0.80310723996721211648 -0.78241204939036301802 -0.34863399670910039108 -1.612977712074548764 -0.58603403750943294792 1.2526034577375979584 0.26369107349092230086 -1.197617638857299216 0.77231663256725446853;-0.79415382974524240112 0.55248800653487528667 0.45125960628067834923 0.6955135377256601581 3.8957797117204324699 -1.0764650211767570198 1.4563944738111058719 1.1661633868550129733 -1.7596620176870354513;-3.0400984403456812188 0.99244775209826074924 2.0650232018358254393 -1.7946914371535511723 -0.99047622393360990056 1.9905773178187389227 -0.30096004832331541001 -3.6929075939534867778 0.12937148159633860001;1.1128643241948490417 0.33542697976151536476 2.1458348653879131263 0.55728340490205974245 -1.8967589402445717006 2.5767162136558749985 -0.47148707037463866154 -3.0939986850494882731 0.69501524031513217672;-0.41699908691574255615 0.25755228452993511601 -0.42530340043930153771 -0.20333977750934889572 1.1209169937513161486 -2.059595577188990223 -1.327301287664871321 0.22190578239077393685 2.6867390525702194992;-0.72258925952324282171 0.37998630908537500694 0.42195427677759311802 0.31908508379505934327 -2.510163726378636273 -1.1486301599481023583 1.2347790521933097452 0.61835857830906681976 -1.2638256140465082833;-0.69516565027123200515 -0.42214580004452156858 0.10194620596833946224 -0.20404832600777569884 1.4312054909778779699 -0.54011274007596987712 -0.22202917956634118934 -0.0014943496701398314985 -1.9939439121733395499;-0.35995712456853834471 -0.81366471521722327775 -2.3106902478503257292 0.10990486795386952834 -2.2171625460867048218 0.18088628315318533435 0.27200018549322052541 -0.0046887860299608397074 0.66921234205642754489;1.8932162833064389851 0.53351178268104471059 -0.97929077523117991078 0.99832561431204569491 3.7294101638243120078 -0.44978490085209626992 -1.7052224416181218647 0.52492394399264985516 -0.89692080926914607986;1.0103339847686789721 -2.0090846857070658871 0.7351327958123100581 0.10122166859453393672 -3.8285203948216883774 0.16854535209318582956 -0.9348290178279131668 3.6031632330516245588 -1.1062191090022959195;-0.07967727984449735068 0.35453459007468324238 -0.88897449389749561011 0.19702423997195742111 2.4079310134937825794 -1.1116203921289444789 -0.705465793485215098 1.3802652406183508749 0.071773737811393484298];

% Layer 2
b2 = [-1.8625376722544437769;-2.7854187931298155512;-0.93265997971459246862;-0.82991888420214876554;-1.910395746701941011;-0.64037646166261208425;-4.2180950279015450022;-1.144488648061265712;2.0144464496104479423;3.7883428575996194176];
LW2_1 = [-0.20453048383943933652 2.819756647202344535 1.969296468428045177 -0.73998573324389671502 3.2008549812006226176 -0.33936777914023313896 0.76684446960789021119 0.23638306029930389318 1.937367457692204642 3.6337415924487306285 -0.70669765307293486156 -2.1417045625454576019 -0.11284959382243234249 -0.65478799844712987088 0.055111236821735444524 2.1439060646859484649 -1.0094251674972698485 -0.8541080669967258121 0.39432101133215169408 1.2341343047951152112 0.42050651975119379689 -0.29412829137535573265 0.86994491057343659168 -1.6988217078252172421 0.82293342220107135176 -0.29611603733717983822 -1.2098946494710611788 -0.1756250492849406597 -0.52280380486086630576 0.29659402438191057039;1.5621584337015776978 -2.1011191703294156419 1.5822268615063996844 0.67341360330677813018 0.82785615654365074523 0.542847837160843949 0.53342312944403202923 0.54990252424994767733 1.0340181592224728657 -1.1931178965725115493 -0.70250916159504539493 0.58205167792964829232 -1.7064294915392463903 -0.32315201771287577204 -1.0163518265654547523 -0.034726358922726421885 -1.6703639433434174233 0.75704285531756176919 0.54547963038357938359 -0.27010057056270636577 0.39266542215285210604 -0.22892552214718478454 0.25403892562436009017 1.0100014404935935275 -1.3228001541414073916 0.52631127701003121988 -0.52113635052176454643 -0.49881017078807721177 0.34184288746071572751 -1.3262374990446716971;-1.1248850839804023227 -4.303979806132233854 -0.69193642573615199431 1.2436914194937891409 -1.4057557260326303261 -0.30111226331636903319 1.159798780497209636 -0.837297133618503997 1.1606363758340363379 -0.13313348809846903276 1.4233501842133287063 0.36581144470513454747 -1.6572222731659462802 -2.9408501821779542418 0.096164875030588084504 -2.3522182918069534097 -0.17290883865835643407 -2.4462833395677430204 -0.95518357968179645745 -0.049335380649081751747 -1.6083559198088928088 0.32527743279579696134 -0.56209419543255167984 0.017867879098307684615 3.9463034662010305631 1.5042688182350760773 -1.3095484515563589056 1.6637868101094175355 -0.65651088785738331843 1.1973386159199150836;1.8210461176082479717 1.2139288913180188434 0.47193633376890070652 0.26149088362692191057 1.1767908034610279344 -1.7683181442667674776 0.38234576446026258267 -0.73444316023721101239 -0.051265736525330563023 0.87402150190990102185 3.7828962115118032195 0.97342808747467568509 1.0479717630252443072 0.11772656655173326101 -0.55804208566118873591 -0.28100672450082514464 -0.49478247051194901296 -2.9054641166046444312 0.88335320005539808008 -1.1557340685680628223 0.96293340232985602523 1.4768581235170419319 -1.0272603311764192391 0.36577341828178649985 -0.30822932610093078942 1.5075569495358784877 -1.1596649534343466126 -2.5410534837814680031 -0.03298452527441329829 -1.2667752025259679804;-0.31962669376634578189 -2.0963996302926699578 1.7681236468702323794 -0.25267889950828920087 -1.2927752798651170885 1.6781684829575702622 0.32167574035366552909 0.41474871878910213319 2.2418459637568206588 0.84102873159122926161 0.052826032867040205454 -0.53731212894063440366 -1.0648545455822655548 -1.3220585018963801893 1.4161395361002828697 -0.27362771198450469567 -0.14868148110237425219 -0.36427651855882764442 0.055583705403267312517 0.41893015872671768296 -0.76859109923548973864 0.37407825090569729598 -0.16702345662453826902 -1.8162739320184697611 -0.54868518154727241587 0.49242774082490642362 -1.6611923642327870443 2.1852082794328495652 -0.75032521278753983029 -2.2373643135230545376;0.11442914015545575801 0.48278923629523673444 -0.029201696841772938756 -0.37917205900606226754 -0.46412825683563219137 0.79295697334586656702 -0.024511747135920924218 -0.084849506422808834705 1.9923466926802448906 0.56622165347267328084 0.74487864779785672997 -0.34816947806361958628 1.2674733485746543238 -0.55763526279809705333 -0.36581167192841118618 -0.2701097975439107346 0.15507402878125059464 -0.19187742114512953973 0.16864480126795630688 -0.15621275158242237113 -0.61498879935429262567 -0.072589550749976722299 0.016997648399095961758 -0.12868099242880104427 1.5215582201899127135 -0.41954631683032350686 0.19739652439857002797 0.46442336499825903617 -0.2710096322028636151 -0.71975804315348235196;2.6950311408807117175 -0.86870424153426506475 3.9959036757186914279 -0.68048782768085891437 1.4440089639903590513 0.72575477789665399087 0.59523674241819868325 0.82709589856529908136 2.18808349011907044 -0.7038161073471318474 -1.0647247456639026275 -0.40215854863419758791 1.3816843659712938486 1.7343060480808760726 0.59355536935341157712 0.49961093717872562259 -0.1867008735608823855 -0.2871106781880966019 0.98794715706961855339 0.64992141954200066678 0.17220716654336068463 0.12912136919796898815 0.7170741737956438655 -0.205955685836923863 -3.2726007129173626531 -1.0440360670915043162 -0.44259269152519192803 -1.551024851594818621 -0.2069110299887041704 0.34533516977078665411;-0.94040159582104465574 -2.1465984641053452719 -0.21795050424107975662 0.23287652540423103842 0.13451971160313017095 -0.99563600220449610667 2.1268445044077846084 0.49020798758472416967 -1.8021335691099731324 0.35260346845799261928 -0.15032862163215099383 1.661780336015526105 0.63904893829212683354 3.5178621284231867961 -1.237980955769371727 1.8380787490002468143 -0.52028509601476624624 0.089375220219245612996 -0.77562825188512629637 -0.39769130450990330949 -1.3928677177680857113 -3.4479586869723384268 2.2349377169714124136 0.97905944129325039871 -0.50884998667199332623 -2.4308459753394826564 3.5949080004015212531 -0.4643066573946043607 -1.5927733613417576208 0.54200182260853713156;0.34406122264209826334 2.6235368997359831411 1.1724944290348215947 -0.95685681099940345096 0.59908529530563370269 0.14908256921126483707 -1.1779608580153553277 1.0033059110968880479 -0.69753858792663003818 1.1366974599537686963 0.29515343985729697307 0.2149414967366354845 0.91709257376238650927 1.6075099570723081488 0.65946422197991094727 0.15039362291394797744 0.36086623447620586047 -2.0467118293427959408 0.87333517965429341423 -0.72112238264493033757 -1.4944328021482593538 -0.16236976294435057078 0.45141232648254359106 -0.34216499188374721596 -1.6754885020944287888 0.54238978490576450486 0.58097332537066859182 -1.4871059775003516723 -0.69523876505024118089 0.20122500320129063645;0.62414867204759583164 -1.6744434462380952677 -0.23788690441650234275 -2.0566591938264795481 0.096490745082247003639 0.37385146008172920329 2.4045594418555964467 0.16129738809349519757 -6.4210288304469811393 -0.40659961582349996023 -0.077412316660348645669 2.0259887492243056073 -1.2679250861097213221 3.2024014665245950084 -2.3465969642647714899 -2.2450932195364248223 -0.40447302727504635955 -0.16945200446877572986 0.9434437705498821547 -0.22289088319266792126 -0.98395953796975799133 -1.5430485173157606482 -0.81030802003596480443 2.6454056876525591235 0.62200636036786216554 -2.1393307898530249389 -1.1731754443030586454 -1.8220603662697312242 -3.6083193186108419859 1.1082578718096574022];

% Layer 3
b3 = 0.37695040252404954373;
LW3_2 = [0.35230893911835237109 0.74474795380159453106 0.1325731285301232909 0.031279827589904302121 -0.064554435906104101761 0.45189158153123382133 -0.37099486625403815809 -0.023433538332785133068 0.11121601710154534193 -0.037056155269093823956];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
