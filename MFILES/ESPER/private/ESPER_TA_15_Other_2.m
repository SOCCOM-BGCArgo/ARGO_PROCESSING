function [Y,Xf,Af] = ESPER_TA_15_Other_2(X,~,~)
%ESPER_TA_15_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_15_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0077798922598026898;-1.3570329022516165463;-1.6662897821512459018;-0.20977365548777104909;-0.19300130407519119902;0.32380454586158524677;0.71327473246676253993;-0.18115049997000670645;2.6877541192773057865;-0.25351073775815313738;1.4344718220053029878;-0.93989445712983377135;-0.17704427732994695854;-0.20511553655485531555;-0.763415558488710011;-2.3943275380887247827;1.2947575817775649476;2.5373938682319487903;-5.6227624195200078816;5.0461629047418714578];
IW1_1 = [0.84314170341275884724 1.6295864110349889131 -3.9226385197090998247 -1.2628486388179707145 0.37854287746571002593 -0.9702842538238979353;0.86893132373837644877 0.59895953104923294052 -0.8104604700061051048 1.1750381021889850786 -1.2906819838932468425 0.8215058227192835183;0.56680602262678059233 0.76312933026786500257 -1.0153248167226041065 0.70903876456763592628 0.19264347395241424032 0.05286362839523142676;-0.20657869972180004092 -0.088958570412080745227 -0.10721833452186502189 0.097369867200572390864 -0.092292831778089903794 -0.029806389608953012121;0.11903055919512314786 0.15480559941864610596 -0.41262390225644074437 0.60665965693483669963 1.3007778575145676481 0.5830329900898180151;-1.3799670559531731495 0.13535375795023649181 0.89407093832818396173 -1.5255665359869441389 -0.24876176422875612149 -0.77372771334013368261;-0.52721554219310629019 0.16925909137007058569 0.28786616109249851814 0.8000316108971899931 0.91636943080403832074 -0.27773830923404746462;0.017624298170989174256 0.092677547849681421455 0.70375466457630164729 -0.69481239964012464494 -0.022760762034488561667 0.23310671816617006824;-0.036635723708783499153 0.18953503777674649 2.4008655603941884138 2.0054401485881934164 -3.7385709438631704593 -1.1330037609282379574;-0.24158932415682668471 -0.14486824257105854197 0.0058258569802522256614 -0.25537574593678052937 0.032302756333691784452 -0.29173838647480526687;-0.19677276591388209726 -0.29179896714539482749 1.6773818064287879803 0.50781219082129380737 0.56894331707874123971 -0.28304341551003814326;0.073505865337803039106 0.7463461608000399039 -0.48701075786878955665 -1.7323346414262710269 0.80324907776883269772 0.29759279920952619314;-0.51374353932587091265 0.16590100910899804876 -0.78472797342149869237 0.027637052047670869481 0.53097891376727612833 -0.58284047626109891649;-0.047889612277631998793 0.084845411925192903979 1.0138285137687050863 -0.96715495282234087426 0.19818393423970498413 0.56684287554666246134;-0.052618587304098900226 0.11273680356584285522 0.025329690089463560015 0.37119683882421883325 0.99321242776746365699 1.1698700193172248962;0.018880311804600792558 -0.06219110201737581417 -0.52292388834157899069 -0.37014629567498680274 1.3157314106455300085 0.94524405890644946915;0.59116705368511901497 0.052944542576326587835 0.32454241146969931009 1.8392203653612160252 1.7348444893936758593 0.52906013901832094071;-0.30415594812736063135 -0.75663257526663196817 2.1011881692848457526 0.47493049573947082598 -1.7399544231528394356 -0.42568145550928121468;0.64762261923247188555 1.4286408796788692133 -2.5353293875324376394 -0.59044752385605892009 1.1061039293997838584 0.098030389196076400671;1.1485481437513205272 0.79115289666077237563 -0.34232899171140079853 4.1291743503889977163 0.27655102899605976674 0.83312178312118934098];

% Layer 2
b2 = [-55.198779740731723109;-92.66925079302659185;193.18372268532112912;60.377003849564623295;-21.95729313172743602;-44.112702417387218645;3.0202057285664367647;35.608119172570262378;76.468344561783212043;368.58660762804396427;-34.198405091277585655;-13.75336595881033297;-144.17142194589649762;-64.084731687280694246;-26.685955454981627355;-120.00471970377586217;2.557512884306739398;-172.16300557969185547;-24.02892279978781076;68.099196247072370625];
LW2_1 = [-4.1824037297935019453 -27.643854608853832389 25.489543798305462019 -96.907274412781035267 3.1789785610788063863 -3.9467639664776741348 24.21763005895656562 -69.882528442497658716 -7.3293867792116946802 -1.5148785156230728521 -5.5265744053913978817 5.561983417536053409 -11.893856479794292724 31.276874584367231336 -10.851411126567217735 19.038628195425950196 -22.420117090510693458 13.280938269265250895 -21.764911182287839608 7.3105256986406610409;9.38245912600319798 13.546420270421826615 29.143671947188316551 72.356772520842156382 -26.603932790603529668 19.055460662379228864 -5.089301744162177954 62.859005775871622745 -0.36656380800119975349 -20.74837749434822598 38.345286889616232884 13.553225727653408939 -26.408897615272767467 -92.538875878662025798 -34.757067237402672788 16.944571541236090439 24.574030726497831267 -39.779225592191266969 -156.1848521239594163 -1.6075674738976624134;2.2084318175670989426 51.115322982736692836 -33.639123825832555781 30.468124005351395311 -10.612132334754308616 13.483146388202261079 -12.289883659918487524 -43.145940843181087132 4.3199645155852222089 42.115174766892216951 15.172886790665911505 10.34083176589880182 -12.927633071274755139 20.109396915090165692 14.671072585967554147 -14.093807014531654076 13.714633602752050123 -13.258498367315478816 180.30558760809793739 7.0048822394371388356;31.679634874976368764 75.565075667020934702 -42.165532408517478302 -60.909849810564026029 -1.3333412513906066632 -14.908829285317716895 -67.461556638264951857 3.1923963490266986653 -3.7908210335524552548 -19.739490519432184357 28.81026794615288722 4.5142636002762914771 43.071175683461341066 28.33807562929343149 38.107225388882518757 102.96202024936829389 -31.232691658855600281 19.1107422820280064 -95.706723682433420208 -25.193711801389326865;-12.242530038517648094 -9.6093962048260976871 27.32039639223485139 -8.3534173444395705133 -28.583566587225519129 12.966751484318116638 -45.257318897304479322 -8.9586181584377460041 -33.248658169321331002 2.7340634516439821233 43.730129646280325062 -20.813802419583826264 -31.439223013693020192 5.8046371449015632393 -23.862324115631931676 46.741007957566864661 -6.9707458621120270692 35.551328995862206739 -36.460517396794138278 4.0454132145132604137;0.12247264447699229839 12.697302726936957384 13.259959633621608788 -14.401744962616994883 40.551946980692811451 6.8851342067850387352 -5.0242721527990337194 6.8011880567043219159 5.4950517737089707992 18.639329209795594267 -10.738897328594719127 3.9969586931816234454 -4.4820940547194547676 -0.76686441515724579343 -17.761747196024828099 -6.0378341981204197708 -6.3562594029112320371 10.296493434129347477 -53.750581850360148906 -3.4858659442637338621;-0.057522816634884288423 -0.040591891869786386748 0.74036814184023880259 8.1242296833918832277 -1.2838430904837572211 0.26089179420740699067 -0.14547819678748497019 3.6921799648525430726 -0.27743644565027958393 -7.7375715495820651668 1.2613158046727706019 0.066659910440595021575 0.096351722629752889482 -1.8859216184380798165 -2.5137649292417711955 4.1085157142325972046 -0.41585192474674043117 -0.49983077906370049215 -1.1974740148717180066 -0.27264751700191386385;1.599553977567267804 11.129989163015000742 -14.535292516057264578 3.8572224639921168787 -25.896304878578160213 -0.73514093703986582717 -0.69612476430324032872 -14.561652064819870844 -0.20245350199862349738 -20.927212098071905189 7.0061307137375212761 -1.8115899817017697693 9.8809943865495846183 11.248795777159228848 6.0963172488768719859 3.4029505901990599881 7.6930298172066651219 -4.0802707374381483874 37.532702300944023932 -2.151127721405305504;-44.095321189311817989 -143.63831353427445947 24.06863169210878084 83.484029134541785311 -13.295204127089281343 -53.087388844726966397 -34.237192179208470577 -99.508776971804053346 18.468621692759665365 -57.986369551413268653 -63.515153807751836723 13.303274711980963119 -13.300392527029503142 83.891909037120896642 -22.818565474253539094 14.805356757641071397 -57.941315130333222783 -106.1750541696502097 38.113161042129554801 37.485603255203415074;-58.055210106217032262 30.668443140271445913 -108.84763484292692226 -72.884632999289493682 71.478783718542487691 -43.459655958302079171 -69.630617619407971119 78.025628202597928862 34.09551428618649993 11.967304415118970695 -189.16013831481396323 -164.96179342051198091 248.89361882564267603 268.07647138705260659 -5.8450384973817319789 375.95782598517922679 -68.583664193625850203 -31.843723685582755678 46.479583137797234826 132.96576959211242297;27.326246174162911018 7.2260582143837845948 -73.888794049559450627 -101.44227393532085557 -14.866477365763346441 3.2162578073868255402 62.122885170216356698 -56.934672811844272644 -16.161821839318658789 22.252132265380218712 -35.412604133425411135 9.0021874873094116509 -38.811598497465929825 23.277091575684643487 37.75052635393149103 53.317006153936617352 15.093555525919086335 13.203115572803284294 -26.98318571402953836 -33.554342983150732493;0.93347283554820692508 11.447834155671841927 -18.652307972277739623 3.8482316257101154555 -16.563508993817801951 -0.42430584375087015969 -2.7667990909630457708 -7.652037456259102477 -0.6039011029313586798 -20.188246823932139762 13.015189848220339641 -1.2926829701589674926 8.622824368639683712 3.1411685767809784942 -0.024039710120163884643 -8.4984577583843972093 3.8700693049397218992 -10.545830942725034518 1.1437085381748837154 -1.9540286717914312486;16.464791369084593953 -76.22114120149461769 12.678488306791942719 18.163269132548187201 -26.810229635197831755 -6.784564041338303042 56.129136781981685544 -62.516384134817641893 36.873556157644785003 -16.273253303399545899 -62.8795745794099048 27.731105314712277021 9.1114450130718633858 40.186659495630507877 44.45775506667300192 -138.7306544885887547 9.9687266232007303302 22.489684693724683484 33.548244237214760233 8.8149793712159212333;-11.033455369808468305 7.3951712877536692758 -3.2882265722095374016 -3.701724347504769419 -8.203112004973721838 -6.8189537390688359508 6.4674558515615165888 24.679038883209130972 7.1165838068148028484 2.1585458099677845567 -22.086834511001441683 6.277584586681203227 7.2756161152820775229 -16.923362322193170826 -10.245125201790308722 -9.0168738327387369935 1.2087272009103950943 1.0160940236793736258 -61.63971099786409269 3.4902958161336590237;-132.50514479700990478 -27.084730736610890034 -4.4518544327074058842 -130.89908940311150332 -139.63148112374989296 -74.57757535355014511 103.23204060222361989 -200.01668174181645554 -9.7257495029921017249 -214.25300288284392991 5.3882766842319149703 329.679282254911584 -151.00365226609827118 -229.11680620607899073 22.633844912482828704 146.06096090854606473 26.968823367857496009 124.87846785542518546 15.088085999250596458 -200.53679461173649656;119.11803326282702642 23.485923431514532211 15.808043502749780984 46.88513538886631693 -40.785851962756815681 16.236937779812080862 10.928418041727349319 -62.914974294171393865 -4.376956852037791279 37.824307586152869476 0.51304589519070287196 34.573091837619273292 -59.030865232665121312 -1.0015414416296166689 -7.771778123260987492 -119.2984992544556917 41.881816986046622731 16.109306731323361106 -138.00679600124112767 -14.826463922400401785;-0.076423386400410395214 -7.8739199207201728825 9.6020195999958364297 -7.050950702861249475 -1.5656350995812899907 -0.59384005379041249206 2.9594682433499426288 -12.073077438063528177 -0.66057538990180764138 1.7766754383062735023 -0.21654836900578142145 0.12425754886893876361 -3.0658200892528930659 6.2806736675104195555 2.6715665618396506886 2.3711864496962635762 -1.9120370737893872537 0.76705181260919330644 -1.4291874541315068292 0.054287946016047777809;37.766729406091172905 -192.5225957960407186 -128.38649424350523987 -123.74150540953826294 -22.413899121984627527 -47.63639780250028366 -26.802505445946884777 -67.066368274964204943 35.870754776861595303 -152.57460032548064532 -88.423081186811131715 2.5162706361120861231 12.742958893148269794 21.938494465277280199 12.511196349991523746 92.373306165772717691 15.057184767239071732 58.556376279844663202 -66.495592084146153411 -93.846152053131035586;-0.33105391032425313114 -7.4963230291261666594 -0.95786340120914259533 -8.7263691427306468995 -2.3167954672525490345 -1.1840205026059058557 2.7738038014954198296 -8.9739244215501567936 0.18150284255341431194 4.6283903599035465248 -4.2778543458477544803 1.9828490536107312714 -2.0973886648447570558 9.1898483816685434533 -0.13883550237364092328 -20.983621177910503519 1.7593272510223603167 -1.4877913274944583044 5.9619114578100429469 -0.55303657443593912113;2.855206183984683399 28.616564308856386134 42.099919263408942527 -74.000704349278024097 41.986803425220841746 8.7241788360802523528 3.1030610180476596582 -38.396017499544946361 17.798322932935047191 -7.5700586304116788128 5.7786979286150437218 -13.523983983466735026 15.94119895238955209 10.438761216421140077 25.376217496656614969 -12.380718223727052774 -208.44544232031131514 -51.81911228550051618 -75.680644972185802999 12.9364345124867679];

% Layer 3
b3 = 0.068478189461357599765;
LW3_2 = [-0.015818412458107593971 -0.013307458126360026049 0.015816033033049306522 -0.0067699487528102529621 -0.0053985025663076790375 0.03226583938320908701 -0.50692565813563628119 0.060988126125017097512 -0.0028239164759037644128 0.0031258778350036113894 0.0054624500288456990377 -0.037875851569036368682 0.0052443207771760884731 0.013220338134303529984 0.0069735137321139751068 -0.0057768671900708511852 0.34569954944185504742 -0.0077924019897695918219 0.095869640351137333512 0.0028597251764940091051];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
