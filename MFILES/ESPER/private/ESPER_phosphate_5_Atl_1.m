function [Y,Xf,Af] = ESPER_phosphate_5_Atl_1(X,~,~)
%ESPER_PHOSPHATE_5_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_5_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.61570403666862305592;-4.4003308815167470058;-1.4369562921491165763;0.060808124718236808426;-11.136570393409336077;-0.51928615274681866332;-0.86840806658948843655;-1.3758628575486029355;-0.78202542320130086217;-0.41452408957393382938;1.2597887287804905299;0.46840626215497255247;-1.3632648301252163758;1.7287664363824588598;-11.079788981618834853;-1.7255686331504411779;0.082341277864132714215;2.8751374183384617034;-6.2174721789641447245;2.3973074863878638396;0.96732367586829959283;0.26260142857505358593;0.90527941560368474505;1.0315213803413165738;3.3097843202033376819;-2.2863163785420379526;2.8767789728326849108;-0.8201697704997215066;-1.027071230681035674;8.8450351568142568937;-3.3158710907226347508;0.70542861551327218361;0.22444166920366262485;-0.29660526543108328701;1.1614802028345205809;2.6856114466136045138;1.8606174769371852662;-2.6293418470098339768;0.29882600441472328967;-3.209719171925676573];
IW1_1 = [-0.50239488588522862589 -1.0945545974992405558 0.52242735815788166054 -0.43482827393985828968 0.1222884701150197817 2.4841316355833136242 0.76246944813487482762 -1.4255429019354104447;-0.19721847507674675204 -1.2256636051779201679 2.1028647291925821605 -0.6362369389003834641 3.3354578835933192948 0.17664212424853481531 0.15401388436701288209 1.5269815122404486463;0.11420227347257648487 -0.34733456945123580839 1.9572732800185148605 0.12383931561398986432 -0.072566544863089943451 0.60059009559302733994 -0.11826851530806932467 -0.034842269818825391536;0.16703686396496489341 0.23589611371590790689 1.0115588367006229653 0.064309406648029310283 -1.8444865738693254631 0.24482533961390973154 -0.22751055447316609337 -0.31671419672876938156;-0.57854610060233890856 0.27706559330504004768 0.75863845432299481519 -0.18675794681414828458 12.559432291700415973 -2.2658081685655799831 -1.5652881835411824873 0.18944011703834504057;0.57808524802319805058 1.0774807045602474709 0.38804186990343653152 0.55091687013945478402 -0.89612518446108724302 1.7442897121173428499 1.7929670644813342495 0.65795543020291635816;0.43603061281422389461 -0.99753528824994086577 -1.0409933472663766008 0.77574022897118355413 0.58665010167259923346 0.32884056767724051396 0.86410613740783137615 0.33996324308892039712;0.31873881072575471762 0.10113707127635609972 -0.69008770175022549065 -0.16347951198655041871 3.3966371881391261844 0.24071838619096053158 -0.6581103068785973953 -0.052096964590040373277;0.047710024196263835228 0.70047325027962803468 0.79139579468040777144 -0.39044532383191071778 1.3448161061513994596 0.89002467600793888636 0.90333100838554458711 0.041865663183599383101;1.1014415907974224318 0.65887610069379620725 0.029949705535914850768 -0.11387498499433650057 -1.2186863914145225074 0.13486299555157638119 0.36546239597071528138 0.18306521302198475176;0.68182356538622401754 0.54574768154458686009 -1.0579144914518383569 -0.11479061109155556941 -0.41663366963327275183 0.75204821046302350318 -0.5142042185059624293 -0.24273202020662429379;2.4861136328664814599 0.4130448651843822705 -0.48811174248877436943 0.47050898337891894352 -3.2039946219233921276 0.48528550016291138736 -0.17728593322431313029 6.1957998738460755561;-1.096744357443101725 -0.74922120509103473651 -0.34870567494634630012 0.082736026084939295888 3.1063764774219357889 -0.65120323024779536158 -0.63663415459761341086 -0.69923045105394865395;0.1565754601710637739 -0.0078778143788699565853 -0.028168790223927941269 -0.43780858892331075971 -2.1560540807359949156 0.42867897960271650337 1.0696652128788270986 0.64539090841057411563;-0.52336728879440375106 0.24484837724676344894 0.83440693340521077115 -0.14927237873136614543 12.453461116964597011 -2.232914658071610603 -1.5477890074057147896 0.20671694272644708379;-0.86640300469097319969 -0.030036100997687657788 0.72924259093097643092 -0.32547994165212634776 3.9383320275246060937 0.20813500468398693499 1.4496652636964098004 -0.71043805799051507055;-0.69089272940382429056 0.34200480482276973682 -0.38857414277044133311 -0.11561257812073055806 1.1384925316792227079 -1.0619835611942203268 -0.35578351890706377825 -0.43343300179245991544;-0.55328597436556370415 -1.0259585282117098526 -0.3101351830064845716 -0.26750681318755731297 -4.8832527498354014739 -0.29233069460939098416 0.99747680410819594687 0.04117183697341789822;0.79763017223538301703 0.73763830315982426011 -0.15923228060172914256 -0.65889950529820295877 10.495285891287515767 0.77038912770696377219 -1.034168880455449635 -0.68755461111974092159;0.93233883186519150854 -0.20204033406032700926 -0.17013658929015906818 -0.45870991590067883292 -3.6161411420209277345 0.36284891928485074608 -1.1547075879730803738 -0.15163293029753449614;0.3204845041769277536 -1.2104156683893716462 -0.99034110125593655116 0.68775475590997614539 -2.6239962880194078743 -0.11344034109784366382 0.70158338299962119677 0.41904349997689316343;1.753245488679483266 0.13267988996677501645 1.2671152445251929741 -0.065180149882070034795 -2.3396801457168936444 -0.43895052245597238061 0.57971216209508547035 -0.23084985780050382154;-0.2849500753505933015 -0.42335691246744461269 1.1492047658713262503 0.11355986869085107904 -2.8568001326031637888 -0.33354282184500050334 0.72842925155026327921 0.045486762009556452879;0.14891250197975483549 0.47393094168364641172 1.1139779824283668752 0.085943229298726442345 -2.1369923249488351757 -0.70429742215756707679 0.019935734443375083269 1.0089118113599160331;-0.52635467625055887275 -0.67762672561232162316 0.82827883518041700572 -0.54911875702946200128 -3.0503827169525332685 3.0755931227720427756 0.65570569254941624138 -0.84704224990569321196;0.057368111743209423969 -0.16864681543209414372 0.10037860401093491591 0.5623436063788804784 2.739223513245199193 -0.40862163015408109468 -1.2576885161073065866 -0.79511085197232811428;-1.4823358179910650634 1.2403639446202590069 -0.76593180266620874974 -1.9065855586913706965 -3.1584216765990107412 3.2405948128036761169 -0.86663158524898231683 1.7933925989354835284;-0.54442876398951389749 0.12083967182554833375 -1.6387305258595430413 -0.10712465615692505494 -1.3287958701230058178 -0.70104214247178531227 -0.23147847783553424095 -0.007669898939131366937;-1.9633257816289300113 -2.6204479152978921164 -1.4114282935787474393 0.45219011352609150833 1.6720387098771480883 1.3243550622172488573 -0.66740407606446638944 0.47732320958899188135;0.89646700452563210515 1.3012120161340317015 -7.037884279208167726 1.0529194423788696966 4.7349964296650899342 4.6994787352669078473 -0.74109261320710828613 2.9589309938983077153;0.22586929323402210601 -0.62808737562235228413 -2.4306960442475502582 -0.073850891382520128525 0.34445969236018686432 -0.49911944684149395224 -0.33363783244302441799 -0.44669396868402605483;0.19544231073557594147 1.0389261081323402092 0.73962188292980679538 0.073497576167470518582 1.9626745471889055494 0.94655047854784091221 0.37274423591662608768 0.11308981375157807492;0.32702772090780229952 0.28151506726426744898 0.21638910041801179274 0.092673281798480791616 -1.8635653833518339706 -0.11755152335763925653 -0.089279214934390990766 -0.70898167153363278459;1.2204872572695533162 -1.2134112823252032332 1.5296814352582595031 0.35254072917359163819 1.7993190804703393937 0.41887165710411422559 0.0062003610339117576702 0.1592069963412148792;-0.92094647810943375266 1.6128094680791784654 -0.1714119162297992327 0.40982606771002011437 -3.9486928374651384388 0.23568516987993981537 1.7418318826959913181 0.6834423074182348623;0.29793746738850651612 0.92342445099067393954 -1.7667168973082048034 -0.21218685424644012638 0.94141729464253731674 -1.3470469798626503177 0.43969878843787918443 -1.3766950509886730636;-3.5000517766236538542 0.13071336460227636622 -0.5355103440596378217 0.62321225207502672916 -3.4975175819111612441 2.0885467117973237627 3.043009380850063561 -0.66906521636344651327;-0.52820215579369589332 -1.0375842821096781243 2.5248504320935616363 -0.32627197392784690333 -0.037368715661354648394 1.1679609050734396369 0.41213686093324258808 0.47381344130478469934;-1.3177533268349685969 -0.047364663086776163936 1.6375890093633633793 1.010797560268530848 -7.3197699586790898607 -2.3822228203295243709 0.036495179067237461246 -0.73609244948503171901;1.4679904008885258371 -0.76556286552822483404 -0.56414565479869982489 0.58525473848072773198 -3.3611953632212978604 -4.0327550563275575968 2.3482240301143457728 -1.9371823181677896297];

% Layer 2
b2 = 0.16025034825457351584;
LW2_1 = [0.36178084822696632283 -0.29791160494359597566 1.8017437823339195191 -3.4386215497532104379 2.9400511576395169655 0.96600329193568768016 0.70496921350711672094 -2.7837623838307430368 0.91880380466009892171 -2.515451591147702004 -1.1149707125533019347 0.042367207231028589098 -1.1296417657817665603 2.1243580367165844081 -3.014446037071187412 -0.39678651874546255751 1.5775866112874032954 0.44834129165511588111 -0.15998086772309727532 0.67985015557666428343 -0.70291555087221901932 -0.5137442501639065684 -2.6259964355132972003 0.75366313478758095723 -0.32005369394371735448 1.4436972902064926227 -0.063364164594380212314 2.1466462416635727628 -0.097832215626371760164 -0.13198023017917359656 -0.76611936241161171512 1.2199731464117447022 2.491325162020001649 0.6724746089866671106 -0.76586697694039762574 -2.6571559216817171034 -0.26416033404452787803 -1.1950888144064044649 -0.34420332009423959541 0.13801088062204661111];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
