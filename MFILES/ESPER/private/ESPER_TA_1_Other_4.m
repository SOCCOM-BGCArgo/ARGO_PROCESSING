function [Y,Xf,Af] = ESPER_TA_1_Other_4(X,~,~)
%ESPER_TA_1_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_1_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.047339774664977261887;4.7224130376199697778;3.1432085332314225745;-1.9971219671778763782;-0.836241760967558867;-0.60009724442351197737;0.036163476761449098174;-2.1418598868481519837;-0.38847568524631326259;-0.79329683187221189389;-0.70976782579157948749;2.9762542637258455613;0.36213721923073211029;-1.943270651320998077;-0.25038915102995901174;0.64128269966307027694;-0.42843845162770016755;-1.4377500302260972642;0.8622910353733411748;1.665225486188991022;-1.823628909349305216;3.2043326031782539687;3.0312423952303384489;0.83490840863281623463;3.3760179934604850338;-2.1190647828289082;-1.4163559032177128749;-0.63037684404798854931;-1.6117176299527642414;-1.8615354507583907751];
IW1_1 = [0.10637610792679531857 -0.4307312914381142277 1.4484583134193984577 0.21030260015961993458 0.059691088211598679336 0.10075588408989175071 -0.46703587307332855572 0.83664067997339652827 1.1353922464633010581;0.037184431829643413425 0.47710534532173176636 -0.7237090061140832864 -0.82173949950607261261 -3.9468832149137988985 3.2531728563517532393 -0.54561561777033051879 -1.3278946685233570246 0.40688724809276494154;-0.88843671871053830902 0.50541973080792645945 -1.7483782464970596404 0.30579782342390987582 -1.7962530958988902619 3.1102795367684321626 2.6632955525954651321 -3.5890884182439211081 -0.83190642561766758867;-0.78570690325335246218 0.40471640584796519935 0.79248436682433531786 0.15714265781823216761 1.1528866889409836727 -1.0419589783509117797 -0.8992393032809065101 1.1114046091752582957 -1.5815004965691721317;0.038029102658514897517 -0.16903637108548458245 -0.75632782992758007534 0.37611073951108231483 -0.10374666693195165601 -0.9411851106570373604 0.058847385287338731252 -0.35694650430806956765 0.24736946733633582984;-0.55038279998953487659 0.11688859251104984083 1.2592636352104353836 0.38819382937683893919 1.0462532166960758495 1.2006933381678650541 0.22159527630575717727 0.6704301931583516172 1.3548623977999718626;-0.35735752908649731641 -0.28060550460307454035 -0.36343418051759962539 0.11048343356659115488 1.2838905009013326097 0.21811890905858388745 -0.33412660563751223064 0.90568326267365395488 0.51861867280352036413;0.046752513087052791074 0.085768172298329115044 -0.028904042500754782707 0.38715600253096021932 3.2226414240744096773 -1.536894964032924582 0.33219205930453232778 -0.68729252821147546193 -0.75973703762749256185;-0.033781207150423493701 0.23110240851865992973 0.40575965557869947409 -0.1758395764672896211 -0.28729069227585612989 0.91493273068738689702 0.34923066249278561513 0.53967854053201158582 0.14256636169326603047;0.93388375182496830007 -2.2039233652623995141 5.1539930355651639715 -0.93090551174577118587 -1.95630791960257433 -2.3217578996767205268 -1.266219686215643403 -0.11483719189724969634 -0.5822735548191446675;2.435685647760806205 -1.315302368254658294 4.4682486016537632523 2.4870463347353681804 -2.7719924653086680522 2.3474493901658166628 -1.0685436395693177491 1.2637026391790351365 1.5422154161532348748;-1.7075128065104823172 1.9219992484831835977 -2.0605898504264104076 0.749326406980281301 -3.4177743870047923025 3.2879219069312450863 2.4782060927115252547 -0.94838777051132616691 -1.1240041989580629167;-0.23736826101331170991 -0.19271550221290298377 1.9952939735563561818 -0.89027716449146498956 1.447764660714513818 2.4236621184810722696 2.9732613845222433113 0.10343220283438754603 -0.40029603216937637011;-0.037887689236647981161 0.25808963008887936263 -0.12985907964129450587 -0.012052769392665989637 3.550082309647977663 -0.96405486932632311614 -0.085675049998637259341 0.75022068448618872694 0.15988654347433489677;0.15965597155158697817 -0.25780504965104744652 -0.82681633995026682094 0.14157334126836565447 -1.4023474128020254614 0.40580622738490473855 0.0035228515311636291601 0.026190810847510598292 0.52708667770687001042;0.22586624691803450227 -0.8166577032568529404 0.84890052502285140434 0.31743143877108115358 -0.15840538989974400907 0.88258823678896924925 0.88559331891239190249 -1.4634690074082230549 -0.12999037978234692647;-0.87488958853454190656 0.22346204083711473931 0.75989295078798191341 -0.65762776877698447819 -0.12765478418555425977 -0.033323939517029693702 -0.56663451661791208736 1.0275869822652219376 0.55485212492530899819;-0.38780451089157580435 0.33901549390877450119 0.58573500613145168536 -0.16947578211735864206 1.446430187980518367 -0.89698471857388062389 -0.30301782446854252928 0.57226003932926672313 -0.40779612572031848083;0.33980530827077520817 0.16245443154516070461 -1.3150747977311039172 -0.023195572147307306349 0.56055272889572349548 0.0760591163199474396 0.65385387876645950644 -0.6476640109870769324 -0.49782243116267893557;1.5132464565194030381 0.14935710907529922697 -0.28465032291050418323 -0.12975730893914605435 -2.6140779587440996501 -0.5885956832841635622 0.18769749316018088936 -0.45758276674655357086 1.8743867710580812691;-0.12004801715205978829 0.55172223228675021378 0.14241710296063450625 0.51355529457155435491 -2.0928832545954292321 -1.314544955207444632 0.72547070496540755347 -1.1626299070931211954 0.57566566111502637249;0.15584787280183415303 -0.34747587365012772009 -1.5181906615988345344 0.54769115379388899623 -3.4876965333243012957 1.313965236991088581 -0.7624968292364125988 1.4949693278952322917 1.0080448013276890329;-0.49645997766429905695 -0.71895534426429741348 -1.4123837340894591641 0.26123127756241865116 1.4385726609648421537 0.32136870617955387575 -0.095941153246710791924 1.099882656876973952 2.1482600650213998783;0.97061114586941510396 0.11095218923128424837 -1.0694346555314435676 -0.37584479943909671062 0.75226362383679712398 -0.022165048088080573779 0.45026176377600268808 -0.47787985152912265674 -0.51475239325192490014;3.0374189031786644755 3.0867146384792776281 0.49555623301708884298 -0.17519917354343095273 0.85207948815218992333 1.4597183152288089047 -2.3583543822381716204 1.8118879487905508174 0.096793241135950988663;-2.5735549563327588807 1.2443805055638863521 1.1624082626937985996 -0.30070802129826046389 -0.44919019968704765322 0.40409937744081014799 -0.77615877339719663297 -0.93717192227580992103 0.78278120648999038877;0.17370205913861100355 -0.063866362691620492953 -0.81474354179110242136 -0.14158629857413496111 1.0917527185449704685 -1.6736034652234548226 -0.27207655717589518396 -0.94070491923001020584 -1.7218661994628665646;0.25225590982998702394 -0.4182022093050997702 -1.2514335036286257097 0.27794806311771091956 -1.313420578199373967 0.76238689715904151001 0.19229209933264568289 -0.43374185842042084493 0.4472869131236443252;-0.2374243618586192317 -0.47568549891822986542 -0.74273834169750796441 -1.6330959286517716667 -4.7819497227095562053 0.84649028641544854512 0.10492895111991135115 0.64597260354427255002 -1.4351878105504647376;-1.1916651690716411061 -1.4674883958362920922 -0.26587829933629580914 0.75340551466764993371 -1.1558564621464411104 0.05459083508624922032 -0.15701027150077456751 0.18691056684160659018 -0.97122889096999642788];

% Layer 2
b2 = [2.6331041965499819568;-7.8155648478051586991;-5.6307891530924454315;-1.7450652538270678971;-1.8916110692824776862;0.61430165923791024696;-3.2023120761132033429;5.8244665150517294094;-10.561323834343111727;0.7270443137149031898];
LW2_1 = [1.3445077698952341283 -0.41936103434637067577 -0.2914368311519991428 -2.4895857250275259531 5.1646601246434888921 -3.2995799243622414565 -0.68278391676252536691 -2.8546239942922562172 1.7871576195897032058 -0.4331003255294730292 2.2580119487433436554 -0.42553841790208846163 -0.1878911880563260417 0.3107806982665362594 -9.816665564364070562 -0.70516253875500134463 -0.84576275486953067517 2.5634613700530244351 1.7395166889988082914 -0.70651502374451136124 -1.5052874397446875943 0.41518129460790970109 -1.4029006007484183804 -3.1195661684949942405 0.18009795707114897856 0.26774258173153747675 -0.35002847367694983616 8.9321204797948983156 -0.26634128394514305915 -0.80671099630644815814;7.0652785394427040089 4.3528387431890305237 3.1444657898453503009 -4.4081887900597376273 -3.2653252804777674889 -2.4159342491287056909 3.8217352337966854492 7.4004495865282837741 -4.0376976846650229902 2.2021035788901954788 0.59567151683711794252 2.2801720395647802064 1.3823727585140614949 3.9873733659610253177 -5.8285186209707404714 -1.103727573809291318 -4.6738684143437891905 0.89505718743380602298 4.3996538696468174834 0.14813342163864032242 -10.9663245870611199 7.653681625089331142 -7.1582529361451117111 -8.1003018700323377033 3.6731484410847499156 2.8155916668541149939 4.1483003994213936139 9.6770292287884593918 2.2247728009201912514 -0.54288107627051540582;-7.2575300108628093554 -3.1574545957938147112 -1.5014144536586937484 0.33502943251717276496 -1.5610965726050318736 3.9638083539985915493 0.43819202581265997987 -0.64169619935811783584 -6.1919916955083342813 0.11694616750213303324 -2.4755402306705187598 0.5306266715884980778 0.16901003554259388939 -1.9073177495079660648 3.8426288599516205124 0.35167532840654724957 -1.7786096140608329552 2.1876823098829190073 -7.4687515385757938802 0.16684182242463588275 -3.8341848213012705848 -1.947785030838687037 0.70113833807329628556 4.3608785776155674085 0.1755213686135075335 -0.70250516703932708307 -3.7400693424440349943 -5.7206832728347132289 0.35204098076565631947 0.22027892922899605654;-1.9205787215226608478 0.37316696732296489314 -0.27433381579004906259 0.41672757454140207933 -1.9130071695691559519 1.195851228194002136 -0.65311839268154925353 -0.48604308182742195221 -2.5712652809512106522 -0.030796236206946721314 -0.49763705856876644384 -0.0014508318651499400517 -0.057625572110000577997 -0.033383163941054984358 0.10422823058084695891 -0.40320458517946566879 -0.68429330438654012436 -0.33227177338258334638 -1.5831309926475798378 -0.38451370520572353273 -0.35028934884683826656 -0.88879214667716355258 0.046004992870635183499 0.4912648452745365657 0.1962705849192473706 -0.48341358316623278535 -1.0838996698566929489 0.7911932538540816795 0.33448147928541244189 0.20750218371014800267;0.60723122117484218396 0.05735862323228213544 -0.101356132227556614 -1.15532637219628187 -0.70277439354853010745 2.2571481862203928159 -1.8239442451853788985 0.43658330385795174333 -1.5606230876492781512 0.1370563977157393809 -2.6785307898679189265 0.46990249317382276617 0.048515965928389588602 0.19724991040874279014 6.9985505209956260231 1.3280504865201978593 -0.42494581588260282867 4.4163135016449670545 -1.2926178636801046729 -1.2684674121020833581 1.3434622155244611008 1.9761581633160225646 -0.49273204657194402678 4.9480979487321521404 -0.11267605252602158616 0.12503204062259734575 -0.041752956689944539792 -5.2622734300454769851 0.17472019893193821427 0.77580317469977011502;-0.036627976494200006896 0.064994199512132075358 -0.075019729609634280831 0.087619035588966914796 -0.090023329042829919322 -0.2682707577868400084 -0.034706925960206920501 0.22071409559613461293 0.42099644147845977082 0.010857505224360838869 0.041006477753017890608 -0.00045991373580196758582 -0.042914151515472481746 -0.20241443070454998021 0.84209983034483804065 0.12826369086883829262 0.099258872208598192266 0.15411724539355411978 0.29471221989388446394 0.15284759475556186636 -0.059154566259522083083 0.094844166043018901524 -0.015400347564664422853 -0.49489843155367119198 -0.011844217395913809315 -0.032023135150561404805 0.088198267545315900406 -0.56661579296161623809 0.020343695542003947113 -0.011910228264264672779;0.88758903223949336958 0.26555090761862892856 0.11802123522324904636 2.8393551766948736947 0.38047212814057113084 -1.1921745253035540557 -0.59069083589632953579 0.0068592581794634510661 1.1386708761911139565 -0.00021175751578625154445 -0.92536358586643396862 -0.16849023764486587007 -0.22354036249213563026 0.32834770219294806548 2.4282179845162650267 2.0543407019620629761 1.9417387351598869305 -1.1774230421158105031 -0.037612182910677673109 2.0410890866200350757 -1.4367283331319755657 -0.45811092842735762209 0.80101934176400813037 -1.4556592045932517099 -0.068407584459555179079 -1.5361308059654046332 1.4714606228592699289 -3.4744977540263008997 0.03019737040949847795 -0.89955375615956811863;1.0974830109802875544 -0.11439557500578657889 0.59636867235678547861 1.657916125300853416 1.3380801441557852449 3.077177371650416049 0.74207560404425487732 0.37468936719672130131 -3.1951713394303733473 -0.4722645681011356511 7.4389445971893177756 -0.47342884657143985416 -0.22750811676654400517 0.1558139703898701045 -7.0834378513622366924 1.300286613612558595 -1.0638678232504554799 1.4206276229814065459 -5.1783440970557244043 0.87782440729807742485 -0.40970226763028105843 1.7228238067977115211 -1.3473400171701346295 7.1139038380442292109 -0.56106842064864548281 0.15955657558805011464 -0.61597837578097180966 2.8577882057492938195 0.24997878758465241766 -0.25287967989918869183;-3.806478780340120327 -0.78538280228405477068 -3.0522570702162044043 -0.54741126931035810621 3.8772710719887459874 -3.260266894999581222 0.86317280304086130283 -4.5746107992104416695 -6.7174395472602936863 1.6889655321836303248 -0.74731123156768552995 2.4315067810662180925 -0.18120698238315807727 0.96188857766435131857 -1.5191709122932919307 -0.27234693505613344344 0.35357928557186446561 0.22367793434338253955 0.43572254063985488282 -0.41852529644855512858 0.23999831356791337389 -4.8179264290651957481 3.0345168128869257629 -5.109426151172575814 1.462576207730829303 -4.2346934353161760356 -1.609364168027217934 -1.5829650745225878339 -0.51653815597360352996 -2.2745888015367299317;-0.39811032391595452262 0.72023198641440500101 2.4450826420937641359 5.4821816182389149219 0.037847355320676762114 -1.3117909087007955105 3.0769713220245140661 -0.6141894566693000268 1.6997972354753314583 0.90961316396494318326 5.3378454753176916014 -0.94254032021651290574 0.99022323797785993804 2.7372858388917848949 -2.1159149849507339347 3.096702361629153355 -3.4836911366129306167 -3.8667544304117411613 -5.9399823599938610386 3.1872964469271818366 -0.13588314867235384842 1.3049817652189008577 0.43092340728572153807 2.5100055181629365997 -1.8485230826548855187 -0.31021671878949280687 1.6521890217002905832 -1.8505488731260113511 0.60097442558210112384 -3.1531058688574353788];

% Layer 3
b3 = 0.87466744542483931824;
LW3_2 = [0.099860113846719347763 -0.010878433548242732315 0.12354152377681935915 -0.17590317572551336656 -0.11133015591581432724 -1.8862591634011574016 0.077508382897089514452 0.037909957288591630831 0.026573301614743399107 0.019669627569305500603];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
