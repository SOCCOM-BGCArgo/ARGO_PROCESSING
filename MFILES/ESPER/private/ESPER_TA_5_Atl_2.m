function [Y,Xf,Af] = ESPER_TA_5_Atl_2(X,~,~)
%ESPER_TA_5_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_5_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6730657203400980393;-1.7735132951842491611;-2.2781637562587979673;-3.2418943392533190462;0.34375008710711629778;-2.0593531529571955652;1.0561109615209922641;-0.64134681025048290159;-0.060469817288057656213;-0.69682352926287893791;-0.19829934856067704674;-0.78218336622530992841;-1.5373998840174860625;0.53403687983043535148;1.2526905799281291554;-0.95419215883652208632;-1.1733411764481704864;-1.8043727552236716871;-2.1783926211267621298;1.8125056793299858526];
IW1_1 = [0.18652194314395423302 -1.5174999638075579167 0.91435744234424454202 0.049044757279919963533 -0.21499925136574773998 -0.51313504183909397494 0.070981786882474529055 -0.94923119432947455909;2.3036812287911132557 -1.7454094756922386988 0.7804590915957635433 0.1813642595496152421 -1.7478542076672907157 0.55574122260980884924 -0.28501451216286488588 0.29866396027566716187;0.72826852962240118394 0.55585527124920786068 -0.58801875364793865231 -0.86046979136422196976 1.5677496907335375376 0.47793063083769576904 0.075995271984588955161 -0.83971735908456257569;0.17290447636423209032 -0.26181132942767260108 0.3335327929372296496 -0.15305651249024207483 2.9605849564721831157 -0.39783190213388508472 -0.21185826389439219031 -0.23237664165488997048;-0.57949448948003301485 -0.40144380875993462832 0.61928104393553151663 1.1092886263206169772 0.83913374327435497069 -0.82369257139460372308 -0.14069042731720052264 0.3652998540854656695;-0.066832891304421757073 0.8523778249282637498 -0.29939920137293707381 0.21838556300801303944 1.2723532222034303896 -2.8893006907619396273 0.39392710905228245366 -0.29147926428228165818;-0.63983183176998414954 -0.59341947690466945176 -0.1484463585579744449 -0.048681455888189832659 1.4012411006263358892 -0.63195265710954784399 -0.31444135211949530984 0.86496627153782157382;-0.15076215573655213364 -1.0587802757357545058 -3.1453004941899234126 0.69427111625911730464 2.5626874104023369405 0.14203337932102541585 -0.1603505540167040333 0.6141119265603495192;0.8721882359940615892 0.24188862463202429054 0.81901999849071271953 1.022270319937383487 0.44239246650301200514 -1.5034664581898609104 -0.068860887664702954969 -1.5093562697917990434;-0.28065943316026126242 0.66793909664306383434 -0.32874057931237055108 0.30082099202018314221 1.9909631762711073044 0.76759160302826867639 0.10086079257479554916 1.4405226609894323797;1.0891377729359905668 -1.2143947560896328763 0.83937169775672471062 0.1817148160345543606 -0.76661432218860470211 -0.78269611925918203266 -0.47050067828698460826 -0.51133695870621398427;-0.67010645682022673686 0.30046680468349845627 2.2561777186680096463 0.30660407959604751849 0.55070103842076578715 -0.18543542806413593205 0.61347336384002260079 0.13626193619228338383;0.37040183798289672001 0.13966842878300231301 1.8161693269554817221 0.14411540358635654968 1.2453608279529428948 -1.2937464946316112879 -0.39277125605128898611 -0.31478818591690099771;0.44406308608078254307 -0.46009409322964572864 0.37572503395112660796 -0.28559541098711066498 -1.2288855479116622682 -0.72993135930436048309 -0.34762842842152136269 -0.42262579720463716582;0.42084029759988678121 0.039235075412954047158 -2.1034359889854705727 0.11741891725067510333 0.51084148308035171038 0.35456505904563212495 0.08598903352611098061 0.34263767228627550754;-1.6370926881866303404 -0.10111053109429257724 1.0903467453145068156 0.74540786790444168997 0.73502954157502908838 0.43408839515500202699 0.59829484197415327973 -0.7494590281456303682;-1.6893168526092134929 -0.35542168581929323157 -0.80876151979237398404 -0.344915814142106536 -1.5245489862666108394 -0.2291344590501967482 -0.074949667635033578872 0.93481535491413092487;-0.30439396826300568755 -0.30931580455764190463 0.35760358259926805502 0.31241519256507055413 -1.5739054310158981931 -1.6018502092580602092 -0.2943943542061081553 0.90877656053549438209;-2.2125822307479285911 0.086548878692082595321 -0.50472509744181759395 0.29591910871607363109 -0.5438917315742156644 1.5807433427844386209 -0.62629089473761934137 0.9632355663830348691;-0.30825126131791302786 -0.38272073931395811375 0.70391093800962623028 -0.01005970336789244711 1.5250667671160180738 1.540197431377483106 0.46994390135446323375 1.7384516008055213021];

% Layer 2
b2 = [-1.6253092184755826288;-1.4853571423788789474;1.3038313248848003578;-0.95207999383461616727;-1.0300697959166664752;-0.71209252218181873229;0.79900996702509585745;-0.16759163098304880046;-0.44306287507280167626;0.083681726020241500863;0.12283772863453457092;0.34046376843122616584;0.57472774764045264639;-0.71539810780832235881;-0.51129139089010888775;-0.80982467169310079491;-0.74439326086682744421;1.7259935242589523607;1.2385161878217163522;-1.6117967891106164124];
LW2_1 = [0.50633852822070002375 -0.37833438840722438679 0.54290570544970162548 0.49546055812806799601 -0.72929188415820178637 -0.59615611555724046244 0.34647978788627642466 0.13020549068296144446 0.40757381219405314221 0.35493085864709728039 0.41493528014100389267 0.19857954114252618361 0.63362755672074977387 0.037502916457920754123 0.98183987243619030849 -0.78608067125175229428 0.53820855939892753295 -0.21490076038848743289 -1.3140134130773009069 -0.43566303048039300982;0.54100684517764807691 0.027169776765495104454 -0.087304704944314984183 0.92259570683752589737 -0.082363960022849361242 -0.08083234625494464809 0.4209906241534747684 0.0024470713174012761505 -0.35791539080493872671 -0.03867937392880658326 0.98913913864531588516 0.34109469126587660393 -0.54081871617003229868 -0.55955212679855548252 0.39854968674465957035 -0.51957632728456015769 1.2984105635460529982 -0.49600618886477720881 -0.59138107047073085187 0.54844024864505924732;-0.055857865969709333265 -0.0014392435740243503944 -0.30903701754853918349 -0.34352548344972572147 -0.23524959638421424901 0.35758306447759186097 0.096774773937057009809 0.20613026517350910294 -0.70163590949524945461 0.78921353581829822854 -0.48426399663145003327 -0.79440136291462570828 0.30683865441232494042 -0.64806142638582586724 0.48095776455860056453 0.63073187785450812726 0.045165421044138516493 0.32097411590320523711 0.43676859755626695758 0.18245328857280379564;0.20063664960089658273 -0.64841370481515503421 0.48387943368856733972 -1.1024787673069722516 0.49247838010429617617 0.10367136680550337324 0.16064454703751265829 0.0013012978617252153601 0.48244981922727014911 0.3673598938271721015 0.48172162058827566744 0.36201586148228742656 -0.14282970815879336701 -0.013116757989273784141 0.58050144449111806821 -0.58654998067861363609 1.3901188184197128539 0.6184603247348674504 -0.75818946878585891103 -1.1153072287745691149;0.15486793432634643475 -0.10076399985075842891 0.89446032900820304778 0.80264225968624436369 -0.54709405687070189472 -0.39953801287816359533 0.14357455673912708494 0.80258946715816581463 0.70502032769087941144 0.065082308425114171468 -0.015628673682176873194 0.28285248831749448817 0.57047106072610476168 -0.3955082711490718328 -0.51691708836863947685 1.1115567106935599906 0.83638230981202277281 0.44508287836104531987 -0.34272611470968122882 0.22059515200499341114;0.19588080102890478851 -0.36733689624157123133 0.6199550878291186784 -1.0512910647484359217 -0.4177983613731536261 -0.94845543789943909108 0.56110821347691863803 -0.17031132771283613581 0.23727164550863866221 -0.32646026629070140634 0.41046412438996521255 -0.19033425210287169271 -0.53152925667791905973 0.32929510345869733579 0.28509489648891650493 0.47933529684957632 -0.46053312406140572977 -0.039437366946642259113 -0.19978681807001952286 0.54371613273868646399;-0.021508184234786377476 0.19098516824483544041 -0.15535592678239584785 0.46475293263909844832 -0.32512878408743378644 -0.10696171319802835753 -0.14346876937616848124 -0.018624959402114858731 0.15008584064143681847 0.35541412862642790538 0.60172813991451168381 -0.10046079963535266277 0.90568283870823462767 -0.086678270584773370322 -0.47664287105251285093 0.47385989422775043334 0.013587552327499204108 0.033677913273078445566 0.35913886853841348046 0.23379148437757465984;-0.60495313312121601346 -1.1229255236193478318 0.79646564527437502257 -0.71341971431004680415 0.56884987227958738742 0.094276965150313696284 0.13964535314753273587 -1.1307506474275013097 0.15538382090519400891 0.61205305605087279019 0.81272968970796766186 -0.86466107442130379912 -0.12937283230911922338 -0.10309445235017096476 0.89630378464397364446 0.52832608561973704031 0.96806861422367096459 -0.63883846068725835821 0.39471613115652082193 -0.60928783254927165736;-0.28971609014751503741 -0.35486558813612606444 0.22921331126355726227 -0.014355113798299293931 -0.089627475374241635797 -0.27936733651918765897 -0.67240956533695461772 -0.16929504204977421922 0.50295687061567218024 0.2823779460552711118 -0.037650081984655706102 -0.2698368557979786142 0.27478949652896689226 -0.17719138800933373346 0.22773884776270827968 -0.053294850258546667965 -0.67158250506355154918 0.27012785126690008752 -0.11196001036581462729 -0.38351331216327444462;0.11205994156762098812 -0.56335651970206823691 -0.46207380762146266218 0.097531936274318775659 -0.50922489304959805967 -0.74234218773605975539 0.2002343379982014504 -0.61925621871679692454 -0.27354275102645370099 -0.018154974185356786281 0.4323206534560950498 -0.54567285525532638335 -0.1153632905118945895 -0.68883764005113934381 0.038756384558919658445 0.20176579953288403813 -0.4723048749875694563 0.098660322048666218575 0.03176648618337256369 0.61966335571038633212;0.58642249522845624199 0.40014682388417466274 -0.58174204954036068393 0.28650482207094735143 0.021560449439339449129 -0.39241473662194370498 0.36037096067485596684 -0.14152130361094211741 -0.79445386707503384827 0.064244259761285713028 0.24053937370195732637 0.057941113343167829908 -0.72012304652863368126 0.43755157199344829611 -0.58190796760774476937 -0.051160587955047021058 -0.35524574318089491287 -0.090599969369166727384 -0.2156178255411714817 0.79836544797507325022;0.75066287724987901253 0.04715903170680679074 0.084695481523967011683 -0.61656200091809010289 0.57789139661255162217 0.48422258961719805148 0.49362203568290546896 -0.21560361378225181839 -0.12873980619827565808 -0.15898433144540055628 0.09896893550275412399 -0.18378904643386367868 -0.44349869274334924318 -0.097237649216082397419 -0.33026748877301453922 0.35816030578752466873 0.12849943794820128939 -0.88372147740276396632 0.29186160919601483732 -0.035674851936716552026;0.16248233068911940857 -0.35718328078101713174 0.056818470915790342257 -0.33690781157497168286 -0.78019221579424335999 -0.74907359727737266031 0.73822454410448234974 0.36675833430636500809 0.054598265560468352275 -0.45311559619443442237 0.16187863405663302507 0.35618105942163119648 -0.39195573481629131241 0.24826538083096655329 0.33660522341009690983 0.064020690914718028641 0.24936330603939174666 0.17119008160714985212 0.3621035882994634858 0.52879465916539447612;-1.0641924636562287709 -1.1386038294906353219 0.5592557051061427531 -1.2497112648771293575 0.40503343488749699031 0.13109156528843129985 -0.69253968094630391494 -0.96673318103244976207 -0.20245824981016619093 0.1374624034963198016 0.49193000602255265719 -1.0182694823259812456 0.53541265245742009071 -0.34053938537558642308 0.94517221716332155967 0.7189094145255968682 0.69704770808277993766 -0.4967429521478475829 0.26549452494309716544 -0.27050490239045876795;0.11202069486889132399 -0.52578062777726830568 1.2887477596769572052 0.67005205027475556179 0.73077346257798370122 0.74759398860832249056 -0.17166750636928979068 -0.59865771609570850309 -0.28067062064965442314 0.39011002842046366146 -0.48831388722276947156 -0.48613741872165155966 0.47478389089046479921 0.35335668696494559882 0.36330983669640187772 -0.0016853918087293296574 0.64181922681189540469 0.55261763562319310417 -0.56385401225236531086 -0.01974440443390291372;-0.2925190822730268092 -0.45908253948724592197 0.44865417145956443257 0.3041039800584138808 -0.54510769352410459732 -0.85979683673704754288 0.13851140459942432037 0.42843077704658427685 0.76417278342672034785 -0.014720550628827178477 -0.052955684288196934462 0.16092539068757721887 0.28811623087172033575 0.28324635551252197452 0.78861315912162888164 -0.54568620022873037811 -0.27964498710966989581 -0.24386177436129008456 0.60853528073205032101 0.52145115154248877776;0.26385738807049546883 -0.54649823627873905796 -0.39654721482517307773 0.099712344789129214728 0.54677097882656444661 -0.67320150683494495158 0.48904299945636647839 -0.11045511743544800254 -0.60047513559552245788 0.13584211668893536595 -0.011194857513543573016 -0.79499629099542690192 0.67125732709323138181 0.3509266938020955684 0.56053061589222963335 -0.79212785593698620268 0.24767801168713271531 -0.77483048671829057863 -0.17099612534814798148 0.20463334128604340756;0.63101758837941535063 0.12751383389969744853 -0.067302796829563943382 0.5640176410428892062 0.25646674477778469425 -0.72822725862230108795 0.68777198694232999365 0.6046479038272295492 1.1824348375951234669 0.28405810930020169991 -0.036805065925478538946 0.0089723000401179722058 0.7280800892001846325 -0.090751358047988159305 0.4863496146458531344 0.17003442069825855376 0.16695446458936660794 -0.55278252515639125786 0.55441893315637613693 -0.38597939177410062195;0.081092275559134341378 0.67356501452802353125 -0.3936997528865425755 -1.5783715220203520246 0.45980543273658502912 -0.58772355428566036561 -0.058485321127056094648 0.33597714480771417866 0.40596100402065166124 -0.39983354559678968565 0.2536832587381179227 0.086081233720976674251 -0.29126727672041968775 0.27755846610433271282 -1.5748637285994102619 0.26610159094078028597 0.29725527742305279943 0.15427394895148960341 0.85517115679929200933 0.75759029105723396658;-0.099477470197853953837 0.45106977204508835744 -0.51795778433385397665 -2.0927103445862078601 0.54684187929225780422 0.041288101632979773425 -0.51971997313859807921 0.39432347908546816484 -0.20009012302038767239 -0.6707192821115988135 0.1871695949892849542 0.26241068450048815608 -0.24110267117659200942 -0.30134026804271973887 -0.2996805395952331641 -0.26258263150587662915 0.78642031782577637156 0.097975751693984161617 -0.29792444723084682279 -0.62599896386168651929];

% Layer 3
b3 = 0.42040259667098545115;
LW3_2 = [-0.25365488727609192265 0.35100042516147600402 0.020683983102669983162 0.26375828088249042569 0.71928845271308050613 0.51099787983424704851 0.13933880991031022401 -0.37755249241961186257 0.53151020571252072244 -0.3414749493577878825 0.88359983336750869132 0.90145574341258538631 -0.29644548605567955235 1.3971314797451126477 0.27528982189087808363 0.13753028613580017825 0.19045535695688303734 0.55594593064480724021 -0.1401634406316837056 -0.53235710504062994097];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
