function [Y,Xf,Af] = ESPER_TA_6_Atl_4(X,~,~)
%ESPER_TA_6_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_6_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-8.8156875656465931712;-2.3665145824083850812;9.9213484895279897557;-0.68139016755844472595;6.3618057366886651138;0.52052794901336907341;-0.36877892564673764308;3.4804447297790876981;0.83086256649334477853;0.90197985749733222693;1.1878240938837953955;-5.7380922031529015825;1.2915199412788251898;0.078942536648681033151;0.31541199238079808964;2.5466164969719105038;-4.5454533698953412113;1.452066375796617903;-6.9229382005897992514;1.2398094218146240575;2.9399385799452311119;-0.031650499273749917173;-1.0579171112577665514;3.3873315142064712724;-3.6104217976671226786;1.4576877237045469116;0.78122634234252885665;2.5859760096180117728;3.5262547586385624143;0.074972333439992863702];
IW1_1 = [20.791888207640287334 -2.179535254010847467 -3.0177000291379894037 -4.2840561503583911573 -3.1245849816134585453 26.051028615549515877 17.994278720616119216;-0.31298280983965742763 1.368039331548765114 -1.707853127971684648 -0.12186770470837927915 0.19008021060558358273 2.0174596467194811922 -0.91921895387657037713;2.0352061680598443338 -1.3629067500111387012 -0.69308614828442038913 0.0078123985146700790361 -17.836514642800949559 1.9108875576695660836 -0.57977247639449713823;2.1261076095809468001 -2.0410805086265364494 -0.24127678718239345401 0.22970840009831663964 -0.6825691488863787626 1.2931957472058699388 0.17944634857935440331;1.4309110354545093724 -1.2086683542946816683 -2.1160082874845662637 -0.044090013917402873234 -4.4859895824287292498 1.443443885447439845 1.7072416078123002769;-0.88167124688993925297 0.77614420083059865174 0.2078152679209524234 -0.33637116278756312715 -0.11996162003195162682 -1.0225734200432277099 -0.43943319330263230782;0.18309977008095812412 -0.26055189927403199501 -0.6640809317078312235 0.27634387353727668524 2.1773802267781494635 0.051554505501858666205 -0.12056672624228208235;-0.74661204769819533578 0.22430132749530731773 -0.50341309548312873634 0.40547749818399037025 0.77317036969387997747 2.6597292824414875412 -0.69798265594115005417;0.15111589447189521795 0.20480469899181799609 0.70195179560226650395 0.65046721723392086911 0.15749569661235968132 1.0924452368664725466 -0.049078040857150069531;-0.1792662345082050579 4.8515812828822069136 -0.42694349332890618731 -0.21309422689433529796 -0.83711197875793041945 -0.84843132879173610572 -0.18106980766581998177;1.5181600665288539354 -0.6174405465541824567 -0.81977288822923410905 0.28517249664381211227 -1.493282928640767615 1.2092309778553198552 0.46621232318150773732;0.47117821621702443702 -1.7057172265552664747 0.42607196397040436597 -0.21846191833632180868 5.244048041302055374 -1.3464809408111639843 -0.52786718762103856939;-0.2103744757038862323 1.4874974022668983054 0.43457414169424601891 0.22719571834382951137 1.1732678142995325299 0.96024702557895180721 0.64944999415793669417;0.36530645972882991313 -1.3243425461554192424 0.09257028549684269414 0.0081699168928939993467 -2.1209006967861512294 0.17326959810957573427 -0.41778651365406926921;-0.34824798390492700539 2.6378424052721860527 -1.5483030097099512723 0.16397453162442590657 0.91584478025625104536 2.8758842817665080105 0.68913138561398123993;0.79308564446559026706 -1.0752867750484824683 0.90771633108255800337 -0.20492224229326280738 -4.1641329965615714315 1.2223243925939377696 1.2043840550270250578;1.1419911065754353441 -3.2612916708963317625 1.9247451693760457836 -0.92598100019328510868 0.029573681652569190625 -1.2650972847260939513 -0.71949859594170684218;-0.19061627723692381453 0.46587461563813747922 -0.26961852450846712781 0.26015309431063854406 -2.4210499014296673614 -0.45882105371533399296 -0.57135308247763794132;0.51161149533296246261 -1.5783629836024697379 0.65560071333911562608 -0.28311835287343045664 6.8904069562824021844 -1.7379561188598666721 -0.64506035790257798546;-0.53567339221430876339 -0.35933637862227529869 0.58966083288404069762 -0.028853820558782539846 0.80390253903802555424 2.3497207849829333526 -0.50172760555361328727;0.19867280646577789582 -0.78589050455048625743 0.15193063409342638659 -0.66877899295298881555 -3.071785512561779008 2.0729953211410507841 -0.59911120187702082696;-0.8953648491389100128 -2.8899586728415567194 -2.1280761667291216988 2.4715780327559140339 -1.2733032745000896213 -0.086117480404345317369 2.6945222017157268724;0.8985503690984677494 -0.89064832699370855007 -0.20514293385633786126 0.33210224526462533978 0.79411101655973392877 0.95428766576613166528 0.41934152801422652779;-1.7385827150045327638 2.2895136288351269904 0.6271181186397062346 -0.45128357688326387054 -1.7848287334999679565 -0.82396501442389835645 -0.32534774746291694747;-0.053173615936253616765 0.025025319051786551472 -1.4288679081908666202 0.64137581051552383649 1.2446664245474552413 -0.40027590721564787479 -1.3666255481207392197;-0.91638682835946971839 0.40852479061383689674 1.4963436629684923052 -0.59883249647884162492 -2.8325847833945076992 -0.49225751988414617744 -0.5284197175150806558;-1.368968113491448646 1.3799556131435082307 0.43664457903119197058 -0.4481888162927136765 0.61800182569156947299 -1.1967286857843064674 -0.49855166528391603453;0.16398891428992162789 -2.2690258159485776623 -3.3860336951337397515 -4.8100857258748286327 -10.35054179449454459 3.6663788134797221652 -2.8540124151465815494;-1.4216380800549737184 3.0945891857355505294 -0.55092926465833158556 -0.28215340180283787763 4.2693307782286860075 0.20280122991756652229 -0.40358570398681170577;-1.2732095190972838594 -0.5719275061937194593 0.79470443110373822915 1.0751629822525039515 -9.7025401516690479298 -5.3736377834646624763 1.1727754507118481886];

% Layer 2
b2 = [-2.3596367975413272688;-9.6053175621052986344;-1.593897405183856586;-0.3056681971281287602;-0.17336192853346615861;11.249853315420098809;-2.4794971216399184222;-1.8203662906527477983;2.6033087804731058768;2.9680535957002920355];
LW2_1 = [-4.8455373125026017789 5.1633255973966649677 3.4594031093332522353 -4.7854530326413522445 7.2070056877222263836 -6.416775242857337247 -1.8854811007322025418 -13.119524438788859655 0.44239312681694947793 -12.398399889284327458 0.56801356436008332285 5.0849969854281562576 8.557833027512215196 -1.8655371234437414518 -1.9330081860743637545 -4.5863288341801267123 4.8426628141250622761 7.8996857396624049485 -6.0819529355991797104 12.076229630222952593 -3.3394305374159181099 -0.4426807760514018808 -23.190568173205978297 -8.2942707636955770312 1.1716386213050977716 -5.0074883988046456906 4.9719741870653830773 -0.081513981698313933699 -4.5368651516600495555 -1.215114781129281285;4.9181432232938382398 -23.23693552416006014 7.1169239804456392307 -0.54079526190506710392 -14.18305121355252929 -9.0968803949023069322 1.1557768421344383203 1.6441205473242821444 3.8926282594648586866 8.697295733623290559 -1.5780268606789569219 0.25905433971433677875 2.3187575459333125139 2.8544306983967535629 0.41941393782914970778 -1.6896198562886477479 4.9358332078245386043 -2.3473367745208757462 4.0135598443619144859 1.4156930736369006674 0.10471609168424747538 3.0569415447644630035 -3.9702896285595157266 -3.3878603972369814024 -3.5958460410428605414 -7.8886908482605173631 -0.85475667270194577441 5.7910468272221740094 17.879404473083766902 5.548978917827678714;-0.0019935792517207910103 0.49546846358032547997 0.045862474356130153441 -1.5755299899717141177 -0.14675476628193306894 0.46635364679736684979 0.55819211557926984302 -0.85306674916520575103 0.44744338777571385224 -0.35269733473065933982 1.7915614779884831975 0.18826382977209621394 -1.262385825903584724 -1.2412253892492211005 0.1905237804232783605 0.68360905985684095043 -0.42624172978051588778 1.3334693999843110213 0.13669967538162963727 0.57558194523656835973 -0.55417773725956553932 -0.00069895080695130400346 2.8509993729675970897 -2.2091982401120469071 -2.3197814417036668466 2.3251551209620648919 3.8129894258957728326 -0.058890783574209792928 0.90062365392641829942 -0.05063305084675676776;-0.83745391125691548417 -2.0597310353176565556 -3.7543761315059920314 -3.3113153296776882684 -1.8005062358389958277 1.2458194347018249903 2.0297280011063767446 1.5189180140683888887 2.4342706472210369206 1.220607082294580481 0.32858380158885630573 -1.1411072255291923039 -3.7380850937933853828 3.6326729535725261755 -1.5993985576892275624 1.6953189618956598927 -0.9490660646428774605 2.0311849643936703558 0.31885698856074423668 0.97422049155217405048 -0.92972896108909908186 0.93372125861649324374 1.54613286943563355 0.40306976526186999443 -3.7081973136243009392 -1.5563712794039930021 -0.28039487993625805684 0.094791171352555714247 -0.73944562710450167931 3.2556086345187784659;0.33668433382306717228 -1.9945793743352830951 -1.5708864954815224824 0.78430339003914506524 4.3476335416360063491 3.8738809188685809914 -2.8307640723418918682 -2.8225237638148996666 -2.4003497818526122742 1.5045056719993394889 1.2622534645150251809 -0.70027317922476195466 -4.2517577053432447087 -0.71557423037701073376 2.1940518352297582183 1.7853682957571168632 -0.05415635237907015509 -0.69234903696230909453 -2.4102200265047062366 2.8498241604326590704 3.0806990896490558107 -0.18084874455779115232 -2.4206056224094520957 -5.2497514443934738537 2.2309274940604977289 -0.57840229542711518729 0.3978210452920900031 2.9389200760488369824 -3.1705239547719283877 0.79953372662103061597;-4.7116718520521105873 18.100454452884275014 1.646374644458644676 0.98289623953420535152 2.4097572069044224108 3.4068903386728601745 -1.0368772685978964176 -4.9634719124933237566 -4.4116332315399553465 -4.3437117331970496181 3.4996926605521903042 -1.9610091052340559159 0.46490170632165478404 -1.721887644355926561 -4.6861988515727031057 -1.7984513312329493129 2.7797999144689349293 -3.4990360501730219944 -1.1987976566618501195 -2.6354951713169061378 -0.93652009630113508543 2.0211626022496647082 0.12824231788269219168 4.6073750718943475846 -1.1787004749223199962 5.6810883742941085117 -0.71411813122959466593 -8.253973694739244138 -3.3083675331840614042 3.3089267661706993628;3.3436075137541156899 -8.972237545098364464 -0.47630404278114185646 0.23816917269420137537 -0.1300589813018199481 2.7782430789218572897 -1.1480456029518886218 -0.079218328777078572678 0.31778079104214224104 0.13641188426406641865 0.084213801139880140045 6.1856435782766538978 0.77786015958086729416 -2.2479874849164267481 2.0406824425826357583 -2.8866352056851707353 0.89282024978246943281 1.0430873860975840017 0.36926197745859290489 0.22734230130018526217 1.8691559112765177009 -0.95635288879877200507 1.1578842214210012251 -2.2312098541577363164 2.6053205710306959197 0.64132581681787814709 3.8458014795647024187 2.980539995371258577 -0.99066559193278524997 -2.281422783944024868;7.0067056591852709957 0.15929129948673198536 7.6161747294236699091 -4.4425808445964181104 -3.5241931210142332098 15.436815354915017551 16.899852881366971502 0.99662836035859836414 -3.9058837950782798742 -5.0464088358239953536 -6.7178168433049716413 -2.8190810189654764706 7.4797548250702199368 -19.817618522574974804 0.67537943647148634962 -13.717359839250281794 6.4576021250819364283 -2.0763731076488984861 -12.166345820715978476 0.087782067223910575926 5.4189442705038581849 3.1874266527124341941 13.562663976406577504 5.7328785751931130577 26.090022822905542199 -5.7317970238529101223 -13.739549485775629734 6.8886046957123294732 -7.2170655559958456493 -35.286423582441969415;0.0021586851913024348616 -0.45580437633022025112 -0.06404168133835547172 1.488658980652947994 0.25883292444346384098 2.50293077138048492 -0.85414224092157775559 0.77405961453077132273 -0.50542698657629436809 0.27904047142132759607 -1.7214998437109869656 -0.56945279425459793821 1.2679706223703339774 1.3555315897132420577 -0.21783880664593829879 -0.62632078180916062049 0.44467427014963806231 -1.0285147095821689511 0.071592581787155717965 -0.58831068749345505342 0.62819220960927679709 -0.00021124484808112978999 -0.064254373084398130889 2.4556810778892237401 2.0309106096526723384 -2.3360407731450449909 -4.2653662695674068317 0.061523973760483872952 -2.0645199078121665437 0.022257619155937175687;-3.4719057675376832073 6.8722110458162051216 0.0090700440762239344789 1.2997280124226109344 1.2315526846845141762 -0.80799460661129984818 -16.508695859961157737 -0.030505506568411385609 5.9360557556384501154 -0.4247351229711971432 -0.73574505544088664166 -0.084327030092801291694 -4.8913833453081414504 0.85039715722941200404 -0.24901300550146401869 0.54938091951563150506 -1.7930887688494285825 -2.2932446111409672262 0.30394015717714939484 -1.2693943637661369017 -0.51669947619261169525 1.1367814979250221441 0.10467294592790860053 -1.2169211324206468117 -5.7689300479063829741 -0.26395040983303164062 3.0132461435541593175 -1.7925030162970581049 1.7255203084405137393 -4.2511646807375518264];

% Layer 3
b3 = 0.39786769713485725664;
LW3_2 = [-0.0021663577083553594432 -0.0028530785346562391978 -2.0599983950724181092 -0.0054026432135379958213 0.003651855619789135237 -0.0010812129881373412806 -0.0030256327760650766727 0.0010845114160319415612 -2.0825882961765684875 -0.0070312458268387981533];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
