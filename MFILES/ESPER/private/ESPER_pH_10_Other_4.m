function [Y,Xf,Af] = ESPER_pH_10_Other_4(X,~,~)
%ESPER_PH_10_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_10_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0906355206820910198;-2.4045585938320397368;3.6640360385736414628;0.79583535267595439944;0.2065871875004163527;-0.84931420928464784748;2.2940668391919776248;-1.3434748993611438372;1.5211408287444234677;-0.49801174489316024641;-0.12947695314234966557;0.21886090140463212994;0.41194890073241163808;-0.039808051348654824309;-0.42379261962019371124;0.79795354411934538152;1.020510304440883198;-0.55153567449948093238;0.2599130934811237359;-4.1150998743121167678;-1.2396732965301291429;0.11299026942646535343;1.2983587518995320931;1.5581820377039325987;1.2890726746318019735;-3.955232928197007336;-3.3103911168648032515;1.5661604755859732663;-2.5217900817095828536;2.5473540042255611304];
IW1_1 = [0.20213957305094218397 -0.55697498446447957221 -0.23286840336710759591 -0.71890214836949661859 2.2309051261146888301 0.4669137353588516115 -0.34985581828075840161;0.41782780938684582761 0.8489142107793506975 -0.18530137578628352868 0.31482408940436507061 0.52497530842207007495 0.26320190570037405031 -1.6517917036589557789;-0.17924755104322800947 0.33533525931125612862 0.094370221661389502854 2.0396868478040452999 0.32037568973031205211 2.8247948215985299036 -1.1407515117432185381;-0.40456080750257794598 -0.10430914535770184626 -0.65879635549868620359 0.30535305247222338521 -1.120311658587282766 -0.29731626762527091357 0.063658699218156922228;-1.6745154089818230503 -2.1170408394127595564 -0.051849545091992750578 0.024540400419739465815 3.504251025043289669 1.0115703653518157701 -1.3527507731732817398;0.8768414433283793219 -1.0942216344513890913 -0.53402989295682501414 -0.38727187195671475273 -2.9719109798713474468 0.20975104703358790625 2.0988013319747071961;-0.19277691857130072051 2.0567928228000904589 -3.1585882506617850574 3.1223749576671386841 -1.3396014248364365162 -2.6364593625163630364 -1.4505011296330381221;0.2448082051552985805 0.084092679417480026283 -1.0444258655418390269 0.89912674197276776233 1.9802716465685890057 -0.23489484500569504655 1.0258508100281680253;1.4969751287252019978 0.10079851956884812447 0.29073145538915112773 0.22328231582992003057 -3.5014576081937143215 -0.68934396080699988918 0.090241763329135388227;0.55194198981065500931 -1.0775571137839223823 -0.26996339028161658868 0.3916682666497385279 2.9452698137339239359 0.51913309574081234476 0.74335383342175276322;0.93377763754044484923 0.052874789027490452786 -0.22905406295996091903 0.088343823929770234904 0.11740175645175178476 -0.61791110597492027168 1.0641483123385113707;-0.85846442290618629745 -0.48968098992384800905 0.26877067145326483111 -0.52544235746886258642 0.7690842876691248442 0.048137209654240092904 -1.2025553502497241531;-1.6147774123139182478 0.57221818645715138985 2.1905442716299483585 -0.24012526885030988089 -1.3025474384624464719 1.8438783118997819077 0.80804109385404709887;0.037217057270962583537 0.18305124654525159467 -1.3525171115149223766 1.6024449659756518916 0.51346568194581621025 1.1590198511549745231 0.55634394232795880697;0.13995641189367896695 -0.70840186064871468741 1.2250342023932054847 -0.84320926057569023371 -1.2939382056312758174 -0.66168616276618441585 0.85106953351622749437;-0.19936232708585840956 0.69716945685407705202 -0.84623937431208617888 -0.24852278248999293275 -1.6430466048666241274 0.6032632327348531609 1.3792159462405617631;0.95871541052636366498 0.36465572019294278938 -1.2574996786900869417 1.1980323245294870471 -0.12282766064967642894 -0.047403585537094033997 1.5809699080483563538;-0.12817343989386248415 -0.45976866821077327918 4.9981647706895238059 -0.083076996324797550142 2.2239905776939790094 0.017233998348781580379 1.5857157385913638326;0.19947103337977969972 0.43423526593239947236 1.0144700945509876888 0.85003936576347449705 -0.60546602914148595076 -0.42891335680473663405 1.1800648301942509022;-4.2262513332942184263 -1.9956249609888971897 -0.26193022128615184307 0.6677580008926511379 -6.3326030322779383042 0.87902022086519404631 0.81754806526851520054;-1.2680748648148822966 0.9024841944307248065 0.69684392565281649823 -0.7249158592292812564 1.3967511456959811333 -0.93907425255815180076 -0.35470718753345503726;-0.65000389335943942193 -0.35972393199479385517 -1.5927626718982201837 -0.20440906962066085484 -1.0739481325075284079 -0.040085503596681122673 -0.5328793945248344599;0.68138264655907154754 -0.064843180384221488222 -0.3624961380350957274 0.61179260866033935429 1.5371348889462070897 1.080555996675667485 0.92339091065480716214;1.306458690217492169 -0.6416063792794225451 0.12615888999720575869 0.72419697179646380647 -1.9484362894967997004 0.5263904828939116598 0.84914595787967728224;0.85521380347277586864 -0.83204007419927283884 -0.935414290588389985 0.24343915498035825773 2.3352877660023887429 -0.68868455241284420865 0.075405823854328521416;-1.3088299491290076304 1.2731854731987894969 0.40514656926866698949 -1.2843459929064580116 1.4689099372612743899 -0.057189072916493381704 -0.19538724401032583899;-1.1825726481254328348 0.42048899460574878928 0.050870611259626136169 0.30212156795885292127 2.0101515101462701374 1.9714942753975179812 -1.5591782908065043856;0.19326856197045547137 0.526098860401965851 -1.5231238502840638294 -0.74839093195151895621 -0.99716906824241680063 0.018556653688999238949 1.7983004887856206544;-1.7772245166022206941 2.6844362090214599625 -1.435362868504921563 0.16223927948448282899 -1.8834686558804356604 -0.7696787155027785543 1.5233895903766641045;1.5737611659721650881 -2.1952005478324667642 1.5593270290340628392 -0.061083962767344381073 0.7943017030551879909 0.32365990651456089111 -1.7435024076556591144];

% Layer 2
b2 = [-6.5099450633388986631;2.2111934561989627923;0.67043760140458152907;-0.050851439301912791657;0.68475554803487248545;-0.045323459476272753843;1.2142380832686210379;-1.5854757968779038535;-5.0203782658999571709;-3.516080223651755432];
LW2_1 = [-0.55372714069809136905 -2.7853268624704030643 0.19960424526986769722 -0.40906003745786406745 0.5379298143826036771 1.332907559111664586 -0.16633408817151387749 -1.4777653587879411301 0.71380104550005252229 0.89674210894652084392 -3.503475108579551911 -2.8462002599109728074 0.26955907227749725807 0.37173389867000417031 -0.26316479059339031865 1.5574493559755149263 -0.62738835953777449816 -0.35521523650158737251 -0.078811359184882134876 0.014327590864894884301 1.3868189863480202551 -2.0757957842168313078 -1.07069742832802417 -0.78535369934734711173 1.9413312670897922008 -0.51901057977476228178 0.64902189522733766402 -0.37198892656108556443 -1.528371084707995875 -1.5743662991978417676;-1.9328058769465985556 -0.049882215105270473476 0.43781828520525273296 -3.2900233163225474087 0.42192227879642013599 -0.6191306852185781695 -0.10510002559748068962 -0.53132507331549805318 -0.22646506781188455171 1.2850198330706728012 0.63019467390036953969 2.9585278557392400423 0.14547003812516209886 0.26050743409413040785 -0.82448607528944251044 0.64001696927832429918 1.395229076208069019 -0.25895033919302151704 2.5376871307830812796 0.36719545512788231978 -0.14571036215940658121 1.6787555874728545824 -0.5860987403461933587 0.74658274899889542908 0.56281159979041350816 -0.71578751910048821205 0.75793568027628488437 -0.26277562130691817233 -1.4551540261743192151 -2.9838465037183059536;-0.40577401948462932246 0.22244980038273268197 0.48157017874512852984 -1.0917746849119280839 0.11454920685020075766 -0.31255178635255870256 -0.024603717560676020143 0.62845725305851329878 0.1934403879719174546 -0.36452236992558001427 0.71416427858113740168 0.93800181354034117831 0.17382020161381517287 0.42006708252736613129 -0.013570020054143840799 0.61633026757654241212 -0.41611155724325271654 0.097807551667018363672 0.11672219505235331694 0.16445345484435219818 0.26219054148809706195 0.76755994352510203971 -0.70627377288150405832 0.18489604817634155975 0.49832464677558435673 0.27337974595565839309 0.1456770337458943021 -0.10936981479846585863 -0.13778970961169229037 -0.092438324153587492216;0.78808671673831010018 -0.66802883610389518498 -0.00048453206920956296867 0.49792073162005523468 -0.066120644541820788875 0.36975549883355585123 -0.19649695657809906901 -0.50263398720012786303 0.021949169414095425629 -0.055654126710155439606 -0.27475852666389849466 -0.93088325460170506798 -0.25792697216863147425 -0.30361874618781559132 0.064281579824189236105 -0.37434118900494278703 0.1998472673804674582 -0.49973237808152731754 0.21878600218303878577 0.31789507068545480584 -0.057089779895962255996 -0.3754773470028796023 0.49241102039635353815 -0.2262631732884921032 -0.13188486005893254593 0.40404146395711676432 0.080426483861236172657 0.48961292801249950424 -0.066884930847730381109 0.12923710277480024433;0.60485476236981361442 -0.5602335748338739263 0.30667354830732540538 0.035666328523832419028 -0.17098067733052138562 0.18541354798106821078 0.049052573600220771011 0.11883395223803576435 0.2042334687029791207 0.40991802977853070145 -1.3397566067862014538 -0.90633132686315232007 -0.16408238656464757543 -0.15128211399707489071 0.55682392157927518284 -0.82840310166482067356 0.84117991176635154016 -0.089977825932510996365 -0.31625101603213823243 -0.060379028160272484038 -0.60185051082408569378 -0.56222627485819365312 -0.27837562407329613512 -0.82416442645519971677 -0.51440877766051307241 0.37317770768414731952 0.080357958961222816785 0.083232642885034804903 1.0455460084210970173 1.23553728739431401;-0.9519379320750613882 0.8453018863604251365 -0.2334698168403926688 -0.30861946913037691109 0.10052247726711950604 -0.33047819783245196978 0.22631854564111161809 0.29459392553580748819 -0.11906519900431043746 0.16105029908645593362 0.24976305142101506984 0.85714500637371282554 0.18121510123429773742 0.20229583788479094109 -0.17536018649640519596 0.44019779693709965018 -0.2399233664480369399 0.50863617304727382074 -0.14485618383573567458 -0.43067169587043985235 0.089897977870740566897 0.28798843877323893059 -0.43046849326494052157 0.37588832512406938902 0.093631168556237417966 -0.48398073331981511513 0.016499277268478173414 -0.47735374892042808925 -0.2507744131781446395 -0.49650784301227607331;-0.79413118477812094653 -0.22742558298960685592 -0.70904414084986500111 -2.4264594245805852779 0.093246145168349031662 -0.10187381620490884582 -0.13881217991897709663 -0.20212824065870338419 -0.31825381860748291896 0.57743261948858437549 -0.12729193404698807557 -1.741573090091173226 0.25441005741170169552 0.15609070349999509819 -0.24854619614565082175 -0.56516262525460647659 0.097091375742560201423 -0.086149415001452012142 0.71945704475034855108 0.21341815423379323358 0.10373039183549942477 1.0093310286256405028 0.16167274360165861946 -0.18664539060147039562 -0.34211274685778880755 -1.2398798701341440243 0.017669646944342667222 1.6229332666104014926 -0.17555917972224305279 -0.1489697390220383888;0.19808320787484329228 0.53376785332764431491 -0.40453598532224832596 1.0109485391954822209 -0.33438824713718329207 0.11859758902989629703 -0.082398160524284350115 -1.0949511684661132893 -0.048230617024205696408 0.56331780451153479206 -2.7833038984004163652 -1.0961711217737821755 -0.18482131518688829641 -0.092722859622279579783 1.1511036214672181188 0.15225794907390324817 0.22694430702299001057 -0.27431358783521014866 -0.22475405237308471174 0.32256825088910068278 0.19593532340556446547 -0.0094374201347930744554 -0.45295378542627307006 -0.25038902224950893016 1.1891684072603652123 0.68372279856616335891 0.46330818619326724628 0.45067927519506567613 0.3973467102134615736 0.53723645667835739914;0.12404779563304198231 0.073175025973898411014 1.3995859061376307864 1.5607073718165545007 -0.011243413380805542326 0.69646704125667746599 0.039594380197909069541 -0.60648923346703587089 -0.48425267506467373213 -0.14760933515576246666 -0.1330737318159962157 0.1166255031457409802 0.15628836452195801754 -0.35876888627881098337 -0.45329516989024110085 -0.64418297136040547635 0.1041353986901426415 0.0099322701754556187714 0.031043418720811226386 -0.1801014434467624048 -0.21990259838126033354 -0.67157633150629136853 0.34645733432024583553 0.59097078644804801328 -0.61125719498098096683 -1.414533348266463042 -0.3692764878666504047 0.039951843406895712341 -0.39476723342594910449 -0.68670763581043803292;-3.403313262638525849 1.9231963342047035948 -0.69050597967507909569 1.9973934601142140366 1.2834011355751127059 0.70227493771238191922 0.19791640211662023252 -1.5769832208760925507 -0.34632439787841973189 0.75861885266569595299 1.6093861195699619149 0.29763005436252293334 -0.35648222016149466729 -1.3697047351685367467 -1.5671080123692762154 -0.027210811085242269519 0.30597477742776763021 -0.15182672222133264395 0.21373215058940070454 -0.68062276762519513529 -0.85306735236207220652 0.052951720397847054644 0.99040363069176184929 0.1797946671552788922 0.25238849832702231479 -0.019248989278668884179 0.60714105074667912287 0.01626207508128631879 -1.5363215007263424372 -1.3296627612820637321];

% Layer 3
b3 = 0.57904264533439941953;
LW3_2 = [2.0863286320754044212 -1.1854718660464651503 -2.4753652164525727919 -5.4158014220528292171 -1.7131799327792009979 -4.9258497876975981811 -0.97102290632011700744 -0.62957736280630194337 -2.7338724901029918257 0.37892294414561511484];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
