function [Y,Xf,Af] = ESPER_talk_10_Other_4(X,~,~)
%ESPER_TALK_10_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_10_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7793371733913388;1.0194346513852031;2.531307828895395;2.3661023234252436;-9.8523050470132034;1.8605325286543122;0.60466418772652197;-0.99864404546722263;2.4777853182461071;-1.7048663889729851;-0.099382554302053602;-0.50582504801828787;-0.16005518863524737;0.26492194089435056;-0.18389589851824686;1.3923631342001574;0.51116684287146552;-1.6713224585835813;-1.6144000854159342;0.34733556370611668;2.8416623735884081;0.13821797254399593;1.5830715158526267;-2.805149194558989;1.2766546395100706;2.000254937067798;1.7684160165599074;1.9082471569430348;0.16958193690136575;-1.8249781825257088];
IW1_1 = [-0.20586399749831058 -0.10047387333739535 1.873854494595429 -1.1206445995605243 -0.69206502345471332 -1.087989893440215 -0.24759408684938772;-0.46188785488567657 0.13197601935553319 -0.91665073508906658 0.35261072805032384 2.2457666716697724 -0.53609366385225066 -0.13080394553672806;-0.17293962246121236 0.43429562041681952 -3.4497036594934767 1.5125681157536408 -0.129063442443479 -0.56382530277919118 0.37479389377824379;-0.99446021932578288 -1.6336160141086327 0.376931228152043 -0.35969181296903807 -0.22569045526471976 -0.3583567579263417 0.13780414085618414;5.0097001593790225 5.7580413984797838 6.0254069419258709 0.85053232753986463 -3.1189415034711909 0.13357913181674569 -0.26541504462429349;-0.62049414775678891 0.10474916547913705 -0.97440864078657974 0.73320145536535763 -0.024449070957705564 -1.1926927810469041 -0.81649248432151622;0.69411752140619576 -0.45201480610981914 0.36996510432052554 0.35237569591692358 -0.048037097780850808 -0.45848099065104148 0.22363334675418423;0.20528006342967819 -0.88818415890368474 -0.35460455262952045 -0.15154161576444097 1.0387867179082002 0.84193648172415569 0.36040284660605548;0.54230872644058725 0.020451875942338004 -0.041872930924464209 2.8356020875277874 3.2188001458647992 0.92374121778806584 1.1089998542928956;1.1134189132741343 -0.042999583860149591 -3.5843223500815311 0.68400037219203902 -0.60720090677034277 0.71657975497109061 0.1170072064816923;0.40802764268385916 0.21290607225489513 -1.9047451337118702 1.7103326073265936 -1.8833333140461246 -1.3670362342106583 -0.48422800044329972;0.15081248190141561 1.7687476309216119 -1.4750466056778149 0.20709766302216895 0.8075663065848866 -0.056550817067516676 -0.68956103247636236;0.47743243528294793 0.036054958387402226 0.34660663537689984 -0.97246857979908186 -0.83836488267587439 0.56487884160824664 -0.096614546558279696;0.18280232852099637 -0.08737647664830947 -0.44870071430585429 0.32414595385544287 -1.3205712939500367 0.90393585643482821 1.0586664458616777;-0.040866831450887584 0.5001900310928562 2.9335169674706392 -0.040185325551926158 0.402491606510332 -0.28739849951155694 -0.19630914830161739;-1.2073616093344179 1.3853437607952448 -1.7094887272906696 0.38177846457432907 -0.97413161480473942 0.61094698168291384 0.17824007427246549;-0.3124954737907526 -0.10691160724566486 -0.51762491198404614 0.90025188351470531 -1.3840535211040277 -0.82457885091613903 0.43221142984190714;0.30389478894648242 0.11848980100527405 -0.14169651565438077 0.57386368392009413 3.2755902866960329 -0.18019210034429642 -2.187043794086132;-0.46699016443457059 0.052419886059746991 -1.8823316030221027 0.93610334814500229 1.2213506603592124 -1.9475779600004588 1.8039509756800696;-0.33629159917054086 0.023789656573740953 1.1148916746173043 -0.22142046078800845 -0.20584531774178066 0.21889964061142234 1.1138504640045714;-0.45197343806645968 -0.53446477837545114 -2.9927988031296624 0.80078238948252689 1.7788457191535616 0.68814123494742674 -0.34104990586565559;0.21670529577553921 -0.018412020702429151 -1.2974662783384332 0.5136468682050126 -0.4376472673643837 0.14946669039376748 -0.8301385370508596;0.15592246826252171 -0.19654236342931877 -0.36147326945427949 -0.46746582338558618 -2.9242507207626667 -0.34703455554855045 -2.1466863070206061;-1.7023415893879632 0.61385102334859398 -2.0198616580755897 0.4138213555114007 0.83891197464015899 0.62667526372450022 -1.3856033105927936;-1.422296888357113 -0.27389841275093335 -1.2360614186882513 0.50764531611843533 2.8612702145222282 -1.6906489345145326 2.1169232440039236;1.3231852337627061 -1.2115304890118754 0.49449779669768495 0.83752988091555469 -0.81228123230201121 -1.1033932339274062 1.3116677293101076;-0.31313831547942794 -0.20848984702226889 2.1681605937701978 -0.67926713128261651 1.1444650726850529 -0.88256510931335708 -0.27669855463037379;0.97643451808321113 0.16724245701311213 0.74518451045052647 0.91287387065486181 3.2355875597439741 0.22357518514093017 0.051740765082014098;0.37937573638394856 -0.47660903906310592 0.46281619145391129 0.56876351087689814 2.2899606131528003 -0.055398837181464884 -1.0408111952768753;-0.12235889105597816 -0.0059798045878517864 -1.8261328686746567 -0.37316694645828929 -1.834559688177049 -0.63715133161317061 -0.23526469868538685];

% Layer 2
b2 = [3.207357464778529;0.038803805525850076;-7.4615463644480204;-1.0025871792656411;2.3175143200047073;-1.9245070637595942;0.079027542870898387;-2.3729703660769035;-0.83438956640585737;2.6691487846694106];
LW2_1 = [-0.35785374322772873 1.6109316398133204 -0.16472575149924457 -0.88384329408204632 1.757638245962386 -0.63859064887477324 1.2077250171322107 0.59930052159649949 -0.20446532242465504 0.73499075565340122 0.42012672828961817 0.11053235295186081 -1.0180442699934977 -0.67650215641881306 -0.30249670003913948 -0.24883533689387827 -0.74860219791746174 -0.91332754236649183 0.19971096327767324 -0.65751670986329425 -0.18962722582826808 -1.7098155828041446 -0.049152249109050153 0.60580822935951439 -0.32629120851568749 -0.29509325892634597 0.93576614706239636 -0.052887276356262024 -0.58208756442297505 -0.30290232388829263;1.8647532265624862 -0.50409028601852102 0.78116833136999764 0.19324838482508117 3.9845828545050743 -1.7312574334533988 4.6783228295405355 0.35936422447962035 -0.21206234307927824 -2.360996135054422 1.7760869939266726 1.0069408542022769 2.1511589776543101 -0.51273069336865584 0.92625681274521077 -0.34849901810025918 2.8564598719331178 0.22981799463858768 -2.0614723422666796 0.64234758514809276 -1.5657596166939691 -1.4952632446665515 -0.059024517976151984 2.695824583593426 -0.069272166120630377 -1.2262809526213359 -3.3871121689746606 0.38397618473733475 -2.0379375716784529 -9.4084909093840103;-8.0984479847390762 0.73381426760769575 -0.33490565781799131 -2.6830255360896214 1.5284323040270142 0.58042051066558886 0.22253876815283952 -1.3616877746652558 0.58456108793789907 -1.0133607975759307 -3.1781009243576612 -1.4774188100422034 0.22329574437353167 0.93266261894400382 -0.36591775015313432 -0.012224144305870516 -0.94724814324046991 -1.8830369418547361 -3.2193319440085384 -2.4970849057425473 -2.6230806939821338 -3.7211274251381061 1.4756080412397219 3.0667748827530126 0.53240129790233559 1.4138671904313764 3.4734675750198654 2.898930402156505 0.78031040323753909 -4.9300010625256538;2.6580728353478755 -0.36211253051609704 -0.79562705542560819 -0.84307978016270135 -0.58779518740071846 2.2693960163860591 0.17417112691295569 0.9020052303072319 -0.30492546718371283 -0.51745960018509463 -0.78935931447295904 -0.53710949201110214 -0.97578907106219237 2.4261454771521298 1.128517974172744 1.369881028669645 0.83846350418577265 1.0509908642047909 0.99876090360765835 -0.3425215091836975 2.4789146879333974 1.1097497624532493 1.0738451346274025 0.77267811213686666 -0.10028857395332566 0.62711001783451603 -0.34572306400927993 -1.8311064332784892 -2.1029912694060022 0.37774635070438028;3.0904393274917803 -0.52754688865867094 -1.8041099302405892 1.063884813106337 -1.60273782773047 0.72677156277102872 4.3740009966573474 -0.91525173808135318 0.030605720359280709 0.1077090348904433 0.66870567855721419 -0.45373273119797031 -1.55723520567092 -0.96963093557807634 1.0297138867615285 -2.1816502233035076 -0.86640303717869793 1.1246986751835808 2.7751891522217669 6.8193016436844021 -3.8530664753342259 12.75538077029511 3.9351161047789329 -1.0697443524361649 0.68370861974688302 -3.0453738834924988 -4.5991082199503843 1.2762293378549807 0.33518976644385379 1.8538463961778293;-0.057893120491747947 -0.38154657176744189 -0.30124471594888852 0.7288258424734092 -0.37820845957971871 0.62249227783689554 0.49876784834033716 -0.28437158845888655 -0.095181657564684066 -0.36609274347562992 0.05460654243038305 -0.0082160037066656404 -0.0029350898346027837 1.1200129243724759 0.14637719346859127 0.24377110869779692 -0.27332323171206607 0.23497329733886382 -0.77695256385138101 -0.73145210608627786 0.32080188335555926 -0.55621425423028725 0.0053155668445818462 -0.1258902831308612 0.051702193826984051 -0.077036184859377743 -0.23492157731807101 -0.27959545859531099 -0.16111115672713661 -0.29726337001993153;0.012021983214153646 -0.45636763370467104 -0.28261881947197809 0.38698320199782221 -0.37011722743693964 0.47251364698667103 0.79330507956897978 0.085304771565948498 -0.24185612268754197 -0.076233427939862347 0.33125641699859376 0.073816331533728768 0.027647561364135462 0.54838854517805236 0.10847444439755868 0.098410142623208699 -0.1433351653157667 -0.0037010474632498732 -0.92681141801364963 -0.55521846655937002 -0.80942465658296459 -0.85370051365858513 0.055552424085581836 0.14761006866926954 -0.095492873539421694 -0.13966154118276922 -0.32070447573456484 -0.50138701576537048 -0.38761055660241678 -0.80167600884268386;-0.24657349607931783 0.43091280705781082 -0.38541200828967687 0.76560434586419401 6.7770475946939674 -0.3190840410953934 -2.9871798722180949 -2.8499142904467067 0.88120081113583448 -1.217296181664804 0.11035307871552595 0.26749927531966616 3.5003192261561162 0.58718765730794653 -3.7716306189932105 -2.669686394306503 3.7796584449772128 0.41183366236883712 3.0478783194432673 1.9601033910254024 3.4761281837475768 -0.99506813834261021 -2.2966330219081565 -0.66436100634353901 -0.53851979518697557 -0.63104848924273194 7.2888709899473234 1.2874641111622425 1.6674409942543167 -2.1979616075768194;0.13103452615668448 3.2327146445367743 -0.48627159040430962 2.2671706679822892 -0.2186273997051868 -0.11362940994039554 4.7715417756694531 0.50805611352382496 -0.2049266471633957 -0.68358594548297613 -0.75675529705079692 0.11882947390102351 -1.5072620518024515 3.1090567011278565 2.4244500470901325 0.75641704744365379 -2.0909943989885549 -0.17890090025267796 0.9570050959683517 4.688143500932819 -0.65707391531325143 7.3303821903615125 2.5907520730713016 1.2774621694416326 0.0038219942063323457 -1.2531105670056721 -1.2576697171381914 0.88806942027482871 -2.2457210553550677 1.6134751786563055;-2.4834856960351326 0.08396112051422841 -1.0077970151352775 2.1229836552633619 -0.51915402673496425 1.573100415891316 2.7323683290344829 -0.74608637869060224 1.1578029306274711 -2.6964523044898856 -0.58496870516305099 -1.1054189962817664 -2.4710826902487915 -1.4785473920983272 -1.2807610284829973 3.1227955668220821 -6.199206270579432 5.0891544778349731 0.17099029707523661 9.8397490598973167 -2.794135230777095 7.3230930420835021 1.6569623786773826 0.68541836942146306 -0.086130953251003839 1.6308026122461363 -3.1912986342174015 -0.84766750334501884 -5.3555872790392005 2.4406541621088356];

% Layer 3
b3 = 0.22541819907093072;
LW3_2 = [0.49446608501051292 0.053023743913504416 0.061205866734305538 -0.08351956022163462 -0.038472222879208144 1.1278704186127151 -1.0937823744170061 0.03219393225836522 0.06306060471777776 0.034747426479056522];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
