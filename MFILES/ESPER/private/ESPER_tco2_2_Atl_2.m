function [Y,Xf,Af] = ESPER_tco2_2_Atl_2(X,~,~)
%ESPER_TCO2_2_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:52.
% 
% [Y] = ESPER_tco2_2_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.29306331981605455;0.052075787557576997;2.7937533680176805;0.6429060392600856;1.2672388971341548;0.77950354321737847;1.2416813206146708;-1.8523599505636832;5.1143201103151767;-0.19853221034728619;-0.58950335260735121;-1.3858859120763944;0.18332905225309898;-0.1487556489538587;-4.7022138971334515;-1.9589046918198159;-0.16991803383189652;-0.75134755955110222;0.451450947688813;-3.0284843600386981];
IW1_1 = [0.65034147466816017 -0.45281505553010892 0.36057610628439951 0.22251975939962959 -3.7114084711176734 0.61950126839274655 -0.86023490415975501 1.1597602827661211;0.012251882130988091 0.068853937170573989 -0.22045513042790554 -0.39049575724606972 -1.4579283082492998 0.29772159312732127 -0.79734008962728287 0.20301743814869072;-0.30821574621186487 0.14610141521220424 0.14288084696007286 -0.027443630763049964 -2.2943706221686448 0.4125346225087595 -0.31486399692492362 0.41487173489421503;0.047620445658132463 0.03446863679148645 0.12318233677127159 -0.41140139243776097 -0.078359072354984127 -0.77723799559036655 -0.83686214994742958 0.28492009265583951;-0.90746668880346637 0.97943098154987085 0.50174462180274593 1.8546287366708689 2.8190496798379403 -0.31821621870558831 1.6016295157830305 -2.1361261227602242;-0.094710239169944602 0.096348937323514725 0.15712691713794569 -0.36191306778945004 -1.5423217723623894 -0.2694733174959299 -0.76469174435314091 0.35147462924209411;-0.84213094383275933 -2.0262896428633019 -0.18596954119668702 -0.38676509099901246 0.39466840174316875 1.0454625090979983 0.36336654127265783 1.5327613846636607;-0.2443032260447032 -0.28298863086522097 -0.85174576060673857 0.61520196278377737 0.46868148741073457 1.8856534427958258 0.25244513119965423 -2.7449656489178489;-0.75323731128700311 1.4120667749507456 0.69437315313576609 -0.25844497673802197 -4.4350107407064865 -0.11202906072899112 -1.9743598845179164 1.8945948962121308;0.38317799696386962 -0.61824729677112977 -0.40546127938131721 -0.24576597515842899 0.51963675273908949 0.56713772234256032 -0.082492476477864465 -0.82108008257423337;0.067264648550259168 -0.66494377722046027 -0.3157889455915226 -0.1433353506420707 0.62869280635126035 -0.84814658799266573 0.40887633959160785 -0.19661815303475835;0.067625071685520399 0.12764209995864398 -0.19495439360717196 -0.24624078863031651 1.7741032261907479 0.33020436582712759 -0.072830302017409254 -0.56953288430652083;-0.08216909623660755 -0.020832421332016342 -0.061612351163442394 0.10365722722599938 -0.12201456393069138 0.41087011642848464 0.20694624137265893 -0.021325927407594106;0.050670539943903706 0.53413621733901062 -1.4481559074206265 0.7062680081153494 5.0903532395296409 2.0088911269772689 0.26791319792468876 -1.7073446793044524;-0.5600928395039424 0.5895565838625979 0.46905916037170065 0.85963026234482665 4.4291810253937332 0.70464487468875603 0.13067668172155755 -1.7603097973499584;-4.1893904261911539 1.9373684618586697 -2.3059760446273811 0.88143465888269001 -2.2812715921158953 0.41849952642444388 -0.31541935845448488 0.58334367946311494;0.19236922567950143 -0.51724775654271571 -0.25222201781936499 -0.14692033467514848 0.24761921974856008 -0.26690933601517941 0.077775247785316692 -0.32286949344147003;-0.83934636737499946 1.109894547835159 0.62147423492645126 0.75258409941852789 -0.94699849717342222 0.40061598255241038 0.65183144385967384 -1.093677498093576;-0.022111171136999723 0.15764532034321185 -0.22807053675214778 0.13405962576833144 0.81989760469447159 -0.21780904138029503 -0.15784278297252741 0.32552369079566634;0.94005953983287638 0.071660884689298071 -0.13176359302982271 -0.25193703043060311 -3.8950887544336932 -3.4112992185569042 0.79145911703623428 -0.67694678235620453];

% Layer 2
b2 = [-22.850629676763887;-0.78711909160514104;3.3317917232874139;8.2247761402062558;-8.4659752094780512;-1.9911338000857437;-1.8272741004853952;14.817272266949665;7.5250132037208086;-7.1867006946943013;-10.192089532273473;-18.530839236820874;-15.979067144141169;0.33088399072962338;-15.459000906924507;-0.44078187195153734;46.761495938052384;8.2410460116306368;0.36693883837915092;1.9581738687439316];
LW2_1 = [-5.6859057495991312 -5.6995507143824895 0.22130265831442539 -8.842391990494578 -1.4084059229628949 0.65975570197611166 -0.56030147175576916 -5.0556274406229162 4.0864715016686528 2.0076984618131615 12.933238871904711 7.9555752289533386 -1.3264033195072269 -3.2060703283963252 3.3671436776431278 -2.2038937709040498 -7.025080371800807 1.5632247800414392 11.656098094708957 -3.736452938375165;-4.8556537838714009 7.6341772074292313 0.71828074451581925 -4.295059633732615 6.3520665552360498 -2.3360241769346466 0.26843595725220804 0.50697954106508103 1.063967055400679 -3.1527808660807826 0.76405869532923432 -1.8642205430772447 -5.0642130697632544 -0.68021591414227622 2.0974666322008231 2.389151276174192 8.5519647561095855 1.8184030040693719 -0.13974808638026026 0.55324892409719706;0.64078732293679252 1.300272923422273 -0.56681400559890471 5.9038038226014748 -3.8646706722034709 1.7535893774036588 0.22516949789529458 -3.0179891070610863 -1.867643267001184 -2.2806814525586177 -5.9657942975039493 3.1621864048371795 0.368534056603743 4.7580696066837955 1.120680794960933 5.5787313241631207 2.6381503174481771 -1.6698177327603743 -0.8510282542170069 -2.3254905943641453;2.4311511858599744 5.7982295193104569 -4.9063873896318118 -4.0503973231419206 2.9891088828965651 0.79705880541874718 -0.88746877984503336 -0.19083028756609005 -2.7819126198088582 -1.5739058769732199 -1.3862654044869138 -3.7176069393712465 -5.227557509943054 0.94105569831342073 3.0027952460689553 0.58232212196249744 1.7259008340429909 -2.0056105260586916 -0.23955677826156285 0.11636518487935489;-3.8974656807180503 -1.7112783553459952 0.44670171329971964 -8.6598801309549049 3.9787322797111577 -10.602804180812324 -2.0138715884191778 1.7782966991120799 4.5119899125233331 -8.1831935068531401 7.4147569506447919 12.911217041288511 -3.9269983952856293 0.82974038195647792 3.1488726245077525 2.3626462936239649 3.0893384575852978 -6.1408641187030106 -1.7138969904996033 -1.6701550795361455;3.1868720627054357 -0.30362086756683038 0.79982049603396266 0.52654408701120203 2.1182957013175048 -0.45211437361262935 -0.37754606351488224 -0.60955152843508453 0.077053159627545817 -3.6831442128728997 -2.0854199876162154 0.75032762146965148 1.2012637082986826 -1.7193229648127804 -0.84675027395359592 -3.2639184116718183 6.3988541714781872 2.0408688466944427 0.45047015270764662 -0.99971055710038126;-4.7334745491503236 -0.80450993835842 -3.1544851099705191 0.22356824057536973 -0.020607205273939964 -1.8250870050287038 -0.54747243853936911 1.034225359479263 1.1384579515864954 -0.091606075027345621 -0.28166900364437708 -2.9595532101151347 -1.2813044626229997 1.5822798690044659 -1.4468665887422218 2.3785373065935498 -0.96076696936095229 -1.0778431525293104 5.5041896890714845 2.3357316728413138;1.1858895820527582 1.0842864873747917 -1.1775925906933082 -1.1961731965550844 1.2421220998003504 0.044197523384380669 0.037576329007898063 -0.45794405727425569 3.4249849515883097 -3.4993201333653494 -1.1697193154526677 1.340511290776965 3.5620220995044556 -0.093313477714645099 0.78340156012960327 12.540555379029033 6.7955973747196383 2.5408674626008652 -0.45715973465326337 0.87852932805303618;-2.7696550549820507 1.8579183959716714 -3.4810810996990273 -1.0175930427873789 4.8131223323102681 7.2154805117383187 0.94591099169752557 0.1481116860869495 -3.9781234989281931 9.8306576902135401 -2.8304298030705897 -13.615184911868571 -7.9920380453456463 5.0261908418280639 -3.3395910582372319 2.4117071805705814 -9.1283497124114792 11.030235373251109 -0.069137212539568699 -3.1229033977550924;20.58609124003809 4.5332217389612994 0.63208128266635932 -1.2394554388457903 1.1083473073243328 -4.7392254049942641 -0.1233790985045132 -0.63976749584693415 0.57207442242076778 -1.3893235018526626 1.1477638101289909 1.8187585117568801 -3.468581936591256 2.6800841842500271 -3.0449974886943227 -18.32444935077265 -0.38707711494009761 -4.3784712968809512 -0.067539267325241001 -1.0856120100646423;-69.110627553216403 -48.927248715539925 -7.0588760332238323 1.8155438918052014 -41.771818540759533 19.694852622728227 2.1857938444510143 29.675682843040761 2.5957912430256176 -26.87938869401987 72.337010343687311 -5.8687400130628067 16.529358266117388 -74.465205374657742 14.091438682582039 -28.301260815146488 -62.31499055968915 4.1778761403980651 49.792637710385158 5.1116270997865794;5.2437411963722091 -1.4784813032041713 3.3016322270568494 0.73404421048952084 1.5580721932897736 1.0157816988428867 -2.3075313069202648 1.4192743172933524 2.7131693381696804 -1.3101677014712794 2.0137845283735167 -1.7888828256997391 10.763639658307708 0.30089956650591376 0.18163777498846045 -11.802661627273842 -1.0488482418191032 0.19164876387080806 -3.3148616403600251 -10.843082106686339;-3.6088094012588927 5.1536357369191439 -0.61827062462207716 -2.8904081755865509 9.6300324911135924 -0.9521116592258716 -0.74385783788682935 -3.0538770922694058 -0.69823415943486 -2.4355124685355563 -2.1021580756545473 4.1882015353093989 0.92056781546979505 -1.940137896034837 4.0452961008262314 -13.675679877688177 0.6965759707899043 1.3951555205933597 3.5990742183172126 0.1793339871570242;0.55989351589581193 1.0813763167170145 -4.4783455386273516 -1.0371030837285564 -1.3733533597486112 0.21986749335701844 -0.49001858467833326 -1.4058648083810297 -1.316647434526208 -6.2202392819828267 0.6737888426658809 4.6223108035041447 -4.7002284758762931 0.52962394185228234 -0.62818850951021898 -6.1342343864040823 -5.9872502237829703 -6.1576319470104277 0.19520025973139984 -2.0796904748913487;-4.6761605283663714 0.930804989507514 -1.8212709533768263 -1.3183950874317631 -2.8019125802551077 -1.1652891582920404 0.35166745227508339 1.2205170925745219 -0.74558649499078211 3.6742368117126101 3.6343374560055519 1.378431850832563 -5.3612038727716156 -1.141606855039601 1.6950233872026583 -12.807323931847094 -6.9107242122140162 -1.5839088682848923 5.0750575937755098 -2.5287248947915417;2.9213375783965208 -5.658865039983354 4.9842781590956271 -3.5070522211941726 -4.4794083104976785 1.9769791571956441 1.4859104137549377 0.27847279972688316 2.8834775760857876 7.8885087251970134 0.80809179770321071 4.5388335550946497 -1.8450534600994279 0.64207607862110438 2.5073333209256403 8.5750744591499402 -10.782872720440301 -4.3732126091956687 7.6846244344549497 -6.4359197003390243;6.7971809070307971 -3.4165565567321878 0.39656473283003796 29.686376904346208 -13.596251289378182 1.3664651053853747 1.848729451866602 1.2609117026703525 -7.8421671822401917 17.791341063872633 -9.9013846432527153 -18.105662907968362 10.62321270501157 17.102568755618456 -5.8925522094972944 25.912274980315537 -15.091292213781625 1.7966627967785127 -21.266227510671545 16.729622107016002;12.22716159062816 -0.432838207106791 1.7807701011907728 0.15365825830007274 1.9147671028595323 0.7242960132726427 0.70848580904942593 0.9747306629028466 -0.36668647046801178 3.6009695850743935 -1.2085938501365272 -1.4321314994792693 -6.0389416335900421 4.2307382304779706 -3.0316690784400979 0.9618508249039377 1.0483830300322099 4.6278341429187657 1.7591140804060073 5.2550438977018077;-0.5291330102333438 0.17148770451493503 1.9633396943089974 -1.141879799300842 -1.5814484629791126 -1.9083036087593399 0.24614979609273799 0.21288584958580023 0.028221759907365421 2.0564534884461825 0.74695410503701509 0.66988352808010532 -4.6019324927109082 0.93701533426303318 -0.14084568649435283 1.9847226708878216 -2.5686593114393488 -0.47776921672652195 -0.17131299334960512 0.23060857120149511;7.2383944564199343 1.8809308954487893 0.55403088287950342 -2.0853093518049768 -0.18893699867421992 -2.6638449260957331 0.022976816981207078 1.4610133985956604 2.2214055635151522 1.921452265697295 0.86044829574654924 -2.2346237841955534 -7.6553975429331196 1.0737508713844286 -0.40269537061353333 -1.6368557228280569 4.8508629015480205 0.56650658885860916 2.2640379634771826 1.3737801012872715];

% Layer 3
b3 = 0.31802847611436214;
LW3_2 = [0.031495186329663021 -0.041179363942658191 -0.01055997261636449 -0.02978015096896686 -0.0039289356179680584 -0.43453417859029286 0.085202356594020437 -0.12711893038507216 0.03786573704693208 0.073193008207528193 0.0022483432194815487 0.10353329137564443 0.021026500912953421 0.20091684996816297 0.099457241952862055 0.011143202820058809 -0.01239046565144444 -0.04289535904901276 -0.60684092507552423 -0.038180129468750108];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
