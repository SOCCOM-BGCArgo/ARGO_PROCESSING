function [Y,Xf,Af] = ESPER_talk_6_Atl_2(X,~,~)
%ESPER_TALK_6_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_6_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.8310112146515953;2.0124180875203654;-1.1725818432229385;-1.6178223572254566;0.45658305018366796;-0.95363492209320477;-1.2414863437322874;1.1784145172391187;-1.0144145622219425;3.0758928891781063;-1.4325871387176266;-1.5577211122969126;2.0753379727883021;0.25269354920683645;0.24907165833053696;-0.65330797458219025;-0.31083616044358636;-1.0648784566984808;-1.4042300200710491;2.1982317011485786];
IW1_1 = [-0.13949773661148215 0.62969265666841645 -0.013835358523811517 0.19568435833542391 -3.5729911982442744 1.6826814451368408 6.1149600556708022e-06;-1.2923075259323555 -0.20680801114949235 -2.1279011187133019 -0.78852669815429133 -0.45642406344109843 0.12573487629842603 -1.1509046263698188;0.49768674030711529 -2.084234745965273 -0.34940828953317432 -0.34225662857969485 -0.941103435610116 1.1795632280630819 -0.89200471850148799;0.31151002154131785 0.28512304264899835 0.60907333400785491 1.388258258041799 -1.0331323406841229 0.082059342394714019 1.3747157157897143;0.11089589478218848 1.8455932962154744 0.89661941601414319 -0.42616036496533644 0.93734758328705647 -0.083407625822558673 -0.015694534079658005;-0.2003019884410232 0.62049129325747798 -2.2964536608374528 0.19659792051406536 2.2268452412640647 -1.2700967790191351 1.5384212690900714;-0.31848027793948164 -0.13092387577832867 0.03444143456739511 0.80840189562730169 3.1314660049830332 0.0658692184754604 0.45676855673901706;-0.6933850717535619 0.08661293093911869 -1.9588370907661361 0.32062967980869383 2.5770718044967773 2.0535967492948179 -0.61295795900623062;-0.6144834470772047 -0.09619360334625407 -0.67692713205028932 0.24402463084078671 -1.0140899293415557 -1.4585203065506052 -0.041101500688567834;-1.085141325911317 -0.05313078161210727 0.91885351051872854 1.0429094060920361 -2.8607146553418925 -0.38955078897821482 0.52587512762188093;0.56937933639058003 -0.6366483407357495 0.65158490885305664 -0.092826220274059304 0.7382924761236962 -0.58313387694109664 -1.1507244605499805;0.37555620299400405 -0.41464838395062692 1.3223330386690251 0.26930816214340914 2.6829238096451982 1.4950103249804529 0.012054192564074957;0.32374499819474106 -0.57332561018497041 0.64947231187726895 0.42842161181078053 -2.6118882896997171 1.9976342402691016 -0.0063916272405859231;0.61375674054834284 0.56558880521897736 -0.36698318212796144 -0.3564209810815494 -0.93127369684529804 -0.35030780700659148 -0.25349051947761558;0.055482244320495498 -1.4960606232261506 0.44720853961031809 -0.049020767730826864 -1.2639076096134703 -0.54116563539809348 -0.30988897042908314;-2.6419423495684882 -1.3251781011032036 -0.042889116274644784 1.0517911590701778 -2.239703035213787 0.97093523287481609 1.0711506367744617;-1.2906253061826045 1.1152731435115406 1.5374647200303093 -0.081138680520908377 0.12590300733625281 2.6329853356113349 -0.30275440918973845;0.60725024177970854 -2.2633538206878749 -0.07929656394595995 0.41558440944206471 -1.8005044431178188 -0.4584568725032937 0.43997944594635457;-0.70961745492531192 -0.64419255322696689 -1.0481948449320384 -0.31652816641792575 1.2124850453436795 1.1261004496483173 1.674443127377117;0.4008757801926438 0.25900647090884277 -1.1010841163987117 0.49188997342883584 -0.074269973000271369 1.92102813072538 0.073642491132641888];

% Layer 2
b2 = [-1.8425323097903206;-1.1396535534986916;-2.9886783813164404;-1.5375774061028389;-0.89875123709016158;-0.9982460256010699;0.98492556719660973;0.51153379086885942;0.15176297257524918;0.45501229107369784;0.33970304777555976;-1.0553827378816176;-0.84844466761179549;-1.0668319821301369;-1.2747642799584338;-1.1331210953224637;-1.7787360357570028;-1.9006686432211641;-1.7817636779142612;-2.1352438099326201];
LW2_1 = [1.0921363774272967 0.48175692304239609 0.28624371884191485 0.17088257050429617 -0.4019660756825913 0.085044209790642131 -0.86621354421819452 -1.1234519026139034 0.81504759964220852 1.7328477627945189 -1.0138927796968702 0.013992952536819247 0.05792691529056089 1.138315240638903 1.2383644933627227 -0.94329687353274649 -0.42952541573220487 -0.91667967688927532 -0.10565988819316455 1.4766764700586932;1.0254321474655765 -0.29366527710006179 0.29251795498487704 -0.41179937919550674 0.2631037042941724 0.32238550819463485 -1.3972094781229141 0.49436936282742644 -1.557183684207166 0.32737759098452568 0.15027711347096451 1.2661196051515085 -1.3272933648218361 -0.68301717488350233 -0.55140153832036887 -0.19255787935736696 -0.25069656132262713 1.4229030781196723 0.43146104621915593 0.14325506833395124;-1.4352331070284605 0.45283152228113549 -1.969703643875274 0.85901629593942819 -0.47756081188383198 0.82462980760399096 -1.7265918982256623 1.9309595958846948 -0.61624734852112606 -1.4778951012483645 3.3348400991228835 -0.90466493153178051 2.1911100865814661 -1.070366551347218 -1.0943739980438847 -0.52967127964920324 0.65182706417550207 0.65723681342564633 1.0871501128351264 -1.1585320227850266;0.7419747357138512 0.52244320319427429 0.5029460101874218 0.89949746332670533 -0.11603333120481084 0.55198053644834699 0.003975048445771256 0.25031469594454048 -0.24463167750065506 0.8855969092630056 -1.1472010889611166 0.98692426243283327 -0.54796623268123124 0.94984461015159805 0.48781091663620979 -0.95966867675933443 -0.39120263155049506 0.05243664498261754 -0.74922778389112843 -0.25470994797923635;0.19494601654786153 0.80300858672206143 -0.19582792547093925 0.47957312991799395 0.070533541760266077 -0.094135236987178558 0.52913617643512534 0.99042076392478184 0.33156180943024555 0.58299665293359892 -0.78419292914681349 0.47202681194347401 -0.27123010883311427 -0.063473355784496435 -0.46522004578393999 0.39722508341760254 -0.3019122903435455 -0.50317572450836545 -0.26794776071054904 0.55946150716370713;0.84552179190851429 -0.58005373833149476 0.74340790966122017 -0.43855943508293738 0.11303441376722768 0.36146051102443538 1.0005831413933264 0.49219351475321782 0.88423443168905624 1.089483471479886 -0.28730671446525713 -0.29630704229643734 -0.96544282483658739 -0.52677976329173515 -0.22082057652812212 0.80506888834499046 -0.36857792071800261 0.68239566885314507 -0.13443173042318152 0.2770344212462339;0.9626636609786412 0.32220480159194925 -0.17331520079246068 0.10334297329392733 0.40931096878003898 0.14351759040937606 -0.27220326344783013 0.90371085122368899 0.48143776554831469 0.1028569544335324 -0.21217257219151842 -0.036399251430419485 -0.73943663899118672 -1.5319050227675313 -0.22610434770644239 -0.50821287196101494 -0.64055911815327138 0.37662827018769979 -0.27428832090444732 -1.0894588645814376;-1.2287152318650603 0.86695907032456931 -0.41622775514049509 0.46580719915120872 -0.18425604247020025 0.30941892140449295 -0.27059882095632326 -0.1962444398813841 0.20372234743098283 -1.1526033491022853 0.10553883451832467 0.79417326447786263 -0.66486105108184412 -0.41906977724835026 -0.9066626391893341 -0.12234941719687874 0.44775960577512863 -0.13755876665451758 -0.42442888858215078 1.6763866087956243;-1.6587703538468155 -0.24845395187655067 -0.40400370983253175 0.2624982345709046 -0.8193415307543167 0.20328514335046408 0.71734877708355982 -0.14181375234922192 0.67473925959356251 -1.2274900738197421 -0.59535639345350311 0.81038573385699519 0.36666104752273199 0.8124302131857889 -0.73583850854680388 -0.58392539014804723 0.34284343121724531 -0.29157130360064798 -0.77110779525499928 0.099906452616946528;0.068168850205039683 -0.065463937078063347 0.75975435216799292 -0.20487432869470285 -0.14443478175981309 0.70656805468478745 1.1238982584328547 0.26897624561696731 0.88964776513744404 0.27394178670428432 0.37722801743174789 0.78349036416386941 -0.48098618899555112 -0.61755401101439877 -1.0096979717206556 0.10566890735314577 -0.13994431927108372 0.23527609647604888 -0.8822962393792978 -1.0701371488639637;-0.83953314928338019 1.1343814451477185 0.8499915342519605 -0.30573144775086647 -0.95912094248646562 -0.51078020099256038 0.57505127303970538 -0.89915145440473521 1.3625615210174769 0.24446270306832144 0.68152868515130449 0.23768519825019385 0.77892062182601363 0.70899518213400414 0.66364141852540104 0.86482282467805283 -0.75765429815748886 -0.21294695114231821 -0.26267176366348088 -0.53566825045080446;-0.004333219607875095 -0.030290676866830336 -0.85012082920597365 0.32197499067321678 -0.66434042346555089 0.32303773305117012 -0.65658762328376363 0.6054427843846355 1.3482811530142553 -0.27570778959729053 1.08989115645859 0.10107954409161467 1.4041073017589836 0.83616624888733793 -0.35567192719025864 -1.5627218391707363 0.7138017533364065 0.28894134171791597 0.34529097447740797 -0.39431927430406655;-0.3495332440380477 -1.0572278548537917 -0.044704489652677419 0.1438836287868592 -0.021361549766723827 -0.58797675726785992 -0.35887475461108614 0.73876634878974223 -0.93526658315186428 -0.33201102866525789 -0.86937776614017714 0.23283178294862006 -0.28027478230787206 0.89761335835758693 0.27019810169807118 0.04884434271642886 0.6134612910915116 0.13081831949441219 0.38155212653575943 -0.063850689465923538;-1.3483071370506368 1.2038819439308805 -0.89817784304063364 0.72251399795649518 -0.27291655803032489 0.870294425041649 1.368938274752501 0.32734836154654207 1.3011851396695855 0.27709217491321175 0.24960673018127941 0.45560146297061782 -1.4199728535749494 -0.38268027369086183 -1.1421108984872812 -0.31715238421997705 0.99392628182623444 -0.42720355588472164 -0.51780182494841276 -0.99260805566452603;-1.1083088621931083 -0.38169257107503851 0.082015517581560851 0.94002210768065875 0.85351745764373743 -0.78022274128243962 0.2095100822228296 0.35565360848434102 0.35962598924515288 0.93803478499585524 -0.25492137645652579 -0.50609497965543238 -0.12527732163986288 -0.49984138337720357 -0.51668560808135189 0.42939748045991072 0.11628557929904483 0.22367498497996016 1.1543839403311904 -0.34902785220293087;-0.24400952932637465 -0.20598307422970125 -0.66734764919741096 0.55040021914817783 -1.6142669998283656 -0.64613017206041845 -0.69948672988172778 -0.84163588921060217 -0.33154674762541098 -0.97783443279736459 -0.17323009478241133 0.60850527335771865 -0.55155363998863194 -0.36153315447576501 0.35990987648076611 0.098322376629818159 0.81810640244626132 0.091704470517129766 0.40130981128089194 0.59888643049876578;0.50266568754658414 0.18623834409012915 -0.64113363229762421 0.34616781405969249 0.74026149237492445 0.28097660096677951 0.032713194285339191 -0.76309486707509167 1.8878902011421699 -0.31893510643048945 0.80288050367690245 0.54390082703615461 -0.70515925675552804 1.2038496434574681 0.64466542262956028 0.42127781477745907 -1.3429749314563173 0.63054808142932961 -0.26966011687643071 0.64638714315418833;-0.8374342971922647 -0.4322156332904028 -0.00081269603261637131 0.36379025140809501 -0.22348257470651231 0.075419865371471162 -0.18346286008764165 -0.16383258072561632 -1.0386528008576661 -0.32868783393381623 -0.88628428817223148 0.38746853935690467 0.95881288635488116 1.5546611531089949 1.8595069172118732 0.20472514239452153 1.423185352843473 1.560074657982125 -0.33767822185023616 -1.718686174396679;-1.8905256952683114 0.50940918505932209 0.68023548885995078 0.031805672989697588 1.8350697801478215 -1.0805297455461784 0.30226576806262823 1.0657761543303836 -0.15322586677939939 0.12095763537677301 -0.50299877288767691 0.17168779406922244 -0.66135322889414316 -0.12356264065290834 0.29117305425352191 0.37207406475104293 -0.61363703976291384 0.4250840387846968 0.63135899389257777 -0.76065848068491404;-0.11018387355177457 0.15160541611598369 -0.99061549220225942 0.60025352026385093 1.800844328719861 0.48430683134478003 -1.0210686732621357 0.23860911747696786 2.1855260136817223 0.22623596474414168 0.81461046198311471 0.90796651096054992 -0.72682693013410671 1.3539126140923328 0.42181513320589992 0.076858666855751004 -1.6918115008579859 1.652780600228424 -0.061408220793485797 0.15260871750740726];

% Layer 3
b3 = 0.6486473651253577;
LW3_2 = [0.043701950892154846 0.10542097228223973 1.5666155299503974 -0.13985280345208873 0.053908410388372872 -0.016115405710179158 -0.49300102104795873 0.030794535970367239 0.075114032262233996 0.068178707173274788 -0.020275206652959669 -0.29938609803755262 -0.25225278453514088 0.043220141124836985 -0.76493020436768266 0.017545425025883361 -0.35751715399314904 -0.60587596510935504 0.031015093777444391 0.33760047869159482];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
