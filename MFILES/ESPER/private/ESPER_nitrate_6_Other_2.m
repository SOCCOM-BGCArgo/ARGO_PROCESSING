function [Y,Xf,Af] = ESPER_nitrate_6_Other_2(X,~,~)
%ESPER_NITRATE_6_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_6_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2633552471432227815;1.2909914774396922255;-1.9581631654978377544;-1.5789831280880934905;-2.2047198286442428738;3.1840005402371014398;-1.015814283716335531;0.099479912726014599333;0.26106735938539454844;0.36700580191894166537;-0.62872215309736256827;0.48536847439898128664;0.069294421141592579816;1.0479262576508994176;0.044856396490523253728;2.3281445177276145486;-0.3786698819320649112;-1.0944611105558392783;-3.2104125160485459389;-3.8389400878990485033];
IW1_1 = [0.18490491875552575451 0.10324807520012743711 1.025276804461646929 -0.37694301170398936129 0.026818504989491780133 -0.014125621622951327339 1.0848763955318849739;0.065449432916099739566 -0.31006023950728134331 -0.27030324739849465043 0.62283724905678772288 -1.0491391458661656344 0.10748079629860630979 0.72000043825023885002;0.10311537905538549487 0.091065470547406407453 -0.16796872284296038291 0.10522580386738145108 -0.4669426266202565956 -1.8810065944920950631 -1.5928211302112580405;0.047505363816900368634 -0.056343581170194889651 -1.5513998589759734337 0.23089679156060113896 0.46242127423284862253 -0.18876207975933453898 -1.8515014735911932142;0.3492077334417211798 -1.001316465162451097 -1.3208694697767415782 -0.019098401649386143042 0.057695940221059088815 0.25516050989053956632 1.7937138398253842375;0.38545010780452282351 0.45522567859677398605 -2.522463260540017238 -0.026835441951749295503 0.30403828975782076771 -2.3071457594279025649 -4.2763163075180035122;0.15957760931097805801 0.15945865439015827203 -0.69370982582269347105 -1.2362161212566853408 0.098496232005609071769 1.5958819649191713363 -0.2361234543111617179;-0.70063772858615269712 0.02067678516497354485 -4.4964782122952646759 0.56945314366951738094 -1.142167915384305843 0.99584401703383607085 0.078358822551737219997;0.10017701687194105475 -0.15732832296938925598 -0.80914316613722281346 0.37665231278744576437 0.41809846236254183394 -0.65868608773592818295 0.89971034457661869244;-0.41278905857356862352 0.6524672710108166962 0.65955482546705068714 0.23189842921730660641 0.75342676891102089431 -0.60219722220072458008 0.86428755237061272165;0.3846731733803190334 0.21232722487696087388 -1.1685031202158417951 -0.2068265677167440697 1.3448193426281938034 -1.0949521687000971504 -0.72171473929240093081;-0.52549264668646211707 0.092108154978579506733 0.96944489537640055055 -0.65923150798965635122 2.8011501492529435886 1.3164648282686519654 -0.94272287200548399166;0.21743101470323547564 -0.25366877082816446931 -0.63922975759250788563 0.36541390499460263408 0.14117309819689247141 -0.66331472158185045274 0.8479066768359245776;-0.14620261562316452797 0.35660364661099841488 0.43143556598641258359 0.16808671373452785391 3.5692727361712144329 0.60732443060540042268 -1.4907694877514541254;0.9887313702523472525 0.58686639963319575664 -0.14350304944921032924 -0.20528078944165289998 1.9703920969775423622 -0.20162920726507729818 -0.25686363875869794304;0.02332838700898766382 0.099193185417615695187 0.43717779794041783381 0.2374991408220653577 -3.3594067134791294471 3.3761387236451771976 -0.86742307236912341573;-0.62141228328653008717 -0.3091313745219099185 0.82210816936349540018 0.16137044265367811446 -1.6731583277521844266 1.0249733328046986003 -0.9328242617422055627;0.10769281935095148528 -0.44788197807290225372 -1.0132112111773736718 -0.69568484736672164814 -1.8318193601498657941 0.20371746224811224102 -1.2128509303524039886;-0.53565120330635862533 0.40650510433417741396 1.130016598359362634 -1.4848223489614664761 -0.97823365605549983393 1.1905785944926610131 -1.2725138560437201374;-0.12246763563181742307 0.18545323931016569063 2.906509142119885869 -1.205897519839528087 -1.5527968251153554391 -2.3177910452569334687 -1.1315669063331506017];

% Layer 2
b2 = [5.8147962185375012822;1.2137209485371960316;-2.9597415453359614546;0.98602603406759037341;-3.9049567377863132478;-5.032564668287317744;-2.4010734900369428146;-2.192393364363661501;-2.9234064376655926054;0.5580363236141654415;-0.9886424834733898992;-2.3158139748137345215;1.2698942620589677155;0.81080349653194905279;1.3157052414663443773;-0.63245177150180575953;1.1423546534137101194;-4.2652327273315631118;2.9600798993021202321;-2.4320133089025288697];
LW2_1 = [-1.5346543242984429511 2.1888703325525997734 -0.22370427063770273457 0.59916491219295875403 -1.8815568186056133015 0.7798384890067389108 -1.1406899286436549268 -0.19073271262901841938 0.089902765401182985205 -2.5918145789919746491 1.2337040239666938746 -1.3686074579289131403 -4.0747721530531109124 -0.071956945136230548998 -0.93606680281056042769 -1.6916649814620074999 -1.3191219420210418267 -3.140187889266100818 1.9958573635958050119 2.6619244087913003227;-3.743908940320380907 -1.920406115166382266 -1.5593192823824610915 -1.8403664422101404519 -0.6849279048169383266 -0.64120740420284982886 1.4245198780151826501 -0.53473069917712956478 -2.9331008086952770064 0.12627108748835083607 -0.24636409585116381127 1.2623117832502057656 9.5942239878743222903 3.6331857594238678999 0.13934850581186597474 -1.5073443639652810422 -0.13941085273105677245 1.2642108279826473893 0.25316058299399862852 0.23187250574043635765;2.0081131697242819989 1.3831159975732962852 -2.2576193148748222583 1.9002465020440508781 -0.032830982920333387498 -1.3460922548870604132 -1.364614898812600785 0.77437474916275594872 -0.67340674027512514854 -0.78264627988095669675 1.8788473017761884165 -0.068621059293852579297 -1.2895108723604697953 -0.56342791728154506536 -0.84100197895108719237 1.2328440376808829093 0.1454863056450248493 -1.1453102321453072499 0.87648775347526541868 -0.34359234687797740593;-0.35094373766607539489 1.3769882133283131154 0.66174118294928496731 -0.045258883620505549472 0.30649911912288013704 0.05088434958543705533 -0.23228532092118447938 -0.58581027762984172469 -2.8178297510074603593 0.23574102612937575252 0.096925380706192582059 1.4192703348396855656 3.5838332777267876139 -0.84089724339974991629 -0.29166731543269963645 0.74996689920016990083 0.54320989891854787324 -0.92744127738775550274 -0.149180035702569741 -0.03585794044624096566;5.047857593295019818 2.7310353644846907528 -0.35652754889965443397 2.4773949351466679758 0.20206376071727175092 -0.33551139565530113673 0.49232982758327353823 -0.28069248700020077436 -4.0591026850495168787 1.1950059562987134232 0.71021438409035908546 0.19846860053823206504 3.5199442054852441153 0.23034201235457812951 -0.52392240267270051568 0.17224160672646601777 -0.89219789597095144895 0.69347789585812991131 0.59173218485455292281 -0.33723868742644713681;3.3045072432783721972 -0.19931481514027765689 1.4748826638946526124 -0.073834463161953772792 0.56644258930361435223 0.2423054792942655189 0.57144351208341870318 -0.19235118063197237381 -0.81419906258563989887 -2.1520395981966484733 1.0774385917072240026 -0.79995016390743978185 -0.19988056604342072098 -0.59701738114876379271 -0.12905751519076763545 0.56815783049177748243 -0.20820618661363929358 -2.1103757020688154178 -0.17342091668848474972 -3.9127968665292751638;-0.022070905014259192822 1.2759038933776591929 -3.3523932797259154981 2.5005378764231815936 1.2437714707723921403 -1.1249125594435271935 0.0045859157352714438605 -0.48838112312412518268 -1.4586257918273526357 0.34251210971767342972 -0.84413090962306092102 1.3299827039866054523 2.5748542477480866886 -0.40959156247791594918 0.36919426934746307767 1.3103100371365636878 0.93290962192645632278 -0.83400583113502402277 0.62031429329728071664 -0.19099516408564193304;10.879620676308725535 5.4908717153419264179 -0.97736769572560744379 12.035892941065327477 -0.27639746640411044787 -0.32732035655546742881 4.2997521700320158189 -0.5394474578277890231 -1.2004988389116133529 0.042977959046905551965 -0.53162228384034360129 -8.4314708047237321153 -10.23537694738030801 1.3620568920096762788 -1.7535291098816472299 -8.2198231023824988029 2.5283210114523710921 -3.456945091841901796 1.5130826003102659794 1.3507784888423659542;1.8812760698614621191 1.3492252458516027502 -2.2925119407001286476 1.885306705582162401 -0.032333520718872563182 -1.3463311319699962088 -1.4539141735257823385 0.7918200270210981051 -0.88916125502338538844 -0.78824391142164951241 1.8133745435268580071 -0.20148189162263771546 -1.2688424488710940974 -0.55872655064533005564 -0.82017066823038575762 1.2381762092603525449 0.092784157998885036234 -1.1280846866586875521 0.85617037089017300477 -0.35615749389332640451;0.35080583006288790227 -1.0598248958994134217 0.88279058643292018793 -0.44343729999525804963 0.033351859227249334994 0.22862821162531993258 0.9461924242439567756 1.1052317782136311664 1.7169131878564043436 -1.0230446434257793875 -1.3566162248096242937 0.60917512406827223348 -1.1935619301718334295 -0.1943320694460277942 0.31213227455111325348 -0.37336611179515399872 -0.16341904420977634849 -0.62471163599422041557 -0.99051395062257940882 0.69317404243760061266;1.5732628509603765465 -1.6254401761544725602 0.0094560937338658834772 0.58281061426031310901 -0.029983890186720159321 0.98497618724175162175 0.59993430466571484594 0.463027488779646057 2.4156920552837775062 -0.42113086956129641703 -0.044371506779242370078 -1.3906765022461600179 -2.6209979898926136777 0.93641189833530924513 0.13699071648921712363 -0.58317423283848035531 0.38963737636121975605 0.34965565325214559289 -0.59443384746742655711 0.83636989594473032383;0.15443135255219114788 -0.91555621907211048871 -1.0363070316050375652 0.82538078957678040481 -0.64227972080102468944 0.83521556709364974669 -0.71104424337513993937 0.51244445694934603885 -1.1218322725647791316 0.26649637306545387316 -0.77369097659012953105 0.1499366146998538929 0.5436299405895216319 -0.4167842892275835931 0.28454259418870420095 -0.57977678518480946224 -0.27679222663223135292 1.0551052388456272357 0.098242780393573203579 -0.31276577052762527531;-2.6289305931303239561 0.50241722150830803173 1.431439930264666538 -1.3928628158990326025 0.13342261324203363859 0.2551352251496628587 1.0365353717244620846 -1.1411560686033055401 2.3186014436445727682 0.19095955613187287625 0.4193044244959664435 -1.0791761788601714755 -2.1596387459107977413 -0.23757373801174788697 0.38730865545480319678 -0.2965985495738526212 1.0277060110910261059 -0.15063864802793416886 -0.76757967283194461494 -0.28595363694057646109;4.6000393083037423025 -0.054087530225974178588 -1.6161869448943699812 3.5223032723752858431 -1.5986231879406045397 -1.5262927199158762281 -0.92925320525099674995 -0.28918279262117058126 -3.8788165147355262441 2.0512038254590616582 0.49559487861806306164 0.33844506151934372618 5.8726884934448033704 0.67683004283648584565 -0.014312978926922905257 -2.341266727977961537 0.28142653718975019217 1.9300224161906374132 0.018906662594704561065 -0.020259523131969610354;-0.6419904038819251868 3.9264587599610689672 -2.4454274022135176203 -3.969486055861981999 -1.3186569123091314015 -0.062967014434049395355 -1.2706542269997507244 1.1991828758905591634 2.0459832279292373691 2.469340255702250797 2.1094287524750665597 0.68126069189041060792 1.3404600652755678247 1.5196742074447524562 1.0709184579995871811 -1.7838638876249610643 1.1516101291697966591 -1.0238924472380857011 -0.89006953804441157896 -0.44823885425081233524;0.92807668647536911699 -0.15965566072147885368 -2.6187814978752839146 2.5532660343301736283 0.14522554526897182847 0.58960322096993256213 -1.4886581361478308239 0.48768871019633991404 -7.305919814709199045 1.1556467212218772822 -0.76147641605080995664 1.9684492149110401904 9.118558750723680717 -0.027479028441179019493 -0.88858390906708717427 0.72593743581030989453 -1.2048791231862652218 1.2609108410001039768 0.62529165984815426871 0.82123850321207358949;1.6924778915760774201 -1.7702982437292991147 -1.294293509211027704 0.27220884480205609357 0.0090047592553506722313 -0.57111678372287921768 1.4555929143178127916 0.57040287820251056594 11.32664530043368778 0.4952816984174686632 0.70552503168065294759 -2.0156639523010659865 -8.8286814883280602118 -0.10318732645152790817 0.52797876271988941621 2.0670707132466237255 1.1594693628262195961 1.1998038439575930969 -1.4410327871990613602 1.8983036806800306362;0.29918953196922498661 -1.8200859904234960585 0.84783020940166420321 -1.1147777556205207272 1.6676578100520180747 -1.0342007254077449918 1.2714357061284515815 0.40673357479541361048 1.2435050764496715647 1.1513276209260001615 -1.0806230111904624458 1.0016582919870145041 0.66396639038606708461 -0.39543996269054199066 0.21483126501224547589 1.3582201729025322745 0.25255962232444417737 1.8823753292384639568 -1.343116904896215491 -2.3099822996523311502;-3.401437888216327643 -2.1772986641754270565 -0.12241814253983888949 -1.8788427416235033984 -0.4041904064577289124 0.25239511217908633389 -0.38588352441857970421 0.44531908782316947937 4.0551925830367467896 -0.96959997898484107104 -0.33077240897715831647 0.40169919256908676042 -2.7400609727402338578 -0.1502237603887849049 0.29540622113836029206 -0.63929361771633741451 0.39650807444346475306 -0.65890583726523088703 0.074449606627481498822 0.038439978194150320467;1.3983135690733037304 1.2729019014789213493 1.6254785374896356664 0.32616495978181331283 0.33897610166793412656 -0.61790126273827927772 0.4644042999595788257 -0.17376675593055865288 -1.8490963898175432067 1.2103229533081922842 2.1034927063415973514 -0.1794526068085645909 -0.33557814175967459747 -1.9092470529253531275 -0.58222833584324085177 1.3609901833458195597 0.13070196721393814721 0.59498299779790841946 -0.68805851995675437749 -1.8454617411956317774];

% Layer 3
b3 = -1.8967701375622663118;
LW3_2 = [12.594201618279587507 -0.13251323251016025595 -4.8536680439103410123 -0.61906350898814044292 0.51492273624745132921 -0.17177740468656854667 0.23897426992995030037 -0.10563880603548445047 4.8066090489249733153 0.38999690245616985829 -0.7231757823609781255 -0.80209402436606447306 0.41233134801198906283 0.22232886632484391565 -0.10875596956771498014 0.13238062001099665244 0.16862505289487567106 11.77585258812739788 0.56177575377032873405 -0.25787523766040132411];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
