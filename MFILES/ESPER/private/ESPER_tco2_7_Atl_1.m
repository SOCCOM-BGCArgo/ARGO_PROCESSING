function [Y,Xf,Af] = ESPER_tco2_7_Atl_1(X,~,~)
%ESPER_TCO2_7_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_7_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.6016045885941939;-2.1427344661008259;2.0858120761161776;-7.0268279846258359;-2.0536356933752109;-4.8023349605290298;-2.4010405506412593;-0.3032651132024981;6.2587305183859074;-27.088106748325309;-13.79642656415189;-7.514832469462954;1.2657179055632366;-13.993754178020206;14.337176242673468;0.95007486637023708;-11.590713062406431;-1.0680634898719275;17.440524243943116;-4.4875368138185605;-14.058014547730078;0.85599624342821601;-20.03959952800405;-5.7723701770756009;7.4613184329846094;-3.01363356333998;5.4374672183708146;-4.001274603667528;-28.510175429132101;1.1034622212422696;-0.37073150084120604;10.685826654425826;17.714365363665799;-1.3091184823275668;17.410744158371497;0.40857009236105007;4.3864557647388409;8.7844354899885051;-7.7410579299537376;-6.129917411282884];
IW1_1 = [2.5431583880487065 1.1982830188949669 2.6001585635606377 5.1540994285422439 -2.2870801347448557 11.201228208860719 5.8427088810682335;6.6467158073887864 -1.1032827925087096 0.74772365091748227 -3.7294077987597349 -7.7130372729941126 1.8690634678524418 -0.98983758380027331;4.3540781540152613 -2.7669998521228161 -1.6696048706230182 -3.6634585329337757 -18.157053467510103 -4.8897579997617591 6.0595909219377218;2.3256522971604543 -11.735829285273812 -0.47410342921347848 0.38780009166674712 5.3037240414249185 -9.7220049991095721 3.8545805188098816;0.01578231070971977 -2.712298356331861 1.8767565328377878 -0.026776141730747896 1.2157987108727482 -0.25711357599672852 -0.055704170382164714;-0.10695619482443489 0.19378465903584249 -0.40409261062276391 1.11991968094288 5.8871204924071918 0.1777296178687901 2.6773219378290096;0.49469343055996634 0.38400698218624768 0.32105036589257557 -0.68260617194367301 3.1276239382473201 -0.22079498220132798 1.0527693265150144;-0.63070620016415768 -5.1384028655611447 -8.7945186582817811 1.0817885722767424 10.907869066284603 -9.990353904865783 2.086550843621513;-10.022957620618241 0.96749448290653406 -9.9134214246735972 -2.6318537496944461 14.756348756575253 12.67543029462419 3.6639655063839345;0.56109389039639157 -0.83987735503063843 1.6550780872635791 -4.4353201855937607 33.848208764782726 -1.3059216099482165 -0.22251461341107936;-0.29625702639870211 5.7082576090385926 -6.8210378664740947 -6.8967883607000307 15.225706474783445 -5.5105628640853039 -5.0046537234747825;4.1175502163519857 7.4632412316900565 0.96192573545324611 -4.1143959194198336 -3.334067846280071 -16.701160279007006 -6.1885837426743739;-3.8152015182890748 -5.8574564093771606 -12.143920852121161 -0.47146940675206084 -4.3653039220802556 18.827448453354599 8.7389031000710116;-3.2672148792039235 -4.9727821808015999 1.3799319502393756 1.9821435887133183 20.88197638633924 -6.624417467786631 4.9524096714391854;-0.17022528032992393 0.22008228992998879 0.32266401322984478 1.1049154690100875 -18.337754211978787 2.9678282078194007 1.5313959145562976;0.64397100929617435 -0.11509157821577193 1.2781729368771768 0.090651227497295039 -0.31411609062711121 1.899068972941673 -0.40715084473877972;-1.8947551742704407 1.4275849451812808 -3.3158084512810726 -0.097946595369306388 14.434207690748609 -6.172347239918885 -2.6890903901422796;-0.70308194554390202 4.4528111059236402 -6.1279345839726389 1.5443351012775099 0.052522845137654574 -11.139942477880158 -13.190419052417267;-5.703465640565776 -4.0049469349788014 3.0417351081338095 5.234759244620462 -10.579576076861077 1.3276511753705003 2.183409043489045;1.0135083899961326 1.1443934615209606 0.95145967394707598 -0.34826212817324231 5.8331466062223987 -3.2378512614734953 -1.3933582697137612;21.531171658542089 -11.853833576751649 -6.809064974269158 -9.9559180442151494 -22.67449408429383 -5.2670140370897389 -2.71946729295259;1.9500046906566977 -1.2290117627132122 -6.6218411513789528 16.837729145113574 9.5234017876323431 2.5547800137879744 2.076120224422862;0.6168967500616771 -9.442139917605795 1.5100556394062818 -7.313056827986161 12.686000507020314 -7.164588440208159 -5.4078299426937102;-6.9676218887010934 2.3694929663216362 -2.2082515159360439 -8.3588001424839806 9.3520595989040984 -13.475980106836946 -0.44798109540102177;-1.9087958285148434 -0.74812816670261617 -3.833935339550933 0.60915163998695421 -4.6145896323011648 -3.7900759467078786 -0.95990744089669566;-5.7110999266784033 -6.395554965907329 -0.37166499857819557 3.6170251917069351 10.497375408021812 -4.0086708770012764 -4.9879068812764418;-1.6680699656907638 4.2713252763746388 -2.6529940557031519 2.1316171567044395 -11.132791040164143 -3.1362686804409381 8.0229871044858427;1.7990402951459898 -2.0886734804838034 0.46934019967605162 -0.96185878315279316 3.8289836557924453 -2.225539305398875 0.066636748695949016;0.11802003388509824 -1.0244231614731507 -0.20942600469258899 -6.1746809520632073 26.637058179288534 -8.761323496056022 -1.6266858158026978;0.14015176691879813 -0.042383743548553877 -1.2657970853179981 -1.0799274249094042 -5.334503533065206 -2.3043495880024318 2.1854640628366546;1.3022674748599838 4.8702896599680745 -2.7013670967654457 0.70917555517150876 3.1870828274047973 -3.2379979512978792 1.4389340369900487;-1.4612351080468533 0.88514675137439436 2.6912420420310057 3.1584948437448968 -12.445659265006224 4.725843739396562 6.0620715662133753;-5.3160059737452396 0.38208088030345905 -5.8085060069434586 -1.0438479328450647 -27.740617780888009 2.4241097095401587 1.4978005343037448;1.28310906768065 1.2152807234816401 -0.81804760618502403 0.97459502320228275 4.4975918655719722 -1.0593535994722232 0.54692690598781313;-7.9771364303808197 -8.080329947276125 -0.063810604949831276 -1.7826610920615822 -33.681724162044127 0.7994326047597301 -13.613740110634284;0.76054130351908356 0.22300150245812808 0.35112140563707678 -0.16045337748935731 -0.92100574319223116 0.35093396025409707 -0.038123335857611879;-1.4757622231033416 -2.3040278508407095 1.8408827248979645 -0.10666873891658306 -5.5627986462767378 0.46664625115594344 -0.26303498110775969;4.2549626585987514 -6.5265481985226508 4.1437058910653723 18.883937230002857 2.4854052881638489 2.7539808216093995 -3.4974192064707132;3.6283388452016192 2.4254637717188272 2.489809375546451 -1.1636185121867881 3.15242440283162 -6.9136516220082527 -0.77755884448496648;0.56887566976092174 0.22837800133530761 -0.2343084340145106 -5.4462138667326006 -2.4687050247142066 0.072107639741891383 -1.5366374730419778];

% Layer 2
b2 = 0.15541469004387698;
LW2_1 = [-0.005943684431105465 0.0072901746932140955 -0.014207243147166992 -0.0069954425369945237 0.056099508612740399 0.055797140333578403 0.12795614630623292 -0.057273066139587187 0.0044118371713840034 -0.013725782061573068 0.0052460992364961566 0.0016407875258725754 -0.0025917499298464233 0.0067029428843241737 0.037488129455049202 0.12406294262240455 0.018096681433609034 -0.0029927641606188409 -0.0072176295651580329 0.028159270599664148 -8.7589940221472271e-05 -0.0041142800106800052 -0.0051057129468170901 -0.0066282718183084512 -0.041021294022780562 0.0081401461886836252 0.0051483350456758593 0.040976252690057308 0.0072367932488265436 0.044532513070377568 0.014202067192515778 -0.013823158632810544 0.012715674121639098 0.076965873487055872 0.0027889962318287382 -0.26247867412942744 -0.050122242198397372 -0.0052525720036025996 0.0075107196212263125 -0.57707745242423247];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
