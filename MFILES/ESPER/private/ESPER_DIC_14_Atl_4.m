function [Y,Xf,Af] = ESPER_DIC_14_Atl_4(X,~,~)
%ESPER_DIC_14_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_14_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.7785117454259973258;-4.9366233275456812279;-0.26619262982774788417;0.50440184380103825212;0.64180915465345544924;-2.9037063066004922263;1.8457186276213117804;-0.76568969748137905018;0.13292122582002013909;-1.5609157017727268713;2.7385715664041585526;-1.4748302387510505707;3.6797637766374662327;-2.9321357223017732174;-0.35605864306785828255;-3.5749681021296551009;-0.079115085914413407764;0.65774802247708508141;-0.027287206663288696151;1.3676677546356394988;2.4789766821663268281;0.72520502963720223644;-8.4791997056130927746;0.93621914542610684684;2.91127747944148485;0.94949527291309787635;2.4590676333179590785;-4.5829599229413293671;4.1043968207788426028;1.6998700806984305967];
IW1_1 = [-1.3263545793022974983 0.26458104252030828496 -2.4937105052847807762 -2.7340072320573347575 5.8273489861128231482 2.1118784641371353139;0.15576470568776784598 -0.42591404493666046305 0.060502039272540643344 -3.1921547512866448315 -2.0792141734402149744 -1.8992236083747562336;0.12739439413014175262 -2.6426978297212841973 -0.41449751229061554403 -2.7077419785744405445 2.3033820010920740273 1.8067994327356216022;-0.34998433826586017314 -1.3852157380233816042 0.90410365097068823292 0.71182953727984388248 0.44121940388167840696 0.95689507197693679519;0.15399465151848359956 -0.65327495859622530805 2.2516536439799184066 0.087753926469522167131 -0.081455682125167502838 -2.5443953464954343069;-0.3673130816317709546 -1.875954647965828892 -1.8313284832592608975 0.26824729879670039523 4.7675225613132452551 0.63539593198923649542;-2.7351330826386828221 0.031702349517959541036 -0.46306517332040053603 0.22660236957368010136 -1.8558432872825190163 -0.16839892484191598676;1.3041608391525185695 -0.37775822164716782448 -1.1227877089094939755 0.25263764381240366719 0.1811288801086541056 -0.063023987065621497883;3.5589139900004083117 1.6693873848500753176 0.84450971641190719641 0.4301627731627856166 -4.5551879719973662475 0.0081319312743573530372;0.33740197078410510967 0.58368746712195496151 0.44265671461512540175 -1.3877665007418298337 1.2456414699724731587 -0.49651225959547184985;1.0703426387194767688 -1.4996724328373827184 1.227978334660720261 -1.2976249025060115905 -0.035202354264659577177 -0.68397043283999847674;-1.6839439164764582468 1.5372696149348314965 1.3127127614062994443 -1.4654264348451220279 -0.51769904445844805441 -0.37373332423168814653;1.7216075170758611268 -0.39581523700387843956 -1.1393386127287310483 -1.0171702025655384727 -6.418680968107929985 0.76700200940214224854;0.67403311071206073457 0.012941768381501907517 -0.30187718583183864585 1.4902958669171524342 4.3700456443535617979 0.79752552026293865861;-0.17149165226785023641 0.71304839229848837601 0.051214307062689756744 1.7168794886218610163 1.753692873195490165 -1.8701920998745726887;0.75763939969987159628 1.602050566203637727 5.6968189459648099771 0.068565098379052349942 0.49403660671997290388 -0.098878986978976096678;0.62203447452967852715 -0.70540160243322191924 -2.1386136951017440389 1.9078015493291722304 2.0971193059583250751 1.0438578052072626789;0.70718814467387902667 1.3205251388014780378 0.048970637831859439859 0.28801092485269791377 -0.16324803742508550708 -0.53782361734955697052;0.74878240701206333352 1.6271051044300490762 3.1700901619076287119 -0.19474054055031148058 -2.6577455981028776932 -0.33868158493513683682;-0.82328881179476776087 1.8271636744466157598 0.85000265874969527236 -0.25590003438043129602 0.96878466914409799848 -0.20250681348427329587;1.4523460424712193451 2.9860458100169542384 1.4398526856874289681 0.35416522846494274956 0.38904732037168304748 0.3910935856255782217;1.1782259331076703202 0.18742115667695213865 1.0882093600968352209 0.37872052397176969585 -0.16966311540307030259 0.48188067319617777784;2.6792877285592742176 1.764524443038947954 6.1130928544943374803 0.056467296816581427632 0.92333369522307617849 0.9894782872479451763;2.2519610037320410001 -0.43347871153347455886 1.1457269678550285885 -0.9177855509846032378 -3.2639478387366014367 -0.61931443436488375909;1.9005625855556480541 -0.66788750851530465091 1.0878065470116566882 -2.2825477765521609008 -2.8537280066030068504 -1.6847619737620782576;1.2726121232179830045 -1.1148216118197409319 0.096095031780695061574 1.2588708344232582004 1.1602592199501153836 2.4342062289069983372;0.76623257071494754733 -1.3746378727185581958 1.2830019070621674349 0.66317786922263022298 -3.4073807442346821794 0.78648622312223126496;3.2057998107059821891 2.7436385453481464403 1.2674252474730371976 1.361872726745808837 6.5972237244320472982 -0.25129399207238478642;1.0868867351123814302 1.5061985298045583725 -3.953221071512934337 -0.73712776624354181543 0.41985037119690254981 -0.046435663122810014181;1.3049445170072253575 1.8524654401432090189 -1.5466504115168431266 -1.6768600066185508357 0.18569406058214726896 1.1276341242244558583];

% Layer 2
b2 = [1.0532749883144523206;1.7132003176808199285;-2.8737730361222624254;1.9321438518044602439;2.0004225409423121995;-0.10846008965607729924;0.061082326140763518185;-0.70616460325283514354;-2.6488867228501438156;-0.37582402713041151987];
LW2_1 = [-0.04757764525621817342 0.63191979504024198278 -0.66722544999665689414 -0.22676794335837674454 -0.16721684388668645038 0.16674033540906976758 0.75148066682632974622 -0.84169656991453944972 0.74417427360241161782 2.2282477094278707597 0.69454646876910119957 -1.7723532950476188486 -0.21547919966029960293 0.89168525777026708123 0.13215526432905719267 -1.2422323970826523176 0.75789603914858694189 -0.97442822240127413558 1.4574504433651396251 -1.4481904122231716858 0.96976141463405041154 -0.95359749877180410849 3.1506331242634040279 0.65107333935876887665 3.0942450533091818698 0.2857923267053675831 -0.50524502973410334583 0.14396693420614248282 -1.9547379560236579632 0.71064571189489766923;2.215712704574318348 -1.7620178249132030235 0.10813892542191078094 1.5861651306403019568 0.17857528689957308243 -0.88482881541811320147 1.0151866963201230387 -1.7578836561537938277 0.12155413826733151017 0.86533391338241893997 -1.2565094614420870833 1.8363839145839020439 2.8386315186061907845 2.4401469958422370432 0.95055427865673602916 1.742268717331283856 -1.4412728471370788164 -0.26364219006082306729 -1.9619625067663521989 -0.403589196626169322 -1.3283553078753704835 -1.0711407233950762663 4.3453236834393207388 2.0563079762588345467 2.851679018852701919 1.250003738467788672 -1.5366842450615998406 1.4994932831079985647 0.24739525437932596841 -1.5506289090190068514;0.1013986675713645369 0.45231520850348272411 -0.70980983295477906303 -0.68998583134826529939 0.070660687215173573206 0.42566986974904374996 0.075229279531027939965 -0.057918337368699904233 -0.70214816841900928868 -0.65749455351207786169 -0.35358567449549954675 0.49474855117044375108 0.56031376764874585295 -1.1468165615138719016 0.84636031045670723216 -1.1744402125726125519 0.055463556028756549887 0.95179709556741320942 1.6631781830792855548 -0.10449649988342772644 -0.34433605599447530965 0.19942798436260433803 -5.416313674715382831 0.47634597896414831997 0.20865652360157679879 0.53794562937854140117 0.15555276487148222975 -0.2755437949904582795 -0.72895833735211390536 -0.67667121377326122644;0.18957466552331095344 -0.20674577404408764347 0.35825168115213884557 0.99898965990070542897 -0.83623809165538132149 -1.5401371272741470886 -0.45820958345510820475 -0.47217855843993605802 -0.26264240403445282546 1.1469547921646354727 -2.8538724381139051189 -1.3077639003337473422 0.07581110765765267101 0.35637296434892778985 0.38466807783743850457 0.38251940299985298655 0.046736693085704689166 -0.11942777959637486396 -0.407068776584873393 -0.36764705336336123143 0.032608149433900918135 0.85051652814955780446 -2.635311259054870181 0.80628315946386253099 -0.19770547030570831404 0.38783127199517752892 -0.31314537606461967378 -5.5934259638017973515 0.8848426236709502346 -1.358991029975330056;-0.040639510133699818795 0.96482483548113839866 -0.63674423932997448183 -0.37816868725548147268 -0.16245990655046765871 0.014094693751629545214 0.66369112266712726456 -0.71120345063991563528 0.66357982776346546849 2.1281799334998043882 -0.41975217007154669302 -1.6523309899919120802 -0.25900727896889802482 0.90096217706454928553 0.13088138907233723418 -1.0340435774293643689 0.71945278575917792629 -1.1081843856645356983 1.2022385377344586566 -1.2058409468454209801 1.0446589592810324731 -1.2549361091345945241 3.107977493237569 0.63894657550554678771 3.1597024043652752745 0.33113424381829770216 -0.31990172778284881039 0.14717780966024071598 -1.4255673049715911205 0.63116427268079544621;-0.77160402449710063788 5.4222446309182243951 3.2901188010024373654 1.7271680043468653487 -1.7473967567892372266 -0.20167452542226066425 -0.61734033864659010327 -3.5289058606753704872 1.7800071392673446624 0.7799967719019090806 -0.4943521753351085013 -7.5626998057906558159 -1.3166438360901160376 -1.0003748928597684387 0.92086481500331018868 1.1885134568117117215 -0.7552945393619887593 2.827927318794042133 -3.2465817144065898248 1.4591104607955380779 0.49131874254163826476 -0.94031680201658007778 0.13131030492411399635 2.6718649740289763805 -0.83013299832410136769 -6.2389229990601124953 -2.6918385300217941847 2.6030608868548861246 -5.0037251904988870876 4.3480897056834111325;-0.2135589783418984644 -0.26598053020098416654 -0.11983503457859785712 -0.15370331362046429913 0.57731519793879471081 -0.49050564388980860686 -1.0766334973681239706 1.9940364356369140175 1.4109623539281315185 -0.72325296971346919594 -2.2463480983699000149 -1.173020951005590673 -0.98687069568650620521 -1.1211473533483178322 -0.97409920113127979047 -0.49551726460459472046 -0.79910563390123690031 0.41231474685059171792 0.70528747075769981922 1.2430854157584318997 0.51815558785609439063 0.90242466011962074734 2.6473899243880802956 -0.026781177720752960547 1.5815274886563850387 -0.90119967488607588546 -0.87977562934857456156 -0.51153900922612149937 -0.24927669885067374467 0.031423919393204054196;-0.28379777111149340207 1.2310580668076527289 2.1684165441903178184 1.4481869063242345241 0.40929123224158242556 -0.25530767074342891609 0.27140359075396219835 0.94960526950865364881 1.3784892770947039242 1.6980395881701351168 -0.46740737092122985885 0.16452284617795420729 1.2992072577291315927 0.059627649067593373189 -0.74724479613643579601 -3.0702653701229145611 0.62604473822774220348 -0.11862995046014740419 1.6813284700353481327 0.28659453811149643299 -0.55990875920331872884 -0.063131526381647276591 0.29811354075590490442 -0.56545129399909177526 1.395193844455612231 -2.5670414001326880005 0.47697180386147242093 -0.48468274837621744267 0.21938995910749245488 0.050800793249411557717;-0.24350363689672790968 -5.5637119784193487249 -2.6065200511240345094 0.34583770988174733496 -0.112145166000092944 -0.89616712910906670686 3.1038167922542876376 -1.0482446564904071007 -0.23345799697980906817 -0.4870127804804182392 2.6423684908678497507 1.0926631214116713231 2.8526847821320515664 1.9309458151973823981 -2.6422402882620086295 -1.1862339551089255973 0.57070272775974628665 2.4036567854970956049 2.5411376165541015304 -0.5920844314326687563 0.24851233314768539362 0.5211800194613752657 -2.2550614320391173528 1.026928532196492494 0.31343642335661103804 -1.1906323468095247886 2.2633909160780940617 -4.2658719851653188471 0.90051572234936749783 -1.8138721374532797981;-0.48932754047701054745 -2.1891762475224667561 -0.72630513978505317763 -0.68369717561899023828 1.4191772042726449321 0.22669596145075043836 0.14967469014510959013 0.2936138502970282449 -0.91301055584483536975 1.0048345465471619775 -2.7929144308652231743 -1.6259592048157285316 -2.6557074084013234661 1.8236973590176794868 -1.1172916723370027725 2.1888941985267527102 -0.26804000611998207715 -1.9335581095875780111 -1.2863188947400179263 1.0748884707941930294 -0.559221248144763039 1.8666567216149483333 2.5949154181706179934 2.0950234574350288241 1.4409792599627668785 1.687087194615977781 -0.56367808045713474474 -3.0572203021214150453 -0.29591518249547771324 1.3747046954903032745];

% Layer 3
b3 = 0.6919596229978228763;
LW3_2 = [2.1734311609378256236 -0.12753641173288024491 -0.084803955859887827917 -0.0045911600622438675581 -2.1777545936465827481 -0.0017932562989865551487 0.033372165843848299038 -0.010822017619807043978 -0.0091030276851254282588 0.0075106351294591412043];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
