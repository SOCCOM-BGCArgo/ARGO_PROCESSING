function [Y,Xf,Af] = ESPER_DIC_3_Atl_1(X,~,~)
%ESPER_DIC_3_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:10.
% 
% [Y] = ESPER_DIC_3_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9305309197856277414;-0.78367253712784423758;3.3449904650190918076;1.4298486387812421317;0.55902573372988606515;3.6494503273940930299;0.69893745544367802403;1.703267816919670663;0.1768589287960259937;-0.28949640205857229969;0.401259931276464199;-0.9528788168274725523;-0.73772008762132068593;-0.11743201057475013971;2.1698128368291738077;0.17601661863551787413;-0.5048518767585166156;-0.035387300698739854177;-1.1758115558985500204;2.3593186686947902331;1.7940241728576451496;-1.0117189488507987161;-0.37402540921102644944;0.066863860350437689939;-1.1683478346039637419;0.62895250208041286744;2.517331802074691538;3.5117365755957710149;2.9954190259438986388;-1.2045012890375066394;2.016195372904658889;0.17694221208414029345;-1.6572436939350911889;1.3873487262291179789;0.35579852874664352758;-0.33416912097299644735;-0.32322823711272741232;-1.3093743031560898249;-0.55878145423022540506;-4.0763016077445719532];
IW1_1 = [-0.96269097363238509413 -2.4234439416259903055 -1.1092109782962251696 2.3902626291923065871 3.7653931281045345258 -2.0795174358928578684 0.5613156277797242133 2.4854837172859070016;-0.89955221171081656273 -0.23155560671866751155 -0.16079722547069516536 -0.45682394475712462256 1.3709295490289714614 -1.1817160629316794118 -0.67745669891755777581 -0.37844111363716442797;-0.74593370621006227505 -0.72089791618633503045 -2.0223752212371466364 -1.1823210604353564523 -0.41103599921941758044 -3.0136576436144557611 5.9600152067333471706 0.31284043147308215893;-1.6918279013505923558 0.058558398038087745852 -1.6989527991599802093 0.5170020627588239881 0.049907206592369232623 -0.4814510703331068564 0.69085535595340119563 1.0162185196866939663;0.50998185476403246064 0.98005067745437712823 0.89457697320823015286 -0.059427494801489892662 1.5371278843183251439 0.2032138552345923721 -1.3429882120748612984 1.6779902520287672818;0.7781482170880872351 -2.2487579641388322216 2.2856534859940400572 0.53817681117700855165 -1.6605213178604221191 -0.27977651480266457762 -0.96137300143962522991 1.1327545373449616761;-0.8858965939299492387 -0.63082855807770732426 -0.44705302442575023392 -0.040216877780314470858 0.54264386402554365407 -0.1078134192862939128 -0.38392652753459971526 0.59468360842381184916;0.43717091730689749962 0.26832952784149932679 -0.23079932102878109035 0.81095995726606584508 -0.47025395834145899965 0.28486940256425341556 0.026305299007369404435 -1.8735929187241289195;0.13115092898937788513 0.56020032267117303437 1.6195154855735862665 0.16403127359132088636 -2.3140167290013806678 -0.14444415358536255578 -0.14181904814688950367 -0.012979497371111424139;-0.015207353995459626031 0.14047164773027334683 0.27918972500654920532 0.38394511236944994792 -2.5723833684546648648 -1.129999070746797063 0.20579974401727821331 -0.022814120219070106038;-0.24297657543214956632 -0.11121926689323674564 0.49356551243467700063 -0.42788770400032877239 0.81984605238998486954 0.14481713314382738123 -0.41265514230878452828 1.1432079399964840682;0.52259340148638977475 -0.73098144328276770665 -0.1045480497901927347 -0.24530898255644018047 -1.1674543287757215282 -1.3504885772350923023 -0.36612439014177439178 -0.29879574519600099469;-1.4092650819463437006 0.89837248026102489717 0.52523427971885905396 0.22633395359446029094 -0.82394491906840849893 1.1102384794781408051 0.27854864359028541632 -0.42016732533491463197;-0.73527881951408313732 1.2371854571913063481 0.20627608591923429771 0.53848312803553999295 3.1483124141392115902 0.19297095971801472847 0.43743320922508549531 -0.60806881917027044704;-0.18767679827439573415 0.73281048577418139711 0.81358674921559415161 0.48401661262909989603 0.25225020356261662613 -1.4420449110389153002 0.38101246156987900182 -0.31564049848297920375;-4.2338578052965862852 0.44613975578305303804 -3.7508701259257528626 -2.1253165564415263944 -1.3205749635071926118 0.65281539132499988298 -2.3943996344990732261 3.5902468841968722124;0.51500238201187453768 -0.61901218876024954874 -0.36824063717978716692 -0.055254219376523396046 -0.30887485359580840738 -0.18544566779874346873 -0.11825160251023711377 0.0011558939866340299692;-3.9238967903196932951 0.4593830476470769919 -3.5075399651511394161 -2.1220301299878667756 -0.94976029475409362579 0.75714189419929434077 -2.2884593970547664199 3.5749773628302627948;-1.2018473813260037719 1.0053899354200985794 0.10629868928658703364 -0.93920348292752953157 0.76853589580029102457 -0.4103779830250836036 -1.422304118841042353 -1.1010049153695595781;0.6057035108725039585 -0.9829769569128081752 -0.13367126194852263499 -0.47025193472508353132 -3.0423515563012681895 -1.3248307300920558749 -0.92281946335225217837 -0.0044582706442174956096;0.7733903090695021243 -1.0956238432426352869 0.59930413233712886978 -0.41222704373634316832 -4.7240623008715223463 1.1413049241834731795 -0.61621056779608285314 -0.068544533640579011213;0.34835388880562329073 -0.84627130780091486262 -0.6818439654398118499 -0.113015632114757264 0.32793652462030409289 -0.12613455308225232643 -0.030812364926940154913 0.16832753560174451568;-0.62740057943688565256 1.894187937187655324 -0.15481433478825756822 0.21392412253631123975 -0.85965874382365392581 -0.55963148012315289126 0.28277128720717137345 -0.61377221435775874969;0.94569946286821249259 -2.024809420129543458 0.4599673492568795985 -0.50125105426867888614 -1.1620941415902186211 0.72134621094661677265 -0.18629153376064475078 0.64089691653760827439;-1.7306735416362566404 -1.5841825258344026661 0.069969564107627890692 0.0033301118975145394333 5.6793355755946732799 0.53640872426202401702 -0.19981694264953744899 1.1288881595984787687;-2.2401834632309873818 0.93393546542541316935 -1.989800843663346086 -0.68643580447383423238 1.7012461483334222478 0.99974259697602951835 1.1709027096019033465 0.81463492655330571601;-0.7112301167055340434 -2.5211514944912218894 1.1185282401701994726 -0.62232296833324896035 -2.4475089203618307643 0.064789403503453815714 -0.80450395108757077889 1.2930494814714246221;2.0572777771345447384 0.35071353381394021476 -1.0102246399140883959 0.1279819126963817888 3.1893382959644829278 0.074728721809990947267 -4.3372198152480070377 2.0682601793802386503;-1.0464877332640769581 -2.3529191686431780717 -1.161679396602397496 2.0848907856569405261 3.8384710359538138924 -2.0633595943488667324 0.29491753038605045267 1.7656337229432494951;0.27035368145442167931 -0.34754563629062268371 1.3717274138299719866 0.57275799220211720542 -1.3299405111078401731 1.6549794031089435364 -1.3159988856279161151 -0.19529812584606884296;0.3342772930885363758 -0.31407347236970617477 0.063778682221074342595 -0.67738869900001119628 -3.5859591837087170241 1.3989795436362879588 -1.1056482956678137519 0.2302010762474619443;-0.82838870860447699762 2.0393181150148027569 0.89310802401236089043 1.3893804777967342368 1.0965998428288097344 2.7889771788305042222 1.8778843780821314891 -1.9593469459949317546;0.57864286624699823314 -1.2079966427319597244 1.6291518349723890235 0.87761885032036790477 -1.9451421464139078132 1.8051252944310778314 -1.383433591781597638 -0.48215438236094637636;0.62800105993960053663 -0.50316971168043833629 0.14507026318232810191 0.30299351936998608625 -0.12548001734112262939 0.53420080752729648399 -0.27773396772748820682 -1.0032176280848223993;-0.61547392871573136652 -0.57682250296946047108 -0.20026388717104864901 -0.044385005760828120935 1.0596134955399763022 -0.11956729254557597886 -0.52892609984123695188 0.68575263688004706175;0.029936449752121958856 0.053964984663925616437 0.4320772014958309537 0.36960665209605753079 -2.7322926505463374092 -1.3997217310540248647 0.096396973482651041043 0.020055737041267254067;-3.7402164299853040141 0.40822033416228681313 -3.3437976815030148181 -2.2054731350265246448 -0.56748473238565644294 0.79079724217279756537 -2.3786076771767499238 3.66999133598063354;-1.0097189835118338674 -0.0031936471732611770857 -0.30944435943546355627 -0.4733750848443979975 -0.46066701652094238506 -0.8430123408241482208 -0.29432425355261171429 -0.85904769198726049773;-1.3083655389871582386 -0.14892857689926211617 -1.3490607884192529209 -0.2051279585630447766 1.9118072707896553997 0.6977397275326348014 0.27438564163658796247 0.95289030955226827757;0.61998446339307200503 -1.4815907916051354043 -0.95831958981024689681 -0.36454716550951093978 1.7100638040636277903 0.9699852149400833845 -0.015181631061673788591 0.36065491834939816806];

% Layer 2
b2 = 0.76404826597858066517;
LW2_1 = [0.91851940657359942843 -0.41791950001961358785 -0.11946719291666912932 -0.033313083468571522139 0.10869524514671180526 -0.13635452477700935048 -1.6328980316615215873 0.61536654140836855031 -0.51607062982695983688 -2.829606264412660277 -0.74887139579160577618 0.52355975883438843343 0.85495485501404955286 -0.46724494368660657306 0.65464181318072867111 1.1866354618888435013 -4.2144538746454234257 -2.8409348105709057997 0.12313316523316471252 0.53949842777768308721 0.25482255850991764046 2.3934791380879083533 -0.3125491107050837325 0.23005117039860517592 -0.17060226274340040131 0.05138876464775490871 -0.059835454214452743482 -0.086259756076938587377 -1.1187699303038185494 -1.3699513964917582332 -0.25119021938914870562 -0.062295510913655899321 0.85367751906797784134 -1.1519383531350499972 2.0144106211614305479 2.1201737903588271372 1.6400688012249577952 -0.41125462105345855779 -0.18994918440092778411 0.70367550527659361581];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
