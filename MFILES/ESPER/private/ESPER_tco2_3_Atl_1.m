function [Y,Xf,Af] = ESPER_tco2_3_Atl_1(X,~,~)
%ESPER_TCO2_3_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:53.
% 
% [Y] = ESPER_tco2_3_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9305309197856277;-0.78367253712784424;3.3449904650190918;1.4298486387812421;0.55902573372988607;3.649450327394093;0.69893745544367802;1.7032678169196707;0.17685892879602599;-0.2894964020585723;0.4012599312764642;-0.95287881682747255;-0.73772008762132069;-0.11743201057475014;2.1698128368291738;0.17601661863551787;-0.50485187675851662;-0.035387300698739854;-1.17581155589855;2.3593186686947902;1.7940241728576451;-1.0117189488507987;-0.37402540921102645;0.06686386035043769;-1.1683478346039637;0.62895250208041287;2.5173318020746915;3.511736575595771;2.9954190259438986;-1.2045012890375066;2.0161953729046589;0.17694221208414029;-1.6572436939350912;1.387348726229118;0.35579852874664353;-0.33416912097299645;-0.32322823711272741;-1.3093743031560898;-0.55878145423022541;-4.076301607744572];
IW1_1 = [-0.96269097363238509 -2.4234439416259903 -1.1092109782962252 2.3902626291923066 3.7653931281045345 -2.0795174358928579 0.56131562777972421 2.485483717285907;-0.89955221171081656 -0.23155560671866751 -0.16079722547069517 -0.45682394475712462 1.3709295490289715 -1.1817160629316794 -0.67745669891755778 -0.37844111363716443;-0.74593370621006228 -0.72089791618633503 -2.0223752212371466 -1.1823210604353565 -0.41103599921941758 -3.0136576436144558 5.9600152067333472 0.31284043147308216;-1.6918279013505924 0.058558398038087746 -1.6989527991599802 0.51700206275882399 0.049907206592369233 -0.48145107033310686 0.6908553559534012 1.016218519686694;0.50998185476403246 0.98005067745437713 0.89457697320823015 -0.059427494801489893 1.5371278843183251 0.20321385523459237 -1.3429882120748613 1.6779902520287673;0.77814821708808724 -2.2487579641388322 2.2856534859940401 0.53817681117700855 -1.6605213178604221 -0.27977651480266458 -0.96137300143962523 1.1327545373449617;-0.88589659392994924 -0.63082855807770732 -0.44705302442575023 -0.040216877780314471 0.54264386402554365 -0.10781341928629391 -0.38392652753459972 0.59468360842381185;0.4371709173068975 0.26832952784149933 -0.23079932102878109 0.81095995726606585 -0.470253958341459 0.28486940256425342 0.026305299007369404 -1.8735929187241289;0.13115092898937789 0.56020032267117303 1.6195154855735863 0.16403127359132089 -2.3140167290013807 -0.14444415358536256 -0.1418190481468895 -0.012979497371111424;-0.015207353995459626 0.14047164773027335 0.27918972500654921 0.38394511236944995 -2.5723833684546649 -1.1299990707467971 0.20579974401727821 -0.022814120219070106;-0.24297657543214957 -0.11121926689323675 0.493565512434677 -0.42788770400032877 0.81984605238998487 0.14481713314382738 -0.41265514230878453 1.1432079399964841;0.52259340148638977 -0.73098144328276771 -0.10454804979019273 -0.24530898255644018 -1.1674543287757215 -1.3504885772350923 -0.36612439014177439 -0.29879574519600099;-1.4092650819463437 0.8983724802610249 0.52523427971885905 0.22633395359446029 -0.8239449190684085 1.1102384794781408 0.27854864359028542 -0.42016732533491463;-0.73527881951408314 1.2371854571913063 0.2062760859192343 0.53848312803553999 3.1483124141392116 0.19297095971801473 0.4374332092250855 -0.60806881917027045;-0.18767679827439573 0.7328104857741814 0.81358674921559415 0.4840166126290999 0.25225020356261663 -1.4420449110389153 0.381012461569879 -0.3156404984829792;-4.2338578052965863 0.44613975578305304 -3.7508701259257529 -2.1253165564415264 -1.3205749635071926 0.65281539132499988 -2.3943996344990732 3.5902468841968722;0.51500238201187454 -0.61901218876024955 -0.36824063717978717 -0.055254219376523396 -0.30887485359580841 -0.18544566779874347 -0.11825160251023711 0.00115589398663403;-3.9238967903196933 0.45938304764707699 -3.5075399651511394 -2.1220301299878668 -0.94976029475409363 0.75714189419929434 -2.2884593970547664 3.5749773628302628;-1.2018473813260038 1.0053899354200986 0.10629868928658703 -0.93920348292752953 0.76853589580029102 -0.4103779830250836 -1.4223041188410424 -1.1010049153695596;0.60570351087250396 -0.98297695691280818 -0.13367126194852263 -0.47025193472508353 -3.0423515563012682 -1.3248307300920559 -0.92281946335225218 -0.0044582706442174956;0.77339030906950212 -1.0956238432426353 0.59930413233712887 -0.41222704373634317 -4.7240623008715223 1.1413049241834732 -0.61621056779608285 -0.068544533640579011;0.34835388880562329 -0.84627130780091486 -0.68184396543981185 -0.11301563211475726 0.32793652462030409 -0.12613455308225233 -0.030812364926940155 0.16832753560174452;-0.62740057943688565 1.8941879371876553 -0.15481433478825757 0.21392412253631124 -0.85965874382365393 -0.55963148012315289 0.28277128720717137 -0.61377221435775875;0.94569946286821249 -2.0248094201295435 0.4599673492568796 -0.50125105426867889 -1.1620941415902186 0.72134621094661677 -0.18629153376064475 0.64089691653760827;-1.7306735416362566 -1.5841825258344027 0.069969564107627891 0.0033301118975145394 5.6793355755946733 0.53640872426202402 -0.19981694264953745 1.1288881595984788;-2.2401834632309874 0.93393546542541317 -1.9898008436633461 -0.68643580447383423 1.7012461483334222 0.99974259697602952 1.1709027096019033 0.81463492655330572;-0.71123011670553404 -2.5211514944912219 1.1185282401701995 -0.62232296833324896 -2.4475089203618308 0.064789403503453816 -0.80450395108757078 1.2930494814714246;2.0572777771345447 0.35071353381394021 -1.0102246399140884 0.12798191269638179 3.1893382959644829 0.074728721809990947 -4.337219815248007 2.0682601793802387;-1.046487733264077 -2.3529191686431781 -1.1616793966023975 2.0848907856569405 3.8384710359538139 -2.0633595943488667 0.29491753038605045 1.7656337229432495;0.27035368145442168 -0.34754563629062268 1.371727413829972 0.57275799220211721 -1.3299405111078402 1.6549794031089435 -1.3159988856279161 -0.19529812584606884;0.33427729308853638 -0.31407347236970617 0.063778682221074343 -0.6773886990000112 -3.585959183708717 1.398979543636288 -1.1056482956678138 0.23020107624746194;-0.828388708604477 2.0393181150148028 0.89310802401236089 1.3893804777967342 1.0965998428288097 2.7889771788305042 1.8778843780821315 -1.9593469459949318;0.57864286624699823 -1.2079966427319597 1.629151834972389 0.8776188503203679 -1.9451421464139078 1.8051252944310778 -1.3834335917815976 -0.48215438236094638;0.62800105993960054 -0.50316971168043834 0.1450702631823281 0.30299351936998609 -0.12548001734112263 0.53420080752729648 -0.27773396772748821 -1.0032176280848224;-0.61547392871573137 -0.57682250296946047 -0.20026388717104865 -0.044385005760828121 1.0596134955399763 -0.11956729254557598 -0.52892609984123695 0.68575263688004706;0.029936449752121959 0.053964984663925616 0.43207720149583095 0.36960665209605753 -2.7322926505463374 -1.3997217310540249 0.096396973482651041 0.020055737041267254;-3.740216429985304 0.40822033416228681 -3.3437976815030148 -2.2054731350265246 -0.56748473238565644 0.79079724217279757 -2.3786076771767499 3.6699913359806335;-1.0097189835118339 -0.0031936471732611771 -0.30944435943546356 -0.473375084844398 -0.46066701652094239 -0.84301234082414822 -0.29432425355261171 -0.8590476919872605;-1.3083655389871582 -0.14892857689926212 -1.3490607884192529 -0.20512795856304478 1.9118072707896554 0.6977397275326348 0.27438564163658796 0.95289030955226828;0.61998446339307201 -1.4815907916051354 -0.9583195898102469 -0.36454716550951094 1.7100638040636278 0.96998521494008338 -0.015181631061673789 0.36065491834939817];

% Layer 2
b2 = 0.76404826597858067;
LW2_1 = [0.91851940657359943 -0.41791950001961359 -0.11946719291666913 -0.033313083468571522 0.10869524514671181 -0.13635452477700935 -1.6328980316615216 0.61536654140836855 -0.51607062982695984 -2.8296062644126603 -0.74887139579160578 0.52355975883438843 0.85495485501404955 -0.46724494368660657 0.65464181318072867 1.1866354618888435 -4.2144538746454234 -2.8409348105709058 0.12313316523316471 0.53949842777768309 0.25482255850991764 2.3934791380879084 -0.31254911070508373 0.23005117039860518 -0.1706022627434004 0.051388764647754909 -0.059835454214452743 -0.086259756076938587 -1.1187699303038185 -1.3699513964917582 -0.25119021938914871 -0.062295510913655899 0.85367751906797784 -1.15193835313505 2.0144106211614305 2.1201737903588271 1.6400688012249578 -0.41125462105345856 -0.18994918440092778 0.70367550527659362];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
