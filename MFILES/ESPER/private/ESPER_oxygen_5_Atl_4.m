function [Y,Xf,Af] = ESPER_oxygen_5_Atl_4(X,~,~)
%ESPER_OXYGEN_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.1366186928622417085;-3.1970432135501787307;-3.8728964392692670771;0.5146598960940529377;-5.5031283459178039763;7.8824067153424239862;1.2145787843058213351;7.3106307625109820947;-1.175199555711846866;5.1659192012777772618;-10.986755108550466886;-0.38945136510825317799;1.1868924227607651201;-11.398046942596526065;2.7027584004805835782;-0.77283481338039128339;1.3712805524026294712;-0.27220129125011283122;-0.45917641238651007995;1.0853402730845322921;-1.1789480769324656162;-7.6751398480514199107;1.8204430823120609784;0.80280326675704671846;4.0941414852368751554;7.0060665599925577851;-2.1191660400837015743;0.60856844619449501632;12.164620885257610539;0.4248946667206994765];
IW1_1 = [0.21314069773775901062 -0.267147682276375531 -3.069583970990072519 1.2959897316566519887 -0.10138489003977357861 2.7912931698861980223 0.18207988707136185669 1.7539937017660645058;0.82889864014072867082 -2.4704966659074885094 2.0225086012816162473 -4.688956819324335612 -3.7157936957089190422 7.8719478656188295318 -0.25232370182741403752 3.2778890373007678605;1.7030489739121006387 -0.46981542077841975669 0.32725644566983008721 -1.5794812993409916846 0.80920921748201779522 4.0137274962674629464 2.1815374217721590355 0.70153817645354010768;0.048032349780830062291 0.002505636303575706561 0.28260607420653105493 0.24438774159708304134 1.1999903505479536658 0.56589122856398998973 -0.4203746563414211268 0.58141864096663065098;5.1573153012611436807 -1.1920164331277256498 3.1238646666403693253 4.1540172582559673486 7.8354628099908092409 3.0801600206629538015 0.70409291503545179403 -1.908360028022542787;-0.15498987874105366047 0.28928824095435068386 -0.82909523307525978542 -0.43279041688763786322 -5.4355013677100849634 3.4826710596525716213 1.5255152829792919533 0.15572887541128696554;-0.11808273281114380071 -0.68885505291992432664 0.21236333001591839453 1.1940217846041389915 -2.5148090874530408811 -1.892774010238473803 -1.3747509921693805701 1.9860864014385171128;-5.5473101766382688638 5.3551761901473584615 -7.8481201798300457284 1.1983566774289153845 8.7618519331668238692 -2.1062158394356678137 1.4284887430653698814 0.77977134786149748802;0.52728981167930222274 1.7698627384317087152 -0.49448134107655666858 -0.11592755664590122244 2.4437288228299873794 -0.58150214839753333607 0.58287942095854161639 -2.0976228353971921869;-3.2500003589044150765 5.483157004980903082 -2.2994563025098706532 -0.49069435255475846169 8.1118906676965831792 2.8625588995668818093 2.2993711251741615342 -3.7226946151256155026;-4.5743123775397069863 -4.3909721921454849536 9.651439053435076687 -0.0087172623821208002071 -3.4965802153096743332 -4.3974465971023244393 -0.3260034993664053804 -0.073994650056850380659;-0.029088521548039699555 -0.029189497520503045191 -0.11589622975156445295 -0.27731135484930230506 -0.96363473071148064708 -0.47928916228711149206 0.27759106728499671757 -0.411861752803048764;0.17746130518375125007 0.32956087198197508981 0.21850196666780999366 0.29021995640125469729 -1.7168839940527966803 -0.47087850742337894472 -0.5001019189622537553 0.9515384835448811307;-0.014855107068422858732 -1.2313733200189467265 0.58143504288846781236 1.6167874058745874688 12.19658111330865502 -2.5256202886895082749 -2.2996712066205682312 2.1592315933463890332;-1.7914681070478839509 1.5076643180493674024 -0.68618021094658510073 0.10801959774554348304 -1.0468864839811520273 3.8031737346433929225 0.62783167676771511889 -0.80287040969573608695;-1.2954792574884119727 -2.221195355284343087 0.21784578205713359123 -1.267332254445598938 6.9027366289062213056 2.4725349593111793922 1.9211352834934503075 -2.7917124147814642576;0.021261135377861447443 -0.011407156708810215276 0.30858623144812319383 0.073614811787341249971 -0.79506933934393775321 0.58605002255076066309 -0.13747035222155401524 -0.10147628146958286022;0.053562090517950751434 -0.15101154904942007406 0.30093278859900840505 -0.10150117579138540069 -0.72985032353334944322 -0.14544605219240150373 -0.051526714586257738038 0.037810635227453315288;-0.028111785436733236626 -0.074380980978675362292 -0.0062380314728940379487 -0.69964248819256980028 -1.4608130813043724849 -0.87412253630658576231 0.45892717781499370311 -0.80511638606174984467;-0.94848890217382597623 2.7869106998168797773 -4.4406761270285430854 0.78254964244962388342 1.6711328136310006354 1.4039839606516908432 2.2216786322868413706 -0.69036259104489561267;0.096953232312347953359 -0.19555438335981609188 0.85132848531146021465 -0.194937101612416952 0.84484683901485768676 0.61338018908886848823 -0.27422265614334900841 0.17465591074026112772;-0.091033760988661158176 -0.10614444315295780419 -0.52403697043502750486 1.9698170570216657627 11.677616246079860929 -0.7983542779142052126 -1.5490992661235141181 2.4505581090761490159;-0.25395724273826347783 0.46077916817363628876 -2.6887910891793218582 1.7483839589452359053 0.50811273646296573059 -0.85881421370809374327 0.52448207674038083148 0.26637834057645198849;3.2254259595059946442 0.037756922992080596546 0.35735856071280819313 2.46440062397305093 8.9008127505585292738 3.409383260209851052 0.96439278398721983709 -3.5348870995864558608;1.1761185112713206102 -1.0328029860146821228 -0.16103578767063184141 4.3101413152167866727 -0.34499548129850010625 1.0087644902039345496 -2.2667906175302583449 -1.0089682667731685317;-1.3919448882626896946 0.8933303637433801514 -0.025267881422824763765 0.90613009555850887455 -5.4737090695424646114 0.62503762845911770007 -0.23898051815692641919 -0.51406145833167116166;-0.1545159650488428793 0.1534199366718930202 -0.48712866690731587704 0.3398866213183375784 2.4613299846322189701 -1.4173334439226041859 -0.33932737205502733202 0.48515417811807004522;0.16363887055794795744 -0.16773696470331181385 0.31431983669445079377 0.22494485076860409878 -1.3421710709568470676 -0.29569514512753120039 -0.34744325751163152027 0.65829490453792072202;0.9731725278784169042 0.82501471375638213424 -9.6788334300309522007 2.9882859004756361365 -15.611417751512890462 4.5564743125843527594 -1.7234559865979433013 -0.032817125714593678443;1.6579597621937500751 -0.77369515168441405084 0.44101975638563667426 0.23104184179231776475 0.14709078899761973691 -0.87963735370911755318 -0.49026078413261492406 -0.34134364587764803867];

% Layer 2
b2 = [3.193455914982403776;1.4656770082783419085;10.609474293205773066;12.67763033882063084;7.8713003266180834316;-9.8301086329711679923;6.8757365221493103036;-19.43599562346204479;6.0643884994040710978;-8.1346496706146851352];
LW2_1 = [0.18769004883865456068 0.059429759530088624442 0.11507544274023832898 -15.20801395510085996 0.0097350846408659815617 -0.26624608791548032283 0.35682948277177639618 -0.065672487243588734129 -0.1217057579223680408 0.50030273165287464376 0.22932235446564974701 -29.175685797329254711 1.7853808319293218432 0.11308558152281775189 -0.098016616887377464029 -0.10616683675410966414 -5.2411692745899847168 13.032613025461611045 3.7292779310697801165 -0.069573183677277300463 -3.2695963639766398856 0.17116675637709402591 -0.25751732929789555859 0.12117074695254724526 0.023560734018506054172 0.10463543567634936426 -2.0313503884893306939 -5.935523181065966547 0.0035418071011594017168 -0.20558648950105554154;4.6194901566988528785 -2.1335902224557807827 5.453909299837402358 -3.1602379095428734246 1.0867279818044306428 -1.6137483574419957399 -3.6309789821827185285 -0.61049656769231686049 1.58024917956874833 -0.49137891525061255793 1.7904397353729983866 2.2199881757785653313 -0.21432056097332155553 4.055173903452213402 2.7318261617822745535 -1.3607792506771463348 -5.1951570138641915975 -0.40358193443175766069 6.0717099464962842603 -6.1417499581939072328 -4.5701338658421475358 -0.034078374780881638684 -3.9725070318759891919 1.9498205448007905893 5.0087888471485273456 6.7010979960210335094 3.6845380444044497636 0.73223989846231773981 5.1609222104532355146 4.9162783674611487683;1.1076748290922993068 -0.049938935187432323404 0.20244306115655688605 0.26652952563852227996 0.066690606877611469105 -4.5195139195087197237 0.61964320748356482849 0.23589719821199570116 -0.068924557336244085537 1.0361739858961009908 -3.0040839245825208259 3.389496075424398569 0.37712904996634710741 -0.21618026379638630163 -0.017394573569949334235 0.16123880657720035536 2.1231170770484646404 -6.8656736627016909935 6.0627638199207698477 -0.52341465617868443427 2.655921815418353038 -0.72234282150724848925 0.49107164218745125162 1.9416765622343028497 -1.5517871956449973414 -0.007715505861370819396 0.093987508937156266642 2.8849360403068344816 -2.9350291989523844549 -3.4697998949589479167;-1.9103782203663346451 5.1470563488818248388 0.3227487886343947121 -0.20330879361417708573 0.93682461946090278548 2.2373754632721922775 0.20401434785525635052 2.0293594413178728253 4.1448623734709233446 0.77284283313582913255 1.0688617752194331523 -1.2041884723451810046 2.3703949526741907583 -2.0415435856083763433 2.099808301612413608 0.48671639261084137518 2.1458828031068546416 1.5268517882546910336 0.40824298307438577904 3.3592576992304330474 -0.88913043542504266448 -0.066512807289339892503 1.1041792219305845979 -0.3007696563854624916 -1.9007717417215779232 0.71824001243540491757 -1.2598947964046225412 1.2697754660650237835 -12.860704533352009804 -1.8236596059080931731;2.9981348507540199755 -1.3528581779359041271 -2.384941795661634778 0.93389274587037973685 -0.96739120752926077706 -3.5952837579129628409 -0.18554908673414863274 -2.776504315519437327 -2.6720602826700843302 -0.36686326543658565047 6.4471303053564126273 -1.3514924639574219523 4.7279826561843414368 -5.8230825003753983182 1.4424942329216918768 0.58445747121747881891 4.4402522354665636684 2.5855709394742967255 1.8612827429476912489 4.8054302500588477187 2.05385595093332185 4.7225031306098337325 -2.1999678101165263122 0.26639448097145695948 -4.9966520474284292774 4.247421202328110823 -6.9439521227780511836 -3.5912301514989164453 -3.7006717745403783226 1.208564880150064802;1.8656763213842957327 4.182378663261227203 -4.7181600362029652018 -0.51551926468919073709 -0.82528825602967559316 0.4316157668472440645 -2.3276297263117062819 -0.15546564727374861947 -3.4417330336709697214 -0.88698194017231990482 0.99745129431584622637 1.5031704279288591319 -2.7349610335393501614 0.75743583813469050892 1.7459566249554614448 0.62579447381379238458 2.8162087419859811455 1.9752174125339256872 -1.0274785188825505955 -1.9249527839129487727 -5.5044006101086813132 3.2432742296115071312 1.7423495654450245063 -1.1998490692918437617 0.25153711746927093218 2.6944354524148201868 -1.7032053192981526646 -3.0576829372257714468 8.5069780040909819263 0.96514213353275923879;-0.079569946352369080866 2.9664974232265355347 -1.735475906627925502 4.4014867470337941668 -0.05720616488581324599 -0.61518181278187911154 -0.28446074892331524309 2.1067796505729003975 -0.53258958725530980427 -2.8204926867796089596 -2.9104723226210662546 -2.7876166749093669317 -1.7182331111479303143 -1.1929249215527819583 -0.51676705374293951945 1.0913496488346348112 5.0546403012152838485 1.8420437757466776585 -2.0361197083632052163 -4.0704525070469221859 -4.1620474347370688406 -0.25051600337697615961 -0.059279515033531807178 -1.7265743708939067513 -0.35532523046330222183 -1.7652044708215643976 1.2551924030804899601 2.0330625066594212313 -8.0397445088014389825 -2.2970776373682140203;0.18426942797977260979 0.42506314780100806772 -0.86205797869795641741 -2.0156758756821595568 0.041907324605415637031 0.49718827475511939706 2.2294007540814431145 -0.34681010320380639689 -0.031174154360641130601 -5.0484753955645533807 -0.80346024140154870263 -3.7760055171878041946 2.7877375723028285925 0.04772701987499202575 -0.46744264779081184935 0.39383341748821559802 -5.374883909440913321 -1.878702923993593954 -1.6887514941882877384 2.5932303141879531339 -3.4247895068098261895 -0.61018935983109356957 -0.60449882564056045542 -1.6240872723182868675 0.058586359485422880022 0.57550822623744668505 -3.9603717192001188785 -7.64316153708935353 15.322367766420455837 0.52315326507855663962;11.458802115272968436 -2.1894622612029541742 -2.3852905386899592166 5.2750764989271390348 0.24557414811039177116 2.8480944676578570096 -0.63720198335459699024 0.20578351626188401413 0.92059068010436106988 -3.1101181637819186321 -1.1456574565111636854 2.3955688557044325648 -3.541970161123951133 -1.549158930853418159 1.900858505283966382 -0.82201775898307261059 3.0584085635513864609 8.4060765423277636899 3.074510164426244696 2.9975199325139483264 2.7296813323914865812 1.7753596333101011595 -1.2783784313090078566 -1.0984989428865206129 0.65306834730492513419 2.4873723218353482878 8.6403135387137961487 3.4802454314123427714 -3.0180938484952903877 2.6709000250618664118;-1.0228739324343687489 -1.9519622349360956637 -7.1211706914441554872 1.2944567470624284145 -0.38886747306949415171 0.42860413773535827042 -0.78702897027173046585 0.022759916983322657502 -1.2798115290317424453 -3.4426637535358781683 0.0030025724318299695792 -0.13352509150471011945 1.4611091005800509457 0.1718245824299527158 -1.0739498053608158568 0.28513989744066425835 5.19323252988411177 0.043642170766723727138 6.0102101792609303743 -1.140627532835913005 1.6419133591398189509 -0.72186008421825642589 3.3134381687588359 -0.057066591742806933862 -0.47927682993079018248 -1.4073891208579665246 3.7777500317413243991 2.4062245407356783744 0.087207047776262522354 -1.515356905851545033];

% Layer 3
b3 = 1.922816236291426728;
LW3_2 = [-1.0733155920881991552 0.024566991911476168675 -1.588175566930876581 0.010376834759884906445 0.027208904816843387103 0.012355460189967276685 -0.11334722132953435614 0.14302991788618207858 -0.26266432543877227257 -0.096084715322767563772];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
