function [Y,Xf,Af] = ESPER_pH_15_Atl_1(X,~,~)
%ESPER_PH_15_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_15_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9940897408914937117;2.7729921739790688306;-2.9585652942662368226;2.4804634854443308178;1.2220887693514226324;-1.8962113660705925966;2.4953910522307607422;1.852931440227505;1.8438991872358516666;-0.8111153929610990243;-2.2786383642938354832;1.0512643193360307059;-0.081978922954763749908;0.78749280306853186584;-0.18721707048347149827;-0.10188522436151888073;0.86100562805896596608;-0.19233031895326183069;-0.80064851336900599854;-1.2407714398884170937;-0.53894758400086983929;-0.097017290149317342296;-0.81986762556533221424;-0.24332996577508636538;-0.23239023027084024231;-1.775169632167414413;-0.96214173890154919278;2.5605448163416273388;-1.6985348770027715037;-1.4441613193193436615;-0.51440804820464025582;-2.5438809551572605372;1.1526474026135358208;3.1908340969374489049;-1.9963709886939344784;-1.9077227836323880084;2.4848846013076455463;-2.2320586413483325394;2.0423857044682565132;2.5193633749210584405];
IW1_1 = [0.0057312745184114532657 -0.76964862700985003929 2.1947967409774342684 0.98794502723081578655 0.36080546286229497888 -2.0102957379632244717;0.014539856977211357281 -0.26168810714976326048 -0.29162423263913556104 2.9693852563581573101 0.88350538626823604815 1.504020985195345661;0.90100649411468847205 -0.58239220492729892875 -2.2079767905135283534 -1.081288627999081875 2.3823357702340928199 -2.1446517926132959708;-0.64327687871766636718 0.012387415597162184863 0.55604782343196135219 -0.77334538524669882431 1.419656046621694756 1.5884347648069829795;-1.1144379966299295948 -0.075267172419401534578 0.5877459985044812818 0.081693762673460165735 1.2049108944685207323 -1.0029174920119323655;-0.89660374712110191275 1.5183890837167757226 1.5986300623962967915 0.99629560049457221993 -0.97956792957362692764 0.86337381946018931789;-0.80460002516478323908 0.47149590562420018447 2.4387534942533766191 1.0184569352267276443 -1.872517916976345731 1.8829764361246539295;-1.1745637028700841586 -1.1200952817220377611 0.92324735908618860147 0.023043854665821029287 -0.99936259496048573947 -0.98825159580347443633;-0.97546108360526995185 0.92522307314712359805 0.34205338307684046706 0.89035853037791512499 -1.9818470513356054585 -0.67822259088768022117;0.60823103662873989617 -0.5924717146525909639 1.4586104914281468048 0.47774111039763828002 0.073841624222726040538 0.77714332076065451016;2.2311723609559339643 -1.4042217811245689685 -1.7392307435782821123 -0.43921324296751018679 -1.8391637331091679197 -0.21368273709000779048;0.62076032956550497577 2.0640645237746273466 -0.34604925938211067438 1.1664330185049114341 0.18417355102288640589 1.8650481451972384939;0.33150409350619608473 0.49313091338821962717 0.93845362128645659627 1.5666090647662465063 1.2042970196033975228 1.8081231206287804447;-0.96529104531927456545 0.76813137068253922735 1.0042346219398017304 1.1517619746079079679 -0.40402984115271117771 -0.088315797613600463545;-0.52313154597660338485 0.54385894364523612587 -2.179524408265780977 -0.1766565823047353545 4.7885201360663938175 0.33679534796797094831;-0.44793033601745135819 0.79330888936481946949 0.71728182734149492639 -1.2982700345562676603 -0.30293948115091812179 0.52576619880743924451;-0.089711336447500206193 -0.57361685573232046309 0.43444868353085303037 0.30508452713915390486 -1.0190305268856290066 2.6979147930223668084;0.56651885433407067616 1.5200907114494162098 2.9553159351745601491 0.93587833247434470962 -0.17578896901396406927 -1.5223361537652895237;0.35215606855540027009 -0.90789267576062337994 2.0664577980026983539 1.6748765850865372506 -0.70628851350704136003 -0.60318089395960916566;-0.016935920972136874613 -0.58594603521684551772 -0.83740545975881075513 0.44880068867408073885 2.1015006923006485096 -0.57698477194611885732;0.70965872912869243372 -0.85535321678220288533 2.9824383048340719071 -0.011138100741883387793 -4.4331855893333251828 0.039594540549679695107;-0.53405113408869331337 1.5777550122227255169 -1.1226645967625881184 0.90339929241574334906 0.72146298693777088928 1.5993893342356759746;-1.6481901775520537701 -0.8663107080035359342 -0.034273426260959763412 -2.0904774156856849032 -2.349838914249574362 0.1500981045349588372;-0.76432065594321108026 -0.023700890044556242875 0.023252155299091994273 -1.8012460181998741771 -3.9031930376706065466 -0.19857509037382295447;1.2547023275657878116 1.8378373752575751787 1.2726220931372702605 -1.3578126786914292978 -0.4040979226360303378 -0.14713121582215882288;-0.42039786281997915118 0.0034304287339379864637 0.17365816361895508591 -2.6641466170596674878 -3.3133401382360312404 -0.57198781042948343423;-0.61433547537798505189 0.46408589162034979969 -1.0839567888955254915 -0.4027946748263463439 2.1955593871127296879 -0.87083984014761184334;0.27088607043330004132 -0.10438867527746455155 0.083630399253015061389 2.6259279964989956646 0.30208883753740656264 1.8565816880244221387;0.22544438607482544801 -1.7099895110478848803 1.0134894103344882499 0.85319021604211298104 -1.1928918452832264485 0.93578735341035357287;-0.42443125336930681568 1.7553589333766557168 -1.5283503055384994873 1.0740537744675575649 -0.69365919511202900338 0.15817155848124209161;-0.71426569420261787347 0.2359202181934250131 -2.2254031632752622194 -1.5980456065708330549 -2.0211832899552995002 1.1192471784991973038;0.42329863870329209607 -2.0441369794429431472 2.2584995409069636985 0.49282663232944262655 -2.2359732239393670383 1.666388163357973351;0.3357932166873056623 -0.010437316808215423708 1.69421504905443987 1.3134028670730459876 0.96123711762253127855 -0.65033017795889325185;-0.33086365400989659058 1.2959063060679616441 -2.7756007018853825485 -0.9964968404160594595 -1.8198629493044642391 -0.75792519924660717301;-1.7028171620668972608 1.3183982819713904178 1.2257440039541704913 -0.059207583511339062499 0.5287475331202960982 -0.50126969338421756284;-0.17975640845800289203 0.74266337980129082386 1.5167798225036177584 1.003860373562360353 0.080464815206826051375 -0.2219512465677502544;0.7706286269931025279 1.629296379411086626 0.85101427562008480354 -1.4918754920656811525 0.071722076116381539013 -0.016795559908379248393;0.12465054933765570833 1.909598999654219309 0.28927134788476138727 -0.60112754035545878928 -2.3633635530798788871 0.50025063968167549078;2.3867613973868562205 -1.6981319228321629655 -0.083741105061676493482 0.90790764350535679839 -1.3869755154169352007 -0.50171910519386275773;0.69988244122798870528 -1.0765278160623827919 2.0529038709070941415 -0.99851023852648290724 -0.0346573884393514553 0.13533167809007942695];

% Layer 2
b2 = -0.22740168007297087427;
LW2_1 = [-0.37361337675815387005 0.83138314877813823678 -0.766939270381049365 0.2500238457103193257 1.0998747286641250565 0.43158050035480499673 -0.96882600026267440274 -0.46164518022432893263 0.67465472562617312402 1.3502121884668560892 0.32880126373558665742 -0.050680627578609048489 -0.17160508174656938229 -0.54364121542012444621 1.487062910435858365 -0.59821732067059540938 0.22795694308960953722 0.056675102839206216443 0.18601599870020182892 -1.2637614769150691263 1.1664935988449616211 -0.13127634580919972374 0.14441088226467069244 -2.1673836341182193266 -0.094100013173349705831 2.7793952951004587959 1.4038180133083077994 -0.75572897755142420806 0.92960614510865435811 -0.41524937097120728779 0.72283742356876912183 -1.1989209497014938766 1.2729438820910639052 0.52199752621393902263 -0.30352480582743424087 -0.57567621636898569371 0.2497044563204582901 1.1216878882859031563 -0.16959901057096932186 -0.19831635606266481697];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
