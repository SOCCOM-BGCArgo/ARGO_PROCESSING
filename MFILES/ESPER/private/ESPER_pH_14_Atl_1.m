function [Y,Xf,Af] = ESPER_pH_14_Atl_1(X,~,~)
%ESPER_PH_14_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_14_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0261011478162829214;2.1111125203583180898;3.0813897342695417692;-1.8714176822013244283;-2.1011339284957730733;-1.3850718206599976767;2.1137799549851559178;-1.5737665043225590455;1.8224850544749480186;0.54703700555037637621;-2.1070828010453692691;0.93234275245993214476;0.46002987804430284235;-0.27626133600833807646;-1.1960205296465931113;0.42876683895778205935;-0.27413793646992323794;1.4876434348586011769;-0.45410091320468476406;0.530159890706133341;0.060904869219253116031;0.23200096190367683335;-0.027573192677495469288;-0.5387363417224286799;1.1286843361649192552;1.057364484416099204;-0.47742207940853353954;-1.8296843692296280715;-1.5181654091408558482;1.9515584531811989155;1.6970598321045231582;-0.64015579876062767006;1.2393960914763986203;-1.8025227733593451873;-1.6779889763634316946;2.2860800207709406351;2.3427095901903922659;2.4983849747312394385;3.242809985844824272;2.6047847484458523937];
IW1_1 = [0.97662493879466671931 -2.0202547071470089435 0.83287273233185799004 0.13302635761961589811 -0.32866980498766529273 -0.99756087054152220439;-1.2293169757497000028 -1.2243950889757388989 0.059284246673120433169 -0.96323229982055091902 0.14177895489271810647 -1.6111903067003261469;-0.88470229820891288508 -1.6735044262374842994 -1.8160877361999885338 0.79803699669481920065 -1.622122433790335716 -1.5023028223480383581;1.3679031038841513723 -0.19775400225515518682 0.048432010490408503034 0.80742959362332755724 -1.6055692862736234972 -1.4979932813052481144;0.35664815848732267511 -0.25675147105567569517 0.75815875094410167812 1.4205807022887733115 0.17574822777980134147 0.022383982630039538086;0.55381748647610862246 -0.1858602208809612133 0.16445286291224411879 -0.53485195587024614294 2.4409689360657536028 -1.3882966450012859116;-0.61110328186034645892 -0.45794421677088448241 1.2579981612040747052 -1.7697939625458571911 0.21818432200214465944 0.18004228385205428564;0.0040523642068369149227 -1.1815828833825428035 0.33206636130814465302 -0.33701033733379431867 0.39489946531404584995 1.7373580885162220877;-1.5049706449449298251 -1.0059995832345824951 -0.95575149110903112604 0.36049731846033455929 1.4719178939602750589 -0.27243899795793463658;-0.92655993211044451741 1.5250224587439944468 0.42007284986389736847 0.6926187207992253736 2.358060951674004091 1.7938536781692755451;1.052779490507565141 -0.025451339523144420052 0.70392524671084322208 1.2674882361587920254 1.0549845424868331545 -1.5027939477667231483;-0.15836951079871064429 -1.487721139919000457 1.18601262444073563 -0.47095922923340954869 -0.21598208848063563114 1.6943643826888816761;0.55775269713734465515 -0.12358200967185289931 0.93065464585751445092 1.2205778161655096437 -0.74911562586606073033 -0.12125201265417537289;1.4174670326230391915 -0.83372362227024543468 -2.5385678006859198064 1.1341202934568499483 1.9951315613426032769 -0.18563078835807414468;0.52540979774621721088 0.63903689219686610201 0.69523848239652930037 0.92713552857200787205 1.222230694947145313 -0.8526360585382235513;-1.0441969177539789371 -0.75279508885538659602 0.49910350837119116241 0.39661371791568961198 -0.42589090392354761461 2.3991333285961884414;0.67468252821704244315 -0.31656810094508808229 1.6340920411291850467 -1.3444323473867325625 0.27744533522108300039 0.20284071393765734648;-0.080757817074327969964 0.36944580060152693024 -2.9598516595932724549 0.70915416789963703348 1.997950717775792695 -0.23825864265486496052;-0.5238531628529716766 0.49887146898069595347 -0.28368054119149899162 -1.0796690826828567733 -0.39248468939815256418 -0.40253089661301627578;1.957582635156271067 -0.16326441349407308512 0.67388347047770502662 -0.20817484970193186888 3.0147224420951919122 0.94909118863522334841;0.071558488782369061854 0.53794801038357487055 1.0963895811312212025 -0.22691693884021499339 0.80299488857648282369 1.1250730282856089559;-0.01043157431334190699 -0.1251713354426511049 2.2581876105052973713 -0.74833774989801726818 0.75268336550045056299 0.20736592652343102672;-1.3328280945551402858 0.21371926812916169913 -0.38627711161070615864 -1.8403196055291222155 -2.0482834168284385079 -1.0273493741621413378;-1.4463130866432520882 1.4282774144516914294 -1.0042622170595498776 0.25873043549914293004 -1.8614608419281537532 0.75351782188420091124;1.0443006619489554332 -0.20043001055097231511 -0.17545069991996839476 1.149369456298910519 1.9072281276065969902 -1.2287769006833957341;1.1452458466047201746 0.38871478134845294239 -1.3539724610062087162 -0.6704881826563658942 1.504196467800977155 1.4243087836028347493;-1.5366936952978398345 0.81148115418826261003 -1.2063140719495439868 0.54846935001613639216 -0.26839297529202282844 -0.16640702563276088544;-0.3272437596130152726 0.17862799835918724556 -0.35339291193953786818 0.59843218426405686561 1.9028299568315243384 1.8479568462032667231;-0.10413295295710491006 -0.12175726733039925198 -1.0043165151859152484 1.3738913713681826234 -1.3598324747428904846 1.1290645795031122312;1.684813004914274881 -1.2062677027406216723 2.0644459554907572674 0.164802872342837331 -1.2757005646016494893 -0.23570697459188097445;1.2284930613601514615 1.1897319358285565194 -3.4518567997329014929 0.46237660714771161574 1.4661391152069713772 -0.61859625699084774819;-0.63860167208577933717 -0.37475903508992286506 1.9706010422897000112 -0.34272636736152756187 -2.5069149071025855768 0.27277306613990459638;1.6160657269151870175 -1.5354561098717611767 -2.2393535359461669287 0.57082117956330857833 -0.076667606215060468688 0.64331493810420803392;-0.67240007391778022772 1.2073202700887899486 -0.79523559819275624339 0.97867319266972374603 -1.2322302177871622408 1.3220412379251791357;-1.0530457714914480682 -2.5641867496248282876 -0.86678785393473989362 -0.50435015000522742667 0.95923124237096035749 2.4430043544612201067;1.861155047197369683 -1.1545765977648323464 0.91893323726267184259 0.34181129479918215264 -0.9086004727270712289 0.49512098519068081792;0.73240322838803539884 0.73513168362196557037 -2.3311416240816122958 0.035807717213221089414 -0.48790303467855872244 0.18232993373743197618;0.94810962979499247005 0.56172333428622400753 0.32618269868095273178 -0.64925548218572715076 -1.2836795875713784554 -1.4131788545477599328;1.5028365834447130478 0.2313717909600044309 -0.67625406429126189156 1.8251061020878556196 -0.25796173342176281773 -1.0831975332938095224;1.21278375724941756 1.0679919273159219628 -1.7224988698202878812 0.54141663653266214329 -0.11936667239177981004 0.33699703631208072219];

% Layer 2
b2 = 0.11732274489662301853;
LW2_1 = [0.56157139265628652769 0.62014477163595160825 -0.30227889799662754911 0.57735450094289508804 -0.43458027416054384462 -1.3959658618308570244 -0.40011165028326012294 -0.69191940387166761539 0.25970457032199789627 -0.40665423053294658118 -0.50901373584540166028 -0.23702771132986982794 -0.4579411780859098946 0.76000887855785193015 0.67075561097849589753 0.32302016075510880944 0.20844858078525171918 -1.1057099830409498065 -1.0935335841550393177 -1.1173442040769479 0.62466170324315062334 -0.26736062881794231405 0.43543865644674495385 0.97731664305769949674 2.2645451329414876263 -0.89265092024261860626 -1.3435262714114857285 -1.1668602166437589407 -0.14296552482987254229 -0.73549045802613388645 -0.83250430541465825218 -2.2957178663682706876 -0.45530530352990361553 -0.41332060984488555588 0.089271595044428914134 -0.44146352076024863997 1.702635577446647952 -0.35397123720820083959 -1.1458559656883000599 -0.82164624032789945751];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
