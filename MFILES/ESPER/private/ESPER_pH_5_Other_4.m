function [Y,Xf,Af] = ESPER_pH_5_Other_4(X,~,~)
%ESPER_PH_5_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_5_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1554229272454801247;-3.0991270051507227024;3.3232589405445418507;-1.9100116602185563952;2.121184655398508756;-0.84331576023266330289;1.2033163416077117258;-1.1834360389828164628;-0.58944029520006913092;-0.2332885856628085508;1.4976915008969469145;0.57122121113220991617;-0.9813666528353034435;0.67063773111403601757;-1.704118538786877135;1.1977467200592832874;0.090844067766399735908;0.086929001073425243851;0.94395045528855237027;-2.1790936666901763452;-3.7010077293710268442;0.59946322395262630067;-0.41393206616337252512;-1.5099379145623541554;1.0148428327859619902;-1.9905834008117202494;2.3576069169809708015;-3.2813200796874149034;1.8871760494877785064;-2.1662414193561492226];
IW1_1 = [0.47157601912327379301 0.34547992021993545464 -0.66523194098074645009 -0.25766407956037368221 0.19512510034276667192 -1.0192476718427232463 -0.94241718028146026498 -0.23688174351631879899;2.1107458776258005706 1.6549520419382761638 1.1771679755740886986 0.58208012454409363556 0.13228887734027811041 1.3336603700319273891 3.7960945302886419661 -2.4090262452183566211;-0.032407261705404886987 0.51305293543845376103 -0.10673518494637322662 1.1447306471103080305 1.0927112563729817207 -0.17435615978854152042 0.54050403962552950876 1.7524361381230981749;0.99737896622657740142 -1.2359903902467266334 1.9461753420806759962 -0.10230596991063299617 0.15557382116484977375 -0.43005394807968061466 -1.2417037619860014086 1.47558329318964776;-0.38818205969590124926 0.86392769214585529713 1.3306697100680586754 0.036016878067747899739 0.80959769133557601961 0.20765888200953974696 0.37789130095360534689 0.6321834217243647025;0.6807644510256614101 -0.27707544478661816356 0.20562634570071636197 0.014066577846969827853 1.3472105441596271547 0.12546584767786803094 -0.87629441048736245179 0.80626512989862852976;-1.2082574761688831266 -0.07122781320435890573 -0.3473327487151885995 0.14236577901660799061 0.32092420500954632612 0.8830872051753191343 0.14117474819199851699 0.4284584699914613104;0.64727525959955856116 -0.83912394111407051511 -0.82811912436501944335 0.13819924266085717446 1.1583381179065586064 0.20324552867762277208 -0.51258976711701498274 1.0156053209721747077;0.14624218309222133949 0.12991661317783684271 0.36163053254225829836 0.40289987423868989236 -1.4524146557846933092 -0.53136582514664787436 -0.223129431544816903 1.0706689194021303813;0.23018052652748774434 0.06560701634515789249 -0.63224514098372319726 -0.13837474614102490689 0.4224395430418138031 -0.2331124133343732141 -0.59169204473636782815 0.64051819123715669768;0.16495226217051922601 -0.74309685233773814517 -1.3847200279607814188 0.23256905348185077931 0.6083200479940104044 1.4956534410328126139 1.0548966988399908207 -0.18799909499830486093;0.20516846447473777171 -0.071193853447279659141 1.0535568922194979979 -0.12758629332784013344 0.176410808639121508 -0.058293835665025814374 -0.064370241678070261315 0.3412370966176339615;0.83430427850601740491 -0.62071064508730788845 -1.3087364844380369178 0.25699160851080771195 -0.25806704736142604961 0.34727787968875306612 0.53913108351371785698 -0.14309269132088234255;-0.092986848657981971411 -0.50345139896666701862 0.33084020647320616648 0.52444962594217825469 -0.53025327618688777864 0.25232188306675884526 0.63799926865896217087 0.79249369473398623143;0.71424114282740636117 0.44986646031787314026 0.1891037566915824697 0.69780909632415699662 1.4389544772282290008 -1.121787133351842769 -0.99368684894044723155 2.8208809173072593168;0.82156463854530126234 -0.90846744815640634307 -0.97198502345371562416 0.2833541238907904547 0.92763156005241764746 -0.43404701770431952657 -0.46264253197448318433 1.6858144598434232631;0.27009513855485633993 0.25582402242985713414 -1.4526482123711961236 0.87675278880723128694 -0.4592297028466955644 -1.6374861407279537318 -0.23469977418246731893 0.16901882499680609406;0.15822836318440625103 -0.50953976002878387241 -0.79265786124363568632 0.44441621541543929741 0.071742088475877305309 0.10893738992520902997 0.34652283867610472745 1.3728516495059404079;1.4213860432736953321 -0.21514141216283194646 0.43068595789971059196 -0.65909257383841557409 0.43558374541647409961 -0.17071296674651614822 0.55409065345138663883 -1.8319828662601531644;-0.60439613389006352495 -0.098803387943536602478 -0.82857393751758368072 0.21736472453456398557 -0.86615709159611309342 0.46382840639317152176 -0.65707885859352122004 -1.1346846812520134939;-0.27990284275282878435 0.1685210141797165162 -0.31391551839414205682 -1.7036941306230568571 0.77440944270605305277 2.2912402725200906595 0.81705888984791119611 -0.80082617567512315304;0.29071437249101228506 -0.17897168063350887834 0.76550665668346384862 -0.1937075818048491771 -0.24593352047891950396 -0.90527092812036791258 -0.64679732064916772849 0.82859016926201023434;-0.72914205602201176415 -0.21212163883283124965 2.3116799104862710834 0.002288518878727429165 -0.54185849464532487296 -0.65495804809734148311 0.23706820854019869382 -0.74590358827459080082;-1.4023620137227814642 0.13928415168333829754 -0.27570192443119440062 -0.4916288619116698233 -0.26469124032195306961 -0.014987383003287573294 -1.0677610857040880088 0.42081261931483715522;1.4462639195412168025 -0.35222041723849190076 -0.22086896112498105582 -0.76154150609151238793 -1.0245695748317231732 -0.061079366653692672429 -1.1006948715914093295 -0.45041125329410974798;-0.43004173562342556947 0.5894045754034132889 1.3112381492760665225 -0.29751656053195951745 -1.4636778603732816251 -1.108478467512491239 -0.60030171663236975288 0.69985828421015283674;0.028904173509229490191 0.01601981845192910342 -1.9856975792458446683 1.7178364333620459448 0.91086026339903591875 -0.94145275285006768673 -1.2447491450131771273 1.4691025316147094948;-0.76534223090894648589 1.5461742553663058164 0.29284878057812296914 0.43335826642606983805 1.7728798832841137223 -0.11390509136505506949 -0.77230092544013828615 2.5346454277007839373;0.41657439774035620594 -0.34936236148629573606 0.76999641309339506012 -0.81955483408666907064 1.4778665280584069031 1.2532364838084302239 0.023443278971294147228 -1.3748686906020997078;-0.64192674747508282618 1.0451048496212087535 1.153545052087114664 -0.067689061033159719782 0.49019875927653572267 -0.63462597477955695613 -0.3997837648635081953 0.15754715830862447978];

% Layer 2
b2 = [4.4305819379331428109;3.2285418377656944777;0.72382659048898301268;2.1729665653353622545;-0.37920379979267387904;-0.95220614075423992695;-0.86751398351314223945;2.7983262771338108799;-1.3767495443403039435;-1.5623015292728255066];
LW2_1 = [1.6797009801913072025 -0.12909686778503667859 -1.0749632799930426419 -0.11972191459983262674 0.90760035731407007198 1.0881735722797474253 -0.22841500649286439195 -1.2074428007943267538 0.2286082380678888526 -0.010270910017844754603 0.21709384712083093505 0.078636337867516573064 0.76352837115878691154 0.88281320231121818143 -0.25601532926399495071 -0.97775224866654530942 -0.21443726355048745025 -0.11026775587052081717 0.24683142369378296976 0.17188407504854597008 0.38572414072189575851 0.083857059733007693891 -0.39694335278751824436 0.30234015714472983749 0.20648343093336976595 0.47528767081688849672 -0.08232691034594716295 0.37650471611061253618 -0.4783935084661369852 -0.62371113506666286952;1.3922485249857872169 -0.21377428541612689128 -1.0816696745770335575 -0.59632240906853162254 -0.042642656570868839316 1.0774508648449625525 -0.71207123591388177264 -0.74622222202722698903 -0.012352005616186243625 1.3042645472209750679 -0.94545767830051374858 0.52935894096825986122 -0.60271041581783246777 1.2169907028981621355 -0.38541667885225522339 -0.82781085219213246251 -0.16197971350718548544 0.48676403850698807263 0.16954605825826604693 -0.68459012021862408748 0.10373795455207326932 -1.2669571467395088771 0.29617493337144445986 0.30704367321686854009 0.2206778647642829716 -0.60704172902202413464 -0.36523792904446200636 0.35014794598783077761 -0.33537048767985905284 -1.3196549673204869269;1.1220605711242013225 -0.59876374447911429044 1.2832244956399563307 0.13950567244903741559 -1.1504817966668299256 -1.4398329698627361228 -0.7806739113252069151 1.120218082717292063 -0.69669224108195837442 1.3704839122363641213 0.073673961332024737181 1.0493939388067854424 -1.3563119481827345947 0.020082734177540209619 0.19724494183437629724 0.81361982828764189968 0.13077809759282432722 0.18264960425065618344 0.13739454405349868504 1.6265805510510782383 -0.14871374426434977312 -0.93251797244583889412 0.1141379600126224414 0.098657549200618796514 -0.19047492123166839817 -1.6590289005771712283 -0.57766405813794963198 -0.42979617270430986453 -0.69448434810430048625 1.851774004697994469;-0.96624801666934290179 -0.55812835974880758982 2.8927860965398584092 -0.13340504232612471203 -0.067982517175092183059 0.20500580386787073395 -0.017993476941670954322 -0.15218030955095576684 2.7003701441986844856 -0.5335679161523821934 0.91215730875266987088 -0.047278242860570862671 -0.23257506739380948146 -1.3590646540552742128 -0.59228275646359251905 -0.14800987302264523304 -0.57592781453225283528 -0.42971275622644566905 -0.37269749676469382527 4.2449892869836016729 0.066252488840930490177 -0.43428990153303226318 -0.42500030143761641233 -0.13170668350665296065 0.36004006384926351414 2.7878931934170663176 0.91630475501462138599 -0.46357085267275011109 0.51844655794440697161 -1.6414064053759029882;0.75889348398607781032 -0.25912682038447987232 1.1409272235183574029 0.42169867468776084385 -0.9775175209574341606 -1.28920965748550298 -0.15342052401829889274 0.85094705708945461708 -0.51210366972444676392 0.85162808625379926575 0.33764589234586800393 1.50213697876627017 -0.58755021914305682884 -0.41373451126213428575 0.07312415190046983593 0.64243656463425080627 0.2156174569462195878 0.18678961192761756038 0.0072562988115985214629 0.4468969820325285891 0.04142057557219153141 -0.34322505500928324196 -0.19718640109948742944 0.22878502678314216467 -0.0073611559987857783441 -1.3496279920470604097 -0.47477061718371110777 -0.16645658455007456 -0.83847513392162875689 1.2285626399732145764;0.20006799941037906043 0.13689259194156638832 1.3066209905364556398 0.72305805764645358913 -0.7747194833359992705 -1.1793079117227946995 0.37497830614521121539 0.43752684480743370132 -0.58739877701697906787 0.65942719861263388026 0.77093667393209275307 1.6305839576149385728 0.45637136584926174532 -0.52662665941649233758 0.094318804686475896104 0.64156623886215213837 0.35707882013102953955 -0.3103556517305727791 -0.099539511865716745476 0.32392773791629192459 0.40607487230442318449 0.3438986937588350834 -0.27431439795795797831 0.056992677872734050226 -0.18175541528424526971 -1.5675171559023028944 -0.6347456862736743366 0.079896775341159770312 -0.68170940674180646734 1.1882572855814383939;0.53208934791404305376 0.34647788914206861799 -0.033998779929138259193 0.29516660906147940135 0.76737449964762982635 0.048950359740137852627 0.74944482163027592581 0.33138713573708877824 0.035449231268598523081 -0.65414602422665990566 0.24709499362181069904 -1.3782668403382938305 0.13204465576449536668 0.053595279918043220446 0.31105433269189569634 0.087352160347028223741 0.072077712402502630562 -0.049800854882153709757 -0.14867343742137445473 -0.81589913773466127278 -0.059939773487437647548 1.479317717762196116 -0.22770077038836447625 -0.20291299374472104855 -0.11569811145733881197 0.078871701168942404125 0.030673412717023878366 -0.41780989096686677042 0.098531079832844523092 0.66028577424044598843;0.60923510960656290791 0.66560486201409752027 0.62198555839191838057 0.2337538294061267119 -0.1053803575973284723 0.33453363837051786067 -0.72984624983033330459 -0.64017132281684296924 -0.61076772257508837871 0.47666764806332379001 -0.17249938801746880768 -0.60591571454033088528 0.28261636107722065692 0.39282628191563379039 0.017753416655090583504 -0.22564675499117917146 -0.25109612299831285398 -0.015879121830242228647 0.68956041044767235615 0.90860301474313942549 0.32760965825588944655 0.50374436186369131452 0.15355340901765215933 0.097714129710853969701 -0.41402067402377407124 0.75651289343217253958 0.15420514561465287207 -0.49584150010407923581 -0.86439210965317714308 -0.49411287072631593364;-0.0039179849869496888651 -0.013214694304592372945 0.13059978589881710009 0.33974629730103123038 0.47107468017344794609 -0.095729884616973862088 0.87195999216596697945 -0.024523154473930039443 -0.056524501283806816154 -1.2464020428476247915 0.89178016622619571407 -0.25278729467345556481 0.68302555629306394014 -0.49787441947394539543 0.27785645508638456835 0.35221168745524777943 0.23535192111606945131 -0.39139040301868344152 -0.23963459534331332801 0.25264071125716935917 0.033157669671743252027 0.72239589400581860623 -0.44896285811079988948 -0.1569875368547995198 -0.030466076973797807936 0.50454398198461880565 0.22060148465108875282 -0.065938394564891505967 0.43971860440417470661 0.9960629438399973834;-1.6039764453173939174 0.019602027281421484373 0.82445378248905842877 0.38106404204067512165 -1.1994041914142845595 -0.42790913997961155246 -1.0075831925273894818 -0.60036903183136003381 -1.5084677168557323323 1.5607982021554176466 0.20299004969833109313 2.4687534250381149015 -0.05632120334639222764 0.092790820526800071866 -0.18816381061676318298 0.48399320054728911522 0.31296889932914195853 -0.33614941945912418797 0.75969034570641880144 1.319346323061959092 -1.0162269365708820335 -2.7473831461138158438 -0.57899471853797102039 0.72738132194200300074 0.036104017314531319793 1.5035087887644429383 0.51739185431828127459 0.11844128521714997193 -0.37065551373572847016 -0.32539115706596338784];

% Layer 3
b3 = 1.9865676217293968264;
LW3_2 = [-2.1528724976924222823 3.2080082360194430713 -1.9178404830981714557 -0.76898594746456294668 4.0930865176193167443 -2.0594411003338102262 -2.0004349013893705234 1.4315292831277011132 4.8821673275400376824 -0.67996623868893901754];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
