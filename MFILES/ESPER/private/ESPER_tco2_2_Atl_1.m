function [Y,Xf,Af] = ESPER_tco2_2_Atl_1(X,~,~)
%ESPER_TCO2_2_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:52.
% 
% [Y] = ESPER_tco2_2_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1329886771057578;-1.348706006443078;-4.0110294400423943;2.3748221929069762;2.0560785624187816;4.7818878132767528;4.6791394806177076;19.187237268858993;-0.51258048782825294;2.6971433207756323;-0.84680997367983502;-29.323719586151736;-6.4111267947736472;-3.1819074429646128;-8.3590383478565826;4.4722322371071179;-1.3111544111506883;-4.6074505467343823;-0.26028551559164081;0.81396164465993315;11.725845308203702;19.539102823593012;8.3465612172344823;0.64738641076604331;-3.6059740490311372;-6.8261859324893779;-0.39983821871818848;1.8422580817547969;-3.1058254373555974;-7.7846962197295229;-0.87455446616170274;-3.5523869693242962;5.0182550504634085;5.6459033718602853;-3.6489459963134414;-2.7388969734876487;6.4895530091641671;-3.7823029612995769;-12.518273885706105;10.155305334415036];
IW1_1 = [-11.798501100376365 0.12589110493887581 -5.8828806899997605 -1.4051359544285058 -4.6968976787386811 -12.123071998972067 -8.0883470496468579 3.8663837892490247;-0.30486707093020859 0.23489524226406264 -0.04157406927563826 -0.24551874466379311 0.83467462448092999 -0.51710277817297934 -0.67288879461340756 -0.27471357906129779;4.0666358049278557 2.7775136494782764 -2.0770363941097409 -1.4831765393383778 -1.2060621503097422 -5.1441192744368358 -11.243916995549109 0.732864959828883;-11.432141003976467 7.4256342769790349 2.3390737943943534 4.0057213790790565 1.5509299157553802 17.489247762612592 6.9439644632510387 -9.0081437666340332;0.22428776281790608 0.21761871156498971 0.020970664682396119 -3.7737296498222332 -5.3504277404004883 0.52437948988022598 -1.6013298659833064 3.4982766101671827;-0.90021428942756854 1.5454642394846345 0.22745887309098869 -2.1992017655487381 2.3099772993745509 4.2373261684100516 -2.6529825598520156 1.7425016987790385;-3.0138507147688025 1.6912269362118377 -0.74701137752844848 0.23505563709989907 -2.3393871085653779 4.6250720130261929 -1.1671345233607138 2.1546176627101419;-8.2554308298866612 7.7333779153293172 -6.5159946166749068 -1.0069891854920798 -4.9420489266500365 9.1285180451136831 16.815050416484109 3.2176634760829588;-3.1545343455899637 3.8277070100114505 0.24067398798105882 -3.9593438152339355 0.66931584427165136 -0.90716408424363937 -0.43449100359016807 0.72887524988110708;24.81080810201118 17.254899696405246 -0.17551365180233025 -4.0563612796486312 -6.558327030578023 -1.9386774933534574 3.6327711451662927 -2.5570430693827508;-2.8583176132057795 1.8813962300766094 -1.1624152733794071 -0.00021895878425277297 -3.6710731656905473 -9.4046869007398577 7.5543527340311112 -5.2257806823578035;6.9466699527942462 -17.273155409030668 8.0056629402699588 -2.8238587018656935 1.8401803583501466 -2.9395834160264629 -5.994595182378041 -1.3661771980392057;0.88362699023732771 0.10681137006016002 -2.2228079808911714 1.5143548307452452 8.9779166547901514 0.63090683923129398 -0.5982582974293964 -2.5766585811204434;3.0244487304312329 -9.3992831175365286 -5.298255888481938 -1.8540597892603436 0.79769120127145032 -10.534089743255757 2.2205754657525829 7.6534119908035043;-0.30820363840251652 -0.63035410813458514 2.3433899715145849 -2.3933899245876233 9.4866371761616861 -1.0836031926248266 -1.8907130812526247 1.4562315925466256;0.01837118110960588 1.6666192680845227 0.86433866592418085 -0.3632517495477211 -3.9187108126568266 2.1171608516513101 -1.0104290632482611 2.4083530561981035;3.7365253500357203 -2.9414109647244744 1.9861324067991701 3.1650694619963367 1.3892492092374198 -5.5173510809238557 -3.3235105962151064 4.4375630240468462;4.3223253989060844 2.0122097031293298 0.83394185403178089 1.0179118639507019 -2.7350788784562154 -3.0216282530519245 2.9776412129293504 0.52308357222255686;-0.16762970469321001 0.1198806511610408 0.21652846391907632 -0.14576973465952933 -0.45736763969183258 -0.17635227919505048 -0.4930543126993599 -0.10532913013389544;-0.12021727473737909 0.018764980689709471 0.51144523944573439 -0.10491495975699917 -1.6197775493244368 0.15767753970895299 -0.29438719271046748 0.047552095154227744;1.4319284381141506 1.4072526684004207 0.86978926447061322 -0.74594725747471413 -13.446096189805548 2.3003714085082914 -3.3254033319368275 4.4951120578209629;-9.6702184243730915 -2.6859724841448394 4.460694338953699 -3.2863243360644185 -9.6152539198329094 12.295576880358649 2.0871489363027189 7.9825608138239783;0.77018898455982843 2.4427821093265054 -11.845192695143744 8.9412398567271332 -8.4512886448610836 -1.4271828896662082 -7.6627017353248785 3.3105554937785171;2.4130451372262209 -0.63827264924657556 -0.13124698093621073 0.89686429761617759 -2.367108166360445 -1.1076651577975791 -1.5953497931988903 0.1338504062657758;10.401282340251241 -3.3902697713480916 8.9788170088388082 0.49465226022086684 14.784937868350109 3.0091434178002299 1.9032289965605824 7.756399693153555;0.63247635548971815 0.87450959597929401 -1.7434032421923287 0.051595299163087832 9.7836349046882365 -0.57403709758513832 -0.58408219259651939 -1.1710719571231225;3.1514170065866347 -1.1453964929147151 1.1526936902495777 -0.38744412346985335 -2.277844742988766 -3.3343210676111088 1.1234430109520905 -1.5583540986354616;-0.29644741196259955 -0.65103206013745096 -1.0202093982800522 0.3526744751257116 -3.8141618131621526 -0.75817958159929011 -0.38636796541991736 -1.6810994885498582;2.5781842090228912 5.3820809902596025 -2.148372199506523 1.1834814206525546 1.5364754085467378 -3.081202861333892 0.6676578153731062 -1.5312095419323364;1.6609710467561014 -1.0904564107836361 -5.5041050062578467 1.1380856126753223 -6.4214720493917214 -6.563699709090379 1.1618749930972461 -1.2625008343718407;0.73754646225799769 -0.64832251664815521 -0.61385198750253511 -3.6497269344799075 0.31480994685229291 -2.7162978246747049 -4.9773339815039579 3.1871177127548491;-3.0857671575979158 -4.9425266356299948 -4.135174940657512 0.2461834893483961 6.8294905884851831 -4.3634800538987806 3.3878555987028127 -7.816245066687908;2.2548420933650588 3.9619467408375226 3.7530624037505285 5.3699330125497982 11.549700521964672 2.7236331285547091 1.3896452392366525 3.6875177663798624;-0.10781850443600746 -0.073388880620377309 0.15609689163532731 3.8531397120933839 1.3395065017923222 0.2093045963781785 1.2967002427027998 -0.25238473846198445;2.2435416776007799 -3.9648205355193165 8.2437945022685675 -1.8127157191944743 -9.8612752902913599 -1.3653191183804656 8.4287852249493742 -6.0308700821959347;-0.58340655456744861 0.31269998660484316 2.6792702955490331 -6.4563455417269866 0.06179447396167171 -0.45571033286472667 1.0926758904738785 2.1740002399322886;-0.4298499022590126 -1.193576206129735 1.1756347737541857 3.4898478020950114 -3.5785611444354508 0.42414934873530058 -1.8771494636064654 -3.8287451033462436;1.9987577569955934 1.6001500209621002 3.7075816125190157 2.1319762011439649 7.3050398812477084 10.054344370042216 2.0771900788335511 -3.9666767866546211;7.2993302668418432 0.07726248262469862 0.75811780331525203 4.368266397664688 5.7107588442578381 -6.7720086786907068 6.5913342211060559 -2.8987851460431351;4.841031527917977 -0.045952951029755426 3.8430326301967095 -0.10846477242221099 -8.0644068477004112 -3.1178529980143574 0.094099356615954935 4.2251852851933256];

% Layer 2
b2 = -1.0815738915242581;
LW2_1 = [-0.0046561961224316261 -1.1480200973921852 -0.0069226237541929027 -0.0063261823740082095 0.094731719679693002 0.025114239981985875 0.058828500480296503 0.0038568570212880234 0.029454542180482841 0.0012693367749395676 0.0043328386515339764 0.0060345934802818434 0.040923872401687808 0.0043503063846940153 0.026011001065852683 -0.066789863540503591 0.011947146589534491 -0.0068886545963158536 2.6786967737060055 -1.5850580503808356 -0.026695845299243612 0.0022735908339692034 -0.0033953584020417816 -0.045053079896301203 -0.0065452989985992326 -0.077578943426999628 0.077822304597879172 -0.14780064946675434 -0.010075331749092505 0.014883357812146319 -0.014238318673243801 -0.077752220335204209 0.015449474341518754 2.0535112766154504 0.00030745663280096853 0.010249592942589909 0.037704351481536655 -0.0034628898306526827 -0.0020945330011342455 -0.014924081350134101];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
