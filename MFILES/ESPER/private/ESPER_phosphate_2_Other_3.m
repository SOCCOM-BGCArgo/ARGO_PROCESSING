function [Y,Xf,Af] = ESPER_phosphate_2_Other_3(X,~,~)
%ESPER_PHOSPHATE_2_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_2_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5081733483070447477;-2.1018899458146487191;-1.0232093533832937737;2.1910079634712791297;1.627910460852088903;0.55691099247159436825;2.3208788033946352591;0.55719340611736989377;-0.33620326417256340967;-0.456754908401577564;1.1483770384285210131;1.1625109088327776341;-0.17818498009962166484;-0.090700104909756787408;0.96230661282803320322;-2.3666431497723094957;1.8891321290261224863;-1.7729325441799370644;-1.4502254712789646174;0.94263527227790755436;1.9802286573582787987;0.75351557188998363745;-1.4371203713905980059;2.9855320385333437017;2.9060429564438261529];
IW1_1 = [-0.43581956948872402346 -0.25737528173974572043 0.76476186474243101898 -0.84304889598909815707 1.1290236648558480415 1.840557040310939918 -1.0507194898722271859 0.47878160510695910723;0.25314096692338439176 0.32203015842847043659 -1.7215703107540076822 0.38935786762320195864 -0.15627448603496785218 -1.5678233930764358117 -2.8522863807370519851 2.1351793165780725836;0.72113411988680931053 -0.34278496355059112632 1.1414738227859777542 -0.47260424345660212442 2.6468475079596176514 -1.2602439531744191736 1.0410958689500933172 -0.28383641422077859895;-0.28936004822369087996 -0.64839449596804066278 -0.67788021220154659474 0.66532688942701423418 1.8324725599966920075 1.1372833717136254794 0.10177266777068721959 0.38527135412935131775;-0.27681194228579014682 0.025379742785914875119 -0.90895856255196882945 -0.04067985003566210872 -2.8834947980223364361 1.4767480638779375557 -0.71623730196421786509 -0.022404189898426022515;-0.49870853277922561064 -0.31764084136003173375 -0.63046800604178054872 0.47512682772452119462 -1.0799661367607680251 -0.35300083712518048884 -0.79394725202580196388 0.3510097953003891158;-0.86468379947793372331 1.4933082452209485158 -0.37639829031244259605 0.78141918144782218647 0.53259945029570909814 -0.27046838615581314524 -0.3393213919549351032 0.38716135088101866213;-1.0568111718392247944 1.6524291087859994676 -0.79915174992815918298 1.2497265085245521377 -0.18366428522973377024 -0.14846017593591173678 -0.31204898195855640397 -2.1443810334310589027;-0.1204596877801298177 -0.24070501411042227735 -0.67914584450554005279 -0.10796466824181369382 -1.8519145277816184691 -0.61322377468396982447 0.41584895276991107327 -0.38285421444266809488;0.75709816688951447894 0.59882091644757784454 -2.1280118723331287178 0.78427773513650389514 1.596236635652516167 -0.12419414973785389278 -0.5225766198541980101 -0.72452793077092081386;-0.37061049725721600945 -0.19302855800540341669 -1.4926976274725249905 -0.25412093794847623318 -0.086582335641659249892 -0.11315519583663978531 1.096676207619849075 -0.076151851590233188283;0.1860497146067877916 0.21208422635327772721 1.0511852272770236816 -0.17363505502441248241 0.71905706805971525419 1.6119584926531751456 -0.0022457520714689476783 0.42742377545075199707;-0.43192788579118807091 -0.64316925283201842323 -1.6349494488566442829 0.066326984652669770948 0.24671361919632636694 -0.62434592984626025025 -0.46700251540851750454 0.18655327107988850521;0.37484257813078519783 0.60235887489334027922 1.5399640247275983018 0.063950671036280062887 -1.7216736149132616518 0.34618470644919713264 0.30142071415615334651 -0.30842866219438147546;-0.087502082685048110378 -0.18902920083130039797 -5.4303922000642463885 -0.25817529173762782113 0.49238164873987128045 -0.19552004849749909932 -0.8951972190995471923 -0.076689591993622033272;-0.46833289781857201373 -0.77262161388067462919 -1.387486432676719561 0.50814880248890714753 0.6309548956012115406 0.13532850191442641341 -0.65601282336828103947 -1.6886341359059675593;0.17736643744300384373 0.39361489352057260627 -0.47530053648200254468 0.028975020070130370897 -2.2146191174778651067 -0.90718456790292190117 -0.98485988482764930119 1.8686041820034304806;-1.3378655080920995868 0.51584268466094840289 3.2370893010484351748 -1.2194286446900333143 -0.60242429557471754986 -0.071112409047133368079 0.28661690603786565967 0.55591468353884621045;-0.20243562765605202514 0.16253733570087530724 -0.89013672045583547288 0.033056140428712611767 1.6783790392134487757 0.74049579552536370919 1.1892154595482575807 -1.675141515278337323;-0.41820179556661346565 -0.94915928443907093826 -2.4235584470213691333 -0.016526398877143518712 2.5703942506061365769 0.049721374087533486141 0.17819900305247923789 0.87411316082462753307;0.94431423886736709505 -0.19447073858135149882 -1.2738051951540776408 0.24781007287065176525 -1.5459905672689118195 0.62645710538422572089 -0.59420206972108280397 -1.2869455170197345861;0.3855413911729080878 0.21630166691514163269 0.79961510775546107421 -0.35418399695352620338 0.60159990332012869274 0.86498956981153507506 0.054742876030796500109 -0.39204126880347589523;-0.022224538425395033714 0.0692075908016907132 -0.44601073257956908025 -0.57911398664197299979 -0.52055292340696912579 0.69341601877846659185 -0.014126931102151419825 -1.3695617243028141985;0.48224053589938215003 -0.68131212822131370643 -0.57405537687571084327 -0.1187401878820569523 1.6584218418044036625 -2.9714234816020770324 0.58512730709374138893 -0.49427920630569111005;0.058347741155248246392 -0.40340545658722887223 1.1167777399310279129 -0.018071735060887009205 -1.585084439479388152 1.3287579123468797881 -0.87506464760864854924 2.1987971837232040961];

% Layer 2
b2 = [1.5592258054755467889;1.847416152113269705;-3.2651643373502912127;1.1696298508848255171;-3.1296210187796749125;2.9261709256666819101;0.38638171528889225792;-1.7112807437495933804;-1.0525810102863841777;-1.2528705256959138392;-0.42435057659838376631;1.3124637596738271128;-3.2712204916856602033;-1.5754840706608981282;-2.3855881441477704286];
LW2_1 = [-0.69928724727096114311 -0.24629042182850852116 -0.14086425602047250583 0.45286338936665393451 -0.83114214863595237137 -0.045808912014825960146 -0.22107840834371875194 0.20779683026210482577 0.019084466797250523862 -0.54708553527276282402 -0.26195360830251895878 0.41420823355212410544 1.0713393648597564489 0.70461297695159685883 0.41017634351490517286 -0.079637308495331224356 0.20171657431756181977 0.305526709963801546 0.33119784265796292644 -0.023249630615413137413 -0.065650050024275430349 0.77995192618145803287 -0.74727049337117734673 0.27362254794409851533 -0.16659311838654350391;-0.6545137257529942687 0.28151530015355280545 0.090289590133166841568 -0.22701359541353316462 0.82815866161214690688 -0.31073364254220503522 0.030666679184974818956 -0.49499699009915720804 0.33311897439827542478 -0.71851873343635797031 0.034455222434783119856 -0.063028115531668635341 -0.8061020787823720557 0.11625791195929480182 -0.39760139613786515955 0.064233149354928936736 -0.8915001310295194159 -0.75385582403354234327 -0.57731298158773947105 0.50677383745575299567 -0.88564863442257157899 -0.25502135016514532184 -0.024032404183840394563 -0.19674311598752936003 -0.093778440565535095552;0.20922937286987605687 0.22263280201545490589 -0.30308560105185261557 -0.36464127271112228845 -0.95210984750002458643 0.26284304512815293009 -0.015421993659043828351 0.055116674120175020157 -0.60513027713396050355 -0.63218041378224676397 0.52909257069296589115 -1.1224318407430484701 -1.2500328652648240446 -0.85703219950457321108 -0.038854115211190476398 -0.46254569464904893294 0.57323225644841602211 -0.36317998698711517758 0.43809196242857617598 0.24584185466486918603 -0.23117107417767726596 -0.43084465055891291163 0.33835818088604491249 1.9958616610783170842 0.18474422768327347644;-0.40748915158590010011 -0.15354372983853112333 -0.13423542983343764168 -0.37343049155093149816 -0.73487982080292624243 -1.0303681806964322121 -0.55758556040063400605 0.087516885422489698598 -0.51445637380375419667 -0.96260352162437112788 -0.13606365587467936229 -0.67377494650968994261 0.16634132414991506521 -0.098502133779710676631 0.12742731862501599505 -0.30754899313490435819 -1.023688545766707314 -0.27156306236087962569 -1.1184173269448980381 0.113733912527637121 0.1279254985253555077 -0.19093047181729430606 0.9868103233882795644 0.13128529736574170994 -0.37390348273232226761;-0.89829117306257766362 0.12339339203943998358 -0.57281223894047406109 -0.48320133215308513908 -1.9824324573328184762 -0.10548856032067993604 0.37684764900337652804 0.069391121187476256793 0.82282105972138364081 -1.5831898469286918019 2.7199195512761407123 -0.87540825704378255612 -1.9285760392342496949 -1.8665177872008098525 0.11683502990935588917 -0.34555179934433249977 0.68470781808093361676 -0.75422788266456564088 1.524926688603886582 -0.028160321952835160042 -0.47464029355976405933 0.0089855145476109843372 1.0693141162867996208 0.10020878950817893593 1.2256435334164228479;-0.81371839333884732337 1.0021874907242527275 0.06600215942621072418 0.39154785973445754843 1.0705047416863124887 -1.6883147394879876035 0.014823136445882846915 0.090734659769042463884 -1.1084481138856574489 -0.40469797268659501999 0.11135526450308869117 -1.1114160902426422073 -0.65272809791629049503 1.013066574186718416 -0.5611032523495204094 1.3654711800720926718 2.6179225111688846361 -0.20527837917257041322 1.2681913576003145394 0.72491514187664907176 0.14369585808158980011 -0.46627270250271635188 0.5795998361658092346 0.76218917054930024335 0.82723581101455490039;-0.095719259561343125742 0.31838044779669483209 0.045206167276596723181 -0.31058582679675028615 0.48682997787404042045 -0.069310127445177532879 0.45553210993741549695 -0.0097255599479598147522 0.97580041957871188618 -0.71516431536637148358 -2.0191183000594983277 -0.72690326722966314144 -0.032330359387930954207 0.18042823751346925842 -0.15897480961750531936 -0.14474609078442265964 0.61523871286122000512 0.079059524350196225262 1.0933893829612706394 -0.1454832589383709962 -0.73583419434407770776 0.78218412323426200761 0.25546886127648321674 0.41960429883019279007 1.0544000701616000892;1.0448639312811354163 0.4202605089736536903 0.99148782921739142537 -0.13207381793401232195 0.68126874081305444086 0.81806696174338378036 -0.92676911135954920251 0.21508567537878739429 -0.9678850143997268507 0.89776383594079578465 0.74570553964707153582 -0.19255061724425145964 0.83626215180883134437 -0.23286469019643449285 -0.49653260760402101459 -0.72502811708327019602 0.79820367683292614558 0.090186471880823709801 -0.40194483922344836913 -0.75379155322967661412 0.42234173546275949329 0.086789608468296378097 0.33604511350950766468 -0.02551332256490663683 -0.020624857835256936445;0.58516733754951189006 0.28717396320323296255 0.36562264833099750172 0.48638267090137587978 1.0340268179201246301 0.9166520191685003649 0.67251416889716086889 0.043435707624095230839 0.033542063962011335609 1.1987735420404936892 0.019339673312350494361 0.22291617884840189689 0.2945893070602234598 1.2402377656492680202 -0.076092093484830675143 0.51677413331956922882 1.0152397268138040332 0.46947277513499879875 1.2965310449975453455 0.40696263882215449881 -0.014847580253701973471 -0.15595045931738829581 -1.2122472565569153424 -0.089588713415376997062 0.57624631808280535328;-0.62276333788069027086 -0.36346256387697528645 0.11624597341223462388 0.21721423326664057729 -0.11041042206712593787 -0.33093786847417094865 0.0094460678773482954079 0.11151986429874370665 -0.31242582107267036218 0.20537569184349180329 1.580989928508543807 -1.002406818628375218 -0.98559581503987414575 -1.7688109482313820742 0.051426233840354232396 0.43608224144118107324 0.87523390908833587076 -0.32716725300067400761 0.042882486327570537576 -0.73731326998352253455 -0.23161556466337573923 0.98877908170818562539 0.27952818585681371566 -0.38032444913169977108 0.40494350101565473876;0.24021015144027973998 -0.03586909854435978845 0.033594520522698650966 0.73538286112907713665 0.86699468551026570573 -0.45933205411532268547 1.0685443853940166381 -0.85354389257817109282 1.0545623776165069518 0.80464071808381865125 -0.32061059787771262197 -0.31899441382078214113 -0.33098395802180868852 -1.075875668215527492 -0.1391333984842973992 -0.27829047065669271221 0.6932999765343182963 -0.19564514992692744189 0.87128198212069030149 -0.62830485829283255761 0.033679513047355794098 -1.6678534054381044527 -0.77770441355502206715 -0.20617244919057425845 1.4736983910244372264;-0.47787694450431600357 -0.1725133002977015384 -0.10723545700791567437 0.0030987654904943793405 0.74093054651255529919 0.69137187799920274411 0.25749248376974437358 -0.42226135683651322417 0.28574550876167581492 0.0011810588657010069949 -0.51623486629007020454 0.81633908246504349737 -0.6080418808934006103 -0.076707306358918717071 -0.13160150288725411261 0.076886184485889838558 -0.68484866750175199535 -0.28275256407448223772 -0.04818459764498347897 0.56616181901500306495 -0.43031487701935472456 0.37345184307191303663 -0.49306804546319682458 -0.041196431863612971436 -0.16832093625662131187;-0.13186814466842111671 -0.4142375447639040642 0.66115374811235716468 -0.060519435803483713487 0.73454955382741182746 -0.26311002776885489274 0.18411469998999635544 0.19474985915015644022 -1.1659352145197934281 -0.28973742000078994696 -0.13009738709591534001 -0.7672462011140339655 0.22038925250634400221 0.056798362667884690069 -0.13084437425498840479 -0.94406483410343799978 0.86673107059143683628 -0.20555936854549589077 0.51825311421977560133 -0.13704788520354022063 -0.46277372244157533032 -0.44708276869302188139 0.25993935855923350209 0.19442056724843842508 0.46406896200354874615;-0.75551680531652742889 0.80374783615740719167 -1.5424993619249671717 -0.18126610340073495697 1.1407611423513364102 -0.046271608702485263198 -0.53174314665139543745 0.38523118439207276742 0.56654692800591155422 -0.5969525294239692581 -1.6756316742335162218 0.18988247562335267005 1.0845865523238022998 2.6285326636829977609 0.82860377555669872951 0.18483474341137809405 0.10219467086314522331 0.02992429461785191605 0.29500039409611467089 2.1760759848625403912 -0.81231128006907826755 1.1304436143791036784 0.072137613759809246505 0.048216733797325619926 -0.18962303821814502358;0.9873350998113056276 0.12356805607936650893 0.50486162625392294601 -0.90798069464257036287 0.93989119723886072055 0.72623428952095725464 -1.4443814495575846291 -0.025162824502867983667 -0.73560967356867312805 0.75964790576998708627 0.4354093680616084594 -0.21876038104335501777 0.84362682724290471992 0.46613573720319734228 1.0776091104130776088 -1.0568025352714232046 1.1860630611787179589 -0.32826129129130715567 0.15209587012273928508 0.45276468837603950357 -0.71222834586982985972 0.021200584603913379123 0.47266665489374604103 -0.31464546072188354087 0.29640480982634431761];

% Layer 3
b3 = -1.4557537683347756552;
LW3_2 = [1.1688157654929673956 0.60585009070302675571 -1.5957840425169704801 -1.6469084988084488064 0.57478639501146333579 3.0738846479848400683 -0.8194364882296747421 -0.50898327885077110366 -1.091305950654919199 -0.99093774770490694603 0.41011806728597510752 -1.7938356063596792023 3.3394758391462451286 -0.62792912703711845079 0.36435898285925927276];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
