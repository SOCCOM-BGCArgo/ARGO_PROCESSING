function [Y,Xf,Af] = ESPER_phosphate_11_Other_4(X,~,~)
%ESPER_PHOSPHATE_11_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_11_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.60479527171512637018;-3.4982617296422158226;-0.67494527411855298471;7.7306161616971733608;-1.6900191908893731352;0.53412808617652351995;3.7096235989836161551;-2.7256377962520561553;1.6237660280685421998;2.3880372556842326404;-0.71830485195077198313;-2.3230145440446072769;0.94941654419760268535;-0.91289270155804835838;1.7106291257469365963;-1.1008194750335198453;-0.87633910715266605251;-2.5407179582002314966;0.33233163720574354638;-0.68011280910980653758;-0.75506685923916716519;-0.55878342629659638607;-1.8399476067700755166;-0.81947137648581835911;2.8258713913972708376;-0.69910825652908636929;-2.7593278001356269513;-2.1021760773204536399;-3.2354592649846423136;-6.869551144692806588];
IW1_1 = [-0.16436855504766581526 -0.014774880495257601207 0.89028771698021402781 -0.23484148037851201862 -1.5045759812330388172 -0.94602086279370156685 -0.52431327413557371475;1.7881517308013670231 -0.23230669386027216761 0.34660572739667688813 -0.13882570556126791472 2.7100704078608059966 0.36031116505513027803 -0.7583645176328670523;0.078187475358720601171 -0.19072194577014434103 -0.99842624748365316201 -0.26170398564252439488 1.0550708907342181142 0.25741011996068968726 1.1030369079341610927;-0.45035145406624044195 -0.10449176691715823806 4.936814937487206123 1.9492308496758683489 -2.0632355110374072105 2.2377227722706356516 0.90905061094054029347;0.35918163720918161452 -0.60495413528072705667 0.26502916782271629392 0.53852010216792001174 1.8376364052267857296 -0.81848383741358288201 -1.0599485469237017732;-0.32855464894114511099 0.65585323426767150323 0.29980042886592084272 -0.21034875447000164761 -0.2170653884890688945 -0.28929142992197348638 -0.86982822114831714888;-0.11228489997494599251 0.20898071439430837559 2.6849743620113266651 -3.5031160367877691719 1.798693584795548972 -1.7288172924429161537 5.8845757160174576583;0.80813383811130734546 -0.63435922692355140029 2.0004798825267133822 -1.5789775131032264266 1.975136434516127304 0.19515789657929610845 0.64128805496531182673;0.22770861932804098426 -0.49848377044941627467 1.4971713959707688701 0.99911235550635690839 3.1145928617687688167 -0.30806901452404183983 -0.27420770815901585049;0.040239461407231447154 0.31557764780243063862 -3.7381120926658146786 5.2871665272762378152 -0.93896512859660474781 3.0117330873595542506 -2.009318245601471542;0.8579531124916932594 -1.0527197753141093184 -0.92635476646048175997 0.18377808392194699971 1.9278800981199786246 -0.063992497854951563285 -0.079819147021817776766;0.26464636506379757286 -0.52940131248715160961 1.6518275815160479159 -2.5896578187877263844 4.0405836722614978385 -0.92988375802167577699 0.04122115849114392494;-0.57471026109034639706 0.096146576093675481522 1.1641578782868375885 -0.83536036209415320819 -3.340512227781539778 0.54379072124001515132 0.91545757887412748666;-0.12790097055505755819 0.81744309158601557996 -1.2044257873557779881 0.50636063568143241387 -3.0345108696095564049 -1.246912761901042721 0.084624299826458013185;0.19974998310694008774 -0.28766947366872847036 -2.5452182970959222885 2.3273190092970104104 -2.3187142021267104219 0.49721658747370678366 1.0943911877569598712;0.95796031676228687868 -0.98182851336672849474 -0.023905904507321135144 0.58581043883520167448 -1.4559610982660595724 0.15407904852795151207 2.9255315378995567777;-0.0044837615514591163887 -0.36197619639274342118 -1.0593452432659180573 -0.22895618589479738159 -8.0378028211630141442 0.37646018219262428195 0.78962930008421616801;-0.18687818079683282679 -0.23187256828478106097 -0.41440334945705042946 -1.3841554331379573028 0.55177167377267644088 -0.40199668779308539435 -2.0006845545613289872;-0.4769201589074755776 0.25440886264320228261 3.7335940894797161604 -0.20414023156761285094 -4.3675164237812564849 -0.2860074572062991094 1.4674152354000706833;-1.0004342772188787869 -0.43274932955223288644 -0.30268409756403513722 -3.990142547865815903 1.512546245400007594 -2.5386005418737247474 1.9105225432948327313;-0.27043746393175299714 -0.72241520259465108467 0.87499389360673140992 0.26139569898873771248 -0.25022443951297945741 0.44250317496746849333 -0.15309223814505984462;-1.5338881625429916511 0.87564188984054713849 0.81642130226137332727 0.72076938734807227682 3.5578531260212136189 -0.89012004760267560144 0.011019497524848109044;-0.086193679717286239561 0.19906886211145616294 2.7794221638829332832 -1.6414611578529731961 0.33799789718287226448 0.10328046387528430627 -1.4835040941700505801;-0.43612670664194214121 0.10922429773426135802 -0.55868912923963554018 0.054802204814018824763 0.058679988326681781219 -1.2401524696089958333 0.93754159890487842599;0.95690649770143354491 0.25388262140577694259 2.7502404650998690805 -0.18154263363375627849 -4.5090490726452365777 1.2406944482076041059 1.6668335055575589365;-0.59792886860088090284 0.22864141309629698595 -0.38368863784063872435 -0.065939722580536402896 -0.29343311235275848503 -1.4333745333706549019 0.94899923192188995191;0.0070575391835743152974 -0.064265184430094934864 0.51958515535840987809 -1.0292478503271664803 -0.35098410365121612831 -0.56644260878095187284 -1.1278026854778602228;-0.14806581669724003247 0.33131021958553374951 1.8723986033981527832 0.19405095303555605635 -1.0181297134394293735 0.15802706226139148771 0.28386337739770534094;-0.068483692536599499734 1.3204507446757147715 1.6536398449864673221 -0.63910247641017992049 -1.5856016547311591047 0.00082180967373090684381 0.24489020171034972528;-1.0366171558273087339 0.60204081853692303916 3.1431762876997280109 -0.053594159642715029357 -1.2456718521729843729 1.2370842511197788216 -4.7878661135732629717];

% Layer 2
b2 = [5.5055608336254309165;3.5684182840541636139;-0.20753910918347506787;3.3139940103895537682;-0.7877806820934686316;-1.0257860417326787328;-4.1058327915142207587;0.38421549374899405249;-3.8792850990702509861;4.490881520126884574];
LW2_1 = [-3.7961914336300730533 -2.5211260425313182232 -4.689338627092003442 -2.5089589317694858117 -1.1397284951713155809 -1.2886226363826009944 -0.90634260143490308348 1.5783834983637186067 -1.3907951917457306301 -0.046056703354137848438 -0.28300567479509719515 -0.43866395053554374517 -1.6541265203510955306 -1.232858140873296815 -0.10441223249031765519 -0.46148977432899729312 -0.70461450177583562215 0.46595850061449034518 -0.19671618443329397241 0.34451928100830253587 0.67417663343466038839 -0.12976456151212656387 -1.2091626518697462522 1.4432841647518446226 -0.67476433613923825217 -0.56923610312127570499 -0.12662318007405931608 0.19124629649860092062 1.3163046051108397982 -0.12956034467866470172;-1.0522730242207039009 -0.91730315879226087539 -2.171751514978665476 1.4853545359075339682 4.2310799208115046355 -0.45758528053191166451 -0.12852350246959040603 -0.87702045267255923644 -0.057677523674050504288 0.067402283277422800345 0.48750710229226745795 0.020561485458953865368 1.1557810169277498158 -0.17676033869630253248 -0.83197944012397595515 0.13329359803186116573 -0.31808575156102014692 -0.28367469148688384539 -0.076201618654734848413 0.2444885170925562845 -1.2354821216689464425 -0.37121258980222937574 -0.6840255935004192489 5.6963122859537183018 -0.49863904147079674001 -3.527870807044556134 0.71062487376554173135 1.2579254509008441776 -0.38366572122157849289 0.063856059041042204094;1.6758157632567554085 1.1396082489646552904 1.6297876626043776849 1.1867756932034398965 1.5049740307622989643 0.53682958067242037004 -0.24338827709557417367 -1.1308337251233828713 0.27687265307522390678 -0.14049304474995888414 0.14824636662916176877 0.82325558289583156135 1.368073671763046617 0.63465126856100462227 0.44604315931396570916 0.55680657648222398048 -0.11272486020988528588 -0.68261129782978779978 0.033893475263313238566 -0.087649070398178194341 -0.25426967562832392122 0.33564629767643006097 0.63779423268742019282 2.2493522675049213433 0.5583595625047872435 -2.7228822589883705518 0.95212265713165600278 -0.19349412688605718835 0.34738058707916963375 -0.49945766637404259702;2.0855721055492710825 1.8675787837710595696 1.9441792552504553182 -2.2770511455293922509 0.53268840706999009971 1.3572916286633873728 -0.041599168690556471983 -1.5006114138494317523 0.82944376997868507484 0.23023305148408509946 -0.054019479090375695229 0.053661237818512105835 -0.77879365033447589539 0.69624164250660536268 1.8683074074960686062 0.76476092253215266492 0.40741108354568872363 -1.1585861916851174502 -0.24093413096192359268 0.11117542969741700531 0.068519592780431112788 0.35723208917992971267 2.4312721104901218183 2.8636653773744971119 -0.49108316591656769878 -2.8874218876610902029 -0.15138232954306207745 -0.66886339349779677654 -0.87982833030253793094 0.065670420629076062258;0.12153526398483152637 -0.28162090295348396474 -0.14561697256112984822 1.0207988809414938469 -0.58280507917497181847 -0.21402533599770051653 0.14584393654118124606 0.090383354016806222164 -0.29312794090982791095 -0.045472927723384785892 0.27279124410314736782 0.22984705083910347834 -0.78582313330713782218 0.020847023587072754242 1.659541166519108879 -0.22752071152638550511 -0.22079914844788720019 -0.39752299978402599878 -0.26663098013383079721 0.091882910276587820286 0.19043010671356025432 0.034005589567343542934 1.3875299506337275268 2.2760378573829966875 -0.13587956264005734974 -1.3966960915077379912 2.2564342517114686082 -0.23828467597819891211 -1.3138148800339379818 -1.0411698649555185536;0.57023179376094423887 0.61574788155161264136 1.5693905228787641271 -0.72218133324026645425 0.0593450571901668264 0.68405681490701264469 0.080836965426007018065 0.68348927707793993847 -0.074730370574878898782 -0.29876033290548864585 -0.19083018223607228769 -0.12828988223171206018 -0.36511651659686228388 0.40839824798355001123 1.752107296553361282 0.024165900847493149151 -0.052165265306411863488 -0.18651928218100999324 -0.13432203996236113941 -0.18173013151388814346 1.1902812848529151779 0.45737290392287799357 1.4551286385183268557 -3.346810570586276512 0.22385094960989071478 0.82959980278951195309 0.85810611278167070459 -1.7280786255323279388 -0.20781144224216946403 -0.68675891906997565961;-1.5932861334811103671 -2.1434815880543967026 -0.5749939873192768669 3.2923449633397341429 -0.52077402097231251243 1.2514309621053663069 -0.44442774976398041753 0.23696090600848557228 0.69857852459294822456 -0.041984882903391591846 0.47405653008796105885 0.13546067754027227292 0.90783900499639780257 0.14887578039106200145 -2.0143491088417051493 0.60399529146309793859 -0.37352891969249235604 0.033962715112259039829 -0.56153064359407423023 0.29993291031754476528 0.030409733371425981541 0.11607876508681258532 -1.9805683752660534491 0.74102799442534272867 -0.21018813829940433124 -1.3758694412644107974 0.97134471174777570202 -0.15077880226300477418 1.5163247964702168957 0.059652916727151103493;2.6413339176908690042 -3.9696094865348521274 3.8742931019372672807 0.044682421378488101915 -1.3403101287374892259 5.0646251801976314155 0.087349594949795814069 5.5436441524955331062 1.9165603402516957487 0.74933490941501701421 1.0828976884717587126 -0.52395314117433178236 -0.45431950937256299072 0.97655948274084536376 -1.2393482553800840851 2.5178182686549899216 0.31541370115138650521 -1.1293440326412937935 -0.080686818895324155521 -0.011277494966146999963 1.2329044773231154775 0.69964537577741614527 -1.0751948298880820154 0.96458199737664340745 -0.62046752610776090275 -2.0852767100477374029 -0.5820103238872794682 -2.1815708824016892819 0.66199598750235266742 0.37850884570441928334;-1.1880833277053859387 -0.060169479510216651585 -0.23177059940686559059 0.65803300349674387348 0.43292982463824192241 1.0285139264494000955 -0.22045874025847267408 -0.086090301517159170674 0.49019866057367250667 0.0092269678441387718848 -0.0068485984859621299239 -0.46188348318690231054 0.54642033129553668758 0.30140490844720646546 -0.25542574721917860048 0.37394324830173936158 0.31571632573196600768 -0.20517415633954635967 -0.27763136935872173572 0.083704511419056604193 0.45382105296642910597 0.22272962535471199641 0.047505010524174287601 -2.7075900867268956063 -0.2189908268871669228 0.35601043892988187833 -0.54861335378336106849 -0.89714642185546644715 0.0081833427063955771485 0.22917962685111095689;2.4890695265626097132 0.31015514507283564738 6.6663438519369586643 -0.59356188944456789169 0.50316274343109579359 2.6768749232234863022 1.7301449808175799472 -0.069947217253555557526 1.2544342610902876611 0.66439084778637880202 -0.44832241562756419695 0.29109582094776198513 0.10089315959335613815 0.80582489068009144351 2.4675955195321659374 0.68484351249844443998 0.34060047834695966751 1.8825548498877373582 1.4511805776837327642 -1.4455021550170619182 -0.87941379504768024677 -0.34741244219787487113 1.1157280075562849841 -5.0459665718807205081 0.14506982431383005916 3.3400157358373077088 -3.213523630190542324 7.2189010460700426819 -2.2207162056765770153 -1.2959654773486561918];

% Layer 3
b3 = -0.57915569153897905608;
LW3_2 = [0.61497896872239077304 -0.77968173733783818768 0.83103687106423851372 -0.58381040011576257331 0.70409947802963490648 -0.99120427769798258311 -0.52787128653238735154 0.54682549210811159934 1.2043767780930272338 1.0599080894124466301];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
