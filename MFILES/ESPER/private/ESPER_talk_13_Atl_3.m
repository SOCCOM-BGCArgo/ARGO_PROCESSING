function [Y,Xf,Af] = ESPER_talk_13_Atl_3(X,~,~)
%ESPER_TALK_13_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_13_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7788273426219607;2.4389285397546283;2.2491487033432613;3.2906011090425618;-0.78736695440602156;-0.16159888817523832;-1.6472111382883781;1.8252014965058687;4.117129771224791;0.78128708566043503;-1.7237323814903445;-2.8919423509470277;1.3486173024386097;-3.1300759137805336;-0.70606059356682738;-2.4648642870175754;0.047711512522657665;1.3700572077007858;-2.4119457039635313;-1.1052624265552802;2.0571380169735298;-1.1607581669393412;-0.11860161980155076;-2.464025926359767;-3.9775526578862679];
IW1_1 = [-0.89084040144703946 0.71921288649294091 -1.0337310960359893 0.070403304409860035 -0.19422473460798526 0.13310604141086088 0.026831793083408832;0.42220217926648479 -0.82790924796565557 2.4771709829220003 0.12443615783538724 -3.597998886529246 -0.0035409610423467264 -0.35629872869170137;-0.82733077766839525 2.1367269702104648 -0.21805380897224336 -0.26010666830169737 3.1120849264974986 0.0096049527552465423 0.14949350866863798;0.066593396165065266 -0.65231669092877831 -1.8337874318352545 -0.13904819133852656 -2.3243124918014164 -0.37057993142754841 -0.35831901521554599;1.0266240822764006 -3.0460495586556267 -0.51656157519734536 -0.20482491887645762 1.1395826155257676 0.0080400069453545452 0.6142092783774673;0.71689788067789351 -2.6503378624132399 0.7758755750916404 -0.42653745789511394 -1.3031126565920441 0.16089699397209292 -1.0504687316963228;0.81112162207126615 0.98547093468517122 0.85572755440397341 -0.6173548822694287 2.1487579560003351 -0.17801528956102386 0.27427348872792151;-1.1685476411700897 1.3276129963154297 1.8942086743000868 0.1296168940448667 -2.0433797272192629 0.049490474490167288 0.030763640318621988;-1.9658353580803991 -0.32971828142206594 -3.8023222330321471 0.04213946424887776 -0.69555316898480124 0.11199078318441889 -0.23753062506145803;-1.3944917344922356 -1.0475749610095302 -0.98556298542097132 0.68596130535237065 -0.3657669277897202 0.31261833553635326 -0.43118323724956992;-0.058062505884824089 0.51604626395977315 0.55840755709861978 -0.20924433122147126 3.998007640499706 0.28433780289134436 0.61747955126061327;-0.49869656516950139 2.8136816314828725 4.0657239689999738 0.15265540350546844 -0.056936071351919512 -0.16762919484184999 0.22333577803546145;0.75787492062843953 0.72834049774348919 -0.055830144210794859 -0.52654044126586619 -1.4192638027990867 -0.31658413719248246 -0.024803560172083211;0.034622383611005114 -1.5405898440204886 0.79267249714388399 0.41916813080446591 4.0796542122164849 0.69053408774925473 0.26873574501484354;1.894273009208105 -1.1523133191458417 0.13167035530839041 0.13610086785269265 -3.2435888959145251 0.11231275574070806 -0.15672710628567574;-1.5830135667617491 0.0077098011023331147 0.7569008519060062 -0.43538551173858203 1.5192382735980572 0.1579945113044135 0.239410992576118;1.2426521487204001 -1.8155517236200369 0.51328245101235903 -0.11427604025348391 -0.33049537898051584 0.42714040682849153 0.52001035908342186;-0.30978560033203228 2.3479366416114518 -1.1226267297897095 0.021544183242152903 -0.21068213470559918 -0.22021546386735449 -0.2736543463793894;-0.69695009281025133 -2.2345259353217601 0.60950532169609284 0.18419929794012352 2.3876672239616834 0.15717133195067476 1.0480900011040095;1.0331946054017385 -1.5180371376492152 -2.482733824842787 -0.024119684557641324 1.0350558094528817 -0.059068875492616468 0.025953313494029635;0.01829116884802072 1.7022484190961555 1.4843516682815681 0.71053449388821976 2.7192758854500929 1.5192219793894839 1.412043872550572;-1.8124610824206808 -0.28423882274151291 -0.82979288332910817 0.70819629485996827 1.2888185855941698 0.36848986572606945 0.29120319866217337;1.2392301523863642 0.90379505722081832 -0.3498900427998583 0.62320490893384217 1.1707017734724914 -0.11040283654842636 -0.58218715649528607;-1.0262567015244903 0.10978712721419168 1.3506627013170709 -0.32151203141562423 -0.2036915648709631 -1.6268804030366155 -0.2318883476714855;-0.6863879455224392 1.1876774073578429 5.4519280219082402 0.36479129292714524 0.17116599480471162 -0.0047844202224761444 -0.24816107809759463];

% Layer 2
b2 = [-2.1271095013537002;-5.8939205618945216;-1.3322356179213848;1.5308481630188435;4.5531465922612497;0.61885866413374369;5.8069173068385957;2.2121718202111444;-0.10236455363674092;-2.3413948898109043;4.5311209636558383;-2.1026099851635656;13.766928500200681;-1.7700007382538032;-3.416228200024312];
LW2_1 = [0.813444075708319 1.7404653020600804 -0.29229820583801963 0.14140652568937226 1.2359498306626711 -1.3628116683460043 -0.42422172857665152 2.1768270772495857 0.53992069647483454 1.4984718697446384 -0.12290592468111299 1.480062389253159 2.0744086258684775 0.60100783241724531 -0.48767910067251036 0.57823125006349119 -1.3039766019814372 -1.2201313141635624 1.5338395570620882 2.6188551663823851 -1.0224451186848238 0.15983523445831233 -1.5936778844835164 -0.4393374839529034 2.7298125007173746;2.7653536543082575 1.9284758580897645 1.2139179697784763 -1.0725483500628492 -3.2498637980530996 0.75697497054197227 0.92240331914264584 -0.42659375502579866 0.48895879084574667 -0.51282128640878011 -1.0222796697183805 0.2729395388724451 -0.1070084930892298 -1.1332344899807159 1.2797479965001313 -1.9717239808372762 0.27131575151793624 0.55019923315666364 1.499581240558113 -0.3774583082878728 0.8124334573066988 -0.80201922998864983 0.91467249955128538 0.25650542427267264 -4.0928844413031422;-3.147249731762968 -0.52369761643657964 -0.36924508596405886 1.0680718800632389 -1.2061004143093548 -0.54007724806095858 -2.8168854997769328 0.10420887866677025 1.0770656802850964 -1.5031830509984987 0.41652731160299028 1.3113399612074934 -1.2235989167434282 -0.21599331420815771 -2.7672810352753094 1.8456407158686883 1.574288717143379 -0.64460659430007194 -1.0100234523785248 0.40396775251162037 -0.62376166723230497 -1.9297906111399148 0.0002943617107620377 -1.025006654209986 -1.0295540253541002;-0.35334407668900014 0.35943641420090339 -4.4962651025997582 -1.3492991670544667 -0.31339527563132963 0.25725591060063163 1.9436370967207803 -0.90906491499690489 0.98143968459848674 2.7183560474327373 -0.10447384445640795 -0.29699682726971061 3.3008057737628063 1.2215442941165349 -2.0220323884109233 -0.098663453896325692 -0.33669786156331893 0.13515020170132325 -0.18098959989427876 -2.0679152329080099 0.69528809779694412 1.9031575468047583 1.4110289013445105 0.084772533427274449 -0.048303371585264383;1.9436997677711372 2.9793833767901172 6.3435439323605864 0.75236265791285106 -0.65437859480959359 -3.8671744402405732 -0.72330465598896232 0.88273029586354523 1.211727909757198 -0.34753588029029742 -2.5591523506098306 3.0539073763614106 3.4167198019021958 1.9704243958929117 -0.82524952771194338 -3.0123335510464684 -8.4073381095350967 -1.0610964174094999 0.37261268779965018 2.1840318095001057 2.5197265750814188 4.7258957383415092 3.2519733170981118 0.063415301096708884 0.56789830849753831;1.2830098816114788 -0.76547605120759132 0.50907166877237919 -0.83074663265906001 0.39307997296676805 -0.48750027123942458 -1.4458121924964999 -1.6062545742206458 -2.558946240142193 -1.5846742677193373 2.1124238059256042 1.574324591905808 -1.7755450458774189 -1.0242180535618046 0.89991564881195973 0.92147331413444555 3.6170485725696286 -1.2343708673806364 -1.4356922848932636 0.55647299084405211 -1.339865242850923 -0.51102321612873847 -2.1109777355602493 0.80827551654555918 1.0908914747928111;0.72952212784658876 -1.1605851306507331 -0.40002812567049212 -1.7809707793349117 -2.1557181743033285 0.67630164936329895 -0.22974759973770986 -2.3956980469088505 0.95696375700701064 -4.5980087093844819 -2.7887163498293872 -1.314921559358303 -3.4650785492580845 1.0933663767940291 -1.6712098663781998 2.7526682467865129 2.2092012117774318 2.1956164769319684 0.24235129754565274 -0.58838331457118953 0.61605757534044303 -0.9873207792171147 0.98062558574338321 0.90291880741522179 -0.16932580102271844;-3.414280717776931 0.52995961382109436 0.78798827863566168 0.48873646178799307 -3.2124026776760428 2.6749092552593678 0.8825965891075781 -4.4454991994144741 1.1443025869609094 2.2471883005817768 2.1952911044852184 -0.72042266101706642 -0.47585608506208427 2.0587159690416743 -2.9608562827758509 4.2042970614935129 -4.1932216953159465 0.93160252297659152 -1.8226715859418456 3.0312517368781715 -4.3882585008943265 0.50921844914700787 0.45470370006190675 -3.0572817604228031 0.33603484946951656;3.069190345058741 0.75183678173814739 -0.11874679062132693 -0.063974025947026225 0.033101357682477996 0.52874307795749098 1.9313741786720953 -1.86156360775578 -0.7942621926860296 0.80304129439298066 -0.32141372458590839 -1.8884915586863547 0.59917014666629409 -0.036726376368068157 1.9083256421593495 -1.6380912787548192 -1.3451019146003398 1.6114129938131274 1.405578312102737 -2.4571435341096608 0.6119479377820265 1.5287643888518065 -0.081286141805725298 0.35518154224930504 0.60095954491879511;-0.4593617346902712 -0.92674449441758056 0.68285520300706881 -0.52553508050818698 0.99162053690296426 0.74512026260262998 -0.72315356304654932 -2.783686103300373 -2.7234163411464083 -0.81508552694057068 3.4022882522587334 2.8395112431766827 -2.4203707807828141 -0.49364110381399395 0.4436165025332332 0.72872809715344522 -1.0810629310638178 4.0989117262890238 2.0339839992995934 -1.3387640726884842 -0.48567933766435395 -0.86803949161967386 -0.88736700892517295 -1.238918419203392 -3.5854538522877846;-2.1074499627272458 -0.80758324897923128 -0.22657775839326272 0.26515644284572087 0.54699194558219277 -0.56890253966447046 2.0763862718426798 3.8006348084110182 0.57661694562795318 1.9516501432738678 0.14693896306606444 -0.41530217029425076 0.52754334586266471 -0.12544333000684896 0.29145364887470576 1.0981589423982989 -2.4189492275967224 -0.74338154733149975 -0.48938046780990263 4.0520842676430711 0.1237322295102716 1.1193504220874109 -0.079686913228979153 -0.39343083816482177 -0.1375257610121137;1.75528752204793 0.47905908357521898 -1.5927147305789799 -0.20233545534040151 -0.24957037804533902 0.50743791694182461 -1.6587077431705028 -2.6838883283133734 -0.62344170823558442 -1.6026407534363372 -0.28535872085941566 0.61707897673427159 -0.51362818925636677 0.31136026440304071 -0.54393266380492677 -0.78454125621265047 1.9311488801072791 0.38994714609524034 0.15984951939028672 -2.9353540220206598 -0.11457974749861546 -1.2593454354021405 0.031381798182818332 0.34573146380671588 0.0064640655063359712;-2.0448486570239819 -1.218205519244806 3.656461461317063 8.5600173517264366 10.522310591659631 -1.5138651934909277 3.0728788860778691 4.7690445490258213 -0.3551100780659171 3.1468088671382577 0.22914564688752465 13.830177074920032 0.67335729798110755 -0.088717790144211273 3.6265031325489612 -4.3536766168792385 -0.92440548229053432 -2.6794272469230349 -1.7068172772555872 2.6964007168791375 -0.67336623534787055 2.3166952997115251 -0.87590154173378065 -0.67430304230309879 16.000245972458632;-1.7075170548091962 -0.46166780084988535 -0.28247059138590519 1.7939256616036483 -2.041629193705965 1.5096200406185036 0.78697499966326467 -0.73496349191033206 1.1385461888720265 -0.45529582685308551 -1.0073188058272822 -2.6111929267713667 1.3518186446436609 -2.9815240925322581 -4.446528747345992 3.2974296452436738 -6.3079880499088548 -1.8927715061887673 1.7016267993341361 0.48431231217873399 3.3473312379905313 -0.33031365714223038 -0.58683437948058315 -3.4604100109488476 3.7094978247511285;3.4403337922399646 0.87054710577418992 2.0898226485847995 -2.8967488452112415 -2.3959585629293434 -1.4682066617762086 -0.8975215286842102 0.14264684422153007 0.073029876186341006 -0.94722606652027719 1.0402365816359607 -3.5545982152748894 -3.0126751188050145 -0.53435070479161828 0.016331352032778537 -0.80170663129054553 3.8160358384269313 -0.87618191656826594 -0.59838149312559541 -0.69643880178533613 -3.0354145627803968 1.3686299661675794 2.563273457802751 1.0551543971170165 -3.2343267724424631];

% Layer 3
b3 = 0.56985499932701744;
LW3_2 = [-0.10845247477915733 -0.072651834322159325 -0.20438689163873408 0.099238763138451994 -0.021487385280499635 -0.13358831431306478 -0.11303160082034595 0.01009062301752163 -0.29805770031969214 0.071010980574660987 -1.288338975127957 -1.3836113404195001 -0.15890544846903787 0.0111112261824504 0.016873641634797456];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
