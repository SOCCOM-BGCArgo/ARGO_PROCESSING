function [Y,Xf,Af] = ESPER_phosphate_6_Other_3(X,~,~)
%ESPER_PHOSPHATE_6_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_6_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3019988469451084789;2.2969007839355248812;0.61098115474187708607;-0.34865961831781894231;-2.1080023169963775231;-1.3054783754129135609;-0.1428641419838024007;1.0358595394316449934;0.15012818936729016572;0.81435166511436452019;-1.8635966658215330494;0.6519979439597349824;-1.7366326710646451392;0.25457811170160138392;0.18346914368445949028;0.2728327327949905956;1.519696591301626265;3.2218140487249358195;0.84536150612591209885;-0.96314385738190300135;3.6864126620384758404;-2.5064167996424373541;2.3209435451049400534;2.3759091382238008983;-1.6004454159050651718];
IW1_1 = [-0.75503221055652236515 -1.4410777169958011168 -0.052960268550809222465 -0.32213236501663339295 0.47681325590595524666 -0.21242932084387514124 0.44957273766619365585;-1.4392041256426557627 -1.7257760855218193807 3.1105704694249909359 -0.042830151605388826208 -1.1262377263749281386 0.57517356985961753946 1.0906786298923798473;1.6348022347779380681 0.99317884588130800338 4.7696819969784964854 0.16693327403403754317 0.3447141750807971583 -3.3850731542492162873 -1.7693431147925990921;0.23177506010121007307 -0.2809295093514524444 -1.5809693266125519617 0.057813481219821660773 -0.98778679092121879357 -0.037012337018129379262 1.1432921223098786445;-1.0201601756727680659 0.11422361792449919893 -0.77975985617087839596 0.21034227994286974761 4.1809018877153709681 -1.1978673098035641509 0.92430216181353042071;0.83390523372957314763 -0.15146682647966788759 -0.91724112389484802055 -0.081375518283116649032 1.6230522458374394557 -1.6228765165164560358 -0.39505733388191738298;0.82161617008301479625 -0.59473371700802191153 0.46161382454308103052 -0.14388470483231358132 1.4912798458878018248 -1.2331725955045387266 0.31568804262107241776;-0.92734289093367427981 0.45280925041481195903 0.83881458620399262927 0.040093184773623433137 -2.910396074040090042 1.5525182993354211813 0.4915177627214682432;0.48604560282819730954 -0.18973396809462908519 1.5893917915819100184 -0.67112885680969613933 2.1107391123849050807 0.85606703662278904599 1.733658567245074833;-0.16955710024457731899 0.093750988764317019775 0.12225321591839893864 0.15434326804384562726 1.0862524302138627519 -1.3387409508329284336 1.0625460301577949185;1.223668012266834193 4.1264879996201120349 0.22177161058495997725 0.99640255306103409083 -3.4993818820952347082 0.86335142033046485821 0.6778125161675712107;-0.2559171079077449118 0.24182648098828360417 0.071594660926812020429 -0.31739630457227452354 -4.0669929505504516243 0.27698829441537425877 -0.18838884607128006388;-0.040026262178298514793 -1.1020398807992297652 -2.7879501427420887438 -0.15084298972532828031 2.8360646328772487479 -4.9730146820828746712 -0.042106158539045999978;0.36458079742806426271 -0.96225468303701378048 0.30883432736861177181 0.13276026865756149209 2.1129320372489890367 0.28895581076527415698 0.77099629268762170931;0.082509453791212730711 0.089500516486872752631 -0.56005511550709963231 -0.022921668902914662386 1.6379720170152112235 0.072004507307319637333 -1.5138779970921159013;0.14451697314233333258 -0.57451030137320946434 0.56121081927880767104 -0.30498406063703081825 -1.8967871917123126924 0.64313372834074122864 -0.385999945388995791;0.44815881474247826199 -0.22786363915884910725 -2.9085293304819579419 0.089067515694668988879 -1.2106421898334467357 0.61133212904471390114 0.79637217811126415068;0.77328013574127352214 -0.64070189956928824682 1.1873426422117712153 -0.23643272913179991246 5.0968053042334684477 1.6401703714006563573 0.15484188446282312612;2.0664419725570035702 1.1215379652156038937 1.6461836521870087946 -0.57198240030986347016 0.16984344628967765201 -3.0646856824126222918 -1.89744941557613922;-0.93926335094795410097 -0.57053214146197905876 -1.8683019101036153486 0.05886879721530235976 2.9481723433741944262 0.041570553123859599332 0.3888551649958676415;-0.2700924052618648985 0.24687774553935848409 -0.97895557524599130517 -0.38448338528086845045 -1.3587479993333817507 3.7739171433802982669 -0.76124787343022159991;0.31134409406439345069 -0.3012348000895598843 -0.34451262136946037007 0.05563888810528033052 -0.11796925491649974671 0.78070596300281691615 -2.4783917291846431219;3.4488027118652961889 0.97026866679501555524 0.19890707473727534116 -0.31539028759745008079 1.3757865589565949627 -3.1355206528136689847 -2.0997965778937199843;0.93206021947392980742 0.25550920770415491701 -0.6929156098314492862 0.070791404701074950312 -0.18743799335884894774 0.90942861972990862718 -0.39634170164560633687;-1.3298290241572641168 0.43609767760542350601 0.81744467017627542305 0.086286660893295077934 -1.6673069304223362419 0.72088618537129556252 1.1612924402449391614];

% Layer 2
b2 = [-0.2499060864053566644;5.8568609450615305434;-0.093694356657868210769;6.6557509835451833524;-0.064356967635073841771;3.0403012753863056794;0.47055063347274767027;-0.77095708708128485309;-5.2709750821672720633;-4.5039336214516820789;-1.8532447433565586437;-3.4311319407580516128;-1.1351669354236793019;4.8141489883637964553;0.66707572122518288271];
LW2_1 = [1.4410249273717463669 0.6187927366810745955 0.14798762118897709761 -0.17063803173573180438 0.37375228907913599086 -0.041615327210971914118 0.86870092058975012517 -0.30991589824601650793 0.0191751437556733767 -0.68723076542286865021 0.059821644618103825275 -0.54907667321625119872 0.50002629960441247192 0.334732497989688349 0.50850594446620023259 -1.1970334577767363093 -0.31226770692006811103 -0.18837685171746065826 -0.074629033572502570526 -0.94289288009132043999 0.34152656136566750256 0.30114070379413437895 -0.4593419909478982377 0.60333915597819887111 0.65868440927812121899;0.15550916994736155297 -0.76711556227789035045 0.63255541947127402747 1.3367512254454243514 -0.10863346283883607013 -0.24976732419409583552 -2.1347866098382946021 -2.4026305170075503703 -0.56732596303863114251 0.53620965656896013574 0.36217133541223656135 1.7592890209357063824 -0.14533496081852850801 0.44715996259832319071 -0.19885688063679721194 -0.40488257817078227019 -1.3208716104469120367 -2.2754879434062793564 -0.7508881141036962692 0.39267082401965275329 -0.53615991060905365817 0.44160864422389395356 0.46135223663524937976 0.23384176077284044015 -0.64595276965237080624;0.029989300730170906362 0.035084652353128846503 0.038750955585475969911 0.76121538604243166315 0.050949925047297360547 0.92654093353396405064 -0.083658580431547294176 0.74501700870601861304 -0.036417058897847881527 0.32997371583728229982 -0.24936092234761850217 -0.20097142420834770982 -0.48007602110167696408 -0.45713461508077563034 0.13528905049154668627 0.33944962912336656968 0.082489438926122510276 0.095555175068704256702 0.17003667679946993241 0.1082949673187754841 -1.2637674832074314857 -0.030561577782263017744 0.14614477481281717974 0.92104646848273274973 0.19567594973509175316;-1.5712193369982250246 -1.5198508147614251396 -1.2783586737698224844 0.76006704444600503567 -0.3190123243062056857 0.59018881387675636851 -0.66662129242937961937 -1.4698137210387849372 -0.66653586518019725116 0.1739523437193340738 -0.31546329773143311215 0.64897238710634153058 -0.62065546427380269279 -0.66416129941285562133 -0.36417137314766723222 -0.50276303776935149514 -0.15570787945226499671 1.7671632693788916768 0.79775691990765984496 1.6193927070688229897 0.12956876472993000826 0.70210130383289570677 0.65176188173441795826 -3.4969138792785825487 -1.2543833539611954908;-0.06341834528722678499 0.23427295080255094994 0.074126673454403407826 -0.34654540549182544229 -0.96166174122973013816 0.75237259095874153836 0.823310004770488435 1.0343785784323427102 -0.038539977545698302086 0.064798339318078546079 -0.040013556940464919953 0.83769433174832952371 0.1710129689493295746 -0.17019114480433483738 0.35095219453316373048 -0.7935765975820455731 0.014184216844005620092 -1.0162927644731059029 -0.68071796377335536121 0.318520283451197872 -0.63719801087376382043 1.1826923923335928013 0.45226582906008355733 1.3646146971123913616 1.1001267342409262184;3.1821241123258148242 0.25185172411364159517 -0.50929776959071459963 1.5553188961982864491 0.14006735387352506339 6.9920691646112809181 -0.0097780136475156750886 5.4496910760616170677 -0.6121283969713461337 -1.0516919481598288044 -0.021334301281786146459 -4.0772929029892264197 -1.4007752389496630485 -3.3214913557142127232 -1.1991105597861482224 3.1270649845554765456 0.68814086965594767342 2.1540884710613457109 -0.076854376443010685716 0.031033989388914842711 -0.55923657394372672247 -0.095638665084954277429 0.58447191682296939508 -3.6774657073330390133 -0.95923825880157898016;-2.1977260777089253629 -0.92163787488310344731 -0.41414313353210424618 -0.88689875086255343106 -0.092522310599382179275 -0.90862308885662212976 -0.76556538098437343365 0.61274989346768027332 -0.14649533991215943352 0.3218701003269184846 0.35015497405345386017 1.1480218069074674681 -0.00089334803918876895534 0.25662050387591039957 -0.75650018920461437055 0.13516417066507166456 0.27426981411784040477 0.87178990186168503485 -0.00021027340564813961493 1.0890832415161646463 -0.31374972487266872267 0.25414301356168350621 0.44911977044009282478 0.22204530855639215137 -0.6264026319198863213;1.9314420477801161891 0.34057385198541950677 0.12089064319434281169 -0.68657566388051849415 0.046642718945565826705 1.7387814724151555712 -0.79993906148348969953 0.73230144233072969051 0.14927484622073200482 -0.3474879404910752867 0.29624353455523838585 -0.0050971339045774478882 0.17440992475992933564 0.74523603908335600554 -0.41458388834620235608 -0.2805960886205776661 -0.17766582233921443534 -0.063938824191092216709 -0.59166697675084567454 -0.40646575081581404199 1.0462946514505455653 0.037648403662090726418 0.027071886998593232276 -1.0269992951108544155 -0.28052435112576951104;-1.3218761438381883 -0.16090362321426732173 -0.18293567018464529372 0.85951088682723075785 -0.93081021297877386544 0.70147152421785063936 -0.57499178715533127981 0.65032024708278068914 -0.95294475832507175017 -0.065063366366643934913 -0.33398537323871579918 0.33933878374443032788 -0.3835835994552974082 0.42594349098775280416 0.53740295983182440054 -0.27872600670586322735 -0.47850988425460039277 0.0035696927579040920939 -0.094942554257188838118 0.1856716409352192898 2.5777669755035179655 -0.3946391145526251254 0.20334717558987588926 0.66470301911842177844 -0.42064573515835168571;1.810514559968249948 1.1843261254520065506 -0.10705192725256476582 -0.66180334374196569946 1.0510928208751988411 0.92009274383582873025 -1.9864414370461689341 -1.0774746578142537778 -0.41649810425312017159 -1.1716980075825376151 0.41768789559701946512 -0.76923114357259170237 -0.14174242885169582862 0.82728128553854851646 -1.2637619946143889837 0.37080214666089850173 0.49414314698448158492 -0.30252453729353290246 -0.58874475267766390729 -0.044763489857857718945 1.3491860218779401226 -1.3757821574045645541 0.95586186744654266789 -0.9506465071789826915 -1.2893673258140436744;0.77902507590510705615 0.50579652532382668451 0.021943659718607722714 0.10788082658645462009 -0.11270644068564827922 0.77332511492850963819 -0.56489657665903492134 -0.23169538205111189777 0.36913933703575818601 -0.090895880063091821777 0.041481466619633193538 -0.22659970468707910096 0.16228328601657884822 0.48705467994610385229 0.48156708233824102594 -0.36666330698845961411 -0.2450276802502875384 -0.41363030775043568843 0.19636392608265312854 -0.68758278815098172743 0.63655997326782598478 0.22474965757843226588 -0.044485771142745655915 1.293212041723990291 0.67725994096004826783;-1.6162646717187960643 0.51459509480504006529 0.21823386764950206129 -1.4768571298533779146 0.19058064938503715968 -6.3845629085029109717 -0.30288149058247754164 -4.9937152743706434421 0.75339798456695439288 4.8153872866097282568 0.16135733594066381524 3.8451048111555938824 0.97632784957791529656 2.359697492276765729 0.78775254721065957053 -2.5332160274955315415 -0.22641182914035301588 -1.3567000172428320681 -0.0033224236584122150695 0.17068390868890437329 -0.075491589977662920674 4.8684323687506303457 -0.42412737221762064621 2.3510032314530011632 0.46066927830046328074;1.6842306158096940205 0.18060213440831821008 0.17781492183305599997 0.39887089204325099079 0.64989604450581317518 1.7624863954432823387 -0.50968051415113058145 1.0694182262714437837 -0.18708816276891615527 0.11739616635739340278 -0.093578529060091272807 -0.76529492810831500904 -0.49626131483492097463 -0.39086361665339180993 -0.14532004621390950949 0.54120275930624150984 -0.12678326227560265949 0.59536568212255436272 0.080059427418883222227 -0.23187478486699891755 -1.0256055743813339287 -0.094440500481168240809 -0.12382409708493946621 0.66473063710918400826 -0.38481886248938940165;-1.6766494194499625969 -0.13570157927342302306 0.66740647731143987187 0.50871326610323319706 -0.54236015297417905501 -0.76083482286467019051 -1.1144394033500737429 -1.2820523590555008564 -0.80000722701374427093 1.1780088122201537448 0.076399410792542185589 1.7808537972160505269 0.10834993741007292734 0.61569217821475252794 0.73344485411330528901 -0.52924191349732485623 -0.74337150851521605066 -1.3839219270116733806 -0.73808420068234670275 0.15445018443556168819 -0.25747219766986900735 0.87276998096346303235 0.24067951032481219031 0.53878692642587955319 -0.32850803893353908158;-1.217244976779808141 -1.1696941198731043432 0.036356305281612197322 -1.3950656570835131554 -0.96016318590857330229 -2.0825501296546056196 -2.5268728025966069595 -0.7783018770874688963 -0.1302302395789992906 1.3991808341552107731 0.074189584109795286837 1.1426721213777184527 0.10430921899866504865 -0.16653532892352668204 -2.1045976183696826212 0.66268116541315402745 -0.0027924097114692819632 1.3853596037918778361 0.71753851234191357022 1.7959341838781710532 -1.2142912908833798369 -0.0018380452781129943962 0.09687202692075694288 -1.3203834096126401132 -1.0619325662393472864];

% Layer 3
b3 = 1.1164039509105445624;
LW3_2 = [0.50814186474902034441 0.82094549245454440101 1.8638823217265898524 -0.239864760175681202 -0.46101775151845575396 -0.77636400591342158428 0.33463839786228688489 1.0228842163120679398 -0.53165042539062046245 -0.3623661622498439705 -0.79954552074589679833 -0.8726261799150786258 -1.1645071640327517848 -3.2609999848609483308 -0.21987039821488910118];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
