function [Y,Xf,Af] = ESPER_TA_11_Atl_2(X,~,~)
%ESPER_TA_11_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-36.755394894482506629;2.4603221829666210851;-1.9049180385455628528;-1.0400767914114414925;-14.379628799412749629;1.0101715394313919294;-0.52872478466734940117;-4.8441302740845948449;0.30791622567388576837;-5.2874680240084499516;0.428600863175084279;2.1935404129185114286;-3.2994871784608390541;3.2600949899234952234;-1.5088962133805143839;1.4955864598678862976;-0.91830010120455474176;-9.0851093631262838102;0.25115750801286867988;-4.2973692013285695879];
IW1_1 = [-0.72317028287289075728 -3.7526487457481030319 -4.4452147779686965734 -2.9197862758644199666 68.954832323270323968 1.0270201176768638529 1.6728544769386062274;-0.16880369296129021928 0.84797357553573537992 -0.29773060405302187448 -0.13373740650663767937 -3.1274482188158869711 -0.014468663864132740721 0.085330258917233892113;0.48911358157656026346 0.48019406804692599255 0.82563368125473957093 -0.01878744789344748492 1.9951905565844589852 0.65117914225864237387 0.029613106863232110944;-0.077023495261133001488 0.14988289330463211435 0.12646414395218333326 0.14778269975328053865 2.0650899283607579981 0.34621050254661100976 -0.088416621400706774114;0.26736765984468308099 1.8012804801953374856 -2.4927998656753307394 2.0460156806391096573 16.433456704717627872 2.9838128339211884565 -0.72252081361116282654;2.1157743116114509085 0.0089742293636838020576 1.5128593717887293124 0.31428264293565671972 -4.7631054068243106059 3.3258107637789802169 -0.73904432704434297463;-0.37035475160456959864 -0.32090542310399711168 -0.96565265254561605257 0.14502258718294991358 1.3566581977536900094 -0.67286093384428546926 -0.071639889751563254339;-1.6486413306400289347 1.4401698215569802564 -1.6620874752775720573 0.55024941635948465546 12.42272498299596073 -0.16926901237212818585 0.11507520330692705413;0.08133170140401162207 0.17214019820719303477 -0.118906072391398554 -0.12790486764604069858 -0.2523832551289003634 -0.053112290507097731362 0.17261601388786129707;-0.74531453030999450515 -0.24958310278327397458 1.0991713219239584998 0.35461850269784178646 10.165297365905457738 1.6367986103472644821 -0.79271918075700398276;0.23719182951259046299 -1.0308838578837584699 0.88493884076932649574 -0.31780549441642086395 1.6206737275100031592 0.86210799061345566585 -0.084456800953081223593;-0.61692927661583785159 1.3868180604854420945 1.0016460063807890446 -0.2863721308951197031 -0.12525960384311099483 -0.17444165161480232329 0.47432659501836954563;-0.65737371837930591578 0.34682772156424385157 -0.68357756921128765004 0.4205446017843005313 4.0755434686532208133 0.86942445374733867691 -0.94177707748920624908;0.46073252866258923577 1.4244750029700987692 -0.52895277766348791637 -0.29291790018572960719 -3.3666397082972516763 -0.74692266482333258271 0.43397093842986472767;-0.3030838894333577338 0.55090653391630572955 0.26435882945601774097 0.17989452134321293197 2.3126883962715818477 0.23047791290904232064 -0.14540700222128435937;-0.61588507713966733625 0.55093008563416034917 0.32871803591340886808 -0.075944521120043864681 -0.2493417834368570063 -0.065712456307717867499 0.50200589365360293037;-10.558567842711077844 0.64940814554455583707 -4.9003929704104631782 0.8088785158671166764 -1.471162559739813247 -1.5557000649713228491 -0.55455257942640190372;-3.2404857311911343665 -1.1847826801909997485 1.1524182973902197258 0.51938542616364558047 6.1123222220136863569 0.36139760656457609045 -0.65883381038722910183;0.15140302345507375414 -0.17159082624270022288 0.12642861402913535551 0.10662125938796725155 0.360027914709200203 -0.073315825222439845454 -0.13452454798217985954;0.24922099758821439353 1.310530818004969289 2.5545230741045594769 -0.41418875373179475652 2.667962497529197563 -0.36635883051561313195 0.36187002473049412199];

% Layer 2
b2 = [-2.213872288224412177;-7.2970962278860564965;19.275917770779869898;-16.325519640522305309;-12.077460043060041173;10.089502256389888402;-0.94583592563362606231;-4.2437073898653006054;-4.5532889090849915092;-7.3580856735419954973;-41.135904077934448253;52.182192484266892052;0.85435816435027245319;54.399533270489541792;9.0422095206318875427;2.5722226782625665642;-5.3943907838303264413;24.656439077093065038;-33.106074768429152755;48.469607164247612729];
LW2_1 = [3.6989660663118630879 0.20713670862928004746 -0.91072445061993922977 -3.0886086458317647541 -2.0351546252746586241 0.26662711507453140669 -0.38262930879563766817 0.70861312819267718854 0.61700593193148711713 -1.1175237806200417623 -1.313045724433971273 0.71723445136296926083 3.3367737830497925522 -1.0131654691810152435 -3.3604539723488797698 3.3792436837562886964 5.1641919359400434431 -2.9550120412382021584 2.7948320759078804087 1.5256196520598408473;10.959836214114087483 -6.3084317163812633211 -0.63073318205528594582 -9.5869348042200233095 44.212461012100902735 1.0291263515120663286 -7.3165623305293863154 20.566937511722009901 -12.131202220583697127 18.903332698743589901 -7.0549403721885139973 2.1016150332882546081 -7.0076327758229206566 2.954516703734399119 3.3385805256442897537 -7.6829735627402122589 -18.847686138469999406 5.4065989444313586887 1.1648260931187672806 -3.8005458070652573532;1.7826321651072920549 3.2798638462715263842 -3.5842207874886011787 -21.432669887880251736 9.1613930212502303618 -1.0462648225239259414 0.17239269779684002204 -2.3422091406672973513 -21.199091574214794065 4.0223091995797304321 -5.6241869848573857738 2.1570253695380965375 -2.2921304365031351935 -0.91312471291793273487 9.3606382572926047914 -11.235806184773267091 0.94908848194765704775 5.58075566156947378 -7.8694918606904478153 1.7802796699892577958;-0.036263096250126053421 0.018632133431867446693 -1.2087921172816780135 -3.3842631131123321886 0.23617817486792394566 -0.014612071906251845183 -1.1114334427311758358 0.63555284503639597471 12.047097716463841977 0.064280220017537720301 3.3210498037359399426 -1.4532158836503159538 0.49755049904043957554 -1.4409407749259903753 4.6403509438856271885 2.1915507865779200181 -0.039068023684527372619 -5.7616704537307885658 11.660225817979213758 -2.0323450298132819114;-10.414278968129524472 1.8301237315592131516 0.28044523017714795277 7.6980212569497314945 0.44480102473834315369 1.4954511102936860478 -2.69791956176055292 0.98290475566486357195 1.0391055099297965558 -2.2721824619639647835 4.7125688648053563057 0.12489639182237415038 -0.16697357311473570718 -1.1960210332452669846 21.126631063860124016 0.65146269046286819915 1.8194845826304444358 -1.7895899841638953642 25.961639125995134236 -25.425787203396197356;-2.9858303930787659652 5.6388102181853003714 -5.6404406119719068258 4.8723302349242310072 5.5578088716618454512 1.1351313016497655006 -3.5005434622144147028 0.49319875499416271358 -6.7862467502476002679 -0.42603023272456769233 -0.091380294608531281719 -1.1548330432218700814 0.48629590550841850227 -1.3376454071089105557 -0.60632886495821203265 -2.2158019624464468933 -0.70630014569807542113 1.5390178130897982367 5.911951217406121728 2.4914098594916320728;-0.19098890039178195721 -3.4378686930032458235 6.9632377853764371167 -9.8756883672682658215 0.30893696120707347941 -0.754533615797642776 1.8388947251293290552 0.75751304965486121468 0.30746041450937222628 0.14453935054778821456 3.3350468562490265256 0.20404152457118884811 -2.338675080559738273 -0.37448615342653129856 1.5977740850706101394 0.84856673292667350594 1.3121278031201284442 -0.4297971487467893148 -6.5252729371707056671 -0.12328338018615830896;2.7113845073306745981 -9.2908385750840878359 -1.1825796886870516555 -11.588109257618160797 -7.4391366821739088877 3.6566648984991534377 -0.18239022124299072991 7.7444190848790572801 -7.5641457948464942973 -0.55797709271114637186 -4.1566077843172797301 0.83417220107395595452 3.0531070689964754372 7.4290525381264593818 -3.6755195403670422039 2.5663832164730231433 -0.92462937096441599749 4.1511540819184764572 -4.2927713916615655165 0.020995452807682439544;34.816475431499846138 -11.111070398870541709 3.7245608315989682247 34.874735654876161561 11.584779681433520437 1.1993150925096738302 8.2280699261656629062 5.7503705554652002618 8.0476050790976305649 -12.674629351180042747 19.431649570088080026 2.7309003626229042538 -5.5851053240794170662 1.0318328152671945031 -10.554578321782004835 16.437736193867767298 9.2932474383581453736 20.631382137735094773 32.246399517970282034 13.622615938796830193;32.472629870942931518 -5.0530021419030672902 -11.253348936255992641 43.313685577055380804 13.95486740560729011 0.72052926008175477435 -13.784038281519471525 32.757058455040862555 -16.176369595739476637 22.292307862687934517 -14.732248060103104947 -19.126859778311366966 -7.4798242973785526999 -48.923773368123889327 15.282416687506104935 -23.932779774382787252 -33.252486185973033628 24.805948614096941185 -3.0009496732499250093 -2.8214528684754478505;2.55247643078765174 23.71553219378853683 11.000414470686536106 7.4796129511468976148 -55.545529189821259308 26.737193607400257633 65.858647155561328645 -45.016106582860246021 25.575364952820908826 1.809505010805816605 -21.844076125926175536 13.426861225710853276 11.324201504193254664 -2.0511701205905765732 47.161531412009985331 10.408478713832277407 22.364466800873628927 -24.894719208054990389 6.9948881583163577957 -17.212873684498724458;6.5859297916627399516 38.273512759775186964 73.559672598072424421 55.699296763578580283 54.284955094054495817 -7.4642060649447223852 92.193241006865889631 -36.138902880621415648 14.651291514291177265 -2.2725516202885187589 -4.2736973679052674413 36.644635221201056652 -14.034720390204999063 -25.819601806442971537 -18.887774135309776113 -4.384943194990595039 -30.030385480675697352 -34.83536068617539172 -47.215285516066579419 31.518744284320341364;0.16708681980982775794 -2.2733555154777125296 -5.1609845540094427818 10.912565942269752739 -0.80213602888403923163 2.1440529836901256466 -3.811758998739929627 0.053095206785170948049 7.6854204450816441252 -5.3588282378454410448 -1.3366023381460885311 -2.1443638348403237792 -2.0286757319721568926 2.1766186104228086862 -0.79602522705635792022 -0.70911797008382015939 -0.0260579886536195654 -1.1104720179483813514 4.9052385533906823767 -1.6334831202634820801;-56.910364851808722619 -4.0810312162952033788 -2.5509161833355804561 -9.4419954575266942243 0.74701094859780903246 1.9215351056773180005 -6.2403767717947395965 1.5119948293582516907 4.7425995890159944324 -2.9253695332939946283 3.3005101921043338287 -1.8018827842215798807 0.54831980656788725792 0.19243302915260029895 4.6917325057229124496 -1.6559993851008607546 5.3811312704937881435 -5.5050466747607309514 -4.4215472544169855951 -1.6687103351559158249;19.862823036660628873 17.127524070151356028 -42.529799899364341798 87.777052858621019027 29.618266808424557723 37.873793033293168264 19.419987060627590836 -2.7733593978308159755 20.828089220489893307 17.725505142678866122 19.495409124264252654 -4.3754570591257557766 4.1145646092834082808 -11.894955836549447881 22.928243911130454791 55.542358411945713215 15.700925710230968946 -18.790405724455705894 2.7546502950399740506 -13.217951635210400951;0.24748763384394822928 7.6348885265395809441 -3.643700005442638723 -5.4291388237330453492 9.1399821194708934513 -0.41523244271047299314 -6.6214196352982259697 3.3349892845198807478 -9.204085443495445773 1.2153956553890830072 2.5653041704018546554 -1.2402847211328473787 -5.3303863895344081314 1.2521175518496348023 -1.0362438433255640735 -5.567102111333297465 -2.7040608763397120384 1.6323887627022926061 -7.4292435793360747098 0.66782985422232199468;-5.3175396328384003652 -9.7796961841497296319 -0.10681935133652045722 -38.570081116216826445 -6.473627523887384605 1.140079666125080049 -7.9370804603805371613 4.8066884782065288917 -5.5477287822545795493 1.5932092571618434729 -10.818687069307065585 1.4217445494179961063 -2.1445173414426448311 5.6082630960645971641 6.7428073143542954782 -17.787856280421841859 3.5001778541582191373 -5.1085500843933253634 -21.709746763817431514 -13.951657237064839734;-39.948851885088757285 9.1527252379622279221 -2.5237295086021580559 -5.4016848439828084594 -8.586672010683779277 -2.8329674198033236721 -7.8098126560706271349 0.80539514865038175362 -13.065589829877398031 1.3714492010817085355 1.1149541983902748754 0.71181386793578105276 -0.80286699361327173996 -0.44156310760570732787 6.3659381805714199132 -8.3606838385639470346 -6.4281155704325749767 1.5946734708616052689 4.9182859622866157423 -4.2368835730857954402;3.3317017497315148944 23.833169060548197393 6.7750586501020855223 19.087683911657222779 -25.916271999193412512 -2.6468936173421169222 -1.4578256599770178514 -0.54771698789421929821 -20.104883175078018809 -5.7411599607280496826 12.14506746942297255 3.6086980057955480028 -7.2495655619199625974 -3.5371612168902593076 -1.7495597850775692628 -17.291282575915872144 0.77602249729680772283 2.0859546025536390701 26.329159208696459871 5.2618220221970304351;-3.1582957914862577198 7.3656649087377195073 24.482644105490585673 24.100152167776851542 10.925824728850468404 -1.4496882412111495864 12.579230493456799778 -5.8573075092820587884 -6.9146178013636179216 3.8412645558531837153 -10.274367725628300363 3.4690843972084652869 -5.1959389517113940826 2.9091209343316384306 -11.556988699766083784 -20.771317350495738907 2.1430480780764744608 -6.0535145184886252068 -10.477454492180859447 -8.5390765956793721614];

% Layer 3
b3 = 0.042991068574291468884;
LW3_2 = [-0.027899189297593770392 0.0020579242389715838787 -0.27377385750209709547 0.17524608422684673226 0.0034120023171468807227 -0.0036130374211184859354 0.55066240939969501866 -0.0070999336725230495146 0.011684695668798374471 0.00088411111917185872082 -0.0028094331638880963055 -0.00027020864505433852881 -0.038752459754535679981 -0.0096371407515513478337 0.028577244830974651846 -0.02535796165546317163 -0.053542203420363476685 -0.0072787839275662161512 0.00096307551079840647903 0.67728749417516798115];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
