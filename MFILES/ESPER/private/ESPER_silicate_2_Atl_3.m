function [Y,Xf,Af] = ESPER_silicate_2_Atl_3(X,~,~)
%ESPER_SILICATE_2_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:38.
% 
% [Y] = ESPER_silicate_2_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3914854294962639703;-3.3753956285475958943;2.9917049143420473278;4.1368905559653645909;-1.7441854428541871957;-1.2639214724561558256;-1.3311771144735049521;1.5790044496838664401;0.48341634998980054228;-0.39504852730121786664;2.4431411902533861635;-0.25579815429902802437;-5.3116610584767327552;-0.53212143919604304454;-1.7013775530901691369;1.8498864796529370658;-2.0750060429159655762;4.0237518273159178506;-0.21011990416177778185;0.57678088492980017499;1.1394758335784151981;1.7141701200085475154;0.9775045978069275554;-4.2809359869002738819;0.23902204509942315269];
IW1_1 = [-0.37066599479436490583 0.62390319039360775388 -1.4803629959930020288 0.52730591518339442469 1.5249019358021467241 1.5188310207824073927 2.0161073592791174391 1.8706416033124313447;0.69414444242988249112 0.68954679679174379903 -2.2673290033428901147 0.039413405954357584593 0.31770107642889378052 0.15452796189017148354 0.74152484029671683619 0.10686010037908404147;0.85082500946334804759 -0.52248570988368070456 2.1229252747253490874 1.4773116417508536102 -3.0417971788200683925 -1.0526818096077565912 -0.64489689053730836488 1.1215573133730494249;-0.065029602336178174427 0.45204981811648942136 0.6243933715599195855 -0.74798471009880784788 -4.8643125622540104303 -0.19316770092981014328 -0.71574911645459993181 -0.37945365720132073761;0.078959729102513226406 0.2423314496289467046 1.2539159688678622739 0.29849461757567197218 1.4133544238408981553 0.18190110075309870452 -0.075737207995460562038 -0.066138798547055163701;1.2615486059357283732 0.5029496770013082152 0.012591148397681998367 0.47290284122302095327 -0.16203886071392226143 -0.28932331209041500797 0.78434620425667422872 0.67943394388659783534;-0.50566632129751176716 0.0016690096432411323946 -0.36830143080273275435 0.45352733171048476013 -0.90433155540170384601 -1.7228312632911590985 1.0370059076210698112 0.18386647688297838577;0.61238246160601206292 -0.12090103798023334181 1.4765678589798951759 0.23287359985415134744 4.493253866841389943 2.6155484254291248014 -1.9895658123355381974 -1.0808929511180953575;-1.0717721334091097063 0.18100559831741716565 -2.7009357606324155832 -0.81737742292968895708 -1.8485727185262319505 -1.3664074281950369105 2.1334830449661046359 -0.56383670509050665132;0.3890840889299136407 0.44685328672774710101 -0.94892956592659483128 0.10184291003128168041 0.16910814801303764021 -0.30017536639922132169 0.95854520805152776397 0.51233623881186718396;-0.1973071576770598079 -0.15643805896062532024 1.4267879254810349465 2.0166364530749731898 -1.3281537984731452973 0.2356418610077027076 0.58200039472045117517 1.2178667813122041608;1.253254577258968272 -0.26505635924598724973 0.92492042594053414106 -0.99031162534801964181 -0.6655710971102408724 -0.095867131994022164454 0.3855710755104702625 0.44914110549868113687;0.066097094237063669375 0.34950855332135283282 -0.10039976140876692712 0.87295944018788595997 6.9956550498818099726 -2.0778246737639238795 0.39251231037688827374 0.059210361930733750035;-1.0305794194391024732 -1.6752726808388442858 -0.13893002170177018439 -0.476034077799521671 -2.8379299149565890836 -0.36831199118011542781 -0.78772348794692581553 -0.72886761878857564412;-0.081355226563779234339 0.21118653166658910014 0.089048934396981249684 0.58896799226350160517 1.2650979748561441696 -2.0264750844762913218 0.065644636684002152793 0.093843208583495235642;0.083450459598983089959 0.89502672835891916581 0.31666666510160246251 0.37103063289204379904 0.18430122306525062448 -0.0012904868967536448424 -0.10073776801456629792 -0.34987427178905139424;-0.70563175774277631103 0.29615920793844802139 -2.7281054409227323276 -2.195443758276091728 -2.1699492613833726296 -1.5560427455616903103 0.42627934606995387945 -0.75277648831649546235;2.0288122977071458841 0.94786863161129830679 -3.4340866917163324068 0.96774054876275505954 1.3881863091609831784 2.3623541061461024171 -5.1917445399898767278 3.7087592629171903802;1.1625956728604547319 0.19272231753343960214 0.52077600150410696678 -0.085926703415122998586 -1.6647795658548598663 1.2407652604164987054 -0.37721702737175144549 0.61360485961866240157;-0.7697817938513864533 0.35528477503582522878 -0.10435762548249265247 -0.13784343353986233671 -3.9054660938495127098 -2.8510940763184722258 -0.59862147476883265096 -0.92314821297404381362;0.60048707487695129892 -1.7999266913434424087 0.33682727365625719784 0.44464945283522577801 -0.75266384825506160716 -1.7823260049895306434 -0.63158419880788518874 -0.58614239582354654701;-0.26561993618507862003 2.0119915743736527247 1.828400966629738944 -1.8029952769715154037 -1.6145748006311151368 -0.68424177713737588391 -2.2591281249140182652 2.9546088561324483912;-0.40912520521391548822 0.32931464135674631821 -0.4931986157909606372 -0.16074132126567300394 0.48747523249649643562 -0.23099028772906854412 0.50305955967845805699 0.43481053557497417739;-1.5011497573556915608 0.36093819045938330126 -0.57427744097299548987 -1.3670474177467248911 -1.1527627279118504156 -1.9534042612669417771 0.10641052647124882302 -0.42689920115721385896;-0.39951143063121941079 0.57294352082282429262 0.70949834550032264691 -1.1895084992896387543 2.587053580560706223 0.844317778191941537 -0.40270503563370135813 -0.14315504374635035223];

% Layer 2
b2 = [-2.0297969994041191732;-2.4249555375196316653;2.5356112161642307967;1.425948264311219349;0.46375304217953045027;0.17120655631532749608;0.74937926993739589765;-1.2097344344630218682;0.92980401701005299664;-1.3022485145773985415;-0.8517958146312261114;-1.6794658235238355548;0.41722329714247213817;1.9041871050992806857;-0.065446278320131862083];
LW2_1 = [-0.38979375262668097823 0.92427500996914746523 0.35128059564813179927 2.8215873430056372939 -1.816589439603984335 0.24166419496484495277 2.0387739689520958386 0.44796967842947610361 -0.319206673848655198 -0.60474888802013249123 0.37244116258874071512 0.067671623941863476293 2.1229320721812956485 -0.82329799636763234538 -1.421879236174097505 -3.7763032626689088112 0.73977604200067825779 3.1039581983245985164 1.0691003751510712583 0.081822677549348243886 0.29919403444749248511 -0.15811375909658845207 1.3884707520277552728 0.78228202511750233317 -1.3316624638790932611;-1.360839960984277841 1.4816254528420600423 0.31764041881899268693 0.99677454169311963117 -1.6622801679852139412 -1.2695969934274522473 0.73615190641645966707 -0.10644641291332801458 0.68692945233440305675 -1.1997954636924610394 0.096149301022180388987 -0.12339549220467005419 0.60008028175991434683 -0.28473907529670777761 0.67198310580412523585 -2.2491788725741663768 0.077250414344560508484 -0.42170312968478240734 -0.24174846491199536436 0.66485512217509845634 -0.29610265355212173066 0.0024523633597935026555 -0.34423150397560886571 0.90752935931884037846 0.4569960736731437656;0.19566680197468575009 -2.9160778993040494811 -0.57542645930259583853 -0.65596774060350770963 1.6815232272625668664 -0.72411801735456482465 -0.18293675204423232028 -0.58909177365361897749 -0.011237224135447858309 1.2302629569174898805 -0.25344643208095124498 -0.32992886197963550154 -0.62877114131216493842 0.23448790031001959244 -0.73592675906663818086 -0.12367282350117406176 -0.76878047923423975529 -0.31125635181930366713 0.15668345174328829339 0.55409636200045819798 -0.049615981653572602261 -0.041909432156816375792 1.0631775899209643388 -0.64557931643892518814 -1.830082456324086948;0.44202239318671715518 -0.50171241635306285112 -0.50893438834098525536 -4.1352516548606468305 1.6767276287436847504 1.4207817153216550921 0.24448864926490906924 0.13392160796277671753 -0.55089929800663284265 0.67304621281225640583 -0.42121865724542789655 -0.62287000124970604009 -1.691341786067197539 -0.73400241684415012955 -2.6476998256123835951 1.4446731068907490148 -0.91600609386574260995 0.0034010520274719213338 -1.9544460673753025759 2.6749654893637164754 1.3631896373307221815 0.20165338125473503128 -3.455541608805968945 -2.8818853132702701991 2.1319808139661269308;-0.37803606864366490203 0.11155455708405875859 -0.17814769341941860681 0.41446885186012716318 -0.95480999052020965046 0.082241048248603301762 -3.3125523745078524485 -0.23548272977405765305 0.41610747166055994661 -0.44035342720574860431 -0.1110100905755507239 0.095322698612573503185 0.40410480575890761479 0.13055398179237848177 0.62501547786514088934 -0.44509758307733116034 -0.27727716848481342993 -0.3654133195929359923 0.11008958397493845416 -0.11580811920646803814 -0.82766260879920561244 -0.0053103266108972396742 -0.42731563976778919045 1.4975271740576612256 -0.71511751165786541229;1.8349412348568270303 -0.55041536804264123983 -0.78698905464168822377 -1.6939087436717972235 -1.4327320220717567612 1.8495308922736504176 -3.5195466262488239728 -0.22298616229040987835 -1.4035334078002448255 1.0364577927786211564 0.036849894203517835622 -0.3958096793984337558 -0.21998366448333056544 -0.17430149155578186781 -0.41964585543360705122 -0.69417512796699032407 0.83619488279317499835 0.30133278709751309954 1.7900608608862700333 -0.45092457016717035767 0.45644569594054373862 0.6292032553961145469 -0.11519571816743057191 -0.48255649988693860575 1.3331532976718685202;1.3045904366676213115 -0.59652736829891905845 -0.33447257794008289356 -0.49846714812296621933 1.7550277365020909848 -0.74451413860380266652 0.12442969613889892644 3.1330191376628091504 -0.86465477538657409262 2.3468311833725450377 -0.26478965634032919363 -0.15465626454781059018 -0.66424897380926739565 0.24749620801936689229 -0.89641229683537793083 0.13474089578346346019 0.070812523593762471963 0.2479572404516180717 -0.0021389257455471481773 0.63594462744243129837 0.54641109663655107465 -0.0089750954492086865155 0.39129304896582656204 -1.0206215728113638974 -1.6271357205320089445;-0.33781738591339527389 2.4152198628121857027 2.5270779030355008388 1.471346596234713644 1.5409982281082670319 -0.84731996681041432673 0.093501660318891080537 -0.031875698217531348022 0.42468810269271983771 1.3141432879716048454 0.94451677817897505829 -0.10902529859420395653 -1.0019003549032041711 1.3270954798407073039 1.3623563827304103757 1.1877605218187086145 2.5762048010639801987 0.38399637916485829248 2.3922721366686818811 -0.93898391220325638784 0.56676903022401292631 -0.61054215944531975424 0.81794215191070729354 -1.114339298077542395 -0.5216470522845279012;1.5762830062640138529 -1.4035680285356710861 -0.13063875839387220634 -0.67777922982704630339 2.3891959143743366489 -0.81596740265782286006 -0.49455611972981461388 -0.41108747080158358767 -0.070387939725661957668 -0.46912030714741576043 0.050406995680811472749 0.036332799414367782098 -0.28157652254723508634 -0.62383590991403581327 -0.64092806466999630022 -0.83133879094183527059 -1.0437801724558530836 0.49529817078252652562 -2.2354835706475331136 0.20791373534671303558 0.93160587377622527949 -0.78774412207918942386 -1.0098978049131475121 0.6470175752806033298 1.4902148312648404449;0.55640048352703475043 3.1473455307382613988 -1.0720913142002803653 1.109030533081510006 -4.018854284845662761 -0.89928065654261746253 -1.5601990892584787218 0.18439244612528130074 -0.30303095163200238771 -0.92168891069951908168 1.209052116003765498 1.3147998578241011369 1.7059637879891389467 0.88562959858749457087 0.54527427148219809183 -1.7352464445064512688 0.16520509917858630655 1.22410265514705352 0.053426304545467886986 -1.5370859321573657752 -2.1849240007086248028 -0.3076669262747969702 -0.42897107136691547957 0.67329764379426404464 -1.6231902906961341859;-0.39808866315591090457 0.044448077626397533568 -0.68321515401307963966 0.78973602620487715065 -0.8829562813663700549 0.38663239653309328103 -0.65163120264304408291 -0.19580649523560494929 0.065908352445722573343 -0.6138292223815337012 0.59740752431218391294 -0.022803197873807155849 -0.22368055385827823045 -0.18081454310478992098 0.40463636993942864173 -1.3094568656102691939 -0.24259919091518905576 -0.24674517957641423083 0.23312662758202581936 0.1610889825937885933 -0.59770528029551073246 0.15499952610769429651 0.20224554222306206919 0.68500878116767516257 0.2401855878250983567;-0.022661629730564226276 0.45522170555715452123 -0.64675689530628466262 1.5521026307237761888 -2.507490673776867407 -1.3128542783133250182 -0.64573682286154276966 -0.72272897371492761387 0.087749716042661379811 -0.36818103654269107583 0.65754689593801018965 0.88186592491226478696 0.082711009693498593887 0.34763746613020501952 2.9033149063880334673 -0.50570872875356842613 0.33555872131992559027 0.36000451564691554607 1.0462201065810878831 -1.1620706821982218493 -0.43614001556791998082 -0.25730146519553376283 0.90409648250382323997 2.0171076407030281707 -0.91781462000441216276;-0.60697983363494312226 0.070552665464953409624 -0.21340886599321154393 0.29046422631779234003 -1.753941951184855963 -0.086125957624800575374 -2.8141133485873317532 0.27351173646376331083 0.42195810232546338003 -0.19637395732787812919 0.065336214931397726402 0.12392140441057630795 0.70891352356015568947 0.13642257697686407947 0.88656078301723806323 -0.053642235893463521834 -0.19704949847437167043 -0.61625638652289782549 0.047059592379092893277 -0.46917491837406444244 -1.2913716958218630637 0.10127718255425877114 -0.90729357984852965213 0.29132796376363362389 -1.3589544048464552439;0.32515053979876051837 -2.0970175142397899926 -0.19779652774908110247 -0.97502135598373007586 -0.57055330298885909013 -2.7433140616756706009 -0.41734817592174744405 -0.16901900442775763533 1.4433684176844745473 -0.11919512996658530868 0.49032148175599488127 0.048949781879120440875 1.2628028473686481181 0.17333368218657771442 0.30914470610597089006 0.031059980947889288816 -0.67593111380842796354 -2.2755483223531194348 0.54598048704951118726 0.1593199806668593177 0.093784746997758988707 -0.14252285097569020178 -0.039796522212918176986 -0.064042199920885028996 0.83208298863500729237;0.17625771407559676085 -1.2118292453147276877 0.34347738549138323583 0.89325157629440454787 1.27841668716995982 0.63328165969727234774 0.64395179636479338292 0.42405835750154224906 0.75792596910644094432 -0.60632763362266950402 -0.69672076621929079909 0.31689170517088743884 -1.0953938929631923394 0.28006790238483253441 0.78206518325455220975 0.27467925634957829351 -0.43972687726901088512 0.34756299219623532082 -0.59229336977953739307 0.39538147612374013873 -0.034133278925741077081 -0.25050144322969342126 0.19780193273150056821 1.083729428190533195 -1.2793394166434075565];

% Layer 3
b3 = 0.32157932119783583236;
LW3_2 = [3.6503947866315975546 -2.0293140057728260572 2.6251370984238069362 -2.5209311241112661861 -0.51233341141876154179 0.091788271404481189264 -1.9497228496510523588 -2.697667907130695486 -3.0389090705061394537 1.2392762606964711214 0.68978108039319774303 -3.3939947540036405904 0.2859778294539065957 1.0582554668608776804 0.21545982205637689844];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
