function [Y,Xf,Af] = ESPER_tco2_4_Other_3(X,~,~)
%ESPER_TCO2_4_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_4_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.5982914922113682;1.5257086066841792;2.05435095815402;-1.0942261014850776;-0.86357156496910481;-1.7741851077968132;2.0838389917853215;-1.9821912766271355;0.53751920252979901;0.22230537394648334;0.94155776011292025;-1.8840492008615695;-1.8309860567366665;0.69847694784388514;-2.0164849086975383;-0.56904028437708876;-1.7659839742304302;1.3937469481241653;2.1302302743328321;-0.23734833382300785;-2.3085593298173781;0.37488068652490036;1.559866030108316;2.9277219311027434;-2.5150240973598312];
IW1_1 = [1.0908088492892614 -0.16917002315507249 0.98871710830043924 3.8836304723992838 -0.64665889032980484 -0.92259532078420381 -1.9129953941540345;-1.0879345186260962 1.7705712905353239 -1.2518451456196154 0.53018267376382477 -0.53956271028177605 -3.2988645242181724 -1.4928346345705348;-1.7617286407640382 -1.3605280044690673 2.2454259805507535 0.9125175091318517 -0.37928434116771254 -0.74168305916319666 0.050067730623728393;0.78429300505772515 -0.42901528838493552 0.17793973745190145 -1.2889104199414119 0.57523877904876997 -0.50039305243638799 0.50512210190422968;-0.28397346977443694 -1.5723651494012998 -1.1897334337641718 0.1448908681140339 -1.4437421271583151 0.90260237689997469 0.7541671277959846;0.51760681893113369 0.003967126061479349 -0.57014504573107805 -1.2664249703114965 -1.8578521969938042 -0.60409380590155326 1.3329670940446194;-0.22236003325963941 -0.0081727844049792175 -0.34661404161564136 0.7910109169299071 0.25154465995901143 -0.45817765299474267 0.806649963161441;0.57356028118414559 -0.33431898842535956 -1.4193868749088323 0.84467423337946046 -2.723919679794685 -1.469049653009322 1.5069753389063265;1.0415181131791114 -0.30764073459676688 1.5004918808542222 0.30320286110464506 -0.75603069225095998 -0.17985916363171628 0.937853897250847;-0.284578530449483 0.30577652972841174 -0.81840332611879918 0.78070187415808079 0.11796638481416134 0.6534561460201993 -1.1077193610338445;0.10977290551141999 -0.044008675260966176 1.0628547394346974 0.2256121938537636 1.3427272354772015 1.1736218311316353 2.195542931969567;0.46935205917862455 -0.7953147920657283 1.4680111679341705 -0.47226874506183281 2.2162968498819966 -1.7729816793555446 0.44084848540726013;-1.2828953877900504 0.41475223597799082 0.28408926454667882 -1.1011518903468187 1.9701159683366882 -2.7842462065093998 -2.5794750805220397;0.34308552134904124 1.2168463670435354 1.0869481460592241 -0.080922954861699786 -0.14191962400577129 -1.1339702732279304 -0.57801310027506858;-0.48961340035710904 -0.30288773295979571 0.70677077378713105 -0.80603545619529626 -1.0572748135780357 -2.0567829029333944 0.1222717536925661;0.5039474856312367 -0.0041795263132818929 0.083768087347178291 0.71967382901440624 -1.7542379447796717 -1.4119017766089987 -2.0238045859594598;-0.33866307337917279 0.049634466503912164 0.5213796386850218 -1.0701700039089985 1.2767230342177838 -0.19315321049335515 -0.23622101110787164;0.2996103904913171 -1.2067509294261412 -1.79740409093722 0.45064623577604002 0.70175535759468755 0.44114506844263207 1.1692128912811302;0.54723712703218619 0.99669412198327734 2.1298860969638338 -0.078570306159624459 0.33662078274284812 -1.0749156891425575 1.0065860112265008;0.29039461970349079 -0.098903896937535735 0.18062233788456628 -0.73239212326519354 1.4853945676820852 0.15758015090059058 -0.87708729809320074;-1.4944572453098599 0.49619125640628386 4.3238323869439235 -3.9240264610795079 -0.39532594295278556 -3.5941322972255563 0.32633441839706873;0.27013673621937234 -0.54062059111221905 2.6515236953150221 -0.81999959871456751 -1.2650147623485839 1.224089636112599 0.15363120105822997;-0.35834127749682465 -0.19136439345222583 0.27252145793282473 0.81432461916607424 -1.7710318223229005 0.66451430126348765 0.073483512732534104;-0.16271001704799906 0.055657985256102417 0.24343471695621144 -0.33253539867665471 -4.3953707142779583 2.0785310606103686 -0.75627746921883232;0.23791245371861433 1.8527546976720579 -0.45164736055204152 -0.070355255490572671 2.7386375533851206 -0.83677528653828936 -0.84883442585082913];

% Layer 2
b2 = [1.8889035191813206;-5.502584430116813;-5.3866284396894928;-2.3432501491807822;3.6624521800286596;-1.3931898963359748;-1.1973912911217623;-0.20277018998696167;3.0151383955909741;4.8946783350600267;-4.8203450929871368;-3.2373173554348771;1.1046908168551612;4.1289155811062557;-0.4235510840787608];
LW2_1 = [0.45369713453698068 0.14258545164278721 0.26401397489324469 -0.058134260508682332 -0.81961159013783391 0.27176878237855778 -0.33297804744282394 1.1019703070001201 0.36480639201219156 0.22658237815621154 0.14025039199151354 -0.024744923537932558 0.15274552309015887 -0.65931712152214794 -0.012166290097485145 -0.39201554513455494 -0.22891949303202222 -0.09728516948783579 -0.20860422688605917 0.23172323316272533 -0.074507442922931155 -0.23699755638120654 -0.66397311562031225 -0.10730327661707151 0.023130433079160979;-0.44270365083634339 -0.89970206792989815 -0.15276279999569314 -0.57226421543056694 3.0546468000911906 -0.65875401579775184 4.089087158035885 -1.7305761606878973 -0.7238445904315608 -3.1418029519636641 0.14865411353778821 -1.1495853782124914 -0.52013267541645525 2.0063429286894139 -2.8039430320205332 0.68937507106347584 3.0747378028691372 1.6636366164385579 1.6788378962049739 -0.79678078535967367 0.15636234185942821 1.2535899131880008 0.67179933342783527 2.057315444099141 -0.20896310436938054;-0.57202969100948453 1.374661542595133 0.58711332092990165 2.1324481824271904 -2.2245940194511951 1.0134674963053796 2.6792657265932585 -1.0466099171530112 -0.43347033540252161 2.7859895227835398 -0.31035560309672255 -0.049589744988974047 -0.95947151631208527 -2.2238259413346819 0.55224093171899558 -0.42659849350525048 -1.1280014983148017 -0.86039930823518873 -0.80981271645704389 -0.81860470486711245 0.74680977585914887 1.6925809369746916 0.38444838578921564 2.2126352846551507 0.55826437095163572;-1.3105587448657352 -4.5000187344168054 0.99577281003317353 -3.3747226414541558 3.4247512586966242 7.0496312105766847 5.0841874954283037 -3.2186759529310152 -3.0137033393898376 -1.8111933051155125 -4.6899223877519933 -0.34607856261578807 -4.4033993951904655 3.7488490535301118 -2.3572653154406535 11.336710240663331 13.594623032458943 4.1994178553107027 -0.86681027076101391 4.7170877683995629 1.1228439616572221 -2.3259340828572426 7.1346802239413671 -2.8806274271829282 -0.67762584079565324;-3.4926345772492779 -0.28703391941493478 -0.63348224711950085 4.5297621049957861 -1.5759449310649984 -5.7064789258070121 4.9698212327191849 4.1974760683934607 2.1213569732120292 4.2304470986067786 -2.1826818747657231 -0.29387303014330607 -1.5778631288313787 -0.57719616977768995 1.7826408174245401 -1.9101820266267646 0.36613081588294377 0.40388112759984407 1.8179220849422115 -1.178207452031317 -0.0030154713425411253 -1.3573636788444081 3.262611608948248 -1.6490422295848561 0.87956501389396979;-1.263352253902327 0.5136233674225017 -4.4247692681801537e-05 0.4055414779688119 1.865740019602572 1.2467064531049872 1.7795471367263986 -0.10515677653759625 -0.80594729583216085 -1.4556624909032239 0.48662792594806953 -2.3405295657122727 0.67134188991609545 -1.0560363714132115 -2.2772039187344872 0.12840123638633677 1.5037209724519429 0.20903486823993009 2.997233332627891 -1.3827902671724159 0.23562794146148575 1.9305208472011681 -0.004273828212342165 1.3367920829465345 -0.33062585869022165;-0.28711016673510742 1.416324075252327 0.43111094688881862 0.38077488851700947 -0.82524591102419631 -2.6971149899913636 -2.5635162084941943 0.92982496176119378 2.7331555696374337 -1.4971380522286295 0.83246604305252381 -0.59818451124321526 1.3321012627163613 -1.8655481323315948 -2.392945973597524 -0.49545165875771152 -1.468148274047357 0.39510771356485347 1.2592940473042407 4.381265187128232 0.018460747863419461 -0.36547414844814169 1.6945307382655321 -1.7265015442615996 0.32807642260966596;1.343446395061515 0.29232104297537137 -0.66947452812100705 -0.63998701891069998 -0.17313313974366873 -0.12023343006948645 -4.0658489115304768 -3.3921698570826684 -2.2794262753874635 -3.576164593400871 0.61429882154873183 -0.39799001013453417 -3.1720494922075946 1.1327829613151363 -0.85760686654214602 2.0004306808285546 7.8242841875360707 2.8409873392864191 -1.175559390058722 2.0244296618580764 1.1441265753898926 -0.8956642316274146 -1.302166644962035 0.83110669811991345 -1.0393451886649008;1.9478770094999842 -2.2225306115211967 0.18540122652657942 0.021367222415208283 1.4388574721619825 -2.152499342834179 -3.8798308230959933 0.50634438302881957 1.6561632777995852 1.9236005872124264 -0.79248011034355481 0.83016777323128166 0.092940475756173035 3.6785945362487782 1.564634886366534 -0.70114070141811535 0.046687264136990508 0.5865743545804879 -1.4661699570616393 0.34386055184200826 -0.11294825132671008 -1.54329162895479 -1.8454942103170719 -0.95869906070074484 -0.54741916545096259;-1.1367926519163327 -0.18116656872547646 0.077995396345521592 -1.1029690543957176 0.21090522568872763 2.0114686747378907 1.063603873189668 -2.1602249034905481 -0.10559576812615484 1.28160241270175 0.35902259817554866 0.76335005667225742 -0.48364212629613712 -0.62889887024539082 0.68294273799948824 0.38574303215865918 -0.86364674204344927 -0.0088071221811634355 0.72985673038065579 0.87210254378296093 0.17409522175070202 0.31397849767730956 -1.4358717361550015 -2.657675541510947 -0.2782777748475263;1.1294040929426901 0.67390259202345337 -0.54518488132102605 0.86970219739401022 1.6672448691930277 -1.4031749133517197 1.1964766919004437 -1.8400337858526035 -0.48601127243596298 -1.2533352018987098 0.010737491750262684 -1.5429606687429755 -0.96735474422071499 0.7504517762347227 -0.22892163320606085 0.57620589428219882 1.5744667725876773 0.23313788539117744 0.27032250775477062 -1.3153744751291723 0.0012766840384412289 0.89333826558374341 1.1609458044587098 0.83389860244585567 0.31427643840404734;1.1912060639329196 0.92203182643839976 1.2586961565830104 0.87282984068284664 -2.9527524294529139 -2.9411524580975157 2.3736875133318724 1.6732988770327288 0.38678268799718291 2.2486592802404086 -0.29854113902362439 2.5576835329392864 -0.24783820308744539 1.3205816457886874 0.11762856437899946 -1.5060749553551707 -1.5113530039157781 -0.2656165132045506 -5.9899813376371567 1.9343460388084985 -0.62657963444555875 -2.8543539027917979 -1.6796879834014495 -0.22015196936733758 -0.34879144675986301;5.6677913277616572 -4.9976971189403399 -1.2907391714550773 10.025827357950996 -1.3610070205946991 -7.4406342168508406 -7.3387171380161647 5.1608122969765988 1.7054737643580005 -2.0705613447303386 -2.912382907751534 -6.2266879794088759 5.1738304745960315 -4.3659948462004987 2.197434866115767 -0.6487237198637803 5.819626250876043 0.44711670049017438 0.21941864671789774 2.5717133524168272 1.3209759323037902 -1.3444539635869845 3.9794923043369628 -2.7539717308085594 3.2881630850078212;-2.3821441522666897 0.10647427244632625 -1.2957275878044987 -0.43397307234802135 -1.2903067505867134 0.29359596509566671 1.7475443815824339 1.2775734172544646 -0.10741012997761257 -0.35370094675582342 -0.27688108773682346 -0.052028461385916686 -0.39793075120491739 -0.13175815876223712 0.93286688915993443 0.10024002092571432 -1.2326216536455801 -0.48616339002232484 -1.0792999098609424 2.4543570419348275 -0.28087488725073401 -0.86887694617404154 0.42035595071725906 -2.1351948546868926 0.28973506212044442;-0.68998280420006386 -0.43481188524864822 -0.18324113643525505 0.19220734977596707 0.54677743034210557 1.3590381967705902 0.46617199790343816 1.1036730739394436 -0.54661060141350648 2.3251649607678266 -0.57473433117328832 1.5322732534959136 -1.3538761875925143 1.03587368670175 -0.089242986221572687 0.58038245338817351 1.7318934314095169 0.38524962526896583 0.058482532716858458 2.0606036068638978 -0.12693370727861289 0.35600040408912903 0.50608527812604209 1.4457379845161136 0.092611317610406821];

% Layer 3
b3 = -4.7479000645658234;
LW3_2 = [1.1878460826120003 0.10122866730283905 -0.29722417243080324 -0.011203730879716755 0.33396970186341607 -0.10338775452450936 -0.063159118710026912 0.023020392160298182 -0.14269839014567634 3.7934744710512596 0.42885335183520529 0.086243571603687105 -0.0092929765316936974 -0.22092433065825406 -0.44883278603695265];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
