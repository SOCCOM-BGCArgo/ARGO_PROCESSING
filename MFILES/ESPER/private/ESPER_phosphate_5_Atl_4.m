function [Y,Xf,Af] = ESPER_phosphate_5_Atl_4(X,~,~)
%ESPER_PHOSPHATE_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.4941717768734203986;-5.0066694767562252011;-1.3249133107702713019;-0.13345337470934504065;2.5492417031478580292;-9.345880204469318997;2.3264378347276930548;0.80973029752285297089;-1.3289901613357248955;-0.92820357228619765344;-2.7222762521894035004;-2.6023613827503484508;1.7999976776434489789;1.120689662090508687;-1.7119761436537599408;-1.0056355477628242667;4.9253718463402664796;1.7575768294975004924;1.6806500885725308425;0.98240530539822690237;-2.2955822344945531199;2.8591221225704699371;-2.9811769648990895654;4.1813611474965721726;-1.7700901891035862867;5.5230562868571873025;-2.6688000358734882411;2.4400063471717783337;-2.0723067728592226011;2.9856022380737319288];
IW1_1 = [0.37843745694949754155 1.2944970906593493698 -0.19072517170890268545 1.1883786049874516255 -2.1189980534743617646 0.22203987271855110675 0.34443768565137594662 -1.755635553596766929;1.2029125413584065285 -2.1903933381744296049 3.6340069726622052926 0.13739066169255056971 0.0011219461063488589403 -0.97537380275409235608 1.1644430329495771836 -0.49902236694101048675;0.093847270997029719197 1.3405408742460780402 -0.80597820903316519381 0.36975677034854170788 1.921607602513310642 1.3686995373130677045 -0.6031578653351331587 0.88637418617748087168;4.5747825153575263357 1.9123983644611346477 0.7937627713267483287 -0.66519495212055335109 -3.8336555979085242818 0.37642399317229074951 1.5511560695662804932 -0.046293124394282715584;-0.38538821528037137121 0.72584206384960037184 -0.37168971735737799111 0.91290389311759656543 -1.3750415487263198955 -0.89603866671450871362 -2.0638714353512619404 1.9939057575116088117;0.94890553887440365344 -0.11273997999699052197 0.37822072916859378333 -2.8540046325264492033 2.0644728096091791159 -1.276499782216617751 -3.0568555386374867133 0.57518777129047149455;-1.3411122214976325395 -1.0757027059050616735 -1.8618983608106298711 0.019555766333553416259 -1.0052585008052252746 0.48137985311029179991 0.54190222058185555376 -0.63270857805059343981;0.186186085529144979 -0.47715975304519386846 2.835180556714581801 1.1572220849838068535 0.98445538251952635633 1.8298142305257416584 0.28429749637183820976 0.6499904535977325537;0.20983041569106375412 -0.38071683607111311831 -0.48099972607768248789 0.034645340308200475721 3.6611815765197368577 1.8205916206309096239 -1.285329009938954492 0.93079762840432223037;-0.27171152307608359422 -0.087003041027100644356 2.3975851381185298017 0.92159328649200322747 0.79128399616542588468 -0.37936848083540142262 0.54574923067787350917 2.1738584562010090373;0.54283603740313546293 0.054434402194857699209 -0.13071630012776749852 -0.20713124067481206159 5.3503029233356800276 0.69350942550777316953 -0.60835193687071054125 -0.028075769357178537167;0.57114072951332894856 -0.68314616051554033493 -0.68853901633370595547 1.852688095073364849 1.8807975867924899838 2.5705975012806767666 0.14885297384221476968 -2.5828050170758833914;-1.8348879914022666604 1.9867413978190020529 -2.3574826331156586434 0.17257629020567180622 -2.1420780791929230347 -0.62242436419399027603 0.69546474372439570644 0.040834850895258137382;-0.1845515091394830387 -1.1759904803699148257 1.0662963692658777859 -0.15920570914449166944 -3.3477710620417959753 0.21051462327633865823 -0.56970789382347597485 -0.030836694196040723148;-0.40873836149843179033 -0.26825698756744431606 -1.3659675443003924666 -0.14871801359715644542 2.4854862652078089091 -1.2526078172750954032 0.32907838234471359362 -1.6999361917950510659;0.26096913356572110088 -0.024273329237370688816 -0.09694639111447092561 -0.14832642209339927386 0.83043324356739300907 0.68362452160952413838 -0.67912109905555817502 -0.76510665980635861327;0.049774728571088396045 -0.71344569339018049092 0.9842672521307066491 -1.2074824300815694134 -6.6505502802639231419 1.5309835885660922905 -0.54436437768969547779 0.45215741899397915438;0.33750273665708974136 0.38492801929500142233 -0.53606996902696502083 0.011436614313543988844 -1.4964629029403242466 0.92581730658065231054 -2.2712093038404836953 2.3501115940819765626;-0.83915794984353342389 1.5188955363923855035 -2.1801398267031206757 1.397726441738106784 -0.018122889882904374276 1.0004120916572714073 -0.28810369581676492645 1.0876490382972736626;-1.1287257901069682742 -0.073464431637799545993 -3.8146023224371070626 -0.91293597755570177199 2.4579942595062416189 0.45572889474319888681 0.6938284961073438728 0.47358775198712016463;-0.21898064141541698224 -0.21103066335241199569 0.099759024274716487368 -1.4505476101395733401 0.73703246283372858549 0.69909658854788891968 2.0032166834432110214 -1.618071788031947067;3.7832118618484011918 2.1326788172700470447 2.0563779927790220015 -0.77861529330297707396 1.2194612754984530678 -0.44086377788727382221 1.632525125865204263 0.96773361112225420033;-0.22917457857246661956 0.30738548816963706667 0.030049580523103670837 0.22971385823647660906 3.5461235165728379748 0.25913654091069826535 -0.024830690343913379425 -0.074536645711618540466;-0.69163448928109472202 -0.66356170751249432538 -1.8519804507587371845 0.039889232332225826871 -1.7398505331869897894 1.1112476898349183951 1.8644815675733867888 -0.89092989171353820232;-1.0422000188966247247 -0.05731712453051700934 -0.60123262141482602949 0.26665201306253299984 0.34560238721891173297 -1.0865089565779120218 0.19243863537580283007 -0.69566668973286238664;1.8170007529108289646 -0.50219870796994003914 1.0561542253005715697 0.28587703249816692752 1.7984838548698738325 0.50218458828260881255 4.5029620588195653497 -1.1469234252731494994;-1.0107945486929286183 0.6825982040284673813 -1.5638926848168495098 -2.7240757397482409097 1.7928284114284602779 1.8211088039427518748 0.99706436774495688091 0.8451845283721540758;0.31268515672228330837 0.084242982900959606507 -1.4261256930717587377 1.2654880283911089656 0.74948636164329396347 -0.87854772016726290218 0.17520791446634426114 -1.7016838651373664693;-1.6236613141529105953 0.57321545232397941305 -0.58800411824521925386 0.33464719913185858591 2.1094035558129244912 0.30201648712403234009 -0.57907802621901494078 -0.48206205707852017861;0.62408299736961336812 0.0085655530559400911567 1.9389732297854527232 0.32828250926077451322 -1.0936149124947993627 0.50450689091960332355 2.3883777896375772976 -1.8761793206346881746];

% Layer 2
b2 = [-6.8391001480051523131;4.2312076060776311337;-1.7729566427053022881;1.4875265750359931705;1.5694589315558560294;0.4780613240133391173;1.623110848629180758;-1.6454428704557129137;-2.080679367973031102;2.4871758433221713425];
LW2_1 = [0.81898471527354188559 0.11203702639886117809 0.051098593543697369557 -0.14269524236100614156 1.7642384599729370454 -1.4643914201431182942 -0.93074397803833219811 0.3244225455370794986 -2.1479870118782247168 -0.015823844975883155639 1.4974472960191718141 -2.4295784953308805498 0.039090591982324583709 0.9133371869892937811 -0.1534877666415668529 -0.62494875726313658948 0.029195427568229757875 1.0960524998074336889 -0.46963232860976211747 0.6839236230450962406 1.7054945248160515714 -0.043110364674886852976 -1.8439032309814755717 0.87046384247602903717 1.8862895403800554739 0.22660365011868566221 1.0909098998068325059 -0.73614757555973908687 -0.54790855742828659114 -0.46299232458931038892;-0.89115455245525165839 -0.33408028367321429553 0.0047371559999704309502 0.15270964875520459669 -1.6879063234023317097 0.97172311116883414162 0.6335978421229773172 -0.40531659667633834765 2.158198620267073764 -0.079025396039668960313 -1.3990596138264470571 0.86214974795600984869 -0.06490986906152998448 -0.61528142338607172412 -0.29718416495710658909 0.45227379809662121568 -0.30680184035557767075 -1.487076489316282002 0.22747357415008670478 -0.62858823157257726066 -2.6662597022978773431 0.056894236515376922503 1.0937211144005409835 -0.83892205960366561524 -1.8729271792774977445 -0.53373182660015205947 -0.49308674273721514458 0.78783063591847712903 0.7776858748646721109 0.40379218573162639627;0.95567935032832185271 -0.32598627845787381263 -0.83072459955364497119 -0.40621771966321129632 0.48232572034660492477 0.55865333740827394227 -0.59860310874980537932 -0.18354773222091899654 -1.2615526283440969824 0.081106987310774397715 1.0800942779129480975 -0.110601044114308808 0.72405935004895982665 0.87677189560539992019 -0.27350552812245232381 -0.68816533608024443858 0.94450131030203010596 -0.079375459152786848049 -0.022952193201444360399 -0.30171024897505177575 -0.16589543803730089078 -0.22742967759827312224 3.0185502646033417484 1.1669041861193309995 0.41271689670603300959 2.5764024490937131873 0.64952393257252405423 0.54049309436786407979 -1.3463344273985755617 -1.2065940215259254309;0.2596687340808205291 -0.18990189724485673217 -0.15886718857960532847 0.03834619236750475002 -0.42637719685986785745 -2.1336726263773493351 0.31966983549277727672 -0.14327634681295103869 0.044459471110119622161 0.34397751118940367299 1.9812163894155196964 -0.2970478208048414337 -0.36965035427662001899 -0.026745839995976235931 0.66533285394836549909 -0.15951838555112704543 0.1858423699390606143 -0.4582985933660197464 0.38603060602504563059 -0.29015694108405387652 -1.1373396514926112921 0.15436527250574230696 1.4286508806190105769 -1.4198084527719854187 1.8170707241055759074 -0.43172682703891485101 -0.14339754840765123189 -3.1047546008025266318 -0.51621856627990303501 0.48493540737144630315;0.15625056773989820513 -0.16273151984832687211 -0.48857375420079734996 0.12925189586913973794 0.74939172450511626344 0.39707343535372857657 0.34692095115931192995 -0.093709295681667081901 0.18374328830338051977 -0.011589943668519585296 0.36317886816087319168 0.27423878812842306107 -0.14360361282048295095 -0.77705639060231135318 -0.34079206191105987367 0.6883718233314899404 -0.0602466151399181013 -0.042330899545446318277 -0.26092063818225569305 0.66238665625546067073 0.73698048481874178783 0.15705124836571793256 -0.53847140397151460611 -0.044722411437898804132 1.5221736501684763887 -1.4193922551542590416 0.10089012902798488724 -0.58675321912378786138 0.1940478028119101972 -0.29682093575663281992;-0.1351770500193996416 0.52835887996271913014 0.68718043798552574941 -0.14021805891047173231 -0.64213107625056264904 0.11447023966997317557 -0.53431949292136404761 0.30621893285705803489 0.01540734778217200257 -0.09208585854579151575 -0.5957497877002746467 -0.34166288254113935663 -0.079551883241818208137 0.56478255406570387898 0.4764240947320456665 -0.51135862677983390245 -0.040930585524979655465 0.10918031789027929368 0.30835930570369424197 -1.0390129378505599256 -0.47347542544540477394 -0.010343492915943046373 0.020960191352990643204 0.38820118882669668592 -1.4911621884520251946 0.68917720171133167728 -0.01988468486040406713 0.43603998360483009478 0.094946711674854925023 0.26980192527878377184;-0.61603837229603020109 -0.66214097308981889611 0.1832061151461710502 -0.062530004245916342986 0.21596248237023066285 -0.3337451097216854734 -0.55866328088098604621 0.52091319477257735926 0.5272867471922968452 -0.067196394070626636053 1.1063142728585111385 0.14370430723825228236 0.32494602459184712684 0.69609494805768745707 -0.2183639325951578225 -0.53566436250786964024 -0.0025229251468692386398 -0.26544417882928800223 0.32221532618691689498 0.01767338721809047497 1.2537950233291346169 0.015997762448661717594 0.84385665985279501022 0.62487413547261461133 1.1647172141976314119 0.93667994377864027822 -0.26233124647938238505 0.4700446609062141623 -0.14612378835027153845 0.36682169041555157118;0.29008425459215103626 0.72544237768334440819 0.28505738540133607195 0.054237181429996006443 -1.0759711099929623046 0.16192439986095241711 0.2631490596930671777 -0.1930418355573973177 -0.44687456214277843092 -0.043900063328646321548 -1.1940758964628710448 -0.28784923205494217235 -0.52664610631015718045 -0.75420624864728524894 0.56231439415611395027 0.47677275962647008845 -0.047932559850696145054 0.65621685648793659507 -0.012852198806894438859 0.19914421752412625466 -1.5587501556578822193 0.199033497341448401 -1.1297860067487843772 -0.50952685737305003499 -0.21458741462976058112 -0.35232295077830222407 0.072844170237500310838 -0.38321530702716094519 -0.037315951830972152181 0.058170867352327723654;-0.17181851656145563645 0.23903998846527976796 0.88549851221613629093 0.20437963045047649602 -0.50075699845789656273 -0.3251213103606342969 0.29857659785775336747 -0.29506850592229588726 0.4794061816314360569 0.033889229776629531399 -0.94108968853691254974 -0.00088975577565134620663 -0.52963514642357834017 -0.2129712554757126064 0.46368349335146386014 0.80692437414728912515 -0.70009456838172012816 0.25377675171216629302 -0.1080722691861547291 0.018546578139949768116 -0.16041059958327227863 0.46612120916689425698 -2.0239855988346557858 -0.67672066186466084403 -1.1450218002770440329 1.1985291126629731284 -0.38104323998065653401 -0.78602481246016131511 1.128272560931220081 0.66844928443042084254;0.72989470080475082892 0.30380718249708471568 0.53285094832157875455 0.060313791917808667886 0.091425947824531311747 -2.5481725545599727134 0.16939226669191490005 -0.40490633361187727823 0.050920115103017596359 0.85101764006378932681 1.6475820765026931713 -0.46087451998757378302 -1.0640480223217745337 -0.47221429969158662532 1.0061582266179602829 0.46950313806765237024 -0.33960289132858556549 -0.29130029960935494016 0.6721077831702860772 0.17908694696872851093 0.021830715416938893669 0.81526502814800716479 -0.72557188812194384209 -1.5125182532922354373 2.1548669215505853458 -0.66943073210671222295 0.23841759606082066347 -3.2718963141119661309 0.30275242725873474647 0.67606502690758829566];

% Layer 3
b3 = -0.28494047515877640731;
LW3_2 = [3.4964889724522016934 3.5654111503548553408 -0.40467061204540111241 -0.57725841862593585407 -1.6621281643145393581 -1.7098224860595827579 1.7438022045227681289 2.1946387900667758686 -0.8704403781596559142 0.49345924760797854614];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
