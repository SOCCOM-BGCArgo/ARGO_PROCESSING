function [Y,Xf,Af] = ESPER_silicate_16_Atl_2(X,~,~)
%ESPER_SILICATE_16_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_16_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.43729357712130390023;-1.2286464475532132834;-1.5413910480148869109;-2.8379173559332664389;-0.79428729089582439382;-2.2823133637345529579;-0.47927885532053970952;-0.17993490304977730054;-2.1708640064519624246;2.3299730822760444937;-1.6517477089168961513;0.73398625569258235668;0.24446453679042889906;0.028116684898077146798;0.53578998710675507233;-3.8344501433029885007;3.1396968311158950371;2.6748751061045927813;-1.6157260547970007103;2.9892587942037933679];
IW1_1 = [0.39103520586661838498 -0.79327567913114283016 -0.021490175648668063957 -1.2856203965926389365 1.537723138191226635;1.5588238056515886232 1.701727774432900242 0.5249056167947289131 0.13103200561009517577 -0.098421591405479180725;1.5517091199166266335 0.57629853012366882847 1.0439711842312910939 -0.10181272751418551925 1.0465749045378065496;0.53329114709943981065 -0.086258798591698604419 0.19663773484460933538 -0.97846917726665394444 3.7316314079370225265;2.1345614264793435488 -0.93689402159307721973 -1.6518465438087124308 1.4887648014930581208 -0.39544256873781941097;-0.55177493143174272117 -0.29877580065552344912 -1.1568174222551383945 -3.9255932856056539038 -1.7269696365762061685;-2.1730032927593252445 1.2952882392022742053 -1.3946726330961121132 -0.49437193640527010707 -2.2140933829221070006;-0.82509301647380006717 0.36723704696970460581 1.4006733000386704102 -1.6159104165943647402 0.96135481891765650619;2.0436457586922713858 -0.85545030688273548947 -3.5080625286494018233 0.60469932142708771039 5.3501719510007266223;0.25803472437241914417 1.3472928194394402368 0.48140464896701123942 2.1112498116739297771 -1.7581312170922795968;1.2405964682326811044 1.7472635258382100965 0.92638999499062013587 -0.76994248711809321062 2.1416738229017564521;0.65643636482421896527 -0.57587242987273989936 -3.4263244992904944297 1.1960420579008512743 -2.1291730903039121081;-1.8222699023999455736 1.0985135074003971045 -2.5244341075431204757 0.39452075927085117346 -1.5215075331650991242;-0.028059032747862925478 0.48613606635749290197 2.4428427463499744476 0.34385041800782367716 -2.6679278772221728389;-1.555966811460227639 0.6737895728029278386 2.9110957659123917196 -1.3607407250524587994 2.2236149706527683634;-0.74881914444191266522 0.26925734146998003826 -0.035567719411981793542 1.0380844878102615247 5.9061535743218778194;0.49661821837079911379 3.5428617421661163789 0.43528334770472715265 -0.40725603154529876893 0.71668093736483340361;2.0319574938274373999 0.2539050128278044216 1.6501203263194974546 0.33768499914492616787 -0.043080761031601161326;0.091088830352716892991 0.61903606075453521118 0.0090920026146265441741 -1.3553536138810666767 -2.0380786452591941327;0.089638898781256623471 0.99612473021575065335 1.4498585845631370983 0.42868469538537568031 -2.5584094860766954938];

% Layer 2
b2 = [2.1038297048618721519;0.31919934431009278075;2.1938625424706739153;0.2690989410803388826;1.9998252082740353153;2.0817382573414886515;0.51721403947884991847;-0.65268812580015334035;1.2291790536670010869;-3.4802567194242897131;2.5745296521759128971;1.0290098599316486183;-0.88564772539516767313;0.82206398541341274555;-2.2052369654844161673;2.0291924399919056832;-1.7578691796459362529;-1.4145367440240652623;-0.82283560214804085664;1.0082779301902102809];
LW2_1 = [0.60066803640015264953 -0.46437743104969120278 0.14830546482429798893 1.8108794519588444771 -1.1263268196532034704 0.00060442125847464138119 -0.89318211008394032824 -0.16173786844602608403 -2.0238709099146525716 -0.59334179458184410638 -0.72959961663851358171 0.3062314136792049224 0.93895413367000890581 1.9507295662873995745 0.41042311840272793777 0.63688233149258099974 0.26127765755680343318 0.41777163170740744258 -0.98721495284103344403 0.10692064927836067434;-0.32669744534652683798 -0.025858085464932491215 0.2226329923495077856 -2.2896522789574387247 -1.7442363043641460063 2.0617406114417797802 0.61023480323392420566 -1.4250863275403715669 -0.17523618235118837427 -0.48450809728039617719 0.93201550348818540392 -1.0073723155669103146 1.1283884000963471106 -1.9025949961998900317 -0.50029462545575575927 -1.1098573382416336841 1.8885243396026403229 -0.048227103808577455324 0.090933821703200135023 -2.0493582463997093157;-0.43939545796522611054 -0.44012886268797296596 0.56446961050502564294 0.7578348572101819558 -0.45729271662704379375 0.19029673492948628866 0.094302128910404584006 -0.31480180066403995465 -1.1004781765883080435 -0.34558472495635600419 0.29130883945228763787 0.67102779524986111426 -0.46452119022353050015 3.075404190133062432 1.0362075958084937533 0.15427274294586409975 -0.23821181911608924064 1.0448380250043611817 -1.0695465197753137865 -0.95327126480530766095;-0.26523774343075129378 0.88881511405457391817 0.76964607929022266219 0.41062782282927329236 0.77541062633878765631 -0.74478426518040075077 2.9290499620561791794 -1.0542268067768860718 -0.96322048615322930498 0.29107518087780387406 -0.17417350910445011936 -3.1035286748625678932 -1.6380236170109561122 -1.2772653212645115328 -2.155635590950679692 -0.25993761975101298267 1.3002752196214537594 -0.72531154345904447212 0.66845119204840619531 0.071444231774946936886;-0.33790460097984137411 -0.35719660385730306329 1.0102997565071043518 0.77353916009952272681 -0.46817447947234275274 -0.32821856588182701797 -0.93398331087215180624 0.24010664049307930967 -0.89657719791278067678 -0.2727637248840620865 -0.31250714496605991322 0.49960769734309562473 0.093450157954576631991 1.2469552034008153374 -0.49183595545625213852 1.2121071394294216095 0.28709040557432774499 -0.24450592624588141089 0.21235417061102712655 0.36576358466154418325;0.020554734046597467056 -0.16728027855444282945 -0.20963324495064478148 -2.1291601791857703851 -2.9820021750186196385 2.1663431365831420372 -0.66519035388601865932 -0.53535161778873829874 0.70353718875902648833 -0.28583984958308322755 1.492430661540371073 -0.57000999880453373514 0.31424968408328357583 -0.36081687179172938773 0.48738002442344313669 -1.3788075125494725359 0.59060816019190887083 1.7061301305822060836 -1.1872437428653812574 -0.30625863895212829258;0.57165602649282176717 2.2363284417290740791 -0.78919750248414599625 -0.42381739130329892928 2.2495855778141056192 1.160434782947316501 1.3321832868167926556 0.76373233518716177048 3.2984647049762001458 -0.48749484554589611607 0.0021659578816363989073 -1.3076905532845803926 0.40311745546584160094 0.5885153436668673077 0.012992191319137438854 -0.93697358433530864019 1.5776115151441145734 -0.32938599977784094319 -1.1641386753170952506 2.5388853192614884158;-0.70713346230483276056 -0.18080530399871322378 0.9502379890871134327 -0.18444806001920804883 0.0091524837578674418659 0.60398082211314463308 -1.8359700930917830508 -0.8572914353174082569 -0.77556249868678672765 0.3984606991836237011 -0.26428112736930098325 -0.34097950996600051576 -0.53700455433775318159 -2.1503771288705615383 -0.75817390199432621589 -0.56267893967810256317 0.10468395098126566378 -0.7330253300842078934 0.21247292808056619795 -1.1622361593376520084;-0.036371608701043917078 -0.24010837638354734502 1.8869643882252564726 2.9076070220008460865 -0.41615910759932006613 0.78617392345862990854 1.0582051066855313604 1.5842483939139953009 -1.4682690165997680509 0.08647039217390116439 -0.19329491507161306041 2.3343470192338373614 -2.3581541742181997279 -0.12923104931366380388 0.75847901027118014294 2.9879647735997125757 -0.84969445024370204855 1.5708425125882541362 -0.68337015225287778275 -1.441074219032439041;0.51641629257419341403 0.30376522443537912199 -1.4537760179565510921 -2.5088207836874705237 -0.4890774577862511685 -3.1634201371718546625 -1.1196331618230614957 -2.1154482994864909351 -0.76910612806898215332 0.0087742082230150425515 1.0751976356975792015 -0.71277518792696348271 0.36789202235594531398 -1.4322453807212105481 0.41061358988900220623 -3.0452628943447934695 -1.124144225620212767 -3.2319187323747917695 0.85213608880026703307 2.1254752685416899993;2.7193161653091268981 -0.76959974960566557289 1.6109392388486283298 -2.2050376895832473068 1.0905256108640783985 -4.0118376064125476077 0.49935263748181302201 -0.28844261660481573806 -0.022914611909332759793 2.2188790296453757556 -2.5924255781090752571 0.38303827976266702215 0.69731214291531773419 -1.6496817462937105603 -0.8053317039869920535 1.520436957016938706 -0.48108018210177688756 2.5685151558737215893 -1.3935301783817202192 -0.92257421416086227151;-1.6421954132411848981 0.49156703676093682631 2.0571374252117640147 0.3407788398892842574 2.3396084230758593669 -1.5155944229507334331 0.79996199372113618864 4.1892829735117409484 0.13326503462777020137 0.28550792476406244846 -0.48478548354949929644 0.55537339548989717031 -1.0531002414060222083 0.62846615785527581988 0.28221714542378306678 0.38955200203289974681 0.097136822712895726228 0.10038222875105951015 -0.97053022659726961852 -2.5119576138333759019;-0.020723088395928235261 0.68368418752697368568 1.4023076338455902068 0.59695058791956556732 0.43963911122609011795 0.53369863443956888638 2.129255341901050258 -1.546582801767159232 -1.097413673360832842 0.44692871979627785128 -0.074580559603863588736 -0.85063969139096584637 0.83117570478968216818 -1.2442643990263471121 1.2499116111545633956 0.13059649310222878893 3.3231945618459799441 -1.3986020617685186451 -0.35333146340921006701 0.1807069378984104413;-0.32906463625435566911 0.23108642630323622535 -0.045503752849161221983 0.18859459525921581924 0.31004991755038385781 0.57644837341101162753 -1.3993887074360078504 -0.5879200246403650798 -0.087781663377805241311 -0.18408328176998270398 -0.060010648732489534074 -0.038187296265310415044 -0.31923171683909695728 -1.1394835727610546083 -0.40690918964742295305 -0.93504720618493453177 -0.075114903555296611004 -0.40185943402441759442 2.6310345545197195705 -0.32028772320681531127;-0.069690935283121813182 -0.24661443897143758841 -0.57533400720526550742 0.067734172530502095855 -0.27849650924345098479 0.44438393130515851936 -1.1533559715125367706 -1.129487660100026547 0.074247047320031719919 0.51171222608131194942 0.45823539582112920998 0.12479681905980133383 0.24908496662925011522 -3.5470555174984279567 -0.06337043233713716972 0.53585191099283979721 1.2238306692545521948 -0.88804634045429675648 1.2912789873218626369 -0.00093849570724567274449;0.65887204237390417649 -0.019371086406488650933 0.091399209689948468505 2.2624993448809993524 -2.314671222877697776 1.7448044466092196281 -0.44278021554896113132 -1.4532179371077962315 -1.7677302623319115504 -0.65728218819952455299 0.16751608461392375471 0.10731877274947751455 0.78705873628631739525 -0.3314633640361620559 0.77823934511021641836 2.7613075005041314292 0.54735287247567809832 1.8390310694107765421 -1.5678666850653057985 0.091293616766436214149;-2.6536528766313307592 -1.286048530421113778 -1.1710115176722157848 2.6708625749413825723 0.34778311008885615108 -0.087745312715219833666 -2.4675315190039079916 -0.033236318416304193313 -2.9044644629316769269 0.23224773561796294152 0.57904905298429543148 0.13574059549919836876 -0.32019663640423351447 -0.3173988337087750855 -0.051619654740603759802 0.65947951162120133084 -2.2427189737145694082 -0.52740148010944543078 0.036396555235908976955 0.79593109868003930618;-0.82585721192262129264 0.89090872155951683631 1.4873725361442007298 3.2314915493295890414 0.72763351078063953636 0.49998832555144895329 0.00094343383521023433877 -5.4931909635847882001 -0.077565956816636680293 -0.0085144732028081711317 -1.0026177978902448551 1.0303665657710530112 0.91730563318064206602 0.14768807661050784019 -0.4110960542942934115 0.67280349296598962461 -1.3848460643396081071 -1.2512118940651100196 0.48909852192326169762 -0.49463163912494101382;0.17596545135904514967 0.40669253722822074071 -1.4380284294696119574 -0.2464679589837120155 0.33732705638882964916 0.56424165980858875802 0.024144768484086642779 -0.37578365040292172061 0.6613608416024285841 -0.20707746375919483528 0.6933817844385956608 -0.025320026947926902589 -0.46964438784282303008 -0.1820688534894518984 0.39416971364480335449 -0.90640094868747944634 0.15686132019875684285 -0.40024451195928101299 0.83446189900977896237 0.097338052262965241157;-1.2732174394040081111 -0.14222343373016063661 -0.12765829624997240832 1.4489239178685995313 0.96947305775348813217 -1.5548266125966487827 -1.129416131083683883 0.70939783013297985637 0.11383559810040699833 0.115452525296366737 -0.82848277358375344015 0.71137190052066012758 0.91147963589184555211 1.2724306734234345218 0.19368734597775949524 0.74673105110215076685 -1.0772279591331748172 0.89366306936681050299 -0.12925889483363775523 1.610316465424087129];

% Layer 3
b3 = 0.37443765839224685266;
LW3_2 = [0.91285783994462887936 0.55938313811545836707 -1.4338978690399346583 -0.90283574205378269717 1.5969512350327839112 3.5882171287492270473 -0.52115390791887694633 1.9280888742459183494 0.54102820525428052534 1.8683561743940002575 1.1295908414698458966 0.1304831559876614977 0.89663141223730780105 -3.0270840658158828518 -0.99708551025634784004 -3.8624657013969430075 -0.43250597867562323717 0.76672938456223838077 3.9413839849294287632 1.1419254145215700369];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
