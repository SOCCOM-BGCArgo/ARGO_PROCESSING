function [Y,Xf,Af] = ESPER_DIC_15_Atl_4(X,~,~)
%ESPER_DIC_15_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_15_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.255023497014349676;3.1113543047418477094;-1.3953054138071927515;-2.0232403320696183968;1.1414874071733418504;1.3743854441332694627;0.680930350023095321;-0.89219761397932118019;1.2055606482879348551;-1.6912099689638233624;0.16612852045574980075;0.47618341058938012944;-0.097604056601456601339;1.0680145972608352523;-0.27731257916532947583;-1.1650023221781262706;0.81878898230237096012;0.17993310809622992119;-0.4346814591398797667;0.68388898928640273756;-1.0224309320831763692;-0.7140432588604009867;-1.8416203784656988152;-0.70930479350076058864;-1.8525549813978252622;2.3069958421063283538;-2.7048298821125920099;-1.7471984328526597441;-2.4390160129092008923;2.3921783581310247513];
IW1_1 = [-0.045095905668708392844 1.9680922712340302994 1.9416074519038093449 -0.723820266918613342 -2.6233244461596485486 0.14420693130924361336;-1.5838102820541677396 1.2730003039685009458 -2.2769706495009507385 0.71039433085956060765 1.2651254002980059088 1.9537229259420230143;0.73658902852856544818 -0.43707365033171452495 -1.0893583742763048861 0.13922324634480473526 -1.8630310543686732228 -0.7544002343645775932;1.675821293735672679 -0.098298634883600480294 1.3707641621220516548 0.83925969379112130841 -1.4340186767325768802 -0.43727068335798680021;-1.1705621644054524655 1.9767465396788157506 0.34813158981243486068 -0.12661667448272367897 -0.65098428584538270414 -0.23905325562439283527;-1.5688139158816931662 -0.25928544046247237187 -0.92421917852677437644 -0.23410289183975138694 0.82545905559578902633 -1.372666241454050251;-0.75979081069523735081 -1.2992471762094375265 -0.30878854082595919017 -0.26835990111686547355 1.0938853989384869081 1.3506639878183162029;2.049432028232141878 -0.12346566373173148423 -0.033579523630117298627 1.1821729457376157768 0.13865904214601276756 -0.69172547109271853571;-1.085071083125566771 2.3639047543660947071 0.78382079697432704979 1.3367810190172559892 -1.4068947802906923705 0.14375650890386670877;1.5648332875579518131 1.1164469012109898838 1.7593015908893439025 -0.2728867253485090516 0.38219413170758459453 0.42678168768058327709;-1.5660035325718668631 -1.0271260917956310799 1.9446203459097932686 -0.49160835401984004367 0.44901487204044454593 0.2384139249463213539;-1.6627845742438531751 -0.4604095300265121371 0.3135206245404107972 -0.82519974081900782092 -0.37960021324429021883 0.053025175507804583885;0.3697110090170534491 1.0259830861119441092 -1.2820600660648273639 0.84186769777725234398 0.9912647272456530656 1.2918275099277314322;-0.74221136429826262138 -0.40069423771014800462 1.7359558168418711688 0.2850214455576084438 -1.4823215744702116226 0.33407979208358073997;1.3753132744566065604 0.71848228273748004913 -2.1170165030800456307 0.37552352546979156367 2.8988105500608645215 -0.52876503629876214774;-0.60031259524208346878 -0.42755884318454312476 -1.2604003979750344477 -2.2665226556712596562 -0.83475022532745757342 -0.54151993389031627402;0.53166301108646585316 -0.12083854377974018179 -1.7036582912931081957 -0.79076428209753069076 -1.7309951158677485683 -1.0343774112643608909;-0.068851270235833275657 0.39028998760665384316 -0.4407092819251469118 0.76849898927434645568 -0.51431764045479377856 -2.7072484890767647414;-1.6247398977716931423 0.038659435628901991922 0.2979632582193070256 -1.7948145760613933852 0.46405123279934684666 -0.30003623958474090472;0.62176091408651124048 -0.49161156014537282788 -2.1606876558834646751 -1.0793526073975598933 0.31432433371259393962 1.4234963444019359535;-0.25898276063150288406 1.9343741413458981349 1.0606458522199453398 -0.63012002149003032425 -1.0580888993459496294 0.72924978944042473383;-0.74730887223344488746 -0.21248321539001599478 1.137042759393904312 0.29969855847888898781 2.5050546025016044993 2.3821507690143288727;-1.6491017974194055462 2.3865820716405972135 1.063775764199887508 -0.21467444962234677464 2.723193964299112757 0.14256469102640417779;-1.6281662998223469518 -1.5853339777007078304 0.65673298661284273958 0.17281283978692654757 -2.5122040691799276679 -1.2033316954505821617;-0.82975368368992807877 0.38650282093690274676 1.3313526796407824104 1.0866014642919907818 -1.8495338257921374314 -0.087752826561190461208;-0.0097664025968993914417 1.0658652923417648584 -0.88946385351727819124 -0.13618998755664024625 1.3551833719459887018 2.8332417032421388647;-0.81786110216535967687 -0.57987181220325068054 -1.4132671034874115801 -2.1428084033081358228 1.6867140048243183248 -1.1509877399807084686;-1.7120924140801554447 -1.7176661054091650893 -2.4401769276500271388 -0.44550655695678803569 -0.3355505131377340966 0.51062514358331279052;-0.77094273026264859006 1.6246373017513253689 -1.0434175876338200872 0.14701613874322963516 1.2382301396817236849 0.76196895870624525848;0.72144766901335100062 0.87413191534650436232 -1.7528678340463561547 -0.006286296257708395667 -0.75705758831511282825 -1.6797056849640241705];

% Layer 2
b2 = [-1.7238473042196214013;-0.87953310614241386745;1.0792949648686440689;-0.4133916267484754048;0.23322719158040067233;0.50848802234974943559;0.9628083021634613603;-0.45592644550752509103;-0.98463191587725529264;-1.2788015050099819092];
LW2_1 = [1.0526604316797907313 0.78476303224956578397 0.52066873500797317131 0.65159437538295206238 -1.364779525896640644 -0.83059794419310439828 0.56169628316827535652 0.051139966946266574022 1.629983408952371926 1.4361967168363931613 -0.51356798310484153003 0.73607489378395041246 -1.3207840334671170357 0.55999391931285669166 0.24631108555233000024 1.67398568451176466 1.4861062760497643076 -0.16807646977169343749 -0.18832761858236246599 0.81667350643889213835 0.046676774248656571764 -0.082324621176831175307 0.81438585110737804484 0.015281074301307224356 0.92460741471576479711 0.65887451993034784614 1.3865747095283080803 -0.36668516096196329679 0.29183073943652138027 -0.078852028551336342255;0.18067309094759084753 1.2957434188483891724 -0.22898051767149626978 -0.11122443920632156533 -0.24507780600786327474 0.043397481568326776169 -0.52318694345247018784 -0.52417824567982274075 -0.15845384192796307943 0.13810118778256402772 0.13411331304399640163 -0.49313836503519192789 -0.42267409159426583276 -0.10275730471206304117 -0.013345288352190416009 -0.061895368561662562901 0.2882133702333716796 0.32603369234225293427 0.10858958909475201204 0.28011822611438164099 -0.59682844442208815572 -0.91423863864983989647 0.1611061084820759326 0.34993465220817693284 -0.013257887605559974878 0.50060597784467553151 0.11655298279982385934 0.00042075100375547891656 -0.21191900675193112158 0.13541708389676029856;-0.76767265041559373806 -0.37470783084643621841 -0.76221370526046272609 0.51299996805774294995 -1.0542836690532442212 -0.091070582831219770714 0.46734148374805883908 0.43895348153093832755 0.18817457650818630865 0.50158875628672128233 0.17935360197473507182 0.44914389911289254176 -0.28841847656846336667 -1.240784564459117556 -0.15501886440130963063 0.021109495666994857604 -0.67936263666030494157 0.13412471502801026624 -0.090036532894722312581 0.13590138900949769174 0.5495135554423785651 -0.026836469065925620814 1.2149760155343507506 -0.40364497571530322251 0.013321800922434430883 -0.7953731123707171724 0.095560846363390211655 -0.18196219418575487747 0.019671294354594678899 -0.38760742836041284232;0.840866738977812056 0.48637835618868557885 0.27275049780970506141 -0.46064510285591209193 0.25544029593288702928 -0.25352372034875281237 0.15732862675549985632 -0.69885541985558885525 -0.50090723770796963255 -1.074395337286506269 -0.52595392145193131661 0.48906463230612351456 0.0024157470106913902543 0.91775266988290316039 -0.92643904545966415665 0.81366974678857673098 0.71554961015840012895 0.65349501498294571 -0.10208674055274312431 0.11346675759629246127 -0.2278831245204311351 -1.2181765018409638213 0.38011964412076443276 0.96046982739882735824 0.26388066912831514843 -0.087789183525801506303 -0.26022480118268048743 0.2723689481952586422 -0.22418112261131997731 1.0797293786055843778;0.60657179124360094402 0.13367901978684965103 -0.34572404945449047853 0.17087608153005603984 0.012620333846051655022 0.22417127793483465625 -0.93333821242039838317 0.018176220340397543362 0.16529063998293175297 -0.32280026733170097408 0.07648555408899779251 0.26836184063059043137 -0.73006929624840410931 -0.39297337907736773488 -0.38420102959441021495 0.23036710091787540589 0.64859556380389182806 0.53709678414632711085 0.090594646094759867516 -1.0203895409269236882 -0.06094407579432925548 -0.09362503870997841704 0.39863354126487238194 -0.55335783473196942239 -0.45097416431158249273 0.041545073558469515496 0.075369038544487274023 -0.023199018221264900569 -0.097317171279710318332 0.38497728330088853976;-0.11917265874641896906 -0.65667880711779647029 -0.47474614496702832733 0.50587433606420739718 -0.012052050889071474343 0.034149597882311963359 0.24270353748285397599 0.17631534587979968975 0.1737638829411882746 0.16746809148075364471 -0.31618832193797452579 0.63974248504247399616 -0.12627473281040813013 -0.073811200653034286789 -0.15791256219168683939 -0.19848217418926300537 -0.48350141058285950324 -0.43045506211966050314 -0.3902638268684243128 -0.067447146743894542675 0.71781128082697465143 -0.38146635070008050317 -0.12437071271333488554 -0.45967348221983106438 0.70291513224819146544 0.028374803350784075923 0.23001066472695264054 -0.085884230517769971636 -0.17343763558187635931 0.18055903869299147479;-0.85268009331785166172 -0.59708765008692288312 -0.49997308215692642941 -0.22398073161855730495 -0.087042348234689176367 -0.62967986957635746492 -0.56331518937747382392 0.01209863227914912201 -0.34169603507504631157 0.71947640224298048395 -0.3074686473779746354 0.44213159042946043042 0.14889926010937856726 0.28517644567561656332 0.33091174284213947798 -0.033729076835739627005 -0.18423602528847091153 -0.0088498650460593509398 -0.072473288075614164527 -0.11183361043546302671 0.3688043637204914682 0.12099328290984630307 0.93545377803140994377 0.39614600346650774565 0.11030228913438860916 0.47956615623243609159 0.53554488456604798507 -0.13229153211578492666 -1.0037146703273049919 0.12316579753655099161;-1.2035864844431085618 -0.087885522873430696467 -0.48723513167483933906 -0.025237729205012122274 -0.14952823222875294418 0.21353754286120393835 1.7277099649277118942 0.17502297259258711715 0.0085505250343428443327 1.3195711704705861411 -0.092979272181511335438 -0.44642448677662260881 -0.059821384282976210189 -0.13825660467284603405 0.23715040278806642782 0.64585840918023351698 0.019885751205796733942 0.70760707249233345539 0.6396286474897363572 -0.032242406486357559625 0.53444508856844052946 0.60439515499380558339 0.42831221334647578969 0.75483133177847794304 -1.0480705742289304627 -0.22310249491092201679 -0.40107131431945131084 -0.064370459878991023728 0.1697271601736630442 -0.32066440824821984545;0.59154637772657259198 0.10883177191195919642 -0.34760036984066472465 -0.87251979069387930465 -0.40275748259534355222 -0.56306590264139055879 -1.0848787680241254172 -0.087442913164185995245 0.021193301822695378295 -0.96893983286297624691 0.15586943105695841294 0.21925614799937742649 -0.22986606335459905393 -1.0453497196474850206 0.36909247016604312952 0.1098469013698466501 -1.0606958206296004388 -0.37947022453096973527 -0.10033478064490529424 0.2676138158079473528 -0.845914837534926356 0.47608892206948377757 -0.14064399407455568936 0.68732385697601416918 -0.052057614969000312599 -1.1550700360800134625 -0.18074265636999164997 -0.072091115730603130829 -0.80044228985861720638 -0.2938853908939763615;-0.15082191238527067889 0.00086474904129247394044 -0.30473289829270705509 0.20705533096311576347 -0.24462702643438141714 -0.31655962900522899295 0.0072357820957196661987 -0.030804918941030899615 -0.23585232724047455743 -0.44221081080168750388 0.2905881454399348307 -0.0030040508837701953432 0.25823307102046744177 -0.4606038706516437653 0.33856054897412635185 -0.75459488289740583866 -0.27597104177048470408 0.19006802562522739919 -0.21579591823682817142 -0.16973411222787593289 -0.28207928289537853583 -0.33711201528982059905 1.0078058340490989586 -0.9854178262053302495 0.14306576920645647233 0.33108599169635699599 0.86113455675900052455 -0.061466872970001695808 -0.37583997367061522388 -0.48463831277070651415];

% Layer 3
b3 = -0.59916353947208689235;
LW3_2 = [-0.85776173526611920739 -0.5025215572105009576 0.76598731228087713063 -0.033322758689594549064 -0.15648137491011626654 -1.4807629983911030358 0.41851467875960757237 -0.63406773138386951505 -0.47816019698627326706 -0.6908580196723700384];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
