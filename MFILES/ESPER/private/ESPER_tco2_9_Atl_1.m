function [Y,Xf,Af] = ESPER_tco2_9_Atl_1(X,~,~)
%ESPER_TCO2_9_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8606363355750988;2.5184658380616805;6.149861895235496;-0.67502078388495745;-2.2118455866194782;-6.9968984309244791;4.6229213758189482;1.3443145549880446;1.5798882780363077;0.60497948607180607;1.8987345596629068;-4.1679175486778757;-5.1166676847282293;2.7411329782735461;0.83182572382735431;-3.2451873329051262;0.65138717043213901;0.24973777934736385;2.4233819699366208;-1.700358969573897;-2.6285226241760622;0.33505777719576701;6.1369034057538538;1.376338616573479;0.83172594804876598;0.51672666478826845;-0.16990422979810443;2.2055033872252068;-4.2744481350380124;-1.5914219838810608;-3.0687973382908522;0.6928927090347361;-1.8782247958583405;0.90712978527976695;-3.9381400335862082;-2.2124275503169599;5.7839765103136624;8.14050866698914;0.26032104748881252;2.8529074866126392];
IW1_1 = [0.87637923908763893 -0.70677332857502073 3.1103702677519189 -0.01339415002095027 0.15493624535466261 -0.078264309805934851 0.54416093307840518 -2.0464420924047779;-2.2952923634587323 -3.3430226870048352 0.2938187945513373 3.0081714166158289 3.7219964321853132 1.1666317996461024 -1.2989549292886029 -1.0462414753376181;-0.097827102594788218 -0.24359806080083801 1.4773254736217485 4.4154073135253382 1.6523176491344285 1.3757671020427018 -0.42735623027776537 -0.90114274787818982;0.10750475656897285 -2.231084660044778 0.54781102585760899 -0.32198545976491488 -0.47404717693407161 -4.898858928099763 5.3902768570352322 1.3682798698049987;-0.74746585287869838 0.30697671911238256 0.89335584906118648 -0.53463171965053879 1.0733632512768247 0.63411672179937051 -0.50404025880774728 -1.8943197617560581;0.055757171878818859 4.7196776374028833 0.36280088333215016 -1.0021753592481493 9.4752946076593361 -1.4589735486651172 1.4239286167464964 2.0290577533374217;2.0399204152268293 -3.8395290772606572 2.0761956100958345 -0.49121518141671322 -11.023533912852795 0.6541831464678427 -0.27245983549687075 -0.39998658507700108;1.0967618679673803 2.1451251442172072 -0.047583444957968762 0.084450649779902395 1.1692078046085093 1.0456378632434162 -0.3259881040348841 0.13721073559647851;-1.3230598873429498 1.9090405251230205 -1.9518641351065591 -0.13378023671350864 -0.056839284760612958 -0.012459215262134967 2.9750195442878176 0.32598366251583272;1.2192290184538652 0.55191776902761314 1.873557737423557 0.58878783044826766 -1.3321440067296741 -1.1325395019132862 2.9643360644355199 1.9420170344080054;-1.4307948206554839 -0.28484828679869889 -2.2072023341567717 -0.48832135422868961 -2.0010590115700455 1.3466414195285326 -3.4425485714037665 -2.2160374570253034;-3.4992632112643478 2.1550946683326995 0.80619155128907904 0.077012243674319109 1.3569468400682685 -0.21662571540253775 2.9995885857954003 -1.9435684578363095;0.53260980631410082 -1.8472698330863577 0.80766005730131618 1.1547686385123299 3.4202757781772748 1.4869874644718448 -1.0463757634599327 1.8713021308319027;-0.71835741279670662 -3.8017891178511189 -2.6065380768021096 0.47319905041031357 0.078322299026342385 -1.7421315729042177 -0.060331557045169994 2.2368034200962348;1.1757534463082941 -1.0639712887423216 0.12689082253759454 -0.20342329791676697 -2.6689477139827389 -0.635378614481382 0.95009188589220728 0.78130872407693563;1.5864723545919752 -1.5846446861635528 2.4666882249491566 -0.10952180472728305 0.21554451350999193 -0.00051351297383319327 -1.8155026519446464 -1.6255287448539262;0.23051034943505475 -1.6496636453930307 0.42136429183981772 -0.13090606205317792 -2.6787613363202318 -2.8717762502949702 2.2886604069714727 -0.32677044625764445;-1.125034646998609 0.0083886774486251914 0.30799221279888295 0.057710530654809807 1.4622346764940597 0.58069787493633118 2.101548126424142 2.1307576884360588;-0.69392709222666837 -3.705866335419842 -2.4452737962004965 0.43045394208924026 0.28940048945606306 -1.5832146290907148 -0.070371916595321896 2.1216291347989009;-5.2289182010446709 -0.88323331985076381 -2.2410886578434006 1.4386973785212192 2.4433769086281276 0.39393231278467195 -5.6354487649384515 -0.32525049966756747;0.84955884343009525 -3.3828953686534047 -0.27932694105156503 -0.25132253986459224 5.4601719182506976 -0.81941999805382038 1.0775121116142283 1.3307282802542657;1.6692389178657274 -1.981487693945412 -0.33223253074273373 -3.7258781412536965 -3.4897217943136232 -0.94282132436156041 -1.009480237869119 -0.89143257976735679;-2.3716742512507749 4.3715293407738338 -1.1027132880938597 -0.02345646953238853 -4.1552415111347374 -3.993148162731782 -1.4943499009154992 3.4345479081778683;0.24469597670058718 -0.33510852198096042 0.66501597570794602 -2.3689520110338469 -1.0012048401126983 1.1435332307747494 -2.0734439336065988 -1.6192841020349136;1.006511109889461 -3.2088332254981862 0.44892442854390263 0.21371735808960438 -0.26515090131656927 1.7791550845129245 -0.39059775009216335 -1.4999080645052185;2.2428783016513121 0.18819751689573627 -0.80441295740678709 0.13360994751349206 -4.2985567670919185 3.4139956720993618 -3.6419352132682445 -1.2584751989224667;-2.6462239568871069 -0.66279209692318675 -2.605992692317328 0.39650681648357672 -1.5054582090783726 0.56568596259994286 2.4680139809396686 0.29079370926033404;0.59298764153283678 0.81923402822426783 -0.91556141112713452 0.98244026772007675 0.93380058470961946 -1.6068158843295135 2.3117890960942664 2.8877497519979869;-0.004232635195247008 2.567436899793913 -1.1022861334306275 -0.2814267311474471 8.5936880007006611 -2.143583357482941 3.1812695615898989 -1.9391546620561011;-3.2518141237086979 1.4913277717804405 -1.3387505589527904 0.10209637992898674 2.4604812582710052 2.2828060361093718 -0.99229904256909962 1.7368495419559504;2.5691992376648827 -3.2934315261891638 0.030148112633355723 0.0032972847305174757 1.9098943996042457 0.17904196732030539 -0.14302255204827316 1.7795428241024138;-0.29029908380108571 0.68530548804013214 -0.10120950786767975 0.31122856889319084 -0.070711892936457132 0.22694508276164962 -1.0722530494617157 -0.72257956479660401;-0.80021250131833943 0.31915436904033773 0.84039691856113874 -0.55678451269102824 0.41228134973463937 0.67232384477006801 -0.70969597704814269 -2.1757261259253515;-0.99874223839217058 3.0153099816099611 -1.4843041281172056 -0.091463134670888596 -0.21076865412566603 -2.5532309094205456 -0.24335325236609595 2.2148998914678364;0.20820765649340073 0.047565954953203607 -2.170546368151006 -0.62554788230183844 1.8711889541199969 -0.15143830283824239 -0.15041539432780218 1.629362616987472;-1.0532740187453928 -1.8503527087718534 -3.7884604421165844 -0.91857221102276654 -2.6526833087086081 1.8762734528688196 1.6831145278272828 -1.2282484625005941;0.087102160673239282 -0.47180927986860788 0.81833665748426343 4.0867211929513774 1.3114893349849337 1.1176227296330286 0.039082522275570818 -0.47352219140130819;-1.2404177409322952 1.1880613402943445 3.0572099102875963 0.64799006903469047 -6.5128004769132701 -1.4783321203807158 1.1796208890057174 -0.35511435566300231;0.81902639923989617 -0.28667229714660303 -0.73325090323953956 0.051660605038035191 0.35458268491659845 -0.12650758681856561 0.31900579638013488 -0.11287069520058848;1.416030987700833 -0.36197263033267862 -0.79874132401495346 -0.49269123215091104 -3.9782604611487073 -0.5499480042342213 -1.1855364044671151 -1.8195565023603926];

% Layer 2
b2 = -2.0265638213282289;
LW2_1 = [0.10465650148190388 -0.055638159526567935 -2.6035557358614763 0.066725445224568469 -1.6480121658244418 0.036893165043914003 -0.053705699369922755 0.088087360984955398 -0.07582546152377527 -0.15137476000260366 -0.13312106607009225 -0.11493174001739571 0.09121651884540849 0.83670771956312173 -0.2924221763034614 -0.12467846760212276 -0.056108909134686247 -0.048932614826671696 -0.92426500157112657 -0.015734304839384278 0.10169961674455281 -0.0093948679856360497 -0.061202065737633475 -0.020024654187801697 0.22775231016759168 0.079081141735777169 0.030539291678718699 0.10874725861512319 0.063689487501119108 0.066174274615997106 0.11714547987613703 -0.425301319699251 1.6045925689385896 0.14225395780390376 -0.096045024555314412 0.012356843176986173 5.3753977302490767 0.065690713551537994 -0.4667860315760331 0.11977561354508967];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
