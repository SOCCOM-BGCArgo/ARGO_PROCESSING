function [Y,Xf,Af] = ESPER_phosphate_5_Other_2(X,~,~)
%ESPER_PHOSPHATE_5_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_5_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4442379489503371914;-0.95147073708888973975;-1.6410991002562964614;-0.086006998449314892019;-2.4491702726805892887;-0.12836372480918736838;1.4666101030680780415;0.32173972723093369197;-0.77456354971123897446;1.1264796457530314999;0.53784914843878661728;0.27769408341233159376;-0.16261948977453222209;0.079352911802970466093;0.63691828104001957378;-1.4908965775701443768;2.966097650764983662;1.8792578480095991633;1.9313718536886115285;1.1756839012828224078];
IW1_1 = [0.46849403465121197687 -0.90867820747034988571 -0.14189698699200650744 -0.19142738772059286756 2.1824936807709902631 -0.4428758870299780992 -0.20482800048988014652 0.47287926370685534616;-0.10693168573938405252 -0.57798123083308128312 -0.452968842976412156 -0.010840558145512175364 0.15408109903438857446 -0.61371663513106489152 0.12225725366354021906 0.66428743908667831075;-0.083465321155737862147 0.47223443939880277442 1.256081987236394637 0.029880760730851625012 -0.80562082410834445767 0.38726094821731699147 -0.84006147119176577398 0.0066912051016015904048;-0.40097962223582467312 0.71685270085248797844 -1.7803008628905334643 0.3972240202855432667 -0.22636703908793598394 -0.26132644718767489289 -0.055239569073956967804 0.24978072284886054799;0.17192500687795850278 0.02328256011110377971 -0.8064996428054850286 -0.73351229566342956989 -2.4957849905452618167 -1.5038066852922777894 -0.22353833294677133425 0.80098799478378668315;0.73258537563530479186 -0.79745773762093929982 -2.0770887817110939011 0.44332978998513422608 -1.4704131679067156124 0.15145171098039589275 0.32546780851881440544 0.74743407662425709326;-0.7864957790223057188 0.87008408504365786218 -1.3320996621846028507 0.26310992989479131676 0.93079006765154670422 0.0058508795474156057026 -0.64283868704806490513 0.94815462895364133189;-0.3967726946749781658 -0.1604025750691953911 0.67699888299812971404 0.05452744900611748019 -2.3135332248551994105 0.24230764581852090589 0.61782959139677573468 0.50810751724971481291;0.38105752077701021685 0.48947653210938818491 0.45095725248512741334 -0.13361119926200384911 0.59851666295854710764 -0.085757712879481765023 0.12637550966694513499 0.26609205482369074902;-0.18138813515844112723 -0.29182183927598781548 -0.42307640658090545083 0.0085446454133538459613 0.056403921239061190207 0.29499649397484389857 0.51018318249724936564 -1.0444563222531246804;0.089683814814146861627 0.42534312180886163501 0.56391277116045102069 -0.012459696642965440577 -0.65918353560101283772 -0.15202485646663929653 -0.65947027955879178318 -0.42684166274634383065;-0.5706831318531557784 -0.21507894473639599386 -0.13796549470006508331 0.093957244953811872024 0.32313621104328810185 0.60764705009956843096 0.0026365355160281028074 1.4080201217297880767;-0.85897964032351148411 -0.68197202232488562945 1.7500532813494513729 0.009000767498819143772 0.23335683902248879895 1.3366252169584498244 -0.079881806328257268235 -0.035307977992224667818;0.39419568656532455453 -1.0425874712638978359 2.3517089916253421933 -0.55155606440175841687 -0.21393342899696263237 0.040271791916105914577 0.43218729426590235532 -1.2609671313260457648;0.059693234316541270157 -0.036593306662450260369 -0.52227266149283635421 0.0080271282485360768294 -0.012472148142550690611 -0.23359011183901987052 0.70993241072250190538 -0.063088714170827855932;-0.55621536692388140466 -0.15816102938226461738 -0.60523000468650978156 -0.099127217387082841582 -0.39981120253053015201 0.19875377898823309852 -0.40975060721425804466 -0.29403828357341998956;2.1150414127181971224 0.82576942176279122254 -1.5374113808264942005 0.058487058445093616232 -0.018685642223874001505 0.051519118062569653482 0.94158890445832021943 0.71156639114390618506;0.73161760135652886827 0.26656993323141559005 2.5669496713781141395 0.55036661580584544939 2.0738319477368962751 -0.23831364568554677663 0.57543256704911616151 -0.20541311341859250228;-0.14594912087095229802 -0.017873733320607973485 0.18941739692563699937 0.22865898626769107227 0.13154705930115251356 1.0025382634086710265 -1.3337359766484286894 -0.20578579886847844782;0.016303572922088820779 0.13225230884893934835 0.85419623811170908301 0.40163630690496487929 -1.3500161213520824877 0.034587917237127140113 -0.8600948380352804179 -0.22193543115026376222];

% Layer 2
b2 = [-1.4935869849587806169;-0.081991924237200169978;-0.19811161964247922529;1.2286070536714184254;-0.72556196075466361517;-1.0416073227588900085;1.4813915940476758415;-1.9385715570360060322;1.2012010488898337002;0.16475206641542827768;7.170562463858468405;2.5641061784796987943;-5.2093962193732190613;1.502981503715992373;-0.95840614324981754368;-7.4554509152991021992;-8.1493287366844189279;1.104654046622203234;4.1206953810247970438;0.54289331765420190123];
LW2_1 = [0.16312233482230029114 1.0513101497265859852 2.7031230453372225853 2.2224939935397243218 -0.070523220073730977231 -0.096140784498538536806 2.4188746131548537477 -1.3052627544995096809 -3.7524877656030626305 -3.9188436427745876323 0.21139055248767227302 1.8510687915883998755 -0.37399102328779249005 1.9905107423823875656 2.4575965682076752472 2.8429916996413662211 0.25188240553987806258 0.22541007072242749687 -0.092812220297183264939 0.45214976834986730925;-0.022813813381378587192 -2.7754241899324521015 -0.69350293797225903702 -0.097636963700273027289 -0.48021865156756032844 0.15280879298518851295 -0.16587823936934445457 -0.43082706458807795702 0.1975830669835908493 -0.07382645005436486163 -3.7142144740607112574 -0.29125984106300317755 0.36648518088351955679 0.018620177653710334037 -1.3040605359262367191 -0.90201726977830043452 0.14004298706643758532 -0.23646029381978692085 0.60598433767852166731 0.61624330743789779152;0.14874431042466385033 -1.7581224598911737722 0.9909454120276004474 -0.15885521728947915587 -0.42431937376023820541 0.1740522248755139445 -0.11133811101113423592 -0.75996941730090983302 -0.26938214200929616604 -0.47120642819796576539 -1.680000264263123988 0.37100101670995683234 -0.53129367421034379149 0.16428269469955777971 0.6598095909565134809 -0.21099973442045993899 -0.14071837958136687585 -0.17648798375768584568 0.0026687642300268531528 0.27339280338456678487;1.0294767579334138663 -7.7971840916749366457 -3.5982994382748585416 -2.5113276100562051951 -0.58118526107116963431 0.48256581137377740909 1.9982372729875839124 0.69703338707177009415 -5.9225229725083270438 -8.3768175139870102441 -5.8491933566311100634 -3.3984532879865292365 -0.086242969365123406389 -0.17205191144664869207 -1.381184669718102942 2.7617951164964256172 -0.35072042187546126346 -0.69495541177627584428 0.32712850274433025177 -4.2132516779799358275;-0.0023211754926716269935 -1.8626572355494619426 1.0943201029627902532 -0.74875722106876319017 -0.820543210905262832 0.30360700269805751539 -1.1248008697053784033 -0.76959927430466479326 -0.56141369377688254971 -0.96725442112994808319 0.41501915073984207982 -0.0035284387589342228186 -0.75014054547888031621 -0.32866779040914673171 0.29263666103721136524 -2.4205389066736286985 0.17507981257008914389 -0.4559815689304679287 -0.77879398919589404304 -1.3347735049355848869;0.66433817071048428815 -1.1085077616641036968 2.2275641567770536611 -0.54213269756985216219 0.65221685182295618954 0.23811359599167580825 -0.17132025918722554314 -0.395083888591159893 -1.6789457928956399435 -1.5332105075830997354 -1.3323391397203661057 0.2197021400401828195 0.067757230968440718133 -0.80371988746781564128 1.6639795244533170937 -0.61419237231358470019 0.38144285855308052158 0.39030112666738980831 0.75840826993947751955 0.73816495415684513226;-0.9944981043659887332 0.065916347744209416448 -2.6605911440665210854 0.62528493104224169841 0.30758926900939792537 0.42365755827553802648 1.0347316869301139697 0.6311474836699957347 1.6600130710607063911 -0.60968187104880078309 -3.1970087094925787596 -0.89233591204699280741 0.53098204763427425679 0.19498840205912904011 -2.9158154498782571373 -0.41021821747584091833 -0.87252747626621507404 -0.090080058355651165813 1.4061324710030624896 0.72283462509379936556;0.78529157977277286307 -3.6156636549711658191 2.8814519060933405648 -0.38340971799156614574 1.758546008414070716 -0.30145893511825355704 0.21009082922097060964 -1.3434241648252143175 -1.5473227605554493724 0.49035926867661161488 -3.3964181380959250767 -0.27591300784075883934 0.046242579633062004529 0.36610216617114110793 2.1161018851006012653 1.6848620144466608384 0.061761788241332341021 -0.5673336124854690965 0.58635433489338106838 1.6225600052734641121;-0.29932611393048053072 1.5142143298355128511 -1.1592935892875015913 0.099436311039149252733 0.47031537040563831109 -0.30121503327679571838 -0.031740878759542137666 0.47102261803932704565 0.5498535543363538558 0.09763872747229752902 1.2083248103534747209 -0.3804478599788863602 0.32814301522556199586 -0.053865424994079334764 -0.25221437513167127564 0.40604545052440904618 -0.17396277373250645937 0.037305670859971606923 -0.20245647524725848831 0.046626832394078776556;-0.64310990548474222805 -0.64524381311598355548 -1.9921113145124991206 0.58396639577805398158 -0.83968101106137393863 0.34776135029910315577 1.3633071004284864625 0.6414114480001485985 2.225546710690029073 1.4922223243234939982 -1.7721234545527293491 -0.69933540907335767223 0.46736148373283720181 0.95947105302584734243 -1.5504535824322476234 -0.061030651573329090798 -0.54165780707426136598 -0.69373345688329957071 -1.1686492136526633878 0.66369397927980411378;0.75262936020094040046 -0.60341761890344813857 0.87499070641100684664 3.1381813880974860353 1.7535663673688708375 1.2047846138812694505 0.16144679119716695559 0.2134605070843478003 0.97836192821252254692 -1.3392627897214037791 0.74880903951592214796 -0.5024628580426746538 1.4355839341652039121 1.2711823458556519295 1.4594628027638030243 4.3239065732594150759 -0.072350693705036148162 1.5981191934515652786 0.55122109349877523865 -1.4895300761768288655;0.18191439910273141112 0.36506324216600538612 4.311809686396752106 -0.63075832139233689588 0.46742519560542750146 -1.5101714174280838066 0.36045068041859790187 -1.3340536749502820424 1.8101670343634965743 1.5803540899081554016 -0.67303645909391851543 -0.65915429180240303619 0.48295569739454019542 0.50515141080053327372 5.920756233698623916 2.7364444969858472412 -0.30230708305035886019 -0.23365821293650201884 -0.64081014761071597441 -0.62725821342474596953;1.3996680984748772758 -4.8377282060918114226 1.1759994649372136344 -1.5580678911580163604 1.6508925252950470419 0.33636708664841213912 0.89316112476478348725 -1.6490422370449688838 -2.6404569888534550337 -2.9608482003586154008 -5.1675409879715505923 0.5061933290654084816 -0.25363691228335288885 -0.4034039012494546883 2.2589816168314285072 -3.7883266053334661017 -0.65533812243065003855 0.2489567927723920493 0.64886107161774064789 1.976031478267221031;-0.25957076606472384572 4.1527587584419176636 1.4668473599316496081 1.1406822446963267303 -0.95736417225059777802 0.40594783405369982976 0.10838606316277232811 -2.2797118980553738865 1.1107675133479402163 1.0816158459205897913 3.9032135096243170125 1.8485368317539840888 -0.10961855310849330514 0.55117254008680471866 4.2426194807004797838 3.9849901114711490102 -0.13993068886095844094 0.18698945643356537638 -1.7207637532113109202 1.4351740535225125939;0.96860357465914492803 -1.3038935214281228703 2.9387136272993639174 -1.0184733428805921029 -0.031138882307085426204 -0.6292051150548234606 -0.61755391157439554206 -1.4800485945063266424 -3.0854115230564964634 -1.3683316422997267026 1.0686545582264823651 0.89026884810019080163 -1.1752046495732411113 -0.0068562062123344695574 3.4202849293326904601 -0.98416478210461133536 -0.42709713997690368359 -0.46998504309916910859 -1.9802931664749450213 0.69552590482509069059;-0.74924900759880241896 0.70186906307368124303 -0.9015475295835502223 -3.4113384422280907948 -1.5941214332492661399 -1.2914323472273161464 -0.13036574439624096233 -0.20104968586480276294 -0.6990354403614541523 1.7890592166935204155 -0.78239543347768270021 0.52814806586064733107 -1.5847992754514041991 -1.4031317131352962768 -1.4060025378198843793 -4.3270284048816503031 0.1525506111054676095 -1.7727658673735198214 -0.76941857935039947858 1.9354331210820521214;0.025657326987686301933 0.83046607745890244079 -3.4414218280556854168 -3.0666073597605434387 -4.1829153069930988806 -0.45357633116239631788 0.0046233876243061636929 -0.35714476276878420746 -2.3133481403613829208 -1.2150481028560542462 0.31853692912418857253 -0.42349899557209114143 -0.096249037611550208871 -1.3918516540497889444 -2.1459875273879505109 -2.1982982205260017672 -0.50166505242901460182 -0.14295583330751227003 0.3211149185033895237 -1.4440944759545406573;-1.030649916392068377 -0.6311712460140176395 -0.5932103863773150465 -2.3892296305647033883 0.22787417362967057888 -0.33569692685740809557 -0.51920460623731023997 -0.14892831438091844176 1.7837710195319844697 2.6835343591957054876 -0.11369589755501501027 -1.2331583931114664665 -0.6178438939850495748 -1.5845492849230038424 -0.052578710725243366086 -1.2902776801301278908 -0.20356415770230831819 -0.16480919717128034163 -0.38018249241111584658 0.3507089433826699465;-0.060269155822457141924 4.1836410402434882627 1.7363900233401459161 1.5860486234009729678 0.4157072544330664976 -0.57164881556615276814 -0.095653836305802333873 0.46519648471316898952 4.0170066731775326829 3.8602624227718380645 2.1689255039627011179 0.55079556037333465834 -0.21723827978068899203 0.66025152508781759231 0.15587741385187059429 4.5224298131480367147 0.8426575347982117048 0.48611096377247337008 0.5574503437056310684 1.2203887201748764291;-1.9847952653094513842 -2.8028593329998217065 0.09355485284149353542 0.77020780542370137489 -2.1594534857954053031 4.6089398808742281233 0.094941885830950256686 -2.8404669712624119882 -6.4355718954607343818 -7.4713260944610890846 2.5273772305551660544 1.5846116651176185286 -1.0263946321085903879 2.6692368466642157898 0.93594243850956293507 -11.212601847531125543 -0.25097593163609016598 -4.1524480621559218818 -1.1941710773465039619 -2.0194488317653296328];

% Layer 3
b3 = 0.17616676597195526921;
LW3_2 = [-0.43577726001236394282 -0.63031644163776656686 2.923599405597030465 -0.084727010992637533104 -0.59379777118270971048 0.98164410688623005008 -0.67359454564079435102 -0.40708322072548913662 2.675938057009054738 0.49504334867189891956 -4.0879808289824612899 0.18783312643292868205 -0.22650822004105108931 -0.18425118345278207466 -0.48065049112773583495 -3.529416653245201374 -0.26479346719435548074 -0.54234975664143636465 -0.38377951760867151654 -0.14488611131828679768];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
