function [Y,Xf,Af] = ESPER_TA_11_Atl_1(X,~,~)
%ESPER_TA_11_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_11_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.80469446338174122069;-0.98993590580932666612;-1.5928055919882355695;13.504919450608506182;-41.883879121737336959;-1.8633498834519244269;-0.9379635077751401484;-14.529951640432617666;6.5900930698693525045;-10.770446926866206638;15.121230945717419658;5.9636808167722996643;-0.96026999301297943923;20.472087500215664591;-12.76061122420123084;-0.18563596828461106925;-0.93540036006930793455;5.9724442149412020342;-0.52228357240033440601;-15.397968386499645277;4.0973736670789699943;1.1855489009607114159;3.1664492592835169482;1.1967500723649093786;2.3520025397090322805;-7.5003735699793381286;-4.6759187138949949158;-7.7207723818510762825;-1.1020647630931692529;43.161873273251721628;14.008352576548155355;-0.82331722680436503214;-19.107386008580611758;-1.6670879897470476383;-3.0458024216907810811;0.45304191039217889259;30.115935793444254642;-8.4161968861909421946;-49.89270301376302541;-7.6369318793819163105];
IW1_1 = [-0.13504644567576654102 -0.0024260391459651029118 -0.32492610437555763392 -0.76552268248165844522 -4.3685854735079532318 -0.11216241266580796732 -1.1210199285984536743;0.051894146287906790793 -0.27386384528469659427 0.24248634520371259438 -0.20163051040335999708 -1.090179611456139952 0.44857398829916417249 -0.30651354229417832054;-0.0046096709070872887021 -1.8121431592513510545 -5.009496030798652022 0.30799423296051986476 3.4088497692577295339 0.32775201981174517663 -0.17776529763404025353;-0.16620689569898910998 -1.4420392547511478032 3.2852663590050594777 18.534495455981410572 -12.482972361125591831 8.5349583571769365165 -6.9833731478521121616;5.8236385694627381682 5.0074647188307661594 -15.95929226980548421 -13.186889227042131623 66.523435171000670607 -16.292765666070966546 4.5691183733767593012;-0.010380907743583817765 0.55666271089041519105 -0.58784989882640770187 -0.86575531031439545426 0.34763684113589149449 -0.31216067904310135228 -0.45316947263878160079;3.332422406939035131 -0.4338461453357593256 0.41222675106289113911 0.77954551820352580016 -2.7006295120342107552 0.12737780337085896631 -0.42600109919929274316;-3.9493325488800032907 -0.67809551127372902357 0.30669112401497278242 -3.1602580231989438886 13.107117221694451814 9.9360934209362365976 6.5967729475998968525;1.5312079088681658234 1.1688463456404347696 0.0094225166254451563075 0.22278945369927324882 -10.473267673485183948 -0.29807630881897106967 -0.36729844532938632495;3.3207576717582321102 -4.7865833531720820559 1.3154314433009524077 -0.22824851524518596779 18.867307249138193015 -1.524666095726615378 5.6208367750956282904;-7.8875709092589554317 14.708282505611883551 -0.3003056367367272772 -0.018476986996892510312 0.071265703284645862126 0.13710778953524763168 -0.28114128949138239566;4.4225726846568891304 -3.0707401256067248241 -0.57248497494886763093 0.062512563983127170109 -20.213402660304630842 1.7837144618244469285 -1.5449779501901323986;-0.61459398539723064658 -0.11610239603446693979 -2.2473023531277407372 -0.75399887555156852592 -0.98026231449879586144 -0.27846031686279631989 -1.8053442167369870841;-11.669359057032140825 6.3226542845001212356 0.76331331161014215336 -0.10238502727104450973 -6.1862493066196195812 -1.6725405105173074549 -0.40614046517985452622;48.462112607141115461 11.180664804833396531 10.20703827071324632 6.7362358945388631781 -55.686404502901936553 3.5090822449244711834 -55.536646128118903221;0.48269683833226645353 -1.4139959823137504547 1.7909555532402814393 0.40137488315108893477 -1.6923553227749612571 -0.31543994619175380612 0.63260093866112510064;0.11029798705158676275 -1.2998452814960650414 -4.4003455388815266858 0.18641083533050234466 2.7537432434160669104 0.22673425839510549795 -0.06030201440681336178;1.3056581898225021465 -2.8578770504098671701 -0.75663141054186489054 -1.651084086048409727 -5.17693739736433578 -0.70170373446532374739 3.2747902818522365287;-1.3179673221550092244 5.9040219394374728878 -1.4075511706675911672 -2.2446191484990634102 3.5320749903202059983 -0.79108837817750010668 -0.73590454621452749961;1.9674210930752920046 -1.7909774897023826856 4.4551797139221021027 2.970170821336862943 24.470439408245923119 5.3505202040160435573 3.905145359065739008;3.4710409730238764858 0.72015077910749469847 2.1268193996626689746 -0.46217171620484787109 -7.6248465458240204384 -0.88196191453888805878 -0.3590353387960970033;0.049561743188956022821 1.5153418811741186101 4.7781029001351686958 -0.25565261028496444329 -3.1597581961703462561 -0.27089020797217461256 0.08551783687696173919;-2.0879963857421173223 6.6113863316560257388 9.5479407513476655112 0.41596311834267002405 -5.9535804138178223255 3.0953260290594242221 -5.4374740066122955184;-0.37468547024094012166 1.4221192666378750236 4.1737276873633453178 -0.15754691044150662127 -2.6156439558651634059 -0.23954271454788747531 0.13222116808050884962;-0.37424209401615365911 1.6281294043232337199 -2.0304404713973349672 -0.28171372825420637476 -1.5618660516164157848 -0.15784920372829142066 -0.86119088729621651179;1.0074211631237630638 -2.287581825967128335 -0.17615590536755018625 0.45220569863937676303 9.3980877044454533831 1.0872699376391510295 1.6090504154243248092;4.9360875012094247438 1.888857474469133324 -3.2111951116729673394 1.0279804284837352757 7.1998690058288579152 2.819058733809674866 -3.8871283285426914134;1.0174135988084409554 0.96483489009477585441 1.53190474185604808 1.2301151638058351878 13.922326110147176692 1.4227097536370574282 1.5503792181317219701;-0.65011806829399898522 -0.12877225782789078479 -2.2131122890086878385 -0.75837670348454233604 -0.71745441104883567185 -0.24115104361359310237 -1.7737428725163519871;-15.301128531177635494 39.952524917703790663 -10.66620444650139099 0.99891014892690965787 -26.871499015963991042 0.37307240175444666974 -6.526838208883978254;1.1328055143736206478 2.3802945844054765878 -9.7471084556668365906 0.22248419884335590702 -9.6679377317706745032 -1.6360917801908687608 2.3499260935269421502;-5.215244683995764241 -0.79603940389653293774 -5.5944316027343603537 0.91822472992492865096 -9.9462676565697876185 -6.0956631984539884073 -2.0572831840366676559;-16.376089934292682671 -7.6627836583652388924 -8.5003297420538572737 -11.730585740096303837 -5.069285459489991652 -2.5926257951210507358 6.5681871850181616779;-0.027279959440777257901 0.54037715475700154322 -0.58671987626740718103 -0.88289325754119662992 -0.0046817663868459246171 -0.32297090955916230026 -0.49306351247825980222;0.99494660586808336689 -3.6158129890601178325 4.7746775659501574651 0.39425273801871485446 -4.2196198503961417359 -0.9411367690674674602 -0.82318111801695603713;-1.9994351621615833459 1.8995061217765236705 1.4906373909900929586 0.25922043563645574826 3.3669745749895145792 0.64547256405128949908 -0.03986171245277640024;-1.6811760017155172875 -4.2157016920550463013 4.9875740670796782084 1.247774494100500231 -42.804589660915901561 -1.7631855602951236328 2.9492957658341496519;-7.4625885846942061619 -2.9494623661744805432 -2.3492664078575624664 -4.1385986390028897119 6.5420963038007506896 -3.453708080061000274 6.119744713498362465;-4.3872455015898443875 -4.1574540264962687175 -2.322533605463073858 6.2697676162710500591 66.300781462786304132 16.479363211036108794 3.9972398049553938826;-2.9943061060825799657 -8.9348720426553764895 10.991858871661964514 -3.1406835363283720497 24.908287471545399683 -10.269575700542889152 23.333132021278171209];

% Layer 2
b2 = 0.63182292248775018262;
LW2_1 = [0.24045198184716107259 -0.64169455153987109419 6.4224893377849348042 -0.0014579353809344810546 -0.0015333777638511989199 3.7322187794882264456 0.051213653843084516737 -0.014685630187446193848 -0.059283045807847517539 0.016923734014273668358 -0.016632941580258232134 0.016494425383476469388 1.2041128271737961963 -0.30444609386698234799 -0.0003556073596807490236 -0.2892757978199620994 13.085888316970935463 -0.015531644683419779801 -0.0086543288151283998683 0.0059600313386444789612 0.016767964715676184767 13.672592768297503696 -0.012913648348260810608 5.8311204507570142397 -0.19756605252298550801 0.041548337949560906757 0.020127730500921595796 -0.026359419895991220706 -1.2262678076103139535 0.0044589195230776996343 -0.024388977212792654209 0.031393527489956947474 0.26746827554939139882 -3.7821732638731360154 0.043160001184591643975 0.069834218032277045607 0.0058983955140484572999 0.01163390777987660489 0.0036061443697994518404 0.0026810446516129502782];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
