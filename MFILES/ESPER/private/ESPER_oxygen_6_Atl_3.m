function [Y,Xf,Af] = ESPER_oxygen_6_Atl_3(X,~,~)
%ESPER_OXYGEN_6_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:46.
% 
% [Y] = ESPER_oxygen_6_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4280027593167357036;6.7579845228872228446;6.7392007334785795081;0.49776979579888058769;-3.2271002525102341352;0.8616798632786708545;1.7127773275597877323;-0.26875346814430645104;6.0931223435651480358;3.3273280499777841968;3.1453387008296354033;0.45347114003967786688;-3.2763940644369435873;-1.5251777129738037786;1.0336904523852468163;-7.7570470504952719892;5.4082128449438231499;-0.65236683711227161364;2.7447136832658567407;2.0917645252704821779;-12.348947509708802173;-5.950508391281201348;-1.8092356489663947716;-2.7576252282217512679;13.991402989265571577];
IW1_1 = [0.025451165633607220062 -0.49535208190790241956 0.055642465928490619786 0.21931112713355252475 2.1401567540321004834 -0.72361783783760247335 0.1782494627534089715;-0.69118078445297448376 0.82779284007962550263 1.041819791748177737 -0.72251812842954887817 -9.2861810222258789338 0.16134654240510701295 -0.129062179105551178;-1.1314753751831614359 0.78040279393396694285 -0.079458536979730223782 8.4196111698704818593 2.7404536011205515855 -3.5221477535505396617 -1.1474240654276852691;1.8731744344642555777 0.23306989006859538116 0.59948095228840847515 -0.10828884506862795911 0.93848714101114705244 -0.41406854481213517527 -0.45767637422882129217;0.47160378011379355812 1.1858154591681833168 0.66400084995975272584 -0.13020463724363437463 3.0932483265719525889 0.62023002207961208665 -1.1849093889174666661;-0.10384385212142917265 -0.31452190393739359875 -0.047011513477762029156 -0.99066173860407458207 -2.7563644586655278168 -0.58824469968460102454 1.4964496423620745613;-0.64891807326942485545 0.23247794554285683422 1.3361904835125890667 -0.75213577997680081122 -3.1883339880457630677 0.55623374977522777041 -0.86499623201630293501;-0.78212258030132675302 1.9107304390185257947 -0.54713789434949233748 1.2635134071677678325 1.5680333265857135938 1.8393941860326563642 -0.60451140949948656278;-0.74881115781974294521 2.7885961895819475487 -1.7363889074511644761 -2.7814645753009097362 -12.036005823838195283 -0.63454012404918247459 -3.6201325670686901326;-0.61182241235033896221 -0.89179294361943539649 -0.59763374288613768659 0.093412495290238081735 -2.0613870153968543164 -0.17189273036103133729 1.6981530140245919558;0.4579155983052429213 0.375989937633139093 0.60025049999908419718 -0.33688801323043582325 -6.0844491085920768825 0.42753861145558169632 -0.57871623120270188068;-0.56568351646939307731 0.3085164758462344281 0.70474510250433974878 0.18562700020433198222 -0.33333572693606555726 0.50629154040541746173 -0.2197962783818823429;-0.47088633488168235575 0.19180497477754171465 0.12074067830751437913 1.0104760519139348585 3.8053098974617691752 -2.0825082196333175588 -0.52109173468464675683;-0.25270650432730040746 -0.16162325738396360331 0.2571225066601816045 0.54217254905207057369 3.1643084570592159288 -0.64713246472041852098 0.58907584048651862041;0.82714082494035190418 0.053902660828890586187 -0.6662772217698582633 -0.18947569149202964089 0.54501756061600192815 1.5091377879151810504 -0.78625577206551156006;0.87402973364468694584 0.48378661987808035949 0.83505032617620078561 0.46932237291611467178 6.1476707913429269325 -0.60324227746558289898 -1.2023049683699786883;0.048773387232231429911 0.096725721596772853972 -0.84361980850805506904 0.58742229671475354458 -9.2383755434292300635 -1.1289948013296675633 -0.81866204335787251534;-0.33829169465496689018 0.10404472197816903856 0.39988279332695825241 0.034312713238481395983 -0.31346049620935195756 -0.68737670870951028679 0.27825519852857383274;-0.025871067218670308618 0.13561663980890464876 -0.40427460717099750198 0.16895343654755018425 -4.193984044639322839 -1.4971999887730256251 1.0487327105393866589;-0.65089882702451884455 0.41496761729439024524 1.3997126669961290624 -1.0728109292917877848 -3.7252221286317301896 0.46921154204306192437 -1.1777334135516985825;-0.40320315123928807122 0.13436023537852920251 0.83403085094928397503 -13.87750011204306233 -2.5154657805866587061 2.2017903290917089087 -0.4814444758909593447;-13.648485596367692096 8.9264324316275285298 -10.231411702356286497 7.6564339956845683943 -14.61616325377715242 -4.5494961279397436726 27.490132217764653433;0.53051778989276254794 -1.0757193216711136152 0.27593160935327876171 0.22176604644696723545 -0.017504057302776338673 0.19640741947271647683 -0.082910078251759083967;-1.947697286223888602 -1.4954067797122010397 -0.10879538235741229024 -0.4699255316369864155 0.48828399642646791445 -0.75286787917264785808 -0.21795522098204622718;3.3100997862919365744 -0.62013229842129180547 1.9781551589409163139 15.436889356032514442 4.6973831436887758528 -1.8437777536217183627 -0.44727508632972767799];

% Layer 2
b2 = [-9.2482629292571125745;-14.372448611589371481;-3.2461516692817005136;8.7696917716032505297;3.1932512375046036013;9.1296829226055518092;5.0742176009100914413;1.8977835428686431474;6.8021011703203591026;7.5752871347516999023;5.9632828029262086034;-0.48325941041426062617;-7.6810600687466319414;-6.5396156155745313043;-3.9274789240115928202];
LW2_1 = [8.6785944007206978767 -1.2337798595476765495 -0.98729351217413419128 -1.7298936332597913967 2.5531893651107053778 5.1476375853628670853 0.27560383262650967051 -1.140524661345287738 0.28995567053995258133 4.2389394473416475151 1.4125154041090508539 10.826389272167887157 6.3203460451821982247 -10.300426591990643033 7.1416558221881869528 4.8835607052177048004 1.44390684965500804 3.3788959914208143154 -1.12001519263985716 -1.3435890018226317455 -1.7492168982166922397 -5.3127782686618036934 -11.55128880272129166 -3.720265583442327717 3.600183058130105529;5.9565414118506874175 9.1991088430718352953 -2.4572314161163593127 -10.569851397450724662 9.8871109912924044494 0.34867224749100517167 -3.4471575161066150272 -4.7608357404530812218 1.4159697985272210463 6.7706423645905351449 -8.1307514390263975201 4.4774301225347272748 4.9895977904111576962 -8.5766227888664090528 8.1330342037763028173 -6.2069248079279937258 -0.83134688160111558375 -3.2634045905525628228 3.8765537480093863465 -1.4606326900804222912 -1.7148823772250425534 8.1740992740172888631 4.3339230276959304078 -4.2932711748468452839 14.129036624447955717;9.4032974588242570491 -0.99211145862106975279 1.3821514358386399746 0.12337490557368410715 -4.6350603352547601332 3.7907175082010051703 9.3050311599317101496 3.6854255644107918322 -2.0068879122293172834 -5.5804773127249713838 -2.7304853279458933812 0.95434687773742876704 4.1570651457801117701 -7.6450007569979323563 0.32260602335662569295 -1.8976060335443860616 1.4148612540525733472 5.4664988607457871694 -7.9772189017082029139 -7.0510382448668345035 3.5742352915463624363 -4.82666276207096967 -5.1418527628281625041 -0.68927191091187034466 2.4647536787514350287;-10.319277409031789361 -0.68801363838154305785 1.2440950450106271763 0.2434007525121112403 -1.9288196109793858124 2.4799555426928598934 18.34751850711741028 -0.55390298671228743732 -2.0192574379167180787 -1.8563198311722566292 2.4208739009059372371 -12.843241956004181503 1.9617176517941330438 3.6831889319602590938 -11.374186147956335091 7.2183373474097454192 -0.63668909780754512351 -11.290834372670236263 -5.0629984363018092353 -13.150777836863449366 -2.988815988610283636 0.57299274707992808864 0.54357062894021512811 -0.25747770651480711424 -3.4577297651219720542;-0.474338778387733917 0.73894572515891698838 -0.21761427346295558749 2.1471250888362827247 12.863494976759225707 3.9735071326658912838 5.8938950421412972247 -3.596146920092957 0.65542435077445015956 12.898307420996291128 -4.9052519821679867462 -3.2164166980226518433 2.969105078129719022 1.7761562277401883314 12.672730149699734881 8.9581700375538471093 3.3282244275921963883 10.701260006766926125 -5.7808809462482502184 -2.0426662715114658475 0.027639479223054888579 -3.6331259390354158079 1.1966889428831990472 0.58376060349604286248 -4.8807003806522795131;16.094423574206587091 10.798538460264634153 -8.8202404765000377296 -6.0186521821859715331 -3.751959344576475619 1.9125351329208033491 -25.960778365211101715 14.780142822454781282 4.2264510181883885309 -9.1579814483200792097 22.448552646867657501 -36.125326061330824245 3.5118745470447159107 2.8485665680447507242 -15.774836506466460406 7.046167248467812172 -4.875701228604274462 -0.49177932255851108945 -12.763611510197652166 5.8883761010745407916 -3.474972371824325279 -1.6002224104219273659 -8.0107783819219591237 3.6415506601668092834 18.157556861353516098;-5.1317127105832875955 5.1305841808448198194 -8.2896430433505088331 15.719596585537443545 -43.517698764269873379 -5.4429070607542282545 -4.6017196787712419948 18.550322157352688635 1.0930639294832478203 -8.9161219851059581032 1.4104672548077739069 -5.8576267830114332469 -12.090889750758138987 -1.7597014262048622513 -17.120046263261286867 36.288604690032343569 0.48818581902491181568 1.7160834129791189273 -2.1595949948909751726 1.4630899615837411609 -20.426217770547577146 -2.4109373956347694978 -3.2740528270634934316 2.1820294061315430589 -2.7561451774804721637;-0.0074106298389014727684 1.0462206244499481222 -0.9038758787801897121 2.1704106601484207673 -0.212239491570323624 0.17242444205233734 2.5377617380312753603 1.2122029595608947439 0.99378120123851876322 -1.9813303656568101996 -3.0463488995527514547 -4.7676657017059662635 -0.61736041766219207361 3.6576072625989008991 -2.6122974978241666477 -0.43740977304402961501 1.2693159579857926644 1.516624920248667685 -0.63464829521451382455 -0.91190831371663017002 2.3868340957203626473 -1.4896393440743256331 0.53190397527199873018 0.23811927217863998463 -1.0583911191392600948;-12.507459258399972413 13.937134373665472253 4.1619129602501834242 -7.5658065284503219772 3.3001439468532964838 1.3264060356465119384 -8.1193993806523767631 9.7153561071215506217 -2.3446979886918111191 10.144176339701115097 -0.82756690541702659925 -12.069750787246448454 0.4944116467875584453 8.6471642380669422323 -10.652118437417362529 -5.9276082792227375862 3.8968638014474836773 -3.6605895701328217129 -7.1858498496556979518 -0.27398028425796489005 2.0095934244855828688 -2.5912509121702700376 16.257647504709119346 -0.5515040795468314494 5.6825011318669931271;-2.6729494957836301694 -1.9510684120765009464 1.4910617602522133751 -0.1853074842030717484 1.5215093518884947876 -0.76701462779297890915 9.072615758554558596 -0.35758963185798331441 -0.27072112559014538391 3.1831062017445139745 1.4495036669531278228 -8.0183776556475727659 1.8422683016499274977 0.43241918446014376842 -1.376885624431858135 4.0859968118574760965 -1.628672829557392232 6.2307250978789516793 -0.64631463536833277939 -4.9941552304652985228 1.1051236805071891212 2.7322802842240832 -0.93036142024296730746 0.17068953057155505926 1.7235245884608463296;-4.0368693150417067628 -2.6277023092371822877 0.44154444382504492994 4.2819087223388176966 -5.8890111347231623995 -2.4472232349155631503 -3.0374812561571205016 -0.029155767552002262444 -0.16514963039873409301 -5.6288769780791421127 2.5250371605421428889 -3.3149966379036737152 -4.5448423509363395922 8.4216946774197847247 0.50828492491658883168 1.0947296746070702689 -1.5047904986473623623 6.4401916944342749716 1.8801228973398314004 2.553153621628962977 1.9630695154058839247 -1.5182330748811665444 5.1922951312813996338 2.3110772946934097227 -0.5611255947276274636;1.4860415910002016115 -0.50754309612861581158 0.18183942778438461074 0.81400194843827289315 -0.2052653939950144224 0.41866547886813471058 -1.9588689377566836924 -0.21949064665005926789 -0.059427579097406549313 -0.1520582585876162629 0.56753738999279890187 1.1119495862236694617 0.19920056162942872957 -0.97683421612212761875 0.87352495894131088061 -0.6212185186725649455 0.18816671015264418987 1.2006888262612034346 -0.71691208580278242835 1.3275416776565525101 0.12185796984097645168 0.3568661819905997179 -0.88166969423537455697 0.069329493959775417844 -0.70983657520954035469;7.7373876773551275576 -1.7484103738278642393 -0.028715798685803123336 1.7304384216833135213 1.1382162296243762967 -0.96018934753229312484 -6.5409948680165976853 1.21450551613605362 0.043960928681567285059 0.85245714229104041504 1.0594991972482898923 3.7089350358314447931 1.1298390148741530581 -2.4774138265404737069 3.9101611126409898667 -8.3078176177389959634 -1.9749134527154896812 7.2960122069432653547 -0.35063788277979618391 4.3715534989251256803 5.3230911249492081083 -2.5665268811592074627 -4.5136785519789439647 -0.53939675796138175645 -0.14266686448421031508;-13.140073583889520847 -4.3555658227320881437 -3.0411719167248749685 1.2519732024674357085 -0.17158605545765409639 1.3115759112023648303 -11.463417367556358428 -1.6390917942260596618 0.65104711596869679902 5.3073009617755744216 3.2902911119789224337 1.5967251648336362457 1.4493122743381856576 10.350625316938430132 2.7970379164553849094 2.0934333670559599483 -1.7287794939391800675 -5.8916236266902171081 5.060476313677461313 15.268552976263704224 -3.3463670514697843039 5.6888751863825186561 7.5919939701010523692 3.1601939427732554933 10.860203715399270763;-0.57698282261044930852 -1.8491408064323935356 0.94362534244291185193 1.8469587151598296781 -0.66059249894511828938 2.9861844946335414086 -3.667018176710119981 -2.1253328601477083915 0.53421248542087340638 1.0696434636067138069 1.9557044765365172445 2.7972855323915739589 4.0214355051626524684 2.5555123709827514134 -4.9536852194618026246 -1.149617016047457696 -1.6274613917149927111 -12.33708695394208199 -2.2177038320505264579 2.5190098586658784541 1.6499044698840321654 7.3355053208511149521 -5.8561451523753733639 -1.7975502615793594874 -2.0903289860143794421];

% Layer 3
b3 = -0.29358508207112482546;
LW3_2 = [0.098010907768882771229 0.044554809942404079159 0.031346278144261129073 -0.063268610853312201581 -0.048485730142378100083 -0.016019184072081884412 -0.01670181548597364507 0.1070113223205984565 0.031051467592389459665 0.20767171162068523427 -0.094228542079791255404 0.55130993297497654648 -0.10992886860027689666 -0.058489024600889075178 -0.17032295857483967239];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
