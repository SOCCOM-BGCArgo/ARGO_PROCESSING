function [Y,Xf,Af] = ESPER_DIC_14_Other_4(X,~,~)
%ESPER_DIC_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.95878503785144320037;-1.3001176387127686418;-1.9856248904892301876;8.3336168372103074375;-1.4825904094366921804;0.038480732802155380445;-3.3243555110503284489;-0.032362795012905037906;0.78863449322338097236;0.25146210433224236436;0.93172186900280751232;1.5153747604467362464;0.67747259075853549781;1.4129357247204228365;-0.14399041052651226358;0.87615199856972103554;1.1871005676731312128;0.2666259898879759227;-1.4800710973347861454;0.38079715285652598888;-0.45119904907917496306;-1.0503951695612756545;0.68628086989158354481;0.10930771109005572861;-0.29077385292521557014;-2.2240273976993925054;0.53358937965420616401;-2.0451981756618256014;-0.19292471086718515627;-0.37235746397095542681];
IW1_1 = [0.20985177783783096062 0.25752350558234471389 -0.83331413990237557243 -0.036413488667316848413 1.0713321244279780942 0.14808460288635252877;-0.054955674783815230966 0.4179543020436968237 1.4801772036017333267 0.14770198080049781741 -1.3576015292835161841 0.7342512847225586281;-0.34508453377883913094 0.24213776935286060454 -2.1014852320132506591 0.20731348755245948556 2.359333652880133414 -1.6639555129546284018;0.025123323088252727531 -0.35904506695710447506 2.9324485520235596958 -0.58169710212734593302 0.073282805029601411073 7.3368251861709428141;0.044508095942989572835 0.40715603679415507399 -0.030560040521940591562 -0.92004704703345785433 0.58693897763344360374 -0.90108446944731523942;0.53766912082700490938 0.24970007334933946863 -0.38609151602880026344 -0.10264746138540986609 1.1168020170625740928 0.2275191649602860966;1.1094463657951387781 -0.048892812126273950402 -1.3965559408712442391 0.55195927636505304203 0.8875533755691711324 -1.0381108295510430573;-0.023446578139286296943 0.22685196447626782001 0.41605969438289097662 0.20895696617056666589 0.95285857396689765952 0.19876193156932323025;-0.31688730401802128744 0.28670819679854753215 2.049097395848394676 0.20353963236454827856 1.8816767357031600749 -0.10159005140970353565;-0.62521512709350690606 -0.252908569054173471 0.59539621673069320629 0.21013515268931456936 -1.5423375181111615984 -0.37640836304319774674;-0.22308945892240708564 0.33931331013883203607 1.7883056442752531812 0.34004661128816943139 0.8544348380764386075 -0.031534260353771874363;0.032059368420860982762 -1.1925799404554460192 -1.5171634320216158542 -0.28945904122500881739 1.3721837038144912846 0.38804680480906322826;0.9202890076516795359 -0.10415087468902152479 0.18806570773527311879 0.22968041197650004848 -2.4111693399455771392 -0.63736245031888794088;-0.11359865741084003432 -0.42188652202840176697 -0.82929633771709876378 0.5266513474850083032 -1.3661186110370504565 -0.2651413130161940912;0.79218351160818745171 0.25553723836034919481 0.32570441469323313521 0.025052750960049004203 1.2040154876652218174 0.25904255746737686605;-0.20885227984869333961 -0.033583880273142761863 -0.60139945443566134031 0.86743567795963305578 -3.2162605518939231253 1.2202713848922135398;0.25876376222605457222 -1.4310162121591505358 -0.73462168608034728035 0.79178157669260762486 -1.7503294289677431284 1.9309228669905269538;0.1621548807319447838 0.21979279573931112535 1.0302762780311638391 0.23588853897412018212 1.0886411853834683239 0.20068632267071573327;-0.12844390852593379204 0.085812975254077786258 -0.39753238128821105635 0.40835946152966523526 2.767388903181799531 1.0517363327836084519;-0.17605908195084310486 -0.013535690356281380661 0.41999137288573035187 0.43698791710797829646 -1.4454467659341596608 -0.55616535625687124611;-0.37318478059148391113 -0.40012604474628726825 1.4240826640427044492 -0.9172264247606625176 -0.14077973266117013718 -0.85845088961411208928;-1.2306318054439480125 -0.24732797548318527503 -1.0405096385000873749 -0.26844204222916301372 1.939534897913361311 0.45841876324021529898;0.2520011954994453296 -0.37050646842681117521 0.17496939800246003038 -0.29633012244771600452 -2.8168768758393727403 0.56526190275167798038;-0.1097047647994614239 0.18984667424015930215 -1.0040360328628794573 0.38964108997100282972 -2.4510382074924352835 0.73365530975634207778;-0.096047408841087145159 0.17621813251503415376 0.18814734427394452787 0.10735608181669488437 0.91154021407127727716 0.36634640000221713185;-0.56118759212342372855 0.097740756338249384916 -0.87574630832950961512 0.52573602503220595583 3.9622905919988378187 1.8312884564898401774;-0.23180232780617859856 -0.13917254743641566117 0.36666750067114611822 -0.016515140501087405278 -0.53716181709802934829 -0.094544087975560728299;0.13993456488475547461 0.22302428921154346386 -1.7728604133281267163 0.12049390271589120738 1.4124919659101775604 -1.2823747066276098838;1.5867888463334656191 0.38969247289346148344 -2.1225474759582776407 -0.15826963271477761941 -3.7795408088901440991 -2.1040279640740919831;-0.16027385472216634787 -0.18952621290293514278 -1.3601809131901465566 -0.30291598481303178003 -0.99241416603733156876 -0.30367184713463107881];

% Layer 2
b2 = [10.0471795009424536;8.0371588362528214589;-4.1131108855387683576;19.525792167398840604;0.1606901468977911529;-5.4802189014610291906;-2.6018326807950331592;4.9150591633940905467;-13.88922146527209911;-10.277005215192374976];
LW2_1 = [-1.4292951180267030598 -0.24156701566550059512 1.3227940770582542473 -6.3024023846674159799 -1.2686777090843521787 5.1664446207057235227 4.6881573811206163072 -5.5900581294841238389 -5.7293648288780607558 4.7847187489431277641 7.7956565656459950731 1.2534089842388642655 -0.96336588044400273123 -1.463785566391923032 2.6373405912247882554 3.1404176121669413746 -0.49602685386852535254 7.0249372733954809078 -3.4020165340285641875 2.855011021263931692 -0.061734348927581103594 0.29779796588501028509 -0.63726924438358334424 -3.8408369922256588858 -1.7545689112199238657 2.6079820033318146244 -5.2967774776853771002 -0.80282254227893778964 -0.21167821644617643151 7.7331232368780238318;4.8095858721978004269 15.227924779129880406 -1.0043384811092961328 4.8615556104124539871 -5.3329877169576436202 -0.90593202779700732208 -10.121120516313295568 7.7585237238603559362 7.6579752669430121159 -3.0167538199875285621 -14.068148204124979017 0.17197104192488793517 2.3980907765984711411 7.7200706885644780897 -1.3023916155895047808 -0.86141971098195313505 -2.0747596034251865049 -2.9574272396819409892 -5.9763352233179665163 9.4818873309272930783 4.6359461228345431039 0.43650926803673290033 -0.99988533067810281274 3.7199109241823546945 11.51282177597699885 2.3522385918766670621 -8.6616145791034675483 2.8336081544033535629 -0.57120056839042898655 -5.4389996392535762126;4.3318507230006932929 0.41409747049657186224 4.2918106972457303883 0.55214175833029643936 14.014718657540454316 8.5368988388685540514 -2.9475458993463488078 2.9871754830696435334 -6.3106043229350960999 9.1449237577979598512 10.419732625006686177 0.30741032706831716848 4.4165958531161289002 6.3733067994217158514 -2.9953023442410913191 9.0218946843144642855 2.8112008136564741179 -5.3811874617655508501 7.3872834084919691833 -7.7000953085452357172 5.8755516524963349312 2.2260173095773869711 2.0543351896671153689 -5.3871997866888321482 -6.1393337887467271941 -2.2098483219546367629 -11.30108002257059141 -8.7146172246776654191 -0.7802745786703446651 -0.88811949579852222936;-4.1392001384321774893 28.443821371067031123 -4.6839919421418008127 -1.348384502837407295 -7.076260274606051226 -11.601286732901082033 3.8350406454333216821 12.890776039056758506 -15.400384883554789184 -37.803420154290165556 -6.4559911689662436984 6.0039130818186885463 -4.8481046327135581819 -5.8525538583779450619 -5.0440636462027104159 12.924348106423918736 0.29648945321141251252 -16.559976963983899623 2.9889373917119237412 9.7050453552232536225 -12.96645644157445787 -2.1837835750290928161 -3.1582837189909480635 -3.9750112590823816205 -3.3339033529153843105 5.5486857592495395508 18.917703952417351587 12.456968785697561941 -14.801173892877811156 -6.865593504861673857;-4.3978132412822734665 -8.8652896669239638072 0.25715096279160609694 -8.4702545646822020586 3.2534796370314591485 -10.571789372439049259 -1.274609583073132324 4.6056133251178135168 -3.6888860595753030225 -6.4992434967865611029 5.5138907453047396601 -3.1474922959282896073 0.11241782174055996169 4.3495866414487762697 4.8863267395911984536 -1.4230817534844337757 0.17597742381824038604 0.74918902863642011791 0.33554854840201631117 -0.50512646528943294655 -3.1134400426009216645 -1.0203577936132790516 1.5198942702137250294 -1.6655231203058751266 6.6748260193220119163 -0.8689336229487923946 -0.34821998328920189536 -0.63588879770484685316 0.49345294584604659782 8.7054666372017059928;-15.38194496086863694 -19.976497039096567931 12.706899646090437983 4.3761840066417647677 -9.6624033840903855719 -13.969227549667929011 12.634814962584886899 -2.4205430626296324803 0.73773841048862942582 -19.998573539805171606 -1.9466509020800646379 2.6855318264678476048 16.039662945863462085 12.097721229761980055 20.633136333180310373 -2.2815497668818580657 -7.4630024342089411604 -35.68971338585644304 -2.257417704489467436 2.438806708656563238 13.514082935480859149 6.5670123468689931556 17.456522646923833264 19.128616629182360498 13.733025081398086087 -6.8708629108894099247 -9.3840891204286371874 3.614038892227459332 -9.050651843416099851 -9.6823475567865244784;4.0956492817031415754 1.0038053947386387232 0.24654800448112854094 -0.11926388170295446067 0.073047699503991717074 5.9981498522321867739 -0.054517499889102490063 13.312900565834716815 0.30843856141894343548 4.9521078119019037445 -0.19974102966365869793 1.2919718641204209764 -0.43633803350330963022 0.60582621394110736102 0.903610600433757849 0.89898219165953863197 -0.126446596349658269 -9.288556578433068367 1.8123349486901243477 -2.0944786986541692464 -0.10193095108902325285 -0.30443548968396871857 0.91214892497759614276 -1.3813478310308797692 -10.752976295413363417 -0.48870693770492951158 6.8200533167996084671 -0.90020889384300817326 -0.00020865623297287643964 -4.0249996544799939713;11.488343958046334237 -1.3757083346722553951 2.1331421010441182773 -9.7401513071778911268 -3.8422438454621485882 -0.90443296058109701185 -2.0628690233529778375 2.93067554285065901 -9.9827625315456796073 8.6947233122119822468 11.171072089678956374 -2.0305715508134940528 5.1450598012066510734 -1.0546047024596980624 16.035670704609518822 -1.2199829837589051262 -0.40524744446362859218 0.59641457643704676173 -3.1975670136516805009 -3.8165060776871113646 -2.369520476312465096 7.3574436877281819136 -1.1703506221963539957 1.9919447434434556232 -7.7012637483688006768 2.7262971762208301207 26.61534204683181315 -0.0012752284204729513739 -1.4476177123137543568 1.3301243996074361142;1.9263025037471530609 2.8066348423768734399 0.70748635393280789874 -1.3211182511322197008 -2.0009413559493900436 -10.066651313120340561 -4.6495730783419375598 14.262844498698822093 3.0769847518129136432 -18.886490851623889853 -5.3614802910985526196 -1.556820450380628662 -0.22900390920320262689 13.096287264945393858 -1.5562717057107755547 0.7175515385470009333 0.95217612764622661103 6.5650078212114442167 -4.3776836211312613045 -0.15054648848190355093 4.5004067764528290496 -4.5586239150957474919 -4.4952032113168725047 -0.048163265583994863128 -0.31169672438614620669 3.9463327510696801781 11.550091999359283435 -5.185632264827730431 0.18545991688735574687 7.3485673681185197381;-1.0581669136799634057 2.7430897723928011622 -2.1857833570513958144 9.358473181644049177 -5.7341080357348541696 -6.5908720468704684592 -8.998006805542777542 -9.3949787670341908807 5.0691411395841186049 -6.2300767224287953994 -1.0444249842211192902 -0.76488382474950766809 -0.49991508102785919831 -3.642435095501102893 1.7725517896888400848 -9.9850329888910067666 1.3196914350816673078 -3.5864036288507565864 9.139504959824234831 2.6776548741023238343 -1.5403629653481178963 2.2467702652274419428 0.92077116260939428916 9.6615873693419658252 -4.7090093142793367775 -2.6921706927368642681 4.190731489319087899 6.3182229466908665927 -1.091089409469360616 -3.2056716046908473317];

% Layer 3
b3 = -0.16349199155282126417;
LW3_2 = [-0.26338330971803464164 0.20855417260857325723 -0.044989439534970913914 0.0051081794653184096899 -0.070428031887380754261 -0.0058325398714931002073 0.72345883839150404437 0.097693882733523904061 0.048000080999709766882 -0.036528875345341708936];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
