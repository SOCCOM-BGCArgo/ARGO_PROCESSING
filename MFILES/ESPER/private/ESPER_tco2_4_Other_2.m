function [Y,Xf,Af] = ESPER_tco2_4_Other_2(X,~,~)
%ESPER_TCO2_4_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_4_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.5192313854928674;-7.4680872356675403;-6.5188157844072236;-0.36750429674825669;-2.1467618359151608;6.7386338957888157;0.33225436377791517;0.65078272936081394;6.0358128195306096;-0.07822452923093233;-0.34744029414749789;-3.0987668634318939;0.026832701559695967;-1.9216477808596539;0.58918144880941126;-0.33466091139475129;4.1597901389131851;-0.50390461783079477;2.0327761955944155;-0.44792372000179814];
IW1_1 = [-1.5602954001912879 0.14188799457118989 2.3865476993224055 -2.3612359336190942 0.66685243537038308 -2.5813363111087972 -2.7253751409308347;-0.15428045827653983 0.054208464664079886 0.2098282944288451 -4.2970959094025716 -0.57919689433379296 0.61253477023310499 -3.5343468476372975;0.57003458133364138 -0.45324822887809307 1.6966253189252918 -6.3586149805874355 0.45996369769064194 -0.22780997409728893 0.81072872287422626;0.038368033204364542 0.00028164499163132789 -0.021154691335193172 0.026151378367477402 -0.5388680518304001 0.40667036034598908 -0.51535415522860317;-0.010752262341970823 -0.6764703106114931 0.084298978191669274 -0.75627640831119325 1.6216374084483214 -0.18779274269918772 0.11898751346448223;-0.16242949174391674 0.084745623946199958 -0.4563770456817195 -0.22136033932463822 -11.807697843001883 3.8700261255198387 -0.43953715184301434;-0.39690252539793985 0.25544851092255533 1.4049362069873765 0.10011721692689374 0.77898329994093851 0.77765208483370207 1.1362348714274124;0.091145726816146883 -0.1383567532967184 0.4828828741760679 0.22743291567894564 0.93371144387169314 1.4904573932227834 1.1805438628241864;-0.15978589893582495 0.089014511827457898 -0.82192997742681217 5.9275534414921696 -0.2058837154653379 0.08993613832009123 -0.77339207981002955;0.50130873100442319 -0.19024736487024127 -0.69640062909404943 -0.1198684815789826 -1.4480402254929321 -0.69289688905371738 -0.80583415212297826;-0.17559968080934257 -0.11674515622493903 1.0672980737799536 0.32252593695536419 0.85586860755111049 0.32949508726973586 -0.34600228775964997;-1.2708766747629696 0.68297385174450742 9.7640917232882973 -0.63060941112863311 0.52194102231235184 -1.2892943176072096 1.1891790520469634;0.042189719696696715 0.53496822962024981 -6.1208531343010337 1.8319091060342918 -1.4121325738516239 1.5072014020345388 -1.1789930427059292;0.46393663426017762 0.25368606450007475 0.015544844394984804 0.004915600000923062 4.5231335930392342 -2.4312444225334811 0.17175488515662229;0.22278662825951215 0.6353604330285646 -1.2184485435795696 0.5131868620054032 0.068871683201010503 -1.4372829921678862 0.061220611603759134;-0.0015458991305486015 -0.16875895263336047 2.4354749058900653 -0.14029833468694952 -0.51513522511146781 -1.0167675691058935 0.50361228516799239;0.14942082789232763 -0.21291587132798898 2.080236997486332 -1.534645930764202 6.5872232109777435 5.4225872622228541 -0.19895689197077063;-0.019071146335946539 0.017349812094333991 -0.17616231121927359 0.043500055208374515 -0.46949685406150349 -1.1189580262503289 0.82110466103790269;0.85692513090560718 0.71801471927937133 -2.2165428789756016 0.4923982290931615 0.1088455577165169 -1.2375247215363681 0.51889588579704593;-0.16697675717619415 -0.69492105910386104 0.88227921743958526 -0.89275694559167496 -0.38664215741354258 1.4306539861975021 0.70232037312152551];

% Layer 2
b2 = [-7.7740089178097431;0.82727332755760574;-1.3947163640485267;6.1505997886645742;2.4946172329592473;2.4999903905032106;3.8936765828897126;1.0681324055480734;1.9159380523954828;5.0389353684119254;-3.3922147733663763;2.6319577281286421;-0.32694857471790034;6.3082102838677843;-0.59602547264453387;-1.8771588858697228;-3.2054167162825138;7.8870759517052464;-2.9859177312372949;-0.4807178372116937];
LW2_1 = [-5.968176752440745 0.31429878450984861 -2.8726802601775341 -4.9980662204183464 -9.5187644457546963 -0.035227564336815703 -0.8109162751991239 -0.22157109069276409 -5.108408699809349 2.1030534758278554 2.5093596378789971 0.56459538476375593 -5.8590473262992893 0.31992525667638894 -4.3342161772416041 -1.305300170764035 -0.1406694409583627 0.67831199213309334 1.3331106627257019 -0.66576962230813164;-0.10981996730245287 1.956120268278674 -5.7495170678809364 -3.1673604840809291 2.0289030455695061 -0.77867524717363301 1.8437241109318596 2.6823976965611824 -3.0572810971551725 0.37339186059168122 -6.3921166918273817 0.9394383238552827 -0.30018405189426789 -1.2795107975090683 4.9339410580419578 -1.365946815321037 -1.1861382630374582 -3.7355938512047975 -1.8067487473564841 3.6773240764944553;2.258508179264759 0.063736275196833697 2.4540173848442244 -0.6441695455177221 1.3339681468833842 -0.99521827529887064 -0.49502889498729857 -0.31531085326244107 3.704323187371684 -0.78913315316926003 -2.2345343987924733 0.74904243062652864 -0.36605226296246757 -0.14440774956638897 -1.9440892936901255 0.090711780323233224 -0.6953801234591257 -1.5164889326525801 0.29460557944869958 -1.3582012393582898;1.9498280698761594 -0.70085230992118408 -6.9062011858437637 11.058716392268751 1.7903893532841546 1.6814170070450174 -2.0559555508514817 -2.1873563405904344 -7.6775166648453581 -1.2014988647853844 2.567455623692299 0.31446704510986062 0.17036690716873387 0.30732766934102385 -3.5730384345883377 2.6043143757574883 -0.13639237031865975 6.6020906037980778 -0.36063120555709577 -4.1993729817169818;-0.91191782397148347 0.35912676971548213 -1.7580269483165099 2.4870132684595294 0.52341076732568004 0.93931265463140623 1.5857873110398533 0.12559297881750203 -2.2140301985403523 1.600280867131374 0.36112195596532809 -0.18966082277598048 0.15005184270363323 0.1068550413466907 -1.3820353427117096 0.020195677345643512 -0.20460374473978837 1.0955434373538857 -0.58012995819145963 -2.2365971601528707;-1.7579088405054477 0.22251733780910424 3.0742370982473681 -0.60020338271465312 1.5062818024640041 -0.67166126972680806 -0.70807243773509643 -0.096379085944171355 4.4281584553137687 -0.91163763967734956 -2.3708823547293836 0.79706216293695986 -0.37467352517550129 -0.13823257224388907 -1.9556986213028993 0.21749541693182678 -0.72575432528528971 -1.5542021071413361 0.20234919232146548 -1.6806055984180595;1.4273112436105979 1.0596535344961644 2.3957530069808648 11.075888754164998 -1.164001364173481 -1.9669048227358821 -5.6973855871491734 0.56368254066119328 3.0972935800804327 -7.445973826081171 -2.5198629496450278 1.188612168245339 -0.37350279864843189 0.63378986986696595 8.3439253207433772 0.30914341812741764 0.10864021969392823 -1.4091750955324061 -1.852952051362879 4.6137021531248958;2.8899244288216619 -1.9833756189720777 0.065709675156103181 3.4779455909017187 -2.1626740969411018 -1.1777106966593485 -7.5227594303860066 -2.2347795384411833 1.5696080894116222 -7.4217658127827892 1.9826572056489618 0.94224242329865182 -0.084358954892350971 -0.99586702298392504 1.3679312204250458 -0.15325287222850387 0.62263797812972377 4.2911383488401311 -0.98038272224065037 5.8211999502787624;-1.2263059125237521 1.0561080086546686 2.5855031839762663 -3.7960142374292558 -0.79949984499726501 -2.0053367989196116 -0.78288153973190266 0.83637432744789919 3.2781164756341266 0.095685765302536641 -0.98940100412865972 0.16494246255304129 -0.930621548725028 -0.41983378722530845 2.9879165563548922 -0.92912058717183765 -0.55558216829092044 -2.882094695872639 -0.38174916535355041 3.1360222484438709;-1.0179888914220521 3.2859617454156518 1.1070070148236395 0.64967047405933076 5.8465517483521836 3.1207367544029361 3.5428267559186084 6.6651528117438712 3.9766000740107073 -0.57645603526071687 -8.1213399225701792 -1.5599123577482898 4.7022520469226734 -1.4111060119521126 -6.2112011301175869 4.847888008452518 -1.3121716421943608 -5.5089847836309751 4.2705077992334104 -4.0389042978239882;0.39873738568071976 0.32671225292039702 -0.66804898892688758 -3.1726405181874884 -0.83433701827163698 -0.46191497585449115 -1.0468267535650582 -1.960838344532603 -1.5538679998896527 -1.9395154848690108 2.4910011986696765 -0.38694261678821518 0.87789505625804953 1.742250356533336 -0.28937708900094183 1.0429484228169914 0.41778048360321052 -0.66484235981304696 2.7489643241908404 2.7261749858954083;0.67271524866435006 0.43244879637555173 0.33793024968226199 2.6133248825303848 1.2677576377365563 -0.29838807854897664 1.4079560580904356 1.2476081132582058 0.24744753881713863 0.2312362190344511 -3.1000268774142938 -0.25180136080115911 -0.16350677649858558 1.2708934685793523 3.8768732505528742 0.60162676909818946 -1.2093464849356301 -1.3969344569030577 0.42406698485382255 3.9445781789663794;0.25879020138749309 -0.49911957767155707 0.40905855585472928 4.4978362152254086 0.21923833961524553 1.5404544785351209 -1.7764104023980176 0.61206195939090124 0.33271229436984001 -2.1469058513859922 -0.98011962881131642 0.084838528276078379 0.21396631070645067 0.12361684283297772 1.2257939449848356 0.90269225702278133 0.50005646475757815 1.2316927225146295 -1.1488323400613121 -1.1002286654422646;0.65123867970527205 4.2030963381614814 -5.0111856760561668 -2.9172810660859865 2.8425521523043091 -0.3112241804263931 -4.296473642794246 1.8128684935726105 -9.6371722556609587 -4.0790893518193654 -4.1728296595349654 2.964569035073962 1.800553437579151 1.4902044728019872 -1.6884148928546656 -0.44646328269542002 -0.59450394420842578 0.65406914522393078 0.87889484858234102 0.3246671392828534;0.20658284730461546 6.5544039463821644 1.2707681926263734 -4.0003484983281847 2.3484538154078312 -9.7855831270607414 -4.8268131438027861 -2.1121208569724863 12.627259016828436 -3.6585855125278495 3.4531690756762483 -1.0368170123085094 -0.94511101036824507 0.46845036184816458 0.87785051065629305 -1.4216018604841032 0.38828815432782143 -2.4470412911529347 -1.7654620558156704 -2.0698018913490341;-0.36070432629938975 1.498573254340944 4.6988176657253922 -12.319555742707424 -2.348261173433472 -6.4259732444286373 1.9966649548686093 2.1243257784513183 10.225270222499887 -0.49972935854397177 -9.2499061328176033 -1.637834886894189 -1.369643356794102 -0.94893041068120898 -0.68843896482459843 2.8973775824450465 -0.9937971524442446 -5.5471237495433163 -0.62363236748748085 -0.27623844486589549;-5.0632148183341235 1.3523548227169242 0.16097957617842179 -2.017899555435271 -0.35298318299119924 -1.1563118554602019 5.1899272806397798 -0.20137584501357991 -0.72669966525135643 7.5183376661545394 5.4516937920506354 -0.25618475586125611 0.12095523852830421 -1.0947458124809843 1.9534632706824986 -3.3572402476952252 4.8106422214070266 -1.6925010202353556 -0.28532089200252031 0.27667332571478037;2.3009620966621904 -1.1115800187167666 -0.26485153867764077 3.3467441297759533 8.9731931547127921 -0.9463274498289459 0.68105051708269815 -2.7887695540093596 0.84463024182703672 0.7905418170342543 4.3846337595324503 0.86368674285482205 0.54241657289276779 -1.2827429100806211 1.2684782409403597 -3.166562989068753 1.471378004186807 6.6726957523158568 0.63648248819080278 1.4563794937464967;-2.471721998597106 -1.1962700125127408 -6.7518286089117794 -11.803790447154251 0.32367250864956293 -0.38239605193449744 7.2854442564466844 -0.19277050653269592 -6.6209004470862558 5.3379281791627111 -0.71885850000374396 -0.063714556663781799 -0.25430763372549631 0.37824731255389893 -1.4940181452596968 -2.7803021552692564 -1.1547419360359203 -5.9960674667301053 0.61424357229490001 1.1724765595933699;0.60099287579877381 -1.936014189522631 -0.38573606449833375 -4.9419946058336439 -2.4165356572118393 -0.33620332667555153 6.0302986222083117 -1.0404243695059621 -1.8883494782750783 4.0255510428067494 1.2415621245394115 1.5787835243084931 0.59974103619749941 -2.4760603994728596 -1.4355194927177222 -1.194104819109161 -0.59060050367628825 0.74956410975708354 0.12376626690340911 -1.8417954470260984];

% Layer 3
b3 = 0.088896725087579065;
LW3_2 = [0.1308195369828086 0.055146130991263052 -2.0417685164282258 0.11027607784889465 -0.48160483029390844 1.7912082194266765 0.046342167854972326 -0.089452923942147045 -0.28665090574973873 -0.021407058044924075 -0.17162860211304781 0.10002284439585306 -0.31370875518574415 -0.046256375857354773 -0.029877952981442139 0.17846176517123852 -0.19309853072529154 0.085137243347110786 0.067810572351299961 0.078017745088373683];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
