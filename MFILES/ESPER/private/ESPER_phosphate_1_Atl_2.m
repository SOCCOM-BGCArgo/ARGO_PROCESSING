function [Y,Xf,Af] = ESPER_phosphate_1_Atl_2(X,~,~)
%ESPER_PHOSPHATE_1_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.1921817117206066072;0.54795335020620172806;2.6560495279427569493;-3.3206183935255810802;1.0905925762261212686;0.11452968101818024327;-0.23341292578454714279;-0.53847552141791543701;0.3345509166517987576;-2.777994906665397945;1.6699226592596556618;0.17254238490611370493;0.63684205346616418186;0.39930042761512768434;0.75486190190909041586;1.2904443675847752093;2.3407803733050958073;0.97260268650373060684;1.6446738989197176029;-0.77015644233806945795];
IW1_1 = [1.9535022242020549932 1.3792590930566057672 -0.71336097160761702263 -0.78110478489771706379 2.6670388011785339799 -1.18325958949518939 -0.19267731436834270586 0.13586597393466215422 -0.30096473359718056706;0.25752709179879063051 0.27554202242380371191 1.2259739435584677825 0.19677558136638440001 -0.11990148111822510058 -0.17414163699326273838 -1.0403165446579862863 -1.0072680838336658393 1.0605941407503309826;0.2503391643570366254 -0.43624286842165616029 0.50039118202920274125 0.33452896740001375475 -2.1487763510748933982 0.51251498030734743416 0.19591901700153499521 -0.2374055700249610712 0.080198880740558683988;0.060762673151394913651 0.15247631002957609536 1.3741967869796389845 -0.011972152460594664633 4.1711673138442284525 0.34666152380565484759 0.79893049377904490349 0.15131450920735733945 -1.7431649191610287808;-0.54673023459683156577 -0.17670769817909159904 -0.043365030439831628306 0.33910840363804201081 -0.31890370103938114887 0.26333091737037023217 0.79681668856921927802 0.35756961891227623251 0.14558036373037258615;0.025034293899582699128 0.2373656471348845054 -1.0828058926370742743 -0.22838471848753277849 0.55721960727258368351 0.42741402834158370716 0.3828398985111216013 0.55537794031349285717 -0.29848528190617912292;0.20957192211759848033 0.73211115772043788841 -0.47522045898219694715 0.72068127778529300631 1.2682352956105551467 -0.22898511337044344383 -0.20320118798880748567 -1.0232117664688891168 -0.8523069951383719367;0.39313890407265666971 -0.30536489770527142085 1.8704078752200727909 0.89839457954420065544 3.0375322122231831479 0.45693815453223474154 1.3207304392859100517 0.031728246352154293453 -0.3269171045356075167;-0.82103054941156583535 1.5890323503708070341 -2.2469709185357369385 -0.16428416624636565935 0.00023327723429000107869 -0.6197500253272776316 -0.11323918433928642502 0.63179222991727790326 0.23325712859900352147;-0.32881944273051560979 0.75854506442378932807 1.4083871473106799321 0.38695566562344674288 3.5306222675747895856 -1.0566841011934882122 0.021470972668614047435 -0.21888057102367530771 0.46450644850168704147;0.28100330342808182982 -0.42772398329362337766 -0.071618049638346656383 -0.05098965536331340892 -2.7575147539604931701 0.58601435127971124306 -0.083390861291291834556 0.48204297305990795319 -0.23639742439832656107;-0.16515181501434220146 -0.21890913619695059888 0.56046644075003371199 0.3313815298490486172 -0.46801758264205944871 1.0131640786767861506 1.1958996380920636771 -0.078531147335233253415 -0.50961899955826206465;0.64362722100299885053 -0.50515127846589680249 0.72859021467840656694 0.67656510608669095941 -0.059211474052835173787 -1.1046390401659507141 0.10710732413932931573 -0.6610570078544454331 0.66885161236404266916;0.5234689425667164997 0.3779244158536775311 1.5400548387917285531 -0.061465221930877410317 -0.71120248550961706613 -0.040905564941785682587 -0.29409445380788801216 -1.68876727109064384 0.30020157891249049653;0.48871922829809733013 0.87598007803355681933 1.5270017512101319301 0.1480903982406719388 -1.7815087401793714417 0.21843423478918055913 1.0203127973017893648 -0.80808275532838291788 -2.1074844232369267516;-0.30816157374393549073 0.12714775749060625021 1.0236088566965353408 0.18180746992967425357 -0.82021005127342316854 -0.55703413206191387808 0.40898008640807498315 -0.59822047026843927497 0.28331334230666810337;0.91144254733078977626 -0.71090623960876853094 1.7843145563500490969 0.37091744921186908801 0.86350721609939207202 2.1033797702810841379 0.56271083476598260376 -1.5300057583627462154 -0.56900320028983908394;0.14346583506074064851 0.63061877077064831809 -2.4049320994999590084 -0.16151083283137793178 2.1875212967506607598 0.1698092611960092535 0.70160693661040918201 -0.51234521176715741575 -1.1978067523399362759;0.7617316475274201748 -0.20792515318425050519 0.25020846500627674791 0.44422139273599353659 0.52055870236114343275 -1.0608596167381394437 -0.44015849916186239321 0.50601211721856542702 1.8410152803293211576;-0.68860473141417943843 0.085681423343806253912 -0.84822895455298397138 0.20111611073239918368 -0.33965863173972266065 0.76615382013514599091 0.074185722232738990356 0.63098225533185514635 0.71822166703691070477];

% Layer 2
b2 = [3.2816244239562388785;-0.59954157833528221033;0.70459778452632093604;1.243639952304535834;0.70637366341912066758;-0.98823665471034582986;0.51831806866131158174;1.7661171461904425772;-0.57363521067914380325;0.83516696591345862544;-0.51158364821835700109;-0.4097629679472533093;-1.4211720123632816115;-1.0009170522801922321;-2.2403757261313845817;-0.89001435568181208602;1.0629517438233822002;-0.057795903750548618949;-2.0098034205661243767;-0.88103623324495095037];
LW2_1 = [0.17927180926763508495 2.6300867375305503337 -0.86110548470521142139 -0.69646504765482908361 0.64083805309214258994 -1.811283859622910164 -0.60313325365992076499 0.3680549336833492946 -0.61798706012336346305 -0.72140069399363337954 -0.245614915481508711 -1.032580041575230867 0.49952979986763101916 -2.3300241290628447288 0.087540453576637616839 0.24410196378080578627 1.6427909852593203244 0.63558591979631950952 -0.97341414281867100211 1.1013176628341481145;-0.15638592170942799964 0.98279760634463730895 -1.9389920939857359095 0.80682720127630636053 -0.64181812189847908812 -0.81235665483671315457 -0.28304259136072590364 -0.67637016828436713478 -0.63518975176892777945 -0.91729962767781825228 -0.97966004286698216141 0.49711576212094321647 1.4189974075158864331 -0.78493133461776032345 0.47940023327326641844 0.24993221607535492934 -0.55539960514852004803 0.64140998486552658342 -1.6849523080767745409 -1.1701571807352522114;-0.14190344828659537391 -0.48896812265134181885 0.2017507552280898564 -1.0163714486131856241 0.0047815797023876734084 0.16388547600530006809 0.19764295942644499737 -0.5718093351695389126 0.31164585176820036594 -0.41501229555539526084 0.034077327243860748573 0.87644227701705679223 0.23914670645910721114 0.43160906865506798447 0.067342908162283054985 0.78876293670425567939 0.65757717941851001608 0.88581739566232331473 0.52722584536620564766 0.63177236699579553125;0.12554223684742571443 0.76438579591461375262 3.2501278512879507865 0.10521640641219982826 0.57745666923740002208 3.0179483006524057132 0.12836748008058038173 -0.49540412667323197038 -0.044073605773269075581 -1.0202707611133436938 -2.6811765661851034714 -0.864788114913803585 0.7632339265002303641 -1.4250354208478857032 1.5232207644041906303 0.37371343124854639051 -0.55878515759599278745 -0.43329765498127048584 -1.1167470775424073182 0.41300372254994321963;-0.45624179061178349315 0.62666432314630993172 -0.99649777732759370341 -0.50549691054537504442 -1.1674877693384588806 -2.528042330933204962 -1.0222632731276037887 0.55701262552504759995 -0.66787641304613620807 -1.5261595525263460527 -2.1798301474537056244 0.8800094739135483346 0.079927827824239877641 -1.5993614862404454957 0.75856914963786470363 -1.6810829625500374185 0.55921195559460290525 1.4663640857623085889 -0.26704392811047661382 0.42448021243172634476;0.36865740638363703185 0.78441228161357445803 2.2593014992532465257 1.1906897140622358933 0.88782393537987014387 -0.11383353643088563178 -0.47010603831058173085 -1.6465812070914676024 -0.6374233476221495831 -1.3967658663387303442 -2.3364495877428805848 -0.22613291006832170194 -0.084381109949100155387 -0.23183064050745150197 -0.49042384393712606938 -1.3193881383637555693 0.82375596043020027359 0.39019556862427390298 0.22123967929309629188 0.51916336419815600767;-0.15071298101682545356 -0.018828414174154473743 1.8309289729132183222 0.19299773837645889385 -0.23850227778991808791 -0.7557365055047957636 -0.25900607541589759641 -1.2423758806199780569 -0.30803209625293648255 -0.5068094614384760499 -1.3127952791637655938 0.33290046691132840762 -1.1723127908319888046 -0.76253388000574817696 0.18964161261067061237 -0.46178807900615687076 0.017562799829635888232 0.87254317647241319555 -0.18536518364142950954 -0.17011393169892247146;0.010271659815754183645 -0.087772200673936512372 -3.0751193958277687202 -0.22751961622980235167 1.079147727041051219 -0.081711239961092377304 0.21178379701342217589 0.36480496288395974913 -0.72291131499656191561 -0.12884999417808465361 0.35841844602600675396 -0.41977689699200371187 0.16700555542562248168 0.12829761985224741316 0.0034713083446045508301 0.024722787337862421608 -0.54596148676808398115 -0.93544399541193756775 0.1002701678355128051 -1.6874141376321292185;-0.27152675761402994548 1.8499967345320953438 -0.43625198309785595541 0.04005064355854977276 -0.15692467432858789311 -0.99447480517671960065 -0.37151261730011114759 -0.0051636006505433804104 0.17346447020059427291 0.70288113584052425153 1.258028571707838994 -0.60300887409228820513 -0.42712352105803974567 -0.53365814621443596888 -0.19061143172161731929 -1.044099377945814533 -0.0046639534822109814105 -0.37063931529945909338 0.75891401499560440236 1.1912175133135460836;-0.48446959659681404498 1.1412635019307857398 -0.83029046006908668875 -0.14229133784946920716 -0.92966584535560570224 -1.7727197560732779191 -0.89381963903542549499 -0.12325972931451532888 -0.66195198800161503261 -1.3331915043585134129 -1.1314148272433948161 0.22881705141188479757 0.46602286748715138209 -1.6417342981589200246 0.69261299941837450866 -1.0518651518437569514 1.0974922831754918562 1.0927632805356919388 -0.40567440760856443571 1.58180854511172031;0.2889198258973858513 0.045418786788811553456 1.2371227522004573096 1.4295566362717915254 0.31742858207678747995 -0.38055782348024885797 -0.24570964332812569864 -1.5879782165901779045 -0.17010020025233865693 -0.49131194619239365595 -1.032892534372561899 0.22158641441203649758 0.23855571094711744418 0.40855985711306402886 -0.51902261791691384207 -1.1181097328940641233 0.11711007098348663602 0.11344468008323535524 -0.27839767478435645254 -0.11845678296001238561;-0.04939654462469075108 -0.22241341882584447776 -0.15504966065165226574 0.44167344410048164915 0.076328034424693921856 -0.11361947674155273291 -0.010180158533991175845 0.8426556601646968403 0.27719458927103585166 0.4575133974775361656 0.65021272637873328559 -0.43046748710347654265 0.47610427108749803216 0.10436949826841758482 -0.25079506974957460619 -0.85415864445512035275 0.080295051872505657231 0.52192259887682801445 -0.092542591147346087155 1.2583628467564200726;0.37255360339622062282 0.893188655153432709 2.2358525875905299607 1.0575739566006256975 0.94096977143549709321 0.35583961504858313551 -0.51086043748520426622 -1.4194139209172222937 -0.53198240420200371137 -1.305575568811756515 -2.1833667899529336509 -0.35396267946284160066 0.25730280047855125236 -0.22107324108069428825 -0.42587249991604125832 -1.1287857418515292451 0.95939464242654082238 0.45622892061034819866 0.11378386492809926256 0.63386590767361683518;-0.49372412277263932889 -0.12835455226058689604 1.6274040732294556832 1.4127465685322246891 0.10797242541290955065 -2.3844253531170740423 0.049115417360008281622 1.0747580416677005033 -0.85432953472266304207 0.096045289115938042857 5.2901039730405230443 -3.5078853316827673936 0.553392383140085653 3.4912509618011520196 0.23441632424359179487 1.2102758917942721961 -0.054768279104130193624 0.24571634296468441994 1.8303910915127323822 0.018506028351314658675;-0.36590282837595566878 2.6249599254600699538 0.12094827805837168877 0.21137313333843929519 0.35809260633409190078 -0.61040592488561917772 -0.28564015901713302181 -0.35125473016447750219 0.35020955098609068967 1.0238815729122243692 1.5784989489851755096 -1.2647430452653669608 -0.20635837831337439097 -0.97201586348079827005 0.044308184042387066537 -1.4728077323260686526 -0.070262750140487273409 -0.46400832624143417693 0.45921014733302972788 0.15144912659743883787;-0.13659070489494781753 0.36288528877388087635 0.61863724742133807677 0.13305114795733502531 -0.4780724953181129111 0.39944156699334443239 -0.5168831050505829916 -0.47396619907614684353 0.33419860639653692358 0.60919486216480644991 -0.42115609645988016929 -0.044265499971296105863 -0.38111063065471068034 -0.40156642499589684236 0.17342244036382714611 -0.64873989061309922377 -0.37065672344398248317 0.15094182952012138998 -0.47840925099482650706 -1.6835310632894568972;-0.79687772559726566257 -2.1274899536170139847 -2.0414323728509167211 0.74148753244799792128 -2.6760545088266152192 0.16398570890478209039 0.79652545460131929378 0.89943895380917537885 0.44705199565275671736 2.1027642254899538976 2.3081476441590349502 1.1835280199358142461 0.19333213243894015188 0.8475631862498306246 -0.62892091399396865548 1.918573604781749653 0.18095668511448606552 -0.58496179324908137431 0.92322952085019982515 0.729186086910963982;0.39860911644202545734 0.4893487833166843548 1.5863663891663797312 -0.020076756845230140508 0.11347493807204661609 0.910507268684273674 -0.00032342415461588617381 -0.95846744374740500128 -0.11807194466236234365 -0.92453069785346819742 -0.84314549324543430764 0.44945417573382812071 -0.48356983752866755655 0.27084800655897528499 -0.21888455629678948977 1.0905159867173925825 0.043642546044936787741 -0.88508293946048599565 -0.10517281295247589423 -0.73144354225421226445;-0.60155097161899762082 -2.362915108744783943 -0.73401801913440600789 0.72416695899411154258 -2.6849147930195345069 0.071484911977605480882 0.77041515502380264468 0.9182809531806701564 0.56767119569251334177 2.0037117020827248659 1.9905734686019878055 1.1151518916485076982 0.010214504468319500485 1.1208099108952112033 -0.71825317639634778111 1.8488936467735657132 0.26038907800157989891 -0.56044348124957144019 1.2382039551308721137 -1.3650369570463793956;0.020376058744480625429 -0.58629226402624556869 -1.7051776895056931505 -0.24338065870855030148 0.014705380622666852641 -0.59105897278989638632 0.18347378468442343546 1.3117693310528344419 0.056039554504246177902 0.57807344704392138457 0.74698374613800266886 0.096969281299678022901 0.43030443534323670196 0.57677882225645471514 -0.041627968379961008405 -0.18197875503526050878 -0.2177714504775129789 -0.42810440607433580817 0.59736075002560440339 -0.41095416636762560625];

% Layer 3
b3 = -0.42385458363188904807;
LW3_2 = [-3.9494126125141404415 0.42451663771328884689 0.9539175425706658551 4.5036781115047821444 -1.1115069886850932335 -3.294379939852378758 2.2555961226399978692 0.82554213720734204163 3.4244745411763677367 1.1358503005335891523 -1.2122100940807016833 2.0011161124330572036 3.567091273615143443 0.078239924473720995346 -3.0128086536352931546 1.1482130012945614972 2.0209266181223366488 1.8462735824214135949 -2.0024356345681213476 3.4882653980921705106];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
