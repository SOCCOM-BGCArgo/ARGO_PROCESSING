function [Y,Xf,Af] = ESPER_TA_8_Atl_1(X,~,~)
%ESPER_TA_8_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_8_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.4314806654442664424;-0.43217886267366550923;3.2313314617241268856;-2.4923282636774182208;-4.6256153710713734384;-2.3168783811308868437;-6.5713866155071425368;0.25200120709109058437;6.1502005360040223891;-4.3359888817007306017;1.2545194289074879102;-1.6822213072810439094;-0.57833302485583448771;-4.5403757549624215173;1.4695457653393044772;-0.93184758801794431715;0.1732811081845208323;-4.4733428790426312815;1.0299650999428131559;19.235459337122144063;7.5633355328071587564;1.1083162697486459436;4.7253891870647359852;-1.8128283113553969041;5.9866319164567611821;-1.6799044410659869087;-4.3373359244891220854;-0.77864092381526373021;2.8656819014605883211;-3.4367721445158490035;0.28915662258969659915;2.8266219239012260189;2.6027238945127524339;-1.4583633214902571584;2.9831382525907206293;-2.4309836672413713821;4.1131117263349530333;0.17232392888135242281;5.0939772935911475926;-2.7687616318653796021];
IW1_1 = [1.686808353767942803 -3.7832613474707699197 2.6486593992825566701 1.5703296068372061267 -2.0331358886580002121 -1.9162816510258897651;-0.34791783589542940591 0.55195104744809619923 -0.28878670894652258561 -0.29822482554637880225 -0.21386670897175480421 3.2607257985075337459;-3.5450063663437254569 0.25505730327950465464 -0.94570857110338657492 0.94154973923473539443 1.0004855609935578986 -3.7514017764279792289;1.2772060643061913243 -0.083855961672005693841 0.46781519517883646264 -0.11213186675641328982 -0.12649041031126945223 -1.7407113484534160186;2.8953495570826723871 3.1687585316471755803 -0.66706806848021482637 -0.50230919530827788932 2.565229170003875403 0.26679615225710695547;1.9663119340389791923 0.40826439193928548699 1.7253080181712463492 -0.54940563050136970169 4.9902880710980879186 -1.7988966110660642439;0.017584435485410797317 -1.5145276775800293745 0.93839245809225435568 -0.38418770406110730464 6.2529152864052042204 -1.7514321945150468363;-5.8928640401756782197 -1.891367961089784 -0.37645058271078313261 -1.0598671092137796901 0.31235166800470548498 -1.5708343763747194544;-1.9096319518359998746 3.6420254811497998482 2.5841843289448633847 -0.62330425508075448793 1.2338396167473086873 5.6033271972417377782;1.7596636615296525896 -1.6276178078987271203 -1.4265161754479218637 0.77159888084372807437 3.3321744046092161007 -0.93349737326727044717;-0.82392231612552557785 -1.6783666480434327184 -1.1141099080946581523 0.53378930616210407134 0.48159548103973731648 0.21474552331815088824;0.79043400684499931508 1.6471539909904371335 1.1598461667133188602 -0.45409981532143134375 -0.38332912952250125516 -0.48132941389337929872;-2.4675364616215391678 0.42782130734956907991 -2.3337652769068446545 0.9603543512732829468 0.009316981586952788677 1.8179652964354766631;-0.68340554063616731906 -2.4524514081960342438 -2.2365661235661651318 3.97900045760771226 4.7956328453192744732 -3.8409628199488934364;4.4407511838045694574 1.0486340999204746272 4.384179548240673796 -5.7991319352431709433 -6.5352211143324687725 -2.0234356839921305848;3.6902625225189020775 0.23262628993679174139 -3.0538901999660299502 1.6712695712498353284 0.9307811542239786684 1.4135147200182551774;1.2426105014319022146 -0.97499272199924891247 -0.93823823581708598596 0.4164046443647418938 -2.4327683163932594113 -0.26983339464778927086;-2.2364849620366871186 -4.3159105855357555726 2.4239187572682014959 -3.0970079813502948696 1.6123121359974907918 -2.3550427240698534881;0.42260191836952570865 2.7253504941303989817 5.9019035841149527499 -0.96116267802711274904 -4.0665156174850096704 4.1783525870223945375;5.4728199572032325548 5.481004155998989269 -28.870107245335582036 -4.1569440593468129919 2.9755287072016596284 -9.8786387912207231921;2.8212880982801560314 1.4313903475568772183 -1.1847563262571716436 -2.6250509849629692916 -1.0422917043526986891 2.2879582413837069588;1.7576235911014645996 1.5276018066409937646 1.6331439828861458174 -2.1500586791283269328 -5.6348758832335024138 -6.3912953855983252183;-3.5297859750165718751 -0.40864029054849476674 -2.7004280013677677275 4.2134755567332620174 1.0462510057714087264 2.2832302797601569111;0.54203413408722211919 -2.2927964059311864986 -2.582028205586276659 -0.18046882862518637269 -1.5702809647494506695 -3.0815115259842338347;-1.6479811357801883442 -1.7392341085919420518 1.6780844471799263307 2.9029754314071900545 -9.1258829548146653821 2.1382074636089267727;1.3980017459200506647 -0.11781833258998794522 0.85256996081826541545 -0.2033035979841940899 -1.6307319622986460317 -1.5912446006361444795;-0.38740464760055193238 -2.1438465306557494827 1.5385300591571475781 0.013766630826709948948 1.8828585748322788085 -1.2079933474291066897;-2.0367819659017434297 2.7725622272433660953 -3.6390416706260917401 2.5833455882985045804 -0.22982436139954276477 0.96466752851323300799;-0.045586132281231976637 -0.86503427863500725881 -1.3854382086340240043 -0.015338271858497856681 -3.502296400598646553 -1.0278170084281825769;-0.88156176504998251531 -0.08372847797592346264 -0.65945562212631247956 1.923777654823024319 4.155793537809726601 -0.25465139217697230212;-2.3785985800634126264 1.9296016438582981323 0.34334219459011416919 1.1464569448616390712 2.8213217488362647423 3.962304663667189697;0.99920770959332516625 -2.2489194748495071607 -0.88377255398821408239 0.82047954003253653621 -0.038878158112288417614 1.696644600418437232;-8.8700649779457165778 -2.1982923836416139451 0.078407172247324158354 0.14904925107274233365 1.6971166374456425618 0.77225930804773734728;2.0865180699608059101 0.63702287826475778587 0.81750795070839021861 0.54511550509190087599 2.9982451085399239865 -1.9208187879214537741;3.5017668314678056518 4.9216560934020412432 1.6205598268323220257 2.2622557683793336203 -3.5367561659195456691 4.6390061107606008761;0.55219796428469980487 2.7821401185062510919 -3.7264337817604160641 -0.54550254837283018716 -0.32520571461724623319 0.25585407090180350975;-0.021470367197873426596 0.65695422953002147182 -0.58923758157696082272 -0.067546874137377574399 -5.5073881925046626051 0.26639622399139245568;1.2012181245569149013 2.6664346368051448088 0.67859166420601346736 -0.60252709259739223313 -1.069189898659624216 -0.017503029786332828521;7.5832164210570525142 0.7293778632367055037 -0.26925524493783903335 -0.09655928810652267269 -4.5026448644216827688 0.84317783640962684633;-2.1329322474141640953 -1.169746783772300347 -1.6775097190168712924 -0.088098061671652530547 2.3515256865401852338 1.4740810302440576773];

% Layer 2
b2 = 0.30594124423349228215;
LW2_1 = [0.024868330981178982803 0.030002029858486437691 0.012603940639056052109 0.38992985182671846545 0.045852888206829256479 0.13292666413371326262 0.086727233926532518171 0.013373986098861277705 0.011208498764016996269 0.091464332480353405241 -0.55020643484339726292 -0.5238589651752373344 0.10993705559707880881 -0.007924513284554976153 -0.0060452207005803173037 0.021109273077987204814 -0.2296587755885982074 -0.012672081688374782493 -0.013050721005481016185 -0.007845233278613198552 0.066114553275945620037 -0.010198593268428134476 0.012337804537035118591 -0.016326680224359322452 -0.022539829905326186354 -0.37929799888877174796 -0.059064636823155519663 -0.024209050365954033757 -0.11574247378155137767 0.042657034198150110826 -0.0066239510195582156082 0.057242818409092302567 -0.0059128332101916619701 0.079862689118352384043 -0.021368624085835338094 -0.0095511507945620199161 0.15588406677287303115 -0.11675483512292587907 0.008017840603484970366 0.077847212468007298547];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
