function [Y,Xf,Af] = ESPER_oxygen_12_Atl_4(X,~,~)
%ESPER_OXYGEN_12_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_12_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3494861076017341528;8.4708472416942921512;4.3492254378937289516;1.929708245485207696;7.8488693152939399411;-1.5752546473764923451;-1.4459304659275318272;3.7622419472754660141;-1.7256694596610024917;5.7026297549139091103;-3.5167050958103884817;1.3766581760423552971;-5.3866504227101188462;2.5029062561079640226;-0.25400384256290681195;-6.1908278773930423;0.14300449198372894299;1.8045087190003676891;-5.8139612898386321405;-0.0018076065894442952531;-0.9144316298403546428;-2.3172740915287830532;7.4216393853864817132;-4.8928904493067406634;2.2036106337781391495;-5.5325153920302714283;-32.334464856225622498;-1.5260847105081951636;-1.4218062078094630962;8.8549673001547599682];
IW1_1 = [-10.640862559994786807 -3.1853106861266811123 -2.5682292446441992162 1.2147505071317525882 19.801490858812307749 3.611950835579869068;-2.7323421975291410924 -2.6617917555339616342 -2.3200529708179615795 0.34444589779394690909 -0.53065043790158039627 3.1761608515449335499;-0.25903349514870904757 1.1373777623303202855 2.4415709335084625486 -2.7547265980580157851 -8.9243646947507695444 -1.1085044920549795844;-0.25527891121464674207 0.19344828698114349685 -0.77962728051787233419 1.0963068331898120356 0.78196254910173945696 1.3054106405486800568;-1.0913981848823788301 0.69440391544105706245 3.6783171775169707374 0.7035511651684586143 -8.8343480921798747119 -0.74040560456819415336;2.3327455429954566668 -1.4314683688037579401 -0.24109519507172186281 -5.4628386167763736125 -6.2559651853380771058 2.6256673435441801878;-0.78062352297217230124 1.5478108511912149758 2.0274749546211121576 -1.1871986645028176355 1.8488198217847651161 -0.90478509329883149981;-1.3610997263041169081 -2.5595009394300416439 0.64093533647052081115 4.331805650548020914 3.1556882934926311357 -0.025186777304559544721;1.2896715866234360615 0.54184865982847596477 9.8170641626717074502 -1.5938826715969367509 5.6541393707549678638 0.066211430863444276085;-2.9282194427768319933 -2.6612397005574144337 -0.64206636894796631498 0.23909085085556641692 1.4720065112878915059 2.6584274582189602043;0.84126997022980998242 -0.97750738792923685949 4.437743400724857068 -5.3357543565727159063 -3.7855764895127008707 2.6932489158343191349;-1.7525524519718185257 0.060247869736688886011 2.4325438470176212746 -2.3773262618410822 -1.2737676752055910878 2.9112613917586425138;0.86435585064081699169 0.90237146809718460361 -1.5730135086118448573 2.8554467657254578583 20.705292654437766231 7.2170796113059711985;1.906379652985890738 -2.1357228157854986073 -2.6860954718005776165 0.33480007021651314592 -3.5993872028126880913 -1.376407503374546426;0.73152571852882253278 2.3322620623829930508 -0.08285987265905396526 3.445939428767138768 5.294096637496075175 -1.7089814239585814359;1.9274647435817851004 -3.1119069716689193861 4.8235838885063557768 -3.9785351763618983512 -8.1451693086187084702 -1.2095054508081024558;-2.4523727520003433256 1.442566686706494572 0.30481472198128189977 5.5879747339181227161 8.936033956195522876 -2.5438021051741319667;0.35753444014735336065 -0.56111744618106196292 0.81775735122048420767 0.48244894986061981346 -4.1902831498506225572 -1.577398876373885539;-1.2321257956214879403 2.1700246807108110048 2.8000010311909284688 -0.20569443595600075958 6.9976775156940345113 0.938598332315748074;0.73621384111316778842 2.0486425733542636962 0.16915881262560675258 2.8387931425328289947 3.91838463698015671 -2.3216334490509344946;0.58388420405586649586 1.8477012860132542293 0.34011374619236367511 1.4307672761845391385 4.7431029010485197261 -1.5026975783873997017;0.9515502851945314422 -0.64325602768047451807 1.6748438835705314887 2.4836991398935293063 6.5213693455834924606 1.941537620657074692;1.3179380152673054738 -1.2148691580413712998 -1.3984943757096759409 0.7543461347162283559 -5.2091609067910269459 2.4725103935216048434;-1.4240990185020823144 -1.6841317316295660866 0.52620687151548184435 0.40792420819406338683 1.2623470486873924479 -3.6342092854072900465;4.8659604334584969365 1.3975674017355397272 3.7482874435080697495 0.97352620852733517953 -5.1798831331550481138 -2.5500349928209162798;-0.33572920383120746779 0.14711149855091601446 0.76377888963477535977 -1.6428909293133453495 2.7528852482521850575 -2.1591907239341616709;-0.66301737326091370051 0.64778253581061417954 -1.0869249340440911844 -32.473958229736922476 -4.8489361314615289089 -4.1246240810951144695;0.38807371012062752413 -0.20648460236734567097 1.2204469930063275296 -2.4099594574805029978 -1.239496672892926199 -0.37553468182181903856;-1.615431887875379946 0.57858405382453770294 -3.1154639704698388059 -0.7190677336837545397 4.1313208650404131816 1.4194897800795109877;-0.1958970165433018551 -0.9465372736741584081 1.2839765601694068664 3.3319685619604704208 -6.520920355565356985 0.90302875481192768081];

% Layer 2
b2 = [3.2151726289422875027;18.811842563223347469;-1.5103357678873439163;-3.0956662321654504488;-3.5743188817665640933;5.3227244283237853395;2.6654366394667521334;-0.82012981488248637429;4.1285864656435418141;-6.9252144332647240788];
LW2_1 = [-0.31231572948050972949 0.28875891452978835749 -2.2878388686309758526 -2.5264424898863229174 0.036262062885009896385 5.3618284324866598567 1.1721825997681192266 0.60838771779649425397 0.0079662153222244246747 -5.3219517012894774766 -1.3267959639748665435 1.1452526905809308211 0.25047589018758908974 -0.17253552257206092313 0.24858637907668276745 0.95716950849700677129 6.0214555634518802663 -2.0153534000206256849 -0.42532520356406100515 -2.21116847394484628 3.2681447557941671889 -0.28754949798953655105 -2.4807732526792820593 0.35240015921664274989 -0.11727530579779438247 -4.4839448158414763057 -0.55803107968683129947 0.66432137037382588129 -1.3331037340049383122 0.38878340707658137765;-0.12202037013113710417 -6.7538227683605116525 -0.65483388467509973108 3.7256537149700932332 0.068036484454486692575 1.8054362772013174965 3.0643034058355866911 -0.34443987513675788925 0.2526338210077838653 7.0976201398771605611 18.329471864834751216 -1.8650004910460826757 -0.44099535104988557555 -2.3951611860775345875 0.061747249745440060953 0.66283806603740180741 1.2161361366852876387 0.17813210748949392936 -3.9205154005134263961 0.49077044257694468765 -0.85693578137621706503 -0.67340052252569460034 -2.330985253419449954 0.52968312924468863301 0.038799846852776417871 -1.991209378026834953 -0.3152892044605259958 2.550747729008830067 -0.21464124871384257509 -0.16772796194209688148;-0.85279961383517610685 -3.4908472780819761461 -2.3038886686268118531 -7.8189704417644856349 -0.30555253926649256213 -0.098491811131163634063 -0.37687444224099919676 1.7116261243966659489 0.010260751307639877361 2.5947142969720320416 -2.2872039104135248877 2.7611163440370938282 -0.11578515314535414715 -1.1230028148034321145 2.1181831671838224906 2.8237171482333676131 1.9729740082545474955 -2.8818537253090212857 -1.3170097690140145641 -6.6299119859741004746 8.2630757954427505041 -0.66045337658224678723 -1.1383294484728971874 0.35632524661882947203 -0.61848961670573243676 -5.293809927796605308 0.097516946172543889082 -2.2808532379078698682 -3.0323291519397219673 0.0070776901385140589262;0.071967434070925678791 0.7193783990860735944 -0.23485229089874914976 0.081255746904983702783 -1.2494465256655811203 -3.7374146066212814432 -1.1059887596479847094 0.13323596858769359841 0.68423086367100849348 1.2298007695181563115 -0.38126341092393400967 2.2691270391588242994 0.69383168728407784709 2.2200759512403536178 0.86381902177611658011 -0.26799105206279533187 -2.2727718243430641287 0.16373611754379813199 0.66958449791956864416 -1.1391399708635721044 0.75159698506618910496 0.38007651001950426561 0.42158016555004668158 -0.98538139333669805264 -0.13771975918686552021 2.17267861052420308 0.99778199400839528987 1.6193855653328657063 0.84974369885213019149 1.5089171502138478687;-0.082075876074678866257 -6.843976763424771903 0.38751858927695237433 -2.6634734577561696156 0.90724482928136118698 -1.9234530777922174138 -0.76115756480959417818 -2.0422878299675959468 -0.20383979683117517401 6.3120338673148248532 -0.55951323216496373636 -0.1082694323720195112 0.11326798748820011975 7.2803774820619597818 -0.3442549667910865252 0.91775840390126695034 -2.7767476110690534341 -0.96445073948229842475 1.0802365629968933014 1.8752382088405639138 -1.5193834891329540682 0.20625383471976349581 -4.6721713262519566356 0.39465602312260933404 0.30393587073924521746 -3.183051556617463973 -1.1229033710707294613 -1.8657179722270393896 0.52041558890978234508 2.7456119354354933115;-0.51672156792024226402 -1.9192320803480678038 -1.991262892831071607 -0.003311085597992161067 2.8211663461938019104 2.3437249618275548535 3.0084444294834500333 1.2390641075039090513 -1.7623517636252523655 -5.5607597058157294256 -0.94184968917519817921 0.29293173286160711921 -0.4453794250263543586 -1.5358056636079078228 -1.7634295081772985991 1.0258664872109319877 3.8442085715997014184 -0.19920253275511823343 -2.903480662243978383 0.88781099937770890929 2.1543630851501518464 -0.15184288523580452557 -6.5410937821374375289 0.44614796417208790746 -0.40606151727720313227 -7.2906647366642838293 -0.61038986499905156791 3.4245963739024727346 -0.56268979494053417145 -4.3924693750392735936;-0.19655394498978598361 -0.82943377619804914413 3.8251719199152374173 1.4936462429663743823 -1.1577921114142279979 0.88474441259159630757 -3.8663700894624666304 -1.0688788162427087514 0.43254385718492216473 1.3337833065988395909 0.10329235916462718714 0.83283305030712861949 0.27586608729775574655 0.15410551412793410675 -0.25119071157275846273 -0.6162325812741032971 1.3055429573640491281 1.1787784184069109994 0.29767842667135951951 -0.074932373319228681718 -1.2467450200821050821 1.4334862881848542404 1.1767538171413096659 0.03633747208409016799 -0.033364012047854142706 2.9880105167503625552 -0.057680537334445183828 -2.7539379071425824641 0.73035170498523760418 -0.30706020526936050885;-0.11294446862980681012 2.8682923848865926608 0.214249063760076075 -8.6326032158901160329 -0.50724161073602491712 -0.24507001755256985209 -2.7905588142677051344 0.2164341964325224299 -0.17799282168998734055 -2.9442360365732676009 0.11010708343501612871 2.254811017742338386 0.37793782643806467236 3.2438166039979972055 -1.0202396001188558383 -2.5364707087693640908 -0.69790176235933842896 -0.84770395587137570281 3.2311596450621342669 -1.0514082017181034523 2.4417290254897277002 0.77602507662411002176 0.7273688402510629647 -0.68631352240801302145 -0.11077065422415410811 0.23851583515551047499 -0.023070895844878952508 -5.0679343348004177727 -0.06460970950136560309 -0.070203067907707750184;0.22485310461958799011 0.14833752509902548011 3.6465165076954733081 2.2675399542568679401 -0.21197305794136206414 -2.3293031218604967059 -3.8511483283175524939 -1.188315722098138183 0.98274530315869557118 -2.0443368312476213333 0.088575359812870305132 0.066623077747677422744 0.27008010681635830075 -0.35101337675896998602 -0.076378783666551638976 0.81513683232860922878 -1.2759974033717962349 2.935509046252419374 0.49235725202540464585 -1.2565123421279222882 0.73906701729992341221 1.1336158981008805924 0.95687018659558087386 -0.31051940070754874279 0.074094239549427065583 2.6660010724451321806 -0.042535892277852246912 -2.328531182007615552 1.737968601001959712 -1.3579810129081464343;-0.35077655130958340646 -1.0613402650109953207 2.1168068036272655874 0.93941240591916042035 0.65716104433887723157 -0.06490183989662891284 -1.4397209240698554122 2.2199326368344167726 -0.24701786572264844422 1.3830994671416736441 0.46404221121241367998 0.18586840065363072205 -0.66640143398115347928 -0.17371844066855351985 -1.7055476350519505058 -2.3096683829954764988 1.0320481887215409156 0.76509358110983516355 -0.12548823762306118845 3.6688680037273431189 -1.8630215963036296234 0.090812040048092526612 -0.49441137249712518997 0.25911630105289545911 -0.10699676149136021219 -1.6554089765360262554 -1.1694448901672243046 -1.4387240909517404752 -0.82883221056861189346 -2.1001962586484479445];

% Layer 3
b3 = 0.234596777301727899;
LW3_2 = [-0.34890197300006348113 0.6281229207964144079 0.16511553735158837619 0.19752172541760756874 0.32182119293160932338 0.20919431933655746603 -0.48350347367154372646 0.51040793049820420979 0.31551557447639461129 0.35147883486572145673];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
