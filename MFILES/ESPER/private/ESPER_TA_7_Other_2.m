function [Y,Xf,Af] = ESPER_TA_7_Other_2(X,~,~)
%ESPER_TA_7_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_7_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9089433345217738935;0.15145737405176012969;0.22043139536862127459;0.23656669145693698386;0.9949671101158356068;-0.062165270785038070911;-0.49910914709482995244;0.91441792031605784175;0.6778334018882313794;3.9402845837648370342;-1.4594588543377939871;-0.42110286045929679055;0.56082134267720262777;2.0635051393406165232;1.3444376243953179983;-8.1667974721985210351;-3.1207621016600701758;-0.98908253400843892944;3.2456118052506925942;0.51390563053273341509];
IW1_1 = [0.31968350113438881444 -0.28497202991058312449 0.071938987630869699608 -2.0042283373016429593 -1.5277530211289200857 1.7009127018386962504 0.59708607375611366663;-0.079389222530566946889 -0.009684135579966220847 0.64977811747964742128 0.01977723062519799388 -0.064528348714927574736 0.25199456247939261422 1.2391192134679951398;0.3462189475129320293 -0.52082381865602345172 1.3702606260535872273 -0.47556534505427189297 0.047480980219538178322 -0.32984335711809525948 0.0030897028003137381839;0.084681015337842641122 -0.0074564091353350424318 -0.40937907838855225329 0.23371314508672300092 0.4057287475625879769 -0.20095420850042644556 0.015333566970768623336;0.046099276540413243464 0.35929281486034225779 -0.47417019836817164702 1.2645889213311720667 1.9263452663847220325 -0.31162257176673519021 0.54509137078679703592;0.092354405134128278454 -0.065658718327255644054 -0.66769422903946373804 0.32459923467101831074 0.18502094490666687321 0.13950093724842654863 -0.13662067441830805237;-1.3477202340626099897 -0.28630408024480130669 -0.14632988899244864234 0.46566760141724927724 2.0548040084732051014 -2.5626453496850465363 0.094267552136890725434;-0.2063255747783910854 0.27869652911464809497 0.51303026032332577078 -0.30484448777780825957 -1.5856559884407293026 -0.15011202895507380628 1.4959757687929502445;-0.20412057082433643362 -0.10607095044297487618 0.96888055193718458646 0.65863260426944814085 0.57898139062569919933 0.70494816951888283896 2.2178455961270056029;-0.09777408066847281809 0.15685857682666465296 -0.755589441450301047 0.93005927158851420256 -2.9166006449472878792 4.0792937314123189907 0.2142652168924625844;-0.01370165632897601786 0.17465464905061839351 1.5748187440117993319 -0.9880802793637089021 0.34318594717701772501 0.26042389097425816535 0.098365322508799965529;-0.10922114167202839896 0.10217834129436483004 0.70284831734373742762 -0.22773882344753892948 -0.35643195888413298222 0.50967679272958887893 0.056460662522174222266;0.18717854130531319523 -0.44259248796250022506 0.70917455274634277895 0.29920328014952457529 -0.60325349101036462862 0.081331218065091692715 0.66789177719299686053;0.43710536589999304802 0.26175195925940331065 0.46108530706874090166 1.1300766076648465219 -1.8152928698048715894 0.43848991147786842149 0.098593572563678108511;0.48288423966942806143 0.19999487973216875658 -0.3346300448325943977 1.0243926957230462538 -0.56093809843905229062 -0.15618359140398535567 0.54115597553369076955;0.010811332394130792126 0.065925932939737141858 0.18917239134473767814 0.33098691756669540442 6.8303903576536146858 -5.8368656237000964282 3.0588783842735951524;0.0095456129461603880793 0.27951576355910839888 -0.22538853184601428947 0.43394550917229568476 -0.32109113592556853822 -3.7064312261874001742 -0.50022959790200205443;-1.3274375636363071607 0.85633330741835911315 0.058703371880416008177 0.2800900776902113809 0.91620101534321829462 2.2411209474223037219 2.3716068994966232886;-0.2875420684398456439 0.48177683182169123155 -1.0275221442629305368 1.5045216552088038764 0.66873954961109460804 2.1496633978788266539 -0.50336783147741270827;-0.0091101038163614572046 0.024139177013875467992 0.57957519463926487902 -0.19074886618971986785 -0.9581938093878499263 -0.13310541092640440497 0.71320606895267379954];

% Layer 2
b2 = [18.355963272682632947;5.5863175874282164912;-2.9417495162714688561;1.8057117506409665619;0.12564313992215514482;0.3591317935173110043;-2.601159664192811416;10.116309396920778241;1.990117964113282456;8.2797949356596678427;6.5694535538826821508;-0.20438251491754683142;1.4896509043500345548;3.6441303167759322434;5.2481101304962560761;-5.0274162504280806019;7.1256642708134831921;3.1384035033188046881;0.73580270888245080663;1.2108756144666070753];
LW2_1 = [-3.6527522011902751053 7.6371009086326244741 2.170235034571349253 -4.4846709124587365025 0.63532715759828073399 1.5844535551545921859 -2.5047844624046673445 0.34259557517350386346 -3.1682653298268363962 3.3608489618777874774 -1.4538646934772414543 1.8718183498305460688 0.35465363640199598638 -3.0672532418421263323 1.8721352634965353623 11.68602882925239328 4.7529404542825384183 -1.4589629920085087633 -5.8444244397149311965 -1.9007757429172804642;-2.2830135981401338263 -1.0118963831726508484 4.7350493186457045525 -3.1574375913149284045 -1.0629254963160299496 3.7688573353181600289 -0.26969542937274126881 -2.7595388576579700235 0.095441513367341954122 2.6368763005995936588 -0.28947781267982081177 2.6491993290872897227 -3.5744662616565006097 -5.2315662173741612762 5.1605746294582157674 3.7716113263325996563 4.5828187604653454201 1.3506159801630266415 -0.95561214721768672486 8.1718780244103168542;-1.6134592125236595361 -1.5382781306547608224 -0.058274431971246196116 5.276997244174438606 3.4201533035937212723 6.4238904884562675335 0.19834475657011663152 -3.7165480598801274859 -1.9472238189390198571 1.0559758906049232507 -7.4926251497793110445 14.577372119556409658 0.81134821836453863142 -0.95178710305549818482 -2.1055736527297579386 -2.9142617345754113778 1.7198289539986930663 -0.24616202697380487607 -1.6251528207356222833 11.93062360774682773;-1.7332531062429006319 4.5731303354348025181 5.8148235110513279977 -0.016057039554590646357 -1.2705435895543839564 4.6897097917825991686 0.20515482494573089589 4.8401766425066972133 -1.1822328960869827874 0.25298338195870401224 -2.7734588593390543387 8.456900918690182678 -4.2874692094821664767 -2.3756575313229730817 3.2273059809124911013 1.8882742021725389403 2.0002658262581389792 -0.51527913905649624926 0.77131438302679855568 -8.3103230871948987613;-0.25843291602877138669 -0.097176548662597048156 -0.049950628254241596915 0.14612371443619218137 0.097666434453727038467 0.72495687194532265618 0.12165645947861204734 1.1974996484209345926 0.32905888139035005535 -0.53753281235931982263 0.87278367109698440363 0.18742351455062886134 -0.53214745446232525339 0.11563348346374850706 -0.14667920564890093993 0.18079048238124811876 -0.83466236853634212522 -0.44729896042211708673 0.21850226817893791953 -1.657165075083887773;-0.17048951315825142117 0.17893629738744210034 0.39257127147095222108 1.6232147260797711308 -0.37552100602978888411 0.25131581448731915573 0.0081431013895598355901 -1.7429743181017973708 -0.081814378683829264149 0.3828172555873405325 -0.32115713004072282688 1.0624390034001978123 -0.60337890763799606475 -0.33736545496205438965 0.2189967690700098113 0.28798381325227306871 0.49936113628841655165 0.27663013248767243102 -0.12195777226830839535 3.2296510863031056005;-0.23915312810551836442 1.7542954845304372657 1.6317792215269044664 3.1119776820110240934 -0.77061332338000054776 -0.23253844017691169266 -0.49268673997011114274 -0.82702915588563685745 -0.53997519236031243928 0.71095454898462018267 -2.0400941987020595469 3.1623839440484262653 -0.34068586761041957933 -0.21192917115354750757 -0.044617022853694759954 -2.088204860966551113 1.6796901047656138672 0.25830782087068887565 0.69215043076693916202 -0.54168147026899937657;0.0087354157494269127349 19.947867709954689275 3.4923468833733686267 3.3238992221626535439 -3.4943097188023464206 5.2167900873102093229 2.1429779865549405393 5.1653548962590152271 -13.177867216113998694 -2.0997029397531870032 5.1666846828712715833 -7.4276723594474596268 -0.46578262915302515168 5.8702711295483771536 1.1301053632097028956 -7.930168544422159016 3.0090826095675216045 1.4820591325289373952 -12.226190203902069342 -13.873642567754325583;-7.3945615081914732869 9.4540387553394005238 5.2847872976516852006 -1.0740163355249914279 -2.3932744598361743726 7.2425128943013614702 -2.9568118683367217159 0.53769339079245170865 -4.4881516457351429139 5.2730771193538537034 5.5432089651203897418 -5.3368073787323240253 -8.9081487737362472501 -2.3382142236778942213 4.1736841461382869767 -2.1837281446098386617 5.937586280054707899 6.4206249148605181176 -2.3084369727832645403 1.9714184089012543044;-4.3306140581057341876 9.4425546181916892863 1.5411900788415984209 -16.574078363471972608 -1.4923139151630007149 14.28148710848515357 -0.77208954011367414427 1.1791059602084286162 -2.3663037449371024934 -0.4552831431821020014 2.4396922089820356483 -3.0255315804087108411 -2.2312607539299671444 -0.61130544038580725275 1.0665912300666127166 0.69939276425285379357 3.3929147161765795815 -0.51136045064429902496 -0.11253256110674980661 -2.0606114934024311047;6.7983890634504851036 1.7214289848475796685 1.0776437579551647605 9.8475326307344186461 -0.43428675294258911599 -6.1748689158212588524 -0.67377398495473694862 0.96696470562889846878 4.3821582103306706557 2.0440470473267851048 11.1549260167414932 3.7425734570096014231 -10.079902461013380943 -5.3516015453658871692 13.898978570142668687 -0.20630363569716245187 3.9387414500507733628 -6.0506290804909275138 -1.7334884405639088278 0.050369591614013158043;2.5124155441491966556 -5.2507523152960819957 -4.0918170943127627481 -14.534587955880086341 4.3069957829199960742 -0.51829055911993882066 -0.74596434785197462958 -0.31172708947385835421 2.6644422344518976509 -1.5937873756970921679 6.1694338550034837354 -11.74823307009837059 2.7974156715567595199 -0.70745309567755576552 -0.92666093767196311415 -1.1369964620468289151 1.310151962640539347 -1.9480250171910138413 2.445241290416124702 2.8226343912283891058;-1.1290518314500685992 2.719535756990319797 1.3272146364873764757 -4.77124255504433048 -0.67988782408314740735 4.5060782284842701984 -0.14284712988381870202 -1.2777199532121867875 -0.53578971760138693892 -0.018466151874831360225 0.14693980871621767359 0.12682192312426279757 -2.1003811858661780576 -0.67371449277140282863 0.96397732333476904287 0.29795910245484857892 0.72283848572970910151 -0.13933182971513705106 0.37946531951674633554 2.4680140510802268672;2.5439657010904035417 -17.426280077690673664 -4.0319572699871928378 -9.2027456830325053971 3.8840542997956899463 3.2019686662923740883 -0.052199807706393611118 -3.0747851160041110852 6.1356959358156109019 -0.92642746541522613679 1.6625478177966481752 -1.9702492380113139081 0.705817128196013166 -5.4373464728988487593 1.4330189707581761915 1.0786851207025538457 1.4596162559876502129 -1.8554499230427980994 0.75141356156824046231 18.731558331068537626;-1.3098159914669753601 -1.2047633998625197904 3.9589510483498822069 -4.9133926680960176014 -4.9159718695054754889 0.54535129668800308433 0.35281787093011207634 3.3545813116136846688 4.6745819551845508855 0.88365009695221419239 -4.0900202187166971868 8.3556901842397870439 -6.9819572525812940711 -3.4337983625941275179 8.7880297452697977434 1.0775928442324511636 0.60699037398178534719 -0.81736820883419103456 -2.8315934133790756633 -9.3862381970861594738;0.8594379253338556568 -2.1843546117919796501 -3.1164248482673824192 -13.89728367340612003 1.0597282109825549856 -0.74908448973784169667 0.35675557079921249581 0.76474401941233549618 0.27994020617290948927 -0.76890525937052356387 0.67475181822634489048 -9.4573608780700766374 0.98343688787455230127 -0.5015960084802537633 -1.119281900336092761 -1.6731294969692793728 -0.11317378443249155595 -0.9592827637959610021 3.6905582656621374049 1.954555359867903519;-1.8755724695219451181 7.9278944166966729412 3.9828553000820141605 -6.2848756306259767612 1.7787315491221629138 12.868001347494056219 1.7166711821657407722 -0.256883234723977949 -5.2982355175969511052 -0.50968208590192987106 -1.4600685631766372463 -3.5026422353216264405 -4.6739975508257467496 5.4971073896091349198 -10.707070706321303533 8.8532037705686992268 2.0080473432463965544 1.4055407711613583377 1.0833434881049106568 8.5426403504093997299;6.334874085447800951 -3.5591547287167144553 11.850695143163241241 7.3422921205151689961 4.2625170478241223293 -1.2310305639416270207 -3.0846125562816406607 5.53906223063009584 -4.3274560489521851636 3.3478253084719802324 -0.83078530724902110993 -10.81584335828881116 3.0117879116541690365 -2.4990690023180404111 -1.4703723870431297804 1.722618575029789767 2.7512196504247903306 -1.2422682357402989872 -1.5942616363991830575 2.607427650209004355;0.46444017754541405685 -4.9643565444782069562 0.66092784718416253131 8.3739282664442740156 -0.1491636083098696608 -0.18044875107971394823 -0.014800833192060597679 -0.78632696604592711154 1.9752667809619235406 0.92100406672694334897 1.1516543520525650557 3.7455477682557893893 -1.5812464888230883808 -0.66119266763628081751 -0.19423868039938885222 0.65744432313635536858 0.54567496139771576313 -0.15422825501686787675 -0.72899305258821234244 5.961447317606473284;-10.984760292055126385 7.7852088996181993963 -9.859624898810215754 -4.9801768021860279845 -3.4004452190155110003 -5.6705598826366783172 -5.8185577649779558485 -3.8466877778828321155 -1.3017380112627334743 -3.4795856178664403835 -1.1291850447941249591 -2.4614237832359164848 11.516382505435569072 -4.0560925307011617136 -1.4975083350000393256 -7.3864868607886773333 7.0105042893383870961 4.6698308227646334601 4.9276448388081846019 -0.38685549760901438709];

% Layer 3
b3 = 0.23930719634022440401;
LW3_2 = [0.029761574223591571314 -0.050109694386599200333 -0.11377916849418366618 0.14685498148200504254 0.88717668416067285708 1.3256174913745630839 0.24380697352090158203 -0.016581123155203884162 0.01124031599374039278 0.13578783586331241717 0.01221851230329143792 0.057940485262855459525 -0.83354763903462936181 0.042150543192019711281 -0.045044851370122380996 -0.049464015034082015054 -0.027426235190136809272 -0.023516715882001420351 -0.28619536375447252041 -0.011659716014732802308];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
