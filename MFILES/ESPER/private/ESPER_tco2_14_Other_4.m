function [Y,Xf,Af] = ESPER_tco2_14_Other_4(X,~,~)
%ESPER_TCO2_14_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.9587850378514432;-1.3001176387127686;-1.9856248904892302;8.3336168372103074;-1.4825904094366922;0.03848073280215538;-3.3243555110503284;-0.032362795012905038;0.78863449322338097;0.25146210433224236;0.93172186900280751;1.5153747604467362;0.6774725907585355;1.4129357247204228;-0.14399041052651226;0.87615199856972104;1.1871005676731312;0.26662598988797592;-1.4800710973347861;0.38079715285652599;-0.45119904907917496;-1.0503951695612757;0.68628086989158354;0.10930771109005573;-0.29077385292521557;-2.2240273976993925;0.53358937965420616;-2.0451981756618256;-0.19292471086718516;-0.37235746397095543];
IW1_1 = [0.20985177783783096 0.25752350558234471 -0.83331413990237557 -0.036413488667316848 1.0713321244279781 0.14808460288635253;-0.054955674783815231 0.41795430204369682 1.4801772036017333 0.14770198080049782 -1.3576015292835162 0.73425128472255863;-0.34508453377883913 0.2421377693528606 -2.1014852320132507 0.20731348755245949 2.3593336528801334 -1.6639555129546284;0.025123323088252728 -0.35904506695710448 2.9324485520235597 -0.58169710212734593 0.073282805029601411 7.3368251861709428;0.044508095942989573 0.40715603679415507 -0.030560040521940592 -0.92004704703345785 0.5869389776334436 -0.90108446944731524;0.53766912082700491 0.24970007334933947 -0.38609151602880026 -0.10264746138540987 1.1168020170625741 0.2275191649602861;1.1094463657951388 -0.04889281212627395 -1.3965559408712442 0.55195927636505304 0.88755337556917113 -1.0381108295510431;-0.023446578139286297 0.22685196447626782 0.41605969438289098 0.20895696617056667 0.95285857396689766 0.19876193156932323;-0.31688730401802129 0.28670819679854753 2.0490973958483947 0.20353963236454828 1.8816767357031601 -0.10159005140970354;-0.62521512709350691 -0.25290856905417347 0.59539621673069321 0.21013515268931457 -1.5423375181111616 -0.37640836304319775;-0.22308945892240709 0.33931331013883204 1.7883056442752532 0.34004661128816943 0.85443483807643861 -0.031534260353771874;0.032059368420860983 -1.192579940455446 -1.5171634320216159 -0.28945904122500882 1.3721837038144913 0.38804680480906323;0.92028900765167954 -0.10415087468902152 0.18806570773527312 0.22968041197650005 -2.4111693399455771 -0.63736245031888794;-0.11359865741084003 -0.42188652202840177 -0.82929633771709876 0.5266513474850083 -1.3661186110370505 -0.26514131301619409;0.79218351160818745 0.25553723836034919 0.32570441469323314 0.025052750960049004 1.2040154876652218 0.25904255746737687;-0.20885227984869334 -0.033583880273142762 -0.60139945443566134 0.86743567795963306 -3.2162605518939231 1.2202713848922135;0.25876376222605457 -1.4310162121591505 -0.73462168608034728 0.79178157669260762 -1.7503294289677431 1.930922866990527;0.16215488073194478 0.21979279573931113 1.0302762780311638 0.23588853897412018 1.0886411853834683 0.20068632267071573;-0.12844390852593379 0.085812975254077786 -0.39753238128821106 0.40835946152966524 2.7673889031817995 1.0517363327836085;-0.1760590819508431 -0.013535690356281381 0.41999137288573035 0.4369879171079783 -1.4454467659341597 -0.55616535625687125;-0.37318478059148391 -0.40012604474628727 1.4240826640427044 -0.91722642476066252 -0.14077973266117014 -0.85845088961411209;-1.230631805443948 -0.24732797548318528 -1.0405096385000874 -0.26844204222916301 1.9395348979133613 0.4584187632402153;0.25200119549944533 -0.37050646842681118 0.17496939800246003 -0.296330122447716 -2.8168768758393727 0.56526190275167798;-0.10970476479946142 0.1898466742401593 -1.0040360328628795 0.38964108997100283 -2.4510382074924353 0.73365530975634208;-0.096047408841087145 0.17621813251503415 0.18814734427394453 0.10735608181669488 0.91154021407127728 0.36634640000221713;-0.56118759212342373 0.097740756338249385 -0.87574630832950962 0.52573602503220596 3.9622905919988378 1.8312884564898402;-0.2318023278061786 -0.13917254743641566 0.36666750067114612 -0.016515140501087405 -0.53716181709802935 -0.094544087975560728;0.13993456488475547 0.22302428921154346 -1.7728604133281267 0.12049390271589121 1.4124919659101776 -1.2823747066276099;1.5867888463334656 0.38969247289346148 -2.1225474759582776 -0.15826963271477762 -3.7795408088901441 -2.104027964074092;-0.16027385472216635 -0.18952621290293514 -1.3601809131901466 -0.30291598481303178 -0.99241416603733157 -0.30367184713463108];

% Layer 2
b2 = [10.047179500942454;8.0371588362528215;-4.1131108855387684;19.525792167398841;0.16069014689779115;-5.4802189014610292;-2.6018326807950332;4.9150591633940905;-13.889221465272099;-10.277005215192375];
LW2_1 = [-1.4292951180267031 -0.2415670156655006 1.3227940770582542 -6.302402384667416 -1.2686777090843522 5.1664446207057235 4.6881573811206163 -5.5900581294841238 -5.7293648288780608 4.7847187489431278 7.7956565656459951 1.2534089842388643 -0.96336588044400273 -1.463785566391923 2.6373405912247883 3.1404176121669414 -0.49602685386852535 7.0249372733954809 -3.4020165340285642 2.8550110212639317 -0.061734348927581104 0.29779796588501029 -0.63726924438358334 -3.8408369922256589 -1.7545689112199239 2.6079820033318146 -5.2967774776853771 -0.80282254227893779 -0.21167821644617643 7.7331232368780238;4.8095858721978004 15.22792477912988 -1.0043384811092961 4.861555610412454 -5.3329877169576436 -0.90593202779700732 -10.121120516313296 7.7585237238603559 7.6579752669430121 -3.0167538199875286 -14.068148204124979 0.17197104192488794 2.3980907765984711 7.7200706885644781 -1.3023916155895048 -0.86141971098195314 -2.0747596034251865 -2.957427239681941 -5.9763352233179665 9.4818873309272931 4.6359461228345431 0.4365092680367329 -0.99988533067810281 3.7199109241823547 11.512821775976999 2.3522385918766671 -8.6616145791034675 2.8336081544033536 -0.57120056839042899 -5.4389996392535762;4.3318507230006933 0.41409747049657186 4.2918106972457304 0.55214175833029644 14.014718657540454 8.5368988388685541 -2.9475458993463488 2.9871754830696435 -6.3106043229350961 9.1449237577979599 10.419732625006686 0.30741032706831717 4.4165958531161289 6.3733067994217159 -2.9953023442410913 9.0218946843144643 2.8112008136564741 -5.3811874617655509 7.3872834084919692 -7.7000953085452357 5.8755516524963349 2.226017309577387 2.0543351896671154 -5.3871997866888321 -6.1393337887467272 -2.2098483219546368 -11.301080022570591 -8.7146172246776654 -0.78027457867034467 -0.88811949579852223;-4.1392001384321775 28.443821371067031 -4.6839919421418008 -1.3483845028374073 -7.0762602746060512 -11.601286732901082 3.8350406454333217 12.890776039056759 -15.400384883554789 -37.803420154290166 -6.4559911689662437 6.0039130818186885 -4.8481046327135582 -5.8525538583779451 -5.0440636462027104 12.924348106423919 0.29648945321141251 -16.5599769639839 2.9889373917119237 9.7050453552232536 -12.966456441574458 -2.1837835750290928 -3.1582837189909481 -3.9750112590823816 -3.3339033529153843 5.5486857592495396 18.917703952417352 12.456968785697562 -14.801173892877811 -6.8655935048616739;-4.3978132412822735 -8.8652896669239638 0.2571509627916061 -8.4702545646822021 3.2534796370314591 -10.571789372439049 -1.2746095830731323 4.6056133251178135 -3.688886059575303 -6.4992434967865611 5.5138907453047397 -3.1474922959282896 0.11241782174055996 4.3495866414487763 4.8863267395911985 -1.4230817534844338 0.17597742381824039 0.74918902863642012 0.33554854840201631 -0.50512646528943295 -3.1134400426009217 -1.0203577936132791 1.519894270213725 -1.6655231203058751 6.6748260193220119 -0.86893362294879239 -0.3482199832892019 -0.63588879770484685 0.4934529458460466 8.705466637201706;-15.381944960868637 -19.976497039096568 12.706899646090438 4.3761840066417648 -9.6624033840903856 -13.969227549667929 12.634814962584887 -2.4205430626296325 0.73773841048862943 -19.998573539805172 -1.9466509020800646 2.6855318264678476 16.039662945863462 12.09772122976198 20.63313633318031 -2.2815497668818581 -7.4630024342089412 -35.689713385856443 -2.2574177044894674 2.4388067086565632 13.514082935480859 6.5670123468689932 17.456522646923833 19.12861662918236 13.733025081398086 -6.8708629108894099 -9.3840891204286372 3.6140388922274593 -9.0506518434160999 -9.6823475567865245;4.0956492817031416 1.0038053947386387 0.24654800448112854 -0.11926388170295446 0.073047699503991717 5.9981498522321868 -0.05451749988910249 13.312900565834717 0.30843856141894344 4.9521078119019037 -0.1997410296636587 1.291971864120421 -0.43633803350330963 0.60582621394110736 0.90361060043375785 0.89898219165953863 -0.12644659634965827 -9.2885565784330684 1.8123349486901243 -2.0944786986541692 -0.10193095108902325 -0.30443548968396872 0.91214892497759614 -1.3813478310308798 -10.752976295413363 -0.48870693770492951 6.8200533167996085 -0.90020889384300817 -0.00020865623297287644 -4.024999654479994;11.488343958046334 -1.3757083346722554 2.1331421010441183 -9.7401513071778911 -3.8422438454621486 -0.90443296058109701 -2.0628690233529778 2.930675542850659 -9.9827625315456796 8.6947233122119822 11.171072089678956 -2.0305715508134941 5.1450598012066511 -1.0546047024596981 16.035670704609519 -1.2199829837589051 -0.40524744446362859 0.59641457643704676 -3.1975670136516805 -3.8165060776871114 -2.3695204763124651 7.3574436877281819 -1.170350622196354 1.9919447434434556 -7.7012637483688007 2.7262971762208301 26.615342046831813 -0.0012752284204729514 -1.4476177123137544 1.3301243996074361;1.9263025037471531 2.8066348423768734 0.7074863539328079 -1.3211182511322197 -2.00094135594939 -10.066651313120341 -4.6495730783419376 14.262844498698822 3.0769847518129136 -18.88649085162389 -5.3614802910985526 -1.5568204503806287 -0.22900390920320263 13.096287264945394 -1.5562717057107756 0.71755153854700093 0.95217612764622661 6.5650078212114442 -4.3776836211312613 -0.15054648848190355 4.500406776452829 -4.5586239150957475 -4.4952032113168725 -0.048163265583994863 -0.31169672438614621 3.9463327510696802 11.550091999359283 -5.1856322648277304 0.18545991688735575 7.3485673681185197;-1.0581669136799634 2.7430897723928012 -2.1857833570513958 9.3584731816440492 -5.7341080357348542 -6.5908720468704685 -8.9980068055427775 -9.3949787670341909 5.0691411395841186 -6.2300767224287954 -1.0444249842211193 -0.76488382474950767 -0.4999150810278592 -3.6424350955011029 1.7725517896888401 -9.9850329888910068 1.3196914350816673 -3.5864036288507566 9.1395049598242348 2.6776548741023238 -1.5403629653481179 2.2467702652274419 0.92077116260939429 9.6615873693419658 -4.7090093142793368 -2.6921706927368643 4.1907314893190879 6.3182229466908666 -1.0910894094693606 -3.2056716046908473];

% Layer 3
b3 = -0.16349199155282126;
LW3_2 = [-0.26338330971803464 0.20855417260857326 -0.044989439534970914 0.0051081794653184097 -0.070428031887380754 -0.0058325398714931002 0.72345883839150404 0.097693882733523904 0.048000080999709767 -0.036528875345341709];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
