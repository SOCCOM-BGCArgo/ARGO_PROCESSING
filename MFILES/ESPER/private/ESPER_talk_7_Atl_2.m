function [Y,Xf,Af] = ESPER_talk_7_Atl_2(X,~,~)
%ESPER_TALK_7_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4676593434699265;2.7599952027304839;-0.79332006687988854;-0.62682832970597324;0.81351239427988975;-1.0930590064761256;-0.92038209552932626;-2.3316136564621206;0.18300239081998479;-1.3399695214457734;0.34192078783262592;-0.045782950653071655;1.1815361870946235;-0.47557035564992606;-1.1152104538636709;-1.2902560515593577;-0.57053667779477557;-1.7919285570469545;1.3158831775423467;-2.7100435897134934];
IW1_1 = [0.6302598745659731 0.13596300149904297 0.45825292309577248 -0.10253203361594301 1.0892141955440862 -1.1414903230503983 0.55628442476492967;-2.7596500414657372 -0.82534895602242409 0.20593532565987144 0.31220257109270416 1.6713824938400683 -0.18806444864951272 -0.028973737577212041;1.0234249160847237 1.2211554408815821 0.30866112161833126 1.3319904002259733 -1.4016915655765689 2.050511980893071 0.29747137780640603;1.0718562033483541 -0.72122207906468705 1.668951286206795 0.0039999526833205436 -2.3392499159194458 0.34483491224944579 -0.2144505325022952;-0.062716422740982061 -1.3619969653316895 0.73424286878651379 -0.0042762037716831854 2.2719989863567109 0.9070286047524323 -0.23228973841970521;1.6652954563303506 -0.87947319648341371 -0.1300801006038714 0.57600017846447249 -3.4529514389980078 -0.30894719484200545 -0.62396490584235731;0.61407526245359267 0.72087647684903799 -0.089134426993252747 0.091484350307952308 3.1540548028967228 -0.73333197279735174 -0.059407037139091748;0.49317166761209108 -0.11978156159711485 -0.5237141906867856 0.31870171336211067 2.286727240628565 -0.33726526016095737 0.21930387112090852;-2.1786149970217865 0.89908600404174477 1.3720432235208002 -0.053316111760220747 0.77845224852351558 -1.2770160372839485 0.65475642975917503;0.21054104300639642 -1.1964423621524758 -2.1396785345431266 0.22443544574472649 1.2734559711536786 0.60954713186102538 -0.95500679216322704;-0.34304555033282946 1.2639006905590908 -0.17415170510603825 -0.62172408103368848 -0.054032181231863 0.69386742878068397 -0.32151660422766642;-0.65993015982056924 1.6129544910275539 1.4781177391975129 -0.48308804575025283 0.58333783987862764 0.7371778579390742 0.18943604471620992;1.9861478915393482 -0.028623530089436841 -2.3401458300046896 -1.0427711227332055 0.88259387488100038 -2.3358987879092599 -0.85213249230789145;0.26676376343542568 1.8023689849349713 -1.107958112427055 -0.7665912948311423 -1.2002553179476765 -2.3622611845875929 -0.32232754078355202;-0.018194530507462805 -1.3511916448702033 -0.20307893599604684 -0.53420936167714572 1.2852975502695596 0.40435030118310744 -0.45909251026419262;-1.0859662330355255 -1.6643793546396828 0.012753697865958633 0.33051062422302863 -0.86937372329132823 -0.28918605950183152 0.32489301555807543;-0.80503664758708426 0.015183304457756222 -1.2421398995142015 -0.90248374598446179 0.54742410981581135 -0.51794894444051809 -0.10190383421548155;0.16386360715019502 -1.0832633938517156 0.54446561225247081 0.29352001129022864 1.9971628450038414 -0.48657747565421172 -0.083210035388631975;0.47665649866790905 -0.19709965543039151 1.0499200211380937 -0.11968975168275472 -0.49367935828832016 0.5623672792762433 0.053988687694922467;-1.1771896741047321 1.2595928900724422 -0.1233014334038415 -1.0866693606153957 -0.95862212617460518 0.64392173477328707 -0.82954740806459304];

% Layer 2
b2 = [-1.8449097558125187;1.9393048136734925;1.6622151241138416;-1.7363436434647446;1.3368012836532464;0.51031141180116579;-0.69184324927667329;0.43599829497788795;-0.072755875625666183;0.4446189700379245;-0.25674400746186032;0.21188088535879329;1.0512155887869032;-0.81704394347274156;-1.3634820929391924;-0.68955582022649975;0.30020941283634073;1.0757503495789209;1.4663333860190952;-1.8184456624187031];
LW2_1 = [-0.46906050131079885 -0.72775494697319709 1.2910737121159932 -1.9050190182516886 -0.19896574659090782 0.64799331697093088 0.31276605955379394 -1.5056118604235982 -1.2826716779656102 -1.6899912178584457 0.52469842998841543 -0.06796309500239657 -0.41393161277574608 1.0840441388267184 1.170869634915142 1.308560044969115 -0.84370803901128077 -0.43666719046171404 -0.12839058828545796 -0.363483668298062;-1.0769763177359819 0.21671080709132373 1.7842462843224087 -0.65399337064062069 -0.21539162101542011 -0.51797962267427733 0.58997353145109965 1.7949004629623893 -1.337552200469277 -2.5813752606702258 0.54198389998337915 -0.093950305417021651 0.75194693741133656 0.11164792769220785 0.71532828817114369 -0.57641258887277513 0.48110214817934216 -2.2748521980962044 -0.078138258689933945 -0.74818749383441285;-0.53929451098165859 0.65256481205630767 -0.040193272789751933 0.060184025290866978 0.40091599532699285 0.30670225149976904 0.7291778572158244 0.62551321828402018 -1.0063337633842069 -0.024256059697191586 0.043729188994921189 -0.38312952023467067 0.46697239737996615 -0.3629907145138519 -0.46698096192967981 0.69942171151244836 -0.76416875995102718 -0.14925624621255659 -0.40830671485687586 -0.42315613585035267;1.7360371561899561 -0.47502523770003646 -1.6300621017437762 1.0995445911432389 -0.7088186452950006 -0.48705927085298967 -0.6981474079598381 0.046558719148768753 1.3719690468955295 -0.11063138362507995 0.97791942842179791 -1.9858668246583977 0.32852791066171949 1.0469266629082947 0.48886758732849483 0.30896800356295467 0.39509422531930533 -0.57487854051939347 -1.0086951333650902 -0.49895499580895841;-0.011692551082795457 -0.5484390089562623 1.6458287121295954 0.60944772623302712 1.1094762536311369 -1.3141725038022796 0.0446072285264833 -1.0381351625975006 -2.1783508368559557 0.006059329648573749 -1.1243297439599309 1.3481298407482125 -0.034577339632095284 -0.46122807253743703 0.37479700498615309 2.0836080343603127 0.6370762817345369 -0.95318980605969639 0.39965016486794158 -2.3314599096325002;-0.85711770018861311 0.48941454193419687 0.72271930944720142 -0.49317591889890805 0.13930083730969633 0.93383788394490652 -1.1556145009833634 1.0100185378841191 -0.51435908027385135 -0.24541281733345022 0.44834530544335083 1.6193768158552708 1.0675980546119292 -0.68689628504210398 0.18926543301965079 -0.56510127968361323 -0.56650513939532299 0.037079261696460794 -0.18923972314349077 0.41261706051959302;-0.18984472933096502 -0.12092712097591703 0.40432835072654955 -0.37965023203717702 -0.74418696620578595 -0.4565083602652043 0.80256441369994047 -1.1071045910032919 -0.82144289723256203 0.69919188735937177 -0.0048179316910142468 -0.16453767968806648 -0.65608185424054311 0.14319153699334886 0.34565342708077745 0.33865166482490561 0.39364081546004837 0.92814551679540569 -0.52939217525124316 0.62496886934916585;0.13375264465032913 -0.89926117337806999 -0.33315116375566473 -0.93287950966689515 0.31415495362234525 -0.31972157051558542 -0.59213556305295112 0.33711372380937288 0.60374646799673526 -0.38274511087097352 0.68120273027680078 -0.24698036686731079 -1.2787146622701091 0.22977749455682367 0.68438291365057091 -1.2732652169707288 -0.28545496788927016 -0.20064317639241183 0.21890998724628241 -0.27615090413767418;-0.46867710799943263 -0.4039213008625881 1.6808374714796983 -0.93820708662822661 0.60231380144686875 -0.69711726261155305 -0.95476403875828186 -1.8085242572713334 -0.33397910211325843 -1.4093081395092857 0.41161480678787138 0.061408490962983203 -0.53608972840882507 0.3496590261967315 -0.032760844447859788 0.68758211994907603 0.86844222286275596 -0.35976925200538379 0.075383368024900366 -0.66616719913513078;-0.21931546809266156 -1.948622848617978 -0.50018535509947459 0.25495821402812746 -0.65329291694991132 2.2702207766720646 0.060098539788699501 -0.74954157507504404 -0.5332911659852535 -0.06170896702956695 -0.96930289312939244 -0.079612591413998096 0.80426318592632851 -0.14405082164145089 -0.20229450913578892 -0.34918462550819396 0.40485106448524233 -0.12621566261622211 0.86187717402246911 -1.8507956825256346;0.47448046743924432 -0.76197081795476374 1.1667528108065528 0.17486157746793746 -0.54193954150376022 -1.7814026393571223 0.62951908666229484 -0.47451751031132766 0.4908500084297881 -0.175296807888768 0.027277480652655874 -0.79697474338934815 -0.71201240135559629 0.96894628266681271 -0.094838702937378866 -1.0989096246238592 0.24658194302707589 0.43599298565665212 0.53846373585251495 -0.36708295620154385;0.25604019695540592 0.68266191341487481 -0.34546510633360894 -0.17168298546801025 0.49083932033489841 2.1204509488182066 -0.16812611955234236 -0.61694290878158542 -0.12257378834290211 0.19583041308665475 0.078691871019317336 0.91848599307020617 0.43344880932818275 -0.60727419409730943 0.053254859578748599 0.36155269309285903 -0.70466031110262151 -0.53098531926340775 -0.27006487266617774 -0.58098075410228411;1.4552350490778965 -2.1888836243102827 0.65713279654837942 -0.26797025843177902 -0.30954041611514549 -1.2113070030183997 1.2597375302676885 0.35866343428396152 -0.2219715675371001 -0.14304725288827494 -0.47967386696161529 -1.3170232850793393 -0.16508562191912518 0.69419427152781987 0.83612650619059559 1.1752816829898074 0.11042394345670145 0.21195242806238121 0.21107850647298082 0.25951709446000965;-0.88371307782347852 -0.11615182410034132 0.87241582166678644 -1.1222525638247305 0.23534657217005975 0.63897343020496289 -1.1859929338313877 -1.1320276927059576 0.84876664725604722 0.15098663177919544 -0.28912257195670721 0.19656635647651663 -0.18388919947853299 0.048638306894203925 0.22543185015066977 -1.5809661604180303 -0.83051092457233444 0.36753154155076123 -0.20995391342468592 0.13303734247602481;-1.5377913835709365 -1.0895579106191635 -1.2996534131235922 0.32096397159138063 0.45264376148220192 -0.36636635644948623 -1.1224876381671831 0.088178148878922794 0.40282032081650077 0.32627800334492796 0.13851340034196272 0.44548789584793019 0.0083134176250959611 -0.81091860857975218 0.19913831464254092 -0.42810594584738532 -0.48758772970720976 -0.082132432179300746 0.21748842866287313 1.0582096127916381;-0.01918176949621642 0.97766511540174783 2.2148948658068521 2.2147710265461256 -0.35149641472421561 -0.27016766777833418 -0.55374343453153119 2.5299408695219552 0.66091736308396454 -0.23980643956043715 0.71617707994626023 -1.0053940120797249 0.2817716314335979 -2.7301601348310993 -0.37761511048392887 -0.061240567972146873 0.60302854847458098 2.8236655711843035 -0.50805220575464594 0.14513679732988477;0.83027432792599787 0.16659997652894781 -1.8190117569451154 2.0162073779511722 0.053776215810889073 0.44658673401439886 1.7351215029418592 1.2635750758364053 0.55573396997436686 0.76152288140096736 -0.39037968489585312 -0.53424250855956101 -0.10221664605026448 -0.84269461989297045 -0.42473494536729833 -0.91804263004393505 -0.45820273241163617 -1.6045239788563039 -0.30675662700650186 0.19338479739611533;2.9641624740772095 -1.4597837015588628 0.26061097949039558 -2.2787043559376863 0.60393275183389805 -0.9061806166425721 0.45742959796941374 -1.195300167793877 -0.19645534856488403 0.25062301265302006 -0.2210028989594669 0.1965326293706541 -1.2286323470491338 -0.020087605444051089 0.46865884433543853 -0.55801113656269186 -0.67646217862857516 0.70692517537834065 -0.22173296117127783 -0.19663238771378444;1.2375697468699962 -0.20478107554273667 -0.30552917650332512 -0.68462199441345184 0.12583712604534955 -0.70532056214767558 1.4715133787466923 0.67872596730574941 -0.011861049051837609 -0.47389425074945929 1.2728102969231285 0.039918972316207092 0.16544733063201664 -0.78947957317245598 0.011922413481162138 0.0001220080171328887 -0.64217267466665795 0.057631655436487891 0.5437306153998851 -0.61495069882858078;0.52059614298250245 -0.018316028314195751 -0.22012763022907844 -1.6082229737720017 -0.82558373253628248 -0.057095315881955197 -1.3741746471031238 1.0151660911400133 0.60586277359483087 -0.22493168807723729 0.87204414460820023 0.098447899094024238 1.6721372516642936 -0.25689911169620522 0.7571224994622876 -1.2586162155213112 -0.87581048293413999 1.6239725048368745 -0.087687946580407267 0.73616446641681865];

% Layer 3
b3 = 0.28483506997199948;
LW3_2 = [0.76683990505036481 0.058778514989549537 0.50665820164385256 0.094324110592970287 0.08113401464420042 0.058422946597154884 -0.025675137411585676 -0.089169535309102724 -0.041317926509864947 -0.20817597135978741 0.080996784970209429 -0.18418475584536115 -0.12872482714348943 -0.17209536113115628 0.16293327653760703 0.0017773562520209264 -0.042549076254663587 0.080271977787143373 0.51685594089218845 0.13215661943066051];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
