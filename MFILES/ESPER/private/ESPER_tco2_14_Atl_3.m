function [Y,Xf,Af] = ESPER_tco2_14_Atl_3(X,~,~)
%ESPER_TCO2_14_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.6864217575510168;3.4137088466502892;-3.2395237835648842;-2.1047510230590847;3.3776657454695025;-0.90291318880860216;-2.4741443174674895;-1.6588798540694114;-0.66223615233449018;0.2376871438938509;0.063732308099795854;-0.8310695674346128;1.2846818889445513;-1.1410664854502177;0.60134414400064651;0.3786398100219287;1.9956790694212831;-1.3272483561443214;1.1438095657444318;1.3947622660368011;2.2082156838835143;-2.0721337512578617;-2.3715498767614762;-2.4733298129046712;-2.7830332742422041];
IW1_1 = [-0.1096713066211335 -0.85413816141454646 2.0724640567295429 -0.29255303102377389 0.89492486582811859 1.0347107510862925;-0.32759722244442335 -0.77389450812046801 2.0369853966539311 0.24064001152137462 -3.7184453755781339 0.96462928896342803;0.42358815566566715 -0.52540377404471683 -0.2306688686448729 -1.7079771030828934 -0.96076424152814388 -1.2172122704568331;2.5687156053489715 0.41708767797615143 1.6957747511023593 -0.024060429785722218 -1.8479355175969945 -0.55277183910181016;-0.94140750359212888 -0.7475215624209185 -2.2328302670798958 -0.082306072003293707 -0.83205564955699185 0.27216050556295746;0.18885399870062899 1.1993102052809377 1.3037430866427664 0.59335104228378899 0.34169711517501089 -0.45644248719282621;0.70908779004219002 0.085516915477354571 2.4613919512574434 -0.032711948117371298 1.4515369024957105 0.0017210382485952592;2.2114371088407188 0.065192805983068522 1.1751311325859313 0.75848025365628213 -0.88689139233061187 0.87115247119137085;1.4805704274819318 -1.3517999416153366 0.51542386356692993 -0.79914881209271971 -1.4459276625629838 -0.0086534192031984068;0.35353307323415095 0.93564557911061952 -1.6558459602068525 -0.32256306503120102 -0.72113463942038203 -1.1118127447898556;-0.17332330501759624 0.89995873639183732 -0.039024550131228422 0.86764616226834634 0.0014787794852444882 0.85246088339002246;-1.0334950029639285 1.2012927441270327 1.3203009416749907 -1.1311243966693181 0.44831710846157496 -0.47695148082333222;1.0962674712666094 -0.75515101811528884 -2.5385327994959708 -0.56083422506482372 -0.13581062048928669 -0.11685497995724893;-0.88933901841083896 -0.48609624784510358 -0.84492220822421471 0.12468708674884382 2.3167658548825991 0.36954442185220038;-0.50258890003283607 1.2533902230567693 -0.84251162007569058 0.76769514176660514 2.0759734680285433 -0.016951340902991024;0.21411085842951 1.0518954928548903 -1.3794477256429618 1.1604269671087013 3.1315477414097375 -0.31249605619076881;0.23020782787086158 0.47325822995373285 0.97795076527951752 0.47765469518312675 -2.9632998104504726 -0.17959817919754265;-1.1396942625107733 -1.1678454333742179 -0.1398702977652192 0.14702298295449251 -1.2510816306508239 -0.52940383878760766;1.4281479302258089 -1.6184502196214268 0.24099457373380567 -0.1924118888053313 0.88506121482649447 -1.526482616301031;0.92565690957028668 -1.5833859625452458 -0.25139725852831513 0.0091929044421481688 3.9954632758073014 -0.42287635521375644;0.39116820765076737 -1.3605862347789481 -1.1183408171484384 -0.73376434110142863 -2.3129545575809041 -0.052875147001880375;-1.2930356543156791 1.2553430514399324 -0.3079356493802739 1.1838215981860076 0.57356782497016234 0.50218078108303155;-0.79716646964982685 0.1503569211621667 0.96612139550235476 1.8240865707498801 -0.64524439472326611 0.43822170742752259;-2.2695674492393207 -1.8143770048911649 -1.796929043699137 0.59677819353011741 -0.12537678089797505 -0.41464013165604197;0.94582827640115141 0.7891642758929327 0.16764858610707467 -1.3711941264783418 -0.86884171556885181 0.78921446130725703];

% Layer 2
b2 = [0.81590194893481371;1.5716264770554216;0.59491388855920047;1.0937455361110469;1.5435339007612436;-0.09921059635560063;0.85466666343805098;1.3385707045359081;-0.12343275386605443;0.71627647216821666;0.91660083639522238;-1.5466371973723145;1.2551495152543815;1.618795460963268;-1.8254641039433723];
LW2_1 = [0.60021857003347234 1.1316558190177357 -1.9522560538502427 -2.038890409566291 0.92331106208073854 2.2724446093633341 0.91529190393531856 -0.58627147574891403 -0.8260430667562253 -1.281331160896541 -0.38577969385295213 -2.0699118355236528 0.86869137387989193 -0.27761089655387999 1.011087287415096 0.85700782665321518 1.1378983498253361 -1.5187474472915674 -0.10599256843170328 -0.031535424952826685 1.118092419439622 -0.1875768131663923 1.1759418877978707 0.67759473056791475 2.1065411140300276;0.70655350337698242 1.0215593689531404 0.92761278391933055 0.17835468963108062 1.2282514862490714 -0.62323707901749636 -0.88272387335349156 1.275861170497443 -0.050696398283190711 1.1206891970064523 -0.92853537712400736 0.21960330135588352 0.80141013673016648 0.11921802744095496 -1.0901971711546341 -0.39352098961892334 0.80312303152666664 -0.068660553484844081 0.65041331986867323 0.18113446193569371 -0.61323266118979602 -0.3708771579156469 0.3206223471260008 0.50932873075728757 0.56537575973260279;0.11495458825619968 -0.42371658757780478 -0.31522500482439092 0.78296432852463216 0.14448467233472434 0.71081117628847401 -0.97065001313036525 -0.55576207923603227 0.1536932216402592 -0.77330648910477662 0.27931724131306335 0.50526555655863448 -0.042494192559055441 -0.026387373369545299 -0.77244525378820184 0.1763355806334605 0.87874405528884358 0.02710376314275181 0.055484573163664938 -0.23821643106590923 0.073617081299216694 -0.18933382400791898 -0.14347588708773118 0.15178983026821824 -0.80668531246857877;1.6449179951540061 -1.0341719596551195 -1.0762271863612261 -0.070588235599495466 0.74421535828995999 0.15549709140710113 -0.40397955844235395 0.031890504609202251 -1.2160852131396538 -0.24678492287043399 0.28767621665770493 0.35489420225281459 2.091721485885444 1.192472726978925 0.22012447132441657 0.70203121203447283 1.1563344854322772 1.6350580894083986 -0.54617274787288372 1.3575196795284452 0.36833602242771085 0.057725091439495432 -0.0026863911328903894 -0.18530673784265647 -0.24839468996044642;0.73058628181729679 -0.71044940647774413 -0.37847742588281863 0.37941044949900593 -1.6537472058374607 0.0344927949760672 -0.22375141536553453 -0.29213091156179427 -0.074799910138805714 -1.4405280302127972 0.13341297136731534 0.21889203148964773 -1.2460092069823616 -1.9572744169096745 0.580671602834814 0.22079233977875926 0.31193814400889613 0.66305586074607237 0.24009990815954371 -0.0012025061606017445 0.89883932950195111 -0.055336534662074464 -0.42550090801054341 -0.54508750522357274 -0.43643863893543361;-0.33973873589211151 -0.23800176404421108 -0.62890805287528029 0.27613150632166783 -0.062760476013552335 -0.10636630622054996 -0.48814047660474547 -0.20537222063653177 -0.061272329015248823 -0.57880344288058361 0.071625303756439052 0.48401153129459462 0.46607536557494372 0.13757890537945153 -0.91060271740824938 -0.070392552896403587 1.054393941854769 -0.77114333951459313 -0.017940341792577648 -0.39494343810671173 -0.31528944005414189 -0.5098851861577639 0.72428033413196835 0.11161552410896647 -0.51750436350329643;0.55073908443303377 0.55248530330716739 -0.19863252832528061 -0.38869174839997472 -0.94649574860916497 0.48877846052509044 0.058558148177180844 0.025314417570804229 -0.056610254481264423 0.82658963488506665 -0.34469217583186917 -0.63968254472806108 -0.62961933420304195 0.048105950776887389 0.5650917892553653 -0.31702225548483864 -0.920005268319673 0.28460178950985238 0.17924374926108597 -0.93654959011951711 0.055596617077031681 -0.0070771434459682356 -0.61038092907464092 0.52770070287146986 -0.2800898424092792;-0.17896378927550263 -0.52936517428468866 0.74501390598385442 1.1747206044500573 -0.3070812183201504 0.56419046381636884 0.38220444806381426 -0.043066160840240203 -0.48355500076285796 0.7071079545027622 -0.051142414327123263 -0.62815937010230904 0.049873906542155122 -0.79953435049091115 -1.0782682723225854 -0.38941707397689279 0.10295476785741814 -0.49087997548375201 0.59978149317884999 -1.1525403709482698 -0.56938661790126233 -0.82072360761369667 -0.55296956069185432 -0.44733459913717077 0.26875657274188708;0.33130221222402823 0.63433610976605426 -0.3954563951114855 -0.82646897945818854 -0.3324965038321 -1.0822775214600151 0.92882588590306081 0.25925795102377847 -0.44630585488896923 0.69920007551393604 -0.45696486943314379 -0.33564916200337824 -0.051477946014693909 0.07396919257854298 -0.097931446994670462 0.48148228811179711 0.57278047161685353 -1.2429500729551013 0.044149273573496142 -1.9080968956814262 -0.53032903725649538 -0.53593865344172842 -0.48910741254707985 -0.083679978855723924 0.0010569364820471744;0.58604937253444822 -0.74415384470242674 -0.36951901295849582 -0.18032340569432845 1.9741285053772148 -1.0115618995885134 0.77461333957459966 0.012326089223384759 0.036294148427509353 -2.841444668276214 -0.079783742826504994 0.3024424899315048 -0.72924148261500943 0.84199674374095412 -0.52363658018564296 0.45830661852390525 1.6516529134804738 0.079274841041592325 0.52112054603729208 2.033993849005415 -0.81984212705986237 -0.52975616311043539 -0.66600869832203291 -0.026481549336421505 0.54391613316422927;0.11247942243589995 0.30708758543026693 0.88247989874440047 -0.50996881181660958 0.95999517378607535 -0.80814154365453494 -0.45813344619427399 0.74220025184621841 0.15891999782708621 -0.43686478559546033 0.29182594507640919 0.034488398184701244 -1.2849212768325953 -0.97701688782601681 -0.41274222224465901 1.1304972735794796 0.021868129402478537 0.7726476458674556 -0.17740832108018487 -0.57195349056663114 1.2012610228228615 1.4955966801627234 -0.32607265186036388 -0.97219923771595529 -0.2382936508093228;-0.56196509023564323 0.21809174266352513 0.85881347371088523 -0.092512130970784395 0.56982427268402958 -0.78392502283648202 0.3101153443911176 0.1722965574670399 -1.2031826024888521 0.97730639248987883 0.51351027793488258 -0.29891784732972709 -1.319393059985658 0.63371535249162103 0.90065608761129701 -0.84715353423910389 1.1558539010407056 0.63402746245588648 -0.94741989951976568 0.63555888557169427 0.33315220331918938 0.6570435826100911 0.12483159967189138 0.7385185155102143 0.31454020641158076;-0.22649319635097898 -0.43720983239475986 -0.053159414198535877 0.11802845117713975 -0.029643655274386838 0.27134174045936432 -0.0029726742319425951 0.54942097413434188 -0.11143709244445829 1.0770435145029511 -0.066605029739906396 -0.38316829955780435 0.50858517426234229 -0.95441145563091712 0.30574015132558002 -0.38031021190998882 -0.40888357042128004 -0.86638931551464005 0.89670308597898796 0.6106059575104239 -1.3035432166439156 -0.22405706183274818 -0.1995567093644055 -0.15436449641334132 0.52694439366332724;0.32201875194018736 -0.91370524384237151 0.33203775696216592 -0.12081443583277025 0.45859424630418 1.3775444408892989 0.33240011334731739 0.36153166761764893 0.28547948004004331 -0.40627356441359641 -0.81195062861867306 -0.53518120971754157 0.17147073548837322 -0.29267334246228477 0.66533166903071783 -0.21766672685916821 1.0114972990831428 -2.5860191612787489 -0.81455021233427005 0.062231561834613737 1.0555404438741007 0.59186850160992022 0.3668212410486093 0.8066303828425212 -0.14487944895214472;-1.3243220778186569 -0.77955759501678712 1.3210800711085038 -0.13267511873347662 0.55581914366162899 1.657688924339028 -0.47707526746399598 -0.59934089545081803 0.040452316018037504 -1.0573377035224178 0.51721927487057584 0.11937893508357719 -0.28749746591255709 1.5631286783487068 -1.3279644252880871 -1.0436915496256576 0.13356366737616854 -0.23014543057687131 0.1770089602512028 1.0166674295673437 0.59563634954379896 -0.1081813088896872 0.59991745512327543 0.41654394610586842 -0.02426195400341144];

% Layer 3
b3 = -2.2696919562570739;
LW3_2 = [0.23795612250443116 -0.21316085989293362 -1.1648910942216697 0.29700978956142904 0.12721596452988818 1.3383425267976605 0.46382093390529183 0.16745714061565442 -1.1488950011024217 0.83952193268691711 0.21335029098418937 -1.4032028556561651 -0.22476880215589556 0.28542149366503922 -1.3283912496158636];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
