function [Y,Xf,Af] = ESPER_pH_6_Atl_2(X,~,~)
%ESPER_PH_6_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_6_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0842746079000242787;-2.0569666705652456251;1.9210545038066670909;-1.2815915034989711074;1.1769987701111510603;1.1860520580847697669;0.89534057724729587679;-0.77331209084486829397;0.21191563296929555316;-0.010607454891485134513;0.29101990245705028348;0.50097369786699019745;0.35062521858588446833;0.85928798274192264017;1.1332355637436122286;1.1643262726078900116;1.7798492327989414719;1.9648802776918947721;-2.3605809222486060506;1.545106761717591759];
IW1_1 = [1.3411019983603846839 -0.72639849604481565581 0.48868135746933427654 1.2734373616260481477 0.92811558144123340597 -0.39885317085000399073 -0.5167218070919519235;-0.50922404532752918449 1.3343615020985355457 1.1244333934184098656 -1.165448334078432735 1.1458707559291270162 0.051577572658042081244 -0.074076131115710541764;-1.3368242952295608106 0.63547247515425686615 -0.3770722046787377546 -0.22313958737914366126 0.095495356285368176996 1.0129650828718306244 -0.87110877753116711109;0.84937598996339014334 0.036029094579866853543 -0.77825632976611869296 0.77587359048427462227 1.7489245458714213211 -0.21641656274186854558 -0.12530573548016765706;-1.1740267818232770214 -0.82411361734835186788 0.53408426476320924881 0.7270093349783247616 0.71943683387552492814 0.85990632564998892295 -0.28522532706858483298;-0.94187106794713415514 -0.83926859964167610517 0.51642058426377523972 -0.75619206504253322354 -0.32889574327110060459 0.48629667595996384222 -0.24901482018937762253;-0.53797438266111774485 -0.11576085174703772129 -1.0977103462540744871 -0.17155776889141882702 -1.1028444190898862853 -0.27421032250563109889 -0.13184377713205708282;1.621944129246583266 -0.46378362241171122715 0.20896831535672602542 -0.86069868256925241568 0.75120114999797649169 -1.6382689985044240899 0.76827620049717260109;-0.99580380060920536955 -0.51704662576704651933 0.73796650647919703747 -0.47228119944135071862 -1.0012092210275873594 1.2489136020572102481 1.1706992998498479963;-0.51376200087516821213 -0.49758162353188195581 1.8038720944003943103 -0.063742354650531130034 -2.5618378535581247668 0.42650187371355341437 -1.0780847400061923658;0.51362294184951640119 0.50065906207643473547 0.75126677143211972876 0.19105703714463628806 -1.4264295986669528471 -0.21565635605617716752 0.66526144523657049223;0.34153021777155823102 -0.80069619721050977468 0.42119929825165169923 -0.97509196206436166143 1.0518444430374571663 -1.3112205381769244106 0.093777884933993665983;0.86499221096085954219 0.69882593820713589938 -0.42831165893920408738 0.81645558310231947097 -1.539502067728785617 -0.35821128943942015521 0.67716956431626573742;0.40283215237258945818 -0.92785737774135179645 -1.2949436442022366212 0.95074028270481958369 1.0293714327311673795 1.0827724862066339107 -0.56392157090892736093;0.065834275668774588919 1.5620300065200480866 -0.10376305049972053829 -0.38650014619990841203 -1.2930979227756635996 -0.72749312391871145955 -0.49351073568094355748;0.7825445195838756085 -0.97393058689129363703 0.37291520579819525949 -0.33790632355514987895 -1.0358572649137645083 -1.8159197221025564772 1.2859202496856907416;0.54890320356141841796 -0.86299941784231692932 0.24301886840036168724 0.88017295923369454069 1.3089116251226371457 -0.1570850477631006159 -0.80606994881125704211;-0.03701387635740310128 -0.36081975786501796488 0.56133411616865036553 1.3522552961463176757 1.3148981610341012871 -0.089214773217219114909 1.3689589358787981332;-0.5418713889121586913 -1.5340666449857407461 0.64251655698497955882 0.62074577534727892747 0.38003816811637958217 -0.86997609748596205215 0.76714933505451599061;-0.064548243818542710981 0.34784641953647477131 0.62473631870043278003 -0.36527362665642693074 -1.7890374652852059079 0.98582921239558862769 0.41151077430133076174];

% Layer 2
b2 = [-1.5706929942935823341;-1.5742391175458836372;-1.2738181284002614291;1.0202285718051173902;1.1135351845791905401;0.60651894845650899946;0.55229693790591072311;0.506645522010574334;0.49287478941645479491;-0.28060500981299779655;0.32855395079679322601;-0.10515004201488266367;-0.52586816139169345607;0.53524235359650329524;-1.0434526597428674943;-0.99184928056795995666;1.0806803404806231139;-1.3943731046375529292;1.3869126579328328042;1.6090335957455224047];
LW2_1 = [0.18953493648125185889 0.13397003284816380586 -0.38129151467068600478 0.66272890788483429514 -0.10084114221975791492 -0.21352104156451917616 -0.42236649089513361721 -0.44520985854744005161 0.67594602900031708348 -0.44255102869996010284 0.2164937469531318659 0.0027975846592088633724 -0.46461218616839555784 0.93841276647649651821 0.16255594657069372122 -0.52422013765952213404 -0.088807802739604049802 -0.20567018770615691503 -0.43197821047890194723 0.27911980668049329868;-0.20671981794439134306 -0.77835529152943860876 -0.15392174916547610164 -0.16385452737324168737 -0.23949577872355928831 -0.25162011476082235539 0.64236059027364622587 0.28949292965580908366 0.25612475915730675835 -0.040322572070657619614 -0.10506255282021895181 -0.37393184932812606469 0.46384673123250746984 -0.89836993610857629466 0.23601384221763829774 -0.27959427200268854863 0.53089844627455196058 0.47389032479396131503 0.025799893832080748879 -0.75168290335444309935;0.42539660390173111848 0.65391840630184383532 -0.15260113395554064653 0.34384586042847548049 -0.71504742540681498486 -0.5880579971928355798 0.33222725814413883727 -0.18814075392594198366 0.15879752390853418831 -0.25971296910182389839 -0.23076655209100482846 0.15645128202941899209 -0.087421413281824206232 -0.15327478659547630335 -0.22024681981789773211 0.17127414149895092699 0.4523638730393666485 -0.30615350749128433794 0.020742058445049820631 -0.75974597167604907;0.3626758720496790489 0.19836429035121178055 -0.14288284889022923041 -0.030825388820692377345 -0.78467964100387377346 0.62839740287624745729 0.43411857796201303028 0.5746049094257288381 0.35748313298375561375 -0.28417059800851379725 0.4057225295873898574 0.3087420008011798056 -0.68818185957390531904 0.22414827235924184023 -0.16877631199912346283 -0.85665904280951232774 -0.14929882729901133853 -0.66442901012282973294 0.046394912158774510857 -0.29372400137399556908;-0.44638688409505178356 -0.5013688141987902025 -0.033801254426872630321 -0.20941935357762533898 -0.36299361719105421864 0.17316562151555914273 0.4724173797712766798 -0.40758346367980236025 -0.098584674847857087232 0.013583696953345271788 -0.02784088093412569187 0.75373102857572071844 -0.12931717748382329236 0.36905882453429222911 0.21022217013057073465 0.16579459636435109338 -0.18051675292338584256 0.78932201361494369607 -0.39746376296716312559 0.17178888380592327589;-0.47379682673389972303 -0.24177523153542893053 0.16851115452047757404 -0.46578364758889351238 0.39216781470061479187 0.58935656659157864556 0.7587721622228207341 0.41841747920890304258 0.84126329369514829537 -0.10207200779277959823 0.098161858616024610935 0.21508515495355870484 -0.10654860598584948994 0.10539010088928578435 0.58224780394129438399 -0.15190351246167371757 -0.16043302605116951942 0.15283201550502842347 0.43684080030321298382 -0.78842725191626383818;-0.34218979312167208118 -0.30857800507617594299 -0.1757368915479842475 0.90513223307836998544 0.14641600170408219928 -0.71109127140453376459 -0.33350485418518305281 -0.36786871785281993752 0.44869120118773353489 1.1336048527053994572 -0.37145205678648673953 0.05139113907049941421 0.31044125648695131137 -0.38719172964104453527 -0.23350218620347068521 0.65160518386230981136 -0.12303944603847791206 0.73132414929962608063 0.29105504537822729505 0.67303702062200188028;-0.31179695509597227243 0.40658759153061796443 -0.65252567364345959167 0.11820885195144624491 0.57352837189297301013 -0.30117776579988314589 1.308161325777351669 -0.25825273233293527531 -0.21665342552401550824 0.42846696587818078328 0.22127769520114873303 -0.34887176257093355236 -0.33081582931351594112 -0.14387644492885731662 0.026964835580579132879 0.14710728576050116634 -0.26405201169588649046 -0.40554683536671953803 0.4413200604403957894 0.47778478939268087533;-0.66450219953634970249 -0.540994701255053001 -0.3111556021155589824 -0.23286294368732637916 0.55303699791389404616 0.33309133124644435542 -0.0087785472987394128075 -0.32794926445471189735 -0.57143773224660032728 0.032680036554980543273 -0.46682328245742193973 0.15314570218426856729 -0.46255807355969752459 -0.54318478734705077926 -0.14666365376437645596 -0.16708234266835073067 0.58491846160082638928 0.58567536384735752186 -0.11152571891233956092 -0.092238275258280363889;0.025125496916419406274 -0.23211305504302373603 0.56972452831763487069 -0.21663495405332269805 -0.41692413067801564752 0.16306558490374187254 0.14847248199527801615 -0.40640712023380248796 -0.36502885031109694181 -0.49446616830178402591 0.38549341886683174963 -0.54233087432430382435 -0.0036617103030327675939 0.30427944030766573835 -0.50938577966675790965 0.72331822825567060331 -0.32068773610167872201 -0.4590880818377603978 -0.64900142080071465678 -0.086376301818672202026;0.00074824076846866961754 0.078835756870773279759 0.5418922216606981701 -0.050970008424140789138 -0.36040158423182172553 0.27311099281348433232 -0.56587755292016406194 0.47095620564972956457 0.22090230435205268633 1.3219354469813913155 0.60008040009903418355 -0.21358667241238812884 -0.073736984138950675827 0.2560534841079054047 -0.040294457268696154406 -0.34724604650680568341 0.91760707828916632245 -0.11592873448775675715 0.23954643870172559472 0.44484041415411212927;-0.12148072344101365494 0.16133945200534130504 0.0069795698381467305427 -0.49344534588701860489 0.13608686675533865351 0.007464442141688888005 -0.15389130023369651523 0.24138487661635110726 -0.21283365710416196626 1.1116555599245692143 0.50493569977320862385 -0.33562437112867532507 0.032747626221065292973 -0.55144989343789696523 -0.23089966885615981207 -0.58330502690677921152 -0.41583108752631947613 0.67860032272315029545 0.51607944356231838512 0.57117867615865669517;-0.37772199226392622062 -0.23332001141667407795 0.14208233930302602288 -0.0073107129461922638891 0.18308909372166204399 -0.60470923163441425707 -0.41220744810587683915 -0.44038917228561319517 -0.23842053279169458935 -0.66209446120528303581 0.66712967658398547588 -0.22666962537406926126 0.17604894877839996625 -0.28572206884857331843 0.21348111017605150841 0.23158018246385730921 0.46128231877604869426 -0.10235743273980016377 -0.2055767980641955428 -0.025588301498149577939;-0.068260078341584706774 -0.39490725585553299037 -0.093636743047834772313 0.68166057367792298738 0.50584865091513198099 -0.9343747956056323023 -0.04821975608588151968 -0.027137110617900462445 -0.43995662090245457598 -0.72809724375884876668 0.057541951372775110296 0.11116755324825509932 -0.37044794679281534133 0.40387996354987348857 0.59689115002297943313 -0.40404315537022506 0.50022761191876108366 0.31821148107116764558 0.48426665354372422367 -0.14339587130830422357;-0.39286443338844218021 -0.81843492785436733339 0.64061903203522829742 0.30764771276327562699 0.26981356901012126803 0.20006469336244714352 -0.22333358353831325727 -0.6211653583882987828 -0.0075275466222182799148 0.68181148470432306752 -0.17439078616724831838 0.20299417188378729437 -0.13613153977952746621 -1.099502533024222517 -0.37296986596827036431 0.24041118440959668989 -0.42411807536968781918 -0.57338902936110913711 -0.32077083467458566979 0.053686866371890872018;0.073532468182449281513 0.048618757108611708462 0.53795805067198354532 0.20231327873175103393 -0.20003985027656487339 0.36746881677322301707 -0.048556083341827337152 -0.014141023795281537634 -0.56307655279475565813 -0.28908059481290887538 0.2104867119544080456 -0.62229123558254484383 0.12841325615741880362 0.35774236305560913607 0.061734281925656039891 0.19016017659058401246 0.092503727407770061641 -0.85764050460715890445 -0.30089970517361391833 -0.43388408134827183282;0.8227473636079570829 0.13927592636773977741 -0.09114792029362200898 -0.62184197662256834871 0.13151314474204944815 -0.30855378719359483064 0.055925490621484663656 -0.026615737892297347544 -0.28675004117664265602 -1.2357658769612915872 0.26277838240092538102 -0.013418405172858980171 0.59655279320410015131 0.44230944437903024768 -0.15648631835353069008 0.57803792407637388795 -0.71995296403800124185 -0.25383341377761847735 -0.44904673654808374694 -0.010006896119919960614;-0.5131002499162716779 -0.39426375639356575631 -0.045313676747304784675 0.40574119887297482867 -0.37019801842940924796 0.31171586294638903292 0.16741114273376320187 -0.37759460073778966516 -0.12365721088914610748 -0.83726519049598235878 0.16772265475102390853 -0.23497935307619402523 0.23545212295789047507 0.13977280710188999535 -0.22173439133387037869 0.21858898392426337476 0.51551099456403826071 0.06296372897024138382 -0.039247818835035190588 -0.45596808207766437171;0.28682256038086445527 0.57331140249073453408 0.38227437866244035058 0.75294085319882375629 0.054392271158669347475 -0.56575487109226141325 0.41803292882125836494 -0.31030415099583080751 -0.67122295342969540144 -0.40411308975871151894 -0.024909250904479679489 -0.29994360146755455476 -0.29858211407517898373 0.21056089838373603929 0.16285147347714362676 -0.41901419296523223501 -0.41917792782551671626 -0.25120353248053423068 0.45708537130111337454 -0.033449469200835385552;0.075155655831185677607 -0.62377473376144643158 0.34033494863310626011 0.32929836370787862743 -0.34340057718055810865 0.411025135165046962 -0.23761089578944455392 -0.072767634117996082832 -0.30534772910807844726 0.041468002210513617289 -0.38584366379994405882 0.28566590550683162997 0.043669292150713981404 -0.77332059135254505033 -0.45017219581198286704 0.55832926968886376073 -0.5648764309148435192 0.7195171873576210464 0.66870025639619024016 -0.36156999587571386767];

% Layer 3
b3 = -0.28432120880995898071;
LW3_2 = [-0.83423656170138060784 0.71271583307376917826 -0.48739641209399237054 -0.75906308145707512836 0.37501802763697150711 -0.47391007430534365374 -1.1309746684675723305 -1.021634710987895156 0.8552732649241530094 -0.95710714721794531989 0.59682544058947328836 -0.65126064858155630066 -0.37423866584810028257 -1.0977151550969475036 1.3955790576941897729 0.51776484159929458961 0.79292100764450923478 0.93121008477041333773 -0.16654129997489591775 -0.87066035057819624043];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
