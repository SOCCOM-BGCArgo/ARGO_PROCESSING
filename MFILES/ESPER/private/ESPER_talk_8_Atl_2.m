function [Y,Xf,Af] = ESPER_talk_8_Atl_2(X,~,~)
%ESPER_TALK_8_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:47.
% 
% [Y] = ESPER_talk_8_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4729694262489916;1.93780201678901;-1.7880682464293209;3.7830906347947888;-1.6130869443373681;1.5563797507230588;1.2999476032923367;-1.1598952280782666;-1.3016250402377489;-1.8093999950104391;-0.53200617433678088;1.4645177222847308;0.020631490386566344;0.095729886903551886;1.5541814363473589;-1.5816680176014188;-3.66615044373096;1.4185681182182583;-0.068167780057588043;-2.4050887391204858];
IW1_1 = [-1.3365355851801506 0.49158147737858704 -0.59604685007637559 0.25990049106878144 -1.4088504906600465 -0.45223372883343854;-0.84996081184451633 -0.56067046168199797 0.87446118848398413 -1.6062761395790761 0.80775073572227785 1.2451451810168856;1.7912654358997762 0.65683324205500138 -2.674164779898017 -0.55434291061029783 1.1777691338825675 -0.20019810125732843;0.10041397977221315 0.82467891496309798 -5.9453605442948909 0.25128615341136618 2.8214089286936757 -1.1789204887865743;1.1900807450842841 -0.44063081948262472 -2.1799155621575474 -1.8732413319690617 -2.922667803844277 0.20539803976361123;-1.1347823378266113 -1.2684452106084372 0.15700629377187428 -0.82164801742938731 -2.6903293010864653 0.90561079088847174;0.51550227771558521 2.0550450659801571 1.6352108727938166 -0.27419604243080337 -2.8143082334963525 0.16998677974865092;-0.71231717320859611 0.24760960237301832 -0.24662851028385346 1.3909280540135089 3.5521110835624712 0.82727184795323305;1.4699802111968037 0.61235699391362475 -4.0940722052599829 0.16190995383457399 0.87820061613533096 0.43363364227022594;2.0285489640095355 -1.4638254456788118 2.3347507736175386 0.0078777022781821408 1.653139458257171 -1.3433064711954048;-1.9863753098775787 0.33168067154465902 -1.0662572091118703 2.7087566515600048 0.49432475197435322 -0.61259938933290348;2.3206830385518002 1.2147872338081993 -0.3286022898830574 -0.3969965413162474 -0.84356596459823741 -0.6562352157236695;-2.1717090009018016 1.7092520950200307 -1.7175415869970394 0.63141745597768062 0.85661409161050428 -1.8235434124187284;-0.005491847432843918 -1.59388922589743 0.20459889523824007 -1.3003313473717324 1.5384966531545059 1.1766630851394819;0.86457622880407037 -2.0338729319485016 0.31572627818343202 -1.1365884145920369 -0.32625248219361325 2.7678333895380796;-1.0787444446029326 0.13433111791655916 -0.06866306016203319 0.030964177669158655 3.1811247899425981 -0.63964014195043384;-0.16628444666263342 0.29721171137595404 0.83817807837635949 1.3593961272146153 3.7226915915837782 -1.3947542382924831;0.40364600796775235 0.8200755846374761 -1.1571437220283607 0.31198247350440289 -0.64233013856467935 1.3774401244542691;0.17906539867458759 2.342687248873137 1.1532690537238062 -1.060536513270109 -2.4558446890696404 2.6013139818200077;0.021676263508981854 -2.4306816566449836 0.57874123657811738 -1.031318349553719 -1.6325524940331477 -0.72502869796349045];

% Layer 2
b2 = [2.2079335061110021;-1.9711886663204619;1.7932539750586483;-2.3449298855505192;-1.9686117307378934;0.14755280994070155;-1.3388949351118609;-0.17213897055406874;-0.62895330949731365;0.17483878904003425;-0.29125790686889819;-0.14005182033424571;-1.815587677386451;0.72436397757287307;1.4533169213867838;-2.1560622189986782;-2.0060841177872577;2.9131057885476412;-0.91612116107309516;1.6429922377471655];
LW2_1 = [-1.5160160165535355 0.032480520161729469 0.97017942085319253 -0.086975105867944019 -0.024315253674969436 2.1337344960601143 -1.0155687565226192 -1.2770066933790023 1.4686150914615326 0.77809950139575423 0.37538905973523617 -0.69184430330880509 0.54635117077871465 -1.0535126690643897 2.1205552132968921 0.93093539030887074 1.728559861033705 -0.73285381317918208 -0.065445452284059805 -0.39817955660991089;-0.6297992923534429 -0.10210071121831829 -0.068370497460236171 0.22591471518069295 -0.20219331996378662 -0.63355622518379284 0.94126578687063112 -0.36819704511803386 0.78590711882544639 -0.32919497733491265 0.74153583206932328 0.72361852699418339 0.46193789484250369 1.2322861707925168 -0.92781782083995512 0.17251537110526394 0.54047897707261028 -0.096983706455945493 -0.36472228856523115 0.27656956074924843;-1.4201121578735463 -0.13991885963114364 0.26947816985377354 0.88951405526390281 0.94078197786422124 0.058713391294117172 1.9884975806388898 0.3755097403462303 -0.10527771949643547 -0.33183203170229258 0.32683851220991245 0.43853158393606817 0.27859576038322154 0.30813938660802576 -0.047632334591869101 0.014388997896946462 0.99459615719837391 1.1075353750950705 -0.16021232687219805 1.0266980102640082;0.021497853364813243 -1.759310557762862 -0.37932393209749871 0.42072340366525762 1.9786828338793196 0.78501562710218087 0.44899712301824612 0.16781838911702091 0.32010772946292931 0.5540844221549549 -1.2684286090348287 -0.73001107004085319 0.19155581860625789 -0.15689581615194059 -0.12767227294528957 -1.1498008397119031 -1.6955526843211206 -1.9321668304537294 0.2023352864335218 -0.30514904570927126;1.5646966140357599 0.064717111853289544 1.0559334794657282 0.98996198154852777 0.0042606779884339745 1.0360395545747856 0.012023290448475114 0.032925863602257903 -0.50370200128989195 -0.58828193685475638 0.3872669975666293 1.2234969172156389 -0.11138450939087659 -0.91729034919509223 0.47444058698404995 -1.1675677186931863 -0.17142191720450334 -0.31484432691772701 -0.47715248406995103 -0.93802465476843144;0.30066227674096568 -0.57144813022202867 -0.52006177309016488 -1.135111294748588 0.80518437868641324 -1.525357479413104 -1.4530313080229136 0.29015526499529909 -0.47732679459656407 -0.21192766990531581 -1.5671488130562168 0.17851508381768832 0.96704976790019415 -1.2116794058542666 -0.62079806571447627 -0.22825363916624497 0.93006734603704333 -0.44491758173973067 0.23529997498448973 0.075087897552227875;0.82617026745720623 -1.0333265715219413 1.0788669354392053 -1.1547720164997912 -0.29446287977078905 -2.5099818483662899 0.70483081599730657 -1.1529056966503399 -0.24330150091113315 0.04296223065503587 -0.72622942377039645 0.03662265275407988 -1.5239854672638495 -1.074384462278043 -0.56761938894167729 -0.32983860300710155 1.0855654504901224 -1.2894445962585801 1.5601406069667023 -0.60927594893953019;-2.0215989781142492 -0.97667868373642763 -1.6080910674721334 2.3530654378293057 0.5271621062557531 -0.44641496899401195 0.3882984310524511 0.17460104265108195 -0.9084773107434152 -2.1188030735086274 -0.45674143243503135 -1.2936177602991323 -0.57775012858376262 -0.85154713670974169 1.9064429272930736 2.3078507046186387 0.9215304260019479 -0.43448892489867058 0.21380432605754307 1.3737417762833233;0.40409061438292099 0.028986230336434091 -0.44591044618418474 1.2191567808202624 -1.6645695962672555 0.099872929477334296 -0.84292050292569642 0.084195517404560105 1.0635163525305023 -0.63002999277672977 -0.070940009596308973 -1.150525661769362 1.0880340864642561 -0.51884283724911495 -0.54108670538284787 -0.6465367883013281 -1.2398623088957199 0.65347273577564868 0.29717910461051394 0.20067931772566058;0.34124757905028186 0.3082320316789019 0.79392383688876456 0.14308217236668089 0.4835876355548171 0.70217765279119149 1.729569537158689 0.88611172170970143 1.1815271473854838 -0.58023368250029073 0.69322374928467001 2.2293676274980658 -0.39375354367151982 1.304753418733188 -0.63232963828967603 0.84724296859264925 -1.4036731663529638 0.44272749974152537 -1.1352816480378298 0.27403210649035281;0.38388482800975476 0.57595153982342984 0.46680800944552081 1.2989193054036201 -0.12301380245368493 -0.6888215589824318 0.63538565831978622 2.152302966812051 1.0466116521124134 -0.65741592834441032 0.083439283911205364 -0.49698819625799123 0.40200610066410636 -0.034371845084688296 -0.78438601262570273 -0.95186163238607757 -1.8426866032313065 -0.21896930074744034 -1.0957031780509507 2.2143685521959693;-0.54552281098503452 0.40728804582532602 -0.39941521652611955 0.25266470472296687 2.1452905908615518 0.28374353161820065 0.54595341698606037 -0.2928126998852843 0.77939010929154373 1.7352095941205956 -0.78675708000620326 -1.2495247477617684 1.2488251787590599 -1.0350854435497379 0.043711844857079463 2.0360010241714539 0.95514489887619702 0.27783644450202105 0.074219908238648102 -0.13519828156454008;-0.55451833704069298 -0.58081436342735049 1.6575361326637346 -0.94879320680759782 -1.1102874898641391 -0.22321649042011915 -0.29500802592856706 1.6198145305423901 -0.79069605532990606 0.12998616757072859 -0.86718855567044817 0.26743462986844208 0.11855407523186132 0.39910084155996239 -2.0489033322289414 0.19250313119527548 0.33814880738262565 -4.1185975874227339 -0.29450431485875617 1.9233127474949701;0.5937667977435731 0.34563095335851834 -0.20738226851296537 -0.55225454080530589 0.24555948464769298 -0.29796903537994762 0.65903710865796705 -0.66669278559468326 0.83545868910792886 0.089185032016336332 0.94011127976105413 0.78809788039190731 0.57056891312847058 -0.1963617794261806 0.73362242995296134 -1.378055150551206 -0.73436226406278782 -0.14268132086142798 0.097301081374032497 0.62017784003998788;1.0472039210643194 0.50828243931645778 -1.3733748883685382 -0.25075973488166825 -2.0533278016031282 -1.1641763034439074 1.3617396929709618 -0.34238233976372462 0.5072717101251758 -1.2245288911080487 0.63143274426610341 1.1293988023123596 0.77596097003675046 0.48889361818014399 -0.51177503951128911 -2.9838304525613402 -0.7728977688692209 -1.119665336602691 -1.0300494747428814 0.16192701829437903;-1.122377671615151 -0.40080539377614982 0.66251929208390659 0.7715316323702619 0.35925765149713379 -0.24667136642809162 0.084782976675389601 0.041074332231474123 0.28147894886473773 -0.53535933817962911 0.30068184443442364 0.68482923410626151 0.46533958018783755 0.023597120858259955 0.053969911784933024 0.61964148209716585 0.16560719275423777 -1.4727931482381134 0.097753157924168874 -1.4665420573349688;-0.26942427227000115 -0.79422279362422044 0.93019595690968659 0.30264515946134829 -0.5557317479562125 0.39254945843028094 -0.50773141309132896 -0.39138471807746844 -0.20090830911038376 1.3041211906471111 -0.65334311080189067 -0.013785895723266627 0.46017571258341483 -0.081654529152233563 -1.1704457003424626 -0.1950790595511363 -1.8221410800599689 0.079877302804134409 0.7140606166916279 0.61501727811685181;-0.60716356981149733 2.1475315133421504 -5.7225045207426266 -4.7543344709495905 1.4834871185855423 -0.20827871056656991 -3.2230305416713882 -1.478174564466211 3.6182281890976928 1.8976974146622509 -0.8756850948320769 2.2276783878073805 0.9302069776678159 -0.49041900024580432 -2.1902597423539993 1.0630207879765163 -0.92385667354140122 0.87997940858631674 -0.16444858321257899 -3.2844906873988529;0.42690206228804656 0.81569727586800189 -0.94100454984033222 0.04086663794614559 1.6869993594247492 0.12592164352987553 2.0207922453286842 -0.7719427438766876 -0.77420156924948347 -0.64334305663438207 1.3974711237002067 2.1120065325690054 -0.66017571417688126 -0.22757150645733443 2.5715013652485896 -0.20395786826759404 -0.93050585432026345 -0.20596635659044099 0.85380085811396256 0.44580745346565659;1.7786326004185702 0.25132668556300147 -0.059504902504825888 1.6282407878623149 -2.0589676136938517 2.1102040134016771 1.8187094327516702 -1.5530401016973565 2.8224985734185033 0.089491868201664687 0.473716461845749 -0.96046598724310561 -0.49645745634113592 1.0564648778543393 1.4811446686647349 2.249965892766788 1.1256098582295002 1.2065042262471226 -0.27593652796430701 1.7941083214415046];

% Layer 3
b3 = 0.16398395559284609;
LW3_2 = [0.039382637202390998 -0.13745048896088854 0.031148534665686685 -0.64522379195803425 -0.089368433910646042 -0.014123941617488318 -0.028046463260568474 -0.02475881293811719 -0.040270848328363751 0.039997546234267309 0.038467340238369382 0.017798373248578286 -0.063638683847716773 -0.058608946835179039 -0.029699511525962542 0.1779552685323168 0.051549455536809903 -0.32446977748400146 -0.023795016198339788 -0.049035882098148062];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
