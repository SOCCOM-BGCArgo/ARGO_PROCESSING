function [Y,Xf,Af] = ESPER_silicate_5_Atl_4(X,~,~)
%ESPER_SILICATE_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.37458922728889426645;4.160889775202528007;-2.4310051299899391175;-1.7299641831831049643;13.590720939601562023;7.8536136286091142722;1.032241153342493778;1.1822567747144785422;2.102159001069032751;-4.8126837954731556124;-0.43601075610209411026;0.96779067307250188357;-2.2128493834781632899;1.6199839279653582835;-0.43441613618640562144;0.6604883700186809925;0.33357526084062938398;3.8443533644741831878;3.052183381479234292;-4.9245995946101350782;-4.626533011553509489;6.5505319975879423566;2.7875164575471083062;-9.168457375510694618;-5.5254412134682384661;-1.7999650366912447463;-1.3467929242208627194;-2.3289078040623225618;-13.984153086991353732;-1.2589071863060536938];
IW1_1 = [0.33392159482123284775 0.59474231978351677075 0.17521688415585226495 -0.11751411620877001696 0.24791235760469773619 0.039481350615693404371 -0.4443559848833872894 0.25003809778630770033;-1.3732052078045371424 -0.9521658375329010715 0.467847606080039502 0.20158100767109154994 1.1771986498136706167 2.5656062777597146152 -0.30296117915068926374 -0.36449423086254867377;-0.47753480978559870174 1.0598863239428286676 0.91463768816802459849 -0.17011031164403547788 3.2026656273479634507 -1.0613943413489175249 -1.2867951650240274653 0.013910021889614250165;0.059386863412361351466 -0.85055917263733860079 -1.2883509235749548427 0.28974692906436749773 1.3883385112906201364 0.83458456371325673295 0.23769618160974356758 -0.16703517924720023835;-0.62558202838757193121 -0.89600569521359485492 0.12297767597517060556 -0.70249238925259183119 -3.8362422606298913763 10.586626193027040443 3.9926381373169097522 2.107153594016494047;-2.3409325886235747838 0.565724424407951898 -5.5297044100436592018 0.27786468064469771466 -10.982488366162165505 -0.0062387511804983340064 0.90694673717624130216 8.4607355800040764393;0.46231295741926214937 -0.19675024572752120022 0.77239396008204164179 0.76625649594395639497 -0.061638299397144158398 0.33752763097412169513 -0.13329403593231647918 0.55385584079357985665;0.26326318805724496785 -0.36327227511779008884 0.11268370652661802156 -0.072418125123427948275 -0.53952067727479124937 0.28734873769297664126 0.0087362649462985435267 0.74939401552904216786;0.31001374759441202578 -0.32401403691508245952 0.89386535013202883526 1.3162068680443841373 -1.9066805579254093583 -0.36775139071435503091 -0.48812823354404227816 0.77496253286926797266;0.72003178579648197122 -0.28432570398162221315 1.9655815136861352066 -1.0185306650590961741 3.3493350904386236522 0.076532580965802551876 -1.7765318048822886787 -0.016599966861249773609;-0.70033713712387557493 0.2710059736658695928 -1.4770308302909913589 -0.16862346375637285445 0.72578027970735559116 -0.7516354698615429486 -0.14527004903164217331 0.67077264657742252663;-0.29540081868492290562 1.7144126789133089517 0.31979556630863226196 0.56122062755424040326 -3.014744649071777971 -1.398107428925632334 0.14579224528139975159 0.82071640142580637445;-1.1748225197519817087 1.2495832317265438416 -0.81918895455967000174 1.328488105448708545 1.6618263109054209892 -2.5272327273248897939 0.022861867087266261184 -1.1933007535132675869;0.34079894827901496823 -0.076686376059771396707 0.07481311380216883189 1.0927125946640512399 -0.70524998782226577809 0.32597242621520383654 -0.29612172846322293296 0.52594083689560011674;-1.4086860141593393614 1.0718737616963049941 -1.0948706632861404664 -2.4323672345591758059 -3.370682220325103895 0.034856393903711722915 -0.054183945197581545594 1.2220273839232409507;0.030318371954392353551 0.20490391472971439257 -0.48955255241186812487 0.68509240594617193398 -4.4885065234481142937 -4.013818030698628192 1.4704266473236964341 -3.6152708129286104111;-0.19378532771840545346 0.30172788226391916711 -1.1103367807039659088 -0.71816879335763983416 -1.0086630619282668242 0.35957624504609964067 1.1830910100948373032 -1.5468098030566705958;-2.5756468866276560625 3.9806208807224132684 -4.6132620575762093296 0.46494007874128656654 -2.6701554539630962815 4.0111082891763638614 1.1425410999699887604 -0.45815136709268189374;0.45227146516253502462 0.88900635748680789661 0.44254075574231344081 -0.28985064540331406668 -2.6954797066980371589 1.2244876492930980572 -0.42805350671434377885 2.5981196239386488145;-0.081164170725096768111 0.34029816890771596993 -0.72186856734095050658 0.10438050711897510492 2.6511331247800469235 -4.8181038755531933049 1.3125867538324316186 -2.9165330153926416479;-0.52278302731349179933 -0.95654203812092952752 -0.97864894697023940839 -0.3850434999457255647 3.1263924003870444679 -2.0709683300259928984 0.58572294290984605603 -3.1118809618394487337;-0.15498125650110541884 -4.7148422387032660197 -7.1711477165030119707 6.1016850253852101815 -4.8635022258192588396 -5.833297343580190919 -3.4922307512288184306 7.2542180285034625342;0.35678189147577132889 -0.42985760576164711022 0.24698061857889747062 -0.22381667766610990888 -0.45489287909213937944 1.7009149088937376426 0.35758314457657242036 0.87296066802082128433;-2.2243777407255302947 1.4475074668136489464 -1.456568179039837041 -3.2708818217127579864 6.6153891926014685154 -3.915959694105842992 -2.478942776250935065 1.9631176572725017593;0.27210192026323876124 1.3201441591839047085 -2.5032378729615500923 0.42403531231292068693 6.1156727736414477903 2.0099747097927220807 1.1853063092801157108 -0.11523551928225744811;-1.1397354279697786694 -6.5680595952824374351 4.4288574427947873247 4.941636598656983459 6.4344597932870382095 2.2076155214524750825 -7.8214723638732950306 1.3212724263774893174;-0.1110180935106097333 -0.068339770613398673205 -0.083477368316159900052 -1.1120468901037374732 0.64200356036919792313 0.44323208055830742857 0.43219202090017061479 -0.41171400799291879569;-0.33741972259584446237 0.16792766523049160177 -0.50594604467316162122 -1.7442401475697619784 2.1647937077210355206 0.63121461296394498763 0.43639084299173186432 -1.0521901185407358525;-1.8721258730344843002 0.32702312126093519007 -16.675168330402282635 1.8535845710995086932 7.0738658392221545057 -15.53469719835536722 -15.813655175758313476 -10.48464285788255701;-0.31122953991670693208 -0.10591894325881173744 0.39103778209613737626 0.062078487696967617204 -0.29566876317958978859 -0.47227065310572358126 -1.311637197573178204 -0.080934517888078025272];

% Layer 2
b2 = [-23.331371736529170846;24.722594516601386516;-3.6617386250478034526;-7.7713566088771166562;12.709293177536507002;4.1405260241085732886;9.8855800833974871722;2.1669350728265608375;-3.7488172440952776121;-8.2218491887571492072];
LW2_1 = [6.0053740936876662815 2.768120464239349765 -0.44392978292266932483 -3.1648224413267969091 3.942322008748985418 -5.9882022036744988469 5.3325316279038093015 0.73409957275822157463 1.3625664349955701748 3.7368490202016197976 8.3675528387566533439 -4.5416424953106453444 -0.81111909392458458878 -1.5149457033085360624 -3.623015007550487443 -1.3396333385986904929 2.2242226967381375502 5.7450065751480785536 2.2168094321986457906 8.3608992786469507053 -3.367126232283751186 -3.1700965403820275945 5.921222800423992183 -0.22418866071921969563 -6.0690381769789114585 0.010022326688389825849 -1.1700172191330460159 4.9086710513255082944 0.040929190199151553597 3.2695895753143364715;-16.941486050934436491 6.0348595826952475818 1.3354580166002136821 1.6186169120081344008 -2.7651976541323421976 0.32349117318006248567 -15.988297843250883545 -3.3428680437068827302 9.5082447319361804716 2.6099470686318735346 -8.8183300128296870923 0.86013914907153965483 -1.5464329911036429621 1.5936946529852540344 3.7956624812676715841 3.7808246881805773754 -7.1988171535661082956 2.2471446989730594623 5.6437026618942898182 -5.3720268512180329168 6.943808402592135387 -0.51743895643915160942 -15.152567479487178304 -1.7096939715122176917 5.6082393641321610644 0.43272674639170682909 -2.465723793000716757 7.1607453156886773371 -0.39723603825509146148 -8.6990651472780253783;-44.939294065756932639 13.032208656836999694 9.1154483982154719257 15.434597392583377484 1.8993552230954517945 -6.1498773238171304811 -19.469571684448681026 3.4285996915704051169 3.0990390835647101397 18.892186491354266309 3.6530813533577126684 -3.1397395988066869599 8.2426084096285698877 6.198776890446091592 5.5828962278984128886 2.984434128643495665 -15.881577266716353947 10.394923816092493496 -7.8512399882658012729 -3.437842049159142821 -0.77048387137713958417 -15.072282424223812924 12.226700964376869152 -0.95124912319821186557 -0.31033326136433542208 -4.6436547324109911372 10.313238706417989121 -5.1736744881452896294 25.784414890689159705 -8.1984413035727854435;-0.14895230800643532998 3.7389805909888407243 0.41813908257408660685 -1.7938413038437186486 7.8549573167985657918 0.031674603635573166105 -7.369371441855961713 21.257780731558465703 4.5533912005028582826 0.49702501710715230043 0.55985160917438048234 1.350572301319636459 -0.31189012831090201505 3.8033669427943461727 -0.5790072547523771318 -1.2745501775185053006 0.5272593604538924339 -0.49247611386288753232 -2.7669461291377674961 1.7245732428742015507 -2.6189529534029505342 -0.10175034888111970932 -24.020938304901516602 0.031618545370821697638 1.599343935315294063 -0.035104248758851770706 0.30386937678825554077 2.4791719129626819118 0.013349391040292788585 -3.5614669754212520125;31.153983617452873034 -13.505154734781978476 -29.081608552260242107 -32.75092284593826264 -6.038844105497630288 16.853328804906347216 -14.484036258201335556 26.922402997353110266 -24.010307030655667404 -9.9327251038482753387 18.998822748426178464 18.610597316036937343 -0.67578462906941660915 -13.317934269948215942 -12.889176632850610105 -18.516503687297984015 1.3477147176341615076 -1.6264783597836125484 -16.697337378024556642 6.8532536928069021087 21.949091857283452356 0.071438967356488441984 67.322185531494881161 -20.01003131105398225 -5.1831949050260792689 -5.4633421531623245215 13.82500662193549168 -19.987898968724238102 0.033126321862796112572 35.605870590125690001;3.4841544051267749893 -0.78700716440592499712 -1.8187769023946889213 2.1640297684676790269 -0.0022258125176581274908 0.57907899858244304969 -7.1836569498803610756 1.6985053270459327113 -4.7698502437199321591 -2.202180099896936305 -3.7494186832487006455 -0.82322417571146577764 0.62302033233577736038 -1.0079807313405948488 -0.32897444450068924482 -0.9945595737026056149 -5.9335729607273695052 -1.7186890910833094726 -0.96543623653164267751 1.11807537651832134 -0.99522911514979262027 0.0097790265240190361873 3.0312306200934648892 -0.48683789206837224661 1.0921638719341109081 -0.31766644225424989223 3.8296431084659681154 -3.8875154022943183563 -0.24340856236911292965 3.720165779549948315;-11.669658322805259942 -11.098854403251865008 10.540296290104194554 8.1626012837760235641 6.0991897698640817893 3.8781030387201562704 26.095676988410684061 -15.257779473775388013 1.7908603854129736543 9.6792038769561159484 -0.74883257963091576226 -20.03917754711120125 -17.867073954559625548 -24.602920814761894519 -5.443470097503527505 7.2118206780162514846 14.548209246074721435 -9.3919848775763696835 25.194902925122622861 17.267540183969700252 -6.2255162073780381249 -8.083266909905139741 -14.130130222813367169 13.249063029277003523 3.5080637013405522318 2.9938305843000865281 16.984726628708944673 -19.261290225024868761 17.701853104177153853 15.18658995373146503;-1.5347805480849898707 -10.27057633015682292 0.79739653393758247457 1.3717387603145385633 0.17865166126097375976 -0.12501302267655986511 11.6147512726810902 4.9931962754755927492 -3.9997792554877178439 -1.2981557928516145317 -0.61582722869163497581 -2.133448520501315393 1.3264513419245984593 -8.8973478532050709333 1.5799799979877493517 0.61102470030942024337 1.5346447307279993399 1.2079305256093233467 3.9051975261096099068 -0.75061383957902017006 3.4910702433389362298 -0.054279516998166452146 -4.6938258196561122304 -0.3031945460241961543 -4.5543267574443806467 0.049927789022960050724 -11.005535217132074166 1.9691398429326647523 0.025836804587602509725 -0.85111620799417786465;6.6527472653154271498 4.2725520578253668447 -0.52992951133304389 -0.59956389878259830351 1.9626668086436034333 0.65124756448978571299 -7.8519751047239845221 -2.489897820121770522 4.5110685220399577844 -0.43303458692213459003 -0.25350039991513345639 -2.8823409593935527262 -1.8525345128841272935 5.6161221911998335798 -3.2849666903532339646 1.4431263309292197139 -0.1014377841190537699 0.8625441060726781739 -4.5950373224955249896 1.7476201718184887213 -7.5183872956152475453 0.098267992218482133615 -5.4641406721108944922 1.7061712989881228086 -5.6575242942548680247 -0.37441701211335415289 11.272441255083352374 -3.1361649448913504479 1.0141637737549713538 3.1952269090775802241;-4.1584263242918826364 0.20338977598310120642 11.081824723711607206 -0.084345000351487661727 2.6337902633752503512 -0.14317938632487681172 8.6216000349745911535 -9.8371965065897217784 5.2396751302968489483 -6.5494756548929560225 -1.4190838281035886848 4.0998965267923175304 -3.5301131291881824303 -6.3332928496105251881 -2.8495943188556567272 3.4564051639220352286 2.7609792445024301522 -12.248386841158476201 -2.4358545689323110039 -1.089486517961428369 -6.4292074110849677382 1.6363662170242800897 -10.319808001778779882 -0.63441653117453877808 1.989150802363699011 -1.0263915517734791827 7.9880035825602604405 -0.56238689503728667152 -0.86566588634585373008 -10.224526084182846475];

% Layer 3
b3 = 0.40089643780902373127;
LW3_2 = [-0.0044258796575745232293 -0.015405746445112845563 -0.0029256507087631780477 1.0032897502347521979 0.0049645322598345685908 -0.061208824689044635803 0.0045191338226409864115 0.28948507439632620297 -0.013933998613515033438 0.010838715403494975781];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
