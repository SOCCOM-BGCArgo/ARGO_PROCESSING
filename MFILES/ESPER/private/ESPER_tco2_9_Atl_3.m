function [Y,Xf,Af] = ESPER_tco2_9_Atl_3(X,~,~)
%ESPER_TCO2_9_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_9_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.4108198866445534;1.1184381633905052;-10.851005068926822;7.9055251011513645;0.99323755430501226;2.4559709626495581;0.31140234931796013;-4.569712534669149;-2.3831960115778572;0.62312506505783694;1.1237765600481682;-0.71236142786002543;-0.79566416818535624;13.14866261548195;-0.8089646506773418;-0.23369571146830848;-2.0094425578164898;2.5224730931117421;1.3177797720716558;0.83566618636325563;-8.3108609169012748;-2.1843933804483733;1.3907439398530514;-5.2069677658422115;0.27737011676874984];
IW1_1 = [-0.75539194085494799 -0.79553218673330728 1.3123481630038358 -1.23887679530216 10.307659268916208 1.4192868955894555 -2.613073672990029 -0.7942571809395399;-1.1674153299456616 -1.3593827952097812 -0.35731076062356248 0.22985655026853768 0.45998416015916183 0.016964850296700092 0.34391712495993815 -0.32921611266086864;6.4004693116270683 1.4060397974049399 0.31153138410489412 -2.3202318871087595 -1.8955391690937748 -0.032780010712628774 -0.99030982447622184 -0.51892040569000253;4.9731676427540741 0.130286466358363 -5.5469853357093406 -1.9702919780581709 -9.8698746188452589 -4.8323736511361632 -0.23881065785056213 -4.2124988842723852;-1.4731724783119085 1.0462113576682532 0.057469944358357339 -0.78535861276667962 1.6002256739123091 0.235759636232933 -1.2163759414817288 -0.22990487915260727;5.193093509837805 -1.1045148898238701 -0.08134340793311011 0.017897529211651886 -10.098396033886084 -3.4428805923597467 1.1922613021664028 3.3272122908998649;-0.30242858233241499 -0.75465298779591428 0.2205622772070184 -0.55002393048117892 0.43681483935413989 0.14804933934164005 0.54547326656537032 -0.19826976564898413;-0.68458430108951829 0.21777843760431961 0.65645833258736075 0.025090480536831279 5.8453610903705409 0.28306509499064325 -0.46728342232719067 0.4971681686492132;-0.96666792973670135 0.3499535880494582 0.35767562624253907 0.10947232523762021 5.8333482377032455 -0.086968337436935356 -1.9710164083502104 0.96426718165122161;1.0490403712256984 1.2393673745155522 0.010407774241230985 -0.25597235597310958 -0.60627380855919777 -0.2313819846831337 -0.14122781607654933 0.59393255854045557;1.050919345630368 0.78726645285156271 -0.15059212553726864 0.26608203471585201 -2.500998782236866 -0.26000212686315261 0.61229560922321902 0.071096082008737876;-0.4163796359297478 -0.21992963480239311 0.14663744176370802 -0.72614139592228766 -1.3746078432600091 -0.57110579051348564 0.21388631535098085 0.57721910573737123;0.70004500183419138 -0.65540957531915178 -0.99887995558647535 0.6370017292187502 0.50827582310133135 0.20801128389135753 0.1227185607476845 -1.0456958248480912;0.12916012833111365 -1.310834447765161 -0.77521640934165359 -1.2744404261086864 -18.081452536722438 1.6860011571889006 0.1852982056353584 -3.3289969705227254;-0.3295687723023597 -0.60181156198454056 -0.10313295125466841 0.0879325822389522 -0.27004009911642796 -0.34991466244111874 0.17393190808291065 0.022369443064510997;0.20514958440403697 0.074789187612193025 -0.15229622189120645 -0.054555628055387453 0.43998893750397583 -0.1450973586459918 -0.082493482334250939 0.72456426681630104;-0.76695166418450567 -1.5254678761452185 0.19791436805953136 -0.64361210240756961 2.1816728172866671 -0.23618654246780268 -0.30638919433759676 1.8208082378296551;1.1808302781620765 -0.42526337245551099 -0.26542565811889773 0.47812184886108777 -5.6851089301177549 -0.57178877730863831 1.1960293114109257 0.05718069728882956;-0.51149465758160628 -0.84378975501952413 0.23632991828512062 -0.012005871149606214 -2.8526626156392298 -0.1932931820549873 0.58011193420758833 -0.85533224133705377;-0.083703618696787732 -0.074226418559810742 -0.66816323908947817 0.58698330390692877 0.4148143340599777 0.45658581575719387 0.31432978776364551 -0.9061718361043043;-0.56946314908392137 0.69246897317566525 0.29412559236273078 -2.0614071405508465 -0.89982798380159246 -4.8926717858926949 -2.8564294168789499 -2.0901744644615916;-0.61310031055843595 -0.24700595328467898 0.097943836827579719 0.076513709323857371 3.064426202772772 -0.15810779157059227 -0.69071565520158895 0.14520829027128546;0.24353627703959316 -0.64453703343892288 -0.40604845082459357 0.44451547416400078 0.61849418008353929 -0.16218095226819174 0.37259485819017946 1.1939597305971721;-0.35563137278926693 0.72710628899471519 -0.29425699159689511 -0.47949926663255549 4.6899520637376533 -1.438025188692859 1.8256258765234508 1.9911411133392738;-0.58748767679777647 0.43121821511547442 -0.31788046955806371 0.10834172833294528 -1.567761488491856 -0.14318810679007218 0.10316039002296318 -0.17793088570819504];

% Layer 2
b2 = [-29.924444654306253;7.5945527167891367;-50.289873877484546;-6.0921911596848588;13.515093310264712;-112.63045396057109;46.380658383250847;0.28613293727643291;-35.768324016265765;3.1761990672673801;-10.18014424759096;13.061288697097744;10.251463152587931;-6.7378218127472387;58.869479180575276];
LW2_1 = [-0.84538123268543064 -3.5247850906631575 -47.847193838727939 -0.51875492847142235 0.5384968377318734 3.6653300678282092 2.2723221656168371 0.15897895668043116 8.1499349501503122 2.7801711887691578 5.7086000089965987 -0.55098992284328152 -0.072650326492154568 -16.014232176666308 6.3237802569350725 4.9521872554424764 3.4723937206245155 -1.1418624529775552 12.702444225648049 11.295994563870369 3.6414233691113469 -7.8663707795199871 -6.1156392663808736 -4.0986579691185918 -3.6638359790051234;-2.3216667540072526 -15.925937755174481 -45.498035359701134 10.459530916047413 0.63872118551895218 5.1061215271603277 9.8820785508031861 -7.6323250380110705 9.1914816758844218 -19.319048802415136 4.5206613163287974 -39.321269285046476 10.121543781144524 7.4223984589597194 -8.6044143487440401 -5.6424684041699633 -8.3752062783589611 10.008029666253613 -4.2209334330410879 20.971182652397601 2.6112096754587393 -9.3980931796425278 -9.9193822416522615 7.8053417818001396 41.338365226146792;6.4702437060838491 -6.8531299738033304 -63.288223090575165 10.310151070845901 -2.7653526059112004 -1.0991238384888176 -5.1646125565759826 8.031268694328288 0.66546888490959111 -2.2907787204756791 11.598754200433476 22.55310344142497 -11.686574655713658 9.6478593288055325 0.28819891541159787 1.78395536028891 -9.9783435000330698 8.6089077866901444 -3.7535294673778896 2.3992989842479102 -1.386718626863833 18.234022733568242 8.8080462873562837 11.842957824003369 14.076763050228163;0.7689963315301499 -1.5171161229081147 7.6378921424817587 10.417964725687446 -8.5322980733367917 -4.3093831382799079 -4.2380054226133028 -3.7188378089802021 2.6808946258584321 5.7230714673488841 1.2698142650452169 13.970153696765504 -0.97766996685114649 15.014031589975096 -6.7395484571234299 8.0075256692107448 2.0074145237784693 4.8499964959652671 -0.68532324671080469 4.0366735189135143 -13.751212422329255 6.601306619053716 -1.8509550964261166 -2.6656389905456197 5.9023560066436733;-6.7672188292602948 -23.636020949227785 9.41044399132198 14.12114260164978 -1.5924114232547573 0.62240227296322692 -0.49927151749457377 -18.941770578834856 -6.1846827879146424 10.486405429690615 -23.094150137218591 -23.776977699135635 -4.4231883575603828 -8.4590924471766247 -13.656235007069295 -24.929680451818808 9.1963124124118334 16.037963650039252 -5.9160842260316198 6.5029032677306571 -21.065189526747101 17.356567612288643 10.468286280231093 64.460100394561053 -10.692254000974502;0.15049673066106609 -1.6215130263190307 -95.002273871934392 10.702594906737934 0.39680329180974006 0.13073878449311094 -1.1473713610285421 1.2371195231920356 0.74077252266550964 0.71393616176456187 -0.51876806754988347 7.0105016089164582 1.8103781662511671 1.5043417031284598 -1.901381013251906 2.8456230675426073 0.29272767518244136 -0.14676580034895528 2.2186612262882703 4.9631902932815937 0.32465872919541922 -0.95194518092271585 -2.5836540331969564 -5.7738055129648105 -3.1353841837033096;2.2470576363502968 -8.7214968303050782 8.419111936703489 -5.5193241567162605 -2.4859041306755891 -18.852926256075794 -2.1436542113213162 -23.430377858993207 1.0093704722687358 27.303999383580141 -23.136334161005738 -40.262099873778013 -9.8242516296279305 -40.992907562528771 20.518586664148952 10.200782731575417 -17.844434272136738 -1.890759617049941 2.6873530251307449 -12.741349014321472 30.796054634329231 35.450915878575429 8.4190272337772463 -2.2180301614125106 -0.90765287561039421;8.0466068496411314 -10.229317482012352 4.2957127912731208 -15.131250901775328 10.759543550567638 -1.9048474464044021 -7.5841630776425184 6.2958932689043188 4.1527811803973478 -0.60985273842836751 7.8870254231331636 14.702656670051676 9.6970600592925393 8.4599489501500749 4.0603535333655429 -5.2850502793066054 5.3896996805826474 0.12531861927855587 9.7911994082585387 8.699720257009897 28.472179165192298 -17.182918298904656 39.473700149025873 6.7835929454832442 -10.983999026486115;9.674066809858461 -0.79134326439025982 -46.556502559284169 4.0005549185491223 -9.2091856829557113 2.8104512077028354 0.52533771364680804 2.2767421457834462 -0.069848506054996845 -0.30921650162402597 -0.4682857114341622 -16.750272937400247 -1.6549269327219236 16.208295711119831 0.52105908080921637 -9.72836519851713 1.1926579994881259 2.6283025111204177 -1.2125022811859343 5.147169819172599 2.6106545601002513 -2.4075937725577843 0.095479793672186106 7.8052646942673984 -3.5133538668563142;-3.3803331144308197 19.94781001398276 -6.3804674395814374 -14.043127977788144 6.4661883390767549 2.6844776403086978 -3.4098913134576709 -3.2668573547714606 -17.593954891926412 11.87398002054522 5.4637677859938707 1.6265979485365374 20.858409703514347 9.1417544307619867 -5.0280732024795594 -9.3251947503585022 18.963344130078433 -1.7400005868717519 -0.85574721627617167 -6.9470951422555558 14.009734900183878 9.2944679099291498 -12.920421165600651 -3.9293201354050526 5.4420216855298458;-4.3626814211621454 9.5914832327914805 -35.110814000318022 -16.727852070122857 -24.57043366213346 -4.976565778657406 -10.884912371581574 3.5678561265429285 12.130433896126885 -0.83006217470121713 22.191247491433494 31.02716575745599 28.38605727520487 21.584759492811408 -3.0987534793945977 0.80116034178297191 7.9592309042944089 -20.220873476907421 12.488780949471915 -12.667217870844359 -3.4346692545967743 -23.081886721740947 3.6531451638308479 26.278117240858382 -7.1621727488873912;-0.99514556413058641 -0.37487006721617111 62.3061738421858 0.15273208310057335 1.1763458643701716 -0.52431743296426481 -0.93552543926079113 -1.1833670149689572 -0.26557759160216782 0.75805203166033119 -0.81833673389528228 -0.12493761921736721 -0.89754605663478426 8.8790847866357314 -2.6697993399610462 0.1984697326762663 -0.045148952621472518 2.2882182296343547 1.3997819904298507 1.7125854624318402 0.22995322935151519 2.6519696768240828 0.39511260797964542 -37.702002833622892 -0.48690704314410527;-11.035766713193054 16.757153530980087 -7.0722693709496207 3.6120502358512492 -6.9905571842407586 -8.9281126175829666 -2.4437823985956362 69.921058510095207 10.805768718067121 23.69158302550732 -4.9640838661909994 51.587536741173594 27.70408754755216 -5.2926282448174122 -0.046232280402640658 3.9748991930477162 5.5793925038000287 -16.377071444893367 23.05832336779967 -14.611753143108883 -38.699237081747633 -41.890158652167045 43.185045693318273 -2.2544108439924617 22.006579217129993;-7.6271351762690642 -12.84031612825758 78.849655162122588 -14.653407401431259 6.2677342584790647 16.398324850441597 -9.1467189220289491 -37.664369490085178 1.628574740403161 11.129661103757666 -53.658227728553854 -4.3854781447388405 4.5424424930327758 -5.0484900193921085 -2.4473243547287709 -30.984167785843638 -5.3469671348342303 -10.321557112794506 -12.52354478506998 19.442061005982474 -11.393448508373266 -20.489637646166376 -26.143214157597736 -36.079900410320057 -0.69179346573240585;-8.7077672958479351 56.962061896800947 47.246913505116964 33.304774315935369 23.837899477852439 -7.5414076802598542 -93.822498784185669 -48.226258061390148 -3.6172919878677301 -14.336001194182154 11.316638979926168 19.144895556037941 -16.107338716148224 7.4717397712165781 -7.5330694586225153 -27.124191358656365 11.541399475987067 19.563169323665885 -11.58961197094046 -44.161991692530343 -16.050007822335459 18.51083557996283 -21.989427387198173 76.761899559819554 -106.51344450155574];

% Layer 3
b3 = -0.60878430087173874;
LW3_2 = [-0.0037248573168084647 -0.8342498698151084 -0.059767406414331301 -0.0043908660635624897 0.035048162272091343 -1.1964653712422699 -0.0021125802773200985 -0.010158708435212275 0.87704313770187259 -0.006209490101663542 0.0010220044236629203 -0.073092018098623562 0.021987068524663745 -0.013234785254730133 -0.02302556496327509];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
