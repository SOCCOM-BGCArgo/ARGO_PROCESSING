function [Y,Xf,Af] = ESPER_tco2_16_Other_2(X,~,~)
%ESPER_TCO2_16_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:04:00.
% 
% [Y] = ESPER_tco2_16_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-9.3810003295587361;-5.831262541492829;-2.8133856811496449;3.7943603908583712;1.039706354748323;2.1444990763863117;-8.6207931309714727;0.14691208961325358;-4.0167617077696987;-0.11317109457848742;0.55147777749700944;-1.3507562629411745;1.0619271076878818;0.012725573914151331;-1.2519582054934497;-4.6911935238059659;0.85539210883047556;3.4843058852282951;-6.9497506849387207;-1.4268865682464813];
IW1_1 = [4.3201911548732479 -2.7512981164071686 6.3292185440244646 -6.5973679992901433 -1.6972113335592733;-1.276597730194813 0.75459326118008185 -3.0498022252766135 -2.953047648044711 0.94760741996169173;0.69873756884554838 0.32380534783034404 3.5328815649347356 -0.97534262808443983 -2.9424305764824967;-0.28284640148851825 -0.020336192760617225 2.5201492544941484 2.3454531434596144 -2.6521174131609264;-0.4801079393212957 0.33982707019380476 -2.9704819393982391 1.0288145194650984 0.26681127222013645;0.83261616247940851 -0.79660340197787105 1.2243762004060341 2.0554732768021364 -2.1802777117104069;-0.50448742296258431 0.38553273015877237 -5.4316733613028978 -8.606003637428481 1.2224282745070354;0.33929650805586631 0.34510031569069166 -3.2554442590857748 2.717762424583785 -2.7249830144563987;0.67751648494990369 -0.08708371431872737 -0.84543964975956176 -4.7302766323439833 0.54581515639914824;0.24422660259483725 0.72138319351645741 0.3586132398164773 0.012396982342964121 -3.5559640660203264;-2.3131770937378691 -0.96202677192224328 2.3956087416416478 3.2571691956187991 -2.9087547809071168;-1.4669114218081671 -1.5487392441108947 0.098910876940855166 0.34135505555313489 0.14186033873320289;-1.6977470972314188 0.19029281510571905 0.10461527729269497 3.1403320474315111 -1.1752026492859673;-0.54416153259302769 -1.0522392413424579 0.10723708077288385 -0.65535069216361164 3.7875850789447587;-0.12964920118821341 0.14395713268825536 2.0150778676129368 -1.3055609605468215 3.005430827197122;-0.15834391745044524 0.32936661228804076 2.5897456242448365 -2.6876823512783043 -2.8025885559759338;1.7937894490695014 0.059991395385399722 0.13277503150836323 0.24792189983076257 -0.96388057289648277;2.1626172758257991 -1.3998714591576826 -1.4755588230517493 2.0765763510420299 0.99954130744095671;1.1529027189105212 -2.3553051570876198 -0.96226383576194852 -5.2480348769405936 2.5882533866409947;-0.67806270085841003 0.62158290434421481 -1.3172330867208863 -2.3150819471268456 -0.92713860957972893];

% Layer 2
b2 = [0.10531260937989151;-0.23109907075873182;16.548006286757179;2.0392097359602612;0.24170729521897844;5.3624434256829341;1.7230462137553686;-3.2808976670888805;-7.1089127888341181;-0.35828885535180666;-3.1366984957526642;-3.0802922845326051;-0.4163823171443492;-4.2357339049179963;-3.465519823448449;-1.6767419674863557;-1.0898185600729007;2.02075142022092;-1.4914269238260822;-0.64179411936342012];
LW2_1 = [-0.70850734643777546 -0.024747370433581713 -1.27965226811913 -0.4980025010781351 -0.50252708933450096 -0.14764778630356459 0.80591141106412556 0.14228703297599143 -0.92621206774288678 0.75835724056435416 -0.05202341331636063 0.12047981412275996 0.2962316509361777 -0.12297943715162914 -0.51408963106152883 0.59727925054171238 0.037169849495959494 0.092985473634742105 0.30414339173438731 -0.28568367440944464;0.86796455706431941 -0.15704433351661823 2.9423446746196835 0.60390730209670584 0.75722762774737207 0.1455256408898892 -0.787031416433421 -0.1198430659643063 0.94377780910108988 -0.92424402816063556 -0.014129570953924229 -0.014973217940859783 -0.24359159385161114 0.145153479423972 0.5640310553691309 -2.1711444900405255 -0.12745069838425171 -0.047374054847986194 -0.31696431178991902 0.1789275914928706;2.0184363779714407 0.77979265765045513 -2.2732015689765226 0.20910463088421063 1.2218660899911005 -0.33074417971646725 -0.6860839142965719 0.87267697775767261 -0.47767168809281529 2.5219221010009729 0.58109808354545067 0.48515897064211533 -0.33750921480041096 2.7161918739000313 0.27554629537153674 13.324187493343919 1.0640385295728889 -0.29614899877222844 0.094233541809315841 -0.32859590616376916;0.40452279385467421 -0.5695346189653937 -6.7790967438123531 -0.64329406681141732 -1.6297458066222252 -2.3131106236855481 -0.27143591569570402 0.49680377329682707 -1.0302387936508799 0.97928463975922964 -0.84209145151423781 0.37292807678835965 -0.10815428155441527 2.2974871753952555 -0.18301680451475266 7.4572648182888575 0.82872481443318879 0.30604108463564089 -0.0054170051315647096 -3.16117156643879;2.3518061337066398 -1.2242607210903227 -1.0180922876370493 -3.0100969482206663 -0.74643512544354107 -0.92594874716360909 0.4311425102812817 -0.77793731784036046 -1.9387769102604677 5.0920843097621713 0.86328816887366699 -0.40720860370734691 -0.91506302634490444 4.3990349561555773 -0.27626674332322221 -0.40852880600060187 0.75298766268865835 0.027560507392086164 -0.45878935095148782 -1.0677518582858518;-1.7506064314116132 5.5854646587051953 -0.69029750436539961 1.1094061158369777 3.111270022387604 -4.5945549217217989 -1.4412880946740176 1.1029468455103519 -9.8217336245366873 -5.8671364089199223 3.3298868603123517 -1.5723815349945642 -9.1526552219222559 -3.3151802191386914 -0.44226341295920729 1.6498732276520065 3.9036003953544722 -0.54766757353158946 2.3512331849338013 -6.0844784305154391;-3.2379954315687201 0.93665449403944845 1.2988961715862652 0.52817492139826827 -1.5331688821908076 0.42562956422102605 -1.8383937528333611 -2.5154297971510426 -0.6561669360310397 6.2062518212216133 4.463079592552389 -0.026400715193168608 1.327931570757277 3.563089197432852 -0.62193746797604454 -4.5158412931305509 2.1383185928402351 0.31344573073481197 -0.40894512421501067 2.1945666785285187;-2.0129809405454608 -1.0148138938850257 13.217698423772994 2.3601610770856483 3.6566555829266156 -4.5677001658057561 -2.6636929376238725 0.69547297187232671 5.0581624464665387 -2.4905190612596146 -0.27857555207017221 -0.33450526506878953 -0.34793357749959586 -2.9520892136950803 0.29772892232478276 -9.6767636374270491 -1.6007300341350237 0.12717776754919169 1.0052072301357762 -3.3359804070090973;-2.1663919424466114 0.26209799466867073 -7.1985512065261927 -0.50762176255909441 -3.147644551135393 -5.9711972181931507 -1.0480431380973123 -0.63530286903891564 -1.9798420228616544 4.9914136363976418 -1.5876137132391483 1.399485197173659 1.5367017488027819 0.72365400354905185 -3.0438265067002659 -2.7047561482523275 -0.7207195072472049 -0.28685399866747857 2.0786942753437123 -4.602193146019407;-1.0703501400116056 -0.27290725496045948 -2.3628481574002769 0.19701700201312078 -0.35504006317392961 -0.8938584342605973 0.39587606808024639 0.26407097174791888 0.093794564260647473 -0.79132700228384667 0.34149286874479573 -0.89491565160033393 0.049929618216804132 -0.78970794495996577 -0.25638330909523438 2.2508610337744122 -0.22363472091095676 0.1725239608052031 0.2693789400338944 -0.39837236517173513;-1.3433851785959587 0.070511566703891457 0.060076350373238635 0.44005723583596101 -0.2056729421419595 -1.7070670662651903 0.18282767482397055 -0.23985499069001578 -0.6721453963339119 4.2975619020574607 0.6761131406896157 1.7985539959908907 -1.2563195551163482 4.3349280538404704 0.61423187574677562 0.032401484435280244 -1.6877480442862256 0.77303370729488741 1.4914625029874291 -1.3109303687426173;-0.43238411669157384 -3.6542535107914587 -3.0747580391399274 -4.2357580898543894 0.8651355091975943 1.1684682631588996 1.3376064244457169 0.71374936329324667 -1.1795380876656671 4.0702678592691006 0.86432599107258634 -1.0935513036698263 0.18792231788353786 2.4571519868242437 -1.5695443482650486 2.0582022978456052 0.95197284883732003 -1.2001212315179408 -2.2387424193322465 0.98733398707277253;0.55633580929262527 0.85554443424390458 -0.028465938856117031 0.29110493945501881 0.18758254304181907 0.8608574509160325 -0.67427282269971278 -0.30912839876929754 0.40637651738008529 0.034458032160433145 -0.11591590031888617 0.37315913294659514 -0.20350269610938748 0.048432921480266476 0.21836080996784651 -0.17057310589041441 0.13993793973340754 -0.28969278999470066 -0.21173998531417931 0.88148881006878832;-0.23052002356935594 1.6148747284495257 -2.6970840618179257 2.6032833396930091 0.6079514810826171 -0.78534614895487209 -2.1638286101524451 0.19327266272284602 2.5622582862986478 -1.4582483526214063 0.45150115540559249 -0.47453735691271576 0.28880396868192304 -1.3902635343477665 -1.0180491799559968 0.68293339003048859 0.19086031100393591 -0.61890461418816434 -0.50030225473110901 -0.47356486122593872;0.15422395081096499 -0.16223658365504978 -12.09226716266361 -1.283018213208154 -10.507483847551427 -0.57438860467046038 5.1638276559306657 -0.93109529997078833 -0.79732190179869633 0.1459439209585158 -2.3155169917115987 1.0171766694788877 0.7694690046848256 0.54994041084553291 -0.77949579421809911 9.7044859966047152 1.1699726564339239 -1.6386035091047171 0.24263262089810553 4.5039808951898905;-2.2933791305231637 -0.55266503855931126 0.48484413987035052 -0.65332923566687162 -0.20698928811934944 1.1305016380599735 0.57383262577203487 0.24698223990843657 -2.2233732192277289 -3.223783030362112 -0.99662965666151526 0.16333926681090807 -0.35397999300112415 -0.92566021706977086 1.0081683937215977 1.8661558925963193 0.77663607210554964 0.10221850982576851 0.2988352900937653 -0.14707373039323585;-4.9984362388978445 -0.77611144472685678 -0.94115292316986376 0.81763698303669063 -5.7479556223852724 0.83106129787260463 -0.76567288002376521 0.41007268497259958 0.13891307903315439 -0.47865739835632315 -0.097245102479532705 0.97394121326277805 0.46089929481994807 -0.55185169482304852 4.5374148162163435 -6.4121086361180089 0.097910935089315282 -1.9883344432236116 0.03130835139059223 1.4543675830461853;-1.2586213653719438 4.192252988893701 4.1144863013446749 4.5996816725765299 0.63358434567874222 -3.8029694880615361 2.3267066889701491 -3.1552278108295249 0.1122130784007625 1.3179284775410931 2.54391737811854 3.0852692260043919 -1.8619024797321069 -0.74054558205285292 0.95471630646326844 -3.6825336819563028 1.6502034996065367 -1.1441334432332579 2.5339687625541543 -3.5361666761295183;2.3040505579594717 0.33665013023999457 0.93896584134653571 -0.094824214040150678 -0.930897331812929 1.5817313575014218 0.63832725306844151 -0.30983563304367112 -0.024486694437428947 0.66182984712213633 0.30226128144826186 -0.020414090004997477 -0.027182482999663329 0.4794022339196255 -1.4893989660006093 -3.8245266284611761 0.97333578029354995 1.212373997673728 -0.59484919842476802 0.94175549936420133;-0.040746832421511989 -0.53716534192829368 8.8661914507280688 -0.26631896453974868 0.34244114824446698 0.01311448271274877 -0.64160249281733994 0.05729251360388115 -2.4148676481285305 2.1321446181839434 0.054004562562352941 0.87240986725612901 -1.4084489285137742 2.719240294964457 -1.255561564760046 -10.131274028078437 1.3881052625079744 -0.96335871519919236 0.42244513820989238 -1.0307256918520056];

% Layer 3
b3 = 5.2592216034226968;
LW3_2 = [-2.4164220032681878 -2.3084743332868478 -5.7879422303912946 0.34647142949682841 -0.2043257593876589 0.12170871248441632 0.12590869242275651 -0.18071304259418111 -0.084721206902179033 -1.0576393556421284 -0.20451753587022722 -0.16736979932421689 -1.5322177661587084 0.28730427444203438 -0.34630168101595088 -0.2561333800345168 -0.43190196287602256 0.12996579140959219 -0.22602861385760425 0.26020539686424221];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
