function [Y,Xf,Af] = ESPER_nitrate_8_Atl_1(X,~,~)
%ESPER_NITRATE_8_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_8_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.6845672344070576898;3.5915282777949224524;-1.1068245082847711913;-2.4491895463261634802;2.4466062156579120312;-1.5554737808432053114;-1.3324348401955679044;-1.0269143919360832484;2.5633745846540247904;-3.8987967840532884445;2.7277710973913840142;0.88476718191008418835;6.8805862501765870931;2.4792343445069469077;3.9950916715538955515;-1.5547208277120985187;2.5093233633409508521;2.623072170910988099;2.3886279266847800784;2.2705127770058006753;-1.7634843892166509605;0.15894683332273984444;0.44641499649381805037;-2.3534245528601274167;0.31874829609749516512;-3.3037515652166167257;0.23343428677365590795;-3.8412532444771465556;0.73720784192589705608;2.0226492477006856596;1.9040333033364704729;0.53180645089077216436;-4.5185874437299808903;-1.0173433715297288682;-1.9618997072289143802;-2.2482571699183213632;1.9322994257212620095;-4.6160293107527738954;3.2520437892609153074;3.9417692156558414851];
IW1_1 = [-0.14126376533552648107 -0.2814131255328964909 2.3536031099336707229 -0.60069155314536049062 -2.9021983188795714703 0.9700563998584096348;-2.1817897441326312702 -1.4697912502575127824 2.8345206022684505953 1.4939860822290702558 -1.9942556694817206164 1.5290968523545065416;0.54722095977290230451 1.6413647900857315509 -4.9337072234960555051 -1.106871991270473643 0.73611592845917772632 -1.3603935890379932339;0.10517750829817205938 0.041537637524937040534 -0.21181072788578267363 1.8484908437290916705 -0.63570516615028660468 1.5984425578643395305;-1.0805832177981822273 -0.3060365539482763908 1.0355653970680820386 0.77969308754526811533 -1.3325004241129549953 2.332164055229021038;0.37308462830568156487 -0.64265169990652049048 -0.041184913275492250617 1.9608505463739225316 -2.0665707973592764013 -3.2705469686752000058;0.5804791558559361242 1.2779597476878459261 -3.5555521037190520595 -0.87245841912938215668 1.0385185760737969396 -1.0779801919459004456;0.64049639521692269817 0.11169475562401315338 0.046948317346606170675 0.32714763407041741461 0.60931362613914541448 -0.069247067018861935273;-0.9399147646333129158 0.501066710441773977 -0.24845382187118175699 -0.79360609565193351855 -0.43267701262425395381 1.4582541533360633412;1.6828049242061748902 -1.3162300524717021055 -3.328761080562632646 6.1212029511638581525 2.5980581763760923764 1.8753073504767658886;0.16210441689798735232 1.207775989155016827 -1.9620528781702171184 0.55153870024773954395 1.8927219919276909721 3.5204551511730870494;-0.62215272842840707579 0.21834509100584015284 3.7361699714050833343 -1.0063443231283188961 0.051554116690596993311 -1.7419616883349666736;-1.2554744491035529919 -0.65620471555220138971 -1.1151919639348031321 6.2280777511864799934 0.46938439851991464735 -2.4155278106534110449;-1.0570386979690604701 -2.9701842690724116203 1.8801643511600525382 3.1591541839967041128 1.2221315924818680898 -1.3293194008216164814;-1.0490230478905488987 -0.13771054047833219958 0.92911193129697100535 0.6996999748248822204 -3.4379957997820951299 2.8618451406856140196;0.71774559631233658674 -0.12970091244563955457 1.543178353434078609 0.98294837836060666714 1.2547307592534042708 2.2950306960920761057;1.6412501180789977884 -1.8631962446192167349 -6.2117571175317376486 1.0214937062457316586 -5.7378975720705129859 0.11142016886841663026;0.76256881509114160522 -0.95198047547552555603 2.1264732782319959448 1.7270183130502163582 -2.2297754203976030141 3.0083942325547718966;0.78086845130566284734 -0.38777330392490955147 -0.8972938879387117872 -5.3605923790340606061 -11.201937979722435657 -0.12766662181451743363;1.667613979847491823 -1.1995735357455241665 1.5971413373872651587 0.7285970629281742772 -3.4858664827352021653 2.3175735240880830368;-0.79925995580543296448 0.53971520713869347574 1.0978944726624728645 6.2252663895106694625 11.404906507793803883 0.40036150793248104218;2.1501550620273106595 -2.222763280215952264 -3.2846303990895764358 1.2776224665286459725 -4.7128821690820110746 2.6139026419929067835;0.43283871562118064746 -0.31165667877019942456 0.47067442863465536185 2.4705736414897652153 1.2866547170463078498 1.160627965209531709;0.086852462771167301958 -0.42346806147709992185 -0.38020376264397909294 0.68210417344970841746 0.73800143917299010354 -2.457933053851477645;-2.8111540099540861526 -4.1640227252216943654 -0.15646041070419466901 -1.5644140103966859279 1.381996620325224967 4.6669081676737764752;0.38275144796083637733 -0.16097067852476595884 0.056692434580649077314 1.6968661836943430554 5.5426862211762939481 -2.464938351559354146;-4.5209528822057976072 -0.013065908635433651219 1.3804858649083160405 -2.6311592317746428371 -2.1061648084207118536 0.55789588748825602593;-2.2389360796092048211 -0.9293546678777312442 1.3463653274193754239 0.16590966732907716508 6.6978753628173501866 -2.2675276370157249062;-0.070125086443002762615 1.0687854457329901692 2.6477293611262071593 -0.72210634486503910701 -1.0246980763984503415 2.1199368300883789651;1.736459447084679919 0.19175919327644097567 -0.95137702386876477068 -1.4182158063437331208 -1.4280102435626391699 -1.0928576248568844242;0.58555047990122222057 -1.6927879852225109492 1.0744701523599127224 -1.3293263755800663883 2.0639495066595872075 0.039364202846551905879;-1.4557948421858384336 -1.1774772698511219993 -1.4786947772905540965 0.29559347348639103403 -4.8696781223077891809 -3.0548707082094761489;1.3851389072330417829 -1.5423432524351816664 -2.3158563147430673013 0.75627394647998602562 -0.16028450211742739651 -1.6143567223461694482;0.1638959714225927955 -0.29316459980911679928 -0.14279529613887381734 1.4839834629957724399 -0.9981192795650083438 -2.3190362916622659917;0.40450897949168479473 2.6971694214646659837 0.329854771805514424 0.19142163085440291881 -1.9147514442765760645 -1.7706097258780255643;-2.0662571578416089046 -0.33664560540870647198 -0.6639474957408584288 0.073820923178042549551 -2.4218553755691596407 -0.66145490493793313025;1.7494913733812813561 0.1596142476863828541 -1.4367132439217620288 -2.4399052742158091611 0.91460317231389820503 0.0055508210450193450763;0.69819224862973494616 -0.7758267425272861173 2.5604459891117610226 4.4329499064267441355 6.2714569677262792524 -2.0612170539440661798;0.26602582234072985612 2.6890329864137054727 2.1417494128433518519 -0.71122648015239098296 -1.1573911742287348314 -0.1720068026035355413;-0.4277810949769746407 -0.41460265349327785067 2.0647946770086234025 0.10251032732989104335 -1.2118776210945723104 -0.83338950593111216225];

% Layer 2
b2 = 0.2641146178041987036;
LW2_1 = [1.0693721719166608963 -0.47829625543147286093 1.0713463363723616517 0.21363190032597956236 -1.8498585757559387055 -1.1141245375674031504 -1.7388886308373405765 -3.4905031256342846646 -2.2402854525318671719 -0.050154545479280811249 0.36180133326492081025 -0.59608322710458616633 0.36759150272094504031 -0.12488058286601413926 1.6013420253515942004 1.1626156671540255338 0.26297867250700190933 0.58236117074921978087 -1.5080296370326502498 -0.66044050571001355898 -1.3355929475230583492 -0.85777754443110587612 -0.70434476394544132116 -3.4663518895464924263 0.075792163096822434687 1.2993360021878566091 -0.16329590943433372474 -0.4413395533459697484 -0.41326379024524384498 1.1958235009702109508 -0.80636962561870961785 0.28339450485089656695 1.730211641534264988 3.2449743582292844835 -0.23497746927515816839 -0.92368690368739581054 -0.52183378892063192467 0.19645357070695498858 0.39293711668722114405 -1.2377883559661935209];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
