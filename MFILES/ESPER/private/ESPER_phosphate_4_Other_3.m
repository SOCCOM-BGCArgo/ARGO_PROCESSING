function [Y,Xf,Af] = ESPER_phosphate_4_Other_3(X,~,~)
%ESPER_PHOSPHATE_4_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_4_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9068367996603181602;-4.374579610886179637;2.9974444028818183483;-3.2933249404633917479;0.7173010360667092522;-2.9638560063383478926;3.0965117796933392391;2.668022094270786404;-3.9599842190861069824;4.7124821173752513559;1.1672869172576383345;0.91930017377391282096;-0.80068594407227955401;-0.14023565725874154175;-0.99207674675547852239;1.6340904636332602706;1.0004905339770682193;-4.7131389189583803301;-4.0263129551928500405;1.8781817245529730531;-0.4080147155148970417;1.615092527638912534;-3.8484974498620494465;-6.7610554362203805212;2.9126590065388557882];
IW1_1 = [0.23853380717489539031 -0.094563199391930322091 -2.7424693637709793848 0.61668721685966765289 2.0015006269432098485 0.20682877542475741617 3.0979546245628419854;-0.80443153900617436758 0.60868375918595707397 1.7063264540627762766 0.74033413940850867352 -10.459542817357913691 -1.5354338732055583527 3.018676620388671239;-0.61253103052926105576 -0.33394038611610449285 -1.0035023420116673254 -1.2315907818889118008 0.30433071506554926211 -0.4214465131349718896 3.5342942318773786781;-0.31249004622289316968 -0.83527699817988743103 0.65884922916546462268 -1.0473614736643646062 -0.73649800604832482698 0.99667583402910875368 -1.3665813895177303383;-0.3928893941514585153 -0.78865506319695177773 -0.73987347323968399859 0.48375169352273683643 -0.94475029531394860705 -1.0718920891252392558 -0.62587074074583481931;0.2886584038722510015 0.96326458854610963467 1.0677897702068466224 -0.45618840460014326021 2.9735799997402190264 -0.81258802868231616578 -0.77816559566063170372;-0.16789772704967051431 -0.0073162889782683029546 -0.14602191870509867444 1.0722205304788525737 -2.0937572974763085654 1.4019544227973559369 1.9752697428387697709;-0.18221786446169063733 0.17166778364477802699 1.1875346013056680139 -0.24057296228650762449 -1.3451498373082386717 2.9074932893250680088 0.15584021482882140508;0.84234078891860431071 0.18953933240545492445 -3.2156215627015329872 0.39424355499615942877 -0.20322690801599302413 -2.4736620708246350731 2.1828348095730287781;-0.70526366087423342233 0.35231797747901771878 2.4942070194502612424 3.767053577887341298 0.69277254216995898251 -1.8761016478703733679 -0.29230235014438066266;0.11344790151318147331 -0.30988928904977269818 0.66837404634434349759 2.3090033517642218897 1.9050794391237355629 -3.1976934593129540119 0.40587685669628853491;-0.36968355878854564089 0.43678995156672123512 0.0096222284184376265931 1.1519053417380820115 -0.76397209604238913716 -0.87863660500580076373 0.61875578162387190329;-0.76379365018700806633 0.29059595490705314447 -1.6346318311895946529 -0.034945783075569364362 1.6772285513707185789 1.9344817702139616156 -0.51436729625993526938;-0.43293688688847292712 -0.82214716151698530311 3.7079612866053945908 -1.1276954040187885386 0.060147801569408430866 0.50047881506101732363 0.62071555430691238708;-0.12799063537975743921 -0.30166477360231547244 11.488812286930999207 -0.24081385733678870031 -0.37377447888149412103 1.4850016054992269954 0.39278888963827024439;-0.25841918396259749846 -0.39165768731728395347 -0.58852370249346397379 1.9715488726126539909 0.37045403104327156996 -2.1770236446439361622 0.69689761017438034418;0.35116099584494331332 -0.82687650072812257651 -1.3268061450890862307 0.019962433282657766898 -0.12789967194291912422 0.098301803607946713903 -1.0584647087536331878;0.22555531411363605176 -0.19134964004399981907 -1.9429016334599200633 0.40684552854277761247 -3.6661465919536708746 -4.3921843485872242852 -0.051011652179940435159;-0.86587597679527672501 0.16564580859601119034 -0.19664722925380015428 -1.6316625872399226349 0.97710699395796163369 -0.077991911197477475914 -2.0197297151044231178;0.65939646633541737497 0.65281175824197390511 -0.19793238713877148172 0.62178173873771758196 0.33816558539413082984 -1.2072644313923568404 0.16451389422692924702;0.14541586510027321166 -1.1544641881100319303 2.3121500757420516692 -0.58329029729308090602 -0.7084873949245207303 0.92430047745840648865 1.3159595564198893758;0.26529183505062575721 -0.59912584981465610845 -1.685243758340392306 0.31408834237090699215 -1.4182170186112088572 0.90151047421896035594 -0.48621829143856176714;-0.83092728886386768572 -0.35353446833558693774 0.57620658847749406384 -0.50162679470120907776 3.9373040312606515378 -3.0239054301957244419 -0.95977796483498567515;-0.36595818268333091261 0.55245609983002241794 1.714758349266314319 -7.6734389924208254996 1.1598503699657605193 2.2658122882655766794 3.330645121861361968;-0.1729924470977526052 0.05054257539607522054 -0.087698169379842136339 1.4473882734589382792 0.3424312130371193752 0.99300546686796431484 -0.17038521923889016207];

% Layer 2
b2 = [-0.28678944348784340956;1.4012048768850440261;-3.7385468800653223198;-0.59264782837772844726;-2.9858696544210294732;-0.12439460849235259299;0.014265670501549533936;1.1790129988050619403;-1.2472502257435826856;1.5927766401034584298;2.6308414972158140621;-0.6522360358519374568;-0.90394180578404415005;1.8323606154170104521;-1.1786335739933690991];
LW2_1 = [-0.67852420607697472299 -0.32991192037323885389 0.96156165897796319619 1.8054418643171086245 -0.099732638054392877547 1.1619907125416519822 0.37193552395188250737 -0.88825216745946811159 0.35601290530124474198 0.63218423486557751012 -0.37106388275972407298 -1.1363316563603398368 0.43930467738033107672 -0.34405192259193212445 0.36275796213770966636 0.90068336169446072681 1.294631770314553787 -1.2357242664662104747 -1.5887141399354969273 1.8247528006311719562 0.45189970119488409583 -2.0311350973720485591 0.96351333862394428209 0.41782860041992464506 1.28320711392155129;0.085356508117550883297 -0.77405596112292995858 1.3427786063977267261 2.752094795421297313 -0.70118720970231751544 -0.83438477236137187365 -0.99748909217431169782 0.083589816736144559317 -0.069017632561437017302 -0.36877295915688895755 -0.55082609090581780009 1.1273038914694395451 0.84718387378542192589 0.32146274331042640204 0.0055979196224978265348 -0.21920296677906236926 -0.38744596844493034427 0.058295778583356237801 -1.0218633914171206811 0.72753304420190401114 -0.38051817530336434769 -0.62439008800644402175 0.47033858291784919059 -0.24179206138398798287 -0.76005539489274354104;-2.1799715349471351367 0.48213199221576891196 -1.6496104627026300093 0.2812965993385924679 0.79781069634819401504 -0.14926051467102385839 -1.9128471194986196302 1.5067661551548443555 2.8176390463992837532 -0.85117023919425582879 -2.5976160725635919491 4.3306976907032961321 1.5489430002722865964 2.9478071109619015111 -0.09195235753715154392 4.6847719763499000578 -4.0632005699743949378 -4.6817492809862830683 -0.55187452425071581441 -0.25697823664676139321 0.5118829290083519723 4.5977083696023415271 2.407775124505004527 1.2989406514449406416 1.6186167616063096286;-0.012656162780032044479 0.13963580525266236498 0.2077913626202567976 0.34540348177627316906 -0.8051210916028416209 -0.32183524391787787788 0.31721035716358719769 -0.628217550025973126 0.87549707598613513149 0.71528850749090799876 -0.075423159555065871773 -0.62210308017587223617 0.09359951172840376421 -0.20049522158213423095 -0.020152911539564163229 0.97969509416800959478 -1.3869420222371395823 -0.547369632815217666 -0.63021826636327504811 -0.0041427366272042288192 0.38725724887525131424 1.4095964141040113748 -0.46420262649348636996 -0.59544600828379112833 -1.0826408839311922883;-0.87288267483501613686 0.11554791491830160299 -0.38767121200539461645 -0.7548046643048269555 1.1536069487838149783 0.014981818326964782551 -0.62513537148759446005 -0.19451317515250982071 -1.4727130749348154026 -0.11293509229160768326 -0.17549877614647657609 -0.09320753442999071825 0.65518566240658981936 -0.1761945416679005505 -0.29600687168670059002 -0.43856666062759430691 0.46692510257698477405 -0.52886017228615711527 -0.47585062111367376625 -1.3620907650898161911 -0.70467584844010155987 -0.94860659593911433873 -0.31574932690009632763 0.72119032135523719607 1.4316192439327903863;-0.51644352369609758391 -0.42289049553571278484 1.1060996572319141684 -0.17651355330175341751 0.55343148198169278551 3.4223748305647894163 0.4934305368130825209 1.8703579034910222667 0.52435007567037361653 -0.86552577260746643706 0.54400265308070505643 -0.38453107058546565078 -0.086564297139596652064 -0.7452338700352382217 0.36447539517458477087 0.43130416069156790604 -1.0676673246395687045 0.66322257483255897537 0.26338123620931769286 1.7037787393757248822 0.46206805491247571194 0.93000469933315577098 0.46357491796246935722 0.36569343903883305691 2.8464943503184336748;0.45001626056286719857 0.011368933164422482043 0.61248958310501044888 -0.81768635151418811446 -0.05970330483599631255 1.9452862515502913343 -0.1164937914650075873 0.23714580817187994044 0.76341844979942852234 -0.15955350899544770704 -1.1931836960091823929 -0.93761182833419365323 0.59794280683253731024 0.31659220171698970736 -0.42727341723956063779 1.3977238695524276668 -0.12921352973384531149 -0.12146868549269269899 -0.51305395653039398418 -0.1393732417463871831 -0.13382819362973913391 -0.0045267545931123674002 -0.39802450615926060484 -0.15089820975018167215 1.0615917607033134029;-0.41832970510181066714 -0.013220144576186372565 -0.60317262989741804446 2.8568246205756313572 -0.38627957608096574749 -1.3971153022065954108 0.12067241141736523291 0.033448683168617300565 -0.94273230224686543899 -0.093728362963511044348 0.14209847331328401276 0.64385465315524692542 0.062231590671539292747 -0.51764646300606576013 0.11468174032599148804 -0.0474789801952181581 -1.0131080663673932563 0.96324553087804554163 0.86076476659340361852 3.2032669176941426237 0.084206904389027142921 0.98436216025184553047 1.0599575199940507453 0.077503781576500410666 0.30013354324177282662;-0.62597391273737135187 3.2629900826697784133 -0.92866165125128430358 5.1169634227711098262 -0.06950744402263489552 -4.8213148589847634184 -0.12557905398255816976 -3.7988405537910736598 0.75488571753548727727 1.748280717089987002 0.41718949085414080979 -0.58305636729616738823 0.073684773264411959626 -0.30870322846683334594 0.37843047410368135797 0.63819627306512993759 7.3940724213415620625 -2.3073527508218139026 0.26865630614269120358 1.3031202762280984508 -0.67309321749396366918 -8.608214312172567162 -2.4298741887560275643 -0.086175317435233281249 5.2070179140149601693;-0.21866732744352257445 0.60321047588544129958 -0.75877200862795857184 -0.069468503984044568944 0.51919818466828560055 0.63184747027252130547 -0.3539778359872947644 -1.5816323467620156951 -0.60899616533238487559 -0.60534103991359011765 -0.10516062843606670263 0.35635503869497286988 0.39805697036572584846 -0.054724424873942030534 -0.82609698000610953805 -0.39024720179502858652 0.58105697217732166227 -0.83248296875741512046 0.50968763762804980555 -0.97335363194610990956 -0.3108926831904917365 0.45546742791677313766 -0.93646159641241100147 0.14994898587607416451 -1.8020643927825537034;-0.68497417794933224133 -0.01906460819190114106 -0.96609156297657183821 2.6916906741474937448 -0.73679020662613736725 -0.53193051617229536454 3.5047635266138508214 1.7501872101520838942 -0.17025056921632231166 -1.54013948954286084 1.4554634048165664417 3.3071564193176832269 0.36838817772139970108 -0.36435804739846017197 0.083519928730009199147 -1.8195351176118503833 -0.93461256817571958244 1.6522630713668546854 2.2077476524016974579 2.1460425790109098898 0.19981219337745964593 0.35366377339358706644 0.34270798217203618519 -0.34673936020975981709 -3.3840533311015938978;-1.4951172289338248156 0.12337401758681523778 0.39223294826037607974 2.1434267663310038188 0.694992525043741316 -1.2021935672337671352 -0.028259256189288164962 0.13473978388991864064 -0.84844442766840255654 -0.41828141989053785332 1.2587415568251865139 0.075008695188243837415 -0.080482936309339142555 -0.15386096379346336782 0.23170075907493076217 -0.78283054519035810692 0.051531701772457506883 -0.55468294751033397905 -0.73495555625675279554 3.513463092771105245 0.22030271770537337983 -0.4782109773147117382 -1.1953891935046125905 -0.035809672287322388828 -4.2284697131863850927;0.16620188225013221572 -0.79532823792154683229 0.47507882995731848252 -0.41976043159800180415 -0.1228789217682688395 -0.76036059790707510864 0.47025015202230419087 1.6457288002437713281 0.4899922686970799024 0.69961537907030979522 0.13928034832633631734 -0.45210379787285065456 -0.33362136280642767927 0.088274957166766837569 0.78742637340701493454 0.26041754190327370821 -0.25160748330332738387 0.89113676968924926403 -0.5578747481466354019 0.88925522002488888162 0.50969263256479602209 -1.1401411732779995756 1.1718780656097067538 0.058153203642218175007 1.1435060829802337068;0.61384001948386224257 -0.32428375091711064693 0.094912160787947910667 1.1777831169110488663 0.38850991197624551443 0.32973743804863381301 -0.89727200494961523169 1.0190071004799166055 0.14214474545519345527 -0.51781611597968413285 -0.026054638376345889972 0.63777119834767892481 -0.10582816427225887057 -0.063251458828214660035 0.14332749409222070303 0.69223986671633885859 -0.94549885618157236689 -0.2378439328123620744 0.21829406157384934062 -0.0067524496743093234338 0.057178371348560783072 1.0487588096525835013 -0.78890713256544631182 -0.111345729640247873 -0.25539236595452291523;0.59814352802817161159 0.030001366727478939733 -0.14646886917405893547 -1.1258594462489621701 1.2421415397668678082 0.91141568078460799551 -0.75277421626856999559 1.3918464842428226458 -0.33949010948077990024 0.10215259150115427178 -0.27230078890883774312 -0.21375009371548042703 0.064789992380646393988 0.15502701099729915279 -0.092292478356554352725 0.044461274302765779742 2.0488068204899216873 0.27425160753088190235 -0.79142369933390355197 -1.9602190578480482852 -0.31680440759045530585 -1.7417182157881787585 -0.57079326974186039845 0.65948996380893831759 1.4101117357947352549];

% Layer 3
b3 = 1.6359872858013362329;
LW3_2 = [-0.59249139905293468633 0.60337697823961922161 0.17786966243078877747 1.2628931087742327755 -1.2445661183363305735 0.76790844790542445164 -0.97954984111803233837 -0.81084478207803389882 0.25001133758643329097 4.7086809997568224162 0.49498478816213059561 -0.48350324960257295981 4.3501199379351680463 -2.0413033138418930079 1.1413097727498004996];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
