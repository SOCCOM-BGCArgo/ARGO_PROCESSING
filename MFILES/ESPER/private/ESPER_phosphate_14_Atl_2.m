function [Y,Xf,Af] = ESPER_phosphate_14_Atl_2(X,~,~)
%ESPER_PHOSPHATE_14_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4198412688833634832;-0.32438109844627388556;4.2825729353207941941;-0.39024140120333716819;1.385274406297570815;1.8524496383722552917;-0.30563825850151488117;-0.0047310552960073120471;1.2015564420035056425;-0.48660249858190579575;-0.1598082182952591801;1.2403695695170706692;-2.2073122046194795232;-1.1751448774381261231;3.9460042023845645076;5.1562125916518848356;-1.8606200096039962055;3.1968413574875005345;2.9676284895621001247;1.3214243103418612524];
IW1_1 = [-0.38835598032764900855 0.67761057863870011175 0.67805126721221498087 -1.0472439693450692477 1.3841290728991029191 -1.7682520327775390623;-0.61426926186477281977 0.29319083872148660186 -2.6969497275723282037 -0.39760420726764600374 1.635322830489673418 2.8934697535780409261;0.3167592022018587139 -0.45473448076526068462 0.43699414703962591311 0.13634890687114933905 -7.0223331337830634524 1.1621524191254033465;-0.3454581869831829799 0.94215215890608128291 -0.69634056457091053627 0.59177791159420722877 0.36429738114260856729 -0.93727293461800265106;-1.5184075743681730852 0.60439413606043701499 -0.31374642052488960209 0.087443959333034018688 1.8986668424513677422 1.3869139599914577232;-1.2117825302492168937 -0.5248773246081550603 -1.225219272352619182 0.03874468647935325194 -1.9740520150177953695 0.28957389941878741713;1.3470697213698803463 0.11139062793819838604 1.5098669649921052649 -0.93739555629850213059 -1.4913900722727861936 -0.20525042295692166872;-1.554520371876205953 1.3651126839917846478 -0.99027343120002586652 -0.6622171671451964059 -0.80561715590973315138 -1.3328793031658248136;-0.52551414962296716382 0.53608596969793609333 -0.68760555999750949674 0.050332468062225264871 -1.0049651991284893615 -1.0757298166361719538;0.093544230519265678114 -0.46072028084224575517 -1.2095658637551429671 1.9111028117884698574 -0.64102909225660065218 -1.0099425691134535921;-2.0918830893581370489 0.37693981650776919867 2.2552115400516861143 0.072234295142585974725 1.8978066031715008499 1.411991299855650972;-0.10310375013231741492 -0.024843421618360447128 -0.31916217536947560918 1.3939344307670424872 0.29646069513752226765 -0.88127100321276075068;-1.8815056515937331749 -0.30093912608405709586 0.23125102889743889834 0.20396415919673968609 0.30058958888865178194 -1.6089270812477571848;0.09486475370292747622 -0.62394592337657905912 0.30936047177309811129 0.61208346906460830983 -1.703955600172121887 -2.0108762118571865685;1.2471970173449198338 0.21520270144769726439 2.328529629259095568 7.8930558665893331138 5.2569456883354375165 -0.32272902455733032401;2.2275038664166477709 -0.8259459863660246759 2.1085522086754044935 4.4797859465168468063 -1.1686994359729194759 -0.80788610326453236254;0.50262301885745674923 -0.27404702017626680899 2.6433878770934149394 -1.2560061863799301118 -0.63363308954997954459 -2.6110508861151564552;1.1616412663678092887 1.6002655679969497449 -1.8166906775199453961 0.53937132365200946005 -1.2283463176266462558 0.13605230484804520241;0.97083916381008261709 1.7282012636025250174 -1.6948859977707553259 -0.35812534778428878335 -0.4234560238816406641 0.71388430639662869837;0.32533545680474251771 -0.8066628352737826857 0.38619569333554515378 -0.82625332516072413913 -2.1487997152760507369 -0.033284668827001526181];

% Layer 2
b2 = [-2.2478785043418643141;-2.7683829683960148316;-2.809641676858982251;1.9969204025014677395;-0.88476745094887998544;-0.75641035690584201845;0.51433954343196708336;-0.3484306415165596138;0.08340681553537242221;0.66660985123700455812;0.54071745375470314787;0.88064428570306652055;0.81295440970347088161;-0.1650535544195571025;1.3661277716619448785;-0.41702992621990714328;-1.4386523393137697902;-1.360019058950311388;-0.72105325422605159869;-2.1272329527398392557];
LW2_1 = [-0.83535237849344246008 0.67173413737200904361 0.23480377875295979639 -0.55765707871950931374 0.84628502818042150579 -0.78072254980492938881 -0.15907046570506527816 0.21218811273177051735 0.073179079270183133854 0.43447188500071942663 0.16931813304154394451 0.23703729867312273161 -1.0041905524264094218 0.092258837385440661816 -1.1632220742441867767 1.585980489022798201 0.51541366862683013483 -0.71009902771646959962 0.86408965399978376887 0.1856521980055957366;-0.69328495370094511685 0.1413068863708603351 1.1562895120471938792 2.2965723640050668131 -1.3290895507552291654 -0.38848477519539531544 0.055548170494476287185 -2.0635386623198717082 -0.65866497056997619364 0.45993627551774096673 -0.15526842385332556562 0.75518855034399146042 -0.51174093500831407955 -2.3363866764806644483 0.11178182421825649806 -0.92775208279724230565 -0.60735142882036596834 0.55384335215934499264 -1.6138880294716513308 2.0538480887866588098;-0.41166533771958352395 0.45739428682342969656 0.22177847771841577296 -0.99927427750674424622 0.26416209297863652017 -0.69182439805110640396 0.17110752827214573135 0.1709772386824389423 0.34779782975359807562 0.73501260252782674165 0.035237862456842544701 -0.11956494619294814885 -0.64332839193556667912 -0.48651310835143057876 -0.90311985939953720592 1.4343956360967518027 0.40902545627893660551 -0.74119043566467557316 1.0931158718013394004 -0.29732256742788071291;0.72362207544141898818 0.39512977873172799859 -0.52103527305110686196 1.1643217292649057359 1.3263286281495270114 0.12342233008744081524 0.01179535087048916818 -0.14391614395719676267 -0.25007175061646275127 0.51997224915420781066 -0.55814019361069655556 0.54639983544861236986 -0.32520601111884306356 1.4747386774167101642 -0.41455333013124379127 -0.11235684268543813524 -0.20768074405148051476 -0.24670803876596586468 -0.96614280429851429055 0.57176467591754287501;-0.084325695521847376934 0.12767895537032017406 0.77761413463518647138 -0.50458258471312189553 -0.63051796828449013788 -0.7489080882596355071 0.50794028860262752101 -1.3969453936533382521 1.0106895231663481916 -1.0615244162537462724 -0.16110761192340994352 -0.62229368288419362187 0.26358305455440395049 0.46895733963575703118 -0.59981450861688778708 -0.21215780364699413085 -0.40543990001742835627 -1.3763306760895983594 1.9496480150986510438 0.30194773373256089677;0.36029339147442607239 0.19839406090718336717 0.26704967210280344814 0.28090417061279210342 -0.1237584992964701619 -0.15629792921264343275 0.52343072652411781753 1.0508165051940985268 -0.53278241384070401665 0.32978901037922070394 0.3450218790413490666 0.17721724343213340891 0.36840082062275053554 0.6341645696887342476 0.52366479060613646546 0.13237989290664728403 0.21200321769071026057 0.49187290346126844032 0.66437887732809197683 0.71194097678123713369;0.51042109127491386289 -0.86332372799777978845 0.072511865628176325194 -0.93749022815586080526 1.0839355227010605276 -0.078957793661079009317 0.091465628486479072512 0.13729167823554835892 -0.32384060375618739513 -0.15538987504684401153 -0.062879611093235643349 -1.0022713828073430697 -1.1734650803013799703 0.18246444051905391648 -1.2713275526207270527 0.49660940438146278231 -0.9236814478901700376 -0.77259665801260590801 0.27201550299120641485 0.029380254328574016698;0.60379825940717690713 0.54282327985619061028 -0.23501896769213301286 1.4236770959689903915 -0.39936397642159626731 -0.51062585549981842625 -0.68373368774155429684 0.031111351110278909898 -1.6518849757201448103 0.33643971803681471666 -0.14168845977055238849 0.15772373314112025922 -0.29033717595928598687 -1.8484645106861714581 0.064526947331141740194 -0.77493214421606759768 0.24084187800414641467 -0.090813363932020413349 -0.6168781794920669137 0.53328629140128658292;1.0594821919175132496 -0.10501923682492424195 -1.3099887412355211147 0.075029316695398987069 0.86554749682682918799 1.5720732851491707738 1.1247613912490408428 1.3113383431610268204 -1.1992408389292488202 -0.91465073982548938947 0.24248352049786831008 -0.67282758989000135408 -1.5385488293645093183 1.9807279916055786639 -0.092593074972419642243 -0.22814910566437612838 0.43516013886596338622 0.43428303108075122507 -0.97122556018421923874 -1.4220187548330323057;0.10088912654479322006 -0.33847188045382697874 0.54553894662605562083 -1.1335621685179657625 0.2593306576289358123 -0.079326818156541564764 0.17693622598534927692 0.096363391063789785584 1.0757016918620470047 -0.10405016680776968396 0.20840283758801234071 -0.66791439582392408969 -0.18228701474119865522 0.72868718091565543027 -0.14470553619358553221 0.43346430233011662425 -0.27570213311453034555 0.17422566016403129296 0.10951456987359413364 -0.27265822731830391401;0.44541569981325951355 -1.2600473612081053432 0.047763845568722006207 -1.2510683882539566092 0.87443282066256755591 0.29312825248560925306 -0.27613858804358720755 0.29167496725944613845 -0.10409620752460638227 -0.76129422584727768353 0.45563416248853444435 0.92380638348556698425 -1.5944190490347673883 -1.1238830725850039727 -1.1553778119777671218 0.95504296253728016008 -1.9306384114291519349 -1.1087546767830007699 -2.46531240561929188 0.61960632299796158939;1.2414960090314459684 0.38600061721146522453 -1.7137779127230745591 -0.37871308574188816687 -0.48664950757717889696 -0.41342857167119773099 0.52051124225623479624 -0.64261679598682541759 -0.78105188071614417566 0.21141036298080456701 -1.7274966254371653118 -0.56247982562718545907 1.3336236538120156414 -2.0945279268114500582 0.21320030501859621452 0.19565921033956978903 0.30973060983647832112 1.0616424887246453945 -0.5767239073630336943 0.070030254553767254388;1.0290271721324155685 -0.36210524690890216748 -0.34072086578919691391 -0.1684177745966659312 -0.95120112242045606887 0.73051788977252984925 0.52491852835994379234 -0.38732321555885335096 0.19414621729475528555 -0.4177973659407552276 -0.16124203791685023934 -0.10962525496225068722 1.0419456105650215516 -0.89276675015700346361 0.69748727127440335316 -0.99119189761379367098 -0.00064885462126347982076 0.35805080526580118638 -0.21102684166642207697 -0.86774079409928606132;0.057407900447345866501 -0.72331245563669932519 0.76746303234697788032 1.1536887233043469081 -0.99669015446632192035 -0.31216740799642694881 -0.75334377226019610951 -0.53381111919144275113 -1.087003049859128323 -0.59435560873842585572 -0.098995755506492560949 0.25408391734261825956 0.35826892358883932754 0.35922239763784247213 0.69277189110178494236 -0.47176145298011457063 0.38457453020923765274 -0.13774910256406946996 1.1143509860751323881 -0.25172401921082654397;0.88054355859402766438 0.62227201369711182544 -1.2789904481945471026 -0.18481529072670030422 0.32413658387384480797 -0.76078878232050628494 0.22055677561304348755 -0.81666627385370260672 -0.2834157784087111831 0.90456907526327512414 -2.2008370638231697924 -0.5848035684115050481 1.58700618409904326 -1.6544350860414334115 0.47318303170642078692 0.33906056883705421034 0.19612379799900736543 0.99175042868883989122 -0.49254055132421364904 0.7813309348449234415;0.35165764938241972359 -0.67832837248864519264 -0.49160624566922889178 0.70002292549299616198 0.40475212264688564812 0.49009739759036768936 0.6572350102917693393 0.30560058307499377017 -0.91796959065429639679 0.042575235235030269021 -0.40559814216582462665 0.79111240655270165245 -0.64262379854314555239 1.0823453754877898625 -0.43861299002830705929 -0.76273242645679917295 0.071728085356851198351 -0.38263232972305227797 0.030125788696156494129 -0.13872922015237176829;-0.68764091455593401303 0.29536071704280403294 -0.74372961792128089442 1.5456317605155844852 0.21461689312369711113 0.38857293398106385052 -0.05414075376550049612 -0.9222763654920070886 0.17456143812223373635 -0.300195604511921732 -0.4805542652712315177 -0.63830772395872270586 0.032303913750167161101 0.94057090953240429787 -0.57496300997324234494 -0.27614430247898036352 1.0382093574868258568 -0.24059294142628748214 -0.32331721760547660338 2.0009979425731279079;-0.38639853058446360645 -0.13249251304399992102 1.4476133838517091235 -0.21129470938031538751 0.76999509160109402828 -1.1032922692043156676 -1.1972321663858032093 0.46733218883775823338 0.21135897554039584367 0.71348093195863027116 0.02281415492528368269 -0.62940732187409609288 -0.9055949324200948114 0.39980428707422971391 -0.19665758489953055754 0.3797607872177770072 0.8326125939194393144 -0.57418188268078951264 0.6680644170433278628 0.1209918350822565547;0.42187844750548303407 -0.52452105932593717785 0.85449615144876922557 0.22300687599598925659 -0.0088416822477346227599 -0.22922219896394119276 -0.46774145630449165401 1.0568102883067835851 -1.124851236412758082 0.27185243763323718724 -0.1301537706440804576 0.43903529590134665606 -1.7459206855207116682 -0.40581489471348858311 -0.66584750549191040747 -0.86893512382214121992 0.65202411300290408214 -0.8776752499791978801 0.13116846455289182805 -0.39396105551431803704;-0.47950142061007172689 0.77623299008886637029 0.74723204543119114973 1.2394426230520521059 0.089681079995201307131 -0.59607246047420436863 -1.2924689173445800261 0.86635046050556574482 -0.06766270445153362012 0.33147476795354374746 -0.44508856752643632948 0.63077186757853631605 -1.46480631683597462 0.72831589840874633168 0.051192335521588146208 0.97871157233768313333 -0.43449414182632606352 -1.7635007725178959426 0.38724888487384662161 0.52293893800878465949];

% Layer 3
b3 = -2.6104503872605735459;
LW3_2 = [2.0347433715748537431 1.6766372831668905352 -2.5553956201483520871 -0.88960355958815939825 -0.30697433870294527081 -0.75658511698066766016 -1.2542085239585609724 1.1166355277261958978 -0.42006819404969758525 4.2898335897432406938 0.51269780038770162989 1.2417487496915191603 2.1501648349658477599 -0.59007418016570711838 -1.4284328924239002578 2.3169297763141325497 -2.6595799772122910021 1.2563761113533760128 -0.88173263528928602639 1.2832933643507735688];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
