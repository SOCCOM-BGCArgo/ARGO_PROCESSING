function [Y,Xf,Af] = ESPER_silicate_9_Atl_1(X,~,~)
%ESPER_SILICATE_9_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [11.086673683769078025;0.64891808690647012625;17.012119469742096101;-1.2210367619846156373;1.6757214696034115065;-2.4723392665480061758;-0.99878170830569501515;2.5635142537218573722;-3.1421721198658056906;1.0244528504940433322;-2.0890646735053364225;1.9616178708911851114;1.4670913299751899839;-0.13570958304731836619;-0.78954487573087106522;0.068357398658164134075;0.31561392880867406019;-5.0680170211770887434;-1.0371438379716038103;1.226814091121314787;-5.876151542962689156;0.41737551968098535182;-1.8483421482283814985;1.1029165818338630967;-0.23337074007931538078;0.62947235161531367442;-0.79662182798959679797;0.75438123988270844311;0.45832865301422914817;0.34794303935242126835;-1.0370658128026239986;0.56077145356095969841;1.1181104720929870844;1.1172685719384043423;2.6477294650410740928;3.3218553790242033585;-0.32846232374654427133;-1.8719278830697294591;-3.9491259462664807245;-1.0573114818483027033];
IW1_1 = [-8.7863880500254474271 -4.7198521200117697916 0.87668408544698572804 1.3568138246206120634 1.7933491777209775719 -0.47557039549312907223 -0.12808494589319294188 -0.72566946167499890574;0.16279235351927878739 0.89801245289515696513 -1.9261663933676174132 1.6523316050987006953 4.4056473130969573404 -0.78987839133187986995 0.34906713476418688158 1.451148574719614226;-5.5100051601852770844 4.4190348648904418383 5.3007594331855525382 -2.5187981356822644052 -8.9985184269280935609 0.39770574334595321098 0.8538696888018197928 -5.4412075471444909525;-0.017915168792918833435 -0.15813777060648323558 0.61703612576623445563 -0.93902971123475098558 -0.80009804273438833722 0.7505290453065940337 0.92163558568243375557 0.66203576448062195769;0.9013707967748458838 0.28193186200181713508 0.58061936100198496824 -1.9573475895753384979 -0.6042863891994414427 -0.10034864385955293009 -0.71941996072426028785 -0.55196867605489874364;0.44827909309483421341 0.18824420374897282704 -0.25497704677655552707 2.5766438245818115149 2.0394156924036219714 -3.8606445822175694538 8.4876402361249017048 0.29727731180689925816;0.055590479740400711162 -0.13751575695937706678 0.36812764323224478336 -1.2373064541940732575 -1.3786266847783088529 0.71617102457187531428 0.76207432811556030661 0.79549256793151945644;-0.45017144539047271312 -0.18646970290336190024 0.25628570473865719404 -2.6143119988788976471 -2.0695763621204910088 4.0920734306501795885 -8.6974090003579451746 -0.3974245779003487411;-0.14464723069766455277 0.57645679145233108542 1.7513798961827222733 -0.03987014640584567865 0.080819702041196650466 -1.6018351341160745882 3.7499392526249248903 -1.905641273937776381;0.15491847988708745687 1.6711018644123638577 1.0275759040722178828 1.1298340602028533741 -1.3567873031788335592 -1.123155334527719873 3.7993119929833190085 -1.8611377278797722745;1.3825372102652540018 1.8613951127610306457 -0.063305177546272572986 -1.7905617048309943051 2.8840885632801502858 -1.4459161681645742448 -0.69027369003853100704 -2.1581347855280954562;-3.1309729471102865084 1.55900526431656683 -1.2023035600785774157 4.3623637800596544167 0.50266818850578220967 5.2526675778608433731 -4.7548688532878085056 0.45182560327346704687;0.69330486282965753109 -0.19814139682148282362 0.51540821601772146554 1.0116776649869425597 -3.1252140544532776012 1.0800035892147625827 1.6247741092048457734 0.95631694738513084442;-1.9272725129535051014 -1.3758170782267264975 1.0661843017939991451 2.3119026565652727179 2.3293124715673987346 1.5426755569457808459 1.6229414221838645016 1.5850004940364486039;0.13020866220041507622 -0.17770977093238032873 0.12816771910881413765 -1.8612065822084611355 -2.218532112566715675 1.0077426302227494581 0.38118629202149206803 0.93904700183641365285;1.351973411869582975 1.828402569811107492 -1.8707785702960069152 -0.88308743534803291197 0.14769276174529655243 -0.83651810859409836407 1.7319725089256934325 -1.4618744852943343915;1.5077152547426972973 -0.020306724596237973879 2.5051043288899439432 -0.55376746018825873108 -3.9736749607977834842 -2.0216302914043353667 7.1949063105422332853 -0.69604997055885220458;3.1923600678794565866 -1.2781108199830524264 -1.9319219197771830832 3.2312231890323590555 2.9159240633766398965 0.7824487763571681409 -3.4097438931835428733 1.6976097116089954309;-0.16177458844324110743 -1.6003839575402647455 -0.99114026803967225643 -1.1518710041663129395 1.3529574401004460515 1.1114509023098706475 -3.6326539060289588789 1.7710487245969808168;-0.21515545290871043727 0.28382198865649710395 -1.4319486276671249403 -0.56693246090703941498 -1.0456491772532303663 -1.0896643918180177746 -3.412002681851047825 0.51043230271560124933;3.1382808968601301203 -1.2594773644276164859 -1.9507115547338833572 3.1856729371682801499 4.0951555487014026369 0.74779754430734413084 -3.1181765371428808997 1.6433320172775169876;-1.9546484760295594896 0.41415858976514818846 -1.4445980427538840374 -1.7558029411590256874 -5.5972518753582232165 2.8694391078332444067 1.4507667538660851125 1.5152060945308492013;1.3130333350034608664 1.8016316452052945074 -0.083070686719812811272 -1.7174484756389731821 2.5980340324442123823 -1.4007670374057705764 -0.71289674364209376645 -2.0637404881952594593;2.5192215829891657641 0.17158414542195421504 4.9066477344333234711 2.1761610999381861831 0.48681829235461815397 -1.1247611909674091191 -0.51595455440864024244 1.1149938415216278376;-0.69627838062200131386 -1.6817739159242006686 2.4196262579000258341 2.5735761501126752648 -1.4289827740591485306 -0.62175999327714170928 0.071741499187339366483 -1.8351425365639781884;-0.15654039293056937199 0.21036081926015368082 -0.051841217656476250297 1.972671413817192132 2.5109067676614702513 -1.2513314903311316684 -0.1892092028710131435 -0.97362866298743266924;-0.82948268208213538077 0.8303449492839803936 -0.36741431145420672122 0.36409175912185437474 -0.3518649962574444956 2.0002204306599056238 1.6006892996838097964 0.956621296594810544;0.063979968298050041153 0.39146715640065549158 -1.3037865063960947243 -0.86243991948336651276 -0.85688466320629941286 -1.2669116559122588495 -1.0100412018970099659 -0.11247300985585739763;0.90909770817467450144 0.28210404577283926253 0.57704685345604966873 -1.9589055944870088499 1.1756316370591726184 -0.084247492557917191824 -0.72549473053973545511 -0.55162875615895590187;0.15852222818551564565 0.89574989467681775945 -1.8745787153735480324 1.2488937628140464042 4.3374653483272886945 -0.8080192712902415364 0.20929685397883152076 1.5839780782841443862;-2.5282425520843911926 -0.17624854838626913267 -4.9005787566322585036 -2.161487725680108607 -0.56295178257541611533 1.1529318316732504179 0.57726203930495512129 -1.1654501784068858061;-1.3715463749832612628 0.50215141301268528817 -2.05617973291291678 -1.0809168425623938425 1.3089574934171983589 -1.5965802665813184635 -6.4170531442776175268 2.0877685662133078637;0.21213669396366988118 -0.20857784024327588601 1.0491443055023992326 -0.033879798516231539318 0.42257453920166099248 1.1166897642439459482 -0.30098937098803635326 1.5435953661362669109;0.20172933316166083428 -0.18743387203799916074 1.0593472152690448507 0.023158279781758394494 0.443156369743859746 1.1005090557533958595 -0.18420527990137017249 1.4532465135268239909;-0.048330049244677354692 0.20238355376338268421 -1.2340880493844477162 0.3832047635966311927 -1.6672230405046108981 -0.79687322450331088408 -3.1067756851280829977 0.57523917980193384203;3.0994512721347766693 1.4144868038038580504 -6.009154047127136522 1.399645252406429341 4.7303507488842839734 2.6843627943781616096 7.7194752878057997236 -7.2738915538235415781;-1.5194500107218054108 0.019731782639624613485 -2.5281116180481593148 0.56205124799588823681 4.0847085021045019815 2.1520073561422536912 -7.2683038531230375057 0.65254990134267754076;-0.18636489342963125093 0.46305254180956539889 1.6558890659366283238 1.0000010181454992431 0.039555939531482106619 -0.89460463970758219432 2.8357305916886357267 -2.0882701574329440852;3.6427531625636881962 2.5093708375786270004 2.8829927410575768576 0.75407424461853955755 -4.1792784737720909405 -1.0229517372272329823 4.3427805738614031483 -4.194908456935878327;-0.97817356860207849145 -2.8191041255280349098 1.7415219164257782491 -0.90359852666703255331 -2.9015356917393040348 0.43303759327553376091 -1.2618621955295550308 1.7529271090269216149];

% Layer 2
b2 = -0.12620653344072391144;
LW2_1 = [-0.82455624196551335903 1.414238484800494966 -0.044265181570293327118 6.8378327334178283792 27.213630156164619223 1.6597933237879156643 -11.856417582832987634 1.580771295326221626 0.22094977549952438123 1.6754953638312664044 1.7602134708788113038 0.057940338438872342197 0.40466373013100920275 -0.043821035213100455186 9.8908410479855888298 -0.059991638380884733384 -2.1599761437174231915 -1.9172291265799796811 1.7377013591172814078 -0.54731310155450729749 1.9547864031869228718 -0.1832842398966577635 -1.9134120573867603454 -2.2123036942707927643 -0.041571368076148834669 5.0584953992955057345 0.41399134414340366117 0.50120534698515761818 -27.045986942114737417 -1.4826079710686452806 -2.1971073554521711735 0.084641934076352315364 -2.1360943688362534765 2.2828301456667263736 0.55865465050652152179 0.033748541172289148182 -2.1090110886500252896 -0.24814053738650196368 0.023904459401713675643 -0.070059385132522716821];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
