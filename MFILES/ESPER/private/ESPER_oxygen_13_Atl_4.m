function [Y,Xf,Af] = ESPER_oxygen_13_Atl_4(X,~,~)
%ESPER_OXYGEN_13_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_13_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7343084632599379269;0.07504837133669918503;2.8997494391993305918;-2.0632606132084139183;2.864287219055271283;-2.519379450062281478;-4.2967347031307907557;-2.0669736440350363615;-6.7802683451862302277;0.44298589960083295525;1.0703413485798209948;-4.9065312747639504565;3.7395255053499871778;-3.394343928456526438;-0.38807499771380160603;-2.872036373568847889;-0.893305422187621323;10.176962717029990557;3.5125471019874092704;0.2650655460372992045;-3.6958141103678672224;6.4725307008128343256;-0.86577294888157452224;-1.126713647029943921;-1.3413659867286520377;-0.84797856719601361064;-1.6927474212165996015;-2.9577505050720858115;-2.0628329965866485374;-8.1372290795998338808];
IW1_1 = [-0.85001156307091130238 -0.4139613163867003065 0.66312835259988311964 0.50593356451481719116 -1.4644394761854171438 0.31064309716986870935 0.10422023825012388665;-0.53821757225786415191 -0.40384032025495680829 -0.95462503356542216526 -0.95649870178587159675 -1.9646605539680659369 -0.010499929831681456202 -0.14068067708214704314;0.23050424913550615624 -0.40559148943680112254 0.31582484273987837531 0.058408107433792280649 -3.5044621814500946932 -0.16005942736273556792 -0.15610383862872251326;0.60218448967382998127 0.40838085481202734961 0.54983988596099020452 -0.73292181806992984239 1.2186260132973345538 -0.33160475447251031023 -0.26305283981313337671;0.66751079002136659568 -0.15298231775496473617 -0.43613577571961859025 0.21948048067514744353 -4.5529103510480259942 0.036546367251564237932 0.025968896437426388507;0.67821673560504480704 1.408989003175046939 -1.2632263301965920288 0.45243559386207443662 5.4542261805704601585 -0.014130375685524908247 -0.40983935071972094066;-1.4942768020450647448 -0.36352136774992199753 -1.1209119044030826373 2.2275167289970219109 9.6207773482783487395 0.91574141374495776624 0.90606518313539441412;-0.87672670296569132908 6.963762807387775311 -6.2195640201706794414 -0.056155286655064272361 17.852522790369018679 -1.2221748948385868783 -4.1982678180339805252;1.065121190977346366 -3.2262770053957843253 1.0525402066707918447 2.8330853021233344258 6.7732362695886987325 0.83158346012685957493 -1.016107316359273316;-0.84860302404067255999 -0.33416887778774984064 1.0820311031458895723 0.62099408300628755608 0.67052861162392307648 0.33014687765742628534 0.18855266511324414447;0.010098714640941773568 -0.34007274593900549409 2.839446962974853772 1.5437101242382735844 -2.9753972663021608369 0.71143638977181178351 -0.2746306928712701767;-0.63603686499742728699 0.29779424260430692462 -0.29178256660304141556 0.10419396178579598544 6.9825179974822670914 1.1161266561340652537 0.4589971069940911863;0.19404838658547796104 -0.61995289446045487303 0.01251284348168350477 0.5595327341951423783 -6.5942981526256660985 -0.10301122930227726848 0.60750996178523131164;-0.53638821702478611808 0.019812498246920412504 0.26231149797439506921 -0.97896385275555342087 3.6840425236202913872 0.28793639703366963323 -0.26196807456973225658;0.32925802498889561454 -0.36635829023792404469 -0.25216358177674191854 -0.089318204764227165926 -0.72866405060123018433 0.22277149249743952164 -0.20550623714554028254;-0.44118634795821992656 -0.2548322483719466236 1.0263200522874318388 -0.96668183202342672367 2.3224200791253353238 0.069806823863890796189 0.52881458610863774084;-0.070838931025483248272 0.31693013076565729191 1.4781509631166782626 -0.46945242388418295665 -0.45772234818351231755 -0.20797079441317312121 -0.21376657782762692461;2.2209395949896446609 -0.47586864531520428612 -2.3840353321904386164 -2.0752741645018502048 -11.083796470358038277 1.1930741209206772169 1.2660897355874558556;0.41448427734445186799 -0.087852862922086244479 -0.32652859115019544634 0.93401889077369759651 -4.77099843202119267 -1.5158988761812881574 0.58914346483701884871;0.12346070519659960163 0.16115217551603619461 0.96531144949140879064 0.29795616838545574412 -0.75047069368853913662 -0.62778226205202802834 -0.19650541479720137761;1.3533014554548508102 0.11690879246831616112 0.74906152004436554748 0.82331954346940450229 5.1750643180872017979 -0.24958629283008276767 0.43605212286067424055;-1.4779066410982202306 -1.1459792226252338843 -2.0403038166613010063 -1.530419610374809114 -5.5522433825480081993 -0.2573193533661135568 4.21970053020820135;-0.8165619885004553602 -0.78013412986812069594 -0.67669783847922471143 -0.6053958521160309747 0.36664912719260994711 0.78695741020018361578 0.28640319897244753689;-0.45907072460778702849 -0.010905596485583101546 -0.27225954244968003648 -0.88346145773971007653 0.44043869197175489205 0.31435938513127403837 -0.24365951231320556736;-0.9284926331155956003 -0.016075599227934347923 -0.69574215230820468658 -1.5120493641182202182 0.41128226082361890592 1.0524695268385846347 0.11907950752875821887;-0.0031587098294525118788 1.1920297044384999818 0.51530904975837166226 0.27514099147368309417 1.6494376121805096602 -0.92423856874354171076 0.41963615708183588104;0.25883477123299131195 0.27927428720400371276 -1.113377520003681731 0.41834934646472499153 5.320251940976506333 -0.084783383949793289514 1.6277267089878542095;1.2566806344526770811 0.073078079139285781474 0.67876243558810733791 0.1127483317074226693 5.2608311874003126363 -1.1391685445318282532 -0.6397825818391381647;0.90330375253887995601 1.7470382246602416121 0.79170550019487750948 1.4505117991859715065 5.6173681945515161473 -1.131436670333835437 -0.24693712934526301783;2.9747920607381064251 -8.1722458969843199128 -1.778332275209058233 -6.1611899230509630243 -10.398351722747152692 -0.1379723070337003088 1.8992666726727280846];

% Layer 2
b2 = [-1.1884481376826205867;9.900429521276723932;2.4397928451194452748;6.5052017254005232161;-9.3605001424896379092;7.1190292189195316652;0.36122147385183089874;0.36917661692986414312;-15.907265217864123841;0.97198916526363920987];
LW2_1 = [1.2788437475896357043 1.2514807073096450019 -1.2532345675429923393 -1.1608237653922950372 2.913237191083881239 0.098718658928350327963 0.14913502153632096636 -0.089314738251296543758 0.18122692165495446481 -1.074651952337545513 -0.92954824695677951141 -0.76834392432948372953 -0.96369028725833083548 0.66699581712277400403 -4.4614299745652656881 -0.71037569211732165542 1.4500372804116925529 -0.070398869614764505998 -0.57357703074083410399 2.7361766593239384981 -0.076871599682125660302 -0.61685485034414910821 0.081484089621699201667 0.8401236239751139756 -1.5227172512929592063 -1.3770707054706325945 1.4037163349384476074 -1.1586979377885386899 0.10043150511526009738 0.29986953521215814478;1.3277770523491034815 -11.507870356066266737 -8.1231388309022101168 -4.0945696562923208361 -10.379887249465113541 3.4269405498902019147 1.659070035480593841 4.3406203117073589581 -1.642137277432803355 2.3114636333263502976 4.7522748937404353242 -2.5076047218624868407 1.0222768569679641093 -7.360869164585047919 22.283790102228945074 2.8652812288686444475 5.2565349328213013536 2.752655440312250068 5.1035095039615363532 -6.5861622864344839812 -2.6140535948279608469 0.60750326984076452597 -11.507898997009199604 16.213627006304360378 0.28144633140125951964 2.8409454740042341392 -0.068658307426476966606 -2.2324387186577947517 -4.017872956641125981 0.41801307351334326956;14.497483959946579901 1.6102184606377871745 -12.331892045986769801 -3.9972447454505664055 -0.69257217567423634552 3.8267071960865464142 0.1387049476611994514 6.1775439186213327858 -0.051342771282398294574 -11.172645407237533632 -1.2150434849514444302 -2.4345512308269436907 -4.5558301436483841229 -16.40996944049537376 2.9260520700228287438 10.958143305529308265 -3.3558800408334277243 2.5064003456975210149 -3.7466117206809452789 6.049101145634125487 4.469493441087437624 -0.4258817839170771502 5.9486611125367048203 16.030680416438915614 -10.287462852774273969 3.058752757896979535 -1.6642673301757131554 -3.4771248340410947364 1.302995327028494188 0.61656586955283221307;4.3553070090106302814 -6.2677236055372462786 2.6800627640183356526 -12.835264988326427371 -19.058368974647230232 40.343459795330062434 14.39466231183354239 -30.224803003611707908 -4.8965911617103188291 15.118033303268058276 -9.2022385141989282431 -5.0656657426913573872 9.2521944945846339436 -2.3748987122135121197 -5.8159541973683381855 5.2923114481413113808 -3.5391160222392437085 -0.72469480305093203487 2.9682782368981803778 13.822939301571024018 -6.2018257172627038187 -8.003201682959206309 -0.043676706037440615749 -6.5165920040968705607 10.119644180265629174 -6.2573882446782080891 -17.6521683479476863 0.31859881709153281548 10.190335796094087684 -5.1467736868311995124;5.1532437097927665803 3.9421737972854953291 12.376641150127714042 1.4568339038125150964 -0.44128329657819637122 10.095451282108955482 -10.081036981829846866 -0.97220161504211788372 -14.414307522865343003 7.287246405320552789 5.0953501103121627835 9.9593141067868096172 11.379693411640230849 -24.015228020164453682 -6.4600192556131679211 -6.9428029609751096274 38.336238790702260815 -11.499748136372067719 -11.042544957162899522 -3.6239619840635630688 -5.4612058318137792767 -3.0055956704534394497 0.078997220611879470642 21.969286650954071405 -18.564654437031506973 -30.301639473230078892 16.131964002714237694 -12.318949615800670827 9.0343424208479206072 -4.0731211824747148853;10.688711710307693181 -19.85682825971815646 12.111705150683381049 -25.716666584559071396 -31.621873775504109716 16.358413148208217791 -0.19259868873687244206 -10.361737076153390902 5.4090921999583976287 -27.834423570617932597 -20.453611173501037968 4.2036126477172208737 5.8675462005683893807 -26.810405385631476349 15.203896809759084974 -19.400693461467351852 -9.0091140330896273269 6.9049655778012182239 12.865947643156520286 17.947405306736367692 -20.184338653127195329 17.738223833428392595 23.663461160984660125 24.934372681731527877 -11.507772157101781474 7.5866140569793865112 14.441209641458252477 5.5587441959835297567 -7.3127025382857873126 -11.370300546210740933;-5.431484787001537029 8.2578154710257809512 6.153997588084317627 2.2329497054101659081 -5.8836377417762104614 1.8519439928538132811 1.3402404219855177381 -0.19336006658320312179 0.66117096366463612434 1.6598142721851738557 -0.77959667036820268216 2.2361303765569786606 6.9782170878855573903 -11.643164732299879915 0.016924802086629726905 7.6698235691231886335 -6.092940431357360076 -1.0490155821988811358 -4.7050142730096364829 3.2289235883008231554 -3.8170088842773419735 -1.9917544081147691148 -2.2518601169877339174 -4.9593043866764077165 5.9202989426965428876 2.2511897617773577451 -0.22245509530594417824 3.5074558435444278537 0.54149466665159218248 -5.6259739501918319959;-2.9376638377991257656 12.257648914901661641 11.692902332235092899 -16.658813462992942078 -18.102900102862495402 3.8151551123269880073 -0.55694390102671931242 -3.2323177481774383324 0.58887241245459676087 0.43025598678364701533 -6.3177131969023738733 20.525355163933419078 -5.5879086890011144817 -5.5243692593552076175 7.1711622085720421182 1.585422545629091795 16.730020017332371651 -0.29286624175809089499 2.5411896989066526942 2.5740001198669864024 2.656410958906696429 0.25942060347905543383 -12.975502297260273821 -14.427705836393441174 5.042504247849923793 -4.3526372916058999607 1.9614032313802838292 5.8405309053802803021 -2.1436444124498126307 4.2911133188362686752;-14.240856884886856193 -29.092370042117892126 17.715201361383609679 -18.001461412757695513 -9.9766388220988702074 13.264141676223257349 17.223643767492163192 9.6803115978939135999 -11.982095063126530832 -19.47972372756138526 -8.1868369915436147721 1.0079746641274904828 13.735468898925097037 10.194612172790828097 6.36680990531837665 13.601403045055837637 28.058050462224848332 -10.413470320028345384 1.2600978504236222122 38.297750654307535001 -14.233605399803172631 3.8347674779127549627 -5.6850890231958350896 16.100084824480195067 11.513083266906129154 -12.627835834789379987 16.419167652167264038 0.31240621512973476559 12.664553499379470836 4.9488693260290670395;5.7043251509680334976 -3.4915086423835646201 -4.2371900464705944955 7.5052430418661231215 3.7254226935928822506 -23.150073285949755331 5.0392803028839896484 2.1443953390284509197 -4.2171526317178509302 -4.4567088435057335971 1.0163906226187309212 -6.9952629121274014778 3.2495203048023122427 -2.7876382349150361506 -5.3856709590381885988 -24.445808316794572335 10.668969487477310665 -1.2653767037999981149 -7.191176283206153208 -12.464106018933611253 5.8611741728940121021 -0.50146932875501870619 -11.608866017549321015 10.535088590594730462 -5.4736778080291772497 2.6034979057708484973 3.3553163666167593604 -9.92770531487125929 -1.2818516965237471972 -4.293569180437448729];

% Layer 3
b3 = -0.27500239471887449882;
LW3_2 = [0.32027382876777099607 0.20674313472942681957 -0.1218743872905414527 0.0044478140777634419742 -0.012725073439499037797 -0.010104963710542643612 -0.047214049476491590229 -0.035064307278245034072 0.0086422267004414334013 0.01127410339853764272];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
