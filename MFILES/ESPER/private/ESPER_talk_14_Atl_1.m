function [Y,Xf,Af] = ESPER_talk_14_Atl_1(X,~,~)
%ESPER_TALK_14_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_14_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4201218141676915;2.4037109829343208;10.906157605862523;9.7718691466148737;5.2274676943311942;1.2572894811550017;-3.6714198944759198;10.007906852900186;0.78765351317756871;11.044953532237844;1.0796914473461974;0.39860322434768597;3.5509257992024712;2.8062262857003857;-2.15836602776234;-13.200463431544454;3.6156458433341765;0.6509075861027932;-2.1809603109352524;10.335887400728778;0.063886206568062182;-8.8353808769877933;2.2181145898449226;-2.4272078292931036;-0.43700469647829759;0.62413869533825794;-0.97623014796782248;-12.46941047492558;-5.6469417568665596;19.457260380059356;-7.7285683606770057;-0.15069386123056996;-12.80289034505326;-0.16398769104003405;-2.0164737663435957;-1.1103031253738749;9.4886081085396885;3.5367082395069831;4.0080815364896054;-5.3438846846158787];
IW1_1 = [0.057433966546353632 -2.9913924402954057 2.3729312061611312 -0.23087185207879643 5.5082512996754929 -0.14495126125262159;0.84739813563987065 -4.0142883328415611 7.6465013825892685 8.5271580560269609 11.691938168549038 5.2879314770892085;0.10187420831580653 1.8549403317433752 4.4942429263784645 16.84000073521964 18.958003851572673 25.89769181842486;-13.034095424449173 2.4229015222860966 2.3107761891095375 5.4904207909619061 -12.337829187014355 12.803782945617595;-3.9778774163206183 -0.49251436714486907 0.22724609932098597 -0.044103342744012598 -0.7494838373089564 -0.026102619760438844;-0.051327996218581001 0.2898919697073688 2.101806460205248 -0.010279817945205723 -2.0829872634823925 0.031060645683325665;0.78165001766487785 -1.3308933585726821 3.3648466081893083 0.039804042870564056 0.7645927068237105 0.17897425945820331;-1.5053103815746711 3.1476986571074979 4.4377499517916084 1.7430224884746361 -9.7508142838477276 -2.42113835739009;-6.5133863017930569 1.5491412536351823 -7.0331958704562911 -1.9902874276431595 9.5026355487031271 -0.01510709519223475;0.64776444766821584 -1.6400347448739683 -2.4306615223430725 -1.7309526961378423 -14.03851059298772 -8.5819933158048247;0.41418845764672169 -1.0395448771713132 -3.1934433501943724 0.068496661316644655 -0.48284453432480445 -0.24973263422734338;0.46375680259240465 -0.27451445311510175 0.22925648546941396 -0.0097080342887376977 -1.9045027105386954 -0.19867229839961922;-1.0126665173899025 0.52457877967328992 -4.9186333967732923 -0.14746523048387125 -3.5722362356315807 -0.077971106097097051;4.7543537875492978 -1.4683456265194863 2.0308719354789404 -0.27406967106824709 -2.6253426939114202 -0.56262996039751312;0.081443097832853556 0.93438271529700634 4.9636418313404045 0.022953393721055954 3.9296911692583443 0.40789613127550672;4.050805987989416 -2.2939082659891552 3.1606313316401269 -6.9385168258735845 15.691231112148275 0.69705625222873135;1.034419114935617 0.61626620388264985 -1.1540311788086617 -0.25842477070877201 -5.2372452455476424 -0.31168196050765246;-3.0524959111847392 3.7073646009617707 -4.8818884998387926 -0.79887005266540023 -0.60015186192254644 -3.9176002752998378;2.5386601057260849 -2.4035522595240129 0.3068000672355593 -0.065369729078493644 0.86223099239671075 -0.083305451069142319;3.3510314186284766 0.86580352941977201 -3.0749581018716725 -2.0232650188065251 -15.584740226522712 0.70386875634858559;0.26032420905279985 -0.82276313266310908 -0.56296516842584599 0.27096759206909271 -1.7057310414836853 -0.96446410045921938;1.7780761934101661 6.2536599776596189 -8.3874899914008854 -3.836665558974699 7.0731267328125842 -4.7053993953553022;0.036110680226795193 2.2346115720536521 0.04431294732961584 -0.014982435376986385 -0.76830540800756564 -0.027994459004072981;1.7235775004414191 -3.6227279773665706 -3.565010328789155 0.27009180956609052 1.8171453374317807 -0.35538788433163898;0.55099229049459519 -0.8766417673516157 1.4965474683240774 0.017284175200617636 -1.6472351874049893 -0.072146033846873486;0.56329830172524331 -0.046664705864537789 0.38729646340948881 3.2350613511836892 -1.0180883844061037 4.0575248287905472;-2.4199866381900907 -0.73519321696319573 0.86366531427269344 -0.035264204224803468 4.0040701191674666 0.2667445504746207;-6.8161698307001517 2.8591245389965989 -8.6933067239755921 -10.369814452957261 6.5865224024004538 1.4773682546454032;-0.059172227371038354 -2.158219316821981 -0.48409187553984417 -0.10250221228339457 7.7744881716029575 -0.52067631820325522;-5.2993772526235494 10.798685363335938 -7.8166053481362399 2.1460515831847311 -4.5267323074680483 1.3821405535924955;1.3262038441650468 1.244757539093873 0.98214653472684832 0.40751876695900774 7.6767953348561759 -3.3245727853406306;1.016455943547794 -1.4608460256721068 -0.25037826870615471 0.36188188671393051 -0.097258468840033557 0.77026769616791846;3.9097212357177411 -3.6809823505169712 5.944571379932051 0.50307317590238665 10.832645915340155 0.014700149828133079;-0.95530622540846755 0.60511448130770074 0.32901523921862735 -1.1973447841478335 5.5875973341131902 2.3854745759408043;0.114456947198329 -1.6844885365460109 -0.12143089732628001 0.032013262360191828 0.97420132061807596 0.02854742778800682;0.20252500742798732 -7.4304168524258172 3.4764767798133711 -10.789052208300557 -4.5528618764874587 12.78827753253077;-0.15256231708348553 -3.7933657685742856 10.07254709411804 -2.6772742838792709 0.7951531653856917 0.24018418928340401;0.72769605741115262 -1.5402079412112133 0.78558770504887421 1.1607728598963745 1.5230857124985822 0.94831548830666412;2.7223656863327008 2.3227045672618551 -4.5404830660063276 -0.27485398591822185 0.15211754113282761 3.6579944085393921;4.2715940115057052 2.1096633411499126 7.5852868449174613 -0.3755228934369681 -2.7328964221986642 0.65498382407478395];

% Layer 2
b2 = 1.7813548167396873;
LW2_1 = [0.057220584052017763 -0.0079002562581589521 0.00098696977620375695 -0.0041297973096358336 -2.0203419485176832 0.5570194789975349 0.40324171715917378 -0.013186475898714281 0.010386677357587139 0.0061477479455822256 0.5089702801440682 1.1814394807935165 -0.1618940349220494 0.092947134586411129 -0.14886311301960514 0.002679615753957248 -0.14929066581886899 -0.01028427667085696 -0.27696098865780422 0.010234312309369801 -0.12631677898240073 0.0045496421106697186 2.2055020588361089 -0.29609415903587766 -0.97305865060633889 0.0089093094247932516 0.11758779543363269 -0.0045616270523096327 -0.076428057829929383 -0.0078520395079902522 -0.0066787791278652914 -0.15966681413953077 -0.028845121929885344 0.16647331414656402 3.4089718883812949 0.0020297241834008419 0.023260082881135721 0.96045344366106988 -0.0086080499360508406 -0.059538456741661507];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
