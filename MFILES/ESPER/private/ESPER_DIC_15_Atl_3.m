function [Y,Xf,Af] = ESPER_DIC_15_Atl_3(X,~,~)
%ESPER_DIC_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.299494966574837207;-0.20220663596151336461;5.3061809433561490934;0.23800128953998153647;-1.558968727556834688;-10.136660285840333628;-3.950151318334120365;-17.784910358899068683;-0.55117560193620529496;-0.49101381261439469572;-5.2379673963572015438;-4.900304239317791577;-1.6964792657013181287;0.48038879758184438451;1.3684164817503476907;-0.4631007147292812709;2.7853311397270799077;3.3831702039175834962;1.6347647357117933709;2.580308544727918818;6.8023265933665264527;1.5253870598945924453;-1.2354074946010187297;12.548355651555379353;-1.9413307247306772485];
IW1_1 = [-0.91157896747798328185 0.037712910738162103153 -3.2649982398982104748 -0.090886861313393366157 9.1806181246573821397 -0.71027563919952330096;-0.60416383178364307938 0.25481988090193674612 -2.3631356072198292928 0.74582161057268048232 0.97457457622616294746 1.896823330561727694;-1.0619761102096938465 -1.5513488474568641884 -0.39809269078844200518 0.81954058042575583798 -6.4247222047552110524 -2.0937267742497249756;2.7476220926855940974 -0.65464079617658277321 3.4080280511849729841 -4.6044025265002037628 -13.066774979250457278 -2.8273310725570768298;0.7553790721517887885 -1.1660829258768987682 2.6643251006738526421 -0.22532813966185621934 0.14666222365811729111 -0.54551800395287930456;-1.7426909755483290798 4.8908916099690982193 1.5892019333145961379 0.18978191428854440659 18.923522619136033285 -2.4178075965011007753;1.0485661975926192646 -1.7297771293111621205 1.0923662204047726032 -0.075277789613050011264 3.0343932542226621507 1.5878200094786318886;-0.096358255884223517618 2.0483748321040562423 -1.1700126984741041625 -0.36678913590636641473 27.196883943128380423 -0.59400807591902926585;0.17194104510626836979 -0.0012591787935193382488 0.057571988680374844294 0.0077260114922018049977 0.97148471457491547554 -0.0019891079179038969292;-1.9319566178316751603 -0.19282126778828567737 -0.12044101090792695696 2.5043414500632565911 5.4303290579086764822 -3.1079692446907354331;-0.75500965644229678375 1.7246465716000323187 -1.8726396584996789496 0.95209672018966862161 6.9367901792220161283 -0.47654589180455492192;-0.17617496765854878671 -0.010303079563798970761 -0.1626590364662678645 -6.1828841413461352872 -3.6811157272377856842 -0.80367565817907626879;-0.52475326409782097059 0.58767612688457104841 0.89019816824664443899 -2.2888389369605670609 0.92082624548219671468 3.4769782479422617349;-0.054379673867904286533 -0.035789632319272790539 0.013403320821405960428 -0.021573234639475094565 -0.44376883322659976816 -0.048091261976523240473;-0.088315022009729696184 0.1647493792359526199 -0.2461073085890777834 0.19181330662872547732 0.37694415248327428625 0.14747991998906323508;0.17746518197192248656 -0.4253690169988962877 0.71799876576525889504 -0.84177749569343618408 -0.012946914692637071301 -0.55523205748409043547;-2.3753990379404124056 1.2067207263716090981 0.51304085519349063027 0.1096220817553795468 -1.9398565429825225248 1.8173109330188061961;-2.6364972437703526609 0.60923043293684808752 -0.75216155131527473454 0.45495781327607526245 -2.2213881269662856255 -2.7643025512953496303;-0.43385691160525013954 0.39384310032740232899 -0.6378724294315346599 0.090728985866378036862 -1.9752365219432739263 0.97683298515760075276;2.3758553099778829676 -2.9021726892729131642 -0.55159282039516877028 -0.94420266372537087207 -6.8654579895338434525 2.6798924490258442255;-1.7190619767927486361 0.49481116841336636458 -0.51577829466691860194 3.9216627895995430642 -5.7290496370848220664 0.5112216986821782605;0.22942858850518091374 -0.21292707177616967962 -0.60810223154292986081 1.3644869441494567042 -1.1283953921618521399 -1.7610112532915516148;3.3071710137972969434 -1.9998759222005246805 0.81285361423132551639 -3.4184634715797694859 -5.216597230050402878 -0.92898502595579801611;2.8416266057651937693 1.1604793011962293292 -1.4611994090446664973 -0.24880013096569592035 -14.047487244029072784 0.73956532628519267014;-0.72170319962176077144 1.9930751278322527131 4.2797655915922874215 1.1375734276535460765 -0.68819827492395424517 -2.1701031348797696907];

% Layer 2
b2 = [39.176699725416334275;-8.2045410456543024225;28.940352994688744559;4.0463898680160941268;63.313468027765757995;147.07039290064491865;-16.885727149126971369;-5.5610695776517378164;25.033223341739223144;-3.8061343219701284646;-62.743394862111244947;-33.227824633615426819;67.130405155797177486;-68.403078613047028966;-0.23682266801339740825];
LW2_1 = [25.972466581906036964 -53.919987872773056381 43.762997518680705866 9.0314100886611416996 64.503456112814873791 65.773106412770914631 -19.326157385685124979 -26.221111746013061605 74.944450054048985521 -13.545164337765376317 41.315884445131587199 -37.688303427479084462 61.8403640823901668 -106.50262067576814218 26.628532161466250017 -61.317443810850264185 24.579599453145675625 -146.44767685209325236 24.917077254102718342 -107.89236739258527109 112.99518849737826542 42.41495480775617466 153.00594574235333312 -102.03137749393245315 14.058934538819537252;-13.201141963713846295 11.451619069388167205 10.679810867556160048 -8.6031453542725131456 3.570499697321701138 0.31595964007591359479 -31.826658033214652477 16.124103041146540249 -40.649946513026577577 -30.668176265483495513 21.292149806799670841 -23.086172086180891228 19.986554174989564103 5.1069873612420364495 8.9084038424434801584 1.3609120740801197158 -0.22861477618396525147 12.606474969665358188 -83.897639572500494864 0.63517802043007831614 54.232625963981071493 26.804686814796525596 32.609549729044836397 -6.9840101255541346958 -30.044645566193032948;9.8655817738332718392 6.5099386589923238233 -33.428115583739540284 5.1880072378414894274 0.66557998636773896273 16.449465778603901356 -6.6389984433409932052 8.2327631377513128541 -18.102595670148350138 -3.3902693254971407733 21.780670830064309484 13.161550540132035181 -42.88849597210925424 -5.2999037575016290091 11.000893162705244421 26.23875947032658118 6.7367804493530165644 -24.791144140010963781 -28.85891004794711634 14.902178709994851502 -23.063753345205537215 6.0348656588997906525 16.947389287869853547 -11.961649436377756572 -7.2687703028231336333;-28.591531384254754045 -16.854169556779236672 -21.933299736277909631 -2.5495590333864504018 -8.6151876152807389531 -50.686891978431788175 -6.8775364943731736034 -9.5894051222375153998 18.24803670063653982 -38.501482322291217031 3.2050396539091923209 18.050090260893949079 2.541216486843138167 20.114952673600416944 -29.171303907011754575 18.910824034406889638 7.9645278492653757141 26.542159316731574137 11.932808709287717974 25.055730974005332001 -42.897303626038748803 -4.2915764198300561105 -15.201378207832956235 17.458669451637170766 -15.326969401555555095;28.704187276867894951 17.650253907289943811 118.03821563744081402 -31.607384529461196365 15.773912133420305182 57.620771099105454027 24.711296431246303484 3.9530579929713614007 2.340642303556659698 -20.921664337160994052 272.87261370117738579 -72.094902695868356091 8.6668926131833323723 59.920007224511699917 -3.3738325067011074587 -58.102402216444545502 -5.5161909333295922053 7.2120164115832849916 -45.417430606699710438 11.020961506760420079 135.64512117165392624 -10.988459847844680439 -21.635465051959993588 24.295609251203224233 119.79294581482172077;15.639058074375840945 3.3359560898690161501 -44.281956467555943391 24.463253000225545719 -3.6216333830403075744 -113.64050971515929689 -14.489741052029975421 -36.580066825857109336 -1.8359564371914898206 -15.05646420621387449 76.463740765878654315 15.883997346144752782 -7.1997195721205722307 -59.097858426301435486 -115.88936445515686557 -19.068318396456451325 17.006281826135314361 -26.565336868695855088 -37.525128330280075772 37.369272818046056273 33.64567961698737264 -69.950706500960492917 -13.708300012344075469 -62.76301017610666122 48.757999113746720354;-0.055489694058598659776 -0.11449912224853572851 -0.048866244311561057856 -0.025848970309892974756 -0.081095045271446813961 -0.015953349522911754177 -0.14991860018081726302 0.016434976570387761774 11.055370863671642567 -0.014284957318526332951 0.25726371380240831144 0.54625321420395900329 -0.19515017762514899613 26.532147593345758452 10.831894481973753486 -0.41338221989690671077 -0.013681753557465528223 -0.032558955423859892164 0.2550319317127815455 0.066500850506977834953 -0.006316992007856141525 -0.53000278325185090633 0.0045991086981845546305 -0.047539508912551362019 0.042037485468518404064;13.711408573688876444 -25.325274542391493782 -12.162076802820900312 20.213057183291617491 7.3933212033357111892 -9.8900707566968950601 -2.023736735907692097 -10.544530814506934746 -47.217158249285077432 12.357555274578343685 51.611434628639258904 -15.86774297176364712 -18.859632704588484842 96.808533861900997408 14.752897669832396588 -29.177019475888407385 -20.569816713337772285 -54.010741503014799036 34.91415017977796964 9.5912102450160272582 11.133503567964250891 -60.084990563264113916 -17.43979277471665057 49.718108785309816255 6.9962937011306669532;-54.798596255729712823 -146.07059661207199497 -109.84322869340347495 59.636609771382318002 -90.968669509182902289 2.2366562230012791979 -41.994331327755567429 -56.269325438175101795 -65.607420080531724693 -1.088424057520242183 -28.901682449171431699 -19.638917381178821131 49.296339015375430392 -118.75052300205091171 100.73409838842395914 -101.06925157537827431 38.789755286573210924 -9.4096646280642488591 -38.904417310417478859 -15.317267805242806844 -82.586117927594656862 40.423066807869318495 116.02050888619423574 -32.825927576205309322 -87.098672972364695966;2.1076481889346290188 2.125419058764330682 -9.817079758892782948 -4.4066528443835801809 9.3341673090447923045 -7.2026129709595707595 13.636778682889627135 -6.7051449598773578131 1.6287488242672518712 -10.955848371829034704 8.1481372720264584331 -28.010977427943245743 -11.603522380522548474 -10.511631389455802221 23.327538194057456877 17.711905809871964834 -3.0667070731986258991 0.03746105710571970282 6.4990951636851708173 -16.454731504501204142 11.53249405595444621 9.4906287716490442818 2.6331131084962091649 -15.363222137741994189 5.7107434797467142573;88.745450442346481168 -58.579494575690752356 195.38075087450533829 -166.42253757396443348 13.41230322418283194 59.89526515551919772 -11.619592068863259016 20.903746612909078095 -11.955614790344313292 -92.239660972193902921 -102.84623701286949427 6.4644307377858538644 -33.395613247084042996 61.874606899795480786 -157.0766691464438054 40.202760844172871657 -34.407785097910696948 -25.657473293858764407 142.318845745650151 -145.8025912702937319 12.112006199916798721 -48.954710233312844991 -83.059810256209559043 11.723330441956751002 -118.63134891972426033;50.235324194924466212 26.154117192368506295 9.6880326660365412295 34.991405354487284285 41.043584444521272303 34.502533510329811861 -50.302961938846600276 -4.9139279021268329473 -65.276539317195584999 -18.573761981890719142 -41.254696581926083354 -42.384273516066826915 -24.869612262548173476 22.033308613953213495 -17.798538879252696177 17.699457928954757335 57.724407512892504712 -27.362495742312383129 -53.31380849296263591 4.9363347309131837548 5.9736654302420237883 9.2823493745260705623 0.98662531175012957441 -18.374815240564377206 -87.353425607099850936;16.185575369673642854 -7.7789629093953189809 7.3779518524240144117 8.5268360879330096225 8.3493696417760343564 -5.8249219716362787835 16.782102613640613953 10.274675079610847916 43.610428693768533037 -36.21596586180672972 13.989797234271380333 -12.387902745977788399 -18.596846519737471937 6.3141485089559612476 -50.5954117116205353 -23.475098713432288378 -35.734733401669821262 5.7130756215693461186 -25.211191244342927575 0.90861816195959366205 39.345574828534751077 -24.990575330696330525 21.644398159742529231 -19.012771943291294718 -9.5816149835317059313;44.52853069416750742 -48.919936134469352851 -11.317412332990910429 52.871957728826927791 -17.966597334116013229 -18.209754721409826317 14.033198910115684654 49.45006182045474219 -75.725226556842798686 -0.48394861495994706546 -68.739373975149646867 -14.170984042644736434 5.9880305883518367693 17.069457764440880254 124.2378126148844899 16.953543838410084277 -27.328657190379207265 6.6369371699470907089 -1.3436372646480889692 37.851926923457327234 103.67796017677112275 100.45520980808218781 -35.121507488532323293 -29.685437153094103024 34.385891736899132809;14.14718757107475966 8.8184006152620479924 1.2188032551047007779 -4.4036872563245506029 10.426695225858226834 8.1897429132025898468 17.816708414274575745 -11.959438487097893145 8.8211795572788194164 -12.059246842497104879 50.436707098886408573 -32.719387824001664455 36.622476852321007357 -32.084481297860989457 9.4112569449034548796 -8.0796739769684577936 -39.188796372575531279 28.08721284088687753 25.086397644839202314 -30.788483534902272964 -23.492686131032876062 35.430756698774395375 -14.068866606275626907 11.267782082896243168 -12.449498934731270339];

% Layer 3
b3 = -1.9145310695507100629;
LW3_2 = [-0.0011475775097292346179 -0.004023838853654246317 0.00063390442806212136083 0.0018267083081743077082 -0.0023038180674447334036 0.0041750562347458355233 -2.8872010332737247928 0.0038191823970408597839 -0.00018329016038400516441 0.0071152665590599149803 0.0022783291143969926912 0.0046957375514166069946 0.0026142777638660259082 -0.001352313604506609002 0.0023591017037397055654];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
