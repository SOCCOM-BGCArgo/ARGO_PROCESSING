function [Y,Xf,Af] = ESPER_TA_8_Other_4(X,~,~)
%ESPER_TA_8_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_8_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.7574135285794709738;8.6650552443961590399;0.90826172424288564855;-0.17371247425911887086;-1.5251744843304575472;3.7951391073305642543;-0.35677244169672023277;-1.8022516442111484736;-0.50202352198243904713;0.37842020777339380189;1.6699996829064331916;-4.5388558118099737726;-0.42648442873685254995;-0.22180848638273231721;-2.7005122803107370899;-4.2099687733674358014;4.9596065641959832249;-2.2780365169220235799;-1.854181065115399818;-3.0157291982155083332;-0.64810995250818115299;-0.50550287286949435739;-1.1814836403188166969;-1.8102587003235068863;-0.43216432583018554725;-4.0529930810619800852;0.40550743728861882165;-0.82489337899301262702;2.2043097079066784616;-1.1940208366141535912];
IW1_1 = [0.84430933523136275642 1.2017194109845548144 -0.89763526479993016594 -2.2583415079419815186 2.0063017842007937475 -0.42678954673127661446;-3.9757134519264445416 5.9729653095539321228 -3.1841599039194994347 -0.14556055991844710218 -1.0177043005554498034 4.2951498859919272633;0.59702800667418876035 -0.16115037810096979887 -0.78008015351211468236 -0.28714570555270663155 2.8344215402856161035 0.80397862787665785866;-0.24131975189364990309 0.32758179053012942417 0.73462074675743538332 -0.16547460353116102971 -0.90151739656613782969 -0.95991610960141982023;0.31212483234309601476 0.14892277308887000298 -1.7529029075011730576 -0.32350558592199862851 -1.4743299154610669532 0.018115432333341778548;-0.67505836322236845159 -1.3366051013025275207 0.2335605015610355828 2.0245256350127629474 -2.8771848648962614625 0.99788594314835021848;-0.22393093352085954861 -0.16003074072229156455 -0.016772807549322820558 -0.33630709330858071793 0.71148676834264767965 0.46554761177842690634;0.2644251517820542241 0.11464962343162174441 -2.4549573851295720672 -0.30770310002790957071 -1.753516323085446027 0.05692692957698679973;0.86729389957389058097 -0.73576887267243817892 -1.1604935459882033122 0.27799717802502060815 -0.077432192179724024239 0.80207324919873035363;-0.20525246632732638274 -0.32785438000286637461 -0.24069841874021347117 -0.85651476652889413366 0.15797901413404041859 -0.33021088559946498719;0.085737047125925308633 0.11457279337280208698 -0.051650984627748315614 -0.78667455210005277078 -4.1013479156607619558 2.6512031706408905052;0.23093924244404978596 1.3306821860421873538 -1.7366313470808747432 -1.5297050681836397157 3.5516851126184207921 -1.1629169787147688453;-1.39562944086772589 -0.57520849683825325815 -1.592538431226848461 0.055067940882486288157 1.6080195443023137525 -0.41644822186567842515;-0.44684060976329476045 -0.24504354742389816701 0.028482561288777588637 -0.91901490931914253668 1.4255997510236457781 -0.49733850604715207355;1.9573875658697164059 -1.0412014112819880651 0.61743403469186253218 -3.0265332491200980236 -0.079769953961147971322 1.003930983972330937;0.19947728320374497057 0.39062018166755529958 0.68044143962030778638 0.86583668543555480923 1.0941539766160099934 -3.9684929411117226827;-0.032800792616431415083 -1.0228090174408281943 4.0680696171418864182 -1.0536527773950152831 -2.5973420442021279975 3.2292528401859490472;-1.7072585467485594801 -1.0773343149462346613 -1.1959049594017399087 -1.6089363173985655742 -1.3002766411395496604 0.011575921149313094308;1.1351978830817239796 -0.40713025089226539954 -7.4690019799674391976 -2.8126778838153994045 -2.9018749400473873301 1.8712867272257291962;0.61828146432330777227 2.2535561980431397799 0.42016138550693171716 -0.2155318045211562783 3.9240401197425573976 -1.4531495259786688656;-0.97089986708353503975 1.0184767488307433503 0.052397594635638616856 -1.3475325299022571368 0.80246373716704111345 -1.566319250758015702;0.037691796316835272929 0.85527024448799426892 0.24284798384996819642 0.56239906434213171593 0.033266191196277786202 0.64898070081475367488;-0.88292797164902847573 -1.3877933095525758489 -1.2510914992986001959 -0.41660349364603199707 -0.4307086062723954889 0.90507446730697160842;-0.56411692474480223947 -0.039573061210337677485 0.5356446421687339754 -0.91844072378452845662 1.9587114497592807982 -0.50952951379875910387;-0.61447652305364730552 0.2320887730162930207 -2.7134968879089100824 0.71391447510410366295 -1.8909065524616468501 0.11001421931544230759;0.10982985617821994229 0.2623940357230803988 0.46382507480934020982 0.85619756973646943266 1.6478169227813572739 -3.6319679510713642756;0.34681579912210369621 0.28853532020850680695 0.037112105715555447627 0.3330978452561936809 -0.35254658383052589476 -0.71706989766631568095;0.17152190734237088288 0.77502274864919362685 -0.28158508763928274954 -0.45749640825656417986 -0.6055658848252669646 0.52050898561521175001;-0.5687872888042618813 -0.93358550755425451229 -0.62265452630314699345 1.8945856537209306847 -3.8940146764008360947 0.56789171520871006837;-0.75413889363410413491 0.51616475243911008608 -2.0925456138815565765 0.72957902019301668073 -0.17883337167501325848 -0.061634376162218319772];

% Layer 2
b2 = [-1.9703835011116657139;-2.1873089643426162354;1.4607830931638350336;-5.3100855939753266455;12.091022451761778811;-10.085333125035356616;2.955936248268204114;-12.425153038923793858;4.2519808529167599787;-0.089921261704526966874];
LW2_1 = [0.63666049859123186039 -1.2550036119036800386 1.3537114715526106234 7.3580422580660993503 -1.6529949593693609167 -0.2180476125411778543 7.9437257660474287491 0.51002540996420286934 1.8409634439945363749 -0.021584972565218699114 1.1552348238377676548 1.8709652784563530759 -0.21074492180658263574 -5.8351036520940091634 -0.34234813755485665743 17.411340080384601237 0.16417462053991652149 -1.3881814922867130591 0.15615235700438956368 -0.40670718990575394081 1.7943504831296344104 1.1204114576597392627 1.3858057303268291882 -3.4919010183857555063 1.5141802270387365592 -23.989003343739046414 -1.4643247135396488812 -3.7252610302476134585 -0.066321122125035436579 -0.95878659120531284366;-1.5532555276640642727 -1.1048150203449014217 -0.21261284347395201233 -1.5757010082773834636 -0.63305264850483200512 -2.981648262658948223 5.2102161499922967636 -0.61912712331246055886 -0.2470643567200017654 7.8696081834853659487 0.69051226459418146852 -0.76946199465166276177 0.23936951305711043347 -4.196268516324639819 -0.69184401086463986896 6.6908882148269688273 -0.67412658438471340094 -0.014539403072505920761 0.11554681925178016122 -0.81858290933576083326 0.66693935995684849871 1.6769546982146672498 -0.60551855989679637116 -1.5831169364322896786 0.49313703016660903611 -3.9649027738274749133 3.2813141261326501663 -2.3541605177254734116 -0.31175465945776437149 0.24994654182788167418;1.6375611319971412616 0.58658190406785259974 0.69883141912327739753 1.3394574962349399261 -1.5028626842108092632 2.1365744317315731315 -7.7389390757644935803 1.2579193031151449933 0.85511748926145370042 -9.8920598148437122177 -0.78776901153318290572 0.57203597374876680171 -0.082386632045907834399 3.9003867945494414826 0.46502971602254544736 -1.8777558426033023053 0.50923612362062697922 -0.21410067979071925603 -0.1291839419376526743 0.2574008939652593364 -0.091366566527115514185 -2.3236759053539901565 0.81097451301630463227 1.7314036288880001457 -0.68432399879470373616 -2.6490614220737449536 -4.8903272641525612485 2.3991246941363391088 0.2568292446027861109 0.55085646240787367045;4.6086702055409611845 0.41597750504816422001 -2.194443504025386904 2.6933537652818344554 -5.2826501670944123745 8.7915324128365224254 11.299330959084555204 5.8943504333678911067 0.37549967663922406702 -19.479384295468694432 -1.5635827051870481164 -0.075358206512063638516 2.3502220471379056121 3.9033942499282532346 0.58663488027590104945 9.415156065598630164 0.62395216022242705467 0.66784319974343342441 -0.69372950612250527946 2.965990133991127653 3.529123778751602547 -7.4335337528965430565 -0.80481278534149647275 -4.8605836151467505246 0.69457158305510324769 -19.663319000825357108 4.4743620734968194697 3.7336101018516210104 -2.4460172725935733773 -1.0430226136939444448;1.5498330098363284346 1.7602226482845868549 -3.8601318628498408891 4.141819878578163916 7.9957472013607109318 1.4853413413671252563 2.2077932165768423545 -3.9183284575416998941 2.2143016834315054631 -23.234610560956475922 -3.3472736469334112286 0.048182047740334986441 -0.13010724471728538076 4.1898726383283646513 0.079132887783582711583 1.5897410122396780086 1.4470007131626350105 -0.44766491009650283273 -0.016858723203018514264 0.85891410194775075215 -1.7913589895895518644 -7.1601412545334994775 -0.11073474916205731933 -2.2059750288561108533 -1.4424958361951827346 -14.376904137665018624 -9.2374712238491358818 5.1756959613685546984 1.1350549282891011504 2.5060567603431573858;3.5403609117603824785 -5.5652309184662103192 3.2180469060905716461 8.9878655442954453747 -20.488987109749796645 7.9997625867673258782 10.005560200147892047 14.183855683020064831 0.85166278917199522702 -11.471275900173035112 -0.24974614035922462763 -1.2840227071154330929 3.1527312139674261715 5.3581842406462358852 -1.4000009074121169128 -3.3865374347925452092 0.7555928988937393731 1.0265246432659453912 -0.66736215586585023729 1.0106127958294910396 1.8797727373419659269 -7.1496839767282160949 -3.5989471808127642127 -6.6723798246077352658 1.2256152453608284425 2.0054007178385298005 -1.584517252923162367 3.1357643082507653531 -3.8948560842928401371 -0.7844642851708414355;-1.3387523253343003304 0.81560184174274530378 5.4868869864043618989 -4.3338348152772354638 -5.0814475108016594618 0.5998884693098840426 -33.29059231756212256 -0.16267024065596155658 3.8435050851144203499 -20.410283372690873449 -0.39098870554149861567 2.0850695654033262194 -1.9407544273858399198 14.6994287791962428 -0.094795276862166585885 0.37662657227503398838 0.025015616944634225943 -0.8492030754347849042 -0.14665732032265374474 0.25282945718438903926 0.25501003633784963265 -6.328887718924235628 -0.75458506636264666145 7.2207072694214460284 0.80168684312841176354 -1.6572863824551826717 -19.572796601212179013 6.6200787723354563852 1.813791745982318071 0.78134964098432724278;4.9480247107087622638 -0.77361160213514446049 0.15515275217098004057 -2.2386717314286421754 -3.7711363810037847877 5.6354454837515577381 -12.453538198122716452 -1.5285525030886273345 3.3218844217150467202 -0.57627681585213186288 0.96828967143603150713 2.069076647165113414 -1.8867825432299423216 3.4765030075294847123 0.046886130887522567412 -19.368824576949521088 -0.95096681774335445336 1.9679182055794819384 -1.2818182713353354352 -0.25099702196641054952 3.3846870909979394071 9.1057136958205120436 0.027362095151946597138 -0.51947926340969474701 -1.3582175672896361629 7.7280272292039091653 -3.4117592483365757339 -9.1302829628139523521 -0.87064438718336056855 3.2578160027600060467;2.6628723761348869203 -0.85059548172426202584 2.9601473855041118277 2.7799623102591839441 -6.5851515174779597928 3.4874156716880300166 -23.648635644530994426 2.6279988407712018272 4.3358180348647961111 -20.719145352396893145 -1.0025462397256714731 2.5695465389588414418 -0.99165409078044197688 7.4295937267697276241 0.96258747963050050878 6.7776795189848177969 1.0291287903300516682 -1.039134973168653886 -0.48519386940391190377 -0.09221144697245102495 1.3787040194215016697 -4.8715386311323856106 2.1838229051794697533 4.9037317537316518212 -1.9011913953654104859 -18.09769298002354887 -14.583751845463417851 4.5037640327060719514 0.56505171922013031072 4.0780991105278365794;-0.14576939239047723151 -0.52644913838182516574 0.82628758464684137763 0.76794593810133049416 1.619148767168890668 -0.014225790560772262269 7.0364849374358096057 0.72353231154429975547 -0.57211260705161803841 1.5420726114478640056 0.81886797761644480875 0.21259219143843641198 -0.048482830370371592099 -0.8255452464501097376 0.053316855629704215658 8.5903512629825229396 0.023984618432865291437 -0.1936625537148947418 0.22286920906675353193 0.29117318166655992151 -0.36672266702495937007 1.4857497649697857245 0.59624509950841919625 -0.6707295600953315784 -0.34532280069001436429 -7.3498284845222050521 3.9510375374030646256 -1.4911673174465480685 -0.27378139506900256439 -0.48609907420517367571];

% Layer 3
b3 = 0.82176074183677183527;
LW3_2 = [-0.15088403213142054238 0.62108526887410253625 1.1175189916279031355 0.066850392544849979171 -0.12177462752330833751 0.037549682261644408421 0.11286944327477094197 -0.075995139922625451478 -0.12858122756083642524 0.45019516392579728148];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
