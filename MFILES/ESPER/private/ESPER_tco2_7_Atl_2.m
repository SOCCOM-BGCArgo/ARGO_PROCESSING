function [Y,Xf,Af] = ESPER_tco2_7_Atl_2(X,~,~)
%ESPER_TCO2_7_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1428944269945336;-1.5012797254483021;-1.465847168884205;0.29669513321926111;0.56148436411063585;-0.44538801103547709;-2.6433222197213353;1.1443912579212296;-0.9411854550996025;-1.6978555097078512;-1.6349981530831403;-0.4680614743757846;-0.79590865310508996;0.49818964853201952;-2.1051230737705575;1.1206279886708741;-1.287620731862646;-2.9173834758790247;0.096648154525600896;2.966490489030833];
IW1_1 = [1.1848264366912828 -0.97317084236118589 0.91877210803675524 0.90776103596792324 -0.63664814572222572 -0.128079649356654 -1.3514909592928859;-0.13862719531219014 -0.74808397131926008 -0.53054219608583386 -0.45508827901899679 0.11756929862085366 -0.81406649768251915 -0.3261073129512318;1.6440753804569945 -1.295187852528443 1.1615041929218246 -0.023163850798002331 -2.6769207817267966 -1.2923378911036052 -0.34162552842656324;-0.47269855227635793 0.99823286932725341 -1.7069635735852979 0.055816643967310245 2.0500681275851611 -0.63905166714123762 0.54215986948479034;0.78073579451056641 -1.2851530845532284 -0.35657943965845157 -0.0862699111612273 -1.9279483428831929 0.30819246442285642 -0.58334974190359645;-0.91609366707383277 0.49614528642022659 0.54804546940675658 -0.35261072833820262 1.2277309607669076 -0.00033712659473807485 -0.79525012973309828;0.19339666648251957 3.1000822628721343 1.5032885730035896 -0.72412750635891077 0.48887085010832843 -0.014879853406491412 0.29716068743404667;-1.8203843383175664 -0.2548186989702198 -0.7504792100515133 0.1655254771350112 -0.56244438198943913 -0.72815673216858667 0.29495478512089768;-0.85742675595422813 0.24089425692244068 0.45926692875426783 -0.14186749044894645 1.8817189903828053 -0.73481096125045564 0.20663269883546273;0.096917453632523076 -0.85508345079981063 -1.4340705740295245 0.084363075831250037 3.0109363793327746 -0.33443561190489396 -0.0051322158762324909;0.88670081116298982 -0.60888061369961211 -0.74122119228558425 0.16021465165517063 2.2902317984589757 -0.34603375222636218 0.35293395265873284;-0.85269796710934198 0.076462904368368279 0.26444235443915171 -0.3776304559861694 0.46874954769596078 -0.69152490853148818 -0.59877319325954037;-0.84366890349302015 -1.1507043101122925 -0.37591537507629774 -0.25549038371794686 -0.60835920542645483 -0.027203872404190869 -0.18787184527297249;-0.23469758161670792 -0.62547682325333576 -0.482589937578696 -0.21668639873112661 -2.3839045951684041 -0.23385981214675061 0.53094619233954998;-0.86359834680331338 -0.34293635195153244 -0.90205649288009837 -1.0041818778253591 -0.30106510505954293 0.5821297895788532 -1.2321307187020012;-0.41948960174552385 0.059353752296035213 -0.11437164479448328 0.64925548801717214 -0.068231161264504486 0.0058532411367995954 1.0856832572848663;-1.2580515831663623 0.78417037848944637 0.88939552717616921 -0.54062497843151969 -1.0837202515416997 -1.5553611429547769 -1.2363433043367928;-1.5088662992173838 1.4424150891066279 -2.1036389131290121 -1.4828486413626336 -0.56916068332585568 -2.1131798880760866 0.081057085996058043;0.59373665734930159 -0.64883185653629849 0.26008638559485048 0.043966747401658693 -0.25570231433688834 -1.3645917659371232 -0.35000210109962909;-1.6457926825074811 -1.3736819679534229 0.12183040326016881 0.61306773875483944 -0.97007779941330086 -0.094283429211854605 0.16968415770569534];

% Layer 2
b2 = [-2.096886769890776;-0.45034517865653628;1.829152052425651;0.80037604733276868;0.20314414446426018;-1.844720064715603;-1.6373289527063424;1.9410134468278053;-0.2529726308849361;0.39445279026366808;-0.41819269889320426;1.5372926682915931;-0.83369370678304422;1.803390364840747;-0.82448574458814272;-1.5243818727675544;-1.6608434798611076;-0.98629179974668901;1.7111289988610765;-2.5362856908757707];
LW2_1 = [0.65624428360162002 0.5662855258947318 0.27778097937483798 -0.14423605377124837 -0.31916131996925778 -0.14736206489725956 -0.57131755197493428 -0.44436239174964481 0.26236366855796084 1.5301210687980207 -0.19587363295039412 -0.23111243223187164 -0.68475744148664541 -0.024393823526324476 1.0608825481128239 0.44156042223555797 -0.61823027063337033 0.76706287075306023 -0.22398476754649449 -0.18292464643505044;-0.034140223769232189 0.53202851252777206 -0.45651535855186132 -1.3926899900490439 -1.2903529113923224 -0.0017589341918116258 0.029820478615558574 -0.36123424871066362 0.78541682730056761 0.7145449933540936 2.1386976541587188 0.089542172081123084 -0.87752149561352599 0.87282823863463188 0.024796068263320412 -0.052262682459371795 1.702074932908634 -0.77997348089775309 -0.41387833526959467 0.87523660153834459;-2.0659168599099962 0.38705294954092023 -0.45932263055409817 1.0401486385195253 0.2321261337395345 0.86808503194889552 0.094704432642166839 -0.16288304817823013 -0.64773711083397922 0.58709202808929228 -0.65365152635208035 -0.63220860081103825 0.86565946784101455 -0.82260613975557084 0.28043901613835504 1.0378049626272878 -0.86150558511469488 -1.6855489022425059 -0.93741465121649337 -1.2399922242015002;0.10878044446257025 -0.71578731025507103 2.1775709791079758 0.25637961016810829 -1.6009843803965058 -1.5081157871698339 1.0548876929995632 -0.94626783136489412 2.2630570370430401 0.15072709658098843 0.44313400746728621 1.4047738573075517 -0.058470697785805457 -0.78961064642002676 0.98835429565457122 1.1097354537012312 0.20539678294300243 -1.7398441906932731 -0.99355850353475694 -0.057640298627821954;0.25061307140251077 -1.7141633751947989 -0.3365999987998034 -0.68658675803335423 1.9394384796432256 -0.75264444984969558 -0.12237504580391925 1.1052752769271807 2.0463479762242733 2.1262523527170782 -1.5451203497329606 -0.4916339976538795 -1.0398916363758464 -0.81906213238531866 0.32916325126047569 1.0374385501722014 0.0099264882068971771 -0.4645658064537464 1.2670704355574747 -1.2586340227754091;1.7286238074832814 1.7302820062626203 0.75865901824060378 -0.10966299690142636 -1.5970770567397632 -1.8739152241702499 -0.055063287503546339 -0.86138039325144178 -0.39050111527274667 2.1279022934827228 -1.0027074198808006 -1.3734594290855959 0.056064333331934765 -0.32584091511480157 -0.073817335849947902 -0.61117034288576055 -0.16566251171938781 -0.015023493757243191 -0.90176451354767617 -1.230306415268559;1.1722280706411048 -1.6260750127079859 0.39965251173744509 0.077988600971805822 0.0010509125161292593 0.8789146749428226 0.086293045386859918 0.72651347004444333 0.49634286479520578 0.17815340566392293 0.34775675209031215 0.17706576912118749 -1.4922605939056193 -1.257359414598699 -0.18371107162794512 -2.3873461066723447 -0.4402183132420453 0.053693106909884727 0.48313906579935006 -0.76697500733403801;0.077551410276492289 -0.69333708603902366 -0.22125487319521733 0.62052201250962347 0.017923705809791336 -0.23991129617031529 0.045266162321873332 0.35809742395709548 -0.63870085214778793 -0.69481357649594833 -0.77574257253056988 0.10022812493351003 0.31227218062787465 0.50281494878580968 0.34937060909065948 -0.27743540144808054 0.18816372016225028 0.22303826495588036 -0.010924058944822974 -0.16187260186864313;1.0986554046777286 0.57862090038480407 1.6081074397826693 -0.11828318143367166 -2.6962123795521591 -1.624178991005311 1.1903611179148084 1.0292994057908904 -0.27697051044301796 1.3862003152528215 1.7316977659593429 0.32978025004977646 0.093489678928736081 0.27018793803277719 0.26035523799284144 0.77037346965124431 0.42969498029132391 1.3758489211665283 0.49090309907448354 0.9242954472176016;-0.10692506131534232 0.18231975184879137 0.095687650979832242 -1.6541720711550723 0.19079408980723569 -0.67645018477829821 0.56796504431885131 -0.43182470812217766 0.16203765931415121 -0.50907039481506322 2.7958272477475932 -0.37693636630442134 0.60303484527185491 -1.1449203829509103 0.79198242635641214 -0.063121283705531897 -0.77035732085553421 -0.03503299606944664 0.16930441876199556 -0.84989120862800061;-0.2821587437397568 0.99193505819036532 0.10068858859144265 2.3205848815385646 -0.31190452813144331 1.1578675696959357 1.1030827382623514 -0.50822197840938355 -0.37592566443770981 0.28133319415707453 1.1912118746994624 -0.47775582462382582 -0.28596374724475238 0.24205808118166819 0.62669812185740681 0.66043449314043112 0.29780468245554442 -0.42985720593655913 0.103983729186052 -0.02116786953842742;-0.5243514353825921 -0.6932716500028695 0.71897336070301165 -1.7234686463442472 0.029221026857411431 -0.23503904685139337 0.67768701739909598 0.65640071534109778 0.26565417113044348 -1.2187287012230756 0.73724823960143748 -0.18750484520378 0.39720207230750482 0.42716674762830875 0.080063456797321353 -0.8313463471296868 -1.417116841681898 0.19475087164988031 0.681824008330154 0.63302844816476855;0.16807056248967583 1.9638401625067072 -0.83732384083400935 1.2347851157050358 -0.30763351527556321 1.1798742074025388 -0.35297377510618827 -0.15718739588383251 0.29603207620575095 -1.4489280426089546 -0.48345544701333271 -1.6686824668930824 0.025772163313603151 0.53551715318848092 0.16641001159019586 0.0060161758826761599 -0.61230728706317683 0.94601483861975277 -0.77966296331626805 -0.36350315122890864;0.073337222577173067 0.53714207088177313 0.71369029258593308 0.64208790267004534 0.52044764114736086 -0.0012713317137380284 -0.70004009688046542 -0.37434711794945502 1.1313879749206206 -1.4196378672589278 -1.3526380601497019 0.40146527653967862 -0.89171015261881015 0.22868282890165506 0.72199073223066146 -0.87737997685844804 1.3211432341442413 -0.47088817774026226 -2.0631268227523227 1.7394278642445911;0.28413842533950184 -1.4695028328131217 0.9727374640931532 -0.33030532043792266 -0.26338270844643458 0.21395442444906901 -0.484970155254284 -1.3438460366292231 -0.8437529414661783 0.53202007859433409 -1.4149723149549696 -0.15268235584928988 0.90925984626688139 -0.61745844099095615 0.53451179020173833 0.29411969423343759 -0.52138657465020444 -0.35836519021560898 1.1566969401724785 -1.5917632735618163;-0.55875096869021279 0.36897174223396589 -1.145786068062729 -0.0012679367737112989 0.73236301871670961 0.53289349830839561 -0.48174875669534101 0.23896397727137336 0.7487340862587557 -0.61384609912877353 0.51975194535363312 -0.37464919614838627 0.42769398688393223 -0.93235220393230711 -1.8743553217014972 -2.2627101908103096 0.49106288604596338 0.29806532093016092 0.41417148933635184 -0.76891649920314564;0.31741792113656986 -0.4306177282697668 -0.11285557110209393 0.32263869668975048 0.38926813545372713 0.34956724217735125 -0.43094100962984394 0.44475069571323944 -0.64669855123803643 0.23894454784968555 0.014086755136468997 1.1270469347484005 -0.1994887359063244 0.33128408561076517 -0.99816388035199743 -0.10296037881032812 -0.63333465597514838 0.46666846018864272 -0.46484011805484043 -0.64087389394774086;-1.0560090100204138 0.61915592414856613 0.10008805374260586 0.37220264947798204 -0.16636474923523892 -0.89835132361041703 0.53730297060627374 -0.023881942370485937 0.87871437683921383 -0.40890476416034455 -0.079237564737680288 0.036981315737165128 -0.55428071370239484 -0.94579506849238315 1.1313295787865376 0.6616833906713272 -0.47836866793318306 -2.2981768023952607 0.1817815417859911 0.69139565474637177;0.33490033014275533 -0.022664900865405908 0.06084042850192501 -1.4955840360293677 0.0049773127929318046 -0.44978990522631929 0.99415004511924077 -0.5144096104175413 1.3482442480387378 0.35170851950149185 0.079843096426516186 -1.5572541425202413 0.11934540590893107 0.047318305306741748 0.045975066955388361 0.21155084641689115 1.6060034182762495 -1.0143157164939813 -0.01590250974728083 0.42397346337694813;-0.59359826156753215 1.0077081683588458 -0.7046029516729384 -0.10709625041388998 -0.41400526024090512 -0.69099903117067507 1.3209462248614994 -0.1286301854381238 -0.28504816719677339 1.4293468901677937 0.090785571828626344 -1.6259171991562584 -0.61034709342471072 -0.6736904106028222 0.17548399354856475 -1.7848679490963579 -0.18764886558478711 0.33591728352850969 -1.2254600393491513 -2.0180640888221038];

% Layer 3
b3 = -0.31662638018486511;
LW3_2 = [1.0404490700355935 0.28599580500477129 -0.10395783736822981 0.0045118224710334054 2.6880171780623399 -0.27864414736790061 0.014642452512846167 0.4521626892786561 -0.028643011579211154 0.13169591531216462 0.080097242874462557 0.1280097226191021 1.1542539187506413 -0.013856526863968405 0.049708439782208604 0.05975089017569097 0.69623912918050501 0.30330313137785492 0.19658410283650427 -0.143507924884135];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
