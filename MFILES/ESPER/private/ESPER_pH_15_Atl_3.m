function [Y,Xf,Af] = ESPER_pH_15_Atl_3(X,~,~)
%ESPER_PH_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8893619961070653446;2.0591526553614212247;-2.1376950905209644027;-1.4218057511049542185;1.6315925225765990358;-0.64433161531843319292;1.6386983288012630933;-1.3441834608414473529;0.27015480598696123282;-0.18151199215977992241;0.034353425756476173303;-0.439127513209715159;-0.23823253272579383855;0.59832826320803733644;-1.1188890335495607076;1.6282329579054757307;0.61937051884837635018;1.0574707751105429931;-1.3557554446378736746;0.83247185640275633833;-2.5908358324383184979;2.2837182832030853419;2.5129447344765236672;2.4761433033916944169;2.4364558447442403732];
IW1_1 = [1.0132387690776656353 0.49067250037774545746 -0.53425232924879728635 -0.69332098878925874086 2.7144217601126108264 1.2554920377374552132;-0.93324218730875507788 -0.44495245060216392918 0.58837544257938079184 -1.6784241066692819899 1.206527399387729238 -0.91533938670206693722;1.2111299096026044708 -0.26844725456074308712 -1.8191084746528334293 -1.2725097672081218114 -1.1261525141814920925 0.56052933166703866608;-0.044919612686634753651 -1.494329200494497023 0.81511696205145500738 0.027273819121514782104 -0.29622283072593746933 0.46795742507508247821;-0.48224258915626855293 0.29777167963356698799 0.68427275920552532718 -1.2123855595370960359 -0.42886587929107844452 -0.39599871414376441869;0.44199981391096643257 0.024965133081260724307 1.4987196025896052376 0.80115771841406258069 2.0423039996849308153 1.7520560796665243242;-0.25359905621306189083 1.9504730151699249951 0.50461000181899429151 -1.5638246055841218407 -2.1480846036858731729 -0.71014444572433133018;0.61033568214304900756 0.5733607944443207538 1.8046134591598912422 -0.98386214270480698563 0.42037315326435387153 -1.2012932828112483641;1.2494902920166808258 -0.29370086628110958493 -1.917576859612631246 0.64008695522142866619 2.2044650946674018144 1.6074687709861454898;1.3517416265795096919 0.57493726897206198778 2.0798872767197864597 -1.2162563699408905915 -3.9187839847738357157 -1.5803624549368229246;0.99486742487119117495 0.52266316108249588623 -0.91336134721375716872 0.645470884818766244 -0.17990878040250032899 0.68449010444427171862;-0.2127165148330856792 1.7152842626951649851 0.037330167713738163227 -0.79437535558089333865 1.0497652213940973365 -0.70669481127909505869;-1.3754753712462426396 0.24381631327669495146 -0.48008173618390231896 -0.47779358788144704606 1.4227378150063778595 -0.79391323084676213018;-0.68615637182546895811 -1.270533837096826435 -0.067281196050943181675 0.28299781661875655914 -1.2333203371245597957 -1.1271453661414572167;1.1902502651790807242 0.15007325485797820552 1.3721328363005858009 -0.13033617882455247883 1.0943863052248994361 -0.64481930175524204696;0.3709997845014019191 -1.87087834172531009 0.77544233227439518519 1.3553109589033971449 -1.1564874233848008167 0.03358520277566574147;0.40725310637228717692 1.3186025790245545775 0.25836264334419034583 -0.60637540356861208135 -1.4403450801040984519 0.15451113942584215888;1.289861979584162377 1.0280540300222371641 1.0971104589784090866 -0.81809127854138308233 1.1986607615702662422 1.9735500170313979851;-1.6298768114752921754 1.1759746192395124087 0.38027428239960353595 0.2805564040523231828 -0.765868684016112522 1.4527794276710324084;1.4823127588832076817 0.50900074612810919383 0.99708989094725020141 -1.3369767346981586975 0.20172455850446691095 -1.0761524268911308866;-0.70991242862468983965 0.93536960651142764256 3.5263788389134593793 0.38315489439071687139 1.3213228218784371926 -0.079185960113770006985;1.7694582652482744312 -0.024979789606394461193 -0.70462337552098641691 1.0853800817266749945 -1.4004108298413056044 0.37063534466577380266;0.21680173957671408647 0.49944288357671251521 -2.078174751810934584 -0.94098448692876457411 -1.5884212825262755686 -0.048025534502482057631;0.66231965189582520104 0.59446849953480807027 0.66231937831606435552 0.18605565040719418413 2.0780703641112396873 -1.7992833384511459638;0.60766361653975331514 -1.9852457420228559748 -1.7313817641845825612 -1.3853593331842850578 -0.74755943292471005446 -2.228458785890688354];

% Layer 2
b2 = [-1.8051575681845284382;-1.666873158130979915;0.71526720111070252184;1.345482935726550533;0.70237801883820005777;-0.00584634811791946013;0.26355266430208384998;0.59974321335717595272;-0.54923962463573217097;-0.19262545694525998186;0.15708161334102699325;0.3173858461774408668;-1.4177286352202662645;1.2020558416494884213;1.8879192787963199329];
LW2_1 = [-1.0260834877733482351 0.15844611990676982227 0.66718736633087916132 -0.031605917866365448865 0.02692258770757855954 -0.24629254617284032647 -0.28519875957295076629 -0.86716296207091725368 -0.87631513117555481784 0.3737022781155373008 0.13459472350470300106 0.0020905945048274310327 0.57200954587320296252 -0.43146560852869786373 0.31382151104224353944 1.2476122932416857658 1.7218440831246331069 0.37986919542261227134 -0.40151372424642117753 0.2173075400893138831 -1.0050750583459229226 -0.40813729526168390782 0.35950336810336275262 0.017822345936587550425 0.46356627258688765103;0.3070607826398848994 -0.2510128014827915921 -0.77739704907549322943 0.95255369149411373009 -0.43208679750406664422 -0.10156107934492644707 0.64442946986147664479 0.051789030250820378143 -0.9305972155104593746 0.88887210614692757638 0.97482054260286910008 -0.39666866509083037462 -1.8644108516621777927 0.051150771033213734973 0.70627787980130452006 0.40873969021567946314 -1.2947247083448836236 -0.19645797504012280088 -0.2008207545033057484 0.38607499301994002705 1.4774072695057713922 0.47710904825191324807 0.57128063827516506468 0.0073073298452665837177 0.5387470658956611258;0.085359034455561116905 -0.19274229573667120419 -0.031109391950289326523 0.54166732322225752405 0.31761070734564600393 -0.52275061124599275786 -0.56059361076060865159 0.60004453842047078549 -0.34486964422574784006 -0.20454368520927848629 -0.01908862457058392581 1.5896956083214661692 0.24095331739490927214 0.16263017864141451896 -0.27628725210284932334 0.70275466526149488189 -0.78839044951048431464 0.1883514133031810589 -1.4208434340868543178 0.33452117027979172414 -0.90645270624875995402 -0.93744283417088825061 -0.49860255451089957601 0.4335137795952871409 -0.39216082310081123996;0.39140571955992464748 0.55448130711142096239 0.053038886465355511435 -0.85864078915940744707 0.52309238206638730695 -0.23505285833060299283 0.023792619142523192127 -0.35687942109740189434 -0.44656865459339833979 0.18116611860692327651 -0.51109960073887983345 0.71574399173126879159 -0.94897496797410907377 0.51866767393097201744 -0.61612511733612296272 -0.33565910978079999127 1.0196700206497879559 -0.69448106895028682839 0.28242818203973696356 0.12334481909743685857 -0.89004594268989234429 -0.14367985695194823714 -0.84366818263384812937 0.1112333546824656183 -0.043482634305853598566;-0.62680724255695163816 0.47912671464984690761 0.40325878448736335313 -0.20002403141958602362 0.34464709118299069468 -0.090289403843465204647 0.078921534650194927196 0.60120139510278713946 -0.23165799978760692746 -0.23736102979771417365 -0.27814088939407866086 -0.047957143727485135321 0.15982215459480186848 -0.31254147636907003704 -0.40488065613106871687 0.0405853967132527374 0.52609769933706274081 0.48262188043219611533 0.2920782845980856024 0.33500965633076063011 0.51451351515214127641 0.20726536655715019353 0.146686069267357444 0.186129588424883613 -0.3266556428416302893;-0.5449895066717659331 -0.45705409872621077794 0.087640197449319306999 1.5368377904980932147 -0.11164514741383115004 -0.024371618266318253315 0.2896182170486651386 -0.053274629074080565028 0.36227026490427005623 0.022163482888484218464 0.43816643075981659416 -0.23116765000004491082 0.0043444632805293573533 -0.55316070265832939512 -0.12386335648881244276 -0.022186720200251055374 0.26143266990963925922 0.61324570098193076362 -0.26366792111962944478 -0.10209332917649194261 -0.15147200068195115774 -0.074012920504002294164 0.55939276343298438565 -0.5717800093366577352 0.18902839184731390354;-0.33487483114405275364 -0.14437323286826353463 -0.40039927983985162951 0.19233988320038539199 -0.17556558835749358494 0.17111502764594690995 -0.40072158015742570525 -0.12552358259193305279 -0.92168770851091430529 0.12453166771676048297 -0.13727208456631573297 -0.20610466447505543242 0.27800716009475739954 -0.73035470706900729176 0.73637823585698347628 -0.54897317445015092474 -0.26418497784303401898 0.59733247775911857413 -0.039494196693776580098 0.60790404761263516775 0.12657389018794207303 0.26489642556199938239 -0.073594781094461714233 0.47990343024385495596 0.49782916097139995326;-0.15966815626883346102 0.048315242571443053898 0.19475715489905229272 0.46060417249396529149 0.50415321751477104595 -0.2516062624950423654 0.49194751165549838179 0.30239923577379640429 0.73801475254748549748 0.098628726429093094286 -0.10885718504014690877 0.35888205692788027745 -0.49172486074268906275 0.083431408188883768307 0.2790030444721155467 -0.11754383093995585119 0.176928056038472864 -0.38255288869095510629 0.43184391257720056156 -0.10327530400428350243 0.55369232700933246338 -0.39086914167901731787 -0.78887006292806460817 -0.63182973254006991048 0.74304689687208469451;0.19032416477310190595 -0.25775714471543570427 -0.22388996196025026664 0.84004971392592886481 0.11942119509674932465 0.50072562355934924216 0.15588570074987789793 0.28163146131383276494 1.1713813371244508055 0.2696475007472756702 -0.14874588226839127736 -1.1969969260960775514 -0.67981955750123035376 0.19153850987344001044 -0.30122794160291010979 -1.3852910649942513643 0.34950524464945154079 0.15647983559318628943 -1.0350395728502088666 -0.10340660594069520095 0.92029885218638929345 -0.2542212218042557148 0.16078316922005056466 -0.74825261429825884463 0.76584961133032325442;0.9476514681687998598 0.36410555557263907245 0.0058771566362339558443 -1.1286120960448693396 0.46796362351311693306 0.14690030275197049625 0.21065273863907513219 -0.15677585808333172057 1.5718670676707153788 0.64685813521848256613 -0.65650395600121258521 -0.11794659928654514791 0.24096308581547401517 1.1479939463778110476 -0.031641109274800446882 0.01809904759628803983 1.7798027114198808896 -0.77026468423222660409 0.42654048859754567502 0.31189052653583426711 0.042995006097865690053 -0.92823295061125232763 -0.99335734341682180304 0.19616582088762846148 0.37672741146232668896;0.045443530530049888738 0.58829997723437532642 -0.02788577444673912345 -0.30888185625799030598 -0.19132947047289300402 -0.50013357592984231115 -0.54461289812032065427 -0.31970511544358015676 0.037071747722694170513 0.47574754666362401023 0.29438956947335565006 -0.23826189719087961794 0.57918629890233996882 0.044019080403614060937 0.97123299927520856389 -0.13988000902972314021 -0.33710805599790494291 -0.62678003920996960829 -0.11585964612237713289 0.092418149787178119348 0.36441818909630102619 -0.50124153625429279657 -0.29940631551056923199 -0.026641075267270799415 0.17392380154663744651;-0.32221775615064496279 -0.40158693849470250559 1.0103292564729895453 -1.2812202246081945134 -0.65106418476674787765 0.51261373101916585249 -0.33747827178904188372 -0.096357243798671568524 -0.81624642756272869359 -0.26605555605297764865 -1.232171819147165559 0.12280885147156155035 -1.0971776623042976961 -0.057706215296998514264 -0.99740453301714959711 0.37229949970893472244 0.33675646036751571977 0.16280139455791078906 0.031998020412027171344 0.12908457688703711685 -0.73256863153715068293 0.37076758336542736672 0.525112162283750461 -0.32018597527859576912 0.21858376105299456849;0.14243878030413270608 -0.68263163613331978574 -0.34297081605241591662 0.60124542244260248403 -0.10379899502823752844 0.41745458048416284047 -0.22458925306911026176 -0.11167354005733581834 0.097166307417083735976 -0.51864787142379986662 -0.14800935888067726087 0.80549227621050600856 0.28102455155897509975 0.059901109486398970705 0.007477247030916699122 -0.542854111569003428 0.097710600854493359635 0.2372379596721692907 -0.35353340744854117039 -0.1686409496476485026 -0.13753609356785861939 -0.38918707432056809381 -0.14988151507952807151 0.027160509447527458882 0.519880781896896349;0.61440975412354981167 -0.14946466546274578269 -0.21177893509957901319 -0.078950116665606293043 0.30440686775273578801 -0.77166341739144794776 -1.0510198398871768433 -0.18227744234526971345 -0.68052325956274106744 0.13285540622897151763 0.54784172467533542861 0.88021147530525267744 -0.3861246530045744918 0.53548078300166579435 0.29945730423354111061 -0.57076571704636536175 -0.5578395736591896803 -1.0215681938037648457 0.54506709053070401261 -0.56692410844715068752 1.03124378988746912 0.62370559664510916154 0.42153619248959994792 -0.51361883851065381901 0.97049315492610355172;0.69372411147466861436 0.54219284202180062504 0.21932870621137612321 0.1107666243917471427 0.19847354131022820756 -0.59210007677877563026 0.27539739676619612307 -0.68251231296910319646 -0.60793042797048135739 0.11083763760326592607 0.24816664801907770133 -0.48819115565290532865 -0.26105998187855744552 0.2381942785747732938 -0.21669515120594290414 1.0420077232054461014 1.9610741187103590821 0.37532697403140313774 -0.23150827837418760935 0.29646310006894605049 -0.59368032228410605455 1.5780169102085275235 0.06442123286245293734 0.71517106806924390927 -0.69526317704467621716];

% Layer 3
b3 = -0.44729560163962700514;
LW3_2 = [1.1802878282135540466 0.50580595083774737564 1.4689206176754463495 -0.66927114641680651719 -0.62461937757393592996 -1.8599071031855696212 0.50827202934093895781 -1.9537657080219685835 1.1017103060556676652 0.76420718786061003769 -1.4878428016894746921 -1.1381419114485356037 -1.8883863432171394958 0.80931960232055499826 -2.2157406043400995621];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
