function [Y,Xf,Af] = ESPER_talk_14_Atl_2(X,~,~)
%ESPER_TALK_14_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0174744861001446;-4.4392528857820137;-1.1476614880993536;0.49722743555493892;-4.6489503039567905;-1.6418878183352337;0.34246127776709623;0.66956844588357012;-0.46821185113062835;-0.53888352106280191;-0.32299735479663533;-0.11814577842951643;0.91961385778751348;-1.1410763965169208;0.97910426457004762;0.0016353264527673933;-0.18112931217361836;2.4911315471171784;1.0775568933627333;-3.9453035470130082];
IW1_1 = [1.6371340848067373 2.2255097624600713 -0.0956315806684397 -1.7408937952316148 -1.8304882289493418 -0.33146647736464674;1.1957423968647023 -2.2989123657963901 -0.79799684963385153 -0.018837442321599188 3.7281555758178775 0.39360732406020282;0.47655309344296376 2.122598036703284 -1.5143444641739912 -2.0234341427860594 0.23255952509333896 -0.60132716109851614;-1.8171032577657285 -0.81818190000806135 -0.35710142003733542 0.30200641334878942 0.32311600372877036 -0.37521893705990211;0.73620246414383317 -0.18884504166109034 0.79949751186253992 0.50329407979239926 5.2483629214478844 0.11535564505593225;0.80465560061682273 -0.34348464563772324 2.2863508785310818 0.76844505232128468 0.42697619500129791 0.13470637004940239;-0.72283834496122357 0.49971211437516733 0.30884908090019686 -1.3339604053048286 -0.31436952340430818 -0.67503525904226103;-1.2849417364557485 1.3330181979745557 -0.64934976176731085 -0.86417384000196207 1.1959391389659697 -0.079646447512793872;0.40347486859145437 0.76169160666456448 1.3584682938047723 1.8932791962649169 3.0455356475349213 0.95703441052267402;0.95986341842587741 -0.35580154878125109 2.6249647749449312 0.87096717361816989 -1.4048966818320576 -0.025294315072881313;-0.47528880142603724 0.28001788419828394 0.88577862963009513 0.38998105170868835 2.279782139901636 -0.20447379172868618;-1.6721133885108637 -0.63805980058651934 -2.7923728534674406 -0.8552879536102781 -0.37058264161671284 0.12843875725192505;0.1958992325629432 0.83986918005258826 4.0798653736732629 0.67341105259674383 -3.814288614766475 0.11917485961934157;-0.079680862975334388 -0.47742726646200639 -0.32997744504441157 1.685021899712468 -0.11630821182413 1.247194692993457;1.4449138037162517 -1.0478745734260149 3.3261278334118041 1.3045871017159749 -1.0131457978474925 0.36770612193272467;-2.369963172337104 1.8732258410802971 3.6527648183075114 -0.51868871682593687 -1.7434393591438664 -0.29733869361229387;-1.7644987664377376 0.85669722742194199 1.3651226949132884 -0.74134580918127657 -1.7730847979159019 -0.10690952831941972;1.6511494919466347 -0.32291517301902778 0.83126593544157268 -1.0919552845161726 0.8305585552132696 -0.83825982718696046;0.63313833392670549 -0.81352755234671481 -0.856231824421682 0.57369125744224569 -0.13381343455320063 -0.35813468111639296;-0.063391825013173142 0.79102482962026943 2.7206935353372566 -1.6551170496120122 0.78155299677279344 1.7199907443141169];

% Layer 2
b2 = [-1.6956513849235488;-2.6982887929001258;1.3561291264541906;-0.89280542179587707;0.45335801429547773;1.1687644173804048;1.5608764870974885;-1.153173961177385;-0.80371931431373544;1.0420660133447091;0.61608516683110226;0.79184830364101799;-0.050046027906183219;0.8415448497692507;-1.1712467242158975;1.7280639343801059;1.8143220515704637;1.0949085633997939;-1.8017947335960176;1.0591471530362655];
LW2_1 = [0.074559949261397043 0.79503464495390774 0.017765745175324487 -0.25828857570688296 -0.88067632939233798 0.96130624188996283 -0.35923706708646819 0.18768890478432868 -1.3282169204001932 -0.58092656673224308 -1.8795251009747054 -0.47830882985613316 -0.28720080514703289 0.57692917090205953 -0.26437645661077652 -0.063001321145753894 0.18193833219258096 -0.41969678190459392 -0.51607369639033762 0.35655212357921356;2.3573398393558187 -1.2639971187834083 -0.4911307106268733 0.5294562416819758 0.47912972284451499 1.5143720110977246 0.46440946864279375 -0.54488830714218073 -0.045051352913193322 -0.15317656808449293 -1.7424652674123238 -0.77016173428881585 -1.7895829050392569 -0.17125380048627953 4.0977411866664326 -1.7741952342982961 -0.79541540461664184 -1.5978898303805165 -2.1829783041195889 -0.31928943825669209;-0.26683972044476389 -1.2565267899429291 -0.21510261927950475 0.25577121372840383 -0.38729239680912203 0.30002647664419596 -0.054627464673149669 0.25625750172155048 0.60942284351044151 -0.59098674965019171 -1.4695095458171061 0.46191898833993467 -0.15231213306674646 1.0245600111125381 0.55449277830911703 -0.58416143833546008 1.0202028087948625 0.18843012277952115 1.2473592380365872 0.54918301405175884;-0.054219905308848904 -0.43929232607352353 -0.26347181833221694 0.26408723293536379 -0.055577361662203187 -0.96281803444129865 0.15849089640051048 0.57435350536128915 0.29378246711577116 2.3054957204772175 -0.66336682194436203 0.2967605375912945 -1.6577141383651297 0.086114340472881218 0.11054839449716358 -0.33986844605448446 -0.03359849640288734 0.31018405982393599 -0.20967350913538918 0.77922499618836816;-0.3861393819819316 -0.77184035154818154 0.60940544792306972 0.22973723799363727 0.8498929738778902 2.114383848233917 -1.0589048579872284 1.0047308399348793 -0.29831031444353173 -2.2762782946780882 1.1328002504929502 0.78160254685770414 -0.10098400656475061 0.51989023178792015 0.71524199990464388 0.38523252126012636 1.0813543753726673 1.2627163362253238 0.93096575849475505 0.44947612867743519;-0.81996686081385406 0.6440172773151791 -0.16770190839748719 -0.74846837316469017 0.33273567527066861 0.70178056405218325 0.16377136053365923 -0.19895835321908714 0.46846967936953154 0.76069549835181183 -0.59987463469921265 0.36384063713397485 -1.7598311371654209 -0.10662029074237957 0.75428950130121786 0.75734481771218243 1.4204629394998074 1.1522520427219145 -0.31889026407765125 -0.03513231532316094;-0.75283011465290095 0.10994675061238512 -0.34347171332084042 -0.25195148596395028 -0.82615322471306185 0.27194283798369673 -0.14877067881121103 -0.32927227704030249 -0.075448764472799135 0.48319601860318623 -0.0065756229854657556 -0.11881972944537243 1.2485165602352366 -0.21950197750891634 -0.33208919873455817 2.9201117609843941 -0.60446249001197305 0.9928210595225796 -0.11930268451247404 -0.7093707895306558;-0.37863650182283209 -0.58425333630304388 0.00040925252384438164 0.46456112915153791 0.53538196578451358 -0.9107834046033626 -0.6208570654592217 0.10516875714043555 -0.10897087783521082 0.93955154086885739 2.1119565815829611 -2.3193570694310632 0.1964302175519741 0.098807088683201441 0.84057066572084838 0.79550053415655431 0.74861102425330661 -1.1756852430743159 -1.995863653284329 0.33448650060778035;0.016180986957120523 -0.93524105255205681 -0.30830194736979616 0.43836547563765077 1.3671796305134989 -0.30179228067368524 -0.45227927124531037 1.1285108433106159 -0.23257323416794998 -0.80366342299648752 1.1113419800929043 -0.65396567596720645 1.0969284529315306 0.49582838667542639 -0.14600506014481318 0.55811933140917247 0.3118359886174083 0.16742190494408957 1.0809451638921581 0.89350252587113321;0.55446218568587191 1.4048390664373474 -1.5337784593895838 -0.42464152536489319 0.62999907029540547 0.97059515446502176 0.6937406733223247 1.3782241266241506 2.2507658022357679 -1.5631520892371107 -1.2129339861153878 -2.3573747954381492 -0.36634175854014728 -1.1129932444756407 -0.84182105337200097 -0.61057565248100076 0.78614962098240782 1.4843556410884424 -0.66496867167738094 -2.2928599938761547;-1.1821680303096425 1.0038040261873578 -0.086834964403284282 0.50087947325341853 0.18191288594671476 1.2229405947479222 0.37359325468147653 0.21227345661587807 -0.27659824544263489 -0.25311952202315913 1.043246431276629 -0.80440226541591464 -0.45279201983954626 0.5201789248189379 0.70965906488695996 1.4965030246820643 0.72126836052077858 0.0034572512616180442 -0.28600805780836469 0.14261638973511973;0.41996827886131155 0.50050220314064686 0.39251508428524512 0.56984958383958828 0.73162310134159081 -0.64574239021724 -0.56443517838403068 1.4206533205749221 -0.18024678864605059 -0.81930490625452801 0.28517056884026198 0.769691552040497 -0.32054264048020281 -0.67183877732870578 0.37414632298292094 -0.14261900200298736 -0.60055746050120706 0.97592006999465952 0.59985471440863958 -0.6740306843286028;0.47058895893838071 0.01225896087437185 0.21880037778064976 0.72194901866535699 1.274323817509643 0.34747380930505972 0.3545824742948786 1.1758010079840631 1.409913804290106 0.27374003036413375 0.39351541705350257 0.30442300900363767 0.045755835181805912 0.89823466610077951 0.75463198480849825 0.28092183021872341 -0.02145292617314783 -0.57116064396026156 0.20612710536518711 -0.20559556291435041;0.24010552890278034 -0.2596923888785248 0.33178393653323085 0.6466946627960537 -0.23981316022500257 0.17405594414866063 0.26524150477556896 -0.51536578761080243 -0.55583841422309366 -0.80105009504767599 0.5096382586516004 -0.057641422381825701 0.040551511656351714 -0.89359871006045721 -0.12527539266785495 -1.4069581838155509 0.47602981366373376 0.49556086683952077 -0.27750111552652745 -0.31275813773443872;0.62521386857086436 -0.022284963102173847 0.4423299579669967 0.2834768727271027 0.72903373131740801 -0.20037486253624578 0.0042529918341650055 0.32629013257584788 0.056158586610448188 -0.62989495728621292 0.23989645077362015 0.053388033505506936 -0.23216342588927083 0.34523260814723256 0.13360701254865387 -1.3562165482775383 -1.0429832201816733 -0.36734759955254948 -0.31539878916140629 0.27071495146765245;0.015335726589203152 0.42893328631315142 -0.14627674087566783 -0.48751542995843383 0.47052466175001345 1.6276298869199799 -0.35940568943834139 -0.1896194471021341 -0.046225634761916462 -2.2519945551034879 0.43037112794735999 0.032696510329663191 0.3890146504193242 -0.54551497629465151 0.2113425104731449 0.20283085434794426 0.8496684141962636 0.58887334424460269 -0.81552610535897219 0.49933307374563979;-0.16740644023576393 0.040642677448772237 -0.23570012060083298 -0.0590053611507333 -0.19922265515423593 0.97289471343827227 -0.27187390007409429 0.53956667568888328 0.48855219635573977 -0.48203831413351489 -0.66156332983168109 -0.056738646330901102 -0.19056619658939844 -0.040225855924005349 -0.65456952645053834 0.24145505868462175 0.46720794972595137 0.65091696399097276 0.2189490531310003 1.1155722076537327;-0.098945692954402462 -0.16975570361102091 0.055129999902578046 -0.33018264388063823 0.49056109087388555 -1.0132672744255549 0.5228843533691887 -0.96313756613387569 -0.52644148793763079 0.96952794027229283 -0.61711689311277862 -0.1935850735097446 -0.91727263087966082 -0.59064264034444924 0.53863599503017956 -0.77050324072845155 -0.43443268431749321 -0.44630248895988073 -2.2996776376697166 -0.25264242831470918;0.14981047422517724 1.3527278328630761 -0.18434698191814886 -0.54232456085154468 -0.058692484846509241 0.12453083538448437 -0.24004800237774754 -0.39609254673064709 0.11505738895884177 0.69167677126396143 -0.57544270825949895 -0.3228179868833187 0.073964486051265058 0.67097340238682424 -0.44219632607059967 -0.38697563369566401 0.073141463424562722 -0.3109155776727025 -0.61563567088882387 0.71650121643615183;0.49431883656352005 -0.91458905054616346 0.32262208071633919 0.45100125300155947 -1.7346879270124935 0.086700482478337212 0.26388309512809804 -1.9177482924157128 -0.071031617269617695 0.45613992553379018 -0.18611459940899733 0.51846512608056139 0.80121397196225319 -0.025107233457191441 -0.3939871150528394 -0.56188889333019276 1.108086692523377 -0.2881780866196107 0.48869881007545674 -0.27436390686161982];

% Layer 3
b3 = -0.5469670150346384;
LW3_2 = [-0.039553941007225688 0.41166451774719537 -0.11238604996184677 -0.35937747775403606 0.13005178503933251 0.10243167972165614 -0.68106102437384031 -0.33441057101543453 0.15657036140932282 2.1825620121945053 0.050483498405727488 -0.10249806407045216 -0.019468823298318831 0.17914630064956472 -0.68180537083242643 -0.31241943523044469 0.23855974361455265 -0.10901951070993031 1.1854105251738429 -0.086249990661563899];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
