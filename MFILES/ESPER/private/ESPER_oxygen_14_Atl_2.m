function [Y,Xf,Af] = ESPER_oxygen_14_Atl_2(X,~,~)
%ESPER_OXYGEN_14_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.8832118922987750587;2.7404639656573954731;-3.3736819909436102094;-1.4502477255694947722;1.9995623603865890772;-1.503503556975458233;-2.8430312884600459356;-6.6523447795911136993;1.5591954148276498948;0.37567401308818954009;2.6925396910980459175;0.039945878796376246833;-3.07785089379036636;-2.9031843480106789279;-1.7456224055100488801;0.24819874133391181537;1.1061588867858183072;3.6421567796232992009;-0.15225055227895781251;-10.516615503942441379];
IW1_1 = [-2.0354935281033950112 -2.3034919765621424403 -0.87121912563025094567 -0.0023855736689781404519 1.9603642211914256155 2.2894576312158849696;-1.7547360369942481828 1.7937046243378633736 -2.0084552849559225152 1.0886246136565043141 3.1764646252673349736 1.4497824446599907322;2.017869925771508921 1.9954066279880557921 0.87266138563184336707 -0.099159823648211714575 -1.1990034805036464682 -2.4545534457295912212;0.70991718791305946645 -2.0299745405660605257 -1.6344215239559019004 -0.70107255460779849265 -2.6951686725588812621 -0.312287130976684979;-0.6298054775504497993 -0.22355934371682009698 -1.1242277219975098657 -0.8028623338138729526 -2.0755052181373860876 1.2956672721081992083;1.1879610964847135968 0.17312174431558494114 0.69705960211524975456 -0.45602153889633484374 -0.71041476752331589317 2.4075217981946130941;0.71291695013152867055 -0.098955475363363479269 0.38021289183811246559 1.2389613572553190846 4.6827735255315356966 1.803566015874752626;-1.3445537707572925434 0.69263498152675362363 2.6651141718088378063 -1.5860482793098351628 7.5912215877116153706 1.7883081727890899337;0.66491696011687795309 4.1392756887946768884 4.5177624371153477512 0.040016654510597923777 -0.66181133983363493734 -0.925381158661388592;-1.1498649761812131942 -1.0358293290268034692 -1.7319877895867761275 -0.30539325491194441176 -1.3499771182774034095 -0.48221467192168315785;0.78368781554010757961 -0.21727254665207387796 0.45651108514664079374 1.3495998916607552243 -3.5887080784739104899 1.4406514282815727768;-0.31152757017183763111 0.33357879214422148095 -0.3921264425497188455 -0.44859431524040488393 -1.0655134101035659278 0.35622591434235006957;3.0387114367716994145 -2.8730219075263967454 -2.0934195541079603231 -4.064945581557569021 -4.0991024090285801407 0.12208640393524995693;0.14985012016630797071 0.37809488836790994259 -0.53191637591219420589 -5.331431449988800253 -3.8612282671327426975 -1.0171808961132640103;-2.978671097985117644 0.40610428028501976971 5.4504816396528088518 -2.0981007648661309517 -1.7626615990571679049 0.41612658290616932888;0.23601932505581299515 2.9325310956088137537 2.2270668718732720137 0.45982380055723509615 2.0325708231836712159 0.73424820625398656837;0.13846535553582253741 1.0380550915979309679 0.48404907381716916204 2.3647650272553191186 1.6762215206934496514 -1.3085570300116897702;0.45424244968360594221 0.84680276299369927617 0.69494567069271817594 2.4023539851658219924 -2.2028500899169465299 -1.0669477949654102567;-0.048472212187169988473 -0.59430854433113167179 -0.067671301071699982432 0.59400142842344716421 -3.9758911442847648665 -2.4934673160485454346;-4.7809130452477406337 -0.35926157705694578004 0.073690967707161408873 1.9516227378311021834 12.291108090516653206 3.2896910670295045342];

% Layer 2
b2 = [-2.1109123377354213069;0.47280841803565942794;-4.6854088438988599208;-4.5707622704435566519;-22.495898429887130732;-0.033565590619270814499;7.5216145332921700017;-1.5122421179626956977;-1.0438115243100949403;-2.0505235666586441035;6.064490139278675862;-0.28586259412266423752;-3.4476586360830876465;-2.1631794198768430348;1.1296610456190949723;-2.2716784190383068065;0.10433585288230266819;8.6476668444339761521;-0.81964018946553829359;2.5419247479872169038];
LW2_1 = [-1.6778502888332309517 -2.0318230994339292472 -1.156667671193135627 -3.9922067745066942557 0.96851340238047023412 -0.24153661771245993339 -1.0763892403924300023 2.3488055507794647347 2.5169871291007264169 2.5467989446978567258 2.9567912652479693136 1.9423284852615354534 0.69200265303832075858 -1.1202642457159806 -0.038512218274096239601 -0.91135391603870974375 5.7530553528108798744 -4.1680240419493310711 -0.3816367075990975688 -0.42086658254921832656;-0.034982655463173133181 0.61532709085148096229 0.00058351635144806082711 -1.7861034695938575734 0.053400577118724396053 -1.9792548176619644273 -4.0634643314644485201 -1.0988777862838601251 -1.1000736087558617982 1.2635858684264178464 4.6868621492224189495 0.39950614048365357123 1.3167602984632198471 -0.78489845885199294173 1.7620517691202488564 2.1135143434684966479 -0.27933290969734758669 -0.18535716131918100746 2.7841277768342536092 -0.037643541545170314255;3.8828477927478441956 0.5507014046661117268 5.3124482161670245617 -0.099178792000426174713 1.0143462925997486224 0.63402101141830558007 -3.0195952688988021428 -1.4328893186228879308 -2.1914598012590271736 -0.022874471195670875723 2.8213655976283362747 0.75181100127808730971 -0.44095670635871825338 0.62495696587871618632 -0.81476665200417808244 0.3658668381682612103 -1.0268804840539123013 0.14685195111512536204 -1.5457071582830896883 -0.057235881064618403247;0.25956517460344880055 1.4000643508193852949 -1.5163226604685959842 1.3113618543515010995 1.9443584933281841121 -0.85690739837955898217 0.97593944265221843626 0.19465711065748936281 2.8934454515498018168 -1.2167316381743407128 0.89203594890905268944 0.016325357690766591906 -0.59835641098063141463 -0.65146691965856162732 -1.5258201261755224287 -2.0504959171977992227 -2.1037541690588632548 1.8886665007400569305 -0.25137476492215082846 0.44774815852884203293;0.29537512293164303046 -0.51475922746551050491 -13.629890965786508161 -0.34911925582277619773 0.97366718985887334981 -3.0925583943310481772 -3.9746734282804134786 1.1374755270729044465 0.36020211820471442765 -0.23413296888417703401 3.9607136668402138646 -3.824052754961409839 -0.19759039010442980278 -1.6288169190004073705 -0.99853715903378870156 -0.77112706863160418447 0.33991394265650604067 -1.1809108113577577726 -0.32522844615148177594 0.36520488405896583961;3.1855955476308910335 -0.75130423436200455267 3.7642318470500173433 -0.42910052091694378396 0.49216978207212808138 -0.62239022916781150396 0.20038849933430435968 0.31927468974385514455 0.37824494188163054753 0.2479788210599331022 0.078883680967275021656 -0.21406327772327832237 -0.29678241490027629235 0.30552750644752590947 -0.77026285039132702526 0.35560006544243960569 1.0404017017661311151 -1.3354128983773749795 0.73534478758463039938 -0.19648474258637951828;3.6722299536263141029 2.4422157457580677686 15.295992231277274698 -14.766902328097323505 1.1478971498639511939 -10.110722875290742095 -2.0266242802894383068 -1.5210944041327469911 0.182059077883563597 -1.6295098733747361841 2.7492983836673139386 -1.1726677778899643467 8.2294788138575718506 -2.3693013691085571537 -11.024148029678288552 1.0393032376997204391 -1.4660038174320417781 1.4912341278258152144 5.0592891716935382007 -0.53820807810971227347;-1.2173826797173969982 0.0049547663197993087672 -1.4527841970385984016 -0.62903904484944861419 0.66820125459868273676 -0.81788529660161912727 -0.15323268453018673574 -0.73426564406757011128 -0.76112547309852163213 0.13377922307095779786 0.39049003040374796747 -2.1476048426925218315 0.037015064604356884281 0.46056701225976148795 1.303485328177112379 0.17479296929702448082 0.61408349235410431 -0.52326786558378513003 0.3021168930291923127 0.012441441804210364233;1.0327411623837723376 0.6217478123732277373 -0.030216595925833367176 0.38387485359881007296 -0.7788864867753274579 0.67674294217875186064 -1.1921282318541379652 0.31254853018802514208 -0.88775693296284274858 0.1285519940049533183 0.91493884037700323741 1.9262741117045818484 0.08924469790014247228 0.040415356627899155784 -0.39041703688117956883 -0.046991813780169880421 -0.33197796383502997664 0.37632807514052307729 -0.7354870685852599177 0.22751860193228673479;6.1232477056713374708 -0.6668058980336046826 4.4619999329649466802 0.89919046191330853635 0.39264296370837697969 0.24452424352530802154 0.49453542010471585044 1.1325021979812113226 -1.6999508875328062096 -1.1947967534141579193 -1.1205114625404295481 2.5481885226368965469 -0.62213200274154933922 0.36362138013797723479 -1.7830786423868363322 -0.53030206893789577638 2.4677285859459705541 -1.8371079868825694881 -0.060636437901236898973 0.53390953112484873522;-12.520751231977035545 -0.81523952500667951071 -13.259005485535441338 0.32894447952276084646 -4.7145685438226401232 -0.039053951727711817832 2.3703196822485530504 1.2848941771635415954 -2.4756199519198052172 3.1381817329922725435 -2.9623491360965155117 1.9732859325207625645 0.50979617499684592996 1.6796930025086755922 -2.3887177136399015964 3.1200629080580357666 -4.7039169062833527946 5.889157242620335353 -3.0337116113132700512 0.50137437550088803651;-3.6395954435591484355 1.4680102811564805787 -5.3835080272522146672 0.45504282179004096331 -1.4282033402205291939 1.9432826359193497989 -1.2086410560977436379 -0.91393655844939980515 1.2753170012328720606 0.49125448619355166491 0.054103838336917634 -2.3739379569059346764 0.090850711649519633184 0.017802118833834673639 0.87471995525354395706 -0.8825728328702265868 -1.7751397328061622183 2.4621310312060455949 2.1910519290024121908 -0.63716830583265737786;-3.3139742067703248374 1.0161159981141676401 -3.9713612354393585946 -0.32553854950551791569 1.4470049561176692166 -0.60362398456765509192 -1.3077562875588915059 -0.40017745416949845882 0.034721137589446629534 0.82825335593741566953 2.0439147250785980603 -1.399507109446811004 0.35893246332868006254 -0.52147957406380385237 0.42794381711138274049 0.44972789510095045884 1.5114560311752112121 0.034000444559487641438 0.2688807873044927188 -0.36970035889513580551;-1.2638709057474186714 0.33896801145091015606 -1.3949540732556744427 -0.87138263024359108311 -0.45778091667303277834 -0.027413691600434216683 -0.055786827129277884174 -0.29239923431889680572 0.22714098941478083615 0.52565934297153937838 -0.13620010405770704986 -1.2157836657244598388 0.11258081872541672586 -0.18851421580841504211 0.61043265774278310243 0.32684515696525595629 -0.85473037893710701596 0.33767500168656111592 0.13025384556384289603 -0.28941190754001638874;-7.3331478847780102726 1.8876188253610377554 -8.3807723444178083838 -0.23021268647837137 -0.18629049807340211653 -1.0251910742835512735 -1.3827944821074704684 -0.61562834438357116884 3.2622376175747271887 0.014865857845164929044 2.7740162181635694694 -2.2950529089241897829 0.127272003736800976 0.039147636774146225835 -0.38294414832701129114 -0.13743455751574198964 0.6219626564167589633 -0.73532150006396057584 2.3318763252497882732 1.6406982058361856414;-1.5352777059197411091 0.44765582781339730012 -1.711407433867576211 -0.82211102354160059402 -0.44300686670284855628 0.036591416598058208731 -0.083760292807239331014 -0.32091667901099169002 0.22906393712012029784 0.50054869895564990667 -0.1319215563738171948 -1.2372135989641819265 0.15858987066841184754 -0.23114529217111073889 0.62369251221915356087 0.3066687330972215908 -0.91103077717740488239 0.46907601309015556357 0.080719249081536284529 -0.29787848212075185295;-4.9345875649150139353 1.7422092107400670713 -4.8986314393211030094 -0.35827695301036210918 -1.4849403047961597935 -0.99803268549331558557 -1.2100687072680420542 0.21803281334967999916 2.2086718492507229072 0.89289637540923383341 2.1403321743208767458 -1.2261780344153874189 0.36118403540587928902 -0.070934689174045925664 -1.0758666900179603143 -0.14118404916188684317 -2.772565610202935904 2.0291125123790365592 -0.48193569697633736881 0.86191539157662733217;-6.2486207675060461142 -0.18075085516528163754 -5.9230155678645441952 -1.1796422323230848495 0.88874609873461485332 -1.4579298543320209358 -0.010023831264345667291 -0.81797854020284677112 -2.3449608719721810601 1.3505106618342912483 0.92567173860762896886 3.6670765973082994904 1.486300724447213728 2.5326077240029309934 3.2642430115916338806 4.5028956006579727855 -0.54443472722888230919 2.901709792264841159 4.1069609522459753492 -2.5148512771359414764;-1.1375508382810348706 -0.12429737929631422266 -3.4863428546081132176 -3.1734973643803021659 -3.6819406100556841821 1.8850862990108467887 3.9306175225749577784 6.309523406282471214 1.7532438088499480155 2.5572952967492290632 3.1678921258837666741 -5.8894062868829131219 1.1852825634481962691 9.4220273987417098027 -1.8750456716594567919 -1.5617799868230051175 1.9097173649155365638 -7.4276061489742772892 -3.4851958429097602554 0.11330399576699543007;-2.3379083071639765734 -1.0225316234611370181 -3.2274798336725578629 -2.6585565369775254752 4.3204593355685947387 -0.31796579476101455297 2.3225409296503989331 -5.2536167785529199747 0.3268336205643757042 2.4106335332612549571 -2.1439762066063119406 -3.2904665269150501494 -1.4449726160697058397 -0.91832996760062068908 6.6761281028802637039 0.20118309203550263642 7.1499598749748543014 -7.3844536545550623075 5.2836759742095118497 -0.23197497425437341168];

% Layer 3
b3 = -0.6505608377663102404;
LW3_2 = [-0.24231242624633006488 0.21468015863096764906 0.54135969139397432937 -0.11203794483370228818 0.68584927013909902094 -0.9087491410364395561 -0.21646476247711921026 -0.71501088232983622817 -1.404190737150621926 0.81826386848029630805 0.72388685954309894832 0.23671302572616226279 0.33539074907289290195 9.3940259043699221309 -0.21676138974849593066 -9.6494985253511647016 0.55017927542260880447 0.14906296506138946856 0.062932316307698063507 0.054648387751708195348];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
