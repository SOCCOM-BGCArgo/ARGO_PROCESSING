function [Y,Xf,Af] = ESPER_phosphate_9_Other_2(X,~,~)
%ESPER_PHOSPHATE_9_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_9_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3743419532519818294;3.3577114445699725032;-3.2068136500814481415;1.2772789837165936522;1.8604807703783585726;1.6496964032751617601;0.92933831340165462542;-1.7546409054299128005;-0.31218760093138314682;-0.22312194237808838371;0.50477880761064053416;-0.46862715047395675505;-0.71650092931381859085;-0.49809986802594419242;1.0144890328059759099;0.82770631110915338091;-2.2845711863963198418;-1.0652265573666155341;2.1784373486157404542;2.9730508870296552537];
IW1_1 = [0.73516736862450726697 0.6625218746505198153 1.1903408379008206808 -0.19727372330924214383 1.3066404998710297036 -1.8086102252284457226 2.0199648649974579762 0.93673493124864515291;-0.061721705098548539092 1.5983228588834275108 -1.4542622794966244548 -1.1608526828441079193 -4.419999974442675672 1.3205359585622353791 1.0697621361874893875 3.1587271655911002277;2.6283127168687974162 0.5058100818691619871 -3.9999197550993605965 0.90140668585136529689 1.6171814657906755652 -1.8674273712523674629 5.4402492062714973287 0.83671345164401755845;-0.16834786908417928575 -0.052460514029972732386 0.67167323261290889924 0.21865440745700440162 1.0108608215341938763 -1.3878487650299256018 -0.45771042071115730643 -0.91570456646019027236;-0.30422152150337339327 0.027205243149687186738 1.6658252780151434624 0.064333599335772331806 3.1270685105586437658 -0.11872972115802747639 -1.9456599005852608375 0.24681611724238783356;-0.13820755693876174419 -0.043647565772660414096 0.30171352711604482177 0.92568645911065372545 -0.86671876182961860025 0.5196200149183705097 -0.80627236028243487453 0.3439170922984357559;-0.53186916236231518429 -0.35376354858128217229 0.77621146328846735152 0.95667597814966764957 0.93322615372710693293 0.59950534064917404553 1.7249757799115983392 -1.8802231738210701817;0.16824267691553471127 0.15651791854691585182 0.27668421559942374399 -0.98781797824381611939 -0.0081009153042679912099 -1.1957438244812004235 0.64786298404407349771 -0.56821069865403628363;0.71208925365318020972 0.27086293116959153648 -1.9914766170376816401 -0.060128177283441275325 2.0579896771592656179 0.2584311970926446711 0.93036166333546799212 -0.9774474724205041154;0.22734330284697565339 0.10289298019482560897 -1.7402659083112539395 -0.079037811315439632232 0.051628502439491748277 0.65352802451708724707 -1.071741617616333464 0.25447920702045834229;0.32669331357416375727 -0.082583896381523858032 0.18313036452879413729 -0.17989341063107366914 2.2883131735269541807 -0.82890374057207583114 -0.88238978000522960699 0.95369500622311476068;-0.76343934053184081545 -0.66420563253905584578 -0.15555446153196589298 0.19350200229383021644 -0.0088995324973575144767 -0.468573377586416151 -0.045397157267048300622 -0.80168586165218380657;-0.058977585018094719205 -0.23589568395054882899 -0.48716391359971189523 -0.11858563685168026225 -0.017141292571952435747 -0.89274544896624430379 1.2895654950798738358 0.47722667971762350314;0.095767652747060852403 0.0924552999903893169 0.055685607528052266657 -0.10449871652788442211 1.0587739090437182643 -0.54112314256562599191 0.3483512707468877645 -0.39911628949142713418;0.11855794420137355516 -0.17115165405623836148 0.35644131453167404722 0.18599425044853595823 -2.4049720610013811672 -1.7457263304152663697 0.5127760187160740335 -1.2798496426771530654;0.6056085421021907278 0.43550287223355538258 -0.69784302737791670257 -0.018818020659382764942 0.046136693647777990424 -0.79117673964200530001 -0.92229945954653880236 0.047407971908321154542;0.23500014293355217521 0.12858210937499331417 0.51356893962586314117 -0.75727152194829927545 -3.9421462947669323462 -0.79035763509512890757 1.6666714642584774531 1.4681452640556020839;-0.63633029485225034438 -0.34077727956551207011 -1.0857797630429895097 0.15489636271188284011 -1.0770846530130828711 -0.57522871624931548595 0.12206504221227799933 0.43139171911677448579;1.6022719336706885418 0.78144046067259353983 -0.85662338500134327379 -0.29490728483050476783 0.2849566498117362956 0.17422175600261982642 0.21528459138587491273 0.26515132711646727248;0.057032358664335411347 0.13252791591840201724 1.239274896031564932 -0.092078235640743744117 -2.5498365576338204441 0.89998334338037511149 -0.17141842997960526906 1.9604083295893497407];

% Layer 2
b2 = [-2.3583286153310023536;-0.15568334704606404117;1.4237623588964603005;-0.24922428615666716856;1.3184220686361138863;0.21950642079949780894;0.25743105192018711502;0.28514015955157051563;3.0500845928206228308;0.23703928358548176369;-0.88159202874942077521;0.44313560307977900576;-0.091470795982582564498;-0.45048901893519227579;1.1037372268501348671;-2.9025301688782692011;-0.79817049239389514792;-3.972103411144617624;4.8125269597323079296;1.2041340409283758373];
LW2_1 = [1.2229388239991565435 0.16575800102168020134 -0.14071601286801607711 -0.52188642896758452583 0.58073842188183666391 -0.35436135212582497989 -0.5033274002003199632 0.60254728846325045222 -0.60976561245617377782 -0.15040151501423515423 -0.13381634695427416237 -0.30215433773910416182 1.863720112730061107 -0.16030253408016556516 0.36623728342958550286 -0.66205960629471249934 -0.84845160832107235915 -2.034711235492464354 -0.76110112856988632046 0.94050108338636484451;-1.1651200063069315771 -1.3464551220008109667 -0.011718186438832083746 -1.6239019997630463887 -0.18400717762359633523 0.46432276881233486288 -1.1793685770227653187 0.23946285178667242599 -0.28048632959539476772 0.56798014084969639104 -0.92217970445690411463 0.15376385612603604702 -0.71056386402043292261 4.7879791974917926822 0.99511042497163937348 -2.0198525804732474498 0.82173062276591590791 1.8310309209968584909 0.61394359518631069772 1.1339654611745364488;-1.6100367818616927451 -0.18234535114705466285 -0.020682924202411932801 0.037939601322065148736 0.34171662750926912189 -0.3086209911682137319 0.46178078043275128106 -1.3051005233236412373 -0.16522779561553471717 -0.67644254236319190099 0.59503734363564686483 0.47599297360099102061 -0.17200678320140289079 2.2022779197481425761 -0.47980089369070039185 -0.20682779385475424938 1.9057958752194816832 -0.44826365054968375645 0.68167854698194585428 0.66352225049655733091;-0.63885092856756964252 0.4891345552727850432 -0.087847146656775967899 -1.1656787006066890999 0.95420641428129382433 -1.8012935140938639567 -0.41965427543741529171 -1.4100336877218391241 0.77008866674883102998 -1.0726072788141780556 0.23725914744043544169 0.44460237947354958044 0.21957316804147150591 -0.38737452738466227053 0.68531449186806370211 0.4001107796117251425 -0.51793983989255953926 0.53019162739064673584 -0.41487402316453964035 -0.17448391645428781849;-0.12332676257037608614 0.54562887080678013074 -0.086583614173547568393 -1.062293453254588016 0.53767798671877109484 -1.1727208709649954432 0.1988957107234612387 -1.3714534778415921057 0.62983230919830657246 -0.23330830529347632019 0.32260984547542598255 0.37597764384804410742 -0.59909599435312854698 -0.26140386184526609448 1.2105091602535518192 -0.4591526294707198308 -0.43032134139652455929 0.9551130976617324686 -0.22043946655174059823 0.15810142379884986608;0.38192376146716167096 -0.78536437920964397019 0.20256210732136725738 0.59752839760569287364 -0.49601372434788187915 -0.51022009804471923911 0.31207884751301079307 0.33523554649583287013 0.046677495215173975263 0.57231717482069255354 0.71997590986752368902 0.81256887064743432703 -0.16556493372756878046 0.26892082568311997948 -1.0092015555260549498 -0.61489634509883739355 0.16547827897901665195 -1.674802339403059559 -0.35701167206764006234 1.6710679465828108814;-0.26019205984846682789 0.45165616310896133934 -0.11228045915727291604 -0.32148664217147804312 0.31332482490188473534 -2.184403775614286225 0.53697314487655878334 -0.8525816539112094361 0.051019150553486540545 -0.15830766617776734217 0.91684565971587217437 0.53047670793336076933 -0.41138363423671392427 -0.5337400418361326615 0.16471217673253293889 0.18940654933818470984 0.058727332778401496183 0.10257944550722027099 0.29424520432833695116 0.52023641090833949718;-1.3568682599977641701 0.09876175862003833128 -0.54514358419266839562 -0.97153615500404144623 1.0630956039967756066 -2.3939648964991357971 -0.2003169931216053079 0.3817878077626895017 0.64194314020376908037 -4.8033308483867891425 -0.85060276829182568381 1.5391887751538328999 1.3275754109618171928 -4.417754286886204973 1.0829547019761263105 4.2248959064755311488 -0.88099910099066014446 1.7990500317267084096 1.0000910825798245973 0.34959242944479701487;1.5179450231728330856 -0.42683744292158143363 0.021746592974113024971 1.193617466616119227 -1.4790600704023166845 1.9410768823810247152 0.46977957606114295608 0.99086679319543169431 -1.6598546093332138263 1.8782961318110891202 -0.10557386733895154918 -0.61578108357153160668 0.062928179152025531806 2.240896027015767622 -0.39310930184043940683 -0.66074505254046056457 0.47883848683402752133 -0.30136014871752125899 1.0121323203551879644 -0.13425876879575351919;1.0992393813598313468 -0.1882065006362175219 0.18025791459137588402 1.2340299574870836619 -0.66199264353570363983 1.405695173934992992 0.17792575449381842212 1.2157474902117035853 -0.09017850571848501362 2.1755342754618438583 0.24133535996423494119 0.35211410767686629475 0.21629673979132074679 0.47438297503332021998 -0.79329537109525494198 -1.4287430429347045546 0.23284411820316883168 -2.3817091723164502959 -0.2724510400267255994 0.39918317880142623055;-0.62200177276494605927 -1.7791085511797928298 0.33950594038334841462 0.72657906173362218905 0.93589320230813921597 -1.1045455741460468158 0.66475580993105309879 1.4507919302602250156 1.0872607587043161548 1.0689303057106902539 0.025647047537941839584 0.052698029164823509407 -0.45951471819229611215 -5.4916685692115336792 -1.1716415413345724339 -0.60360306442529454429 0.94902569025972860484 -1.1641063472187656025 0.46276733006813863813 0.65425908494996742881;1.4031670887153380178 0.14726129437746843243 -0.21067995905121270073 -0.32706823167432191868 -0.83911680836091540048 1.8527778927449340962 -0.00072113188380975115112 0.27046253178531354244 -1.0300115587554696805 0.34091554860894862644 -0.43878764273481130065 -0.572722834507131906 0.17253339699322806089 0.62134644924398263477 0.96093124001822460833 -0.1470799792046675325 -0.39526915459329298175 -0.35004009739254360323 -0.0056455289787513702332 -0.53505123766228146476;0.016611315818730671562 -0.23434327939580595901 0.0473476966349859682 0.87775380076066489288 -0.59389076946817209723 0.3724170959383774071 0.23429089226372840082 1.2114488797215348104 0.18520039545836894379 1.0593583627442821893 0.85470421108166583224 -0.22906421981154162504 -1.7298181857545953388 -0.51953924511492033389 -0.2397747761000622313 -1.3346101565664278965 1.2119024812679748404 0.17027168070331108463 0.44510860921881639785 0.57823976847313385274;-0.23313565591796692189 -0.52174048364586067539 0.10010420275402215351 -0.033764937141504997031 -0.2374704141959753656 0.092022908777826831206 -0.03431869964366281861 -0.34509300552365912429 -0.19861210401892692712 -0.58140758288254346109 -0.042191808054547176587 -0.27311834126588424576 -0.66075152630849165458 0.64288385963459104833 -0.37497152692217095016 0.66129802808867110819 -0.1533087337577428988 1.2062639357832769527 0.35043260185385416428 0.19074377875440903796;-0.35479353758786397188 0.77776530994089598803 0.05069284186487531263 0.54161277738441215845 -0.25001958525875417338 0.89964590854404580256 -0.48845190202080451813 -0.79082206441382973949 0.18026147021605148923 -0.94369389534054270996 -0.94800613577265491205 -0.63773797887475303092 0.24501331466046122332 1.0193264948571161277 -0.74132489549369828818 1.0263128957282294795 0.33008684426871365281 1.4373241336794542189 0.089413756968386687296 -1.2870865446599575321;-0.15565973946517216997 -0.27377156869462448974 -1.9466517954592379436 1.784851102144367152 0.018769814860265292278 0.14973044542544136637 -1.2072335896443602277 -1.0945810102739750302 -0.32395452511130556905 -0.44054710736260593862 -0.71281444343352995396 0.35229429206614321091 0.4969185526673343678 0.99538670922513150519 -0.44882453145227774183 0.75808953657206057386 0.15196012434191169538 -0.10650650670916009255 -0.71989079367518071795 -0.83261854099123766559;1.1312474131421912382 -0.38231148600157149886 0.10275438298373494594 0.77972295747254294351 -0.063984141628809054758 0.69517337160624947945 0.56409133826507618092 1.7461310583129374674 -0.8311920407767260377 1.9824814458354971247 -0.54992592499355008595 0.16108675577952319413 1.0046459829731342328 -1.8985127695673307269 -0.21794104397096680792 -0.8151827369842450377 -0.10970670358512767117 -2.3098571016969047243 0.85904003302526088515 -0.055370378272224490823;0.17931151660060762332 0.073978296657084371968 -1.2966558540031907221 -0.90134855592650453548 1.1243840168251870715 0.67816658134023188875 -0.18881683810229188403 0.39669442840400809258 -0.6117911285435118085 0.43864144753838418822 -0.011456131302539916336 0.39279197288789002851 2.1355903414131556239 -0.92252720593827919338 0.92373279442210254331 -0.56664138291713705975 -0.84843195863047204952 -2.4362981991953001071 -0.89342352656574508529 -0.83989041039319556337;-0.15239622746998110481 -0.0022180699846763712868 2.4019462653542906772 0.86028334775154557956 -0.97205361127617850858 -0.90834252667527126679 0.2017345277950468585 -0.56014500542882672551 0.76827205384418806311 -0.70155098397401649546 -0.18733326576830919286 -0.32258871229939761749 -1.9172493281606279858 0.90217678593370131956 -1.063872718890999769 0.6511565899533923174 0.75989436912975805161 2.5553816816384991029 0.72663095657763110413 1.0607061807144748666;0.15575214311378476895 -0.27036506094994511296 -0.02845683198817691717 0.70731479337991454148 -0.21192054595730192013 0.31975907682792426012 0.53291363044071093924 -0.11797729751248824115 -0.32611709607098893215 2.2759445577198107458 0.0098306562839301780965 -0.019754392802940248103 1.7235030112669107449 1.5506622852953773073 -0.27359466635556284331 -0.43564670120597465131 -0.12471122858507290021 -1.6515396328504765577 -1.3776782506972626852 0.078906963211394981483];

% Layer 3
b3 = -0.35266125150309957093;
LW3_2 = [0.68042942241340675924 1.3082077629619144332 0.95741202145762016595 1.270139333791198144 1.7527834972919347223 0.8224013240228753574 -1.535939069182294725 0.22913772159578965626 -0.60553730912267256237 -0.78360283332463498418 -0.14627914988904971993 0.71597176234250681226 0.93424678179506837061 1.0519176977356392566 0.73907292586498196663 -1.3651274955329881777 0.85347025677631993545 -2.9754082261872754067 -2.6032985234746837122 0.48036558265808415591];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
