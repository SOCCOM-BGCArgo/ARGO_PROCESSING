function [Y,Xf,Af] = ESPER_talk_1_Atl_3(X,~,~)
%ESPER_TALK_1_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.9738221379087459;-1.2791124547287565;-3.1334724495954309;-1.4178768181776404;-0.73340254677953376;-1.9651894211575156;-2.4820944515549623;1.8271641030142112;0.37341207193647363;-0.79051524848140353;1.0389255523326428;0.29172489843382354;0.60110897504842409;-4.869179124477701;-0.4013700279770937;0.38682924136236652;-0.94206803146968998;3.0017333608873478;35.650476509153975;1.8789406385473821;4.3996693048737887;0.17544921918087245;0.16377488952423741;15.042892496017966;1.0964639873397468];
IW1_1 = [1.3983561102259483 -1.9304704147914595 -1.322048387376602 -0.37714670192574479 0.68228435669593823 -0.31587914630706099 2.5403270261424065 -1.1858820628647813 -3.139442869641953;-0.069245521331997628 -0.16504926357449287 -0.12674900122119598 -0.27524060324186206 1.8746043606901532 -0.051256741678153292 0.032759611788325184 -0.10139618465846512 0.12944788586226935;0.27809101283015453 -0.97258825287937989 -0.26711977668922132 -0.26328764514230962 2.0996311019504397 -0.84388618854264841 0.27153313186841538 -0.14837120476112414 -0.91071151007403683;-0.27973026227921427 0.2309448130900866 -0.27880537813003314 -0.19753593865437444 2.1184889677816612 -0.47264203486094225 0.03653516441352346 -0.067746529369143299 0.16290434188860342;-0.055042698206930744 0.03838442495986194 -0.16930207928001451 0.00085422299453432032 0.50238019834696501 -0.28333969667709435 0.12449199151796922 -0.10237602873083651 -0.253737145414276;-0.3759998448553713 0.45056673118337431 -0.10158584604212655 0.13579608087147771 2.1913573169790719 -0.47631216157563283 0.21900939642432793 0.045292365719298351 -0.055650604279220792;0.41638190287330967 -1.0372566634935294 -0.17077438315326601 -0.72312202048235308 2.0655059376331013 -0.63371244980120811 -0.49562200954455288 -0.68518581714844118 -0.48886271181512808;-0.26236927432930229 -0.019778191230752824 0.018773217733819753 0.10421559854085108 -3.6154430628193133 -0.014904074356458985 0.10599695098990668 -0.015430985741394307 0.10767783180740011;-0.21309386830779029 -0.074187466014676795 0.096921683236718389 -0.10886749870713627 0.53406345534333211 0.5580419885441934 -0.12327664608687451 -0.027651742405863964 0.35210758691403782;-0.19905515810011193 0.34363314830124786 0.068661278815387972 -0.013234465742682678 1.9767108872997268 0.081775671307627334 -0.1801232813689142 -0.015128088221763588 0.23158864057978037;-0.92925671115134256 0.36998065176497907 0.50605752998281262 -0.71936592967371138 1.3354825000149373 0.25388033185672232 1.4645406407740222 0.63943348939017286 -0.27603292712750305;-0.0035500696083623079 0.030190022021567987 -0.13816675043087004 0.062147961693484001 -1.8121317695146069 -0.81062693104303329 0.5251284035751973 -0.16026668973758887 -0.14914280055206375;-0.15996665026277007 0.43550943112640589 0.0040459416175014926 0.058523452017407968 -0.2177273691666925 0.32133925505076599 -0.03652620527197846 0.0014088010204312169 0.087996566913189106;1.2701660774570809 -1.6768551376846768 1.2832277010911577 -0.12319178381417784 9.4672835039259162 -0.17408498640970413 -1.9508895621982227 0.055061118182873028 -0.28292598286571546;-0.48125304336538477 0.20997464089658627 0.0068885372166226731 -0.26222822857910416 1.9349360472405928 0.60514116333062129 -0.18868815970882691 0.027132173506291976 0.44112473587753465;0.14366260422036453 0.16507418899236048 -0.055792212531996226 0.033001326764555437 -0.096750375621554821 -0.078025057702431497 0.096268521999424247 0.036873224668723101 -0.23425111596500961;-0.33363084175768271 -0.0010814040433719451 0.11278379354105217 0.009038199175358157 1.8963749076828187 0.077049520176883365 -0.23667529150470637 0.023713684181116846 0.057864937386586143;0.094242000633959599 -0.091515467656016147 0.288165342471847 -0.027634042744975957 -2.695039164937695 1.035705550273917 -0.36321212914146339 0.14093082691994133 0.4766314245017052;-10.172793220028186 11.896905849928602 2.7069248347721788 2.8054876652460226 -39.62162581596364 3.6212879733861412 0.10718649677374058 12.977275289253649 3.689635632481556;0.046334001931033833 -0.36979971997912547 0.37485178348745868 0.19719150311259787 -3.1251299053911534 1.0908863252163277 -0.28373451144400141 0.12421745530332957 0.34351575868266337;0.82061466119889293 -1.4697965982752668 -1.2862697151951143 -0.024560800368147746 -1.0956039001822617 -0.91568612450283637 3.1158834175525083 0.76134353745874983 1.7378718549582166;-0.02893611563599786 0.13168719026156578 0.074074571723779348 0.0063126839247028433 -0.9205302918631062 0.30849256822426158 -0.065153331687430135 0.072923336057702542 0.16967894429496019;0.088892434086350947 -0.048831423391265602 -0.13134534592339864 -0.045862040924200598 -1.1102587530042132 -0.25707641066027481 0.11661328453679827 -0.04678114788944087 -0.018368396715889836;2.2259776532343785 0.036207563482172488 0.91932559532394975 -0.43192865563378313 -15.625387303404414 5.5346925431378171 3.8996114085363964 -1.2360932380783118 -0.96044226380579378;0.11137162810206865 0.026112560083100065 -0.056201538882958674 0.26131669612047836 -2.0381665143936316 -0.072568506810408592 0.22073210762672385 -0.0026891800238456444 -0.58905521334001854];

% Layer 2
b2 = [-55.636673739182591;-17.833753326973426;-35.881310405861136;-2.9661620382345264;-1.0053899396871131;2.4268191689393475;-7.3885244418363376;39.702356694731883;-7.1151902586861677;12.578376797617908;-2.8670497649216826;12.935492723646293;40.448635289413332;-39.877044751296573;-37.157002831852445];
LW2_1 = [9.5838287525898629 20.315512806354825 53.895342105530091 -11.288406006551337 -35.281750401500879 9.698777103954713 33.798248172913624 23.151233839694175 8.2082433869289417 9.6664565148369697 60.30661009604659 19.201749692636074 -12.226617439406903 8.9191598699298673 -28.480135751704122 -20.386877301966244 -52.570402380266891 9.1371917786380834 -6.5929659853346347 4.9663652407291536 -68.291848029323035 23.307736036968027 40.69202116851492 59.012214736719656 9.6503072566030053;-0.55188935452239385 3.4494829868182069 2.7484369339965089 -0.26479974912246562 -35.516955883492486 -0.87979401012802994 -0.9463234808920068 -2.2764272832584465 2.6093100592236662 3.4982055360749231 0.43932413521173957 -3.456828575085932 16.464668785271453 0.15658914249981976 2.211610626027452 -9.3991256107859797 0.81054046159866167 -6.247483018177177 -0.0023315150529109301 -2.3043116322109869 -0.048330350876252232 -36.00261858798396 23.20523068319541 0.0055494218676118631 13.765510433095857;26.951946010848683 4.4353355383416178 5.8154728550942218 5.7097448529554589 28.417069561909624 12.016499238436678 -14.632592424536261 -12.059900912293907 21.775021643041541 -1.3566453728697305 8.8676694212474807 15.243159465922934 13.520893454027663 20.248824232124548 9.7137290701742938 -30.946447395297675 16.30346072208771 -11.568665733158927 9.0752300965854538 -28.82881601376889 13.207930896780084 9.7129442822022014 -51.691641164244146 -20.915543070762386 -16.866752750857913;0.26134126218930531 -7.4053393883914644 1.4171586663504425 3.4599542726916614 4.0665193204767531 -7.246134298643006 -1.0298890005820316 -0.86681742475724088 4.7225584696398286 -5.5553654702689172 -0.41052133543648633 -0.20640530522901662 3.5031804801026456 0.9269185073844225 -3.0073502219490327 6.9470103199325735 3.949728421437618 -4.5093092921817197 -0.0381292070706368 1.058425481392858 0.083769284956911799 6.9355949391466867 -4.1529878576645283 0.11693227885453943 -9.0881862678092276;-1.1049002615121148 -24.322812324044765 9.4421602477356465 -2.3566457236931231 -19.669906265733978 9.7678281714162054 -0.59147255986865355 -12.00279634018159 19.405676523844033 -15.745308361924696 -0.81872535230574273 1.1242345599419505 22.933262932218515 -3.4497690639192129 3.7250442775404227 11.241494950368729 6.1069454977734683 -20.596313130677018 -4.1486118906988088 1.3771947228846446 -2.8095239619528813 -7.2151598671720318 15.235031249224019 7.1582437051526808 -15.235463129006128;0.052759798572918438 6.3093951740062497 -0.56611527688296415 11.698085004752988 -2.2226693820430565 -0.62977563021554916 -0.38313229869339455 -0.23240584566375933 -0.010408454992097296 9.9491132121008068 0.082109510581904327 -0.041071362367686562 -14.34859591426603 -0.096294047430164495 -1.4998660171974032 0.23401616807474687 -4.8696387864720974 5.9492872589164127 -0.065816931290409358 4.6175182266820745 -0.22186271599917942 10.752489477088572 -6.5078004081358332 -0.2510542497188441 15.283035618630093;-9.8090021300689525 -5.0052024211555617 20.163071764977211 2.1578814214487179 -5.529349267583866 16.050447779001271 -18.557937486132591 -51.471726432558455 -44.175848814147528 -21.397785659857167 -15.604734121110962 -11.421003707080194 -42.262088761523479 9.9398172573094694 -4.9167067326174099 11.344490141424442 -24.180215403607281 -3.0465543519321105 23.318141648707815 8.858695997159689 42.619125465397182 0.64932105605441637 -31.794010378556859 -27.604989664040819 -11.79768387602128;-2.261830732701378 -23.061223247998129 27.670249829386812 3.3755010399119199 26.849078875225192 46.127004411819193 5.1656020037773995 12.81506879457014 -45.152957479463097 3.4955877532547697 6.3425219243364683 29.223507509648993 11.642744394202952 34.982175154656986 2.6965789953008348 7.9199324008282348 -19.570172809722191 61.816438150748326 27.118172809684584 15.723381855329874 -1.5969306700614043 46.319950670962776 -57.242359468423473 1.3424737588525599 -37.539605330415434;0.75660089621317883 3.6585758924114415 -2.2576302359179583 4.1466397719226178 1.2970118715615302 -0.81238586343973962 -0.33660222505052872 1.8096190257452973 -1.7395911232166494 -3.1964495509574555 0.23397548323071099 -2.3939403745919074 -0.077786205821512494 -0.18502175378695174 -2.5697647931343406 0.43546221422682074 -0.74878831320239536 2.7531213874245992 0.063498995110809767 2.9137696258297066 -0.037893584023878407 -12.779248632941364 -1.9123702233054571 -0.50393342768816907 -0.08703636758048168;37.669002694740705 -10.219061097938136 -28.209584951479719 23.52745299236733 -30.585713389736217 5.2690344093815495 -7.6357158062893902 8.8093736479720235 -14.422825556870039 2.82509654578068 -24.042073476028285 3.0099421100302779 2.3446413207872996 2.5801267508618109 -34.396173313123441 -14.448099697039394 -2.4533917535377481 11.591161354238315 -8.0313898425695527 -18.655285726859315 4.5484861016268381 15.622078580459503 5.8644371905915662 -5.0897388582307599 28.724236092717923;-56.937874980423381 -19.950083044903543 -15.748863146628654 -24.371481029374646 12.956947094522562 -15.074111758597001 -16.993198244994435 -8.2946538521456521 -18.849660007987929 33.368812700408661 25.209915222609489 -54.494914937665847 -29.763601748054654 -8.3507956808672734 -34.37985374569751 2.2001640246393563 52.246965987102776 -50.82120140987314 23.930625855575315 5.8621844078193659 53.492554481386932 -44.309933968500346 -47.209935230265629 -8.6152521729556995 0.90351832224330608;9.1838142669824023 -2.3665930832044619 -21.329041210226933 -0.44731943017991127 -22.161678142285545 15.050566408537186 8.4754265412078631 12.266734116817778 -2.9641121223873914 22.59933964754234 -14.975202702877793 10.661167619300045 -12.093820413485625 1.3340817969167704 22.172685837046188 27.91681330003787 -5.2671956743777759 15.412863305520368 -2.5522820805792192 2.0860747644716646 12.118063948961012 37.521466685193424 -1.6112355300686825 8.423060058909881 19.756597168604578;2.6616453944424334 3.8886538465693525 4.8117811568568403 -5.4617556537357856 7.6430153258065312 21.802925499352614 2.8170669729782656 -0.90210856744089274 -59.807143649223661 -8.6931773599035012 -7.6029211141539124 6.1985614318945128 15.616681726758927 8.0866640933859699 46.786540333719671 -43.87183947378454 -5.4434704292106284 26.266156906297184 -1.9812772493357318 -0.69284608031886197 3.9417469861959993 8.1526391101571516 30.559723792523787 5.6328114635949484 13.852310279212922;3.1024280533006907 35.185462865599746 1.7483716690190667 -26.10974934799351 1.7229779013709343 -16.56478961364602 -1.956949824240191 -12.573733152355697 -8.3846269316964825 -8.9335370914831191 -2.2192073531404586 -14.900814626455949 9.7656569412020851 -10.786325044320028 -10.584988776846659 -21.804138563138874 -1.3046948008564256 -28.557272890888058 0.015474788674960133 0.79761770597049753 39.66928868882961 -47.779425113609619 33.18684202921807 -5.7571492010767216 -22.062569394988149;2.2689620046108572 8.9891358157672556 -14.832707390722257 13.241996245740399 -3.7812124815094603 5.8014369052637811 -0.67683163026739857 -15.468683464055109 2.9116663271079131 -20.401272741756646 0.010025149356363318 1.9342835961242799 -33.064057391763789 -0.60358419886153292 5.152371346146448 20.451237102798146 12.015197709572385 4.5592335652686389 -3.846555165353303 6.1643520888883661 -0.76861694318764084 -23.077416737946006 -12.877178956132935 -4.4493993845612074 15.265078599391565];

% Layer 3
b3 = 0.45967707822560383;
LW3_2 = [-0.00076793117630141478 0.59328443264792008 0.0014238325596033913 0.630198954395218 0.0060775687743755934 -0.13565180930144172 0.0012729188296736809 0.0043290368510044679 0.14395368461643096 -0.00064925734497974397 0.0013905422334336357 0.0007955937555621746 -0.0060532385768354508 -0.0019144602929311082 0.011177817402668927];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
