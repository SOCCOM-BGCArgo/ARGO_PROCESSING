function [Y,Xf,Af] = ESPER_phosphate_11_Atl_2(X,~,~)
%ESPER_PHOSPHATE_11_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1220943402119458732;4.5216122343116564863;-1.3285660882159104901;-2.6047290062210461947;0.47525715687073588622;2.9439292599901567549;-0.39673700092576935639;0.027297431098545349437;-0.17560872005413954988;-0.0099049409378794937842;-0.43614854819882076242;0.076521926327566713866;-1.5285974704016849213;1.8374644797852881517;0.32498212391708908298;2.031788518879531491;2.0744549722051379703;-3.6416494247254318495;-2.7690121101439326701;2.3005541939241553884];
IW1_1 = [-0.38904836975793805065 0.83631366932297024341 -1.8435849431394359943 -1.662731723172392595 0.14355927545600172257 0.64052860400534883389 0.0028072580672251368911;-0.13173850367111383797 0.21170010529958718792 0.32385319140536700244 2.4776447073189356018 -0.66753037094565670362 0.12863141699177452204 1.3718610291397805856;0.81555430701646625113 -0.61104006973554603199 -0.59668249898303338252 1.5460978272642689202 2.7565165031245451033 -0.61945517780091929883 0.08413108695409668436;0.35335360001501647798 -0.039709036167653699589 -0.006204349738891057342 0.05471890250226733865 2.9774150065638131935 -0.098107205895695395736 -0.41221224127419264782;-0.70647659521846095654 0.54697438726581548707 -0.48689432837596019477 -0.31917803983973691562 0.6975219042195320851 -1.8138578045816782236 -0.17547030312151076781;-0.12519887904232099296 0.7680758257656132848 2.0864238355124005153 0.69194547065597511448 -2.3495432206701858391 -1.7583115299892271288 1.3539387100530593244;0.70684776758477096958 -0.29232274584212908364 1.4536929826324045401 -0.50812939607605389636 -1.9358276776825418253 -2.364746176670719624 -1.5444196223633421816;-0.91204958913729994308 0.4634792298085225748 -0.79301674164628987995 -0.33478129789440663755 1.3855915920358969906 -2.3549194471915826377 2.3054291543408287346;-0.052563987165735383267 -0.68257763570130602915 1.1405943428490028513 0.64385560422087118049 0.13101418945507040115 1.6175896185750335832 1.398641133624491939;-1.2685883529338508602 -0.042650806783590011761 -1.7432363884816077793 -2.388448944729979484 -2.5657631540043683849 -0.632936984540303893 1.0642152742338248927;0.36473993068110277527 -0.22246124268113670608 0.59841339297505968808 -0.96136840242898347064 -3.1028172793477883928 -0.39961551360084701656 -1.5670743585180422208;-1.2743003425075443147 -0.27446969087705747059 0.19177707351968228955 -0.081178784912615167824 2.0305814685499581351 1.8482793836694759726 0.62310193273225389365;-0.64491126765377049246 0.96797999265676726299 0.44010662593637456252 -0.29410888811799884568 0.62970021101724082957 -2.8808998460285133447 -1.4795670180374556058;2.2016286137431460013 2.7291962504360212094 0.47897556770365723455 0.27640213392606544085 -2.9398022949951889693 0.023525499935243505967 0.6686513321701224033;-0.72928707836800521491 0.084108717635297813864 -0.29090884149370843659 -0.065717074785996740238 -3.4182895178810048797 1.0617523151366188294 -2.105045433431558255;-0.0064797826465496114953 -0.60763516160136776811 -2.027827686199874524 1.2478313215367347055 -0.6555023654682858858 -0.5600672007489186921 -0.75175394796565331301;0.50316293050514959706 0.3471892949020016772 -1.0766472699100748667 0.4967230369122886402 1.157402737450032415 -0.90831098187730163751 2.536663138945949747;0.045328462527395987913 0.032373889103517142218 0.24564807838040622623 -2.9495734944296851943 -3.2858008218131464773 -1.2472452435898178091 -2.4121038014247777603;0.56809588949176081929 1.0569272916800729334 0.92255690022766922986 0.059514100697700397791 -0.77266331657094522445 -0.70145953523251169948 -0.19642689997994908224;0.94416743040180295399 0.22636470169597330826 -1.2207168552378573345 0.15702538285118219918 1.0099590196530081609 0.45225112237593212416 0.053641226807769407103];

% Layer 2
b2 = [-1.8421536315898050518;-1.2927734803626180771;-1.4611550056913136242;1.5965461087940440166;0.44873323637953477228;-0.68981656148940118101;-0.059586682378327093801;-0.77426303266274110193;0.10788067514824237203;0.29569961094787716727;-0.50567612363032465872;0.14614973151432855691;0.90879891503812149089;-0.67474577525113788035;-1.5148814410648043793;-0.23356046319588627536;-1.044716109140350957;-2.0427601824889296545;-0.80177165610599943069;-1.8737454493426712876];
LW2_1 = [-0.45724544839688063824 -0.66899217458688631233 1.7954472427963701353 -1.5661560664375659968 1.495626582622591183 -0.4747751065899601941 -1.2741085460434737886 0.39839209276147369287 0.25603488658479295337 0.088110323863465206395 1.8516702665178554899 -0.59688359347531161347 0.75945024244063519259 0.30617651983777183222 0.065961741661310288598 -0.047599494542897878568 -1.2307258570561523392 -0.06152713489636450761 -0.45759397791065054006 0.060453213121580917644;0.68366586232313686367 -1.1259475134442289423 1.2530273872925590251 0.12210722431105561214 0.27005985981369884374 -0.84997794965552753155 0.12185610547298417194 1.2348287223270391078 -1.7224344501022752496 -0.52537705446454152636 1.01992134403418655 -0.073454255627318443267 -1.1102479197287240531 0.14657777098431032381 0.70836348080418121143 -1.3405987160136598746 -1.2734954379871072927 -0.073543538225438229161 0.39728642855806300949 0.38698923506029797581;-0.40236721864502300594 -0.34608824907423690886 0.29088437815434459166 -2.1041286362754885175 -0.69716185019380061405 0.34443608805610154144 -1.4278539629139115341 0.43711029731452338831 -1.2383596988808267536 0.23711388071900910135 1.3709932636073927092 -1.30418784220060191 -0.8325613078238444098 -0.06327573624625978943 0.051475526258112316857 -0.24822676674919430528 0.87451605015044076019 -0.83156107225129738403 0.27111527478237495981 -0.1694159588691281082;1.3981579613124337502 0.42049289087219932082 0.47477265937195956003 0.21312647787891020323 0.59315753162818207755 -0.23296298317278618661 0.83690676709990319271 -0.22344746485741254216 0.54420561011460788503 -1.2075660314745848556 -0.74038991327737413428 0.16206970540996637475 0.43968324857205065559 -0.078439959063046918453 -0.5469423013516151455 -0.64533923322662833932 -1.1750561780683930202 0.98115991884591302608 -0.68529795027027418097 0.38217623134783668126;-0.58404297174342800769 0.68615968267888061138 -0.048748357133277527009 -0.53534872245547604486 -0.1565497614981593566 0.061659174627781858369 0.68369273220686210824 -0.17038878160336007328 -0.2284878194696017828 0.22429598883509321849 -0.68067140109415846805 -0.15787763947583277613 -0.66767936617187750858 0.029084996581683279782 0.26846233507751665615 -0.32365378913547998563 0.13624608066009133434 0.51364389897766593585 0.58022900051519921139 -0.21753495737450012637;1.2007700127036102788 1.0718125733975543135 -0.022535929895206033985 -0.41895715251667781098 -0.0055636968633413124222 0.53923164589631589205 1.7728927352741461476 -1.1830347238067153715 0.11049955366822808434 1.6795422787090035222 -0.41878518772886152988 -0.49798685354916405466 -1.1433439750432139448 0.36482674693997929616 -0.44127557883554174856 0.35190637169975591547 -1.1534710145559161631 1.0588515093876136319 0.77993869275347738057 0.22860270765755857925;-1.3012845973972233526 -0.5658003861095649567 0.73950896678195909839 -0.97340093560565776887 -0.51099339668302223849 -0.45048789271270867074 -0.41481385563004657957 -0.024299515375796110206 -0.72544243490441684408 -0.30114364808078875058 -0.93209027117181475486 -0.81222121769639077371 -0.49467221416371720544 0.44540163346903194341 0.096013591914637819169 -0.17356840597604383802 -0.90114439666726386946 -0.97725680971821715648 0.58313536729444426232 0.21123823210512121529;-0.37181753245661941509 -1.37204941992311924 -0.018120472476673251533 1.1906586866974693262 0.48644713049298715646 -0.17904904800624801831 0.083848391116925366506 -0.35877195878286521902 0.68067587086221936765 -0.53065893669530717069 0.35135231063977157007 -0.0094869708833075477167 0.50918353524793713571 -0.10823399348714811408 0.4323116051585377817 0.19957812264313068429 0.3344754122392427087 -1.1757447588927010251 0.62424152865089099773 -0.34641796859397577801;0.465547641655703337 -0.88181136866806419938 -0.51483753630893436259 -0.79319176610922403903 1.7631353400866793812 -0.095355020426795847333 -1.7413887594731747299 -0.25414502528639715262 0.66386194129679576559 1.3351477111107123985 1.2748860561502364241 -0.62418418825683541495 1.7166677201170907896 -0.19208341786951443897 -0.73723046283588955507 0.58722874251868328876 -0.3853174858170154149 0.43928710122782888003 -0.070738426452015029655 0.28045953473019213931;-0.55128620758921942357 -1.0059348669269385645 0.53082251849936212817 0.99969779632347655074 -0.18668805036459060198 -0.42896405735373505097 0.67358087711162895062 -0.66284895770811047555 1.0971185205748903435 0.24912599100151383569 -0.47770817242041913042 -0.37706658880135357492 0.66430758224026531522 -0.3033849966581279034 0.68516026059396939463 -0.93114441369937117621 0.18821168040168465008 -0.17048544229927045657 -0.19207640763495448244 0.095631866170616391942;0.069132114726926346959 0.95447534596816208108 0.66665470102488211257 1.4252652459564914 -0.35155167741038700902 -0.23735041945929999385 0.17280597468428116059 0.2837330945822835182 0.15369106514545799458 -0.52373578968500866804 -0.58809477343641747282 0.65668069817054619541 0.48376009656525265079 0.055209190665110229046 1.0007753178570886199 -0.82564339236260242405 -0.35845621254298121183 -0.7857124886284134746 0.74688783078305875929 -0.95904729395804533265;1.28640492843334453 0.66221844972249488404 0.08844895924494204642 -0.014650109214631487631 0.17981913189509410311 0.2456947960856973312 0.56249940188266733809 -0.048448234180845178853 -0.456108673429835354 -0.38237694583766607126 -1.1089926101912466194 -0.25671186838075238379 0.17846264281534895968 0.081921130469069083913 -0.2262895753399823684 0.32286774812816387836 -0.67446724397324075984 0.53868840312644261648 -0.38435957951669980082 0.20952318975413322666;2.0078230156346981161 1.0152736967704911741 0.68176806483858987118 0.67497871715912916013 0.0046240164319140807797 -0.91469250420850178873 -0.060266499609892776324 0.10973275244963248687 0.55192642388966162148 -1.6008951969252440684 0.28703796043265283888 0.76286634758522520183 0.3251660088334441534 -0.27914889275126564261 0.11553018784616986281 -1.0591850254123200692 -0.5021220701652530094 0.33900981236407851105 -0.21417279234661823484 -0.011424505207798007697;-0.41286026795554836566 -1.7588107840199203036 -3.1707964132225479048 -1.6570370314523747979 -1.5726603661899452025 1.8488182962643540108 1.2070372802574165227 0.32787680867660973227 0.98634732625974563813 1.2644729926471478532 0.83644715654069390354 -1.1204394026155326536 -0.53979872523543082075 -0.00072753199248709772562 0.82266762850149022235 1.910371567673603499 0.95485834466691155153 -1.2525658761348579251 -0.35587048781581320789 0.2212097367962842509;-0.096307889702354515515 2.0322496850637485899 0.31310107996985608869 0.74214843840947097853 -0.63829260810636989643 0.42064293846122075005 0.67654177930019476772 0.48326930999295425462 0.097875198864997098314 0.0014362052659369229507 -0.40736148572222768971 0.10913773995874474776 0.62801742533469551155 0.065990378602105784211 1.3322607366264882511 -0.21370355315606784363 -0.22327370433966486907 0.11339172809382722096 1.006025585854735116 0.034944058883570390528;-0.12058924298018519616 0.68244018955978180685 0.1289716090201283305 -0.34592671765668897566 0.13997284389998645993 0.61043106818149428516 0.75849269350398951239 0.11382639113205397785 -0.20818605362036621265 -0.089932851385877907169 0.59364997714283895824 0.052293451370778426535 -0.9568798758821064343 -0.13388240274549592645 -0.034589391739972344397 -0.4322536097277624445 0.069877056712021684559 -0.10420438230056466855 -0.11599728766171490957 0.17163557730019884939;-0.59059914700498661322 -1.3008148115054565253 -0.092020416972780377796 -0.35187284855451239629 -0.4310251105778008518 0.42661682442169918117 1.0688115369681066014 -0.48480082302616595014 0.65980474958102497407 0.57037363228223436629 -0.23225196100225389828 -0.1375722219521712808 0.12733710105619164277 0.16123412374913920209 -0.86801970655387161724 0.052229096683218040331 -0.35830659781285523202 -0.10680026931529805478 0.39739027055821601886 0.062296161610992724367;0.54630263844462401135 0.32456602699051478877 -0.81729936903489253108 -2.2946021941383287768 -1.0182021472640823134 1.3779307596838834549 0.42047313846881734234 -0.062097376204159976387 -0.57168617929752318929 -2.0229341353753076405 1.3507232441973699988 0.72272295711827139186 -0.061975728638443722263 -0.5008324512307106291 -1.535042049161850608 0.21876170093751892698 0.078136523414447225933 0.49783344906417997811 1.4277486408517954253 -1.9897044859785393278;-0.87135802035489196005 -0.41984659098026244628 0.014269570172169189146 0.50845299474928817851 0.15092622943309141892 -0.73265513916086322244 -0.78087806936821491099 -0.19811458872936457687 0.13793865836202356956 0.31200553658852225869 -1.2981817974734419785 -0.34076858045500835193 0.82494333472987513289 0.19836495499502121431 -0.10570397910977002986 0.28785260326708622669 -0.46914798025352655308 1.64668881479795437 -0.51106857414840634046 0.41092129291421686244;-2.2741142317994289535 -1.2448922716948132017 -0.78263556376250298374 -0.65526227723147445481 0.33721332228525563446 0.89449588213207242848 0.35133415548369167913 -0.31764733203137385242 -0.40287456424241435693 1.4528929283690990015 -0.26736229406644879125 -0.44154317943279081105 -0.48909753811662232126 0.3779759675868589186 -0.25382313941666312385 0.85612607387897832201 0.89671639533920177723 -0.32786254172918177785 -0.037745141436947599045 -0.020081677929357354129];

% Layer 3
b3 = -0.61338052026155964747;
LW3_2 = [1.0362484576552708493 -1.3840977709931669981 0.51304115255572835252 0.87142298726930034203 1.5238471415820993293 -0.50837031462623882838 -0.53449581409144220068 1.100575693706603353 -0.1143695800429901932 -0.64776459905173833231 0.64007817649876685984 -0.53143717582473604111 -0.94717460632111993846 -0.20812808732505566622 -0.75413821530584845831 -1.6441172269769117609 1.0375939303466823471 -0.28422237480923967512 -1.300072183963339123 -0.89796589017463701587];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
