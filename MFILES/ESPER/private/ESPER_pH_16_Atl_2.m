function [Y,Xf,Af] = ESPER_pH_16_Atl_2(X,~,~)
%ESPER_PH_16_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_16_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7904497282712310557;1.8976855402919139415;-3.8643203826470937656;-1.0615051142594700284;-2.4469891405635886272;-1.603338058739397054;-0.77435616398635520596;-1.7620499091152055371;-0.45041627961493357901;0.891661426765953391;-1.6779645538428928919;0.14871870709795001475;2.1505723429068495101;-0.67306901702327581738;-2.5279692820129437969;-1.2395686988007106333;-0.46710375494453904022;1.780689251917550564;-1.4374725397862209153;2.7038097586842049225];
IW1_1 = [-0.17170405593402587874 -1.2100154970917458286 -0.78883201616912979048 -0.27303800954814033686 1.9599614168859669228;-0.25451345433325323064 1.7087497889203735468 -0.62696705192722246291 -1.155149974265591295 -1.7206621996472100111;0.61591999852193646259 0.31706917353910601953 0.61006404824605064974 -4.739288716189566486 -2.1073148626758522184;1.3669025964760364023 0.68536037185034026642 -0.80279627394474406543 1.5582577223078926121 1.3851849401937383899;0.16894343232232653107 0.17897179058426110343 -1.1744171466867876497 -3.7308410098650366393 -1.1327429195495386516;1.0617559065080071079 -0.1334624873831055103 -2.7263930833093232842 1.6842058409893962967 -0.49160651452267822847;1.973081901718972464 -2.3281031829919305309 -1.2712181514818183814 1.8837327261941367862 -0.84597983129175746697;0.63722485327457545345 0.94260554647428451691 3.544054501707327276 -1.0648140950471181032 2.5402385908303677375;0.21892540417163655619 0.8545834732598597272 2.0360304424530446532 0.57429438972280799636 -0.78146056815161035747;-1.2356431381251502533 -0.2893627113734403844 -0.69322477351167943738 -0.36798156314916791176 -1.4345714654568337831;-1.2054106343555968106 -0.69090111461711845031 -1.6181796603183871142 -1.3340348874399534651 0.47822727790462227215;-1.669316747378879251 -0.73936918806305973462 1.0948661197704812054 -0.80643000482364246562 -2.35900252591736459;0.93544038294799636279 0.186616944207854768 0.20745035303294453999 0.92124441341517337989 -3.0328243701673116561;-0.061197827093240925178 -1.3139887122016700172 1.7479407418213537273 -0.13643613938445395273 -1.9172586735750412057;-1.239182106396154337 0.18464808784751257642 1.4120197968929395493 0.28233688745518703556 2.4012395047134647008;-0.52994784865982969002 0.36753266305575804651 -1.1606738570845460679 0.28658076432061985184 2.0144056745645007034;-2.1347807378645167198 -0.26155410131901979387 -0.82715640197413375923 -0.70951312341553884888 -4.3257695883577538254;0.68157669945387977517 -0.59700288085745045752 2.1064820039818448194 -1.0136297940790350847 0.34367284169295925222;-0.90187914552881554009 -1.9295346677264340052 -0.47023079639702336507 -1.3409727335209151722 -2.640319965782471634;1.0680156130741091935 -1.4870951795380897842 1.1822480409992928152 -0.53826953309407932213 1.1378923972670931253];

% Layer 2
b2 = [-1.3824602957199942921;1.4084512262304009766;-1.0380656236780521073;-0.59105095755576908534;-1.3808576414386659614;-0.65696612541352561454;-0.12792653436868706152;-0.45662881425157708648;-0.3756876125953040324;-0.030711358597038607154;-0.00087258674850549181046;-0.21639269944524033851;0.51913639097319896898;-0.66012229398299626659;0.8256481185518900201;-0.84781858501349627311;-1.0657403061294314917;1.1304995418029957222;-1.6616283052926017483;1.4480364268544108075];
LW2_1 = [0.62762408672407354882 -0.17826774324381364223 0.16177363189009782984 0.72939919992188162468 0.31993864066790084211 0.92219480314038937419 0.43120305588572321875 -0.71875523839592980746 -0.23261921932183185491 0.76021648229924865259 0.63122399395831307878 0.52715899699799362299 -0.59095371046671718585 0.094536797690709606368 -0.094283565445765118995 -0.80165143907488889408 -0.041319945357721987733 -0.50747572966359233426 -0.26224359465954355519 0.36875645549376862009;-0.29129393020293914418 0.55881635074442659317 -1.7775704907235581054 -0.25812866555653768419 -0.77797326019718993084 0.4395683155914652529 0.14453573226656457607 0.58715317060285787676 -0.68554305674497040268 -0.35733324500967850179 0.49381250909354662548 -0.81169765347427325075 0.77712508057199858325 -0.88660865233593511014 -0.4061532500266130663 -0.20722134636456596146 0.42509528983009059466 -0.18294156999106700456 -0.1733817216783136439 0.17642490881359987331;0.52821720428099572242 -0.10701239861324042535 1.8003743077343241641 0.76491474416852778262 -1.4045566322028475437 -0.34000718055448980737 0.67447169408943674629 -0.51853562149724441444 0.6603510031701208538 0.29587598088239702721 -0.032719643728964104001 0.54602397472465569184 -0.86564768881660003608 0.44153835517824657764 -0.39483312077913423899 -0.25096055085431961951 -0.036962749533096278531 -0.032272659547513404821 -0.12544881510491043275 0.077075808782288535159;0.48648167168816591754 0.27411532432592988773 0.41083521999760236332 -0.52709156837324577793 0.43174867687378482017 -0.23045432035863019915 -0.41815652081253307237 -0.30971446965083399006 -0.26313637209391210758 -0.49301097431175217034 -0.41180193674076054355 -0.030883243109795642523 0.46510326476757796188 -0.38721192475681165401 -0.66233385678853329281 -0.52012454810606389977 0.91596028039520571706 0.91944399804270471321 1.1305082971326856356 0.57598885749312578319;0.031149097584060446431 0.49063756969449878742 -1.9625889657583019954 0.3189382596025200356 -0.42221863264267667226 -0.19306831465075274812 0.40341402675358034591 -0.13923572553752225356 0.61313004898387712949 -0.47371013989418930823 -1.0201473186087739453 -0.75297436259586714158 -1.0489545747551176635 -0.0093675545367410961717 -0.07745340471541052596 -0.25385313851157609299 -0.16412937069532684831 -0.11073461523933142425 0.11039982426946258476 -0.13124668935390645941;0.63069654342740111286 0.63207040655182777922 -0.37195066477808513827 -0.13157422498390314303 1.5532729258125084204 -0.9501394837875136723 0.47699298678282625596 -0.38226010246041514096 -0.59606219332839427416 0.87233738768329327495 -0.18238782844858500432 0.022272009807209169896 -0.19512238114039098802 -0.75761136811965268389 -0.05415353810948894675 0.25460953311887613015 -0.30021667782852851092 0.81150051093448227757 0.24100984880855447212 0.15272573750024590056;0.91337915231527444515 -0.52807575764057224088 1.1245840990315050245 0.72180827247193979357 -0.34987319862218346778 -0.40005520769783725621 0.41287297902303304875 0.33103638636006643692 0.56400985567549488664 -1.3015578749258316371 0.63431864122711745235 0.98936596061442561023 -1.7431346286431785852 0.17847647307115380166 0.15708240520403521367 0.56688150972638584602 0.37068567309497291173 1.1653921407088936313 -0.067402925437421878918 0.86677598465303928865;0.20818510480738339208 -0.31922618174851019601 -0.29953458988041536948 0.24917415500532527628 -0.057231805080793458906 0.42791543660873526678 -0.3810415340874617196 -0.81157964003436444678 0.50951876355985281641 -0.4049082386020229074 -0.38152736210130611116 -0.21640379114519003867 -1.5188967007019886779 0.07753514851587449408 0.98737042817263120931 0.43301539366065699976 -0.051764892051330183009 -0.50709242997729897517 -0.70800295826994963377 -0.24139957061847044928;-0.072947404755055622605 0.5657995803308549787 0.78607228963404784938 -0.025597443415248544857 0.18276599597772202888 -1.0403360857496259939 -0.1726667935030893053 0.62401152659084602181 0.069575841138846419853 -0.46116020419368936034 -0.17137545701098896855 -0.41755544812765860163 1.1756467264521019978 0.72694802544225189944 -0.98431189158284848606 0.31036431918952656073 -0.55820490839682801454 0.51124633265212382494 0.57752535001881388776 0.41204971188828909412;-0.33759988392971052029 0.56354565809661283371 -1.6641436260178970041 0.20421205876543874203 -1.012866172421571509 0.15552288827115751113 0.58893794309293656664 0.19884384490683396085 0.3641553796462175252 -0.37363264172563431798 -0.29914706144445324387 -0.59421742970636215464 -0.25006565317576778806 0.13102401646120445666 0.076371452042116344527 0.010311444965076344699 -0.583733276375273058 0.023842767741314649377 0.27826645134155558736 -0.58311410870526947381;0.2473696039180019457 -0.46550172757490665409 1.0960242786185818709 1.2107372515478869168 0.36177580471646014759 0.60267710253541362242 0.41291949709221964504 0.52028032794260337113 0.52552530928326091075 -0.18662211139064596721 1.0418182079290294606 0.0013020018970864872393 -1.3932700152187516007 0.74794826938733227628 -0.21450863580119752805 0.1952127034856760146 -1.7780944406960270676 -0.097264727516864116219 -0.60783957105833774648 -0.21532926005033098393;-0.37657082976733224911 0.51387970370707980461 0.0073943587995678131813 -0.098560163422255347987 -1.1792148995278366463 -0.64187141646664302996 0.59889489566879550164 -0.39493524954153169659 -0.35954475012180531213 0.59423310529208583919 -1.2430458525119003621 1.0577607379959528267 0.50589165413694980877 0.79599272959341649258 -0.96854856060267147111 0.7993105900839405642 -1.4521590772128929459 -0.85978640020591057258 -0.23837159491602555317 -0.710417813189391123;0.597424255750852784 -0.4626608659641350263 -1.0648232196058797783 0.093264052587477566658 -0.75176100927526234852 0.86620326992325613613 0.4402452108210639925 1.7910862439367651877 -0.12418524336249073259 -0.082033283392389230726 -0.33415995464970549289 0.26884948461813323872 -0.52352842324389381456 -0.35916789113494090868 -0.73760499943465673844 0.094828409593109994069 0.82255544563506755029 0.14173990479378095753 1.1273213242799602352 0.44005002638492562994;-0.49918179284703362297 0.04169811130202048105 -0.45689762308615372577 0.00052825720964214464836 -0.32507728223303661297 -0.35387952380281273435 0.66696452890077084774 0.56252534298390366452 -0.27972607226324547325 -0.53473501675806112132 0.84237584296109535575 0.41795967225460861627 -0.50830774892879249105 -0.25114254325958967895 0.58453081510658966291 -0.011642927673276584621 -1.529314299679791489 -0.16552700013194598938 -0.39744935983129547896 -0.68085583702962060304;0.51150056159065315775 0.14490826543091936407 0.24760261450198181588 0.30054129114039451753 -0.43303338300512544956 0.092149955051048421106 0.63406318804304906411 1.1934935010977216763 0.31866950045576686312 1.0648921724836635239 0.7587100511722491003 0.43146182338951122315 1.0910132604409190638 0.17803675882861380586 -1.1423702441585767975 -0.72015411240107274349 -0.53325896627072078005 -0.21642903420555881233 -0.075789310113499916421 -0.05856039716743134671;-0.12728528246452983086 -0.88885162902378844763 -0.18477702164870193902 -0.33276114914151849744 0.27719052247558378932 0.012603117635420412954 -0.95361148084993430096 0.56278882977150146427 0.12282414205151223618 -0.28443645417010104959 0.61466481053568688964 -0.43205662384761861494 0.43100189111282477539 0.2013287858134634456 -0.81160776663902300943 0.68974433625205822107 1.084648672770699207 0.33371794968817997118 0.57947202815932019604 -0.28780387426728448741;0.022134408825068504351 -0.72458440786786659782 0.14574189996920178247 -0.24325698833949319089 0.68275738409337782819 0.2137670637115937633 -0.080706479182718005028 -0.055222241607806255015 -0.81536738378731077326 -0.61836599573732731194 0.78515202190025501494 -1.0836167396294429377 -0.86480997963643768678 -1.5380843143820368546 -0.015571210456590772395 0.19219946113096869622 0.053387273675022786645 -0.43349066548685410982 -1.4587842193154776371 0.40745482576669783681;0.50961422183701976518 0.0091142734569916485088 -0.29563990110950544299 0.96485771032578726558 -1.0053290189881856076 -0.34934851385371135102 0.56103003410154883568 0.33544036368772617296 1.2699831408183241965 0.038736201604051417879 0.80563937388798456674 -0.13432429507628043663 0.25251837502222823639 1.0845939403196698247 -0.33437001609709948724 0.28087029862641477163 0.1197198997615394056 0.41139983664184753831 -0.71165910737357218618 0.46220644519670245343;-0.3771146041361057577 0.30220752556476465633 -0.73623807498474280742 -0.52649839374800200265 -0.51470215664843721459 -0.31635222219735142923 0.17266328042013068256 -0.07199636291904877583 -0.24232594869569598628 0.29004252234359301221 0.10441665689272065787 -0.20565234111904426295 1.0486512627381274765 0.14134118297417155863 -0.10383406898057773171 0.27761795680109285778 -0.065488540263153594001 -0.0056471851800797313869 0.014475843887141254945 0.36522963699179539221;0.30004215877088868947 -0.53014255804790677562 0.15100648517660464343 -0.0043224584735014840581 1.1629923138960360784 -0.40545406800686956128 -0.40123056258915829053 -0.27406755494573509235 1.1178989477076923809 0.047657707785295884417 0.65651733002146450691 0.20383575263962733226 -0.19907648062670710298 -0.26965092709385640735 0.25856535317337714375 0.3478165123032226913 -0.24898345831557899821 -0.36016136871094284189 -0.20734139922158661973 -0.081397816534272776634];

% Layer 3
b3 = 0.20976244736860258366;
LW3_2 = [-1.7884602812362595525 -1.4565758517894487056 -1.2233469222719439706 1.1159502741511950763 -1.2702694551664239775 0.6102600940735305457 1.201026492374685839 1.9540259382817899425 -0.72121618164322998101 2.0022615805785952681 1.615502371532205883 -0.90595883961621170855 -0.8549472467813362675 -1.0978310143370388907 2.3210261376502034913 -0.59553692059935015024 -0.42775329118260063677 -1.4354556594503378175 1.905189190543924882 -1.0344854601331014976];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
