function [Y,Xf,Af] = ESPER_tco2_6_Atl_3(X,~,~)
%ESPER_TCO2_6_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_6_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.22639915486677126;1.4234982767703945;4.8855466189526648;-4.776487666291815;-0.13305002330647434;-3.2286552636795833;-4.7099530035287884;-2.4857660750894768;2.5225062440730905;0.36141840045042006;1.024533193481646;0.08090522944024886;-0.26150545703300376;-1.8779779755139057;-2.0498603755511686;-1.3358362423109473;-3.9598285637003285;-1.0282146802639429;3.2305982820191188;1.8628528156777788;3.2903902370214384;0.43674979906500716;0.25055547849572191;2.4566699999598542;-0.37814595438873494];
IW1_1 = [-0.68952402793895762 0.22107168348739467 1.9241737591617365 0.48919934472971394 -3.1677531263647949 -0.19066778808774792 -0.18144229544739926;-3.2193979968571997 -1.0008636541458484 1.2618545167982194 0.030674901590112703 6.5520609811626791 -0.99967095419501184 -1.454834351115263;-1.4146838322909419 0.67955141439714184 -0.34528269150553842 0.12397791225316593 -3.2300847914391166 0.35555264774205014 -0.63920265493962725;1.6494516694209951 -0.99961876742062872 -0.40048037831456484 -0.73936960584217404 3.5857785691343467 0.6315895659607873 -0.8788299711727493;0.72033498325845657 0.72503015656328518 1.3833156627116769 -0.47595832142974359 -2.0866493582168477 -0.56030482695676054 -1.0940338476811582;-0.81575317088207366 -0.76346606893503233 1.1847757674170798 0.23278006551518232 3.3126439422994185 -1.6380366701207802 0.66574881800652974;-0.42738139536198688 0.68069908591303785 -1.4372374609233673 -0.13213413073362118 4.4571083556121831 -1.0675055555322253 -0.43553733573608844;1.02994477329916 -0.10391126366960286 1.2275190326181724 -0.68906010289189512 0.41410429482801903 -0.88179987265959059 -1.2227480819258887;0.99731671351559059 -1.3243518532735759 1.1941268972733496 0.0027928715375588643 -3.0269951658480365 0.66376005814878347 0.57531815058004176;1.4746102955084395 -1.5586867773918518 1.3379230210527644 -0.6246982201707707 -1.3612816793358831 3.0490674222265195 -0.77227102124549163;-2.2590170372878844 0.93933944575698647 -1.1624629386986252 -0.545367215180253 -1.2314297660387219 -0.9386763212772008 0.95588772014183254;2.3140005838960329 0.45032555730829882 0.180208188419378 0.61126299555058006 -1.1149401654292912 -1.0882563281514133 -2.4948645985723039;-0.50161198494411796 0.4805275649448964 -0.38111114934053297 -0.52641530712960771 0.59652307269348359 -0.016692979951839573 -1.4782407892661149;-0.40123327639405471 0.9221363728066172 0.36989226448201895 -0.26297460207308554 3.4358639845042904 -1.3687506914077054 1.527548826873339;0.1392553279053465 0.78883327578299356 -0.11000838579583727 0.072167507976581668 3.6723241175939934 0.21456045821411138 -1.2725360515682069;-1.3130284428299623 2.0795743444437673 -0.073144640647813064 -0.55514907698131721 2.1035652327928132 -1.2373319017210804 -1.0982595104346593;0.79459917645917599 -0.86066851090320806 0.61458741169208664 0.50128507491591812 2.0407624844623964 -1.8531475224517289 -0.070946542931417333;-0.75537180048100117 0.98082275215147874 -0.35015723573367602 -0.79158276311926323 0.99787387395848137 -1.7850610163802287 -2.0488612840999099;-1.2496032957384882 -0.56350448698774647 0.92073440876244406 -0.15372113191671719 -3.0913720926738719 0.57406294334984154 -0.88900234316921645;2.8984841235919321 -1.098230486861558 4.9566714369271851 1.2058814608404167 4.3807229290405507 3.7142332834941607 -0.84439921010380936;-0.45033962108371201 0.30874969252173112 -0.60673412976568064 2.5514064505400351 2.279755054203445 0.83628217400639482 0.50848612202273791;0.34483798333240762 -1.1066040668656987 0.22491132684205745 -0.074289380452856865 -0.16146152330514052 0.083145414629311742 0.22837585080783418;-0.083155264065060727 -0.77666898005475205 -0.72747920437788638 -0.16898702612132369 0.2060112015439251 0.62423615912212416 -0.99878130981728719;0.86564503611086707 1.6316706928084517 0.60298261572530021 0.89331159940533122 3.0916958215765291 -1.4957429630038506 0.36804041634432344;0.99543973753497839 0.22167138270995199 0.73788293906704394 -0.15966938826836233 -0.060825211655084678 0.14411021451454817 -0.54904553606922379];

% Layer 2
b2 = [-1.2168170458193011;-0.7625277416765458;2.8416757653538949;2.0112890273081359;3.5955942286510694;0.30443119731235829;19.047343166936123;2.0836976729517023;-2.3923055956130335;3.0926572224722215;-2.8139110573747246;-10.54395063955827;-4.657135628365821;-4.054719751736175;1.3657075319448613];
LW2_1 = [-2.6340355219575384 3.9401353918525945 1.5910142653182873 0.57118724664823828 -0.41490188578871845 1.5088805136730061 -0.63086968897087148 -0.74138717776294361 1.5416497986666666 -0.9630913113559747 1.3257426602131195 0.82044793781586212 0.63562616943874273 -0.66230975448268792 -0.66017870068496343 -1.2049978463399733 -1.6120635846474984 -1.7171753252549153 -0.51442914967130171 1.5601905541831504 0.094217909366109215 1.6533396548179202 2.9741638102563241 -0.54534723497242443 -2.6594326337262943;2.0335237256393062 2.6899359056734866 0.84565202074964763 0.65919124458040945 2.4203773592156694 -0.0047287386827501096 0.90163195636130156 -0.98057938886613782 -2.0508789569069257 -0.17661889015397531 -0.76664405064669228 0.066672797880357293 -0.91830823197344791 -0.63122289179827584 -1.5183153889758139 0.5164054813085408 0.03249531978391515 1.5574405882446076 -0.18434478862431014 0.10358145729365095 2.2893357818888824 0.50179446401957206 -0.96198974531737391 1.5013765409303303 1.2181945677433126;-2.7540874368751571 1.0541545308281857 0.89335782574376021 0.16685330140633975 1.278068908552612 -0.3977076937306776 -0.017026209159302017 2.7129231581782896 -0.17059280305457644 1.8288798493898781 0.69661779125279288 0.90447016223387711 3.2751092391048426 -1.8716242778946548 -1.8278965473510174 -1.7474626908494257 1.4238720619412801 -1.6361846526945421 -4.7146210564565294 1.07649220874406 0.33778824240391619 -0.12006575654946541 -3.1820446596141205 1.1362244543469289 -7.1974279648825332;-1.5053208124595836 1.3581810414163966 1.6949445424068426 1.8629157679253032 4.3077621306664584 -0.19125704871686597 2.2853898311301379 -1.5890808477187559 1.0468305138017744 -0.3050935689078097 0.31988620066241324 0.98391042990154032 -2.2120565135031915 -0.85400254351023475 -4.0582612399829445 -0.62208836458804229 -0.71581923611011067 1.8211706038676572 0.52657432523968661 0.72872802585876695 0.77032688848744468 -2.7881738756043686 1.1381240529754766 -3.2415996513899823 1.001330376678137;-1.6919289192815223 1.3350251244787203 1.5366358318156919 -5.3878905226763258 0.45681401334343308 -0.86138621771123314 3.8134865282079504 -0.99107002777319009 4.8602967374458705 2.9016662364876784 0.21450717470331115 3.1289840831850881 -1.5789005482730025 -5.314587139003164 -4.4066739884837265 1.4083113901733695 -0.82471706417492496 1.0675215770965587 -2.5527278260800692 1.1703907373862183 -1.1452985243149818 0.98485279686217353 -0.86558897602076035 -6.4580617528112656 -0.25774661537496985;-1.1409238797811703 1.9996813899477979 1.2658320003107062 1.0200232194330183 -1.1399535801717253 2.1056640033509888 0.88852811762234385 3.7515373928771383 -0.92370294791040886 0.82578527746321484 2.3706518199282973 -0.30835449695832839 -1.219446342848896 -1.8786576181774501 -0.21286110730982483 -3.6262654771698624 -2.4408170136113814 1.1266371402460937 -1.3084798523314185 0.76883935981880214 -2.6329428114395541 1.8943736188706186 -2.3170374036629675 -0.32630432894284772 1.8592750233970168;-5.5231387136616874 -18.13292599604706 -3.062748162663302 2.5900833142799398 -0.040737059945937883 -0.39150899511392556 0.25384969103541855 -0.049483686081706627 -3.1291836544267251 0.89676945865378122 1.7021849558175113 2.111788414628557 -1.6308912035417464 -0.23808298079708862 -1.2064305247142622 0.94706025852973585 -0.62142064255616802 -0.15478997444291984 0.71949326669820424 -0.339137370997251 2.7697084575145317 -2.0701994115717239 -0.98566828532092166 -0.53621854006463798 -3.0499024431217663;-0.65875492839089123 -2.8886771709558885 0.094941880442438439 0.32844744375770674 0.025225444934387463 0.28638196889629541 -0.1576229586881622 -0.036039076586492871 -0.079942362412573229 -0.29643427445189857 -0.26501793617936908 -0.035114751492966605 -1.0066720053268663 -0.36552417700999174 -0.25690328332296475 0.2618848457814924 -0.83840653645319241 0.18040351870467802 -0.26703489322144791 -0.0071403681878448059 -0.91065307164831699 -1.1316434012397079 1.1193186853739694 -0.29241452097358961 0.26400084416542297;-6.4622963387621963 -0.48852585070856208 0.94447652143640837 -9.673546574991656 4.8333629345235725 -0.26986838460701579 -4.1419509141875697 2.8369535606564154 -2.925819951331325 2.6760733737867857 -5.2522652561226417 2.1923972100881817 1.1522029468824013 -3.2465535382626141 -3.0905786275888762 -7.8572568291825222 1.8945892389511614 -1.9787556366291568 -3.677221584912993 -0.47814038059215991 2.9596485214240866 2.3074047808167131 1.8317073721514761 -4.7335978939094074 4.8720893436818464;-5.514641591995554 0.4293389588904763 0.76121003350407812 -0.72369654990332322 0.34500131454080296 0.98140557873470746 -0.99331119492372566 -0.44513618636880581 -2.2483088459403544 1.3657805969465404 -0.66371254884801445 0.38522155078711878 0.8596343462491014 -0.10347731282559794 2.5386541961189639 -1.1656969712773115 -0.3232269462966596 -0.98787415547753354 -0.53909054344274376 -5.7141416291656881 0.43061629636049359 4.1297168299044653 -2.9096917384384904 -4.0836820822240503 -2.5682136439935759;4.3086314845850966 1.0212614817664925 0.1764108978401982 -2.1384945284418935 0.10944446126100757 -0.47279535653519361 -1.0754288283983009 0.056514605993107245 -0.51264333076739954 -0.19906382584183765 1.100580308744467 1.1619551663403378 1.7736009371488299 -0.49997099928320332 1.3652193400068333 -2.4561232196759373 0.63021897635652691 0.89147713866891087 -0.25199439856824396 0.58935785554876441 0.13140252310793069 1.1500100779638436 -0.90287841090277932 2.2324416464766492 0.048121542458570414;-2.3086752889071462 15.367057918372753 -0.90610284057004475 -0.17998237865148575 -0.69161017260998137 1.1924538396360191 -0.21931289408726967 -0.15793708818704849 -1.6192458230500768 -1.3317618472158728 -1.7584692936438848 -3.1656084260529171 3.0686973645024009 1.4714376779615301 -0.88659351007368048 -0.60459341930878452 1.5696233759019873 0.3355567884455784 1.1827079895525436 -2.2470545475304733 -1.7720015123775954 3.6713157529734421 -1.9122296543642445 1.783389138775098 -0.24614526080731575;-1.3402340695468873 -1.9856400444211404 2.2300280875161462 0.35340450308918803 1.8906715267484833 0.25063844702572668 -1.2407461888677407 -4.1182969370458817 1.401474966589261 -1.770891434282222 -0.99526423374112016 -0.23855988516519827 0.6754836321313088 -0.78894776893653051 -5.3204542825877184 2.74758091394721 0.68408576606931715 -0.36897332329922772 0.46897118863037857 -1.5290554028398211 1.1866444450383244 -1.2011537764169504 3.1758595820082443 0.34170017375839035 7.7656396089063362;5.9625099964474284 7.1884011060244877 -4.7318311752261755 5.9930058519537477 14.468460227329556 -4.6761625679365801 -3.8650304372898927 4.2155894091024875 10.712149068862061 6.5800565621523459 10.313741244576651 -0.15265604752109771 -2.8246183092013766 9.7566727121848977 -15.285532058280015 -15.102181553697713 6.0310289814014846 19.204534359374939 6.0905765150042956 0.44093710814255965 0.66550510096917592 -14.729339292395061 -11.043313456485045 17.549764307399943 0.42276040896663986;2.0034277794368123 3.107187207849174 0.38073017715997576 -0.33454164582437729 0.005597319717196847 -0.48523697615172268 -0.64975781331643578 0.022050271698305035 -0.93900638277010517 0.29128086269984077 0.20457106868228242 0.091420015408879174 1.1514737545210552 0.60120686806267032 0.52238098444476655 -0.23016357184466554 0.90915221675928137 -0.19076481165191495 0.29890772387723968 -0.055986377993229017 0.90170907858777505 2.8399465504907462 -1.5258187305281958 -3.5414802464497908 -0.45571811293218789];

% Layer 3
b3 = 0.10436579677252637;
LW3_2 = [-0.057157570864002 0.042449641290721686 0.17976875695139741 -0.037359112347450783 -0.026172319748478723 -0.028818148178480524 0.026157770714488191 -1.871559723877644 0.006432051800856005 -0.090015201823648694 -0.021860493276769637 0.07371099627485285 -0.045845617440280227 0.003417118080197346 -1.3227056329219247];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
