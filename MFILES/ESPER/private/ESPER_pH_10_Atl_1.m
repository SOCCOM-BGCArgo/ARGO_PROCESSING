function [Y,Xf,Af] = ESPER_pH_10_Atl_1(X,~,~)
%ESPER_PH_10_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_10_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.2690635508857566194;2.6248498739047074757;-0.44116106326776760582;3.152624473960509377;-0.24281007670356710704;-4.2909458096505268543;2.5562846184894763013;-0.75941669459655647412;-5.1369054742617805687;1.7842669040076253317;-0.77800600728228286318;-2.451250629677797388;-0.76228173578827829182;-1.83718061203981331;1.4635378858237966249;0.092622179489531858421;-0.58374361661107798671;-1.4057350342475998239;1.5481939781503033515;0.21663370385178232214;-0.84898411397585238358;1.9565353932864426589;0.2446262825889388981;-2.6716762034581083007;-1.5540051008339172967;-2.287470203502366406;1.4642204999744081739;-1.2388294512619264509;-6.3343447789777487245;-1.2023689994984614327;1.2460784040750159107;-0.28291183318482859832;-0.76667814820509783136;-2.02473561071058894;0.94061880221233451493;1.878852881792700158;5.099406075548451156;2.2667887752171482774;-1.764882284314450045;-3.533689804853150207];
IW1_1 = [-0.052516597438583591251 -0.97754820548551624171 0.5175711859885744337 4.3621640438910285198 -0.49307511312007706872 2.4816943092557033346 -0.29205207567984448058;-1.8895842949996080051 0.19010388556259816273 1.0590549114326759383 0.10439051590695858085 -2.5742775568137599151 0.27293300702045591999 0.20415865634868490819;0.26538357934074280342 -0.94801285955381420223 -0.7797698604211639184 -1.5632439324098461597 1.3061407080641351808 1.002220829390816359 -0.63984829484828043;-1.932067639169783746 0.86037706481301190475 1.92065828617973966 0.38417846141087019785 -3.3021136253031762031 0.66755670951016965464 -0.89939374009222960993;0.33689341066097383548 0.16894677662370458093 1.8892416495177721814 -0.063803333064934991681 1.4276139009232107213 0.46093734011114290139 -0.35535173274885212269;0.30101595313296242162 -0.60402942970581552373 -0.82274979877157539132 0.9056047408209598748 5.2827158319988427593 0.30026006807634136875 -1.4468583661575737942;0.79461387567562713485 -1.7128827835873117191 1.9281350876294227614 -0.63096424196779110627 -2.8147642807759574168 -0.10871441914587849642 0.66186327106892672845;0.72408973287883371395 0.020397970809999197567 -0.36333582432005506746 -0.18762918353687549344 0.37740902873727089073 0.13239857719849845719 -0.69968203934281036904;-0.19191074929561541262 -0.24788214961141721848 -4.1985248075685550617 0.064149595306469270328 -1.0013314412109737273 0.57999846348624661818 -1.145976976945979775;-0.19099867312363544292 0.6126166084637505449 -4.419065795106150496 0.53674595998670027175 1.3190260104894713233 0.83800173217394147152 -2.3285836589180712863;-0.026001686265801529641 2.7867625131727176147 1.0025560852558301761 -0.15379060171320754757 -0.53473976713786219861 0.40352520387687157433 -0.97708141603381715168;1.8428032951702335573 1.1690342524076893227 -0.22035707097890205874 -0.19682046267662189898 2.5750016951640017915 0.14198538338856514507 -0.0097811999565939611312;-0.83422737870267127391 -0.020463942332878574254 -2.6639038187232952914 0.14131499877468142734 0.44397835188509254811 -0.2780760147384642722 0.27871693363879435079;0.62005889132873981406 1.8823712815358135675 0.089194362186362743938 0.43985627050888242984 1.9534507738544293343 -0.76389763542909994154 -0.29192729779849041494;-2.3758323331125525968 -4.4425374398301666901 -0.89358238856757254975 -0.093622850156464432203 -1.3959471920510462262 0.23015403498662970194 0.036945101457116588661;-0.69922517368484793376 2.8477292916948573342 2.7559151803214994025 -0.9336477715921609466 1.0195552713504403286 -4.9281480583954806463 0.83317559212635794452;-1.6612484710752757344 0.70078039491811006112 -0.68976355992855464816 -1.5995916863575245781 0.24568371427606403024 0.037119970886975550695 0.21799244059006064878;-0.85293101677780569503 0.25487505327236992247 1.5457463746497597246 0.35129021955504508012 1.9664579226658396305 0.15964622345814702409 -1.2468049003951358067;-0.19589365302936720403 -0.032090082565023776706 0.1308661290591969506 -1.0423315922316842563 -2.8069612003996140537 -1.1336067410608505757 1.6657420910474334264;0.25229520963077461948 0.26805174266512288295 0.017185491739497849029 -0.19358387247667122044 0.52576999928775980386 0.41730297662616000487 -0.6226013880108345333;0.34466161118872917779 0.15309702777047515254 1.6392568484295531039 -0.04370953306751723666 2.1811709479460357208 0.62255273015625156585 -0.53191205901607818696;0.070604719393059262034 0.60590713544289964698 -4.4973257387678060581 0.27131761521379715862 1.1189201500965606506 -0.2755453618981082986 -1.7119514542191798245;-1.1247208166943793994 0.29446489701424716223 0.21732928615248511828 0.52767360587119860327 2.0580290429550980313 -0.9944172248292734162 -0.17171318467073182212;2.6436214427142119554 -0.98832445457898554508 0.88824151247901039774 2.1057592215516107714 4.0189732992356779206 0.54313706583411092144 -0.62217464675638056715;-0.034287855934057469287 1.1925252864786943796 -1.7309282183318575044 0.67028473905196983562 0.31542010333307141101 -0.23365427329570559456 -0.51152633103302225237;-0.413750962585894555 -0.28594336410522602776 1.1056225068822378432 -0.76109330399436470049 -0.4080275373449022136 -0.54759541645310405578 -1.828393110958810075;1.3055395748762794739 -2.4333539154519376879 0.41328190104650330827 -0.52537777204674018794 0.84504308785128823267 0.21095728428568910617 0.25093229666003641354;-0.24082035070583013292 0.99660012273153997242 0.66983215827568487466 1.8065197960091043949 0.90739427262132532626 -0.17808758963928664198 -0.060314018465427055027;1.3024850417381825807 -0.90165940278011136311 2.5301459367661012223 -0.47828131141305574303 0.90175145443842552595 -1.6141020917441086802 -3.0020075161853649881;-3.0789248038253442807 1.4293642969780759877 -0.07168386567768779416 -1.7666573231333819738 -5.7618861523369409028 -0.45328903825431260399 -2.8469055441845538823;0.55448594361769809602 -0.28068397896403673997 0.069881802104350410065 1.529443726430836703 -1.882992090480756886 1.02602713635419307 -1.5500248743611677593;-2.8868873128550900375 -0.21951968913438554831 -3.9891929401179311299 -0.94074941611451889933 -0.85491845936467292244 -2.5891333867295109883 -0.15857851751467991197;1.5397289243556799843 -0.93219963687071905056 -0.93591616004543798368 0.70017843152389291905 -3.4175691063161943717 -0.59107616743650426283 0.14656883515121099659;0.41141443785595455118 -2.7465571431133679603 0.087429024963366422374 0.19885834984258399238 -0.88387448238110388754 -0.24385653415723257398 -0.064111084017123010081;0.20605902001779444199 0.78546776449582367263 0.0014615629708487425618 -0.053265655504546198518 2.7067152526070716867 -0.12070564976485144426 1.0772673792090323719;0.35982733587446646961 1.1603842558588424172 -0.99022564846821836682 0.2020654902809715936 2.6846842409017281916 0.9462394232828634788 2.4840541555868269619;2.0021392031098312891 0.28723882639106979031 -1.5841178537659468262 3.3455489498995505393 1.0387451853307696492 1.3669280926346403238 -4.8948535536162891546;0.75886679860081762694 0.17178657215897286115 0.25420362353937031585 -0.51357161363004044663 0.65523174987317311935 -0.21766661259424230357 1.5932863906419731936;-0.77316756444258549763 -2.4487199942160486899 0.15131962506722684836 0.33036850577564652598 -1.2382563382590958678 -0.48728348138757832109 1.320367307518782285;-0.034929570830799762382 2.1804241967238651156 2.2924214941341634066 -0.76277092147475378248 0.60069956192979134801 -0.29764225001753713551 -1.4819401611740450342];

% Layer 2
b2 = -0.58797783116184010321;
LW2_1 = [-0.28518287605905290327 1.2357735324737590954 1.3573859148322884316 -0.66927270737231270292 -4.8568812827472891414 -0.5880263966654477592 1.7087059678065101842 3.0845424490635817705 0.56533710071159548605 -0.61046264088840240802 0.86001152605880959445 -0.87566846464392111837 -1.0325532808677755359 -0.61336357093654214623 -0.14117879726015386543 -0.043673875181868243578 -0.99218353050965779616 0.58836010976709951503 -1.4570864117263191417 -6.9049331722550801871 3.7226246730037919619 0.69466241119495231171 0.38589108951113004764 -0.42639135987089382684 2.1928989402442535805 -0.65718459011957486293 -1.173694666762394867 1.0936000264889860212 0.12114473687000971991 0.30367391214008038203 -0.74206648255783713708 -0.029273366357033519386 -1.8731607731504225089 -1.7442385226711951685 -2.0156771632078855916 -0.4387863298428755221 0.80749958864433946104 3.8838287023300708256 -1.1655365145392801995 -0.30122967468743871988];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
