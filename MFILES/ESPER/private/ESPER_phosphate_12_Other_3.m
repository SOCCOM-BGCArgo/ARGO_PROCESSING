function [Y,Xf,Af] = ESPER_phosphate_12_Other_3(X,~,~)
%ESPER_PHOSPHATE_12_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_12_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [9.3301637828092367499;8.3690131554829925165;-0.89899144165129907247;-10.129523772150506034;2.423699628527559824;-2.5911881310881761387;-0.98582985338195128211;1.6981468188691029031;0.18208316695726978196;-0.84302758978926350952;2.0929646917279920437;-0.54030494292547026625;0.95535658935368028555;0.48999682332331989665;2.6722867720723826324;0.24073871209011707406;2.0265189562296974657;-0.075602886887887868483;0.24282558974596171741;2.5801344578187541678;0.26869595668390783283;8.5880045648003946468;2.3217738230015450007;2.4209467222254579255;-7.4938465582815831922];
IW1_1 = [0.25213140556068230902 -0.073164404413727401888 0.17191932939483328679 8.6965074442784224829 0.41994161152168624218 -0.025075680602876369851;0.14153881292687667259 0.44697620895736311919 -0.22484453722834263356 4.8462345173281198285 -0.79088062268216607897 3.280561964140141118;0.7409798135170431177 -0.54518367884482898944 1.2910351614415616073 -0.54723016205759456021 0.50018982432779701686 -0.054840089661975947866;-0.34394409419016791496 -0.10993262939095865827 -1.3746462678559145942 -7.7656420381344721804 -2.4116022807791521743 -1.7174704796613025071;-1.4484809966731482245 -0.7766408751816089584 -0.82283519482695843816 -0.16583698884904862769 0.42204667484267033295 0.87494669864912888446;1.3749291351257604266 -0.74823008291406800652 -1.2513349393759631845 -0.68691239107937296371 -1.0346468597028963821 0.46525939785380904246;-0.26620133861778366713 0.9266032483153130439 -4.0966831655207984753 0.73298006480719191114 1.6038089172978085006 -1.6997992720081724904;0.13282433101944468579 -0.30291325037267419207 8.7345996601917441637 -2.1645470593602569309 -2.9521460756519499746 1.6794411660756429772;-1.3210631507598538104 -1.2330043218823012463 -1.0662193164533109169 -0.08809476415858515097 1.13431279445589972 -2.5557458340889742665;0.057470138573636836421 0.077945011406744882376 -2.3244056337532259526 1.0114573704411751187 2.4062458155223298562 0.51180284140510068358;-1.3028653479980660812 1.0031807045818972313 -0.98505053756005389598 2.8542897251485990218 -1.7398121203972372051 -0.97509561951841106087;0.67112104274640249635 -0.62117295668553451637 -1.3243829843057350892 -0.39310237170698536513 -1.2156849573214913995 0.18693100798670891916;0.15950926138403923038 -0.049223928701452465684 -0.68458184058747817424 0.23534225857204701948 -1.923101288980249457 1.0321956284159448103;0.10024466742004797815 0.080882363387305894475 -1.0608703275455713122 -0.092146934787804113398 2.2006381815013105196 -0.98768819208831448719;0.13259581627525643399 -0.05499033975351824699 -1.164064371371374973 0.22297193071359708294 -1.4430021918116255897 1.8615073198852660763;-0.33453622889545037156 0.4399146591355468372 1.1637547763759024111 0.17295109800044547455 -0.85115750592399452845 0.70319152368625892358;-0.068927047852674561135 0.96403452740647876951 2.657501141890882046 -0.16928066553617826528 -5.7797935866845877584 0.54250318776804651311;-0.22233485067166361415 -0.37205720699821370756 -1.8576287919859284514 0.76433721412806554518 0.43988957897752783976 1.3868739312747353498;-0.12311382435032487692 -0.35624477821454314519 -3.2141396857771904472 0.2428741403507787 -0.19303524158561533031 -0.87511281569828858196;2.3873535448815390581 2.1666397535779875483 3.7202041281095454828 -0.69740550117419930487 -0.79422333704815406552 -1.7663691124899270068;0.14308201048911706188 0.081425643485612139716 -0.6839575939383891745 -0.25777412709977365335 -5.6308701799279585742 -0.94176088291301662814;0.68230566774465062352 0.88785219805297721507 -0.71930049073021429251 2.7822954609226382416 0.69014550080984116143 5.1067814571791751987;-1.7540865475543527818 -1.1320185538159617256 -1.4028859868088958684 -0.14539006218887159938 0.84957486906244672475 0.57536279978316096084;1.54320861269968157 2.0911043753273612644 1.077649210550708947 -0.0610739622136038246 -4.0282204615020642535 -0.59311586239307378943;-0.026697759084571278526 0.85438483354150085436 1.6658333912938618759 -7.6717988985964202797 1.2424835287775206627 0.28074931122689072982];

% Layer 2
b2 = [-1.9240440913059779771;-2.9716802837320197561;-1.7820522627362167523;-0.73376213224007325042;5.1382670595765143062;-7.3887541399634368844;-1.6275685061159805844;-0.64624684664146092583;-3.9769069126235767619;-1.2463961884711163286;2.6553450568426968381;-2.8634075970644889964;1.0221704455018598701;5.4729956018797354389;-5.5687954881344285951];
LW2_1 = [0.23899119426333953475 0.30680806881725658508 -0.22547321693882801941 -0.5170564316315404696 1.6976019775215958063 -0.11299816457282810256 -0.78218486991256885865 0.011569471285464802413 0.41875069279354820706 -0.10799538235213670956 0.23489205515130501256 -1.2233029819414742434 3.7453869899487104433 -0.82907384162759201196 -3.4895042426474969233 -3.0550834749876729646 0.26243268452396889545 -0.20295213694613445377 -0.20062129203403700206 -0.098017348414925431488 0.62216399030393587655 0.10377990375750451024 -0.30913119011686474025 -0.23913597411852277608 0.65976579681121771959;-1.0679785744339189701 2.8361065695322902336 -2.6374476541940472529 -0.28418108832991406665 -2.0080455370917120739 -1.0004111976069502976 -0.20155709352864722983 0.07607776759609381767 0.11382727328879951867 -0.86109268637938707336 -1.6498169864981304666 -0.94172117465896121313 2.4381517654647333337 -3.2491660153112831289 -4.4616896455925294518 -1.5334546034481895127 0.33541416979207577809 -1.6155006690111826106 1.1201443431094011416 -0.25615870659037875967 1.6623381321722590087 -0.64741405692278630735 0.49798987152853735338 1.808080731747249148 0.77455963892578871821;-2.1330182034494216126 0.84592501808421483034 1.0089868338490914912 0.39881881390609502658 -5.0349475140473716195 2.277070104792394023 1.2487608518631572174 0.67117916138689748262 0.19241685717044579307 -0.48566358162738831883 0.92141484780110516351 -1.3417056609432023162 -2.464166827251002001 3.1296670842967864168 7.9328446655581617009 -3.329260070061379917 2.247098386163382866 2.0429380053821732943 -4.346986114175260596 0.13878026481509495027 -1.5187465610275006078 -0.77969830372567694443 2.9519972262823532816 -0.27647723958360281848 -1.9132324106655420604;-0.11182846536002211124 -2.4721308765647647121 0.51297750064881475485 -0.34523881750428869752 0.047294418381650799033 -0.21184365680984415525 -0.34427417414826666509 0.24747309997149116723 0.10871842784532355364 -0.050428015938004090712 0.18937498314177100833 -0.42933214819768555914 1.8736618747859727918 1.0349479199258631024 0.48384354227657694336 1.314931574536579495 0.1049704250774267239 -0.26466837630575229534 2.0194075599345153726 -0.068509806887180876855 -0.35230200431976543829 1.6357703534693757152 -0.13808036753245403472 -0.33686883739775974611 0.15502950007275936861;-0.77468890833317116673 1.6645944848530007665 1.0546356470520890092 0.33007294510715928793 -0.59877238847360658713 -0.099389139027323228359 0.59252177786577253649 -0.17770241146163578971 -0.43406835364965423718 0.18691592940048534777 0.11989168377817138733 1.0942695961425605855 -2.6455869919487766673 0.82773087323340099886 -2.4285221183112599697 3.1994691922370512849 -0.19156632615956872834 -0.052862336511739910216 0.53034594910373611398 0.035178837341271022854 -0.26451795645098857834 -0.10277949147911924488 -0.43382237996797923252 0.17239651892773061315 -0.21848489126715894826;-0.98435006449361417413 1.0120865908934086885 -0.44626350679651438647 0.13646813200061858051 5.8364938788425195781 -0.19117522463691066781 -0.020704244649631296793 -0.099029719315509329158 -0.36875350820124458417 0.8594704314631713693 0.53033348345156505754 3.4924847231489386523 -4.579045088672264896 -0.098352861558565651823 1.5655668247748735222 2.6281499450855321243 1.1588956038271880367 -3.9418420580336741565 0.24272905310252512745 1.2221808556312072636 0.43643997817819130125 -0.95471954188501195748 -3.4928905871848421327 -0.44822422290226593411 -0.8314695371510444355;-0.42176933290410068 -0.21767084152338367353 -0.53642029584038253276 -0.46106952800409889415 1.6534937016567521351 -0.63807302314449343417 -0.11610062789927876048 -0.032005312214115393121 -0.080226945723998702165 -0.92196520470157572458 -0.38432427312548222975 0.42515702476846845004 -1.4065440936328239552 0.21487676430548716122 0.10184331465601330347 0.26452755510631587033 0.037265538749594290246 -0.21555616022518664376 0.10335902600013857633 -1.1097633692681938694e-05 -0.28958287766874901692 -0.35171746281964089142 -1.2483610196259553593 0.058358165459286799603 -0.5712148030767960627;0.58286190330036924401 0.3567117571651208241 1.6207538125765112991 0.10022524184372177958 -3.9326404514113901811 1.0592470704945335935 0.66411473101335705138 0.29558701132747694507 0.0056892812170555922754 2.2338635188503563889 0.6092004988299802859 -0.73712965066056890251 1.6030605586964816744 1.0891549196245959852 3.6985637032854259409 -0.6105114536668252434 -0.0690490156702664587 -0.33591743822265035524 -1.1839804290969639933 -0.079454582019836808571 0.067066942889765640556 -0.20138090765887176059 2.9454301548920662768 -0.53189218651022751594 0.058034052460345715574;-1.5519606580000857576 -0.034246373604794835832 -1.7427132979610087116 0.43310404543103964148 -1.6104395599829881558 1.0544630736699276419 -0.27778504331621423074 -0.57826207224341319435 0.49261381665442527389 0.092905456094150795643 0.073002959429432481842 1.7535428575267901774 1.3412932569152291595 5.9951391362942336727 0.028590016085654229583 1.6496063984885438458 1.0441004508076985324 1.3628245661040898629 -1.7604022339629519234 0.090011968310218098965 -3.4386163940098346536 0.25389723966942806532 0.66671812562629673149 0.025706141643611804537 -2.9163113016188830784;0.4377749354338104637 -0.3248126360287380554 0.40219058033743265712 0.13555391711491446283 2.0004465052585227447 -0.10167596304185831657 0.34221146079930686579 0.20580739342131640357 -0.1298311493858587129 0.80223592534288235001 0.24947702739222216151 0.96536856277476756905 -2.583633323368174306 1.2295202789254320308 2.6379254027929306403 0.6320427462861125667 0.79612133968214182644 0.48469897799562866592 -0.71725410996052552104 0.3534526781861324074 -0.82981622178086911212 -0.10722424589448342758 -0.95372740589632454267 -0.44368235468201872029 -0.49509414296577874959;-0.030438599940114618309 0.32679312075640426505 0.11495491869985872968 0.59731835243791397971 -2.2417299424037873123 -0.74086815170057862545 0.30135357772595827708 0.086378611515370101737 -0.13713566280861380631 -0.88255071493477610378 -0.30195284896660112839 -1.9297915858995600136 2.3676852084356001527 -0.77227362168138991017 -2.5862233361371091966 -2.489696302117293758 -0.67322040209101563502 -0.41230574890151844292 -0.22702871869704049912 -0.024753483302433230973 -0.075231495621891880665 -0.46334297789276440716 1.3612827932415703103 0.31125648022650886926 0.31790756036707518151;-1.079564037286576017 2.0601888284365270643 0.1129656274172000513 -0.66241179593098553635 1.0984033580570509159 -0.44016689124951818846 -0.055581684677715174903 2.1822711606124962636 -0.059857349718837223052 0.99945491536516617437 0.18614702957636308778 -0.095558445398483876643 -1.2786228774815349141 -0.84880834167165730708 0.43362938489301799949 -1.5879012346917937837 0.13298708586055649206 0.01846882199377751152 -1.3934546717894407131 -0.20051107726498282324 0.2672174372401242004 -1.4464819179384391656 -0.31588453298971608252 0.18689536673362985852 0.10414340144998057713;-0.45975972332748865634 -2.1202022189100708793 -0.29717926958267298909 -0.79052429016273040308 0.12350216847638147144 0.68226389577489299221 -0.41553106538599582365 -0.11400584300283915506 0.24625635742573384612 -0.64621799276941305212 -0.16180309242572640804 -0.18411621666722505219 -0.013505616766630246933 0.62977949507760200287 -0.18406198233379447715 0.16677400595840169428 -0.26432271249379413192 -0.31931963250568895507 -0.043184887732901557078 -0.49217842825150892594 -0.2224685805421725282 0.46338767973106081977 -0.49663202891894669966 0.31521723142477980906 -0.72366629370657964415;0.20278597340860862741 4.1628625316178773375 -1.2307795132706140784 -0.68395250223767378728 0.9604323404432983935 1.2120333129246907422 -0.7694450239818334536 0.4663877256906973634 -5.1245471715520567457 1.6037584943203453403 -0.074940921980944624758 -0.23831845918036553833 0.23980901582379551829 -1.33015820335203383 -2.699491592365873327 -4.291516217222396179 0.50178606300810979501 2.1854123923448169897 -1.4513160325172058673 -0.34833633774092409574 -0.19398782797820049439 0.3462513746753475008 2.1239474236059310286 0.086584054401667054357 -1.3598424651916021233;-3.3482577866266258759 5.3109342034996585014 -2.1611610355689516716 0.37378907906984970566 -1.1198566299356300657 3.0002676497700906388 1.8540017167895559425 3.5291003835507712694 -0.60069260208309294136 -7.6221884155565113872 1.5375206876786162713 6.5214150159130701567 -3.3387575268061202571 1.3038813140246012789 3.6844564579245830949 -1.8463245599688071774 -2.816889682507670134 -0.42133596262096684182 -6.3223576760617516967 0.86893266119942269565 -1.6116526210065647007 -0.81960762107678630795 0.63104601563352547 -2.3101287132180341466 0.69309570089738470333];

% Layer 3
b3 = 0.64483184809698379514;
LW3_2 = [-0.96018488016118808126 -0.55523971432203178544 0.19486540513990319168 0.91851215467154900818 -0.97340943336827712162 -0.81765217484527341618 2.2502674106153182088 0.50812926798010449314 -0.36359958782227641549 -1.8690166395860170478 -0.99289525404144596266 1.5052062398782912744 -1.297672547167517898 0.29815396487987583241 -0.32786459338287593512];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
