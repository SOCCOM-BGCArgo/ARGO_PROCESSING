function [Y,Xf,Af] = ESPER_DIC_12_Atl_4(X,~,~)
%ESPER_DIC_12_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_12_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4594113177290128913;-2.86965903487379137;-4.468709863011689265;2.3573953248367747193;0.73011440924707193822;1.8474732765082775288;2.0271033792876265167;0.10776742770329850174;-3.2922943595818510154;0.17022543335149120658;-0.31152444092872511039;-1.8814159927780493842;-0.29685183615498256238;1.1898464421886374431;0.52363209671957644531;0.75205581932396781131;-1.6967025295477264901;-0.071114844263152107717;-0.77076584220691357618;-1.3958222053384456984;1.244859170243919344;0.76390951200761580964;-1.1296964377462241913;1.9643690509523128451;-1.5907064030476074645;2.3480742482929639614;3.236678308408701632;1.7436738620115197484;1.9479087743894152318;4.9191698928617135778];
IW1_1 = [-0.89466028782759787763 0.41339428158719532247 -0.45581745796329353748 -0.037949170440750780442 1.9924007561709424774 -1.5806647199524703762;1.5306115589171527258 0.17403030491493334808 -2.9102149742007226152 -1.5001784372603665929 -0.61706017644535582356 1.7493254393938202362;2.1453602558475508566 -1.7013120878653713586 -0.81230806833634527919 0.32656695001216284879 1.6255648735938288407 -0.29583784295173809475;0.87378205466422753656 -0.76498227749098557382 0.68694401393411996803 -1.3826117616256090592 -3.9078253159062033006 -0.48869297811274614585;-0.096811738307138947568 1.4323259584118981369 2.2396824767504015519 -1.3061754714285416235 -0.14683230600784105691 -3.1685848463284798093;-2.3995749458401340881 -0.86605361488711829487 0.38490331513965470034 1.2699412431347114616 3.5154545823982683572 0.0087453078494046758429;-2.1140004399967939896 1.1365570170800680661 -2.2944212761454827465 -0.90770056478370231279 -0.49193789437990542712 -0.55926430036884233754;0.20615373008910253816 1.4774947710547192692 -1.3133614674379607834 -0.76319667131946533623 -0.68029335886440001069 -1.2382761427317992009;1.2954985193551780132 -1.1628276587237780237 -2.7614475255697565892 1.6154488002325400053 1.3479675498188217198 0.16966611338074752413;0.29510860498864277535 0.19647974322979913642 1.2246130107376129725 1.5410255494323397141 2.5325941681731540811 1.4744461641121413553;-0.286256052640492753 0.38353879800068529926 -0.055028113933931165069 0.93508295046147138496 -0.041166584917033406665 -2.45980401521260994;1.0392938870487855585 0.21414559933757670862 2.073189689496651944 1.1253689353942533113 1.9386378507041350794 -0.45664863061792532184;0.53662530815860598477 -0.94033994744867388516 0.45110542113307378065 -1.9890093608940302428 0.69318372523394833351 2.4505295155234656512;1.8338444226431558359 1.6123381776072773786 0.30828634667324678054 1.369475715115677561 1.8906323082039009353 -1.1305055859261086137;-0.39206948341954916959 1.0343690147334791973 3.1394576931441426915 -1.8452217122189877863 -2.7325697901288794611 -0.62698170983430379088;-1.7561869303667136943 -1.629228528990126712 1.5725665151654659724 0.29785152346461657435 -0.42727724794648158646 0.72659325803316887615;-0.02206760318348961053 1.4066260488074566748 -0.95043201956361200722 -0.35704064095994519912 1.0884733204420447006 -2.5363427181321029913;0.78774180063520005124 -0.48087149357769642943 3.1208366646524527965 -1.4541678637111967731 0.59868556726985677763 2.8330832799353329321;-0.18439630605901516369 -0.36327287706563787806 0.27717031349583365341 -1.4694539512929036817 1.198916011259570702 0.63144511283997850626;-2.3386466926270021993 1.5125149540808955351 -1.3660177742679999735 -1.1028920452213069048 -0.22275640685249223361 1.4985281259744644977;2.8907031330129595581 1.605581229828017209 -0.11875855198270118818 0.31340236379229186037 1.558617854543997705 -0.95516292634724753174;-2.3066818492477234592 0.9128065065003233558 1.3457294174525940011 -0.41711623814783871378 -5.5759366796302467506 -2.6373328111708400634;-0.15367723374773031852 1.8959448391627642394 -2.7170963924525284305 0.90707500427702680845 3.7685910627307173115 -2.3086974006384726188;1.0447522319159368021 -1.2972740734695968889 1.0276204695020163538 -1.209426806597251991 0.82104054138823656661 -0.47954916667892294457;-1.3637153965339814388 2.0210059218942069137 -0.83720679719847690414 -0.35970485865011814219 1.5130782753444338429 1.4848425378509140238;2.3216464677178931808 1.3661624371777587594 1.368755186149791081 1.8750223085632085063 0.16020029322001716476 -1.4384544264362342236;3.5177130413699804201 -1.7156270727380340535 0.36576994208106539119 -0.94338257747778730966 1.0056978700928191905 1.1664925385582189943;0.7754569103019310905 0.13309456807036629256 3.3919673391534272966 -1.3619242707565435424 0.026415061401364254429 1.1585240849285545206;1.0239085076064391444 1.6187971667886322802 -0.84218871184103627492 1.4092132775338841455 1.1129849808472938033 -1.6475946783444026522;-0.22908707314349244233 0.54801729408574473279 -0.65240673804552573589 3.6507967021944600639 0.98040861198906159579 0.93485714649004969523];

% Layer 2
b2 = [2.0465540966426400971;-1.2822636483571470123;-0.92095918250302200025;-1.0086009613377606708;-0.0051459365797573760476;-0.50625025855549743437;0.79915570592703066843;0.67166291082848905702;-1.3135637741212866647;-2.5021074363004172092];
LW2_1 = [-2.1652163435729172569 -0.15998743314359079037 -0.42275609207208625362 -1.8725537248972610183 1.2649772721991654478 0.20817412193984194402 1.884223195159947517 -1.206111666029419327 1.2102348905875797147 -1.0719310847355234539 0.49490383050438524482 1.8972095324334732336 -1.1540088949112927708 0.26268628217272671499 -0.55448764810750705845 -0.30778317280255973465 -0.47370105205455276254 0.78121883880175857495 0.81825520231784709679 1.7010882719975073396 -0.12160684896344786665 -0.50645588928285334429 -0.32710145792101436024 0.63346070197742043728 -1.0545138827379885171 -0.50106616069461074048 0.57607793198426870962 -1.4333516598413991172 0.95958843774448121522 0.82424018988796832197;-0.084592765994949456476 0.51817302066603510013 0.0067578769927588338076 -0.15102246223482945764 -0.92970461631411693837 0.24751609948147118567 -0.064699002116031203991 -0.11349717934502187577 0.4341480903255973689 -0.79135127125389259639 -0.86587009244834145516 -0.22980123642264527195 0.15841327606049390719 0.06519437487860377245 -0.47731650042656315058 0.39048449489823322534 -0.1836887200509089435 0.060391815563466268169 -0.64465779744099171999 0.097202111070739449783 -0.075690285007080609914 0.32158151624744507613 0.16058039249194808185 -0.050645450996231591856 0.23725405872766636151 -0.18279052614769641938 -0.1743008314985460272 0.35116129754262992435 -0.3848795751184561631 -0.13691075515842482391;-0.092468664870455394289 -0.14815478101313200865 -0.11625098696183294722 -0.047068382360858126989 0.12640366609132200337 -0.30567803712378233127 0.24741504294243688022 2.0805211621929426968 0.048335207412730049614 0.6846713559118494663 0.59757348685201217009 -1.1853277055120434724 -0.60130095490273038905 -0.41908899218223594207 -0.39788155016415033272 0.50486208439069046872 0.54216420780640650623 1.074129498696914764 0.1265624084881800393 0.99403374031477187422 0.063123469007756574656 -0.020871671643115846662 -0.33660485505955134444 -0.40459735661721413225 0.13982098984392027363 -3.0580360479786450334 -0.39423917053404416988 0.10978508524656777068 -0.13340300493487847189 0.56099497510220319718;-0.89626086121577064336 0.1318072720364882322 -0.32744648843142909467 -0.54083542681192209312 -0.87660121444719241168 0.16391656896496684115 -1.305520979047702923 -0.075593995936489979948 -1.8555563408474913256 0.15361234953827071492 -1.0694488816944189846 -2.3163590106942733016 -0.70399180549090878412 1.3789023251108478707 -0.32971536423362607371 0.75152456958996682879 1.1200344703758318143 -2.1897049841656324176 0.4429134198851318871 -0.20142154426659819588 0.076565596002052413449 -0.22225740956222536648 -0.66183401220295268175 -0.15656512183582918518 0.1806825117747704601 0.30231112398456549961 -0.77626491202957770277 0.61135937135621964966 -0.31373835167845426364 0.56689713960826670913;1.7569543314656268507 -0.3622619623837506353 -1.3351578282553211441 1.5341719754666205411 1.4913875310629338689 -1.4872342719364330943 -0.12189012171528883222 -0.57172792991117349359 1.4131156393174992836 -0.38256931123342152734 -2.1616820392556368446 0.57326686813183291846 -1.8215835478132820224 -1.677624669948029057 -0.24387314448371294473 -0.85540164695625675595 -0.33627348006445051398 -1.8853853231807433666 2.3840271802937893497 3.4083133576060369307 0.86605136109628533259 -0.037226064012187129459 0.78819832121455735141 0.055001635783621445619 -0.3750848861892157049 0.39490012753920389343 1.2792593823434839084 0.86473453192905702647 1.0891690967981699778 -5.5647619219437611804;2.0200504827841463396 -0.29332325147612181571 1.2179828553298044369 0.031024952365538836785 -0.012196639960043413262 -3.0277473302849982062 0.04346700280516033188 0.88532086492026385027 0.35100739157739302421 -0.36766181024491106921 -0.30815443154754662558 0.63158850995817994445 -0.20206803056236374849 0.086017766489812796937 -0.069512361992098897767 -0.19987886387330169868 -1.2764678205784889542 0.666957371499024676 -0.25599090609766494975 0.62547119837342868287 0.61098851700464940073 -1.6761751042901678055 -0.2023101459442368244 -0.66393938765106697009 0.42574934717568035936 0.55021024958335651434 -0.4835666690153411218 1.1526750398220375615 -0.76803311950433961197 1.0576606927341423159;-0.42161013311402983916 -0.42437174760572971 0.6811975192444930105 -0.086884349803409699486 0.37906923139571063741 -0.17730922684948169366 -1.5043528087378179592 2.4766141382075401722 0.98102164338428843315 1.59058277513038826 -0.19687962114810952929 -0.53787467566571178779 -1.7999153684307200862 0.59233791918677181076 0.86423042364679780736 -0.41605719523548689853 -0.18888987449797073337 -0.4303043156848563866 0.77114916912312980735 -0.029800191230176961005 1.0172227186141495903 1.1826940761074924424 -2.1026712447012561036 0.0082202101069336133699 0.12509760210045717255 -0.1967621005505902354 -0.5429990492100817967 0.14129523704828655939 -0.17393308421986120038 -0.16172601074288228684;0.95002011675369613108 -0.28686817950280285583 1.2706556769225729742 -1.6372814343815662586 -0.41376495869507279313 -0.22276083944764221711 0.30039405981014227764 0.59514285792221399696 0.24444699793155438838 -0.58591285081633215359 -0.25082347420608708255 -0.42931440345576410422 -0.69194859492352134289 0.6493401807388029523 1.6220425844820061112 -0.36758682237036915952 -0.5643626960486277655 0.054454447371741994399 0.83387580848754316865 -0.855115146211017918 0.38299371546756377782 0.36927140015800691275 -0.17624194169893517281 0.072781249913159484777 -0.54856882255030703366 -2.7382562017869829241 -0.45193034269939685865 0.63976525424181285295 0.060488028830398749003 -2.2108795400555778521;1.8331237467042729161 -0.36433928952081406916 2.0468328387410856806 0.55182839531853267179 -1.8142134810100738473 -2.0314957989707025376 -1.3146402470466487244 1.3896914041396182249 -1.4953791122084048038 1.6000647678285695452 -1.0935518574100122624 -1.1884961117957713039 1.2362113694729048863 -3.6315665248970816492 1.2383035102041926034 0.93998105470697312924 0.90991446474357351448 -1.5680862915986628625 0.29602143376950573739 1.3637013454153907865 0.41784443824654038391 -0.13008454927698850923 0.64120110146944031548 -0.23240954848240805153 -1.298371538676035275 2.521989035514774713 0.21741590805684904431 2.6547573826103074701 0.81092590096396721666 -0.71443155501718313971;0.59192153181101048176 0.33040492795406251059 0.072292891059399747022 0.42465129688232006178 -0.2948328903299834991 0.39254267974086803905 -0.73593680118475690577 1.4156273922652493624 -0.061833052192069193342 0.28260141764680496435 2.0669613982452634815 -0.84900509012728875291 0.35942604425352592257 1.310437227719757125 0.054635805666435062478 0.12172000049081624362 -1.0384818918380400721 0.041708315717358966646 -0.18714001623763890092 -0.13984478796983326743 -0.22427715249946481024 -0.1109949591584683537 -0.027911428440870404699 -1.1255580734312258251 0.40891812591121129428 0.45179952286829716535 -0.18534548781137230589 0.67569325368919097574 -1.1160319495312809313 -0.23220511876927096839];

% Layer 3
b3 = 1.4162346425791936255;
LW3_2 = [-0.82402158781672618648 0.047583307857564684229 0.1553209387069922065 0.01972856744737421994 -0.35252843551757950813 2.3849974255149839486 0.018412909524833053626 -0.20411474193218789863 -0.32437368240718628121 -1.872248491906246981];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
