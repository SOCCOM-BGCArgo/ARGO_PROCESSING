function [Y,Xf,Af] = ESPER_nitrate_15_Other_2(X,~,~)
%ESPER_NITRATE_15_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_15_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.43293804682059183753;-0.29921785404841388933;-1.3804973917347980183;-11.945986828391657042;-0.82158388947389315859;4.7673927227974752796;-3.9149691949348017772;-0.36125268830034967804;-0.18415057437962806253;0.065148573010195179323;0.48926560015690867544;-0.49745753420392929689;-1.5721880972449757685;4.1366730453476385776;-1.9609820748640134358;-0.88132291969204501481;1.0067833071661436151;-2.9597794585018641911;4.1835575203443458037;-6.340514709349450051];
IW1_1 = [0.25530668176715676232 0.046814020789328406047 -1.2428049661733595599 -0.063544224858062492434 3.1026419805735154789 0.47119694610761031495;0.16545910305450389766 0.39642769753461826188 0.21579576683439397056 -0.90826790099503607046 -4.607500971972922521 0.037146587662246828565;0.7105125419571093337 1.3518261300710510131 -1.8960991111680587373 0.12334124805897862809 0.12259852568360628255 0.062906432748793372767;0.37652013339784790036 0.084900072835478027078 0.8698820913304523561 -10.262200980997803867 -2.1081288897961965034 -0.25671702141717644974;-0.20158396791528698788 0.55125378971602290168 -0.63327186446984162771 0.21913830105300272089 -3.1937263561397499778 0.42254978823744160366;-0.12794680909341965558 0.26165054100940610127 3.2650408339916046074 1.8259904724197755232 0.23854768192514924641 0.58324008156431639271;-0.22190374764976247834 -0.64291423142982961902 -0.020476353996542386027 -3.4137531856259819563 1.9939547680638747273 0.29382235796238442838;0.41600663956678030075 0.037310621681197211896 0.11078122389371261591 -0.60882360476432806351 1.3955173254388593129 -0.85987239949592475519;0.26240215655571413889 0.15669144945576016226 -1.2558597628744161412 -0.15858138654355929953 0.96956108173227828484 -0.018596468732736029517;-0.75333240539209278541 -0.15321563403469634634 -3.1463197206886390767 -1.0191102944451653212 1.5441584228820799396 -1.0457722743626471917;0.066012745863181440664 0.18414143038143254705 -0.11389965364369575296 0.5938275398007276662 2.6512682290712290545 -0.020012451178989913714;-0.067540212424752554821 -0.075310957335406547575 -0.13976312301990639897 -0.1240143570176872323 -0.26412154441391316739 -0.40460128504587261622;1.268907199810875408 -0.060958231305039307923 -1.6307080482655005316 0.57432408587652772347 -3.5972832094178763818 0.43896454259449319002;0.46201414346985875126 0.76020009808448563149 -0.13569286531785096361 2.666861942253940132 0.75208917107500117272 0.031403065951551220603;-0.12821612407917257204 -0.67654090023163393486 -1.6542970742346856383 0.042392140572130559972 0.082714818570431059008 0.32012396171987483884;-0.33576133438704991452 0.13408554037407632853 -0.65536591712874892046 -0.38811562590323561706 0.34353075376563702026 -0.99305116078901001231;1.6284873289953101239 0.048703098014844244112 -1.767977282661267191 -0.14827208626238236322 0.11184643329631847875 -0.80691777728670899261;-0.37576553112532007361 -0.83794394251418802266 0.085952720878969046669 -1.5976404034990101533 -4.3456978521619609168 1.2531106006791996599;0.21561477418949709373 0.80278616481113362902 0.46686191912826285888 3.4377015469632792311 -3.292788366982294157 -0.59272883841623513757;-1.4146173835338415881 -1.4522810458800481381 0.47082420520123396956 -4.605302323273465781 -0.95090976064479004748 -0.49061704217587970289];

% Layer 2
b2 = [-11.064414042382102465;2.20161287043477083;8.7996974889544290477;2.5730963516029179416;-6.0950746848835350988;6.6519470760000247722;9.2225953260485749041;10.062682510298479599;3.7840719252169066067;16.53050713386871351;3.5704118205469401737;-0.13972624905433356224;-8.1463015299919199208;-13.444678143006015603;-0.16949795489112390312;4.772153474356559677;-7.1499635894440718431;21.95851091220987783;-7.7119033697070094036;-0.97843501680369460161];
LW2_1 = [1.8516651028654236288 1.6589267523762976086 5.1898066128667297292 -14.081011076293025397 -1.4377106276778151006 2.3655961146329058664 -0.20634687510763619067 0.31481179639993234209 -4.5765796101835780618 -3.7555034870012251602 1.742670770992939655 2.9429252823470477551 -16.032070569052503828 -20.679458164960525579 2.7092113393051517889 2.831526958924301951 -0.70154177449625154672 -1.5507407484408943787 -2.6790624752745504367 -4.8858759097048070075;-0.61131227340674409998 -0.36047786443951806978 0.32169835226516529936 -3.3953747757060637191 -2.4129016066580084576 2.7014301386560748419 -1.8809854510457397758 1.2391849278090343311 -2.3841837121278204314 1.5679828988687942726 0.029848004588883925159 -8.5011744244433895545 -0.84200449704679325436 -17.429318575034145056 -0.44081257208873148024 2.4536546995548484951 -0.023627114985053834784 -1.9836439554295770549 -0.73206996743527907867 -3.4675845337427131376;1.8460611434399933906 0.24758582230220296805 -1.5943433575966237115 -3.1496499750998143696 3.5817961409159586594 4.348532257623448416 0.83648303278409941175 2.4214542084289210067 1.7625575359956933141 0.55078575011881514278 2.2215964144376409983 13.886541142971232432 -1.1003386993021591067 -13.806059805320323619 1.4168144665568958018 -4.1939207523323647209 -0.30384604097775086418 -0.71061626670805189132 0.99910075738848613813 -0.52496807925200861256;2.6855874361127587413 0.44784123116715762736 0.79512171221815097777 0.94018241733333107746 0.38820285971995766028 1.7814610887054653787 2.0933044834063574413 0.30760724924440829842 -3.3345072359057494893 0.17586927255410603199 0.97480150997123826695 6.0358051042436331457 -0.61236102591012409047 1.9720911300629728746 0.73995394446804729771 -0.1727106375895012258 0.72938901581075044067 0.57385195866584282065 0.12767959733356626373 0.4196764509148234179;-3.7727541888957372151 -1.5624043663768936163 -2.7924354339360619726 -7.4485067096234898187 -0.75441157418654913869 0.88268596239510144219 -8.233121285861363603 0.26413195415832785296 13.596914461568911037 -0.018068470949685846993 -0.30392818074655425509 -0.89956662181364455133 -2.7941091484481104246 -6.7294526919504935591 -6.0743107051885623093 -0.6998971014592283435 -3.1736744127348566202 2.1701239343905847079 -8.9706112564567366263 0.56434379445401494646;-6.5533238298229985475 0.43429736929250489785 -7.5882840885614912807 3.3972566208598484749 1.5590617842440721574 -7.4133946400985015757 -6.2971096967467694583 -1.7438969260185146481 22.051450039049363738 -4.5338452894870142629 2.9451881564822572912 4.5427659696009419221 -5.0176835760206310866 3.6740450382536375962 -6.6569998522590445589 -2.354801346342899393 -5.0112144542374217338 6.4693873960217649355 -3.8740618506703503598 4.892457563737045767;11.294550650976459494 2.5264091415553968645 2.0451675906797683879 3.6012029531694653706 0.3730852430541503062 0.19972719642387301575 3.8188982601098189207 -2.9923705437081569158 -8.2540156297274283048 -0.13834487906086126441 -0.33926947226151804582 14.281725680983109683 0.47857972916843449784 -4.3416621648474986728 -3.0457427170090070057 -1.4891939438536083706 0.54692002617562218703 -3.7640495780126204117 1.529023400810276101 -3.3609581414947977684;3.3558969913729432832 3.1745512652746441518 2.3033931101353868343 -9.8930944631088788555 0.56897712637193342822 4.799357051457465495 0.019313968560490259174 0.27404458554855209984 -9.6638611322493517264 0.47787386294091205308 3.8952945496787050317 0.89221678583370767068 3.6180747114636311323 -11.004695324238268128 7.8910728442459978638 3.1584713104489532398 -2.3274303953321413552 0.92663212481259360498 -1.9485621129519128392 -3.2865003175004154912;4.9069553489886095221 -1.1155479562333585619 0.86250214770563937705 -4.9252018000484119042 1.5724797812254811546 -1.912544263499584174 2.6432438326620903979 -0.004503957392166812318 -0.74882957226388868754 -1.4602500907818360965 -2.4923963909734103694 10.349626309892761 -0.034720087000081778505 -1.0265323789634415164 -1.0811801043463198368 -2.7259386940905661056 -2.0837514771762708499 -0.59509164850545992476 2.0866118188941200629 0.93515724339375205787;3.6114481793616470817 1.3435983282083763246 1.648882397033371916 9.0688397330461381074 0.098504158072243108712 2.341842170387852029 -2.9990342309370889851 0.90805596903493579486 -5.0563474684016274097 -0.55674235261046223222 0.18678058816863951641 12.270678279449292347 1.4117196380755765439 2.9499901200784117705 1.2522737073346990044 -2.1102084627639312586 -2.0485245078314218148 -0.097930090988503318283 -4.3392949033876542231 0.2828042932991930436;1.3018764407853489207 1.0804343577337840454 0.32065344259863037824 1.9218603868372121646 0.4364391778286124679 -1.4951769159854928493 1.0932673547295286287 -0.24737851152967307855 -4.0433066555102765705 0.42399931245007754788 2.5963343370930482834 3.1051782764351152366 0.97225695448278082189 5.7687094197333115275 1.2493237901005413981 1.1514771659447637919 1.2713666823414200291 0.65289126784472995002 0.099351022966386037805 1.4214992535923325345;-0.75051170091149788099 0.13333312255501658661 0.052992718963931768894 -1.839461250354342603 -1.0094512895967127086 0.58100391524913508334 -7.4736713343192819892 0.28523721216886971375 -4.0833546974615941849 1.7832799475711533788 0.41174868748528059559 -15.078249242864366408 2.1274353166037811569 -7.9906309384270688412 0.10636853815375461874 5.6416583622259217634 1.8300301193582482195 -0.14723274040397271722 -5.9543917549742593209 -1.7632044532204984577;0.36629389438162013315 -0.55986436905361891547 0.73541167945799035266 0.99547370590218764441 1.6775657051720309632 0.37064495157303278816 9.6168699276957347877 -0.9732386024730551588 0.15324870757592504167 -1.2087580026887818629 -1.3451440709401467632 2.3597151765008970159 0.0066259165239746595916 20.588470393803405045 2.8005341102193566094 -0.60732513852472025384 0.64283752298230656397 1.6531261522393820851 7.7674976570449842939 3.5439570061984366767;2.7195744215131538724 1.885986342997368892 -1.133789211102455452 1.9070941384320465595 -1.7688149237217203336 11.712555334381258731 -7.8312000356471358486 -1.4310591224753663742 -6.9511264029692547695 1.352229261914607239 2.9905660180083728505 -2.229892485608298891 0.9640891800643074383 -1.7767175682317715157 -1.7915830966029480109 3.6745783171854782267 3.4768989578630349335 -1.2557640783726731204 -5.6227801860361834585 1.5804082096685370118;0.2680260362099098348 -0.61655777992619209549 -0.035203570230779870909 -1.3879711393167579736 -0.69439425054613845845 2.8513507124367483136 5.5523428321933963048 2.5575148900475630498 7.9971000957623736838 -2.9466129690645956885 -5.2653726598766787959 -2.7452506282007060889 -1.6106926141253743445 -6.5692455718881017646 2.2564536494172768855 1.6753217998017513324 -3.3039761779140026654 -1.042019618781735435 5.4956854011823370598 -2.3147631852882804004;2.5606035853221031928 -0.0962770158941823051 1.1417162000225817842 -0.41725716307751165024 1.406925364242337384 -0.21010458922346489374 -5.425766185745386494 -0.054895921184506223101 -4.9547412972191242631 -1.7410057849115727624 -1.6284913161369349854 1.783830997279146624 1.2925615136543142647 -1.6310130763049792701 -0.81440468566506107884 3.4050190468861663007 -0.11527314391177657937 0.58718204054547973314 -1.8307634506903955884 -0.60395409650065423612;-2.3727489184746581863 2.2422734104984276549 -1.8668679771533136513 2.2204824590130840534 -2.2680025235024747765 -3.7992939598109467525 7.6649063579663794243 -1.7735514666308864751 6.5343965213509287437 -0.14649557767415122278 4.0121768734983138671 -0.015531808599964204431 0.45097385804470824233 10.038036548046802565 -1.0442454454422651633 -3.4769329804854782751 -0.96484197345326339068 1.0571888680276595451 5.4871308314275220042 0.90795954741830653401;2.3818498006730504102 -1.7466280814026218238 -0.047385353699211811562 17.281512136232510812 0.92404362860065714091 -2.3239369017227220482 1.8540101100522423661 1.0993791549795117746 -4.2350090288334731881 -0.086791754826849087934 -1.9072690156657932103 -5.5032620588000504824 0.78594043358103649055 0.044914737824269426736 -0.66210071078233490027 2.18430565478560057 0.90393632572671600567 0.14849532818251892641 -0.65165959870586931402 -1.2016074857524614572;-3.4080872320746786741 2.8563634270321291986 -2.6746356636125176998 -2.9457508872617323981 -3.3825300168901821785 -0.9030608381623327352 -3.3049694700532854519 -3.4308317346557424266 12.139924208513113157 -0.88431810505043439985 4.3975593854032739571 6.3645218877016036529 -0.59329255033085759319 8.5650558745376059733 1.9460175235937604565 -1.6471177506421217362 -1.4609024385283162495 0.0042700980822909344325 -4.5533664218297822401 3.1537357173784927866;-1.4039797912157563342 -0.78967392966141147781 0.13473545102383210903 -1.6300428130196789045 -1.8976947110327542223 -1.6739872826646158277 -1.7711533499480083265 -2.5916016407681072842 1.9909033281331542931 0.087746815573717551473 -1.1004417133156261244 -7.133436398772698972 0.88151854831777409771 -1.532121596888684989 3.4552331062074155277 1.9358135596076466722 0.4778080131815198861 0.2569268182270227352 2.0339556620390770725 -0.42651803739692872863];

% Layer 3
b3 = 1.0881573959372587979;
LW3_2 = [-0.1060975094229524851 -0.25898402619018712212 -0.11798145926250948323 0.37994215890854471374 -0.089755773281045975187 0.039077749241876680308 -0.082632496211093378613 0.12705195290002566089 0.19298237922054531368 -0.48934213013118699198 -0.64921562982077052339 0.32072141336153847657 0.17795890830284349926 0.12219196521220325458 0.29758317154169261487 -0.15630767656103519703 0.20001999982805032663 -0.4534956699013644732 -0.1769765954455766177 0.43227298826179783031];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
