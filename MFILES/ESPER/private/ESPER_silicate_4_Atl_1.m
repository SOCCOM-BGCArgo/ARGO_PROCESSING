function [Y,Xf,Af] = ESPER_silicate_4_Atl_1(X,~,~)
%ESPER_SILICATE_4_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_4_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0432273420095046212;-4.1578539622193675385;-1.4193953724534584815;2.5293752493611196819;-2.8711913670705624391;1.2953602709077487454;-2.0469262192641437537;-6.5890561315893432237;2.4292091790808183482;0.71396547431167722841;3.9103948219679014464;-1.7419833773137942678;3.0977320155323404549;1.9556097146335802428;-2.7313700648527561299;2.8409234099038127574;1.8493156047136258824;1.5926762908524272344;1.9680020623201235352;-0.043639763509092745208;1.130476049591246257;-0.41278570198247699352;-0.28658277899771111841;-3.0914966162753647616;1.339663853266326754;-1.8141643986455318061;2.5782179081850600255;-0.57101883446315959691;2.5410907683141834568;-2.0887689146044956523;2.2801606871811874733;3.5840952408846011856;-1.5108308647967065852;2.7850115512307533905;-3.447664251915944611;1.8837031990742247878;0.25842511473270263211;-2.0263673969875144465;-2.7339802910969130956;-3.326564676617650651];
IW1_1 = [-0.47208238194477286642 -0.43656158323167643109 -0.68763590294981447038 -0.10177671392755634205 0.079500315966250387212 1.6403310553993499799 0.58043709301741763795;0.1737328130971014517 1.7067495037377389266 -1.7768406884519964972 -1.2849621074005379562 0.68612203155463480364 -0.038241006889429884907 0.46800523791156783959;-0.0079049430909502362702 -0.57898401469545901499 2.9629673674388077309 2.2326046302068314198 0.0035845739947514901336 -2.870113857943468183 1.0983553107440620078;-2.3616212851366404912 -0.33657216610005691315 -1.3995628994450155513 -0.22130686502053056874 -1.2922413548444402487 0.95714973911117195993 -0.24961453323962534689;0.29235687612738109342 0.24353071645526577771 0.76105883774507820938 0.26404367628773156573 1.4070731325082843632 -2.1890073964062195522 -0.14693093733742601525;0.66449207393731779536 -0.20692445745103857369 1.6972825423868149741 2.2705576725389007287 1.1371823618638825515 -0.068291342516952055486 -0.64071263364567876408;-0.52930926069676442758 -1.5451294397126640323 -0.70405394483232575098 -0.73980343405986304095 -1.8312098769063145376 -0.43224273823167097541 -1.9541957771961746548;0.091262136619173692131 -0.13320937988242834149 -1.4954401762720355151 0.62393138052422825179 1.352625280027210497 -4.992855404550393672 0.88703435887467285692;-1.9017065274522009233 -0.65040760525408325421 3.9587711356642771854 -0.54810592988619910582 0.22280315305847947505 -0.41017004480262941879 1.5521737188556541387;-1.2235787710393286609 -1.1585788007682398248 -0.51020886241947560613 0.50273709710599701062 0.4027337582781586045 -1.0902570429583389178 0.8923358504139738967;-0.24568122892416585645 0.2501704020053746591 1.8974250957391181061 -0.86301287166361018155 2.0874579785490570139 3.8929043595743904049 -1.0457017987966366057;-0.10550232194145971187 0.22144274755039772273 -1.7569599585820905308 -0.12015760889555687774 2.0356745810242351524 0.39797086747194021505 1.0549873112560559374;-0.31458527326371737987 -0.1868650010619366808 -0.89453057836388594204 1.4562827034542511484 -2.0362873670674566107 1.8200266732672529812 -0.18636817248086395837;0.073809992131311757957 -0.67378647208578923422 -1.8314800531471175926 -1.3841724557526409178 1.7358300917387265994 1.4576931747835828457 -1.1738873947892241034;-0.21609124347005936873 1.3807375526439955582 -1.5001903645930589892 -0.99618175998702773732 0.50358599019149263842 -0.42621782768282590048 0.29972613689790056357;-1.4438203026039240218 0.55644394883997050361 -0.081936287670262716865 3.668793103266018818 -0.90214060884367619497 -3.1346065921992889436 -0.85548680442832769621;0.26314967465827998616 1.6606036111087585372 -0.46184839289741896895 -0.35441840044302230783 1.5714146635850487765 2.0696939110707757159 2.7810776588093641948;0.21467967140140706284 1.1259082913053486408 0.84477035170021663735 2.3080829029916003492 2.2024728607977563932 0.18419286056313902145 -0.053489441381074184778;0.8118119989880215881 1.1219794306208428214 -2.4946062607501571229 -0.053483073735219391343 -1.3759996247707648731 1.2022547206824889532 -3.0942198641754821153;0.44033801468391020606 0.43972991762644808578 -0.91048629078947418414 0.95659086359178902015 -2.6267125225537757416 0.52630611908308577718 0.14943827926218408719;0.46887646387617587518 2.0112408045694509795 0.084029215015023306368 -0.86562301918757611485 -0.0028279244675283657373 0.82564081017139656637 2.6502897410494563601;0.94396810400641628647 -0.99712381247439152432 0.74046920174281360971 -5.2039661034807478401 -4.3831930944765957747 -0.62838594523611712717 -2.6780296914374672745;0.20908499921161666224 1.0882717237509005326 -1.382018381615526037 1.468487234555208909 3.6020009148936797949 1.3162196259019138811 2.4141125269967123046;-1.5698998382988380573 0.62164890429252983584 -0.045370437430441688809 -0.81058179720199541318 2.2724430619888980054 -0.24366693845357409454 2.1522177200934873298;1.2067018302750509573 -0.33268870221524987629 -0.39773584189007904488 -0.70089061309010491918 -1.883304331821137545 1.421158600015956841 0.37232592825524191138;-2.1035157822394081606 -0.43568408428347843442 -2.5795103608453286981 1.0813168306078955183 1.3912331160590409862 -0.23297710825879258678 -0.48858133511924617398;1.0562711267689817163 -0.72874834219991102557 1.2253299396481582839 -0.42565539777977129399 -3.1300611922794288056 1.3999933643197834954 -0.060802944066389794098;0.10825458011910446543 -0.54962200929783089354 -2.0023236749285597824 -1.6021933473547018689 2.8295241612725763325 -0.9268824788521636826 -0.1663279091257912623;0.63466526059980066243 -0.72448685312713467788 -0.35850158220686428878 -1.1531046829797673148 -3.562455363100800021 1.3263178205743972882 -3.1744623185949119026;-0.56717474715040072653 0.020363196186958722883 -0.11796459099011881444 0.70719637329515028235 1.9110802391432391012 -1.1059017201459175883 -0.50916160978572189144;0.56884380544509349775 -0.38799082511166504972 -1.0582873004229162994 -0.24571856221124196984 2.4637069167522618329 -0.95362806197946148323 1.7034204660645084761;1.0752535000521901143 0.65006303456062752844 0.98070183896716156546 -0.39014715509730241161 -0.70424546870798021558 0.3584992246565879559 2.1842046957515472982;0.97168165674131579124 -3.5469010784411612036 -3.4895256764487116996 3.596369675941417654 -0.78387619767100624735 3.3607948877113313912 -0.69870468105124428071;0.530333742851987755 0.64395243757749465185 -1.737235554812988525 1.1472931759865088175 -1.8675960095054939814 0.14281352580242639982 -2.6300760776901253024;-0.84338099983441350282 -0.45590777721051561899 2.3453326163222296685 -0.073143052508219966179 -2.2037246070045251045 -3.0081395443395084754 3.0138359097592832825;1.3539313407011923651 -0.73938847677005070658 1.4574572456508041451 0.93003847830801322782 3.1285085747506387044 -2.0224028051521072413 2.8280619763529366573;0.37141987704408163662 0.74272721955542353456 -1.2912153512118602627 1.9723785359353058766 2.6473293095523402485 -0.45951829471510596825 -2.3109874392304332602;0.66928987769050918288 0.47485598703249420893 0.50675004108255905511 -0.018073230542928635234 -0.62464399609384568812 -1.3007821680446871593 -1.0183795246596805129;-1.5038459672859840754 0.79507524549141550541 0.49260316423302119571 -0.92309488293178132423 1.9730433346805851258 -0.90568997381922178302 -1.4023564091879612281;-1.2521661705635334094 -0.63880890579987315014 2.4399396702919005087 0.069345843090858005908 -2.5616184664307581897 -2.6902430197401625556 3.0500887565011338687];

% Layer 2
b2 = -0.092272224435738653403;
LW2_1 = [1.174916369158652385 1.9064883204675788786 -0.054656002241220295879 0.073782562381377245209 0.6697467972134174552 -0.39741778488397450086 0.16080080193367266017 2.7304896004860674807 -0.015440199034514602919 0.054535207284363312885 1.7768406825563505258 -0.36188274480987975279 -0.1425474534871519483 1.176190595615133061 -1.3461890151685638184 -0.056863795759278572273 0.089555526416748923446 0.26519649137705386677 -0.095312407999549347837 0.12383268595456736749 -0.069408957019676351119 -0.038206356209998154627 0.17328719940555353807 -0.32343310139890291133 -0.26735238033230857013 -0.13741434372670055519 -0.51082560320040004687 -0.96171205094869727237 -0.090096593341963474022 -0.84613735907747278375 0.90741143539682667107 -0.2942136649107305324 -0.021133396732992398154 0.26193836449448687498 1.8810678823244326718 0.058804739667403356507 -0.15665872321415788559 0.73888706117961677755 -0.12436496751302858477 -1.4791155284123274072];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
