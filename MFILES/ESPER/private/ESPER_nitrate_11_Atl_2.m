function [Y,Xf,Af] = ESPER_nitrate_11_Atl_2(X,~,~)
%ESPER_NITRATE_11_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [8.487483877872671556;3.4417052909040397601;5.9392236670116256292;-0.6106355131557115179;9.5398942215279554091;-4.6007351987739504295;1.408983100128120336;0.072953268619522698701;-0.79847896265162998652;-1.4054549759717214208;-2.1397106646996753021;-1.6644102768188822061;-2.306892591255221614;-0.27397471371435166976;1.1011519651003389697;-1.6755328730946943416;2.1869730437440346726;3.5519031448124103179;-4.7454074432652433302;0.41510764492883378551];
IW1_1 = [-0.21723406359392516407 -0.24773559159229616156 0.64845943519956372736 0.87293841148727790991 -2.95380149964616745 -0.35328142764599501646 5.9593179736666979096;0.23649508011598971424 -0.20094577092114151995 1.8301029416050482723 -0.48120312555420674538 -2.9504863383101693763 -1.0669364503792098109 0.0028572176750581226856;-0.1980239355041925331 0.43078600935987904075 -1.4772084187503586872 0.59832051372648731302 -0.18864659821793819394 2.6601313306828342498 4.8076096269993957577;-0.35666175262304355975 -0.38138581785450709205 -2.15698648240361468 -0.57438014161214423492 2.1288384617614055649 -1.2960408490913879476 1.6561788520871860708;-0.13649562802355041935 0.3200679462154571997 -0.16676922058074400423 11.313034059516411389 5.6952557925067539557 0.6777376456805370708 1.2929233757796874116;0.1351918248046929949 -0.35884242662273674318 1.5867748209130585479 -0.46775712080559672668 -2.368027688869128955 -0.98036322365083494734 -4.8138957237684323331;0.21359424410273858408 -0.3692993599924282444 -0.84566283299319044975 -0.28964005566037093198 -1.8270266610133469865 1.2022176779225304255 -0.44684037562039830016;0.30502952060965771164 0.071431248179833137235 -0.88832003848748908315 -0.78251072094680740321 -0.32827894512520860992 0.47401769020415546185 0.1703273271843909753;0.26364296242559864814 0.28534350341749303848 0.15610381623726474198 -0.89079228974120849838 0.41673937286061690788 1.3982533823913649851 0.65848602784369769658;2.12001932115070435 1.4263587612211776623 1.3129440854525449289 -0.64077477300462049037 -0.39509525297747022377 1.3635601751774111268 1.1238857141261822115;0.04534902530385486602 -0.28818966380248867143 0.053404542408203560522 0.94054929264421138768 6.4980979163755243633 -0.31929194991270659632 0.76418466488403025139;1.7141410824431764226 -1.5827683890768242669 -3.616603907937484319 -0.14761053640549542942 0.50407963741709327365 0.078789551397424620327 -0.90805844316026795848;0.015272112020865265258 0.039258574477768468092 -0.040634548457533246901 0.473567769263542937 3.9546101192305869176 0.050185838932678819568 -0.15738847051320958847;0.34420840527899027039 -0.19437672400511085691 -1.0155457985165248225 0.1627485970750355837 -1.2526537804543820265 0.41918509811380910701 0.27499066549517037217;-0.36634061007568702317 0.058974686614231115744 -1.23914513198991183 0.25811494691756259323 -1.3213119395034718107 -2.0698392500118996118 0.011497015158780826347;-0.26980092105433145511 1.0862995897070331086 -1.5654478573995720403 -0.031042742567905977358 -0.9901588592628672858 2.0729863186983168433 -0.991281510331676885;-1.372413400439950637 -0.72934416316177708151 0.92859771351570152831 -0.60438546271516335739 0.91605392427925802501 -0.33203148511756075401 4.9671174506006998683;0.91738154286763828882 0.44529371003088913383 1.6371119548307213609 -0.31385937172139827256 -6.3386363831955598869 1.2631975045712211525 -0.79324163785147616679;-0.19424844016294617877 -0.5375714298756913978 1.2031783452190984995 -0.33963058943132229395 5.6782996494653401598 -0.25185246071990607941 0.96013607484879825993;0.58587091683766456818 -0.38542016385264277201 1.9040859896561921349 -0.65572863762000221932 0.93972184739811859266 -1.0684590813716245972 0.21850326635351619009];

% Layer 2
b2 = [-0.45640954267079558715;3.9815651080064728973;-0.044141402558814706036;-1.9199581163825385488;1.0546011564413646511;-1.9464978012144196207;-1.8997631328761217517;-1.6464900005297657959;-1.3999482459910255194;0.4188301623660427575;-0.9589398122048148343;-2.9523496448482906551;0.87234060785908495994;-0.84057473266293114555;0.99441353402808818629;2.3567789480108576328;-0.95556421559087378892;2.8470746063427556649;2.1108392061866725342;-0.2265038655231105813];
LW2_1 = [-0.077511487969032150103 1.6116421398571016965 0.70191199881902155422 -0.64830622780521074411 0.79887095737062785439 1.2706171270938124707 -0.77365152050004948325 0.23531602058975814584 -0.20876295316484183573 -0.1731723249163371614 0.87335504861569590584 0.39954090238207123909 -1.5774342893567785406 0.36428007424678793269 -0.57949117856480647504 0.40164017261087497923 -0.00041666390605013016446 -0.49439819325271849859 -0.74645551186238290331 -1.6327642510544722043;-0.27404910659293757469 -2.5287385907845880695 0.35889473012439743194 0.86553634927984501868 1.0748994748161380119 0.44129859845885149872 -2.3930885334631244454 0.56106743879809883868 0.57784337011122022254 -0.47204885236584309682 0.32150741613341016212 -0.19364613131995880857 -0.68405316045363795396 0.37700945845807931622 1.44286144959245477 -1.4263610684669423279 0.20847770111076210919 0.75171955666762291237 -0.61602355577643852502 -1.3012992103696798818;-0.0088013747732352820563 0.45510900799361142521 0.36881661184202285675 0.14594884140087108215 0.62789354373409356214 0.53823187937832384087 -0.20006039636725828079 0.25445818413589521567 0.087799300641528660316 -0.27657240061997390157 -0.4457532493324410372 0.20344437339925328101 -0.14985022059578964604 -0.45687683256161398804 0.043982181775017011038 -0.2443979527860283274 -0.038925324049966049389 -0.32235499052355970351 -0.051220794624111234961 -0.039027602448442222371;-1.1497915905334397113 -1.3569896436219994751 -1.5453808666351547263 1.2979262377300104792 0.34316758787899148686 -1.5989496760193089298 2.6743830623533635382 -2.7684437742775114266 1.5581417829688883891 0.60424753526603824927 -1.0410019149141651607 1.0341360012327274198 0.60960821896071193393 -3.1417571443499179296 -0.17172051146606645555 -0.65216815179333664787 -0.28250300886408502565 -0.40710151324742033241 -0.30895771647087122425 -0.40662220338896509775;-1.5424333439564581472 0.14728076055427502533 -0.1479288233896652871 -0.13527697745048083977 0.8806227967919517674 1.3985869639164534295 -1.7243962212240626641 0.70706146694198901415 -0.2158490082851130254 0.38796709743875701371 -1.7859386291355976439 0.045524513733124848114 3.3562431075334209218 0.90545685424328592461 -0.65072692027297474038 -0.27444215535081828428 0.44113793425701802731 -0.52613411103167739835 -2.2358444858944985789 1.039071991306228071;1.988111402574362474 -0.052558216912967213597 -0.90424934349924068755 -3.1650728212219845226 -1.1659198657093836626 2.6802509597187520463 -0.9227069696735792359 4.3332131001105738122 -0.83566360459944200034 4.2273053686767632087 4.6884304684440420985 0.19486155948836908491 0.39504674937546346847 0.63182875056305443096 3.0470368343958522672 -1.1747598214692589469 -0.57070695143408844974 -2.0971089730413687846 -1.9173095523604399837 2.6093701874645582883;-2.6108200914374215529 1.9444568804389179562 -0.65208976381505034947 1.3159679211063415316 -1.8221772042692832017 0.22558161960707714955 -1.4611850372899215511 3.7935037789142089792 -3.024647625900745318 0.858482585168557355 3.354642300579433023 -0.46934134677788624801 -2.7978668817582299511 0.44222119904266821155 0.082160197128504808273 3.8505289998166873922 1.8701050080227645811 0.85724690984958951123 0.71095140179462901209 4.6846151960248851864;0.081270976250158402654 1.621335966486652902 -1.4685798051080904969 -3.1671788023129492373 1.1851307288724419742 -2.323492119418324009 -1.8370964604864228331 2.6860616579929579295 0.057699978640858601286 -0.24148083172540230068 0.54642409695993554575 0.3370567912119398768 -0.22704690844701153063 0.50236880190509936028 0.34003942721284891038 -0.25391384744480149926 -0.029723216144321804727 -1.8087192345450258113 0.69402333994962384089 -2.0590743935548752042;-1.2595317464314943479 -0.20387525990493524097 -0.59247050080976682018 2.4579656945423185022 2.3280732650536966055 1.6021418390392412334 -2.0501575981456876541 -2.1217814793561773357 1.4516447427939476178 1.0367709458541891632 -0.56914149851060802376 -1.1150472084317684107 -0.24856452462389100333 -1.0720470176969221221 -1.6477137188848662852 0.63064669941590156821 -1.0330829845765674424 -1.2905787541981790234 -3.0248057286891811835 2.8592119284145125491;0.79093847786568605152 3.3573208615503968844 0.29642789846474609794 0.011636583016235432092 0.34127100686346772962 0.82749180450788339947 0.50371750534574455394 -2.006192902434277503 0.75889096280012569018 0.11675199222044257974 0.057328984009034092417 -0.040101954280182677826 -1.0131723500779807878 1.9589576429929538293 0.92153577627332472488 0.35065287480449913726 -0.19204028285383772934 -0.026362674719226798781 -0.90420814393948267806 -1.718769958423199018;-1.3301659356566710724 -4.9648740278323053587 -0.065421111778835666639 -0.90335517541801413355 -0.63527809522610390047 -0.52974634587155056131 1.4550076899848092271 0.29652996145367738201 -1.8244548920374752399 -0.88980730969267241015 0.49478020266848848907 0.56034228501612093343 -0.8770886750343708238 -1.9989365057960206684 -1.7969595039494001831 -0.67543717409224746095 0.30828976937122448687 0.66098743860728226274 0.13661638830306194192 0.93136778890617555327;-1.182946472689080375 -3.791428166215496276 0.23087881169393559277 -0.76725866335984627131 -1.5102246407493047364 0.83204491627248455821 -0.21968577515185927496 -3.4511519237528447412 3.0109449826828313945 0.18019784692721649288 1.4528910742175118465 1.5461193313258791981 -1.3136568977942313374 -2.9518758351678728857 -1.0126433228131024311 -4.3440634005148979213 0.60264536340318985985 0.21630492935605311056 -0.30843849989366639575 -0.81175364126638205331;-0.83333560866732925287 0.31992987161254410333 0.16026345617181489422 0.42365948675247605548 -0.43880925704725898262 -1.1745595805679867052 0.85211355839284619318 -0.13093297194797781646 0.73080275118468229767 -0.33052007661831045437 -1.6629946192755695744 -0.38373903301001277555 0.37976057810834612516 -1.8506189559998187377 0.55752650917424817489 -1.5124069661911754281 -0.13532394505656733519 0.94837462976439879103 1.0826034106935886747 -1.8326195106148948089;0.19517201206063730656 1.2779508826557528511 -0.8945206571769389603 0.71894155014407445936 -0.44535351873355771835 -0.86040116062593352542 0.84839039207680977395 -0.19765030390184601394 0.46793825182136922214 0.16451568791693765847 0.0045539533162651801845 0.0336815609111233219 2.3541238251115279567 0.50005361601282360962 -0.38054897415375360525 -0.085847907982732077348 0.0024449768308981868065 0.11877734216712776405 0.72247276693358808419 0.16126633662790446078;0.60178706216296717901 -3.3464774619141763878 -0.45624552269397106175 0.67753435350784463331 -0.2903645377118126425 -0.94193935331221456675 0.63658868914762856139 -0.72337788506544076217 1.9832826860925922841 -0.31913812968423188599 -1.1622194959412976978 -0.12281116095356484075 0.90370018284124919994 -0.64159224494472477662 1.2104998523409222777 -0.27839443977081246295 -0.097765942423276103179 -0.33552007954299850612 0.70731752191084440451 2.9765251512186634564;-0.5873101719548099453 2.1729192334185114532 1.6843043870045384391 0.16582438156714532362 -0.32763042098741618213 0.30342850213236977064 -0.6084994671655010734 -0.0050825674102067674998 -1.9485298480542303512 0.1533186542475981351 3.4977050933441273806 -0.15192432202071551317 -6.2208525985518203782 4.02857531370454236 -0.039003009015878088717 1.8169269673131249743 -0.1192341362845577013 -0.44321653093328483575 2.1324406881417816706 1.235819591714090393;-1.1031119579457797641 2.1626625745228960085 1.1024646679102330094 0.57217077952550710052 0.30774808889543781021 1.4052537691383484297 -0.39828954739242206085 -1.6453442633348080992 1.880744908439258678 -0.39685817048386418104 0.35516827596570338388 0.38257007676646953565 1.7748036752960596463 1.605538389778657038 2.0622367217446968546 -0.62181521013760410188 0.22972988375732361632 1.7181221844297847046 0.84191068405831315236 -0.50699638123173773607;0.19807783139119400362 0.19783311936920677798 1.5221956502456315263 -1.3955265523254407611 -0.44102418215656746803 2.0075021918428288537 -0.19812757140266673561 -0.31855687131481352781 -0.67885837147464267449 -0.20807895681973306856 -0.52720729753917627836 3.0528546472984889881 -2.1477315194037496227 -1.1595607384779582638 0.81860941184185131991 -1.2374031298188925554 -0.69887822506013963508 -0.42715892458595694503 0.42753504863718228002 0.059282725743991314393;1.6392061561994524244 1.6115051563450082384 0.64334755694892697964 0.25015323677339768027 1.4639098912525523311 -0.34713127335984905741 0.086288914589161505586 4.7371352250506415515 -3.925652134737727561 -0.28177898141098262075 -1.8120669183980315786 2.4802886858141928172 2.4436365885855342306 -1.5145005510743969612 1.1818432794157711641 -0.63286952863257661672 -0.83118257128932626632 0.099798839741064127029 0.62802335488390870211 -1.4237885422618132836;-1.0926089754142163102 -1.3852761116891405546 -0.3564402056125023921 0.84942750437302227962 -1.3530027523410159684 -1.0622096075401137316 2.273395542947757697 -0.80139774633846472263 -0.40646493071370382033 0.82047585853730153893 -1.1706341621149751742 0.68322076763539685285 0.21686301347344733026 -2.0768240679391900549 -1.4872203569634627751 -0.68027364145700941478 0.020800365113472423645 -0.7030504556187840981 1.4321625364491592514 1.0770229845602914409];

% Layer 3
b3 = -0.10143624167720335927;
LW3_2 = [1.1975023392264050326 0.26594062314213040565 -1.8301650132101374702 -0.27055912026602824128 0.17566167305027707846 0.03595167082186914026 -0.16557702216946387774 0.26000561461324966928 -0.10805279434143701123 0.58930215886910719547 0.18028666785295346942 -0.79765199280725829212 0.52554587422445198097 0.79614927678618763185 0.60575523582017665181 0.15185052157912956594 1.0999944820891278674 1.1166489831750594508 -0.53091694401675659787 0.26522667069520428074];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
