function [Y,Xf,Af] = ESPER_tco2_12_Other_3(X,~,~)
%ESPER_TCO2_12_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_12_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1861956506633859;4.4925750222021961;2.8238984005627903;-2.9353162032954767;4.1941334847168061;1.7494362545839641;-2.9566147072419198;2.8399928347478851;0.21209366729865328;0.65716328226877563;1.1855577659375727;0.81248286778264012;-0.8847851217954128;-1.3895178641575268;0.11693677234378616;-1.1708031717660947;0.2692178388889519;0.90584462937861532;-2.1776372053596806;2.4252893516548273;-0.63015104413967238;1.3422403134519914;1.0646988830192818;-4.210368246406663;-17.09162726022026];
IW1_1 = [1.3665696725141503 2.1625545559760924 0.33719139421958022 -0.015583313620285977 0.45930702952052854 0.79268039368037846;-2.0597234714706181 -3.2693663073705999 -3.0437696804344947 0.19759320674304465 2.4144688686136004 1.5608817899810579;0.065890984027210872 -0.20488835958663845 -2.3181533397934855 -0.98688678253862849 -5.6637076981558589 -0.32860405936163994;0.76254091127407519 0.6164744741844177 -1.2316082592066031 -2.312175142547765 -2.9896537937521566 -2.0173549102597947;-0.052572829295225033 -0.17691656023994609 -1.5377175824168092 3.2696591331885938 0.78181104722188977 0.96011292153438266;-1.0897593773130785 -0.11254220530829988 2.2626229337655488 -0.43343465424049094 -1.3306798461652507 -0.16064478457006676;0.52527012292113495 0.72773642027907215 0.69272660852490187 0.61691283129331309 0.18244882761934822 -2.2036015962394035;-0.12712874421998549 -0.13798398223356931 0.2958934264683985 -0.062758918896430496 -1.3096232954485059 2.024384326046146;0.26368031680753667 -0.14857045688023846 -0.0081488796139736423 0.021577641393677127 1.2798766492283988 0.81053581501494509;0.12678258859957256 -0.30306967182190747 -0.81708299672635243 -0.14747561559953978 -3.9790235448149485 1.2632017272665008;-0.71466960450968642 -0.2117936128549977 1.2204769567926814 -1.0335751270048357 -2.155492426099348 2.5028140664542264;-0.61028297889745642 0.6766595161515857 0.63726705574524167 0.13716733481330831 1.357103134431817 0.4628535825187059;1.1751567077576321 0.92072970283497568 -0.81425305191511388 0.007462233744021626 0.098235462712791807 1.0358716743996508;-0.12419151818350746 -0.51803949216068512 3.4442823405062342 -1.8670316626728727 -0.94262344308553303 0.47950226892002806;-0.36046335141397934 0.11193385978530028 -1.6815079969801874 -0.36322879035690536 0.80931563452460042 -0.4121759110475573;0.016368292283782906 0.85054568250487295 -1.8700252788377969 0.045363554152240131 1.7366029287542255 -0.25679059636363316;-0.27681453619873236 -0.044502929049126956 -1.8218052586875728 1.018706494139485 1.263364527797822 0.74295822171342774;0.57109871691036451 0.7373945782123732 2.2439576432060995 0.27501589218427563 0.90217142996572208 0.76321712190368451;-2.1938881235054937 -0.21144686583714664 1.3771375755020856 -1.4887124090092916 1.1089143924698952 -0.34559524296303801;0.29363020303669801 0.71648980056491951 -4.3285392102961486 3.0391066305235754 -1.9087019804874268 -0.95600292894752537;0.60109215202116983 -0.14951288525762038 0.44051676779504101 0.052633700924154009 -1.0851984484695716 0.14364039988287411;1.0992117767064127 -0.47580180502051339 0.62302396808326677 0.04772984400640639 1.7675655134870736 -0.98623195072634162;0.68825346367894435 0.46393665423637653 1.4829953560371969 0.076368125670944864 -1.5457199610443479 0.36872607023974185;-2.3458063978659953 1.2793511532024215 2.4614983800224319 -0.77747229164179499 -0.17061642316801676 1.2135697567549146;0.17209772003619878 0.041802598226208125 1.1128781951261804 -11.163389027734759 0.96467100756781521 -5.3328122263707822];

% Layer 2
b2 = [-0.95694926063572527;5.7262310534805305;-1.9983701242943617;-0.14555047051517533;-10.155126924825165;1.1559635840432967;4.3731208937063757;2.7079641783564066;1.0295682811572997;0.50877208646198013;2.2610142134939371;-4.0984808041299239;-4.4065595586153377;-1.0548318362452824;-6.5170165049438848];
LW2_1 = [2.0120478830897244 0.036088472286162021 -0.036884685140565719 0.22592348921866587 -0.46076907371675707 -0.21142459468632391 0.92516171026289873 0.40807229180741478 -0.43290002862889176 -0.47761162128323159 -0.045795936254088308 -0.44675656865561542 -0.52242596557508203 -0.36362868855271235 -0.066523546725039281 -0.20616005230364864 0.2831230442837267 0.037925600182807682 -0.59361846081214109 0.037826883418018216 -1.1833627187338611 0.50266107645589464 0.3959947993992145 -0.17972506534541352 -0.88223761346655261;0.76070754437122179 0.64018284296398109 0.69057337268669949 0.26649430630716209 0.50718979372797912 -0.19902956333355615 2.8633880457652081 -0.725836679390644 -1.8666517763153179 1.5399260778117811 -0.16006416188256506 0.94591744306099546 0.072812947344922288 -0.5414090020355814 1.0590179208858965 -0.0095665607933713426 -0.57035141454740879 0.20136045603475924 -0.41673694206357714 -0.20095846360752556 2.8074068419202067 0.16362603758408473 -1.094601003123941 2.0312549432945599 1.0987168081888021;-3.1820149737628332 -0.59787378331512031 0.6984061510184455 -0.54556423479634031 0.99094977721125332 0.22527051875887277 -1.4161924291398764 1.5175839807360549 -1.4709516413355357 1.6685075347625484 0.113617199618006 0.56372507168609876 1.1554237390319149 -0.56546362974335818 -1.3549753773653914 0.25149696590396597 -1.3075913400156187 -0.040746374035862495 -0.43354398374144743 -0.052844885411137438 1.5602232615611984 -0.58901050516761078 -1.3914606206110034 0.3523924632618245 1.0876739858866733;-0.023487506350474134 1.1600074970074896 0.093386216945573045 0.33163552137669144 0.63943108058210318 -2.2208185999551797 2.3861283103516984 -1.1987123568882057 -2.7573756385749473 0.52557669812562835 0.72722895549253652 1.5175736423517794 -1.0693961491129109 -3.0563209793409229 -0.19178406258299341 -0.077700568997504812 0.7205661508604938 0.2327959619822812 -0.46484998674548078 -1.6092955331355792 3.2580876320712164 0.65752208646219101 0.1501171819265216 0.74549110829269061 -3.346009031553022;0.050288948872646982 -0.52811201192753621 -1.3865420828450865 -0.62718031636290483 -1.4703338802753789 3.9619347234152422 -5.9170893933852149 -1.2066650089484827 2.7838312599868482 -0.36917536686003544 -2.1709794828154814 -1.8116558854921805 -0.30075985425710783 1.5352255435655657 9.8130896241060412 -0.37013679805347294 2.3355599446594293 -4.716107204300771 0.32151703020535949 -1.0463911055350694 -3.4344598959666777 -1.9996808410934377 6.5084758082687522 -0.51180881825678615 2.8579801687250201;-1.3578311167414103 1.002901167811002 -6.7024460152013674 1.3027722616050339 1.2518955968025316 -0.83089843264205876 -3.6493779126836903 6.8867120820971692 -1.8543364122877308 0.91914442236672333 -4.8274168873226957 -1.2427696638307248 1.8280179928974931 -2.0674445141463558 1.1036797600186679 -7.1195067938905314 0.30548523926010285 5.0407919783515958 0.91038167095914579 7.311741875511732 -0.39706886774289757 5.4104626200905814 -2.561733365098056 0.9664283592927595 0.86825134698549877;1.5583017608876384 0.1060667355793887 0.77091024291170429 -0.59862965813199576 1.1430100499162672 -1.3428785095441327 4.0389677382023352 0.34425376506317618 -0.89940458314724625 -0.60059261743041525 0.41766949950865195 -2.0956177880489313 -0.50689115421744602 -1.2204129838551758 -2.8469817175069516 -0.49518615655273263 1.4996538911442412 0.1007153443023593 -0.11079604853180827 -0.54998901778274401 -3.9213733709930141 -1.678959915473127 1.086227571441639 -1.0083152069105492 -0.56021562605538811;1.2406205260194583 -0.19316671250546991 0.50502594034288073 0.41663049529887586 -0.21630551340221379 0.31760687030248186 0.75624929331403412 -1.0601328370764338 0.57075596563695064 -0.98821994047776118 0.72349864469436609 -1.8584799224763704 0.19579001653179515 2.748495727537684 -1.3153102131638665 0.21341368582762696 0.47128198962603451 1.9691131493175769 0.086497434316292796 1.1726712435945859 -2.4808228806898267 -1.6397984884467631 -1.1399528741119525 0.71459282443502392 -3.0848469073625;0.61479662870004548 -1.5201265772097747 0.072139300261172754 -0.048587554566587726 0.57500897465130907 1.5020104339967577 -1.5350427295402951 1.082580984394129 0.91093649853385339 -0.36896362261790511 0.094681301244142424 -1.6419137578513545 0.39317345611759436 -0.09157994708140009 0.63107273542498465 -0.2842422106924381 0.2778764852090051 1.8961692056989099 0.35169145842384514 -0.56490322609498511 -0.28744884812322141 -0.55905988789561556 -0.88204831333991018 0.88418403502786358 1.1003689062700819;-0.75123070316670626 0.11445767822754332 -0.086030803393371671 0.29947899468824551 -0.017182809869627155 -0.33955785304753533 2.3661953560058278 0.7187043425872548 0.23563122614539325 -0.05661487534276044 0.013044697447394589 -0.15485802106244112 0.39304333490408422 1.5174742147253066 0.49454823442810653 -0.061508074048564572 0.73616813102884582 0.61733066862001773 0.096070146294466807 0.4646534138735976 -0.064658108031933226 -0.43871105653487064 0.26204323834489707 -0.25510326393344446 -1.4700994695217828;0.04078899201390751 0.29411498779313 -0.5286359112625767 0.20388931218590681 -0.94019544758650986 -1.1920785392346707 2.3231679921894153 0.64251671526412157 -1.8868554226469074 -0.27291496992546938 0.29813614638345332 0.27592668541285881 -0.26950904944034737 -1.5740365712818041 1.0348783399000892 -0.38315897683856853 0.75529885467859326 0.7234573234494065 -0.6159991144507293 -0.63202978917424535 2.5352573531354641 0.20491985698660994 -0.14456430232379414 0.37960243169406616 -1.0353567028018456;-10.831555703186073 0.9760497582219011 0.16171045660253272 1.226235776831383 -11.350097129939799 1.3262480638571328 8.8158012131436614 -2.5369846064757846 1.6292969098741816 -1.9169949779928701 0.90293717982249777 -1.6489819794262739 -3.1368604706393279 -2.4699484662069247 5.5982809886244596 -0.12011762102557504 -1.5809641521694533 -1.7973643246832884 0.77670316008234652 -0.60011887287269239 7.981838574633624 -0.51398418760315556 -5.9925891896341232 1.2320821766194876 -1.2260845198135712;-1.3227468257627 -0.26613121438539639 -0.8237426050915444 0.47854024839714943 -1.0841445953563673 1.5691604963395569 -4.5692439929220097 -0.72058717543900763 0.83004367641650489 0.66846263499068792 -0.52057469541886892 2.0890148252498966 0.65153883238376309 1.4285534170783529 2.8940052281106858 0.46386042370418273 -1.3660411735853801 -0.27147906816310879 0.22701931304429973 0.69234233862049843 3.9707088864792506 1.517819764394293 -0.68395838851044688 0.81985521684061036 0.46418601940532106;-2.2175625843756315 -0.8810595677181553 0.12382254501395634 -0.15035852014527792 0.20779952700625651 1.2826534194181416 -2.0157042879887603 -1.426961498776407 0.1958124644747449 0.089135560675951325 -0.75600155530853552 -1.0657942893361558 1.0070930975673063 -0.66644639680862272 -2.1633860279612014 -1.0308290830529512 1.3185010217415083 -0.31518784885384388 -1.0059571809440322 -1.2622901997258473 -5.6357268303189159 -4.3017004391613636 1.5121861386661954 -0.58469861184851624 -1.419193362023184;0.36997269750509537 -0.57402665234718142 1.0950213477551891 -0.93276537912399859 0.42637736806308241 0.79946824795624305 -1.6782191042989261 -3.9653889711961869 -1.9956390570457339 0.93556489867743176 -0.82937780348480405 -1.1317033971997987 1.0650116337972486 0.73206397775179599 0.18162009709843518 -2.7794611722227507 1.0419590891714829 0.60469011773650361 -0.36665531856736916 0.53894475196207881 -5.537094975509282 3.2025078436860177 2.3651151149094658 0.19976637294169142 1.1498407394429901];

% Layer 3
b3 = 0.72589560890816784;
LW3_2 = [0.67779457606761229 -0.27776732557248401 0.18350418398845356 0.36363816877443161 0.083859003678829036 -0.4560971106409617 -1.6245928186877285 -0.22520103912359299 0.32138659696422905 0.47092016329106046 -0.62866757214513524 -0.33727824990829991 -1.7480992002205884 -0.4363661957688611 -0.33933703190158232];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
