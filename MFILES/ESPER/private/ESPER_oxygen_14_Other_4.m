function [Y,Xf,Af] = ESPER_oxygen_14_Other_4(X,~,~)
%ESPER_OXYGEN_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.67519272298828325596;-2.8486979714195648228;1.35251737742753253;1.4282426531314842411;0.10236102390845391863;-0.8909975622286199215;-1.4165747721161137118;-4.2942516601836508983;-2.6516017094787351915;1.2246334180084208487;-1.4968953927663108949;-1.2581941797539264449;-0.22377201643059893565;1.6572916573948968111;-0.31059406256307797722;2.8248506901134731173;0.1827570858541719967;2.517569659882212374;-0.012793202733625497203;-0.014817968400469245377;-0.37290865165116954261;-7.9077492871413568309;2.3161020738302924293;2.5345266412822273772;-6.5676500759257105955;2.3016022621630427558;-1.6016697052336064111;0.023974557940656591321;3.0381305168667296357;0.79546991079397011415];
IW1_1 = [-1.7062622662099944382 -0.52695436380843374558 -2.2097571155772715024 -0.64046658626998931307 -11.078634707963161077 -4.7670926128367012709;3.1288009551669033748 1.8870482336754297314 0.47700412692462446085 -0.49306695678339190758 -14.971338871294907591 -4.5884533656341766061;0.017523756112263078749 0.7018621608912887222 0.64312096968884835402 -0.14104434559015571748 1.8003431874929285428 0.35966167819142119688;-0.99091353671777815393 -0.52440968170369450796 0.48258623390424537636 0.48677877151917264831 1.3680434546884594482 0.52908283959718205303;0.17004719515491240056 -0.16466066391404435287 0.95433136753389002926 0.27711832729191027136 -1.1451750385089636275 0.51471074782443770879;0.627107812901895878 -0.35226974869332983165 3.8432842552459205443 -0.67848770149666293161 -5.9996571068594697351 -1.6637742350055069185;0.83707915946752597947 0.30277298089783555302 -1.1616677862143260924 -0.38394273461920386259 -0.42056565137378082442 -0.5327917643509628709;-0.32512913084100930616 -0.37099546435870434102 1.3614597774469812119 -4.8371645641315508257 3.8420124556527959214 -0.637382394097866678;-0.32272679560082007111 -0.12903657631099835212 0.75866735600055690281 -2.5510892424327074046 -0.87472000835003616004 -0.4654556020080976575;0.71208847336478431345 -0.1112329009518388534 0.95813959435627804595 0.0334874553283258658 0.46718633783509105895 -0.21934072443283719744;0.52405592302502224111 0.18988616479668254944 -1.7048486539994580635 -0.6698139648040530858 -1.2449272077431738914 -0.51280692002030558996;-0.93987532795817929632 0.054758853926748909946 -1.1246781748055569849 0.61199847536439000439 -1.7225307917845382732 -0.25714177510501928792;-0.17944363906298732569 -0.47352775225486692934 0.68364495234239930355 0.20486848135595275844 0.56865528803404508107 0.060512842779663414405;0.23935359133464920167 -0.63622973441222707702 -0.097159458505911358572 1.0572838993475868197 -4.4046166003884499318 -2.0732470383472785258;3.6770006895782447742 1.7389032626526377268 0.66032870852392189231 -2.9723804744594990446 1.9873100191779471402 -1.857068751793564898;0.0062504610405756102706 -0.75117682454795076108 0.103575047520832908 2.2224201920278940925 -0.75523583589591436471 -2.7205661774554794619;-0.51805014430224383126 0.21297170098762718826 0.97097813855809922412 0.67578029798322536426 4.0493817020559479403 -1.4753437473530142121;0.063075971892890353443 0.033220168872898657442 -0.92447782879109696719 2.519743267282287924 0.2884918296905629731 -0.73465762713889182223;-0.087116829993702737944 -0.28098874945037266571 0.32332828875504043831 0.22014890755038979409 -0.097328999771061810997 0.064142303244777820748;0.64695440884161770079 -0.34880054848843722315 2.5759156075700091471 0.14218522711154674143 -3.837607256349991669 0.877583757718504609;-1.2602123837865362166 0.63835218722982056683 -0.40410287718049692218 -2.1059401790142255884 4.9379380883856747175 -2.0077125154825217201;-1.393148114940078397 1.2750903683743073369 9.576399499673886595 -2.6680244289636227961 13.468336022756258075 6.882635575810385653;0.58978639516850550617 1.386933990339855427 -0.011226544298170137645 -0.19115189491875547723 1.1465307904755810409 -0.29245013405377173754;0.53725064219591722736 1.1505973530913768954 -0.30228530583833695955 -0.10274947655083793707 -0.25347014554953339882 -0.39441490965777037392;-0.3768276261169248853 3.981441874851793461 2.096068214434859911 0.49122722124323930926 28.401230365887734308 9.7414461199476711784;0.5759454402268169293 -1.0553854920213432411 0.080209158383669043602 1.6894626716297553859 -6.963743822105129766 -2.8098918768450267258;-2.145952740348704868 0.18103071175631632594 0.54749411292453664668 1.1413839991034193666 -22.458707117677530363 -2.5713637816751386822;-2.3477639396212892642 2.4445406233220592362 -3.2829837256788421129 -0.31865520199669544743 8.4170563351189091605 1.0521058871651653988;1.0406758346598283804 -1.2912080764152595869 0.30998549927419277727 3.0188799595656754526 -5.8333485937413813716 -2.1913943263783033366;3.7937021094414107303 2.4172324912227032279 4.638328065478106943 -0.72367830016141032612 0.2117475893959316624 -1.3383004484414069424];

% Layer 2
b2 = [11.628297144774291993;-19.589476556805909269;-52.650797443335463299;2.8427638972829192276;37.136824842802404589;-1.5668930497576527561;111.00921348693935897;-25.623829609888840508;-91.300615329623894922;12.249022701266239821];
LW2_1 = [-7.9773798588355520067 24.565068534879035411 -1.7506118972116087029 -26.385301911980231893 19.241073975199753932 -0.8609256841669199467 -2.3371040667406854929 -2.4973950992699651685 0.62076191834593930086 5.4682176942435658518 9.6949394098519050544 -13.585654995897815667 -12.525390646096248304 31.796383681578944902 -2.6607875797104609816 15.185765048023318613 -8.9977886370398714178 -10.440200977616894917 5.8370097653680836913 1.6383863272838563585 11.775018185003126803 11.537895473546329939 -6.1670765959983215865 14.964989448533803085 -25.727147942754871934 -11.278308475906969832 -10.40913756947796287 1.1762543374511706951 -16.461281514929414271 3.9019149114104418885;-12.580228749546540357 -21.383299848231818174 24.467712647045747332 26.665454002369056496 -34.758548162471818443 13.726975641090525926 -3.5320577253688187902 14.091706587636544157 0.90350725436090029152 18.741809247439633168 4.4444891286112122586 1.8971600228741343219 29.607959797425884574 3.9298816187644902698 15.154109816115914455 14.867630447162877516 -10.982084593640863091 -22.129408386186590008 0.19626813541578011502 4.2587953887343470427 -15.652881272970455839 -1.461377804042417683 -4.7017958143285234485 -9.8613715021026511209 -9.6645512824907946481 -7.1230767164917336842 -19.549133598770389142 18.967984214019008249 13.96877025093709257 1.4038548781656696729;-0.90124059892739039057 -18.607496573126262263 10.101435145442115626 1.2053474222619837697 3.2785401004576644191 -3.754394035050241385 -13.26102002443973582 10.862305254790161513 -5.9824696022541195006 0.33356268700010965889 6.0658700070333058108 -0.31472942319045688064 5.3986369386856063457 5.9188544967963849786 0.99732401623310096284 -2.1392633194612846737 -7.5266257364405557695 1.9023962083505063791 15.403816362972403198 -3.6763204263253799198 1.0146184560971631683 12.295063693939603411 20.424848576768599884 14.908069674576212904 1.7916564857876116079 -3.9706443954304706523 0.14380954503697007674 -2.6062753831437484031 1.9916164066826329559 1.3085523999736838885;2.277837248496751954 9.3316429224364494388 3.3494426001744090904 57.456530480180077802 -0.2870112483012554061 -17.721973772916328471 31.770433815003457312 -5.3537473956922765339 -11.131657619840638063 11.853683597490860535 22.520081664102786334 -12.452407490262388023 -10.587479374053174297 11.280314030272657888 -5.6486593205474706636 -2.1764445064410180564 -0.73147674492062031426 -17.037232419091306923 7.7128013434594455688 4.3881839340217432266 -8.2704089220991168219 0.99211312834868325972 18.867104416433743808 -1.3440487243520928828 28.26752054601564268 0.85334134657130777946 0.29463257704952100502 -22.200466560419361173 -1.4710012700378363171 6.5424019118740819323;8.3448770947553789767 -8.1874294937699279018 -5.547595235981627404 2.8446468325347042949 7.9431749318428979123 8.4439419662945649492 4.7211797874996141999 35.64217744784382802 25.628077195343266226 -14.252943511385495867 -17.572767228198198808 -4.8813598023227129374 -31.406146477627324032 3.491747620280208686 2.9594503592400491776 -12.383358921949431775 -4.6198267213037782497 17.328823535123198951 6.4420874936970715652 21.767733790048264808 -12.463700698469175165 -12.871950792597777635 -6.4503465516640892119 8.8303098525542011998 -4.2371711322539251654 6.8166160810411362547 -14.005227244498435368 0.9896486412396882093 -21.095772910160324187 2.887277087056573599;0.25419439127230353259 -0.01755159240976615978 2.9103190294573972885 0.39324410722882602309 -2.5645856731801806028 0.23499437698775405003 -0.42459810879057346966 0.12690651354009152563 0.18070891934506344567 3.2872884301518254802 1.1161482519449654749 1.050583730468139132 -4.374657995634001928 -3.4502236142789843854 -0.028508356938232937844 0.17891032920582167209 -0.31257188968216381708 0.49009895542290871084 8.7072291472618505992 0.75171246359712839968 0.068369264445014218956 -0.08152186972244628016 -2.8139692705797805239 0.86545020076318135427 -0.17308373554897379942 1.6335047450785997736 0.066052298036339732179 0.15984041952664004849 -0.32440278107789932704 -0.15029556247038247663;42.308423752797160944 48.903603167743511904 -39.917063428342274278 -27.823814642419478105 35.814636410894209462 -8.0326551219815396365 21.901839809341662857 7.8131270611073997401 -5.5914886992745369554 -32.140832619930833403 7.7782418345475088373 8.959545590964083317 20.717518526610241736 -2.7059756084947874655 -53.173934668880690424 34.472808314868402135 52.624149796854112537 16.861441871052949892 29.191328566320155602 20.907122522124300446 21.148800354206763075 10.296005443973145432 29.714929166901281832 -15.406851882839958989 -43.156353321967550585 -18.4247118416215514 10.160842299964611968 -10.746644361342308827 -7.7348997335263920405 -10.975515574096879945;-0.65457249136294626268 -0.26324116884315579279 7.6297880337095795866 -6.5122797167163897214 -5.5824951253073082924 0.21834944642590828345 -10.327228824038058974 2.6551856148926691326 -5.6837985718543997393 -3.7827100179604888908 3.6137828811483356795 -4.7300187559051565245 -5.8624581927789716218 4.0468818718192043349 -0.11548019044285258439 0.83539131031285418505 -0.93764663414109772344 -4.0435458727230866316 17.655511414684163185 -0.32892245566742928098 -0.68080961102441306387 0.31466010255193838097 -8.1021953620134823382 25.894558815099195215 0.34948660456858610113 -2.5272013952665273173 0.1295943952387872411 -0.29290122286596126377 0.24077606651255217818 0.37726581028639583071;11.064336983188775676 -2.8105802737721172768 -0.84140618516215348599 27.848117503541217843 4.2600589676060920397 6.4539592939246324121 -10.774668926248894607 -10.512923581989252142 -64.061822738620264772 53.594515411574512598 1.2838039246103014612 14.672624423689917705 -2.2877508552260334973 -30.112666152255140872 -10.221180789687991819 46.022229103948511408 -2.9131435059813646227 11.29212364576547678 21.920250221781824251 -12.936473846537351662 -14.561455432137579535 -38.490121761752462248 24.190438839817751671 -19.071151591497280009 -25.221831195532061543 -14.848223473545886009 -3.9137482482203158618 -47.225349081790156447 13.032660772745641609 -10.534229566570484593;-14.860979368752328611 15.32462029952786331 -10.513160033591233855 -8.9157749663838909981 -8.5725500467447126596 -9.8773456710519056401 -2.0360207311593163659 -9.4294756119951177453 27.534154549193289085 -55.409477036990139709 -9.7511392640209297866 -7.8308821875744651919 14.310722718178281454 34.413584720594784017 26.849367427849948342 -25.722099835097900211 -11.020872699907526382 -25.525789709546291562 7.2498772914702120929 -11.80259755171428715 12.179667552444019663 14.496481323465458146 12.376774132557812891 15.33565319150364914 4.3648430971526570588 -5.5064969958915810366 6.8945304984362270062 0.93574161264622579548 23.660944513441069859 -10.143478187386371303];

% Layer 3
b3 = -0.3038444842781943267;
LW3_2 = [0.010950654516561877244 -0.01297677666021447053 -0.032999968628946461935 0.020931942390315740055 0.011808799833178231301 -0.68104095725923985416 -0.0025496395849284214825 -0.24653870709712824572 -0.010398843263008005627 0.023535106160678675308];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
