function [Y,Xf,Af] = ESPER_oxygen_2_Atl_4(X,~,~)
%ESPER_OXYGEN_2_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8172727923416034379;-28.736508920165938719;2.6932132791479310718;4.28254072947196196;2.4897224246138018877;-3.4148725080426101108;1.0626701993221512321;4.6137109577798591786;-12.795157725056560238;6.2340510472544181653;0.15145062877367537757;0.96198077234442946892;9.0596950637644777515;-0.62979397178013873937;2.8221284110369015963;5.9267580128164141229;-2.1393010930154785498;1.6038668206208250844;-0.82818325696235206568;2.5498157904529397122;-1.321282956100185757;0.86722901796866735946;-4.1132330064584650131;1.6741218454175590402;0.5403545785594378037;3.5353831077444937137;1.0641874419003474195;3.3710159334004132781;4.5334791246690313571;-0.9242290285072964906];
IW1_1 = [-0.18059299889296939745 -0.71421109962266149385 0.40946791826395390057 0.93238831176430114756 -3.5910924030999802348 -2.1624466797318615541 0.68539665559514317827 0.018680903623268619446;0.46132714238623906411 0.1853943794756288399 0.010236641956135217324 -24.773653916744866166 1.5342475489620566176 1.3198741066558181689 -0.61973825377487679056 -1.3438127179455308102;0.48607356813127045037 -0.30827069925129108041 -0.992383178283190448 -0.42251688744941795495 -2.1152730303904383469 0.53926876601259166044 0.25649639264953300044 0.78291298189272140462;-0.38924629749751810115 5.1990889890836058385 0.20835354833079403059 1.9621379195178318966 6.6577626655449488879 -2.4906398627761161535 -0.73722106460114311677 3.4592429102167083776;0.060088081323885295104 -0.13453754230083703192 0.12166358431986602773 0.35667540090909100048 -1.6308086027363235537 -0.49572567069966627651 -0.82207706681278713834 0.016065069386984008604;1.6083916963490429985 2.9647478268414269031 -0.34843053870716045317 -0.22840760818964078727 -1.2436859358614971161 -3.4453594794142148316 -1.1109461764964037034 -1.3552087880302581269;0.15717326225655534055 0.77487882211376524211 -0.57187350762173583263 1.579034616678896441 0.97611491464169197751 1.0509979654555281492 0.60373351586516710299 -1.3168570514412722972;1.7294439740699270036 -1.563160716954476781 1.1250843815387590041 -1.091127328671275043 -6.3718907549808507795 0.83068997615308770577 0.7729327507926812002 0.5805364679378961501;1.5651134921018703405 -4.2218864856446005618 -2.1071324212797248876 -6.4880006374009795422 0.12418099543623885295 -5.417991361299574038 -0.88480237965728314453 0.70059912530998702529;-0.32623925145967247463 -0.48099124177307700512 -2.84452047472924896 0.61182868851468297233 1.7823877537355070633 4.6808829664794791015 1.0059224412708269725 1.5776910347045269845;0.19217495224488678751 1.0934924122924201129 -1.0085614829784743662 -0.52372522060133097632 -1.535713151708880897 0.57896261585808128647 -0.72582416932216087258 -0.25211925158638004429;-2.1032832231807483403 4.4940684930810466113 0.59899345415011429061 1.5945656806392181082 1.4723154687225272763 1.3229755435799117613 -7.3382662359146637598 6.3220084114865029434;1.1461429854924785054 -1.6149302667217533269 4.7862520721967634074 4.5233698670673154751 -7.8218739096733056471 5.0916266588116991798 4.3198675289758332596 -3.4149227429837547554;-0.14871030072836421976 0.9314282432103493381 -1.0069476757401429889 -0.99479486328018151831 -0.45824618313241438639 0.1362657185348472022 -0.62852451942748643887 0.15112532406063688972;-0.23727581788498111615 0.1877374915180722581 -0.36381516187543511132 -2.2604227028806285205 -5.3079139183175820804 0.75667835713603714964 -1.2817590923928730007 1.3885553591824528752;1.1587861182896181944 -2.227792194153413341 -1.7980850648915207568 0.53135512555783603883 -5.5148816549520747188 -0.13918867350575400699 0.54114113573872935081 4.4126297544940538131;0.21121808958929108591 -1.9885892914676694954 1.7967016300210718605 -1.5014240949641546319 -0.97490980894795875589 1.2833422443667439339 -0.041304923504481665109 0.66627080409824168683;-0.26224922032881886613 0.64748234208906374487 -1.1945669651588048943 -2.7136980005444777397 -3.0831540997165314266 0.34948634212236207031 0.061756612495062049306 1.0275899633826304225;0.056028406494147989236 -0.13653364303043208361 -0.4437993441295596253 -1.0454577060290546342 -1.8523585647797575771 -0.10581881239415949492 -1.1502114601927684312 -0.23040723076788821588;0.047080749206767379123 0.56929849916635855145 -0.52857785184855621274 1.5105428054431404572 -0.96888366070773135341 0.14849824752354351398 0.46624668727169615856 0.22362827545637953275;-0.25551987606329201741 0.32851535113380714304 0.16409681385011382071 0.81564672200278121039 3.3152420089844381046 -1.3595319812811368365 0.67073142385398720755 0.61374926119489181531;-0.072997727763893890951 0.19469706848666107346 -0.12419807001302592131 0.2400473012193614919 -2.2804595114982966209 -1.3138269169046485896 0.25642852467821020124 -0.60721352417505269905;-0.41551469617751551899 0.57653942207276875909 2.2836597320554896662 -0.061785076262969536309 0.75352368149477755299 -0.67161455524037039222 -0.05619398953172525385 -2.9082168410161957084;0.0069843835098709877024 0.33582060989632311898 -0.33402239497047292449 1.033332315366306986 -0.45985910841397853455 -0.75343670412728214192 0.40554810315165767953 0.30160866188759766215;0.2042874388246330164 0.52341227859972050407 -0.5504845180471232835 1.7968723790783558414 0.68651250278077646794 0.37051144706862243483 0.42989082812299300729 -1.4112168609598452207;-0.12929845188763686159 -0.048498867081415708569 -0.097966665641923467156 -3.2930545180547019513 -7.5790795976762908026 -0.33184045450622107198 -2.0243612048436845363 2.7936830248413171418;-0.082464106157854724644 -0.44056728397227734595 -0.70938456936676252962 -6.4251868253791837304 -13.487469555648424091 -2.0603741056206161808 1.0976686973930416258 0.78454637543535898914;0.56136443604228924986 -1.1210302637617237664 -0.96520851524333806104 4.6251286822315309522 -2.516090102669367834 -2.9848699742178737004 0.38352722663391669577 -3.9643748412812587212;-0.27259847529357228435 -0.60721614346868957313 -1.0762286822378483997 -2.3910850588699639196 4.9988109797186055516 2.6121173596084630297 -0.91385337191959803427 6.6361812998444422718;0.62277199914814229675 -0.7737488317879021027 -0.83271500927213648602 -0.93784789101531773614 -0.72563756741322271715 -2.4034366607983606023 -0.62556041977501819495 1.4870038447020939021];

% Layer 2
b2 = [7.3289902815178447071;-1.5105355228416068591;3.6431442408829641799;-3.9577766099955060675;12.626852515590732295;0.54968983057039266793;-12.196413528946173699;10.885003358674815388;0.91868739161120283043;3.6116935860391858881];
LW2_1 = [-0.10382646015347520019 0.538970060840671783 0.49505844835738560539 -0.099035818866109195935 -9.6540265474316537819 -0.61908439086816191566 2.6800393440215222185 0.2125832186524679035 0.12043716148856102588 -2.3773712069109147471 -0.92121221512860285152 -0.6036333528463116993 -0.72780730909072277601 1.5815172724327690723 1.4452320930081992145 -0.022371399609387665475 3.4206558103268371873 -1.286452653477554442 1.5866842540153611729 -7.4776403220356337798 2.4051495395137933997 -7.4460109355650070384 -1.7760195749231431073 13.667598513861559439 -0.38589543424277533701 -0.46938165758782468551 -0.16469170783608319542 0.97604480784577429819 -0.51586080430742831116 -0.63478066155243761948;-2.5486126289401038747 5.4119112773141662132 6.0418391806887923323 2.3032783963107226199 0.38612490056126624882 -0.95083449680497789114 -0.1186922143588897971 5.0252153087727222669 -3.8563596443242955658 -12.127083183141216693 -4.9498688789099016816 -7.1076634964348217594 0.24520587668263318926 -3.3025836907298917744 4.5563085369718221429 3.5704750631362403013 -0.19252098898414321537 -1.65793973219904478 3.4548050267500851618 -3.6805821608006366041 -1.9249883851626232723 7.0362706565599291153 5.9318951153015824218 9.1023434227400219498 -5.5538342212725932967 -6.4411270079811986378 6.8661791976856187958 -1.6958018932057690176 6.7416395461353690877 -4.4838678571602139655;-0.89667231589702522943 0.61157532383031099066 3.3867916282139471917 -0.32555012592176868491 -1.4704688959446072793 -0.17065852668774664225 -4.958926444409704537 -2.8795037820044275811 0.67473286131835441548 1.0559868197363266873 7.1363565697578072999 1.1141565013257159755 -0.26865089053281421272 -7.7554437657683967799 -2.6270709139743964045 0.028367846766177071821 0.0054300979446993136168 1.7241684478687338 -1.5273235308582908676 -3.7157244540174390046 0.14080133007889192309 -6.8339741186380775773 3.9010842818544890775 5.3836460104258669901 6.0545220895600104782 2.5405637316760851796 0.61882676525634683351 0.6719430400575293616 -0.21898578882662483869 1.174487324515135267;2.1801698380627581031 -2.7452594767469231662 2.1414257567191032905 -0.1353502157319350363 2.0245386566054537347 -0.58710795121161762911 -1.195999388798833607 0.62675518207076041932 -0.74766536427195617875 0.026134987370288041697 -2.5511469370811825641 -0.80608129532815908647 0.61668628409502190824 4.5575484898203209028 0.56351834734622252565 0.16361491544851333724 -1.2661079360906373203 -1.806197377912321711 3.0086185730859180687 -4.3759559296290158059 1.6690541612093070523 -0.28555583934215783559 -0.79916035675674068628 5.0530645382241194952 2.351172474626491482 -1.14089890162836749 -0.48176365584561731126 -2.9098550756016976493 1.2469256783025588486 -2.8531549804664284586;-2.1368526374090319742 0.30080035480234651457 -2.9629817922079828563 -0.17203121317924330302 -5.5247850723690339336 -2.7665323766650429249 -3.0578708198862241119 3.1515217357160141276 -1.5621680473650061405 -1.2927520509624412792 1.8145703693839732029 0.52315830703672572266 1.9568874973600258738 1.1687723059044496932 -4.7889359530541586452 1.2923392924337750998 1.5640360625429194918 4.2756238974270646125 7.9353424707790045645 7.1005821879408719255 9.8556536958323608388 3.4873495672240015786 0.097758924057781720895 -17.622194488722112027 6.5139492682660158351 -1.5737981847107547217 1.8425810386395955476 1.6733804464783907928 -0.045796374666748934645 2.4792449213816496467;-2.0355170693600994625 -0.53425386943702901643 8.9203788184484125168 0.12499945472626679266 -2.1520193725519827233 -2.9521269830518286348 2.6699774567499567901 1.913783064697186731 1.7348246511214171495 0.1973991956225427391 3.1864015621465338057 1.114582939425873942 -1.9858041218146873508 0.25383337789619597746 5.3643172659019784376 2.8943433662539042039 4.4263062127192487338 -5.4104773271608008756 1.0794641170282721632 -2.4384248346914736416 3.6724770104236341695 6.0945197420743770778 3.957091918000948283 4.5556233735866085155 -4.9349264975359714569 -2.7802828555787271192 0.066664637069733301278 2.9522315432636974109 -0.62961426423642452566 -5.5766483564854567589;-2.9138329156543267828 -2.0450648441885781459 8.4943073382017235673 0.26462847467328320938 -2.5631417333121895297 0.67195866489767186458 -5.1982367507851989785 -0.52168469106931247836 0.8417068388837433135 3.0558231003434697115 -2.7485600897204398585 -2.3336092852321659308 0.63617371104755671141 -0.20875122198716608568 2.6077961962022269127 1.6876710185387975294 -2.6695093654853168097 -0.1379814207368589285 3.9469733997586269325 1.5526603144240374021 4.4549095189014371599 3.7888466461275891461 0.82930293742397920287 -4.8886357838100336082 2.4844907994985301336 -1.8258605078627314633 -1.0263408378305167723 -0.82728273492018689073 3.7895363040425720236 -2.8259531198632945603;1.1200905128893554608 2.0609113400245564485 0.25098807619282259562 0.80598045669672524483 -4.3903425963537205945 1.0647770417505302287 -1.8171005911066042682 0.97732646187224803125 0.14835176922748533057 2.0183345534733709847 -4.0191235466252930308 0.67208711567745182958 0.21120192476223864642 5.096470624268702565 -3.0326245782621801261 1.0868361729243409819 2.1156422207228868793 0.41873246694120341838 6.3612125455416945741 -2.9332142720966811744 2.756889546674795799 -0.73885579674068280198 1.9781071820668998384 1.2213738530260032089 4.3860008446125142711 1.1951179114328867037 0.93794826398431352388 -1.2512640214689794149 0.57463007299711343911 -1.7384293491572062607;2.65703565047894541 -1.2516138436826631519 -6.1145130302588857063 -1.0864463056528759211 -5.1725704430185279747 0.072382548382042111168 8.0353853996642286006 -0.24469839729258710537 -0.14654809884645977891 -0.47720182400985694526 5.5754359350710069876 0.089218293346032456759 -0.28235126906900531729 -5.6159459368701174498 -2.7652542682690559595 -1.3285899972326280505 -1.2795822466584796384 0.94241188500992090216 -2.2553506864304555535 1.2252127552259648446 -3.9126786378128031174 -0.42196248516580914245 -3.584240359372727891 0.86236180672154139071 -8.2702160777055677698 1.0188533629522775747 0.33717018106029444935 1.3139941042241289892 1.5135523971893294348 2.0843489957826397685;0.058761805871032753157 0.20280577609177447007 0.23603272375833397878 0.11337797914406515243 -2.3263631790849350622 0.046220441074419825467 -0.12363278689458762072 0.10087954896501270807 -0.027648119695831037401 0.070006376438571785159 -0.21120755462884135967 0.027420649400525291817 0.031904635610707804405 0.19741628998339136314 0.070653658341441494262 0.14306023212304727621 0.40924892911958749009 -0.043197307469830782678 0.40250409588840463382 -0.25047540207394652922 0.160428393206218739 -0.12800783407142790615 0.20049010737556355322 0.32985350173414651476 0.46180578677779499097 0.11507336692015528168 -0.046027840711996351186 -0.23739906149109551992 0.027016012575610516555 -0.28609277435562285863];

% Layer 3
b3 = 1.4457348885393253024;
LW3_2 = [-0.083733205567721763485 -0.01663805837555236769 -0.07987895794561286622 -0.13145481341584311363 0.047975534102441041995 0.037522091594534873193 -0.078373036787466640596 0.088076122933512981938 -0.20418900060700972965 -2.0889773115324272723];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
