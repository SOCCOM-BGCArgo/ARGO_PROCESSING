function [Y,Xf,Af] = ESPER_phosphate_1_Other_2(X,~,~)
%ESPER_PHOSPHATE_1_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_1_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0420250688263656969;2.5288573519369057507;-1.9770218040937137527;1.6721000328231370169;-1.0748424727803551626;0.61603802248486194681;-1.1192730386738694026;0.8960696880493923544;0.6798851583711804647;0.44747874628041717227;-0.37012714794872031421;-0.50412703523626678503;-0.27943884458715184671;0.49063656346571904443;1.4590865249966684658;-1.9261350461500197362;-2.2441692978039866624;-0.66363728093068286018;2.0162414713698244562;1.6439315715682456531];
IW1_1 = [0.025685630472058143536 -0.17737404449918101057 0.10641797906199457202 -0.46641567632398189813 1.4166157961772267715 0.53350791015286347374 -0.41867740086209670469 1.5134215737146448078 0.071230354560700676059;-0.55409731372735926413 0.80649012264484809531 -0.93527443608236382477 -0.57321358908421304879 -1.1129830508822959878 -0.72001053122332092649 1.1634239119339835344 -0.65129706293389855176 1.3543080115523287166;0.74593658943950136297 -1.4753894290906821585 1.1879487878637315923 -0.47326364195245435029 0.44059351083357828349 1.1545564290848522315 -0.32773018594314512475 -0.13301231521130887914 0.15364001853142003617;-0.59010677407850908871 1.2068460563762222204 -0.18700010094270255734 -0.16566834836272367748 -1.2722634766263283268 -0.90891988837063453222 -0.66232165753973704092 -0.89570503276746904486 0.3986747368977530126;0.46086669203346136703 0.16732594167842504418 1.2129482301299536751 -0.34419240011185819883 0.094087762918389189482 0.25923921166184860088 -0.46161793744020784835 -1.0306813573908559789 0.51891944797553291036;-0.048379711913141144886 -0.080037854693553664442 -1.1933658833915741226 0.020634277612036792254 2.7235097041001821161 -0.38070116470629722372 0.75178769102195741603 -1.4184978899322802093 -0.046623170380171288785;-0.28680775859972890141 0.51990490760178276197 0.69179822550887593025 0.45542500507083122363 1.1521652786439415816 -0.70475619235384445727 -0.32709848811953484704 0.32651078558386753548 -0.37315738939522152817;-0.19440342458096596112 0.012469345512051378463 -0.46970311288032517982 0.28016205607431649005 0.9878057979853841486 -0.71469957750549317765 1.0401464810863874089 -1.3372883757379530056 1.3763774703465012639;-0.18568071823919662933 0.42186690926012188063 0.96269569968488477585 -0.18786784514962492909 -0.33797648796590623599 0.78340067319670503299 -0.084686300852125209748 -0.11508779627986549798 0.36315479359456553921;0.13015622717469307879 -0.39416341496948498202 0.56031130798937189841 0.73150832043214453204 0.75354393993916468641 1.3713743414122239184 0.78929209309633086011 1.7266916899875548452 -1.4440147266486891287;0.18059796007035108789 -0.14001777395766326628 -0.16292293763146251107 0.54212963263872160358 -1.11689158346752615 -0.014856465050561793589 -0.67538331501357928843 1.503010055095757469 -0.077097691996711334439;0.25658287029019510861 0.12829429542713308154 0.088575778956372391848 0.003854754927199173075 -1.6187497521322291583 0.14327319210234054636 -0.74710140827631088545 -0.16912809246398727292 0.087673493416371914289;-0.57069422774957945244 0.06182846918076213838 0.30374127214457469215 0.59613181089132860624 1.7728541444249548142 -0.40058030218292467461 -1.0535319655990722509 0.97018512334566842092 -0.62178886526309973259;0.15479538484430199752 0.0016490732258627718767 0.86989051351084345498 0.26940973242870563942 0.52783981837939863979 -0.28839553197395462192 0.70975736918287313237 -0.0037823664904771412201 0.20703175498052045489;0.46647680567654503658 0.6576524006011047474 -0.32343480076331521111 1.32448217025650683 -1.0096357462203664479 0.70510371545662342552 0.39299611175635051907 0.63648070101744425031 -0.17289190960162234556;-0.16094968389085004268 0.69936503020949858378 1.1564696125101343593 0.36448632801052466279 -0.42347859705343204872 -1.0027152966329859751 -0.73485404788755892547 1.5632622460158625 -0.28332547790375883778;-0.11043808731012158542 0.47231848177319057935 -1.5112146947972600053 0.20953954316671841163 1.4236647352954574508 0.12984041955254202461 -0.28620342183583363793 0.63156793987864912054 -2.3742995940558455636;-0.08368039826682695248 0.065749691321208142414 -0.56698924800866745688 -0.20430206932092032091 -2.8086380000392576761 -0.069824913274697392174 0.16958969829490810888 0.0073569295663640970132 -0.19583812666354669108;0.85305230704061041358 -0.46905668295860314387 -0.76984432234871169598 0.10187603252530846865 0.32610675031406383129 0.21518908400223127342 1.4378458233229318708 0.34084747697126194232 -0.62257764018591321697;0.63949502605817654111 0.44315673724330645333 0.5975295150319964721 0.21172388733515021264 -0.87602594571300773652 0.14281680150455727807 -0.44387541309009681534 -0.42768687756006007472 1.5496215668767703288];

% Layer 2
b2 = [1.9729655891174791016;0.78180323607091350979;2.0676436899340653319;-1.5346465544134562098;1.6967524808303555695;-1.0676918732807803014;-0.5725862455962404951;1.0258196780720025831;0.61525894452296359116;-0.60569737068846085659;0.037494841534002537609;0.24438762536552924298;0.3479242340536467526;-0.16624550729740492083;-0.35288082880358689897;-0.53247835310450986057;0.24741278827528034867;0.61317843999337262595;0.28579966185243332877;2.8492191966601212449];
LW2_1 = [-1.5381384349827866842 0.1206974566950698019 -0.98254416207333783451 -0.60424728063724808536 0.2908841929387970815 0.11529393848601293682 -0.31746911558953905264 -0.59841389498560415561 -1.2889451807955130125 -0.34794048170104591167 -0.34487458133498943846 -0.45804983261193726873 0.048544023547128563323 -0.43611273507447712028 -0.70399291475745540136 1.0482933476208955437 0.89931258591980711703 0.92299396277846990078 -0.47322214165641168782 1.0529900708469028814;-0.31498177997361614944 0.36510426851885374733 0.24741153104883015224 0.34938838352810702714 -1.1595715917506492776 -0.55334547621876906121 0.072048318149635165453 1.2656599019814067653 0.31749580385853171105 0.61574327567809239437 -0.39998065931043591537 -0.27614672018490832306 -0.39851669060844424619 -0.41422787755999285197 -0.32122545211698821932 -0.38091628890288697917 -0.36135605063628933875 -0.64338438545798048995 -0.10263062739156642023 0.6422931086717955651;0.66651587304601511708 -0.65538541440216968592 -0.71860940946563811593 -1.0523606723710188238 -0.0071602200711372871594 -0.26242522249630917397 0.45803160483812066506 -0.86301583639102419365 0.58804884011116553832 -0.64569070442008824617 -0.14149654839841041554 -0.56350781446364273108 -0.028146701371387462115 0.7022966999860452697 0.92320755323177938756 -0.53697446083925681748 -0.97094210131463665192 -0.095809077447886414891 0.73304594865372396661 -0.94454192543000614624;0.91316737965746241912 0.19014624228609980361 -0.41008458626461646856 -1.0387835756858720959 -0.63353385056756894578 -1.1551809673613340212 0.29023848410758096295 1.8686783091553142988 -1.4653173062966973195 -0.50495173096973522409 -1.0336037259895789475 0.41080380561794777039 1.3600022394849391461 -0.81939581649459636292 -0.68207575551143784232 -0.27584827277204682083 0.29319418839472416449 -0.2802092122957297593 -0.78367701448734372605 1.5021482572632838259;-0.00071775083497243891834 -0.53031732105880635686 -0.25041435384662458219 0.45617686966928250314 -0.18921888286127816481 0.14407160997202198005 0.02708224062630597978 -0.045665293648831740969 -0.88654059561839160253 -0.03135805112802400596 -0.62039039723973476992 1.3443695163170656937 0.6793561434872170679 -0.32417893993509305783 -0.19005137133925492643 0.38828618686482702094 0.097912561337899980951 0.5881428162434912954 0.49215168799177161363 -0.08714715048870314007;-0.78159785096097444956 0.14857630686206949044 0.52232093481675934132 0.42850507390886194425 0.10964203475927453146 -0.53775116670843503552 0.17942535878474033528 -0.35278050877302286059 -0.085396686149638356689 0.12864101555640913843 -0.45677305936801221309 -0.73961732309228489513 -0.79696853403036294061 0.36913717979535914937 0.37266957441369280568 0.48555793627587978678 0.36664443161777077185 0.18832274203604443263 -0.63706866078558799238 -0.99925920586530070366;-0.59445248531817407311 -0.44317468292911449401 -0.39144175241453749159 1.250240159619306235 -0.45252383518792205219 -0.27549394233794638476 -0.59252816939995822665 0.039062141663532633229 -1.2875103389276822963 -0.23365750335170093477 0.14186176187384333391 0.72603368942348822657 0.081666611028125085658 0.57350859471559834102 -0.4196505464423294085 0.57324894783049218372 1.276153639452023425 -0.21044551440687814248 -0.38425419298199942064 0.11757139951856729332;-0.29846959829039282353 0.035277631249886157172 -0.67313633189351962383 1.0274481531126185008 -0.28295873576658231441 -0.073729346220640590293 -1.0837777587520776024 0.092679015672749970323 -1.1568403306378365336 1.06400448760731825 0.68522784662239111242 0.6733240039031122004 -0.46393487755076190382 -1.1232249031218997093 0.14054508785043343111 -0.43818492575267842248 0.69620726985386527375 0.84398092443675909458 -1.2746987435717036519 0.60921979737955822554;-0.26602323020523976904 0.17399795733645903595 -0.54020391477701468208 0.48926973596612211015 -0.13562667243151343976 1.229629617000171482 -0.27161850575020229925 -0.072463880439803923794 -0.0043751599988757798251 -0.10089189704295611905 0.84616033074801277891 1.0320025864632640378 -0.07065723203313731271 1.0240447520579176732 -0.77763424203758602093 1.8755110365448250942 -0.092616522797506581344 -0.0042837041670675413824 0.61362979217750646121 0.06123832958933309728;0.15107971715830090242 -0.750767685296217957 -0.27656317328498025709 -0.010569444362280189242 -0.64632791282564605595 0.34638415280673912067 0.22761521107630927618 -0.27432143034979789009 -0.85690764573541533533 0.30225498297408082138 0.17014193991466886047 0.33560930762533330851 -0.15668585085034697491 -0.68313939124681488657 0.031309122974215966573 -0.45248664414161315905 -0.58843197298462024403 0.23420593687422242013 0.31588547060432020652 -0.10952336906994712684;0.58206408479004989598 0.64675750445113411313 0.45834263240205158629 -0.87757620706474714911 -0.18777129798625791235 -0.31366417491016440611 -0.20146620086761302115 1.0787304684822274226 0.82706381168463716236 0.78494973764968756225 -0.15563277219505378124 0.14023984011750201262 0.28893724909550611013 -0.90085597558952745789 0.1427901546750106887 -0.91395881951814994526 0.14540383439507437169 -0.26223022822591385284 -0.89250384777721281093 0.60592955657351565968;-1.109593670213575356 -0.28572318118753969873 -0.61455545815068191029 -0.33579965583707765964 0.23646365349121983845 -0.1321000754937567967 -0.4005971168704559604 0.44059898407116904195 1.0231350404968626577 -0.041494716916559697129 -0.10416371790179122792 -0.12647202112821634423 0.27865454043726595179 0.73469167053527284494 -0.12030717144492819592 0.92692719236606557764 0.28847997193599916876 0.1443023205298143985 -0.41985302954498127104 0.15600724494542975163;-0.55546858919860475634 0.29471044447581362657 0.72544121750227597012 -0.81506211726908217585 0.53000582666326123693 -0.23301922984747588941 0.45128359877928925226 -0.2274932884681663825 -0.11970000832110892774 0.056882814366489918567 -1.0206879838129312432 0.20491172439406585282 0.45769183846604483135 0.18541360405784657051 0.15340575451099436322 -0.40440358021967282021 0.14168139336603552403 1.1762526128583221663 -0.2928035435891390148 -0.18093444991111057307;1.1377864478103847379 -0.83218670109639047983 -1.1722668518449954611 -0.28932175107923613355 -0.84531364308801593133 0.18656983389635539705 -0.14778898521488217921 0.033066179673870918498 0.91281883643698014108 0.17168907985071152345 -0.8238230314555806677 0.98622096008559867464 -0.30278326574940050975 -0.16886741766027363321 0.71464831568699327402 -0.83087141126142238789 -0.31618759819352570961 -1.011018684941786816 0.53677508352272162995 -1.4014626121181374963;-0.022087151309064648186 -1.0339542379974611119 0.081836072261206913026 0.54488355331394411341 -0.39679484308676238324 -0.55228936200154710168 -0.66670516975314808583 -0.26409062542736355672 -0.028490810307627748021 0.16303266695987148061 -0.52514669218641474302 -0.31161061631737935196 -0.56141932199045108121 0.82375855481628157406 0.48300638892487146592 0.64410513378330835899 0.61412752529463476847 0.30941830475149034729 -0.67968627909835366285 -0.96056509405327150652;-0.63144488623992522935 -1.3836079221297166164 -1.2662808513120433762 0.24067175312805147436 0.4551126504778934545 -0.22281942373769642041 1.3252857975371190591 -0.58763870809637175352 -0.19091389163619598701 -0.34295858421591757237 -0.25502555971113144428 -0.60138835446049210276 -0.54412092809110501612 0.0072564723823996561333 0.34276170636442926387 -0.79860624350019693285 -0.75366704005271334399 -0.19256007716920012229 0.14420107256484798741 -0.43458639859311437581;1.2494170056437576832 0.73046281052091033281 0.67728739028441364844 1.159165023945842643 0.82406484309865601912 -0.218692244282462811 -0.24575962387498420658 -0.21886638190366022871 -1.170868813693020094 -0.068416109371409281059 -0.48058199648674870819 0.15235425021094656239 0.014924164240253551608 0.45099230649367844093 -0.32856014088570845155 0.0086244279315639028882 0.27316527334588708298 0.36281933591266779526 0.0028267048315510534713 0.73942960215509989652;0.53965473896094962036 1.0082465434949587912 0.76868149379129302456 -0.066825156733905100026 0.72427576897860157512 -0.5856489829537737668 -0.31093083622698347579 -0.4584406448146163271 -1.0187279948563050525 0.10526120366486761692 0.25378503687012854417 -1.1012793269914331606 -0.62858718547211822614 -1.3278714564223297323 0.36573862241246979377 -0.4164489802155912912 -0.54377073088915073296 -0.72040579917368829932 0.74391444106597182095 -0.16458646902203055706;1.043042513794125048 -0.62035319588805404312 -0.29300226633610892968 0.7539319110133563262 0.054296199068723502434 0.40043641736378976503 1.3801801354011866696 -0.81914330145058678045 -1.393154082351006906 -0.35465220820201193153 1.0244172236198902937 0.16264213691727968936 -0.96480083245934422642 0.11746628067333018952 0.0015705498560818595584 -0.97424443842313523945 0.59968222647219060484 -0.42131026268961196957 0.97408811546855378349 -0.8852926350437642089;-0.27184742035482284406 -0.88118151376063358349 0.80885494381464706493 -0.48740082837763454293 0.13012990032944374286 0.16275932339684884287 -0.13547375218741933289 0.45074388117084113192 0.68729018492561755327 0.57658543422198893502 -0.58461803805720968796 1.1909628475956282045 -0.074922611080936035721 0.12306304388595765142 -0.14200692195816178032 -0.087703146082257057992 0.22592132525224847828 -0.98487862829323569169 -0.23441032652251223012 0.034453391938425802221];

% Layer 3
b3 = 0.018382194472961046333;
LW3_2 = [-0.57958423607530451527 1.5270308233271869813 1.2455113778427728821 1.162796220424411775 -0.53567897449457479997 1.8062974065838641735 -0.6225343170055260833 0.15462370053260490743 -0.50691087743043850011 0.93238441840253938331 -0.55139072183690229778 1.5006538309951680255 -0.7333859160421466461 0.41871100696282154141 -1.4456296878007761642 -1.0809445130945012359 0.85924530953998512484 -0.62579722715883789874 0.49897522832650115232 -0.53513339171594265231];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
