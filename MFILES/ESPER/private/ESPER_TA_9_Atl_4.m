function [Y,Xf,Af] = ESPER_TA_9_Atl_4(X,~,~)
%ESPER_TA_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2872652311068533137;1.5942846933216336947;-0.66378927346799687648;-0.76367221223223702431;0.55289392067436082812;-1.5061850872581441507;-0.40211409337199327529;0.79652946041198380289;-0.80072076526375690619;2.6711638526881480438;2.8595474864909853352;0.67699293847153430015;-1.0929819406831817741;-0.12891081680521868091;3.2653506755118608673;-0.13998111764912338217;0.44366046164655031925;-3.6139384088378947446;2.5405277109325878904;0.34438756884669752267;-2.395755642669138652;-1.8153066913763660217;-2.1337821427272642971;-0.73089326598811876767;-1.5364114288264889563;0.34646148940879090139;7.8048321260074482453;1.7936104360394864443;1.6017007901420237115;0.55809532883955415006];
IW1_1 = [1.3742400921819581949 -0.34241723035458443425 -0.96080044609683257217 -1.5399959976451664811 -2.4151153599518946358 -0.30164698362633923789 0.080916315007817873894 0.48855313221146667857;-2.2140236188220172586 0.9555892258423005492 -0.89211627010571581398 -1.0262483140142126814 0.24847036585780424289 -3.2167287600345901843 0.34934200575019425106 -0.46403941230546441599;-0.51904639738386071368 0.71053769491317064766 0.7255857467831873242 0.6200988200475191503 2.4286603738723906432 0.46933625833733827459 -1.3516876896740637193 -0.23160186211190308958;-2.2014109997914541594 -0.81099594951211961824 0.18639799257946540467 1.3246885433924777686 -4.5887616702227029819 -2.1495005308665549038 1.1793288609320735638 -0.72862041970163082816;0.96639433040325073421 -0.56076645683020442945 0.16472657111156735477 0.90512318580554407266 -0.84771181938063688843 1.6197364686962845148 0.18109950124772117297 1.1798099654387350643;-0.93702280924910108517 1.6718305763541196907 0.80137030935036090984 -0.9846140048484068874 1.1851273355290867784 1.9060902503301933031 0.57061824704556485255 1.5119957837456794447;-1.5827525845739818244 -0.27909655942501132575 -0.068831297857959161668 -0.2756831438928827871 0.41154239240154205648 0.89010287114676411857 0.31048007145736422618 -0.45946276274431285813;1.3665904178658867529 -1.3580442606688123419 1.4440873962705167433 -0.27400063417102593633 -0.93488676828048034029 -0.3803345751036243394 -1.6556212002363990266 -1.3454890980770943809;-0.040027829256911742761 -0.05294961041352497233 -0.38516283860083128099 -0.16527602178714712045 1.7782948443145156769 -0.84243398220271514809 0.39167509467005773294 0.18871845581923363255;-0.63788348977348796609 0.47978702983564414097 0.27141853306082341923 -0.82083671655918521992 -1.9054767304594946165 -1.9404431732257252374 -0.23022773158414638894 1.7139730410233411373;-1.201429312405126959 -0.55040057679827969483 -0.66950246362420540169 -0.84818494307476810512 -3.7276452953816954228 -1.536129313254874118 -0.03181907546059881825 0.029533500587323180397;1.3884182272833471838 -0.68338049150700475032 1.46894701645015191 -1.3207112833246548167 -0.19482915711174225715 3.2961364243604509561 1.4134984876925824615 -1.0608031153577708317;-1.416463726109785437 -1.6233657606527718276 -0.36872272253467702763 -0.0066845406029354334509 4.9553351461620938068 1.3900644731679534516 0.38217009013279590324 -0.53568877529732261689;0.244261202834299751 -1.2962167088698872686 -0.31907660838901980016 -0.45422579255297512724 -2.9055511398878448581 0.14374569271147602523 0.346113521336656349 0.29624493852099120783;0.12136262073471090761 -0.33631380699090696051 0.069658819264031474061 -1.228374412366063595 -4.1709664449713921286 -1.2206189169328918176 0.14083129391580398448 0.70955635329478772277;0.22236450148635508728 -0.36535956180527573434 -0.23990549674506467248 -0.26666245294880336347 2.4017975290389377285 -0.1438519007880898759 -0.91662097818523258219 0.9071121131778709934;-2.7501673852078347693 0.76111167811343405365 -0.030705437882506500524 0.57926320451244295295 -2.7131403694421361017 1.6551170373398800262 -2.6028541617838838462 -0.89430703768512098684;0.47869441777591037468 0.1630104948623552763 -2.3702282827652059183 -0.094946730604565029998 8.0803695674623412515 0.79407466441077789732 -1.9426564317337629006 1.375048021559942546;-1.0314200050129307407 0.10002871024617317197 -0.7877775368291213276 -0.059826570879346049892 -3.7851959936113646066 -0.28972392772481858625 -0.01504846348264459073 -0.24428955687654960172;0.41672399401621446069 0.0069607062195649735056 0.46126029745679558713 -0.25550226324877045592 1.8929780872737367314 0.84932699166860015083 -1.8867630373298043267 2.4135778096870028619;-2.5004850343915077104 -1.7310212997890288555 -3.4477833430987119279 -1.7253005901853153414 3.3048407048567498556 -1.1471026018766252719 -2.0202661897074776221 0.80135396325908847537;-0.30427884474995797737 -1.0048901327978181364 0.1668937722879618446 -0.38387934742249912867 2.2022756405189927165 0.25533333110215467032 -0.6166552961379206943 0.38663547655267549441;0.681801124597044228 0.20882160647348066429 -1.3749959612594744307 -1.4333764208459927048 4.6685754535099661666 -1.3874586323905757634 -1.5895169991047728431 0.79713950136380107292;1.452161949806326291 -0.53830367831383163502 1.0346482484206891428 0.29814483560662186079 2.8934613896767436003 -0.29811221669340520757 -2.0892006025126352853 1.8179300774202831192;-0.73607007407173452584 -0.13707073447302717262 -0.43641531853550297182 -0.24299283952475964066 1.6048129021196224642 0.12135049297730067519 -0.49099873375653968477 -0.18791661287221109178;-0.58454497190335341639 0.55982783038107741813 -0.16809620997079507965 -1.2524652053544602648 1.3973535206588763025 -0.79424626532612108143 0.90033519149177498875 0.0067861521912776449211;-1.8921670277262221393 1.3815911618057445942 -2.9916689342354185754 -0.25465462139286831889 -14.903967613149056604 -1.0057421864495232899 -3.688118463469778785 2.6775820881518859196;2.647910590571403322 -4.5107604750061858212 2.5743217165817786629 -0.060300842742295565624 -1.4025002511862405541 -2.4111698181923051365 -2.1875279184139322375 0.050795344209145276704;-0.56035709569228164817 1.6867794646706719686 -0.72953557610953689849 -0.24505120165117147413 1.6207669723471473944 -0.33819782635468159659 0.71278309144618656745 1.539160886778977666;8.216379960307847341 -7.6276777372200985639 2.3906270317186746333 -3.9445840298566472448 0.67489485471363719338 -2.6635999541089301346 0.68918297665981931299 -4.4155608940508299654];

% Layer 2
b2 = [-0.39053196580831173179;1.2608757519844839834;2.0336390386147851217;1.4462342792494691235;0.8619135703425040429;-0.98836766157139077649;-0.3472512091937203782;3.5966128192689525989;-1.4277446431383080672;-2.9681430372372785698];
LW2_1 = [-0.41763098802742903981 -0.91659069317196717464 -0.89532231817064056312 -1.7975145240164243088 -1.620270895253228538 -0.049590726424823365626 0.46567454337981439849 0.31480771149168429446 -0.029756313414135295015 0.33430752481620124028 0.33667005199700478224 -0.038487483086233342799 -0.85633394171113697002 -2.4664961012780994842 1.5950174132080605638 -3.0182259235696329291 0.81136361093643982745 0.45125809878473910342 2.7392488957214866652 1.3105563350265267974 0.28792541682884115195 0.10215329251839196101 -0.99261097764738326354 0.21024092924433246399 -3.3511737510696515407 -1.549349871554310587 -0.27464135227385338966 0.34159524677372793411 -0.94588710524070862551 -0.31989075235625225035;-2.4041493092218582106 -0.92625706125299878124 0.52607400568450624068 -1.027707808605452966 -0.55137180200419344533 -1.9832890065759520848 1.6247188245929375938 -0.80323799008626983742 0.79758242345647245575 0.39715218466243523698 -0.36449995096279702578 -1.3223381776733713622 0.33749426254726522245 1.3758668749899185535 -1.1413751585818840972 2.3777946948873864841 -0.64840540637313937022 1.0766599996313952481 3.0163176355049730049 0.81892641163246504554 0.47671630081287874603 -0.29962124949158275289 -0.32991573049979283638 0.48849457134737600539 -5.0465632524832244599 3.9355837992510176448 -2.2356230592098018661 0.94842003494585147561 0.80921397791660198973 -2.3608059065739670501;1.5316804455357557746 -0.10783518720341271624 0.20938510578884897417 -1.2676444805262592208 0.96332925255188328606 -0.19747771650314563385 -4.4653577580161272209 1.7779490802184303444 -5.8226386236993716849 0.67728264596914167228 1.2608965860461449626 0.086551484288192911953 0.33825022405907773093 2.4189453260418161129 0.11205898608220667134 -2.062172415505576506 -0.19832354973994228975 -0.38698453616394407062 0.40174454825793709523 -1.4995638528864971839 0.45768721739340689769 1.3221951017201487577 -1.4637216401934272092 -0.3223890097083388917 0.76902994307123306861 -0.96374226459495038188 -1.1864865311046752794 -1.2338931960330592474 1.147414568769115073 0.1118941546988857505;0.51727316782650822891 -0.60307968861484984036 0.16436756406029801036 -0.39317928132527696361 -0.63326231865666338106 0.77635292583034065661 1.5098471144833074398 -2.4503333982744326391 0.40180923243321692295 -0.89329677052198563914 -1.4238597438644908788 1.3305596514633606375 1.2402872794981907312 0.060493389516105604276 0.34371702609676463291 -2.853796666290535633 -1.042817062413695206 -1.0081752119485589692 2.2510239736109078912 -0.86323586272210894865 -0.52936528581980324404 -0.13680212851151735132 1.981031008228679724 2.1561168752314681107 1.2438268887665882012 -0.45405958209328600717 1.8446504908120648913 0.82160192197850556717 0.58171299470662407582 2.0795453444611422533;0.11682243127383243331 -0.001089443060626634624 -0.02993271726045783343 -0.41085021830766582651 0.62646098057884891386 -0.55892439624059542247 0.17952953151980297064 0.34382334597623964711 -1.4388492260430534309 0.11788607306137567632 -0.33430226292166681512 -0.21521222243833793009 1.2690601187455838872 0.2731781246339527458 0.51961659089348211094 0.95163512905826996846 -0.26984682827970513097 -0.62056155062923135102 0.28280284385681170312 0.021110622886833699252 0.38749228204092722727 -0.90894350535382772982 -0.12349666386841913479 -0.31757821981029865643 -0.63614436824215703226 0.49451808080906567433 0.3321048903065891289 0.42211874912917518587 -0.93884899472355487493 -0.35181154387764085323;-2.2550311066006480942 0.63217591057169819635 1.6753798731441562619 1.412966577943700619 0.85638586330921950829 -0.42650488852294299313 -1.2718359843783957341 1.438812686394960183 3.3483670680635362338 -0.48253414644191366945 -2.7207715448461389229 0.78016892235898949171 0.48212636081141524436 -1.7167665244714471751 -1.9540778112070820161 -0.16819194287007185884 1.5296218188659467252 -0.40960465413575275484 2.4311574215443947367 -0.38419883860090991989 0.5354749653495589623 6.5638107322299878987 1.0454756021176523362 -0.93577505438485253375 -5.0969865724993663747 1.7266734504447738274 1.9090791895903851394 0.35328970828232530987 1.2151264570198523352 0.2021025166789196803;0.37501210831444076188 -1.7331995717325330286 -0.66485786980377337141 0.76471015964059030345 -2.3402562770753694288 0.27027315892600700664 -0.9646101728463936098 2.5566160621730449343 0.033725503249821167651 1.2317225278821222201 -0.34127681402961429491 -0.29352963855307434571 1.8655741687624465275 0.17977722076494759285 0.036420008181414970094 -1.9920852288532133745 -1.2568150532113264717 2.8801129665950742087 -0.99348920204273938328 1.3106413713776279284 -0.35987351729891925434 0.26690941515654070804 -0.038189300449305824126 0.65110381244734572004 5.5011160895697477358 1.748857878681017608 -0.68950750042823949482 0.70795743183591341996 -0.85542757333736629821 1.4258964961424513973;0.044772881117333337975 -0.43111714673286744004 -1.2417815455951013437 -1.1211915083448182884 -1.98112641251864674 1.4342313639147930004 -0.045264183402440434645 -0.63211921353105438026 1.9364328859671213756 0.034921719745477863839 0.022676703175989978978 -1.554857833624476271 0.49214445876575207972 0.42883270121661970498 0.057138209604015124943 -0.34908378216084051671 0.54033309173635379885 -0.18386976838164678649 -0.7059232424156030028 1.9094597442131286957 -0.25243877410464848898 -0.36466929134049591577 -1.6366251708165704404 1.074687551609824876 1.448304697296206589 0.31746775516091085834 -2.5628588437311763393 0.16292713502552771954 0.032876512443304806155 -3.3904195470785789546;0.3899806841666635937 1.4093606112644023742 1.2953630128204232097 1.311664673750267518 0.70597699692270543537 0.85804066255739708247 -1.9229206652338943773 4.611198668386914612 2.3040057038760144437 -0.23040244544203863919 0.62661593047458719052 0.60871015722188881458 -1.2361911589153311564 4.6229622334268389849 -0.18359688872727181197 -0.56257284920406325224 0.20354997055156634489 -1.2377098151079812816 0.31725299635629794492 0.71068791333348613204 0.015945702378472835503 0.076975374794407983026 -1.4031713611489680105 0.38769249158140117739 3.0435871257544038215 0.88296420203611680755 0.28549654482689312829 -0.87862259796277997204 0.314219264970483525 0.67185523204575048339;0.24246368956718172827 -1.2669779293592053904 -0.84321467984448239541 -0.84475590691996260695 0.52549439683151522029 -0.15243303125324386693 -0.14128546898716604074 -0.59037105912281317988 -0.98551301311662664606 -1.7015561910733774109 -0.90890259516488169922 -0.62929703791707469751 -0.73752265863403920765 0.13974636553432245867 -0.8984504144200261555 -0.15224691328039907656 -0.72153945589501422564 -0.33042992297903900356 0.51457264514028655533 0.74199302465846028731 0.39524039957290840741 -0.15802430445450446617 -1.2725959168758527174 -0.45918439701383267915 -0.11301598512807577157 1.2196939672190063586 -2.9223138272856172826 1.0062747046207380919 -0.48416255826319382072 -0.47176809284158427449];

% Layer 3
b3 = -0.030262760682298706777;
LW3_2 = [-0.040106589314923668521 1.1936382270671146433 -0.015229311661693174795 -0.018114421377920002926 -0.85767669432711091115 0.02731141124623345795 0.032665730897790380693 0.020242532458610372481 -0.095068148330695156911 0.0072448701313477760141];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
