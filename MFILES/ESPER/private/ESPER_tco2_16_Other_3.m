function [Y,Xf,Af] = ESPER_tco2_16_Other_3(X,~,~)
%ESPER_TCO2_16_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:04:00.
% 
% [Y] = ESPER_tco2_16_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4197413338899596;-10.224030721257272;2.0461821837977205;-0.10632322598502968;-19.886863406803581;-1.5011534011188916;0.5245627472946307;-1.5562977561750346;0.0018925882445559074;9.0368272507935075;0.98149418999422711;-2.1130824688172738;0.19984529525102668;-3.632659335854679;-2.5944490234988167;1.1714002127246861;0.81957490488006035;-0.93698764220076469;2.3349380488240965;-0.28270444438604442;-8.4400180798544309;-2.1505630949380654;3.4196182911582613;-1.119028475430391;-14.485342400582576];
IW1_1 = [1.4049042074007658 -1.7602413340654968 0.67298407634910051 1.2355776392049194 0.078088771196126922;1.569718363022687 5.7040807261833741 0.0087596718905996046 -1.3251385607032222 8.0890659016284339;-1.7419572153584495 -0.73778599594575167 2.5387297773015662 -0.80082870948799578 -1.4120847580453915;1.2071529458645835 0.41109353575874824 1.9468105264413329 2.3632274522263548 0.98164038139280818;0.16088977636784574 0.18804407676549911 0.93368671365057321 -19.925476164987185 -0.95863925746436351;2.0420528962881885 0.73000630810181799 1.815886920736185 -1.1735178938002544 1.0096198078935246;-0.87345094357213737 0.29036444263701655 0.81886390784969554 -0.73433470431931047 -0.49950056297190704;-0.10492448777216182 -1.4013368370186448 0.68078389204194667 -1.2095805241752333 -1.3137866115325372;0.65842671709791256 -0.58380073850341452 -2.0551795107166133 1.0355918976988268 -1.6919011986507095;-3.1133498042789576 -4.272542048619365 -5.0990125041443628 5.1931300640501918 5.7822953916519531;-1.6527719400001883 -0.17409258085066928 -0.96149236475952093 0.7416872483567678 -1.4234903255629068;1.1529375373400648 -0.46214913554034898 -2.905012902596229 -2.4853878832889422 0.96663291220982006;0.54423947207407164 -0.3359587919189172 -0.12052913770784808 0.63814566624310376 0.84638455751046404;-0.32808670054218753 -1.2713977039531825 -0.74449661143975432 -3.3131783126726271 1.1995021527119014;-0.44965719165388035 -1.5373651017919798 1.3826874662684661 -3.9631830250895406 0.41343784795460797;1.1453104218860228 -0.61432628520184085 0.10792089069360949 1.0123231853735606 0.60014824156822766;0.15291833562772711 0.076548521668864972 -1.8113323269756147 -0.58031130633507999 0.48593194752809266;-2.4110489157736805 0.48913141598393761 -0.99624421680170616 -0.17374401063447298 2.9814848647883609;0.39004088032811207 -0.39828889832666425 3.9389756100676663 2.2470741626560886 -0.83573563724965638;0.29709786327243864 -0.3372347211516129 -0.86926802028634598 0.83944535533970166 0.8844929679811635;-0.35989136919774911 1.40952513658017 -16.95850263696833 2.9740499157085099 -4.3848553054419472;-0.18879253503082449 -0.4113563318727595 1.369696088563398 -1.87226564729016 -0.49108609627388161;1.0992062742044415 -1.7416658753045859 2.9047221284076898 -1.4382973051074661 -1.8090863543924531;-0.71733631060832859 0.49461885134677913 3.0546573236037258 1.2148599820650592 1.5694874277354649;-0.92867350911067548 1.0209496078270204 7.7997622104111937 -13.486378026457663 -1.1862922057009289];

% Layer 2
b2 = [-6.4271453290600116;-9.7913388568674726;-0.33588836410866657;3.9900564082512733;0.14656760697134441;2.1104255706041259;9.7086804710522792;-3.3384011410669565;20.262989233101059;-1.4936391034453225;34.038907948444361;6.8249311329737141;-0.60987513499822066;-0.5593199986656705;-1.3361177462468785];
LW2_1 = [-2.0112298175542334 -1.1740519101978619 -0.15043653601739654 -0.08895910547212886 2.2055819264811158 0.27155012081406782 5.2323552753671114 -1.9081779405145323 2.4041159013078079 -0.0714683504302661 1.4920790561708739 -0.67724041873604957 11.723458881023488 0.61875794275404628 0.18562832556484191 -2.5494811029464293 0.25259351256175883 0.023108477117954412 -0.5437209863577267 -5.41503064307524 0.29601295055488636 0.086546373758897649 0.93673980960897807 -0.7793516640841115 -0.55104156820486805;-3.152929866793412 -0.58344421586461803 10.798054715916544 -1.0923909914630796 1.2165617804868849 3.263345081662322 -8.9929956229631411 1.0898578799536565 -3.8670026269808089 -1.5506624251136794 7.2409960625211545 1.8141264413045779 26.908510257166135 1.1742073406008398 -0.0069949678067931474 -10.464433657367112 -0.73764133820737288 1.8733616114430478 0.47645005734751955 -11.794023016741654 -0.63894929054190774 -0.98984738491931312 0.59265860323714015 0.71783625189484557 -0.14049820717787503;1.7960260993273085 -0.55965300516627536 -0.32671347998515976 0.11197494195088963 -0.14863244357766123 2.3429517074559678 -2.0089334676616235 0.18235298225599947 -2.2044556344646469 2.5946857735760211 2.3372801802981273 0.97537106521833472 -8.8501914896515412 0.39272021578635119 -0.25629827716841475 1.448860259478117 -0.16432103182194169 -0.43656354522225016 0.33102022610755932 8.474191038778649 -0.4708377661735938 0.60025175424699106 -0.54949769292072481 -0.71621949554764575 -1.9815520373509528;-2.2619934009131071 1.0808202382945371 -1.538238954396272 -4.9080610686847015 0.19507501898098298 -1.199174708168349 5.7673102298730692 1.2357622195969071 2.5180264942404711 -4.7571621347426296 -0.21190021187581862 -0.35025556803743346 8.2782239312529633 -0.61373321406444259 1.350149012561658 -3.646317505267616 -12.015668667085146 -0.4172592532752129 4.8050061309536138 -2.0788259156762434 -0.49790851018066296 -8.9645708579725802 0.22782780955956317 -1.8014074390632113 -1.7203237405534457;-1.5543485763698242 2.1978457595842258 0.092871931278807829 0.092379997174751788 0.36585038637959244 -0.16311485441695897 4.6016485072181057 -2.6916034251120671 -0.16345022577992405 -0.93090931208078198 0.50276138039917606 0.10147094089071546 6.6995938167554305 -1.1052963157011817 1.8642933225455562 0.92093907998741487 1.2886538660742324 -0.38780445616362275 0.21688506933990376 -1.8534526307760819 0.22107522868222618 2.8969295897510796 -0.3448233345631766 0.2985858438101841 -0.89510604965768847;1.1056660376083718 -0.36962111260430958 0.69766180133545952 1.3505209572698373 -0.24665309045443046 -0.78490611018935885 -0.48131326944595615 0.99340947355084186 0.43023631051849143 0.5495773092380426 -2.4362004659723349 0.66276340506877751 -3.2241915495247491 -0.53301209664947546 -0.13597377043599423 0.26292636316804557 -0.84482208231788236 -0.17027278211327382 -0.75490578370383143 3.0479986604674196 -0.17925328119304043 0.15117783739962323 -0.27715069553923638 -0.11576135708189779 0.62574276022912678;-0.36068502282450793 1.2430507212367454 0.97078163718857113 7.7841734092507204 0.085221870460877869 -2.6475627526705914 5.3685508455384801 -0.77047843830784191 3.4889490189245786 -0.45185822045945817 -5.6827837593028239 -1.2580348084924573 3.3258613270933362 -0.46615019533592283 -0.38985866852288065 -1.7147503626375442 5.268033226416704 0.47234214902666161 2.8990213381185632 2.4423826699915243 0.95292463865666821 2.5556388518949116 0.027915501577193733 1.8270298438546275 -2.1645222817896972;-0.81059274235698831 -1.1164495812076327 0.40754647046406045 0.26696009917399077 -0.34030331671408154 -0.93770591269738124 -0.57629869649578436 1.5725827008630493 0.62626315675684019 0.56451822208534264 -1.9786054296870974 -0.70693311802129122 3.6873007504012358 -0.19528167075581576 0.17361247248589867 -0.88758543865629547 0.55563874581243822 1.5273150584246946 -0.29479059610549624 -3.7577088892037795 0.17198194655822988 -0.45763104770637952 1.2196150634273526 0.43421219572745084 0.0045304111173603383;1.539676031869653 -2.6756480524371331 -0.089103280047844902 -1.8145383517193361 7.6355874115221551 12.05056926271685 -14.995425625634626 -4.5310887287227875 -2.6217479772688055 -4.5276898396234833 14.676256806546789 -0.1942676964995203 1.9788663524688386 -2.2123627331825948 3.3866953471084238 -5.4169214141782085 -8.73977692884446 0.72874217467510327 -3.3650370312854729 3.4848752366965727 -2.7471059271108444 8.8779033889345182 2.8480727479749604 0.99101012920706344 -9.7236178481093347;-1.4089719675655772 1.9630606679259222 -0.41655732964104902 -4.5082710770915755 -1.6569420113054329 -0.42416014798191243 4.9142416913145439 0.4768478172521507 1.1966729379474543 0.25976181957700722 -0.90209185235908407 -0.3640593739118051 2.0596783902317868 -0.95471346236131149 1.9017245102988674 -1.438220058920457 -7.9032033431400741 -0.860887425695683 4.3858296908893397 1.7187563472070513 -0.38631148481538397 -5.1623322083447016 -0.50549439617790859 -2.446814519771138 -2.0453150761086669;17.584030465816447 -1.794414728402131 -7.2064090784457697 6.6849123422677454 -0.38054341074143028 -1.2791736936227072 21.248902395617954 -4.0649580102475573 7.8859415338388441 -0.99738243089553791 -2.1352480223776698 -4.4962368689910264 19.170826042287185 2.0185505218740478 2.3055038748089318 -3.0003032095478548 -22.628292824738786 2.6423328440890756 -1.8801773008446088 -11.983267989390409 10.499487293148842 -5.9422951919568918 -0.2875059289139546 -8.8904718489124921 -2.2662246132047676;-1.2155009948785886 0.72827760816425169 -0.56841275806676139 -1.2656686406978968 0.26730247904608545 0.76866470665425524 0.44498930300411704 -1.2753942851965097 -0.45871745944146708 -0.50337606340299657 2.4792583380430444 -0.62150230332966894 3.1293250378626225 0.40338835203268181 0.23329552400722595 -0.20990773679707481 0.88817669794741894 0.11787518694531268 0.72448448238524044 -2.9887230433824743 0.15260366756683744 0.65216347549971498 0.3083374494608655 0.022080381159340568 7.6564995242732641;0.93253455191016388 -0.66571092349439287 -0.33523944568646302 0.37807500428197821 0.31148358047554781 0.37281307850091405 -0.67819095544762709 1.5331040615198996 1.1327681434309134 0.89578249281966704 -1.1869678592449837 0.18820970607821574 3.1515368343628554 -0.41055406171687508 0.1816288523360324 -1.992024364344219 5.083589920393667 1.1350568598951827 -0.26547612459716002 -2.0161147282126257 -0.055005081219278065 0.73820425791043709 0.093469476686620812 1.2598427952129425 0.15734802632773234;2.3774094273056554 -0.17373035144707302 0.57612393292681519 -0.5173229993470797 -0.019007174492002392 3.9470753172640167 -1.2153267765518871 -2.853626450902381 1.2582071679604814 -0.50250101318976237 5.1240305068622476 -0.5415579022485979 12.444346838937001 0.30510534195219741 -0.21694946516191371 -2.0642111632964926 -0.11733007713618498 1.4214037064174474 -0.53384865098810874 -7.7711005245618283 0.60248110509500463 2.014415035065698 1.7936748836970471 -1.7539062431017249 -0.12164333025800945;1.4863660355228649 -2.1202091277261541 -0.068543696049054692 -0.086368426457104686 -0.32969174178521243 0.11849068685570681 -4.3628307607390306 2.4344818119119864 0.052567371763958308 1.8814058022764775 -0.5213185665590041 -0.09136072407855142 -6.5324296988830941 1.1700592469199482 -1.8223008909029221 -0.69449179031268837 -1.0706447379948982 0.30914060527801002 -0.20933000664511767 1.8142767321290247 -0.18733082617674604 -2.7633894184517849 0.26892911774215894 -0.3375869589437468 0.88873046332039563];

% Layer 3
b3 = -0.096811114558679745;
LW3_2 = [-0.27041839007782714 0.12355426514770605 0.37051505246010097 0.38859592273589355 3.7813622233238569 3.3671505322601445 0.29114731399924659 0.40265558689355174 -0.041766497568140035 -0.38813081534924876 0.3155180003860798 3.523396776633787 -0.37409771639782685 0.17955000118446307 4.0736396338737606];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
