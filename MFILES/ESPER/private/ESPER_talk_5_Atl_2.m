function [Y,Xf,Af] = ESPER_talk_5_Atl_2(X,~,~)
%ESPER_TALK_5_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:45.
% 
% [Y] = ESPER_talk_5_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.673065720340098;-1.7735132951842492;-2.278163756258798;-3.241894339253319;0.3437500871071163;-2.0593531529571956;1.0561109615209923;-0.6413468102504829;-0.060469817288057656;-0.69682352926287894;-0.19829934856067705;-0.78218336622530993;-1.5373998840174861;0.53403687983043535;1.2526905799281292;-0.95419215883652209;-1.1733411764481705;-1.8043727552236717;-2.1783926211267621;1.8125056793299859];
IW1_1 = [0.18652194314395423 -1.5174999638075579 0.91435744234424454 0.049044757279919964 -0.21499925136574774 -0.51313504183909397 0.070981786882474529 -0.94923119432947456;2.3036812287911133 -1.7454094756922387 0.78045909159576354 0.18136425954961524 -1.7478542076672907 0.55574122260980885 -0.28501451216286489 0.29866396027566716;0.72826852962240118 0.55585527124920786 -0.58801875364793865 -0.86046979136422197 1.5677496907335375 0.47793063083769577 0.075995271984588955 -0.83971735908456258;0.17290447636423209 -0.2618113294276726 0.33353279293722965 -0.15305651249024207 2.9605849564721831 -0.39783190213388508 -0.21185826389439219 -0.23237664165488997;-0.57949448948003301 -0.40144380875993463 0.61928104393553152 1.109288626320617 0.83913374327435497 -0.82369257139460372 -0.14069042731720052 0.36529985408546567;-0.066832891304421757 0.85237782492826375 -0.29939920137293707 0.21838556300801304 1.2723532222034304 -2.8893006907619396 0.39392710905228245 -0.29147926428228166;-0.63983183176998415 -0.59341947690466945 -0.14844635855797444 -0.048681455888189833 1.4012411006263359 -0.63195265710954784 -0.31444135211949531 0.86496627153782157;-0.15076215573655213 -1.0587802757357545 -3.1453004941899234 0.6942711162591173 2.5626874104023369 0.14203337932102542 -0.16035055401670403 0.61411192656034952;0.87218823599406159 0.24188862463202429 0.81901999849071272 1.0222703199373835 0.44239246650301201 -1.5034664581898609 -0.068860887664702955 -1.509356269791799;-0.28065943316026126 0.66793909664306383 -0.32874057931237055 0.30082099202018314 1.9909631762711073 0.76759160302826868 0.10086079257479555 1.4405226609894324;1.0891377729359906 -1.2143947560896329 0.83937169775672471 0.18171481603455436 -0.7666143221886047 -0.78269611925918203 -0.47050067828698461 -0.51133695870621398;-0.67010645682022674 0.30046680468349846 2.2561777186680096 0.30660407959604752 0.55070103842076579 -0.18543542806413593 0.6134733638400226 0.13626193619228338;0.37040183798289672 0.13966842878300231 1.8161693269554817 0.14411540358635655 1.2453608279529429 -1.2937464946316113 -0.39277125605128899 -0.314788185916901;0.44406308608078254 -0.46009409322964573 0.37572503395112661 -0.28559541098711066 -1.2288855479116623 -0.72993135930436048 -0.34762842842152136 -0.42262579720463717;0.42084029759988678 0.039235075412954047 -2.1034359889854706 0.1174189172506751 0.51084148308035171 0.35456505904563212 0.085989033526110981 0.34263767228627551;-1.6370926881866303 -0.10111053109429258 1.0903467453145068 0.74540786790444169 0.73502954157502909 0.43408839515500203 0.59829484197415328 -0.74945902814563037;-1.6893168526092135 -0.35542168581929323 -0.80876151979237398 -0.34491581414210654 -1.5245489862666108 -0.22913445905019675 -0.074949667635033579 0.93481535491413092;-0.30439396826300569 -0.3093158045576419 0.35760358259926806 0.31241519256507055 -1.5739054310158982 -1.6018502092580602 -0.29439435420610816 0.90877656053549438;-2.2125822307479286 0.086548878692082595 -0.50472509744181759 0.29591910871607363 -0.54389173157421566 1.5807433427844386 -0.62629089473761934 0.96323556638303487;-0.30825126131791303 -0.38272073931395811 0.70391093800962623 -0.010059703367892447 1.5250667671160181 1.5401974313774831 0.46994390135446323 1.7384516008055213];

% Layer 2
b2 = [-1.6253092184755826;-1.4853571423788789;1.3038313248848004;-0.95207999383461617;-1.0300697959166665;-0.71209252218181873;0.79900996702509586;-0.1675916309830488;-0.44306287507280168;0.083681726020241501;0.12283772863453457;0.34046376843122617;0.57472774764045265;-0.71539810780832236;-0.51129139089010889;-0.80982467169310079;-0.74439326086682744;1.7259935242589524;1.2385161878217164;-1.6117967891106164];
LW2_1 = [0.50633852822070002 -0.37833438840722439 0.54290570544970163 0.495460558128068 -0.72929188415820179 -0.59615611555724046 0.34647978788627642 0.13020549068296144 0.40757381219405314 0.35493085864709728 0.41493528014100389 0.19857954114252618 0.63362755672074977 0.037502916457920754 0.98183987243619031 -0.78608067125175229 0.53820855939892753 -0.21490076038848743 -1.3140134130773009 -0.43566303048039301;0.54100684517764808 0.027169776765495104 -0.087304704944314984 0.9225957068375259 -0.082363960022849361 -0.080832346254944648 0.42099062415347477 0.0024470713174012762 -0.35791539080493873 -0.038679373928806583 0.98913913864531589 0.3410946912658766 -0.5408187161700323 -0.55955212679855548 0.39854968674465957 -0.51957632728456016 1.298410563546053 -0.49600618886477721 -0.59138107047073085 0.54844024864505925;-0.055857865969709333 -0.0014392435740243504 -0.30903701754853918 -0.34352548344972572 -0.23524959638421425 0.35758306447759186 0.09677477393705701 0.2061302651735091 -0.70163590949524945 0.78921353581829823 -0.48426399663145003 -0.79440136291462571 0.30683865441232494 -0.64806142638582587 0.48095776455860056 0.63073187785450813 0.045165421044138516 0.32097411590320524 0.43676859755626696 0.1824532885728038;0.20063664960089658 -0.64841370481515503 0.48387943368856734 -1.1024787673069723 0.49247838010429618 0.10367136680550337 0.16064454703751266 0.0013012978617252154 0.48244981922727015 0.3673598938271721 0.48172162058827567 0.36201586148228743 -0.14282970815879337 -0.013116757989273784 0.58050144449111807 -0.58654998067861364 1.3901188184197129 0.61846032473486745 -0.75818946878585891 -1.1153072287745691;0.15486793432634643 -0.10076399985075843 0.89446032900820305 0.80264225968624436 -0.54709405687070189 -0.3995380128781636 0.14357455673912708 0.80258946715816581 0.70502032769087941 0.065082308425114171 -0.015628673682176873 0.28285248831749449 0.57047106072610476 -0.39550827114907183 -0.51691708836863948 1.11155671069356 0.83638230981202277 0.44508287836104532 -0.34272611470968123 0.22059515200499341;0.19588080102890479 -0.36733689624157123 0.61995508782911868 -1.0512910647484359 -0.41779836137315363 -0.94845543789943909 0.56110821347691864 -0.17031132771283614 0.23727164550863866 -0.32646026629070141 0.41046412438996521 -0.19033425210287169 -0.53152925667791906 0.32929510345869734 0.2850948964889165 0.47933529684957632 -0.46053312406140573 -0.039437366946642259 -0.19978681807001952 0.54371613273868646;-0.021508184234786377 0.19098516824483544 -0.15535592678239585 0.46475293263909845 -0.32512878408743379 -0.10696171319802836 -0.14346876937616848 -0.018624959402114859 0.15008584064143682 0.35541412862642791 0.60172813991451168 -0.10046079963535266 0.90568283870823463 -0.08667827058477337 -0.47664287105251285 0.47385989422775043 0.013587552327499204 0.033677913273078446 0.35913886853841348 0.23379148437757466;-0.60495313312121601 -1.1229255236193478 0.79646564527437502 -0.7134197143100468 0.56884987227958739 0.094276965150313696 0.13964535314753274 -1.1307506474275013 0.15538382090519401 0.61205305605087279 0.81272968970796766 -0.8646610744213038 -0.12937283230911922 -0.10309445235017096 0.89630378464397364 0.52832608561973704 0.96806861422367096 -0.63883846068725836 0.39471613115652082 -0.60928783254927166;-0.28971609014751504 -0.35486558813612606 0.22921331126355726 -0.014355113798299294 -0.089627475374241636 -0.27936733651918766 -0.67240956533695462 -0.16929504204977422 0.50295687061567218 0.28237794605527111 -0.037650081984655706 -0.26983685579797861 0.27478949652896689 -0.17719138800933373 0.22773884776270828 -0.053294850258546668 -0.67158250506355155 0.27012785126690009 -0.11196001036581463 -0.38351331216327444;0.11205994156762099 -0.56335651970206824 -0.46207380762146266 0.097531936274318776 -0.50922489304959806 -0.74234218773605976 0.20023433799820145 -0.61925621871679692 -0.2735427510264537 -0.018154974185356786 0.43232065345609505 -0.54567285525532638 -0.11536329051189459 -0.68883764005113934 0.038756384558919658 0.20176579953288404 -0.47230487498756946 0.098660322048666219 0.031766486183372564 0.61966335571038633;0.58642249522845624 0.40014682388417466 -0.58174204954036068 0.28650482207094735 0.021560449439339449 -0.3924147366219437 0.36037096067485597 -0.14152130361094212 -0.79445386707503385 0.064244259761285713 0.24053937370195733 0.05794111334316783 -0.72012304652863368 0.4375515719934483 -0.58190796760774477 -0.051160587955047021 -0.35524574318089491 -0.090599969369166727 -0.21561782554117148 0.79836544797507325;0.75066287724987901 0.047159031706806791 0.084695481523967012 -0.6165620009180901 0.57789139661255162 0.48422258961719805 0.49362203568290547 -0.21560361378225182 -0.12873980619827566 -0.15898433144540056 0.098968935502754124 -0.18378904643386368 -0.44349869274334924 -0.097237649216082397 -0.33026748877301454 0.35816030578752467 0.12849943794820129 -0.88372147740276397 0.29186160919601484 -0.035674851936716552;0.16248233068911941 -0.35718328078101713 0.056818470915790342 -0.33690781157497168 -0.78019221579424336 -0.74907359727737266 0.73822454410448235 0.36675833430636501 0.054598265560468352 -0.45311559619443442 0.16187863405663303 0.3561810594216312 -0.39195573481629131 0.24826538083096655 0.33660522341009691 0.064020690914718029 0.24936330603939175 0.17119008160714985 0.36210358829946349 0.52879465916539448;-1.0641924636562288 -1.1386038294906353 0.55925570510614275 -1.2497112648771294 0.40503343488749699 0.1310915652884313 -0.69253968094630391 -0.96673318103244976 -0.20245824981016619 0.1374624034963198 0.49193000602255266 -1.0182694823259812 0.53541265245742009 -0.34053938537558642 0.94517221716332156 0.71890941452559687 0.69704770808277994 -0.49674295214784758 0.26549452494309717 -0.27050490239045877;0.11202069486889132 -0.52578062777726831 1.2887477596769572 0.67005205027475556 0.7307734625779837 0.74759398860832249 -0.17166750636928979 -0.5986577160957085 -0.28067062064965442 0.39011002842046366 -0.48831388722276947 -0.48613741872165156 0.4747838908904648 0.3533566869649456 0.36330983669640188 -0.0016853918087293297 0.6418192268118954 0.5526176356231931 -0.56385401225236531 -0.019744404433902914;-0.29251908227302681 -0.45908253948724592 0.44865417145956443 0.30410398005841388 -0.5451076935241046 -0.85979683673704754 0.13851140459942432 0.42843077704658428 0.76417278342672035 -0.014720550628827178 -0.052955684288196934 0.16092539068757722 0.28811623087172034 0.28324635551252197 0.78861315912162888 -0.54568620022873038 -0.2796449871096699 -0.24386177436129008 0.60853528073205032 0.52145115154248878;0.26385738807049547 -0.54649823627873906 -0.39654721482517308 0.099712344789129215 0.54677097882656445 -0.67320150683494495 0.48904299945636648 -0.110455117435448 -0.60047513559552246 0.13584211668893537 -0.011194857513543573 -0.7949962909954269 0.67125732709323138 0.35092669380209557 0.56053061589222963 -0.7921278559369862 0.24767801168713272 -0.77483048671829058 -0.17099612534814798 0.20463334128604341;0.63101758837941535 0.12751383389969745 -0.067302796829563943 0.56401764104288921 0.25646674477778469 -0.72822725862230109 0.68777198694232999 0.60464790382722955 1.1824348375951235 0.2840581093002017 -0.036805065925478539 0.0089723000401179722 0.72808008920018463 -0.090751358047988159 0.48634961464585313 0.17003442069825855 0.16695446458936661 -0.55278252515639126 0.55441893315637614 -0.38597939177410062;0.081092275559134341 0.67356501452802353 -0.39369975288654258 -1.578371522020352 0.45980543273658503 -0.58772355428566037 -0.058485321127056095 0.33597714480771418 0.40596100402065166 -0.39983354559678969 0.25368325873811792 0.086081233720976674 -0.29126727672041969 0.27755846610433271 -1.5748637285994103 0.26610159094078029 0.2972552774230528 0.1542739489514896 0.85517115679929201 0.75759029105723397;-0.099477470197853954 0.45106977204508836 -0.51795778433385398 -2.0927103445862079 0.5468418792922578 0.041288101632979773 -0.51971997313859808 0.39432347908546816 -0.20009012302038767 -0.67071928211159881 0.18716959498928495 0.26241068450048816 -0.24110267117659201 -0.30134026804271974 -0.29968053959523316 -0.26258263150587663 0.78642031782577637 0.097975751693984162 -0.29792444723084682 -0.62599896386168652];

% Layer 3
b3 = 0.42040259667098545;
LW3_2 = [-0.25365488727609192 0.351000425161476 0.020683983102669983 0.26375828088249043 0.71928845271308051 0.51099787983424705 0.13933880991031022 -0.37755249241961186 0.53151020571252072 -0.34147494935778788 0.88359983336750869 0.90145574341258539 -0.29644548605567955 1.3971314797451126 0.27528982189087808 0.13753028613580018 0.19045535695688304 0.55594593064480724 -0.14016344063168371 -0.53235710504062994];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
