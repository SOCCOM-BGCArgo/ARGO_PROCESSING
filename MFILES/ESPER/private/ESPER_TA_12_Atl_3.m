function [Y,Xf,Af] = ESPER_TA_12_Atl_3(X,~,~)
%ESPER_TA_12_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_12_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.36362330131811743117;-1.2996485233087984312;0.96755970902504229159;-7.0060458378864556295;2.1131880613826283799;2.0044538938257145944;1.7561292959975303152;-0.46419444046195867948;-8.8540637348365827108;5.0331609884245116504;-2.1666125011508250431;1.6762600415890271943;6.8127600208050083097;-0.50083629272174934322;-0.065203683222370342754;-3.391538351120205963;0.32498824072373000416;3.7226509193939341102;-2.0929232895197569242;4.3419795236783524928;4.0720575167782637749;-3.7598499391566031491;-2.6184953944148041671;0.86481402941488216829;6.7322980792570765729];
IW1_1 = [0.69435716109833267584 -1.1028007601112566061 -1.4555219193222441731 0.10270301557428747341 -1.0470440860325400667 0.47187308761960389258;1.5403907586107319361 -1.2865416276877936763 0.75388301871417073841 0.39710815483060968312 -3.8999614817452958881 0.77305458343518851372;0.16428936991655360145 -0.89639798431502881737 -1.9037919279903383618 0.016785574588266540669 -0.30448830661848164114 -1.2304665830965084705;3.504184269026466847 -2.6242643325088010897 2.4544932626153546096 0.063217909935130087162 3.2289493759119713978 0.87977012526543796334;0.33559218875054069864 -0.1290206206791351673 2.8989553127109335406 -0.34379669210112284716 -3.5378726613519542177 0.60789885792966380507;-0.060302401197142758982 0.30309801738932556914 1.055324766661619007 -0.33979989903216939462 -2.2357772569950480346 -0.1204056982962497524;-0.29117747568086105314 0.097622841685450365001 -0.94509761580368900624 0.015197959132299546786 -2.6048559035930534122 -0.99632110830736508866;0.2020547637327683721 -0.34471450152423954716 -1.1154826258663352867 0.55575288626600860553 -0.52564662819370544522 0.5362542535658443299;1.5374360136304965341 -0.72566575885113060451 -0.07162579124434428901 0.52870115950370699665 8.3255175126397382712 0.81542647536072754288;-1.7029515204883358681 0.81992873937230414949 -1.2086357248427128663 -0.044445965141816222432 -4.2906244826851622776 -1.0948875859349018747;0.57073646843873337975 -1.5280171816970320453 2.5289160691693286509 -0.34535307215822891314 0.35754537947998621394 -0.033415934954706051629;1.3546642650380986694 1.199536907481772996 -0.58372623524331324063 -0.3821315336303229282 0.38261890000291592928 -0.11236379136167179427;-2.4771407336095090379 2.4025888692455357187 -3.9652218360603224134 -0.25916582173558028179 -6.049123797661128954 -1.3990840029486897311;-0.18256717251452161954 0.34589646776700544439 -1.3990283451510157064 -0.20660094893122513127 2.7334273545077478751 -1.4863802834417370047;3.9912133310818553866 -1.6777859010020850228 -1.8421262221466176978 -1.6726476568025663294 0.43484528572041319938 0.30545597655437389806;1.6264307962735082835 -3.0371596471619555224 -2.1168163547311360517 0.24108541074986850061 3.3475768609040352786 1.1256783649947386117;1.8115900747453066444 -0.8467673741265450138 -0.50384034444546343945 -0.16570424054785781731 -1.9829725656410230883 -0.53017208265113535681;-0.92122790634679529997 2.2946809230553242287 2.4257142463400303001 -0.15264483717239599181 -3.3384216112789708575 -0.34155466958194730109;-0.43947964820864299229 -0.8590392125232387821 2.3300801832909119327 1.2559987948444728545 -3.6316636846992897958 -0.96680818206862806363;0.669112506940188978 -0.068687538576104503751 -0.94211158636445690995 -0.58403293180061721657 -5.8078443802239130278 -0.7608600846275314078;1.8326543319103905105 -1.198609320750367857 -4.6246874337289280987 -0.48112213704088152566 -1.1875230862992751657 -1.1635831679351504864;-0.41601424382839158334 -0.0097109984020061906884 3.108753885734896194 -0.076216227937753275312 3.3549886778137629761 1.1666271478646408344;-3.1359320483753423403 1.7313115954103226457 1.858356897835785615 2.3421328791077735687 0.40726943188906589155 0.57820882070691259624;1.5849615392854661255 0.60999943925897914809 -0.58635852059604287589 -0.26486362095078785917 -0.15208715227979413553 -0.27576319654947595295;3.628027874815304088 -1.0028320849190250907 -1.0607693367969015519 6.5930759661338900202 2.8557805032912400023 1.1695397602413841742];

% Layer 2
b2 = [-7.2725097174902009201;13.18014693271434723;2.2042996388165470023;2.0007947284684601819;-4.7780596613596282296;-7.8988012729830998637;-16.920630535635080349;-8.0978427636185639216;3.0685563876891039925;1.407679454374152872;3.3131500996187623898;1.9195282987875461611;2.2964347022151194722;-0.55349698573998018514;2.8911679648155277356];
LW2_1 = [-6.5580622285370928637 -9.1645550643496829224 4.9833888059837692097 -1.8524019014514923054 13.415628010015932858 -0.26656520100021324771 -1.3238790718696085147 -3.0562354917307263946 10.805904192750881876 -0.56058961845452004447 2.0054086793713743475 -2.7490460185925145176 1.9091868768134432344 -4.3326419649969230008 1.7065014577306658605 -1.0973085872677525998 -0.32132549738169835507 -4.7035808504174800859 6.5438274063876074038 -0.61595585531543251001 0.23095104950995593018 -1.6440138256474297052 4.9368742991290508471 8.619552120201488421 -3.663329222029648502;0.99279903906335431607 0.59156156072556176362 -3.7045173355321190378 -1.2027171544157666538 -3.0817430139698327451 -2.2694162858325288568 -2.6621629826262096508 -1.2399539106563848279 4.561581003459153294 -2.095486969812826672 0.94092556174477626207 -5.522142350303663072 -0.44205801543171518997 -0.59279430561477641781 -0.47823048340217383378 0.71617904082942807076 -3.6803428177112409436 2.2127057251420541029 9.9670577574798393528 3.5112770479266286472 5.2694379113308107421 -1.8603738763388653066 3.3397595674046405279 6.0277997676800749716 3.261241805165926877;3.4657533650115794899 -1.6040730909336022858 -4.8714694343339255411 -2.2220250637182092923 2.173413358797811501 2.5808991410711223935 -3.9317874590228210074 4.115595970441768614 -2.862523921145442074 0.0086572435164456972012 -1.0651257757770078438 0.95135766473142724386 -0.94104926687836554233 -2.1193048019817242178 -3.5078310993899783909 2.2650318186673659149 -1.180746661424050048 3.0794625285965726569 -1.5952710116060537793 -2.8291503930083341523 -1.3003871542510876402 -1.9539308963863162294 -3.1068994862472072427 -1.2197895570096903839 6.581042320957902092;-6.1358358901855609702 4.3052983379036193767 0.045968838812342725786 1.1412132272803252597 1.3098904279965339903 -1.9835833656276131709 1.8561699701587175415 1.5961361671900056169 -0.88908106748075022008 -1.7365682828822412986 -2.5736461435620632265 -5.1968368194814669181 -4.3560641337705590104 1.6999578653839526599 2.7315583466105373134 -0.64686977985677795999 -6.2039626806185372843 -7.2123764843387538903 -5.6046422812319809381 2.2184814294555068592 -0.54161068680759982819 -3.1809496931150391674 -1.095863237144725888 -0.3384733772393994089 2.225751519201911055;-1.9916982220008772053 -5.6107519494229176615 6.1034833547887821226 0.96047509425112231884 -3.132448520464397923 3.4651597424481654919 -3.2673572033664348702 -0.1110273810648096382 0.53422600362909844485 1.369902736339572602 -0.034127642090308954459 3.3251178386028219514 -2.3306909687278958287 -11.413297419269960997 -2.7031695538524025402 -0.090902216932628648882 -4.664939567277016863 -1.1472120235721052772 -1.7236022731823255061 2.9755907728791108902 0.62104098041399091734 -7.425823072309510664 -1.120989959467186603 -3.2871423697700059563 2.8411030050539323177;-0.52781616465574443531 2.0741793524204381605 19.178677545414789307 0.2554718415921832797 -0.13785208824017183837 -0.34700726426066313968 3.4538120968528311927 -3.2666050480761144037 1.2887480695482758097 0.6967470184008281997 -2.774623562926454845 -0.1312177813617060318 -0.98540548787767434646 -5.8523868189329197875 1.0395103364774938015 -1.0726167511680986255 -7.9193778208260843243 -0.6151122400778299415 0.63152561057466949368 1.7865011659581222503 -3.8280006471388361433 1.2817052842181066996 2.937549019494281044 10.174019267934568234 -1.0840632044856834959;4.2803848780468669588 -39.889227809546866865 4.7277157023955274084 -0.29891654290159230811 0.68252221345237884531 -2.292556419272883339 0.5964779116891195665 -0.41543868816791768017 13.272236492518436179 -4.1671378119367359361 2.7865042862775899479 -6.9672496180735912219 -0.090555295335374055843 2.026868478451472555 1.0419205847777961438 -0.70650544375965362853 -6.542545405548603199 0.56731756244324582639 -1.5858403901893496357 -2.6557019630803604393 -4.9815956696632914813 0.45574911604847967439 2.1625521581964535223 8.3311100396348773955 -1.7749630087298831072;-5.1708266155269813069 -10.859722619007696309 4.6159810936717189378 -1.4999420334851640835 4.104845420479503737 -1.5581864602436028555 1.3215173382150178227 -1.3975120239420903978 -2.8872079108827799487 -2.6797286995043605451 -1.7460887620076819271 -8.3754800031602076871 0.54961511489671432962 -1.4713758267932608437 1.1139148845709538893 -0.22920397897109495711 0.49611083476240247503 -4.05096868071935301 -2.2892201370144884542 -2.4236674112869240894 -1.4382275529928674196 0.90340523819931195515 4.9371414399638817727 5.0522708944140051202 -0.30328834214126387803;6.5481223813992430749 4.8199170840427871809 -4.8204926504247662677 2.097781670658514841 -6.3790910662496562722 4.179566647921897804 -1.8624515488193280621 3.944996140634377646 5.9640356781122578766 3.3071599258921642317 1.5815202032503121732 7.7520070260977584908 -0.64715802864208360479 2.4236963961937427747 -1.3433059683341894708 0.50335965444594366058 0.142146014816298627 6.2653345376585392046 -1.1716587876219943798 2.8152855299932606492 1.3764155022607109657 -0.90655671793552639048 -5.0024132177760547435 -5.1022740308305358781 0.2889988320633917751;-7.4688669547260024828 -1.1008728111071655054 -0.73222854722801933303 -0.23623652784007898031 1.2545537212314166187 4.2731519948645599882 18.128536851185479861 22.319446091682095812 -3.6109358973557772465 15.410354932175602372 0.62255902807351415351 -2.8462546770911369975 -1.5208486215044545453 -2.6049782604558555654 1.3141832763250431704 15.518452099713016423 0.93792624454709294657 11.982737881181236617 4.5864981258434234235 -1.2195567752858575972 -0.2372163954625192972 10.548762510404934289 1.879474158857369348 -0.8972049029002215903 7.4368601584462252774;5.307234040880667969 9.8711199616379303734 -2.4947052384615906462 -0.12438405515241117427 -1.9420214154857504685 3.0329249120781409665 0.95213349443665817873 2.373339289964460086 -5.8771660556840972234 1.6920973663857608038 1.5483620494936902734 3.383698966101314376 0.1131611625733030535 -5.3895482547405650919 -4.4326123061324498309 1.716128254506381845 2.4195261308392543853 3.4795083568206495173 -1.4410819155844949435 2.3660810005427221903 0.3200248675547642252 -0.88921394871398673487 -1.6349221998794591926 -1.7654918369883247919 -1.4337153718031390159;-0.11600025529089927345 4.8878256295471507187 1.7832067279120065173 -2.1041636326971762117 3.0201802149013365906 1.6709184361388715878 9.3937642223119759421 -0.39213851966580903774 -0.26606363502678626043 0.7065892610633757176 -2.1608879676430858829 -5.3584643068143007483 -1.4223550632005734773 -4.0629181670639127333 -0.17452698669431235268 1.5781614022163896749 -3.7064823226945042833 0.1693999140452127905 -7.3855035463319200773 -0.8724483465471973842 -0.77463773843400729469 8.8383473683892539441 1.8593404318140231979 4.7513219116787501761 4.2057257521770923248;1.0932017759129135648 -6.0830319107510115728 1.8481592412192706654 2.698351749819432488 -4.8122315569086735465 -1.5158248044890190176 -8.0991377179633730066 -0.89225125332215393659 4.1258923453820397498 10.774199097751562704 0.59510764931695692148 -0.16996783113597802028 1.8891167909729973395 -4.9668686623877817965 -0.63363144913061608676 3.6969500783151176826 1.9522431734054368491 7.8784963169520940696 -4.4142014195001051391 -0.85471491044349434674 -4.0640403262890494318 3.2030543698449851497 -1.405196397483371884 -0.16101522425405384586 -2.0711213942774562291;-3.0611387255968001142 2.5837750911318853042 -3.4429143300743216827 -1.773750743627507731 -1.8772314187797611851 2.5704217954734658313 -0.7308380167465872157 -3.6764557148807384124 7.7282061253971541248 8.4707626651339111845 -4.5320051826386986704 -4.4375077804632736544 4.9903757581861443171 -7.3139617597463830734 3.2590766250649481073 5.5787686484389098496 -6.1369651580157222881 -1.4860546489798078795 -10.697290819055806921 3.7215280015437666172 -3.9040036780920108761 0.81815126630299883637 -0.49411260744106993981 -4.5770122855774761916 3.9795337084124651206;12.784706502639627601 -1.1723749545021160401 -3.8876313310023280501 4.0221329719280118908 1.7088500508260202615 1.1808066876002147882 -8.6486143423332251245 2.2382603102264000405 0.33405342824930928103 -5.8786016211576797019 0.26157663135426290069 1.0751167500072715821 0.14711464429166154488 3.6744786663707169616 -0.19361783813643759777 -3.8382704087991017516 3.1102631406178908868 18.169999656755180695 -5.0548009089184233744 4.0896520413606936017 8.7770871893414117437 -7.16278234744704001 0.26463916180070440332 -3.6462435590638344607 -5.0511836982392175344];

% Layer 3
b3 = 0.12434899046861631888;
LW3_2 = [-0.028067432317363236183 0.03024572767466460893 -0.024066606846897140026 0.0074173161916080265071 -0.0027895416340041781326 0.022995383775134249638 0.031920292385488803488 0.41152403331273590403 0.40316946334933512208 -0.0028070916837665874609 -0.011820986907316127085 -0.018086045797793489504 0.30863073715951816478 0.0022709742374778124109 2.2254247373737434613e-05];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
