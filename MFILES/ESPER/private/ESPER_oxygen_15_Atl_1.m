function [Y,Xf,Af] = ESPER_oxygen_15_Atl_1(X,~,~)
%ESPER_OXYGEN_15_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_15_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.5891525965331174675;-3.1817733421772769198;2.8171683179847777367;0.7201065863229114683;-2.3272623755212569208;5.0045649952418997941;4.3207518890827385505;-3.7501008035520513317;4.993074986820523975;-1.862473770724455191;1.0447030882849348554;-2.0723127830719305642;-4.6591512529715757296;1.4338097605253523614;-0.3571240530073288566;3.1704311437348211555;4.321681555359650595;1.1916854306563182675;7.7419800007818526666;-3.269741382053458878;-0.71985780240469998681;-0.065722585892834931021;-0.79925627944811050707;2.343014228774994212;1.1676573840025983309;-2.6917140938245509574;0.13771536135921344512;-0.43527609705875563995;1.8330308448655463494;-4.103481142254706171;1.8733900544507644526;0.87656210268730649915;1.6982713298028695448;5.8998320834079258645;-0.88662716589698364889;-3.4852179509784253497;1.7673762639936811958;-0.19273559442809132247;-0.43192733346473877187;-3.1274336663536259628];
IW1_1 = [-0.054415755654702413491 -0.040277270377743555618 0.10554809567402030634 0.25726847858717849515 -2.0518540161856413384 -3.4204312374665901686;-0.099042105461361620855 1.6661567571835478319 -0.50391473166775335724 -0.18701217183034157809 -1.8200606494497921783 0.85108668706666290582;-0.79619646057793003191 -1.4214603517025139467 -0.34412777586342996328 0.53565517014405805707 -2.278774213706778351 -0.41079349279571159004;-0.65286819155766306899 -0.26573374386564829752 -1.2630906675035917797 -1.4390911158236883161 -0.94326901433718823853 1.0246630499509137291;0.35176253583895233934 0.086205778864445026244 -0.76986185316823707581 -0.19871630645699547846 2.4700976192414350052 3.4303954671590957126;0.87183755688406605611 0.33771974179631863988 0.044289375781913470354 0.87478806978657774884 -4.7310634794089256872 0.83641675242089930098;-1.3364422687581385407 -0.43655372908637868345 -0.20851930011954514232 1.4172839157192598236 -5.0387428799892060027 -1.4842624857549986395;-3.5573681635095280029 1.813675338315622998 -1.8708919913044719241 -2.7936227612686588273 -3.1629354463941736775 0.55586905986636958588;1.5724305292211484542 0.006889618701692606928 0.54082376957869793266 -0.54668563383192936289 -6.4964631189728834215 1.7899422889792064861;-0.10820872012656018724 0.89012670002814453518 1.7991391070454716417 0.21025045016704912992 2.8713383946004156222 4.9929932344800906918;-1.9858223892772595143 -0.92465521138042516824 0.021059805175439982872 -0.29979889841299262043 2.4169686667361189869 -0.086950290050482909043;2.2079328933150903502 1.4221781908936874661 -2.0032487018359135256 -0.86360631400072807029 5.261543227078108842 -0.53927921644044640725;0.68166138454044611361 0.79921323239289476792 2.0039983430382868335 -1.443298644248100393 2.0005692192964561471 -3.1065518773551041853;-2.8885795071577962112 -2.1365277036315273307 -0.97730537688301266641 -2.7106830076799917073 -1.2219507159070643887 -1.0921836739051833387;-0.042640904103366988886 -0.21792683900021300736 -1.3648415775935298644 1.7067044461935729771 -0.1379086210199238216 -1.5368717980670867362;0.13742906870143040132 0.15602768031913089031 -0.74651001804951366836 1.4514990177345548084 -2.4151195884486678089 -1.2427772464760658;-0.50357024351278156793 0.80124976980674256222 -0.43897742803806366618 -1.0631839283181698796 -5.7643152048738333093 -1.62315423036699924;0.1140930383174346141 0.21078194422562848698 -0.49264038072614785291 -0.70967991073852332296 -2.3978326776898346573 -1.8128770201884516489;-1.7195628297813743135 1.258420773173670959 0.48891366096821753384 -1.81606408310302192 -11.180080793820595275 -1.8080333099106675743;0.25686902710322617738 -0.14063662849090563522 -0.27229249587713172387 -0.96702701371155230792 5.8210122409444249314 1.5850243208874736922;0.93548289334131184969 -1.5159165743362683632 1.0784571476597504258 1.3075914005360063097 -1.0987080007182532526 -0.48255185916462023377;1.0703973874327545879 -0.74458422235138954637 -1.2227727504406769032 1.4031747668791827444 0.86714388327047764449 1.1860507983463184356;0.89226242572484404381 1.0680017492853752792 0.66324190992246401244 1.3567370697360132681 -1.1017504188743303395 -0.38087544109631016331;0.90301456338645458288 1.2637008068316937237 -3.8783576024772115076 -2.5023174665176775022 -0.10752397573621444438 1.5518241851217999816;0.38628954438249063497 1.1632265722817500819 -3.1779279266339282017 -1.5197349298461431122 1.3351072919508373271 1.6339287385043987921;-1.2473301790933333244 0.082310329358215528206 -2.4658373384549836516 -5.3524553161482817387 -2.5210963378853690209 0.28247599665803541091;-0.59871479489178736078 -0.66081562208132094138 -1.3248853137343366004 -2.3912628607832999705 5.1116762866170013524 -1.9655110376638935676;-0.87874402642119908702 -0.63557701000469413177 1.7565002433221561517 0.36195869528378743496 -1.1922370411899407827 0.43550515955976626392;4.3404998138332224755 -2.2505171934543564127 1.9448940842766107018 -3.3346364672845529853 -0.53285588384391668892 -1.3998974733095399525;-3.9875911469201938964 -1.2962105542423256743 -1.1678181709177928305 1.2608146729374267725 0.83456874192120611422 -3.601228174710302099;0.20952711480254879173 -0.96393134783299405655 -0.55951767341250069343 -1.344825281543195139 1.4856969882537183203 3.0090054230984568662;0.84036093761347852027 -0.48200571964945010395 1.5170686649873821317 0.78780491938444718869 1.8444744520577127656 -1.8188688938554680163;-1.2512217238364926608 -0.4464936247952820958 2.0662981610952133593 1.5042619607210065968 1.3798555019156004686 0.92636561151558094451;-1.0230190746088343445 -4.8897163401363883395 2.0895031348619990119 1.1363497490693705849 0.24240865847134127065 -3.6322056976760426217;0.20967943867352911713 1.6670297999252650101 -4.2574579564988717095 0.63924430039399926518 6.7528238292886095806 -0.58422852286599991078;0.5920061711446408248 0.9247889388964249946 0.59507388689356277567 -0.49674764376066821159 3.0927138775219025213 0.23346723211302747303;0.61729415350232819115 0.81062380044522452938 -3.6549598174015165419 -0.32228755804175174271 1.4350154022173837731 -0.64366122124356184298;-0.1306730494071881854 1.5716902759322404215 2.2873704128849734474 -0.54068829587274003234 1.3933627756211182103 3.0011316012275686127;0.72713427139107411623 4.2930316539418553745 0.33839916934900815537 -1.3975548500249403983 5.7197745087780038631 -0.45626766731694590185;-1.3037503864379433871 0.77656708370635507688 -1.9937353516482856364 -0.89176051245722132155 1.3951150840594328528 2.1279198158716519096];

% Layer 2
b2 = 0.61670341325166477819;
LW2_1 = [0.3625878026523582931 -0.36276311399373162292 1.2018273677111419584 0.24810735668669972598 0.31033178980973130656 -0.62848334262502059122 -0.14523326800129662817 -0.23263530511936139633 0.26034633907961157728 -0.053250844137427533198 -0.63893949287299534046 0.33808769982686104338 0.11144252958485251215 0.030224269168776910638 0.17028843223411296859 0.61618929690960377865 0.86130101150797455656 -0.64272821137210189857 0.2769549028244466804 -0.38618480801684162973 0.38410928047416037501 0.64286339160413763505 -0.29196521281047066454 -0.17395897918312114294 0.38047596753652634938 -0.10965276970390346045 0.61534437006100806133 1.2633417993030788828 -0.048647710523152629114 -0.074299512886932414513 -0.3922032188265633379 -1.9798184819020501202 0.24191963989585535399 -0.058453140132087952341 -0.30090282415519747916 1.9801139478201739141 0.73408775486611244077 0.073417122995074635128 0.058412280279662151528 -1.3999839885822611407];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
