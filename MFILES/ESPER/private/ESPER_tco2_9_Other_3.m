function [Y,Xf,Af] = ESPER_tco2_9_Other_3(X,~,~)
%ESPER_TCO2_9_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_9_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.4099338162050596;-0.47768120905633071;11.369023029132936;-0.11916665094780918;0.03537599194463914;0.42325254076221208;0.30421542061255691;-0.40011735647271213;-2.0765976187607409;3.709923509056519;-0.17414076436129;0.94375153805045575;0.95586290460020462;-6.0290156001443913;-0.046210274091794831;-0.079664896278142106;-0.6862691391263841;-2.3073356529673399;1.459181053918942;-0.077605119541036077;-0.87033490785631917;1.5765674027032293;-1.1582738775585726;-0.34684525174264791;0.16559184069830199];
IW1_1 = [-1.7795488298175042 -2.1593968883598684 2.3648176931101315 -1.5841788439301219 -2.3272599386750366 0.28083333453976089 0.11177922097821043 2.068224139654228;-0.2296444074685311 -0.32970256598842562 0.30347295420147669 0.38319073325245379 1.5152004451337244 0.64495307802032509 -0.088912872715215072 -1.1543291787227488;-0.25880018920243603 -0.12126614534682736 -0.016119600456046618 4.673868144368619 1.590002481523344 1.3595548878481825 1.534521936274907 4.6940764767483003;0.21799480988388112 0.24582307291140282 -0.30781997578444698 -0.38206439282745858 2.1031655487837231 0.39305504851331846 -0.17256733448123768 -0.37486112299868696;-0.11232771807113109 -0.045027468944748711 1.0803338222455705 -0.066681303020858521 -1.1962752345171506 -0.20938807878058835 0.080075320928082186 -0.97106774598450163;-0.18009156926748121 -0.10828839284359183 0.052919768761231084 0.38960589500097731 0.05650344090261384 1.1074464850337076 -0.4564970590619904 -0.61608155837275114;0.57196250491174028 -0.80141925421693561 0.038655532981887765 0.10077206965856643 -0.53381402823680268 -0.6217197727462036 0.86181156805214065 -0.70851402889471504;0.13503936594374463 0.50547973755026498 -1.0963528470468886 -0.41872134640881542 3.1254455611041858 0.51690723012820072 -0.47368485839770264 -0.010721159571402235;1.2139250210788379 -0.13527792009870601 2.0389717417376998 -0.31256574726115238 1.2815720449079178 -0.16884794192104177 -0.39032345372160038 -0.98011277626188342;-0.13730946165093352 -0.44671388380808746 -5.1546130792254079 7.2324340454266958 2.1799171407383691 1.2746752766252889 1.4646614053981903 -2.6651032497729585;-0.004853989430562795 0.085561022528890321 -0.40404020504621396 -0.054106466707822057 0.097839769710568555 0.16988352821516101 -0.43406516246196652 0.45279406692546825;-2.0195586755378598 0.66951688970406298 -1.4223347152011845 0.76722117302772319 -1.4240629620527419 1.0902971119737845 -0.26107204844059384 0.98441164438863316;0.32160847061855191 0.70243501029852695 -1.6839089298557386 -0.31293508213771304 -0.58507874615557709 1.2402953913405932 -2.2353592458109599 -0.86149434600472474;0.31614712884262253 0.80514913772238783 4.448282521226731 0.038466658590067822 1.1490114935803515 0.59867824975762796 -1.127117954383438 -3.0276918734073237;1.2154042867562358 -0.49775492654030873 -0.92737461285615408 -0.01204174642394548 -1.3470765693026081 -0.69386992658483637 0.93157355804625941 -0.50629232751739273;0.0016304944260265761 0.04429116234353294 0.4208024651833423 -0.03751930202010275 -1.0094719928432752 -0.55515753240115828 0.48011290452836713 -0.76807500497707815;-0.029105088823316829 0.90551886801517534 -2.5596443915045723 -0.36071761930573049 1.8192552891987346 0.11152601684594815 -0.65450135133357679 0.33368589940703869;-0.43644382287416156 -1.1591126560178469 5.3234922283940769 -2.6403626064958798 -1.7456092175303239 4.0144415212220004 -6.6861233991375109 3.3181362939115062;-0.15397974762296684 0.09247763318498263 2.6394790927914986 0.65483338492145815 3.4007928957207434 -0.99001271854557338 2.380225584702246 -1.3841842334844809;-0.020991474684154306 0.14359920790497863 1.8951605953038035 0.046453878164327084 1.4876948212566981 -0.20062236450256687 0.65924408764295039 0.59492647901287965;-0.26038737475830781 -0.093437977798301347 0.82166712322475988 -0.26089569193674572 0.80326074645190804 0.57339424392950078 -0.88865003672916909 -0.5206210739688113;1.2102501766762299 -1.9250378454992285 -1.6715216392532395 -1.3772984788172313 2.1374291248845636 -1.3991321343477676 -0.44521083059301919 0.13367923346356964;-0.13269414486246586 -0.066658315940161292 0.77234231086066474 0.59821157501435396 1.9091584755037216 0.63742867086567512 0.5831504598857471 -1.8618907390153658;-0.12731040734764104 -0.18467435031008089 -0.061776534576598305 0.2890742908327773 -1.2061180204484723 -0.11274786601019265 0.57559823594714565 0.31783043011800027;0.06453622798840733 -0.13791066557708331 -0.75493485506288949 0.13156097615466997 -0.40460259267637355 2.2625482107573016 -2.4991622804586258 -1.0583675578080405];

% Layer 2
b2 = [-0.49902407094695911;-0.74444275305882102;1.4264503796820758;1.8942280575237376;4.5832807772745721;0.43367145103723892;4.7108252260674703;-5.2860921097453639;-4.3328345294445301;2.9862408959401088;1.3050589285023066;2.6567653947492884;-1.331352262346797;-1.2874338880963219;0.25212990642225902];
LW2_1 = [1.3607036239944168 2.5206595808518739 -2.0196260601291378 -0.45434339696490555 1.9048048247706066 -2.1002115741264054 -2.3463470284667967 1.1513355462466159 -1.7630001421600223 0.79663378723340472 2.1251132187971566 0.56731566813921608 1.2668228787934896 -2.0020635017486583 1.4516872067728215 0.85288726670407333 0.049661430729046087 -0.26985108886427284 0.60229657171554951 0.8416394033418434 1.5247863867180667 0.52308886847664959 -0.70477186990265572 3.4096424186788115 -1.5183124315926653;4.171436970063982 3.5711120130170872 7.9133904332513394 3.1726373975416737 -0.047939239282663401 -4.8993800114782653 -1.2254600420431074 -0.68576708899319616 -0.13520794697277652 -0.5093917094935011 -2.1705929947932869 -0.3818164930718857 -0.82760890146213728 5.2566621428537017 -0.22000479554912275 1.7135582653534687 -5.4809874679684771 3.4000922375559317 0.42144161551513498 -6.5128812981115267 2.400603977277703 -2.2259060238976085 -0.64374446469882152 0.69375282182674092 2.0956589730908806;-0.15334942140896396 1.0209590921001359 -0.3969171660874013 2.448375021857911 -0.80648860278055545 -0.15516898166496901 0.54483015838031501 -2.4731009018301942 0.91751850797585111 0.39837046701515128 3.1344501552093789 -0.30415687030656458 0.84209734275526515 -0.79214333621176891 -0.099853233813006745 1.3818171047805803 0.53704259166737844 -0.029084438082523062 0.075392498131799796 0.4563934796404393 0.56199171009959981 0.065078279487547075 -0.45274424525760226 1.0233027155679242 -0.38226355199447143;-0.03920092317601024 -1.4316294333352926 -0.98431329333552253 -0.0107716361083225 -4.1301894786180586 2.5127319736596072 -0.84628584470824819 1.1235117873681326 0.38306664346130659 -0.33612742991098582 -2.0167792773249809 -0.053668536229237437 -0.77999675282607772 -1.6944107715940007 0.90272609733741749 2.6370126663760707 -1.0324169425307221 -0.137760855697767 -0.54805592202080788 -0.21226741330581178 3.4083664508582108 0.31239724671327962 0.83322006371207125 1.3624879081590755 -0.66560672774810459;-3.6062698194499543 -3.0363973436484715 -2.5455326824755709 1.4792574055535892 -0.12243663963282872 5.6816614277194004 0.81693585246533718 -1.2130957003008742 4.4393473086434412 1.4199854261198264 -3.8143706904834045 0.4460222234275853 -0.38669643375058366 -4.4260573547901743 -7.6781340349044545 -2.4909213493667428 -4.6046384342156843 1.3988219569524729 -0.0046695307109290542 1.1646345711905346 -3.4812432812228193 3.8231939365801799 -1.0403835645348778 0.03205547413651641 1.7511618360469032;-0.043674337922021453 -0.035136548137723309 0.11989412340300583 0.14387384774145473 0.22642267132736527 0.12320664863419815 -0.04856905440913626 -0.020235452148122661 0.074746685462074539 -0.040775677404615074 -0.93826231319482145 0.019604927142829513 -0.1333707952845633 0.10996138693382221 -0.13767580027558901 -0.61369316536600782 0.024901752940129078 0.027462063602275568 -0.031638576205474583 -0.097195513130672706 -0.44669031397514475 -0.083876078261884035 -0.14658802023910694 -0.059530438941216512 0.091359138599285308;-2.4829438551720617 -3.7476594878308691 -0.15310705862631699 1.3262700432863217 2.6155168577075179 4.2173164158714087 -0.17173168973021308 -2.0010241611023805 -1.9415435167509847 1.0856772552671958 -4.8814123736764579 -1.5502778292467034 0.077711488170834286 4.3002760435005021 -0.64493061906667004 -0.67787244005715896 2.3389141176549053 0.13393270349046921 -1.110684441500174 -0.37233887106677338 -0.88264839347666657 -0.61791661076293325 -0.38805523162967204 -0.31912226899455914 1.788249551339999;1.2376200249348839 -2.6781219220179158 -1.2141214094774853 3.0067491415629632 -6.6870255513024048 5.2378185583723624 -0.1269082490092224 -1.0358438049285921 1.6236528595613444 -1.4674564244512101 -5.1197004790924163 -0.60571463545041848 2.2178149189105811 -1.4345264818317121 -0.29838801405643922 5.4270006857142166 1.0238812227856358 -3.1414731781522933 -1.0509957301606165 -4.3307775924602421 5.0231380287636478 0.44215150327135233 0.63418164012337286 5.8053385038109671 -3.4209523386526741;0.5783321944859614 -1.8502117353534089 0.75625000787770369 1.2198496065280136 0.075086930571726163 -2.6374136279094116 -0.71131103639530979 1.4520910748457074 -1.0139660655952012 0.44245014897316792 -2.4982390442232534 0.09806819307357699 0.23283073508572449 -5.2839956565352146 0.61971274697958689 -0.29294005550038926 0.13465313866879433 0.18182859089912407 0.16191934607153083 0.28988376655452824 1.7158698581311143 0.020972613780272861 1.4776782565360758 5.3299289662902423 0.46107074131777842;3.1574374573443271 -6.2266077198918577 -0.3198154751902077 0.86484815716536456 -0.48117805724775348 -4.2216906146934772 0.70379155746254141 -3.1033918891508763 -0.44456147893649584 0.93471113207421808 6.4958343327607491 0.83083111262619402 -0.26740154643129199 0.7127465083952812 -0.0025986836444696266 -2.1298570455749908 -0.67093332697905983 0.025146011515626898 -2.2251828813566488 0.81888817958282945 -2.6698142659503743 -0.41748341961435631 5.7543835081302142 -5.5809660916061725 2.0939948278457625;-3.5650620177172492 1.4441391331021975 -0.018110097305185393 -1.9902751859974877 -1.7778020390526359 1.932591281373883 1.9499762240032563 -3.3344274609807947 0.59565702487774264 1.0248197077498582 4.2570145345425123 1.180334473847324 2.7352291813985277 -1.4449344803548461 3.7780478776010558 -0.91358414020508083 -0.52837144890252108 -0.59433754597978505 0.54025301661752023 -1.5172681744683061 2.3504262311987687 -0.26858882241358328 -0.89214311957598058 -0.95062298770934406 -1.1241041323296781;1.8725688777530449 -1.4512191190331345 2.3089167638664736 0.48726678987826172 0.30207883322392837 2.8571221127818478 3.241817852989874 -1.2713803061239419 -2.3571090438854787 -1.5417337514102636 5.7435676960891016 -1.959736018586953 -3.1786547452268969 4.6029380736965644 -1.3760013168559391 3.9116787627706282 0.93720786176930893 -1.7003885497816984 -0.90784290216508923 -0.30648243203060366 1.2739641422521839 -0.97263096263072879 -0.88714661074243506 -2.7138598097887301 0.9352378893732004;-4.9878392015580708 0.047786028364433679 0.12090039141488029 -1.9057023425728434 6.8145306831573267 4.3907676691486932 -1.2389489649464915 -1.723525540157093 4.1722798798271796 -0.3340509508846618 1.4802100947440526 0.82082019608310652 -3.5527016912466602 1.3015035445537333 6.0371700296732325 4.7212629919403755 -1.8497148543837409 -2.3464818863861332 -5.2752268745099062 10.924732179985147 -1.5481544477453646 -0.99485903933370057 -4.7500872930838627 -3.812645144799073 2.5450963154138884;3.4061510326055218 -8.822668271743396 -1.1554372561038522 5.2212625842359195 -0.099316811208255251 -0.90062497850657519 1.9499250306780875 -0.79966492065785955 -0.90076072872023283 2.7776046114974524 4.6923061788609823 -1.1025592656779173 -5.040686298361587 -1.6793848202637667 -2.212868606352477 -1.4921951840182455 0.69497608245416809 1.0952125261907748 -0.24950985985508353 -3.7386596302479833 -4.2239048882069641 -2.3759732756942955 6.4526340120412593 -1.6086955258852262 1.4985037547615883;1.1596894777136957 -3.8156850152425936 2.5350604849914462 -6.8275461398035837 1.4403258475857894 -2.465989273864662 4.6703712783520599 6.4659297727579004 -0.57878986500266572 0.55266260208399531 6.7181500240667642 6.0673276070838975 0.62513738784124806 -2.5215960038501497 -4.1235821682842335 0.47961814894480242 -3.5517986168885942 0.46397451832077247 2.6091229746605107 -5.1167011517263097 2.8452659641561935 5.875679866657725 3.0547016722665061 2.6724139539687717 -0.26945986222931562];

% Layer 3
b3 = -1.6214752698269874;
LW3_2 = [0.056282390037665206 -0.0090247281767907427 0.2674754494116694 0.16144189610681695 -0.025577171027753275 2.8322049487292849 -0.042252975973983149 -0.22313510551843149 0.13462026305620964 -0.055344033894003254 0.012038609451964779 0.024116458125881368 0.024875355475792813 -0.011217439014245198 -0.055829340404110958];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
