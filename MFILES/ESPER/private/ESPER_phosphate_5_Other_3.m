function [Y,Xf,Af] = ESPER_phosphate_5_Other_3(X,~,~)
%ESPER_PHOSPHATE_5_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_5_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.2910053862014412296;2.3507453443055608133;1.4817873646428436629;1.8305650254822118939;-0.54399852360413880614;-0.74164324873808562533;2.3175074485524795875;-1.5223398895649136175;1.3988808630049132109;-0.8556039786864321206;-0.74014205675064304035;0.36286828289887085308;-1.0985984699001156706;-0.18726060208000416818;-0.0027535054170684481953;-0.080311425813136369523;-0.1613986064869081527;1.4607218577356226863;-1.6489723290136193423;-0.62445594741534371508;1.219960283473399576;1.5187643540731057268;3.3313066265231769947;-0.68698314640007696052;7.2868494970159174429];
IW1_1 = [0.0072117453156928870706 -0.012455823720245225855 -1.1513417134415395715 0.10896094121841308489 -0.6050206639074086068 -1.2991445868067725833 0.45462401310451233671 0.088849291303831290367;0.29057347561716939666 0.68826593855451700943 0.99742566022147916005 1.1311350621851679055 -2.6261194083721877135 -0.56311775300964006519 0.12350090442111914812 -0.62791250651615471146;0.018746847927308751131 0.31661299800915304603 1.3675945117966845643 0.32041065963928494487 0.55619258425179363137 0.51383716841041149337 0.25972830603142510464 -0.91696273559306051837;-1.4862011441384193056 1.9150610259036484617 -0.73033651285787526408 -0.6550565001216336336 2.6969497417439818321 -1.012813367435070111 1.1735145203368655409 -0.92522779865248405695;1.4800991980736120102 -0.78116565351440536702 0.74088849589628880121 -0.68689738746812289971 0.34128061012789490114 0.81179951488495072365 1.04801949818327933 -0.83272377879805448142;0.074456823571862632005 0.21033614785232029876 -0.99191482791306495592 -0.064921884796697124087 0.62334590841646131398 -0.87514408945535060447 -1.0055511433410231348 0.10538997781201267512;-0.16232407182215363717 0.45167764420684847204 0.70629440770288320905 -0.3423648309652663202 0.84997809670774027158 1.3648965196440230319 -0.15079375763269720068 -0.77477046890496859;0.11777787608489033444 -0.091823541278156742274 0.17692663281612353021 -0.95970718763030560261 0.065680649371873733866 -0.40255087898964214688 0.74520712708186576112 -1.4184258410284897867;-0.29418316218742002199 -1.1001407194447387905 3.5848646005679385418 0.34718247304639582307 -4.1935478454727643793 -0.6729016011217832105 0.36936073326721463594 -1.0337131529975955857;0.13946848056352728618 0.17029318069999466179 -0.28935853627014529454 0.48992553438430319623 0.21775212368620969206 -0.29132810694403665774 -1.6352189862910897489 0.51355375071497866291;0.078697029680476301983 0.025034453445003032601 -0.49352241967709109538 -0.81667606094152433993 0.0075860530687072288622 0.64525744836485632305 -1.1756134892414384918 -0.56888650289369357971;0.01452926062627354041 0.30861992553248907001 0.036258508135614167522 0.096375731094191993686 2.3953035529378490232 0.38201614123333704764 -0.71040573448282851032 -0.55427964236852356184;-0.056818940880681512162 0.052780768377706926975 -0.018022956020433040375 -0.45908476040255763451 -2.8612085105470002055 -0.21536394485347859495 1.3006495891881986182 -0.73253329033288960837;-0.29016046931778893825 0.33392952443050388789 1.2262262364271869775 0.016080584111754000348 -0.33761840745951615661 1.8248706691917988554 -0.20836758044691544578 0.48906203767045947073;0.13909068070778668469 -0.90662064592141455854 -1.0717127916303423874 -0.21273204810549192767 2.287871227733177637 -1.0232969717151705336 -0.65455353933055249183 -0.35375048613166948375;-0.61840476126431909165 0.16168323882495516663 -0.58325731063656105491 0.25858403450673195234 0.88605542150849558869 -1.1738078153038993268 0.64080149931969454524 0.14950601734160881562;-0.21209814310122643288 0.6834426622128412232 0.87794230399663419906 -0.34108074382364012012 -0.86095806710336675316 0.78627941205368223621 0.0075336142822406883951 -1.3525460116563938762;0.048950449331067173719 -0.48277081235726182484 -1.3412271281277365897 -0.71680205414293984845 1.9749469164993327386 0.30913812197976558993 2.1468493233653616059 -2.1357139313139619219;-0.89249054458392640399 -0.13461400710315291063 -0.028008781510281702265 0.13476609309141773796 0.55727329647595202911 0.43091927030898308226 1.3624013559630556713 0.36521737164297185529;0.080114251687234558363 0.1263384956229791356 1.6589358586906759463 0.04161488635054440971 0.9632857206452000165 0.99109364617903372707 2.1294026438544504387 -0.9538176401964388873;-0.089704265145398087711 0.034949145533719770673 -0.23439796438990642691 -0.5718282240866711108 0.24233935431382894188 1.9371047599793995708 -0.090269707536746610077 -0.73588107110819223067;0.4573870493291816719 -0.19866499451773589335 -0.8166638985653054128 -0.4235171720525769401 0.17492156666060973413 0.13341811468745948255 -0.59032915450975087523 -0.13795361732131250498;1.1470977747474579989 0.44411083383610705511 1.3945207296850983258 0.98609851808902038162 3.3524462193804369647 0.064700936799694283574 1.4259775143618313997 0.89990002745857500255;-0.1435062180217198391 0.78704724860774333273 2.358461627226045465 -0.2274967092193097562 -2.2028846388332734563 0.61742034516324761917 0.69810405155233234975 -0.5572552291733893215;6.9577861506879834508 3.729049722285994406 1.9626594784185809051 2.8913979563551013285 -0.52695961845488947795 0.7148178952987283008 1.4033762776270228834 0.91511016858698013277];

% Layer 2
b2 = [1.2399233048246014466;-0.14311894844833458751;0.86881358550119591744;4.6881246763793376076;1.320029393112038596;-0.70663111001296607938;-0.38427794139557702735;0.61298298117146987618;0.41501480535646045888;0.028284716951424399012;-1.6270350876289285669;-2.8451683499229138974;1.3181709470267348738;1.6163586006733201561;-1.6384995819591079425];
LW2_1 = [2.9838934069225748758 0.87445101412264492069 1.7324229810085542969 0.002356881292351777242 1.054845136463240074 0.3717258593243996101 1.4286286148010209907 -0.87379036174680935201 0.20229117655619072158 1.3008232728164963454 2.0677378082329926912 -2.2972971087562217285 -0.23889949497875562212 0.68664036582936793796 -0.66507754933918505902 1.9121303321815266152 0.93412746837093818542 -0.25976577671627015809 0.1682438179073141582 0.72492524757016962855 0.86407998473901914682 0.65802858548040754627 -0.017070375142402314378 -1.5345580393101869721 -0.17391272419247316705;0.55172128399074016336 -0.27083312488059668732 1.7376705013164734925 0.22907131001899197487 0.10284851478360225452 -0.47412037934777351289 -0.70899250902675525765 -0.87460778289319174306 -0.019813786313555219881 -0.64954126216705909691 -0.60169672525047879219 -0.23453409494082813613 -0.58065837465198943956 -0.65643679188777903644 -0.20916438216712585074 0.017263446516299393863 -0.46898564696202255098 -0.31290792584487825412 -0.14909012914074457057 1.3602949895765659161 1.2559789342682690094 1.4826222251277336728 -0.19194362351473789885 -0.29399812768157351783 0.056089197983772307032;1.529832397563059887 -0.66831070465222730537 -0.047369727994084800948 -0.045665452474788689741 0.31260952765705157796 -1.0593009048585542153 1.8165785898082629224 0.53140944989539895538 0.029115502690854746376 0.94171654016027506184 0.14237196381142636081 -0.083900014395812683166 -0.31268767857489265793 0.11516648109369620467 -0.36686905831694260893 0.22047532788202264808 0.28565799216376491776 0.34186240853294341813 0.26760603213475814277 -0.039616875882394084196 -0.74512773741064597388 -0.18381354524050033672 -0.060526424608607055922 -0.16393276941788276213 -0.024201688307387593524;-2.4736944210293385638 1.6812037743411594182 -1.494507398744857829 -0.69018741318397303086 -1.0137080085617267144 -0.87730284716326589756 -0.55539205956036497014 1.6032790340234468474 -0.29948550282887492768 5.211249527563480477 -0.49728208733910322925 -0.29580115342698343195 0.27591575225041042874 -0.45544462620835501898 -0.074108201123215602935 -0.68303860467565002956 1.1549627181545751853 0.99149151293905335436 0.40127333319429364655 0.54012457326302376615 -0.1433447808440119764 -0.29338072268951059796 0.70960999749188313768 -0.96008609753540052889 0.14740093424293504443;0.96219641737457539676 -0.84893463276655378724 0.095983030411694730821 1.4670870269115969808 1.0165181419843685173 -1.6708330784759126697 0.39829668127120526622 1.6777801009385875375 -0.28137544019400489992 1.5879183037338047146 0.68174294002598190279 -0.11955522103084303964 -1.2988115762440961554 0.36889703179289745627 -1.8323128772397085928 1.192008579925666556 -0.65454159502579511987 -0.51766673467826640476 -0.08662965589621537954 -0.46083468401796834346 0.069014634221779461165 -0.76022273151597985485 0.49872341788494684023 -0.58688992263525274762 -0.46065105408328660408;1.2224235016996241043 -0.41668481398378670599 -0.93336830842801377095 -0.7760067780109408675 -0.67646585650936852385 -0.9288354515341109563 1.3624094689724621787 -0.36514342531734650388 0.69468348376031563429 1.9073557101982612227 0.71075124606667205995 -0.032828699014008755341 -0.61396007239952588019 -0.61093588855323432973 1.7478052431417183676 1.7588797184143494245 1.3695253862767817754 -0.19331619284091447475 1.2678198963055391513 1.070037734497777393 0.54548295062123086652 1.8187838924848873656 0.64508444404926601479 2.1756209139977671363 -0.16146967532703998538;1.2920190015730956823 0.46884058067441397588 0.65983133411664707246 -0.058223699290863809019 0.40041846003605180426 0.11115082819258170765 1.3466745587955104568 0.24796878671439501196 0.061644349109602675219 0.47573803241524525998 0.068675374404448374932 -0.72351614429665900285 -0.38126709109184697688 -0.029349077487364691463 -0.13106694616705655276 -0.0060996520608660792159 0.17336153200410286956 -0.69958112147090600885 0.30729846311449349194 0.34146812219772371133 -0.47421437976641545031 1.6926267237103083119 -0.15436455129791099017 0.4300447826359705128 -0.089797982407786261505;0.73801348562761370786 0.058251914951285732602 0.10676347526528541521 0.073014990895012066296 0.1086430033818657076 -2.0485623412534805787 0.85101879325422147282 0.48266404275242008604 -0.12232934158897694477 0.19850969874876961407 0.30511733956717113081 0.95428169006115048933 -0.063748971587389860471 -0.12592878078913108397 -0.73073321401506219352 -0.070786947397667554505 -0.73723894276378687529 -0.23273192966590686148 -0.83228822510019739855 -0.79359292583969565094 -0.25958391636538985514 -1.5535173977080549701 0.34376808743141029634 -0.7587841553920561255 -0.065907212105873566599;2.7273155262138866206 -1.1430739552716620011 0.84529507342359777589 -0.15600432216163445664 0.31413967289264760341 -1.013625430034181818 2.1675893335941296414 0.17184282105054088374 0.12458648157321482175 1.023244656817013265 0.43213602551570673427 -0.54165656263351458222 -0.90008300318870304579 -0.13678190748827770418 -0.14390725619163133309 0.67270373553430506952 0.080314589887252277323 0.38607718656235773258 -0.29404986135984068074 0.021811838629560601627 0.5238338205757401278 -0.3511795654017665913 0.067219395897840206189 0.0509585884237859707 0.015787874555954813788;1.7876318531053787542 -0.23103885025859272062 -0.089951695676223783482 -0.1963962054098843113 -0.021627637825418988271 -1.43889557204801255 1.1843875999032589252 0.19453715018184658536 -0.062930302426503464952 0.95743751966656820418 0.7529289590655106057 -0.44375271917481673434 -0.55647090254800324338 -0.06705640433021259339 -0.22080671088991032924 0.16965968706396250543 0.20316054746153910937 0.24160114774787030956 -0.34036180733255133601 -0.032303679592865577885 0.058050380603723361617 -0.343445850265451047 0.15159344062914750784 -0.051353383434774892147 0.029382642467941151587;-2.3205527097450415752 1.2915679388297225394 -0.78495564746740631445 0.19840972686316651896 -0.30877114549979539637 0.56332066454573870296 -1.518890884006266262 -0.22939896728112280089 -0.19491823590362794549 -0.77897655879197702511 -0.7101782005270019793 1.123275654700260473 0.87346633811625395971 0.18497226413099995823 0.11100965843858090487 -0.5510017320147776454 -0.27356054831707710129 0.2649404996411552915 0.15843625266688607378 -0.11825364109870753482 -0.74585773828959323062 0.2792097099668486293 -0.025949350730359248274 -0.20985407865547828221 -0.01513733741211237098;-0.29887981845438610362 -0.25385197247474106108 -0.20019089163760375727 0.0065030065762151636685 0.20476779672154843404 0.91065318065803935177 -0.56951195907204010815 -0.96772197207404697661 -0.080501244051699574755 -0.41435889007868664802 -0.88699842736208323046 0.63680455730380103319 0.12613864068494404225 0.10793364862759617651 0.099084559045644407527 -0.3181596744354071582 0.28015566705392530578 0.55736299011730539021 0.88691324015201333797 -0.64315076799175041611 0.22584398810209563302 1.9738862992955847897 -0.27428418244067021003 -0.00025827660198677335548 0.053975257845446295013;1.4392754585905005449 -0.50528364794317437436 -0.47980695189690686364 -0.15585487403953293684 0.14885306486577831731 -1.3142760808412305984 1.4044327167781331944 0.55559267022203850939 -0.004997786937156674901 0.90361235826341179678 0.70279606812437223073 -0.37211000108054870239 -0.51775936294452062914 0.016589056362853515925 -0.36644626315971418062 0.27976188671967161525 0.32692196374581661278 0.16161052297897102181 0.065200278983341436456 -0.004014365955115986942 -0.42791546451278444918 -0.36899445053062679412 0.13136394656130476188 -0.10512091081198310372 -0.01393201901881008925;1.3178536544573922207 0.077133373298271468155 0.46390913596307403743 -0.13058896964516808481 0.30251751171188373535 -0.30814275460008283547 0.99343207802268318485 1.0323982075825186566 0.29598504693079852323 0.55614188816434673157 0.85453113056486129651 -0.31432801702853424564 -0.4186079879891890787 -0.21967010386244112397 -0.26260978365053522232 0.92360473537568055225 0.052898909035405727863 0.21511632499223401482 0.22009083095738607438 0.51637886762837859056 -0.049667967889559294647 0.41134429516689585693 0.04103865935127154474 0.17869232143757554643 -0.12137313104559097066;-0.40688044399582196098 -0.60744064309658341028 1.1348934413125890686 -0.099539061236588260995 0.29796938215978441278 -1.149814334296518803 0.10835303901344453537 -0.66624132626379273248 0.1237671890180381401 1.1721612353994037559 0.62019155544443138606 0.81461394652728869037 0.60324468008534948282 0.30228312851050270771 -0.39631569743141048523 -0.5592486444484170427 -0.22834267414707043464 1.0332330365677815376 0.9516435084696280855 -0.17845534950330921298 2.320229723549140477 -4.4585427435474649371 0.01641696199844159057 -0.4655971176918993204 -0.046988486699273718239];

% Layer 3
b3 = -1.13014772587684309;
LW3_2 = [0.31845613861340921202 1.0524563097628270025 -2.8317393584629786396 -0.54255923655527205085 -0.19187567027137700237 -0.23783175707648729347 0.7277033616553011397 -0.55484388139114537708 1.9253668153495639981 -3.9246415942090888684 1.881247264288792076 -1.0616919692424278132 4.8252009054344711103 -0.93520978289450973353 1.278927755553390222];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
