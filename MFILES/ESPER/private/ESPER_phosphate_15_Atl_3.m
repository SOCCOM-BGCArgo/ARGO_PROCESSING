function [Y,Xf,Af] = ESPER_phosphate_15_Atl_3(X,~,~)
%ESPER_PHOSPHATE_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.2994359611491708151;4.5639561409908502299;-5.6437518721097932328;0.086050435505781230905;2.5263411148712351384;3.929754386064148175;-1.9236135755064760477;-6.9275012241546471969;-0.18169447285225776012;3.1139905168383306133;1.7310198257656457255;5.8496706205955417701;-2.7448739304135312267;-2.5698001219445902876;-1.5921478193302522897;2.2185133711293318903;2.2332175623786589824;-2.1586611834905085061;1.9635630821311735872;-0.032453406029145079326;6.9627698905796107098;0.89634887040145261317;-3.0977876449214183374;-8.0958233467686007145;5.7032403017169954751];
IW1_1 = [0.49215573412800195374 -1.0735008256406970428 4.3172280828883646819 2.2635293078647698017 -8.7078987286379341271 -0.13975384536588852935;-1.4044726892414798325 1.8059623676921441326 -2.5815607298462692754 -3.2931617075370041015 -6.4509805638606305678 -1.8456365378018193546;0.34552489009226272643 3.7159953314769942345 -2.3817080067274236654 -0.3478230143116120554 5.3231023763741243116 -0.51406069918914043537;-0.79711057757205583396 -0.43075174456385867394 0.25280696972151739388 -0.29456570655642944079 1.976061372910154601 0.15862070395877556073;-1.3113744279098693557 0.71174121290488479019 -1.7774055849441225963 -1.5097181333882718768 0.35567228013378615614 -3.556608716033189399;0.74343964798234829505 -0.17154975436265804123 2.8576871626509467994 -0.96070730766707246318 -5.7551524140552468012 -3.6518019908742327395;0.60650511785924721142 -1.4449719051925622448 0.45681718473680260617 1.3313243875817486472 1.0336527019595538324 1.9780611453589709292;2.737160342036817795 -1.6330893377621957807 1.580753826426773978 -0.21110082276917255251 2.4175069154447714759 -0.86465560304287558679;-1.4974433328607215099 -0.23279706932134891506 0.20338493930440468271 -0.11680674632068058227 -2.2277247192090738892 1.2736869870806508676;0.32236374799617356635 -0.86862208082518432839 0.20430631349111130768 -2.5172558109851772556 -9.3732991090919046684 -0.9235570677832206643;-2.6068987587913676762 -1.7561027517017040456 -8.6735272086131285363 -0.57728701941096227657 6.9572495538875349652 0.31863626608630896131;-0.50691606833175484326 0.0047224638016868398377 -0.18831903433241978241 0.38346404470413697485 -8.811742833233267902 0.085885100107006978609;-1.2685569475582416654 0.57172763189057951294 0.1850919835456571183 -0.82684097410156953689 3.5483623059205569028 0.16429202119311103747;0.11670475189771072067 0.73792322683593880583 -1.4072548605274168843 -2.1148157284487991703 2.1920857170021981197 -2.1163718846475587654;-0.086928434748633848228 1.3468703797444276926 1.9147752029580702438 -2.2998525678552685925 -1.7731843029520208965 -3.5301743317478595507;-0.73828360751186461464 -0.37380793645324988939 -1.7671883290344199136 0.28783206497132135526 -2.5142166831731009857 -0.060385718652652853322;-1.6338435986273822653 0.37627127437777224683 0.4269742768874191241 -2.0794369089121556016 -1.0901092472423099533 1.2372447800596912959;-0.97845424172652739614 0.41882047678453449002 -4.0513699839057197849 -2.3684340612722625252 3.6600454791753644912 -0.81416925254985095251;3.2376748414610614368 -0.71671607113124968791 0.75305520027911765357 -0.64353177174109776892 2.3676296577318871606 5.6131395508000130334;0.32729569502370459144 -0.22437563811589683604 -0.90374587567585473735 0.44121169282473421402 -1.6935082618731007731 -0.71618133296482389127;1.7514925925950084462 -0.42277709093629944892 -3.0013803518371791057 4.7490318518034042583 4.4070470866413788968 -0.2437275233432949495;0.31741641212445065312 0.15445562053828004734 1.2780438686871280485 -0.83494519109484721664 -1.5589328386972476359 1.256316026825461174;-0.63546942784251669867 -2.0181128023120038506 -1.0673701760521725479 0.33672313377853918537 1.2640394837923358828 -4.1379186354739303511;-0.22539775643288054163 -3.2180275931747321927 4.5039626456670536214 -6.717848106346504089 -3.1708460807816414295 1.6515603288820570604;0.32921205317384505395 0.42622788026942720618 -2.5003497959422817942 4.6335466119879376024 3.459519278614303861 0.44617944708443024737];

% Layer 2
b2 = [2.9787260233465198134;1.2956564276344215703;-2.4894577892696942989;-0.11114650211110110867;1.1562772546002746399;0.5686017819108373228;2.943457310018043227;1.778124090514862532;0.26828855718027894151;-3.1702138606259495646;-1.2947143603461186423;-3.7338244986934947534;2.365660752308008874;-2.1578111476184114181;0.51602187605556781858];
LW2_1 = [-0.19223043419163027279 -0.18888678997397603809 -0.35484387765840713636 -0.78197111589820944566 -0.61214944009960281512 -0.39079562347293889113 -0.98247992872116141072 -1.5168648792719570118 -0.87681692763636442933 0.16236735890589246156 -0.41079083934590759908 -0.035734792867380786585 0.5363558558110862462 -0.20221607987026979369 0.19001662952537576312 -0.69687345094221342379 0.36651951716191472075 -0.094918589766335950686 -1.3476242309219252924 -0.70343295340495304302 0.096746340424718690887 -0.70826441071348922307 -0.033109985667545617505 -0.29055660840943320355 -1.9924573433789338761;-0.28520515274472951761 -0.14139205137012528235 -0.10994042072984995528 0.67913339314470111407 -0.69903304544452293801 -0.18926069860006683454 -0.98026781603835511092 -0.11194308482896983548 -0.87923685704827247989 -0.048332269185165990799 -0.88349961462074622087 0.50783742153575761602 0.24597396183600314656 -0.34331193096834156098 0.70778126575492128492 -0.41693806312894798882 0.23111501941106962765 -0.16592612650367327687 0.71850069744628930479 0.0066918521976125668049 2.0488418723546630851 0.086772150333238373676 0.22076697668890588044 -0.48052483694387571056 -2.4949185307980155102;0.18878962634966162115 -0.55838334783276710738 1.349303730391011813 0.33483825809059764023 -1.8436825749150529408 0.15509224712805766422 -0.70029120385990706321 -1.9180943993367574052 1.8858264872170078519 2.3378081042260956401 -0.58980961312416402276 -0.21600912725943538506 -0.31573808752476678618 -1.2347748148251425082 -0.16058633372505984327 2.0717637841407086086 0.98763579563325332167 -0.85985004431565814631 -0.31308034977662640985 3.4837151042522385147 2.5837827336256933286 2.2956249003612616555 -0.063293742045249304362 0.027139056242779902028 4.3110715091645728236;0.29785737884217577953 0.35048271029901362228 -0.26135703549792937972 -0.11431803081461601457 -0.12136807578547509356 -0.08015871602500196369 -0.53804716814153619175 -0.76397820459799059556 0.12331583732862258507 0.94798326402040700156 -0.84096694693464069115 0.90691373212808745752 -0.76307048564844803806 -0.69312039720611784421 0.039519763211942740555 -0.050202366754279297012 0.72510561998956302165 -0.086449593574936284268 -2.1284974606939930375 0.26537950386740982722 0.88658569403359488437 -0.20442731794478469221 -0.47026071303448929717 0.25862061055087315342 2.4447974830053795792;0.5826436174630779119 1.7724265180035794209 0.033351306019831626626 0.64466841710031663748 1.5635704473305209738 0.27275507109504049108 1.593144185768162302 0.90357226348052943621 1.195929365834238256 1.5279264026607330962 0.015173173727846140865 -1.4366455878258370671 0.98406433570735285521 0.71492323528746115624 -1.400148304960843193 -1.516115497200648532 0.088152542521429247402 -0.52835529775014955511 -0.20983866165901604584 0.26865458015761334298 1.4353628386193311162 -1.3736741608642173418 -0.19985821006851928194 0.016322641108880490274 -2.9244559820890980717;-1.9045723956855618031 -0.60802063854620869154 0.51586415426547449492 1.295635214827159043 -0.49670615424878045152 1.2535887931477796009 1.2093628417209674186 -1.2557604540114222225 -0.4000076759918927416 -0.61961231464678168113 -0.34333112087498018905 1.4595639294276925302 0.43612691064349473624 1.0794370469764102971 -0.35155006860473186903 -1.5161124408536035268 -0.65439900752413227014 -0.13615404638189165798 0.46071504729623247165 -1.6205779339000987438 -0.99855423638472395886 0.0028449320377529931092 0.19506667314844625127 -0.18717886023269392215 -0.30625205660139559471;2.373552345286984 -0.95935978435158553168 1.1779035664982226983 0.94773942858472881579 0.11508852501217731179 -1.1442453404858663468 -3.335316685665307368 0.39019628662263383667 -0.14616650219449958681 -1.8410197358909730081 -0.33883811257387641547 -0.26094538154009827569 0.041858925300999584584 -2.440856766757352414 -0.78529262240719155397 -0.84358268608704600755 -0.48712493882052299021 2.0188933648327767045 -0.032989382845440555492 0.82908181264551628065 0.88721454851608227976 0.47541720673756066029 1.0401140292527837339 -0.7801429747689623273 -2.3707110664007733369;-0.75910309070905113149 -0.39145589608911202095 0.30576393323913536593 0.20228988882003540173 -0.51762781825553971782 0.95526586666349178056 0.48532965162510366408 -1.9148924268915432645 -0.5926053118157378341 -0.080359024008819793239 -0.45781930752259603068 0.22315854728175951727 0.51465840816697216997 0.40114248012786457576 -0.22390255557080024351 -0.51094706718936122591 -0.34707388155160878718 0.008209266860549006839 0.3812531860003715023 -1.1463848501260109902 -0.88634587459580638225 0.087416586400404741597 0.25880428510585334889 -0.31080643905440941133 -1.9703918763729797448;-0.077527256563689139757 -0.011914622978113570753 -0.019493630294344314186 0.52395382637561604966 -0.50445695306629612098 -0.22097132861823257088 -1.1617492002919320715 0.1510687020842506334 0.18974815714253642773 0.51192606418836361648 -0.48418626525972985331 1.2949306513107781136 -0.89733252038878685841 -0.38581476911908157978 -0.14345878651278134996 -0.19118675676945720565 0.21625856799939044417 -0.13677579905718884046 -1.5819297884388519027 -0.095170753277813421867 0.27091873053550880046 0.25982612214890499214 -0.17493663426893041324 0.1670108308156059429 1.8400548423240004059;0.26444485700988434873 0.18540940535520084032 -0.068253470428925239188 -1.4267949848016978631 0.54007055681545101944 0.062486390172505623664 1.0453906766629039726 -0.71979229419089929554 1.0613833750453702809 0.52510848673655252661 0.20141179040990439542 -1.2449814650364754431 0.13008989748157159805 0.37448218584080489313 -1.0800112021892849246 0.093274715267728597334 0.010400405166598476053 0.12069961939312418009 2.0801522850374292162 -0.13619619165084653756 -4.1217895827849275747 -1.0017947569175507105 -0.44034423471385641946 0.5239882095416390495 3.8320242454682604816;-0.52802952392477908727 -1.6609751995579180583 -0.054570852197064409483 -1.1864359036379201751 -0.59532270452603075483 -0.095687073049550458448 -1.2597595007103270515 -0.62510492976453313485 -1.1203168711294251292 -1.4432240806666831734 -0.031111247940193948597 1.3393179359977400722 -0.84733323481508027175 -0.62654811438767332721 1.3102864911267275705 1.3968144472559134162 0.095681522109801159237 0.54821000776192208015 -0.019744609959702407592 -0.53228152402245110242 -0.9501816346190876672 1.2979413227804343922 0.2138725352691216719 -0.02504237471755963243 2.339996579000448218;-0.52042512084268899297 -0.16778958127837803604 0.28501499366730415064 1.7273944107139374005 -0.10724496725525942131 -0.29877263003413540021 -0.20933170071995602091 1.6797868952515222496 1.6807724012284475101 -0.71914351349975258465 1.137737563671975094 1.0258089454308847444 -1.3568427013470045761 0.0067987990518224346997 -0.40955406392256615833 -0.29383369035462636454 -0.39941345601137767662 0.099224361163183477652 2.7163425071901188268 0.48672787721453325549 -2.4433121658917777985 1.2708238123898818461 0.49725925887565514127 0.013691888952238447097 2.7345501211725982138;0.41660661426910028382 0.090998696557309549648 0.53262724850466192095 -1.2554623498451022989 -0.19020933020667082913 0.53860511710127245699 -0.11409050542869864087 -1.0032347608754366153 -2.6771010711659997128 0.12108425820598398004 -1.9696967780833740669 0.02251931091765847423 1.4055344919159491468 -0.13452350716736105607 0.17979801127564556951 0.039124141424708033798 -0.019541745584208243536 0.22483452573325060642 1.1202363349387469693 -0.83504302292067655866 3.7540095378529492187 -0.51796589689003535995 -0.35097300416192450667 -0.12202091153020679093 -5.6299338126457989517;0.98133883868924365323 0.0095777465112340757353 1.2415416977649893493 -0.078401366392444771236 1.3934755565541654398 -0.54216720118570171927 1.6852916280398686499 -4.127136855322493858 0.59484534758801599352 -1.5870339434190137151 1.1078757957791764976 -1.946694032125731777 1.2247989667258047941 0.79948528272106489379 -0.34430803887584177092 -2.0721748078525581427 0.59297728770252000619 1.2101483436850690723 2.7997393514081423405 -0.52323294682622545348 0.52818365501415076579 -1.6446668229477847678 0.020777852086190547187 -0.014509726825973149819 -6.5324683907631238;1.3361902028226009254 -0.25663297471883178558 0.57967110794515197547 0.71504209604930224486 0.073160881582949546798 -0.89288825931817339399 -2.1442957222478917778 -0.045883349881846786922 -2.4749005075291772293 -0.99453094984946344148 -0.15260596945025034499 -0.99242404045953758196 1.3871831857902523488 -1.5442305761524124375 -1.0192394468120027362 -0.92471191623644288793 0.23016560827285895141 0.5116031847722614101 0.52451505608662118973 0.17137988178244856208 -2.6136697495337894992 0.18129321979978624269 1.0092804762592848533 -0.52492064241370606226 -0.73185260442656274726];

% Layer 3
b3 = -1.0520461669987846154;
LW3_2 = [2.5410783405901731236 -4.9651774547535199034 0.13421110956585513563 0.81934387240651651574 -1.1873871813089211802 0.48798087371246462451 0.61274443137476997112 -1.1392985744123973468 -0.91273792752824023378 -3.7312020419754508005 -1.3294484438046436647 1.3685258726740527901 1.0497099393468780626 -0.18822906548049650466 -0.36876863286769240302];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
