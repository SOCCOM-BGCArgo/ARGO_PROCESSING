function [Y,Xf,Af] = ESPER_TA_16_Other_2(X,~,~)
%ESPER_TA_16_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:05.
% 
% [Y] = ESPER_TA_16_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.182167287323738325;-3.0877995332981327259;-4.2235759154074630217;3.1562495658209228644;-0.34563722569816041075;1.2051128518907707754;1.7848930252357160242;3.3893058718258148865;-0.45522338726510985785;0.71230131081071845767;-0.68723558832839082289;-0.49685803142380535746;0.23932685208448606362;0.053462191841555505023;-0.54666302744406924941;1.3296830420024412511;0.75069684344885057037;-3.0349123629819372283;3.6276958529982668011;1.6464845296887544723];
IW1_1 = [-2.4352593938897939552 -0.23115156536278189114 -1.7269991997113900428 -1.2658100110734034072 0.22634375530558648038;2.6416224588657946093 -2.2044215211234376994 -0.25448073036926111001 0.99251256479902294494 -1.7944744307065012556;1.612612412129182049 2.9429654460177578912 1.4481877929832633889 0.56380131444999237456 3.3385253355817421372;-1.5075370909521945695 1.5769491021168160483 1.5159397122948325975 0.34567903973385016858 0.30172447285319736743;-0.33008350999916957758 0.32969395655833461101 1.2946086265003593496 1.6200791846316846545 -0.8963673669654391718;-0.43294144207300588878 -0.11103914193167804814 0.87504653647469643474 0.066788798684455571997 -1.8363741766385583976;-2.8943123006405349074 -3.0954553746112787316 -2.183494432895195736 -1.0697286099185425723 1.8709140630263156879;0.10979799865459087538 0.094548200984915495293 1.1479695111666010643 4.4708422771790168326 0.053826311949288267733;-0.20734749054613615948 0.059198548327248703971 2.0073780846168927106 -2.4670103219671659645 -2.2791121673987846386;-0.54222932724023298334 1.2060543436978934384 3.480074869380099134 -1.2239125425373171829 0.15325296627319320852;-0.66313995702536965293 -1.6921294474726940038 2.8686500313187850431 -0.99531504104431534063 1.1965048834498523966;0.63349759677576988892 0.50845408989184170956 -0.30160676471970682133 -0.57385858949753720815 1.1627782993568795966;0.23989919134199066963 -0.045006566798732834667 2.9766957644654437054 1.6079989543980166555 -2.0236942925289658213;-0.1589671824560817126 0.44600603443011005433 0.075874750342490096533 -0.2376266993053187393 -3.1018636989271604065;0.038986306365618193792 0.10057273730749982654 -3.1373057555049737033 -0.9965798284107088012 -1.2954382905199854914;0.60978187284544183022 0.50380805461713551452 -0.28252385829007914397 1.2750608987961751239 -1.1112862110214074551;1.8647816593323862655 0.98676908092839243913 -1.6126946027468451739 0.44613804646981775059 -0.89275683419458340406;-2.3990138816431056945 -1.8309975858339033739 1.3299500121554612697 -2.4289180300451937988 -4.6238019499817974989;0.66314680105212031602 -0.61003575534628362576 4.4922213827013095511 0.36378904021587116224 -0.60838465535087260516;0.62358268553294537995 -0.33083732837582441322 -0.39563004896314979408 -1.8285864279479613348 -3.0296349989090067822];

% Layer 2
b2 = [7.3371716726720839219;0.60516227054603444202;-0.57372226264884007563;0.59409459309652745684;-3.6020546398246611197;0.16474871556867537459;3.972724472015742414;-0.49052648661177500333;1.8269179821825176635;-1.0822180397256007112;1.1196334571736523689;3.3717869669870528249;1.880038173185784478;5.6683658147055622223;2.6892767282081697644;3.2017863331155740347;-5.2426667124420847088;-0.43787480150329466388;0.069155271623171171713;4.3377552334928708433];
LW2_1 = [0.67663654847329601782 0.46352285068633125587 5.5331317665703894093 0.32210395725088347696 1.9321534444051768897 0.56484851044722850233 -0.14413530225815932018 -0.12887495063772960724 0.24148115808323353249 -0.45992678645046358721 0.14208809510304451496 1.3129383283880387001 -0.34160209077457059923 -0.43567456664648746001 0.49340473549075380966 0.023150069854994768243 -0.22327236248826870524 0.046732650231866269819 -0.23117798350593404821 0.65651251987223491202;-0.24284785924530324919 0.37477348181324121601 -0.29958965530726039406 1.3861237238765860003 0.11564249868978468405 -1.0031571238920220512 -0.3041380958109612398 -0.09971762743994991296 -0.1029382671116998299 -0.14994671411949114792 0.097177785052421861156 -0.65058944024514353544 0.83273230954568844275 1.2422897262912562244 0.15749353509969354903 -0.59907334384873944799 0.25195179967850095393 -0.065019506628581247298 0.34434255409681613358 0.91093120901576440929;0.12011486001143503732 -1.2823658526708867633 -0.35364046724455727722 -0.50971116197561661121 4.7542252048341273607 0.34464729092501489305 -0.2525119024987243499 0.65155284657912959645 0.64377500743999105381 -0.22189262203071358215 -0.14770049974235563428 -1.0353253471108931905 -0.32085934157795376054 -0.13292724968064431601 1.2841380863442266591 0.37586610080297355729 0.16851063050011799715 -0.038640841225927452518 -0.35480363394298514157 3.5942208290032504614;0.31704306547717098219 0.74017020480749384781 0.42333135428918339249 0.64727684957528219822 0.40957389863233595317 -0.99489533182004552536 0.72796902832403165284 1.4480426450191730137 0.72874772316853153598 0.49245737390382932075 -0.40542667590139830347 -0.16039840508470867841 -0.53354936822030418764 -0.7310118714983178112 0.81558530334494061531 0.1396372619532056103 0.13826372296724598332 0.11709204214695366486 0.30181961190441403131 -0.087270414174851734801;1.6923359857321433886 -1.4577247995557482962 -1.1705236294156360355 2.1394785718746187619 0.80004281765590146147 0.23495494091218474542 0.0041822047635111259806 0.29437406124441273247 1.1225932599557886249 -0.87401401497496444826 1.5919236240513674474 0.025955954908355172162 1.0964357548937686548 -2.5157829255412487157 0.51492121001209367748 2.7917998413539795166 0.80883424217004862289 0.18802076003393561332 -1.0716347651337421176 -1.0089578841161086498;0.054895045981928347612 0.33985188738933969077 0.61515023923687417451 0.6379796057846903734 0.071173032966274238365 -1.8935722636101925964 0.91113909759489764006 1.3327301325219009787 1.0133387433990186377 0.72022335646558699462 -0.80093121017563284614 -1.2697874362869243647 -0.96363166756360141285 -0.5391397386099394673 0.57609433356717365537 0.64206960894871711876 0.00079544606765105229512 0.05447869356770468352 0.65603870561209676193 -0.040484516889636085191;-1.4332786164480828539 -0.89050490825059769318 0.89265680679162551225 1.0774573359462313871 2.628769002330557214 2.7271346222041508156 1.062568468165829616 0.38264923876409950854 0.61553069742385613239 -0.18676895764752443618 -2.7219703761763121008 1.9121785363330352503 -4.6288338103372046461 -1.7732521205329672132 -1.1401177737653234168 -1.6489832206355945488 -2.2460504902484497158 4.5802822075746494335 0.85253560477906586978 -0.77845055736430590621;-1.8282016399165583742 -0.32984103219721966349 0.82898062689071494447 0.36545428890745174089 1.1413493637618710164 0.81612489245746089317 0.79708143308054135723 0.59959239799657892966 0.4780107160405964728 0.63999299125537822963 -0.41807547705823150386 -0.49672175820235681121 -1.6177049435356933849 -1.5697882925407304899 1.300146341668461103 0.076619937260468423679 0.38589350652978182676 -0.026562682918087800882 0.55593238908220099503 -0.018585294645864662566;-2.6671739130880713908 -1.5246413605289397264 0.1741547622661824557 -0.44026025872208435219 -4.6056782738565509305 -1.2325512389437989214 -0.68311138828855588745 -0.57119512829154028832 -0.27976131126989900455 0.52711284860924212392 0.2145849253306143789 -0.45262882215915695161 0.62179560659293464653 1.1836307465804316585 0.36790265878444750047 0.032800061350129763871 0.0040013964692549230592 0.066179949610451621611 1.1501484335864204933 -3.2664681311734971025;0.6253749187845116797 -0.29763841082855163611 0.35199067211100165675 -1.2124340324893878584 -0.52186321147838510282 1.5199136961593064932 0.21444135888615850627 0.12607288776256481144 0.055398224730169857988 -0.1256821787143142799 0.012583308366112967713 1.1076444225948711697 -0.39829549513635936764 -1.37443617867701251 -0.053714845452348017329 0.48182393848561605454 -0.2879765189654640567 0.071308904592430902292 -0.34466932105828329558 -1.119311974952427402;-0.063302927296795916123 -0.43274933776629853632 -0.41301338289495004297 0.23325537999496834263 0.64845055384104011154 -1.4606131539921787255 0.057524391528669047147 -0.2191787129559163716 -0.21561306814192762737 0.74734109642682677865 -0.18362048349016560356 -0.73261940136647052402 -0.18368649126488378887 1.4569081971619854965 -0.0028087171769310428047 -0.25176567472168920325 0.22370347460052908417 0.05011021292901746832 0.080962543902664108053 0.11836620571196118656;-1.7630273594114602709 -1.761530291842194007 -1.7074846314462299723 -0.98708228337657388796 1.9326454483863941824 2.5756969892437253655 -2.1530590558787081612 -1.8130375981450899125 -1.8669744587021039894 2.7311280758661036216 5.3714056066317388272 -4.4865888121064747551 -5.0926745227298697571 -1.210622149859831076 3.4058649016469688675 1.3738953125085779927 3.4349017107281989425 -0.25272686387115256279 2.0006386798259874205 -1.4440972056639380661;-5.8660478989035782504 -2.3921673406101615633 1.919428354469959741 -0.75046846936655009497 5.0380132171841554012 1.3257076788575448134 1.5069553890665390306 0.55212631507077480908 0.89712020885466314812 2.1632213128930928292 -0.88483175761751964306 -4.2201821337699865211 2.4591423416069440044 -4.0091146824190166953 1.5196871566966843048 3.3697229507051100761 0.7043834569142967128 -0.37120955840947034154 0.66890327955472794752 6.1380706587152742415;-3.473487725778051427 -3.0157811831976220063 4.9511386937395656105 0.86689617856293665898 0.22964330136164887164 -3.3878965063130572766 2.6064393555617333398 0.169129388499338007 0.4201063674898352085 3.0116436840391260787 -0.36242799256271451824 -2.9889969099196682656 0.81374887280851460059 0.83381231835003444264 1.9939811432720897511 0.52062851696780232391 1.0394345800431730176 -0.30376767505314300477 -0.23695902378844385661 -0.48408844027025127454;1.4595724824503171213 0.25901205235093421875 0.35407383864897412629 0.21966792291317324692 3.3149100611317297016 1.4316597819956573545 0.62170186214471412356 1.7893185017782906598 1.1477155245449617293 -0.10529103954283938749 -0.14835718027204111702 -0.092278087820041723721 -1.2315241698441852236 -1.4996885555409453783 0.53691070182591349447 -0.0051603544541085517861 1.4029299325699102763 0.12998066065432214988 -0.5799070558405092779 -2.0483892483831880327;-0.86134506783336117763 -1.2332769710720492551 1.3142499763008446134 0.010031080142393643262 -1.1108099992231836861 -0.80059315589827095838 0.87536604416229601977 0.79365850153529626798 -0.33871729902428421299 0.41305360626028403415 -0.041941246588610446577 0.30387094701380534811 1.8268631780763247008 -0.47526035250574422131 -1.7302793465078631918 -1.1118397040320162628 0.74367083013114354539 0.030203862793269409953 0.28458756430736786847 -0.68382309779132621763;-1.5396221382127994737 -0.36309611095947269543 -3.8712472938456254923 -0.47369760702708973987 -1.9089981380045881743 0.0061322120516648925825 0.44468369625284487334 0.12305625186590581077 -0.20065437072160557941 0.34480360640651536164 -0.033882275296914475538 -1.3471451775586660293 0.21175763543395906274 0.36203089161425139331 -0.62335190729717060432 -0.26348918880408012111 0.30783049616486518607 -0.10658724473373493158 0.0077198048222718194597 -0.91606290410042179317;-3.0436688537116833864 -1.5846187085933012284 0.80215091380867931115 -2.1807594407933388325 0.67554770739639435906 -1.4728434228262365924 0.067357800082732441349 0.14942455913320754068 0.94765757856526622316 -0.93924794632175723219 -1.0261316804726807739 -1.6405616486460850023 -3.2979341245268711802 -0.99180928103683929642 -0.89553258782595812626 0.24080366187521468069 0.20521702332592539619 -0.23778427408400093501 -0.020302033854408544494 0.6282484712913161129;2.3516486383450536657 1.8336896287122090854 0.44485451049826912895 2.273114363724529241 6.4649744377219517943 1.8084007552204459657 -0.050256145230289518688 0.4854803787964447892 0.24656412185041554075 -0.17715588806310691994 -0.260658850208517201 3.3564987531490517725 -1.0717578664397988675 -0.00084289258501525285427 0.25031054607601760376 -3.7993894020126939282 0.99957172964299556561 0.064855935818741272669 1.1395757829981270071 2.1723984327528831351;1.9909818255104274609 2.4995945077245362853 0.7794248164484751662 1.9747591936312562932 0.039033789054082321246 5.7760171828625646029 0.65324942542337949281 0.5186804894923060516 -2.4901869181119042906 4.0184196085383439012 1.5125829090817315414 3.6053657492688833131 -3.1526329436484776814 0.97548692608631770717 1.4877305516648411388 0.85921439550557499043 3.0070293206851745893 1.6893271768224311646 -1.119538083181512933 -4.6246341376590640593];

% Layer 3
b3 = 0.69804992033531532147;
LW3_2 = [5.4780707234727818999 -3.2946615013483282475 0.55798891009944462382 1.9208163124085155804 -0.17334852334409867058 -1.3346966753357054625 0.22241525017813523757 -0.52897760642247193541 0.27793211958554547847 -3.3540780138236994112 -1.0741008578934538864 0.3312334989588172629 -0.10981840759241003058 0.12527968211613996208 -0.31303289923048444043 0.33704082085236275468 6.7687460074506642371 -0.34982081442099771662 -0.186446487123519411 0.2212329030905258731];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
