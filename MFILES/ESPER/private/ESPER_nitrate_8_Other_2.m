function [Y,Xf,Af] = ESPER_nitrate_8_Other_2(X,~,~)
%ESPER_NITRATE_8_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_8_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1384963036566166927;-2.1712915847197167274;-2.203499443556896864;7.8260431400521435208;-2.911139542809694003;0.070706660939569579427;-9.3610189280975575343;-1.202452567304617137;-1.6721446287979062628;-0.13846652516342999872;0.40206795952097168501;1.4832102177699180157;-1.9575624271471576687;0.45223572652133364747;0.086272493274032469035;-0.2000720920915012857;0.035314576257398311299;-0.82820164922983174893;-2.5457064574430616766;0.74857703280573839599];
IW1_1 = [1.3670407336740983961 -0.20433632614373536951 -0.82153725990289150349 -0.39374745903430419247 1.6259739395464483103 -0.6258912380720156321;-0.12634679908064028186 -0.83073590118042672792 -2.2131707537234905914 -0.86012384795846730245 3.6108999858412107464 -1.0445464828938804125;0.28799236801810890185 0.73057070595110795708 0.15822313855060909926 -0.13569511228601752184 0.47647050140651242556 -2.0658347274460253651;-1.3557367766734820247 -1.6312674935281663569 1.6889938355815412585 3.8059109183370010143 -0.92718108059996351411 -2.0215414662073212249;0.35556732228116838535 -0.50470159091929200912 4.434282240285502219 -3.4696618075064900033 -2.1801631413128905734 -0.23806561954637689427;0.51248975963344556295 -0.36055406899194114567 -0.12418670056823365166 0.26051371526490302299 -0.45366810700891779806 -0.1870636772085362276;2.853114640485436837 0.69062425056067411333 4.4074712058515874702 -5.0448473468387309282 -4.7707324909998103379 -2.4661120730824794833;0.80582134939783045535 0.94293513918234728166 0.66160489758495266699 -0.50453434068456237682 2.620482127355287183 -1.2731787628143134139;0.27435084951891358651 0.70164131079554459269 -1.4188335719913027777 -0.57951488320744903859 2.1993901549225025605 -0.9649280458127682536;-0.11074691834936488399 0.083151941108224325383 -0.31061750581308339436 -0.26182648145460635236 -0.045367510585344328344 0.16663335568554193955;0.069149180739841664689 -0.60971067226341846279 0.15209383643658638818 0.054660954382706940236 0.011533328046379315995 -0.010168421330751480428;-0.10666794311008737095 -0.027980430085045460836 -0.16660114244911361503 2.5353129093937218919 3.4220617647632152192 -3.1350199633323212467;0.5405347587414964794 0.81572032402374772264 3.2445939222134221325 0.16001292098648661755 1.5675102325148935201 -0.9064369076926995783;0.84508922131102237607 0.84750896471006442745 1.0652076469878941634 -0.53145041037804396922 1.2293798811094749368 -1.212107448376982699;1.5306402332871917871 -0.062938192088829614246 -1.1252029126208000775 -0.40295943474561640718 2.5594103896285558264 -0.81317091902572102846;-0.28085479508632960055 -0.67386484205250374302 -0.2863750233153440905 0.075829549351420152958 0.93627452110335096513 -0.55529410146350066668;0.65173796223096069902 -0.59269042765313062482 5.3485405967388537363 0.15445041690663191547 -2.3240821969745453224 0.20210257047630753036;-0.011421011439186629782 -0.24057584578356547289 0.36082969536380238296 0.049494213157138561288 -4.8180214394513081189 -0.89539087930140837113;-0.83122587916749823833 -0.78786720007671007249 -1.0173982301277328943 0.18805389103256930916 -1.7404935704607829017 -1.2620214183295348498;0.27705142583295783165 0.38494747981881516363 -0.094741681967980925783 0.081669506977737962861 -0.27749908135866968584 0.12590858031112003856];

% Layer 2
b2 = [-8.4405967099679841681;6.1918999392745499577;-20.532720590742698619;-5.12573339856932364;-1.3138772137747822821;-7.6643334984974229585;13.128634494502826158;4.9948003112187464581;39.831261577800631812;8.8122553734837651973;22.5295716286380312;-15.08666088205043998;-11.625669690660341615;8.5533609538760089208;-4.519379887760298864;-8.2730800509057580427;-8.3634449223054083689;-9.8398155099173560956;-10.207464681219470037;7.7372288006505502977];
LW2_1 = [-2.5150503220778013258 -0.41507361174625662104 0.84572629945013111374 4.067017291724916106 -6.056837535354940627 -0.75162929467068950729 -5.1742702555507422701 -0.55614615646576515129 1.3932302283070854276 -6.2013445531133548627 7.2424532365986387106 1.6619246301791454901 3.4363270472525955235 2.3107230265879161735 -2.4182425183938356383 -4.6788723826330258504 4.4076796441834016349 0.096333309231055375133 -0.77712621065661946496 0.47886759151456292916;4.7916362865336203924 -1.7027433274704799615 0.22255840436003132554 -1.788313003504629517 -1.3888366425216165378 -4.1766576200345157943 0.097654312947949836743 -1.8743917249293156058 -0.47535914960796921136 -12.951399497562654517 2.5428482701385561882 0.59632055326616117963 -1.3237068560007652085 -2.5357063810347040267 3.7847206600556813072 0.085939116227041950635 1.4294789534338336878 -2.0514297725397865335 1.5070324670566115355 8.5060501643805306315;-5.957828023724649924 1.451684584612620954 1.3859001730959636944 2.1612036715144893328 1.2758040250419033779 -2.3648606729323620179 0.62100117084785144694 1.5662752746391050973 -0.93625037435344748982 13.980090249882406894 12.762632265925670794 -1.0923354330390122602 1.1736364892684481021 4.4323314851471780074 -1.1529927972653795099 3.2509221820982769913 -1.2325576847458479257 0.62098683371818785837 -0.020276809239882585822 13.405269304149440401;-3.6942924747782868167 0.72740586388662731299 -1.4122589834463814551 -6.2703673713279011181 -0.46462593034253757418 -10.494232111483688286 7.2494989049406948212 -0.62413522867353465884 7.1850859422596169424 -2.5121069244133353848 24.067010416470836276 0.15388243734211087821 -0.26646305610314097168 0.95025540790758666887 -3.6250229172630539232 -8.2463345542920762909 -0.91056228661322424767 0.35038502445133989927 2.5825863794252130745 18.01536004691056192;-4.5875735760396469942 -0.1991155097675922081 0.73396517605415878549 -8.9929836752828808955 -0.061158776296655295579 -6.1236888739447836727 0.32106949946663437823 -0.54447321346100419071 6.0203136772020862111 -7.0414826680549653659 14.358876105646020349 0.11052678830453319114 -0.98097833394555322695 -0.16859653947894576165 -0.75896550740606105734 1.753120080044968887 -0.088733912888767654814 -1.1294559492756133245 0.90687112170761929875 20.82636936246280257;0.53795681724358290765 0.4273629865369120151 -1.2860267089929675599 8.5134959597275514653 0.18523949488307425715 0.91871787101695912003 0.088146628668292079101 0.68013499229528517898 -1.1007857631962496558 5.1624793999633880048 -2.2529440552966857325 -0.79813356388801459662 0.40572712600165800056 -0.61623092776249810409 0.46467436783932969391 -1.267794531199948338 -0.17090448332003305154 1.3996368893261730282 -1.921699179062575924 -4.7186313972607258904;2.9683211362370220954 -6.1658537515780018623 -7.1355398995877798995 0.16805182601668663955 -0.07081616290449552209 -0.29573362837929711988 2.2358100564157838974 -0.36855992979403151555 5.2570830320018124837 -11.732313202818389186 -6.4985981679837694358 3.1753337115443511784 -1.3419268948612306236 -3.2826736177124118399 2.4928607017657520295 -7.0166464722340151638 -4.2189250111104232843 -1.6921123913309590314 0.1112110428172026072 -11.316435165118269524;2.6656140144794164826 -1.4501117980767428417 3.443436950167431565 3.8198411339916118479 1.1190970630522780738 1.9718619588322412461 -1.0255374670379397983 -0.16848780897100723575 -0.70289624705053832532 1.4276138527926180988 -6.5986189118620490746 0.49532091134297812074 0.88191842563362565777 2.6865519070694490189 -0.25913643044807477267 5.3319587881244565608 -0.35486373443076885126 -1.8571540424894767973 3.8582409689223884364 -3.8366578965660758094;11.488560210341825396 -3.1594921588919833155 -1.833062037046241155 -18.185184924533576378 -0.31412364238048795517 -2.2509493294658318163 1.7390008232230480534 -2.5494042459868633266 0.71215074521751486891 -9.3526747160570540274 -7.1202330431020888213 2.497264317630234931 -0.829823895857514926 -3.9111384164303073518 3.1255364751466703233 -7.3132513592189871687 -1.026463445893853299 -0.92330733508599138748 0.90242085998008381154 -14.280254058071371048;0.63771721108072576545 -1.6457170875269107047 -0.070298267150293525241 -10.429983131805496299 -1.2224961832767247127 1.9129143670315891246 2.9191130502627147258 0.99631456882658553376 -0.76993496824116924859 8.1117208537266378698 -2.2102750627615712631 -1.1844256702496751554 -1.2617567893293533121 -1.8830455504404419731 1.6268238504238217157 3.577832904704448147 0.73772690899876569581 -1.1979010262286950983 1.8391527931246902661 6.3263361093320238382;4.257103269724113126 -1.9899772355097917753 0.24413432374998855767 -15.470417260841031748 0.12251702961198321362 -0.222258564367892264 1.1213928398959949195 -1.4863752617681953438 0.87530156552959104133 4.1918663784994283361 -0.096997823505855590431 0.29962199578443016179 0.42753688012749896386 -1.0325505241976964399 0.77053421744207184485 -0.42533803482041082633 0.30310465200087455262 0.539383792857669353 1.1168057424717634518 -0.20364802735368639497;-3.7239871718098500608 1.9359168025138466795 -2.1697356962279785719 4.8309114256134373377 -0.48849352583681865392 -1.9779751049407385821 -0.78688726587488444508 0.44897537558214622999 1.9220804235845603269 -3.2401671684432202802 11.894495456260788302 4.3667814305573573463 -0.64463073595203668198 1.9002679776995587968 -2.2066127183720172233 -9.0342613867086676294 0.95552028368364672062 -1.9106486917762712796 -1.1345360780956008639 1.1641209211750840335;-16.318353495435591327 5.0327772451033139234 -7.1457269028893515284 -14.556495651678561742 -7.7315197407024918164 12.968921861750814628 -3.511606489469567105 9.5103471641255037383 -0.18404706512204407898 5.8962179866092467861 13.988363239092556967 -4.7680367647233392603 -0.66941105422766167266 9.8629870332315281445 -12.562063144778667478 -1.1429075177837748623 1.2989455250730232994 -1.4681156356906657212 0.42356880440050975745 19.671329828547438723;-4.8736956459491285187 4.014828893509816865 0.29535849089445181948 -5.7487877407989476097 -0.88284175430309297372 0.10252547888661300846 4.7855268633088936525 0.17988488112515910178 3.2726010548880450912 -6.5048292807523644399 7.7542287983792368422 -3.045093860959330101 -1.4728041732191456958 2.351672539488545155 0.14280340284244608107 -6.6800447855261007035 1.2034098209584951356 0.25551470955060590073 0.55976713615439110949 -3.0455994416272402781;2.1782210483444717219 -2.3915699672013683852 -1.1345575274484680506 8.7369014956642416792 -0.16566881991255522077 0.98802712530768155297 -0.20116667163571574917 2.321545940705072919 -0.4706599167109591364 -0.33866695349328818088 -9.903340548283193101 -2.1115061508310235538 2.8099900424609138838 -0.51445045522717969266 2.0542250974678619713 11.647307510025454391 -1.0245625112018950098 -0.74976145450593656427 0.36168163703667471909 -1.572602509044246144;-5.2483130583100594535 2.0596371934645874013 -0.22142779720070956961 -1.1431114406456912569 -0.18734280511427262028 0.44581607343442941627 -0.79945870284344799916 1.3218742318331435648 -1.0328295671222291752 -3.0751336867345728798 1.0951227688341769184 0.6086238483294035273 -0.44464845198239072444 0.1336170240302823331 -0.70694324851547341027 -0.36925404806641848321 -0.37064095589984735746 -0.059823895633755654055 -2.8607961611581069761 0.42575682633539757571;-1.1462737559850719737 1.4287287326077804384 4.0212436226731993472 -5.869396190004409597 -0.30934301872427272251 -0.86216239956137030731 3.2042709793507890836 -2.3452222349893250275 -2.5560654788432097817 6.9135605852270280991 7.2910255543183568605 7.6881633780781326593 -2.913512520103607617 0.066502584997180216875 -0.084075126842609912425 -3.1660090586525058143 0.65978981243264334111 -2.8822043700730639593 1.0043812394396818277 11.384970444280279267;0.55065929285500669899 0.4262213872753616295 -0.18535603178713180861 8.697665749316703554 -0.25393866046757429533 -0.74824919337600870328 -0.73409077236100173103 0.41338551815575463877 -1.0994006933669349113 3.5630593251012396827 -0.28803925445561073815 -0.89233888849759546158 -0.044463770526901771896 -0.7996339384815268625 0.5216977696950817478 -0.64343961258884752041 -0.24167437682429451784 1.7369864177095948321 -0.99823241550585439796 -0.30138053938574904667;-2.5308304163164270228 -0.24486216481420425284 -2.5438056491085569988 10.050572715364062049 -2.1579278961606092047 8.0905827578589200044 2.454736334780655671 2.0250003732844055193 -1.23672943722515849 23.035281686911485366 1.1987817626933192638 0.36382159031062083487 1.4029512933592647173 0.94747872440768521329 -2.0790762426482292113 -3.8530841970930107543 2.5639553083692505631 -0.2670322913866902681 -2.8668770952264228669 -11.252137092077992619;0.41823206250582217747 0.030254315479308901971 1.0380895263082472457 -6.6666068923332035823 -1.538711979659392215 -1.5679308310045561026 -2.8020123847431581687 -2.2360949444507518535 1.7031429264980502136 -5.3408508856501448747 4.6347709314197480523 0.19559894187477308569 -1.1401282874072653506 0.50369042075724324015 -1.1454574620158524123 -5.7015796902322533057 2.6780792708041114558 0.18816882102560383849 -0.14773057095062241961 -3.5983818508417857451];

% Layer 3
b3 = -24.970441304298564233;
LW3_2 = [0.15718944454126146382 -4.7867977408030402131 -4.3158229283797906461 -0.15414963192945707604 25.375159791992043523 1.1882651173999814187 1.005353117439461208 0.38151793733157346455 -1.2051299559839592224 -0.24739483084195310059 2.0588248165097269293 -0.23393395232119126859 -0.075359707271231618497 -0.15835724337834103381 -0.40506252862079994426 1.9723258021263334605 -0.53168661651748216901 -0.91054605855678394377 -0.47394576417339601138 -0.99277094154500222789];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
