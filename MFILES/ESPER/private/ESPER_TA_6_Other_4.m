function [Y,Xf,Af] = ESPER_TA_6_Other_4(X,~,~)
%ESPER_TA_6_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_6_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.28217252747135151969;2.8196548595921191449;-0.26045789196382507225;-1.1450730164152918;-1.4627583082786110857;3.1112858301613770529;1.5590625690660384617;-0.92145158187373799041;4.1541818616975074718;-1.5316333787104956521;1.2563850223675196993;-0.26236206649661780732;4.941491540163052143;-1.4229462343849439421;2.4083583348307167071;0.15216499708836322968;-1.2239886180513213088;14.743023934940687525;-0.4624915748337791177;-0.14251297631249323916;1.1137543883018976576;1.1527127085924855354;-0.53647886861442528605;3.1719388140073943028;3.7952054985610517157;1.4349823206063956338;1.123994755340322893;-10.609737311058159648;-0.80095601545338934724;-2.7988178212667511602];
IW1_1 = [-0.68770984949111302331 0.18887022910833503597 1.6352909248916622786 -0.5157326791737966154 -0.34855705911105694383 0.73320414139740097692 0.3018422783746907978;-1.0511242830294778017 -0.94423613816286733336 0.62732506025905498959 2.0590748803838905268 1.6616022196291142521 0.47780801397965066979 0.47000358374360201585;0.70945941718327243386 -1.2011503573836677106 0.15552007056323846612 0.019267076028219989881 -0.74391560964920733223 -0.30982768978955210759 -0.41957845864032661254;-0.45707189991276364616 1.6809894167400631915 0.1245539120668396893 0.25768693417892629682 0.082937228901597520592 -1.2001285479779777443 -1.3875309772716482026;0.38750464172843901434 0.79904163263986782706 -0.04905493454633469419 -0.3923129277773695911 2.2092199754740620143 1.1106296936977262391 0.3643328857006530308;-2.7954710888942710945 -1.0024562033538675365 -1.0498486558384492184 0.16957116796300775174 0.048041061762386788603 0.048065265207824718618 -0.81408235281738083877;-0.33070001659030812124 -0.3098949855848407986 0.5691340547598376931 -0.15437555939391961468 4.0578597563281260108 1.8768878247633009604 0.77787452353910091496;2.831080104281680665 3.5029902729251101157 -0.018570640370871829145 1.9438234285754363295 -2.3484428939097297118 0.6674779022441722498 0.26403379131157089788;0.16243107191868871864 -0.10587166604646967849 1.2001352831842753144 0.18470250958847239664 -1.5620877565099546835 5.5373013817142950899 3.9139479806734054357;-0.044497809250907398304 0.10156161435883519217 -0.15863563647566555903 0.4260954467063204909 -1.3072965312271820348 -3.2010447214576767117 0.28017716697799854852;0.63004383712341582857 -1.2618918047335072607 -0.2885008395794355085 0.193346471769019701 -0.42580420603936963708 1.5385037979668827468 0.11309966352036504578;-0.48656191411928834123 0.35705472802654375508 0.087016712024909376177 0.037700808036810348756 -1.8373541920589251397 -2.0737548896823776445 -1.7476596714758825257;0.12215286318992880921 -0.015816741249648259143 0.2370381494008222123 -1.635580682861301538 1.4196786950113811088 7.1916597138282627455 -0.19549463024849195181;0.22297327710785161403 1.5750485107698513065 0.015350757374517838214 -0.78436548689153506864 0.86335473688662667247 -0.46348793079869060607 0.13754373943571124306;-1.0801392958607349826 -0.65226745653059947649 -1.869481799532636046 1.6927156920336692281 0.7126689892231109491 -0.027161598596590688648 -1.4609512806531066431;-0.4206197494499160916 -0.24368891755300034485 0.014051992569005645681 -0.21383750265227097209 -1.4729390704984655081 0.4603648251902282551 0.20886616097810187243;0.15127849570552284741 -0.12250746227210919381 -0.23027914925257467194 -1.742901756317505102 1.5612286434172095717 0.36009865243688243819 0.47546989559332070163;-3.25493472742245471 2.1153048360679806983 -3.6293755170381660768 12.564782210457092759 2.8531009148496924155 3.4727066099664294363 1.282039650162074329;0.085387551300439068491 -0.11655122920351408677 -0.37775394760021924201 -1.3502737856184099385 -2.1572915874938596303 0.056561936418403319093 -0.16159046552076519743;0.70329724559093975689 -0.61538508652145551547 -0.1680454047852592836 -0.58771073095757975224 1.6210686942824807932 2.1818612307556146668 2.1507807518562174209;0.19849208139589305522 0.40838416044269043592 0.41544308034441657096 1.0445491923892817887 1.614940313722273979 -0.51985812453372948205 0.28004515733738027938;0.41617633905163514685 0.88208656197494439422 -3.7378846258163118677 -0.38627749294325214313 0.13705761713494657439 1.6262362965104109058 0.19947532926516056695;-0.056466679439015669828 -0.19149600387233300935 -1.3870329702704611297 -3.7212186946160241696 -2.8904674909127598958 2.2062626349714276053 -1.2394596782239537536;0.79608832648909921836 -0.64696112147308493245 -0.13757444091052190016 -2.9268132426491746401 1.7346560100509049729 -0.71919769201670147307 4.1628864134392840057;0.21133437774207344817 -2.4300239896654072247 -0.79842680178039404648 -0.58704729147999212824 -1.6141969610085382669 3.2731969435417909153 0.12720272653613701186;0.32909108427348487957 -0.90519114543089373992 -0.068373335704514370814 1.3106183377600546525 -0.54836408062994612678 -1.1683002455895918903 -0.92362377188580913057;-0.0019975102877318809402 -0.61468959607200956974 -0.24933451998399908112 1.5324236459174032099 0.19337560433675396454 -0.83877655944217266448 -1.2149327906189641979;-2.5654425156647908679 -12.024893890504490201 1.8078495468441484473 1.4984729504830174296 -4.5346977812995410417 4.1812835563997330368 2.7933246730087715193;-1.5177879862414616063 0.54111066626978099325 2.5542560541150476361 1.5649286631497452138 -3.4498353442517863954 1.7870755506410578306 1.9584646960481510991;-1.6274661725269061741 -1.2089264584259782342 -0.6395386586643084792 0.31950719076439759725 -0.74977393112533641251 1.1019480469963154334 -0.35966213067338514975];

% Layer 2
b2 = [2.5337726669525739709;-1.0609694875898449951;-3.6978023544335907324;-1.5955121678418031639;3.7292003118576033671;-3.1737456152571263956;-3.765973580123416653;1.066340819219006919;-1.1684500287691894638;-2.177409474787808108];
LW2_1 = [-1.1170506272731159925 2.9311698034530064838 -2.6235009132843596369 3.8600075375389986121 1.1323132721074524731 1.0751500747325295482 -1.934831938166537757 -2.3479731959217979842 -5.3496503888930160286 0.35482534683625138738 -3.951001880324855442 -2.7731731866394011554 -2.7184805323160778912 -1.3007127485304101899 0.83093507443938163792 -9.9478487165818627602 -2.4866308508181420578 -5.1026125390031493723 1.3765154864036686089 4.0542475958133996627 1.4738380581195460461 -0.10084207253098978474 -1.6869076018933517602 -2.1520477587827135935 5.4197845804084643362 8.8758074355785776532 -13.452279564917896337 -3.0469034977269062736 2.6251725786716897382 2.8576206780270894114;0.0038848148308424489822 -0.14482968396224071839 -7.1723438031002757498 -2.8221438116093691129 -2.4428997515134662777 7.1569303287737557895 -6.046639786501367908 -3.0633728392424131037 5.4867248266127273126 -1.8875516804617142874 5.0482375407619235474 3.6795969507548242916 -0.41676496600964191286 4.4337396300963636264 -3.3346661761394154055 -10.34103663045623378 -4.8087460553056171619 1.1441589630957951229 2.2658899260335108039 1.3766482012295890858 -6.8332066238245658951 0.42219308814594164181 -3.6791711907746100785 4.261184988983649724 3.5702190592699345473 3.0184567344850159465 -0.3261800388438770848 -1.3622818831241287896 11.141619526523189876 3.4548051535320545291;-0.095927790363638368309 -0.33926031592668459691 1.362329583613586248 -0.61636013362551089756 1.1831451685767875315 0.78197048329147900159 -0.72433318029948257077 1.0943822526286912655 0.40967966688382345675 -0.33577926289479920197 -1.3952409491666997177 -0.61292961593463179959 0.1059722909561634091 0.51773133929656922625 -0.69057679486248535472 3.0338481422021952305 0.72615940891869046325 0.071065433799686231198 -1.1556854013920623281 -0.017635490588306747262 -0.28465370716715249211 -0.012635215062274714887 0.65323823875059561228 0.59369927651039888783 -0.49490666008762412842 0.78566227607650240827 0.63146314842011441737 -2.9948528089931967244 0.37553868570491655277 -0.97456224806559343943;4.5382739605373725311 -1.9869436615207753949 0.33551885356781352421 -2.1357998069734178692 -5.5996981015346687371 5.2741316247594083322 -0.19124521942949385123 1.2571236709613220484 -0.7662289349705107 3.2138723326275480119 1.2669722018176716727 -5.5312654878945171077 -0.72642442014480290702 6.4470828962874149326 1.6629252676964110247 -5.6267343889017480407 0.77082468928043745837 0.18765241371523042058 -4.9653664501225334149 -3.1985937085030045068 -8.0800305555099267707 -1.0412913244170125537 0.13035511906644103863 2.0026645218480512156 4.7016192888827994523 1.1459385890002484754 -0.19946446980363571888 5.0684012727401626108 0.11458667633899863314 -0.62005591656038072657;0.19974443095216659616 1.2359439725397529664 0.88341765495966428912 -1.2541261036932391804 0.39744354914135282542 0.019466133533403536665 0.46082138226143798398 0.96445846248033872961 -0.075317618867661778603 -0.41805367791449427051 -2.2115610818297648521 -3.5230759032374776574 -0.419520910177866857 0.1774051254360658747 -1.2687663738688350623 -0.047879311821141412597 -1.4665207485140350219 -0.15250599771763237444 4.828731860185262903 -1.5295617042624687354 2.9330899509244252599 -1.226605181803870348 0.39187905879521933716 -3.2500186041793099889 0.065307047041163995837 -1.8283397784961012977 3.0980811317872283261 -1.2709145431811952331 -0.67110380650274870096 1.0615902346428240932;0.82472112083498172463 0.4564906432485975607 -2.6800108455815911945 1.9901862022387115658 -1.1254003979576887584 3.3270688313944036807 1.6042825886527478652 0.87035415135364846417 0.30192716735317098875 1.6089626470056033192 3.4229236724654885649 -3.2955299081466131739 0.45020734301017817369 -0.22333133092285370469 -1.2771514531334613451 -3.0583650373872437456 1.2820538293127567986 -1.0891607669927731994 1.7881161758233010683 -2.8613022209055913869 -0.26966480925249647349 -1.3879840893097594723 -0.43552612478123026163 -1.0005448680619402069 1.4369282436417039062 1.4549031703266801507 0.56100010505590314214 -4.2289271019674590235 -1.434651039112902815 5.048813009247687944;-2.5535838508050150431 -0.36275368061729373892 1.5064830568978908598 -0.054563641536981843938 -1.0721482692178232465 0.29562454722857384182 -0.5349636271866630155 0.45297083653217251609 0.33957029641741631742 -2.6655665320407693208 0.081891464356957127668 -1.7244595807128377807 0.23227929866121044267 -1.2583473947197125753 1.0969217711210006438 2.4919221642979563214 1.2008651755118224802 -2.488330752572363469 5.1308757450391455635 -2.2307098014572357414 11.904361838961122544 0.43667478351956223737 -1.0859121562035438657 -2.3507238405588761765 -1.2825182059882527241 -0.60016646910844473339 0.64160000646734283158 -4.5119758943716119504 1.6509516587594919024 1.368520959173714191;-0.24386033395775502663 -0.33671937123737316622 0.32559078205308106257 0.4384670955960467964 0.31342607539693473351 -0.1231944033962080326 -0.59697742782361040703 -0.18064539579072153019 0.57940581946387614831 -1.040832147854026779 0.65299979952412978701 1.2645727746167618744 0.45481434243240231874 0.13678629359581354064 0.55981745498351842549 1.796398945225986532 -0.11541839014265119212 -0.083559101874514221664 -1.041814403667262301 -0.0086186702310182567582 0.0064243543156894192259 -1.3064720767192026241 -0.44471325830287367076 -0.26984055041636817451 0.062366815102289731299 1.9541704375466493193 -2.113946491344439238 -0.56730926886805810305 -0.40845975184039223782 -0.43806802150892448777;-0.024542890048248916512 -0.46592749535282501627 0.48980577087974547235 -0.16044085064619367786 0.01068741266281626745 -0.064450851144077073163 1.9773890311853210555 0.034366132960807309338 0.38204121678632119163 0.22539654955134844072 -0.53700741164592158405 -0.38969825502611743495 -0.2359790071658794397 0.21651000039007528564 -0.11436184680321187512 0.57683063938581546903 0.72509878761344104259 -0.084531722367792244688 -1.1711692311720798276 -0.27125078379524275585 -0.74492402519542377792 -0.11807514880663792789 -0.052306414649269057648 -1.6418177132035858268 -0.092998567840195792145 0.21644849629707776928 0.14416519337119004796 -0.58938076222635127355 -0.14417337737586838342 -0.45508560679459181264;0.28813620170813275534 -0.52107597221014867461 0.38675908921458562739 0.37698630386882142629 0.26121623404394833656 -0.1606462752495765034 0.19736828262494221509 -0.081231523202575831033 -0.07979769498273067696 0.013235540795155386479 0.34099989921455992059 0.31555585829659360542 -0.14906163928931959184 -0.43209286849897599048 1.1057416760191489669 1.0188271825074044497 -0.041791420947901163074 -0.0012926158362737485974 0.62085519399770361382 0.11233171860415604171 0.87946465672192930541 0.16093251874356018227 -0.20671922101114750814 -0.30155521640390403615 -0.15341556677698084399 0.37046079151654726092 -0.8322068321225911669 -0.26190720400746164698 -0.027802264300022368204 0.65846333448294502855];

% Layer 3
b3 = -1.7097010943132751049;
LW3_2 = [-0.016093645745900383298 -0.017076437810998015138 -0.2250276952551020504 0.025916691185512333306 -0.11126997035955782378 0.057573024269407038767 0.035873820044237607341 -0.20036726324751802375 0.81257961840478176718 -2.5075326543849500993];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
