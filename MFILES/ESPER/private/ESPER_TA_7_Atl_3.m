function [Y,Xf,Af] = ESPER_TA_7_Atl_3(X,~,~)
%ESPER_TA_7_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.1515057675966211548;1.5958442959541774275;0.39427097747476452794;1.562469612112853401;-2.5807927897688798247;4.7230050951908317813;-2.0728598728470095658;-2.8097656998640561099;5.0164086969382228887;-1.3752668868317776685;-0.91362734176649917917;-2.3068321736756050022;0.46366517042424515438;2.4074426466441343209;-1.5295604871592192175;-0.218175151364963682;0.79405839077072482013;1.6395208374554415265;11.783167581234996746;-2.5111945897995449073;-0.82496059916381025978;-1.5874725443774988509;0.2740967300914148308;1.7582268779002063752;2.398844976182177291];
IW1_1 = [-0.86607782037913538797 1.5558531568920512811 -2.161701040217586911 0.75303200779898604722 -1.5722144601112517659 0.63910179791596199994 -0.41381669623813399639;2.7934144635912137034 -4.7840908774604127274 2.9369276927897165486 -2.5906842454129246356 3.7776449047961868644 -1.751024752595366607 -6.3868994488984780489;-3.2743526149127784031 1.5866636867618557627 0.1302577731811618289 -0.38918019692562638712 5.9380049273541786192 -0.42306855025039780127 1.6163325764487124214;-1.7691982278130318207 -2.1202237493065356766 -0.28719193056050046353 -0.72997619261593504891 0.27510068242140739425 -0.5010633525518319864 -0.029754139040450364173;1.3037055461590243421 -0.22380679830836286426 0.69344474757381613372 -0.042263444989512559402 1.7872447341822856881 -0.8437904200264837451 -0.1707496282790437192;-2.009055991274675268 1.0558341930932839681 1.7432582369677760425 0.42586904900819383402 -2.610392827166733376 0.27341733185192573785 -1.3249383063009529948;0.019148705327983846919 -0.55838253754655731154 1.70638473418953307 0.082338207819362879691 -0.58042598565453251691 -0.5701124019510634966 -0.35725187198614227757;0.80681279737984279432 -0.1703976290163211893 -0.79065246539700073658 -1.4857346985455957 1.0166386416438426554 -1.1494802972600386415 -0.9570602361294247018;-1.2398617240159142128 -1.3932722293662220814 0.30754445262888252532 -0.66046427510045313536 -3.9065503787164868044 -0.19205918866051119309 -0.26446411194162916525;1.6834318131792413986 0.80684764212701542974 -0.45970788494566011684 -1.5989473384369792264 1.9755142297650694072 0.74578504866820261032 0.074358441113827916658;0.78088633109224248052 -0.0030134014212178615588 0.4782033417806540454 0.20664415788589068912 0.74942515979715562668 -0.21586214500716457976 -0.10308167285247771261;-0.47379852672076255837 0.6081084222220011215 2.9404439792917802521 0.22056819369468186331 1.3187816666657976583 0.40716732149473078284 -0.24042719091142678023;-1.1580087689731182188 0.75188407819036184865 -0.36905583247679935033 1.0497328388995803561 -1.7258875447659238755 -1.9094526561308962087 1.185258603850515513;3.2432945970476101394 2.0137722342669297504 0.28608475886985512693 -2.1805818404931032184 -0.71434255716161987326 1.0490715546865250207 1.6183208131239232852;2.3088540792346163855 1.7946816664213667281 -0.40454319754327605629 -1.747993692701952595 2.9357368121549485274 -0.79467178868883470155 0.21469700794481824668;0.82199225264913355904 -1.7652335518497674904 2.8726440410893503419 1.6369121583457164615 1.3302340433562647171 2.375161913700928995 0.6459773796310841476;0.1760223636645902312 0.24377830994645069418 -1.1788956561838093151 -1.9081085085910269861 -2.662910222894875556 -0.29707018403253104832 -1.9043834518601305827;-0.49574220823634651545 -1.3649628725928579787 0.31539261263419449133 -0.13915770832779703059 -3.0686508042800282325 1.8266593825725188083 0.1761673519796325138;7.0423508479080956235 -6.8411457837501945534 2.4342549180747989901 -8.4490296457629501248 -2.2257345809708288797 -5.6339638814822405877 -2.7870362952422307323;-0.36385442720599503463 -2.1372913633016636936 -3.0995995032575489603 0.536177912917252808 0.05128501249230040665 -1.3673197972725750216 -1.0272025323560278753;-0.69769241820999439163 -0.7014015690251733659 0.90564630497875331372 1.0058211072283709253 2.2211386238525347991 0.79697461308681238901 0.64211711096248180741;-1.0963565440533620254 -0.28952034228495893142 -0.19601937952173648094 -0.78147503554684449867 -0.20798011695612336758 0.5768110329261886271 -0.018945532236990029334;-0.49992332030671088328 -0.60684220125864596351 0.10521806184317192279 -0.47143971256472766429 1.7558030869484182457 0.50319133101059632107 0.19216597714643757211;0.66741897993619148099 0.83933530096549247013 0.37033751960097688327 -0.57539906356877723592 0.79443631908174849876 -1.2001537286513679348 0.64326446006784709919;-0.76887325902273728762 1.7250440638655550885 -0.1263837538146500572 -0.6339785980383119135 1.3131303993327825275 -0.87803209199514731242 0.59366598944126147686];

% Layer 2
b2 = [1.4935631954024146673;-4.7323524768509406258;-0.13899448518151805154;-1.6117607855882321033;3.1921539110885728263;-1.2085269130208522448;-7.4029132271016830913;0.9179203976125254183;4.529735521582717972;-2.3679031005643409458;4.3683051842905502582;-1.0215785396033516541;-3.0179578706680332267;-3.1239264153864056972;-2.3506834276585326649];
LW2_1 = [4.1326133382159113694 2.0180884012958797413 0.80922688611866477881 1.589433198961834659 1.8796223200220809613 -0.89833453263822882207 1.4128198461570695699 -1.4805420809117995073 -4.55170986100044761 -0.51239824066095340793 -1.3513497650700714292 -2.0304586985825752166 -0.94339678524685322003 -0.18764955080785047925 -0.82805242091256536785 0.46271397295005162187 -0.56956475556634111879 0.70769673475898986492 -6.9485463872205723845 -0.029000450759470476625 -1.2496479093368926261 -1.0837178652344554575 2.1167472195776548816 0.19730290401860378635 -0.61238664221856142778;-0.10488433304368720289 2.9516853796265736243 -0.67896904032419425068 2.1026701262542730753 -0.5230037794462958356 0.77504799834927184943 -1.842725414410796958 1.2340653807917807416 0.35145914195784083711 0.1786256979880434248 3.1172270161753030671 2.2300467575083011695 -3.8688088363397161729 1.1914176563661269537 -1.9463955062145092967 -3.4589500319322108446 -2.469793079146621384 1.43269150151351643 -1.8411083458709969207 -2.1805997241067474057 -2.3221319194414928866 -0.23800901215612998985 -2.4407081328752555649 -0.91423562030765637143 2.1565968714477614654;-0.67286686635755121877 -0.50305367357628982816 -0.78345312297906699595 1.0450630896079011745 0.50880988028304108273 1.254512624685140354 -2.2263109193667225405 3.1966120988400414937 -1.5120165345609926089 1.3654035725535214052 -0.14282219392425699045 -0.094725293831799561861 0.60115219288482024673 0.74979794333611560209 -1.1882534017224424261 -1.3439945547497531564 0.03001473525766943859 -0.85109270955553106841 1.3732269364003188983 1.1068443428304093334 0.4901536965984039651 -0.87408751265612760761 -2.7709718411538202254 0.91986219619172382433 2.1609856260350275292;-0.41397495646570592331 -4.7013886238458262312 1.1225528109093021456 4.8638050201974962761 -2.9404097632738346313 0.44062582177569353803 -0.83695655519251788146 -8.5328488296921971568 2.434793970214079728 -2.4348656422917791531 5.552591947261293015 -4.4758500097485232061 2.2236310782893924376 -4.9694065679127543689 -2.1937230411505748151 2.4304862514794023376 -1.4199450586350876868 5.0001777115202017399 -1.2072329470859881617 0.63310855182100522764 -0.25938327985127335173 -6.2216513709770762119 -4.5769446923624874657 -1.6563652604348992892 0.013834060297762173011;0.97585546361920438851 -1.3262701100090357187 2.4186423228170994548 2.0254908432875962099 -1.0008184839228377871 -0.20488028134077890252 0.64418288541669732616 1.9043304727190630832 -2.2918714347932338526 0.69116171922117586313 1.8786101033443214359 -1.7273816193164597266 2.3642072583087503368 0.94017186170884103902 -0.69944755974992678382 2.0424598470300230346 0.84941849375003641853 -0.47562143258927491729 0.80491893486704158001 -1.6317814547709865725 0.31941450231669027415 -0.33304041646420340372 -1.9284340985477121944 -1.0114738561366785063 -2.6989940845269186909;0.46567327267053010287 -2.1564165957532712703 0.32750139844415343537 1.8660387525856805269 -1.2125797905951696265 0.31844029944375151775 -0.36625209591914154039 1.4976577140155291623 -0.83210606978936663136 -0.76475078597255896629 0.77086661141477930137 0.90646535297418695531 -0.44172857277373112073 1.2423679063006527468 -1.0121093531378018149 -0.39204255916411984151 -0.67039340290303373049 0.67971348095002703804 -1.219212287394921157 -0.49107283859640571411 0.61540082446063792965 -0.70344929578958514949 2.0046613385466014456 -1.3349793727464360771 3.0820584010355824844;0.42950013524855401581 2.5906411835446818692 -0.57921349938969146631 -0.74092812629990645323 -0.12038479670887158868 -0.4598842365036097668 -0.67773445860972825194 0.31372112858478140573 0.30651852149539504655 -0.2669083348052089244 0.64185925957663847452 0.62705023039184415445 0.28546096948997068399 -0.054220524284472687571 -0.21442728487288922889 -0.3416080809270481411 0.10600659143284425767 0.17932019620513775515 4.4983597556938068607 -0.26826836471661530403 0.81898112373903730887 -1.2698516716849714836 0.30662574226659067289 -0.23922387689111879183 0.88840699859486382817;-1.1141441658698632011 0.26406541475790729079 -1.4887968902762296342 0.60940836863456748773 0.74803313625836231893 0.7872537444252767358 -9.4914284907103105837 1.9545065160626797773 -0.76885797944315525942 0.37530470866287823917 0.29468942677152609733 -0.53372415502618775207 1.3006863836457773775 0.72292001622358270652 -0.70130897575076744932 -0.86501604029129608442 -0.54939646768475525196 -0.67813876176124132655 0.69844664741459405732 0.031375530303666188114 0.62409095359956390237 -1.772947117909882575 -1.5140610899275992463 -9.3609085615617448894 -2.2884009205159330236;0.71722777017781580433 -4.4697562369968748541 -0.49158699364554458988 -0.80873931770156937127 -1.9606744552250749969 -1.6868236976237676039 1.6488432285284897461 -1.3722673327572674218 -1.4615095280892225205 -0.028747334817679704583 2.7249139920356535427 -1.3275441115212538445 -1.306418020745287345 -0.92706009521255317019 0.26940838045400611334 -1.9447167307171442374 0.25483592405344646092 1.8657344040350027914 -0.81045895236085796487 0.0061393923922275356331 1.1363530700582715749 -5.6632052930261709278 -0.23497857066727112496 2.4684745813269319825 -2.609250757739799198;1.9748598988613064176 1.8546886282654215794 -2.533498841256630385 0.77002784266280199788 0.014945003709676227613 1.6200944712834650652 0.074585927144012437173 -1.9806083786839372429 1.2508482830155862597 -0.28803959998980821489 -1.7532487038760031783 0.55552255379190040863 -0.28419851398257828246 -2.7544109971673926829 -2.0399628930439774877 -0.99157270353485138514 0.66117841816346101247 0.78489468873821144346 -4.1494759917362955548 0.69034000243547655185 0.93007160157021973035 -1.0704503932603872673 0.024197423597120924776 -0.29575649291281552733 3.3276948537090107472;0.038640773795461054452 -2.0208796071240247016 0.0085524402465925151995 2.3731562724193064895 0.55771077020536108382 -0.070560831245222693786 -2.0308027443511371679 1.8319985315444644591 -3.7918121179740023052 -0.95769543750210939237 -1.0448331093750384824 1.8626409917849440223 -0.089644255338710149283 1.1222370533781405033 -0.90465971383202437028 -0.4281469722007592571 -0.54349989368937901002 0.89301390225485799412 2.5651682968130771201 -0.43943140189850765642 1.0478345576779892756 -0.38504747627404378729 1.5994418654920481426 -3.7174603216369219716 -0.78016291418227090571;-2.7559845412443717549 2.6032927572172268604 -2.4808567605951230561 1.1548658309721215875 -2.3737684309476887456 -1.2269928825763054547 0.92180710888395633873 -0.22423903253265917157 -1.2847096621557745344 -0.37954485518571712266 0.37039802743639538285 1.6422928541474874908 0.68727387237620396476 1.8214357576177324649 0.40762787568061209509 0.2914024758380479585 -1.5769511091909089728 -0.41708705855378358507 0.59590754014511937431 0.48964067092906371492 -0.33684897808347513681 -1.0048372305447121899 1.2030386987175323288 -0.30196192704395502515 -0.78251164171345233278;2.377657735885459811 2.306290899363486524 1.3405894141894165728 -0.45134640384924407108 0.28271045797978128222 0.8496129290886208496 -0.011651431887907253218 2.1646615142267311427 -0.094719763311826327135 0.30426568301165946018 0.39621931097509888176 -0.034703379132893077963 -1.9665152703056565375 -0.1790770077054349152 -1.1114194973350923767 0.25644134517064542944 0.55773381517472009339 0.90753519798317316969 -3.2772762783849200829 0.3810271420209567772 1.464596884114505837 -3.5362995911003762828 1.8575327358265514288 -4.3669927768063763196 0.29816494720756481218;0.34190519203347041755 2.4027766843274047659 -0.62955523928166490233 -0.48385105408749190525 0.43292428986623565645 -0.49631917496455008054 -0.91686441101543347809 0.22107409439351216607 -0.15682772360544372514 -0.29202981325100546561 -0.13134723850705012915 0.78976590831799553527 0.29443205460901261672 -0.01350189123729391219 -0.28852710720161717228 -0.31526478735641116913 0.14917799688759419974 0.24972543183015932788 1.6832096514063918935 -0.25519532520673415821 0.72503160030821078852 -1.4898148656757219666 -0.24080377749682638222 0.10114818239956611945 -0.23805767599888505437;2.8902160250115791484 0.57530734740374234182 -0.30789723954582598475 2.5368568474654131784 -5.4224178697833878005 -1.1850868940308783017 6.6177915305071657315 -0.53857095830067380771 -3.3989172907010578584 0.3570115243626175161 2.1883173057854006238 1.2180960338006681098 0.98784490231637500646 1.3367354689455643868 -1.8968965571963161132 0.2028050501583444909 2.6569681106817877314 0.53397490114432988317 0.54472289435290111026 1.4462813663514317852 2.9056560804935180897 -3.0918346300035053353 0.9552175506576656705 -0.84821934347829330836 2.3637955637535581488];

% Layer 3
b3 = 0.54082081434972650857;
LW3_2 = [0.024026004453022872798 -0.0090705795309702231394 0.01341785227175695816 0.00025030798308554446253 0.0070844361165983346651 -0.2549231017293808188 1.56545329347561335 0.16443543551348116516 -0.021467714701993021592 -0.00061216894022584657231 0.25192685066584752374 0.0087324125231986703122 -0.039596489897591048701 -1.5719647270163907837 0.0052306985126661471527];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
