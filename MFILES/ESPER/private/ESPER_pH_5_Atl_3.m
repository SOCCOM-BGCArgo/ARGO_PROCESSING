function [Y,Xf,Af] = ESPER_pH_5_Atl_3(X,~,~)
%ESPER_PH_5_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_5_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0049881863089584755;2.0509668760421160272;3.0535287987915680219;1.9504269257218205258;-2.2726681641283410507;1.7585257406778251887;1.488046928454167972;-0.63262872262446834259;-1.784292766548555953;0.73172076715492029297;0.44331790024291872765;-0.95647410697209511721;0.42716419368100494447;0.61835206220386196296;2.2748186703367729855;-1.0126329504436335505;0.76098998452653876523;1.0385024073353159579;1.4905564532527353361;-2.2580550689420055832;0.2326160505374392784;1.5430028249434124543;-1.1277240620907926782;-1.5538893637990671692;1.8959404647421145285];
IW1_1 = [-0.92340057857696034027 -1.8505105840479580959 2.2916540190035532554 0.12670394204021279139 -0.082135214908935591516 -1.3150468619274884308 -0.86897926578470574555 0.44786937923375680359;-0.55588896726034597862 0.3169091712817150297 -2.5231807395167660246 -0.23481516463538124051 1.5147867846056546348 -0.18373496229886468467 -0.038284459135006589092 0.77286736887101870064;-1.2018287342894724556 -0.16899642984943072377 -0.36792210601554220517 0.94404980607001787174 1.7604738453412605015 -0.24397594808334152616 1.2683226450677405062 0.67055136690115013653;-0.49293101403914829639 0.18232332457496203126 0.14225891204273355406 -0.24459899846382127109 -0.65988197714349650091 2.2780241203895013058 0.5534764082008052366 -1.5359319139102662888;0.33101481549409267346 1.5573563510637662421 3.1958172735239194218 0.0090009178369567198474 0.54768332269217734343 1.3572286369834813957 0.044236347911398930799 1.0190018346178961739;-0.77415359112452730717 -0.0043688367486085944585 -0.32532371696226719537 0.87368869160111994887 -0.36125038317143554067 1.1723611289287514392 0.21312607439020064826 -0.15880829393022805052;0.023824977618493822784 -0.012508495954005469791 0.79281101818745902676 -0.089759338006439190472 -1.9543439351248317326 -0.31902567787195129645 -0.24707484677752603042 -0.84850790389780039735;0.98770018033951112457 -0.88308357435833351179 0.17761324777667669705 -0.066597588241933555753 -0.2130895186625553217 -1.1615868106432105655 -0.73480376110379708177 -1.1916052316798455557;0.74359285770936012216 -0.16915324154050159766 0.081496198523078766662 -0.073891941501391736336 2.7531073097249350035 0.33819617033311666354 0.85125531355433126102 0.13317918781623608315;0.073473065040031662609 0.65050619061312142666 0.57375390787915692137 -0.27345092927797826077 0.91458029859615164181 0.79694153652546706468 0.067465496007290917668 -1.121282461097551808;-0.94466930645547542156 0.74094395190999529088 -1.2397304261600874398 -0.22591900507714807178 1.519541931089124942 -0.44809361503797590087 -1.1931614695756205258 1.3090452959251155374;0.012172187674934909288 0.70680898647032086579 1.2262560476659478681 -0.0065701833253527398143 1.2957191850585081383 0.73489729246014234842 0.48467210307941172021 -0.84105195927286480195;-0.66772474057038744277 -0.9293763339435867632 0.61382829302202379651 -0.052697681355532377534 -0.038538323133015368882 0.79949297797764762308 -0.97833207692144308343 1.9183650416841655506;-0.55247032268001494693 0.14105586376108006363 0.95226105155724305451 0.60008992659913162893 -0.47695403577446371379 1.5096596080437574283 -0.02627989661273181371 -1.2556978859532217374;1.9995226827138539161 -2.3685708171466486327 -0.58732248794350450094 0.57879572623723174463 1.6359704741155594032 1.4544005691652468482 -1.3931509434555255922 1.10201796020847409;-0.087046070545831633058 -0.85567536223204454515 0.41579063042679914597 -0.20639711080066555637 1.8122459160844592851 -0.16716461310733271572 -0.20630503080350090506 0.84735277278329623751;0.24393183535676171703 0.90873517119896629612 -0.64894431472210234446 0.19436889534575590988 0.18420387596060877611 1.0804154283191844677 0.065476362681062813542 1.0791918150267987286;1.407320368619427331 0.42244316066540710253 -0.72159796824707611584 -0.70744729929363603382 -1.318126118794014312 -0.27383965845554847363 -0.45714373092168297807 -0.46974277125874575045;-0.38534748356155218429 -2.2660620841589778074 1.4449978649649726226 -0.47111141715607190994 -1.6275496206155481982 0.266044281319559206 0.15926835914461601185 -0.83469426204888996779;-0.87215794664988888218 -0.14507331056258634949 5.0566763150745792643 -0.23485410634236109084 -3.1715058299895488858 -0.92478606534187968169 -0.49246759193128369914 0.14294402185044885467;0.29296263893111895715 1.5201860641112756589 0.71937730755245243852 -0.85757016095938620737 -1.5301490182548855845 -1.1074696380769724069 -2.7997727723450158699 1.5424475471691547757;1.487115132098882242 0.2334125645746392419 -0.12965423108450774281 0.11373203916489113552 -0.2841705793754478182 -1.9345938318915061327 -0.77040083162443750986 -0.17123613519055647103;-0.72888393006813689823 -0.41250702689283397229 0.77674168106196017636 1.2786559686792144941 1.3370936328229154899 0.83489149836125842175 0.51735201690439458488 -1.5154608275410497154;-0.32515339505500001627 -1.7194412191029855297 -1.2183683634193567258 -0.055378941296538634897 -1.9202461855582100281 -1.8656126304108924252 -1.1172863017647545192 -0.19753941116234163822;-0.86485077717775937778 -0.54638173623852448468 0.80494561512796780622 0.27068499648062588347 1.299453940344302838 -2.2249551117405212963 -0.21140086570604207927 1.8744623302087353167];

% Layer 2
b2 = [-1.5421165270241228296;1.8924920140583774142;-0.4255880185937506166;1.2748075127731119949;1.2975121137888869782;0.17061654335390061266;-0.94899310544302428738;-0.48947191857980043572;0.18586985767729757857;-0.74345151511013574108;-1.2149181305898835159;-1.0806713056384680272;-0.99420754760676433026;-1.367102622878644036;2.0258040546451074881];
LW2_1 = [0.40131589561734110072 -0.042878076932326460169 1.8103328201748485338 -0.16293839864999451472 -0.0018026487415200402598 0.12402463591365563145 -0.32818109276644236161 0.88871037776040795464 0.23926433025400969945 -0.91194647304330855864 -0.9082465511634846278 -0.84098918287219270873 -0.34223947443591257178 1.5018335082440812389 -1.7268583960821817236 1.0122340398954368101 0.10500415152830377963 -0.90440925534169192002 0.33766815621637297218 -1.0800272567827065018 1.0897686872529444013 -0.60592815603415117742 -0.71605053791751172021 0.6933155957785794854 -0.58034788836372463994;-0.29695672605962614155 0.53627155024807071637 -0.28239943676984030629 0.62747415959290986365 1.2165937498389400861 -0.069648680159292264413 -0.17147193924395742748 0.0065320121091068869545 1.1975817854243044902 0.59757961835176065524 -0.050749046516825907505 -0.4908357021888925531 -0.1225954596043221656 -0.85972550235634115356 0.53993281987963137603 0.48248285010130509409 -0.9452562083598613496 -0.76663961989812945408 -0.18740791405323808938 -0.17627690643747156996 -1.9812683252711162929 -0.21247039323738070582 -0.89883432122569884015 -0.3421301380909308465 -0.46206707551943720924;0.62881215163199488671 0.10776634287619260566 -0.043841157277355935484 0.50903125052799647055 -0.19129226285282580067 -0.24292934291431775296 -0.06420469539560220984 -0.03656459911588716416 0.088727434243423677906 0.01063796298412071975 -0.19759769353063891262 0.091263453435409078174 0.020956199982354158096 0.65870022337525235834 0.4489442139071931348 -0.6191815311844384162 -0.21866635654093691254 -0.014234020118213966399 -0.61989135889340907237 0.54126678805832917352 0.17545437225570070794 0.49954605820342967704 -0.26359268288010700987 0.086090630843394841398 -0.061085183811761659123;-1.4392054549747903547 0.38363899654579303178 0.19631537135460117027 0.42668559621994650577 0.17407578669779177893 -0.49227639827878860723 0.99877480592517475788 0.70203548284197381246 0.42394000544208848558 0.3888683110917932062 -0.10037512574875147309 -0.10822961484402800203 0.19520715320962980788 -0.84919689112410179366 0.77577918959999381254 -0.94865405517203971186 0.89669154613988033553 -0.64427276637088182198 0.097449823441245170264 0.28069269625243448152 -1.2335453644255647276 0.10563981807522808409 0.2227859317366474301 -0.51914726104816366625 0.87115513648101583488;-0.049033234067506842324 -0.83401949268651509595 -0.47565225867431298878 -0.028690240701986977762 0.56644427544529174501 0.029575552214650829841 -0.865503657761061862 0.18258888969882391962 -0.065492077279561994319 0.70971190418050733584 0.21603872806558713227 -0.11207015648282950271 0.068180423461161071552 -1.0072526300813557931 -0.66403816327802900332 0.35157041343016393053 -0.27782378310943361965 0.5674779249931782843 0.34681071889435644007 -0.27159035768156225554 -0.10793669689256008004 -0.33552073065602855406 0.29582718457253970312 0.18610831300775021457 -0.3899077092199983996;-0.5719613331496191666 0.78441420345103440859 0.72433742158620495477 0.45578194319007619972 -0.059696772847175574861 -1.0061100456497649169 -1.1695421774071439458 0.77590561452850637103 -1.288814518194650427 -0.27614679390693841476 -0.22122994770272394471 -0.32157465477947555499 0.32546222336710312062 -0.13367879984449690389 0.04485650805387242368 0.22099278312414141756 0.99537137288585408879 -0.062247868602467684718 0.18381657664188616463 0.48984544127637180688 -0.3795700520491031571 -0.098529587810971333561 0.10806555635259904036 -0.29412910745277071056 0.14933066801143665692;1.0365200131400886807 -0.16137837924468645401 -0.70326528625144324458 -0.81387884465695192748 -0.45843807420605919845 0.49002687501843916751 -0.12618383031607668943 0.11735123123103240184 1.0608187111314713036 0.62628140091364514763 -0.084049166702175243104 0.47400899664664086774 -0.50688725951011615045 0.47091178042905940115 -0.028217233082315447412 0.56076862511395630939 -1.2785010492876389687 -0.80104345128464182757 -0.28797930743327471159 -0.07867957073922822453 0.53673024986857320595 -0.58124138400914016067 -0.4809677550217584252 0.60668695598856281492 0.23773248630295143458;-0.69922729193259203218 -1.1541377459845292286 -0.15339425706530027127 -0.3612831293212125372 0.69482652677835310406 -0.69936521355252323495 0.598725408423829486 -0.2775302745944218108 -0.98514844420694291927 1.9505690777045021633 -1.3558716798082504074 0.46715421033014481456 0.43095857154816386014 -1.2096558961191266057 0.69327034456163538767 1.0577480588438157305 0.31274256994023830192 0.61660887340624026542 -0.74120601239121852721 -0.25237265623672938686 -0.054990314874312558324 -0.31296651424231808347 0.93775488559165609548 0.34185763051234602239 -0.87070496060213875555;0.25556118389949999958 1.3008312723111055131 0.95434291655516223507 0.2151638580935372469 -1.813550359926290545 0.56167638142189812989 -0.093469230818626417023 0.21774918162823786449 0.026099874289851911907 -0.067971908712656708973 0.44785223991435541002 -0.54353453586949529441 -1.7798887082840180174 0.99401002842264885029 -0.33930433028965617526 -0.5164231730209205562 1.2052162937579611324 0.29333311433737974117 1.0942418516331438028 0.16860836040056537133 -0.24240871370420363773 0.2171877805924780358 -0.50457501800107318335 0.24212465260161875058 0.20188875759388738573;-0.33621705618376734881 -0.41484209000053429151 0.58734417009631523232 -0.27460816132627446917 -0.75046733685202304809 -0.067358159527111077791 -1.0375425701131189005 0.60217681428800462484 -0.80975174775243097258 -0.18315094019113870027 -0.25945472960140641971 0.10650285603525921907 -0.3647060054851483657 -0.093449913806062795407 -0.27542293401699952105 0.81313881822734912497 -0.34367777547431382912 -0.13965609598944392356 -0.15406819629761087098 0.046161067871803421192 -0.16119928844443970339 -0.45042620023889290426 0.27972031894176041522 -0.45368118486946928947 -0.1327362484487495109;0.076862160541301211003 -0.65606370573018979453 0.33585753288457492749 -0.22394524164728626947 -0.059962513227462703458 0.87457712639649709541 0.77196439816992856731 -1.253322202602777935 0.21276027209051995293 0.52013964714301330616 -0.64653083921837783965 1.2200677386781537681 0.31447625452445043814 0.020877741880957118026 -0.35214219022337278631 -1.5001597396288322006 0.93944834767059448577 0.025925791523137953209 0.0095338796673475768167 -0.45261376302377420711 -0.019846144515504041822 1.133082317181404175 -0.38262824635019082598 -0.04876239900387615428 0.91024950866650800041;-0.38261735483437475658 -0.69803158352814720367 -0.35407667162090072921 -0.12738118569548442793 1.747361753911377491 -0.26312218427015621192 1.0264451701887531421 0.50691271233090373638 -0.20090059897133996647 0.50994174097254485467 -0.15930103793008087987 -0.055474301811734801071 0.95452033701527216891 0.32905806466132042631 -0.085889956541763540221 0.48009486183553812255 0.28970980546512542508 -0.14141530354696704719 0.011660480246148977046 -0.25514809966518403606 0.42592562268642358836 -0.53080522837976840123 -0.19045517777224324485 0.82424516154047977601 0.13308889810970031542;-0.63220956609040424024 0.85633045603804180956 -0.99445640404040325233 -0.29547824776914582978 -0.20732669746317594628 0.30665302297482538441 1.3494666997219364468 0.24884703191653650967 0.43011864178199249453 0.150130406448160586 -1.0085108761281753598 0.28128399428248285208 -0.11229842763566352803 0.41684380536205989376 -0.15204239570149422067 -0.40818767543468126302 1.309519376749090025 0.84307218287876173335 0.086883758340988465063 0.79225470706224554451 -0.012622856766735570874 -0.4668176724428926283 0.29260028958045386505 0.097779030870473446213 1.0749429780406114521;-0.024565131361224658291 -0.11749995979836098947 0.017909054201446578808 -0.47903460738966213706 0.27381532440399736217 0.67920397693345735401 1.52563481056143746 -0.84403072628053887883 0.82662956767223016996 0.18351512102667180693 0.20239167509717695403 0.052423643470131731092 -0.10501060019968218306 0.67193137553683501828 0.47852825714628588472 -0.23047875597996508867 -0.09845869893479397561 -0.35263890674233128175 -0.11092854531337005553 -0.77592831127180517115 0.16049565357621103923 0.21445389863925717888 -0.31352646050483845563 0.058527513493987368132 0.44340276924747135112;0.96239051124356966849 -0.67182058928321464197 -0.10245705063585698602 -0.66907571807917987083 -0.8842138688032864513 1.042990302056982399 -1.6196903936374920097 0.14230821058063125584 -1.8258721078575494978 -0.76801966825295875374 0.41719704823171716024 2.7106462949525136352 -0.46177352231538376648 0.04517326608685507533 0.42541817736173981324 -0.63973407687681349554 0.97686625213151345726 0.90284771092241644652 0.51135600999201669126 -1.7103768303071482659 0.30111189540225258288 1.1752958799513117949 -0.77100275960312303347 0.97835648275553332986 0.76948224094755379721];

% Layer 3
b3 = -0.24994272921102395069;
LW3_2 = [-1.3763466883431074717 0.59803343310797352217 1.1699617305924714383 -2.4670994503842025303 1.279916906330220705 1.3754965966819014955 0.73206353682852032261 -0.97783603354088777238 -1.5772362961766648315 0.8517461381349360483 -0.51094146086349401248 -1.2319120636480287434 1.5475047488901270132 1.2561507133910827516 2.3089510183166970236];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
