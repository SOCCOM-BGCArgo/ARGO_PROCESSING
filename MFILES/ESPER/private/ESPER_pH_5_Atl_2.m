function [Y,Xf,Af] = ESPER_pH_5_Atl_2(X,~,~)
%ESPER_PH_5_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_5_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7070143543684743737;-1.5452566146915793777;1.562519785455791288;0.94456620812482794403;-1.4295832660717984197;-0.31589496445019699111;1.0995683991000622104;-0.53033383824571178611;0.83187381196044041243;0.89579949833649152868;1.408738662535990116;0.81672888777012353501;0.73433982417899446027;0.65222044175801396904;0.49640628214721149725;0.31710901101100513744;-0.66931219385848084169;-2.0936451692981705719;1.7831447719976680766;2.7104995016861992418];
IW1_1 = [0.82727637660298414257 1.0893787743226619469 -0.37265855785925439125 -0.75831746028475011112 -0.74345353636843869438 1.301021747636074366 0.32208564651980287064 1.1974550894527991041;0.8242627719025789057 -0.8299329215834447826 1.7686269232550797526 -0.20744496394874922807 -0.70864053340887900312 1.5077393485952685914 0.37270145166457974151 -0.23859743009904385569;0.17960144221766280448 -0.7580330175573258833 0.82379295136248109621 0.40198424347010630608 0.96491782625848698807 -0.70802183213965153019 -0.75676248969458803639 -0.97262940385362783857;-0.35881603934634986874 -0.17043704460009145851 0.23885621430797132625 -0.64759553028136607189 -0.87503309143545138227 1.0134732679897373586 1.1555175736135199216 0.33778121346326750452;0.43115104863300540705 -0.11457413236090031872 1.5440588715098972905 -1.1885241534812143183 -1.0203142432389991079 0.41605197594982457066 1.3485217479801003826 -2.0872379249916530597;0.18980683731597011721 -0.048547210657448838789 2.693535782842409354 0.37924427676406657906 -1.2677828316404011755 1.1290748271813302317 -0.29013901244345796648 -0.26492508085962962472;-0.30411024769941874535 0.40487449395473051883 -0.32077435590904607166 -0.13017354984647083738 -0.7845355010025224507 -1.1804808838270381965 -0.65576530215505124399 0.64871764879915649882;1.2301993121858685321 -1.8863547144111028064 1.3698135744426356286 -0.0019717618271491849091 1.1732494269350168814 -0.61902807210630761414 0.69012724165216288164 -0.33085332924784233155;-0.45043961615401534315 0.19645954277109209385 0.50319008185260649668 -0.37524041242283756592 0.89400417224618233814 0.23496020223110400393 1.5467393853507360735 -0.15770761348960815607;-0.026891711235386778212 -1.1590933567979981866 0.49019753977740898598 -0.084584344415644510673 -1.7154979733522248697 0.73586219633382099481 -1.3496755370645376892 -0.67681562193099931157;0.4086505369412473665 -1.2867865778165266111 -1.4201108505599795429 0.12417151765835596211 -0.417399476243156764 0.50643705425421925437 0.7644214940778739642 -1.3560029061906382353;0.011140765674090575416 -0.013446064350174785629 -0.14067981381240518557 0.30163233152707857876 -2.7994747157814998673 0.096537772736934049367 0.56317585973262351828 0.092515284123892510548;0.054695004061602658929 0.1095685864232699841 -0.14658518325626765377 -1.169752193455322109 0.16447747648316349278 1.1541790450049362882 -0.067818130193577158549 1.6324432743113448385;1.1887718149825070579 1.5984744851251975195 0.45906420068241360344 -0.43639221591923160748 1.1778326699702903468 -0.43548494423176048462 -0.4098988847547986869 0.89071664379851178683;0.9472023281192093469 -0.14011252081129338398 0.48859795558161783768 -0.90164533717384454103 -0.48949905207023136633 1.2182805110990142516 -0.51094106895601454355 0.02711917029479192498;1.0686359982003690305 -0.088229144982327881164 0.65477960255287781521 -0.11009876058390120901 -0.5098554661701778512 0.44664118814800918278 0.28993172350999923959 0.65370946622063164089;0.1734153082049479655 -0.59523056468378576778 -0.14523184781745387961 -0.3144926058810426639 -1.0051700449664631165 -0.32929742761202185353 -1.1242518880497220923 3.047417326375008173;-1.6029980290337739746 1.1456448102621097362 0.2845209698902644857 0.012682269206503792719 0.9830082435695538523 -0.25480330296710240745 -1.139407033911185696 -0.84327196927476333332;2.156469471172408614 0.10343332851108859305 0.75088933894635401245 0.14463218643149206022 -0.99045776180872624472 -0.59398195826182131896 -0.96476558383877097924 1.1930173144085980397;0.66626045302239755852 -0.73685792239933478598 -1.6473370317222921777 1.0375632445191795838 0.72013805646271356053 0.13640284951114978185 0.27604690483241023369 0.83243288493066081024];

% Layer 2
b2 = [-1.6398638129133598085;1.7247579650016908737;0.99407173763958989188;-1.1521964703230818117;-0.95398872200536100063;-1.222593950820646036;0.61825335836902839404;-0.37373962317920456089;-0.13462417414285690609;-0.29126772790112254174;0.25638440299991527294;-0.8722694637589475386;0.64168074577793443591;0.46011323462381104044;-0.97043690895276801811;-0.60437936643846412732;1.1415683081951961686;0.84931415312339220147;1.7490598463774882365;1.4067023811201595507];
LW2_1 = [0.58424194199307988296 0.43496688104360248239 -0.48857841008367253188 -0.13231214326899431999 -0.00012333697855809039323 -0.56018443819289043262 -0.31019398539726256159 1.02561901778291098 -0.054919676236942986669 0.88445927097164689368 -0.34540608741794376346 -0.038099810123032790132 0.11765150442395518049 -0.51095521366741147862 0.60011374797901206879 -0.041166309308747595086 -0.81367522794430602318 0.48095534412638579758 0.12365134298832057558 -0.26725987519383304081;-0.37275380416048348176 0.59327069334800808242 0.82582842487123342412 -0.56111758678627177144 -0.70566786872562226041 -1.1703930478699038353 0.81806060281590531336 -0.43769302741673826729 0.35717988625264718294 -0.75280042775713529313 0.79712440283047591993 0.59848301081716792638 0.50438774041762990397 -0.96604573151454420366 0.23860667826308207262 0.27105682281975279624 -1.2919219912516588522 1.9345843441431254117 -0.31161407559087683783 0.62868632622499609486;0.35893734472430971483 -0.44690342180005204753 -0.87306623820262319047 0.22614799729403406436 -0.095558478805314886473 0.70579335087167127671 0.78621146305018729805 -0.61282204944805362956 0.45591604846663047468 -0.48942653943428643393 0.79894450445809683803 1.0348083145071156341 -0.27108770226424122596 0.87313223538880280206 0.40572450919142222237 -0.15071636299388524449 -0.19030127434294533129 0.024974384122156054883 -0.082660709401833162846 0.55356665566883567209;0.13490339346433036227 -0.29053542463099318871 0.58336623000554499452 0.20142642815057282268 0.74388258129859552437 -0.17463559445119791746 -0.61088055374106731144 0.5015303429167983218 -0.84836584579935969685 0.83051067873387018903 0.069664985791882905186 -0.9816209367886646886 -0.33886947772033937376 -0.21574576905106462865 -0.24578371465670165175 -0.067330473036101956552 -0.038078008780971353553 0.163595612619429287 0.10677052992739063941 -0.25444831901157544118;0.2507385866718948586 0.027368390853661311163 -0.042569633202678723582 0.13663760182766615525 0.8445468086040180955 0.07509483049156388812 0.028938855499290622175 -0.19754082831246119745 -0.42901516569093628428 1.1514696753027338083 -1.0175809619887297153 0.30793983924605500269 -0.22781175176263201987 -0.19649963333359268813 -0.64474071458825421566 0.16708922296868883306 0.52440687139636044112 -0.91832963588184068904 0.66403047486976563007 0.43720670750272977445;0.24874480593356751434 0.30815937018210148857 -0.16637244201049913861 -0.46784264416869847381 -0.021186425119003426953 -0.94594883701129028886 0.1826547162936133506 -0.50691966824117717927 0.26069792158941701432 -0.096789272867513029275 -0.11717731011443642541 -0.65550284541283176942 0.34082939077945495487 -0.015695638658720461461 -0.13649530011051738687 0.0072802807800174118569 -0.0080214656111282801182 -0.63424394142784745743 -0.093829605897390533364 0.32362967659339414439;-0.093125815387901544895 -0.50590132404758925144 -0.36260587209712125123 1.2655051250780298133 -0.93343904658805321173 0.88364837068226920191 0.63381002457623725199 0.14398328222760398143 -1.1235152282860361161 0.50347344534564175689 0.14587619403663407147 0.26946636827891712329 -0.4420249122726697677 -0.25355686777460417769 0.27390355420548284648 0.032023478366027958997 -0.37782916885428818876 0.21166626164490670581 0.38555743102411116352 0.052164360659571182288;1.1082625062045696751 -0.35283980654270225008 0.65017388784655061329 -0.89901535232991636182 -0.62786029860944880809 -0.1123199586659691801 -0.62934622730757638909 0.37058416042534197965 0.96123272405682858022 0.74007430210928293324 0.45139343256661462744 -0.77367754733967575298 0.14893060421914122715 0.41448763304771835125 -0.39088666867781068914 0.4418998688850623302 0.35247313842187572019 0.58816779439078759051 -0.12957948513209510688 -1.9384100853236707618;-0.59975643826665536729 0.36309383991261517943 0.25315170436674172549 0.36278144088818697899 -0.39707451300318497012 -0.46077488867407268014 -0.59724565624170322664 0.872030964780338258 0.36719374813859373408 0.041878907219905871229 -0.19927254637221747391 1.3990289663455022229 0.45582368147884377851 0.18058673169088859667 0.47702328382970970999 0.23416353747653306794 -1.106000777427555315 -0.10777720984024261042 0.074484996559099431179 0.28456473664163639548;-0.096252176977077635867 0.75687447310956568192 -0.59494366088796235559 -0.18156134904712781242 0.007208518710550449772 -0.27145757466669495628 0.14081572001089526225 0.084062942853773622853 0.23912024138351428704 -0.14909003558652544896 -0.20318186658529660549 0.82064715637595286868 -0.57699286718846043431 -0.7261447312333857429 -0.021763094445180642539 0.0944721827389926605 0.926114701457649514 -0.31388068755890224937 0.15117423930530080045 -0.40274694806485683563;-0.19970186430137146227 -0.58455471384074442209 0.85146884099566921833 0.35575002546118866809 -0.21588022138674084482 -0.17027668717129976206 -0.10168070203867120294 0.4784596557326960542 -0.070695712118643255772 0.20150229022759708064 -1.4451061696586724459 -0.48331827039324981587 0.43838908228711787052 0.23242066883051309967 0.28792730484624123877 0.53740020545528932594 -0.51154993125406911236 -0.043633731685503829301 -0.18231344596175200201 -0.51465199153682339439;-0.12025887059720723193 -0.042265763417824356307 -0.47050543000960598494 0.36515198219637617916 -0.26803951274528775572 -0.21041866925762583995 0.50316674486602308569 -0.51198227090411585483 -0.60126977359488775754 0.24140225122554059833 0.57678592323783173246 -0.53819112205158170514 -0.20758899101998443126 0.15545709610345048723 0.21407933680103263807 -0.29621239963624262925 -0.1585008990986481181 -0.78542243577120518516 0.067732693195804341557 -0.9422558648677707982;0.18432691216315932881 0.42288244683071868346 -0.20366102691989110274 -0.58272531997701881856 0.64438820811608277239 -0.54529424892571087824 -1.1802447833992395498 -0.28292491575585332342 0.92176822847853012721 -0.85747154144655157726 -0.18715929381653181873 0.1192294744196421008 0.18266635498958838646 0.34917292243205466651 0.034469111069390177826 -0.17929577683133351984 0.18563175885518889974 -0.76774291828996299447 -0.082222187547027231203 1.0165167179173479894;0.094896554008637473698 0.35231890969677198688 -0.61581508748000657327 -0.36659463735060177081 -0.68855104817463808065 -0.4207260137520806853 -0.56293975031074561244 0.24210836563960941303 0.097218018541315301406 -0.86460118030948596157 -0.23837768117348029362 0.45325262920019993018 -0.46830664811015026983 -0.12156757364431095003 -0.15852815902920538993 -0.38886503800147487198 0.38352153849737286029 -0.76701404638371339928 -0.074088532654707592306 0.84730703497518866651;-0.14807005695608033147 1.0894178565585352914 -0.11897352111133037422 -0.89462103780161306155 0.87995904498943733341 -0.77675183944883274823 0.35912488684391047356 -0.23033704770758989255 0.90525673280137175514 1.2275042156018409756 -1.1658850013482426888 -0.39698967931513479135 0.053431278287194197696 -0.26929618760940804423 0.31255938482203571294 0.37408209242964574059 -0.009723428811966770835 0.78048361298152479915 0.19247067440290568929 -0.4829502184646253804;-0.53026900652505537526 0.22327215209702000465 -0.22609411570296472638 -1.028988355973748714 1.6434002041147814932 0.20911144147497870427 1.4928139270963411978 1.0968552114369281014 -1.4103787683404447328 -0.91867616204472291042 -0.47703865349877105917 -0.54419209439666527128 0.46493018204316732822 0.6195399143423661048 -0.84217123628678147718 0.49119679034921143179 0.79802129045790537454 1.0025953161634348909 -1.562185150093112096 -0.85195131896672493532;-0.085416634515391165472 0.17853952832262548478 0.58607969795216585673 0.34040858189990574889 0.099721573384124878592 -0.53822259844582276411 -0.30763043583412097437 0.70437761673704180065 0.043683865589764954429 -0.84778587673827343618 0.16498048531018968954 1.1511642900749470275 -0.060513890864148968396 -0.46955831120466895445 -0.40066515657282875118 0.33736269492432346961 0.00099174409025588015909 -0.63677798457031853374 0.34196695505035867857 0.0088508964466769077251;0.24711003336205997205 0.1868891767859232611 0.15495020996851693873 -1.029483023701326605 -0.49466487528834823806 -0.3225058623889747178 -1.4806712329219327007 -0.53101156295869611501 0.60035644229576945463 0.1449504236436749971 0.67611955593194306147 1.1940405080655529524 -0.17231116819115951944 0.12822723932760549115 0.18662923008091486521 -0.37845302548982989732 0.53360312689381428353 -0.2680631344196452992 -0.17723479628740368419 -0.085895994089698252116;0.55763917219314451668 -0.14319813226317112953 -0.34687630801313501516 0.050996252404525446722 -0.52174685468606607497 0.51869591055334585139 -0.58016797895134941676 -1.1786038013716986228 0.2249095756845717331 0.54513507245611791951 0.73047691086162458429 0.040323098519982253363 0.1810090729542837007 -0.63937199645123454772 0.11977436951344802574 -0.72524713237496851725 -0.46134098099334569509 -0.83677725735013541719 1.0398543802290762805 0.87859443574257123366;0.19500018847319122717 0.37596888862097199713 0.01099081676664963661 -0.18082149371190256448 -0.24188487008025610914 0.17789806450727593812 0.46219254349415506145 -1.2494585966330395976 0.86712058907524025564 -0.89739450764853223586 0.92630828474610305001 0.0097737764658477280927 -0.49486049201132914499 0.95328556697948896304 0.88645544963639522074 -0.73695131383942313885 -0.2521224155815018908 0.61269704089376775258 -0.11401506167905851863 0.1670470591414728867];

% Layer 3
b3 = 0.10709433082957320327;
LW3_2 = [0.89864722210398828572 1.2361530682016570459 -1.2311864295348136089 -0.71217435794345018696 2.2165979390828058904 -1.1783417476278261748 -1.032246315297303374 0.74181556542839666157 0.92968570099156122577 -1.4419706677119428218 -1.0319524639864980919 1.8743396789435076144 0.86127868746081515106 0.43720180599857605408 -0.98589130293260696103 1.0953325175602905972 -1.3037255214463150388 -1.2372697231094207382 1.4969741472201758548 1.0949468119110543629];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
