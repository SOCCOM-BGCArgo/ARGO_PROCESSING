function [Y,Xf,Af] = ESPER_phosphate_13_Other_4(X,~,~)
%ESPER_PHOSPHATE_13_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_13_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.6666265956443682139;-4.9774180529457003885;-1.5446653808132184693;-1.26892510317295093;-3.2680614398884939575;-1.7006098203293853466;-0.18731888201474394817;-0.4828776260799395037;-0.93418085336353462456;0.37101288942198118459;-0.12150132773080823956;-0.47298947227672244464;-0.057141964945243477192;1.9021357454115137564;-0.56948086689384469494;-0.40671865850787775054;-0.14150389609577845862;0.29574069909360722885;-0.17411908431022218857;0.70449012596816140697;0.98605385031630665704;1.1931961989931216817;-0.41649026721926218908;-0.56370776542247102991;-2.427890027889787472;-1.5068380050664245129;5.4232364946609168399;-2.6752431315253013544;-3.8436140678770529533;1.7160237857791396099];
IW1_1 = [-0.06399573399440434962 0.38430860627921481498 -0.2060747454534550549 0.16691385852112936017 -0.24642656293849196647 -1.1562122716403731015 0.7389230656925163121;0.86279161639790835636 -3.7666578898980476175 0.68814456668426171593 -2.0682705309164921559 4.144068340632911962 0.65369717686637573983 -1.7699505179397871935;0.26729178168181305653 0.54127047847418408022 -0.024530184266789194919 1.047321579537893399 4.5482795193588012594 0.79699035552767016899 1.7116684913894240072;0.43612781179626702865 0.9630688195750231051 0.43025712682308758783 0.73700493959536572675 -4.7958792737007245321 0.51827683570822635772 2.1608750248747026212;0.0056664937102709833985 -0.24921607825002745074 -1.3418724203414242879 -1.6094938488720678116 -2.2222270036167688367 -0.65502722635815080476 2.7118899996836289823;0.53764433618584228647 -0.46231191480562111584 2.282389031894798137 -0.88210448467999935662 0.29013303443531901493 -1.5632759599688912378 -0.49738227500660181502;1.1509471607144488026 1.0624399488420395166 -0.69925201869977560154 0.032015981380384563038 -1.1999821577900813274 -0.26559788434383996281 0.29572092614728173743;-0.020926430518292002403 -0.14907174594254671285 0.17653887967539985682 -0.22557047782504605071 0.51489794735356042565 -0.5391218757917617399 0.65313247171338262298;1.8246389908689617521 -0.76900786186887415408 -2.1424157696704160259 1.0500783758753553521 -1.3478315171660169014 0.48234760672089171951 -0.033288229342078291817;-1.1740208797275173414 -1.0280831241710479684 -0.18411833022867571397 0.42092167401128605109 -0.30137428086740203348 -1.4817569009890336762 -0.071611631725193983233;0.0027631162228152783035 0.5429576756281407901 1.3828352234161052081 -0.51642063145201289043 -4.3283126364358581739 -0.96375965986371181504 -0.0027292902984986182856;0.86241708284833740183 0.11320710062999897461 -0.081224196125718670092 1.2153004720602500477 4.3917137236014909263 2.2085733518300587619 0.13937021610755762069;0.10442639969869303707 -0.09306170265975800826 -0.2530446421326121853 -0.41888745795154058715 0.84556698172238253797 -0.9084548433233957665 1.2495452284158052869;0.26458298035262683978 0.16769094332034442663 0.87495803845708386426 0.28573970789392344471 0.34511827144207585238 0.44138180211031652345 0.060935585773214798189;0.061948861584887653098 0.68752602682158736602 0.16624200813112827158 0.10666437454406216268 -0.34940684283972051061 -0.8594201926944499137 0.63650465666160138678;-0.52484935607917215794 -0.16246416635825614017 1.5483823027215966039 0.65763114255100973971 -2.7021470161476095484 -0.4086453732639891423 0.67365845486302367018;1.2808398812002308453 1.1509371189050856543 0.6590204559194116074 0.53733702942863204033 -1.2528623493011852297 -1.5606042965191073701 1.633434017169925534;-0.098805120748744743042 -0.060769568854019115345 -0.053291494691478605294 -0.014324399006110438357 -0.11149649728876490085 0.96781196925875878634 0.70677976241926421253;-0.37811913001725183658 0.046224270835095955523 1.6028762449394575729 0.61253713652133856549 -1.5060495576414505425 -0.25365177566593405389 0.65037069855547990915;-0.52434745676697613881 -0.72310297853924010436 0.5191988993858823731 -0.85641499628925454868 -0.44794849740884729039 -0.74541663311922379265 0.72581919856377985489;0.92411709865143332188 -0.52312447264077488462 -3.0015895255603837199 0.54501301931503498555 -3.4544731963423234156 -0.8219359210229478796 0.9310557530008056748;0.058965662570352156413 -0.18065839334180072706 0.84023949327583435931 0.20115579525497642721 0.70891825555661935887 0.75593749331066217856 3.1653977013090690562;-0.43654356964427304399 1.2766858872296766858 -0.15713477334153089227 0.1226391121596407674 -0.059259269745738626933 -0.91650082239425623154 0.6550684297409267165;-0.44511104368556969613 -0.37424990462923463097 0.54419262933366596702 -0.4635619109404793825 -1.1253624784679034931 -1.3452938096891531305 1.1467469870036093305;-2.0468494897031836999 -1.3915689547322336317 -0.053380008755406473109 0.12510212423948766092 0.39882397940208580422 -1.5661114513721376973 0.70630471677834283373;-1.633000450063690101 -2.3347926636168536696 -2.2348499123300133995 0.15758112345501901208 3.9059530405675753073 -1.5378119313034508409 -0.62589754971757105562;-0.17013896867119082668 0.63180403408835383861 0.60986254687697882826 2.1451216978156781856 0.092950000748690600472 2.2707198420466161437 1.0122399298096258491;-0.085823756462569719683 0.09579003215808620797 -2.359811841009425315 0.19639264192573718804 -0.32794788362004267945 1.3035453419448403967 -2.3205464518630765092;-1.8866690683062097289 1.2225777663743631063 2.0034567819609323536 0.28834084125103748297 -1.0385336660919191054 1.2647438175800160831 0.16376084985670133487;0.69120325975364094173 -0.21312358138722450884 0.57528220857373624231 0.1950950404797512916 -0.26451395583353143337 1.4353767762518017115 -1.3127630856625860378];

% Layer 2
b2 = [-5.1590324181563431694;3.4229274392954027739;-2.1993332635783158224;1.2109081525670066792;4.3202694416336537842;-5.1037563530716649751;2.2135485546028168535;3.2295912409494498263;-0.31633832734061012593;-0.007524670812648160366];
LW2_1 = [-5.715657554452888256 -0.13002657450513493975 0.20803321825464143879 0.19644188846133400772 -0.049420435052292169265 0.54149868788914590212 0.047879201645602123549 -1.7530212666971471958 -0.67343105554162008275 0.12708030260183378335 0.47778446568463572852 -0.0043010754582712461616 1.2321221902244945401 -0.9375778120237107105 4.9291927816219773817 1.0087749606578304551 -1.2856003434826590581 0.70075340977140732068 -0.38592922539204149723 0.1115602356514393545 -0.25848320314827305522 -0.12578756224340612024 -2.161328144864991696 -0.81584693142418596157 -0.61756016065600172205 -0.13465372343521031517 0.18520767885814515274 -0.030614106796086382883 0.0040759133068504344033 -1.7280575660086896495;5.418637228558530694 -0.33628716483308590535 -0.3312860229165804915 -0.15525610531805164594 0.0096395054261820909552 -0.51957017825575235737 -0.1674084713921071832 1.1887657316279858222 0.47971509542850016006 -0.082335514015805272292 -0.35827509420469511037 0.11992810187553241963 -0.89107764354238627735 2.2311177445634475802 -3.8056399575090771314 -0.95843029244433231018 0.95794899044044490299 -0.59975383475570354097 0.39569328839896839023 -0.1816764688002240058 0.38313569090154320218 0.11777536818456556256 1.7919573877832257747 0.71829016984192162187 0.58496466035472760581 0.12506835882799127724 -0.34765654091124531533 0.30278643588754017291 -0.059881879069481121214 1.5497714737956937991;1.8457569956151453905 0.34115223779341025123 0.84488308046134630303 -0.39823990240876183666 0.36663193842058350302 0.42558465997843097917 0.10104203348557604103 -0.32746010184075841076 -0.39771188406079727162 -0.1549291097010207785 0.57103110438461890386 0.22508500139672521501 -0.00074506433642663116249 4.5404979389297466241 -2.5072635770269631195 0.33324774500265597066 0.45475080580089455307 0.02066225686020877611 -0.52476925746527558481 0.54629550130393467189 -0.4768523750057889754 0.12930626453423682554 0.62426993835565192104 0.60742788684632842422 -0.0080564514857645666557 0.24141645652134793854 0.11638424456705794008 0.50374633156734249795 -0.056445937042298194308 0.078188493948499859787;-0.58200814631138464428 0.21040915798049689145 -0.051057935147469292458 0.75732269561057319329 0.098287191838165047231 -0.72052428040047677982 -0.34974184703945182529 -0.52140713491437429283 0.051628154729300747283 0.10268019728266097879 0.42428322641722637787 -0.16641626992254826556 -0.126477358133255946 -3.0811747348804550128 4.7291627790809922516 1.5520977715506887318 -0.6756049300314087569 0.8467804655421461435 -2.905758561131150941 -0.44367115234357074049 -0.39462808609234356627 0.08365497770054332316 -1.9326074068550249674 -1.3918826729847855184 0.29610162934084605091 -0.12858529928712902901 0.20945285859182249943 -0.96153115939759459252 -0.12762362864513973615 -0.99666500993770901218;-1.3384315161549842355 -0.19605181053737164021 -0.53338480937845655916 -0.29586264777364351675 -0.54659478677988204698 -0.19184511443799609487 0.38430952529566531073 0.30925586182764619458 0.1235851133263231455 0.15483348505581545629 -0.51207580952302123034 0.14596469433233258406 0.46258111766281934107 -3.1700624624761934989 -0.47245848341104734747 -1.610805421513791913 -0.44795032176988947015 -0.33429583021796177578 3.1661630014724102544 -1.5633233385098632695 0.52299529014606127575 -0.089443229292483703019 0.31369159083524461584 -0.78927399047493140838 -0.34658199505951858832 0.0055808129783353529335 -0.42906797206837160585 0.89735259157003166575 0.65334623166974858943 -0.083932266413662179327;-1.217575931191327232 0.705653817669589567 -0.8234814815593783921 0.83781173865832025971 1.634251999315909698 -0.072747697371512237696 0.68320176883338312734 -13.009913503469299201 0.0061186310328645862958 0.93863745619201188752 -0.63711388405714886041 1.1547753510405283084 2.825277558875957773 8.4028829948723711141 -3.4005174180737660627 -4.0683704911102758217 1.594379643626101295 -4.6918684430245543027 2.9009705934162384189 3.1963501310946469403 -0.26290935151677591319 1.3686319061447798084 1.3146162268682985985 1.0064219397469360562 1.3127973304626063822 0.14379409638475321165 -2.5294375925700811614 3.3018221808918162274 2.4506672943932050757 -2.189429098006046015;0.86048747003537440214 0.053488274556641630941 -0.14634726050458013447 -0.31502100609934624575 -0.15836217263220050966 -0.03047190837086319673 0.24172838686935627095 -0.49149623276009624107 -0.082063518220565748185 -0.046031585100140506861 -0.11873563972993762816 0.10752429554030575043 0.46471653858599681897 -0.9462034430059019785 -1.851690379410307008 -0.917521608679117473 0.14910100043467255926 -0.54128068859643374555 1.6768066986749128322 0.11098197125040885902 0.037910082311843687486 -0.024347388152970321495 0.60634549961106276594 -0.38687774843977540407 -0.057963970979921772275 0.091031130411425992266 -0.4336738100714694899 0.23778994516310436591 0.42163584678615317891 0.18881049291660265133;3.8186913760171714571 -0.46985856480887844278 -0.060215645802728812175 -0.14704110484227081446 -0.44819263404669784645 0.40578797872876626318 -0.20321259228457430601 0.41290339897891825682 -0.033513500328175405141 0.088169150984386254755 -0.053141745104270075861 -0.03814365392045230424 -0.025479619692650262025 -2.4636873455392840349 -0.6469452143641947206 1.8912268133864997832 0.55678433792064885299 0.66430788775089411047 -0.84839817310084475466 0.45255622715445931181 -0.30681772462985229533 -0.29294532356329167078 0.31171173905636256896 -1.6977259798310504468 -0.0050517906093576134263 0.082349733305008471218 0.42403863701641453243 -1.5410283854532054182 0.086655366593519328466 0.82007577986397384162;0.81000433297594442994 0.016812400552366459777 -0.55832326835036583113 0.18449048660601144456 0.047921020784586938757 -1.1483206687863567463 -0.33512903859023673858 -1.2908898377751807374 0.0099893940903280041554 0.086556512831525878049 -0.080658681837689844007 0.012556929845353385911 0.81163036542342315016 0.30474323192562235985 0.46412768362009015899 -1.2932733291315550161 -0.35999879467060674765 0.2655541325536195929 2.2838652637144534197 -0.39628632427331567101 0.60938327067552366945 -0.03829849558860724118 -0.31258903543403671055 -0.747902962144791017 -0.31052873829633426128 -0.073083154423350588091 -1.1275839509004752514 0.47607640742468426698 0.059035184118581100765 -0.59690504691914592073;-0.36115195743827954722 -0.34717099407498935859 0.26137556619482510412 -0.012444509726408667025 -0.17463969059490846991 0.27484182747698088223 -0.56819537739640102458 2.3666297343195572545 0.052409354940123470401 0.035911111212344713761 0.060341512004865607843 -0.11304741925725213247 -0.62003206526454679448 -0.21346014433158891355 1.1961831944363761071 1.1915623339966090466 -0.077788485216962355295 0.66958550964743079881 -0.39304624062752169245 -0.26037566992129163035 0.27404024668523396802 -0.17981760287766895834 -0.16896736402838924418 -0.81556306267922762387 -0.44052457986597443051 -0.056378060730764324726 0.31434449811346693027 -0.68898439293762714364 -0.45485898569480848197 -0.0023431371603288330199];

% Layer 3
b3 = 0.63726145400689238052;
LW3_2 = [-5.7997784453923051373 -5.3945564430736805406 0.7264389082245489293 -0.81526890289327458294 1.291327535211756361 -0.13129287937196346125 -3.1757917185551258754 0.49640296334041655868 0.94780205238872927698 -0.97789225868225104765];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
