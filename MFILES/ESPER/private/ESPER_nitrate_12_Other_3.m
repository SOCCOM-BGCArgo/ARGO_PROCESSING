function [Y,Xf,Af] = ESPER_nitrate_12_Other_3(X,~,~)
%ESPER_NITRATE_12_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_12_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.8939514698435560014;-0.11259869218156086379;1.6041755140664777368;0.35015191897848141345;-1.1469574503765791462;-2.0070940138219888205;-2.4055459780751617949;-1.8185908369847683108;0.20272822919122757135;0.68685413914833337579;0.22644403186426756425;-0.82749847942936616274;-0.63007605825875201422;2.2680089323424539316;0.35254372285216639682;0.75731105331102932521;-16.926745461512304303;0.84639900530817058222;-4.0369355193667812998;0.37030795357567980464;0.49253788331020065261;-18.220710970563612108;-0.55750193203386322338;44.245078182421380575;-3.8391981798801180226];
IW1_1 = [-2.3446819191593859522 -2.5062610563494134297 -2.6769635058706904296 2.294717076175641246 -22.203706901636035553 4.7825890944506221913;0.28718577319545396387 0.97942859079893984653 -2.4901644600871244428 -0.41003295696694630479 0.094840490462467577637 0.13257314214960697063;0.012180762914709215849 0.18072633939704169093 0.44950440707640804128 0.9067109344486611322 6.5238089681496900241 -1.3477524745716162879;0.10179648510854057142 0.59990026484964942277 0.65032084037414106259 -0.7216047686935274097 6.3569569434895942805 0.49631385815708278786;-0.49423814797877152483 2.5205357035956419409 0.78869219729731288027 1.2653892284555596781 -4.0869525626044866939 -3.3225964938175822638;-0.15515523476557563365 0.01989720283860834521 -0.41890494973450026484 0.71810385800353249142 5.1839439844082519926 -2.8955144294532466631;0.99192563766598651487 -0.0084600175245828027754 -3.5485235954489477983 -0.19807807863898077572 -6.3961522779450836751 2.7843967369950752833;0.061756026762157578691 0.24960868719789530701 -2.3450041881270116129 0.45352060043103292752 0.45023067255379983775 -1.0944379918261486484;0.081658521581925672117 0.15752334543872820172 -1.9748724618678432652 -0.52333561499542025075 0.022318945698156809898 -0.8132708457166555327;-1.2415015447123101122 0.29605673855747444145 1.4618567783968561269 -0.87220339496011700664 -5.6480710325549940976 0.6384221130206922945;-1.0447051023643831869 -1.0794423454225499093 -1.0576076620944265816 -0.92528692569530024414 -3.7318827835971744022 -0.68042300063660487996;3.4693169076190848443 0.31912802555006669625 1.2410297270310910456 -1.0152094141091256851 4.4277971928959161119 1.4731008145204080861;-0.016188574562882081936 -0.12245170225348135651 1.7888124044951334568 0.35023478876073860233 -1.5966732952388127398 0.91867219375606579135;-2.0819125341485156255 -2.7594230993303190402 3.6990202106523333292 -1.4375876678337391468 23.798341823889611391 -0.27152646494305682223;0.10301487101839743032 0.84000711766699442951 0.70828363977745589786 -0.78860008571586592829 6.8790386365323392681 0.63563953363773662009;2.2869446227496506019 0.69396739664298368044 0.84517323957961687508 -0.60855672281414940894 -5.0916509814238946063 1.4516583936115994291;-0.16860167733126846246 -0.28220328693599655567 0.96803070710149907718 -18.343533134077894431 5.8981392725287422607 -0.82246663048091628312;0.094439994064716092925 -0.11508892040803576917 1.6835175540976328179 -0.44945350467578315534 -3.5971079153091314318 0.1687458017610610761;0.42216938469447673477 -2.8619343083842272435 -2.5961976304661873449 0.087736626171436057908 -14.550863388143966404 -1.7452092991949890166;-0.0068770691733041813126 -0.090114616719271081746 0.28474680592060525042 -0.0486346736180855721 1.1352769858897457933 0.31386018752295707923;-0.92868187058077789064 0.35127031590753160506 -0.99606119888522426375 0.40307692889969298777 3.2182131080692664149 1.0162870715242255937;-0.010660494820354082801 -0.19806430396154378615 0.647954386218329903 -7.9483808617268554286 0.047702223042588608182 -9.790389346959651462;0.31603857689182479618 0.79234503361034880342 0.053934873822651926978 0.69869967735395510644 0.90393408392313634447 0.14327780316368446401;0.41049848594555204961 -3.055989445755572298 31.818639456844159952 -7.2925574660664524984 53.726091743638825449 9.5117672470266896312;-0.52022932503150964845 -2.1088449816475054455 0.90070140279199095712 9.8816527622161984823 -19.078090199108942215 -7.9766155825512958799];

% Layer 2
b2 = [-47.665154335007350994;-1049.9436361700509224;-46.945707150081133818;-114.03373826345251985;82.491421279507193276;-5.6538305934050576695;-1.7258876179808091411;-5.9611981357979200169;182.11621397792396237;-427.58672496263233143;-1.3484869377130170864;-271.94964046991037776;8.1490585623478590804;0.21374137416328584105;353.84218373524748813];
LW2_1 = [48.63905745504466438 -60.898290168853016269 141.10566013104946137 -6.1799352575644102004 2.0125879940440127847 -16.203040054556954175 -23.447736615678646643 -43.454067639143801216 84.960414139378258369 10.405262107386159087 110.78277096116363509 -9.0555993286568963185 -4.4673058907665774697 -61.791027155174937491 -34.215224911168334643 78.345884703397913995 13.717157420835787818 25.23733866825140737 -15.437905281030051441 5.7967568996229950073 -39.105312082521237471 38.378268755530733358 69.940902273138760847 -78.609667576908279329 -25.084478593627100196;-275.58968810843930441 681.09462280950026525 904.42109843353944143 -63.859867844124813985 -503.30319059411039007 305.77729942589166967 179.25889566188678259 138.86074239205214553 -16.569362244531884443 582.43354346682338019 31.023055168994122965 -43.799349433645112128 100.29651243567565189 -171.21473275544857984 331.32477912450775648 -298.29476334651826619 -37.501042468647540318 323.88614445919779428 250.20423261649509072 -124.40203420141887136 -8.1962936262803562926 426.10495053966013757 -35.770726199501005738 -40.621096933467669032 -11.138864272058476956;15.86528153612436931 -107.79526338720614831 -45.045086901601671059 69.149792277087541947 43.65460655367209597 155.14488702147849608 21.87399439511113286 10.710762166795189998 -66.236788215309601924 -151.1987899087172309 -86.693483279853424506 -7.7837453086446775075 -185.5071344682950496 68.908962741380221928 -125.05125804208235252 45.985288468164419839 -195.75353689124750645 17.62481187721228082 38.484677553812275619 101.80776455648492629 180.7635316029497119 270.77252208850103443 -234.18697931526196498 155.29920854707654598 -0.52258231919079056738;-8.583953523508998984 -0.34654977599913294739 9.5219347972689902804 -55.376226096080650052 -6.7550364909259119628 14.550548520727245361 24.149372121845345873 -10.150446985528960298 6.8712341955236704294 30.009536437749691373 15.924086715271009496 22.775165169621740091 8.6958762408674115107 -1.6970751310101714893 41.971211875901339283 5.7449668444590944461 -1.7005709022388821872 -0.81962282299250421858 15.509323300637532839 0.67554358336354058956 -1.6635725891753059269 -19.946979648185692469 12.906354389413653649 118.11835770885757313 -7.9011226483235068585;-11.722795323414050728 -63.906274222146379316 60.44314520412311964 -22.548422153378538724 -19.191171242877079095 11.20667718824750736 15.426633659864368298 1.0064352092058372889 -11.349777145560452141 7.2126876637809145265 -25.253191358472395933 0.45674540793061363386 9.7982294347969371984 -52.269796017357492701 7.0134064308206465199 14.378960326918035051 -2.7411289896608175276 43.066071895636561351 2.3359863145338821688 -9.3327140309564402543 46.347713792085173168 28.174294914199084161 0.54895296985863839545 -54.222098772625791696 -4.9961141889527409532;-0.41257226429309695748 1.4996172571356960468 -1.6072573936625957902 -13.815813213078746102 -0.16837431779876632643 1.3256101119004266575 0.12635715522150964274 5.1095948095504191144 3.1962715062611932737 0.7263121799505755094 0.96023782399446344638 0.33667293005828508035 1.244036596952346807 0.21782713130600175888 10.68682585525758455 -0.0078344412744060093479 -0.1372444042290163202 6.014295884876066367 -0.14759778907361933986 16.238496934969440133 0.5804961093328629973 -9.2083351085837072958 1.5438707056131848461 -3.8450861332323751363 0.28964196498313737882;0.057000924233334936131 0.032361599805566916566 1.5767245053436691471 -4.226257652087676675 0.044902320997816380643 -0.95604992604942407031 0.38216585214547582616 2.1566460181171653865 8.3036597380120884537 0.69461603754415379708 -0.27039619734020026165 0.15957374799732040871 8.3464252834689922622 -0.084240453102276624531 2.8786020122055258064 0.27873435686662667576 -0.39177964126834591285 2.4300763926425856809 -0.36366572343072933737 11.326979600994876662 0.56216935339126450355 -1.64771687222710006 -0.3333240846167361271 -1.1466327242450888857 0.41280130210117177425;0.18957070934509243076 -11.000236653225368144 7.4614470352303010614 5.3206747754243481907 -3.9212767757979816174 5.9687365568397394711 -6.4957296796440138209 -6.2688184736579755096 -24.083700624381314981 19.845597522098152865 -9.2884205987362982171 -2.5041781463885395276 -32.858556864034333955 0.95986456254682250844 -10.175504079993977768 8.7794792810801070004 -0.61576562520183120153 -18.682419097850821998 3.6504557740478795758 -13.164694863975778816 6.217165546002167531 13.063147057232630033 -25.333560008230318061 0.61896753312568342231 3.5996217009748998628;-201.24256190666412181 857.25419454958557708 -149.09532997582800817 -43.159399174708752867 372.53580862852436439 14.186797805401402783 88.911392417011853695 -4.8065954256765355268 -194.83808382682340721 83.658053211163519336 104.28937951317701049 99.478045057618260216 488.77892062156712427 26.958299431179273853 259.42435230439036786 -157.37693496661452741 441.70366733123086078 -43.034819688757977474 -16.138886230570250291 -316.87176162610148822 -700.68071219568366814 77.324529240201613334 102.7855765940634285 205.81259677633789806 -185.40359477724240378;321.72153582003721795 -12.433184195457773313 299.38533916867953621 296.70723357529487885 -150.4462232649266582 390.79544070828336544 45.592037111106556324 -184.71075842315377713 -466.45900014447022386 9.3721911854076935811 374.87880763735694245 -22.002733395621394408 34.007769159320183405 97.75482564592434187 -22.009472901631745856 110.20272929828531971 153.19865196173864774 119.07950485266765384 -39.106703890567430904 1.5207349623029622343 -651.21415886691215746 -303.00920161469105096 156.82385654288034971 -306.89189236042432185 201.48725747656112617;3.1563325274467981529 3.1993001865569929976 3.1246278885024527661 -37.377783567368197737 -3.5019479462925930946 -1.3844848008162597974 4.6193017167100904885 4.1872123605890756437 14.193358108714081212 7.5741611033283398058 -6.1489969979876502038 1.1430115718461137941 12.342513090966315659 3.1289902531206932323 35.431042829559835639 -3.4138648213975746337 -0.14288731906221821544 2.1498523729656486836 -3.4096270713890666215 6.7036036824197058337 -5.5118369948040291106 22.114113906032628165 -0.31511197266898699487 22.813465240249694688 -1.0113910065866313914;-153.04134031404308303 351.14240914962061879 172.87807748297464627 83.913064298162709065 87.197758987345565629 -154.00971997298293559 253.77297032223668793 211.93783929282602685 -628.04287433667616369 424.02128858884395868 -20.646024751898501393 -78.400681308048618234 218.44835544123964155 45.984791011727445209 -100.64198447369646772 -11.46610357973532679 -72.69613623682461423 -55.063135854576557904 -179.51777385735800863 75.593856358564735842 -283.05184605560725686 -82.583777281151029115 343.57235849682768958 -206.28590732193711688 214.27912850781996212;0.21534740793800852265 0.80755372010370429781 2.4981123443468060685 -10.453664778582192341 0.14668596095739858121 1.9393122588037770004 1.237750387230343474 -2.5223807906820296942 -0.7934154024930780702 0.355942139329880336 -0.81415016432537312685 -0.20362333920909428397 -0.4582912377553972072 -0.14562225325715391633 7.0934327717938954194 0.59322318289358300092 -0.33984596003723882562 -2.2542866896011646283 -0.86763864057611739256 3.095127824190479604 0.26017665563194602996 4.1813187993320175551 -1.8973531821842335443 -3.1257056845785538002 1.4339136061693700253;-3.4915471657346714984 3.048044530452481915 4.4585268266163593509 -21.518958621933318653 0.34910255860040323439 2.589913088464841362 0.67667485505458535577 -13.379973302283122649 -17.346371167285237647 1.7366912609638294196 -3.7783108513739507295 -0.22095261481855119068 -11.259356437956288488 -1.5331727217553003939 17.854306267528258445 1.8340241362260394364 0.47026966984186080456 -6.9692766675562021206 3.1851020958840230435 -6.6028400348326954372 -1.8150957983631827997 1.851065640439432336 -18.540248653988303573 -9.4986318114493055731 2.9500231240441010527;-132.1665275977542251 24.518391363504065339 189.10096676219586698 -165.330922402724525 283.78170354468682035 117.72977559079723164 1.8963272053086397406 188.6439557507153495 184.21488050385676161 -72.914955343739180194 -9.5121908209369134823 98.334521038809555193 243.96869149622324358 25.399613483059145125 165.64095942077727841 6.125966802345381268 6.5397361056076634966 5.811282470829469915 38.530795470115307921 -107.47345999560437235 -95.644038046101073292 21.029332482156515738 -62.223050850451727456 -105.98386293892690446 35.120861308305016735];

% Layer 3
b3 = -0.045251063330247913441;
LW3_2 = [0.0092216771102452081005 0.0016332758247060686317 -0.0085845801546784727964 -0.011596327986593095438 0.013244007892065270959 0.27296104460120829138 0.46219620608629935488 0.039592906311373438077 -0.0033551073226102639917 0.0087886387516061814651 -0.023714162323753774225 -0.0012418893923442143358 -0.22697943037101556141 -0.029909977546975011209 -0.0060417978286416759021];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
