function [Y,Xf,Af] = ESPER_talk_7_Other_2(X,~,~)
%ESPER_TALK_7_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_7_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9089433345217739;0.15145737405176013;0.22043139536862127;0.23656669145693698;0.99496711011583561;-0.062165270785038071;-0.49910914709482995;0.91441792031605784;0.67783340188823138;3.940284583764837;-1.459458854337794;-0.42110286045929679;0.56082134267720263;2.0635051393406165;1.344437624395318;-8.166797472198521;-3.1207621016600702;-0.98908253400843893;3.2456118052506926;0.51390563053273342];
IW1_1 = [0.31968350113438881 -0.28497202991058312 0.0719389876308697 -2.004228337301643 -1.5277530211289201 1.7009127018386963 0.59708607375611367;-0.079389222530566947 -0.0096841355799662208 0.64977811747964742 0.019777230625197994 -0.064528348714927575 0.25199456247939261 1.2391192134679951;0.34621894751293203 -0.52082381865602345 1.3702606260535872 -0.47556534505427189 0.047480980219538178 -0.32984335711809526 0.0030897028003137382;0.084681015337842641 -0.0074564091353350424 -0.40937907838855225 0.233713145086723 0.40572874756258798 -0.20095420850042645 0.015333566970768623;0.046099276540413243 0.35929281486034226 -0.47417019836817165 1.2645889213311721 1.926345266384722 -0.31162257176673519 0.54509137078679704;0.092354405134128278 -0.065658718327255644 -0.66769422903946374 0.32459923467101831 0.18502094490666687 0.13950093724842655 -0.13662067441830805;-1.34772023406261 -0.28630408024480131 -0.14632988899244864 0.46566760141724928 2.0548040084732051 -2.5626453496850465 0.094267552136890725;-0.20632557477839109 0.27869652911464809 0.51303026032332577 -0.30484448777780826 -1.5856559884407293 -0.15011202895507381 1.4959757687929502;-0.20412057082433643 -0.10607095044297488 0.96888055193718459 0.65863260426944814 0.5789813906256992 0.70494816951888284 2.2178455961270056;-0.097774080668472818 0.15685857682666465 -0.75558944145030105 0.9300592715885142 -2.9166006449472879 4.079293731412319 0.21426521689246258;-0.013701656328976018 0.17465464905061839 1.5748187440117993 -0.9880802793637089 0.34318594717701773 0.26042389097425817 0.098365322508799966;-0.1092211416720284 0.10217834129436483 0.70284831734373743 -0.22773882344753893 -0.35643195888413298 0.50967679272958888 0.056460662522174222;0.1871785413053132 -0.44259248796250023 0.70917455274634278 0.29920328014952458 -0.60325349101036463 0.081331218065091693 0.66789177719299686;0.43710536589999305 0.26175195925940331 0.4610853070687409 1.1300766076648465 -1.8152928698048716 0.43848991147786842 0.098593572563678109;0.48288423966942806 0.19999487973216876 -0.3346300448325944 1.0243926957230463 -0.56093809843905229 -0.15618359140398536 0.54115597553369077;0.010811332394130792 0.065925932939737142 0.18917239134473768 0.3309869175666954 6.8303903576536147 -5.8368656237000964 3.0588783842735952;0.0095456129461603881 0.2795157635591084 -0.22538853184601429 0.43394550917229568 -0.32109113592556854 -3.7064312261874002 -0.50022959790200205;-1.3274375636363072 0.85633330741835911 0.058703371880416008 0.28009007769021138 0.91620101534321829 2.2411209474223037 2.3716068994966233;-0.28754206843984564 0.48177683182169123 -1.0275221442629305 1.5045216552088039 0.66873954961109461 2.1496633978788267 -0.50336783147741271;-0.0091101038163614572 0.024139177013875468 0.57957519463926488 -0.19074886618971987 -0.95819380938784993 -0.1331054109264044 0.7132060689526738];

% Layer 2
b2 = [18.355963272682633;5.5863175874282165;-2.9417495162714689;1.8057117506409666;0.12564313992215514;0.359131793517311;-2.6011596641928114;10.116309396920778;1.9901179641132825;8.2797949356596678;6.5694535538826822;-0.20438251491754683;1.4896509043500346;3.6441303167759322;5.2481101304962561;-5.0274162504280806;7.1256642708134832;3.1384035033188047;0.73580270888245081;1.2108756144666071];
LW2_1 = [-3.6527522011902751 7.6371009086326245 2.1702350345713493 -4.4846709124587365 0.63532715759828073 1.5844535551545922 -2.5047844624046673 0.34259557517350386 -3.1682653298268364 3.3608489618777875 -1.4538646934772415 1.8718183498305461 0.35465363640199599 -3.0672532418421263 1.8721352634965354 11.686028829252393 4.7529404542825384 -1.4589629920085088 -5.8444244397149312 -1.9007757429172805;-2.2830135981401338 -1.0118963831726508 4.7350493186457046 -3.1574375913149284 -1.0629254963160299 3.76885733531816 -0.26969542937274127 -2.75953885765797 0.095441513367341954 2.6368763005995937 -0.28947781267982081 2.6491993290872897 -3.5744662616565006 -5.2315662173741613 5.1605746294582158 3.7716113263325997 4.5828187604653454 1.3506159801630266 -0.95561214721768672 8.1718780244103169;-1.6134592125236595 -1.5382781306547608 -0.058274431971246196 5.2769972441744386 3.4201533035937213 6.4238904884562675 0.19834475657011663 -3.7165480598801275 -1.9472238189390199 1.0559758906049233 -7.492625149779311 14.57737211955641 0.81134821836453863 -0.95178710305549818 -2.1055736527297579 -2.9142617345754114 1.7198289539986931 -0.24616202697380488 -1.6251528207356223 11.930623607746828;-1.7332531062429006 4.5731303354348025 5.814823511051328 -0.016057039554590646 -1.270543589554384 4.6897097917825992 0.2051548249457309 4.8401766425066972 -1.1822328960869828 0.25298338195870401 -2.7734588593390543 8.4569009186901827 -4.2874692094821665 -2.3756575313229731 3.2273059809124911 1.8882742021725389 2.000265826258139 -0.51527913905649625 0.77131438302679856 -8.3103230871948988;-0.25843291602877139 -0.097176548662597048 -0.049950628254241597 0.14612371443619218 0.097666434453727038 0.72495687194532266 0.12165645947861205 1.1974996484209346 0.32905888139035006 -0.53753281235931982 0.8727836710969844 0.18742351455062886 -0.53214745446232525 0.11563348346374851 -0.14667920564890094 0.18079048238124812 -0.83466236853634213 -0.44729896042211709 0.21850226817893792 -1.6571650750838878;-0.17048951315825142 0.1789362973874421 0.39257127147095222 1.6232147260797711 -0.37552100602978888 0.25131581448731916 0.0081431013895598356 -1.7429743181017974 -0.081814378683829264 0.38281725558734053 -0.32115713004072283 1.0624390034001978 -0.60337890763799606 -0.33736545496205439 0.21899676907000981 0.28798381325227307 0.49936113628841655 0.27663013248767243 -0.1219577722683084 3.2296510863031056;-0.23915312810551836 1.7542954845304373 1.6317792215269045 3.1119776820110241 -0.77061332338000055 -0.23253844017691169 -0.49268673997011114 -0.82702915588563686 -0.53997519236031244 0.71095454898462018 -2.0400941987020595 3.1623839440484263 -0.34068586761041958 -0.21192917115354751 -0.04461702285369476 -2.0882048609665511 1.6796901047656139 0.25830782087068888 0.69215043076693916 -0.54168147026899938;0.0087354157494269127 19.947867709954689 3.4923468833733686 3.3238992221626535 -3.4943097188023464 5.2167900873102093 2.1429779865549405 5.1653548962590152 -13.177867216113999 -2.099702939753187 5.1666846828712716 -7.4276723594474596 -0.46578262915302515 5.8702711295483772 1.1301053632097029 -7.930168544422159 3.0090826095675216 1.4820591325289374 -12.226190203902069 -13.873642567754326;-7.3945615081914733 9.4540387553394005 5.2847872976516852 -1.0740163355249914 -2.3932744598361744 7.2425128943013615 -2.9568118683367217 0.53769339079245171 -4.4881516457351429 5.2730771193538537 5.5432089651203897 -5.336807378732324 -8.9081487737362473 -2.3382142236778942 4.173684146138287 -2.1837281446098387 5.9375862800547079 6.4206249148605181 -2.3084369727832645 1.9714184089012543;-4.3306140581057342 9.4425546181916893 1.5411900788415984 -16.574078363471973 -1.4923139151630007 14.281487108485154 -0.77208954011367414 1.1791059602084286 -2.3663037449371025 -0.455283143182102 2.4396922089820356 -3.0255315804087108 -2.2312607539299671 -0.61130544038580725 1.0665912300666127 0.69939276425285379 3.3929147161765796 -0.51136045064429902 -0.11253256110674981 -2.0606114934024311;6.7983890634504851 1.7214289848475797 1.0776437579551648 9.8475326307344186 -0.43428675294258912 -6.1748689158212589 -0.67377398495473695 0.96696470562889847 4.3821582103306707 2.0440470473267851 11.154926016741493 3.7425734570096014 -10.079902461013381 -5.3516015453658872 13.898978570142669 -0.20630363569716245 3.9387414500507734 -6.0506290804909275 -1.7334884405639088 0.050369591614013158;2.5124155441491967 -5.250752315296082 -4.0918170943127627 -14.534587955880086 4.3069957829199961 -0.51829055911993882 -0.74596434785197463 -0.31172708947385835 2.6644422344518977 -1.5937873756970922 6.1694338550034837 -11.748233070098371 2.7974156715567595 -0.70745309567755577 -0.92666093767196311 -1.1369964620468289 1.3101519626405393 -1.9480250171910138 2.4452412904161247 2.8226343912283891;-1.1290518314500686 2.7195357569903198 1.3272146364873765 -4.7712425550443305 -0.67988782408314741 4.5060782284842702 -0.1428471298838187 -1.2777199532121868 -0.53578971760138694 -0.01846615187483136 0.14693980871621767 0.1268219231242628 -2.1003811858661781 -0.67371449277140283 0.96397732333476904 0.29795910245484858 0.7228384857297091 -0.13933182971513705 0.37946531951674634 2.4680140510802269;2.5439657010904035 -17.426280077690674 -4.0319572699871928 -9.2027456830325054 3.8840542997956899 3.2019686662923741 -0.052199807706393611 -3.0747851160041111 6.1356959358156109 -0.92642746541522614 1.6625478177966482 -1.9702492380113139 0.70581712819601317 -5.4373464728988488 1.4330189707581762 1.0786851207025538 1.4596162559876502 -1.8554499230427981 0.75141356156824046 18.731558331068538;-1.3098159914669754 -1.2047633998625198 3.9589510483498822 -4.9133926680960176 -4.9159718695054755 0.54535129668800308 0.35281787093011208 3.3545813116136847 4.6745819551845509 0.88365009695221419 -4.0900202187166972 8.355690184239787 -6.9819572525812941 -3.4337983625941275 8.7880297452697977 1.0775928442324512 0.60699037398178535 -0.81736820883419103 -2.8315934133790757 -9.3862381970861595;0.85943792533385566 -2.1843546117919797 -3.1164248482673824 -13.89728367340612 1.059728210982555 -0.7490844897378417 0.3567555707992125 0.7647440194123355 0.27994020617290949 -0.76890525937052356 0.67475181822634489 -9.4573608780700766 0.9834368878745523 -0.50159600848025376 -1.1192819003360928 -1.6731294969692794 -0.11317378443249156 -0.959282763795961 3.6905582656621374 1.9545553598679035;-1.8755724695219451 7.9278944166966729 3.9828553000820142 -6.2848756306259768 1.7787315491221629 12.868001347494056 1.7166711821657408 -0.25688323472397795 -5.2982355175969511 -0.50968208590192987 -1.4600685631766372 -3.5026422353216264 -4.6739975508257467 5.4971073896091349 -10.707070706321304 8.8532037705686992 2.0080473432463966 1.4055407711613583 1.0833434881049107 8.5426403504093997;6.334874085447801 -3.5591547287167145 11.850695143163241 7.342292120515169 4.2625170478241223 -1.231030563941627 -3.0846125562816407 5.5390622306300958 -4.3274560489521852 3.3478253084719802 -0.83078530724902111 -10.815843358288811 3.011787911654169 -2.4990690023180404 -1.4703723870431298 1.7226185750297898 2.7512196504247903 -1.242268235740299 -1.5942616363991831 2.6074276502090044;0.46444017754541406 -4.964356544478207 0.66092784718416253 8.373928266444274 -0.14916360830986966 -0.18044875107971395 -0.014800833192060598 -0.78632696604592711 1.9752667809619235 0.92100406672694335 1.1516543520525651 3.7455477682557894 -1.5812464888230884 -0.66119266763628082 -0.19423868039938885 0.65744432313635537 0.54567496139771576 -0.15422825501686788 -0.72899305258821234 5.9614473176064733;-10.984760292055126 7.7852088996181994 -9.8596248988102158 -4.980176802186028 -3.400445219015511 -5.6705598826366783 -5.8185577649779558 -3.8466877778828321 -1.3017380112627335 -3.4795856178664404 -1.129185044794125 -2.4614237832359165 11.516382505435569 -4.0560925307011617 -1.4975083350000393 -7.3864868607886773 7.0105042893383871 4.6698308227646335 4.9276448388081846 -0.38685549760901439];

% Layer 3
b3 = 0.2393071963402244;
LW3_2 = [0.029761574223591571 -0.0501096943865992 -0.11377916849418367 0.14685498148200504 0.88717668416067286 1.3256174913745631 0.24380697352090158 -0.016581123155203884 0.011240315993740393 0.13578783586331242 0.012218512303291438 0.05794048526285546 -0.83354763903462936 0.042150543192019711 -0.045044851370122381 -0.049464015034082015 -0.027426235190136809 -0.02351671588200142 -0.28619536375447252 -0.011659716014732802];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
