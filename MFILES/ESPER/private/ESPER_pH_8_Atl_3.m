function [Y,Xf,Af] = ESPER_pH_8_Atl_3(X,~,~)
%ESPER_PH_8_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_8_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.7508762061313944969;-2.0119583199408732632;2.0573525283984106515;2.9469747638364340858;0.28837284013059966137;-3.6737550716464144607;-4.7618023043446813247;-1.4697681791439769494;2.0396062502581076004;-1.9896335536643547925;-0.095093651782355223534;-0.36172318718842583207;-2.0090910738494871524;1.5001898254720946735;-0.40369329585977492547;-2.2257522081659240065;-2.8806320680680856938;0.95000137797657357996;1.9611163190427001179;-0.33261714088280719404;-4.6105131739734117602;5.3556019304053537056;1.6888704731912569379;4.9571605743283875256;-2.7319425594667356982];
IW1_1 = [0.32459667524903429436 0.15311416483431675162 0.32832302929813095282 -7.361593249493937563 0.96388779670301083513 1.4875527200209972545;0.51379296751438574553 -0.57262801264017870739 -2.6222968969112434579 0.7327560326938964419 1.517531525378617463 -0.97350168786750090888;-0.92866927807551169494 0.66446978896610586762 1.0088249198324343858 1.6245625051507688319 0.22447250256144815617 1.1555199740787800433;-1.0689539048897038764 -0.23838982774899628025 -2.4277840547021245499 1.4742427895274203831 1.8227447493276089929 -0.37113587623978122609;0.2128889250549262091 -0.027789978478747635188 0.46502301706003273951 -0.74164884791346497028 0.11797961563409199715 -0.47642937141017699387;0.31784764446234398116 0.98609732194247057269 -0.021063031926876044087 -1.5865684413873126779 1.0370107214144257402 -2.0186424443931194617;0.61262814807216214863 -0.21910748270301041996 -0.64638866753718327018 0.043900272064232664926 5.6607391576762120522 -1.7498518728630008123;-0.23761093522461751437 0.34324796867707357828 1.7067663627102163115 0.25841416615234458209 6.1214498493185232064 1.9049820830313324294;0.032069229767937634801 0.46872769134486741427 3.2417082949406266223 0.45005805510002688807 -0.9484049847032269831 1.3864970101035873906;1.9616377289959583408 1.6787364339739179186 0.24230967031590053273 0.29598836091165275919 2.5617120409646836343 -0.10921009065968688423;-1.1674622579745603801 0.51876871646265176885 0.75436148912234746167 -0.16342578711042507478 -1.6573629455448584125 -2.3150043892491130038;0.24688612685896046961 1.6219414710089143927 0.05916567693372044856 -1.4491614811346862357 2.2888737277898814071 2.9159960958054154112;-0.70113828502200725712 1.534021565965778322 -1.8651068683120974878 -3.94490437584190623 -0.37447355868233589415 1.4343996099279434642;0.0066155103663249753554 -0.84162795614588570281 1.8252993654522471356 -0.44336172483514130205 -3.3941082720983613008 1.584570957294651361;-0.23938853334374177173 0.24388938245804209215 0.52220600762938207406 0.53985355419376246378 1.0675928689218152634 1.5229537614652106647;-1.3611982379260634257 -1.0155702826311379106 0.5701368700067173112 -0.96929172576685929119 1.0217052248974551887 -0.32839649311872798343;0.12762308447727324645 1.8197447921711633612 2.0091962774284239934 0.27063602252399354686 -2.2823068889418287597 -0.17669315988633318981;2.3054026480727856097 -0.31921817624117415635 -1.9178235698796595177 -0.48144497051900098095 1.4593455883369439441 1.367230406281441768;0.8501550676906466375 1.2841031774875806271 0.6957835013726660911 0.86131083057735435826 -0.8450118195429836554 -0.10904996329211655293;2.4439355335233448052 -0.25597026728652338967 0.78112421257530673113 0.17337122033554966394 3.0830041167409172331 -0.79626559395778551131;-0.6553102047990559953 -0.65293724770687422421 -0.8867630825345612644 -2.8319138161295906997 3.1813079501414338601 -0.57007960515665379031;-2.0009608129487039818 1.753950502592816596 7.9808131741856973562 -0.73979568811266438466 2.7422099445917567095 -1.8257490688767288312;2.004640684801773709 3.000525364242245363 -0.01632712534164414836 0.47772262420354549839 2.3191330605495203976 0.68932578452097093002;0.58055784136054222611 -0.3162414856160502552 -0.76521734439385835636 2.5343194988107264898 2.4466495927000910804 1.5446492685630890396;0.26921015418306004641 -0.25594908996435861148 -1.9351529986826601082 -0.25432618316633931466 -0.16408872302886590155 -2.5756674913515866798];

% Layer 2
b2 = [-2.2704445086658333608;-1.4137163741748135504;1.1468154228290812213;-1.6795650101310830582;-1.0831464130410513036;1.3416604376667540244;-1.931178628325957547;-0.028457210036980526424;-0.99167773475254661353;0.69797447713320881491;0.33621441198075685541;0.25327483994222177444;0.27120929237946184154;-1.6966039105163905898;-1.2696255182573290554];
LW2_1 = [-0.28967697848910850533 1.1413905317123576033 -0.22942457894968137921 0.72074952204783693244 -0.29115986442844116189 -0.8116184622753642719 1.4949771929423392169 -2.2912345410053718275 0.17519830936551958334 0.18458196483525274312 0.058602021082170385746 0.66951261901050318492 -0.56241544295733836289 0.76812363364772118235 -0.1255766308378137297 -0.21027406840481493999 1.5188687492921222333 -1.3505699700117010931 0.13400208293766935341 0.5990954519074266349 0.040410424668487848754 -0.34844828311326936365 0.50930008136099558236 0.41249706444506534231 -1.8003267139834242538;-1.3459442341419805 0.53600056848690058597 -0.95341291605456002234 -1.9344806620464143343 -0.046785738477667045132 0.064541018012620937627 0.27857178187806369563 2.3916381977988345753 -0.021040170331404310644 0.24584502963461044023 -0.70473217917314923131 -0.26829769170245620913 -0.75725867943389080228 -0.97698171755229501478 1.447210891262291188 1.4340075537224146185 -0.13200701989439744821 -1.3411714772215646008 -0.15429570678503634618 -1.1952742197836814242 -0.35825080125373742757 -0.0027500360382281194283 -0.082610261584048105821 2.9570093080321289136 1.8856736445182056272;-0.99602452516435546759 1.2414195908120699841 0.55011663106735364526 -0.40475199742547879334 -1.5314533633796518775 -0.8103803255879556966 0.096245267726094263505 1.4772170289562196466 0.85033797421874646183 -0.59143093678388758416 0.58672692902919398872 0.29627377882163269396 1.9914160256427901885 0.61920545025807738337 -0.88415741216463072938 0.80950111720098394397 -1.7810023670694765663 -1.0027758284492587215 0.75278894133792850774 -0.97934782481099535989 -0.24333128146854629548 0.40981503359530629949 0.75877597838398691543 1.1136684535666179219 1.6818167580639196146;0.43930557041814266572 -0.82173531886492545695 -0.56836865323139729167 1.0426397430821781054 -0.75552676064803769851 1.4471816744663945631 3.3497583461570008545 0.38266716505592296427 -0.27946184962899522919 -0.91813595835301331505 -1.9984821441985660684 0.54625050522348872484 0.3130105416610882707 2.2643862090835447098 -0.71313968750357104032 0.17349391518265921963 0.21419856466293413222 -1.7634258656330501491 -0.28571224925508670323 -0.066210176255263444856 -0.65999595646642583713 2.5137098797715298204 -0.29780760047942800295 -0.7048383308595637109 0.55859680730174821051;0.22917991746938273789 -0.43726336533446025223 -0.94994294401485068757 0.0074936137520373730103 0.65117752525443628464 -0.42426371689810221666 -0.96374293063493188249 -0.097540321274695973575 1.9978064099553269894 -0.11532419898342845255 -0.50491583598016842593 0.38601894720945734152 0.22323170308383114002 -0.58124957895780726691 0.016734926090081463784 -0.039343371139674468417 0.51471677834142115504 -0.8373669146474448377 -0.099136415727490087568 -0.15271307228383354526 -0.18136004637903077596 -0.59384885618024374487 -0.95940182192408118844 -0.18188974346135139415 0.56894530549764643634;0.87412080324607133175 0.76226378945230388595 0.26905403777576814006 1.0175215961276753429 0.72629858462880758641 1.0740616697144906855 -0.026159503389724017564 -0.84730741842708978684 0.28705411673471648015 0.028370724685608948029 -0.16150553319487589987 -0.36864799349707810805 0.13405234756627273929 -0.20887385996853707892 -0.57151503626662814028 -0.022861066113008313844 1.6706144471310011568 0.14834937598097427958 -0.2079440169415240347 0.068496243075438542625 0.1335151080612052843 -0.58103210698556329028 -0.18099673498556873019 0.71737293690818937364 -1.3192806811442112647;0.77287404191920183738 -0.016156157731511973374 0.21233158522417719394 -0.62690510827139911409 -0.43325394853870063949 0.39358338749410953783 0.35391272937822160216 -0.84117534058634002569 0.39188999431588295019 -0.66948419015125493203 0.70446797437185071367 -0.11665837920322928711 -0.51460833652826742934 0.97997779289030095828 -0.57782924757051423725 0.037224184889196251791 0.33985155429491376022 -0.97450289381889754203 -1.6087776643203393068 -0.96930057199704577897 -0.69462315725493184448 1.1977614826615106125 0.26014265826628679701 3.0599305142632235999 0.077385862062582119747;0.75459542958386371936 -1.1153080251097045039 -0.076119071566270929408 -0.68156702425284287905 -0.19331613366905184281 0.31300737640893966374 -0.16855692182301335036 -0.20176441698095695654 -1.5717449517781783008 -0.045009949210825316024 -0.50006584359205841217 -0.12877861506635787658 0.12434741860025008697 -0.26077158397079452934 0.21956220151226135684 0.14198049283564878609 -0.17208164750232424201 0.15010193671047181163 1.1250195799195217283 0.56811754469027198056 0.60543198530711461736 -0.54148248854044322975 0.12059831358435357807 0.80567469674593183981 0.30234333152645515019;-1.3558696275616024529 -1.3158956129207752817 1.2681181732417854402 0.30763615319242099133 0.51441740425579440821 -0.46213209449110737026 1.0430788480410635444 -1.0152795707547628279 -2.0223294907732558556 -0.32171684783709075806 -0.29152035655799707348 0.19551471975181078378 0.090936939442446657056 0.24325587933920639339 0.41353097103969527204 -0.40528366245133240486 0.2393928361489282286 0.53250868619389424286 0.51813512366439118395 0.69050634129685928286 -0.29025858351456507167 -0.44226442024254092322 0.30164377776609319071 -0.043888787031703846431 -1.6473544253111391811;-0.014377317280141695133 0.23040791287521433794 -0.014248624540165432881 -1.2058839922507411657 0.58696184764482417506 -1.2523487564102162573 -0.29398628012053751313 -2.0752538359543923896 -0.27740576629593777236 0.21733482929943673256 -0.21962000489775587719 0.2086140041874042228 0.23971715333882054333 -0.14726705986771115864 0.19408091216697073711 0.51345076216131368962 -1.6220555399527025742 -0.72443335119704144187 -0.4430869343400926641 -0.40645528176010936594 -0.59540281133952432935 -0.24749400678601296555 0.20238831379366165053 -1.0970332500697894673 -1.9714037104692763158;-0.07338758390782663954 1.1261149389508937624 0.031851226559122376714 -0.3636907365170023998 0.23751286094491477763 -0.57102585253783244568 -0.24867522315834103552 0.45540424871428170084 1.1598922207996889 -0.029408972471108893454 0.65220896228368374636 0.14482444064913913007 0.34018634449858237145 0.075964067070967755679 0.0011103110201297426013 0.23597897476588561294 -0.76686625215247616882 0.22992160150003707053 -0.23654789640532528083 -0.15150174268443347692 -0.24165794953579500248 -0.4788827640638232408 -0.088728691216162489108 0.33814701650390494025 -0.057653527810442778412;0.023217338204172176253 -0.20575830589391097547 0.066926159294627779461 1.2407705501860841757 -0.53752753033039235575 1.2976712428843724112 0.36057630269756585362 2.3865620278110659669 0.66666557472619847324 -0.31867516430224246404 0.4434455346718055857 -0.12789195161226146746 -0.40384796592336402732 0.11269287275845592255 -0.23680346453571324283 -0.29092902760175276544 1.6510026473986796347 1.0631334505456739858 0.57415186715027544118 1.3213765068706346817 0.61960074771958495443 -0.46732390275781932054 -0.20943831319436789773 -0.95385295795148272724 2.0489157535365203344;-0.009198357070891826151 -0.17163269239406117594 -0.41777224113534133787 -0.82400916732808826559 0.87687035399179291684 -0.80481564288078144553 -0.36511473126394211608 -0.52658639997098610763 0.35101584402850488642 -0.12044135032018098153 0.42696191467140104381 0.30589321365439542388 0.27429810410960397959 0.069234540164013064212 0.79541640596044482781 0.34010257827991280388 -0.38712206028359352761 -0.19803315768872978286 -0.017425289177955306796 -0.57015402853284646856 0.28319752529299935251 -0.63985844419337667421 0.14390697939199650901 1.151439384209384853 -0.35328400781498631167;-0.49210469369647397153 -0.23665287456492789531 0.39532374094523786701 -0.50941301233340663401 0.068363191180273771841 -0.68801809518573986413 0.89900040832680983005 -0.23915520861762992744 -0.094760931147396157415 -0.26094458801214281962 0.35845307554813915507 0.45047895585985497924 0.19155651824384731241 0.51602575323795529805 0.25886566664431270857 -0.22008281241945212847 -1.5752684546652966358 0.11899076188826999967 0.64828271978293439126 0.17745866118109424048 0.14867435226098252299 0.10264586391356800288 -0.071717581159557106107 -0.258218447397251194 0.14687441593559433239;-1.1284532679631826824 0.042983035349594626851 0.75744295023826890834 -0.34732310500877550119 0.859998206248093644 -0.65692656228808887775 0.64200837062667526212 0.072691923952708376033 0.48682699136588186706 -0.55423482313381866593 0.6103976847087093649 0.3938633048233791123 0.2645251610651029317 0.40235885983452607251 0.66500935517380865836 0.055027374805282212866 -0.39295143056801762338 0.54613001445095099573 1.3431622041065887085 0.10344555434769245328 1.1342915193352982595 -0.5053873582331507297 -0.13294482887084174694 -0.38352070675344185346 0.21424041228997439679];

% Layer 3
b3 = -0.4335206530856860474;
LW3_2 = [-1.7081408188013318394 1.354279763325469732 0.56545150054938408957 -0.53679464117634601017 -1.1909842985253602521 2.4949189877023525419 -1.6919318391417357272 -2.0002725158803378314 -1.6599995726708158816 3.956376452591653603 -4.322802592432447355 2.771799420959152549 1.9534813809308970711 2.9487325582200614171 -1.3046677939002284674];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
