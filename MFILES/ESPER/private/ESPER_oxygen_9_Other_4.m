function [Y,Xf,Af] = ESPER_oxygen_9_Other_4(X,~,~)
%ESPER_OXYGEN_9_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:47.
% 
% [Y] = ESPER_oxygen_9_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-0.9;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0415843642790311;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.64877021351187114107;1.9181172839202540459;2.0414847685258146193;0.19757301842525754054;0.99940831995399614929;-1.4781455777612564351;-1.1436395994911621177;2.7566222624599219237;-8.3608599482115533164;-1.5246266546257076779;1.1283675192589073255;0.26597954188213551729;1.6818658035258435834;1.2129173754518070005;2.544541936287664452;0.027751128030025641602;-0.73989405911628203238;1.3045932125550949721;0.28756572738183844296;-1.5185357317572782954;2.0623286438256429598;1.1497653946925519008;-0.17153183541623179265;0.70996290859567245946;2.4350505830224475901;-0.75343784091590226826;1.8017808355406985665;1.3491430973041782515;1.23031691763588924;4.8531134712745656046];
IW1_1 = [0.80463547859846096255 0.86903974645467652049 1.6822572939087383492 1.0102296478631556109 -9.2865325117083088458 0.64740962506961130529 0.92168488152998873097 -1.8729655593257696911;-0.33139957774103750987 -0.78019090580717553873 -0.54373506880586153223 -0.44828638729718012224 -0.0080127154919467993843 -0.40437285764424918399 0.73302499254979258669 0.14144868647642616644;-0.3008741458183991635 -0.27666880675659039079 -1.0806125792986109868 -0.15332351343173250546 0.3721847103757810471 1.1846114852876161727 0.76103119971831612034 0.78633125525074210049;0.13684240201609176868 -0.042430438451210972239 0.88990095165757643336 0.90879362466974888957 -3.8860284099296853455 0.047115264428854303214 1.4052351148236419398 1.3555730373483028117;-0.41635370582030784004 0.51336479273211321761 0.95449282790875467075 -0.26029084396119400724 -1.7115795971404326181 -0.1855226015547415952 -0.17755707291252520452 0.3170060562649001934;0.14102460757065041208 0.44518385282982841922 1.0472944918621558408 -0.42554902330784766251 3.6659725529926356913 1.1924620648887902519 -1.7087291589526591995 -2.0914998838487259825;0.52301860231409047497 -0.62152080222180616786 -1.4857487906880491035 0.67073565905658905084 1.6239447058715050787 0.1916478247431263604 0.12686989718588040366 -0.83964672043013843794;-0.35902193329030762659 -0.35146699372269019079 -0.033188910920366958279 1.2061098639466398819 -0.44825791330766062703 -0.24572236087762586165 -0.062350035143364533619 0.35760290461359206526;2.1692278109925444696 3.2241766150299406846 6.7294828156065804592 1.3962634761776655523 -1.3331611483080192393 3.9869295720002151384 -1.5275531627393601486 -5.2300133107169761715;0.45773687301399207383 0.027644599976254412982 -1.4680303090214701367 -0.48463693119791556585 2.3468400276601415477 0.051067859766157491785 -0.67395311229163534783 -0.69496091137278925842;-0.0020365418842962865892 0.016794208863068406379 1.3208535273469397264 -0.25188780029248802883 3.755752075625476305 -0.00012369638795471128712 -0.46392793884384986303 -0.30037264788598327936;-0.20455788073485522971 0.077861965458758453096 -0.1210167498339412423 0.048554134205000827607 5.2253736469945577525 0.20199438426876500929 -0.23067841902002286791 -1.5991218892495429049;-0.32423699446284454107 0.015141315728568891658 1.8649863147098812988 0.50327287945610332809 -0.90124161163829075161 -0.85557011253194470424 1.4673442192309440468 0.96628188888540267332;-0.83765531604402865273 -0.21198112669116281337 1.4114829710874547963 -0.26925604121875507113 1.9181177451917406085 -0.23760604846230634624 0.54684238640752769189 0.40071981318035371222;0.090134842143942170423 0.57137108193880314921 -6.26659081048702582 7.2078757911351836185 4.8751172690850381741 3.4713952720888281434 0.94904543639679095346 -5.2873758865882027891;0.34223066009736291537 -0.29767530936072966741 -0.59164468338075015819 -0.3276243126304403952 -2.5601915054535808736 -0.1161869630894269978 0.28958433311207554262 -0.14294185740105327942;0.95451857592104971673 -0.242010095605559028 -0.05910168168758282714 -0.03669847024991834683 -4.5720188990177570432 0.718033914754157232 -0.277878006950040779 -0.3691412727830092888;0.32339807726955366318 -0.11202361896569347499 0.84703492139265712524 0.85740231982824088863 0.28016776296533985047 2.0356389387995057483 -0.10113379146251005869 -0.2465657613260048564;0.99751360193494675865 -0.32227493851215127663 2.000711783918392328 -1.3734829377726851529 7.4144305504518861483 1.6611838098986417833 -0.38097839496435631501 -1.0415736393665970816;-0.032530610150609567954 0.081399720700898056669 -1.9773817135613933615 0.27717861149717665237 -4.8669661717153456237 -0.20774193523953038421 1.2090301178630513679 1.3801307338442139194;13.516152325596522132 3.2171493372272821354 2.6188587675881835892 1.3045712753396472294 0.088015909287498195201 -0.06554698441490811045 4.9639017061251005103 -1.9654935515068008289;-0.87279375246228263485 -0.43620370057027424426 -0.43181642989098584229 -0.21552979608712813375 -3.0229447916607536939 -1.0860019084333603079 -0.49404160687099341054 2.2237798437416604891;0.08242728287660278097 -0.017374789687801085042 -0.16720503952322110508 0.042964052458340687424 -4.392136237931834053 -0.24881787983827655109 0.32935118860269307905 1.4716245938744045851;0.41361610815161925503 -0.26143604031540129684 1.3723254472387313996 0.25128170059662691127 1.0085188237206430539 1.7433436849746801744 -0.65377617830291090417 -1.0203436804811005789;-0.75041899413182988621 0.072356364017488836171 -0.82838649239035222482 -1.7259794206644432091 3.9973638243876696841 0.028204029329304186602 1.0239720983905311602 3.3250884385709364999;-0.17371579902296960252 -0.10563904371101515145 -2.3559461753830541753 0.40534561227794324578 4.8324860505276419076 -1.6033109150020481426 -0.64070653256650100804 2.6258358565640165239;0.14912411075588569154 -0.2494649488745895316 1.8575049637250711232 -0.80708616091652440883 -8.0456115415785536271 -0.99764939865162038934 -1.8587303729807269637 1.7479124190355870283;0.34693577557222404772 0.22739757534895571611 -0.21897508078000041398 0.22119572374783016966 1.7415702029684640983 -0.47431516158130615501 0.015252571815300793381 0.43374524998175917334;0.82778748393730194888 -0.20617043149963229509 -0.80942067188041200154 0.65846497947896664993 2.3083337669043322293 0.02951200940856466351 1.114258791605725385 -1.2989439764091554874;1.5535492146155525095 -0.87553820662313430745 -0.39133201726506489093 0.63373578469757263498 6.5790700414528142659 -0.60274579905415825998 -0.060242507691335857312 0.23804326446409199147];

% Layer 2
b2 = [-13.085661926481970241;-14.136401523999085228;4.536738088961804749;3.0630082830725129384;3.1232228853132473212;0.57593979245662307864;7.0267619850790588032;-3.8354433659813551571;-21.110159292205210591;8.1112477220380423404];
LW2_1 = [1.7562445072772858712 -8.1112143093408128891 -3.2565567234937993213 1.3705942727783992918 0.20097402891639679079 1.8850332658098127858 -0.72181212334922406626 14.700233964398314868 -2.1674412413433721269 -2.695705318086483615 0.73954028805577143313 5.966658034903732144 -4.9293065712312778004 3.680665540927489765 0.45294760740515316311 5.612496428116967806 1.0583616607266053133 -1.0485959251217320531 -0.2481984404268582356 2.0433381081363917176 -0.080695747524456976074 1.2209514681106992118 3.7401788449135393577 1.6069339512992377728 4.3687471671200333034 0.12824069537893076354 -0.010009934448710587629 3.6781259719835897037 1.0840915542827866958 -3.6973992707217924192;0.4286809095138048864 3.3882193424304221097 -2.8446904261949561565 -3.9711982029146941642 16.168058265423059794 -2.3356028245013518152 8.4348994482086645519 3.4352075782641309232 1.8067459771697398363 5.4379855394876068786 -1.8812595782125507426 -2.0901531772927799402 -0.48049397618680211863 2.9532160622919247928 0.87405461842588216825 3.4279524004968049411 -2.2937977691019337811 2.9853131392255471965 1.2364660187023259752 -1.1613816904182672207 1.1324667157092296321 0.50685717388703943609 -2.1270893864522335548 2.4286929971016824048 1.0006776213813408649 2.716879578184046018 2.5160037462334154945 -0.13626253439086025154 -3.8513062074637240961 -1.2811911135266516037;-0.047764041357321998515 1.9189909418218888959 0.40487448847842960609 -0.15613536333614211338 -3.5994610618068980656 -0.69832868853312868307 -1.8755454365061170474 -6.2828266392489533487 0.43745196393099128329 -2.7986336291198585791 4.5171344756155873412 3.5304064445439151676 -2.4212161674859689064 -0.15158026383191020026 -0.34067884335973708243 -1.5327012277163027942 0.12020703427491857829 -1.4915636576184607698 0.37886488250557537327 2.5485943892111584397 -0.015219234129881535969 -0.26266607108555489747 4.4363572959393398065 1.0467273980827818125 0.57467573442020913888 0.83064768811405798044 -0.1659182907842615684 -1.3739819914223938557 0.95911387322079788564 0.070273425352353591222;2.1077463476513100815 2.2228750913024204472 0.015841535867611486466 -3.843199467681159831 12.498913430947458991 -1.7111886231800068625 11.237279267559170393 -11.857461798606118819 -0.52033390047985261795 -1.665073605816888902 8.5351310319139610527 6.0098321546222157608 -2.9812807965357470685 2.0193325932640813214 -0.56471681018398645069 -2.1365080166522671945 0.42640274089255908452 0.32619414186193163019 0.53005308462976863382 1.2997618228793108575 0.30707317418763113714 1.6986087397705864621 8.6200664426588264888 -3.2670874180429718692 0.28434420828457346309 0.31395057125763775607 -1.0396421339007035911 -1.6515930517733761196 0.92421318458291856768 -1.6006866146283718066;-1.0577485624443614398 2.2411022645137221865 2.2610149897904050498 -0.19658585287707910916 0.43628562525405584216 0.11272139978381459646 -0.35994995095585824441 -1.0861972308774678897 1.5991302600473975559 -3.4071924754080407105 -6.1259224211306460006 -9.1321684575534831652 -1.6111820666225049603 -1.3457318407935492388 -0.42078804326790980594 -1.8133644086469495882 -0.75126800557833894878 -2.9873563353617282878 0.28750166983296210343 -0.18636241500665662318 0.21497127649420119666 -0.48656536741283284986 -9.8006107871066827641 2.260264646717317305 -2.1752257645632355754 -0.87119008906257100477 0.58445953793874705351 3.3571772776973265451 0.35451139503323181312 -2.1585946028279612285;-0.60897586791242974691 -1.4785271561109580851 -0.41419187450784383797 0.24514069130725976708 -5.5003166142570023567 2.7274298122589364368 0.36995183269206177723 16.531131252370677487 3.0127286940049691211 -9.584992555172423323 -1.3190920792986382537 -7.3338305785505548684 -3.0553868774753443205 -6.5659396525371311881 -0.60950351396109192503 -4.1128407914930624756 -1.5018644284776729858 -0.16894980162226563847 1.5962655456241925389 -2.307879024037255089 0.1615958184120850627 -2.1459687561168525605 -3.8311346287884160411 -6.7988224820910421187 -1.5650883329451976689 -2.0349772733468602937 -1.6101528009295618116 -6.1706518346984084999 2.8097525414815649469 2.1195985473416119049;-0.25037367854112752008 -12.46730743946551101 -2.3789683909836170095 -0.74083758603616145511 10.109971040668003894 1.5020791624568334832 6.4806462204988308784 6.2440967485895715328 -0.69080723106086361351 3.5801141263287887817 1.7574955999959929187 -5.3533403986603138591 3.6499698764018093655 0.88180158961772436843 0.45140393329513833764 4.1805929124168939026 1.8870515231019604485 2.9745459709420591921 -0.62443101085433805331 -1.9093301779028433174 -0.017685488471025273549 1.4272560548127901647 -4.4736396400564979459 -1.3923693422067233705 2.1939053687652778635 -0.57333112511591100002 -2.3203112701844164079 0.90235381301684625122 -0.88477668834310263524 -5.4574513250382015173;-0.32360773302686879349 -11.288162049690832589 0.7893736890914822002 0.29792386351035199388 9.9435990115053645155 -2.7958059462635449499 0.11153390793480055798 4.6485015809447229884 2.066128708943406167 14.264019798256441618 -7.0101081073977979941 -6.7023605265612467008 7.9733516655633058789 0.87171026086592429127 -0.15428235541098336836 4.1102204585613106858 1.9370805407600595327 1.211506695746794815 -1.5649806537823767183 3.7951366675238178416 0.076266698661901999312 6.3022235841979670212 -18.09420536015571912 7.7035410685517851093 3.485863276977587244 3.944871431572277487 2.1512945237885499061 8.9207632856016711997 -4.691268328836781798 -0.44208029476597465734;1.0169569074751454441 3.8172664951000756517 0.16775192984696205012 -5.2109690776249735222 5.3133272541537328593 -4.596788975455699422 3.5718718345924429514 14.861345850469621865 0.61348779444424694773 -2.6239638114735757135 0.014512105176295033229 -4.9059964163375839874 -0.5076800375687366973 1.8467724960931160005 -0.42964294012684028923 -0.87922518708733155002 -0.92738974650360495033 -2.5483922224566635251 0.20933480237912674427 4.3754689577151344437 0.14885446650256328738 -2.30072401458859499 -6.5922350356889163336 4.0708559716854697541 0.75303719508364674873 1.4535969572634259706 3.4369556487190813243 4.3472789760190337915 0.27026935186596201532 -6.6245059022633334678;0.61427127617508703317 7.9688037166736256367 -2.4950404645733206266 -0.26931990416027362656 5.2535527366771352931 1.5242566154393928368 2.3841161697756687587 7.6279265243109195538 8.8644341017456813603 4.4843565980623676381 -4.3221248165161680888 0.69346775937160243242 1.7514646615844922106 4.6587555139397522908 0.44907198558833993918 2.5997515580341561403 0.5061032112825739615 1.2571020460700772503 -0.88387693000252554043 0.24955489519179879787 0.056916109161891451085 -1.4458774514306917958 0.18787800373942864507 1.9039212847636965975 0.96189948578938799795 -1.3502262580986190699 1.3140620960461659728 0.13258243139286834955 -2.5101502260383368181 -13.712424406230695695];

% Layer 3
b3 = 0.055633626251163789678;
LW3_2 = [0.097627757306820092675 0.15407714954146653485 -0.46928773857779459977 -0.095258349669618491706 0.126940919187420731 -0.067561186608900675177 -0.20689290812688337917 0.0706293056409237896 0.095856332867737273351 -0.15689742233172440655];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
