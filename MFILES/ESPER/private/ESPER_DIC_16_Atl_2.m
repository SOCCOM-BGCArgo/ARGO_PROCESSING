function [Y,Xf,Af] = ESPER_DIC_16_Atl_2(X,~,~)
%ESPER_DIC_16_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_16_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.3644739260566307593;-3.647079722755937059;-2.1082725308460066316;1.5715411646980101956;-3.4982797077278671161;-2.180007629569365335;6.1133770455378559916;6.1450704183658340085;0.57428086120469545861;2.8400568577677995918;1.3222836190016953317;-1.8392901585482688276;2.8543870063145684313;0.069746920199123180195;-0.33877568927547252464;-0.18023143231132884856;-3.4888968657134928897;-6.094069361788114314;7.5290661979505530965;-21.881970782838152445];
IW1_1 = [4.299792970828486105 -0.96798900538514220937 2.5980122364962228154 0.63000348402149286553 -1.1181256428099408673;3.2004175635996716665 -2.6300910077330823533 -1.5149467925931623391 1.6470123763487791724 -1.9942353877736445078;1.166810897762873056 -2.045664428119653433 0.96269448249201072798 0.89503837152287357704 1.150167811059734424;-0.25390389983474903612 0.050856916050972693355 5.148440798685106401 -0.024508175191424265427 -0.28024443016549466234;1.9462550285792392657 1.5639125202165373718 -0.63699390764693297751 0.043169301299671038186 2.8195766556459522789;3.247139606528665734 -2.4782864545474727613 -2.1248976860815576018 -0.68328597668708479507 1.2250720376934014499;-1.1222634969267666349 2.4433992609726846723 5.2778555565785634229 -0.46151292097464552411 -2.6651306933817582312;-1.9504843990302338508 2.7709323786167394665 1.217785951729681404 0.8354674486782115439 -4.0407831268096785493;0.87795625153684864195 0.73261474803415294055 1.8653262554719756139 -0.43988305087184326192 0.75261755000836716434;6.0236246153119301638 -1.7197610075307074862 5.2434674437634036792 -0.22449342484905163153 -0.52793137889108765481;0.81505924452630984511 0.55116686684386773099 1.1997444452759955524 -0.61395753859990753742 -1.2203288628573696339;2.7116344593615377967 -0.76812426547852752368 -0.46346661399182892405 0.67890160925863973773 -1.1911947450739852616;2.9670194480866709519 1.2661743029476693057 2.8037811031452202215 -2.6373809890318216098 5.2191317506556762496;-1.2744138703328113937 -2.7639616829016673272 -2.5744736619483217233 0.15910540802173042674 1.9085614095206382412;2.5299340664948246626 -0.78545780249253505101 -1.9653181843357456771 0.63589542234127571785 -5.9175862679408810507;1.2906521087889011312 -1.3555446220229177001 1.5483788890277083716 0.092405497652099252703 2.3068235419009734954;-0.17914295393824439251 1.3055534705174762777 -0.18218917713685145454 -0.14316019402225896306 7.041042883481445358;1.1184034280364558711 4.9643230387612398147 -1.3307485383927044609 -1.3398198970386290263 1.9052362149192696439;6.9212633482898588966 2.4484150207284467449 0.090599850009988852628 0.19401237617414446301 0.3152562782470013647;-0.11076505014070292532 -0.65982943457678633337 -0.00032088474278247746535 -22.805586200370171923 -1.8033101414092280734];

% Layer 2
b2 = [-1.9855196320448882386;-3.384982497876366736;1.1405169605201983529;4.0965104351651024928;0.39991817507272836574;2.0544001808875580473;3.045629982039513628;-1.5151457399582672902;0.69953098755910725348;2.0336357580209614149;-1.2983584634662637125;1.6925872849119427688;-0.23654948648704030023;-1.4526028419070331488;-0.2485454274785563189;1.5938877057087739164;2.6965876070056111757;0.63430980587176233332;0.61565427805889971768;2.8040327695961178023];
LW2_1 = [2.9032425852221543927 1.2910344547470722354 -1.6960166542893617692 1.1296699227646751496 1.6541836827632943052 1.3498480018904939204 -1.6092971645716236395 -0.94949525601620787807 3.1543533217191033202 -1.0554453579389546647 -0.56789685585967841774 -2.9374231657148053287 -0.6994350994938072219 0.77012896713978906682 -2.2364146161745912522 0.32979479727850269377 -0.62657564806197418861 0.23568952482567226414 -3.2989230596738710055 0.602300575616834033;-0.48268983857767133738 1.276655462079366643 1.2276500098065281641 -3.418700872868336571 -2.8364892711112235091 -2.3994040812875869761 3.5742598443924467055 0.9338669890226296566 -2.6594513329734721374 0.78298686387574145673 2.6249470611900376227 -1.3420954570286960372 -1.7975293735968815856 2.8773581143145596783 2.2900444773767612006 2.7359570092984992762 -0.69700936454787776331 3.8446591440509139126 1.6737678130735389459 -1.232416828165070033;0.51481077558903942659 1.1459143177982007433 -2.8333213315969665302 0.087255857747651904832 -1.599479187020750981 -1.0095717125833596484 0.49524144029467548345 0.37640908174075088377 5.3761224421416411445 -0.57526953555368731674 -5.3606331304302559104 -1.4700774032075192288 -1.7524723462328533063 1.5289456072544818088 0.053330471564402022466 0.14460560313398063137 0.54441802649340487186 -0.68945380569721281816 0.35465957039920709137 0.046875532090420904408;-4.6363486972570004951 -2.8479970913311074554 1.8515395301174331077 -4.1293812443595294681 4.9671682729175090643 2.0232427403554931189 1.4547715413442061649 1.4912964458703621418 -2.1274091645789376948 -0.18050021592077286625 -2.2229110284565791744 6.5048760784635719645 3.9848437611913452017 -1.8550428887189085447 -0.82890645202810708803 9.2825846464827321824 4.4376445135124953367 5.7051193794732659725 -0.76629596540121325265 0.31461123229819970559;-1.1112126174372118914 1.7992983065144945165 3.4682711811758553111 0.47036685446818438106 1.8383211274769706289 7.5214476718843013003 -0.31977884463100014756 3.0535215087182123739 -0.042417233211023488981 -3.6050171144631311115 -1.3986048068373686526 1.0785660779981107726 0.85528329097904143286 -6.2525775520024131637 -3.1776347012920376223 2.6316311876536437886 0.83068383423892788731 -0.61668142663352021327 0.61041398386454348568 0.38785834799674312467;-3.6754879872181978051 -2.1239187976878692865 2.255087751992578049 0.23854557993315389508 0.46137689428764833144 -2.8448738540572771072 1.1772184047692022535 0.75867969586942241023 -4.9124986266990315897 1.7451967289975642839 3.9635454319906955334 1.8197775977981678341 1.2238298142197892027 -1.8722334494864820709 -0.33142840093260084178 -1.9659058418850197114 0.58135826439583537795 3.1150763983781457611 2.2398647376109712681 -0.69370757774168545495;-2.5754754206301373465 3.7622414996177622193 3.0786338358823770456 -0.35266636378185450829 1.6303265642706592509 0.36293042103733202941 -0.64735025398697065846 1.3475919298165821569 0.43725251544849641494 -0.83918052733463621706 -2.2095297936112454629 3.1650303156450747544 3.8925754002034196333 -2.0289895849673755812 -5.5281636918633738631 -5.2364690732865657452 -2.3651254451709413651 -5.3584182841483833926 -3.3885711129085125393 -0.35328932707476096153;-0.05414707489352209302 -0.76423760952272556946 -1.0159288213626409547 -0.63634847639926894747 -0.89353358849286346199 1.5028059341542814309 0.82645629176590074128 1.2181326714216746954 -2.4921117001244410538 0.79346317877411476349 3.5209544352297714731 -1.1543245433583368964 -0.81528432522333338373 -0.24418707652998664082 1.9037525149765124333 3.8824565334474918643 -1.4673227930583077061 0.43640759944413487492 -4.116184320679378672 -3.9028095726991951508;0.850956215620718881 -1.9930955978383995131 2.8751699553009695265 -4.9799076184310466786 0.20968917648487161998 -0.94349576598773166047 2.8421461157534393394 0.23232254450478523333 -2.3931986348977041246 3.8521100602697906368 -6.9435003427489965233 -6.7136487134860498571 -0.45732850550520692812 1.601668390228467187 -2.362447827130468081 0.91373774211070801776 -0.2330190071802954177 1.302178843099815353 2.176357039534922766 -0.49739366846636368091;1.1889178703383544988 1.5044866248251764773 -0.46925595868646519104 0.29384615178563927573 0.11924792949886210691 0.77867058049571957756 0.050105117357160063041 -0.33648284567814484847 0.88815674212328010739 -1.3029204981320441359 -0.076607903268885751968 -1.3756153820198235849 1.7348624363096800671 1.1254841902115624297 -0.42251361878283311135 -1.9943337321510634652 0.20242741018746165937 1.8060594649832850678 -0.86599837034346727194 0.31458717525639434687;-3.6705177570997262748 2.4524912759336068291 -0.1181813391091555282 1.0542626063010147597 -3.9021918383908560379 0.87183632272997357848 -0.53021987016199423337 -2.3439991909180175611 -0.065340847251803710338 -2.0088350776473071768 5.6664116371487365242 -0.24867877780351885231 -1.8435238581075177322 2.8941224025542560128 3.6861006360959853723 -5.5835740078417428478 -4.8227532565408264276 0.065869471751451580399 3.9651304912026303917 -6.0607595213901737097;-1.2635284047554498077 -3.2845929718064947878 2.544176478513483719 0.5765548983998788346 0.16729110677839309496 -1.3199002956449212842 -0.73559844679091646036 1.2342727958697734536 -2.0863761138839471698 1.452886405550580351 0.41242558492140951598 2.7761439341678846304 0.59030081257454003474 0.0069879755074076840143 -0.11671932799967861538 -0.29291250358396464515 0.57338199640196441109 -1.7050126910030494187 -3.602978506937446479 -0.90660937673023045402;-2.0267501682148036934 -2.2173390118609246358 0.92649177886320310815 -1.376760555915522044 -0.19593056861052288165 -1.2255946945165634432 1.7472461335285029982 0.679427147805332865 -1.4959540486240561208 2.3495496580715085067 0.15872570120718682007 2.2355365062215186711 1.7169593586569271704 -1.3800181155786022114 0.15820258367548642453 -1.7579514533366258355 -0.8998617365140400004 0.89355942720226988474 0.43909913732422151122 -0.30104339088306469874;0.41961206705577763776 1.2840534821803719634 0.43386668316540044632 0.82151529962830338594 1.0676126227686910664 -7.3200275062631030565 -2.5768928082990396611 0.71862288415755015691 4.5608249693179159223 -2.1989320655065287546 0.91334298345609699066 0.19541716462637009899 -1.3183298603799298299 4.3290904819961211203 1.489419908310865015 -4.7127910064605851304 0.50104833008253124582 0.72821687223150444179 -0.85249317868837448664 0.80722627926020384947;-1.0409345902088231739 3.7541909619997109182 0.91838206222242013688 -3.3924797967382867014 0.75880118487907177727 2.3003513416054985896 -0.32593332337640606999 -1.0581348201709119827 3.5451814925590756644 0.74023307056583953489 -1.6762146313082140203 -4.9285500137438642554 -1.7714057716911884022 -3.2548157210819761431 -0.098012632685908679386 3.1787868986056810883 1.5077433490312910358 1.0685413315096321529 -0.29181216433737433569 3.4179521599121525099;-1.1831716283786244404 -3.0422372796347034729 -0.22735961387138145517 -5.7535653120824576945 1.9696830681204977598 -1.4441947322725154912 4.9952424362995291318 -0.17765244064995866502 0.081088933749534075623 -3.0386232333450053922 -1.7624855378742647627 2.0259781951040753967 0.38004138798080361328 -1.2733542288201289416 -2.0143611331277315735 2.8064791438254412803 0.60973680257411821959 -0.2216007011806505056 -0.2676969613825747607 -0.91079078942666402696;0.38142955740035028311 -2.3368278844455576682 0.011443099539842542176 -1.8419966764912547585 0.043116988948188973707 -0.49742353207489803379 3.5862251677723833154 -0.59886952627539036254 -2.27802843951735845 1.8050651021517793993 -6.2371112164118702736 -0.79670847225214935783 3.7872439604466410223 -0.06019564677723462931 3.738904435542764304 0.67218930160670609109 -0.022130007463473513191 0.19499765440512201176 1.1083350749072875541 -0.36696393065892601859;-2.448914344010273858 2.5233303484075069179 1.9591509719401019041 -0.40194553375713693022 1.2510857719805612565 0.61486159529695705306 0.12622934592884843541 1.3386787233480341719 -2.1848869472022300897 -0.37241860646667346302 0.77836942899440408894 2.2865366994533062872 -1.5296682755857482494 -3.1072108287856576858 -4.5842324537436143217 1.8823048415368150987 0.29435640616329744601 -3.4750782781975679825 -1.5572409741699255736 0.25321467105053213631;-2.2819039502674169917 -1.7614821366836472816 -0.11917793715186984771 0.31130631987962770202 0.69692517711731283292 2.9678193903864169556 1.2559463620613346979 1.2194452889647218186 -1.679370799628273625 0.016561159272232089945 -1.5963314961360244304 4.1659507013911332152 0.58454446654518132931 -2.4298372705989077502 -1.292689469743551145 -1.5168895700607722965 -0.49524142325830394773 2.535793331912137738 -0.37509600271147641726 -1.792896139490058216;-0.43357180908405457131 -4.4323940332123274999 0.95430848226840081505 0.73323484292226071002 -2.7810652802679838302 0.93679530493392959567 7.8588831069669442542 -0.56580844929273133026 -6.9319242121290498559 -4.9058212403422212233 3.0827352910772218841 1.8386526420480566735 1.5063504479324831831 -2.2555518768757756298 -0.97635404032152184328 -0.11389194105243202748 2.1730651168418813057 2.8331194530271441856 -6.4658092977263201817 1.7634637134954702642];

% Layer 3
b3 = 1.5515544407156174334;
LW3_2 = [2.493681562867112067 0.07212850556707442462 -0.1177975285814185924 -0.064761457691780335844 -0.05082767774733896321 -0.37730190694651122296 -0.065909228120198032341 0.080412357361838479597 -0.33484707726107820758 1.3285278762246985895 -0.01817283854998068271 0.48571734631804275306 0.45255104947407343019 -0.24858106654820774639 0.034737381906392299225 0.12789764104273773637 2.4024959788240676239 0.13958786114049268057 0.035383513864975818519 -0.047885791963734082588];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
