function [Y,Xf,Af] = ESPER_pH_7_Atl_3(X,~,~)
%ESPER_PH_7_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.2171094421287396159;-2.1014687863568446424;2.3392794133695526959;-1.3360509538389018225;-1.4730942297959261911;-0.94704601377420205566;-0.47350531940454754221;1.3958615093395134732;-0.71800347910659212403;0.48779106024194163194;1.0283528283753620158;-0.45997563378280131863;0.047951731497273789029;-1.7112040121450191599;-0.7504762406971025035;-0.48632984889503744208;-0.69185361086833929711;-1.7508147721981690559;-1.116887736903328987;-0.87148023889774517414;1.5586195600523167215;2.0505387817300215758;-1.8664050080595953052;2.1697600782890291704;1.9153375378887287361];
IW1_1 = [0.29552868988339459078 0.98365837075131623557 0.58653387870598627796 0.20554572818293187497 -1.3532635327716440177 0.81555035252505614363 1.0182397019418070183;1.2268245374578146123 -1.7533552441679096656 -0.1606398770227070727 -1.2996240884396057513 0.19860288123314068232 0.032382889595465209898 0.55461546008774265104;-0.59099074446764676694 1.626289142594782966 -1.0462876663621152318 0.58833961152314206977 -1.257018444576191385 0.31171230702616375963 0.59744971769666121997;0.28184770805436321073 2.8213274920115796185 1.150988763585693242 0.17560521812179186174 0.62911858411832799476 -1.4477970111389879548 -0.40371801018649716708;0.75427902982364125606 -0.64766509853302711708 0.97553860962092731057 0.9300165870565589854 -0.27092763597233210371 0.2594973627457043408 -2.4829322449450819121;0.19458649544701051015 0.39376625660856573452 0.51276296804076493263 -0.065692064710627801061 -1.331494856395027071 1.3277658606036142341 -1.8996558919538997223;0.32693992535697385948 1.8086255343266783857 -1.0145271401357252028 -0.7418947998172898961 -0.88584532966756868166 0.21380604386569102005 -0.91100402619393217041;-0.26249065578348790284 0.11134600400606177451 0.61515052744730591705 0.88640823044946059905 0.26641567494929363491 0.75982545788757649419 1.2575294732073412085;0.0057547464441741981098 -0.11369846549449517947 0.97048113434314298154 0.66738216219279289376 0.39761474443611838359 1.0140464085287530516 -1.5681036073152079258;-0.88780326118474817143 0.036170083451169246502 0.076250195865292885733 -0.83211896440807431308 1.2456856471398063402 -1.3583657377702822444 0.20165360460032938361;-1.4162492454397939134 -0.37506573535120002472 -1.2846881848574172036 -1.5106167914192438761 -0.75442848371120319051 0.043715390930291260496 -0.69615883965829383762;0.71768341869225493745 0.84736743352862997636 -0.69484772312562270713 -1.1208798104738295631 -0.41894967702472246662 0.26945298110000964753 -0.49153416017704892882;1.1223068838956420379 0.30827505080868045084 -0.19129611539825489008 -0.18789617952535311862 -2.4274586699677591639 -0.75835785517579079595 -1.0617066983624661169;0.17338170880938250096 0.12491346167443073689 -0.21082067326732326085 1.4219722275572077574 3.9543247001731387513 -0.13394044651312336791 -0.45105553369280382281;-0.46567148461155349892 0.82185705979766809914 -0.13535500692774624087 -1.4298567407686095798 0.44247115737864178842 0.67300112513671306314 0.091049245446756355005;-1.3665895025301366683 0.11874275399475940629 -0.58337023472945048752 1.041833802874428061 -1.9039337302131260632 0.94753095265510800527 -0.47221617120629755249;0.11605839348672872258 -2.2743238420823614909 -0.34910517604887075782 0.55440594130540010731 -0.051787873385061487796 0.096774816260229212794 1.2000860388629011055;-0.29162367370494307606 -0.86595829877568808453 0.7196020380218032253 -0.1451208826496674098 0.55409643439693478939 -0.89512085075316361049 1.2476931397718415973;-0.11112898458414199876 -1.0202223895388644603 0.73415343063472426888 0.59253304488260638561 0.22456414808337357703 1.0693640865414808516 -0.51159421878844757448;-0.36153459410841404242 -0.51572857553542839071 -0.70466604010728628449 -0.40857056766619964661 2.7078265587639882561 0.94950779464163903576 1.0939580794704002464;0.53892035792871861855 -1.2666688027266936878 0.89292065485591276541 -1.3512809465112611829 -0.14827858255048209646 0.019016774816110814522 0.072763202856532663287;0.86165464658468915449 0.42166548182244256715 -0.57884910540009404389 0.87328791048327547575 -0.86696037570080097812 0.52279115304400769482 -1.0386985494340428282;-1.1614152408644315972 -1.0005574431117139067 1.1369094891825615168 0.67177306550147419806 -1.6616157940998743658 -0.2160254029495923267 -1.6374658142827163143;1.2159411869855980548 -0.78745475885179327946 -0.3281704046965948085 -0.55080653419234304469 1.573413766987098672 0.7118962870722735925 -0.58887383212049304593;0.56378979256104555517 -0.91756023412820497676 0.17250502127391301177 -0.48505120928943157299 -1.9774616363548840337 1.2761900769974081626 -1.6843839970815523976];

% Layer 2
b2 = [-1.6037543017621294084;-1.4255915503483373996;0.8681251023497790209;-1.1116414094005115931;-0.68771812600942328064;0.42524645854819170809;-0.31159806228520364746;0.0072944647047099350073;-0.0141827392643952329;0.4771986858611436122;0.8092902595195259341;0.73507999253818490093;-1.2269119707585049994;1.5105953563036125242;1.4178842064519809885];
LW2_1 = [0.24337066769639698061 0.024751824993044565376 -0.78497068200639086299 -0.00050811606556328166306 -0.65533450095311129857 -0.90250242866228713723 0.12607637270947977259 -0.08984034470911683723 0.040428754660064541993 0.033487930421692485572 0.53398933739260834308 -0.021183727290860307479 -0.20384709434239342563 -1.6085478718211512206 0.070445755686823055552 0.1795790313655435122 -0.98966742472965696376 -0.25684803644843889892 0.74359745341197869273 0.20575630032226288613 -0.20232923199199659425 0.15766882868560971875 -0.010703072147321480642 -1.3602207265628676325 -0.85647024530820936583;0.47074683278823614696 -0.13280550586039396865 -0.839640051853548397 -0.018538120592817144278 0.23529529253922207288 -0.095368080879819502882 0.040408313573322710011 -0.35705025289348962803 0.93632625255121637586 -0.54429229933915135309 -0.16364586833139738165 0.27404246446556163042 -0.79326672716679380581 -0.85028577656397896778 -0.06436519842811457004 -0.07312636957741915078 0.14449233230154528984 -1.246415423678531198 -0.92588962124605678206 -0.18069771920399732568 0.30098964524634014284 -0.74263892675953901978 0.10173755784406801617 0.24314542554693469034 0.17558594131850796538;0.034726006733673361881 0.067166388827259337901 0.1898204192587940875 0.34458342180924267373 0.53302428582096583742 -0.33807562246734640388 -0.03853500341317623451 0.11954339899235601197 -0.77299743631646600228 0.35173323989015031765 0.050132063100999664507 0.373162100212608705 -0.55418903135379482539 -0.26263794944563007006 -0.47015093486746939444 -0.0090334057208876408079 -0.24532234035393893357 0.24789016409082911818 0.32513661775824709288 -0.65324245531883540217 -0.02243430132300356511 -0.019399348707192919095 0.53845666120392576826 -0.47351061400352334463 0.3861439581294972001;0.22561877558021914414 0.77727363447515829264 -1.039124832605573534 -0.60543567799131892126 0.45768223374527239322 0.046445394936814217435 0.31494338593423526484 -0.39811999897318284258 0.65684296910159889471 -0.18088648021359923779 -0.48719092979356110051 0.24964321773616549027 -0.34292391369301594706 0.68623740682177425398 0.078410997763299891683 0.65031299348546978134 0.29384206353154151969 -0.82797799137069594266 0.13419481267603561303 0.29784985912160144572 -0.28049670391599651476 0.025343634691245828239 0.13600966982011575279 -0.65835928558771938945 -0.26271033797181503333;0.30047300375067920175 0.67258378533595786219 -0.62042613147494707349 -0.77785163184126804303 0.57780665581426915445 0.58489081673977993958 -0.064936662368413555768 0.49373394210453491748 0.44975523705542291841 -0.0082850209717356803479 -0.83694581662908529296 -0.35533242592551594896 -0.030993687108777461664 -0.61368370240082525946 -0.35823131409123076807 0.0079655785257582746584 0.050551361992347276786 -0.36887508856599965368 0.53407767249527238196 1.1347832359294531823 -0.25271450375721876691 -0.27932451295167892713 -0.25502336984023016297 0.48165632410935671492 0.12023526679640809955;-0.16063552733445654597 0.11947234179897732453 0.27238946831882410171 -0.11450041093403734438 -0.97052370745550176068 -0.026881822973906920049 -0.52573930779492994425 -0.0724466061379862164 -0.033461543163236975862 0.18116730898328914368 0.11902633422963514176 -0.68888114280507795062 0.50169149733110685041 -0.19004331510769642555 -0.46376798633233889957 0.40549816185297254956 -0.35690139483491395422 -0.10639902456953384546 -0.14847348167277285569 -0.98958016417205740822 0.29693252360933947154 0.80185471009995468172 0.090003775107178940473 -0.14850071040989840099 0.15219557187798102293;0.30597705773349692659 0.28664306266620537267 -0.02957831729023959258 -0.073184460047162405716 0.22436781225131835482 -0.64692156279681634068 0.28038530058622418428 0.27390676331939467492 -0.55926813998783952986 0.70839566622307725829 -0.027489696549231786016 0.1803309062327949075 -0.39600126357788451026 -0.11119020751737912489 -0.40329227231952302635 1.0853612949283879541 -0.16434672730725788381 -0.093919437554382562139 0.41446513156264336297 -0.60008580047849169326 0.039987830196681138639 -0.28224787991801575382 0.20369303495112811575 0.55857618282058274506 -0.036409306234554898729;0.11694262934811400223 0.35285188728756505805 0.27415975304966322401 -0.73697577862402297022 -0.10720578914359719935 0.62371719116630119917 -0.30011840786757482125 0.3413049358183870563 -0.43435672187146945333 -0.36649841548231110178 0.66998786657075815043 0.17918992142165152126 0.27432606444858009809 2.1330691639192669307 0.42956952015305638337 -0.42233058523542010843 -1.1238685886856119023 -1.2751752977012982271 -0.41581491852340507487 0.41320418219104615432 0.41880106508036790691 -0.34546941418034426974 -0.43627363318100959022 1.2083825863922155186 0.13648074674907959003;0.28252695033560626392 -0.025133684037069337069 0.099320786587321699401 -0.42415191462491552699 0.19993744972845375885 -0.32504990388045856831 -0.81873938070901497444 0.20590302428666876211 -0.49359868057617567461 0.13619727558567412684 0.065852820623315905246 0.12074549386374321125 -0.099289549643946095614 -0.041026662064112200123 -0.43251512638537797928 -0.32648342122300993973 -0.58901056270100604628 -1.0141726613406052415 -0.13997012301505229459 -0.62950309923127112377 -0.33626932956528815533 -0.88286427361260555458 0.52816198019998439328 0.16690871169308343913 0.29228991741248372405;0.39498719286734035316 -0.63606772117598542327 -0.050863075883607333783 -0.16083695469611525297 -0.21826996413758562032 0.017374314607126475907 0.33496281636560332196 0.17076229297559297748 0.36984537378643167482 -0.33002110980540899643 0.16932006443875213808 -0.25304725117878218432 0.72763896610272515986 0.25606892852684515205 0.27559675024736318694 0.13232814251097907432 0.063790688339066162205 0.38631012927457275552 -0.067035745345703501297 0.070668252206566306572 -0.41436799716703792695 0.29146498077737259536 -0.23226092879023430005 0.01632793774035304693 -0.62841079691720658218;0.090977940380077337856 0.21429021147053989305 -0.62948411627853662065 0.30771393065405377998 0.1746667874267306686 0.30699791250924401975 0.46890988863458255009 0.13672953912621918504 -0.0010012527149598892534 1.0851760576235929268 -0.38739917438372772907 -0.4183374850077721252 0.40153516183177395682 -0.098221842051614299818 -0.086509796474282057988 -0.78974588986591132134 0.11167466505022848045 -0.60152724263487511447 -0.26919579356463918529 0.57899979106200349932 0.18425686386818898588 0.088033012189000031666 1.2343370863201175158 0.28913110160772942381 -0.26874508355997661635;0.40779229330154226352 -0.51729726203161474629 0.71605714957065513815 -0.83713818122137662048 0.63036729476287800544 -0.57061055026323559414 -1.1856392535957473999 0.4045085998245919745 0.54250253113105684211 -0.48404342545841322343 -0.36169149459159283255 -0.29676198278569315692 -0.94559592377245793582 0.42893421208803123035 -0.49660342615591135385 -0.66103846613178507408 -0.37016307322845892758 -1.0887785882081835176 0.36378271006676904387 0.52088011500798014897 0.037611664443439656036 1.4825152663504084227 -0.60539379307433471844 0.21889532550719767445 0.21742447284652016704;-0.20360420862202735504 0.27272239609326792698 0.60801325607113643201 -0.061955382720199181357 -0.42996723166206918254 0.4339399764044393204 0.73536404178405656573 0.50646302549601585063 -0.063790474557583867754 0.170171312644333661 0.067909732572082132096 -0.030036153978487377392 -0.016945416798355244364 -0.17431318646652216309 -0.34862628264842643322 0.13478551233374722051 0.31712216395754427856 0.50514627718937299417 0.56346087780718923099 -0.21607685024427270015 -0.13819813541983597127 0.29129603885369265148 -0.77709770906841313387 0.080707882262933169915 -0.2124372278269432146;0.093284769382413354477 0.11193332946130089833 0.94986976436625270015 -0.61066329358805160332 -0.0038619719636796205446 -0.31184323464636803935 -0.52154145629962744835 -0.18404331960626527098 0.27273222292057858196 -0.06813550828791767322 0.26432284382612164508 0.42100922889830572071 0.16765297438931989205 0.14557226201975947966 -0.73949824350792825456 -0.10027249328559260932 0.42084182279013987449 0.20133369185750304986 0.26412411492660026191 -1.3367224924064105007 0.11388447083409035387 0.75621162209772418983 0.11026726622799423727 0.27095800819101051315 0.29931011320931705244;0.21403826233536099588 0.59936290279604931275 -0.292274983780932196 -0.28721277449775078905 -0.25157847335634181407 -0.12837894862918991512 0.086395919885600511168 0.2828643812936869617 0.25649825806344123125 0.071675399169403852806 0.15261022675471000443 -0.48676463867764840909 0.48397860153255028992 -0.40202158835890472455 0.10297545754411258079 0.48931994286741492539 0.24679402332008693044 0.34501475865536740395 -0.13926981862085269226 0.041650815529528852077 0.38847349856042956429 -0.59874664384569298292 -0.068106398474022583622 0.18521345185101320552 -0.20946513727293145091];

% Layer 3
b3 = 0.73266340709709332213;
LW3_2 = [-1.7466482996194101496 0.96492297260973913797 -1.3520793241319597477 0.9771195052696408645 -0.24840085819555529634 1.7182720239860704847 1.9873033144581784271 1.7381258588840471369 -0.58181331466402919084 -0.35340490533954038721 -1.4105771791398398207 -1.2845167471857557029 -1.2242096190328051186 -1.1291314890385784064 -0.51371427534727354125];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
