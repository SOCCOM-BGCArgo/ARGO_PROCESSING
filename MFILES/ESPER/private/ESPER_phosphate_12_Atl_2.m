function [Y,Xf,Af] = ESPER_phosphate_12_Atl_2(X,~,~)
%ESPER_PHOSPHATE_12_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.2715386891997688679;0.74163679267082960322;4.8676741861651695586;0.75678036942285187294;3.701429662417933919;0.28804091809068632646;3.1983961208486255678;-1.7084367428337396966;-0.32444184611586335265;-4.2215681221707370696;3.3121127756916304286;-11.257917860875517491;3.6456359030592184745;0.45350425259791349308;-0.055345730157602704424;-1.8124309867412782271;7.4458905827256662846;-1.6068730947744112036;4.9554847750404302786;0.38331434514387591195];
IW1_1 = [-0.18403454389995221874 4.6130274486523070721 -0.3871969364832931193 3.1868486324267362164 4.994979209599020642 -1.188780759836347567;-2.9844642120099384996 0.79378262129979237915 -1.3947106331950491764 -0.81926890303134403126 3.8738258047478120183 0.18375752570160935884;-0.3160710717943150394 1.3382666148190602851 -0.61941162328813670346 4.3821667244710100775 3.4125204159567847917 1.3530592128904701532;-1.7561721404241303901 0.68757984997959586959 -0.13780325636835699665 1.877550874672597736 1.823776451214363048 -1.4733167745378419333;-0.24517253154770465851 0.44369836385466604467 -0.22365820769239080912 -0.03140728788281398759 -1.3527999665233052529 2.2552594291390271053;-1.59154670043374602 -1.3114885471155863783 -2.3965347271189045841 1.3246516361179123678 4.4614394356848592338 0.10105988460514753191;-2.2460653864197190899 1.4650733690686850164 6.1429145680805232743 -2.6054185561701470597 3.7352859297848626241 1.3899803298363375692;0.51519200786311802887 -1.3136729327051810401 2.3858658676155992673 -0.10943917758346428937 0.34722587495306200811 -0.17131543162151827153;1.2146158955771684251 0.44304038017391783599 1.0411409601404475467 0.22406973847078390238 -0.54317868551006587285 -0.55857857895282214677;-0.97631413744319850423 0.78470832941192902865 -0.013388157134045130386 -0.089377107413403850122 6.490710712339492261 -1.1647069608063709278;0.43372036679392123038 -0.18324853864983672858 0.23174410814695822758 -1.8926956438079882705 -7.0734336676961877544 1.0219311159960413615;-0.42230124836655413834 1.8483155183912709507 -1.0737065719211953407 -8.868785144408757759 -4.7335872534027352287 -7.6264396619827605761;0.59901619924946225559 -0.59605418662466380653 2.6812507850736868598 4.5789731874226395902 0.80424481086672594543 1.3934913269000601677;1.0578032526086662557 1.6550519440962956352 -0.079707220850814733404 0.058580943901101689697 2.2551894370251379662 0.57463854759177124265;1.1599245901132819725 0.49102713791875401972 2.8215804637304762181 1.3460590640894984915 -0.10312273910665753496 -0.92963525880836406223;-0.76029933246117709089 1.1880197434497075104 -0.45476251887278112962 0.63101436666108634554 3.5675744471083885578 0.77723825325294826349;0.96404447669113779718 -1.0552643999146995579 0.12411920365366445329 9.5854709788658194469 0.83178458867802340659 -1.4552680153552060016;-0.58790466115307282724 -0.23350334030013542019 1.2772249725731952275 0.51690737744773018747 -1.8220747689989167384 -2.1074517849607357078;1.0058334198896436984 0.35955673751377698055 2.5845340834089709503 2.9022032239367687723 -2.9339080845044813728 -0.03912702812828157406;-0.31111083078246359879 0.28414763631924111476 -0.69945102699900107979 0.728668969857676041 -1.2696815317673912915 0.17039748530734344367];

% Layer 2
b2 = [-2.2085537026849348941;-5.558945390216387672;-0.45907400614728965937;-0.13965689479558821007;2.7689750213986070726;-3.7239421182296661428;-2.3025265150571669892;1.2404979957706132598;0.17571657317762406914;-1.3935295351651975082;0.66812714575410736551;-0.4295764162899419758;0.803019566953805497;-7.4073402944744657361;1.7479368214644981361;0.0072375349441372912457;3.2776071320239621443;1.1898343012926997364;1.204084797412628971;0.46384966000617072757];
LW2_1 = [-0.1292685592356783153 -0.76619190096303857462 -0.22342876870874883721 -1.2767586744021839351 -1.7427513581434992407 0.10598518998370343169 -0.59355313692159472616 0.43324382613137413234 -1.6448506753226614929 1.3955354709753824416 -1.4224634721133344595 0.73206046743738784066 0.46035824945563769139 0.36727003872777791438 0.48340379207792461003 1.3975120009984451919 0.19066124160604389082 -2.4444880197775762376 0.030106774300742676631 -1.3794912970040631439;0.19855012793769849511 -0.53539129735486334916 1.2750160589481558393 -1.6462748593466001168 1.0943776781868048698 1.8178931895560150878 2.0093565585241894844 2.1815170419667397894 1.8921256048855101817 2.8391942779452192802 1.3811775564238812919 -0.7832053660084515867 0.96310221172731447226 0.32048696877838384056 -2.5566800368113966613 0.16977713276626538175 2.3001706907420467196 -0.62130051388017870639 -1.9874584988372347993 2.2192105925817324774;-0.062690550800008210119 0.53459006053272806192 0.80940847477650890163 -0.26122502629587041056 0.24425530741875176033 0.58766711287930628593 0.42073781614532973494 -0.17502097144900180536 1.7911925465247422462 -1.6575772524961231991 -0.36252636039307956084 -1.0299434573057775211 -0.24033439690654537224 -0.82659953069670066839 -0.49279266413180372597 -0.37749262386219439858 -0.97847587422288795356 0.6911208886832549414 -0.56201557269771318381 0.59997908907549035717;0.012852580461509655746 0.42557341505591167463 -0.26418381496063908509 0.18925776463837362673 -0.62025517564944387949 0.31169233833865001015 0.021848823866738500271 -0.55527484764329870792 0.071744325566394262506 -0.51793440177464522556 0.0052079317844263908754 0.070711407507081366908 0.13430213582487893209 0.75064184457775329218 -0.37881150441637356785 -0.72489983282441106116 0.012612205745261499679 0.59358935299713211364 -0.76607847461532796451 0.024389548808301207694;-0.19686988745297567815 -0.46934462300248047661 -0.43136808195055831305 2.5771464312208673952 1.8708538013064965888 -0.87006713437701788116 0.18639342740203734827 -0.50580613827324738541 -4.4069989646574727615 3.5875624965370782604 3.1714833845101124687 3.2664852865728146725 0.81778650135018648992 5.6083518883668332933 1.1104184272347208395 1.4553390040400346894 -0.17340293147438884391 1.6664921567212873654 -2.6184474470059706519 -3.9951947050424534424;0.38698580903123730446 0.39944717169050925065 -1.1892829481411395509 0.13927739009660322633 0.67587530595745337614 0.38379380005059593461 0.1335836118875392553 -0.57451719703835057995 -1.8260028633891403071 -0.24425315340638270589 -0.74496272262021956401 -0.67693890731687089701 -0.17561908361194664141 1.338182844073702249 2.6449916151126551256 -0.15330383982612699745 0.62115518581736417492 -1.1233433606365517132 0.49971055891475152366 -1.1186254690822705626;0.62820470994931543185 -1.0357954214939384396 0.24605753313088538081 1.4386763924132144332 2.643333086222468431 0.35480867471473803709 -0.40641837071658887259 -0.63756263373254995486 -0.65113385706704163258 -1.7733153860034729377 -1.771642003774779095 -0.33690526523681740834 -0.21532082793248241703 0.083108186768228786701 1.5163528618129626935 -1.5313981332787103273 0.66593819422721045598 -0.62475944735347788139 0.40709287696890533725 0.68860632970874913195;0.94960169438693686761 -0.40356140783448518627 -0.89189402361247627216 -0.54352377305088073189 -3.1598288838198742567 0.52328709005219875561 -0.22695061069587033065 0.52086127969683537753 -0.62881268740946216766 -0.8751439171371376835 -1.1677030636441581013 1.3036030109975451641 1.3520136997715941352 -1.2329484955069303087 0.44150143861184765193 -0.17865929543441416705 -0.67056149636695150384 -1.6629073606780921946 -0.82550596779898488542 0.90479249121776150755;1.2147410074236841826 -1.0882943099333619585 -2.0129327674921317914 0.23361494893192136235 -2.5965126969212759533 0.69883064346101120279 0.044913516673309991645 -2.0486638325460795329 1.6650347276724801748 2.1025002342844634207 2.7719168297998644235 0.043473540867199872428 0.28721233409509006052 -1.1898528014816081022 -2.1928648609606486986 -2.4775087844898444622 -0.42197067735063653604 -0.023160200119662428114 0.86375970368669297006 0.90451222976646217244;-0.17359092843105494719 -0.68165143086888735358 1.0025546620517291618 0.77928061635673506746 1.7930787103257510573 0.7534644667091825454 -0.5414943607980412521 0.51677064274235728902 1.055725870928964083 -0.37143765593824529248 -1.4357952754501812631 -0.11551780351266005553 -0.059972078869042960703 -0.38442414982802031176 0.73277927875581838624 -0.38750251631615056924 0.33602967546980633262 -1.0188034564594201647 -0.73109678899318097933 0.32985560927547785681;0.22079953064588322964 -0.023664713538809042936 0.04249912411906869858 -0.18689839876727934453 0.43661066288971178695 -0.65016370299606063288 -0.10676990153386375915 0.64818249711958453307 0.27427832217977149432 0.013644899624280452249 -0.32058868419616076695 0.35576445599128136976 0.2891305896476778492 -0.58688485310418292418 0.28838673343416210137 0.83706465240533101113 0.68345186347660225046 0.1749984793895423274 -0.26630129034950006384 -0.58131757098658454197;0.38814019508125141567 -0.057473592794313577148 -0.022838830077715407962 0.20950327077501079698 -0.95621046141106513794 0.59170440839535920485 0.17870041673410472227 -1.0100243777887008001 -0.13302439892207526539 -0.46568659379519955488 -0.56292248307340264635 -0.032129067367813742007 0.39806751156880287867 -0.32305344327284690742 0.027185959725170613654 -0.90952302242307936364 -1.0181853889132326252 -0.23403738992581629708 -0.65578725922434266682 0.87139873656153821191;-1.0108285734109261345 -0.072490389472718172459 4.2178135266475393905 1.7284814682132860764 3.1741222838907758863 0.44891616531269390444 2.0985490742598713609 0.11803647509792332404 5.0081483915506916915 -4.0425935735965712325 -2.626367433140193608 -1.6094625199907470758 0.56441051394405616914 -0.1335095747570445579 -4.3558215156883406394 0.9192758298979807341 1.1748985970659693301 4.2618319740215531155 -0.065564091730978532602 -0.85774411399854044724;1.6964810854061127543 0.40513380055985592776 -2.9609889453898547984 2.1490628032257252933 2.9917216889714426387 0.50454935410247159222 0.99600324478374557824 0.84453420047713800844 0.4555799479209278191 0.065404654377809748333 1.3243135249490161076 -0.39659653334124495005 -0.72019190203972627273 4.5453588618954148259 -1.1552307258962015712 -2.6712013269196153153 0.92581058202588295547 1.9511626095100906841 -0.85968566510203703324 0.79329856392854947167;0.19211236917208893149 -0.48915459376580400219 -1.0366489982178765938 -1.6092286037245069341 -5.103972535261209309 0.95463077971807652755 -0.055555587867154025694 1.1038657956342343702 0.69663519678093210885 -0.7423191337408000523 -1.6711446058472574361 1.6047342504258435003 2.085450908018159577 -1.5572241606812597947 -1.1599418437521546998 0.57276479065912411226 -2.7605242577914959057 -2.542904355754962431 -1.3539772394941564926 -1.7213337158803592164;0.87250114345410378913 -0.015613048611485536715 0.71441230801287480823 0.78761719511892158696 -1.9929135444962058354 1.6291169060429151472 0.22368287198441003105 -0.85409232265844614584 1.4120797926584987003 -0.54276902552873296237 1.8986489009384910354 0.31190053991528349231 -0.67713386265010877541 -1.1020474718953428006 -1.8482983765976370716 -0.76853750474485393873 -0.078067755432316823794 0.80101350913567292977 0.37989936138276264588 1.4453562652676184008;-2.1687777747081531388 0.30861485982945213724 -0.44489491647503320859 -2.0054850905277432638 1.8064442629888737279 -0.69840328990781019858 0.047279884976702477029 -1.2332483497698953911 0.41565836698179792208 -0.17686873867698194029 -3.4849986988521228781 0.087623464018189045621 0.98866166037030289715 -1.063692081954455082 0.14873011360537810588 2.5870648284508601655 -1.9963912799173300083 0.60191821595021144375 -0.15752654450920794416 -3.5885059911735339711;0.43494584099138500211 0.14770580658667220586 0.0089993256956946935526 -0.035107146425465647621 -0.39180560068598607737 -0.5581748524474355877 -0.12531035465134740536 0.23220224453994653402 -0.092247936219714790629 -0.30295816429202171438 -0.35037486139023571452 0.54417762087109555758 0.56961526527138939269 -0.69155990545225054511 0.48858502992981062141 0.40651140977595368042 0.606433499157733924 -0.20872666114380450386 -0.56266850016405201007 -0.14152238423710394866;0.28428954070727396886 -0.41703564280587457347 -0.9319599593425309525 -0.1407977254668350553 0.074366369864813902657 0.39102721330034806435 -0.11931223712248632818 -0.67290109977794188012 -0.27197086752252652708 -0.11525935759552527471 0.82930995475069835265 0.052366981381846235133 0.067356919243689666876 0.65710959917346956072 -0.38034702777936246765 -0.077753243047460118831 -0.31108826951340157185 0.81835077582898807513 -0.43358452860822505048 -0.7557973181122438211;-0.38282617966396559339 0.46588886325826334156 0.65425024441655166285 1.7523978745291710624 5.0246727314806483022 -1.928004093903520122 0.53518823712013430249 0.23951295086947688162 1.2154417679623261694 3.4968270472030993368 3.3301401011090145943 0.66737008156099331124 -0.16091755597605136852 3.9175809100797009954 -0.27684541226205339193 3.5489786119491015803 3.4014603666208222954 1.875630576382102177 -0.84019829439270010685 -1.0725267979762589388];

% Layer 3
b3 = -1.8409080870300893462;
LW3_2 = [-0.38862112511665775072 0.22555577735653836724 0.40850942258507799698 -1.491857642826913688 0.16240082493753929538 0.31486933099871011743 -0.48030719207348904209 0.69074111600399623612 -0.41311314776202950894 0.70046318122901329861 -2.3000966285070063577 -0.88577866841137931075 0.15112849753769139194 0.3187509210326714415 -0.3931610650996379408 0.53683446355292285812 0.25949544803769020174 1.9948089819153447255 0.79319610719316924197 0.18093012463711338755];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
