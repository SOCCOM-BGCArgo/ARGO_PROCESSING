function [Y,Xf,Af] = ESPER_nitrate_9_Other_2(X,~,~)
%ESPER_NITRATE_9_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_9_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.8442757618574274758;-3.6981074037940073751;-0.68222354352658998167;-1.2588141728271164954;-0.0044507858224837222594;-0.71485646548868908567;-3.3255078973982636903;-0.44417954399387415965;-0.39348375301866350684;1.199268333096893846;0.59685447492350129917;1.4109649116975671035;0.75414011223250909666;0.73339908496239381019;-1.8778768579828919449;-0.81994881065594671377;-3.3350164675927849167;2.9956966942514036134;-2.6769338171328791454;5.6892946390222087771];
IW1_1 = [-1.4777834020362132783 1.5100813834372797118 -1.7402225859671336394 -0.5664938441241438305 -2.2641736447545541822 -1.1455076891019964069 0.76883028390307395217 4.26047949626399447;-0.025192547064690228031 -0.094734897563995709713 0.85846839963832322074 -0.40653048782992073917 -1.7870937307736867172 -0.31177979142843947891 -0.47834876094274042524 -2.0792354195294335817;0.11005115546524360526 0.037766520267405269407 -1.2628459223368648789 0.022341465151967648123 1.9882818030984008573 0.12877988088633959829 -0.58688837431821960777 -0.34479571955291304919;0.12486278782758156169 0.08840925591180023857 -2.3181569363464249456 0.0081662499460280462554 -1.0098867433666434135 0.95472249748485249476 -1.8143849656147332805 0.7456851821488865717;0.057054167955745263563 -0.0053426220477645154291 0.21851331491562592246 -0.025925776378652138493 4.4322132658216002454 1.1054305836042384037 -0.82239892959121851934 -1.6574002417966640088;0.076597365348351639791 -0.049421896028190977213 -1.830752370906560289 0.9492436120956708745 -4.2497478150981615741 1.0669775884516983222 0.50532203236892014875 0.49336406060406429175;1.496890284521655845 -1.3999388330521684853 1.9883887544307259354 0.19468194104937172617 2.0120192882944856194 1.6454615280033626501 -0.64332000333279215631 -3.820239489898209051;-0.080588054416788054701 0.11404013153530412339 0.72348424716346959595 -0.34739092575070051883 -2.0147581801055856054 -0.77202117883042598034 0.10856678762647678504 0.65988209382203544262;0.0083430906948685212843 -0.043647423397212545271 -0.28522985579952575552 0.17057991417433718273 -0.40348269750335974404 0.50563373021063640067 0.26652480955593110812 0.41706938752476929722;0.057914755644325299766 -0.078506612864182187539 0.48898886381932388234 0.2707632311959441429 3.5373737220381245017 0.24450721540437406198 -0.50037157315666114243 0.14614074417384098625;-0.02976603680102269528 0.0084168027686940781462 -0.60901841729508099377 0.76187686376331265059 -1.3610402445075833189 -0.2039735940717863627 -0.093088294740024668528 1.815838070214947253;3.1979726064674616204 -0.16689711058082071227 0.50737030424829931974 -0.095618261395374881673 -0.15280705964821419962 0.41894993216239351241 -2.4886201553339772907 -0.33002717047575264031;0.04722373091844928733 0.15365336708077026451 0.8679687287065914747 0.79802379617401364431 -0.12900415584549931869 -1.6950062770923246536 3.8504165941255839023 0.51886319198068919789;-0.069803160798544955368 -0.01009571036574724405 1.0731154982540642706 -0.20702340836674842928 0.37895750593990867872 -0.21247707537040855241 -0.49453676358037074179 0.82497146833158430113;0.12595135937876664189 -0.27678690092350721752 1.650498944867830442 -1.8094007761471260221 1.7118068842273548302 0.194109024195586094 0.65748244588155990709 0.067138083742832588285;-0.069788896806131386907 0.049586626705991496133 0.438462162404979372 -0.17886324354740665288 -0.17475784146444886535 0.10930889360201391514 -0.060131316236191570401 0.95977358575292970322;0.093845667011212954844 -0.1940392242723694427 -0.71015001509802566648 -1.3602302712341485247 2.1345241172548639064 -0.60803967721362361942 0.97535996506186350974 -2.2666653405840828661;0.6310480999198149199 0.99022525334576949607 -1.7970206132096167018 0.19934194771848273708 1.0703131715400528989 -0.301314030360446794 0.058280444081228309494 1.8935020363736052573;-0.11307114278120206086 -0.14694132181342242638 -0.2861747750493424669 -0.5084303102096535687 1.3822361531524007816 0.959704491187398534 0.59845270746994816413 -2.8397682879477179618;0.011847271051811681178 0.1644774057431318548 1.1266245877173970413 3.594729277482288321 -0.48568844637917157891 1.391340941674277687 -0.65691643483590866914 1.6123349823252952628];

% Layer 2
b2 = [-3.4869306053970006154;0.11169832019438603876;-1.0639485926032912211;-1.0713417907598612455;-3.0702209205074382226;-7.8116685210202705392;-5.2812639066725965975;0.63326675734045823063;-2.8874658714704430906;2.2527136740493740596;0.60405885167699591154;2.9644634568286734044;-0.48961557050753390374;1.1740012181723924467;-0.79886876422749986126;-0.12007790460303610636;7.0645556146603629699;0.8941948051244100748;0.22060738283932135317;4.2660960458858534494];
LW2_1 = [-3.3005340170522767806 -3.7530733251090619973 3.3903027777649179519 3.6013291536754326039 -0.73402558772678494492 -0.22437283256908727158 -1.5973075755123942177 4.0191603740269448153 5.8960448226059707366 0.26179355943443677335 -3.3875406016034053103 1.9311144791425052247 -0.79362023728797759237 1.449576763377429689 0.28272792801382978789 3.2257076836237379425 3.940716507095779253 0.84856620747844335728 -2.371579215614576075 1.0767641685737308066;0.54518819144369856655 1.2870038870724729296 1.2814226984359493589 0.54971091212213163413 0.35788600990653768319 -0.89535689261579654019 0.26747429182985416052 3.2548671661567660784 1.9987382098359518512 0.63473722269541577035 -0.28032011939171014303 -0.10420801582777591832 0.17841413896466321032 0.0032461994557167481515 -0.41371316987555706302 -2.8081409462299440349 0.39183861805964104175 -0.28993414265328287804 -0.050759269396902589877 0.37932494170119956944;-0.27614728945520405912 -0.62787019660872500637 0.0074258738897216005834 -0.62359227318099152981 -0.5707415665999143739 -0.97421602063252366044 -0.29154592262451178852 -0.5746108693228869635 1.0146557826909479161 0.06397989696048762831 0.54128778785292686049 -0.0037196840407876029071 0.10712383340567906143 -1.1959126575029941364 0.14216847998639209338 -1.1805992225823003228 0.4524757713782640578 -0.14079856204332566461 0.28842560568377961783 1.0050308393150384489;1.1678140956385689719 -1.0995792745725545547 0.35049644958712133924 0.44999158603615935226 -1.3507299962706524887 0.69592139635354577365 0.74851748854226651808 1.5985722828035242582 -0.64182751637058932381 2.0854793075418225357 -0.36003599244247980193 -0.017917492907996438595 0.44814004031060450384 0.32473106395519435452 0.59268140550517123266 0.021176315604207681526 -0.14857968421161632522 0.26856669390341308956 0.44595710823851081317 -0.046175686527355708222;0.80263541590128817393 0.97914992003722889358 0.11816622077513878886 0.88746820671867221453 0.93818446743348349326 0.30560044500211192009 0.59153729134465538042 -0.64266799531919838184 -3.7296286367209590118 -1.9437755985648357271 -4.2744760267950834276 0.1330794225258206398 0.21992071055528250589 3.3695143492529311402 -1.1928356698928892499 4.2852678768856709013 -0.51041895871895659464 -0.18829499049767381424 0.055682231052660680071 -1.0825913560319475604;1.8112568780326863127 -5.2195791970057578979 -3.8816747141278140631 4.4181318664087925185 3.346199893655557922 -4.566474994400032017 1.8868309169868353603 8.2793942153376391957 7.7678723427528728607 -0.070921199570627632691 0.41109987125559988019 -0.48022579235301121603 -0.075485350397940464973 -5.7628252989192993994 -0.79792891998981241297 -4.5408213065506384254 4.0256154483449781978 -0.27111588048570023357 -3.4456450020306470527 2.1695143966603422925;1.1677254045346072697 0.31736135082089567128 -0.068819849742146763094 1.001176599138063894 -1.7573015708427490722 0.2092474583636794172 0.85267293416744560641 1.9833039363041873315 -2.2976715953831847727 2.3794133355838154031 2.4269864145713411219 0.12460491057623933331 -0.96530518717477997725 2.1865881093447177008 -0.33072197153722837637 -4.854825031658117851 1.6529950832736732824 -0.046251010141385925922 -0.63084572070061051274 -1.2915925895048863126;0.24352343092785955214 0.062939614228259443962 -0.41693368840367900363 0.087489498761071912702 0.46077742888433737001 0.25995723356758015932 0.24983737431081584623 -0.95637269975299843416 -1.2904803846017298685 -0.31382919600459718845 0.04842285409885317693 0.014630042725756763067 -0.11283794482299390471 0.41052082263891503944 0.09968529730482843243 2.3022787460947435889 0.14265721632647587747 -0.025537253653032047918 0.35546972682943511757 0.7514896258705112686;-0.7227648962405237576 0.16261469964335142913 -1.2189397462831703667 -1.065641737893587182 -1.4625026421009599265 -0.45067002652656112938 -0.89090731250834731547 -2.0262999456631245465 -0.96352519593056273894 0.79607524512703642383 -0.20700395345049485418 -0.16537131477332195351 -0.011442496102791414186 -2.9915107265722093999 -0.0089539001219973816947 0.10805681991109797324 0.79735052460157207488 -0.51639541637538011187 -0.85344985791432814715 0.83050428814221499696;-2.6103652820525411471 -0.87912954003752674659 -1.6293880880073696726 1.7139910181524067312 4.3777305714393062175 0.15688196379896338084 -4.0479961387147174179 5.3253003547892872049 3.8077746270367294201 -4.7272415425167881864 1.0445269293373093955 1.3158191027130718975 -0.011385991247852469271 2.1946835827049993028 -0.44319585050514109792 0.95634612102175431403 2.5418794318781037234 3.5596897737086727886 2.2947814034132445471 1.4600128822335143308;-0.16440294709366387593 1.6004610918197128555 -0.70458364139986651153 0.78069851375492749224 -0.24287188539103440887 -0.015082817205102880959 -0.055051720932744713233 -1.4019922965044340213 -1.3871504778003020952 1.4207500398602521674 0.12808086639002161378 -0.085314954498967726648 -0.20176080325042750063 -0.57121622353462009336 -0.19714599116138639689 1.7857905603785313442 -0.11934449782386030714 0.41382761485065089335 0.11625817952572699288 0.59741634594343029363;0.79499891304204561848 0.30196069115656626325 -0.44417375588709329115 1.0481866567831732429 1.831342391660294 0.15783733647113970533 0.41613442112204135359 0.15006733863750426616 -2.6839344944436942519 -0.33521106928145016912 1.0872401695940541178 0.062153592582583294668 0.19412776840441825499 -0.96191862047279497183 -0.073488380900873256918 1.7403138471858012881 -1.238384558483564879 0.16000832634366995988 -0.93589924601288887462 -2.4403576281840786422;-2.3586728288926210872 1.6033336445935328918 -4.0965748158020742764 0.67890895658826100334 -3.7678360600306444184 -0.14875351261254643465 -1.9915427489724109034 -4.4858814373833428846 -2.6900915232039319669 3.9971846680534710572 -2.5430553223576533028 -0.078824607754590853004 -0.47319698745793914441 -3.9578173124019659923 -0.35812242892553514118 3.3969439553120097663 2.0728572740092379156 0.37921466657182850701 -0.83188554864572406 0.54922049951519502642;1.0367641502900533101 -2.7516341469677416676 3.8838821459313268569 -0.27053556966532488204 2.5715866817495820484 -0.035827397431652807658 0.47612437148243930141 4.5373355512804982581 2.5539396117360837479 -3.0354521794789062206 1.752828614359398518 0.29682914165607865442 0.77835701601122386784 4.031070155927545251 0.48276392188471284328 -2.9519129298323920629 0.058624991681681372369 -0.7946388227149100425 1.0733386204750188231 0.57477975588209095914;-0.27312799288941541631 -1.2062179517564781683 -0.22706991675023946442 -0.59177223504432030499 0.039702702016957254483 0.14147132497837180964 -0.50108259074362981877 0.70371963109770629963 -1.0014787071591193524 0.21721740199798789117 -0.011828553306360069589 0.022147498443054726425 0.16828354598679226561 -0.3937173254795287014 0.36793973423864950734 0.88829719190923439598 -0.52763373506711663818 0.02789561701650568673 0.70085887865337037628 0.071045072037093898176;1.9457475720992547519 2.4757817911270958433 -0.068152247577544941559 2.4272927532718751031 5.09523675611666782 -6.2043912496742068541 2.068158548077913661 0.98664600511936173532 18.875297978191060366 -5.4935445117435577345 -5.4587893029635301545 0.37063915163896715699 0.44596589913813000638 10.147713312395168828 -5.3993072263615706774 2.308369182396579955 5.2209030368221363005 0.98567084698708096191 3.0556460024399854092 1.0058482015285250544;2.1993989458214033839 -0.69025175102770341962 3.9464729104947116056 -2.6569581389466789823 3.44284339992885835 0.90460657980890035734 2.0483144055678317308 4.0644908438438740461 -3.8806250393721124503 -3.1063083866134797439 5.9045087337703723307 0.086393005237063363877 -0.63696109738311279536 -0.32595163671434862485 2.9192285032459004412 0.68261092098270159667 -2.9353489387227238439 -2.8149441409395321578 0.47465575640287943626 0.1638070103879450401;-0.08127036366929631106 1.9703861000849973717 -0.8064345984218044272 0.64089253373663412905 -0.23471261242593213781 -0.1493408380786148959 0.042953423075174690382 -1.8979712887370705499 -1.5443304447081405151 1.4985030741894249662 0.24732153239582338466 -0.092453531719813866752 -0.17443212727709866972 -1.0479195205213289732 -0.18461345069029480581 2.2263464101378627191 -0.51853493550585949556 0.55120541674758727346 0.12466204068046612963 0.32667470754111638254;-0.062232576908360912049 0.33389165022736466693 -0.11315648923013550686 -0.31855107132044435669 -0.27988328997744282844 -0.32242027907207837512 -0.0075830268757337811539 -1.470694469380977365 -0.48998304649321905435 -0.24843307628110675167 0.2157692601266079091 0.019869969937843515867 0.10001834936601307346 -0.4379315940045488964 0.12383155061037645628 0.88925503176101328151 0.3439562427651070009 -0.049614597039878152729 0.11172706862884725088 0.62402615696228114217;0.71164724446486482545 2.2174467938850295212 0.80296818543290082726 -1.4157780372248132128 1.0175105970760018881 -0.20894318145557858046 -0.37568787854547985861 4.262088103595152333 3.4205928659933984015 -0.39638688502477043007 1.7293311260828212461 0.22670462603353777609 -0.078536359189444571172 1.7190493176944661169 -0.56428048330743885153 -2.8475591730574318916 2.1709416435795234612 0.18021955230578129425 0.9471088535087461846 1.2639199348187857286];

% Layer 3
b3 = -0.81415485382805663495;
LW3_2 = [3.1089841935060080758 -0.57824506236430017747 1.4115283389501551703 0.21589121916176962079 0.42358786424906519352 4.9695536275049860819 -0.1477016019429472915 1.2357042844750296684 0.44225212075441777682 0.023905998725275989791 -2.2337630244938777579 -0.2644912579165107358 0.16685870221793941415 0.30555545249591198331 -0.70289623271463153031 -9.1037185735907311113 -0.11994502062538499321 1.945945784630042974 -2.4847260832055506619 -0.19078099537577056233];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
