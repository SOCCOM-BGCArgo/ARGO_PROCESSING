function [Y,Xf,Af] = ESPER_pH_9_Atl_2(X,~,~)
%ESPER_PH_9_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_9_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.518240922685737182;-1.7515562155296862112;-1.3470485877282616372;-1.3795244270730759872;-1.4347650944535201845;1.5265555447503336151;1.2557512206104981534;-0.57871070021969495123;0.17788782820597884293;-0.18615330080945760582;-0.57810237895397775798;-0.15367376430094645268;0.59189824369448429398;-0.51449255040279184836;-1.7206114450171741126;-1.144777291198757041;1.4669050449998970453;1.4505485887821594204;1.8064474617095926945;-1.9675761133082290133];
IW1_1 = [0.72516774538783190795 -0.52543823076235474101 -0.17407087022363124107 0.4804554317813813924 0.82595899330128164095 0.1589837273433689635 -1.4159131043252290993 -0.32594141478566779346;0.9456209224648752798 -0.0033350993105510551469 -0.21110368825065511933 1.0026171733568556288 -1.1477431472070938057 0.41284777133312483555 0.69853363960537429023 0.41356787877233502915;0.84540260826820756712 -0.29983932757819470316 -0.97701624740103687472 -1.1014451267157634451 -1.7821661957431520484 -1.6654028496821859928 -0.24732934065582129479 0.18817500162405959019;-0.30852208263092251173 -0.69521710441498685285 1.7657231797903536474 -0.61680646832366248233 0.17960957935803956165 -0.29526472258595604092 -0.64902405775905069873 -0.40636441269972700674;0.61193024751261415606 -0.4890689906210691773 -0.85747088897552004028 0.12109534145524629423 0.84959100134948417615 -0.8324312322217053417 -0.58694764114184283521 0.45933948705452176675;-0.1623576550498259663 0.88234746642478978362 -0.90900461643417107549 0.15055635211915371907 -0.62473933751529908687 0.81769766836108837005 -0.041819683380411455664 -0.63533131683640253762;-0.40570278887741451079 0.066366724161540296967 1.3254873808491636211 0.62789593673125754236 0.28580146205557982464 -0.49400270121923323119 0.79656618727828087945 2.2209242439910958922;0.60081549401122058551 1.2209787767262270108 -0.044163345272156394328 -0.54762623207638627676 -0.81697012118898570954 -0.036277574628401136614 -0.16256372196971294319 1.121701917620597122;0.3119915488233743206 0.9450162704359913457 0.72313351289771010677 0.3211457539287201346 0.049622863144081770514 -1.1502946071875939094 0.71900956577459607111 -0.1569084394204595112;1.096878952922490047 0.83280040021009338336 -0.0030068773023350699874 0.13702001671372690539 1.2902284627205016232 0.10947695088580218503 -0.040465078621789260516 0.35140597349277102879;0.25675463237535789407 0.76029569259975648965 1.4303219432090368279 -0.97420117796458016723 -0.49872593499950562679 -0.41871225306384518561 0.048200900503784657736 1.5332352432942470966;-0.65770271808016778081 -0.71057546196684218121 -0.25800216814134202536 0.21293865274095638562 -1.2397251174352967862 0.74654482352101803055 0.51220425943510439204 -0.66362400989258207851;0.39417124427380323404 -0.27218988299755542126 -2.1508978601393096142 -0.47270322458576613522 0.41497840812096292717 0.20141258235877113059 1.0635520618348504041 -0.81282561142874931726;-0.63571685052308957165 0.65724414764375127529 -0.3378413157587865645 0.88869265617227621856 0.18255418381611948631 0.43219904995882763021 -0.12020736312896712628 -1.475755167631458642;-0.32506182394980165373 -0.40645832804061077237 1.0229875287370739922 -0.14467758095140323404 1.3013166979980086424 0.50674223104323945499 -1.0347894911743695801 -0.25870142527043188396;-0.84804240409566056247 0.61040110796929469839 -0.98638155027545326714 -0.61131880786569603448 -0.67896218188102741564 0.33700786512711133902 -1.0474053661523869962 0.72472304846289792302;0.3232341785491969488 -0.28010569740817853335 0.46098185793604873339 -0.84077505053810985824 0.77506137336806857352 0.52156964940606020953 -0.060318747374368548997 -1.3528324648460030577;0.50735870420281692361 0.42104941979343379899 -0.84185453947167132593 -0.50670456725578316703 -0.17682575513079237806 -1.1566528346477065181 1.6058459289703539419 0.91913288298166662127;0.60854501640101898996 0.54601174218365122748 0.23247796203376439039 0.32973374477412320527 1.9565607071592236998 0.078418017288712296708 -1.5922598675738122154 -0.36757305521654387581;-1.1616923461074668555 -0.049136630953158927371 -0.16482331411626666151 -1.21430030836369518 -0.77349042451534888443 -1.133577151626101065 -0.43705445792204333788 0.62525030412326354501];

% Layer 2
b2 = [-1.3348116750894980509;-1.6034334270082286622;-1.2310367390412546573;-1.2991192133564799516;-0.91542845717442677955;0.46961522007828043757;0.58437197537373342104;-0.58904188056304451759;-0.34737043839319226013;0.30503200648197525968;-0.037929773091804917795;-0.32738140060744236326;-0.82339154246021506456;-0.97492183008725785687;0.78340405392813816654;-1.1446587193791391002;1.4045865626345708232;-1.2823977643720239072;1.4775808239666552435;1.4106491424292599834];
LW2_1 = [0.033165126134869084285 -0.14159156872818579043 1.17976575867517397 0.10229115248220500833 -0.18083206552735503481 -0.65869510389853991317 1.0730294852071950995 0.13198100142404525781 -0.17204808701601892462 0.19912128905962775405 0.67175932558995166133 -0.0055211881718394417717 -0.39955923748978577903 -0.70976918569084190835 -0.53053039770052001778 -0.37131194533204142649 -0.042363497131194888246 0.80990495786120697552 -0.57415290669318674865 -0.47402586205627678106;0.29954036941325096199 0.45851266726267680962 0.24047139194665792528 -0.50467896070475426473 0.29679494380895893313 -0.21732392165373440318 -0.0063952071007233211516 0.733716411593902329 -0.63934369479371566669 0.080700348963849963257 0.22889540498419880254 0.46026281962179632634 -0.073432578589429781113 -0.54253529791477717037 -0.022534961581361319383 0.15245040244467467083 0.24309469666099012275 -0.27502947341204603271 -0.066209601639626011749 0.086776067772948287105;0.38894801455326766249 -0.14601275269792066136 -0.51136522521655902729 -0.73385330607712206952 -0.23673758799744007431 0.64780063797524767288 0.028464645130262172801 -0.59121852266044994106 -0.31101942369660445786 -0.58785190754103278099 -0.33068696307717254657 -0.62759125735321630302 -0.071207717920474894457 -0.58271426407580018125 -0.21413697367872638888 0.34286888632293788248 -0.2268254592427279559 -0.38464179861580316544 0.040509022738966810051 0.026259790690972045074;0.10923396790389838795 0.12030426411461400682 -0.21850006575587035962 0.10164301690107190035 0.06143463297122214728 -0.4388406753740098365 -0.17726207613897046467 0.17861480951843272669 -0.12481306598131489127 -0.80043085645030132014 -0.95545712907992685903 -0.39003154282817598109 0.99916839922022826492 -0.11170046674484127025 0.16600868466647195065 0.088314061043178182508 0.013513337505988549936 -0.1372381698323167365 0.12410900002655286811 0.55504046843306176218;0.1872931030623820603 -0.096030715036570929444 0.29646588874923635037 -0.14720031200030042617 -0.43632698950829801321 -0.80386312842337004358 0.42290543380107037397 -0.094719145221392520018 -0.14797966806909282345 0.42174736851742733457 0.47197703335542579017 -0.20546822275036488725 1.3052554222545902363 0.18274718240650572598 0.81985375749813427237 0.4695649547674668467 -0.30589226990654305727 0.28584587997761856659 -0.0058663072840283991827 0.04225996870645711001;-0.92812728418726209156 0.23246416032430131104 0.14963035493461634973 0.046669621707884960393 0.45891581101946654631 -0.92349861120016030203 -0.050798311602731641146 -0.041095562931112120109 -0.34593264890631519881 0.29996809478687230799 -0.29584406698343912456 0.16162408077627973824 0.45272858473803917478 0.16929954993932300189 -0.73343369923225121276 -0.3705656418241197736 0.10925133733509062584 -0.76433761512649234238 0.19811907550093207919 0.096500862748354371279;-0.44164132906963987635 -0.15880608870810655753 -0.14819895950168920917 -0.60506192128815572406 0.43261941953573607167 -0.28989233374028416934 -0.09199847629762006318 0.21874553557503853551 -0.6989393777596799584 0.49191939201974327345 -0.72553408402415964229 0.08839350177285036636 -0.56654925759762786441 0.021244952357672104715 0.15361997818164727092 0.29593965112618142443 0.016632552631973822332 -0.3361046229480321168 0.61197076111789217023 0.72088795750519296668;-0.0751209290860520712 -0.10623967348597951332 0.34031504519031791078 0.080225784904498359529 -0.73826522193863630683 0.21337013140419675006 -0.23693099336327824722 0.014837228093200940937 -0.12894159707410599025 -0.19642717316609248357 0.72104427768081769123 -0.40021982190843019556 -0.27857721664148576979 0.14265463112771342713 0.38730008690745681976 0.27947531599694724891 0.15095532432971020542 0.73117673854759102081 1.1510393303079733407 -0.45850554874126459026;0.42168112619714437361 0.42734467803360265403 -0.10073837302687332906 -0.2705025232934666346 -0.1050968700778167203 0.893477212522090114 -0.87074354129621767129 0.040444969023891337578 0.55229751926661174721 0.2239857461034241437 -0.34547620946842511058 -0.83285181270072061732 -0.074281227357717596882 -0.33959699037943202882 0.33832057133980353303 -0.12287885189233149763 0.12459873937976369274 -0.378958021673750034 0.23017567555839840709 -0.74979106152763819182;0.25340618778612666873 -0.41196318402234949341 -0.50277985685430737206 -0.19201815240164796239 0.36727041358889667144 -1.0719224410522742996 1.1640208434870029652 -0.8163157033996211176 -0.54669740361738394796 0.077929191576307441092 0.20458565357923289008 -0.23190478554653726206 0.75301050153315618463 -0.69826778377356879535 0.31034226253573232723 -0.35122690988402954781 0.12886204284271712828 0.71847592784952540867 0.54522625952280023842 -0.25315865799814230019;0.40510914513696016925 -0.072482594419280343967 -0.12180895860841975398 -0.16240626470901922684 0.43085270949063364521 0.32030259180175774114 0.28250655187007528424 0.54981834802677831409 -0.54794694811184785355 -0.15170442843595896565 0.39664356148560159232 -0.50732436270517733412 0.65663240909635278708 0.26566489269154974773 0.10241930540934200689 0.73609467895724089992 0.082763471358116028065 -0.31901583590473925334 0.12947769439929732171 -0.12742043793802196316;-0.3233676339677687972 0.27416633034204929142 0.75696907260913737225 0.40918680536863288877 -0.59015936260332280128 0.6370668019771792423 -0.098967823471499502541 0.64832952242293095946 0.095944590645664781792 0.040717328881322234491 -0.30610148066009112977 -0.37659626451699934613 0.71431084133928290925 0.1289760418816719989 -0.76773513225235923141 -0.071663077085410434308 0.054409841168929745647 0.34186248518814488229 -0.39587802825958434694 0.65985096062100601078;-0.86446048604693737083 0.11569355810807219198 0.24290946442408123396 0.59643845402476047823 0.12926699672959668375 -0.60151061108009518108 -1.9111372165400390966 -0.48943266287625231126 0.45085329996369016836 -0.077466062813496050499 1.0355076861094743013 0.031457632765856953505 -0.39228812157741055344 0.45116897736596256463 0.69236548459270097489 0.89628354590398351398 -0.99332092908595737146 0.26592081217578783514 -0.39057661631884721398 0.14604757149215225054;-0.59987492064258918223 -0.27624289062045209731 -0.055703404172537183958 0.085434076526390484441 -0.078087252342781715564 -0.33242466877550386206 0.65316910035849817806 0.37982731517173767832 0.11514863839991033856 -0.12103120759796473505 -0.87694352878053560829 0.15530769692481199984 0.2430057983223595508 -0.087620746903891613688 -0.046137491424406845697 0.57641035110764493599 0.33639481975367208078 -0.20674250280922037981 -0.23308607379781515201 -0.018189627203495754848;0.55046888000262539364 -0.31750961211772821269 -0.1218134493793524703 0.030531504453296227919 -0.22996318823855499414 0.014319463950914532169 -0.30236030807384728369 -0.54406526570051183533 0.45677494952131181272 -0.79799523304642649979 -0.23845739435316037902 -0.18926306987892968503 -0.34481639642390754519 0.50772214884670674451 -0.49054980475677978369 -0.26090026874091076792 -0.068710792490296490609 0.33231893878479817905 -0.46354675689393204374 0.3731812289400172622;-0.65646921147319003964 0.28098404057999293304 0.53198886298767267267 0.52010746418006792435 0.41233449898899265929 0.40778120295520686733 -0.29807050245115424003 0.82832802666141047698 0.37517888700253826384 0.19241023406433716003 0.46633279675786165619 -0.25265977407911888175 -0.066078293648220057244 0.20813870042790399983 -0.99214800644014056186 0.42514493275545545137 -0.5450960250455213485 0.079119298615942024178 0.64566739216517532451 0.52806260658814574427;0.042389411488571837605 -0.54709390168130223042 -0.1362837997069669127 -0.54293599575981632555 0.12134410960434875715 -0.56476009181671171788 -0.0098165767431117444825 0.010954189349851149379 0.07589865900919150199 0.4531054098050915635 0.48449419769639967548 -0.050302085875109661672 -0.077866976001111018468 -0.055900346474633197391 0.2030907366108131995 -0.54450307990116331158 0.64535151024432335642 -0.87030478142776046546 -0.84031081597251666704 -0.63705811808917045536;-0.31088549771626927676 -0.4789064230524255894 0.19128629977310113164 -0.37031862876555476927 -0.58068859561533558988 -0.79298111991758446493 -0.026939849280080314931 0.030392914782315452044 0.84218913718318322292 -0.20945567768188208535 -0.68137860675292638568 0.28963222410762445858 0.17224225080394878207 -0.18875394571175152514 -0.25458553726391991434 -0.38876131167833088975 0.26824957575732039095 -0.6146796266511551643 -0.82466046951654148334 -0.56572971926913018237;-0.054802917388935251664 -0.33526398229179071864 0.74303650375643370829 -0.66124216642599709104 -0.63823800004286546095 -0.74950259647505457217 -0.21379800851597199896 0.30640151313007080169 0.7441102179952253648 0.13662859313226230484 0.17181376631933364951 -0.31119192467911099831 0.037904408097294423063 0.088200301449497864326 0.72947635094358997954 -0.20823043944700389551 -0.40745473588476027738 -0.31114915841058565782 -0.22168375340416648922 -0.14187575081539027799;0.26458308841730815431 -0.2055814621167385281 0.16345772045677842144 0.15798877736818556228 0.0081197292840752555154 -0.29014690543173010662 -0.37961848225890143516 0.81712215035642077332 0.92770685264491803412 -0.16555249561588430973 0.5770789170989301109 -0.6945382658490510952 -0.62701006039106643719 -0.11245141875660258357 -0.4290356018319746445 0.53784050429097751689 0.1548419669621280137 -0.31064486593781692747 -0.55591362068491900761 -0.16347608948091246761];

% Layer 3
b3 = 0.16314074058066035944;
LW3_2 = [-0.41126892469701509247 -0.31060858660177170787 0.70100519728377075346 -0.27366681831864658747 -0.96910424136941453188 1.3939477465560787817 -0.63485456369288140177 0.83698721783812313202 0.47694749142585046719 1.3610221506539099678 0.47221781539495899516 -0.65545017302915709045 1.966261680638155207 0.86606413287862671346 0.23717470366717122165 1.0801290162518262239 -1.5192845548341857853 -0.80220150747583796047 0.55759655358235205025 0.57234836716290526937];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
