function [Y,Xf,Af] = ESPER_pH_11_Atl_1(X,~,~)
%ESPER_PH_11_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_11_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9494386712278131135;1.3627642222194180643;1.4920602989064333244;1.0336691202931622691;-2.2432338988758746545;2.9750929217776644897;-1.1462289317200562433;0.35912657502864520076;-4.3831446938557805382;-1.1418433760349562256;1.1898724527398933937;-0.43558472145491633487;1.5469919281448976101;3.4843784695916064642;1.1768173798245815664;1.3075847110932941053;-0.69986477597275531526;1.6996194831682867044;-2.319140036871083943;-2.1944724653793432623;1.7838896475706960132;3.8337127052515063141;-3.0208952881729835838;1.3068789189623675195;2.3698435099430432693;0.11913851063132743779;4.5721543045681993789;-1.6123130095503737103;-0.64619800531211812888;2.2399812291568288458;2.5883808675820252354;0.95208783210831693378;-1.3730915750462582281;2.1277513088245219031;2.0369854124657216232;-0.0070816162317470336685;-2.440051240048313197;-3.7002987318563764774;4.2812136736803196868;2.4728554574369767671];
IW1_1 = [1.1743621773056542867 -1.0501525848925130635 0.1702696266446296347 -0.057515272160456189232 -0.38608011583828832913 0.95700396526981534873 0.39977594242345110276;0.33276868484937527359 -0.17263453633647057872 0.044091976447699667008 -0.71129882310390657452 -0.85664014527132470445 -1.7624623173894760075 -0.079321961287461495438;-0.25495690345651450537 0.94268244586366189974 -1.9106791244520215933 -0.36069077775045177425 -2.263764721297853999 -0.07869416646270423199 -1.01938081938630698;-0.31476006127276789925 0.50781064766039751834 0.84436212229917029237 -0.72273717445647434054 0.77402061942693489716 0.1510426850121511233 0.74566512215018065923;2.9453361789601322229 -2.0734038747958503102 0.55100653096363527705 -0.39270373058946167477 -2.1802151789136670068 0.75952291141504191252 0.30977806115660533326;-1.2089589891069865146 -4.4139599781586902338 -2.2327699499759789958 0.36619238422849842429 2.1857020824994677355 -0.35616110894161223666 -2.4840250548877853554;-0.83980859546623365386 0.62350269409696101874 1.5090176859337676163 -2.0665460695649255918 2.7191786521526002396 -1.3539860595622763562 0.47415750687643759553;0.37850239635313509545 -0.25338126790829540447 -0.011940961662143988881 0.16294023757322884105 0.6849840153388592201 -0.84569721748533044359 0.42367807962621661932;0.14131039032560813173 -0.30851522721163388008 0.72559640755224519282 -0.33616423685375379504 3.2629484809312461202 1.3874450567404748025 -0.7911751504787838396;0.11620641915807891631 0.38406685194123579841 -1.4850826343920273676 -0.41502636939264847538 1.1570384881637612029 -0.30642916519846724599 -0.70253771575239520875;2.5808608459975590499 2.2387138845134924026 5.4124993176899893754 -1.1601496676750535642 -6.7988497505612803806 -2.7227362994751227454 2.062617919731979832;-0.021127531194860722785 0.09240869809773211152 0.8280252726561232457 -0.78456105503123574341 2.4224123338094720737 0.067322306641376006286 0.52969477459989011692;-0.34875020108645182759 0.61982946106581027212 -1.0645334075881474067 0.65551715093334850248 -0.97546958016931306634 -0.67422184521321237849 0.46310332562237832565;-1.5892064720582699255 0.90657506924797015557 -7.0991622292727578625 0.38075811690992433789 2.0749923602617097451 -1.3842794937327933535 -3.4651167893798291431;-0.6474449028921827054 0.45252270583258319414 0.20313854411486043094 0.063488686421534504256 -1.7223107654145577428 -0.45511634951339624555 -0.86727374160092196576;0.2294924604528354728 -0.15640656858670134999 0.8877744823027322596 0.49676711250669991493 -1.465827493678909077 2.5998272555287713637 0.31694348916964942831;1.8144817553607908156 -0.29526450466985126875 0.82561908290301255775 2.0774935509048200188 2.6852311825838981463 1.0255725200864047597 1.3200580479457022509;-0.54912462604722989123 0.57700112084206311991 -2.5334359031580278021 -0.013530831196576359465 4.2063155141589305686 2.0871352852611555484 0.61697661750366694644;-1.11906417664620772 0.89923544833997293146 1.1819128458090859546 -0.14971109900454415698 3.2246862047863089629 -0.29628737425424328533 1.2762411646068061444;-0.89604718535804395163 0.48461660889804908381 -1.5690893389279774173 -0.76293549334853971722 3.9743692239169137181 -2.9503686790044096888 0.53708152690833210752;0.79679417137754038336 -0.38806662283709025818 0.65203666434462403956 1.1207090397461414444 -1.6485503340687830409 0.62728528599297994628 0.82665188781742771074;0.031870325281586717181 -0.73399228394517912477 -0.43315161874449964463 1.2240495228270136252 0.58957187061793570049 0.65331951988860648139 1.4333260320367642304;-1.0536619896568846233 1.0082007825198942008 4.7006207741299554925 -0.73366166303781854552 0.50378481006722874991 -8.1021478738468122316 1.41070655758405894;2.4621928369840264672 -0.48952684599391133036 -0.35948263669676183696 -0.42521125432477618888 1.0233167071982216534 0.072945206503894383099 1.1705380122106294749;1.5111376518874382047 -1.9889584977027696677 1.4902067410565249528 -0.37981799973345659049 2.0418399256228765282 1.5074958026434173153 1.5549206785087672511;-1.5405518630257426516 -0.11747268452585468701 6.5000422341640042845 -0.70796268490736979917 -4.1296524156485761026 -0.60295847916684119916 2.1248095419083070645;0.41372391114114498434 -1.2103885385032768784 -1.1426546206616430279 0.51559498140275339395 -1.9464618581880945847 1.7784546130300031841 -0.086278847950260584287;-0.025466447517375534471 -0.16442084428328299084 0.10115370346445935745 -0.49917730253175063293 0.8487318045885240414 0.015400877617226051836 -0.68461145773313081264;-0.26452363217783247951 0.17473762205922890867 -0.5770619107922252411 -0.63595352138525129693 -2.5850418554071223909 0.25979446751060164544 -0.33332028197948104786;1.4945074631260608644 -0.79613195622963184306 0.73200336112351238604 -0.40748739536165229369 0.43404569213900451308 1.1143811701246344459 -1.0939396277587773998;1.8011410945532302375 -2.0266069015303740386 -0.36025259687251043328 -0.15898516097100501288 -0.8482943771826630952 0.37891716740003877906 0.49828042211524592453;-0.24887018499663046689 -0.024445339776516528119 0.6263951841560444489 -0.16027345439980542063 -2.0954850860087419484 -0.73244301310324488874 -0.66631271488219601107;0.1507128387475444864 0.60196701378346895162 0.75796605326463850627 -2.691296765697201554 -1.2455366043125910558 0.38674376808513072357 1.7887022325368762132;1.4240968009073611267 1.39056499301805081 -2.6905803925321150061 -0.2998086491953551036 0.70137639472031942933 -0.0035754524360858130905 -1.0234862254736345477;0.91796837165931388647 -0.51895651301269596356 0.36179160200453847063 -0.84840874573606550602 -2.3186945604061031112 -2.0945110398217705594 -0.10806918166876457177;0.19112250040069131418 -1.0233423324263180021 1.2412313520333650985 -0.56759382751468612227 -2.8035782624936480545 0.45450774285017964127 -0.013601482039445722538;-4.8164213259796273547 0.68950721467938169695 -4.2743800269943568182 -0.85070530450086845331 -3.5790403637758285704 -0.61739362887016746573 1.4151976831576498217;-2.1417862684788890881 2.5371763551383375024 -1.0011764571491890141 0.40227799659183849368 -1.3372043302120750763 -2.1899919197273249871 -1.0970652484023153406;-0.19730834776614308845 0.3495750011563264481 -0.56481693292120116467 -0.46585276216583060283 -4.1979617378599236588 -1.4626640897925775597 0.61423042902103830443;0.13543206842031282888 -1.7076800828421809797 -2.0379504554281577811 -0.44254158026353962452 1.7349417637773099088 -0.1972188861770657331 -0.90546348115600150397];

% Layer 2
b2 = 2.4088560926254163341;
LW2_1 = [-1.458768616125966755 -3.3416924566773449357 -0.87910514611331336265 -2.4959358561804743104 0.27980403798802505611 -0.52517609116026142679 0.096792731500264558853 3.1923732340826314058 2.2563367688037638814 1.5564450244573875271 0.071029562277799843106 3.4368942088096998688 -1.1744329320408204431 0.24577080725193695132 2.603720866628375763 0.48523462115211962731 0.09946698818123121677 0.42851541542420101827 -0.73001800298560470814 0.21414951989896272022 -0.49724831496883603599 -3.0175713775186876475 -0.064782703288463430735 -1.1791586296671594525 5.122893171002330881 0.32211180581841464265 1.5021262911549448926 -2.9618799775940556351 3.8373291809951370901 0.61852328744293039176 -0.95631841612808954345 -1.8469717492261874536 -0.57096444644072352759 0.74739165535104923332 1.4632630036590301703 0.98634528491443163034 3.4838455625472795063 3.6982988754982586421 1.9344622592817675155 2.1224137591198526387];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
