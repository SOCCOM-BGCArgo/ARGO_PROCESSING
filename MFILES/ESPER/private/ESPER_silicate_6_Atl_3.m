function [Y,Xf,Af] = ESPER_silicate_6_Atl_3(X,~,~)
%ESPER_SILICATE_6_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_6_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1386207634294338575;1.8991048338707796628;1.7507934194970635744;1.450764567244506642;-2.5733986711034031458;-0.27141626428467485743;-7.5991626084114178852;1.9128316481566172147;2.6520750207722096903;-1.8675476419173100417;4.0846217035770227;-1.773710391518875662;2.9879015204083736457;0.2336869345619965177;-8.9160406258248983136;-1.0864521002051443777;-0.1482657011780832701;-3.5408942556044666894;-1.2026486549255230862;1.7902528809774833629;-2.0150817550830653069;5.7856649961276227501;-0.71598375373697509261;6.53842013941935285;8.6881964620550782286];
IW1_1 = [-1.3117717711347860465 0.54030297646501534992 -2.9009606557840745822 -1.8695724914740790013 -1.8601997656669910786 -0.6777328189742379827 1.0550929768857324476;-0.14664315475548428402 0.80026983958431618937 -0.90072163339738875454 -0.71267510583968451954 -5.7086496208922730133 -4.6076440533233240515 -0.24785601646633756423;0.28204108518027837249 0.4068097558439032202 0.16825095256454156156 -1.7964406408296169637 0.142398249937941479 3.5979878969215470796 -1.3194629663652901463;-0.10356243427594671869 0.30247875583886701945 -2.0071423618511987641 0.58386335913711961965 0.6419876663551601359 -0.6861484861663085244 -0.18140379214863139312;0.2048868805994484843 -1.1776768993042194822 1.4871523928984471397 -0.18955463157406896024 1.726752983129169472 1.0324776165646218917 -0.75218852863685381482;-0.32858856199191233127 -0.20301473213929874251 1.0957022403154261792 -0.63104361259794372607 -1.1623196200653398424 1.2819794490312133028 0.47362463445856928246;-1.8364094072027334903 0.37965067360173471167 2.7169638157229552 0.91949244933289886461 10.872947228270822606 3.4891354127452407496 0.42874686696476160819;0.07140087118953536427 0.026736346967476433412 0.02155953601999000685 -0.23407580631393098969 1.6475151792988333987 3.0586774604772002384 0.67357603185270442658;-0.45815780152638935219 0.69696009893046528827 -1.4588105339202901423 0.26726471360429598922 1.3062989820333377189 0.1721993605042142772 2.1994642325857323151;-0.25996738966369559165 -0.88846193908349302415 3.4667969342391677934 0.48101958549733736525 -0.25424295382836653578 -0.12857988244182622095 -1.8976837541740592119;-0.51778601628932841017 1.6789908539873734661 -1.7274107871735766562 -0.56869090261880905768 -2.899849585297803678 0.11749196244806722755 -0.87895467146766503852;0.47490701904995158422 -2.4647345570926821878 0.30648285857139279109 1.2378128583263745544 0.074199243422906527301 -1.3609280691718685929 0.8937624575912203051;0.31186535107956786517 -0.21864271300113802265 1.1505502280167432261 -0.31992294088725825585 -3.9455264482960656913 1.5315539497044738937 0.99830204867726479723;0.63934407225671208153 -0.08894750909610066314 1.7195472877421005276 2.0532098505730429494 2.9755309282221356071 0.30754776907873643266 1.6291946635167888768;0.6882576428614224362 0.48893369250503659895 -2.0024989448100716238 1.0282494573709308749 17.623606377751581675 2.987259018947768574 0.31445436745113014565;-0.47563879761243804678 0.61819062841391658747 -0.58078018774306972016 -0.40052032660480674231 1.9360604111022032825 1.5660216604286067987 1.3023915269172781084;-1.1471112199497346396 0.86474628926819063768 0.55249161289747050763 0.4669435300730045979 -0.68015785921558225002 1.8264914418122641937 1.2422785226613846099;2.8670140357470907944 -1.2405023370062067123 1.3498632203061800006 1.21127034119953092 -3.4658873566540675526 -3.7821327874293686477 3.0023691540991190863;-0.048064226709019219896 0.1152388404883737949 0.66233638114443016409 -0.35498368554973563915 2.6227427323369099099 0.25868029427026700828 0.69966914997643714358;0.00061137406426987992315 0.73370243562570935936 -1.5318898685495370149 0.43560364934069328857 -1.5463070054860903468 -1.3664289190528478013 0.16580719588848333301;0.12804659052265410235 -0.1922587240391740171 4.0363824027097958691 -0.36670358910358435978 -1.8228827863191574554 -0.38940242995985552277 -3.2419989182730177824;-0.35124594254173879815 -0.79648923414760230965 2.0647529519679883592 -1.9004627943714824667 -11.101794014616919171 1.5097156039047694431 -0.94787131299263371886;-2.6164786168560629775 1.4561514957315708774 -0.863073450805232123 -0.68486139196368089888 -1.3521891221821753515 1.1970998480815986387 2.2370444697125821953;0.087682971427335040793 0.18135084907272516763 -0.21273183783152530002 -0.31176845979026768241 -2.7681064867930058604 4.6665648237801473641 1.1711396447581448044;4.3683986395829146332 1.5024313215380318276 3.3730745184835768669 2.3665620193076555289 4.1365332192511292675 6.3542392278922017468 -0.69717194958925954307];

% Layer 2
b2 = [-5.6026855067990650738;3.9339542700475393922;-2.8740851469137904672;0.26359931176168699407;11.698286908284700303;-0.61556749546258993089;2.122289920091820381;6.4673303193331070915;-0.043726770472987827598;-1.2232797961096817385;-0.9928907376840787613;-2.1445340960370642414;5.0916627208729234866;2.4731220342388242628;1.2450891325929036579];
LW2_1 = [-22.617576918275283049 5.3775563376996320386 1.2743744893360595682 3.965073842742328214 -1.864763732225200199 0.15821888211847173755 4.7819133721063415976 1.5639385660278533052 -1.2141567406942432861 -1.1705692612471041425 -3.490300845413372155 3.3992876431495782086 -6.9136887661923740467 5.8577824863958340984 1.5186075795097953023 6.9227677581650546301 1.6297816156992346315 0.30558386352815797293 -5.0130334047955367183 3.7417469352578467401 1.1271004747051172057 6.7315776352927896298 0.18245953597325517692 -2.5493672621697105463 2.4343118656108559961;0.86035953852599977854 0.27073361630821213275 1.8077069502076468233 -0.58983948650987960693 -0.64230465048718410337 -2.3841690226160303645 0.23413647105979501495 -0.50112740225282714768 0.5812681696569996781 1.3788775809512419102 2.4215049579655256728 0.49434628835779814704 1.5093637706310836233 -0.44207911272299194039 0.23373790136520447569 -1.1896837365002468356 5.3269418149852461042 2.4353938071620797601 2.2345719324707840059 -0.28195143897580748904 -1.6435256591642199986 0.33769825478514481354 -1.6982687608340167884 -3.2810382810454017388 -0.34281256098787382669;2.8756202678973550313 -2.5712750822511440951 -0.16079537237258323401 -3.9489770558561958502 2.1592739352154386445 -5.7197887199144625825 1.8019646962019983949 0.088033932828053718112 2.5807940617546889506 -1.5911669372364900532 3.1546740589909352259 0.69937000446590213976 -0.079647603516129469869 -0.56647028493855988707 -0.83553603247888241778 0.23582417057501942059 -6.7915150345067383242 0.024446209982272974759 -3.0727645158194536457 0.012559723502752237478 1.4613318444130023455 -0.75993035182777879388 0.14326097830033546199 -0.30347716189039053436 -0.003698961127482320449;-1.2976732243113302534 -1.1411324630202503982 -0.94300617819731735736 0.048635755016426814035 1.8328081111201910414 1.2637300777265627616 -2.2307135991849835754 3.3878635046661904617 0.5929327864942895987 3.5486124044795874788 2.0848595579489761498 0.14825452006892961276 3.9691346143998007534 -1.3096359352680211341 0.91251757457274096375 3.7770287503249604377 3.4586294637436498789 -3.0430160734062754457 3.922560291708377278 2.9632804995200943132 -1.1819116546504326859 -1.2314061367689275173 -3.4691961530109196588 -3.6995460509926352266 -1.2658956447366156439;-0.66180207372564980872 -0.66054800655306589174 1.3364801094146030458 -11.485729934332150393 -2.0132632646413339828 -6.1519185695283793436 0.29133629883599926336 2.8632347255267736053 -8.8804115335248798857 2.6873630550504179482 1.9221573160237455102 1.0049802829707894514 -1.9634386162857533353 -0.23674477834822016398 -0.12879811244316649588 4.0135997224166422015 -6.0119014237765417974 -1.3116895489653510598 -1.2915299745794404096 -0.82847353593438111119 -3.4906037141669177259 1.1170804703929482216 1.2847078773245816929 -6.0888389514364007482 -0.20977082782069852995;0.77551628420465912317 -0.26445086002676920778 1.0837851782138470114 3.2792324315151346603 -0.0033350580096197799188 -3.2518439685126314664 -0.086130212275936091082 -5.0413326441364745278 -2.6791606069323430361 0.40743705785704331657 -0.62371808988871701995 -0.23095455686835825171 2.0191738089076691764 -0.91878118244464157538 -0.89846410513551577814 -0.71734779236781409661 3.1843870314188635895 -2.8257303423037023471 -1.3932250564052659492 -2.5638813629466730148 -0.15893586576288154522 0.20321382445542707229 -0.91456393677539371545 2.7295691083371838026 2.4450786014210916797;-3.3859074503528079347 1.513217420531995927 -9.8564115907286016238 1.6075138003671685105 4.9361564929579602179 1.46700449168809266 -0.18440927396332196242 -0.80322912999618290009 -5.7273657482473563363 -7.5952341627494233123 2.3119672365263079783 -8.2116474140582429442 2.1117436652952195075 2.0846096903722268756 -3.6770755377903041605 -3.4472930739184266535 -2.5706438364381276607 1.6932323741604053957 5.2514122136413385888 -0.50001543798010394948 0.68660516617296385444 1.2012530904577769508 7.5283674963633995247 1.000910397603194113 -1.2316060286564622928;3.2898522999324066873 -2.0511153301305689034 5.4832138306424473839 -1.5129858732485916839 -3.9819001078834497243 -2.8316846101042814077 0.13615344815684621294 -14.616502309226234502 2.5973955434111970497 0.45337486430828333184 -2.6779409721655222931 0.62697439002448129841 1.5955943858369114885 -0.42815604164943565912 0.88733249740309794173 1.2493777709506743712 -5.6546548165744958681 0.44789811311471772193 -7.7982142941158949512 -3.5588194336921681327 -0.062233777504483854537 1.2243434119057809983 2.7595690467201325902 4.7377769850705462318 2.1261716140310982226;0.063399544014672945536 -0.82365925368984393984 2.6135787070014426803 -5.1765098346776632354 0.43781087900969889448 -3.4558817317640628808 0.22537904231250391329 -3.2681901451751871335 1.6678066115992631335 1.4605839204173780566 0.027058016732557952505 -2.003308775463307434 -1.4367132564624705005 1.2073539808254640793 0.70468940371766308761 0.96656747147071009341 -2.3688874722878563439 -1.9551240961012885666 -2.1574870183079646324 0.45910101543737491525 -1.6011078647763312688 -0.0321867858073146898 -0.7096114993716147179 -4.8101090878965973019 0.2400121380907243307;1.0335726741191573197 -1.7502940638068693602 1.2735643778918941393 5.0137970124631010549 -2.5449335374647081842 1.6638491548891582994 0.38688699077741300902 -6.1833105504100567273 1.6932594340202515859 0.094275318443201819307 4.3312752876483022746 0.40883314735848108601 0.31434178560127301605 2.9687371560949395999 -1.5531314285563802002 -2.1390555968652282814 0.17815378259430028618 -2.6033630622891874573 -4.4998858098453391463 -5.6124621420770051117 -0.12500387440533861083 2.6581333848139232501 -1.6408154754979695777 0.30344116651525598893 -5.5330828222013064277;8.8809947762173973018 0.45159145016730711797 -2.5056056911812727428 2.2234489838183706389 2.636714407912254643 -3.9424235664212257113 -0.092380941197129057274 -0.52517294507327705322 -1.1508296715816845879 -0.99172972682388960131 2.1618157349322788541 -0.029132442144309836363 3.000654359573507346 -0.57191155461095644075 0.36802626955824385702 1.4936075932832419966 0.20901282326500528197 2.4861832809478161543 4.5420109676141180444 3.1586509602380870021 0.39649364496594885487 -0.27119521421459313881 -1.9143185379466816087 2.4923286105420077163 4.1669472617464604625;-3.4870570732506891432 0.4855317911841758316 0.73572562001522001651 -8.376253769996331755 1.6504055599549283251 -9.8262007725740012631 0.54099113011149002617 5.9814396245342278391 2.347131699170516228 1.1826407875866047359 5.2897181641950483666 2.6001290609780696172 3.612432678568963329 -2.0823712082073466689 0.79859821522425211704 3.5828129194198954366 -0.35784977911553056407 -0.14820666323751935378 -6.4620291062102745983 -2.1956845889737972577 -0.62454859248028271601 -2.2645429547506812362 0.39339691379771646318 -4.2493887658922950834 -1.6844173271797984182;1.603779288019677951 0.86175192970847092067 0.053006309193214709574 1.1660392767201437358 -1.5137095408476475278 4.6534762923822290404 -1.9555847305963081073 -2.765037040863692841 -1.0410619180641866865 -1.4937573343750558674 -1.6460639985133409535 0.24255928620622768666 -1.9777487314801789342 1.8217535934637745232 0.3233939811925903296 -2.6109595785459771555 10.466422095426409555 1.1277039341261241301 0.99497704984384538474 -0.64737051251964983223 0.064475567421890950248 1.879082701541204603 -3.6259325014125720621 2.2644303772022609245 1.1846183978327329278;-0.089704928807081196762 -3.4535914060469137254 -0.74533781574638979794 0.073975393566817745916 5.5440259602531023475 5.5990806291993573396 1.4026605306730934863 8.3168642527657379304 -3.9371539263718409174 -1.5899320612540421838 2.0281521228992982486 -0.59378084436355660358 3.9537184427237956896 -0.59037598260016654894 -1.9411069737663202428 -2.0932124952411910179 -4.3817875749368662142 0.10543561634539680427 -2.0685035215516425211 10.544207282404343573 0.65617662555359324017 0.68130091816539817273 -1.9534513429647550886 -5.7062687268917757777 1.5548110334419220635;11.920938436581625552 -0.2622115222301896198 -0.33044858684839678586 -0.079614727402564602898 2.3780904338366659623 -1.8581347532713266002 -0.10179204537043699819 2.575616530569993845 1.0277781578041662591 -0.98308285549129736935 -0.62513680483640698959 -0.22002868864549302019 0.57725444798585789918 0.77443863462129047814 0.19600280268562658703 1.2625016162311593071 1.3963997226023865394 0.17750921900785759933 -1.2562010659630722387 1.6405007394307400403 1.0497779886197309285 -0.39452867082428394463 -3.875878191305667464 -1.8110118654846403263 6.9148341422626620201];

% Layer 3
b3 = -0.075044465616090419435;
LW3_2 = [0.0054552457064877832651 0.059512651883834942479 0.085648493551629775733 0.049795386898350828264 -0.10773597053332147067 -0.063863323299798074872 0.0098308522474825667248 0.022414943233251036214 -0.023391644459566127839 -0.021882709117006089033 -0.050424436371427246162 -0.026973494899115220413 0.15673458826466712956 -0.64852323830903080282 0.063168419765438132973];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
