function [Y,Xf,Af] = ESPER_nitrate_11_Other_2(X,~,~)
%ESPER_NITRATE_11_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_11_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.0418639875141932905;-2.8565861112416599532;2.5920127072729823858;2.2543983328738037564;-4.7422841551119683245;1.9209136973881857369;-2.2269534268078863271;5.710373138043746799;0.22468376805843781607;1.0881383224889205064;-4.6643181129942004048;1.9173095822044508019;-0.27550788521345770388;4.0217737062458693842;-1.7835671002860926659;1.7339714909151264788;-1.5810954875908493911;-4.1399217752240833335;-9.7407971997945264064;-2.6424343027093999403];
IW1_1 = [1.2469480106350281368 -0.092316700250348146528 0.98883731656021633949 -2.4787334482800127411 2.1086358965878098104 -0.54526032102028554327 -3.7673240860631866944;0.13562911154001275338 0.24408613757313002424 -2.152611171780346222 -0.46084327266802616041 2.0940407270949630281 0.16563482768951234836 -0.18180726268713537364;-0.18837863698017190406 -0.12540113267389316198 3.6745388421669389345 0.23902790131288420561 2.490417105096505157 1.4147030190598002264 -2.4378370488130718385;0.023223141104244591354 -0.4892518356678927649 -0.47120475474727657739 -0.13273738820608135813 2.5239825041276957585 0.43921145182321447153 0.31687637644828253736;0.020833474208597244776 -0.11099083607211347735 0.3082659288818589971 -0.6870704769976808679 2.4866701310977226136 1.1566783178118755782 -3.8745150100706053919;-1.0455635247587773407 -0.63269486725053425413 -2.8813063113692796158 0.0077041233943246252569 0.30194566622101642883 1.6203760468583934262 -0.28005072004524061979;1.3861067068965056137 -0.29162686563800671591 1.7395046302568863972 0.16535511562074239889 0.039775573770562844267 -1.3920904512357523686 -1.6865501231596187193;-0.34317994631672404937 -1.2552371242994784239 1.4293450201123953924 5.7816610625666964296 4.5693911382898209084 1.0322400236795343798 -1.6850405786461561952;-0.018304449497629934202 0.0778055856581761629 -0.034962923175496013473 -0.049714978886893967935 3.231373328612321405 -1.1472040428314347338 -0.29747078967036105768;0.03234142098416093597 0.094210770143787883613 0.39747247441891442321 0.92440202832303763891 -3.0387361178179537191 0.83050623314784577378 1.0104928991182424713;0.23404468872069941754 -0.083304926244582425121 0.059482215829868803625 -1.7764310543548307297 -0.73065685729030083184 -0.63795217086478217539 -2.3054503930947638501;-0.075769203489872774537 0.2828969810570854948 -0.82008977624760548419 0.24927470198956913627 -1.7438431945154613256 -1.1735143266870606826 -0.1076015460763578846;-0.092489435351500504101 0.1238083694539936358 0.83619909459486518877 -0.68269613404051476824 -4.547795292692243585 -0.44781991501120171906 -0.99752893544506049395;-0.011605682298234528196 0.17352200148422358694 1.6654108732491503808 1.5683680415627407889 -1.8749592695059913439 -0.38652589220188882102 2.1132694680150012623;0.016266286967982507977 -0.36962201378441078559 1.5809174255954367982 -0.9560143030819556742 2.7741283727009022897 0.89081651318189092326 0.25554545704081654822;0.21940383831027912565 -0.0092849676547255444864 -3.9119195607811496629 4.0017238826039580601 -1.9075692591783139918 0.87806531323300096581 -0.86596427218091975853;-0.21797301001162147638 -0.18026842062757103546 1.8142369586876696541 -1.6301229520096076619 -6.1470268025885985708 -0.89682888313984077122 0.10265158389116477156;0.013100266200993103405 -0.20265011147705891403 -1.4211290943801706543 -1.7112389575537847453 1.7428887756517601471 0.71616417367547979822 -2.3026307465811179931;-1.6976656143095556484 -3.9608108999480045043 -2.3454739850808112855 -4.8226131843273929434 4.1940431887955638146 -4.965489167793913694 2.165567397903213287;-0.23184684103289765478 -0.15448306039067288831 1.0513487287647027557 -2.7716879186425500414 2.0878474439108107852 -2.7543472489799198932 1.2691626589058795371];

% Layer 2
b2 = [-3.7962593029951601231;3.4567803192180317495;1.7650955377116273048;-0.30706604968101736119;-2.6251751288488898162;-0.024268957260884689575;-0.53276537360934261844;-3.7152216739747685459;0.3882044716576224519;-0.99822272408531875776;1.219202897944167141;1.5619586804812515268;0.56529302655310476045;1.2284351160536497449;-1.4480043013745917957;3.3188477724050717832;3.6180702833808191521;3.7333170023112782765;-0.43846359672190959866;-6.9543752311060673676];
LW2_1 = [-1.8923831976969041069 1.446822051716052604 1.5262313286010351643 0.074148196064812765815 -2.3760659373679042794 0.35869012351091011936 0.78324675546023836414 -0.13846182485698418918 -1.8849963181561020242 0.33383689846823416669 0.98375587383674700792 2.2862097268337673306 0.27789868905551246003 2.2290951638661313794 0.41191579429015506841 1.3760810218047097031 0.27829555993321875018 2.8378051282235001729 0.3687036365367984958 1.5389524281020150465;-1.7512119282422544675 -2.1422002476517927327 0.66070666993012161505 -3.4107103439099573094 -0.30777739581035246097 1.0187243474297522638 1.2192081920325461564 0.32967013482017848425 0.0051378361777489924 0.59005828947368510473 0.23266947991090539127 0.71415795316391239567 -0.56218112727856373034 -3.2128405077407458101 0.39050881168585788172 1.1757156780213826597 -0.16307713009022234418 -1.6531597812532283776 1.3507693819006549862 0.732804845162256413;-0.34576878689474255246 -0.62916254157320572471 -0.065420730775849866845 1.2219472461683604791 -1.5486202207626955651 0.64759394156330740699 1.4256805212987673226 0.041037577652150235286 4.1155473951671330823 4.5146175772974403984 -1.6787695823028687681 1.3360787823471869107 -2.2938898840874735185 -1.0639680591075928451 2.4199578572291717826 -0.44344202834807250335 0.1353727161115713673 1.3610027750797601964 0.6350978528912212262 -0.90392858226231453944;-0.52279371714490985301 0.0092795596151916473482 -0.33484259407479433079 -1.8660824837742819859 -0.895291966271655415 0.48965037939450561932 1.0521299517435709348 -0.052906956254480198842 -0.19229566336863307408 0.069941480884871426449 -1.8882211891294045092 1.7321280648576220518 0.081952318187304459829 -1.6154758066568819519 1.5239538642668393198 -0.21152845391249780471 -0.27728086971634285929 -1.2040698727591214734 0.24525560547237723608 0.023486365938412901572;-0.82133890721014957137 0.24828992212469233603 0.35652764940717718289 1.1162273474855273214 -1.3840065019433351878 -0.31344749130167243178 0.009332134383229540725 -0.043575812834485250225 -0.015376922785895787149 -0.21260744893604258121 1.1538523126195845414 1.1056917092540625713 -0.23997031210344282881 2.4422435347150162066 0.61512193132306580701 -0.59257200406314780583 -0.85952852517661404441 1.9616325420912110733 0.1847126382390903987 0.0083611241882957376692;0.064559057998817601098 -0.75646624351935687347 0.19164731596090978094 -0.43867467139092169992 -0.98468780557884316718 0.42579837231985984136 -0.17936492207739695992 0.018878429753801606594 0.73473132988240930086 0.37754352621044873217 -0.06552742157231410125 -1.9513345490635454205 -0.07243863743097073149 1.4635690663272638012 -0.49588185935682915773 -0.13337045481440520933 0.29608187481177894451 0.81747879884079255319 0.030577137001967100854 0.24166372737007757454;0.32366485177510700977 0.052856552479922006005 0.40044546335293151884 1.8785497564230981826 1.1203165648183386338 -0.40698970371082071606 -0.84570475369308950597 0.057487028407210177816 -0.071966567550301369094 -0.19973558958468709545 1.6081309119800144547 -1.0146774891865870671 0.039333182692792893753 0.36556122787437350663 -1.4569211751725152926 0.12660709247652554565 0.12090728350841548067 -0.11510958214446806447 -0.18662115293983033704 0.045472904270649712466;2.4117167385709370464 4.1876796814995582707 -0.35965171180949312424 2.1498106073557337048 -0.027318383335312900612 -0.22224029635769815272 -0.92172511501311582549 -0.36126319616333413265 0.46260443314804439163 0.092065142686301101871 -1.6512017136044672139 -1.1844963320861014999 0.6278862165382015359 3.1108968126978613356 0.13884206364792517352 -1.1335325846625536883 0.7888315051758414409 -1.9282402158484368559 -0.3138297348541519427 -0.30085192264903326542;-0.43749693675161155371 -1.0496125684398833755 0.39756205421019596979 -3.2492370839634676649 -0.0049895767751354826169 0.62628722912601364481 -0.10246448361250597159 -0.0044882321046566097528 0.27879728081255406025 0.27976004752138922127 0.69792174636662474008 1.7856643490860684143 -0.013052503847467422649 1.8114249992361086683 -0.37009595409532169974 -0.19994435206300045782 -0.71558776625709508146 2.8136429654471442063 -0.02247026072758211146 0.52618016823690128003;-0.36813324724073431815 -0.72278501140818451898 0.32898854935910276653 1.1895940859681881641 -0.39152407865543603638 -0.30380068384555986016 -0.12325453876434862288 -0.028033668933558998637 -0.20908378204423230806 -0.35458514991156386831 0.93785759548591351997 -0.50512536724919276931 -0.060692000160868619929 -1.1597688131556251889 0.1628226897273727658 -0.14330448726616237809 -0.15126402202499650285 -1.6686217276177826019 0.12132112299795266841 0.24195219870543763219;-0.81395933009022991556 0.69891446723536199137 0.32742259623117236922 -0.87254023484147336109 0.39729966707739011733 0.45444640425211324519 0.70438064724256987947 -0.063643455420686043111 -0.33232336878689405779 0.00016885277417768955466 -0.6914205474012478092 0.60466910276125651613 0.058703235945761642056 -4.2505269890942996014 -0.45955881722654573496 0.71176474573489711961 0.031525464636079705838 -2.6405218899375388908 -0.33961652242457068818 -0.043688220366279902074;0.28957557777739140192 -2.7451902251663988785 0.33633572518310811406 -0.81147352107239989483 0.88179091839585155288 -0.19851427910155872159 0.79222127790467244957 -0.081717031707071396962 0.24113794907155811087 -0.42024580065578243104 -1.1023791032414811397 1.7533079979532260051 -0.096041197965467298148 -3.0391952454047501675 0.28811108645530392192 -0.08888106627053674047 -0.30533973355631416347 -0.4541978893774062942 -0.12869936162687062309 0.44047668218542457286;-0.2447877310706158549 -0.79015418992890062988 0.24040855808440853014 -2.6845954304951771263 -2.1706294636394245501 0.40642469466278013934 0.60820624877597706526 0.029215312119364126447 0.14055204765677828393 0.029227864838391272306 -1.0478862843412468653 0.75941793212298125404 -0.19480113038286409055 0.51547268932707146494 1.7886586935231907347 -0.21988891435867688462 -0.26987134098720044761 1.6284289791253636626 0.31304417724618999186 -0.16872834793753652138;0.80055449360028019257 -2.8208389332744192579 0.29293458056600152339 -0.20478612981888058564 0.59160800627447895916 -0.097406813783789306105 0.73346888340363058933 -0.085324269673927435886 0.14982363968079157046 -0.39615397885485748031 -0.70704348897230406834 1.6723254052430926997 0.017374684018621567444 -3.5331229078271610966 0.39431539026666662107 0.0037239018110482233204 -0.54704864861291213618 -0.73793252617405302729 -0.27808562718146229154 0.41661886014607907303;-0.32790792823049424998 -0.4771965381588925692 0.57846428743278111018 -0.38861001096238406705 -1.6178379342697157828 -0.092805034513515391459 0.30457704202480462286 0.10720160793772538776 0.74988168845216873759 0.66228560421962179294 -0.6000917653378960992 0.96696793850936491044 -0.24738580480278252183 2.5217064436720244558 0.5276901115562656619 0.16046439121904257363 -0.1367924639994638758 3.0886555517852096742 0.31598950296884137368 -0.15113194380340663758;0.0021809841643018589713 -0.029707125127775090012 -3.2728439221617096067 -0.3950177467594245817 -0.79785513722098189149 0.7912526688087497817 0.53537586208802068199 -0.078959028558225355376 0.36263346692927861392 0.55733705105843323047 -0.99247467257543664498 -3.0000881156618222079 -0.1346627101245670699 3.059413153124142859 -2.106396897517559097 0.96838808817386468064 0.46639607774868352408 2.6657998372477620386 -0.28518304042331843462 0.86991181161164099489;0.60262882595761690929 -0.55964893855344310936 -0.86190610346170037914 -0.41026877909761844121 1.8203539455030894878 -0.19179039386956900359 -0.19362916482528863549 -0.10309815951495705788 0.066865975782313499809 0.38919890617247049347 -0.0020496741270780820254 -0.98599836928140205394 0.095869809972349021021 -2.773616929378496021 -0.65496617924426459023 0.58508223658668412348 0.74998756962269030879 -2.1657289463900393223 -0.23215630420006785894 -0.14561251839870262281;-1.9923783497054126101 -3.9658524464350661809 0.45124955108271075366 2.8364307023416621689 1.9170067709032958536 -0.063697516989028049594 -0.50194784535171155238 -0.5924358199508465983 0.087205913236993115589 2.3956495510276409888 3.3015379007091798513 -2.3406561442431743636 -1.1015769934846777467 -1.9137741638768017705 1.5699897777902467322 -0.52197297434061395993 -1.5558255225153432288 -1.9205165917921445118 0.23482272903694248467 0.034766341473935161166;-0.49350405113243872579 0.81277052099499103033 1.8913087645582422613 2.5809785186836693427 2.3624347268395156085 0.20863773307213961949 -0.018725935007360691026 -0.1493611552735605863 1.540900006877025552 1.7884917002084592674 3.0434967894129481003 -2.1150211703987595868 0.42876516611978343629 -1.1299222650348561547 -0.16662876538470358656 -0.3076583306947686669 0.38687033071397219919 -2.8107522095792978334 0.38966499289608075296 -0.17419399927562359554;0.57271366064259221496 0.99777479421558978867 5.1326354848868565028 0.037439074336833737255 0.473518340839865437 0.48589993834783062887 -0.32553848070655105884 -0.18875250939442753118 1.4201288700913519136 0.69218625360954899595 0.76227347555326374628 2.774432579062024562 1.2260315431031532096 -0.63522357168917620296 0.73591077977374452779 -1.3398524272980765204 1.0441913108763150042 1.060478793088675431 -0.5936916367362387037 0.76123350894794206134];

% Layer 3
b3 = -0.36716592412177151417;
LW3_2 = [0.26166186421502968251 1.1502030914132561623 0.76246056337806011882 6.0182768920746640973 2.5235327664050402063 2.1914873807078762979 9.5646620436695695133 1.0470221269880732873 -1.1858428043837598853 -3.4796641839244135674 -2.0280270719589807982 -2.9921848886832269621 3.1656185504175695655 2.8471612353193642697 -2.3592317095934767224 0.93107545935166247109 2.3584094161329427486 1.4633156893817464983 -0.89582350190483062136 -0.42355800047522756957];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
