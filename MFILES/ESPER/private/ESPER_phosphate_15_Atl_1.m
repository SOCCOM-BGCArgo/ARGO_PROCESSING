function [Y,Xf,Af] = ESPER_phosphate_15_Atl_1(X,~,~)
%ESPER_PHOSPHATE_15_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_15_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.5408600543698125485;5.1896870581370659892;-4.435958132082031824;-4.8036386547485250276;0.62734069797168745541;4.2754263482597947288;-1.8227039612327706752;1.4867107972418918127;-0.30242926523754526391;3.6207121668524351321;-6.5555476823571519063;5.8484293968375951067;-4.2995158769155041867;0.092288225431225903717;3.8755920253738080916;2.8949756188289144099;-5.9330946503312222973;-1.4011644343356743914;2.2267851673974217164;5.7105849949699045709;2.0909313505100883823;-0.32790039326003211917;-0.72875233911179571056;-1.7280580389931388119;3.3569490039385643243;-0.61663125106174543344;0.73154688378708510044;-4.5772272390706172374;-0.14043867994218089956;-2.1052164114081231006;3.0565244340749990748;-8.1206287007732029792;-6.1878035635328680897;-9.9308002434850877194;8.4606940421408634023;6.3276616599006407782;-15.308800184469129491;1.5809952978255448208;-8.0743038833871718651;-12.871875452169577514];
IW1_1 = [0.26004181409381049717 -3.5215753237603077963 -0.056558773737580017582 -0.65421361291461754828 2.4820079863447355173 0.3791884496915687297;-3.8081789880019938366 -0.4038469591085506738 -17.50210810945360862 -2.1811406378440953979 10.030913960478486047 0.65936441915815680037;0.64283805637348412354 -2.4809432581332102608 -0.85138107959179154527 1.3917608207853577884 5.4054668063894295571 1.0067118697973580499;6.8558447539510787294 -5.9563084207798766556 3.6302992752092224649 0.86689508963020656118 -3.4694276458464612389 -2.4418255438212916886;-0.10409111918558351662 -0.39505118336878686236 -1.317656850618088793 -0.13441266021723616286 -2.5652681405005139936 1.8363752299605013985;-0.68087255106786792602 -0.56907636175105924536 3.3086287548473851672 1.8644923978322267555 -6.7453606582457892316 0.62363437987579162236;0.55985825363028296486 0.76852599268537347132 1.1008685786673229057 -1.2962696231039556594 2.972498318645556914 -2.0854958432399732793;3.3909400399502427348 0.32136244185417128794 1.1966512622269271926 1.3453267148647249929 6.5738992687464721243 0.29751211714111541751;0.06111106949980996822 -0.24281026731403346219 0.41890143308738514438 -0.9104275379822923675 1.3099060629633731967 -0.95333443669768203055;-0.63578984865142529337 -0.67539212574705387304 3.2702541015010062608 1.5191860821538072379 -5.9742928157291155244 0.74172062526271498317;0.72793425017590240866 2.0791998838351108958 -0.054153494862705701951 -0.48067053151892696894 10.8441524987392377 -0.86675974154700574648;-0.58028600018994569432 0.48430217882450654621 0.72265357424390885832 -1.860840210453625243 -9.2372680354791381063 -1.1658105184529206078;2.6596531185784999529 2.2111096836227797091 3.2904671051903378043 -1.2818318562940098637 -0.56850658594137137847 -2.2407627102373486316;-0.013038833289170733906 -0.625798645093023298 1.1443614370089694177 -0.58749810234215338323 -1.1769695733843508201 -0.01930797614365066181;0.47382177764323718527 -0.95353483165034824687 -2.6714171817990437496 1.2229059311109813368 -9.793897182172052851 1.1536519391511192989;-0.63777686400347843865 -0.86241150685822565158 3.4511194695202669358 1.1881195511272510945 -5.1815535701979058558 0.80974582398466565802;1.2039838551731512073 0.19552115926336322005 2.6931902897948898357 -0.81847933106767423173 6.5526332241234790388 -2.1734215422231630832;0.18439593197883780151 0.13015230279862313734 -0.54679456504808776618 0.70352813722778850813 1.6538400609618828518 0.12210723818339930258;-1.2775331004630343656 0.51268477032161030582 -1.1204176705166628558 0.58851113373324415168 -4.4476753635309203005 3.4803894658434892939;-1.2843576120704556232 -0.22036138489997333934 -2.584803875835995246 0.80033070899611569171 -6.2317167856136359561 2.1191938816746449525;-0.73983033800910291689 -1.4633583608080849014 4.3390424462888326218 0.94628496873353606933 -4.8079185262315853322 1.0292719143843831464;-1.9114957270011019297 0.83092692112417743111 1.6953657892516476036 2.232160384722073232 7.4774737389254548603 1.1953167899610435132;0.57471935865823553513 -0.26182536412681028937 0.62664133155989443225 1.1811860519908374823 -2.1739462402946578834 -1.479790432847452486;-0.25499201370664797972 0.096341543212479313629 -1.9101899923498080192 0.40316392439644466172 0.93521745023392088836 0.59589726150910760083;1.3339085257026079834 1.9492055269560115693 1.7475905827646212032 -1.5655698338021843963 -6.7084334048469100864 -1.4805874856286418417;-0.85557002667753212499 -0.11875223441063614827 1.4041783695175173996 -0.57262363385104153579 -1.6929307688555732536 -0.014588664401472481447;-0.08249381688501139509 -0.20593203558810480036 0.65220435955799249683 -0.54845195101012866878 -1.2795897777831060083 -0.16908597006720207934;-0.62685200941044338929 0.20984062313376858344 -0.54013577570305582043 -4.9320484870930547672 -1.6221161641479413529 1.2848979989941953228;3.1463972681216905158 -1.8771258832322303967 15.347271338613049707 3.9386143710520427064 -7.8120729042994110358 6.6328978168639336488;-3.161594213009295995 -3.3855346833526569483 -0.04177134811575724388 0.059111240571664606935 2.625128195471418735 0.43912458912718776993;3.2476403064260233045 0.32086118228765331262 0.98144693309881747556 2.8752422474941239372 6.672039240463167431 0.40475092772489229542;-1.2429722668482403591 0.76263075192995710694 -0.81388090563326198623 -6.9047778403402260139 0.43966823852770131609 -6.1110053347519670552;-0.7648599640517994569 0.27437087077299326943 -0.68621037634954806794 -4.7220781945896046494 0.48951853382373994306 1.626603924254353073;0.4752952586663418133 -0.17351266341112225877 1.2410489859116513589 4.7757861838385471387 23.61278601257026466 -1.5949893215137120883;2.375144552965481104 -3.9363907159221436238 3.2265275686295584734 2.2948279898998173998 -6.4968001990851655947 4.0106401664003250573;4.305262523902617211 0.19719114047668473422 -4.9749317141405811071 -0.78595728650978280427 0.57561859035607643165 3.1555277959710243962;0.056903686641049902595 0.052575903217424162228 -0.11265877922096168007 -17.25809397921977606 -4.8216259249975852441 -5.3500041454711153577;0.85258359414564022227 -0.22812855632008138818 0.84193059824069971242 -0.80574265807075706736 -1.244585898936863444 -2.8107187274861766824;-0.67105506419959992659 -3.2712300548163253389 3.0836773203627796391 -1.0766323069273717739 1.53683725016475492 -3.6441308207178684242;-3.3961869751565405551 2.5462674485668728153 6.7571647601312259113 -2.0094016736152369162 2.7606709696904827567 0.60907244089924794661];

% Layer 2
b2 = -1.020301596317847892;
LW2_1 = [0.46884821916387298124 0.039600299369752157974 0.37310693957979484958 0.046329575314846813128 0.75350001978433378547 2.727408431243353526 0.30693366746303007986 7.0929368853868544065 -1.9327329233748433701 -6.9416983588127854077 -0.18732627423946329737 0.33498086897964846065 0.19176137246248917134 2.3352154146240993171 0.25088500542469605037 5.504488935812079653 -1.7289886302528563178 -5.8898859006613353273 0.54191360047812098255 -1.8506178036053682057 -1.1642699474709663487 0.17087056689307486557 -0.79277349737313274058 -1.171293625388132531 0.29246472346069130044 1.2293014584920196608 -9.5169897338794733344 -1.7871198004394626135 -0.024898351950611994493 -0.050844026788375261405 -6.979685592607530964 0.21106144018026073983 2.2684357904756478064 -0.16559571665545044783 0.19579494885586293251 0.13328520085769504644 -0.17337688402091844253 1.1514718417299913966 -0.29758228404690745261 -0.16952788749034128357];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
