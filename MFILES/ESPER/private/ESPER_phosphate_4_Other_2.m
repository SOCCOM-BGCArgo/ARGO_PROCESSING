function [Y,Xf,Af] = ESPER_phosphate_4_Other_2(X,~,~)
%ESPER_PHOSPHATE_4_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_4_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.5874909767887106504;-3.5818960279977285488;-10.456181004168362492;-2.5123258149170339948;1.5748561185476823709;-1.2814185678993830209;-0.40862012041007284013;0.93974258903088636607;-2.3229872941102911454;1.4407605359177386717;-0.6269174761309911359;-0.24785576443209467179;0.18039278160847510568;-2.5248334558522245175;1.4826692167352131246;0.53746658073853370574;-4.3943677653970079078;-1.6419789333102159379;-1.5916299775361426594;-2.0476660924189502566];
IW1_1 = [-0.3751397733990473049 -1.1432017990810832142 -2.0873922273899259139 0.4503761634573896222 3.8434211018270265647 1.4480992596053900989 -0.43298424760577980397;1.3323616520831536025 1.6828588231837773304 -2.3143687678972013622 -0.52549707573522774773 2.5521437670949764787 2.152564114873497747 -0.48249830082815559074;-0.19535639291707251886 0.080258495456495063114 -0.72066726694068705683 -11.242358700630330048 -4.8224182268980140265 1.4882066376202252034 1.1217169688452275356;-0.15941106630599097271 0.47540196115485666706 -1.9471635869814583053 0.4215845432597700726 -2.4896484769978308726 -3.1045453198621371094 1.0412575989107659691;-0.063207171908944606575 -0.28270833837387748799 -0.66553948128130036022 0.43021536915076458163 0.67253548035129795402 1.4634962910394297975 2.1677769548532550559;-0.066761869420007419196 -0.023865974293617787938 -0.35173785565522325269 0.042638173738583015626 -1.0480452371586688187 0.57161082440133215155 -1.9160274153588794377;-0.54995556624290098391 -0.19141653072625727794 -0.096621247895595493982 0.0027173040996003290995 -1.2896563194514198969 1.4311007869089025224 -1.2026058467916567185;-1.1427026976331597918 -0.65380189603636262863 -3.0595889473936423997 0.66040427721674488382 1.2117638551810916425 -1.0970198833473892019 -0.62089407350844605382;0.44991274042104667519 0.10268468256782992132 -1.2708400380906119675 1.0333978442057607516 0.73916338565829875495 0.67304958600079034525 -3.2920452742449008987;0.14526873299323572741 0.22850250680536066117 0.22975323328365115927 -0.12106488985555902138 -2.3698543815819825831 1.9006562221590630468 -0.3561940503540852454;0.66610235769963233032 -0.13443034305228709901 -0.62960243308863539369 0.083835689314757225188 -0.79730841192479773305 -0.95699412922317406149 0.63264912067295553388;-1.1396589562485954783 -0.66707710313487911247 -3.2002214627243716905 1.4797454099541662575 2.3443657223080882623 0.77916245460246680299 -0.76684845832973813629;-0.17036648899437201177 0.21663922870204732618 0.34686900472999826484 -0.053651140597859151016 1.800639942885982725 0.65915738483235764011 -0.53105502042233354576;-0.86425165990404062555 -0.58182726230815295931 5.0136425637046100334 -1.5930043575270858014 -1.7432062077392356247 -0.95627266992454662553 0.99236786978700119999;0.96389273460051327902 -0.12449142349190665813 -0.98446681425114779262 0.24150855772066801008 0.84003172233094069998 1.5926748431020778529 1.1960691569510122356;-0.20578168464538915128 -0.52937340142997624248 -0.78297647077712384522 0.20955240277939096716 -0.71970355710388322912 -0.90211945835141682526 -2.271499890500675356;-0.52410455196056737748 -0.49392289812885709077 1.0879633634333023551 -0.86410790324765074377 -0.043114860062007924479 1.1607338249982892542 -3.2427562698573950684;-0.11819512797255259107 0.69974842906822243283 -0.94818547954942355993 0.19882441237724426952 -0.89294592219863344607 -0.94885254313858657937 -2.2737059272293436152;0.44111454328585064655 -1.3286890527418211416 1.8354886873877622744 -0.55428324700722764184 0.90991886347346795372 -0.31868952397017819012 0.25427914014810615306;-0.35740384438978300974 0.47439662754032185799 -1.7015502572396621339 0.48683104510834407375 1.0731337213112712714 -1.142365695972881845 -2.4677203636386737529];

% Layer 2
b2 = [-3.7332399179580653126;-0.051473963967347831361;3.5615606190952973087;-1.9898295784499298033;-0.45097281805449823677;-2.0178489291807890638;-2.3300152254032919785;0.61498334910018626065;-0.052141546923313353279;-1.6560890900603506548;0.069220651400254712415;-3.5387486074948188985;-2.1944107359522768697;0.91455919007804242771;0.63655880979525780727;0.78983242013638899071;-2.9116203409782634992;0.424356747673230561;1.5431641624623715359;-1.0387983758837262549];
LW2_1 = [-1.0147966284462570652 0.13049443008374558839 -0.099786760060350324086 0.95827708179924597776 -1.433752452874915484 1.8738626809006602159 0.60538453546963577612 0.55855517453084835289 -1.4691748966880970872 1.5187892071222612866 2.6656046213511395138 0.64391621717830160865 2.7366735527538010864 -0.60575666895329116635 0.94652519414818925281 -0.67456283784364579059 -0.21840179442415677546 -0.34119931318310642299 -1.0507254780416928064 -0.87179346587106498756;0.97140317927158503775 0.005337300548396393951 -0.028745171686801219979 1.1749814752871994283 -0.71715839171887896253 -0.81347731692133762316 -0.29298370758643799139 0.18703498774023594176 0.36522413137036452424 -0.43218412777228171207 -0.19031054856921780782 0.64233829273641962487 3.1262056491248451096 0.18437329530558785318 0.5053302348590994475 -0.83016166919660927537 -0.78508909929971315567 1.6527374696465815251 -0.35727880590323557453 -1.608969715602231787;0.43651981215642277068 0.54003408752439840956 -0.30927384444976152578 -0.2089204982770699881 1.081284621356923159 1.2150847948378353802 -1.0704382614124330342 -0.83666484959538467425 -0.12989733529208416507 0.30008140845047159839 0.11738009045034435152 -0.49739827721287532825 0.87795577557048776196 -0.47473899085445547819 -0.35510332082176970792 -2.2123496128140098804 -0.39619122977548254516 0.33181349521324149388 0.38425668080882458 -0.2278555479958732366;0.25357142602104509876 -0.41257758750807888015 -0.47503359823420909791 -0.82646545285915296031 0.47463245782125351724 0.3306865792343142707 1.9145249430148523206 -1.1549043404835901416 -0.19324603880261212452 -0.33632824322005044904 0.19305311828282767372 -0.67545022656529041249 -2.8758410142516050989 0.46503986637415573036 0.21616535072905268544 1.2743724853948590336 -0.14029667082494245989 0.005053597588690951839 -0.28536089650206336588 0.45785655770265204501;-0.17399683493193002226 0.035773519912621280781 0.14527945319990745454 0.079150520262385559711 -0.21632809885635073677 0.75501143667141834559 -0.65331808469402152806 0.17849176875866928915 -0.32338930442310737101 0.37719861972837948061 -0.075545077760847442749 0.21536416262233942787 0.12109357310784708839 -0.0056218449458205962954 0.18691993944338985978 -0.007096365655734885973 0.19339031936677830714 -0.32562285607483210104 -0.0029764010480873106558 -0.019297563735611807795;-0.060838385094266311803 -0.80110957570468066535 -0.23049039597216031128 0.068321535982853565105 1.7218923836295234597 -0.69046918316222927192 0.84846200448219277757 0.34567210156471406268 1.2958096785081225644 1.5883321479457437331 0.51976038607170615968 -1.2648064255569988479 0.32264742289659648078 0.43142998363519169391 -0.96010804203214850094 0.28255589742464293224 0.61052717781866916447 0.90323455441363298402 0.19433680516985879505 -1.0274726372188918155;0.06215549013779564369 -0.37914377177174124478 -0.53360379151380799012 -0.49640575504281431174 1.2706773895307417188 -0.31460101704455850635 1.0082059986405824681 -0.014265608396500468677 -0.16462740211573920202 0.48350938761337769467 0.4902875254991986842 -1.1176792390965415436 0.43143116742671500097 0.11460718924498319859 -0.50810672791219335664 0.51500352129354487474 0.78120038411433068148 0.2630864041619839222 -0.21258983693377075941 -0.42711063928066445028;-0.29051423889833033476 0.083167923067187080055 -0.24856419110758851132 -0.12864752956349001511 0.22997872618604819905 -0.9566630366316807299 1.0811206953168104317 -0.23633623285836458106 0.14796859953873503501 -0.90072097386955451981 0.097184161880556896307 -0.25952690107532572217 0.40791077401344005837 -0.22341226045810719247 -0.033386537393021283038 0.34704912040885238511 0.60578219153938084318 0.49040074993292076533 -0.31677354421693609821 0.0036390453808437879697;0.7150269710864316508 -0.17964138857661929305 0.36065537776683570526 0.17061356363407170766 -0.38747668124853057448 0.57593907247925324455 -1.1366916065003929148 0.036694561410974393945 -0.22722636531309220453 0.82513202904976223895 -0.295004585873943459 0.59385522536609325339 -0.97110416432091750671 0.47515116981272381702 0.28301783653468948199 -0.68869136628303406766 -0.56559792741196113219 -0.20638869378928784148 0.36367949269013133407 0.11597125183136781923;-0.58721275480651902168 -1.7463781677697964856 0.35724016853104600955 0.86277281133782968148 -1.7326376519980446478 -1.2791020985694523393 1.1562900592313174464 1.0247536222194479905 0.79763647785980507088 0.49697381739427570757 -0.22399892993285264176 0.29276863107565004318 -1.164532771918926457 0.71829242021987360634 0.632500569224598852 -1.168971184756398829 0.63520881545110752242 -0.33273677962397824048 -0.3496056905190805808 -0.25583418169533611586;1.2115782566761783556 0.87426087350387149399 0.1301208859559244424 -0.93795807333380054605 -0.10648297922472797772 1.3005618232476796603 -0.7740272769202801717 -1.1761317888928339848 -2.7489891671544084417 2.1084933817695361569 0.18814890192465202889 1.5814579466729219437 -3.5960888397767685198 -0.18533655812940591501 0.31637512324234429162 -0.11942796307729125482 0.3814033944993580616 -1.791707633270343436 -1.1981195252140357521 1.9170461871330963799;0.33569508835074896025 -0.84607745147880597525 0.65630976596214452012 0.93204035187102807214 -0.53029781569693013044 -1.0366205641667700643 0.12619280744226774038 -0.71238020823912528989 1.1733815610682913899 0.88950808230919431452 -0.02267975069867500873 0.40579776731990252481 -0.54883383425351361939 0.24312340519183792131 -0.057250772908542697792 3.6517071706912882512 1.2800285575293173235 -0.51069680032959785532 -0.60982279323149946038 0.70260531424625216612;0.091629845327679884659 -0.49800930856424791004 -0.29875757870774682923 -0.20210552231006614909 1.3732959504526647265 -0.26155770209673617765 0.70234635043540827315 0.1209660662558245392 0.35230522397791885769 1.1444542728499649265 0.19049844361030848772 -1.1317576654406127368 0.076788259541290079802 0.26810431614555257918 -0.60030165079698272201 0.27755446256117832782 0.67290529036501278703 0.38773491178374752675 -0.058507961318161980091 -0.54080298122584768983;-0.13057870737121390903 0.40244188154456761453 -0.38706519040112907781 -0.23543332494960489409 0.47933772494176873913 -0.63547602285227455798 1.1955837542645748606 0.0094517064114210871256 0.83921846710763314814 -0.84422591923805723191 1.4182489795572472691 -0.94403293279062239218 1.5559040425890249271 -0.21626831610975594256 -0.91457211134355020921 0.19107429886554680443 -0.58046054251878886898 0.1454731067149799828 0.45065334604460627332 -0.37407720692741136537;0.23428246766430960157 0.37335938652703426488 -0.034884365093644571776 0.1424012801211338719 -0.92083401928371677592 -2.0899226977958527129 0.79222972635383026585 -0.2294621447615046439 0.97656965982309607011 -1.3966221898128505785 1.0771002717434794427 -0.61383394173833627505 2.1036386550984826904 0.20491530753786393881 -0.046660857061743568619 -0.64643669610952292359 0.50853205350352626013 0.66303468609576921011 -1.0233031553219771315 -0.77772918246415867483;0.61972224095882200157 0.93987025380900701688 0.30813843183695432959 -0.17027056750819052899 -0.40201857199662222042 -1.1251651108789426647 0.49210018582565678846 -0.079188354806606867098 0.57041138468608088008 -0.035946603063642862397 1.088151059812169752 0.45949034943529404318 -0.56639310747708571103 0.32489206084573230005 -0.6595351597811445199 -0.25341530551218893752 0.47409163202661974701 -0.18432595921711944498 0.026695212868395646472 0.36777060368138192459;0.031908942986873189973 -0.0068096496443385678282 0.25664157962365541366 -0.27967589795114494722 -0.15074973308027575514 -0.18846733849844274356 0.24556835269388213594 0.0026130149780740768994 -0.018609213824088026434 0.6477060759478667773 -0.91465369573991417429 -0.017829332293917695557 -0.11595232863667370715 0.12827444459162373747 0.20524584859923064584 0.92506774656883650199 0.58799455367466979538 -0.22283089099826175472 0.028923781466895649717 -0.14397077399178279111;1.7077719801216564299 -1.269108987443456904 -0.096157219040216429518 0.4929420950788198641 -0.72112715310072927899 0.85052165533147761067 -1.3064498975630272071 -1.1869778399712460626 -1.0170802163883769786 2.1312578411391496225 -1.7863741132234067788 -0.044500754942751519216 0.77361918191048861804 0.80979093643453825546 0.95217514499736155553 -1.0229987588551170408 0.32258638584673948735 -2.3859201004079766406 0.37957778133590358571 1.3323621759277965992;0.47160172443382170071 1.0641828774803065993 0.49302797657993874259 0.27100211162299248091 -0.39061932272620858431 -1.6186708608340651949 -0.045480034807679058095 -0.22115229439480860174 1.1202600000945170944 0.80516414127314084315 0.71669123539094781172 0.70041294536077103317 -0.89335987312898046397 0.62417363788864033136 -0.76102413865087781275 -0.074486672521544838865 1.2205903451092126044 -0.42275515532430812948 0.020383178250219704392 1.0096866461695892525;1.758618246760525361 0.81913084715875172925 1.2829707841722124417 0.90579876989731000769 -2.8045573218011381478 -2.3555827560344466676 2.0480560021229896606 0.099504912795519914748 2.2667144985846467975 3.0366847916369361648 0.31237433077933263181 0.75125812122394008963 -4.5944899878015172945 0.25863123961073025692 0.60331397377277884431 -2.7378566415632450415 1.3399402782952885005 -0.92686924843428952769 -0.22842981067180151422 -1.0947222205027642428];

% Layer 3
b3 = 0.61154305524324725774;
LW3_2 = [1.1667892856438140115 -0.44085505919173045841 -1.719875554364209691 -0.46897486556383111145 -4.7788627704410959751 2.9813735187292791373 2.6941058512042710404 -3.8809450630129527227 -2.1407977227023069489 -1.3331004774740018437 0.44920110906257060268 -0.79684915684663448765 -5.9108134314621940675 -1.1926716531712122649 0.46682302670976050241 -2.9839492466207113708 2.2234698437094704282 -0.6492190944868264646 1.4218096879393165022 0.19698086622240748578];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
