function [Y,Xf,Af] = ESPER_talk_9_Atl_1(X,~,~)
%ESPER_TALK_9_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:47.
% 
% [Y] = ESPER_talk_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.4099166983821902;1.5055766365618173;-3.4787565579579174;1.8159629842783667;-3.7403432585813325;-0.63062902651238573;2.2233368959040862;1.4634497855230597;-3.4956298844234914;-2.1923423981882602;-1.9992232425999332;2.4523967927220287;1.322670474863606;-1.1034721905565006;2.1104024301542723;2.8645935162828362;3.2940938488281573;-1.2776480305380129;1.9487015197710378;-3.571484278427723;9.1287950414297736;3.7258680763331977;-3.3355407464439617;3.9565538715237722;0.47572686708065182;2.2251676614350755;6.2211775396756543;0.32130463347075333;-3.7502408596739043;2.117008566590088;-0.63158338635635836;-1.5849004930799389;1.5293410017272846;2.4115247817085432;-1.1377120046315705;4.0081921383326664;2.3861563404455399;1.6955699946076908;1.5685936859626348;-1.535860558364079];
IW1_1 = [-2.0035353331843191 1.7850610524293529 1.0238061412706454 -1.7068665029057091 -3.2042777551602519 0.040843047107463983 -1.7766724455730083 -0.45332793385950082;-1.2361720966057816 -3.2570499511872839 -3.9954226034243732 0.03029327298342686 2.714894723645112 -1.4321173256252528 0.71641732670106029 1.8011165713951964;0.798539681352192 -2.1166284497685588 4.3665725187768905 -0.23344112929082317 0.79156534814709889 0.14651329216495076 0.46946987260224277 -0.11510192468769045;0.59559869318386471 1.9678379172071403 -0.65432051677568781 0.021918259874428976 0.40318367750022766 0.20221770753029281 -0.16632836923663571 -0.17397554411024502;1.0514539333708204 -0.058175607692205214 4.9175873836338351 -0.056494571552465962 1.2381638320094241 0.38537128549555494 0.20477778576379532 -0.33973042017900867;0.88535484293051814 -1.8319381160432984 -1.6650468863519756 0.047969450686740009 1.5456654492359401 -0.29231036526371346 0.00047803696591902731 -0.082247802003139484;0.10090740150888824 -0.17987693830190227 3.4663074984005569 -0.11114369814930998 -2.776918855392688 0.060472186288790149 -0.090446050404791742 0.13843485979623513;0.24009360622651457 -0.48118901505207312 2.5498479803013678 -0.10198662589479429 -2.3289614941010766 -0.073073028127713435 0.091692908498573714 0.19893613054482268;0.48703062675825487 0.53862624382422619 0.22034989171510877 -2.5595497866651313 5.1333992313168002 -0.36518899317568271 1.1099546185168332 2.986935535108814;-1.099529621248281 -3.9673644135379145 -0.66520277079013301 -0.010509570237002702 2.68836154545374 -0.57096793075044994 0.80234705495787739 0.22822833769513845;-0.74336731556224744 0.65645421983896679 0.30977066760140526 -0.66625257091866164 4.1246770403832524 0.0019867965800216278 -0.43773024167798685 -0.54285844242442627;-1.699516111173432 -2.0777038871484792 -4.732614228833687 0.50300724752893822 2.8205945456568466 -1.8847669905531537 -5.6829830044972596 -2.0933035195073901;-1.2252620416240911 -3.3018312742987992 -3.7584213568465032 0.026699066695103833 2.6292534766880054 -1.4066662615918109 0.74548713408935507 1.7251379152182069;0.6506317796906228 -0.35176938246487133 -2.4839109688441234 -0.17140572719662639 -0.45937195904538553 0.094894845227082955 -0.22447512036244419 0.1222152063135851;2.2720696979161565 -3.7101042092202445 0.6150263499358174 0.12343955418818461 -3.5766649766543694 -1.0918583017627492 0.66182010861034424 1.0656564498679224;0.014114303127683378 0.63889041695310034 -2.2040287759495407 -0.052540991208450218 -2.6551246755914373 0.1594099927082811 -0.39253893375439108 -0.26763237067574974;-0.19427444809009969 2.1616447844602207 0.84456194933095041 -0.072396179604100136 -1.0556499085471758 0.030727664915697783 -0.37261417022532645 -0.048182180516509576;-0.036834326650702062 0.85532577643845109 -0.60671170782820627 0.060332285824989902 1.6204713879917731 0.21573644317955168 -0.28322540571182242 -0.021756639694552618;-0.23390125609979506 0.075161722461436362 2.7429665638242917 -0.014882216529313144 -1.4130176024144327 -0.011176912888239746 0.043892706872073473 0.096584495900724959;2.7567076773450698 -3.7213576414468652 0.96173798403875088 0.06932357030441888 3.3069424863535923 -0.2523294456171481 0.38959255006415167 0.78336024970803531;1.1932954715019368 1.6782419997747571 0.88844540775751979 -1.9652313009101121 5.1064301913923016 0.29331462984657408 -0.2634562254365595 10.155140764806902;0.48186365453399249 0.41779066327694619 -0.17002812618502805 -0.36874115663322277 -5.6959490984388577 -0.29946694078112018 0.058333332448683578 0.66678348319850445;-0.95310412320967031 1.178977655500365 7.2208775830220198 0.069002770891053403 -3.8624298306859206 2.3730058239900154 0.51100873193464758 -0.90157752849797723;0.64379776515387699 0.49104428214980272 -0.033177521344655861 -0.22402643854232582 -5.8138571986977086 -0.2019125221519911 -0.060870242227064247 0.59804200347319747;-0.50780343544028228 -0.26658088473118091 -1.3977141064171634 0.91916427787955191 0.040436353462441364 -0.52837983102250785 -3.5191723167741786 3.3576629441658548;0.42245123596392664 2.023868382977533 -0.67274270797619218 -0.015334815478045655 -0.0043468154547978977 0.17796711937774737 -0.20278883127392228 -0.085219454884666521;-2.3390832836286974 4.8427272326236563 -4.4536712815029 0.15772962824905062 -0.70337001012504219 0.32541565221344304 -0.95747892418725422 -0.36698080285464046;0.38412873452997021 -1.0390805092527209 3.5668900552049214 -0.090422617873843744 -2.4043164869380154 -0.22676596660113671 0.31436324213174877 0.40040876730243741;1.1476155905613719 0.029685579250975164 4.9966260797022954 -0.057670938699371309 1.2477764361716139 0.41328889230044236 0.19211120148768876 -0.34412962796701502;-0.49290354181365353 -2.3182921620362515 1.6599563690784194 -0.71454703793170848 -0.83854124179031819 -0.51279919330640455 -0.83772432246666173 0.36555986762406012;4.5655056716815698 0.4746395846364006 1.7524923854618799 -0.15271646160740893 -3.4247375067354833 -0.865525769198915 -0.42584081549684322 0.97201728589964587;0.17559782527914969 -3.4112726087692504 0.55562200860943811 -0.030868980633465392 1.5587424895707602 -0.44169618043264192 0.52505955164707308 0.28504079798915677;0.70442075921401992 2.5748854751923593 -0.89392643458722054 0.1061212833673852 1.588449156687701 0.32827892880108089 -0.17601109441973473 -0.52423020722279912;0.81589556302743471 0.88773924676916793 0.67061144961379726 -1.4024727387297871 -0.055943076234460792 0.36442274196540481 0.11259672415226998 -2.6371632241095218;0.27861252672490872 0.52357328754657495 1.0412255134916979 0.11199915607670773 3.5247180561097582 0.1828492543971737 -0.38568833264188923 -0.16612466749332336;0.45359079420841331 1.7391862232537327 -1.2917340239504591 -0.43162832399431905 3.2702991613836696 2.4167599924342142 -1.4522457234065356 -1.7315282270162735;-0.25789836067717231 0.41745046215098469 3.4863962471575376 -0.058138151783236655 -1.8997380033487374 0.22092334305391317 -0.29001695162788899 0.043486530208565813;1.0772190098554408 1.0096016567006452 0.10238409677513714 -0.099701849185629937 -2.5432977104643131 -0.006594026362341068 -0.12377798254016649 -0.37084092688537623;0.32472414243735997 -1.5787640690906144 1.1767593600541724 -0.1002326977591447 -1.8574111610036581 -0.37517599922276773 0.37996497742594071 0.1272567676360854;-0.52998388818414455 0.93033621265528066 2.874867348426188 -0.90843447325728643 -6.027975515876042 -1.7951108611317592 -0.89989236147590079 -0.81945127816615426];

% Layer 2
b2 = -0.51892634042964536;
LW2_1 = [0.029878003048225243 1.8127340056784722 -0.14688992072253729 -3.7939463177977344 -1.199084216903523 0.3598552454251096 -2.5452768410329187 3.3863043717652586 -0.020334893766431845 0.13205612942419673 -0.14247476275989743 0.022833014492321821 -1.921698785868283 -0.60184726225079499 0.10255499802908291 -0.38018419567500361 -0.38158382784929318 1.4676241045929421 -2.074442098308162 -0.079470107153176761 0.30478578970448861 0.70411192114053189 0.052200173097671533 -0.67552415183966907 -0.019376485444921231 2.8058217424090164 -0.10471827838871021 -0.59880457522800368 1.0856056782915886 -0.070405970485972039 -0.028565419051060383 -0.208076982663083 0.98473035146197396 0.0064502404787924452 0.25255538020062512 0.87154935497120622 1.5175243676751031 0.18954545544829551 0.94281827043513744 -0.025772348174865487];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
