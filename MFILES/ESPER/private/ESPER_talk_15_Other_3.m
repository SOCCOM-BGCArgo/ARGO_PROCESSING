function [Y,Xf,Af] = ESPER_talk_15_Other_3(X,~,~)
%ESPER_TALK_15_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:51.
% 
% [Y] = ESPER_talk_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.66372009144218114;1.2367529589910877;1.849259541685927;-2.3703165728201476;0.32052023417966991;-1.0534851663837423;-0.74816161165616835;-0.2350645278070625;0.58363234407002818;0.87216857134006065;-0.99719194745249373;-0.18028954456180823;-0.060191804610175023;1.4340766986991342;2.3062099032895889;1.1622976147452426;-1.4190964560800319;0.45651444855308609;-0.57338962212732958;-2.6001445869557234;-1.320937629939106;-0.63865706430303892;0.13246089050326815;0.53766732265139916;0.73696900928834841];
IW1_1 = [0.25121929052947406 -0.3043553807745098 0.47899978091158635 -0.63236515987031261 1.5232689548299516 -0.062791414678650764;-0.089744937849563181 -0.028178996051376977 -0.78692168117100159 0.49490804789179144 -0.16034425359044502 -0.0056353070269112224;1.0748800406517098 0.011686643341421546 3.1405814713569504 2.3144708249149057 0.49641241844759143 2.507555772684833;0.56671992991017284 0.64448174081464427 1.6057917508654216 -1.6130127339974725 -0.66017282124760601 0.60335948724533905;0.76277848108930113 -2.3962480572206761 1.0578242921670113 0.096231450885398404 3.1074268692350469 1.082525094545091;-0.027253876097511183 0.31831034399763164 -0.83712391045412438 0.18480990858082474 0.43888674917802328 0.14647806157985838;0.074369180967379891 -0.11961302431942102 -0.89859889322965347 1.1656396227308778 2.67916408054817 -0.44429707475339547;-1.6013825959550438 -1.1072693639380082 0.49953070167873104 -0.051285402968874176 -0.23792232100187402 0.29580727942717772;-0.87318879064718979 1.5382916989865862 -0.88072790582841332 0.8525035219555912 -0.68618154908673157 0.053984822724689144;-0.32843075334894661 0.55649705527836457 -0.24701392886866527 0.64973784384547406 -1.5121900698214268 -0.11016948862606722;-1.0222744160444093 0.58642543785142143 -3.9635669388881891 -0.21760722864878593 -2.8615963205113704 2.264644896805331;-0.036464952148211646 -0.18537437560409967 -0.45966975681768407 0.53216080486712281 -1.0047086457051861 0.50803120621573161;-0.47449147478890752 0.6307055697494679 -0.29397246334260391 -0.18413478823925999 1.7267946070401861 0.88849423460314114;-0.22917350941643622 0.0092678865926635583 1.4474712867258639 0.8673851623196086 -2.4484179836182838 -0.32009654888943095;-0.30242958418348054 -0.082054118219259578 1.7105501243195871 0.54791427747797217 -0.79968662568663773 -0.22775570390230104;0.098093631162340128 -0.14897332387449361 1.1388514000082768 0.28064473173326571 0.03193585021552027 0.070781926416949165;0.17486051226629065 0.12975233909232892 0.93488063499669705 -0.92350532554043541 -0.48259139531469547 0.12490901129783404;-0.09070647454016896 0.054290918959333627 0.71555029564408301 0.51871880037611384 1.0940620664689806 0.023104347545696388;0.12436967754858493 -0.1595421339749945 -0.02976025250074921 -0.38344481509949907 -0.7824640631000509 -0.5432276150220654;0.18740987962022249 -0.084837428995471295 2.2869640996952403 -0.76706778320802249 0.15599051311374756 -0.40209561786714287;0.20934829494343146 -0.064217319611982515 -0.71508286983830327 -0.3999448385261517 1.0193418515298331 -0.28737031061161455;-0.090748458716395003 -0.1963631869010371 1.8624485854305282 -1.2132416505741683 -2.1199368497308657 -0.12483418219484355;0.12232797410994499 0.18591448762905641 0.55869269893971829 -0.59025639732995494 1.6594636558464744 -0.45164608117440724;-0.0073779998624623633 0.037770904330311113 -0.14971902259490699 0.87856044716666926 -0.4585173462878781 -1.2165400071559427;-0.28737990533924085 0.38064711695799847 -1.0168792992951077 0.058752708440916165 -2.61357832351153 1.863110288280424];

% Layer 2
b2 = [0.077503945881626762;4.4528275764691641;-1.0637349468100634;9.0299856046737794;-6.7565343772114721;-3.6404554729220679;-10.834150930415102;-1.6137145146763778;7.5780063137538036;1.8417401335803603;7.6907120248947329;5.6838869514626182;1.1356501808160113;-10.964520591015015;-10.385833426958841];
LW2_1 = [2.4050448062448613 9.3491319181279042 1.7232058797224621 -8.2622263677410537 1.1820684851588903 12.025187970450272 2.8236800031717477 4.8757912761643727 4.3007955486565379 -12.948544147909219 -0.29063887747673062 -11.395802578123087 -1.6548996640620512 5.6789774486287401 -0.62849502798136758 -3.3737801549808815 3.0262139781697819 -15.154093895735505 -10.197104241280908 9.2925518448275444 -23.712751389463346 2.7986104430860297 -1.433852610106142 -1.3912306557395009 -7.6094339748838769;6.1711811183042826 -3.0676035534015349 3.0892159415947282 0.00082511371835506482 -9.8895735677541659 -10.111594225929904 -4.9721471116446923 5.9429873254233145 7.6746817091162551 0.98853745495651568 -3.519664669732895 4.982791250075179 0.31378719519299453 -5.7125264257635839 -9.4970328344201604 4.1409697800074836 4.4495998687684226 -5.9667631317908691 -6.6078667791578383 12.230845772461334 -8.1219315561367136 -0.40824094019728396 -0.14663206953534738 5.1509131017241785 2.8160670405878294;-13.19086324092647 2.2966672244521003 -0.95718468768734266 0.31073700859067527 0.16063383760830297 -4.6346447442409415 0.349500202147011 -3.6955336496209688 0.41048730534893629 -11.975051595712385 -0.86059830393177261 1.8696374903666357 -0.30833219837969156 -0.27392302876961439 3.0531452840831901 -5.8850141369956415 -6.2335158192310489 3.9868242828463814 2.320505839260949 5.0678174858210605 0.16485061298880349 4.1920344411764452 5.7649108424880318 0.79465043484084785 0.75466006167225219;-11.318313402450171 0.52428241471755543 -0.74528698712874342 2.2157212431848272 -0.15852471632401902 0.32126168681191991 -3.4184487169419127 -0.64709940785013509 -0.77817626932409256 -2.2758573223697147 -0.47600135056999565 15.176837489934643 5.3720857763817014 -3.4286002844788639 1.505205418692084 5.0207338428132582 -3.15381475787748 19.223613501642941 25.302370034232059 0.85108559516739546 12.002890196966817 0.8402967750009237 6.882167014538294 -4.3428415360309893 0.9511679818979577;-8.3413691480196466 1.953652755801337 -0.35457946442050953 -0.37779464160314363 -0.88634346171338829 -16.346501912873737 -1.8327888870951994 -1.438890372075132 -0.62442352872062235 -3.0185548869497119 1.6746723535727477 4.4765443351957552 0.30796249821076865 -3.8921268176295674 0.08697116348954595 -10.926454979829849 -5.0292599585720286 18.632805609389703 4.7688666050762176 -0.51828697945474533 2.3788960482453945 5.4319131388278104 0.039749938602013674 -1.1248862540535733 -0.5847543609057112;0.34465460132036391 9.5646884613004346 -0.093018805069821631 0.69282560379259495 0.39839038068057392 9.5674646539404637 -2.8408971394781335 1.7054075522801373 0.4229619708637391 -2.1021707162950598 -0.98774429590235335 -0.60077749297146688 -0.17199181548616474 1.5490126111786739 5.4085976205557236 9.6224726677865284 1.9717816522691003 -12.900286842722297 -14.188755186007521 5.0364490998253739 8.698710570700241 1.8861354802248687 1.0041868202844779 4.8806284632246939 0.28156081816657413;6.6284358302168194 17.993529445719531 -0.17301573734665338 -0.77787457392228931 -0.2607261714693071 -6.3976107193542759 -0.55628231212801904 -0.73212145533705442 -0.26351861063024351 3.5561614826580046 0.72352116473871886 -6.8887839242724578 -0.22234016147035324 -2.0474738123556095 -1.2026710618700631 -2.326073243538989 7.0226165116942791 4.6870626922808629 -1.03749278473442 2.3118437419276305 -2.3190337674202213 1.2714264570814893 -7.3201409408817817 1.3073798187739987 0.99986108116262096;-10.465198263766226 8.4576803846110806 -0.14766196597657835 -4.7796399225210502 -0.053534577608368328 -8.4553733018270236 4.543224522828007 -3.4949623952096651 3.931120440082184 -10.725081125600438 0.27050010704760247 8.1672894091743533 0.16397439181240861 0.24560297489321498 -1.2255339745021088 0.2208722955270489 4.7891576335254014 2.6183058671297754 8.3170710843340423 3.3417246424442828 -2.0689129701504503 2.3778946782484436 7.9629120566868625 -4.6078650452736367 -1.8288815333573427;19.144316172095394 -18.348115107290393 0.51229865724209389 2.5093739693644705 -0.072858976666612493 -1.3775171797306385 3.5521984879028627 0.45775685315533771 -1.3643680308878099 13.686301534856499 -0.75311951195542104 11.03337766062911 -2.0787638152832812 2.2999128378915858 -5.9832158929773653 -12.429751405826829 -8.8611814480269047 -0.35287352496992641 4.6673530405045511 -7.0596970825383538 -14.182107512737582 -5.534981771014885 6.344365604786379 -2.23996055253882 1.0497984632040906;-8.4830716192922822 -13.508239702571569 -0.65459367283677616 -9.5103095005045812 -1.3292080568643412 -4.1279104687844983 3.1517749401786279 -0.39811855960765574 -4.2292792295662718 1.9915550452054114 -1.3061262419782631 -7.4544762612116573 -0.58491123669193357 -1.3331657299036954 -4.2726212918585649 -4.3160886078900189 22.785821119478157 -3.2961295532094876 -5.6122088766286344 -12.014120690295631 -7.5101119687199285 -5.3776002489073544 -4.5564489046676897 -0.52207817447286042 -1.7739292661081649;8.5193773978104996 4.4668278673660256 0.78747730339488953 5.1418218209201196 -1.6850742458598056 0.18275861280309136 -1.063544239884215 3.2598043002298009 1.4627987459554306 -6.754869722404905 -0.19466489108338833 8.5919608524880537 -3.1441645202151571 2.2134223816097616 -4.6826840360969006 -18.331986367416373 -6.5296290093830462 17.431790220546024 12.208737881285323 8.7978131008941887 -17.383379954379269 -2.1289339806005319 7.7372793036959866 2.1763105831461185 6.65564501548912;-7.7794596052586336 -0.59586429587486678 0.15863372406449847 0.077470078922255686 -0.066179974885626131 1.6309653946469316 -0.29343065037275623 -0.18816715836085243 0.36031699698120567 -4.6786016694424211 -0.51556672420977778 -1.0499982086680599 0.54920283063949116 -0.8148321960842152 -1.9379752196783129 2.0557926234423749 1.5612774507396752 2.9558275572023258 6.2550207884504383 0.42559633437135341 -0.31134621452952493 -0.0084371164638662368 -1.3955940651278642 -1.881078074065748 -0.86190770792874949;-12.546279543350751 -12.448104582090851 2.6545171506100789 -0.77293438154551775 1.363421585365457 2.8614595507176612 -3.833683792892153 0.7273156700442428 -1.7602676602875216 1.7406349388084683 -1.9320718853803094 2.7440848097851793 3.2926322504514425 3.9087806999214494 -1.8892575844687647 3.0369744591720531 -0.13552655025778906 -14.330146689828858 -4.0931954950039229 -8.6650429806385265 1.6454684065945386 -6.3064994840069772 0.056661761069913066 -5.0568918398569842 -12.504178544023521;3.5755166958922735 -15.604690199360347 -3.5516035011337945 -2.5155422336478832 -1.2920826701457997 -21.586341244480984 6.5025419908989788 -1.1859448243836967 -5.5526036333026747 10.365133617486791 -1.3828015526532957 -10.10356536109329 4.6861743247635683 -0.011462892039745515 3.769664082165221 -10.515237302356841 2.9043426112165314 -10.548888510688551 -2.0041765772180846 -7.2048858840163899 -7.6200933552277688 -1.6448028816324851 -13.452000121391363 -6.2695022311832629 -1.3994691568533606;1.0600362189211108 -2.7552607979732091 -0.55961232897893098 4.9607954447358669 -0.30386415165514924 -3.986619471452169 -2.1787944241582911 -0.44247254819191034 0.53497510139425442 4.8088605457980202 1.2009265854749858 -1.7791708057224991 -3.3500971525639116 -0.14667443826270507 6.1455881190160211 7.3349215026743035 -18.717984802928143 -8.9408550282657266 -12.919085031156403 9.5220704884674952 7.4432083056343057 1.2738429270269083 -1.540103700532202 -1.6196062270506364 -3.7497794659724271];

% Layer 3
b3 = 0.13325422852175706;
LW3_2 = [-0.028790675170599307 -0.01265175984227675 -0.040095940282219009 0.12885083093113828 0.0626862829721717 -0.13617609477026135 -0.36663184868811621 0.063076922404396621 0.067878128023692308 -0.03331497860680574 0.021523622710189715 -0.31490543788586317 -0.020159037841659257 -0.02385183998984957 0.070336351070870398];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
