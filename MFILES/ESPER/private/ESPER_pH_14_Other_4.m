function [Y,Xf,Af] = ESPER_pH_14_Other_4(X,~,~)
%ESPER_PH_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7817031854763500931;-2.387909006232759257;2.3655558122311322045;-2.0048936954579681391;-0.69045457477737604002;-2.213353519781319001;1.6371075492994995315;3.0378588145550491362;0.89339526537672442341;-0.81369632053985307962;1.0260156634890487126;0.22285821098866728796;-0.47496139862164471479;0.30025930694557445566;-0.33269907540507409616;-0.44858437882522378404;-0.27006965128923138275;-0.13567394802142290766;-0.27547384754167897336;-0.55541193582810499674;1.5217977841199694655;1.9067461699555319221;-0.52011532738915089435;0.25757236497026370081;2.0650611259892488469;-2.3689336583792695023;-0.36572921863439178392;-2.3091248838668017029;-2.2063373887899233594;-2.758476472962040571];
IW1_1 = [1.4807742881841492455 -1.3172205347513312734 0.13409219182075365895 -0.42818202055991300137 3.7382930400821376971 0.39336906477376515356;-0.35421800950828558063 0.88137154480232071663 0.71020233285230838227 0.74355280305605653268 1.3553035651803162498 0.69265781674499027343;-0.1160789534313583643 0.8173755949855729952 1.3341832171719785194 1.6219991640072703998 0.26935613356912768701 1.1190700410462111059;0.42642091128862391614 0.0098903033126010054393 2.4715584941433932364 -0.71652019954438195271 -0.34476170077989831686 0.29829057716825335689;-0.32112438804975801387 -0.15182649826798352843 -0.74760989190327453713 0.87774748463565788192 0.8219308588540897853 -1.27536036054614077;2.2020542045579238888 0.36176560933941886988 -1.5636009428726855841 -0.25266719858237496332 2.1372868578489017111 -0.39090562034163905958;-1.5556744744023158766 -1.4973687087838345455 0.52057198678395488756 -0.32266822953643226057 1.5135670090590738202 -0.88696573434559888849;-0.31294708194350406849 0.52980546980834786197 -0.014769506032369150716 1.6886692976403925304 -4.5356709113119357824 -0.25202898950178859172;-0.47961050129615567794 -0.96406471382480007914 -1.6463012879012377532 -0.2748571837827636366 1.4853713600710631848 -0.20228750625435545918;0.23033620759775660924 0.23698479010559933555 -1.4123613229239664335 -0.65883964280357765197 -0.11990818697240988866 0.054329259084324524331;-0.21432641226294479875 0.10133506062000408043 -1.0514920963401024334 0.75050373139908455045 -0.27156006063287646546 1.1755868851750750359;-0.46342915844706578099 -0.8495354425202991111 -0.60597552418314837297 0.67380632428751952023 1.1340781004775617458 0.64135900529413281124;-1.1068526023568818761 2.1238486842794066511 -0.39130406501651593398 -0.22864596471832454583 2.2799485990297347904 2.5719321479128538499;0.045196915187704599093 0.5124484818367527339 -2.3550550767258213725 0.87285686508097037883 0.72217350774219801757 0.47675234951408118622;-1.4982174435002610924 -0.66753061071638486457 -0.90459074538145389788 -0.62702247776335617857 0.78859949022289754783 -1.5645432398806449203;1.8543330684049328383 -0.87289812829688684381 1.0284296581967160567 0.39209029141967149945 -1.8034085971657354275 -1.9060025657481414196;0.079470616404033619928 -0.34241613595172470941 2.4189339316797138224 -0.34149350179313980869 -1.3673507780867366623 -0.30800987445453187341;0.2586692053141238512 0.026649914235799633533 -0.15303833340580394462 -1.0896458069550960523 -0.2492272040951792611 0.43406545547562264131;0.97240526176002217706 1.7166177951248309252 0.029596127744809273136 -0.60729611389823656697 -0.1449799473930432625 -0.60149787353933825695;-0.34805932750211199256 -0.83280003972910010557 -1.6584246343742032881 0.8181295299661662801 2.4730620344490947815 0.97027891364646379202;-0.023990345830245771164 0.75238540708935763845 -0.69247721424143793278 2.0413786179344790561 -0.68043665621324811443 0.284141445515074198;1.1520949089090963824 -0.040999583720605331516 -0.2558511052132936836 0.77984310036077364447 -0.42451617489185489163 0.96519532994770296241;-1.3047630073886533619 0.004126468612527419734 -1.3216848978687307792 -0.12261790005414054117 0.12285689145205619388 -0.60018000606761690019;0.20307895235776318721 0.36948318948668862349 -0.068258642641320491085 -0.22060057250032427678 1.9450800755023052169 -0.85863912596120173237;0.095444531826202758107 -0.2930967075262196353 -3.3962356224754040035 -0.32379871819117816978 -0.94881825966931077065 -0.46783142311243830491;-1.3630955840332006357 0.29646537192844807374 1.1081067370003427897 1.0276888899316865 -2.9422999409166781248 -0.76269874644197288571;-0.14865120751734939297 -0.80190345941206531144 -0.3137498894526445925 0.13514687961545926442 -1.1945563907560803329 1.0188525025003345448;-0.14550473995732574051 -0.6096743392170282938 0.12085436098396348803 -1.9440705343889466139 -1.0564897742542891379 0.96513943805847790536;-1.0624633551812803223 0.71093841446545891216 -1.9005577719190178687 -0.20165583964411104567 1.2923114174103507157 -1.2413718531411546131;-0.36616449507771120508 -1.2085410102206683991 -0.20622031334523277524 -1.231787901531243401 -1.8238825336176942571 0.15681082064124265973];

% Layer 2
b2 = [-2.2440915856334209266;-1.412690850762541972;3.439010784203722082;0.04856679227412284694;-0.32861606149367128538;0.911897528402350388;0.21481393296137960003;-2.9516364179816489965;-2.9352558347976631659;-2.0580479597639165235];
LW2_1 = [0.3067720894316864344 1.3069944364346324228 0.46034984727692945805 0.39652010963730149884 0.14027953603358253587 -0.68832715379171782732 0.59077879481225181735 0.19410353409267969149 -0.17002667756861158943 0.26102662910182938827 0.86546717959120533781 -0.211155819930963079 -0.36365193864348721586 -0.57370812589104036583 0.036461205800574179869 0.37268230731413365397 -0.2409803249944478809 0.77412980243234352784 0.44816006961727955504 0.762709577653023163 -0.69497691240476111574 -1.0322168976905503612 0.69436145407694027654 -0.91800072313358749287 0.50516595343445691579 -1.33754117073279577 -1.1337905873938742829 0.58558894623688162451 -0.4361546064337847306 0.11653621520855682314;0.41158800102042292224 -1.3091671907153397125 -0.88009527196402670413 0.88916565153320903381 -0.16272436132523934726 0.2394850604839126873 -0.036428498289421219758 -0.29198950011228941293 -0.85465503843770629366 -0.98574986568319167279 -0.49372724156516262228 -1.1328472478855020622 0.33475750873412563058 -0.41952773488660621837 -0.65090650991318943497 0.39028254079511021102 -1.6333422837434163899 0.058970160269541570253 -0.34998630788552015369 0.76657493318193803411 1.2273282667938132384 -0.083583810745795766861 0.80105194202198026776 1.2095767966688073525 -0.10332700407524629538 -0.0068921784921450500797 0.72947122332845182324 0.57023725474754183296 -0.63579106788503603198 -1.9730953608033743318;-1.4622022547757824729 -0.96876365894309102167 -1.305815867290276211 3.7718439479516359114 -1.5408912774752234753 0.26240628590172837553 0.043184707731127612573 -0.058210918637440572931 -0.59864459971535510796 0.93122499055242813348 1.4987583842660492373 -1.7001454568860634442 -0.1091687829325066611 2.9034417199667954534 0.45606031757259613002 0.65047354382253386174 2.7734436560408766148 -1.7023619683279829218 -0.70455139443257908116 -0.21013714876368844164 -1.8870683231363623023 -0.56722893063004875547 -0.7880961774412552634 -1.4486917191359802715 3.8025746988386823766 1.4623718088362573919 0.92154150486488328742 -3.4323476415426421582 1.2206487541934587515 2.1466702044782115522;-0.17493394351114968654 -0.39229319972551135454 -0.12949300001233690627 -0.38687842185481069457 -0.27187549806724575774 -0.041560396960837686642 0.78785911702274580293 0.17497940890213248277 -0.032052526794948042743 0.45588500302126405694 0.36908120456720600044 -0.011733649578039608008 -0.01835232491766158533 -0.97635378071236111897 -0.11183483902167296042 -0.070479572475157972744 -1.2638789581602078993 -0.39482651662233214651 0.25262852199817209531 0.57890688885357510785 0.38600930485797541047 -1.264510308404505512 -0.051291216127492676724 0.66103945553845111505 -0.94556564367112538871 -0.72815934196825249369 0.15372167205038414495 0.093539028514834782202 -0.72581795231576939909 2.3461485374784660785;-0.2391458276868445032 1.3571255562574762177 0.4785294663450569419 0.66003471557081550003 0.23842108508739362494 -0.18959075523880772329 -0.45702755606993072934 -0.21857644034939871514 1.1544711780625773745 0.44025592345640113257 1.1443163881933595682 -0.12944091181821895664 0.20062939566849563588 -0.20168796678565359404 0.65820908990189885834 0.20890976173395842119 0.83911805512365356119 -0.083230036552778358105 -0.03593633962559001499 -0.59005402053200839418 -0.30065274714381828858 0.59012041843719575951 -1.0402178684755740701 0.086343267067038820262 1.3088950407513435525 0.45946721471916546209 -0.27509834106758346284 -0.14895069420310538821 0.67041953083150873649 -1.0765458572513599833;0.088006603333848854032 -0.72493014856106230415 -0.17761383828931778806 -0.92688448678832002781 -0.29342299743420990898 -0.38696420482808524532 -0.14186315231769963674 -0.14901420920224980882 0.43872938648569664855 -0.36549965833721120845 -0.27169075664688679961 0.082685320317824412273 0.4064727085213221125 0.83717467040977289194 -0.46299966506155809665 -0.24007231587446320464 0.43425348028409771484 0.3396291121054547113 -0.52127693570699640269 -1.3686435273001635871 0.42988516445503494046 0.76082474515955755834 -1.1626009677061157621 1.4492826566906307217 -0.55077302412186690539 1.4449206289147178417 2.3333060281197695041 -1.3424372116572995672 0.74427381023855698761 0.29115155525332669928;0.47990043221845846144 0.57012227770073153899 -1.0513411299843398172 -0.61739654617720274299 -0.4886953385008920292 -1.050395437445633684 -2.1884161219686597555 -1.3880788516180455616 1.8376610825914456715 -2.3174055408410092483 -1.4197474494612458695 -0.67428392917742052681 -0.39231779165081243077 1.8918763028761338418 -0.051211943911439829213 -0.20450607720488972463 3.9983486548978337538 1.5398185796581462803 0.87450216052779838893 -0.16153608770035474129 1.0113116721496957506 4.4504927792207942261 1.351695017801920029 0.94641742377575110989 -0.51688901444801771401 1.4461143847361204173 1.0977896425840369954 0.44241115816397480476 0.56196588305574668443 -0.16503728684465504561;-0.23364509828513499445 -0.63509388339615313601 0.49606262592224398267 -1.0735084665600125309 0.90283242114831085967 0.010119440302400167786 0.12577429687325758501 0.50057685954265751516 -0.4368255515022312907 0.91615222599232226663 1.4249303854535260161 1.0243938482043675187 -0.1393570697216627019 -1.6772855421473311655 0.88553175696916297532 0.10822113401914805475 -2.4518886748553150312 -0.06058851626772351201 0.86017252963158963297 -0.21974542524504397933 -0.88234794482913847524 -1.3254332027395818727 -0.13521119436717299322 -3.7508736831673670231 -0.13858924295180227726 -0.58243795482016891274 -2.0407290835420206498 -1.12742088903142057 -1.8276437433304011382 -0.071368151430927992407;0.94593694581451048808 -1.8390012591882454185 1.0288954382924884179 -2.3963566568544627522 1.3420415612362581737 -0.40264285435547375602 -0.59823955210888479783 1.6632716950961201618 -2.0238754331634796202 0.90964170660328436124 0.98709273304788103243 0.27522817705713131797 -0.47119735856453065503 1.4483347306104834562 0.32971650717348710558 -0.19486984020451092459 1.5784199883817595644 0.80432290970058073487 0.2332020275810259835 0.2309492523897748173 -2.4723111475309806906 0.99735438305971635398 1.0233351488833684062 -3.2559299132245929087 -0.37799689124347446434 0.37122480033158594681 -1.5916023981797231546 -1.3345635273500113804 -0.58429442318225566222 0.23088970988092680225;-0.5391746710493021677 -2.4314816164526038555 0.12664219544874505408 1.522009994008055811 0.40229047559787195487 0.33655346240442080008 1.0670003804672509862 -0.63158471564094942341 -2.3793325921290136016 2.0219440935062196196 0.73512035333699476958 1.453032020208525843 0.31411517662002230722 -1.8880402327523193584 -0.58043392599185072989 0.21046076168744540236 -1.963630521917497207 -0.90980140793892427808 -0.012209802356562044282 0.12522173206839698478 0.83458992368949391771 -0.31823185360001954303 0.073876740345174066182 1.448514344405205323 0.99783190411810407383 0.12635383323278426282 0.62772634042329211734 -0.24812126011391566482 -0.65066851926478697088 -0.32977729006264838718];

% Layer 3
b3 = -0.39395663839740080459;
LW3_2 = [-1.7410730364418267602 0.74791255154903413249 0.22522339088182463662 1.2976326799849540183 0.99552986258721409829 -1.1911697771677640656 -0.31747337913603534965 -0.41259136361766446388 0.48790741752125549313 -0.59151051000059196028];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
