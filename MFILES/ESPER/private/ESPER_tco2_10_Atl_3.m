function [Y,Xf,Af] = ESPER_tco2_10_Atl_3(X,~,~)
%ESPER_TCO2_10_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:57.
% 
% [Y] = ESPER_tco2_10_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3038920880892149;0.53302957623387615;26.261866582165819;-11.073224897002927;15.663859275967454;-5.4560031176136832;-1.3115693956611314;3.3264977759372627;3.6550273884456157;0.30951520801246463;0.32327921675762999;1.7131049673871581;0.6969590488348556;-4.4280972432315302;-10.328600523564972;-7.7110812186085891;-0.3661316196748029;-0.89506132043047471;0.72081423500245689;-4.669103366855758;0.37843145555563251;-4.7157407174150805;-10.964054591338986;7.0547384120120631;7.1522075615193721];
IW1_1 = [3.4281028995493226 -2.4104889345994605 -0.55280148784890737 -2.0592538988565332 -9.380918183690536 0.69987528000957699 -0.41416330054521744;-0.085242230969393304 -0.01862530301158841 0.037135632305637552 0.10021541317857181 -0.082373446978113496 -0.03873419486789758 -0.090316863204261355;13.313582596744901 -3.4199392756866525 -0.14902790712049224 7.0569558215149293 -3.4616116055261337 1.3979128822659106 15.08868586181987;0.30344792393112691 -0.19718597848779332 -0.041719161897690954 1.2342192231312055 14.384892343002019 3.2272687085336793 -1.471320981888814;-7.5013171843104587 -2.4396725950263596 -7.7565665598595723 0.64001377456545561 -13.82815608955778 3.328426077242661 -7.3404319185679086;-0.026683169687276735 1.1017337908263765 0.19505903486570716 0.52629398610813993 11.334843499842501 -2.2136508433697641 2.5048232469834133;0.84427260783269586 -1.0623115316945444 -0.015737554549367566 0.83923834167950739 -0.79887646963742942 2.158244281715096 -2.7063215315066063;-0.40545501218261193 0.29348957405997228 -0.76528987672940496 2.7853347170797513 2.2128003855662555 0.49406773796049841 1.3587089434100859;-2.2645190938061019 -2.0212339884119297 0.67120927247547968 -0.10076234713381328 -0.22407037955457271 0.36666247830736781 4.5518098515228704;0.59908385046656187 0.45058034833703581 -0.77200225215709217 -1.0635250303885004 -0.22845773314471537 -1.2511339071251768 0.5617922008898053;0.69683300959632422 -0.65822164285573859 2.5798586052280652 -0.020559857327531801 -0.049749866397816415 3.2464718579885279 -2.2859083845156718;-0.52834216030957248 -0.91265951061932959 -1.205700342486095 -0.41476156294969402 -2.059100281171014 -1.1535008961740658 0.97207796456055762;-0.11603110900902602 0.63682276758140388 0.22741414390265127 0.72076274310421229 -1.1419430701400892 1.910217946526273 -1.3368610894021258;-0.033928137352885475 -0.99323816454263758 0.48066192433247307 -0.84432342321827902 7.408325438960004 0.43749165590135131 3.6407686915300532;0.34198423552182944 0.24303031429464875 2.3561547927896243 -0.051450044700162824 4.4388026214931289 1.7990491683469492 -7.4564475807414352;1.0785162001056239 -0.47480774050610824 1.9725859375631691 1.9283663087416827 12.447742267393116 -0.89814541749826804 3.0155192844618761;-1.7233295846288699 -1.2444547108471387 -1.8583280737544601 -2.0238103805755263 -2.1983611266849543 -0.22203672086393211 0.5900218785335517;-0.46562074021361222 -1.3608139545177653 -0.69773020109057315 -8.1752283102413621 -1.3502694268583157 5.5575867504462861 -8.0204098283548166;0.13606365027094999 -1.7275345516423612 -3.1524898172164066 0.15880050907698939 3.9601285337275982 1.9144235359316362 2.638414608572524;0.18975731252333491 0.53112387609907774 -0.6685150853407511 0.37728879318494762 6.7385145816849112 -0.24247632132969468 0.52739963349066699;-0.052811663314039567 -0.015319555028232838 0.026259054655608363 0.061034471498466129 -0.031760991603618352 -0.0039145079583938871 -0.056695774448885287;0.17655498176281378 0.45566986148430738 -0.5734700721369469 0.26298339447885566 6.8198440762351931 -0.059584537194128921 0.55651242568076331;-1.7147549427817681 -1.2117077360872646 -0.11467381104698678 -0.59001406939989287 15.195741559778307 -4.2350888456641931 3.1174766470349509;2.8514576725962937 -0.15409681240645026 -0.26409616128227326 0.13192585358865039 -4.5526857935548275 0.12360264940751893 4.2541759609183707;2.0168634199676374 -2.9893209056886416 -2.1783570584193477 1.1833044414606475 -2.9881892530816843 0.32120952315820572 -0.49271698074064729];

% Layer 2
b2 = [10.696574280810713;48.729109485274883;-0.072942082103344422;-271.84767514688201;116.35412778475458;-222.75115549580752;50.093820774834768;-207.50086629435955;-339.01755795112723;33.435672983935419;140.01940949003665;10.056192560861518;30.419502164916004;-93.542245857448052;-71.389530144367441];
LW2_1 = [0.81645757158262122 -49.696060469647101 21.738437422810517 11.813982383420189 46.242158062471674 -28.750830557665623 9.3910185843654901 -106.87993811701413 5.9577238270281967 30.65849213142894 -14.642310442213853 -2.3871919512275475 -38.625330465669819 7.9199718516198994 38.037399195983134 18.980959502738727 -25.457339512565309 -4.9564946477634537 -18.24733181049973 5.2151981102411327 192.84097145697834 -13.061895075554853 1.7075733049492674 71.916748559620359 -42.347074276601049;-47.13168271510726 21.095560155357468 38.097244102737363 -5.4740162291420207 -7.50843670429302 39.216598560647967 -25.142824485752435 29.857724987810883 -18.207676546029205 5.3271876182712985 37.93157192986844 69.619559563422712 19.594602419029254 7.7724823537634657 7.3743650405156744 3.8815246053599153 7.7827563567342999 245.81222750788669 50.871905791148869 -17.849903014671785 30.403042829675325 20.1007045967167 -23.733409829670013 51.774710157096592 -11.422658000329832;-0.079026753593910093 -25.242518319907358 -0.009653525174388302 0.16217258174912827 -0.01118365406600874 -0.084939459959092814 -0.12218698658424397 0.11794331017988352 -0.031677353909003357 0.16026060393689379 0.10505872758918043 -0.21043463361266174 -0.32826974754680066 0.073485005695961447 -0.075140745005555468 -0.031890177160678199 0.013748648916691671 0.030792627841281176 -0.032270054657096044 2.170433519184729 38.597934229236301 -2.0785015847792119 0.026007357740563269 0.1219550013495358 -0.12258122465120416;-158.28855812376437 -73.395597067233979 85.053196337554397 15.315477506750513 97.049345220157988 112.30476155438959 378.96170294504395 -29.538471269715931 2.6290636097716824 213.78106370409986 -23.113496830492203 -244.54189095631958 -109.8586788575865 97.427513915971304 108.15712095961723 -195.92732786900643 110.20569247036411 65.488523533501848 121.861157743153 32.873710448342969 -95.186763307492996 28.306185599725119 -47.209759575835548 19.455145405230823 -43.540450253035829;-28.99240592869576 38.451494931630727 97.863302253541704 48.52028091052663 115.02238866513522 -0.19146555719720243 -64.855659036946022 42.219020478407622 -70.805513504505072 47.006607859845772 62.564047127174092 -97.581998966918661 -6.9969335156482035 56.676794115312063 -55.276255660007465 51.401759732264964 -168.94215013980755 -22.821506905344766 -111.28692052659153 39.391030941916199 -369.82746488945986 125.43961841056976 -23.672543606747602 -97.147756527788147 47.972806479755711;23.950296720330183 52.715505693433869 213.19623546143714 -44.75079345521636 76.179494563470172 -1.744498919049239 -32.52918361465828 -125.08765030466618 -38.961911631839655 -95.229017088298647 107.37231320437675 -4.7778480811939783 -127.17624023715271 -101.66968083224837 141.83270576685109 -143.90423868731025 146.31302717719322 -54.118041832916489 33.993809680196129 -111.94328907613512 -270.5252510736662 102.4318644893817 -101.63622808136969 -74.369908027434178 159.28182841951528;13.077269670287505 39.605632724862218 -26.528721612738753 4.283127749650288 -30.958295839723633 3.4386938715915365 -19.088848921809237 42.252207310384883 3.9105207586011246 8.823657677528864 -0.077586679226206171 19.853292467074432 -1.3399191802998278 7.3014120716103239 -11.496821204567691 19.458642160192575 -1.7211067364319979 -1.7415608840220718 26.344410842160404 -19.282892851851855 -102.05376978577968 0.59537361626103213 3.0535787994419583 -3.6102673419478406 -44.799528518499891;294.88261544133047 9.0427612226581875 -96.284069853965349 42.728062829151334 -8.0558500720403181 -11.127062449201642 -403.46546108925997 -56.815524995139405 238.56471329058309 252.17860213344247 -30.307619060608989 73.916659454384074 272.47048191403843 9.5430481993300109 117.26625322542955 169.76535770348607 -452.95033204418269 52.887207238254987 251.4294378845573 -170.93414267122458 119.61969224288947 314.52921259598531 -140.34246081155021 -145.34077195319153 198.93367858512332;41.141745446437568 7.4022225084555551 -38.300078680138711 -59.865596781339036 71.986203814641598 -29.781538118431051 -55.752978526261749 287.1550097869648 29.400547279568663 71.081859085617467 -20.715290589821027 -55.657862678062273 -81.284540781822244 -59.854288983500204 39.403554662828583 -32.804703536225581 -133.38888994590388 -273.93605641875871 -33.769822650447338 -35.991534327893469 -305.73296052157804 -113.69660745167604 118.71450796324585 195.15513148497533 305.58261489617843;2.2854440064376984 -0.074431370827241133 4.8875510568175509 -3.8960602552199308 3.4505091463765667 -5.2367649116852482 -3.8894212160111183 0.17724157129334586 10.912215476045633 -5.4956603128781634 11.271687992029328 -0.14246483212316657 3.486338249988024 -6.1652209613458746 -4.1417796728786103 -3.2580720837849251 1.8456094421894909 11.843907607157265 -3.3042036354786619 -4.5528943446002392 -11.323337307168842 -5.7933468584543606 -8.5692369673982984 4.7093497450942374 15.390119528975669;107.09116504145454 -231.58741106771922 -79.226419590251012 -16.188858227312689 -4.2679901891489154 53.856497088110181 -35.39173135546455 381.01779402576824 19.623049509707858 7.710057876127701 132.51437773113599 146.80289526554523 183.54671608406787 64.302605415013673 120.45498164917305 136.43158095853002 -26.121594026478597 -127.14689940942552 49.343251667412872 -20.517864731253795 10.949117602205877 390.52609695224993 234.16129182837764 4.9229661838029557 242.46980283601368;30.042947387574515 -29.44224090973027 84.499318173513998 -68.748142402606135 212.55686946788632 -27.516181797967008 -26.455342792944496 -138.69499515621965 -41.877415643892938 -74.41458268039294 -3.0830222569200383 -35.062986966715108 -21.973058777899972 -11.737774393324845 -3.6670732225410698 13.676784183198448 -5.3885242250369236 48.18318202269402 22.454614956178951 -36.76267364112045 -1.4116480076316809 79.59818359236013 13.12973002466885 14.2921932154148 -26.052935085352544;-12.755058747606745 -18.594344938402916 3.0568090167828648 4.9865198997427855 -8.994521210447683 10.430052122271501 17.227867377656651 85.314908510271223 -3.3334966892105045 -5.3933345201883505 23.917177969105534 -17.25168669317345 -35.756180594013664 4.5597599855276405 -12.928328424972424 12.484459870316194 9.2488849712212229 -0.83113618527655786 -16.152999984211558 120.81363535827552 -64.288032311333282 -194.2294812880736 -8.1290939068791292 6.9490662859847649 -20.996829019863398;-3.0283004092572368 -47.682877276315843 -54.689121416229248 -11.489070971331737 77.98519019934551 -135.04650406849947 7.2864063860980783 68.150047175624451 7.7062434044649297 -4.3406085045504375 -8.5327705274239438 -56.79192304873748 -24.536089853039808 -9.8053472696990021 -49.782492253360651 -14.668211669589907 8.1181243111502432 -165.08719448596494 -156.4652894292424 -0.44044310421789229 166.73544393710895 57.413062565145523 -10.277625358181391 52.589838496961491 30.931952539016102;22.686689918387021 23.752082024964128 -4.9659221299223493 -13.543550504608802 -52.444692162278535 17.609080616517911 -54.256132577754947 -28.347545069528071 -16.054157885430019 59.917577036268298 -5.4247365322583194 43.862156312177511 48.075030509675507 -23.328760037665724 -14.582467527359325 8.3382284439372008 -14.079888813267205 30.700711646093573 78.814649577166236 -12.549865856785114 98.09497199711025 -128.11647513949362 -15.174714072148422 25.795046754904622 -58.14872775679838];

% Layer 3
b3 = 11.12289021226815;
LW3_2 = [0.0023623513116343979 -0.0011822046404839249 4.20772259438181 -0.0017337034059368998 -0.0009271025155094374 -0.0003178589352615445 0.0050824697042543736 -0.0013714578479195689 -0.0017344743769030771 -14.434391250363667 0.00075821721942346848 -0.0049778574036502083 0.012255274972943462 -0.0017456142211161681 -0.0052164851397026972];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
