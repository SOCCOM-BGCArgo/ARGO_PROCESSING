function [Y,Xf,Af] = ESPER_talk_12_Atl_2(X,~,~)
%ESPER_TALK_12_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.8404439741776235;9.1629122484613426;-0.92046146155454345;4.5574732390313706;-0.26437066636342732;-3.9170587918642235;0.76934022597784069;-3.188254496134002;2.7594726118810131;-3.31253632812692;0.77129929326239366;0.30993406375642074;-2.5379069360185804;-0.48798588543595273;1.0991750219474488;2.1787882363811981;-0.56945156336299207;-0.79291361459771503;0.36871083717384989;-6.3284805897717415];
IW1_1 = [-22.110308595744932 16.520149522635428 0.51710700993939474 -3.4307636468129878 37.068960044673503 8.4690693595545916;-1.9945487207892041 3.7306094727768033 2.7242283515555208 1.329799013891805 -8.2650429716772855 -3.5880707865785473;0.79745660823972497 -1.0528648989798581 0.7969399068809796 0.71354321432299916 -0.46549429091539307 0.18482650275145773;0.27627438909829549 0.76397268467372681 1.2596795957063731 2.2288554512777576 -8.7791591038556955 -0.46411082232986989;0.40365527596770528 -0.21494501024425858 -1.0310098168686093 -0.88330556275554262 -0.99256309840045653 -0.84179019874623517;2.2970732368680262 -2.466072528779204 -0.048964675098575328 -1.2407018578112459 1.534351689813604 -0.3008007379390063;1.2774162540190646 0.14791720708558001 -0.10303594541869315 0.25786276636833105 -1.7430243922761133 -1.1236327719903547;0.23425908798606482 -0.6317649614006271 0.27749962361024078 0.35074336937114681 3.3168018725013342 -0.48735891192051484;0.93971849603510205 -2.8102993158962755 0.38658998122982596 2.1692992071755142 -3.3701253166343905 -1.0267955621088667;0.51069485110291235 0.78639273800213272 -0.1325454114067465 0.59661698662253371 4.8998632268901385 1.185968840447045;-0.41007456458698488 -0.31026344493287522 0.15568548041763886 1.0684862745785997 0.50619209530828746 0.53397079998830577;-1.8402868950374063 3.8199377371847523 -2.5804831354534317 2.0911663109724627 1.6639413492133186 1.7056770779009121;-0.34986906490275965 -0.62353291029819446 1.300088530259101 -0.85767039352696828 2.4718273177946308 -0.14653434949794264;-0.63526258713727157 1.3237248478553691 -0.66032350326843636 0.12791449726666615 2.1276195544062353 0.90179434662375502;0.38104268698097271 0.59733217285465023 -1.3615354271914359 0.74589859741674425 0.40157847936252622 0.71658823559477547;1.7339853268186822 -0.011451802120611507 -1.5009510237480135 0.14139430057912797 1.9968851535139005 -2.3107488392840523;-0.39049109448057007 -0.67668809734611812 -0.69070028418294405 0.31810936863674949 1.6554703482128301 -0.36473186092946192;0.69759772523669894 -0.10242902285594922 0.13089389346765729 0.53153727973059106 2.0479110081205389 -0.38052186718298669;0.28374047776325895 -1.0980153924021103 0.72732272071266435 0.085627832496107087 -1.747151023088849 -0.83860756885534304;-5.6379791190850819 1.6776675984000493 1.3326464618886735 -0.36404598583376163 -2.5235904884727258 2.6224911412088288];

% Layer 2
b2 = [-231.50792390100349;-179.93231953196943;364.3415289418574;423.3797561459246;-1203.7180201306683;57.880501595510388;183.30852137524457;431.09506901271499;-1217.3519011242074;1129.6575661440418;1.8908493411718927;-960.83956045600132;-20.855494138607867;1617.1824827195599;-400.03961777250612;1996.0996933372585;826.21897830259218;274.4179950574466;-108.9140181693989;-9.0831619082787718];
LW2_1 = [-79.874210215399472 1579.5767883724793 -799.15282181744806 956.68543656678321 -2051.532879183691 540.20745142172143 718.36936216369907 2473.8674730586854 414.60182822476975 677.11808284015979 1734.007085047336 1428.7996523618096 1818.7457066266027 -162.61311851911529 -666.01732864942551 -145.21563156304055 820.84883590994525 947.36354865819385 -765.11081227480622 -1426.0581236731314;14.97176706389182 42.817554482444123 -52.499693812390326 54.496947337651804 95.430863006330782 98.651779209558384 -26.237327868326645 -72.954085874921248 -26.83924186384834 98.293115146031099 116.19098501372389 9.5241004578316382 8.8910235645230884 119.82211584214545 70.853784054391056 102.72379021749127 -91.778499130099362 -50.464943759662027 307.3795370275509 -55.996366531184734;-9.0961413056085938 -27.416639736217544 28.827242767693789 78.347903960298666 220.96091311656144 -222.62464464828557 -21.15601288243279 -226.7983290499225 214.36153131970028 12.876661476281479 216.48986881610028 318.96006243946442 -917.94937380091631 -147.8384878524779 -957.43375199799482 -230.95990977713035 -236.42406787172544 -68.608205899496525 269.90935704820146 -124.74534214412002;-7.6793970184367559 -16.292753391400247 5.6115622458199192 53.106211992255929 -40.045997984760611 37.108001245487664 -34.201111177776617 26.355004955426544 73.467750522785849 41.551932589377166 -76.35359964161799 22.290517509544781 -94.90384580619866 -245.3590401467429 -87.240388489385623 -256.0934080083349 14.749359867052453 16.153242852129011 -296.42342354744414 89.115222031036467;79.252637795809108 11.451926378986187 71.801966973630115 -47.478574636034431 -507.69691540977061 487.85692698486815 -367.19109131392565 107.51591177272127 -53.902665400761833 121.45711936432389 -1385.9906520168008 281.07704369858612 -4.9504280893577208 -1341.5050620931056 129.4882080188905 1054.4270004369375 -446.6932244072114 -83.456408453880996 -1416.1059699607579 2.8893563887252767;-40.118636643352097 -2.6452289519074239 -6.5680323062595525 2.7821384987353617 -5.2678182536258822 -1.7675830730670494 -3.5091160596218289 5.0445992193091644 -0.10234422242702856 11.945541947205163 -4.2063987366103053 1.3105380726328881 -7.4532805296120506 -3.650979754796889 -4.2524389203062922 1.8429766248581105 -4.6904736501748463 -3.5856309994566864 1.2646985804303363 -1.9059390202878428;132.03407231131285 99.681397440171935 31.297947486347098 -57.946766750392172 99.427371838826744 -83.027705344260852 27.171844007682267 -67.588425059381422 107.8618244247978 180.68052286585279 27.205934852085431 9.3616577713586722 622.56808019322921 627.33712737623307 528.17654830235267 85.581208603133405 -83.751948133280479 20.633751497657013 593.19213309215547 482.73252870667227;-957.1786564805916 1052.8499994767242 26.674138587835749 -84.310215536584479 22.604615484563038 -206.28996878732301 -57.5058662783917 -295.92959007008187 177.72635716631129 -109.45706847157788 -104.95093754035869 697.80077034145495 810.80369899715379 -529.40297988748034 849.54470166546616 195.49894688931812 84.732065343435991 86.28290382890971 -365.84561770414143 508.28839039633885;-219.53853482344977 -21.612062971540794 -163.13796532187519 -5.7284787262693193 -425.3103206734138 145.76187107910403 118.96410178580109 110.48017716732694 -100.86379342612869 -27.088072985512014 -88.508389972954348 50.087369889350583 468.55644870206197 654.44960804103573 614.90775514083589 210.905994706266 -89.101926521443517 -167.35929506779857 580.74541053684095 -1317.4346768570974;-317.43283107204894 -140.28811720094424 27.683805972744928 -0.42171581750979986 18.367534927024472 0.048591484344672281 51.142376516982644 -299.30186683319408 74.873699854112672 -88.118798818092742 234.58016307218395 151.09610926928593 -132.63109127428007 -100.2911419132261 -216.35186665121194 165.78352530507388 -35.705881900164087 -104.54373422864839 -32.405740489255024 840.43042353551107;-0.086480253866224599 0.15823246639649602 0.27188355987080803 -0.10174498639452413 0.99756243153478708 0.2394542432602117 -0.096237849712218757 0.41317245570358901 0.0075124777309507861 0.63498649678049934 -0.14749370372457493 0.080406333298594146 0.59652022470606381 0.2781924464234255 1.2683010226702636 1.3417910750774511 -1.2965253676192237 -0.52571857693257684 1.0075049012616311 2.7640614673568744;-582.10198766687961 1498.6539224304663 31.63809316255076 -32.542714865534087 92.802221975473998 -79.321863667206557 2.1618774830315539 6.5010127091532102 57.805123845474078 -188.12157653435699 16.073897433708517 33.969941293037543 -65.908300819881219 -174.33580108853758 -56.622322648475908 72.156680645532234 -89.416755270670023 29.501593061589279 -263.02564049966099 170.42428411357744;212.50972642460493 28.475948652110191 55.064025467245806 -0.27507012203809683 13.592569757760099 -15.062857871117364 22.562456655942633 7.9050747134642059 44.092283479308364 -23.97269645232031 -15.650399733352437 1.6305612075488145 28.499218655334353 -25.599356065904583 6.6485808970204481 7.7950153679921375 7.8969512431172069 -23.139865116967769 -120.11593784312781 193.78063769951325;-302.88487415941586 61.512690852999555 -123.21176926833928 83.380761780303928 114.05689504103499 -19.464786788440044 -20.192775109167105 153.62907508355909 32.875814466363892 74.298454802150815 52.044074208618511 25.039064329873611 -160.05451600118496 -355.52927471307652 -153.39538640659237 62.213944813054368 -40.907714702097969 -239.40633878363181 -227.81747590184094 1265.8167946535636;411.56017538060706 41.745803147270834 57.599035616838414 11.361940138349761 76.954932540314545 33.200904945704032 -18.76917288652902 121.32453978033153 -1.1814093552567935 -7.6659906735944867 -20.50726881210117 13.833334954924775 107.59755146031486 64.339584153577917 -33.53382637615681 -204.43944409261476 -290.26505292622926 303.50710032490622 -53.526419431172613 -423.27352373958752;705.21538667784216 858.13067204535469 -153.04625567224394 454.90477278937811 -836.76121663486288 882.45634760358405 82.58491828473862 1981.4947459453726 -1934.2136180712041 -138.70172448517587 -965.06461472826516 3.7648337489073445 1421.7579437916306 3361.7407900543585 1380.0185222233251 -500.89499858209268 391.89302136184881 2057.6504219196604 1530.6917520008819 1539.9179524817109;-615.45308066544771 366.66064911642917 400.70817750266963 -208.30104339973977 637.56607877069496 185.70709943923882 -649.14561725005956 77.586090551962357 -93.493592644313935 -18.435243311925003 -193.73093775406284 -85.065748383634642 4529.9863214809429 302.01588952533501 4565.1735056836187 325.15575060133409 161.65745627892358 299.36604131329392 -531.05583514151772 253.2317893312204;-680.46425827344319 87.617993848417186 -311.3208796424575 108.44271471168761 83.710589622085465 -146.25062077852289 -642.20833836872964 250.8186874268568 288.37171395693883 -192.43930308816761 157.50519435553684 -394.05175850721747 -142.76552628784899 238.13428288943163 -309.1446654233132 146.43943055621315 -137.21553398641154 331.26082961311039 -604.77997583987349 -384.87970778474556;-26.190240028608528 -2.7377680946386529 -6.1453965023937709 -22.118375243081633 -4.4766122870449658 -8.4382904598475417 11.887158904771329 1.2650995477253639 19.780587947074007 -23.110905026768318 2.723516434641605 -0.99739792775367608 9.4711211167442144 59.926200137227859 15.751932176921269 54.366897152033246 -1.6634447235146117 -22.962601960619729 43.871262424448048 -54.700755915100331;0.069204129095764552 -0.12919775376344178 -0.32506700686973045 0.13403085687457078 -0.97962810031126391 -0.17313522363514153 0.32430558570736701 -0.53594669331702005 0.054579812899378709 -0.76301087495281184 0.19588091236585428 -0.07390279101335602 -0.54521048718997667 -0.030961254029620387 -1.1671145699118353 -51.033437576577761 1.1740331977787526 0.24840608232614789 -0.76294876148521396 -59.65319280271499];

% Layer 3
b3 = 0.55392566291253598;
LW3_2 = [0.00094252572380373455 0.0019491008956156002 -0.0026378834904151158 0.0040902195123250478 -0.00064110036875915204 0.0056468411050334625 0.0043553987814566042 0.0017168633873640936 0.002055276512784053 2.2881674217125414e-05 -0.79475754917760122 -0.0019372237949543518 0.0027813558112230073 -0.0017687037645659509 -0.00048239037747567281 0.00075694083346936926 -0.0012935356387962988 0.0014837522913266519 0.0022063810975414123 -0.93935856111300642];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
