function [Y,Xf,Af] = ESPER_TA_3_Other_4(X,~,~)
%ESPER_TA_3_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_3_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.6273957304370210153;2.5205034058456021739;-0.5368517652640640847;1.315667512249386828;2.2564194983249818982;0.027809638501439144787;0.79242823553449004415;-1.2466476033193887307;-1.2822413621599648703;-1.0021114447610190989;-2.9026259950225155038;2.8944853882142282941;1.5563252350538181457;-0.54687252618116333203;-0.025322099340364400549;-0.31933241190940259147;-2.9271162314489709289;0.58705317006150603554;-1.2596757497083657107;0.2382492488661259733;2.5363613731643108729;1.4895332880825455923;2.2918915602458125313;-3.9988333802507471937;-1.0319596754622946122;1.5739450172172708697;0.12358178436678135537;-0.094946909816654587178;-1.7993138367727663507;1.7172543099843684544];
IW1_1 = [0.065128007427715281508 0.44555428486593479098 -0.77722100723078524354 -0.26169150116108430559 -1.5142180979446249189 -0.72884191275599852222 0.83131588921102816947 -0.53983326791145624934;-0.19787175714260890613 -0.085111499110981189697 2.024968425150984519 0.34578285577213024871 1.0620453327486780726 1.7918957978671532505 3.2850860810911357568 1.0021588845847406724;-0.020951823761935696455 0.13887062702681182702 -0.40222832548327391855 0.22199669646642949949 -0.79250849331800532482 -0.59881079010476756519 0.085690611914999284537 0.21151659056542410076;-1.1323970919997619067 0.65472375916651792682 0.10969591640764377038 0.10218017202692127043 0.93387934252534621216 0.22639437748525090277 0.13472221206480211597 0.68204934277196627157;0.62494627062131258288 -0.19498594990889603351 0.038954239593999191726 -0.16779578435701841821 -2.236160112992297222 0.24035166542701633108 -0.99990518390863825093 0.13975123950995976818;-0.5697938369927454394 -1.024734598484459358 1.3353569666461462262 0.94391120982070819689 3.696013347670993987 -0.69040695795100293086 -0.92274776510580258648 0.42045236348504971824;-0.26817385011710209719 -0.094383180380442244228 -0.87584957666770524298 -0.15924976493327411275 1.3379956245154069894 0.2252833855902104665 -0.13319389740338505312 0.44777470643679073703;-0.24034208310022370236 0.70939385530685006298 1.0039480794143105236 0.83496471558062324014 2.8770617313445208119 -1.2560021572663624401 0.04172437296379453292 -0.033250577492661463619;1.678791896924859417 -1.0564420013769053597 1.1774673305807770163 -0.43087294988756297265 0.1899044964026687099 -0.97748564929603043439 -0.56769367901705303225 0.023160598007005497867;0.042066038816039826032 0.10935243116002309194 -1.7832620572357176236 -0.32434533952606608986 -1.5069533673753541247 -0.80331935781328722701 -2.6392715390414167587 0.11779085140873538085;-0.52224966116954107953 0.45918447459606986927 -0.69358057786928706268 0.55744264086829919957 4.8818966345230103698 -2.7520003263594396969 0.25136550401864682369 -1.0471104875631351838;-0.35452867810037724805 -0.084185268846289157407 2.358465032616699375 1.3739243033739887423 1.3237209299701293563 -1.6297635597381066042 0.44745563414069100538 1.6087935369175820899;-0.60582419588046265702 0.38401683795549390599 -0.1979100286073287307 -0.64187045466483605427 1.4316262872583140897 2.632834235457044425 3.8905333667476935666 -1.7673454223286004794;-0.31548260669520322708 -0.21554619892269824555 0.017345267539486008967 0.13248182152775236919 -0.011930341714144287665 -0.093713715060811136892 -0.22118898563800137858 0.48940178939511891354;1.3208251211739330255 -0.34314337836741704013 2.0047292940264833661 -2.2154513677685785389 0.74037874032005646097 -1.9713428194501081414 -0.95227509704442536709 0.054376906127197074947;-1.0058485001879773346 2.6024387581637129507 -2.8681939923043158203 -1.1816615379546646647 1.7976276481514885663 0.72434776315604409991 0.42038100717633675174 -0.37205631233804914437;-0.051765863754454286005 -0.44416704437883652856 0.55270540949131319319 0.22025370923707962567 1.8732771602553488499 -1.7687655183749146914 -0.037538351916302011013 0.36779903305316086204;0.27881293160984094159 0.052192897901609268396 0.38805576220921511599 -0.54668051591364663633 -1.3070464143661579826 0.16220902221065658377 0.34636495060368899246 -0.0033835062007737228343;1.6390334080063266864 -0.6935139618074855905 2.4058119037412097896 0.22860113216477462306 -1.3023645492974640359 -3.191407480814046238 0.2817530968834454641 -1.1629224807323874646;0.42922838908391547363 -0.67004686378863520524 2.4881877277822952443 0.83529313888149847589 -1.6494889291981997825 -0.38985147435553313411 -1.0102039869131931304 1.2558214244899021939;-0.28807584119098389452 -0.020576977438678565463 0.5316585435303813334 0.11170259406278768011 -0.52496607201891465344 0.62036596989964332138 0.27199162964657924713 1.5171121518782195725;0.42156790118257070343 2.1789062161891834535 0.41092638049256280386 0.84035925354054363812 -0.26476150970005174479 1.6478771414211874635 1.2642768788657514634 1.1372535774559169308;-2.7340827587392801945 -0.9628559279828031725 -1.6314760624610156192 -0.76278336332116292162 3.9472410034788230071 -0.033082645508040693649 -0.65407447096765702899 -0.41030280978417060789;-0.3013854872578182742 -0.9631366180554308265 1.4120004634458966919 -3.4534976422750216507 -0.57851382043227450591 2.9537545252338803792 -0.3657402401613670806 0.85010695449480300212;-0.11611531471513361624 0.040572188451590281144 -0.30463002392949378727 0.43519192058254713151 1.1029570134086894573 -0.60404032248110306469 -0.24176207032104016226 -0.3969645981399924084;-0.70395683249294427331 0.17953546017542648672 -1.1519175832792580838 1.1606878701879372873 -1.2599197328338620494 1.2363129675744410907 0.15603631374458981629 0.33308486524116764915;-0.066519540789062081565 -0.21871020447214795102 0.21235148907549375452 -0.21074158437904777497 2.7585114418024048177 0.44665865592982839649 -0.15900182263477993794 -1.0411553849755796897;-0.44690736435967098883 0.65320569294384589476 0.13933651794978516025 0.37894894044529847665 -0.96162741657783235016 0.8430900749785902315 0.29279510589497609319 2.1625634325168787697;-0.091509035468202493124 -0.74853173418240626091 1.747402435167049406 -3.0418175528830300181 0.88241466074683494458 2.3131917042482093017 -2.0552582252128259732 3.3246363128848011037;0.34858430646470900394 -0.90420446147051813934 -1.3491128487185271023 -0.053733065310394415026 -3.7261356886266971955 0.72684426592173745352 1.0899252109979242764 -2.1890080120558192966];

% Layer 2
b2 = [2.140694826368485959;-1.298278798049438354;-2.9328491801820018026;0.5252002945429752323;-7.9793784630018249615;-1.7491828030396101568;-17.02207219618941636;7.4256299971154264838;-22.376068265359041476;-18.224765052848681535];
LW2_1 = [5.6389554331383173746 1.0354667912286323883 9.8760057201461872722 -7.2768062153186070518 5.1066548227714951835 0.76355026239253054321 3.7487586181579439781 1.2517674579014776981 2.0441813159591344373 -0.54985207998881624469 -0.83849568616896419382 -13.152074533215339258 -2.4534757916751130935 -9.7076136589730293025 -0.78459683039793415293 -0.37704700388474698958 -5.1320193491684289455 -8.4779319877102317093 -1.5142330105131212026 2.7181319588196992676 4.1030411718757138217 0.15728543465160169101 2.4920351892803456195 -4.5143292244629433796 -14.559078127823212867 0.47557326747330025407 10.12745289722967712 6.721737269943587556 2.3315191440150395685 3.1633539366704224172;1.317834703925596207 0.47286940867965371327 -3.08614081722351008 0.16829801921437545498 0.76389276605570599621 -0.12008163048832028175 0.78273103721982728587 0.36813412248003707372 0.40513496687164879395 0.46187453003858952583 -0.12366476001263235207 0.030605858738816021924 -0.33986176201037260336 3.8222813079227635491 -0.040482107509372325382 0.096130300523856168637 -3.472374171753910943 1.6439190760933934943 0.33311230572638861336 0.20297673591320380959 0.87551547478468005892 0.1598957491342749837 -0.088375818423876442709 0.62734189724648770081 3.0310052560463356386 0.38595399124344192954 -0.58241078186285832885 -0.39918686966480887435 -0.53503069565159477872 -0.29957201560830387654;-0.96219872342288126355 -0.41388335418182553571 -1.4659597733614773141 -0.34006550608411101333 0.49354798867459320766 0.14133212263817329646 -0.26765073969681191235 -0.4315185458855987366 -0.26605268710779805819 0.2461930579484054582 0.39934321692549423766 0.50145066631766244125 0.79555759292575478625 -4.7662751564136511817 0.064794981898557285627 -0.41930855075278267163 3.0599810322619793723 -1.6932035163577714432 -0.21984427701220432549 -0.27417761491411218877 -0.43637471889085549526 -0.25016243321793074639 2.1719369952391565093 0.60145327029306627775 -2.8059521046095152741 0.34987614450792942078 -1.791473383587246726 2.3584410475204493629 -0.49716794460564212033 1.6819309234327475266;0.40074736976003355604 1.6545479217321799048 1.1008063296071732839 10.977478374992475807 -0.74029854201191025442 -3.5326483329210462969 1.6328402959716477039 5.9492463330325167092 6.1333287091412644898 2.1587303935618704642 0.95496399947519539086 -0.67027651421296763345 -0.93523462805775503526 -14.065888392217866354 4.5364464538110205183 -1.4313960643133547546 -2.7814882915570899868 -14.848000474064365406 0.095537300217869242092 0.90319761294573053245 -1.1496791391093923451 -1.8627704408744212294 -2.5472682207233914298 -1.3147906865869727344 -7.1846801291502488951 2.6152204404800962756 1.2186188234796351271 10.766251580571102764 0.94276446490382137533 6.4997946620729081246;-5.5506177558711344844 4.817546344649832335 1.8801026161105263146 -5.5024810601763336493 1.8810430412889962426 -1.1256672867877690614 -7.3334059945709642037 6.5369192892675247464 -3.6168256043491178175 6.0453819669068709075 8.9222043342044550229 -7.285490196110156802 0.21873827674114812436 5.2988573514849974799 1.4802726028906887379 -1.4851756882264532944 5.5641197752059392556 1.4241719676696085184 -0.062407882705061923367 -0.83162370834909238315 1.6958496196077779139 -3.553243514727044694 3.1117285774992766711 -11.12078046662813513 -10.14062306875589492 -2.2230858442868646208 -8.2104014245167622477 -1.7311154774251522603 1.8825167105461049211 6.6269775277227180865;0.63683688037130026238 0.23507872794850082077 -1.0678773471221398861 0.47099740463480233021 0.68645040479205876593 -0.15857245977983458474 1.6232766353047269892 0.44712634780359561404 0.4806170966301099301 0.19129728290656808354 0.0080308957695144379818 0.22008904370957033114 -0.19319088238668330471 1.3358438799829996935 0.11998512834979808972 -0.020097969945018761412 -2.5954910628294682873 -1.4999449556118802374 0.29372794666549673082 0.37435199565896160045 -0.11729740106675301536 0.09937893136256285842 -0.43491431678281572415 0.69071411328485943226 -1.0304562789532578648 0.14562952086067842972 -0.079567290572181911812 0.40932969276184894003 -0.57343897014389588751 0.19265809987947354887;-0.31569066216129043623 -0.42764724166471101974 1.7110024360452391612 2.9784808870340695464 3.1757909081383024485 1.6557767215234804326 -1.6484490173452066575 0.22502003065686784766 0.70832799753732811343 0.27654765087449600935 1.4676106543931013437 1.4933162943719773263 1.9230535700364908003 -1.0316848209881108733 -0.75984285562611308951 0.053836381013433409759 -6.6405652866904016918 2.0448112644763729584 0.91960082719652980199 2.6721564309878749199 -1.2959641379303792341 0.12431466389510599513 3.7172737713725787501 0.23612396538136476432 -6.3167026062649620499 2.2146376229839761507 0.13695867498344929669 -0.86972883907326525854 -0.87291887581948290897 -0.77268212231404698187;-3.3223707294919968547 0.31640933923253028448 4.9768796246523896443 13.460218596591527529 -18.928882887966071991 -0.12856231906890389083 -8.1538762706335639052 0.75309766697286817383 2.5125126727805890958 5.1988448197796595096 -5.4150275979973025997 -3.5873370096768684157 -0.79648758206100112034 2.1694671827848135415 2.8786899319663903363 -2.8693995756937376029 -9.0608749416101179719 -7.931010999360343483 -1.8289879647516651406 -3.6298458346555788623 3.4617698831198229215 -2.9004959837243036169 0.39024832903487399749 5.464498865322504173 -1.692912701627705907 -11.13786894926725779 2.434048855446159898 3.4131238991632395496 -8.2030295322125361679 -3.1783216120600790155;6.0469731299483395759 -1.287245860743473802 -10.158692974387660612 13.636486877378750648 4.9728131445234078356 4.5601420539230517193 -4.1897928989692845292 -1.3808144175396692699 4.4197628472257592946 -0.020262841027940306504 0.63517003951851636057 2.5964629498710367628 -0.91253308441266312023 -2.260616063035008505 8.3798589010716160175 0.57153077883719904939 10.408232421824102687 17.474048695486949612 0.18386428689245282175 -0.32262740775838349983 -4.9834305672852794444 1.744066361656221531 -1.0808799062268359403 -1.9522294660016787926 6.5633264943355902332 5.8102432796344087862 -5.7129757373213383431 -10.261125762256479987 1.4369496034641859872 -1.882126880565949012;-3.8233946270621705921 2.6846256437360844771 5.6526493441824205988 1.0006450695796962336 10.414829983424873205 1.4954164113291505966 -23.633247111369538374 11.86138366828747337 -6.6123645115053450994 -0.78251101682401402737 -2.7043352085222531755 2.1666937403469628265 -1.8451541551444217149 5.1275607976246897479 1.0487279298945022532 6.6605433815262182762 -0.31334862341829650134 -3.2666385800158552755 -6.3200174097394334893 9.4202382740657224502 9.4633372836579852105 -1.0384890304232730074 -4.5507808600794650289 2.3061524105662920547 1.4785015436247141984 -4.6438606992053310663 -0.1039374132542387752 -5.5972099058325150978 -0.94295551629057461351 -3.544215675939469179];

% Layer 3
b3 = 0.21464871774289109863;
LW3_2 = [-0.035324698401699251848 -0.79502607947446535253 -0.17144694731461282422 0.055334960586312917363 -0.016420447902710022525 0.77206264172429539538 0.052288732934217346804 0.0066900953785432037968 0.053185175514394868179 0.0066164291701906203375];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
