function [Y,Xf,Af] = ESPER_silicate_14_Atl_3(X,~,~)
%ESPER_SILICATE_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.57906602016212427309;7.3376087838944403785;4.5618038174193831225;-1.2828948522736181026;2.6954043785180736847;-1.8294898558444137038;8.6247107411002659205;-0.37544986777401556655;1.6805357802845619641;-1.1197909394891780721;-1.5377705313217997496;-1.7149667449280630027;0.62797676619988440638;1.3336077030818178635;-0.82225121164859737988;-7.0061918744811340076;1.0546304032624242986;2.6188686067979523031;0.75457340710862708111;4.4430074399357151194;3.8487801801655074918;2.5404747837105112751;4.0661775214319808569;-1.1773063453025385261;4.6913609491238128513];
IW1_1 = [0.065175602647667418843 -0.11626856181563516301 -0.054209077861322792213 1.1696993978881882192 0.57832468155572336332 -0.74001796235914785171;1.6360635923463842101 -1.0751365690040668444 -2.6062456961674982381 0.23105259621261411973 -5.320301576971025348 2.7959152353369600696;-0.39968372568527876787 0.20019229667496377112 -1.8934901200278262401 2.6736339510837829891 -3.8906513685558463678 -1.6721846392643864299;-1.4498010874024664929 0.75122056537209802585 -3.795868266270280067 -2.7819540486030938098 -2.8019489006261442121 -0.1512954184053736939;-0.46867929976546590654 0.98696268152032329279 -0.99797384738774408408 -0.44092129999482643221 -0.62659922279905577724 1.8885701566368628956;-1.7323309042049046536 1.0048622992169475854 3.1001561910550372581 -1.1432885008239606073 7.9590297344813967229 -1.6863256424290922197;-0.095158496320125671164 -0.0031232044637155538871 0.044501272860614969618 -0.95760582686924744511 -12.453934292662770744 -0.06989561713832739831;1.1967402917861229561 2.0780960588259191901 1.0927259457499247652 0.96081663343080092599 -0.83124881382718562861 -0.10749531886734309261;0.01117253445029381051 1.8128582064921079375 -1.631418570871467022 -0.92875647152862317313 0.55001782396509379947 1.847729317543032268;-0.14311157696403586925 0.50222824994850367997 0.098219125069084700641 -1.6135418384260900027 -0.017906086531082804347 0.45008537210173338305;-0.045604882884220654393 -0.12548570338209261155 0.6670460460007870962 -1.2009685346208633927 1.2834479874881177253 1.1118770535321405024;0.10715391080637486076 0.4088060717671839206 1.3799082477537560898 0.41711808707969943999 1.8672310541239443005 -1.1764149073901166709;-1.8689265769706240317 1.7723415307911110084 -1.8808528904290324757 0.77101619062473758515 -0.8103982582550002256 0.84436238663382912062;0.21377479156243606173 0.055620478376158445644 0.064990640590397538712 1.0371895191484989951 -2.5390591915104647747 -0.11141042920162266827;0.1143392800172908369 -0.94276775061768680608 0.64416181081828316479 -0.58140881312175551887 2.1224507818026108197 0.82821889636093004583;0.057910734675018935014 0.14634713548949190853 -0.90236403723597358173 1.4056455842064399242 10.676372559791406758 -0.80067546797445710016;0.93058322355404388126 1.4493125132608868366 -1.0906612400426127785 0.64664898425342975941 0.15628753640778766942 -1.4337059105965972439;-0.58264562055763258197 0.46384037219270202179 -0.24964041154782160015 0.15146164549817198175 -0.45376677215826843881 2.3726117168621416731;0.38935245409454921628 1.3755188179511059765 -1.2727701947725504894 -0.11031608797943298628 1.1369756837016491424 -0.9024622829169747229;-0.16003200395448663462 -0.023616356326143457534 -3.5052596291252648975 -0.024148330396674147491 -4.3201508818884555296 -0.40186143114067712778;0.83460179743903695204 -1.4801528778607502268 -3.0247624846940821541 1.3711749928003720278 -2.6844682986549637249 2.376034365796417358;-0.70455887922792692635 -0.18049886857001637419 3.1043050975261956559 0.66573262741751737526 -4.0819618143192748505 0.14049217627319504631;-0.33299410833151665834 0.70545903229059481188 -0.02386183165547894891 -1.1906388530389915292 -6.2867650261945824397 -0.1723629673050654787;-0.91631678560782314769 -0.54403507642635084984 -0.64373237240635816647 -1.9271162039566789304 0.71282166104075761481 1.5103138384742178513;-0.36641815092422480582 -1.2473156335108821491 -5.9719667120259023463 0.0558094834590139241 -1.3668488128277576088 0.79607778076247992516];

% Layer 2
b2 = [-3.9086826361297348775;-3.7392592080900501905;-0.9320553074774803326;-1.9823902005390667824;-4.8839753110559138705;3.8797318372670526188;4.5418522092102850962;-0.88597797428038060907;-3.6027580074618668071;-0.88594193046528002533;-3.3506007962878805451;-3.0609268247888405945;0.16668224241444110079;-3.7581988756595525736;0.8080633938658714488];
LW2_1 = [-0.24744793324088121267 0.19628152101202459012 -1.8682247587349181117 1.7903690880733840185 0.27537530889321126804 0.73724008415717812159 -1.8798443891556246843 -1.5422312108569740108 0.19592342091574288521 -0.13236309996665540645 -2.6214151892912056496 -1.7666428824586719593 -2.2635206900449063028 2.7326146186405075866 3.5013958944356917691 -0.21588241642342625992 -0.84072168183610307413 -0.21264393224212319033 2.2404480788893161858 -0.3759505677440890814 -0.8144372496398830652 -0.52008802615552818249 -0.35255805069553891595 0.29245712115167699086 -0.20841774421096226355;0.41067484514889507352 2.6262169454820716297 0.98349341369997334006 1.8437474859712987829 4.8949393934590075261 0.043315100040814707993 1.5414288590239373367 0.54746039545319225006 -1.7440086996156367594 -2.4756013188200589603 3.3573729475958535851 9.0423164436272287503 1.4538820834409524885 0.26312211015880604403 -0.37945112487560139769 0.40842998873360375489 -1.7098188224494998977 -0.31370959659826636035 0.41008335565410264367 1.669567123843216816 2.4851971633161058506 -0.25924287754468233747 1.457006020203597263 -0.488364956218521995 -0.10683344568003844133;2.9732520001477142912 1.0277242867299898332 -0.75038510329108265573 1.5207320365660101924 -3.3743318407770295231 -0.65256940132159502177 -0.010533924293764342778 0.59694563955155788282 -0.3629968897955031526 0.57379834544563723675 2.7824011782191253594 0.1360042637568166235 -2.6755788798743584955 -2.3374403688379610244 -1.908799289197380622 0.2829707200877352169 0.30313224532710381087 0.69983792536862243772 0.1324594734476325919 1.9281251872884253018 0.94742672146008721779 0.78576472960887144836 0.077092753652282200449 -0.84885283290004753809 0.0036278428487775066583;2.725837860229418208 -0.48404249531915999327 -0.36321237350243756881 0.22774227911592045959 1.7057294481304319245 -0.56038551833991334661 1.2192966581647319835 -0.50457081004386339362 -0.72273198414452566318 0.81036158463259644336 0.59337428339668640831 0.6679587462117200225 -0.8887174068510450553 0.10555555923662349183 -1.1401112260690182687 1.1100705641794457179 -0.13314959521745642346 0.33689536450704304915 1.8845567031790209089 -0.36566696301092332932 0.07898883267860386248 0.31663138837327109432 -1.8251923226141151257 0.090380284427468787767 0.66513067152351013078;7.3740188885679174291 0.28901988217948532123 2.4411228917152079099 -0.3244755480513512591 1.362774414018829372 -0.2293468871338563142 8.4728665872370925172 -0.079963925763550394721 -0.25032245791378499034 5.7540501738191194292 8.2825897585048942062 1.4707449345131355933 0.95383443499834486001 4.741550753127350859 0.75632078115554790543 5.2498846330619590717 0.31367967031915144904 3.0319794780200575168 -1.7811300923137440844 0.17396217279827269619 0.53366464739453978172 -1.0384927953719103044 -2.3206847707003475101 -0.30556371145693655977 0.51127380214607087705;-4.0996432976378285318 0.21931205093252900684 -0.67016947818097916123 0.70245267052108362194 -3.0876258706637980112 -1.0407278335906646749 0.46916842460080981914 3.2776263395119138444 2.2976912772744748636 -7.3724118428182032758 4.8543116931041723205 1.5940935686637902613 -1.6937853905842887858 0.15021202823374935065 -0.41539753993504391349 0.28933296342674863499 -0.77850418623856831868 0.067537091228515019892 0.11804064224594548738 4.6241885787780185879 0.52228320482020029747 2.0837144743837887617 -0.25618378166811178742 0.21362662947652519274 0.078190853518977185277;1.6949986985082101665 -0.028752494261327091879 -0.76599779158693159786 -0.85348521930660981027 -1.8369866356862889489 -3.3733555618632125039 1.5495132840010097386 0.45871616109357216118 0.39232943822532490019 -0.98592473638457467366 2.6806367854759440839 -1.2504794068452205202 -0.40968065283372157026 2.1694644237553442068 -0.050065366422048923623 0.67825919718145255555 0.38022112004327035528 0.10596450713412633449 0.0019366536355552264881 2.1477290856603126201 -0.1551144593797681992 -0.1260054014739720174 0.12988067413168014053 0.17959159575833089084 -0.46899298949794376856;-2.0147666914497577295 0.0051374651012554284346 1.1700374026155724305 3.1540534668029724941 4.1676646593343500413 -0.40037056944354532106 -1.2153315949601815049 -0.51177640125520118541 0.88636436384465211447 -1.7489492847588492541 3.6449389512350007791 7.594811688237334657 -0.83772866188736716531 0.38490916230554039767 0.40504505068307739002 1.6154528922373796451 2.6112162156292710868 -2.6790261058716864362 -3.8388500107009888573 2.4831080200876693986 0.53941523115299194746 4.2491824485823821433 0.62956229149688358593 1.4789218677523725542 0.010080507673724210804;0.39417808287935096612 4.1306963513769483498 1.1891333175216665108 -5.0450851218340986293 1.9946617380384934481 -3.6466343512028842611 0.47239377154099282397 1.8247466384576511711 -3.3857512164842238356 1.9085723598143500279 0.95604892811098851624 -5.2865015003308499786 -1.7864091568564466339 -1.8959797948733887463 -5.7954026225728467736 -0.26545673975851996618 -2.4434401096486295657 0.94660137601856741973 2.2837782037152916104 -3.9956008872794419595 0.25318164425148725893 -2.4919597721271582458 -2.2665230411107071262 -6.0244339050376352063 2.5512299537927995985;1.9073748271256791842 1.1029560434973828542 -2.0725875447027233278 -0.38745780203181240386 2.8202788858820246887 2.0073046661248166167 -1.9879611351269228514 -0.92953963708135534105 -3.5465240066400878227 1.78743035124440941 -4.0495746153632321551 -0.11127369862377857468 -0.55985247925823911075 1.0197042659421919897 -2.0804873829310195354 0.92070892116782077075 -2.6320982748332588663 1.3078447610429544401 1.9232160952538208676 -3.7209120984406909294 1.6557311916259607187 -3.3104870445765772757 2.5559079538574831503 -0.26500655216656227031 -1.2019792095476395932;4.4618576810819217116 0.398156282692934127 2.0052615878260322546 1.038986757788848303 -2.4226943979164698995 -3.7352184225176063848 1.3888616164524607566 -1.9249343588515572812 1.128628567349313494 0.10501071894325508804 8.4358281096748193306 -1.2653843614310953392 3.2082454514420626346 1.7368215921561109827 1.7247936035818398626 2.5749222708478658461 -1.3784141930153452904 2.2360588239907648322 6.2849606787723280021 1.4680995759627082364 -0.60736798416412507429 2.9545605025522165832 -0.086080498523090215324 -1.2400629475794320289 3.9128303534164126098;1.8240922360395293023 1.2242223769547064816 -1.2941235203979613022 0.93792646517356359492 -2.964832033513663756 -0.55887852298419915531 -0.73819238651171015242 0.38776820093670172351 -0.61883318846233703603 1.9076484593645017807 -1.4836879027849600998 -0.31353037669199018689 -2.4492828512468438618 -3.2727333137564471599 -0.19776627810157434983 -0.3859088643803368357 -0.50871597337711260689 1.3583409680707903 0.78967589069801991108 0.842724242563962056 0.82700876737384299009 0.2729323055734605985 0.16548917947754326896 -0.76103594934849827514 -0.14689374510607972057;-0.55560991293386763346 -2.9048040411551863116 -4.1527893430860753909 1.5297888688539726942 0.93130414378465353753 -2.3225281689491805714 3.1309152946756575453 0.18527746576171852388 1.7574625757667825532 -1.5980992427405520395 -2.6025239548630789699 0.033161633301101223203 -0.57955525291755249917 -0.95656431834631816535 1.2169851475717330391 1.7956322503303829841 0.38443341099566152863 0.35626951580259741403 -1.8784900343723156535 4.7721357191297508749 -1.3696778658374464399 5.3199415272139463084 -5.8419856404246441883 -1.6476721195956207655 1.2187028217637769778;-1.186060061127251597 -0.47275254198610117129 0.74328638110930600469 -2.3910592924092326506 4.7514921362833284491 -0.14402943078718852266 -0.74926445422521625872 -2.5688157850760733325 0.49404746781000025146 -1.6721374025425579379 -5.3462268101613883431 -1.4558042314228651914 2.2099591862013356902 2.0853208295874869904 1.0333984073366291323 -0.055223130639703688072 -1.6088792742922262136 1.346338082781256329 2.0448519410908470029 -5.5612227811443100123 -1.4841877998934478455 -2.1317032450869302096 3.441513421677146134 0.30217113071351470177 0.8356666128283268824;-2.8185121464292679505 0.91071811503752952976 -2.5679836026853606334 -1.53551491061136125 3.3372414053950283375 -1.7283865219141487657 3.3342619242428397364 3.2855670406335337752 -6.0425727532456905422 -0.29753270791432484543 -0.27302701038265964062 -2.5707712222362086862 2.2462699251717928028 -2.0166747398697055793 3.6088336749708669338 3.6161613304764248511 -0.27571040545918790166 -2.5687908333212212675 1.6924512610207524954 0.78562549773441292533 0.87043633736857162209 -1.430628398795589673 -0.2136609133571740482 -1.4818915225614459619 -1.248287913990716147];

% Layer 3
b3 = 0.17510389827512279348;
LW3_2 = [0.080016412959647925662 0.061458467622393889163 0.43272719842059059747 -0.12234424069424466863 0.95155790590881594859 0.062257150004589263681 -0.16391078496019909072 -0.07947583463306381879 0.024351201965822903694 0.034206139673933239065 0.054175034478155359441 -0.47268956564161535017 0.033931027345131231643 0.08522304963259171029 0.072993137041636318996];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
