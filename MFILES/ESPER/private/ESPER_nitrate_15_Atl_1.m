function [Y,Xf,Af] = ESPER_nitrate_15_Atl_1(X,~,~)
%ESPER_NITRATE_15_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_15_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9990368112386325272;2.8078654346579487999;-1.2227550808469336285;2.6550738019151864933;-3.102840573436577376;-1.8707678791194131129;-4.2004684373795697638;-0.18207707379519816326;2.2686442991057207408;-0.88938812485974905186;-10.500023870440040596;1.7380963389073680325;2.1067843491276803114;0.37902949052279760744;3.5052203399243699877;-2.8569867271649598273;-1.2623724820250206147;0.54763472488876541178;0.53723160299351691016;0.71507417522967564594;-2.6715153621066116685;1.8063923403700241632;-1.4002073186941397243;0.59439911740716799837;0.29527726730512859898;-0.31763096268725060645;-0.23719914960255791825;9.3481897539419698262;-1.958724923462719536;-1.6096869159289495244;0.48132200325606089297;2.902609915069444213;-0.3850969564061824113;1.0804170296036259558;3.5223687263490419674;1.255854580072208071;3.7003068969403813959;-3.2611333520401410979;2.1700951071231715517;-4.3633434813833122945];
IW1_1 = [0.35518655728481407508 -0.45159488082075094351 1.6149925908665063723 2.4401135391570716315 -2.3965158150090153377 2.7812451282559331744;-0.19919287471475094486 0.23825192378627077505 -1.1278381751468837813 4.3776652241350788586 2.2164260696033988296 5.1445374934336713935;0.19793663415240164705 -0.12714729806508856536 0.54234938570477220221 0.64523669655790116817 0.67155677210390418708 -0.00065661216019416847149;-1.3068003685233977595 2.4841515290728146681 -3.2489959645498749374 2.1511642985365591052 1.988071434609352206 0.65402200933733856125;1.6007621086194105953 0.24354805868541196112 -0.8802742838133584824 0.75363100408399630314 2.7093750131353742105 -1.5445368320731627243;2.0374365097569260286 0.66247015257140340339 2.2139839573092734426 0.24106120712245129867 -0.22460763509784506531 -4.1308878669245894244;0.28489240886143774034 -0.25811318840882202519 -0.43904690887008129829 2.3118934670128150621 9.2853989655123996272 1.1894644041956285996;0.26901242207946174378 -0.23242790174122013314 -1.5392056232980377839 0.76137962268692638279 -1.713302884704692497 0.67657285465350069931;-0.59414702441645650399 0.11836495474320381238 1.2333495952040720578 -1.2275104652641404268 -0.31405971822610534439 1.7092312544607015656;1.2897221776545690908 0.44629853031588645473 2.0109695594670724539 0.026841171324185703062 -1.2144464897061690856 -1.3984973221642986729;0.47010263905849203336 -0.52018600645527390824 -0.75728568822586561637 -0.076024071983550364773 14.00476027858756467 0.24783319397531905492;0.79017831896248291734 -1.9108428122259557558 0.74793086476045000932 -0.82269090892018947869 -1.4223371740818231412 -0.67213587748280023693;-0.78621928962123699414 1.0425426225686376114 2.6651466740681519774 -0.12393535881314216018 -5.6019396613330965096 0.26239742375126984264;-0.36929172062969567447 0.24494977096046952059 -1.7081315667967620353 -1.5577012769082387855 1.3269881385693411691 2.5177866742561567648;-2.8541417521896770282 -1.6291873170985529118 -4.3009549201297723187 1.1408363441476965239 1.4831103561831637805 2.1233479148475429277;0.72969561501515034507 0.21041119168705368914 -1.0896811570962399163 1.1673334354439854899 3.3954616343936190326 -1.1033988392614493268;0.017699119297726093047 0.012025031218259108964 -0.24934687702935362519 1.73562045750567151 4.342109708334514373 1.0148790493355870357;-0.3308947129576550461 -1.8861567063807365141 -0.91093981874986085234 -2.5844011534271391639 -0.49974554544539362411 -1.4464944356581999063;-1.7495845971053627377 1.2838456131483784173 -2.692709651713399488 -0.038474147402547780039 -1.0258825818502206317 3.0304320909868871503;0.64518310540116485807 0.61404579468294140376 1.2024940160754131746 -1.252550588493129835 -4.8506614101799678807 -2.4286448519966503667;0.19562443564355763703 0.12733861552245312465 -1.638605002591829729 0.74501438468508329738 4.0613947790215894074 1.9856883491148360488;0.062561928839016442416 -0.47452577900023162893 2.6469056892622448984 1.0428264376475586683 -3.6804765783605515317 1.2402893925991516078;3.2224138465737439674 1.276115842690568325 5.8125541098628108472 -0.69441144400802268244 -2.9284653763848011998 0.39169694658615716865;-0.28510658809531003177 -0.33056699148470714 -0.50913549129542889915 0.72498025865986759353 -0.53735893424161107479 3.7536972671589294848;-0.013108304131710438872 0.049786755193304201017 1.80036370084812547 -0.51378323222565114303 1.3099385655536803785 -0.42173484572494335243;-0.13900909939936650916 -0.13067754597010811102 -0.085055690382877538469 0.21924505509724506735 0.39914141853753287714 3.3995289513068271958;-1.1267429565632633981 1.2742869553563287432 3.0333597160830136907 0.08562535002174299914 -1.6956390254432649467 -2.4760857567970346871;0.3811218632455673494 -0.35105251541650472902 0.48169103432511967133 11.884799315807606845 3.6825501851530173525 3.4937900484001525037;0.44702026213928930387 -0.80479990026826631055 0.67735110288922451005 3.341766756271619343 3.2726000319792514226 -2.6145811042091535725;-2.586383768232974667 2.4333862130708800997 -0.9343833554023749377 1.2461567028010485103 -1.3076159198929822036 0.13965421425500657016;0.069532962027239408886 -0.29648462194365599043 1.0224177745663627359 2.0643345015604785964 0.42169634536726852136 -2.24018920795890919;1.1704787750298033533 -0.62032042951186083801 0.3553304129381947285 -0.94006585618252636039 -6.4377982035493817037 -2.1924521715652880438;-0.02360109734825915212 0.45961814713851029124 0.95529212654185335918 1.3512828608055231783 -2.0610624617194091002 1.8723925021786556044;0.11960186738048481092 -0.67589280466007484183 2.6218890324189372265 0.78377254559091946717 -2.9338198824084531502 1.2059128127746581161;0.19968367293182351374 0.032068646806863707055 0.64100630250292467416 1.8134283108612330171 -0.45701544285365852671 3.6442945209918264915;-1.0028303056523051318 2.4071210150176951537 -3.5890244709881038432 1.4844921942116318103 4.0979593867151145048 -0.70096992082557896264;-0.041880823537310971072 -0.072130589860685323522 -0.11946821317911807125 2.81540002260815303 -4.9088934591786745898 1.3116290681915212524;-3.3570949940082415175 1.1814863243361390932 1.8135246713220218862 -1.2784377934569444157 -3.0713620939494332696 1.4147532672220468619;-0.408701500281769603 0.39662870706693964529 1.8525999053871879951 -1.6291470855702363529 1.2750730207245219994 0.54488626385077210124;-0.24485731879421879231 2.1279568000732047572 -1.5729135081986183042 -1.2871849786357627554 3.7173537696628065063 -1.2678922852045610981];

% Layer 2
b2 = 0.64364605022057708172;
LW2_1 = [0.39139668113155978713 0.16797013317133005494 2.0872420453916009642 -0.14219250721074158661 0.5664174712010446866 -0.31512509887203082881 1.0571620014911726759 3.5478307648920330841 2.2399238655880417959 1.0365930826177918167 -0.48727557015039957289 -0.48763199030147930113 0.41500227129856409602 0.58965806159151257226 0.25647237030954683767 -1.140966753805545908 -1.5914503093890428609 0.060543958657049749827 0.16832059661565115793 -0.43688268682044018032 0.77910416637158963482 -1.9704996269766097416 -0.075126432075289087398 0.95364638034169657566 2.5079258547981542193 -1.5344241459318999077 -0.15376864170811660459 0.29675381649138271589 0.18554336826880313271 -0.19354826938673144743 -0.49186209104377515144 -0.28039766153857603737 -0.92924336245579919336 2.1686841690683498207 -1.0043911506982485804 0.23368265390044812291 -0.15088412242311841083 0.078706143003070758168 -1.4109133287585287064 0.30598041480248616697];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
