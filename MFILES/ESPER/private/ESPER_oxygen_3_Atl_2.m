function [Y,Xf,Af] = ESPER_oxygen_3_Atl_2(X,~,~)
%ESPER_OXYGEN_3_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_3_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.016397312238224309028;0.63303359140036963293;0.54097002151246764701;1.3699957582762769537;-2.2962190519103660158;4.1042619377840701134;1.2133706825024688225;-0.027545200459643391644;0.69302662064451125978;-0.73934095061642768343;1.1083822277628787578;1.6863799463330226835;-0.3827988389533376612;-2.5011314479034965075;-0.91372464407743703152;-2.3244698767905354053;0.41337359228442693837;-1.4058810632642075866;10.349232168260458664;0.076960366711395958306];
IW1_1 = [-0.69921059432424781388 -0.19511697938446820322 0.71212026495121771852 1.2644508188485090727 1.3119127337872555916 -0.041249127652186474979 -0.40418967139316680504 -0.3816702077136593374;-0.062276445259083393347 0.23155564276773116239 0.0014767374409177579184 0.16108571933074933291 0.47221794079563134128 0.89955283723886803049 0.054041448598043773099 -0.030342964652983212687;0.33348646729767933428 -0.30222990119094306216 -1.0549918103389159807 0.4311566032744032495 1.9570120769453365206 0.60527317279931536209 -0.15096742698846718489 -0.36021043674413588676;0.21086022488137029507 0.38650945909543038548 0.020249802119037124681 0.35617464037837515134 -1.6625895303373479095 0.39864029434546865982 -0.11814538125837126259 -0.029417777487165851918;1.0916769041874632151 -1.7235340700197212538 -1.938696261525252984 -0.80484036347691934044 -0.97612443196678388979 0.0063519311162534477372 0.50969848597849576333 1.88928940243186827;0.13880909656803475105 0.65001043370359035123 -0.1335592663215497411 0.019683572053886932984 -4.0062349867921573932 0.2764474161055901491 -0.39737561669593524094 -0.083707655225797733545;-0.25646542002939115568 0.27550565211989103132 0.038882081099481907716 -0.66680288276510546464 -2.2204881867587977773 0.068274954897114492613 -1.2695754658923099623 0.85257159655529513032;-0.80710490729068273819 0.61774654994388888962 0.11308360265001621281 0.6000587853846013342 0.125930455439633604 0.22827986892468354885 0.68965106370246120893 -0.21400739916139083219;0.083795171876234308961 0.8060169654601677669 0.16452748420465238 0.7583578058807873834 1.7498856849662385304 0.21291531791175755117 -1.0366776917061897301 0.72362013925311530205;-0.37280824475002255491 0.20527967046490197545 0.36248966396109549848 -0.73899845855725865285 0.44946511723826576556 0.94058512747649158925 0.41817529653424906355 0.13830803126194152197;0.032999930815573279286 -0.47006733683675294699 -0.2023315139345349678 0.47565049817471904969 -1.8146215981495719127 -0.90148230686247199372 0.085408382633350835023 0.40427855573635707032;-0.69671942967513988965 0.5046542472222826925 0.55595802463250909575 0.64614375394134104802 -4.3635576885714213446 -0.28274388116972010154 0.77442783850242036259 -1.0060966874922558922;0.12298566957755611984 -0.071623116219878671385 0.024117572498631188738 0.34182946041798895065 0.50386489166318693123 -0.53012311293629166276 0.5054272237004920898 -0.32993403905374774077;0.021695646286265891922 0.60500226009105240177 1.0929291737531334761 -1.1050223768767355459 2.8548067864402604243 0.47471299556526702634 0.51232142994132778835 -0.75723978861937346618;-0.19972770426941210964 -0.37862409157487825206 -0.14613477152365569878 -0.22079291546543652891 0.89907973866955315234 0.35002496520958209514 0.46371335437302385607 -0.30976888354272091863;-0.13522832785855593007 -0.0086723535343016782545 0.74313247109696423109 -0.53861209801087528426 1.7119634678148545337 0.32698565480761582203 -0.30469775276617144799 -0.19757332972693064654;-0.26071862050214866802 0.65275249332802764979 -0.21126932157993488781 -1.0479213165384635431 -0.9535342437643271607 -0.14910372492769638497 -1.0149980777144156363 1.3277579751050923029;-0.40494582006582002798 -0.91102207752883990199 -0.055175904685001213312 -0.81004404712066335748 0.70806140656412008827 -0.36407668197357284656 0.095971627959990341017 0.29766726939504256633;1.3842825525745803272 1.1838693925532457474 0.78940059131344986199 -1.5158019996976896948 -9.2473718462913634397 1.4741397886123475125 6.3452656129219100478 -3.7363638495921778215;0.42379420671662221265 -0.60389926230703194765 -1.1298443373290827374 0.79500095970902806553 3.1412339511708875506 0.75423417604772868827 0.23563781648242054789 -0.37804067349110564988];

% Layer 2
b2 = [-2.9277974707248644037;2.6522822330068041019;2.8621614352859112707;27.531397603961117682;20.966694928307937573;-11.929330618766163852;5.5905221366297803698;-4.0413281044548750032;6.6646136486611595728;-1.5940744429766624535;5.6794628099143169564;-9.8999812993748292911;-4.3938353890180561478;-6.1647230152838199402;4.3263518133898859475;2.9546534828188919519;10.848188529853326045;-5.8569561054489067686;-10.029492536448087137;-13.12549046441520062];
LW2_1 = [0.74576972491736792659 -18.073687170642735111 3.5609449701219881845 0.31060879289150922222 0.64875015145879166845 -1.0812672612454059529 15.7900264453576753 -5.6170829973312015326 5.4126007154908295504 3.6969050710142892235 -14.368824764670481642 3.4528285744517748235 22.310370120343868905 -8.0887855561969495 9.1478155937849869872 5.8683391154608868234 -7.5724753880136184137 -3.0644427349423764007 10.773282970934776159 -5.8893765672151010548;0.98478547295335117084 -15.588931345133763884 1.3478152057498382632 11.561110115383188557 -0.85539122236615494632 10.339855904264599218 -11.366930719061183908 7.0446157137794918057 -0.42691397077041109975 -6.0638602519224029663 -2.3599608993385801092 -3.3640406459984024679 -9.3879273666637441664 -3.4322065132844112867 9.4721061077736710132 11.662269117404292729 4.0260129718933468368 0.89509256126612146698 0.025572712936967990222 -0.85067458338873780388;-7.0597266760025965127 4.8728709922766544338 18.608338297312531751 13.499291892203041598 -4.8491704798863439763 -14.000946324459544456 3.0257179505246849516 7.0053707862570995246 4.6269190113717169055 -8.5412702269312266168 16.571057916624063466 -6.9976404076610352334 -9.5660050901208499852 6.3608137788643501764 6.2850168159387260758 8.6810510151195625639 -9.3494612196038566765 2.5340037754674327175 5.5219801329539697221 -21.198989742727508911;0.90019977660215710902 -0.47345493067322197422 -11.037853844611456466 -6.1260240629790496669 0.35499967227125295288 9.3769567131216238209 -22.68584098873152044 16.919452449141282102 -12.64442301716481154 -2.4973060154731907545 16.220153740609795534 -11.924764146109971819 -45.916834142115121153 1.2931686323838853525 -10.149596336266565544 7.95594238986038782 3.0935639789559319368 -9.9818517995343434279 -9.8928989140317273865 -4.0444002751063470313;3.2647426103950270004 -27.865499025988768267 0.82866236197006448716 1.3750486946986215653 -0.90968878330264080212 5.6084377603256028166 -10.672734855867142656 4.9928607391067991728 -9.6522522936525838588 5.4096848309106206898 -6.2704367461815673224 0.14983659620396033718 -29.053953225457341603 -10.243500227327713148 -3.5797581602764689812 7.1055569098384836479 -2.8281316095534743127 -11.169809513341192542 -3.5615919554644479561 -0.9688538917601151601;0.41360060105539092623 30.300895198177581591 -3.8091081669149864375 -14.499108378949731701 0.37526608448030912557 8.6519698868982928275 -9.2679921964286169356 -5.0211999738358521483 10.157986486395211401 -10.756412204534502308 11.209860967904834439 -4.0884933654847941398 14.796319202306072782 10.717919422231577897 7.2817220633815145092 -4.0221719752472457898 15.417117869212031422 7.1739493499094129092 -19.421392030529261774 -3.4567617673711072968;-2.3829043392250879307 -3.794479271349749272 7.3131634057040866281 1.0637365061976888914 0.65232229359924787104 -21.999401200614485674 5.1687869853970624945 -0.0094291453109677774574 3.1167652650388455449 -0.43189370135998678135 -1.2086566236213802661 -6.2348199907509975759 -2.3590309097262407434 3.6477811186911250907 -7.646395289660913086 -6.7577458888172907692 -6.0862096468109889713 -0.77948354053815371856 3.5410318061890002639 -10.473119517408603585;6.5813620325875072936 -8.3840522476718675193 -2.0504270560915642818 -15.763721359936280209 4.2273085616005037224 7.5272783634079418746 2.3778182744838574081 12.883703854955992796 -12.228069518213649403 -4.6032016460525637669 0.33077687340032857488 2.5559545014307971655 -11.526228880630977613 4.1124147562885839946 -1.9829905218171932635 6.7895160993955041562 -5.9554429432726241345 -18.180380433311977839 11.323518123111036005 7.7365988580089597448;2.3574463853115177336 13.363322220050987355 -15.53850069571148218 6.4734537446549289541 -0.079430289041867094268 6.4655545337704474207 15.842863942135331001 -7.4129313833471321971 0.1840074075564651912 12.662105251766217151 -7.5647162471197484379 4.9350340616029475527 9.8983157372119681128 -5.8232515778250615313 0.06072955739592607316 8.3562843476871275783 -7.6685211824462751196 4.1043494851075639218 1.9577932117183911576 22.597326250592523422;-0.087219472921206228633 -11.940876338519666788 4.2866055495048582813 11.147697593775086844 -0.42983879423620530158 -9.1211391770549425928 -5.3073497060718306528 -7.8475999613320839288 -0.24836636323534697079 -0.19441660756241610497 1.9766939829904612846 -0.31360738819406008826 -13.382625367797043481 8.7422678030438678576 -7.6794040179454725603 -7.2647761092233453795 -2.1235708752255813003 0.44148026393749645324 -5.745985327748825533 4.8983181795103725165;2.2588430243711483669 25.801605818083036326 12.181638066207133519 11.576513852945463867 0.99301368604468343015 -15.054674075592695104 -14.145966369069085999 0.3680878763410003196 -6.5637755053632016455 7.7353838446134925988 8.3697900801718141395 -0.30648725558047085205 -24.434141291310965016 11.030497936557289052 5.2582325484591621034 -3.4336457248285774391 1.8919210767044927213 1.1981400624254276988 18.574789184051756052 -7.8284724224165138651;7.5164753600943710055 5.6114880406035920757 16.201896613124240787 2.8563470649131930124 7.2542315395401555378 9.8924629842698550419 -0.1150461745412119513 4.9934984312299359743 -2.0461929967264773644 -6.9727037102631843624 14.43540168476533303 3.4848295008095133696 -3.3706045311020038646 9.7614626247815667881 3.905850142256662938 11.639841408578456949 4.3298577795418919933 0.19940898310739646471 -1.4676517488553904034 -2.4800370005675191898;5.2933944246498469965 1.8931231802988266466 -3.1113039796533841219 -1.4118967339179731013 5.9978766174295454761 4.6666967331751605386 -1.1545261818837593282 -4.5673753386318054481 6.6826062630066980219 7.8139320193006573945 -1.4415108496725037579 -0.18324386686503585375 11.399371631996700671 -0.081391805923915303 -0.45148615300853239818 -4.5134105742249444049 3.1059462486571551842 2.6091672110094430437 1.4978165546176511747 5.2177100229302215695;1.2819310066897251499 -13.297527278535163475 6.3835081125280277448 -9.4477891855137965393 -4.4722971020092252559 -2.202113647709576405 7.5408384661485516887 -5.546082587231357941 0.67731452612049436457 3.7231868824931826367 -16.731962508518581245 5.1184729222016551731 27.1126872083131083 -3.6408127570988639832 -1.6680876819594814275 -0.30242883219608251988 4.992423952036125101 -4.3242224905392951939 -1.52563920839490752 -0.73298686447150296353;2.7231408817172071402 -24.471202762472273662 -4.7982503681508603677 7.659315320809755967 1.1117084961632592854 10.504886950236423715 -24.246201174595135797 8.8156214408984840958 0.14169177744462066459 11.103184231351949762 8.0609885527843179176 6.7662983010759711888 -36.533515797637733158 5.501729711876963691 -2.6936538651327821547 -12.559390524418532209 -5.1801240153189134219 1.5781721064801881305 6.4461887742833399173 -2.5018415490810372859;0.45931115931326127466 -0.89675392558675848242 3.9470293088628989331 -2.5664033461045021589 0.24256660620392106464 0.19516237522993670761 0.0096366388157170003448 -1.1048888628349982088 -0.99650019184875748834 0.89114351524059798315 -0.22485620516560902993 2.4536996495521052886 -2.7286730095496998239 -0.41088368298333066697 -3.0180119918801060486 -1.1692786913078294653 -1.0217644588043759413 -0.89695393674762669001 -2.9413396585862283672 -1.7052205499907908681;-11.580804580396408809 -9.897317634397261088 5.7543238720743365988 16.946782216930127873 -6.5852010437515717811 14.655569362363563002 -5.8516108933819603877 5.2189135838291065284 5.5618049865832430712 -12.369935233594391732 5.5381147034633464443 11.478810705552328741 7.1602805821251100937 0.10917131857658124439 25.832488935715304024 25.389108845552467386 13.726534166984833973 8.971537960720516125 -7.8788567772224924468 3.7728085291880448793;2.0734498113796524521 -11.88824787989189069 3.0393548684664635218 3.7310853806362556107 0.49272402061836156895 12.925646911813446494 -5.6912252009873762759 3.968880658281225049 -0.80719269544270211281 3.4628148738650987859 7.1176559783353070543 0.1415983019833257639 -5.4091783031336664322 3.3550942659036686599 0.65720749194611316479 5.0438791702165106656 5.5682085588891325756 -1.3984773077372860683 -1.774478908054768489 3.6282128356585214846;-5.8361318202660896759 31.043452625847553605 2.6935763632845208804 -19.023276954608618894 -3.9177772741187069094 1.788172477833003482 4.5703680297209032801 6.9779954544789619675 -5.6338034388605775504 -5.2228937745760655176 14.453497365295882915 -2.5010197384266725784 -13.690865340329109401 2.6146329064511348861 -25.410624889730215159 0.8256041419949851079 -17.134477523018919243 1.3190014371546825434 0.033540892994558639539 -11.880585113195987645;-1.0461097904192486752 12.022213738257329751 4.1579623184421530269 3.4425024382621609575 -1.6610047743547546872 10.075168557502786726 -4.3690992259679006793 3.7052621631413491521 1.3610909781424973541 -11.295992368298055197 -2.9140049731602002403 6.3800527127600998867 5.391498256812240264 -2.1215006008263488368 -4.6387837653371990498 8.2517387906006369747 0.19067729113743869807 9.8825033874076346763 3.053541126205861822 0.21594118295370956506];

% Layer 3
b3 = -0.46712648553840085963;
LW3_2 = [0.030485778649418079911 0.11814795169195428659 0.044019862041051627255 -0.032620702844832816236 -0.039466980319391671561 -0.025692776292071409228 0.059230858956210601096 0.015247149335051446428 -0.03181856382160692942 -0.011939317338474988994 -0.023939735637062965062 -0.02735915548358487312 -0.061328500361210243341 0.024747770956864000025 0.022341415921781827836 0.664058262375932018 0.067679794245648197681 0.10445301309868509909 -0.049859799313607199023 0.041411035548565039432];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
