function [Y,Xf,Af] = ESPER_TA_2_Atl_3(X,~,~)
%ESPER_TA_2_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_2_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4773886900353432328;-0.73939641259969601794;1.8156522976352151844;-0.86161095098875539744;-1.027587648709278545;-2.8354457875917149501;-2.0412756738575081883;-1.5614746184799261908;2.1397277611190581581;2.4801281621536324096;-0.97444419316370023409;1.0850569278462907086;0.85091390472549011115;0.34823621107221652826;-1.8006234669040070973;-0.61031950909360266344;-2.6079124864014082696;0.53998165424348421038;-1.4637281347208275228;-0.95227502807711206234;-1.5672088730045099503;0.32483752123127684897;0.8015206407086327145;-1.1116554747573839101;2.8913780981031313999];
IW1_1 = [0.56388101507348920016 -3.3203116684858318131 1.4139366996255744446 0.47258221704220765291 0.80202981036084286526 1.1964947063595625654 2.0985196683903057924 1.3566685608872477431;1.1416820330882475609 -0.61754287661407181176 0.15748059431405292408 0.22092854862687930084 -1.0977264031821087897 -0.10350319159629245425 0.019718480158241902256 -0.35021148599399404278;0.024375288592411593902 -1.5914221375215726884 0.79982070844386199404 -1.2104684818428783633 -0.4647881573584754511 -0.46883378146961690591 -1.1927821986665108067 -0.96286566404471440883;-0.92519692404260256424 -2.3328744959875891141 0.24750618670881177619 -1.8113412370959960374 2.110876702439486774 2.2643410255725289204 -0.92942101528689291534 3.4725945908045106059;-0.26951682084893324731 -2.0968523115954700309 -1.5429204923662589444 0.52402770890975847173 4.2542470349593779488 -0.28127407270027016128 -0.30976326479622817711 1.9049791947200458431;0.94477888388705988376 1.0666216855839301125 5.406097638112199455 0.48153084480102553711 -2.1322409043682681862 -0.23406172227234672834 1.9502421790803952106 -0.89015953608596032343;0.26127972759221795851 -0.41605882429419499546 0.87551698189736049116 -0.055602257112994678268 2.2928772391391318841 -0.79375857818983885927 -1.8047479673432760272 2.3908667191557055887;1.014857390164517259 0.89451057788891297218 -0.28118779459983789248 0.13414937894569545218 2.4865858715823261349 -0.92385334428193521816 0.074405145125388524874 1.0313509731663836888;-0.52471323260159918878 0.74742078527533428733 -0.36404412027524490902 -0.05596000341883581447 -1.5867660074566682926 -0.15836235435638773561 0.38608821453648550781 -0.090655806995695933925;1.4112340560075395945 -0.28143436034226365638 -0.21165290595910438154 0.19734435152561125015 -1.2943961238237466915 0.053534201014682869513 -0.53927241147309834535 1.8724043203870841534;-1.2048305666161116534 -0.44879257169901703994 -1.3931290845279258317 0.12040370429558711063 0.18327360106924367456 -1.5287205134198591505 -1.0150557422774681982 2.3049949414683426063;-0.16579484271132052808 0.53818989301224273714 1.1826160224945976296 0.34758689529515213179 -2.9015633655572266036 -0.61466004008548846826 0.27666683195725610966 -0.41168276584357565984;0.23230593300960350467 -1.5316074943934856467 0.031023427121848662358 -0.10542988494350324924 -2.7750672013613817413 0.37074378596929669083 -0.60846274108316711349 1.2831881890456904305;-0.070131291827692315843 1.3207576566947687446 0.19140743200045551298 0.57473999853724311304 2.1158993339745268969 0.91339998572543723565 0.36182979091080441636 1.7266005246904436721;1.1254913937891810605 0.98793495335122516465 0.3421180060724292038 -0.86682927816947230593 4.0867687897216908866 -1.0118423812106822623 -0.52667357453755736518 -0.22094781357531925736;-3.1340918438229330434 1.1168016838341916497 1.5223702227244437779 -1.4813769423740212883 -1.1698669295306849403 -0.27277323778077822158 -1.7043830435186522188 1.253437508368851816;1.247542742051648057 0.053930472921721983592 -1.861630919298591591 -0.14214306246735586292 -1.2867520005862342902 -4.5215579252825994772 0.68051001960307200278 -1.792341580708071147;0.40564300152358623297 -0.88827257034408646508 1.1237701596298834694 -0.97836332775417689245 -0.18994761494009876346 0.55280548862760892082 -0.19214731202641843755 -1.8083614331531692176;-1.4432239246813900468 -0.33827151311495118335 -0.45914646524679780804 -1.5157478999494311545 -0.78828879126138096112 -0.12479292536561431559 -1.7544955840488110077 3.9327250446662533889;-0.74305332803435286682 -0.12335506198007778478 0.37620717729808994534 -0.28910267202220740757 -0.49850102168257287572 -0.42571033687814396895 -0.40616930318622174179 0.39727362429413054512;-1.7269070733952676111 0.9452073464742697384 -2.0464513276462565905 -1.7149348749193311647 -1.4705122196920674682 0.046477806668358573328 -1.7000246771220872688 -2.4619546835842820443;-0.12968827082824932462 -1.735320885079060238 -2.1173241345392637136 0.96875720643355611728 1.2450289765420021748 -0.79458945151439697163 -1.0260245343788438888 0.85361727376231066877;0.24090242940159883878 1.7257888764505036061 1.593834046765908008 -0.3836547348920639755 -3.4500704849223242654 0.14135567030937476463 0.50897913104361713899 -1.6273873378728269667;-0.68792717532633484989 -0.46510652222014897683 0.49971142093345910506 -2.4831292098449093686 -1.5583696403216202864 0.34822528985035205995 -1.1786867241224288083 1.821000872546238325;-1.5841435390336995326 0.86533952636778455059 -0.25292985724956734694 -0.5293506986472538145 -1.4861065738219951804 0.56185242314641115069 -0.069599376561998091417 -0.26153606860155298452];

% Layer 2
b2 = [2.324391727086388304;-0.85627962300387305827;1.5224157074865212191;1.9742065053075110725;2.6556657703372335;-1.5995141633056115804;-0.47260506946846531084;0.69618883857153834871;-0.22253343859591531717;-0.88635089958580781655;0.59838883414134702576;0.21660908564703434953;-0.41770109436706004402;-1.1827276872256173856;1.4592557002101484986];
LW2_1 = [-1.7425425630123378973 1.1184664266391368681 -0.69623593010623363586 0.15025552905223502065 -0.26464765596501460543 -0.9181248358461394643 -0.9564280547123192866 -1.5530519932212256684 0.50747454209718845242 0.95979530896802411899 -1.2454427803816785492 0.71395875086976667845 -1.9421956110305380605 1.0365513643239754327 -0.16981274047308100861 0.87750392789747766464 -0.22018230529054716449 -0.29203446891480028258 0.2680832024590498186 -0.90345994775651838893 0.41270008569525251652 0.44472493794943990242 1.7728091309034474943 1.645945142607587508 -0.29746236461630848336;0.11835677905456357117 1.5898833047591969247 -0.028803967631707727559 -0.066572117294160917944 -1.2130300752024441024 -0.33063774117363531335 0.34935957571504488994 -0.4518124845792932387 1.1062019702217955608 0.72052989693500613111 -2.2338341050207199956 -0.50191926323338620364 -0.75436692462924959113 0.18121392843107625437 1.8218771926528227745 -0.13594773956470626586 -1.2818170722161723596 -1.6335094516679364851 0.90090073593074260216 -0.011042437396022737606 -0.33664542359000909633 0.69012434716959492054 1.433045251172792689 -0.38236528347478143663 -1.333874469844639421;0.066017084934005640373 2.1391008636458033187 -0.16854226635675320645 -0.17220516663652879474 1.0126796908372077688 0.89441609585286996342 -1.2817034900254367091 -0.30468663332019713108 1.7305186523623754535 -0.30984747049803174068 0.023919423349975987847 -0.35773615616511300619 -0.55098918694071463698 -0.89523598864198383751 -0.3588902793140432701 0.81129821612918739948 -0.25619215604113942941 -2.1124261294259167876 0.56073608475629999059 0.055335990507114914128 1.2917534409099546977 2.2074318992397268246 0.14205606220966085496 0.26819730067239838656 0.46566700173223724013;-0.017441170603045102333 0.81869063933008567879 -0.83584652564382899698 0.38917062504213251195 -1.5537139760711671244 -0.4111804519001995839 -1.1757599130653757502 1.1677207752796032736 -0.17412011038123453854 -0.10803947554839085643 -1.3567219477126750693 0.21195158314759893203 0.95882215362617251309 0.5614453127845817626 -0.01408978727063382036 -0.6470217088857217469 0.18715555051864524172 0.51990253422105825454 1.6184250032030347288 3.34169108351150701 0.25212058609640053408 -0.39336308874397285518 -2.0432850773441741943 0.011901956393134700135 0.62869764653655135778;0.46287578818885921628 -1.9287079992534874595 1.5841606467755076082 0.059035671544230262919 -2.2754218493057116746 -0.67547813350945762334 1.0658258903022870268 -0.22457780359285595129 2.271325010041364667 -2.6710860474238726781 1.4741793906398981129 3.0808901445265113317 2.4431222645190500131 0.64990956451374115588 0.85990304744046142105 2.2129440360161951595 0.48097161821396827719 -0.34552446471616887758 -2.2006339762393718473 0.055687827686478966194 0.94436080613673367701 0.10552447042944639033 0.68383538503489571525 -1.1798567259193237788 2.0462478810935715856;0.150671262150356422 -1.972509260317916624 -0.027482298834192467329 -0.0072549959522453843011 0.94547524592201737104 0.4764639219676877202 -0.35584138547615146164 0.29816791235342221533 -0.99321456896550497362 0.76019555592287479939 -0.39462420364709954734 -0.031200435048346870232 -0.46349214497282187342 -0.086865166758737982766 -0.58184358645602807236 0.077474983356733265194 -0.0052055011528101529511 0.34443582643006537269 0.77567081723982977959 0.041327906537059949654 -0.044595359704878941021 -0.4400638729970540175 -0.099452541956232848319 -0.22418539063157322255 -0.35755937958074157645;-0.6616360038081373629 0.27253631006936424042 -0.015948858144663676656 -0.3031758645858601553 -1.1370984695919086338 0.027575712140556637997 0.86228923411151092715 0.65501490147114527218 0.35988120691917163674 0.91369661450894490429 -0.78344732741994282943 0.88105792969088159161 0.25298035405247049079 -0.36493011473391645527 -0.29324112662291179632 -0.99917494346507651493 0.90816661887605654169 0.6186774152673822913 0.48778239980109960872 0.36811749876735616605 -0.4919721544037308214 -0.52629361418358910907 -0.64964423060124965037 -0.116456881297219636 2.0062017757129537721;-1.2935248610918808065 0.076719249207192016793 -0.68462578581355759688 -0.52058703323565791443 -0.064312508708452953421 -1.2128590854650600495 2.2777250053519031425 -0.92006522246936528475 -0.53571812733462476075 0.37893244585760454957 0.52553202242069296801 -0.30047500713401781303 0.43727718984317598405 0.4206026334121771848 0.82399745461211204578 -0.33363698976081512804 0.23223766043224486344 -0.38147675333080349747 -0.23944331270160165714 -1.6246737994645201741 0.46167394582462817354 -0.22648120086893630543 0.72912833736595794587 0.86002670912065948272 -0.088230494570060880033;0.46322926918497142612 0.73728370675117549382 -2.0106262379198840407 0.5446301447609209756 0.69671555901443404935 -1.3382664077666899249 -1.2751932208078873288 0.14535433594876398522 -1.0144133376215291875 2.7396377547301509203 -0.45515154763821463746 1.406796749286582715 -0.058054324403451769421 0.64383932551275002698 -1.0937286198168787443 1.8409563675553721751 -0.84391307853400165939 0.8720645349625909537 0.75483677509603253064 -1.8664279879482257307 -0.25105123676229457175 -1.0467708926082577303 0.71983203736418643892 -0.33522999190337393616 1.6418712232429710784;-0.10030631741983975225 -0.41859562958677076772 -0.62284194259593039789 -0.64456418849724139708 1.9364459534803573071 0.31662133812963472179 0.029857651577178997981 -0.21904643394709577553 -0.33090390601856956021 -0.58684809405687166084 -0.72115646725469761957 -0.060909433659411066353 -0.35565852482849880101 -0.12021140060606876065 -0.99530108442350151421 -0.59304021761302327942 0.7331335531414249207 -0.98191820222362202752 1.5226539922260460269 -1.5680192803860071304 0.27679413467690966444 0.41898420496951410685 2.7163251587209003013 1.5974446185542843235 0.44735126118334295198;0.39710944965119066019 3.9075956420676170033 0.79019127570700908869 0.24411190967532703233 0.10431616329339095384 -1.9874158758221718291 1.254074487396452664 -0.18303107514991037719 1.9003102571053978043 1.6163426279269086372 -0.31321750566016459683 0.5923780670235946344 0.15115823536547057238 0.49061589343378442241 0.72782475517851419333 3.1127011174085059686 -0.55147071911070577599 0.80200218002330447842 -1.8385446622465775324 3.2506865526337103134 -2.005881621927050773 -1.5092449383239068261 0.57582455241442542793 1.335953431487109766 0.2606039329553295758;0.94584702949246546311 1.8046205411397675533 1.8428697084287546382 0.39604326777903769985 -0.51687795188713558936 1.3895959716407246809 1.0012071161296398625 -1.1827776869494281975 1.6301563285421754035 0.82598553300309229819 0.65743370634602205094 0.56350651566911913459 0.45059055675546616504 -0.93062586824680271214 -2.6239751046045842742 -0.47783525944225802018 -0.34255387618555294127 0.36724825706139491155 0.70104107068348797682 -0.92778017198741291605 -0.27945527435796824189 -1.4551396773992626432 -0.21597383466141834019 -1.4515121091078009297 0.087987531191046769452;0.090692182241204247206 -0.62176579680086641044 -1.0660721591331352442 -0.53103117013433742688 0.80653562023350511279 0.67119244176316250616 -0.74033220306356906093 -1.6632191329352921105 1.0798103764659736648 -1.4159368653800705751 0.47619966605741914645 0.59953203407541866277 3.8286757074496855502 0.59164556504708787354 0.57295365685463039984 -2.2132082094483909174 1.6112522475571648961 -1.4562203317110806733 -2.1624495711631146477 0.72330541372141388123 -0.76237502013132829592 0.12873420137869714952 2.4168804821951748174 1.6553924215995445834 0.49450173740674902012;0.57187587732910827309 0.82332884295705155431 0.75364939172160660963 -0.45088919383082320946 -0.18221081535005220764 -0.88943455910769952943 1.145992294684009094 1.1068167878576156138 0.29489398660617099912 -0.71729375284524365952 2.0680772783030572093 0.48211605504074045436 0.77336937675348171872 0.78841283380121729429 1.9501339239994128771 -1.2012931295624134087 1.1680908294773204581 1.2104348145816561377 0.38586660827669971852 -0.093865842333391860675 -0.85391422817033624248 1.3680292324964826722 1.8692326142475332862 -0.27589670260978482741 1.0466048286373650367;0.38631808698482267284 1.3332326775986802492 -1.1269529624189198458 -0.2118362542324330744 -2.0646223934852754311 -0.41919953360146761101 0.43608200050458872932 -0.062882247317816691856 1.4351822884373170996 -0.44145512772020900627 -0.47949794418980740129 2.6904705562864275059 0.73822443472904775152 0.020049275858093150438 1.3721622877994796852 -0.41828875486704758524 -0.46937126615265173379 -0.52649454314620958151 -0.52078035593390537006 -1.5494549230072267587 -0.065380354213692662424 -0.55438403722170348509 -4.3312522512374966865 0.096811766872253429694 0.82229116584422523584];

% Layer 3
b3 = -0.34201304893370310101;
LW3_2 = [0.027049506401429015967 0.014688732986541061867 -0.031163066535970805615 -0.10431439952141383087 -0.0081732889462945851333 0.20904123393939333386 -0.03538955586822997712 0.010102282869820143618 -0.025621993236383384246 -3.0506215983816988846 -0.016958914943231196554 -0.022382515387800620138 0.016389766042394095236 0.017322525123766724375 -2.1947964446708660979];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
