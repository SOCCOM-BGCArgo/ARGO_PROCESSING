function [Y,Xf,Af] = ESPER_tco2_11_Atl_2(X,~,~)
%ESPER_TCO2_11_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:57.
% 
% [Y] = ESPER_tco2_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.2850839600002229;-5.4764793003597285;-3.215977483654346;3.3138288576541304;-1.6102538916133728;1.0779375806436147;1.5983216455767089;-2.2426839763207442;0.082209318423575331;-1.5184792067867983;0.65950544206201911;-0.58924604049733964;-1.6572481203439586;2.6423662419308407;-2.4558318215929171;-0.97585279507572442;0.95734211438662642;-1.4800235425985564;-4.4443044978273107;-3.0973952331012944];
IW1_1 = [0.16555160011241804 -1.5096469065921088 1.3892150670714367 0.19970166169329739 -0.53787948147913578 -0.10265632787642 1.9549003093216077;0.47210425942820944 -3.2762402506252992 0.4865426160713483 0.8496087744186186 3.0888771107299813 -0.49933846907150548 1.0589036133183667;2.1982306784659125 -1.5171240791596277 4.1428771493040273 -3.1981486875133962 1.6493754888365479 0.080265365599378038 3.2543023388832539;1.5496297972761564 -2.7300545968985599 2.0236144567642298 5.797783190128154 0.84720337939868862 2.2194832502101796 -3.4622858354536641;-0.48125609542118603 -0.24550397926986761 0.82871722761343902 0.69395804023609642 2.4773794516816898 -0.30905179516525033 -0.32069512008842932;-0.51632575448623153 0.29070282849309514 -0.58330904881620593 -1.1680787387176885 -2.5932694984987332 0.24327210349359565 0.35166485630137112;-0.2118714953458665 0.37986815440474903 -0.14344833723470168 -0.7947510350005339 -0.81097134529944592 0.27420119381860908 0.92274166711386041;0.030960337984934957 -0.027506051487058231 0.15023884668554605 -0.11508822088296555 2.3885053064112265 0.39894665716057537 0.42051247917644496;-1.0947955051932878 1.3964762493102998 -0.39834593900014587 0.97627651467435583 0.011409066668914891 -1.834533970360624 -0.29313521039162616;-1.027451121619154 1.5227149873855153 1.5195601599906037 -0.10805463418825073 0.74439021740577904 2.131920279096688 -1.0526347498169333;-0.30075456188700123 0.34216018289222222 0.93143245656140661 -0.3268380077841917 0.23123691122921344 -1.1343978269131159 -0.85178675635195777;0.32019705285109989 0.72994420444436536 -0.92404253573475637 -0.67113020386687328 -1.3636681593240696 -1.0945846389767695 -0.99227875715194913;-0.27713268202120822 -0.26328761439275727 -2.2888399300099977 2.6253461359589574 3.2695837621320822 1.4868114216827215 -1.1429928186943537;-0.48682034258822904 -0.33483664306238747 -0.2169226397452268 -1.5619730863618089 -5.0526359005248294 -0.42890694428175208 0.30022052029971036;0.31090155703587391 -0.0019367425152414068 0.39350890991445375 -0.04942693848713086 3.211931637384736 -0.15792908497736233 -0.39295997161969753;-0.5522879993976334 -0.5020571820113312 -0.053383164685383962 -0.19632161306828202 1.7653202294257015 -0.02687902614983026 0.46915012057618838;-0.72042232201545076 1.2807411859522582 0.48362730124629311 -0.020840065319075035 -1.5450442170428111 0.88951931974985654 -0.65155354024280321;-0.14447095286197931 -0.058963475015533937 -0.026993427698422032 -0.41613608560053539 1.9172916925939041 -0.21971018398939213 -0.073352163011985647;0.46454746834266664 -0.31591537139240344 0.33093627440884904 -1.109323084056459 -0.92881118155552234 -0.18321200472044946 -1.6283695720380447;-0.12882911677108108 -0.08305052972285859 0.60906567841090165 -0.50975864600815579 4.6614155278931042 0.036555354564501756 0.29101251624701674];

% Layer 2
b2 = [75.892405234379325;45.698532332422623;-45.44103433462989;-38.047185668063989;36.729913807561054;-14.871696621725068;12.95784387120356;-40.86871765982076;-18.405935213533347;-8.0719890132859096;17.238097802070897;-7.7440983830939185;-8.3105114251472418;-23.622318635312993;-18.962077660260928;16.243348544051386;-20.203067252988784;20.138099221164893;3.6940838106982987;18.799551603554757];
LW2_1 = [-30.362495184682352 -37.844741737012704 -9.374650346266602 28.472560011380935 13.049195096220211 -22.589942930487911 8.3462909785816404 85.178733886350585 27.609337952079656 -25.737140627302402 74.780848526359534 39.171205579476137 6.1261775638515088 -24.079177742576931 -40.55273107793866 31.859173796725539 0.47919571931297805 -35.311871421427853 121.59047076691212 2.3901570343206195;-3.5867287417172231 7.568440973393507 6.2457362483098748 -26.491666673412507 -22.825302441033568 -45.978047162530601 -21.55788977533847 -9.2437837578905047 -15.005004838937223 16.948751972235598 -26.034742680857644 21.698519115817245 3.0144902445003159 18.336358328321413 -8.9574739082785957 -16.189134123190222 -4.1035652687638331 -0.61971242416088235 5.3566129595381398 18.254901691988703;19.252767617839769 0.21230145058703909 -11.665116622773322 31.863871347097682 3.8334986977135617 -11.695359664578062 -1.4359982707973351 21.243134895322292 -10.043537915072465 8.2540264096903044 -3.0615830505249582 -1.8839666763578653 3.3126147489886302 15.874995364454433 9.9017184048348934 -22.791031082911573 -5.3323738223664314 16.973657631780224 -22.912485512320512 23.743094415374948;-40.032845381174965 -5.6691768832542655 -7.9345389357965095 44.779017449917575 9.0747900600932958 -0.26462685462273838 -21.066867575525443 15.753835073508588 -31.029323062378829 -3.3781701254310823 6.4049498683327766 13.753397670727404 -13.011996701257026 13.069564050377108 2.6653776017044604 7.9622837922723715 8.897476895221617 12.251840946910093 16.396452256693514 -23.318445758640589;-7.2075499379839769 8.9057993765250565 0.35130415918256508 10.882423640502672 -2.5584270652488161 4.0937218801150408 0.062277466597059815 -11.503216274943545 -2.1992370743470553 4.0393600775492136 -10.244292110309111 4.0527118820764807 3.3381410199808998 -1.0681697038450051 -2.1200153844842506 2.3332445115269191 0.11662706165356368 -5.1057682993501121 38.746471305424521 10.694821166156084;-0.2137011806763183 -1.1014748561140202 -1.8837186078534747 8.6264315283213211 -2.0879394894810828 -0.064733350956370034 5.5978436887166074 -4.6145955933053404 2.9674132985329882 -6.4626991119692523 1.9749278383664837 -1.7174260438157711 -1.8347708354071157 -0.8748393561576705 -2.1450939240985489 2.7717721126028114 6.4470676515143381 -1.9782836342673613 1.4923620199184999 6.43960130812627;54.278875834811451 44.686314091391985 -16.278300786235938 31.990946335478927 -33.432310045145222 55.191137360526433 -40.087153561859417 -17.465574578170127 -42.093503922507779 25.596335058337882 34.19515565948155 -49.545901368126785 -13.425963351768077 -16.420421256278416 -17.203623605627257 -49.921994288851529 5.2367209807363961 39.906995756730751 3.8556308189315058 -24.959613694944345;-13.439386982699201 2.6413030301707034 -17.616874994756568 -24.707657467483969 6.2118886154820645 -13.654016017098478 27.144675571414851 26.045237646035226 7.5267808759088108 21.753569115587084 14.757964675088642 -14.488096568346716 -18.288888504494317 -18.067499546307914 14.718333932334483 -12.577216090933526 -40.163704203701293 35.931639841629881 -18.970643401039702 -23.238121641272937;10.419620652902019 11.937384976860507 -23.043491483602313 25.089871649176658 -8.3278896109012592 -11.423917708572924 -2.9465069289010284 25.950217442980062 -22.895164297486772 13.066673765040658 12.208009602613245 1.1698393633540476 -14.84336337728986 -2.5887119523829121 -4.7503685082951543 -27.464248124078114 1.8033756607816129 -26.069808355799612 -6.0816022470963427 38.057432061058144;-31.360800786771737 20.891943859911329 1.6246341495502221 64.995175337420505 4.4341046791413818 -27.896572410592995 9.9668716221917943 43.638669185181897 -17.238124673836754 -7.6830458230180785 12.84332928449747 16.931517137893255 0.89352572182081347 8.1656272290067644 -5.6793092455158565 19.38263153937045 4.3753946978971543 -35.935555736978785 58.101270117879437 15.048481390203056;12.728801675904865 3.9610632078696124 -1.3763644139582139 -2.230653512274678 4.5237662189660517 4.2454497489546981 6.9793283894167333 16.096526512090431 -5.6487440713021098 -5.4216245212478515 16.330719215610596 1.8481060030063661 2.4527649412707193 -0.5018256621005418 3.7283272934210974 -3.7512456263797151 4.8535950676171282 -22.133699294738779 7.1220912783450849 23.539799822040102;22.386593148624268 22.244226901569697 -29.088808903432128 10.102815882102275 -43.432466401842198 -6.5871815760503347 -40.480625652185957 -28.106962821619913 13.103234275209616 8.0748762181015774 -12.380938837962656 -22.245935953944031 -43.312023142339569 23.664476852863981 -1.8878442091959158 -38.673031399047943 -32.152282254901444 -5.0698835418312029 6.0357694206698103 -2.0129077032864671;-4.3626254701170266 1.419331997979453 -5.5180246211176813 -1.7984638879578347 3.7058578859694551 -7.1984495688491403 6.6479674182571786 5.7698851961336022 -9.2027871042984302 0.80285262765584131 0.03984591316298508 5.3811413639008094 -3.2622880773656999 2.582010521938598 1.8605870861049378 6.7060394128012755 -2.8905176083555189 -12.279018404958936 -6.9857323596907115 5.1912382306038696;9.558528916678533 -3.7585210624004848 -3.1737489948889217 -13.625585869272005 6.3257716979597074 10.379055274484687 1.6398752880735852 -6.8158829886842955 -1.4272428288291976 4.3304406423608732 -5.6585813324247338 -2.6105416364047791 -8.4998199541333026 -11.435912162608561 1.4241247943529849 3.2180410842389726 -1.8546343433824919 3.4919730898329258 -44.348769231800752 -9.2171852231212608;6.4234859634691031 -11.258924441716237 -3.2584207287850115 -20.871400284387562 -4.7085308043345835 2.0811007386644973 -15.268909302667058 -26.257679137715424 -1.278382418836312 5.5659424529828474 -23.429584606133723 6.0915702896987849 -4.0127699926693072 -6.3381757991479812 2.1248112921695643 6.1569117069835722 -1.8306397623874202 -2.8486345357500724 -38.069846377992789 25.268402146706666;14.708439497692373 -17.197012626750727 0.12803664112749086 -3.3739408047553185 -6.3835219780448673 -21.726681382729797 -5.412592288185448 -14.232432785150708 1.2758562876167594 0.74503227095811442 -21.839541467628734 12.688961650115711 4.9429510397879568 5.2001722847752649 -2.1238392938419572 4.5118370350403829 5.8825568301199507 8.6787248953144687 3.1879748161760406 -2.5131235379986587;23.594850152777457 3.5683111130206662 -11.636898664357759 0.63613404056973355 8.7816990241098072 -5.9934114378442116 -21.685928449412707 38.870868940317948 -32.655707299395452 0.014041906193202986 21.547674199789306 5.3106682758509951 -10.246014043829538 -13.703583156533373 -4.7980776362107687 -41.284951416485789 -0.43938364096431037 -11.331276904539628 1.6517889001437143 -14.083003896644213;22.269444415103649 23.96729475288581 -11.772574805908992 -11.839513466974797 -0.55535668044145337 -26.192931241624777 18.16149279227615 3.0322311020831636 -6.3399085162183146 8.4434539711447858 -13.356109348088394 19.950227668245407 -5.2081028195124084 -3.1042780742804155 10.16524134332445 -4.7712709552004799 -15.992016006826196 -11.762790501933802 -12.600140139911435 12.041962777120775;-0.24915589666444882 -0.30357718184458427 -0.11633195593129871 -0.38268879709233633 0.55857266783735093 1.1340554507206622 1.8076787768151295 -3.3118295031236422 -0.26648037504122302 0.52301074447562668 0.24348773138924401 0.31469137635001798 -0.27680861223282194 -0.79514531525085075 3.1776696636071899 2.1784155461299801 -0.99541389212428366 -2.9915265873941488 8.2753053376125472 -1.0166301995025455;-0.30581618716908915 -13.17450990404911 24.988621524762877 -2.9209137083379004 -10.465127831552351 -4.5025664501874454 6.2678904266298572 2.1845040585389319 16.576596593046403 33.58494609603968 9.38119601982023 16.186293568304933 19.878298711491656 -8.5398386925098837 -3.4876705653947684 -26.718198299389023 -3.454912602377306 39.842295622298586 -17.906599876811118 -6.7594759010279368];

% Layer 3
b3 = -0.15162956321702734;
LW3_2 = [-0.0018188669926795819 0.0010433812911831886 -0.0046320344641960845 0.0020912612111151367 -0.0082535821421151258 -0.014530152893278723 0.0031614634227047815 0.0057513920721562689 0.0027174587542374367 -0.0019078404448801985 0.0048732166298890347 -0.0074616140830718741 0.018750354231359914 -0.0065724618701617698 0.0055753168387068465 -0.011552359747334455 -0.0019329610721393776 0.003640856391230983 -0.97766295673835535 -0.00079033900342678092];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
