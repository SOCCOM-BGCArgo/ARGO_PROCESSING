function [Y,Xf,Af] = ESPER_nitrate_1_Other_1(X,~,~)
%ESPER_NITRATE_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:32.
% 
% [Y] = ESPER_nitrate_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5214963690681577724;-8.7346405190639888616;-3.9020979296851829865;-2.7737963913420484729;-0.65929843818431377311;1.3636618689581625485;-3.391998343354391654;-0.58567999215086985476;3.0695921720305503477;1.125698592221119565;-2.4300825484764412288;5.9756070026826311192;-1.4584946355850150201;2.3381264035556870162;-2.7850267586367709605;4.1575834083785014883;-0.85135253375101915818;-0.15619123472271087549;-0.4784195183336470425;0.84411985018747071052;0.021180334151392452707;0.16910334235622279109;0.0063662942266226787286;2.2077226378242404969;-0.62656252825558989006;-1.3484335461903385056;0.45268431599082481487;-0.24128322967248222453;-2.4221415859640349488;1.5421828530701073845;0.59642026696578187561;-2.855489668841010964;-1.1284558553519101753;0.049515651167919255693;3.8058499711996258696;-1.3639677568105328387;-4.1237983418733721308;-0.41811253190813219005;-1.6984636902999965535;-4.8309657363002447283];
IW1_1 = [0.17836783828769348093 -0.21607750196905869955 -0.13597102668041083362 0.11713287331941335534 0.47456915644485508921 -0.23401307260490603057 2.5312329088013418854 0.97103995521048236395 -1.2922595393569138444;-0.01865608230201932366 0.094438916641146467001 -0.83930119919010170992 -6.0108790529992859319 -3.1551891976307371301 -1.6977367833408307796 -2.437107342548510136 -0.24071471779197164964 -0.95903970494512524869;0.20763757078976258219 -0.16158073859479182843 -0.15261180146588332329 0.19377547897178609704 0.17238165596160123783 -1.0708301508664992419 2.3018723499133937338 0.95924392290829396668 -1.4891061252908897039;-0.1745364625715833673 -0.11689276384681267229 -0.30804365924391724496 -0.23688606972224818259 2.5688186663176151292 -3.2970337403784508723 -1.0355782782771600914 -1.9678817282621656748 1.3619153130820447206;0.44713332207683720299 -0.014989608870058394874 -0.25496092060071562369 0.097172987712828048923 1.5043927967633032861 0.15940296785654797795 1.2408886449483658154 -0.21609762134179885673 -0.90216760942872376017;-0.0041987481137837137646 0.19453891496426037322 2.964795922638370218 -0.36015680227058216589 -1.0823300010491596623 -0.10584541303244779376 -0.21561726544254841698 0.52383361447143661493 1.583613194898077392;-0.14546790414214141873 0.26730619378286779586 1.8838563777071632988 -0.11201412637131033523 1.4697349812736215657 -1.7974710749625033568 -0.23136937999251164233 0.91641939897774915558 -1.157696794168426413;0.27930208768087927407 0.58629619568629554038 0.17377899153072465244 -0.13957873499292228203 -0.44563515852847429555 0.018681148559918224483 -0.47242433678201223302 -0.29294845120526180615 1.0916247018878137975;0.29852731530215537159 -0.26334577932062647188 -3.9938475973754155035 0.21764574736537914412 4.2875158633535592756 -0.20609130622829796575 3.4152341442244029679 -2.1184610824876872748 -1.1631137372749860148;-0.034136995234932104859 0.24819835120344890811 0.13640308651838975451 0.23789269711351568315 -0.3975442966447602644 -0.7620800489947739953 -0.64734510551719737226 0.13430797571922103995 0.68775650687904066327;0.2159976881396006021 0.21697927241496622885 -1.3332378637890394124 0.098692044066124307022 3.398871753310969801 2.0533423737936584708 2.2211385346567769083 0.23441507460831617626 -2.3614014410498249674;-3.2389734497901780941 3.6642620992233450039 0.99694762248979496011 -1.2150146174986309333 -6.5978317784935525125 0.9341795173859152035 -0.71422078622655849056 -2.4167568144957503051 3.1229430783462350796;0.044035765840438778618 -0.14947405423411225245 -0.17317801674119290278 -0.44103145051658304565 0.24312693093918760767 0.78149052043222111408 0.50433089944384246195 -0.34716330465919714721 -0.69792665915523610654;-0.21254046684943220247 -0.1831871912339383679 1.2058511143789016895 -0.13619551958478548492 -3.24931553954891017 -1.9979498156539039488 -2.0411408362100260661 -0.38090976838467721644 2.2740541673269296652;0.11848543822395665726 -0.29684787822598124318 0.1293540460512236645 -0.19222740264665982846 1.0759806604707173872 0.64794747213299963562 2.2487136447612163792 0.81734143245256740684 -1.0493999895657875054;-0.12141667547320326992 -0.25367440643135141798 -1.1167534945785282385 0.36410024593529211057 -3.5215590216718313243 -0.36830416167395940708 -2.0948924174976282231 2.7477490064617735577 4.7307779632411435244;0.027226167148023377312 -0.45569394217356834487 -0.18976397088761834397 -0.15743341804421423502 0.66651657925345098032 0.81716116831911433938 0.77085955940578498868 -0.047885807648355593891 -0.64252675469973474787;-0.02975762977466583567 0.23965372296751813463 2.2535038911905092007 -0.45693806173369244661 3.7677745209122588399 0.93028404450739454745 0.74633413450454544336 -0.11847172427862347199 -0.034430323136790563776;0.20437731740522027679 -0.13140793842026238236 -0.20915151195333051004 0.23522926719453457478 1.0891403030609152491 -0.24343330432043422396 0.78916909837995319332 0.40411265632666848457 -0.58812655515189038447;-0.11559553002393113674 0.13857220471463574385 0.25010558044233160979 -0.26616440380243044928 -1.0466389287801127761 0.37892322434867775627 -0.69972195873883602513 -0.43763265839080067732 0.32839742620996248412;-1.2894459810362672858 0.16352040533033562753 -0.10848530827791019737 -0.96180391374324369913 -3.7177693668216171829 2.2933038581255162924 1.0569256379149380987 -0.45653154747115365364 1.0790848523659553049;-0.92076648057600141151 -0.85813636013587479834 0.33811750615605729031 -0.21197194962916801608 4.055213076636433378 -0.89504941404181392883 2.7481056709754745349 -1.7933547016628190729 -0.50186366510682767217;-1.3812422827400825387 0.19214186718971820733 -0.25000936619139363382 -1.0724069192193215194 -3.9177914109096083628 2.3536008571372648568 0.9821993514790502422 -0.55166720602297725229 1.2980433114483409529;-0.14819828878713459108 0.15310157628751241976 0.47991435415587813118 -0.36000551249085327443 -1.9411335496238812937 1.717569143409214627 -0.82435337766401384219 -0.66642208120510515457 0.84086078533741137608;0.38264472137067429003 -0.12516751308254261965 -0.22862374343397634524 0.14699098575289445967 1.5772113107536211984 -0.19660976288700057757 0.94383022973252694854 0.20959850185543385526 -0.83909216728810265273;-0.025017758688816647134 -0.23339966645159401781 -2.8644055264650081227 0.38434223922323929035 1.6998741144599256447 0.21185460094768082673 0.13707972527462175538 0.0494710988734555282 -1.7935695214081763815;-0.085081889525218043491 -0.26687020270269340427 1.2760088981639876593 0.32743239840122567719 0.32942209918460452212 1.5321064252218377089 1.6959644730640126564 -0.56629229610153597463 0.31022052429163077258;-1.268561468231083067 -1.8719071812955532241 -0.91386489720192698449 0.74070122053362907888 -1.5224282945229437036 2.0151463662696849077 0.30732839223831875941 2.8563041983410792923 -1.3117024307784939108;0.14897204893022666927 -0.13716483524289801998 -0.53778754411722184958 0.3707543627666126107 2.233687164939449854 -2.0274178178980299947 0.74852508654224192419 0.53834651735629046598 -0.90228604715836213668;-0.1071136532566235311 -0.53866941110757449174 -0.20984967694089379231 0.66199172639121295347 -2.4636009377550771582 1.7373784826179496932 1.9194798763303440037 0.77864089613909071019 1.277849756864340991;-0.2375890860328100096 -0.4233361031650244577 -0.15704019841606450814 0.12432124087790928646 0.28380475829445461766 0.14743277255191528097 0.46501959835636136331 0.14142666733066944218 -0.96041380828408384751;-0.071316169975651030888 -0.06486523272995585454 0.54567450098032088679 -0.56406734394845248204 0.79625187740689640226 -1.0980654793869055741 0.8316986781693482822 -0.010675693806827450325 -1.1995822546264611752;-0.028994152974552569318 0.063813066344283631004 1.3180008143687764743 0.097748932866773302619 0.18054714485356426756 -0.44496800459739199729 1.2545357883299868007 0.1627961783699738707 -0.25173123697752819439;1.4648849593352011311 -0.22623211599204640088 0.36000991703935730781 1.1685719388233333227 3.9645066659821246446 -2.3451068653833231359 -0.85877664532800024322 0.59972139041713690144 -1.469107171332808992;2.7580950477826466916 2.3836594128842030216 0.18388619793246935297 3.8639418166810650668 3.4702094890647470216 -2.7320357952642924104 -1.4519970631121152937 2.4962403036289049219 -2.6779445651813067464;-0.014074397014413972395 -0.20913935608244335618 -2.9213805406311945667 0.37435333363799611073 1.4565716190290727283 0.15907641174493425407 0.17841381942171699593 -0.20861991214430106178 -1.7019963455535538355;0.19407008539413483916 -0.12416325350908621883 0.043234884355043828874 0.071993728943689203059 0.20509422869237450837 -1.9325966689652436248 1.7590911530258366291 0.85764015987294017762 -1.5215900819316265924;0.31373241726143324959 -0.26505872790673606909 0.116746493981461405 -0.65112036531251560323 0.39140171116987643174 -1.387495614035233471 -3.9770259515324588584 -0.073138274120427712588 1.6905369867367361358;-0.0064285076412780063626 -0.14075467834794705424 -0.20289703830555066988 -1.0236259057869421252 -0.058310159584229082075 0.28786704702000587286 -2.5029874613322151689 -1.5572014222823085117 1.7957918166131645599;-0.62846776220212841046 -1.670139834875098872 -0.75620968664644871993 -0.35517030905992852396 1.2175267333894244093 1.0729036645864764576 1.2815761170370014721 0.13056428760565999547 -0.81367742887069871571];

% Layer 2
b2 = 6.5021500863252663649;
LW2_1 = [-8.8487152156837716177 -0.1155084030315051552 11.622100964078301288 0.34966204100482928263 1.7229328651698672115 -3.6425253428231085806 -0.47256302349750095582 -3.0622055202875233526 -0.11013098431385076603 18.135655190595873165 -3.6275821982117517628 -0.05486934081641989952 9.9916209382637859449 -3.9098116112774530251 2.8197365341499542879 0.16585255999023804097 5.6924291230386527829 0.13751388065878641931 8.3621810554494455658 8.5767251176480421293 3.1971336691726142121 0.06145778223498276488 -5.9142785039295002747 -9.2049927207260662243 -4.5853753590925361294 4.1352215306827702079 0.35561963009121916324 0.042498653377850241497 -6.8569558723617491935 0.10272850906827600548 -4.1735579097854316188 1.5553357701065433361 -0.63110218770252213272 -2.8877209735948814462 0.033440770218849287521 -7.6876777006584227081 -5.6506411603362565188 -0.11284561040321880454 -0.3395237675375059605 8.2132028671145498322];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
