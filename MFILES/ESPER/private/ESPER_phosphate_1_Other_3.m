function [Y,Xf,Af] = ESPER_phosphate_1_Other_3(X,~,~)
%ESPER_PHOSPHATE_1_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.17458162779151154;3.5354470205757322354;3.3677445041536917536;1.6221593562583467296;-2.6657465305995482474;-3.0618992023115678691;-1.8052223523214570022;-2.3061910315086149303;0.49833464560862128501;-1.4801337682951398733;-2.1955988780043447228;0.41045241815832278487;0.75446749259842749158;1.3584165996382380204;1.1441284326466194532;0.64619866257527525111;-1.0317356389730787392;-1.1177715499697751245;1.3351709096770705276;-1.216637889756819968;-1.4028458839471529274;-2.3760034438629067388;2.3547931269195814252;0.95484742938349365105;2.5804109195176558877];
IW1_1 = [-0.60904326061813229831 -0.26420767096429775833 -0.0050641072388947407784 0.41607965474710406628 -0.81818064434647563843 -0.77484699453830185867 0.70191199176060004028 -0.38436649395570671173 -0.65670070843071193245;-0.15521429945725270794 0.30022413136914044562 2.0786868968626932563 -0.33065224515968733021 1.0098505612701627054 1.1719727188824529129 1.4461505549283566463 -0.9777110426195368964 2.334002354830617243;1.3706092527601843045 -0.45780081290072632827 1.2148449883378626968 0.23891301125668665262 -1.7057278065804912792 1.0394240530219032159 -0.01910031692231549047 1.1872440593617383797 -0.57263470046267428426;-0.60228285352853538903 -0.04610358359976209075 -0.53596603960990940596 0.1178556756015505802 0.85019606738228814535 0.53980145309835125822 1.3331812405702869739 -0.53580309007042559166 -0.51717231150766451719;0.7319751588248204488 -0.64507243754248733136 -1.3460373918802408522 0.37523789761647607932 -0.015351352674686470287 -1.1233937997695098154 0.80356127237577423816 1.4147225493366737403 -0.19712560294107703274;-0.13399582922283334585 0.17225903139552739551 -1.8726744701754007849 -0.27569699916545992169 -0.25319930983743704767 0.4171185297585324192 -0.9068313454441806476 0.63916206189589563902 -1.5480905318347244481;0.28497119331563547373 -0.30710935822248591753 -0.59293963735805865767 0.13979674705680555924 0.37831113186107762081 -2.1512363935351070943 -0.27090183716509053102 0.72289430137507193486 0.57150345711742756016;0.20662002653797972851 -1.1403284761907070965 0.4578293883926251584 -3.5108466325905181016 1.4070444472087777488 3.8434114777550707487 0.85877993278013931011 -0.4604050008463306809 1.2502095420014718297;-0.28751548475453930775 -0.33203313925389066341 -1.2949660113610756973 0.17498848449726300824 1.3514398069147823822 0.64509985435896699535 0.15316744270471152611 -0.66624573520338203902 0.31546408337177539449;0.28373491519038118724 -0.28695972139170505821 0.71116204048274522798 -2.4750001902933571607 -0.4865057236622374881 0.70325661271535866437 -1.0022648421527105 -2.9948730478860072779 2.3582945446378746901;0.51809088008858261709 -0.23161648412566201993 -0.15402120307179481551 0.41274396101063554054 2.0454482203761701342 -2.7392667426015826493 0.55685678486835932244 0.43749747765692292845 0.23878854823578232747;0.17013640684255937341 -0.3726941109956541931 1.0115883824346196818 -0.091698819058589745024 0.064100135525265680703 0.81817931403674681867 0.51860203634033641418 -0.00032367353016984770978 1.0394496313261283316;0.16719825135871224653 -0.035158402748993781983 -0.14148022430280474127 0.076960892173677242223 -0.17310379313871709916 -0.76861440283575743759 0.24906750144129211066 -1.2046342265591098997 -0.27412045941683388373;0.55844063513202435445 -0.42267591711303503788 -0.2482606836607085532 0.067798781588073120385 -0.17699436916690233779 -0.50492701093731207074 -0.71269467562097077451 0.042983904270222646204 1.0360057598868477324;0.038273209681387657111 -0.19219435939551718362 1.1030580168112114059 0.13037210878874186393 -1.3152296930063176461 1.1323523266672976817 0.47124453007127725668 1.511332696122193564 0.39854687453778575579;-0.0091105555139798614916 -0.0073230469524207825877 0.38419668522430716617 -0.053307789397744262394 -0.77894239618032734551 0.2947957597707568933 -0.28885413817686511617 -0.43632089367803134072 0.21684917698556030463;-0.097177061522087285206 0.037742589196590112244 -1.7361184049951294828 -0.4133420704378715782 -2.7081430543495192964 -0.65205758250322876091 -0.5531446698226852865 -1.4439307729213299858 0.18269069521511710485;-0.35300915433880025729 0.57561196944301018519 0.1401703535462115735 -0.34044905694220933823 0.38832395548575271427 -0.01955897108824743158 1.5252138705925541995 -1.1260142183801993276 -0.77632770557412400514;-0.004186735437136197488 0.19445486294391217674 0.74382530495404008963 0.096832764301795187789 1.9182700497903588666 1.0398077295975385326 0.55279564933197744558 -0.99876603080905301812 -0.4429304071229629991;-2.1348010614464141277 -0.11379310740392818702 0.66505649630496777025 0.28954574464339494222 -1.7930608332158202156 0.72787957668419978052 -1.7703285749440405006 0.93811848206332393296 -0.27518655772103933765;-0.0036231947410722826868 -0.19562979988625095462 -0.68884003391143255879 0.25378224055737513831 0.42445673055301524901 0.33954601211126211879 -0.76627930719176118313 1.0167648665134410013 -0.47804939541010726956;-0.86697571792603911334 0.44456771356207347434 -0.7963686497268299691 0.45182667991163760757 0.23567022060698922248 -1.0964406676857532119 0.57151006851381058738 -0.007599986318840210725 -1.1673866136972219643;-0.24026287377995145245 0.046321597129009885185 1.0665682211927027812 0.50340762863352750411 -4.0766800528273359205 2.3827496143698021491 0.29405578347166078101 1.2068038194424701715 -0.60039451884723316066;-0.043464764154487363357 -0.18068023081958559106 0.24706325506767015665 0.40357774989734906956 -1.1083702761410589854 -0.56573978467725882791 -0.52500367123884927878 0.064889375415080191578 0.46610171898270186253;-0.38675947537503307938 -0.020342021199241683976 -2.1736076608284244926 -1.0975983729591569649 -1.2340279155900049091 -0.12742858711490370749 3.1620334221878771963 -0.62123449905216199252 -0.29221930933240941597];

% Layer 2
b2 = [0.5819829027038910807;-1.9805026257031348447;2.121452261279798357;0.78556044039825090319;0.16211423772657562736;-0.304637670215501144;-0.43336784630573377264;-0.06085113640236144289;1.1623258395603375259;2.0174882540102534456;-1.3021571564256584352;-2.2208337600667382716;0.74791611488595122204;-2.0615797091288396992;-3.4749759509212521102];
LW2_1 = [0.11354762442859189786 0.41919232654867166765 0.24979898764563496227 0.072442818958278046293 -0.13570195473096793859 -1.5761766733117881234 0.8267725125689734389 0.63206174701156059292 -0.24879193334768281987 0.068784459766439820516 0.49568085375567089157 0.2446047698441867202 -1.6108033478740826361 1.2325389460466034119 -0.053475762388544387238 -0.027352082868910523178 -0.31946266134429734951 1.2057452473826084649 1.0250563170509798816 0.15808298518498531404 0.095949931314333630761 0.60562553817960451674 -0.23198287933832051344 -0.38634152799959942115 -0.69751918567260684512;1.9478067079175112042 -0.60203185994867103314 -0.46138496165870179766 0.72667491691497587691 0.24419805727708776555 -1.0333467072705864176 -1.0564459301651241141 0.48276984911874981643 -0.67937020182904506171 -0.23348958757704635358 0.50552363110499787258 -0.044892500583798997105 0.20964619871023923436 0.90730004636006023055 -1.041529178396987998 -0.0036142195384271554037 -0.91251128851863883007 0.82016952256458375281 -0.92980632601886825661 0.42691888473129852022 1.0575889165724785546 0.1654824211239078191 -0.35399324404489362905 -0.14046698467136578548 0.60463837196054881495;-0.31814679299516201993 0.95653115905111252282 2.912366046599476288 1.1147874667491179945 0.64423386728898301978 1.6397311247234731546 0.04624004991962536032 -0.55138521585727451324 -0.36315695917860957298 0.12206284584618110056 -0.93500138580701441793 0.21789860718617148905 -0.27159170814597166643 -1.1578113891761572241 -1.0476721836892457507 0.96451644882195142205 -0.9472463271694830933 -1.1404884319065857756 0.72522873534357623626 -1.0374146890015198963 0.13459677931900734804 2.5799852671721215103 -0.94712604692156510122 0.28505414241247561957 -0.32058574595208910729;0.014381644911923473218 0.45689090718520281031 -0.45938921197504539728 0.92150755212572510455 -0.22168368676723962385 0.42873127552796114204 0.44593438809384705612 -0.35132078067549105116 -0.096653479146276949363 0.024474146399437519961 0.2278757873815670798 -0.16147302861019799392 0.72159122826248678351 -0.12325006278446926089 0.068527011587127456549 0.13908469440419843344 0.23495842357208043816 -0.089534809904619080956 0.57056984022638612686 -0.21767152008562265508 0.53038795316336873054 0.0089230173701748925763 0.17979846206209193493 -0.30898121989556842637 -0.47895402544000048595;-0.012565954483426974506 -0.22087781186964530744 -0.14954187399899038224 -0.13792549386387450983 0.26693880066678010721 0.069453630339207719779 -0.79012028181681515093 0.19431291255137980722 -0.063685259883574388273 0.25020907349459159397 0.32297698623539961016 0.07207871800827497788 -0.16791936471190901936 0.44834052315473532646 0.12338416542373650819 0.79016964656259525146 -0.62718738434399501358 0.73172048451607607511 -0.83039894528960300768 0.087242431330223191299 -0.16788356275261795414 7.288434196627479808e-05 -0.72208778423450337147 0.38360983892270600348 0.47626741883564815971;-0.28688233935807072594 -0.10590457301972958093 0.00021906576151473153985 0.926501330816308033 0.024200053168849641749 0.39796351290916420762 1.4797050620926037734 -0.27494805928215620971 -0.28104635025181773367 -0.26091149207504998886 -0.87940281539158704494 -0.17612824433718407557 -0.78320549196923017199 0.14311057517728076327 -0.049470299306096060521 -0.55567928496626228796 0.54662043814196636937 -0.80093548348144605331 1.4206294547723803401 -0.10682766293686395132 -0.57287760412721455694 0.40278901565667674101 0.61245408439233650633 0.14545261042507981464 -0.21411420832499331035;-0.10452060040928129458 -0.44588790447741116774 -0.56369172757240593175 0.083278458350635811702 0.24176487826716303031 0.019072094141406068651 -0.40287737978805232553 0.22948849548091493356 -0.26029930976884801952 0.072549864048589707277 -0.042501087815445981466 0.10424190282478137948 -0.024712650947871027396 0.93873801581719351628 0.3700984825745974871 -0.55353816087928375822 0.029137822525520849781 0.68370096834967086785 0.18940817219888261835 0.051962158934194306592 -1.0517549094744125249 -0.081883114630429645886 -0.53387847488785145078 0.55966613099774698004 -0.10644533360222720175;-0.58864036758307025643 -0.12337509684038075464 0.6477677847195500993 1.3732363233501363453 -0.21018733927040988974 0.33551945396299515112 -0.90348275958977797284 0.25192099809415802181 -0.67047924681599335717 -0.3690651904911999015 0.96802792112348468034 1.2628426942853552273 1.1193980139014425568 -0.27712848171062048896 -0.37263567071900322025 0.58300990519429762848 0.049769595976596844866 0.33543565251745943723 -1.8362459557777932595 0.54562954176779798754 0.31551384452182462681 0.35833569697504619178 -0.54571156516887331378 0.11826313131539678558 0.83592358968681546028;0.59894989531628406443 -0.12338825940323827624 -0.2849860894054764282 -1.5033244332858874959 -0.52410451359143406247 -0.40796928325389747449 -0.8142696974613596872 -0.25829148041536748037 0.54958209401438351538 0.046338095962133535322 0.37529358924730227276 0.30669467365796238001 1.6938823924911110552 -0.83254919887207912144 0.13533028860196133492 -0.53424528408796900791 0.56632399935279387204 -0.4203044402311663652 -0.43355792559265909913 -0.052132160664732474231 1.715207078562807741 -0.72154932887208000913 0.27431435596457742765 -0.65757097016367882514 0.31143085357251143463;0.13192841162314336567 0.26228160124060528879 0.71874816387037021581 0.66707148130780047346 0.17723534207764876647 0.34640564190574346659 -0.28240906107643076739 0.069657846631513670177 -0.20035501570020608497 0.25976196673644424973 -0.037852793961660385902 -1.0323503120367227837 -1.2363907438185008925 0.50252296901045490074 1.7905791394178001141 -0.47005240622935007266 0.90109348164931446501 0.23858241342016450748 0.4209170142642778556 -0.046799975256037538995 1.4867185358987777821 0.11556869190808177761 -0.39722258099834245604 -0.21166207969528347266 0.096958985062750746575;0.72044386731559939552 -0.32940164034537888771 -0.25801738909236365815 -0.39426815006917370621 1.1155304886887236204 -0.76456600046190792419 0.90110787166021344419 0.060848594254367456557 -0.19543527450020822811 -0.028229605519790770818 -2.4669058075041379041 0.22301988735335734337 0.7694372197890196885 -0.84086314555578633989 -0.58946700054848499839 2.2882993851158737186 -0.0084974367529291432166 -0.53040059735074729375 -0.1034900260559702273 0.096010639630639951769 1.2815500500207204215 -0.072579702155079695025 0.15335331928539203128 -1.5090734560741081438 -0.33214323896177150308;-0.33443890599555886611 0.48882880651751270396 0.89693013094654439055 -0.52179715259916770176 0.26159295294284551359 0.26440062264771241329 0.075304800889839304534 0.47415234362782820998 -0.08533650851615440236 -0.20077887229506097277 -0.71566445843447712427 0.030854003038507247375 -0.75049534188959465819 -0.00048839289899776233694 -0.2912008082774908968 -0.96528336626512722951 0.010914268643714426787 -0.12048570330945371221 -0.04476754755086790466 0.20970206134368096773 -1.7868863698641064275 -0.33401871957910617139 -0.23695847110389281487 0.38772075471961903181 -0.090333158405641419963;-0.13115740093359917751 -0.47968717556028678262 0.36000829528099381749 0.15129811104996257476 0.04204069513890191373 -0.012753874932887130506 -0.42997325133717911871 0.35410860406393657174 -0.14697812090123102413 -0.49069789470944719101 0.70044601723513422176 0.75294094915608622554 -0.25182417653644312283 1.0418720658754798691 0.22322714217961725502 1.0937168925214517667 0.19964589235081817153 0.63837861788981287159 -0.20919126268202301033 0.52537420678093271764 -1.1508422126977808642 0.64379084012842224816 -1.0225441838720021881 0.049470585358309476787 -0.085139807277062828916;-1.4339973040088709322 -0.44213981310807626279 0.97685848951781606431 -1.1876435460176970604 0.050371640593928852792 0.69938404352397731678 0.72804969163861721348 -0.52445617831723023716 0.23876969577200812811 -0.25543822312328140489 -1.5960658710635744484 -1.2420574473625209944 1.7610616158035576895 -0.84512976286179108953 0.4813644877123218202 -0.24617013822542382906 -0.0062222264538335219503 -0.47413035450363971712 0.28759835462969002284 -0.58116826579845437539 -0.70283903135763703407 -0.31622749276269984664 0.0079061984591419637303 0.08118184355134697161 -0.68139833772607150131;0.91876891280973860265 -0.80401795219132643489 -0.99013329603618360775 1.1723825705956330001 -1.3864098423290469597 0.11783789868539235046 -1.1440368239898868197 -0.47853742049703623662 3.7266833556122311855 0.22685833086985884854 0.23126942488385826557 0.058967960375645389615 -0.39118432880389947259 2.1106662540718215126 1.0017447622841646471 -0.64455895703199772573 -1.5271809903702393552 1.4991168771543201821 -0.34624639048689009879 0.56561931020243438883 0.67073430014836998847 -1.5497371418287630984 -1.973676737275636528 1.0053552566109784649 -1.9943304143284288354];

% Layer 3
b3 = -0.34405729091291387123;
LW3_2 = [-0.29797283900991577976 -0.49304725956676570542 1.6580038980184887976 -2.8149999433089849532 -2.6952130253516424219 -1.8761660036755118952 1.3358515505989816408 0.5018226454113892121 -1.208698985476790444 -0.60895534828652408965 -1.0843375111633037911 -1.854251798331526091 -0.57613364743842876425 -0.23160307019143858143 0.23207905641768958316];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
