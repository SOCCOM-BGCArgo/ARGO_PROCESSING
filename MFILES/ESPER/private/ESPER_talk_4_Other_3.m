function [Y,Xf,Af] = ESPER_talk_4_Other_3(X,~,~)
%ESPER_TALK_4_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:45.
% 
% [Y] = ESPER_talk_4_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.33262105189233387;0.083063134950159156;-1.4536343060459347;1.4991546319596643;0.76763508603466901;6.4718840830148245;1.5555101707047672;-0.07360724456440576;-0.14691840967220113;-1.9525300764734868;-2.1595859591090307;1.9835811921382709;0.012834721516858678;-0.031460732017953144;0.2030881239532896;-0.10910331734907194;0.16870773073004372;0.050740704398015826;0.069979481568601634;-0.30356370741209043;-4.9476352471887006;-1.5769302120502202;10.71803700271666;-0.74585343571102403;-7.3671567866094883];
IW1_1 = [-0.16609503821612326 -0.0029920974154210942 0.71046010856439845 -0.2683743424911047 0.46016265556281843 -0.0097842134494875894 -0.13124071251693509;-1.5980922192292399 1.3200221977376181 0.76553620729133842 0.74321068619755615 2.0343500783324808 -1.5778526295512563 -0.5360830383711378;-1.7183847456152628 -0.17877318577717116 0.3530577103903863 -0.59207174179146838 1.528620777469635 -0.75231067603558033 -1.6446571985564218;-0.14554147359941033 0.038718730858640582 1.0018946510002238 -0.44768330411283519 -0.86872287631758494 1.4073252502611777 0.5116156076472762;-0.62093407698690017 -0.080902094444230813 0.94951393858538102 0.22817580052233954 -0.44736238029412706 0.80089887914529845 0.77334198037738333;-0.17296054182105566 0.15755989320776495 0.11840987705109811 1.4472935604247399 0.33719342961820253 0.08451339539527572 2.1917906235143558;-0.60156546331509597 -0.86616828162793047 -0.013437420670639398 -0.52232498318532949 -2.814318623592881 -0.58683507368971544 0.45218004056540789;0.71898710943182076 -0.072028457026123024 -0.20071538212120421 0.25669489302257265 2.3967060466216088 0.84495267231017168 0.35670357500710032;-0.14962506210742743 -0.049410731399412662 0.71055068185984938 0.096571041562497031 0.071794930277017291 0.21089576213735303 0.022380381161242444;-0.1181737170020031 0.42617873328896611 -0.75406200983911453 0.3873054034541884 -2.2717614560057289 -1.8318126071452483 0.93749484133613403;-0.60508313713771589 -0.68265490267167495 -0.32686655676471804 -0.34297422882920953 -1.4537800227175504 0.019027492270965285 -0.32519308653757029;1.1646817956281352 0.85869920893119533 -0.49833393489109978 -0.16575773746994713 -2.8948655373966692 0.83521764350248473 0.41576187142804183;-0.36520150764036741 -0.051631686647868692 0.88987620291067249 0.088080490268204692 1.3794970346391642 0.14732272583478748 0.47718154094305304;-0.094504065103879417 0.025842094811213689 -0.54217077400269942 -0.0091856420251808842 -0.11985450478289521 -0.36844159098140827 0.038377772502272527;0.20647005194144924 -0.053965304867442151 -0.77036050684115287 0.329823344425757 -0.2609988359695678 -0.04564941269915939 0.14196871635138408;0.24356406897098362 0.44826093751100338 -0.92521417928757621 -0.33188167543989056 -0.27793175635502948 -0.64506108200440104 -0.35320031538488678;-0.48550486697188688 0.94108530265180224 1.1315304913287276 -0.22054925848021062 -0.75517968809157976 0.39885815328340329 0.35730334162066663;0.11045641593969892 -0.052023774808098742 0.52122220431431532 -0.03488002401374099 0.10389255510790869 0.3551175665588216 -0.059153825778463419;-0.53607665729950804 -0.17809701481603654 -0.93064571381399519 0.22704591001110605 -2.1782862136113268 0.3845796024602548 1.1467076789198194;0.63204677266495712 -0.21107905087865025 1.7631271445153958 -0.83749308214192186 0.63947465194278941 -1.0242876660157181 -0.48026030334965453;0.074369590432547497 -0.043978413181885688 0.91162860118876132 -0.24837048427556932 2.1461162596864467 -5.4163124151715873 -1.9839772225267434;-0.49408885284954368 0.21041888849074933 0.72334885932130488 -0.18303094981394949 -0.47800826970686083 -0.44338499422664812 -0.48841341552228656;-0.36028003221578786 1.2585841626781591 -1.2139941573972901 0.16837231619381518 -1.2139411342203261 11.748193611066021 -0.67058832236840415;-0.075271723628397624 -0.19519920445889977 0.56275995292407033 -0.23947861522242125 -0.96785037989889489 -0.39005604609400207 -0.33768237898685599;-0.19598959417386203 -0.50308798792380405 0.38703512868736772 -0.044156794430343302 0.14559313755858763 -8.4076600947481772 0.93087523777813941];

% Layer 2
b2 = [-496.08115175162033;-85.126173619690931;-9.3498880171480412;193.54115698258795;534.01356779797095;-17.092210612446287;-26.979612801565896;254.14565786211406;-197.66570574356206;140.22488514107357;-180.53393644494417;-43.065428199626311;369.80520216492124;-15.58579024675068;-78.927657816218115];
LW2_1 = [-150.99610998909114 177.29694337095387 23.63894136993682 22.113004333083651 -12.409092057820196 331.39099833173094 -46.472661273490218 -13.805917481091065 38.401821405227949 -2.6697196905352842 19.249860354588996 -2.4483414834067547 2.3393051526664954 0.93120217112336434 14.003269895168501 -0.66574342178519441 -3.5708286115020393 -0.23052264765639888 63.245953543311785 81.01941571933078 10.776815447517471 31.942270460525343 -16.93129608639282 -74.007999168038651 -29.854780467049572;-0.77827739526294337 0.55715848600334206 -0.5422621279362182 1.1614777896227129 -0.081431348548711299 84.110069318143132 -1.3730463136348927 -0.57594851831844451 1.6565163547221671 -2.1672028947942024 0.34489011883632559 0.24332475696929326 0.16894737045186678 13.819236308620123 0.22021418272247495 -2.344871721154433 -0.30606431965078545 7.690901759220484 -0.6011322929613897 -0.7307175169767568 0.19434288549643028 0.49248988914795233 -0.14920790048461491 -2.906840240338644 -0.050583422921799501;-4.2646342047393881 0.076421604689749054 0.69514958310787833 -2.5849907387633344 0.034416767410306984 13.011394302444426 0.18674541966129504 0.30782977062799288 -15.26030489344082 1.0618062705570992 -0.10294450979454078 -0.67680324408456205 -1.2432316212627257 -20.331719227937974 -6.0313037950911914 -2.5271215157814257 0.60577291989272497 -6.3796360653272046 0.57896232630639333 -0.77982210368614935 1.362762612845593 5.4781996776646471 2.6565087794356343 -2.2167223579963942 2.6692746662514093;-8.5945820942104376 -21.145778384528732 -35.975846755684032 19.691835052802499 -0.60589260993214145 -142.77856448565538 -9.2007584545272856 -39.641165424238835 27.013111782310016 -23.817846092315204 32.53383046988143 1.7010915081981266 5.0635316297946993 28.651409277343788 -0.51098341813089065 11.137161670493732 9.1378621842751233 18.873889814563324 41.590142890892388 -23.221493914984077 -5.5021529368807354 0.96169842543716444 -30.349185993411101 9.952329002139944 -29.716399327121696;-1.259205837798542 -331.47283330730187 17.079890700985544 -11.320731971447824 14.029934772911247 -211.97691395190623 27.169401933236237 -12.527331680491292 86.086492971743837 47.211801270247847 82.126782504074384 43.600464824276365 32.879388804414937 51.784823725619908 -11.342449024239642 -7.392566249502714 19.505105104734309 6.2220848514469989 -32.669727158202733 2.9791317333579026 6.2937157348308688 -16.367952164351905 -3.2304313372603461 2.0873108427576321 15.224625724001969;-26.152683321802808 -4.0977953884242417 7.8465968687653138 4.0843141921793542 7.8964636762906668 13.74065720821106 7.3210464201957723 6.9668982473258101 14.537940787962292 18.130798824428208 11.661024204912692 0.040256207583391823 -10.330496837426754 49.734122696262105 0.15552263020665352 -8.4138093461937391 12.992483686675195 19.516797066010085 -13.69490758140507 5.2995131629717953 -5.7761672756495743 -10.464588108327638 -24.479233464475403 3.7010255010005664 -30.182398489085227;0.12682623380681651 2.68468630471249 -6.105325460089956 0.57792220865698618 -3.7119788712836468 16.108912905828824 1.2663537976993033 -6.2376474232715404 6.4795400107944632 -10.562720589812217 -2.9542589975150149 2.1853963172490007 5.16770813881155 6.1384391462307297 -1.4359742717743866 -2.9678079632733003 -2.4848613945580991 9.01823796417019 3.0224858025061163 -4.1724547698652366 3.1823249509022333 -0.94159589062858151 12.416723139850488 -1.50789425810125 10.060547891038597;0.54149946711986141 -178.91696855097206 43.817314070302409 -28.225860281872396 2.6607101301139884 -136.41928645908885 -28.552680130879946 -42.414809206939069 16.718597575978997 -66.039314059552353 -31.089978027896759 -1.881303821785562 -5.228264624151338 33.080184682818064 21.413046765599862 -56.615763393188736 -43.719606829756124 16.910894067916804 73.951057498082719 -3.8833552454882296 -16.302107130806714 2.8575125806536454 70.286803968031677 -34.525990220992881 3.2153163321874625;17.253595885072944 -162.23527038091302 -0.14077842529117945 -68.844009168150961 128.3607885078265 259.8751384945038 -186.95180102172597 -18.756412244709967 27.546937672032762 -53.013739815989034 1.6176053225993123 115.78869498000394 -62.338168610963471 429.12911966926396 -34.875897719983875 -120.52180987632727 -54.369306315923353 160.71861247704376 98.221984018951304 42.158272128642061 -8.8308735055964878 -136.69075099297231 28.554826353840845 16.229094085917495 -75.351375980227942;25.628582551330574 -41.327129697748084 -5.1180751920289937 7.2670482557296596 -10.674895447751245 -81.620903193927205 5.0625038012642705 12.578143131214029 -2.3825593549009798 6.8350650022893928 15.95991210092202 3.0308736132023455 6.2202510618739177 15.662325981561152 -7.8357590820403953 1.7944923246738229 -4.1001772285842213 2.96911367558338 -0.75963663520788616 -0.12401274771793809 -1.3759486703407884 5.4309408190952659 -3.858493335563002 5.8462534058567668 5.5822051388175327;-7.8922647882313806 24.122318947092342 -2.3409455880528034 -24.379129316315904 20.471547505661636 155.20984834727884 5.2971140045380301 7.756654607087393 73.001627890248955 -32.241952256628515 6.7682350802360913 -7.2196000459132978 -15.704103518415735 4.4186493250864149 14.904774359606527 58.227792177241447 10.006811916441883 35.894978615571645 -8.2122677986406512 -7.769864462217341 -12.883950965515634 11.634246677869992 6.3011758051874933 -4.9321387748740282 23.136284980788648;-0.66743096555691872 -1.7566409572648622 0.94124792699567228 2.0621679276243352 -3.0862557352742663 52.060033392681873 -1.1795231080862054 -1.7678915452129378 15.333944414757568 -0.30206244968644558 7.6997077432656988 -0.71960362713607973 3.2010426655218565 5.3950164988228719 8.0041856406278615 4.2890292659628919 -0.41125569231349385 1.7421901775033877 -2.2633160808802519 0.3894596082014114 0.62373617024578309 2.51896918912519 -0.84513755064982632 -5.2842896204908554 0.27617623521974943;18.87850785593168 15.335795353972511 -18.817952924990784 22.514677738397417 -5.1676160894954464 -384.58621693335442 18.687875825136004 34.492807593443636 73.029383530998487 8.4703133186738384 -17.947219929050263 -21.624175779287647 -8.9865493512458627 77.778081486115823 -1.889288943837538 28.589123076631093 -7.5429566805816552 26.867284244305505 1.0923461987996672 -11.399838906978681 -6.1239827787767744 -10.57926481092302 0.34777614333824525 24.440250596427912 -11.970235950715393;-6.0815980977120656 -0.015070624670639236 -0.033981549410031196 -0.34055301787920911 -0.50064186797881416 17.355236059201456 -0.16404543934581045 -0.19658019285958861 2.8656254393431326 0.093032476216227858 0.51387162783238993 -0.013185697468541794 0.61536261753082522 13.045890982855971 -4.4879960627525843 0.31847950208670556 -0.12736475039642678 12.761127229587933 -0.043607956791141933 -0.0056620427225903989 -0.020588515488240217 0.57438212120244647 -0.019022708348724444 -0.79400627513705968 0.022683730260225087;-13.749487393986136 -69.77433283577939 -28.908823710645986 8.0134941615849478 -2.3986388577032911 167.26990954199297 15.290636581613171 36.593962317400873 26.27988728245063 -23.420541746561213 28.389320131182451 -14.505048599918339 49.05385810529971 -31.822418743490264 -13.57705159639014 31.548932960364972 32.192874267467772 -20.9441961148184 37.117707809037569 27.338662522268379 -5.0203234642153616 3.1662720932284558 -44.386506675393981 -76.550256420900439 11.292789456575948];

% Layer 3
b3 = 8.2271002858315416;
LW3_2 = [-0.0029574185727818531 0.12410681822028484 -0.063471962125935408 0.0059347674092651431 -0.0013781401537667859 -0.0096469821047797995 0.016110562374608492 0.0032432648500478672 -0.0019480968955583968 0.0050016307367817753 -0.0071387274013423076 0.063239776343862936 -0.0066548319612632911 -9.1061498008824273 0.0035974309751271127];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
