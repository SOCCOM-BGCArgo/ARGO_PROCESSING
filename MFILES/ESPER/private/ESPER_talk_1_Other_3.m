function [Y,Xf,Af] = ESPER_talk_1_Other_3(X,~,~)
%ESPER_TALK_1_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.90547034869161058;-1.6322498692699796;6.905819064327094;-1.5780281884099605;0.62858778826092077;-0.35238645151457998;-6.5433918065872803;6.1958712153178848;-0.69830599644207147;0.45232983249807057;0.67064695485456161;7.3407327332265293;1.3626002330284874;-1.4293698705625171;-0.035815516513681131;0.69054255930425668;0.65061696999821084;-0.66625929761270974;0.37697993489394849;-1.9657921446794853;-1.9313749905239679;2.1402910098976973;0.73482196537175293;-0.26910519082901097;1.4973926773162738];
IW1_1 = [-0.11454283212556195 -0.016384261200331256 1.4827653643329808 -0.31960390247056258 0.56385754080491768 1.647293016223496 0.74128718498743329 -0.2230273496622108 -0.6185782899882698;-0.12327138878263059 0.17446278441380397 -0.43437033035823519 0.067289831934384176 -1.4110483991265463 0.40945302568392772 0.12788697090791523 0.10110651406305159 0.48043524675391336;-0.053497816130135142 -2.9009019910901976 -0.18640570789253041 -0.0081292164769348942 1.1715540121854 3.8920382125705313 2.2679245766973488 -2.9720144639231538 1.0550965227805609;4.1985210462174791 -1.3601869146706114 0.86944529578273133 0.33271143080611748 -3.576442407020715 -2.469417578051019 -0.23152575344983045 -3.5151223400502718 2.2020801029162036;-0.20873749451282111 0.25056459177780982 -0.50689441218779396 0.3654188830089663 1.367170759070101 -0.88668214285275604 0.088829646906393084 -0.043523315575133073 0.28916512255752497;0.057204756972472286 -0.42646022020067409 -0.11895247122902836 0.70834839561950835 -0.6385909157851517 -0.27546649746530805 -0.10257907111397398 -1.3044437179054158 -0.56302798670229226;-0.1306942542485108 0.9194073286967831 1.8287905731230572 0.39424793230171618 7.6986403284566958 -4.6974571127981344 0.019454834531911186 -0.44115100504217086 -1.4300289187883874;-2.9921318118648141 -4.0015428133219606 -3.1842598901899577 -0.90524286133953613 2.3040195287281451 0.18201846314266212 -0.27073824242033018 -0.43078500171228595 1.3887101521689842;-0.061281159010134235 -0.21010169530106876 0.14561306271183203 0.39714770514668224 -0.10087858531102727 -0.65354089683696748 -0.61993341258921986 0.14702460166871517 0.68829310874372396;-0.014473543648320094 0.26508660028394065 0.09560739920187955 -0.26114246057600055 1.0529281219048452 0.58756636686757757 0.43869019532245324 -0.076955445773979322 -0.40207927508719338;0.18142919860670462 -0.073642521863876403 -0.5898086968116133 -0.1917275089359684 -2.6626833895341111 2.3345736665660013 2.0294890866323891 1.2721076149351678 -0.859675345082759;-0.55329856861592186 0.33896969148298473 -1.1161332494748584 4.0145558692730363 -3.5215934507113049 -0.92475981631975235 -3.029484917711514 1.3046320434156411 2.1739425738559541;-0.11198754776937317 0.68570245037485511 0.1804153628431974 -0.43510579099780827 -0.81882278910722084 0.7285099840607917 0.24030286245604041 1.1930762579528162 0.63020579808629074;0.34971580719958695 0.64603507664663395 -1.8790033119942546 -0.77377703433451828 -3.3572164926511734 -2.7233276827653605 -0.96066809722361812 0.80201954668823905 1.8593302089061463;0.0052873591531987932 -0.20934730527568565 0.59442367331345103 0.10473423577508027 -1.5469631445078984 0.67733673291721741 -0.18247531897298708 0.50643410886661522 -0.39960416445377966;0.02332567625920667 0.281993520298707 0.39335892138000805 -0.11204587019706314 1.5084681524046246 0.42810458745339008 0.26769613201910392 0.13967194403932237 -0.33013376875328487;-0.01853435409011454 -0.038686267940998331 1.0542801274099669 0.14697203791097385 -0.84667413853255002 0.76655751180570508 0.79494348129663017 0.34643961145549101 0.066404056864188932;-0.24759567785025982 -0.11566631448245369 0.39256885586997448 0.47074803423692846 0.30512689783272745 -0.011288551611568758 -0.48922640995370037 0.66727079949288515 0.34041001289688849;-0.7354273443586069 -0.75888571037351404 -1.7877699903611086 -0.36575603223816328 -0.94711649093263905 1.3958352396090186 0.67200767561513253 -1.1652230219839095 0.91919047929627484;-0.094403411593770234 0.58308472631097286 -0.040647865857090307 -0.28689006910076464 0.7913881229588291 -0.21963341737648368 -0.60747764529792725 0.17618616974257539 0.23584593447452834;-2.1463633274500573 -1.0823508549286589 -2.6806953674315022 -1.0503836291675068 0.2542335308468559 -0.75568497926966538 -1.1256701585806781 -0.94573081897591982 0.44928267539776984;-0.36901092550371528 -0.89524562010757547 0.18446330949812056 -0.39587309941855398 -2.9515422893560856 0.39201976849318682 -0.72582062666441216 -1.2380563610507278 0.88198138422711458;0.14831795696092398 -0.015905065483200375 1.185815518876135 -0.058396455626054687 1.6183021088065117 -0.23479633735008135 0.11582757016142931 0.31075591041680051 -0.67396176131782026;-0.079832799147227643 0.040098672725875646 -1.52801866141219 0.016474609011203838 0.81403326432089518 -0.62992644266211262 -1.0052345303206431 -0.32470354497899762 0.23484824681439262;0.52640270082207086 0.78859327033451021 -2.107439750969637 -0.40329374926136463 -2.1361223879998827 -2.0653787920249647 -0.096544219632487452 -0.80734862326242451 0.75915194100683747];

% Layer 2
b2 = [0.61146593378557013;13.09016303525029;-3.2739505949560312;7.1333850710405811;-3.9401081610486073;-3.6197629838232404;-5.1908516510953806;0.56819770748966481;-1.5624155339623047;-4.6376266435294173;-12.681956072635121;-3.7761844831921385;-9.6477313265083708;0.46894249530990156;-2.4880928308393813];
LW2_1 = [-0.21121219373777492 -12.626848158221241 -4.5910299971537087 -0.63018337762960375 -1.8008135323254189 -1.1701328781849021 -3.0525562983511203 0.18566807039797789 6.7746048419550853 9.4134355128736651 -0.33879776071543038 -2.9952108746981851 -0.069245988866693572 -0.94058275471391173 -2.3149767663929977 -6.7011484881273624 -4.6550675718075141 4.5954112005768399 2.3078391275410706 2.7691631737185327 -0.41422631826372935 -0.6163925206010632 3.0777431048616815 -4.3499260774691377 1.3015558938727918;1.0568805917861144 11.275508486852642 0.96931505341802049 -0.23199992102600045 -0.80435805853470776 -1.1659422594390987 0.66381268476212596 -1.7247842793503965 0.39246893798556554 -2.4321453467914216 -0.087856937182237332 0.048140248506803214 -0.84901524476304813 0.19166153630431609 -0.59974849280767051 -1.0405002024645953 1.1986639657474669 -0.37728764847792173 0.76227406755724147 0.75406049707913381 -0.37574966752921185 -0.0034548597695749214 2.1243937563675526 1.3271516562626391 -0.1142033009970331;-4.5409942021885126 -0.70208144881166745 -11.612851438738245 -11.720113660701271 4.3366684457565459 12.466875510559127 11.64307622207655 -8.3353505149572502 -7.9506913773310099 3.9163929338771966 -3.5893534727402767 -6.0957195920283151 20.303052100107834 0.445825485727323 -7.7851396210827852 -10.2904662418995 6.9305607011611237 -2.3019371130899011 -3.7808101294448209 -4.6221140347978853 8.8205535454307942 8.9621350020393358 7.3130550912782875 -5.1505223941878482 -3.8683557750393986;-3.0758363816814951 13.140006600507876 -5.8069322916182795 -7.2572340707362093 -8.951371440571382 -8.7833655444639227 0.48229183113799645 -3.1600225839117404 2.7818080319771732 8.778658811398131 0.3537775145981909 1.949053864958797 1.6234004598938312 0.95753119493128391 1.9849827863304588 -4.071696616657932 -4.0957233429233098 -4.3337680267892491 -2.9532158010055665 4.0599971399916868 4.4477549513746091 -0.58931844949647272 2.8235091967886312 -9.9155151079986883 3.4032397494315849;0.70702386301889597 -5.5801900214068212 -0.42578595868404706 1.5650478534347405 3.2424622740061722 1.1845959916267694 0.90087060763525872 -1.4388420857321542 5.5939060142216057 9.6738444991774042 0.95964360682624006 3.6710914570681314 -1.3215363412880963 -0.29704231005226178 -0.7630582982571088 -4.153161149421889 12.288050206105336 -2.4589411500544718 -2.1685695556384568 1.0312077137873485 0.19867049535045431 1.6672335096089954 -4.6459691539848658 10.411156762572999 -1.2836106817056632;3.7095687685018466 -6.3706149453269934 0.40801451468587502 4.4034835168928579 3.6634242212832837 6.0221144204113948 -0.85708133808405462 -10.048586656225106 -2.4613366863622876 -0.80059352521085958 -2.4818891485177033 -4.9828908844589037 9.0338124374261906 -2.00693148575141 -6.2939546475559878 3.2966847324930866 15.093896721012536 -9.9393051146291533 14.743408270155642 -2.3748633695442107 -6.8888620656106276 -2.044048172403405 7.7080822888765743 10.708200997109278 -11.291944631718346;11.087762051826129 5.5976013554835751 9.6792097064091216 -4.6117807045918386 2.1621657569595376 -5.4180690180554647 3.209886096285437 -2.8787034203069175 6.0460181101169743 -14.764788873821521 1.2048176121105569 -2.7413137440000992 -3.7837081064198803 5.4712229786140272 -4.9743568489933683 4.9749598318250969 -12.144971258075076 -9.2707267982074306 6.9729091642516234 -17.636290277366435 -5.4465496912879319 -3.3060803856494805 -7.2481736004795829 -13.670781047334467 0.19468503133779747;-6.1780058929629984 3.7768552250621115 -0.11435981517464355 -1.5696230802593052 5.8438242894694161 4.8265195072594631 1.6699422930963468 -6.955794137558506 -6.8957309980484771 8.4678568705805226 -0.29297771747772139 -4.4890798303227974 10.434165339589811 -2.1722284120387956 3.1311207158225138 -11.498157349540922 4.9931865563112314 1.4394608297416824 0.56270470388522587 7.9429826196996549 -0.30895071097622323 2.0572211766226567 17.883548008885739 7.4369150559259314 1.7506110166579667;0.10801537231621679 -1.2411509999011521 -1.6017568592856937 0.5386826149082663 -1.3728786566131006 -1.2054536216955063 -0.7589440135254556 -1.4277067305157853 4.3621430220555704 2.0355236678322028 0.30085403192619709 0.97206070033771541 -2.4963715291362836 -0.70261693601181829 -2.6311464566860012 2.2809879074751853 -4.1892273775209903 -0.43367535708038285 0.068987762673807379 -3.4792502247764667 -0.31607909295358788 0.90026572432123164 -0.51562927020753435 -2.9443030206080771 -0.31563134396952447;0.25374896587564 -4.3779979888590814 0.36515580100128392 -0.072198748978381605 -0.53032922755356804 -0.44404050162979175 0.039921169399990859 -0.17058718167690412 -1.2569683550967528 -2.3148413860079646 -0.06983114648219764 0.008125654987265479 -0.38849544334511149 0.10091948991026657 -0.66238762960456199 1.4725233859457783 0.71443108063844407 0.50954500160676142 0.16650111727278516 0.37884342879421268 -0.035739032519736411 -0.11738213546183392 -0.49568368010917424 0.47290897769311296 -0.011079762483026888;-13.450777675996477 16.521869016294939 -21.835528401137186 9.6937187000857286 -2.4357739980658915 -11.303274758579455 -3.3739210580016943 8.3221853222258915 -5.136619387516312 -4.9429164539744894 12.008944626157136 -10.773642739308151 9.3826668208274171 -7.0994158160474008 -23.443833985681025 -6.9905010229886111 -6.8918685660278767 -12.023924419839656 -0.80532570181499052 -2.2105404995320792 -7.5525860395919224 1.8525268217770985 12.974804434844602 13.850188598281875 10.334968800997059;-2.7764421962930443 -1.9946481290549529 -0.33068903331372451 0.45058173822364506 2.0249516511874899 2.5287632982312331 0.50162419403926517 -1.2198435323604184 6.7143897062756901 8.740524545655358 0.38609022457005993 5.0530352469177586 1.3072229336782042 0.26136206255935118 3.3718579140436851 -3.4237779497138621 -0.13782521303092268 -3.6936234984281424 -0.76838202107571674 4.4569002682794645 0.21231507643233666 0.15620536406636765 2.2731437313937919 -0.84400126572694145 0.62065250674074535;1.1027609172972015 -1.732382625257004 7.5540477857413508 -2.3461049913600194 -1.1840742884756619 -1.6804420951100258 -2.9853854442425343 5.3446953710069582 2.8507213315101043 -15.818541800645955 -1.571867437183321 -1.1302840148363031 -7.0494261551011723 1.0286895879964608 0.087318147690099268 9.9790814554914586 -4.1568441335793009 -5.9345728885882689 -8.7008804264833977 5.1102312542338133 2.7531150860812339 0.62544601406702671 2.9224831808770206 -9.0099891586967278 -1.5344565229986695;-9.6533430020889206 5.7247651888777344 7.0859094808290717 -2.28314051642703 -1.0454647829005572 -5.8199935840563262 -4.7482476260364956 5.7701495089236738 1.7202595041869275 3.9522104949213595 0.35963063308877352 7.6237342544796718 -17.793410963903586 -1.6058644351300873 -8.393420716760021 -1.0532524786420858 3.3752064220416758 10.373992019021109 7.806670418831489 -1.6904338199557909 3.0476691845102999 1.466761851901351 12.424363370044912 -0.59711197433519658 -1.9967503389730978;1.4403468869261056 0.10240721679062868 -9.4176538299029122 4.6823785262455608 -9.4559644723814475 -5.7725411999596137 -0.50489847535732957 17.481830619506379 -2.406221773670894 -7.5001210323130216 -2.8106199469106588 2.5356799999132433 -5.8530494840490714 -1.0161396662993152 -4.6980765701612093 7.0819640348620556 -2.746707181333937 3.2568698416291153 -3.5156809286829809 1.9098681218276305 -0.89735516066530063 1.3720498598027755 -0.87940881388176351 -6.6353922448001708 -0.59203500479487203];

% Layer 3
b3 = 1.9546721829242366;
LW3_2 = [0.11541816608939084 -0.2340223325676975 0.0045874396951001905 -0.0065235735140360658 0.049753100391565476 0.011575950346222488 0.0055276928559662734 0.013480682592506853 0.073979175393631066 2.7304931579729304 0.0041695935459491098 0.15268830613536097 0.010772083122398272 0.010982004074419073 0.011562257183267205];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
