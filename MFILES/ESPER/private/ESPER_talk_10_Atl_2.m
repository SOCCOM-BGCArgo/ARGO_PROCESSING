function [Y,Xf,Af] = ESPER_talk_10_Atl_2(X,~,~)
%ESPER_TALK_10_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_10_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4370048413803687;0.38608954447030208;3.8806577652931198;1.3782453045069827;-6.165816235642378;-5.6388688066499038;-6.7192881013548664;1.0667330751905333;0.73012092475676504;-1.8813423174609269;2.1632714509671449;-2.0641290269037502;-0.17664705363081518;-0.046809587211069745;0.20837286934790913;-1.151383622784149;-0.18295188320917116;-3.2155882239583877;-7.1688939810410419;2.9365203146184515];
IW1_1 = [-0.39437164677460124 0.71743022696359549 -0.33544638025689172 0.33015766966001925 -0.49627988938131185 0.72843838742068212 0.33148824079798683;0.091996634877859682 -0.14026071937478901 -0.024823482839151586 -0.037954922050523511 -0.63323857062813471 0.015103476990664661 0.026493366486344587;-1.578420902066306 -1.1130150843733773 0.071862320675475766 0.096592874785707356 -1.9232204240069721 0.10198438047281601 0.093571383423391274;-0.16864671773083992 -0.46013121222106113 0.070890674021609715 -0.020821451107830527 -2.285163425840798 0.012220210101866993 0.028046968035998772;2.8617210470855032 1.4559476227630082 2.3700945726050371 -0.40795041807818072 2.3589935237344366 -0.251860074623033 0.40257039663817384;4.2015546715095473 -1.3229558506025398 0.0018925285307645325 0.031324769048487397 0.25896841087816247 -0.17239299893587981 -0.1845033029722587;5.5200474833210098 -0.73728684492372554 -0.11588632268416467 0.034545243440018678 -0.29871438199373263 0.091702438466965061 -0.027261331884941876;-0.86133672537964823 1.0206188928724942 -0.37771074279565048 0.48134549357139067 0.39454182475737715 1.0758061346100807 0.20642570196038804;-0.51295166025708006 0.78507676367241119 -0.45381822825259688 0.33952290845845612 0.92776996233171638 1.0194479715162659 0.56591277174180754;-2.0547803409460372 -1.1894064015857526 0.86114331389847532 -0.073742159886285449 -1.3346081929641258 0.3886538018205935 -1.0786414791543208;-0.32859029754491303 -0.15308502423813383 -0.032889369914831976 0.056500207443076635 -2.6624234428733708 -0.039380999181726523 -0.022830158482780905;-0.81548294905181917 -0.75937326337988964 1.4536845359880877 -0.12924630349033309 -1.1631595075253252 0.3807354758977427 -1.2839418424897175;0.94985719855774497 0.79075326579342309 0.5462390360802607 0.11948579051470415 1.2993280226688659 0.68640634053231819 -0.48095394911285255;-0.094469724429289095 -0.17133679168958807 -0.19072777538165844 0.016077013750050693 -0.75276016551704694 -0.087684127798519668 -0.011333084760034463;0.76043420105206205 1.6821636813854279 -1.2544637855510925 -0.31366283891855012 -3.6543194944858621 -0.95952059850496207 0.383663817971506;-0.41649883171289981 -0.33293454896164032 -0.36298738877942077 -0.036692729587934979 -0.12882107405371504 -0.22636454552065088 0.1893472465998986;-1.0276574050910143 -0.8145758240957659 0.88671816503625345 0.16623864093933444 3.7981019078427987 0.88307493012041272 -0.13899542681287785;-0.31580947924557956 0.15078422241698206 -0.39967193182410576 0.1016779089709811 3.6200919512018639 0.0055527292323437625 -0.072902915078513861;-2.3322407085317578 2.8459217245583872 -0.35211427140119961 0.3539199682888004 9.4859140769695092 -0.96105918282688041 1.0291263829972208;0.65014845383254283 1.8362088925762605 -1.4507162899612929 0.57586607918863086 0.57989338084156272 0.26808653831306484 0.60866965484559099];

% Layer 2
b2 = [-19.533102565541036;-11.180026120081486;26.737074042988667;-2.5430019849703775;39.021783335443835;-6.0021057735405376;0.69560339083765033;-6.3895526761504584;-4.5623649791311527;-20.496833447881894;15.758424086052297;-21.809953687730498;77.115306080298126;-165.48986439433327;4.3707582529821849;4.3562290523079517;21.487599379613979;-0.45915416002365539;-24.984938109138088;9.1278245932915922];
LW2_1 = [-4.5668399394190988 1.0582739846154696 -8.2825439660941012 -0.64238867720043824 -3.4817726231479873 -2.0817626716059294 3.6787982149623861 -1.6865098381874706 3.1809844525521349 -1.3614499726340614 3.3580914977503116 2.2249502580083016 -4.8109498454827806 -1.6377836608040894 0.22993254167944746 -28.613146486073653 5.8911404249169372 4.3839076841647406 1.4087500339882322 2.0329580259760629;-13.790101123940914 -22.907651009626324 -4.8176645599880992 11.937852592007015 23.249338275816321 -5.5647387420783119 11.526170673045257 12.070871974162937 -0.96301299787041472 3.8178871042984013 16.595233531776902 11.89343560727518 8.2574006903391144 18.113680597348594 -19.762709024717179 -36.346609099204599 -21.395936701737604 -1.7102264164936991 -32.217109055952442 8.9952350038072293;3.0420097925712226 -4.0509290587536206 -6.285961075123411 1.4094894532354785 0.061706861284280434 -0.77603178190397604 15.069279940895701 -6.4427517291203502 4.1776414365461552 0.74669007321830017 2.3343406182979627 1.5477925792414529 1.4297550756004818 19.946999011699354 -10.584700308441592 -7.9188545697181896 -8.0257135883361848 1.1183697518970992 4.000305409156355 -0.96510382282317497;1.2078985550846304 6.5373638608976394 7.7804415818587298 -6.8919566234875864 10.696305834550811 -2.0106060267980852 -4.1749677426564045 1.0825041489756009 -1.4710930321270896 -4.7204712288299264 3.0736730841604696 5.784915599032562 0.52400736898457478 4.8492015633249874 3.0066792298991292 3.4994108470935323 -1.4028813590798108 -3.987894986128139 -5.317439826059144 0.99006537870299016;-3.0789156406233076 -8.1913195674956167 0.010575339733361151 7.8369639834526943 -1.1194020601695129 4.4241183540636397 4.2242945395543474 -1.2740179195831494 0.90143482720218393 2.8556834276998719 -5.9226286546152211 -9.8503738552067865 -2.9273983728316995 10.772188018746455 0.70745341841578979 29.435904729875254 7.6918000463268683 -0.85438430254824704 4.6303180739421839 -0.95167805658315885;-1.0312112784755911 -18.858888940263519 6.4633998476750714 0.41981663303660449 1.9188530923298734 4.805601096781249 -6.1569237926711411 -4.2958873828863195 5.8057536699298486 2.410645790229244 2.3572118372060271 -1.9323639544857634 -1.1346882356022827 -4.227821586084989 2.3232831119120023 -3.3046105685744243 3.4845089340638693 2.7692653188248575 0.37592620209735539 -2.0505856068913983;4.388787213546161 0.59037049590788804 10.387061805739446 -0.71983551383696442 2.4250204804225723 -0.97063545558370534 0.9923925340831079 -1.1895713264667331 0.92517311996666707 0.59499448368112584 -5.3236161107824325 0.48847057119778847 -2.0516091358079094 1.5039600631465446 0.42851348549250362 3.3440149650625051 -3.2348878266508949 -5.637957442662187 -1.7061689798127531 -1.5796997887312667;-29.954541732665454 15.934758660045803 -32.054938330722173 8.9379436670784518 -7.6101852540477397 -6.2732429651656627 -37.895318237112022 -21.882955834693881 12.88364577928361 19.952807336850999 -4.1141541668836998 21.929612329946561 12.710839298069141 -39.913708081431103 -0.3601103506675658 3.9105389833370947 34.047490614056791 -1.9246520209936351 78.084756823052572 51.35861387553603;-2.2824115690067219 0.20250158971621121 -4.7678556936678032 -0.27243145032175464 1.9600381197400427 -1.0338961828158815 -5.6323409982041897 3.077998542103745 -0.02507387141573944 -3.693536713105531 -1.212790877716639 5.8737469832332101 -2.3127732182350451 -0.95142155663330052 -4.1567069919518413 -3.046766669564164 -2.857969183724288 0.12759583413590289 -1.966143382045842 3.1959568866804955;7.7491759339307436 5.472243297750393 0.4527782265250323 0.70131206319417483 -0.34386053132103483 -10.040973332905248 -2.568724262907613 -1.1829945762758745 -3.3824812316543755 2.2306125141142412 -6.994619572105151 -1.1244550537577516 -2.4181495542529179 4.5278785983494849 6.1967490064860167 -17.513965538940596 3.0171262462419399 0.89891340424750554 -0.8810075882817775 0.95593438082848814;-3.3601241139674953 -0.60098072431729632 -5.7300124635458518 5.8556010618129832 7.4807373501458256 12.912570930803374 -21.355496074114537 1.361448808873865 2.0032995949512626 4.6255380008901206 -12.474880782651354 -2.3126959731908179 7.5039100684860793 1.6314049944519955 -4.5630149930755417 11.881948186054274 3.4194268258988818 2.6031976381508763 6.0377352605071843 -1.1546168300977848;-0.10290518033298134 17.162773574476432 33.934724832094204 -4.4257233577841628 -3.5705223929905654 4.3152905518295812 -20.778320322723467 -7.5055220015412916 0.77212175790981041 13.547335729394746 -9.0104300769904775 -8.382892685231413 -2.5071893478739877 -18.545599818599371 -22.559866927064441 51.62712170236513 -19.444852446383887 -8.33728912182454 7.3178746126457019 6.2318440492795091;-7.0393694376612137 -29.174713772334002 23.164625738894177 -7.6546498977500939 -7.8714745230642897 -3.7438936523055673 38.129894735309733 14.912108463733716 -10.639129384865548 11.829472075397343 -27.061275578451099 -6.018318263492179 -7.3396605649897024 10.798421677493696 -2.1005934266071504 20.100712739256096 -50.659716055168474 3.8251750657824664 -18.021666345473754 -12.036809030507232;3.3858307397068321 -2.6219159853913707 63.433748341778127 -0.64435305178782876 12.314254706584997 -10.015786270679087 -73.566563259652625 -2.8048665326515483 -3.629373610130791 15.092500226705605 -10.507491830969936 -10.97481560149067 -1.3544579807525121 0.59593846170102183 -6.1221660085001623 -65.975784271107244 -22.170674025945964 -1.0124515136049614 3.3895604447546002 -0.78664002978717029;2.3987289726779397 -4.9485347957683743 2.3316861586367512 -4.2047453720646537 -4.0946412311426599 -0.84255251207365334 3.3478059427189852 -0.18110696750383767 0.32625528341182658 -1.3521711497951201 7.7740424568884956 4.3591990808753103 1.3430343921935202 -1.2499133547201122 -5.4099114904637187 7.5542547509888527 -11.44101602620181 2.041185712893522 -5.8618228616428247 -1.4816781511045261;1.0826935537900919 -2.6216871952042307 0.63473205177283454 -3.0168194253019438 -4.7676971911561052 1.4641191744054374 2.6684921194498998 -4.685038337979937 4.1022133282290767 8.5720447029042166 1.9091413746249619 -9.2062607223601969 -2.3448740222052318 2.7335279012344076 2.7486553066163708 -4.4000208933646539 -4.8765780095994735 -3.9448931677371126 2.0798095330598825 -1.1221520866547767;-9.731837224779925 11.395488124881313 6.3332084263667818 -3.6565678334376357 -5.4621791164382403 6.7893830698534927 14.563053585024758 0.62483761395949666 6.867708903772435 1.9750363143363228 5.1793926690099497 7.6286755640210568 3.7559024155344449 -2.848918290706147 4.7529248051084201 20.443066292573739 0.2333110904259689 0.55419465422820169 -6.6832070542270232 6.0362041169538605;1.0339762934448609 3.6518654867036662 -0.15688584137809208 -1.8644627396989266 0.52743060010894061 0.5693799762723305 -5.8117868201301528 -0.021277148642021623 -0.58143985716108515 1.3585468546149997 3.1268738605425921 -1.9911637037928225 0.54811319666317904 -6.3016984789416117 0.46967026770711151 4.9907649007793964 -0.070386955094470613 1.772892416087974 -0.35974281059901286 -1.0777122352286304;4.303482364322857 5.2895472894604723 -1.4638635774012174 -14.526850250830568 -2.4678474817751601 5.1319308046111205 -10.603690619738725 -11.956879860509444 6.8307123052887402 0.20761711661573062 4.6700637811589614 3.8725349489010568 -8.0168106404138619 -20.587009456482907 -15.032498622045484 -9.4081049831830939 -11.164311195522592 -1.1331379341871821 0.46751862864523602 -0.8632597973059053;0.27720486967341396 -4.8905028146113905 -9.1758473469579407 0.96424842413543599 -6.3964696733620379 -5.313122583473441 4.5280456863906942 -0.20036116734446982 -0.046830252378875808 1.7778928946772981 -2.5125875298210323 -1.6635565429732515 2.3884663435866123 0.75434345129207891 -5.7382393066962605 11.381983090885326 -5.9830862472868693 -3.0029757883082566 -0.9581750079564183 -0.26068982357022263];

% Layer 3
b3 = -3.2650278103609578;
LW3_2 = [0.077464851606969296 0.0046975007388013251 -0.030032498945759965 0.10293393802593687 0.03790351916586035 0.044649217546152253 -0.036628725589224378 0.001109525257998098 0.055082266204630546 -0.035785021823831885 0.0075469081452194959 -0.0015190236652377919 -0.00086933352479754897 -0.010665025393019617 -0.022244944633696924 0.030068564414013003 -0.028511629954810269 3.7854946105547582 0.012247621130384039 0.18734059703883058];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
