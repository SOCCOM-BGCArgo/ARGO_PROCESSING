function [Y,Xf,Af] = ESPER_tco2_11_Atl_3(X,~,~)
%ESPER_TCO2_11_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:57.
% 
% [Y] = ESPER_tco2_11_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8541414847087454;4.6283539516523673;-4.027679791023715;-0.24410047688999481;-1.0915522385911836;2.7564195674069731;0.85564961807725148;1.4330413165304672;-0.48600242024060786;-0.72438740299169524;5.5210609108575692;-1.3512717509896202;-0.1367266101599077;-0.75912983097182241;-0.15915738330939358;-3.7793754938298201;-1.6176188158546798;-2.3372001159569189;-0.29221045013818497;-1.7813162314520272;-2.2611133665880905;-0.39803005334887742;1.9606598676803375;2.029820809253756;-2.195185440648574];
IW1_1 = [-0.47209493315036599 -1.6998500084263963 -0.82901227800814448 -1.2380250898783172 0.69079305620282805 0.97349049988349501 0.9231657459041549;-1.3157017723890185 1.5876572534982314 1.6396219806515886 0.50153865491723659 -3.4641705687106814 -1.2731122774691641 -0.35954115873528369;0.34118684494776241 0.89593016599743691 -0.4524175650118894 -0.74487716870188758 1.2105480614039013 1.1624079688327666 -2.7136671712145475;-0.37854387188075994 -2.758846180349519 1.8222236537880834 -0.21868645511479376 1.2892610786762879 -0.74299233935113751 -0.70854251197998319;0.067695510652465291 -0.43226997248796756 1.334843846143142 1.1716931624285711 0.65235930053351576 0.49451571825423463 -0.19297621269141946;0.87579056160041557 -1.0763217571279478 0.16138555126422763 -0.25026027407206641 -5.6373929975696262 -0.11271860988249476 0.020729241766747383;-0.57552067687175124 0.51095347466602703 1.2264331201731513 0.76565287479554989 0.039619183412603315 0.020070010532526807 0.24024840771633058;-1.6623536789995332 3.6400663522305594 -2.6147754899749405 -2.9842438013495145 -0.57934797283162964 -1.339562898317715 4.0132837232751681;-0.59957915982486198 -1.4818122977536317 -3.1027304997633651 -0.35869797588713176 0.11209225332717182 0.5244310531342371 -1.0532642869344324;-0.058370761265001965 0.0023548310099006653 -0.16771527790727014 -0.016191362556355355 0.95684056577350451 -1.5687577858745212 -0.46344333887835765;0.51461655127525097 -0.67380966020932453 -5.5519338953114872 -1.225077032430272 1.9480935628749323 -1.9015057944209133 3.7110890858113228;-1.6179434982783401 0.83250115008984149 -1.3821017959328743 -0.63021681447415434 -2.1723346042753944 0.90965268795220222 0.82114780665956599;-0.0635376668613538 -0.95760671054971302 2.276619334079133 -0.60464319460064975 -0.96153634513325703 -2.0050637199204902 0.47606200309478386;0.38953037920430905 -0.96771822700815635 0.76679943458931921 1.2714713271644633 2.3977898368179411 3.7482851953451917 0.28662902624319714;0.69573919527414252 0.36885461089143645 -2.2655777856916752 1.1568707792385671 -1.1655659506900768 -0.24655896440124075 0.71838189766410043;1.3874338007016378 -1.3148107335523522 -1.4247042097514084 -0.46831394195355125 2.4715666314674007 0.29474507686888696 -0.48267072920734533;-0.18107525035573946 0.54012391408281513 0.19701244664889506 0.29389118166025524 -1.2239930605514233 -0.35718887532146659 1.2448901612907144;-0.247007469411479 0.78073809912159253 0.9094063617005208 -1.2010599642440234 5.2975921595462356 0.25055339284247524 1.9589003574265478;-0.30912016325630848 0.26127450364700655 3.8935557682396773 -0.15774023876957446 1.4409424065072542 -2.4455810723357749 1.1049458213528509;-1.3001931205858279 -1.0019527082699566 2.2459402769082155 -0.8509163825913636 0.12331511447403733 -0.40600612689689747 2.3093754756459592;-1.3831878377782469 0.39069472160286722 -0.61831395838904657 -3.4109458827232766 -2.0334170019339943 -2.0617768572215125 -0.1376746945531333;-0.063621568799984249 -1.2862290579137576 0.40937280580456287 -0.75889346978999328 -0.92981033953919656 -0.52367626937854717 0.024654840369750738;1.2018118751251297 1.3062730627593369 -3.4864535663299083 0.59631812799882811 0.43351116408358703 1.1257841233721724 -0.026877880684801514;1.0391220972872719 -0.48576104168683132 -0.27776707556884683 -0.31016876728635123 -2.3799725657312618 -1.3243952898748867 -0.76090955317261133;-1.7221904055511215 -0.4348153593929171 -0.45775557860504379 -0.20604217705524888 -0.097429537377170583 1.7209667348167184 0.87420182413154157];

% Layer 2
b2 = [-0.83860621543982561;1.9161984103625738;1.5259864187529797;-0.18138009384651083;1.5567607993458241;-0.26768533466486405;-0.42727924942023771;0.41823385014215247;0.55526081710209918;-1.0572847630129987;-0.36712677743387245;-0.024246349665446233;-0.68086644413156705;-0.18350874346658133;0.97822094099856349];
LW2_1 = [-0.13232522459713408 -0.86937785344616825 -0.72371841242925505 -0.78965012290234715 -0.048671020283761642 0.70273077851589627 0.80399293942337446 -0.40911379737983394 -0.069896766838178276 0.1401312733358025 0.553511367582467 0.87807268450045284 0.75118801155763659 0.40677439272914473 -0.25373012235331849 -0.12128048575204092 -1.392622988455225 -0.93599080599489759 -1.0413451814115902 -1.5313685182802153 1.6045953569403921 1.3178229506010584 -0.51408179289709333 -1.3965634126528061 -0.69064106945909909;-1.8463309263602365 -0.8322762511921773 -5.0634615709491628 0.25093528238377649 0.70957362650220179 -1.2404949546240185 -1.9756423896284125 1.2089199359168514 -0.34907927735703298 1.1873026407591663 -0.77972307737646906 0.26155681238868117 -2.8901046859196482 0.79896395730186953 -1.3110936963742927 -0.8248231535451277 -0.69715475372564306 -0.29339727517475495 -0.19690019578536833 0.86947043158186144 -1.0460059942671596 -4.4368757709989355 -0.27107736939982618 1.1688918994833417 -1.0081459673728688;-0.2833876656773866 0.67098715511954043 -0.30272102992974337 0.070171181305737004 1.9222958996671271 0.10094072426879876 0.26429871976878233 -0.019347760255515278 1.8569515504288303 -0.45302698225462623 0.72942886353726577 -1.7210524548615811 -0.05628588010136798 0.032861748079495517 0.11114383771969982 0.47302756290465703 0.036212028895235816 -0.13695285191969828 2.4334306052653956 -0.64806349774641547 -0.47857121150613885 0.74473166800302626 -0.14767572224886888 -1.0156437649512273 -0.46800652820327032;0.64842561683980682 -0.12343345507044096 0.8065862618871823 0.36704182540067587 -0.20593616139842591 0.77624399737228544 2.6300811533259498 0.4506376167706046 0.24502123231102721 1.2673130187145263 1.7602760721472328 0.61127473268278865 0.97696147343833739 -0.61934486427688884 -0.41021197338580767 -0.034799735712079866 1.2638941515956477 1.3853039857759224 -0.99702537913441092 0.049360941510552023 0.95865717735882749 0.40967357830686174 1.5359065489629398 -0.019476419404078817 0.15069491187817666;-0.81972140311180686 1.34630871060529 -0.8713341772712152 0.21461249499559332 -0.52865438835268563 0.37496171306118076 0.96340739509320694 -0.35211802391842806 0.39995378264030856 -0.90081754937319147 -1.7843514308591737 0.84121661736912279 -0.81050654012466328 -0.059669074546568203 0.51077407197672786 2.079451580361372 -0.79863727821748598 -0.35177671704174035 0.30607824470403572 -0.67094262202519617 -1.0957328443808247 0.95490477880542102 -0.25394970021452884 -1.3518609402368758 0.54619849867839532;0.42818532562637718 -1.1752782537450255 -0.48268987403435781 0.27753785138481574 -0.053171120153241616 0.16472973064452318 0.39988414573824721 0.083579616945593752 0.79345059338768631 0.86627541126780316 0.85929470862722301 0.37126947336594207 1.2758232510146623 0.2320222667894466 -0.16452651722435288 -1.5755254510905308 -0.24730393906578682 -0.12118309479103101 -0.058046780898407209 0.56168299060257199 0.1056687308024601 -1.4587416602258545 -0.62046747452053919 1.6199972101249498 0.1341772314392097;2.9667979708518653 2.8203679345937194 1.5871706377972894 2.2462136313143626 -1.1011427376835794 -0.10444332167313133 2.0004089990962339 1.4478149720279354 2.0315919481560756 -0.29860794251655065 0.89142993194095799 3.8430644109554271 0.14088884316262404 -0.43214486849518835 -0.086312335536771298 1.298321830284465 0.51762337397226521 -0.63879103858851605 1.0633678676369818 0.30948427741558759 0.011038201307755555 -0.51708003594288043 0.24937076937005817 1.447952503454202 -0.15355056380321036;0.36933608836642989 -1.3971738611261801 0.43610252871369415 0.32742030106828135 1.2211576058441329 -1.2423183524573145 0.50592179200111054 -0.36823723533282371 -0.83234364978394326 2.0206150878249098 -1.0246838159463847 0.058575746625481963 -1.6077104506024484 1.0517676152088138 0.46500532012398016 2.4511057684357946 -0.41012232918420721 1.1369221618528613 2.1826121005931354 0.058942750343744424 0.16992209415449544 -0.97856893313740523 0.9032729744941812 -0.76315967478729074 -0.024011941891442581;-0.46256404537508633 0.70807420466905135 -0.12470840351849616 1.232053503964377 -1.40193778594415 -2.7513389675366269 2.344136977358044 0.32897106143854665 -0.70610392730637628 -1.9147432434406164 -1.9025066225895173 0.11866069895027458 1.1268191837888635 -0.45360346292772802 0.012221193852059213 3.1123796562972279 -0.54377791189679137 -0.25085355261087783 -0.3623193672844372 -0.57191142185987864 1.718792367331051 -0.46640530107038791 0.54224625969596862 1.6633781261957092 0.25148965473475765;0.072045789696259938 1.1499416070131259 -2.1413439124645763 0.47362568309025982 -0.64805535126513136 -0.77046311360582143 -0.19532183847658177 0.72945977441184995 0.27550409078072913 -1.1402599040405625 -1.7217439064235318 -0.058740518295865081 0.3443792202672315 0.33440711872978401 -0.35065787947780686 -0.26055686515727738 0.84940178243803044 -0.23192813351076133 -0.039863668579166948 -1.4663444135478811 0.76413834231312538 0.040603700064863683 -0.40902955461786505 0.028361077172548696 0.16688204053441066;0.42500312009101215 -1.2476458489624531 -0.46893637575375119 0.25354011426012557 -0.12833975990492275 0.31070985936488554 0.55940643986911365 0.12431117272673203 0.76133407805352671 0.97282502463085729 0.68479967065932623 -0.3950031722691455 1.3119232823887079 0.35516084509549622 -0.16169557806735294 -1.5479479789163086 0.2926694132019334 -0.10170352410432541 -0.14780923843321198 0.45153425655901291 0.10746461920409989 -1.3557733904614617 -0.5855950900644612 1.5617150964267685 0.2938911917015522;0.40923691713033611 0.33869311521104967 -0.63393276302366941 0.15935212135713481 0.66058086227760637 -0.59043800406872227 -0.97387895963708471 0.61787413403662339 -1.8883874590100846 0.60677976936442335 -0.37583645001686267 -0.8961098060103585 -0.98551745306745164 1.137811165999602 -0.011746465600408542 -0.88826546675433915 -0.40314755343183023 0.56113033740259866 1.0010097350823499 -1.2088600249017065 0.034666029094746725 0.31722445025689089 1.3326682693694198 1.4312665498645436 -1.0254940279798526;-0.082426126790905413 0.097522975920519547 0.91301983501365125 0.15363792837804144 0.84940113215891822 -2.1334756711822425 -2.0118549401948047 0.27195184191556404 -0.90053179148676654 -0.59344600221714572 -1.2839164850573299 -0.77500120008752427 1.4372795213834451 -0.72829683422478109 -0.19684946172634749 2.1581898712894239 -0.05789313252421633 -0.22639570566807696 -0.05655093116335401 -1.6353050524132504 -0.94379648709983943 1.3799975640010336 0.088079868921111026 0.36941660852811137 0.30965276624571492;-1.01134239388042 -0.030576361485524277 0.65420021601725942 0.2413169190846427 -1.1105997777300776 0.5296994892986181 0.43736706215017845 -0.42380343386997094 0.16581572253297058 -1.006431902250341 0.11623995242323534 0.80609484714341895 1.1554640211422655 -1.5573368645385739 -0.044591996148907714 -0.047383967443515175 0.7679134101049957 -0.99131048068914651 -2.180763398962295 0.55084626515564217 -0.90669832975944864 -0.085128873534057653 -1.0169793413736599 -2.0959285492434425 0.23844172851549517;0.0024356696785988131 0.75184807446635893 0.3592400858858189 -0.053551707599259001 -0.17955012595536429 0.15558430669074191 -0.66963498531305332 -0.076500945117482233 0.20541658380800046 0.28505459355514357 -0.57851267337633894 -0.27880666528769132 -1.0170417448480837 -0.58604688237846614 -0.039262626506020575 -0.68727631563240477 0.45564973074166093 0.073957080157086269 0.68079255041907127 -0.25601484203844077 -0.59753550120456367 0.043037444098471635 -0.60623663182094811 -0.23084999222028921 -0.25214133441822467];

% Layer 3
b3 = -1.9504912617590995;
LW3_2 = [-0.054267093925158431 2.8013578233965988 1.6061325100446588 -0.18046505857587333 -0.21891450564441747 0.85931243539444746 -0.22373318896208277 -0.018327943814035904 -0.064930890246288245 0.079245251016688639 -0.86867636300345707 -2.1735414828931114 0.026595174362462476 -0.34260177416281062 -0.1632765616764181];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
