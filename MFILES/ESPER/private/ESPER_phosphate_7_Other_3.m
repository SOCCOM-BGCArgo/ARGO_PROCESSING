function [Y,Xf,Af] = ESPER_phosphate_7_Other_3(X,~,~)
%ESPER_PHOSPHATE_7_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.7004118575390809731;-0.35037243282802360556;-5.3167997064412251262;0.75840764129458904108;7.0440551836013165499;-0.30097395718803432452;-1.2429170612434019549;0.1112388899386643204;0.17898285522917911639;-1.313741461620534734;-0.50144710131228620309;-0.0059705499945223051289;0.98312727389069798356;-0.16923602206788632141;0.87092495295857830229;-0.2377604748899233289;0.68844214550814164522;3.551808652503412933;0.39669026139997765057;2.3190872362922578809;3.0936187252735551922;-1.2262161094898946789;3.5295172847679885386;0.32239713146589005222;-5.5140278518439203026];
IW1_1 = [-0.20832430210620414557 0.0074403648381672011017 0.24569602844138502262 0.044514729864090780975 -1.4956470355545958828 3.5412247722360463698 0.64623300437221009584;-0.84688868324805588461 -1.2726354906234100817 0.50254021365782031161 0.11368605116345012473 -2.8643264399883365812 1.8491737678621873453 -0.71492164025014393047;0.60805445942574198881 6.1268537246817507125 0.95480453340270943219 0.71931209954023245245 2.5503703439329208358 -2.3947528231736523452 -2.7718730922171199715;0.020890036008603941192 -0.058976707623813087733 0.77984043992536244971 -0.81719939705834543364 -2.607137858050209811 1.4638916541246849157 1.4538911368614457764;0.12463947933932199852 0.027682629725619828376 6.1174789985337998388 -0.073388703823142054095 2.2554945761018014849 0.49642555977563979086 3.698290715561706854;-5.4189725260972076981 -2.2433957324290698665 0.047994098610894833645 -0.051681875632178915503 0.077738145635614874784 0.26781045220139304552 1.3874877248182573286;0.44526527641926749723 -0.086018711012739043631 0.26101431845630185258 0.1577868619407982731 -4.5610547835378136838 -0.46175037488543529962 1.0824703201355467819;-0.56175484463004343727 -0.49279023516089548451 1.3466943356244407415 0.066061315519619204228 -4.4714372685473486868 -0.69182037987373401489 -0.58895172436247722469;0.33886242864782395445 -0.20104090554927997458 0.3268947947651103525 -0.19680745168910104836 1.1752252666654807722 1.1022539871939993628 -0.20998512701082699961;0.31795117418352308869 -0.14309017463099388268 0.82513762436959603441 -0.056841808544543383219 -3.1934431239521123835 -1.0576006328095328701 0.39694300017131933789;0.037727980178411821277 0.12634217400447003699 -0.28583949669104830038 0.16463617332744698296 1.6011397808044700586 -0.93543500620855035699 -0.83672477076697904241;-0.089889407519024924764 -0.14367535221384561406 -0.24060811957445113474 0.061863326620950787049 -0.72190749261125497505 1.3668958415937677575 0.29295065731776487317;-0.018162828816511527447 -0.036483666779036680317 -1.5409621217722448971 0.46499194880727351409 -0.54774797298310529126 0.028119415427288702719 1.3997413837014021087;-1.2246709190844164983 -0.17574132797808889039 -3.2572941999725024687 0.16948966894882733225 0.5345891104132969307 -0.84014188315059057377 -0.88708099201982271165;0.10853995345725984956 0.18290552359143630312 -1.3576642367082247809 0.19300382931414175602 -0.92992156811262383087 -0.89187047149778020394 -0.93625205957146684366;-0.093114322863466852942 -0.34825235048178893038 -0.59387031852490568262 0.05167597942612171813 0.30387110761963376238 -1.3688945554877218758 0.56663101950448346855;0.57193632369937286164 0.84152071407153550275 -0.93181979699275452322 -0.17976445568384788465 -1.4348596630829499876 -1.4020690649179861076 -0.081864736486387132408;1.1804924767748810055 -0.8758268552637443749 -3.2990359735602567959 0.52790776279102336055 0.4509971316607454539 -0.82214952859246748229 0.75404594423028914463;1.61307473572488691 -0.15889094676919751636 1.4032170934120311578 -0.30438799999242743821 -1.1442889781114233827 -0.063268118158884625868 1.1623258919262229316;0.90600729757601616843 0.55939202019491496287 1.1280953100221020602 -0.035374419717551980336 3.8071305144735281267 -1.7105860584844818639 0.56174234935885869469;0.65183993577031218436 -0.2976646891295012809 -3.1576676053884296103 -0.16857655138064353562 0.20509811286813481312 -1.6151795622817421982 1.5158972219016639826;-1.8050685474496135363 0.21689325374464962781 -1.5766279236754436877 0.79199721424824087723 -0.84891972823999328757 -0.45978223987186678245 -0.49003408844844398295;1.366111224058470075 -0.63836524164765984235 -2.5812852022644396932 0.73341389045681215642 0.30694064266156806386 -0.57660293937855644497 -0.040251112335581047674;0.79049932374192177775 0.29402648194925001812 1.4071415272479654845 -0.28086861486733283311 -0.54230663630017006405 -0.26923350668815626552 -0.18698473502658616296;-2.7995608545713337456 2.2845273940990882267 -0.19269362264157777198 0.091534341890462223024 -2.162423515226327364 -1.0059884413347084386 -0.11534976373408874217];

% Layer 2
b2 = [-2.4521599967625844485;-0.18216340869260483348;-0.48375172640131208768;-1.0017690609164320303;0.20275502522972160824;-0.83774063351534522326;2.2438567099849899833;-0.35839844978718921054;-0.88771431449557169913;-0.94314794782369404391;-3.0967055075523135521;0.26671130574457319051;-1.3390664288367795098;-2.8399238430181923398;1.0309430461495630027];
LW2_1 = [1.2314119919734298758 -0.11975826677657215591 0.17196962430448223258 0.75634504959106996225 -1.5743117305207061651 0.10953618360089155404 1.0500028509153280787 -0.13206126790441902186 -1.5277468667230784671 -0.46911631647061369232 -0.56173695660119038475 -1.1388933144990727175 -1.1471579485024321343 -0.85302911329543229524 0.7242289983321396063 -0.15505686538201041147 -0.5568005209347648421 1.3583276820393335171 -0.2026028806022040496 -0.15923430470603877618 -1.0079059776286036776 0.24231399365866285178 -1.2798445886463349908 0.55947699784168769543 0.13023118076540268762;-4.5766207806419876292 0.52519404216373699601 0.49066087151344234263 0.97927327121648055641 -0.68864114232797235537 0.40943731473207706228 -1.7529058825514383102 0.071072199384950962564 5.2606776548917455472 4.0223788002073543879 -2.7381505641434400466 -1.5840757879492113336 -0.071200362223831165087 -0.2928384758444669278 0.99871216645340998852 1.3276981014161326478 0.18434179245212545251 -0.47641961658615417097 -1.612495764457458014 -0.11636259380914931727 -0.87884904634574789739 -0.47835323297789417163 1.9016287071562323341 0.69034224921724973711 -2.3671932351758786517;-1.4795810604615711181 -0.217716177641251174 0.45050717527946543273 -0.24751657281069977534 0.21518249890228494103 0.42984656770843521212 -2.0650432725334977313 0.39614668728379553997 3.3512443120395793983 3.5260083310237910759 -1.2886257154437450456 0.6737068976422779798 -1.7303394516273180592 0.38206425211967720568 -0.30175390318423195302 1.5422018097549956561 1.1661921723620805036 -0.85778474253194381127 0.074428056830771915919 0.3704359604862759725 0.7863303229504416958 0.14421500484103411122 1.4288749567509106964 -1.9158509547771067627 0.54673139146037486036;-0.39520084961847484761 0.0083725641957392189785 0.17386828613616753247 0.0793114272170507284 0.49528179067887778686 0.091672223582588613366 -0.98066564223397123534 -0.19910066224081354735 1.0126488271552915865 0.12186028869571448319 -0.75807272638442435575 -1.1865890252372659486 -0.7518925909011815456 -0.61166864629745787418 -0.56351438345545723507 0.43109737942023118595 1.5616118062035997394 1.0262265181216263521 -0.18338852729583240975 -0.76455116728976424412 -0.50977306344551998052 -0.58586727402636573636 0.55537375646818532005 -1.8777274735507334391 2.3584160007675141202;0.22551623998778125291 0.36707430219275027916 -0.12157882539587025472 0.44807580249091777391 0.37685013421704399716 0.50828246430564893998 0.16872500528424921873 0.20050787474830958357 -0.02075278790274089416 -0.99386181642687343452 0.9821825633428310498 0.41046679249646056409 0.50122508064649184956 -0.22957784528959990222 0.3481867708715528642 -0.26965088324343899906 0.19477323341159888392 0.27820767938190593682 0.33632792782444409507 0.4656022818594799384 -0.82008627570107128779 0.39696361441623323474 -1.3161676610198338455 0.27441776370157017206 0.16048094271136875699;2.6855928216745676984 -0.07494071663735975275 -0.048188050390420421321 0.68716463921488279976 -0.24366329799285574298 -0.059860439105450018171 0.065234224584885647236 0.46947209047100080248 -0.42148429919638469299 0.2997633229805142796 2.4810186652587327139 2.4700908389358944284 -0.54760722456797472635 0.009678829991464002816 -0.033994445084738644791 -0.34735310229769766899 0.34725963663603232057 -0.059821501154008513423 -0.21380110430479917771 -0.16678050077481865188 -0.58340946088861345142 -0.16744355613049921594 0.53312104961979922546 0.10302926189987059169 0.17117394631046070619;0.23829328730362916988 0.01023511030693866064 -0.15499995000600322315 0.32923028134419957125 -1.6830753950343637637 0.0026871603917446281254 -0.67142582349741786185 -0.025230951194114354524 -0.088415869032737709476 0.66016589297084626864 1.7339647607049135658 2.5387761441261926798 1.6548581852322437058 -0.064602264982030185858 0.051483226873526730105 -0.87325642349870524761 -0.40114529477798066548 -0.24500035052461313634 -0.35249280831725177121 1.1209053671314861411 0.355881321353102964 -0.13859852999420685382 -0.73522145214458023421 0.10649513684982958583 -0.26266633180116305546;-0.30992233657030299199 -0.28837855327087830171 0.039055884890307139556 -1.1517630808898640105 -0.64216116101322329168 0.078887523741188764204 -0.48291847029992007734 -0.7151598326175936382 -0.81849013742442011665 1.4941282063448269035 -1.7434370843642443827 0.44821228843938781816 -1.0354404153015892565 0.36058781705335873902 1.0410129624717718855 -0.13861424599136307201 -0.52861147012541964685 1.4964165172631365142 0.61554941547713371008 -0.36538999900822261013 0.81145027705818639774 0.87580440272662296586 -0.69759367164051910848 0.36491921145403521942 -0.105779252349397071;0.50484040156491361007 -0.28922290002839817769 0.018103652905526609884 -1.0022689265552253701 -0.48785548754588858866 0.069770416896029890941 -0.57258447503003151446 -0.53337348390928007724 -0.67900005967553922481 1.194519382192938517 -1.1006092738514701157 0.82645617836348084229 -0.91306890881174296304 0.27032615833671552741 1.3227535913366283982 0.52691404970636579463 -0.63278932872088755612 1.0632124671065521504 0.49586271880079546559 -0.096947707802266441801 0.61397989295977384305 0.69692644666464387271 -1.2277589596927243054 0.56276122038103415512 -0.18774752286355247954;0.84920102629531302174 -0.50058024904147491174 -0.41271588692122807007 -1.2357755567912704908 0.57437485923831932411 -0.60859827044116421302 -0.80737620007394772514 0.13991289075834234534 1.965894844271291797 0.081678325293787643058 -2.3770925790604349181 -1.9119489254536841116 0.94089128441458391716 0.79729590826414675764 -2.2701438125523396572 0.68992908581844925031 0.13265172405073100137 -3.9339354637523462621 0.43471075190436975211 -0.030405938813210738741 2.0576229339426639342 1.0484913170937837368 2.3835393838775074116 2.0992614456108062981 -0.47381310142690447051;1.3089708686286163353 0.42780009713745154043 -0.17421415193895820051 0.56124394651975906267 0.15669278879943038252 0.21616705554662465905 1.5180848138928162427 0.025440863304292977293 -3.8485688410533458459 -1.0098907142064907916 1.5431606708965082131 1.3972145058000509099 0.25414206393350385893 -0.59080745341660967362 2.2298277749988555385 -0.25298426716663652281 -1.9617878393924599312 0.63998218444588550469 -0.76011590924269301084 -0.17362960876638522389 -1.6657251066017799701 -1.1416765023956259029 0.56852684234003303398 -0.52382526548388341769 -0.245508988764909869;-0.53106417621503709814 -0.30703497178200328532 0.12978587688225293184 -0.13349252267888173096 -0.17432041152100408166 -0.32919564763368974747 -0.53656698847315942302 -0.24298005610909151342 0.032173999574426431769 1.4713822759773755866 -0.51027401617736456441 -0.030646386025430238931 -0.60074440497473535761 0.19335726723536769689 -0.2239043212248262027 0.12870608068688801917 0.019206935114317189028 0.10820743095016691071 -0.053341142829119066182 -0.41279377006882705947 0.56733640734995804955 -0.16302305779480960601 0.97117514371129043393 -0.48420447421812817801 -0.10195879525805170984;-1.3369312865441151938 0.20082628523769313622 0.096502760900012918288 0.02477208616024796986 1.2417070013195534717 -0.0067795379011195335689 1.1800823537816207409 0.20207726064634198848 -0.49779300098572304423 -1.1086834102141311931 -1.5138409739507139307 -3.1074331459066026895 -0.67092293111285516982 0.0020233381851585685585 0.17057451348071347996 -0.58334564792100118691 -0.33981525375876436845 0.43464060571414869782 0.66112678954478376614 -0.91901126831716128951 -0.69167716721354055576 0.44655376921602252249 -0.050863861329094428587 -0.34002101296412290399 0.20275098403456831564;0.57865776378609012909 0.6426255906155626807 -0.09282197879332326762 -0.58302004923246719681 1.5880118405504421997 0.25942566647410286729 0.8263415156687925478 0.11554098295820360021 0.74135645762854063268 -2.4574226600852364655 -1.376095483583884338 -2.4184387865997889477 0.66075081039392224991 -0.33954151569623342022 0.39079376347553451687 0.0058413168811314525666 0.46907298570127947679 -0.43962428137512227222 -0.2310543729564194515 0.020870123092382744656 -0.99490867885581157903 -0.35530305849817150898 -0.28538004241481323975 0.2641054062801903024 0.45805196656290847468;0.10176115146690349611 -0.06683541881995616607 -0.17230917015138380588 0.071557836478207875741 -0.4524604349743633902 0.048176434464524693635 1.8839148574561426219 0.14557365274716302372 -1.1941123041241321623 -0.65400066070593898537 1.2858488212186598432 2.0666347336282511193 0.46407834198813574522 0.66744077689866931902 0.30548560831207360877 -0.25456826679272626102 -0.80945494818447671914 -0.10512065435461627472 0.21484884056520886508 0.33548387697766779425 -0.24381161987047864081 0.73234089931434154241 -0.22717762717933964733 2.2763075882717420662 -2.962379130427669871];

% Layer 3
b3 = 0.77743104199200596671;
LW3_2 = [1.7135385515991532479 -0.12040693148757602993 1.1122519956244432127 3.8001307284370291484 -1.6382917174688056416 -0.59323064563601390908 -1.0835506027853332167 1.3225453645839877481 -1.7022123399012996092 0.48700375763140246743 0.45612235617612645333 -2.7619666434685297141 -2.2622926510309828707 -0.70873804346680224775 3.5569518758101068556];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
