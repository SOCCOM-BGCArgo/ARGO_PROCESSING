function [Y,Xf,Af] = ESPER_TA_6_Atl_3(X,~,~)
%ESPER_TA_6_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_6_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7879209656760124414;-4.4038163344944969424;1.5852926899297363761;-3.9304064055500047559;-2.9744493621635745839;2.264013203979655664;1.6334153944470217734;-2.2046284804999491946;-1.8251400620490427773;2.6974968196730029213;3.7785569249458283991;1.1059135995683804232;1.1375152426086616586;1.1826653025048263768;-7.657275084412945354;0.22914045766971349871;-1.9294935276027516124;-3.285202559212551332;1.0194728703427502481;3.7105185155342876868;0.754303742266669075;2.9203712946753284108;-3.5552109510108458323;-0.72782712608035926571;6.2238469832771938783];
IW1_1 = [0.77723904659851072996 -1.4019144484561918418 -0.1024359296341909864 0.26291850897676194432 -2.2192292113885700999 -0.14153523793632150074 -0.40753547630222664022;0.24826944922028462703 -0.64004527814349820858 -0.77109880601654390286 0.14704820342481833562 4.6938427800145756663 -0.33403136574762209987 0.41464799756435244404;-4.07676698943091953 2.5203570250209592629 -0.6636190289451684432 -2.7971324973364199984 1.1479408148732814787 -4.8239502429071148271 -2.2583047748037072822;1.5584672907747871839 -0.089370416650792691704 -1.4735775050711295009 -1.3688801785847239945 3.4795596263579398055 0.9417897820338747561 0.3865263926006847206;0.41381779203558666236 0.44364519916532513255 -2.7738155859481841148 -0.41550764532934669759 -0.67319853643185201264 0.19719774751594931761 0.20721217124077623284;-0.58408724119776522787 0.62549330316064610802 1.3082543789974503401 0.7181031164375235587 -1.2686366410399918525 1.0053905923420589641 1.0064641456649499052;-0.44699061629606212653 0.77131761194093861889 -1.2031023694165248195 -0.081620193732126700148 -0.44272330153820937948 0.52990717048333024763 0.080946228583224991149;0.09332112644918322264 -0.35134256572938982188 0.094888921978968809867 1.6565844103629716599 3.4897731451992171081 -0.56309573481524244354 1.2936353112775669238;-2.1323683623859639447 -0.54662938447682196674 2.5845138957787945344 1.4322973656587623115 -1.6340773511068311663 3.27910590591577078 1.3782467578482640036;-0.75995571539254347382 0.82971184744094839125 0.30258874012297398703 0.47187614869254024264 -0.43634788185057693521 1.724581483990462516 0.13773743752818481956;-0.047319365636485651028 0.61133892281427948401 -0.39732185619225990347 0.016647786713217607724 -2.9164615634043031811 1.7820688520371013031 0.003242098114310752819;-0.35657909426414535758 -0.51336873765281931803 0.30645835238884117091 0.27736112617813152292 -0.91418387496674236026 1.4838311454752515228 0.23053260123368193857;0.22240309176930800339 -0.94881242512537344869 1.6070994461776484385 0.11197796553369214478 -3.9010013345249880956 -0.33651493494815115648 -0.17348256817125073947;0.45322145525183621384 -0.51173452275954467439 0.75279986400791265577 0.084646526801199439838 -0.81640318986986415428 1.8293668641037732492 -0.37270185371336173041;1.0667682975979915216 -1.0365957353392873941 0.058899429823988214139 0.29399399693595601457 6.8247389331964471992 0.23130505177727891941 0.095083364021086497209;0.9826285861972814395 -0.68152464758366293474 -0.91329199556063633825 -0.094812581728094591504 -3.5455480257617786322 -0.88293599604990091745 0.016899422012029714779;-0.072753918281570267856 0.59865263948897051716 -0.61429253414543827372 -0.97165041693109233112 -1.7512570282817390144 -0.35552566952731951 -0.872165967889808047;1.2688405649126390795 -1.2326317670268709392 -0.88495555864049568751 0.016801860770777506116 2.8809107587121323135 0.44423707996124084385 0.22792454023009636743;0.18950734611763739301 0.38917419100859740322 1.1410657172235405543 -0.15943982023876995813 -2.078827398595310072 -0.32386632309294566268 0.066228043370921141353;-0.77271082423807080364 0.86316173595586287437 -1.5464716153896984618 -0.75283117390538156766 -0.7180168549695957747 -0.77837750224726787174 0.19009950386920296261;0.71937290450038871015 -0.80371231909454765585 -0.065154048637976608171 0.5349277760950770233 1.1440115507877659518 -0.74495803281029915333 0.46949620127658625579;0.56174272323401430729 -0.69732204468945169218 0.7361114587369176343 0.088912818169922719358 -3.9538571198176724053 0.39175277766260058199 -0.15990447640594296352;-0.68205076700629618802 -1.1290728739782325274 1.9773106118346159832 0.75473834457132515929 2.4437008865892879683 0.6785731696749746078 0.13529470879273824968;-0.17272542593356957075 -0.75734342087887629447 1.0296724260743472801 0.54328248175407467535 0.24033062750474840086 0.24606458518408538816 0.38791285285699300678;1.9478807024008257809 -0.15421071635989777593 -2.4464550807760754303 1.0589691688864333319 0.17979273557414160445 2.3837141367026934979 0.46802640600647821278];

% Layer 2
b2 = [-0.18200741184205429524;2.9825554664639608582;-0.51561282503357663831;0.11604775836094989583;-2.079070133936113951;-0.14104010336069267018;0.019760003519013823181;3.9862267385179905865;-1.4198886133976591495;4.3965133900754791441;2.3204293417009544953;2.2727844172748183915;4.7093930252208249243;4.4153656215878829272;-0.38357521496183855092];
LW2_1 = [-1.6434873079667020601 -3.1824369879905001213 -1.149241628962534234 -0.85499526936004321964 -0.8142391137521983735 3.4754870165966122997 5.5956909341350327125 -1.9882587785389052026 2.1866274286265667826 -2.393776516420970335 -3.0964970836953296107 0.0025228246471589634708 3.5147672739452251456 -1.3855940285068928386 3.2697597937447735461 -0.14997472560625560445 -1.8258428746938235587 2.9892519901537282223 -2.0985527208822789547 1.8611163667759702545 -3.5160540293758466568 4.6714618814774286903 -0.49477371241801787471 -4.1321844525800903725 -0.3438039833230696618;-1.0683317581312405942 1.0116188641813386173 -0.47040229751881856846 1.478192887215840523 -0.58723074579006950824 0.78899038787825603869 0.69153688348072628322 0.20045527209564292792 0.92349931930598994079 1.5903904031132689578 -1.9622450327357954247 1.6866826794328906303 -3.7861463277654037185 1.022633254334662789 1.4374283769602635985 1.6416674368998964706 -0.48928577766975439589 2.6953074504006688805 -0.92769038376315038352 -0.58765198369559967784 -4.0511148766599971438 -1.5587459979154278944 -0.94297987563436524994 -2.8865519234780498969 -0.75018254475465240283;0.039728603618975510958 -0.070834058029316845917 0.10973156618505018611 -1.9141232827112169002 1.028832953730772326 -0.062167267712216874032 0.84043642612854752016 0.53941218233898102774 -1.0518830750879326619 -2.7242975220964491534 3.4982261748346741292 -3.6962389725773912019 -1.1324741460913765323 -2.9936847468822040952 3.4362429470122424213 -3.6192046322866429087 -0.5075096110678977146 1.3420484696439927141 1.0527731044313319853 0.7404991768789263018 1.8299770125679564181 0.72519355811329488937 3.1324527112950870666 3.2694929191762605036 -0.49097127843474563935;2.2496829735996590749 -0.17670850073308058681 0.068962572039769270971 0.25074047250650355334 1.0265797534221527965 -0.2321569843862531235 2.8694776620236601694 0.43457190712495769036 -2.0518273285931547534 -0.90210176040053990931 -1.1753221946062220038 0.34566972537737805649 -0.27128970730773060982 0.38080835631383685991 -1.0157426407120742073 -0.71864381508357266792 -0.56636526647769591669 -0.70241748028354866751 1.5881987779402919614 -1.9188029005964393203 -0.2130477158766150847 0.88698351937266095568 0.64867046685966422981 0.010414275620570748182 -0.2489451880886933699;-0.39345104828653326701 1.6041303232887869079 -1.4492639651311489679 -6.3450720607702999487 -1.7230902764664375315 0.51939030145785713977 1.0586845282812313851 2.7851095982088605041 -0.080800122967484469538 -3.0919232793487059219 3.2284356584894791098 0.9503610495326029195 -1.2554045511866345208 0.96419812580794517221 6.9426488723908326151 -1.3466769553019661831 -1.7495867233683455311 3.1299161389810499223 -0.37166571955692240259 -0.42979584227001105257 1.6139229688519671768 0.10898572272147129258 1.015908788905441229 -0.49692724243259789318 -1.0719908077457718232;-2.6027746705241079361 2.6090328707995156243 0.94283654432652852506 -2.2334008150635593637 -0.33164308346974680219 2.3838579246348339247 -1.8231955424182917369 0.079545464263362494761 -3.5107678406505433699 -3.7953959992211658836 3.742432875235047085 0.86189154949848245657 1.0163445404359452429 -2.3536487742737546291 5.2909289433655164459 -5.5531421588469411788 1.4298846901180497504 0.9506493194688434567 2.9627779844817152544 0.85419280669622243973 -2.2821664369622260971 0.91316833846868439295 5.8943561866671245753 -6.7059526115122514156 3.5729935081018249221;-1.2823995687769738083 0.41162797671377976405 0.12543479737809876129 -0.1520044894678981573 0.28192609444748512049 1.0091056709254588863 -0.38388525398996564686 0.30465934487136048237 -1.4216117929073661674 -1.3010780353059208103 -0.80379498950650696276 1.2768774742174491266 -0.3912320621463946102 1.0823673513488603071 3.8015553784554469985 0.16327643785726489445 1.140022384880375439 -0.16817277629569801767 -0.59057339340522962967 1.8466640863853860388 -3.3128819495389976169 -0.41236578736325557593 -1.7506918022072652796 -1.3647561906166723045 2.3735702779943834706;2.0724023591271456546 -3.628145031871270465 0.3185124087051441899 0.82142083544698663022 1.2305127607423285152 0.22482580951757435983 0.61699411376771307047 0.93119452204375241511 -0.37671742147292613945 3.1759032602650512089 -3.039151873696223749 -2.247240518836412182 2.7901423759879580011 0.14441590845002807986 1.4946512682567136832 0.71818305191413012167 -3.5785805906343086669 0.79840069407765423826 -3.6807464450377187504 -0.44466255053578152001 -1.2558145864801020242 -0.39598795214073467807 0.45713943707736748312 -0.14339132186963290949 0.23629589097759640115;-2.2425864672038402503 4.8725156366703048505 1.0336799958991704784 -1.8868073970381986637 -1.5730512929768010189 1.1256929688207386597 2.7264290638236019504 -1.8330204277632391463 2.949243581057205521 -1.9517286037921999231 -4.4847009799039767586 -0.27170541357879640643 -5.8072959243098560833 0.74410506319638147765 -4.3390842982454866927 -1.6108559588769590931 0.17903659672619962051 0.16754692230763590377 -1.5562223006382045476 -2.0926457679391834432 1.4622973651059985034 -2.9517578008463329908 -0.34598435749365530345 -0.13400586387221039009 1.6428747132136414244;2.6721033488117211796 3.4150099602495318507 2.4986373260140171126 0.018541977201280354648 -2.4078973468077204956 6.3945730878928026542 4.8465173148705549266 -0.52442001523004166952 -2.7408473532969019892 -3.2500874038006055677 -1.8540572919723468104 0.87352477123237914913 2.608535851539035999 -1.1706765210879610528 1.5141774712448983209 2.2835931870094556828 -2.9030088139433591898 0.84432328088044261705 -2.1028864358625072306 -3.7235056554588323863 -0.76012140038555586763 1.5306716919380536357 0.19906416068914700723 -2.6374875837653513067 -0.9964142984193223862;1.5883893323115503282 0.6617376855072402142 0.098566785688665933818 0.73453228013743465663 1.2606721138084699962 -0.71978051709545054493 4.5352112212857171869 0.44452987821016320957 -2.4411902842616939324 -0.8481964484883389721 -1.9435546464190005533 0.074813414915038928266 -0.66808403031160545904 0.83912982183709916573 2.3905695399589341754 -0.60350829115598036978 -1.2492180270456259006 -1.9722979101833786331 2.6099253373810409329 -2.1470582891639797829 -0.45569947344802047562 1.6436995574802613085 0.84297725225466002552 0.65347215099531286153 -0.28112912800640488253;0.80857865072340051604 -2.7772396413866387022 6.0763111891935661646 -2.1174171719058514363 -4.5514290228230294133 -0.061201996660055074662 -1.3468599802468874671 -1.2468337072833897139 -0.53328358045801138587 1.7584882433603887808 3.0049257271004066183 -2.166332812236336558 -3.7847432599704351475 2.0849784758601805912 2.2396710010932245893 -0.77428363200576877379 4.3182791490379681676 5.9709979591079047623 -3.3558167678937560474 -2.5881290008510640099 -1.1964754013551477385 -1.989262874060048425 0.27578597361438494939 2.9965644900211252377 1.0235081821830558368;3.7081258054277186353 -1.8156302193581876914 -2.254350775577830035 4.0608009560927653681 -3.754335178655787697 -1.6749304285660795433 -0.16763395457982910308 -0.039168137868001218216 1.7737955666110363229 -2.3719116885150905993 0.041071174798865468791 -0.98286115183230582382 0.32370565728917505277 -0.80281668888135482298 -2.3682286686296158962 -3.8025375366805991284 2.5555643394219842435 -1.5118243372766753119 -0.34905532187254462162 7.4297670107189341948 -1.7634201825764059812 -4.9414164009020629109 3.698880153484593869 1.7728455998365049151 0.86312535541022084029;8.308884440710246011 2.4112489924578053291 -0.536868459674671894 -0.8196522617552969292 0.68854996541554203127 0.58406933038703456873 -1.8181040850027248013 -0.026471354219495955157 0.15483992650466255059 -0.72180084682747025493 2.6548912004570754952 0.94222516219874563603 2.5774079454125349287 0.55952730825136687276 0.012973122537383210973 0.38881239318856086751 1.0371371547345007436 2.68334908024224017 -1.0493788740666543102 0.66178092822579992482 3.394327315469094497 0.70018895965354066568 -3.9602146841708263381 0.28245445613546815711 -1.0493876256698055904;8.0218450465446000663 -2.7835709480947619099 -2.7876977770062554285 2.3214085108810205149 -1.6866481445750665102 -3.7339072692835957312 6.8405597271749432053 -1.330652031766539789 2.5738320580076159416 2.5415793194082989537 -7.2603979374726330676 2.1913057228573284974 -1.4394264325016521422 -1.6503435467058114039 -1.8320591351619817111 -0.56752591034641275414 -8.8956573504173803713 -0.018145059714605556861 -0.66823731114340700898 4.4082806082122587554 -5.8508280680816611152 0.33428951675803114663 -3.8268226630059669624 7.2971979012249539309 -0.063336621349957406002];

% Layer 3
b3 = -0.15207185509237572396;
LW3_2 = [-0.010930889002508671279 0.0026160028475250367806 0.039593774000752007813 -1.250342148364757433 0.004747356982045736716 0.017526103997339115281 0.079711388078789066625 0.33097817561331493996 -0.0040273168249813926303 -0.0048212043113143778633 0.89804031276382445537 0.0048336845586138613151 0.019159091394578275924 -0.018581078962190526044 0.0057213040216085048889];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
