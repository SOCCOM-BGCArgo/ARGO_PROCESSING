function [Y,Xf,Af] = ESPER_pH_9_Other_4(X,~,~)
%ESPER_PH_9_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_9_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4273950908243362434;4.5767054656631662723;-3.5554861936669479583;-1.6474015802667203445;0.91488834130116403198;2.0965252112699692688;3.2371488708831250847;4.5141717550166093886;-2.0507941614744509273;0.60146151210920317798;0.21080088145240921671;-1.2968469111501901292;-0.46762373058549089322;0.91970534221772937133;1.2300970856348580895;0.080859600946758800055;0.77079315992523866896;0.44731309531539931168;-0.84568197257216404239;-1.4410728609072644968;3.3055602741544314327;-1.2578024396543379115;0.30413177731418628014;-0.010609403850742910036;0.36346472373244859133;-2.7877808452809023088;-5.3459172505431791222;-1.3733828783277111096;4.4190327710547361306;1.7276069817228778547];
IW1_1 = [-1.0443332376808089901 -0.62903700114207494742 -0.6320334964362025465 0.32760030741579265756 0.44584654517785271555 0.9486506870746004294 -1.5499046489667109849 -2.5717167024373797091;0.03046766586354142034 -0.14883875949840952302 3.5088574895988373648 2.043417621057330269 0.98068257835420802326 2.2304878190008730066 4.9744910920376694818 -2.943869977177052899;0.20630075496274868918 -0.021733011283125373836 0.055178656784560853321 -2.6131755212969429714 0.013962001512235032094 -0.70129459691444062663 -1.7799268621567350124 0.73888297446713124828;0.10990455284341878184 -0.084707719057623018233 0.084378831476005639045 -0.1541966277289834597 2.6389835122335498774 1.5622728778326970822 -0.84016217145545035727 0.61764420447398338254;-0.80690264552114099317 0.0080670626671545293818 0.29369594444384344856 -0.19755975074272860703 0.034818570650129838928 0.052414379673420607997 -1.2223809521513584464 -0.15550625920978636274;-0.25662818165800282966 -0.68823909029572061247 -2.0023854670397152056 0.4298158748913341598 -1.1478146802584630048 0.6819926818152707293 -1.7617752982031609221 1.7488578017931402098;-0.27197571883403626192 0.12366623535803718259 -1.5071851503414233076 2.6351633239757839 -0.92796654106280584973 -0.64869806876309810129 1.0230453319559831282 0.42786379541074598398;-3.7304071598456474135 -0.85475066086063589132 -9.2643332122983910182 -0.89028418821636223779 -0.55279865774322034522 0.68103219194248820756 1.0230530350413804541 0.59442593877843119543;1.125917852825773835 0.71539048159724283327 -3.7370834419683212069 -0.065156599609998963607 -0.79775129413636269859 -0.30076099051486920866 0.22521934007439406433 -0.43978411218436935792;-0.037469181697475463511 -1.1578172904788439634 -2.578389550662222085 -1.4819877661943579028 1.9102009445721888081 -0.14668405572787920899 -1.0551058326011006905 -0.80822935097106662905;0.091465474511231714683 -0.042130873318085015899 0.18774876011120489316 0.26912610242962869966 -0.083061334758274790735 -0.024606622636559778716 -0.068412277241173088949 0.12218908306346619452;0.4234160837894528906 -0.14077751760335951992 -0.53386712621679099922 -0.074025904766105155019 0.27621660228518890579 0.17026729003835872067 1.2283722350130641399 -0.17192767493836774717;-0.99461915865687478 0.95387119097349104546 2.6384377147059820956 0.21171133810921921592 -1.8541167945266952 0.92868383957652955729 1.2260000513031226177 -1.2154266147623120631;-0.68782270694049174597 0.15158911061062033121 0.50685213689679897708 -0.087306506850053755553 0.10534799614591286443 0.31401507650401522254 -1.1429522709436634731 0.068656947183507205379;-1.3739303350831402195 1.0469415237906221083 -1.7934896874888939244 -0.56413254162551917936 1.032326664139258332 0.18742158801278743785 -0.70865751512027141956 2.7419189305176216997;0.61608849604573145964 0.19154096540817222571 -0.22905513507157021502 -0.16297498236822599571 -0.37242897266795860212 -0.49549324240454284407 -0.62743543155789804899 -0.1831033486835174362;2.5783139094198253005 1.5142040045318725383 1.7049302808851161117 0.065078716977564537993 -1.5879086378703202165 -0.26633728147611768211 -0.48260865265582225669 -0.3099917511455119179;0.6780820505106385232 -0.19425694233908277764 -0.58506293757408500689 -0.2500823100428834489 0.72784389517758807386 -0.73585004004893128648 1.0856771728917993247 -0.24648748914471915739;0.1802115398029325577 0.0019955469881515605288 -0.59705303547940358211 -0.7199286026992653964 -0.056071868438911154353 -0.57575565989642119025 -0.12532522363286352496 -0.37080195379010155721;-1.515161758321388108 1.510611157425105544 1.2579310649506796338 1.154565500711687509 -1.2005898409055757448 1.5327624238170076687 3.0796619905922599791 -2.7514417255468703871;-0.41433451891788009025 -0.40581976340916325885 1.3005589860502888566 3.7710098746009457216 0.91975825087033236116 1.2470191611959682287 6.0549718928683313734 -3.1378032215606364019;-0.13133724519511139062 -0.012442072871984380736 -0.64757841380791880681 -0.65958804764952094768 -0.19608407633292671002 -0.33632464079017210246 0.081004207142998510549 -0.40697604898047440303;0.88481173687139225148 0.52588824117717247741 -0.46343684743687546534 0.1899612666794432414 0.72777235563642850291 -0.45116799724396378091 -1.8993338736283060797 -0.080856021568830621638;-4.2886983497705166712 0.61191961023104712858 0.99735408741928688325 -2.2204753429474357596 2.4507707457037084531 -1.3125308705164553391 -1.4931261985109531842 5.1600637295385514136;0.019591682732207318235 -0.5085429974862721858 -1.8059109928724612626 -0.49594209833967500822 0.27807017154394242375 -9.6740428036225060981e-05 -0.74191469605193782755 0.26326375104895710644;0.096743615209334304916 -0.46532563917070246529 1.290385764535151969 3.1210578032400300152 0.073823183250684085155 0.38494819249144290874 -8.1191509992876422785 -1.965377353379380132;-2.0787327554087569048 2.2641094085862834007 0.6817217870255513068 -1.87042791392555241 -0.11017449339511564688 0.8754904314770769469 -1.8455163893881652015 -0.86634941870640658212;-0.19610843081564044432 -0.39037157758229612536 0.28560532206935013155 0.67290289671300274055 -0.67388820770221169454 -1.521622156499764289 -0.44294969880182671895 1.1972365319255231508;0.16546350530057493677 0.17816488536551186583 -0.79506012861268993142 -0.78087973111372122048 -1.0268276050957649836 0.62478033585688075302 -0.11332487391296319768 3.4823969795838118912;0.46022627066839494336 -0.2580330030693378518 -0.24906842093845119046 0.091444136432673364667 0.92464651275957532306 -1.194933099001515231 0.025394213654205789049 -0.33912857195387063891];

% Layer 2
b2 = [-3.4034851208996230731;0.078026398509110195256;-0.8650504692546024943;0.98160787166720908647;0.57015338084405275954;0.068213991450677219364;1.2343321333351151559;0.50552880014971146583;0.86090784626165328675;-4.5565902253510621733];
LW2_1 = [-1.2422509925703479894 1.4719675340779225792 -2.4480385028508049317 1.3194243190112133757 -1.586179127657808996 -0.32565507854632941287 -3.2776228494233827782 0.55541452933592094787 -1.7819747839852440041 1.7441222244140024422 1.6655980328178188188 -0.87825299836884962446 3.0596537134906811595 -1.6275134114448108758 -4.5600150721952736887 -3.8642546084485234203 -0.45753923125125606219 -1.8051491959424637024 1.3449412551423767237 -0.13500211604350947914 -6.3721585982268154069 0.14424125224579456561 -1.3993634557063709956 1.0952839660584696713 5.7483200651723960206 -4.1156358363894236518 2.2736066620866592913 -5.1688571057381649254 -9.0987882988811481511 -4.7541575120862935577;-0.24139699215366572371 -0.50526274073851284996 -0.59350990911461598554 -0.63569060297404056392 -0.83417488220021840384 -0.099538551055592824901 0.15154526986256100507 -0.051255739358961938112 -0.24420962690742892276 0.12977272337872217123 1.5603566511792412719 -0.23995456494595329699 -0.23958928116716987633 -1.4207900345738022629 0.23262025627240484615 -0.83187163683128251268 0.081387244999799795986 -0.10466056781283279709 1.6572979193488128757 -0.31841068342171779948 0.12069515060924058958 -1.9261940726744359864 0.24605117758353339807 -0.11910979029173443533 0.54173103584572290803 0.025576338243899147951 -0.0010170276771340580179 -1.2464550248483770023 -0.14000106133938008957 -0.1891695250991639321;0.20228546079449707951 0.39560412434335878729 0.82241852709863771942 0.15143827633347370365 -0.37189667106118018403 0.24885899787106502412 0.52084524638844997835 0.14062906807547823074 0.088630983524209047686 0.37783491048722223082 -0.70456352612519157486 -1.1801567977314009195 -0.12146532095012274599 -0.49528959575054987141 -0.23379394541355341675 -1.7521167038538461025 0.2904028120977801275 0.23930345530074620397 1.948630409355160964 0.12907913326703279733 0.096558852932153119153 -1.6504335191475019151 0.23052466051308337369 -0.1250533546473062696 -0.70592014372636879838 0.086475353486958242422 0.00034283556708728944642 -1.1076960449779420514 -0.74084018788433336766 0.0016961585029678927228;-0.3342668361373009045 -0.23227471220927770057 -0.79067652026057966275 -0.72254360969348674359 -1.0534780694171401727 -0.15820234972765476189 -0.044851749804346467687 0.053493333269013051967 -0.28208673181065929692 0.12226954033169779024 1.2581341537764032523 0.4674067379800601052 -0.37197077994806571066 -0.52513490494305081757 0.3087977153932670582 -0.56781671141962164473 0.12524669758198761493 -0.92212987056621342763 2.6721525624115081143 -0.30830530993026783459 0.040905615032343231596 -2.9045774466699665339 -0.012874447811261902075 -0.19312890751117345323 0.61318133916273298567 -0.012553581066770213778 0.10147459385507891227 0.072846699412971033238 0.10057113848376145193 -0.044493579830586230117;-0.27525602035264923328 0.94183566649192518305 2.4248373847774136181 1.4766385622000604005 -0.42850358450470921179 0.05700639677968459551 -1.0400139052806851581 0.40580474181310821624 0.15491121994860995725 0.14124404137267351778 1.0384507069083483977 -0.87355373210016606933 0.44391021301747651817 -0.50335389623237247747 -0.055340660787498358042 -1.6298561921283791776 -0.13955960155093058428 -0.39416985101680918069 1.301709518717956815 -0.30184141563271055242 -0.19328771836457467326 0.61271934745858802618 0.6177420500255537128 0.10044671204412471133 -0.16251514810176448389 -0.66387078139475241834 -0.42206460120666372537 -2.2804791402828077373 0.10616517060506978909 0.52858518233804652198;0.086067836768678240844 0.16688241206328080501 -0.47526192399870742511 0.49257989405261476401 -0.41610136899447641712 0.14823369193242366681 0.44776202040877116639 0.25393119253320056705 0.24251154791443246816 0.34403870094731614504 -0.084170657324878009331 -0.32797535477010264504 0.12956259650359860935 -0.0016097349354844518732 -0.22281312919214255053 -1.8510748323062888865 0.17329747307888535013 0.29902856451820736261 1.6320885862049270276 -0.093886740085355913088 -0.092312046588428231519 -0.9620046087788828304 0.50873439126803410293 -0.073218300540801570242 -0.5448936577668512804 0.12672225617638566142 0.37167862593246647762 -0.17338548059723601913 -0.54388902207451594872 -0.2690605344038757285;-0.095064625695823495866 -0.31163426700864249597 -1.0232474207061839078 0.69398086222712596083 1.7083720714352823578 0.60606194196438623045 0.67629923126411728429 -0.039273126095746159481 0.30216030482300759719 1.064786529381261504 -2.1076639786983744074 0.0012885571895853726448 -0.75841365253601233931 -2.1869567956907229878 0.12136718777498468891 0.98022734526105392838 -0.2173634160275437488 0.12938166686017868456 -2.3785750920836918887 -0.45473809358961087002 -0.28442495681277923936 2.1576336514929574939 0.11180084862954228764 0.099256000829362353577 -1.0076651332642045933 0.94260768045274823113 0.042926975284682443446 3.3891521604966592385 -0.95510810338557261545 0.55592980174872275168;-0.13329581128501277743 -0.65357151628834420087 0.011174934137614764285 -1.7674759557026906709 -2.095613863339603089 -0.33613335806356581248 1.2350810221629897612 -0.78640125841503105697 -0.64216781750488105551 -0.086338776451426152425 -1.4616037063258169315 1.5340437231564520992 -0.94009454932358016421 4.2143546067666344257 0.011649290452948643515 1.8363449894403067741 0.028715136178894047625 -0.2870166162779861363 -1.2632861408963607097 0.41677867319840466998 0.18913786258903705906 1.0648207627894490379 -0.65285421284205247261 -0.15352799684846740735 0.80734380110794301544 0.0059643135446576459741 0.30874661878249104463 2.6956343230530355193 1.060780989281034925 -1.2173439610481673334;-0.049532703193326164948 0.098009355259265476534 0.85789110464192153138 -0.39395642987875884033 -0.059753411432982628249 0.03592193016195803501 -0.22817237781279148257 -0.15831091379280112785 -0.27328100027080609591 0.059468965416406234514 0.35924117518781845115 -0.29256840042936316237 -0.41590787736169682054 0.017713518057866046301 -0.012023269595662617812 0.15558846993007968695 0.12388924554332901573 -0.72488111008429123583 -0.066914601072046997476 0.30697731372914843773 0.18703387577697444533 0.84308216270654035007 -0.37357907041241267265 -0.082306829165744860299 -0.27050539675997425926 0.092185457840693249554 -0.24245862937105880364 0.26598513630474263092 0.12942310404568979632 -0.074341739368318088266;-0.19312091877482889801 1.7389975948157547769 -1.825521170118669545 0.26564154699014141947 -0.80874855968331638145 -0.35309437186417919063 0.074644631311948705932 -0.27106130404334044526 -0.5689727563177578995 -0.013189208009668863808 2.9335573916781019221 -0.42433991920295094369 -0.0078243134081543673497 3.1164371537177810723 0.51231684923842046864 0.61095504391776167541 0.078396648073607341778 -0.1314280061282259715 -0.29814039276769471742 0.12838099847542314147 0.1799949328680548466 -0.34482608636914169331 -0.07884396830918144472 0.011374262997591227942 0.66457329886601934632 0.57561735930287116769 0.50917652162550042227 1.3620033195690450789 -0.78966556469072102242 -0.015344982997733267599];

% Layer 3
b3 = -1.6216169053949540668;
LW3_2 = [-1.9594305065070345417 -1.5315178369446358353 1.6198560231412841848 1.3313282040603551248 0.49303862742897336391 -1.595722491537287846 0.8572303416595181691 0.41199446946982909434 -1.390665918592084882 0.47633031315208457235];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
