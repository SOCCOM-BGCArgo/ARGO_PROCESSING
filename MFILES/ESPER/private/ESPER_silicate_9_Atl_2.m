function [Y,Xf,Af] = ESPER_silicate_9_Atl_2(X,~,~)
%ESPER_SILICATE_9_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_9_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.79952971829079366728;0.43677577055616262358;-1.2060397877539916767;1.2025116760614162903;-0.41473472196194227646;-5.853224555331207668;-4.8751167921034079811;-0.73883548146576272231;-0.63016022745300614982;-2.3054818498228644152;-1.134378736745020877;1.0913920440600393125;-0.27798358974788217601;0.35095625001337676929;0.2275500476817028106;0.60491984374175389316;0.13524717940601169164;-9.7818814895688319666;0.063831646830343716226;-0.31723976029160821932];
IW1_1 = [0.80630112065075854044 -0.72546756878504969901 -2.1410309070138873189 -0.78084623875304826068 5.5987822498295436446 1.5545685480522191124 0.53612364499131426321 -0.14547262650435416331;-0.25128463224705843704 0.031008544862823388122 -0.59142661606788149431 0.11922673438456093953 -1.0224794536737578099 0.54267561461791424815 -0.67447543603952841984 0.032919876842105962045;0.6424249279989989736 1.6311590322047782031 1.1255041006606700815 -0.27709995824520555763 -0.46176868785648522708 -3.4905043403654238965 -0.2472078069831250835 3.6423692366485802552;-0.22618285758578168809 -0.056606277952301255196 -0.74022286893229038984 -0.36503102551757943273 -3.3191048121168456042 0.44011814066767268594 0.12964674286876290421 0.10940967497199255432;-0.03959379369916522784 -0.10743552116757995596 -0.046453970848521396186 0.049141646499045593677 0.0021047302768686993769 0.088054712358140899142 -0.25498743610488106004 -0.26454492132553908412;2.336897717868979818 -0.18378782208014729505 -0.23035382196722384296 -1.280191796699472917 2.1660693828781591996 0.071909096473327271948 0.29558490089578914883 -0.42477609750082134799;0.35559973019350610279 -0.11748120886949323105 -0.33453187967197695052 -1.6420362369346011011 3.2120988374270349475 -0.019224376559259230557 1.0606823990427056703 -1.6663371513450679906;0.14731722271750058439 0.026637372178127342176 0.31364788073410354574 -0.44898204233526634033 0.99112177522516631267 -0.35030756726726186567 1.0807382401593084165 0.25163720916478671263;-0.11755224760273041973 0.023439036763881725134 -0.059497480712428607585 0.39605433811195089877 0.01428555575642386638 0.017606308527659257634 -0.22293055886096668772 0.11828014406967224392;0.14974338921636215494 -0.15257372347181147321 -0.094529136549278372503 -1.3892082044472728874 0.46099434611782275084 -0.18925282248823671605 -1.4822771856747791741 -1.063201660670324733;0.028148537371095939952 -0.012675415258260581963 -0.15342704322889680335 0.01283323399069537761 2.0568125805786876548 0.3138843223190324605 -0.22734945554015090208 -0.29501394407231806838;-0.2147095612737075776 0.12676947031547994293 -0.16607924764086579028 0.49427409364787361357 -2.335115132455906295 0.08899118132564833028 0.30765553976710419137 0.39685287103014893484;0.054424964785624106722 0.026972192259125220282 0.03189717699418683633 -0.13393550116050176313 0.33935349305409662213 -0.040296319602182398278 0.48944763296008991782 -0.13733024221692127775;0.10639184287436448395 -2.3220148738797738398e-05 0.072448600390500828006 -0.40843515364128307743 -0.97418614961315297407 -0.15671431862769497068 0.28298833572004128412 -0.15305071810721734837;-0.068553479170883849236 -0.13855045394187481822 -0.53492240523733414204 0.42148265150266206458 1.1514680303599711397 0.63266835256109943408 -1.3484795559825810685 -0.046524985797925147435;0.20653317754866615252 0.19343366532581637851 0.9728056813559431415 0.35087485223890879649 -0.91728975296553372232 -0.72064002728291376432 0.38337441308663144923 -0.75906445516174803068;0.18499951387910251732 -0.044971514936661079187 0.023408846045524601964 -0.72395188006269151071 -2.0776998252007334855 -0.10380819382946623874 -0.33043970936148781004 -0.95358662158096452188;0.89217902216969535711 -2.8674271962892223797 -0.89984860760946316915 -2.141643859563397978 5.6734836257005518689 0.34654851286721061188 0.2791133523006806838 -0.41768742031413508276;-0.47788878610016083393 0.19522173850655133442 0.10197799745564130325 0.94100050739912677322 2.0933903455529048188 -0.71716104518172374416 1.5639643887568057679 -0.461549969284208772;-0.0050678518144601572559 0.055613878785564001273 0.34374078365681587366 0.10064998092661824047 0.85003088189376407868 -0.5677388416151978312 1.0421464897294809848 -0.065696956835989792078];

% Layer 2
b2 = [-57.517451681655884954;-9.9433000637387518594;7.3692440897576201309;-73.424353132114063669;-7.2905908453447265671;22.402192141427299532;1.8961195585673908948;-3.1892411079963083331;40.628977330353741593;-10.434942994206549471;-7.9796476533841262935;-15.401247108395910601;24.900997659134496587;-17.679000393416565373;-10.69638974890775529;-39.728380692832232057;3.7344355199835104209;2.4871782448142214506;8.5231357696367542331;-11.07887343559963611];
LW2_1 = [78.374587386816770618 -4.1458156250649595975 -2.8487523611512570731 20.096696111841968246 -1.5054569451262440616 -13.438724392524832751 5.2564615408737509483 -14.873718719719951409 11.172699618265507837 11.015963799256441646 3.0882805966037980561 12.943923059899372419 -24.162102043209230828 19.073167918663763487 -2.831111944342183051 12.488877006783566159 -4.1158945398931834347 -4.7481622293501057896 8.4421415220826876435 5.6347826684877393433;-0.95251253994054685403 -8.0689041463389283848 -2.9402040856481233 -0.79717240802425259893 -18.874382202465934455 -9.28805295535894615 -4.267827427766973436 8.985535762857418618 19.731628542470097898 -9.3208062813850531825 1.2389810250405386416 12.529833567971655484 -20.701556262819881482 -8.1911172294355729662 1.8330270306291955862 -2.2512499689534664071 3.5116891921057669101 -21.120212973187111771 -18.839957381884286036 2.7423830593552644963;0.0010186240465811671838 11.878770704940567526 -1.2446526936177149114 -2.3302790891375884108 1.6466582783549705837 -8.4801332847083941147 -5.2885244763283285607 13.651284447348571049 61.370014168003095278 4.9888496757569598117 -19.945538957893852228 -18.880727978335659856 51.675212857789013299 6.6753273194134443713 8.738350228104399875 5.9704463066099933144 -6.2558912989987298658 -7.1659411518679014819 7.500619710827851172 -23.292560799691557349;-30.308570089866332609 -99.94996248098944136 -6.802721767063768965 50.118774011492916998 -6.9940501885239507729 26.835805076944058811 2.9646988305822934429 -29.40240305987589764 -127.7157789615937844 -52.380336435127446748 0.81392879680533214426 -62.233707469597277395 -3.2567544544163782305 -91.405955541907729867 -40.75054372433736205 -39.436779078698940282 -10.876102085238711581 35.634424492197908307 -42.524939807200375697 83.744722270657675267;-0.26593236152404725603 -1.4202932096604061751 1.1813789529148515101 8.4418565726213206091 0.99748832346090976486 4.0630684070484530679 4.0940000547218682314 -9.669174608280792782 -28.694536552272197127 -1.5092123749545445222 -13.635067230198554711 -12.849707374724502529 6.4482498338751819134 -32.477771638399566712 -0.9395040149888406189 2.4920704300077516358 0.61508243751542279742 0.69486123223573026397 -7.6117954800865659237 11.263578927242072325;2.5396126491786441548 -21.930008232969328219 -0.01779646891368884265 23.177236679388830254 3.244618737966601163 2.7971937972844278519 12.646696205106277233 25.173160073671006387 59.973718587296858118 -5.8915263707594016651 -19.017275723012559752 11.090088800834081439 -8.8522187342642748575 -10.470031374510682554 38.824576225893878245 26.840572252894357774 -32.54574530892547557 -0.12678055106995780865 0.13129240493016308688 -3.3001015820218699837;-10.93917660949488635 20.428833539353107085 -1.7954847145042498457 -11.710612260748376912 2.5671022092005029158 1.3290408912677111886 -1.9538765796506296635 0.90590640260279198248 -6.9170037606541683317 11.456794666499913404 -7.4887822127870160571 -6.9571826721656631065 -4.0749319353584043668 -0.52101539367946980708 0.4284182268770048152 -11.263679912310749387 2.5689646147750551108 -4.8230585812211010932 -0.3381378789489500325 18.775251148311802751;18.151368893777679148 -6.3608475703497813214 -13.776868763801090267 9.9805716037048259892 -6.0073326805674476248 34.874066026314544331 -14.626682992445818599 -11.77913381190870723 18.607690713299216867 5.119543634238842067 -14.498508064744928703 5.2570754050429204796 7.9861243369818337712 9.4557237943257455015 3.2623635203269234495 13.736128008691323998 -23.039120425884718202 -8.4586112966643618449 -4.580247773184601634 -7.4341074658614294535;5.0362998507580449825 -24.908412691471177425 -1.244292892652733018 2.4584526625739142602 -10.166103952455047832 -18.009294808548560241 -3.4800570389451297437 -19.797949609982918417 48.942113549749755919 32.788864004002341801 14.010928895236846259 2.2433260264935714901 -9.0766297299549218991 6.7124776056580586214 -17.548766319057246932 -7.8121292183953494614 -27.144598364196770746 6.642828086634144924 -26.089942847987504848 9.8038611296669966322;16.748483893780079512 16.731282093141196299 -4.1127803603426205115 -22.785231000258768574 -36.40532243453652228 27.507024275468818786 -1.1072549179783315321 3.0150817196039345625 -47.441534134399141465 27.03941945887719811 -22.713296252535400299 -1.1248017848129736596 15.875729510296096691 -25.466238403718818972 -24.99267807298382138 9.2547844681957371904 -9.4317037813041881833 -3.7471340813010836079 3.9961787449395846927 -32.371884244206661663;-10.680226262974569451 -37.112873282451388945 -1.7290302609903476228 4.8452607070101842979 -10.188163041217675797 7.282866556582741957 -3.8539524385231884729 -12.793106636552469269 -27.479478172097984157 5.8026861386888795025 -0.50321755131791501281 12.940519756439263332 -6.7873657554161495042 3.1161666951283080174 -8.2632431582301109074 -12.910502949685561447 -0.9203209088022452633 3.9235159898198794792 14.218286989462248116 -11.175726367128996586;-0.88649036835924821531 1.237512490285599176 -6.7298181862108528151 -16.038104247093759369 13.850869769846497093 5.7053511036933679534 -13.601418703665977716 11.091891680240467011 -13.736540085496235619 -4.3654765824086982917 0.72647728500148678332 17.978114949320488591 27.351328159975231813 14.812478329766062046 -17.152614334155423137 -13.448077915197400145 14.423098582327087414 3.7439762845526942669 -1.7384018341201930014 11.815346633083139594;1.3680751849826773281 -12.844135374889647849 -0.72212798249651855009 0.58426598856583955577 20.303157577426294012 -0.73956496357637757644 -2.6452252215339151498 -3.4678496323811156543 14.0786042773980693 12.450704782982798591 -1.708694001739740953 18.679386841609940006 19.734252940906436891 7.9434317408406558414 -7.4334578000642235196 1.2551291246351965469 -15.151206823511151001 -0.77026441557862135312 8.3641123943014612507 -25.115523438343412721;-0.26811145232683386563 3.0608410155789251839 0.27475508785620417207 1.9224761408647370597 -5.9619028266826088469 -1.8705704651586256837 0.56196567128878061048 -7.8500795239531226954 -17.843628122008539094 -0.31705067306630324575 5.9824042655893316933 -0.799217670410880765 -11.383041575298012305 6.3888157619281580324 3.1346153989633682713 -1.2959384662981039416 -0.54964393995989135888 -0.41586921503988388826 -2.4936706889671080845 18.29614213970835479;4.989999157259425111 -5.7877468692288180918 1.5281841267165436893 -4.3802058391643097224 20.700102379046885659 -3.0163179488818312457 6.7623371644706233852 -2.6698760856721222012 -2.88145417914210622 1.9160840574238784395 -19.117479343857599616 13.311774374991818704 20.495038275441928022 21.284023984410371355 10.003358484700809683 1.8716293160524306582 -18.501819871752584135 -5.3440158857586963492 8.374929789632419741 -18.464294463064277352;46.120616775497161655 -62.793609944538587797 11.372343631864319846 18.933006785700005281 71.678162625664626262 20.119184764584144176 9.0301759002123578313 2.3040147888612216853 -72.245475491967226844 -31.9171333958666672 9.5906739830628708887 6.7507377909768617741 -15.130086571480683588 -79.245642029734838729 -21.406199266245188539 -25.298455994359031251 6.9486550591025793011 -1.4783790555170348568 -31.447777219868367382 4.6979303963992080639;-1.5558850115258961999 23.851242352440678474 5.2942961333518923084 -5.2699930778348695881 11.870069234493586308 11.113737723785828138 23.12704124031724362 17.134342814496001495 -3.61521439219284213 -13.400103155799493848 -18.547246330857284136 -37.58087485896979274 1.4846002283953974032 -5.9843870069235363118 -26.908618936814910683 9.7346709725719495765 -46.731659305588337361 15.467717913560838028 8.3565641909316674685 15.389963790270650534;-5.2961273141982703194 -31.949473748606003198 -3.7898463996676454713 0.84488694609897352361 -47.936133494111544451 3.2257610121571542727 3.2122137436645212816 0.8160555983415268555 16.11354827587037164 6.8329290172901773204 -0.34432074986910177206 2.9572308113738179358 -28.232245106051628625 3.0093413313964050282 -15.006858786026343822 -4.8946454600823185999 -5.4742720082897848854 6.9038798020551528367 28.8912148575287695 -48.897794267366535337;-0.99043412618655124469 -15.494010328217498795 -0.51965223980036434615 12.589854343208340737 27.352199344479846133 9.162061051275287582 3.6671498474029569081 -14.957967839585304404 -16.483762990182565744 -14.820398990779032999 -7.5170021829868822749 -24.292629688895399198 -18.375709728664585185 -14.030897594290923536 -10.127775171470624116 -6.7491414638879598797 14.197039414573318084 3.0606336486909802019 -7.903476149220448832 14.430926669634903448;-5.9743639336792000449 5.4828116405656235344 -3.3774007999667277069 -26.736507107060408117 3.0495555209181004486 -1.5957233283021248216 21.569134745369691331 -11.157488542279372368 -8.2094046011596937262 -25.929560021962494432 23.800153087276751052 12.06330557345395782 -2.4743547221774169209 -5.4496978224926468926 6.4725334625187178617 -16.679208083472296664 -16.588670433624226774 -4.1594765857830440225 7.464498266812722882 -34.139129597836650021];

% Layer 3
b3 = 0.39153022760291583682;
LW3_2 = [0.0096050141473273623755 0.0044859727573582060603 0.17161196437020626027 0.0030235188944272863541 -0.053032301413244782584 0.0040770487604450270439 -0.0085233228744458298248 -0.0079253297018698400794 -0.010733998678336409416 -0.0095007457252364018591 -0.016591583116248684315 -0.0026989555014745843578 -0.015654903407153756417 -0.18092795756774507354 0.90439069328000976089 0.011519845002713309523 -0.0031556604701422318049 0.012651035725979059565 -0.011679346342026941663 0.00094380362233240447118];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
