function [Y,Xf,Af] = ESPER_DIC_11_Atl_4(X,~,~)
%ESPER_DIC_11_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_11_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.79064193995745635224;1.9508032078329280434;-5.027764941275245647;0.14555535563875515725;-1.7217556739036952163;-0.24351586528820948208;-1.7448392800668606206;2.1523801623942357963;2.0687835359385973177;-1.4348682602331863656;3.4682580708035408712;1.1645197260009436668;0.46584799000975363192;-0.77109175726893630642;-0.53862116585355124254;0.49548483686226890699;-1.0508067485418566278;-1.3521106410236569673;2.316977070904786995;-4.318989788149697695;-0.19112549708411250005;-7.5614858195513701133;3.0812164906879750959;-1.6877278900753687196;-2.2946704539358866448;3.2461360120831135312;-0.40255370726941969162;-6.4994240277576897924;-4.8664797605724681162;-2.6580231591526999324];
IW1_1 = [-0.40521337419353931075 0.95486201917449187171 -1.194915478408858478 0.86923557978765797483 1.7106390206379811225 -3.8054743931007011248 0.99861745505082932794;0.6271886466216144429 1.225733614860473164 -6.2239336490066596852 0.69457992030835069563 2.2240048613911715947 0.30979846205964217676 -0.98339781597996211993;-1.8540866422044297579 4.1289772500369661401 2.4744225028613247019 0.0020891175336728417394 -0.30919759234788940505 -0.28050281268536603196 -4.024660825372762929;0.38372415999954329058 -0.80122048018918856638 0.95803514238183173912 -0.8311912563632490869 -0.76564042799799292283 2.1995632527691841851 0.46541940867557962669;0.86104601698013460975 -1.2848720503543429317 0.31331389703957585047 0.52730809373662046458 -0.69411237073648168749 0.71881067521560815248 0.47826979948519904307;0.61141455452776038992 -0.16001094236062005094 -0.83030842393730153184 0.77008598592981236663 0.17866343103177276253 0.50914176823616674739 0.86490735150465836156;-0.42684611863344479321 0.791723838498539223 -0.87510648980314886813 0.13161093323981221115 2.4859283704183683383 0.4577377099475861133 -0.51366614818788403074;1.1777767178415015081 0.23540991886826076462 -0.35414808841540773576 -0.53510855483445773917 -0.22003703385287223804 -0.40288226264491699968 0.63630475634888550296;-0.73549577595326143253 1.5439051474448091117 -0.42130129773766333834 0.96124101903044001372 -1.0606575318303463895 -2.8423115259670259647 1.5125209762905538202;0.75493751221366600657 -0.13870764730226620154 -0.15993588820979751097 -0.65717895188920849581 0.79746183485511157318 -0.36514151435253527911 0.12169134296795867944;-2.163256801508403715 2.3910937049703941959 -0.94881204382137040998 -0.66984350013817284264 -3.1581888521130458969 0.30608384602556293341 -0.97627381226297027528;0.16619254442903277913 0.10189868948460310827 -0.9210266896160972383 -0.3843274163467894633 -1.0682320809533976114 -0.18876820253951309692 0.17962644854937645511;1.3890942233961987018 -2.2889608510435359712 0.98006697251036856144 0.50934366487052162853 -1.2803736939362859726 0.099072758688986753417 2.5516010870651539832;0.09942583168628706114 0.80411744819627861691 -2.5433513775761338316 -1.1117684385401109814 0.40998430221674087015 -0.93514907762454868578 -0.4302463065195689107;-0.70638809101513144739 2.2667293906596346353 -2.5464655789405687969 -3.2892258870238939572 -0.65447912823893139578 -1.3130865038864016903 1.9427083832906855143;-1.8282641854256200808 2.9246399631186723589 -1.1829876069224856128 -0.2810489939317127317 0.30206819539045304257 0.41673731999868701692 -2.9094368696574210986;-0.81882149054728303739 1.166886705628401133 -1.174992132595432226 0.70506388640115058575 2.1488909910740705556 0.11433963558193716015 -0.38855333470035635646;-0.82950880873632559798 1.8891103332036172091 -0.72433075825568937756 0.31889333815930370752 1.5163572644476170925 0.33781568676724915701 1.4514707872719403436;-0.23732466446500261048 0.14767998328109877004 1.9016998932385063004 0.34376154940192704679 -1.8319775259422195202 0.099665808180875586908 0.57766168981357912671;0.81562627967329648371 -0.41237110497967621736 0.078987883137068518047 -1.9445496150350338738 -0.96014724565531051059 -0.97976919312986443522 -1.1760240494371325681;-1.8736332715756407463 -1.6711474077192745025 1.4342573035948578131 -1.5716367732583758077 -2.1357956386999492615 0.7770816088533563093 -1.4079674171508747005;-0.29336210289486347458 0.81971364246436118073 1.1745018664440911582 0.29840211869196986427 7.6751797371628924793 -0.2663504926474944412 0.17112797512322250326;-0.30116712243283572104 0.52342126816231049347 -0.23164397847701925781 -0.73313657279783639442 -4.0797995844785921449 0.20894721628894774579 0.59741155498884057629;0.23646484817023649683 0.081970542225638071132 0.78550851456746140222 -0.27997362815168924666 2.0258450716589191387 -0.066592607151542568267 0.089941376057947219902;-2.1184884979338498567 -1.6706286684870108594 -0.24779640796486898657 -1.227465365895211713 -2.1282629235461119066 -1.0211462031404276996 -0.27220487815499294637;-0.34117548542526060507 0.59815288717490433523 -2.6865531303187908385 -0.58905612908554683127 -2.7303606320340905178 0.056740230122251517075 -0.87156552643500140309;0.88208711372218007174 -0.16833500608358728523 0.36908652824610299614 -0.2325955039110696454 1.9775983662985960887 0.45887900281913768241 0.89293193810777782282;-0.46517872485221023471 -1.574450237306757705 1.5031294189211312773 -0.73605922556514813415 6.5388280307164796668 -0.37890270704819328795 -0.76965888411714078465;-1.6568443111810429169 1.5707638262989380706 0.010582677734973847811 0.10884301569024812384 -0.78993567196765923644 -2.1167262780993758575 -4.4265128364841794806;4.7790568936395514399 0.38702330622516728509 0.82596187135350229713 0.93932153660662442984 2.4951988256362676033 8.0352230068950269981 -0.78323022567859579279];

% Layer 2
b2 = [5.3463976708172324948;-5.4230607144810125675;-21.825027578578623633;2.261508816260016097;-0.93314595533479460787;-2.5882869687795815317;2.9556173594301609064;3.7427131554039272388;4.9357088885252489163;-21.244473453994555001];
LW2_1 = [-0.80790654492493163552 0.28486875614183826411 -0.58673066112258032145 -2.159400059866088295 -1.4181287827793023215 2.7445340947593819259 2.9299561383445680285 -4.0448249130593127987 0.5214393673893865655 -0.10305921863648645487 0.69102502899043682927 2.6543586457025036829 -1.1229076499027133007 -0.61571305483028049288 -0.60968554401850660884 -1.5970052786571957704 -2.6663378110505044916 2.1737684012463618366 0.5062333956816283953 -1.8607899205236462237 0.45300360605656814217 -0.36846388764580134678 0.40002837895170095805 2.1845255903622686766 -0.62981744950432994035 -1.3015890135972911779 -1.0453434027147443519 -0.11961624018350447418 -0.52518053429738642546 0.0714663400503078583;1.4949795607155742516 0.3978605196887318729 0.88295357687506281774 3.2846963094315717591 1.5015091546094145869 -2.2815946024158870742 3.1051146430133220733 0.70187241354038598651 2.2899745121567720574 -0.58137870665374891122 -3.6473993426624140568 6.8616318749567826174 -0.3128814690972754331 -3.9865383044887585662 -0.056694313603891328956 1.6834788270405698363 -0.07803773559923846137 -1.9064168475456675367 -0.37809507342098108706 0.77006026809397609689 0.36061287359347599102 -4.4127441183376907574 2.0034594286337457092 -4.6839798748123868677 0.74695699057825182265 -3.2539105004447570479 6.1866040085036857477 1.2837208035158034214 1.0647425791357909564 -1.0651154680574399514;3.8739445780446102319 -1.9637026022688037763 0.23753800645925302049 -0.54020615375445113493 0.18338150600943228796 -1.2114752215402662117 -0.035660579362665492664 -0.71856102167683544302 -0.56284614507381336423 0.91863041479305640458 0.14176150695416336878 0.09340376663671198787 -0.40514050272802676345 -0.55131472814840998264 0.67143920094185016723 -1.1506740845498875103 0.86118581877710687067 1.26736313364385067 -0.34620340702055263371 -0.33763634717698493004 -0.40475839336130470247 3.6981159686996214475 -3.6981908054595842295 -0.68675820292142053525 -0.057719188772040845581 0.48929360005527250399 -0.38917070237297474167 -0.14769885895779319429 -24.387880717214173387 -1.0333118875083635579;0.75591485446415518368 -0.062887561818290360627 1.3329263023909230235 -0.18786725589739305953 0.6860978330253730828 -0.54882041149063343077 0.37702669870860228141 -1.0760874196385918911 1.6984948975338820532 -0.33888206522424968448 -0.58361368055323215032 -0.99608120224464313797 -0.67111454337459319763 -1.4525926828869695218 0.097508789825964767295 -0.77493749957472246592 0.22446331189597848454 -2.6940791539840085456 -4.024351377427351828 -2.2331383366396577728 0.67162322465187351828 -13.361374294683553643 2.1666856732120445272 4.3752032042448769644 0.87588957855043858558 -1.1990572497735088042 -3.2793013293104293915 -0.2297170279385726821 10.744906904794735425 0.12191404155931809261;-1.914201685523747809 -1.8162021427096817217 0.20765972590550463295 0.85975108955111056996 -0.18573977081268347455 -0.92063220507284626581 0.52561768250111751133 -1.5179703411916758427 0.5514187277410731447 0.83616219082101372884 -0.95501678119226984798 0.68161889728193703064 0.75819271001937071919 -0.77026323492382109404 0.067766106705367937235 1.4244917643995960166 -2.256591226206707379 -0.37193616912616261905 -0.05604830512497043643 -0.57922302487247012692 0.34022905121552565744 0.87157515013923780867 2.8116394633818688753 0.6841442062435049154 -0.2853296191180405561 -0.072839012485151746756 0.41727251188877123589 2.7477549024206191497 -1.3671708869580154744 5.2075204680480888797;-1.828695931327518176 -0.31238943204245084306 2.1755380661995586955 -0.61692216914353792401 0.045611037618693887896 -0.15868623825822492091 1.1797347026897673228 3.2907856012788516686 -1.0695872788199989323 -1.0368416530098458761 -0.030116441428165233174 0.34945342905248577559 2.5546221296533611067 2.3231431885039994789 2.6699694407019567421 1.3825622067830207751 -1.239735524076305051 -2.455191489964427376 1.1938370234608941534 1.1323375393449321979 0.93562241882647512181 3.3890732180326033074 -4.138611398662576768 0.077642157608923734191 0.48189145587138670912 0.62672131751688109347 0.69491234532280765634 -1.2295597020711512837 -1.8228838571637724364 2.3960200177442905201;-0.34819745249235262152 1.0697249478529300415 -1.1763464873095568208 -2.1419581965637810583 -1.1145384317929867279 -0.68258404162157637618 -2.4821526112015082077 -5.8255207473424270859 -1.069830750601731939 -1.0490800256049523931 1.7585957374490257532 2.7286127735801706251 -0.29726491818128125688 0.67954502745512745943 0.437158692878197086 -0.8784436999377677191 -0.67643192862839673918 -0.30302510192989962068 0.12460232551004031543 3.7185673116017379236 0.1598216971424935573 -2.7381134124211974346 -2.1184052376900348591 0.85394020571422690757 0.19522043283970097471 -0.55363245206191002978 3.675962194948672046 -1.2705342558081216264 4.4727710523198078718 0.58976823861104465951;-3.914523679971117609 1.565158781344801131 -0.35492945002127745946 0.96625381292371526065 -1.099096628057538716 5.8283435256649376299 -1.3754548439174996144 -0.30923809301114302261 -0.51762116802086810541 0.28740847541533026677 0.17208386898377731056 -1.0513381624137598802 -0.93450654852378789439 -0.7309305184946560674 1.9889445869003286038 -2.7436009782648578259 -0.81982204134603753332 -1.6931903036984048416 1.6300215693656379123 -0.80821725067407823584 -1.7790361534685981137 7.0008459692658551177 3.82080027090134422 -0.63912279852465847529 -3.2881981743665162909 0.0033313277080004610221 1.7190912601889549727 5.4924250838191435165 -3.7817161503013880797 2.436177282724462767;1.1303502271083329944 3.1943655713216605463 -1.8823704855601888219 -1.2365635473109926057 1.2511850805028525979 1.0116843976949989603 -0.60625973823721968081 -2.2963164061156384754 -1.028253146345065705 2.7166242262981552535 0.51351658915602638178 -0.56691237549540685059 -3.7458522205330995192 0.016448886015755063289 0.38651056611176387579 -1.4715304933666966125 -2.8003420275340022982 0.9844995116744122976 -1.3394968217932661236 1.5501433814255916044 -0.9354498188441516815 1.0828187364362675815 2.3278405621540065873 0.38615066301636769008 0.84212655981744066747 -0.90938683796656638592 -0.034085463353853609481 2.7729735934563537469 0.52582188591386758159 -7.5559294578940345843;0.38412864874255575609 0.73906952519336788221 -0.72050522344365519611 2.8675181546283114997 -5.022048223881096618 0.20718013982490018909 -2.9456727658332009234 1.5054012984991895774 -0.031392106490055832202 5.3078740150989851543 1.0339781313057676559 -5.1809278764617845425 2.1956658347135671328 -1.3427482878517815745 -1.0532885722543363638 1.9194222087263101972 2.3906947146680996852 1.9652755865160980164 0.11188658020475539256 1.905689039519788075 -0.50339269637213401865 -0.83508348932296383449 -2.5547479785923363771 -6.8396364903974182781 1.5078856300237846177 0.96864344517962608361 2.5855017298039988383 -0.1591988692424897156 -16.981403173425029252 -0.0040256077214622324606];

% Layer 3
b3 = -0.69210520747280968035;
LW3_2 = [1.4004732680839608872 0.046001989438839568924 -0.015330764589629432282 -0.12088096824396901696 0.0032007519362468356446 0.0082065290277267277652 -0.044457365538365531399 0.0063140287952944303129 -0.0028671014481849547983 -0.11804522306295926748];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
