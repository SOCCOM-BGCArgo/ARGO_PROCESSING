function [Y,Xf,Af] = ESPER_silicate_4_Other_4(X,~,~)
%ESPER_SILICATE_4_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_4_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5738581175875538953;0.020829247477561797786;2.3847992185624518058;1.8411511568933531802;-6.8556565495638812635;3.4785626278426087232;1.3137669293909621793;2.5741411016983568594;0.94123096928927407756;-1.9758108968416625562;0.64368109786968252806;-2.4963599700647631785;-1.9446420744501926592;0.83530386560339531243;0.75088746916569848455;2.1080462314800341161;1.9574843127422294486;-1.4718510152832344762;-3.6150908889801800505;0.18123489476659068731;-1.446739130029508491;1.478434815517795986;0.71141377007565964607;0.737546443706912358;0.48468379443635639658;-7.1859287095455410821;9.986513618592328001;0.63957737795983171658;1.3753640248104161969;19.925777870091540223];
IW1_1 = [-0.35235872530452355678 -0.14758677644993120626 1.9867052427347580146 -0.55515238694164514843 -1.2743493249801474132 -1.9759676650808846166 0.12090201901026016718;-0.10369439504745531222 -0.029725293197032747611 -0.72907984465241226779 0.86869557453095480604 -0.17540787230354434878 -0.18025438683369271464 -1.3609140844142337823;-1.1280078805159776678 -0.14134399368101716044 0.6352451085678344489 0.24026411268104433394 -3.2916912296707523389 1.0268919701462242422 0.37230223309447613156;-0.10086087545901420426 -0.76133970214008817035 1.206673343523415376 1.9560798423273066948 -1.199227404888362214 -3.0686908387853923941 0.41555941038304528012;4.9395007429547082012 2.9595211345118519475 2.2158708272792777549 -3.3856999597965122817 -1.7332648526389147214 -0.073735292596023016554 -3.8853549564108389447;0.087924313008691676319 -0.25947400859223934688 0.49162226808200942818 -0.67125488535559152403 -2.8602751730012676568 4.0029832750838219013 -0.63524392605694302016;0.054819686249729007721 0.71932421911797395087 0.052522892142782343083 0.41925564403378762224 0.7491501364526809148 1.2177909721031454637 0.36262028022379577674;-0.014849604156561444987 -0.26690189096959776593 -0.2669520086127928904 -0.78855085389285839437 -0.34285931184488815937 3.3636415753658335248 -0.11597720067716918435;0.32032926090548324849 -0.16474157396659810937 0.48334671205630097557 -0.31942530136828573006 0.15051202398788815495 1.6120114981913606922 1.0657245855935757461;2.0449040518613275097 -0.39236004287767223264 -2.0442634804307786567 -0.15648729679629311273 1.5016713208068053209 0.03628551356088396268 -1.0249666112233521975;-0.81448203656267781358 -0.32196597150491501615 0.14549547701297010915 0.60938469284156793204 -0.1575592647459818918 -0.97453568233380905017 0.21343039855305351304;-0.24691884091272214841 0.11334877383288112507 0.45356831014552961845 -1.1688868805434384779 -1.968336338112213868 -3.4278502815938129977 -0.20102936073385904714;1.5594080009637092399 -1.0157756721667914324 -0.51085707609435149212 -0.45430957290662354886 3.9739025637597147345 -2.7140701493829015867 -1.1017050722937078433;0.01088272140064926001 0.19481772970888988628 1.4178252517148353107 0.0069029606140924076527 0.70149916504345755097 1.8011660729009510984 0.11051676866496884521;0.12092546135589975209 -0.1608287134571385335 -0.26113588588503383603 0.10740990806748659803 -1.3255687283562378465 0.75172059318789397064 -0.64211094264531520803;1.6099451085751113055 0.68014368011976333861 -3.6277281239517420453 1.7824870815260118739 -2.918466120614649828 2.1491684915178517201 0.11303269235401411374;0.32758960189866143109 0.56845153541224247018 -0.10810023343146846209 0.33100724951981491673 -1.6936729955934477498 1.0990278758427172168 -0.25943346815931672689;-0.087491025210746337093 4.6456798686076981042 -4.3889627241576283367 -0.99546559878283868983 -1.0785197226573433049 -4.952079882928328125 -1.6154534869479166836;-0.11297887846871405848 0.7859984472300044489 -0.78286831523836275526 -1.1900412936594424451 0.11032558009702737867 -4.1942967288005545967 -0.22668357615159076546;-0.61031387743077814001 -0.57809220478408229749 0.31639170138617372929 -0.83693618303640338052 1.2131248732391091139 2.5541950230004721867 0.37590870383022961798;0.0015241757641775547944 -0.070182197006720528631 -0.67208797070366788073 -0.19311097468905530361 -8.4149110593735070296 -0.90362016580771875596 -0.25555419922355804285;-0.0022361705568916139843 -0.062233653405108460555 0.64104830079127095299 0.34911792773024269421 6.519005113558906217 1.4526825360658250919 0.25676458093895526691;-5.3384139513477038008 -3.2636417943189806046 3.9258325288389954721 -0.47649461031211809425 -2.7020707713679752437 -0.32452928881358905633 0.60700856654291523995;0.3191051210412036987 -0.12801526720034481222 -4.7890988317378626604 -0.10084359456773761554 0.55212042211286382898 -2.3489681549465450949 -1.909833609301760049;0.0074997651263329937962 -0.31947586172169673002 -0.67912046023228467284 -1.267268483239325283 -0.89168851495040668542 1.0326485984158269016 -1.2651641399161499546;1.151449742724249603 3.8242023435562257916 4.9540946586868210844 -0.67304003858154970441 11.963585416154469243 -4.8463247653946543991 0.502605333953753175;-0.012925671094665337757 0.3409214549015705531 0.56043184383118671565 7.5477682455518877447 6.053891918305528641 0.19270492886645854136 -0.67275390571818161067;0.23348388526844568447 -0.12434491570315749087 0.61892363194532429294 -0.45529661581208435983 0.54265156550520388112 0.73605933517153410151 0.4494884071221985633;-0.13687915862097541075 1.8805006721418118243 1.1657044632241224669 1.2450364771712338907 0.24273204470828793622 4.0287189464382668902 -0.99302241765770316029;0.31938954404029529233 -0.01743856158562512651 -0.1496557268142431063 -0.23519695857158134933 -8.2012486500523138488 22.497355069176084186 0.36133857649872963558];

% Layer 2
b2 = [0.022855303312639331514;1.6723269242625873332;0.045269845639195296916;-10.524556608223136323;-1.293379873863343299;-0.3502400899328129702;-8.1656102831835006839;14.890768368665867172;1.9046267969670778175;-0.41598800022257592657];
LW2_1 = [-2.5075786377452291553 1.3176589827805105237 -0.73054788169892903582 1.0474781026174788678 -0.16846136638718933742 0.74675342870406058449 -2.8747596397336510066 -1.1810308465037506753 1.9804648652482992333 -0.72460976294693157929 -0.97154303903164107581 -0.038396725886967811303 0.54441861266336544212 1.1098492159572768134 -6.1931716913204750696 -0.95710955564867095102 0.64103691039001764462 -0.20126946865217776317 0.4482187950828379619 -0.70105428593353269484 -3.1306353029881304195 -1.9083263883076335699 -0.37070218312918606918 0.028939761532001007094 1.9930744498874652937 0.42679014860406649934 0.13346117589560912986 -4.5993902431411068932 -0.8798335597314835832 0.94944178531432255053;1.8879943167681025873 -4.1258847446364210754 3.8284340569906576413 1.5380210550544075598 0.35626827308874581268 4.4929492993424151592 -3.8618764548648503165 -2.8556931450459086541 -0.84252691288205383557 -2.6990504533407615462 -6.0737287236991148731 -0.91748736187419654975 4.9234473695109013391 0.94616491817554226884 -9.4929279629517751005 -0.63721878589927616332 8.436880969566891153 -0.16085904746944118537 -0.80673919161758989027 4.1975562637521948162 0.81585828883663646938 0.39751820729805437127 -1.4744448733038308941 0.75070464850129681178 1.485531607340889293 0.50097344479693328712 -0.58481445808185195112 -11.25472101265229341 0.76007763864839750223 -0.9735888916648340885;2.387066712135166302 6.572712961883971694 -4.123349272574455604 -3.52235488701712951 0.21004731420247199636 1.1395186120828306731 3.6332830803378350915 -4.091624471243307859 1.3041153786928354474 -1.5992163775044907492 4.1096252468516878409 1.5945491506893623157 -0.91784290484670449928 -3.8237960380125923798 -0.066928946651766352272 1.544387138134410975 -1.7704009023625715269 -0.08017687964879526008 -1.3771937536904834687 -2.648319666140860118 -0.90694780740408076358 -1.7568169648067815114 -0.31841384780871806459 -0.16010116837196519679 3.2008350553582203268 -0.94943321082955478563 -1.3136946155364543909 12.093174325208531528 -0.7398147866075942547 -0.46649177653153806045;-1.9568310126271180049 -4.2644938841693988962 3.2102450519869991652 -0.18286144082815447565 0.53783217042550857112 8.1720283324974971606 -11.027629474241852137 -3.7996018373115156841 3.9357765915341107466 1.0565638551350806651 1.9591761951033266342 0.39159528420679584615 2.099050425506648665 3.4360251341292813443 -2.2546476045715366787 -1.251593820135098678 15.039919134371867671 -0.26882627653478363694 -0.13218142831247212121 1.7064359549785126369 -8.517915047332277112 -9.6279484016264333945 -2.9652211085208262098 -0.018187323440502608379 -2.983767813626741372 -1.3474871733774231863 3.4982623148403546587 -13.653282874901941923 2.5744445562352682444 -1.8277278983129403578;3.5401277790345542229 -1.3478925013186215942 1.6149987652572346253 -0.0706939033513613313 -0.72449577146326515908 -8.1375576961094537864 5.0964129738239538625 3.3668096286175122067 0.98150913693807750882 1.0624021513542636352 1.306398965337412843 2.4791858860166322565 -1.5742280323021269339 1.8760877507907367523 13.781100603628861023 1.6695210455877869116 -2.5502018698823172294 0.66159773013691536292 0.38127725309017085342 0.40407559170362239431 3.2811133063181534553 6.2690464655383459913 0.81143042140469867629 -0.43766791196779691875 1.0542870144551366174 -2.0594906886729487105 -0.78582477050591004186 6.4925600648032144591 -0.66749451572703766278 0.049072272979541760318;0.98157566358202275048 -1.2038997206190529266 -0.66250381579988515401 -0.35456226986856070882 -0.0037822981052605649313 0.039628343594829147645 -1.1779014632509861027 0.028042710234822666726 2.7160261813657684549 -0.27626251248024780161 0.10963824776542638317 -0.75483988291658010716 0.29993970520830764981 1.2492784966857228834 0.42458461350909337817 0.15070096350140291253 -0.65658790753577989108 0.00073968779285184531498 0.21789197829106388138 -0.20775464257960538084 -3.0090480230063763045 -3.3074374492398881387 -0.2513006035148741546 -0.041670215608822357145 -0.47393180266593626371 0.0095398844818943666357 1.5879375354369118511 -5.9508365154498505945 0.20369022086778479363 0.7291920554737200133;-1.7073997676881680352 -5.5092157905212468805 2.0956410536220837493 2.3377720100136012427 -0.033357854005286041721 3.9572032639687493294 -2.8557746970240969198 1.6482483759578572258 -0.86141753681359600758 1.8424903276963107146 -1.9677111307247590055 -1.3010052518742845074 0.25224559855780470663 3.5203572147882713494 1.4510523791851528408 -0.72990836112079271469 1.1424542845539111813 0.18355120155023091355 0.77892156090978026395 1.6937244911439577333 -0.056044418165917070374 0.12612187924638412762 0.65235527489863309736 0.15331066830245954069 -4.8824680014084460566 -0.071326089138954232305 1.4930323697538097072 -8.8324983724754222436 0.52059916560732388824 5.5896244118740092688;-3.2754323515920202858 1.7051250854491277753 5.7995067063310230537 -5.1541595210580757325 8.5393334933955404864 4.5316526665423593201 1.1647927533264552657 -2.5682106409436271655 5.4859988770453025353 1.8882240501934479671 -1.2633726116027088615 2.8173399487761061621 -0.6544806960243787497 0.66097691979316164357 1.8970675134785666138 -0.77681341971037798366 -0.29200191888421789255 -0.22207651591730301344 1.5202557588419391976 -0.060020219072621949774 8.5186423052039632609 8.7811852367091685068 -0.54422793002647285032 -0.47131787590909651753 0.27458204839447530876 0.020196317253814877191 3.4777880722072911368 -6.0041477988845137759 -0.015253208048275165853 -5.6962959019609700206;12.58678669045154308 -1.7565550554773272651 1.0690912799356766527 -1.782096031567899086 -0.94946054593340500904 -9.9584074139182199303 1.5242614518039170335 10.612181910568040166 -1.3241209236270021776 -2.083207038252443688 -1.2566568069602617186 -4.0293564845864793256 0.52074641497415430358 -10.249097203974022463 13.649257514274561132 3.580744816035784428 5.5867741137208479785 1.0274196155908033035 3.356596887153989961 6.5156507243096424276 5.3268205843706457614 10.453939063023421241 -0.43005911937008811652 -6.5353014842585412936 -2.2019970519867464454 -2.0595765308387972148 2.6833777319839975384 4.8047177286971383126 3.0071647977797053564 0.8997240986702803589;4.1941438137127775576 -1.7400166280825832832 1.2442225919622105224 -3.4075108453566054223 -0.9857716794453634801 -0.9727703036579095075 5.0604916959629111517 -1.6174348472248976094 -0.58706098267870632235 7.5828768190742472655 3.5369547049997267507 4.949774717487204434 -2.2245777576450511681 -0.02687802295178562742 1.3965900480288342411 1.8833486946465314293 -5.0913889354489683114 0.026252363695343568228 -1.1548795034559815598 -0.62501512655200042179 6.2252118757115333381 5.9895373065925952005 1.4434865871570985441 1.8976956484702078853 0.097733750212707429239 0.14051936359609426552 -2.6209757954412462588 1.3979945075678574806 -0.72327107202474572034 1.4246238023146384766];

% Layer 3
b3 = 0.12350680056223684034;
LW3_2 = [0.19877461272959243144 0.038578228861680594064 0.10771822925876921306 -0.04406203442899762901 0.14550526495854579356 0.64287433432067808692 0.1409568003407905834 -0.057942986349033012705 -0.23133857985057829088 0.089342634656235264679];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
