function [Y,Xf,Af] = ESPER_DIC_13_Atl_4(X,~,~)
%ESPER_DIC_13_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_13_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.29896611686017310339;2.7531090543911593826;-2.8394630452752664951;-3.077791412022382378;-1.6307766151876410543;-2.0835184999201654676;5.3964117751316100779;6.0248959521954583707;0.079011508301559035816;0.56550570981163317263;0.5529480244525259991;-1.1690753010974399562;-0.80052168058575057241;2.2083942229903108512;-0.82076899479638287804;1.5026823317111657197;1.5569571574232852207;-0.79642495450854311478;1.0613992410762074226;-2.9709542574201495135;-1.1353112763522448247;-0.74939693171554666584;0.49141317067846768118;2.2728018202466140352;1.1410215861362140721;-3.2218736800235685536;-2.5088567716070033775;-0.63820695139313088351;-2.2760994753001506652;2.4845416351927669396];
IW1_1 = [0.8005915796859821576 1.2542870755300763452 0.047214427255828153585 -0.18665573495721343722 -0.79759300617339556894 1.5110786716583481937 -1.3051105202481743106;-0.76556110760027096251 2.4328267638573621845 0.53571849509757873964 -0.30755021530112458539 -0.81804955071408569367 -0.0099005715578328913618 2.4975133147232386754;0.70074075841446947788 0.98989132909431210017 2.9768582482194112515 -0.039717223515754115915 -0.71065737802117578958 -0.20154896181291184765 -2.6307525731064451691;0.23425655605431247586 -2.1380247881232818941 -1.5003040114284247331 0.41642706540007884408 -0.37148688322011041985 0.73483495617790395293 1.1436300536586883059;0.047835783376782257947 0.65195324360761608418 -1.4402383920439774112 -2.0844838001006800177 0.30689449448315431201 -1.2593595958618657438 1.2152977120049408555;-0.34861793623628689609 0.75061226676080061715 0.98864963394883020875 -0.5366590232029319063 3.0592541880015375888 -0.99588451089240048741 0.46406881714501013736;-0.43744952033078082776 0.38782464884734907384 -0.32178167316109035356 -0.57053388731906584663 -4.4523993817369662551 1.3298896953771643936 -1.3525070003621315617;-0.12737990749018013314 1.191120552556169665 -0.49619669990788339842 -2.2416452349826188062 -2.7709798200169006854 -1.9006106829478337517 -0.89770343807061570018;-0.14491093537175994688 -0.076387789660658261814 -0.33650517190854073446 -0.016964247317144912769 2.9612527728444542063 -0.22376934715075513793 -1.1146285796427368719;1.2449768781781762605 -0.22905639897155083418 1.1085355645003092118 1.1093252240876148029 -0.7369299128031617796 0.21758019641199041749 0.79261366902355501196;-0.59585024219380333665 1.1032991955371789228 -0.86528315920776521786 0.35873891592172257869 0.077682276656026755246 -1.4785277197102510982 -0.61215849632685648274;-1.657295714277996268 0.38579339729150713412 -2.9653480640842082572 -0.063038866215965064232 -1.5012767059533482783 -1.5201039436279488726 -1.5358570528080910389;-1.4328118373337315195 -1.6063064643436792966 -2.7700859396003871815 -0.44152808970317847237 2.90544010623579263 -0.53659276100069219773 0.069035143765855205844;0.087816394910098891091 -1.3756003553546645168 0.34555123479147209498 -0.013465038651300281422 -2.8433757658482377018 0.90507363616349778557 -0.43359035722849614825;-0.10080301988707415783 -0.1916706784890804538 0.58426703385322165119 -0.095609689510571652105 0.48138796417922952164 -0.61217129936808234447 2.037357252329645263;0.3904359871749296107 -2.5901794566191842506 -0.78240025020424019964 -0.7104161147506402596 -0.55765592011328335431 0.050975378740561003155 -1.2626151502177753727;0.46928471527371057315 1.7568871101967507009 0.056161295838028639504 0.20735679049579955335 -2.1184567128896478749 -0.73656734633105180876 -0.18042965602684774007;0.64252418071982742021 -0.94704388788209470373 -1.1623049388255752845 0.51716516416361701936 0.94166684274153311662 1.5068574649602102244 -0.50526318772171863181;1.2041977370288592386 0.96629641347849559718 0.96958350423842043497 1.7705044576326123273 -0.28461706299708305901 0.22094096331354137752 -0.79761132322324357347;-0.13515844642141661147 -1.3431425372954899355 -1.0626156519731588812 -0.33998590644074322409 2.6715071036945077232 1.3518748554372999049 -0.075762076680499168546;0.8138193800527241395 1.5105933635738735266 -1.2706692334792200061 0.26292415755963882695 -0.60363892525844853321 -0.12144453169070655585 -0.32416120016217558897;-1.8202163953607062297 1.4892691870829737333 -2.4394241274481256454 0.74703593153486114176 -0.59781745840875766262 -1.8865327319675848639 -1.6335984784573212014;-2.6544838854323966615 0.84965164560804273819 -1.230280509523078214 -1.3719611748502900106 -0.85197871688598725282 0.10151991103839388964 -0.3284862019101475461;1.1405807499557574225 -1.4501911664230595633 -2.6682129656563717823 -0.82796462301482098844 -0.28983278046891541857 0.0014321988406920706238 -0.61552943373414370498;0.96851027331789796282 -0.078346529833628247852 1.7176065628758119264 0.11327085808007067436 -0.406543212312674207 0.76085779128337027721 0.18013384886333669299;-1.7121603109922061137 -3.1453500311758886276 -2.5862070191430093224 -1.8858869254237156099 -3.8915556111585964949 1.3695214077291169019 -3.2623904264430092503;-1.4919930532542768908 0.5498316772465301483 -3.2734554514177167661 -0.24563325181958989285 -1.1554340202799950887 -2.2064730565498620329 -0.68563216021593642591;-0.25400110145606058509 -1.8100177007559208331 2.4087128453649366833 0.11598996406712303031 -2.4799709739057886893 1.3298835279491711958 0.78253048653225065756;-1.3441744766310061987 -0.1740045591024946825 0.33211764311258862303 -2.466581066243817677 -1.4153594389867991676 -1.4998839526004759115 -0.45333459287113214708;-0.089144566745752759629 1.0849860418525705263 -0.1834750208259399995 0.45757767877343563656 -2.9123915826375759153 -0.77870071282098229926 -0.015684681385471511278];

% Layer 2
b2 = [-0.72259743145792088015;0.51976439544258312697;-1.8291537298228051078;0.94986915115858072678;-0.54456712853975097754;0.25877641857835465;-0.42754560304058886189;-0.36830289392567489015;4.0758775714711701355;0.97924535078042018732];
LW2_1 = [-0.097659872158858074265 0.40145958707190143588 2.1775585726978712309 -0.38411528437692604721 -0.70252453391633451485 1.8591488942234131176 -0.49583768463959543293 0.51400554361214012555 -1.510695174284280462 2.7187319227164219448 0.50999895547226892223 -2.2008210096251210608 0.81429972640812708917 0.19907745668477175305 -0.61481094296205607286 -1.8763049958035307174 0.20646137908266676275 0.60171607844806229703 1.0844385877797551032 -0.25548929838111467117 1.4391247733791177055 -0.93259549184733703253 -0.96475658707900013855 -0.45166253933533495601 -0.59938174284748835241 -0.66187482394421626175 2.8380427581036524742 -0.083417813729856779559 -0.020429638006660793409 0.31260930683311616285;-0.17754149483806000442 -0.49730891487858713829 0.058514310617450299157 -0.21366819711577234031 0.1303509789957992826 1.2546008524394793859 0.1398389047605668456 -0.63003815663619877618 -1.5178959733106172081 0.64651603443404837002 0.320788467583870196 -2.1941532015456237659 0.72315011812504836897 1.3894623621567234739 -0.24143339024038362739 -0.64622760812604274072 0.97673446628321625163 0.33476174432727756614 0.040301768070376477182 0.66533091308426239863 0.58527490025225481496 0.47169849861253071444 0.24770743427161348582 0.42134683423205909758 0.8139237918786670356 -1.1360464513763468553 1.806273838600320536 0.61056532103889971097 0.23329310089302840447 0.29256643235645235501;-0.52842436941633874614 -0.52741105545886146633 0.086038555795497462242 -0.37690338352857155613 0.15726097009714040675 1.3522943292481082178 0.29062362642821187864 -0.70882882326211205104 -3.4838080238673838629 0.57628394986326958449 0.13048087169048380729 -1.7072720836685939538 0.79532998834456758441 1.3282411513423253435 -0.45741151345145503182 -0.7437320808253033988 0.78341159832693318954 0.25197253495677079949 0.079323265303448811658 0.81418465914252868831 0.76494702154232407931 0.41728852378406317003 0.21031052488614751517 0.41881009148621067828 0.78905942870700107594 -2.0651669810459947207 -1.8153470697796190159 0.67259390706167088148 0.28144243273590013876 0.6849389921923990654;-0.49346947646734695692 0.23206011780735411043 -0.0003032719161444596967 -0.21272122397117088077 -0.0015428450243670909642 -0.39723030116738616835 0.5899985239221861022 0.22696407350106778678 -0.48703811951620368248 -0.71710877254544291848 0.13511243967391700638 0.64639736027555116937 1.498393539006287023 -0.20298123546618512814 -0.37704000023765588123 -1.4203650901521673866 -0.64361251023296683904 -0.60272435892113374045 -0.10399512156739580682 0.41072878500500303867 -0.30115007209783434261 0.55223955606521402117 -0.52253361255420294196 -0.90208976920328265425 0.052769436752249293532 0.32307572117322647109 -0.024017807480661922115 -0.22653533179103355066 -0.14890256050433259283 0.74776449089004259907;-1.5641508709986438053 -0.16073758694188844398 -0.5629358080299463607 -0.74473053823535217965 0.82647881516989052386 0.29164158494639136343 0.49473158465418176633 0.26670856380708002353 -0.14224922758117891641 0.055739499790246824218 0.88345884386639306207 -0.13508882171712702225 -1.357412016022159662 0.61613271295280780393 -0.91704566740653969958 1.0923217137755685258 -0.019170517814102269738 0.17017097546777656958 0.69218104178810047067 -0.34227184036818053547 -0.45817184260781773641 -0.12374215167469743148 0.11647827677731695251 -0.095636277690391444106 0.13655119349639685544 0.72819362301310908148 0.16180677026735662549 0.46561580953257775128 0.52046440272883676137 0.44721042847394115727;-1.0022716462139178439 -2.3330997137597453417 0.92500241812559680366 -0.51583441854079514766 2.5049041799095497218 0.38976464907190411235 -2.1480273783207821658 -0.10028534829157209618 2.4667265260322688292 1.7453952565747139491 1.2086476626607134399 -1.3430343589302797813 -1.6423519347041839467 -0.30609179442795098058 -0.38594559206248491012 0.28944875160581828855 2.5178937994815799861 -0.91247725893993270052 1.7363746689107162346 3.659622625863573564 -1.4443290681485652094 1.6912345821908230104 -0.047231535164899855761 -0.24742363209556336723 0.67647848706944757602 -0.070647188018820930577 1.0343041509084207608 -0.45879905590080993782 -0.42717075240772450773 -3.8461647402968597298;1.0413913946004216271 1.5901717614289438973 -4.2573570457452705185 0.80499328212402254668 -0.20169334894580889794 0.041923409549059049983 1.3287766014088313593 0.64201381430025983299 -2.6069293641916253534 -0.18614003077795188146 2.1434849080069953153 0.12868452227199608795 0.78318062676886945894 1.0704567293061111322 -0.50925298436849320005 -0.69246694269465358662 -1.9018486493994974929 0.90671713620318072913 0.17995591229501467501 -1.3435759075455480094 -2.3914193678069146642 -1.2544887914716817967 -0.90647569144594841717 -0.7190548879308295005 -0.36231285576438554408 -0.21327341616588219031 1.0047466191714400363 0.98084318315199414684 2.0403514384762124756 -3.5979165643912511818;-0.4115682296887399616 -0.42030981399639671947 1.1696781884320976985 -1.065312420807323246 0.44474304826859406559 -1.9818773430810927572 -0.77266825538625105718 -0.44183059222114895448 -0.69763535060023174061 2.8774638739641771323 -1.397685788298449916 -0.60657652932407979396 -0.71506504392269520931 0.073246899351324307181 -0.67666457171017435623 -0.011962745754747891244 2.6744869590724236197 -1.140841867295543377 -0.5419556629962759553 -1.1138744761089842683 -2.5168412521398288995 0.34612374054169675608 1.9838231608863068356 1.8970847401454631331 -0.60564837453714615023 -0.13883642165687087866 1.0709265776819008043 -0.067053790270625843184 0.87255711157722715132 -2.2063761374925152658;-0.95904981348415607734 1.003295697183045565 -0.78061805899053049451 -0.40697125150199436883 -1.9542678851875612267 -0.59168462412467115463 0.02193427752565442479 0.3000431937929769477 -0.22492582429688764978 -0.17010422769827540646 0.43716079844384897468 -0.65063074788568842077 1.4489279884230594764 -0.088684334977583864634 0.086300888396339550668 -0.061943315977071915224 -1.0369709918260541226 -1.2638265986165397869 2.3392666801024972756 0.70185527526298996381 0.99600758917519560676 0.61507668012748195618 -0.45083594638597646043 -1.4569348004201045921 -0.97754085244163191337 0.31094260569716364317 0.080559352619009927388 -0.22917884794897155909 -0.48409723131300624877 -0.21476843839226025801;3.1345761923676218608 -3.6628351436810584474 -0.573556678606182202 -0.7902467461669226978 0.15480757932332461779 -1.4618362744963895317 -0.45305182844171432155 0.3533979772713425338 4.5037600687178800385 -0.87156028769634719122 -0.86326141436646330884 -1.544122524606548863 1.0627358650369520543 4.0861973388909706983 4.5416088365811457805 -1.9600838641386635341 7.0017871864317342556 0.28011972816692148891 -0.048514953957218498459 -0.6695337187748137131 -2.3569022225802109816 0.95519566551098500362 1.3712708332706988745 0.26657981982169126622 0.4185501573914276463 -1.583602069164184778 3.5413725774990356676 -1.4754087482810083198 1.2123707752331807086 -1.5922110190875746749];

% Layer 3
b3 = -0.93222338653263892017;
LW3_2 = [0.015282608339584093093 -0.89141800224499967431 0.74810589984363506932 -0.16309261396603594307 -0.025147612351656443291 0.017330395247759543959 -0.010916468479469438463 -0.10533767827347612078 1.6096781972728846366 -0.012307034780759156661];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
