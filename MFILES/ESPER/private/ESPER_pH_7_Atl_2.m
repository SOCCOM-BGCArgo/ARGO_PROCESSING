function [Y,Xf,Af] = ESPER_pH_7_Atl_2(X,~,~)
%ESPER_PH_7_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1856825478299297671;-2.1329482795077860935;-1.3438532451182032545;1.1781430336110259027;1.3358677244729946221;-1.4096130390386021336;-0.71259517736591149184;1.2563016122199239799;1.0109665889904577707;-0.092603315551402873296;-0.88001057364574009068;0.24916585409603908552;-2.1073196071049347111;-1.8429904776293883906;1.6344617866179687038;1.322608507587871074;0.80136926239485328782;-1.9887515629258685212;-2.2824835857455529897;2.3327321496598703021];
IW1_1 = [-0.35317045275645697622 0.12316428256466104008 -0.22959337843202448637 0.73069192051622977591 -0.8014388776522299862 -0.786527499300840649 0.71489212390065492997;0.55639834426402612344 0.87607673729224255776 0.010140867703495282451 -1.8261976700332538393 1.0527239975057647303 -0.09770415846603293375 0.93104177611372895829;0.64795518010120667363 0.32433048011735921001 0.075820280794582861628 -1.380995740317463305 -0.30817599758050473469 -1.1071080659527872125 0.56877383342608123229;-0.36161521491375114845 1.0058307804144319686 1.1094216195537309755 -0.20530340242896200076 -1.2804063641772722715 0.59581761663930432604 -1.5329183021318848468;-0.47210844356080339246 -0.50483614831966561187 -0.12568602223777089466 -0.26870890190567431333 0.21522636269089856498 -2.317306172839258771 0.47503848424382777438;0.571366156705618633 -0.92044701937917239309 1.2316144851018022699 1.2901094555422634169 -0.10989366874631172066 -2.4747549837057136735 -0.13195408604102376593;-0.9369104755408954599 -1.1019982367583296412 -0.31974808331084453306 1.2008232942692376177 1.9945435648672611428 -1.0499785734826123651 -0.98946372338947541358;-0.51465311684661907421 0.3135203299605753835 -1.1976471872571641253 -0.2556050037805395192 1.0065733687146813935 0.78023042333992631558 -1.7303893795676825729;-0.24525997000856344932 0.087126560825768806229 0.67291817512652030153 -0.57123390758823100466 -3.9932309319682581794 -0.078492072693864822774 -0.8040060118866934058;-0.14750117732815837268 0.18616199464451455015 -0.77899122315058322297 0.79007169552165545934 -0.19565971931259551475 -1.5424743051913556435 0.24247039934715533538;-0.58555817142188393287 0.13251246033932922996 0.14894480211466892827 -0.68592988085607686788 -0.39905391277450991128 -0.82123160853375176682 -0.92462937464508443419;-0.65877515199740477314 0.24177169463099285052 -0.24692988105081076222 0.40527898621897051612 -0.15567756346873290463 1.3357145178447589196 0.61007219812681301452;-0.061816020241993646644 0.080039078660623749761 2.8906919812063640585 0.44949962378238905725 -2.0484757667195774289 -0.76844960219167679494 0.095548898482486252504;-0.19389571890932985609 0.059525348812401498999 0.81790788492384036701 1.0278795282109642883 1.3116926617805353406 -0.56451804381348880124 1.656627344207127317;1.0199390563044705704 -1.0730336355838689943 -0.70519253085570809958 -0.15515472704560778761 -2.0274444917370648689 0.95531788434557596279 -0.64211090460991326889;-0.10934265916631250026 0.54316859185102117635 -1.465915408757390459 -0.62548326754431404773 0.62534474655772465113 -1.1160500596820666086 1.7716173053128565495;0.4818502519858847144 -0.20044980086504959882 -0.36339597555039221399 -0.80242428371189689074 1.5540174082319784254 1.0732569299718877076 -1.4051852339328012587;-0.24751048643131592919 -0.59042846914245428191 -0.48985201169357728279 1.1690437566482403398 -1.2540883032451313195 0.34333189627867022331 0.19868548700840094057;-0.96206744099571905871 1.5044988402932868432 -0.038094181417838018922 -0.77733805359010432756 0.04077133756405579984 -0.99324558404067753159 -0.29416735877811972522;0.03194124344059137699 -0.79478664556583855649 -1.3854185132196434882 -0.63527752458189312712 0.45129433345389791121 0.2555336857063190692 -1.3502266120613344302];

% Layer 2
b2 = [-1.7430010769992132502;-1.3156901128001685652;1.2165491744725878132;0.83126816743797427023;-1.2356249182059284575;-0.67570896372960698173;0.4670772773949338208;0.63961741173924469006;-0.50210019808985884016;-0.015278928045047521916;-0.27075836081009813094;0.36329787099018534535;-0.066379573358259072458;0.49020399742001935506;0.45849607419428811683;-1.0438995364644034769;-0.71337042184823795665;-1.3814642586160530424;1.38359787915605148;1.9424320358159963273];
LW2_1 = [0.33727938670102852736 -0.71946718689497490828 -0.12992841667830001828 -0.89841882753670498918 0.59663186685211788696 0.37290947154911274763 -0.79389753640879279217 0.01668335608080147997 -0.82631051259829035871 -0.44766141208492699066 0.53153441217885877279 -0.054277908078803734082 -0.27960584374817043507 0.74901445549970047111 0.50291613460587802908 0.57485146681234178256 -0.13749808705280761045 0.23459479374038491595 0.009939571724957650678 -0.13887038975552259967;0.57818940799276685727 0.90284641928822617629 0.54699602267616276308 0.080210888349482187265 0.0037777335378585295486 0.81161003472039394691 0.73898734297383628089 0.78357344186439792377 0.98564191648010734959 0.61025034017541757159 -0.09045771843182486005 0.3872607460209089858 -0.27006242395956425728 0.58928979969046824117 -0.40167476581187666618 -0.90542581439381975006 -0.14314373100950456008 0.10386957688501742558 0.47926600056691148755 0.84358028186288036565;-0.31532639042861598799 -0.47875548777070497941 0.30738109659289036824 0.21427965882014471388 -0.42217598338149925352 0.62429467109003689007 -0.2003621943065752864 0.69587823909009394185 -0.2150660307477473554 0.73808109898079088396 0.69878779196557005982 -0.11521892952277093536 -0.24297709188028021599 0.48231362097813740286 -0.30545179923185428184 -0.49710052259734899271 0.031244564222552700938 -0.17837615965019099074 0.33486047750889402774 -0.65955121290159568481;-0.41021469734987514588 0.28681883514697631421 -0.090219900005925557362 -0.23013513660854761911 -0.13978399582514580701 0.46937217240623640979 -0.52280899423596094433 -0.30828218401529960957 -0.30396969778725863032 0.22904833188118930987 -0.76825829253376054506 -0.47189340469137769363 -0.32860003614408483941 -0.30004546256177477837 -0.6470917686046268047 0.29167687034218131581 -0.62055179678040472968 0.80070591339436347766 -0.59987654654550182087 -0.27169812460075010163;0.11770084055889634689 0.49085708343271605703 0.21988107152251165632 0.16565656980180795688 0.037370108636763002541 0.33455322052167879576 0.14381477255451191599 0.92046199595238065161 -0.23987254585334949475 0.4516104361969209835 0.0035260379469682643153 0.41230548425735064066 0.057788039137471519657 0.13754001136946425454 -0.34763527699182994457 0.3739819278098507338 0.25943930807791254489 0.10226029608618235345 0.52192916103057640509 -0.35900874217278372358;-0.080728945270474472551 -0.77787779268368151264 0.37631618674809658165 -0.88079300839307639315 0.65310380772825848972 0.21253377757380875757 -0.49828661816230995774 -0.80917148037973507524 -0.26028593588410869897 -0.58154541467565257218 0.58796727450953056859 0.51155038817832276798 0.57329406111872338592 -0.15012994885311214954 0.25240000927711925272 0.44959656657706409399 0.40133015748520095567 -0.095161330650841133294 0.11767078968820350593 -0.21878084003855927109;-0.38694342245510499056 0.040437483200708411457 -0.43804470435511128068 0.41103356862195211674 0.73124013192372028236 0.70350301508943458018 -0.11654996696255433275 -0.032794222164648750839 0.35984339687580135791 -0.35215115207287855936 -0.16109443530027500735 0.62848637392803052837 0.54631861304508544386 0.433981933804437503 0.60953816081627576473 -0.078188635952695789699 0.28758611625829383351 -0.30817084309206083104 -0.28639777096451163318 0.28978597607180528462;-0.14538457759158479599 -0.23539927418738512688 -0.64400617566968132444 -0.58057552446119742307 -0.019620938371169772962 -0.24337806509578788217 -0.60483211353046828496 0.20381286742102758258 0.0027099458376229515304 -0.24336463561382906673 -0.18153497280760536037 -0.20981227897287585415 1.0692927210286973239 -0.34739515641518292632 -0.62021296353276522684 0.64475518510888729651 0.44892261525448001747 0.21303957948713128645 -0.33045273594809260187 -0.25044402226493761576;-0.0067625743654897534085 0.005007114693661015789 -0.8321190847954016423 0.61753015804151822898 -0.76989770924631339977 0.1306005932052734797 0.15435390112120808692 0.73873693426996256406 -0.10637742025959978642 0.06355993920070654446 -0.17831962597490663702 -1.2721278443606174324 0.46320720719303815072 -0.19614257693891420931 -0.21288697418870874967 -0.90934788967535651327 0.016037783769330359734 0.71069705285497108971 0.45315512401865654102 0.2166603096802081907;-0.32244733964037425311 1.451003236028366894 -0.84160750566551434382 0.27811717196882979053 -0.76671347560998170945 0.6505281580528253782 0.90562426631443271319 0.42297922616660665884 -1.018291789179730511 -0.08626625345679733714 -0.16878481392928548765 -0.10846751482629506114 -0.11900027139866686809 0.47084318559521959324 0.29108485100706693594 0.10571397588664148415 0.81482161293185617623 -0.028218309684243794017 0.76351266709283616141 0.18530067138786385228;-0.60750797996931116263 0.47221324816772625166 -0.29627178881901722329 -0.082994165534992989097 0.13308441947642507541 0.85965907033783084401 0.19777807551645615325 -0.040850150191716567971 0.73618339365041485234 -1.3432827596753145194 -0.46875263566439451246 0.22282404787482851249 1.2718037043121761531 -0.40449547435141824936 0.15324929864865663443 -0.20548540343991525403 0.28699096760535974804 0.087572745252827502438 -0.060226389173120203901 -0.24245106315209230541;-0.19681308122686025364 -0.61561835943058096365 -0.18527790721694514797 0.364441264202346904 -0.097772738628502359193 0.37708503376318591727 -0.46470322955194626191 0.19747679845572191359 -1.7414495177619806476 -0.26210636537838283289 1.2218122541256324354 0.54507921660112168549 0.37730490771855834664 0.42288440748762673449 -0.48338963445748545089 0.10306366018438473109 0.44900924734983299613 0.27159154101840821127 0.70940094197812531007 0.27283920526164823217;-0.055436578762103137785 -0.27876094433156667352 -0.1659948313322951452 -0.012760025967216221537 -0.37543301888532171207 -0.43144426799216611945 0.21095734703854351899 0.44593558958851947649 -0.30390436813777088609 -0.28922294771405077096 0.67563661191854851307 0.38427350638259161197 0.7121985470106274585 0.24492959850381382236 0.069635431336135769631 -0.46222120013760537027 0.2474209099425052627 -0.75617453748412322145 0.26817688530894562282 -0.34146721592632972575;-0.75200768831299269479 1.3305213044824224511 -0.5307383958424833903 0.39836918021125428124 -0.27130908929009900366 -0.42710892665623567677 0.87467969332374495561 -0.69304534451575028342 -0.49330934368789230993 0.11938237103319845889 0.48313996344365650604 0.55648156380031987833 0.87915834755280020119 -0.2937231592172012129 -0.573668454598924904 -0.019387522540258092518 0.21717919189254250578 -0.63981545525753025228 -1.1830277277057816843 -0.3071622620236674206;0.025408695908736868979 0.52792628901065852265 -0.82777289272975740353 0.42662005738058733639 0.3263609041217361284 0.055384534323212886164 -0.29087981149195640818 0.24672381228986456358 -0.1878425843153378183 -0.18061517242045099785 0.5381197778880278948 -0.19524991878052555538 -0.66622997389521521061 0.49964628810533506797 -0.19517544463607883198 -0.3002925042852782056 0.48361973915724848494 0.73280506306756865165 -0.62275782623175035546 -0.91015534843556067379;-0.55356280377938393844 -0.40338081302872419442 0.39419135259457677156 0.96535628955201679968 0.37232558329371323591 0.11946676298429836915 0.77101449585950410093 -0.28002552114643919356 -0.44170913138075151849 0.037003336838256073449 -0.12759387843353856007 0.46544532135488703162 0.42996522524768532314 0.10890217156576981195 -0.51880616879217689164 -0.25216440983043181268 0.11276732239025361038 -0.47862430623744034452 -0.56283949191744009344 -0.26829570148132031449;-1.136118288963946954 0.034921915557837850119 0.55012148851350239909 0.31911482147867070713 -0.28679642332721011488 0.091429133950545429799 0.3435658592440231085 -0.65211905411187065518 0.48979260579879468906 -0.30470992141677233356 -0.10692708684343509018 -0.26024893285401412557 0.80295838305943678659 -0.14088195191500821335 -0.12266021310542554734 -0.4675133451148123509 1.041651290776788974 -0.13886676185341495504 -0.056427089914031114404 -0.067520000787076636661;-0.13204729033125078841 0.44991363497157338402 -0.43021663758338979378 -0.28476425012884198917 -0.26286572963231624733 0.071022873460054994355 -0.22343103777384290543 -0.20311559940525683587 0.46694691264549914589 -0.50915111628012399425 0.34608659387187890033 0.14167510581470360576 0.43402061226937516114 0.54052566305052396345 -0.23482902714811204614 -0.57757257149341656444 0.16314897203777090073 0.31958605701497716511 0.2283068791808368081 0.44419055871194279561;0.34089344442101560118 -0.069160704698719627226 0.56485283265883112769 0.42633624982447221319 -0.61276298684927599236 -0.19423270510733445238 0.091885395553185783557 0.27250965239563545994 0.32994497889890067599 -0.6175108940335645169 0.26662790938409364205 0.3559857035495929134 0.2078636713058107377 -0.051751224503696298396 0.42308853740584173586 0.091902551856239383943 0.61296034740019789133 0.090786143498457261281 -0.37556849898109495589 0.46949195879803978793;-0.38170127873376907823 0.23255756087871271021 -0.48023245737085018536 0.24432664973441028944 -0.5557739326610546815 0.15369365067895041088 0.25701490022701467542 0.5783900291557136919 0.11985806098623115468 0.57605638941076109383 0.26030442634783307332 -0.19185384807996125334 -1.3675815077228659078 1.1831008807811200789 -0.15624027196381279348 0.16724419765099643453 -0.7404673246931655628 -0.026743312157283323505 0.98025080155949229077 0.59382786464778203328];

% Layer 3
b3 = -0.26025391567358624467;
LW3_2 = [-1.3705725485449986589 1.1434540576820537705 0.84013923411337243508 0.42838304796945902986 -1.1241509182048901039 1.6359113282394117661 -0.79848530579784471328 1.2286884065625738316 -1.019616541209672711 0.93545371045419056788 -0.89052187668909366103 -1.0386045660252283263 1.1814302881439322501 -0.89007741483547120342 1.1137498732908972521 0.36290227726960561094 1.4020170201464829951 -0.0032940815735055827863 -0.26503169888924660302 0.84662689667839319263];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
