function [Y,Xf,Af] = ESPER_TA_3_Atl_1(X,~,~)
%ESPER_TA_3_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_3_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5876575845453815283;-17.812878378891245035;-1.3358368800497968376;-48.807080975041948534;4.227381353275818654;0.74910265775811457623;-1.4617296561487651552;-12.921167275481320047;2.4488813246628327036;-0.31847778439975205078;-12.455668639965432831;-5.6549152334350205606;0.47219299692025878956;-21.331603019428627022;17.874378268060869601;0.21358218571662332397;1.4353489340609839608;2.3597327328740433927;4.2627684808150947404;-0.026860845333404791135;-1.6352871894781486617;12.074079546667592311;0.14903771523710013236;-0.38594790057765765434;2.9092362482540021773;4.3679735548077589513;-22.586558772054036837;5.8158349181402053674;-3.9024812571540583583;-4.0817588487071043701;-5.7612371109488300647;1.6312682674408574002;-1.6444711499991375714;-3.6470208230066076815;-3.785254717560807336;44.36875259997479759;38.82084254029140169;-0.26480087751090047865;-3.1129012536349249807;-6.0025201830090439969];
IW1_1 = [0.77598836975929130766 1.6781486176114071007 -0.02134771641561843819 0.029104935764887138183 -0.66565842886366122233 -0.31662412106206594409 -0.12804867497525915243 -0.18403733215911372012;1.4030253266843522031 -6.2783280730630588451 -2.4153002342915828038 1.633824864596973736 9.7141249906755113841 -2.2196323709789269607 1.9657043762758097394 -3.6786687649569489444;-1.1478878036636572801 0.3983135451712612185 -0.14990758025106906692 -0.48521410235891943019 2.6426693432378964843 -0.15123217143243608551 -0.77816765550108979443 0.37670239560983387328;4.2103645287538480346 -2.2732985163772991832 3.447649915537005505 -4.3760741757253613926 43.74526671519660681 -20.73759409731601977 3.1457117996234718049 3.9313001032916030653;1.1740204292535940667 0.22693439582231822449 -1.0229650898134854398 -0.096409275674307043369 -9.1629456345203657008 -0.47949170204722324495 -0.76049264673332017672 0.09345039654443355881;6.112597523446217096 2.8886847445606296247 11.011822625471140213 7.6269894522352643662 -32.100705393225048567 -6.9246243174483383953 19.114637154493923532 -7.4881156832380959543;-5.0094126435270105446 -10.195253978036822318 -3.6461019346624934379 0.9642752528025227976 5.5922311058038998155 -2.9303105966313656161 -0.3380698011665876912 -5.184091788470493789;-0.90124254645920065521 0.049412958793997915907 0.19653998168521483181 0.18595819989221379354 9.7280769154325685832 -5.2074085059130768016 -0.37574997836402068696 -1.4603170697886704854;2.1708988752452453852 1.6590460076470328055 -0.028717560127402796261 -0.027935121539135489982 -0.069605997816577072634 -0.59277077925797416746 -0.10805939347449926291 -0.33284037222652812504;-0.10990594553345638118 3.6048399333743286199 9.4741257269448233558 0.033306814905801208904 -4.3528709576968900308 -0.11705474745131151659 0.43877122174678978572 -1.1485337799858830188;0.74482660803770528446 -6.1275774340954329844 -3.9883316643380668509 0.0012142069062548660821 12.514054308534925397 -3.9532660933386387647 -3.6412234742629210338 -1.6897213874765522057;0.96314005740348918039 -1.7177125442495018159 -1.1776061797486057081 0.46789323374363495089 6.1335786030286163495 0.030315710256464838135 0.67157439187230782984 -0.3391424021418983914;-3.2983030669589106232 -5.7696640194978368044 -3.6043977255989934072 -0.033942139434907765694 0.17145567868580208204 0.37268310278098776278 -0.30747798657199854055 1.3714669319006791426;-3.1324538414476830184 6.2262255355152733571 -5.0695128236551054712 1.5312372324353022979 32.489007306074427106 -4.417851333411760173 4.9562900724032212807 -5.5482590742555295549;-0.78050794141559354244 -2.7947483004081044022 -0.61404681295612195679 0.27022844358513870011 -11.649668549826076358 7.0078464886982825277 2.0701146939702974592 0.61578093622316931732;-1.2536148701939691108 -0.16617965173923118782 0.10799218472406811598 0.10075139081052031376 -1.025439339064914579 0.52204528338691447154 0.19448813703021283761 0.1541053709934182836;-1.5031200483936844048 -3.0192286204772122993 6.5275351590754722153 -0.16737702123178796465 -2.9278578071057594912 0.00048478072879456872435 0.61548009735610387239 0.18269941365392930455;1.21986573707547441 -1.3046759492989394857 0.96122018110044649131 -0.043533135303951621398 -2.7360505240815866657 -0.39827494398619328608 -0.91731410047795658436 0.89203162737696639617;0.047569314599471688998 -1.0950464649266451467 -7.7362308363855198934 -0.69186897261453439434 -2.7352631068814470261 -0.15109022571619434849 -0.69417056504255869598 1.5246716814534710949;0.19591670624577289805 0.49003658488123108539 -0.011650157316279318234 -0.047408285273378675262 -0.034207351476127786927 -0.20230241204901106 -0.091218366908601897225 -0.046114505238712660828;1.6046983871387905385 2.9054837465928158302 -6.5997726439995982872 0.18988887223125427983 2.9596846041171045449 0.012990784097602806058 -0.58637805535540188373 -0.23100031959463529496;1.8502299236935431104 6.458563408522040028 -7.2685438095678636117 0.59873461464598320969 -2.183523666963065768 1.958010966905262551 0.047734505177358624306 -0.4874108963814400286;0.24362722183027504808 -3.7741035300189400559 -9.4203991330786163161 -0.026892086186978782225 4.2678182870300505058 0.13492834933889266691 -0.43375042146289011225 1.1440331654087290136;-0.35337897769892318012 -0.81762818821842420114 -0.28644371455758760314 -0.022305530325046944717 0.75981334728999427863 0.25292657488886810535 0.21590755643205025716 0.23112569650864137061;0.065207016107677831518 1.7275941403988941403 1.0521981699039244518 3.4627376306635300196 -1.9494799320328213277 3.9573995710071447895 -0.63311136959944447344 -2.2600767824196550393;-0.025700931503767888292 -0.96280406513203864449 -7.7069562685661257007 -0.6901253067517967299 -2.6885363507732904509 -0.14965967020754661343 -0.68988995479510406561 1.519084063695294029;2.5585772991874704552 -0.50922874143931495805 2.2247656750763784572 -1.2039480118127503516 -13.877632791434464821 15.240528426685195029 -0.13480382403064145036 -27.576554904245373478;-1.0336897504094515465 2.7277671986441949237 0.84661690824782354081 0.21819328523264075459 0.17829068250496021841 -0.52709420213770163954 -0.017159165054102629155 1.9136755740760356126;-6.0280334353500109046 -1.0728509459220778588 -0.32372854588617805405 0.54129865648962183222 3.3479505618386466992 2.3018754906902656465 6.6087212262052004164 1.8143821721705821748;-4.885829872903787674 4.7742718872257272622 -0.97859745152900623477 1.3869036444774185401 15.539626314216109293 -3.9455173002075514255 -1.0189461069997041154 3.4712166814487357414;1.0066733174498685432 -1.8343267371260061349 -1.2006819599150662103 0.46206070865600973319 6.1332220635680929632 0.01071128512897962827 0.66428032058615937849 -0.31342021791705065858;-2.2550038795917743961 -0.081029918244738111111 -9.7814635250975374703 1.669168828099947044 12.927208918648924296 2.2679875605042560949 1.1253790253707556257 -6.8848469709107167347;-0.18763478699002550387 -1.6352468908232535849 -0.50260593396866914961 0.29892819058574782165 -1.4967475792803521806 0.39955310143339850537 -0.26417766110130885826 -0.85673665252984942953;3.4392246017680294656 3.7691677425941207957 0.63939835320894711224 -1.0513313558893153665 0.46368750627167237832 -3.1006508766137526045 -2.6168066388604485084 -0.26399930170702806675;-1.1203361202112773753 -3.4404344468484491237 -0.013241465652781374968 0.030807060637347907783 0.3556639077663811821 0.59042775521878931855 0.20576937538785156079 0.11848913505883029718;-1.5034045826235127308 -15.961620830534432258 9.198059084131873675 22.253891460441746375 -78.705903121233589559 17.643514005311242698 41.07611125578891631 -29.522701087712214019;8.1241386040134599966 5.5713012516773074978 -26.570333438088386657 -4.7216044596443129677 -30.76861075229549769 -6.0654089285324106484 -6.9997394319467307611 16.357923419895644912;0.17925522431685969593 0.92216335572622853967 -0.091720422199599041524 -0.09621585279642996813 0.24932351540441130555 -0.28174629255732647204 -0.089024483729203601756 -0.038769322740889851364;-0.29363196858936035927 -1.61366444913805962 0.048139647442659513898 0.47897584331505610455 3.1453610256955597535 -0.88759819159785180442 -0.20611177416596618284 -0.36145393340400427951;-0.26926177103463394547 -0.33705935243367002307 2.0745278334033327994 1.0913318275716428207 -4.1681881928492305889 -6.2618065834991796237 1.2415052586970594106 -2.2090981816469574817];

% Layer 2
b2 = -0.38687041225534402056;
LW2_1 = [2.3764129333982064729 0.033720647458375566097 0.12742850280627654458 0.0035046275664151150739 0.035822352589943283474 -0.0036806993474908975515 0.016182922658362575152 -0.080137323985319836028 -0.99731358567326278131 -3.2500070315105809016 0.015712120333648028903 -2.3329548153495993645 -0.016083341764089070791 0.0054499923820893790907 -0.060046794731115550603 -0.8159225759529367128 -0.77807007597087740614 0.094325500284078253599 -1.4959978992008649001 -5.4366916778185618853 -0.77166648348098842991 0.025599579652810799252 -3.2644002854635236766 -0.71623957676717797671 -0.0087212363911818094331 1.5094152320833014169 0.0035849521217042618765 -0.16975926462140128459 0.0054778497984886266939 0.005546017487477152702 2.3244021101645420124 -0.028783679627243364402 -0.33332667040843982909 -0.019454389545886286578 0.77083357099931049117 -0.00086633732469478539132 -0.0035262527296397380705 2.5657430311995494954 0.10943310094149064082 0.029651749815342010735];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
