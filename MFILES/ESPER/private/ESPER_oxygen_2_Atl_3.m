function [Y,Xf,Af] = ESPER_oxygen_2_Atl_3(X,~,~)
%ESPER_OXYGEN_2_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2272993837827170793;5.9792435077633081519;-2.7281878215061099446;1.8479874437337902027;-2.6749844598556671293;-3.7037313748200708652;0.15592752330344608613;0.3685246320463890779;-1.8604024796894111926;1.3481882490731591506;-2.0646717906042271196;-3.2788860573353253436;-4.5792145982964562734;0.71948498315212239262;-8.4703096052524831094;-3.4080081584508921111;6.1036084012155527034;-0.48614691472508769765;-1.3177712208011069794;2.0995748193231031919;7.0761637745792507204;-2.0022371684384410173;3.8506851229220702137;-1.619569142061537903;1.576492062135475658];
IW1_1 = [0.29137619396115971293 -1.0773002870725427726 2.6427033461974529516 -0.031223611226968196047 -3.2201697416139407615 1.618589106254008092 -0.20969608762702801608 0.56423022037666803463;0.68990154306912032656 0.61328640320108418482 2.1255283026299625071 0.37730853900519450983 -9.2423976914577767872 1.7683426328569542552 2.59876388098767519 1.5919894573933157655;0.072687675679097604742 -0.04394917589648176387 0.39746684353710426407 -1.0251489860697351464 1.5312834587656121155 -0.59331080382792666938 -1.437876251400359795 0.033768163541949801354;0.29266406644361586675 0.90776106304264647662 -0.78809220540733604388 1.3837210500362868704 -3.9488659113538053802 0.089716007938240249775 -0.25319513755086264784 -1.6826448100086648374;1.0240861500730940037 0.12330166705597629673 1.3693604556990905952 0.044083196997718523957 -3.3221587633030358333 -0.63160483098574926597 0.43594391504126556169 -2.3184938826321084271;3.0662173439632169902 -0.73728935257798289271 0.23523537715546538607 0.7041448837775809988 4.101781296219821904 5.6164306712982252634 -1.0935071605251736049 6.9353813235799455228;0.46645539933415430811 0.018021183477363530295 1.6057505861694305604 -0.66055583334479928137 -3.0910307022736001059 2.1723155331063646045 -1.0561344571340340881 -0.87876145707152386599;0.60767915576138409328 -1.4147928220565486601 0.63602832481960336342 -0.3910519174199976189 -1.9951171703806052093 -1.9709496672880555401 0.5180610747822316231 -0.56674305046348838477;-0.016497567161710975647 -0.0048345313526657425138 0.40035125110673047688 0.058404889318761935013 4.1814547806700126387 0.73261515699480284081 -0.4783503619211270097 -0.2333201439688047385;-0.35534775929610434853 -0.048504036855366007563 -0.021232099558326788385 -0.040707242782263348968 -1.4485522122271805578 0.8816630486367255104 -0.48672085124356945229 -0.11267022866825095184;-0.26053283753567962888 0.46004530048513625484 -0.6646082618976791867 -0.094019562495707739713 4.0754601915726080819 1.1273652328414620616 0.38018514420163906919 0.41544887781035871877;0.1839663425679611275 -0.076757298789842859366 -0.85660726405216192081 0.45204495949825840295 2.415506244367794153 -2.0618140245079628059 0.7871630455605954646 -1.7578816715818104122;-0.43682298289363402644 0.053398637642873440778 0.37361706529093285933 0.30748095851176726612 6.4824683632521660215 -1.6043087002029341459 0.12837840783504611553 -0.776391283166967483;-0.066516313903695098442 -0.025704913393150917444 0.10825719789577643859 -0.021457969171439189582 -1.8377745728858190244 -0.014726554171390175696 0.2866319686679741352 -0.015492234460575824567;-0.35898726152534632394 -0.18097668983112272234 0.49860595005717733841 1.3217608143427699297 9.2793821508607035042 -1.0381674125674877907 1.3208135173630883852 -2.4428722960767776939;0.46907449185008870396 -0.84495154470580835504 0.017946507417417101315 -0.62992277581102595896 3.1023285098507247248 -1.9199055415241343958 0.42747387824956034619 1.1048418190247226711;1.4525395711941064825 1.2120287217709528882 -0.82812289737513367083 -0.25594621394992372876 -7.3208342036959681565 -0.46134222609443747976 0.71667598667121457101 -1.0964291684152946971;-0.49419997479374977445 -0.77713055588761659198 -0.81581757433175261518 0.098669732899688222805 0.086949319812801309504 0.4079576842968478112 0.94962241301459626719 -0.50695030821584641245;-0.39684420766862232854 -1.0489416462391265572 2.1924533320642480838 -3.1731728803012972939 -2.7380244962696420608 -0.43772869521781559987 -0.45224235490259823145 3.4261075274645436117;-0.43082723819618690131 0.69939596504752821193 0.28774319714755614008 3.5929857085028187313 4.9744356187041116613 -1.5680727743623783521 0.87921589589663984299 0.15841017403270865604;0.10329173745353026348 -1.7359993665321324929 1.2642395196095765897 -0.62681864198269254818 -6.2428390247125697954 4.340645143369324721 1.8693732239944502727 0.38579086788099281602;1.878038673678230186 -0.48807009531004769132 -0.38605103541734653305 -0.27143242105473430748 1.0984711204879284985 -4.4078317793803751812 -3.3479991398577717554 -1.1987356355597871271;0.1301225847109541145 -1.3667393294640433066 -2.5856295496657395461 4.5324499362459222951 2.5113124227821908008 -1.1492044862738381994 1.7510751206242638478 0.73494406142353163602;-0.22994234609445676765 -0.02564417177018843419 -0.11795405968700346799 -0.7259902759344983858 0.10831403904413343386 -0.6441494517810939513 -0.2418287861674532635 -0.31917895061761392128;0.17791712543273693892 -0.69493905158968216629 0.39573039071117971366 0.83909364522144092025 0.80289505541260541843 -0.039309847917667326 1.5819371977745102509 0.40330247821952686094];

% Layer 2
b2 = [-10.001002291004098765;153.87773244498060876;-2.7342238643282779087;-9.7769174343475491185;30.043377174603534741;35.867349035961566983;-4.1975092472957769019;78.134402902872935215;-10.129449206205846323;20.881246234716687837;-4.4615548102296758159;0.2580222115254886539;1.7494980540755560305;-24.196675722704149791;0.0094726016069076306864];
LW2_1 = [47.530703725219041189 -22.871222395298563157 55.679523213225614597 68.34077625621785046 13.397596910655257929 23.299838732735004498 -2.0475545610077841019 -35.219096257535561278 103.69120332816908103 37.74003948834533162 -27.521885276288209354 106.38866382147018896 2.5731678686229275677 -59.858575566728461581 4.7973335442306437315 -12.807953468774012862 -46.391340811517558507 42.841360419019103745 -73.941484157827943591 2.9663875317859011993 6.863686549098858336 -71.460683792398583591 -4.4026494851007011988 -46.514965208998390267 -32.257355098227783685;-11.838255727118976779 96.321836719253369097 -15.653576536155267007 31.469457871332132015 28.223949845864634511 44.500326579481850331 -6.493890292751355986 82.631182537875162097 -7.0917530382553426449 16.475825645527482521 -11.862532461263850081 64.339526550897105039 70.449242391571743838 -6.065509724180068396 -45.610068886146216016 -27.481929241597924829 -79.674510110744563463 -28.425559037478731028 -31.845364286206848448 -84.548473995482538612 36.239156276834478376 71.039340126679434206 -88.498571253949322113 19.62654562006358816 -44.197604491548624139;1.1234471556881104881 0.83903352594311930712 2.2324220228892213136 0.41934768836115110524 -7.4532410065987386716 -0.40456708851713635289 0.94657424331194162104 0.66391377205077473089 0.093242750144867547757 -10.394694447892209865 -0.88394602687481416137 -2.4592725681197773469 3.9167952366665050867 -2.580712704997081719 0.52144273405745233951 0.39025254872867509714 -1.3193150411819514201 2.7110560538346701875 -3.5391183730679323105 -6.5603353647707169927 -0.99428106275445626849 -2.9273925674772400818 0.30236637492530571425 1.7406271476903407702 0.98137383272697975567;-1.8285855988410033568 -6.6206233192083727701 1.4880940240141649067 -3.4532871018018522769 -7.0594418831800851422 2.700783527902416381 -1.0025853245698319594 6.0044919768759053014 -0.26035500222529722736 5.4620392925147482899 3.3555528993457870435 -5.7512230417976795138 -2.271793814111097376 0.17632775640139669582 4.8182642923303404814 0.16158261140862198446 13.175521762474021514 -0.16140584778178446168 -0.81206902384968349118 -4.6999522672247628918 -1.8110773133133593049 -11.407759703930359763 4.1957976913639596361 -3.7479414321974284796 -0.50990197408253357114;5.1590996505582289444 -3.1524941014449279209 -21.492519589922800094 -18.971344715612335818 17.418418685621752218 10.674146071758176646 5.808286144736448442 24.132223611319250978 -0.54866282379277631076 -15.300459183595611634 -2.2728156977140359096 46.950032922530837709 11.398630997736670878 -13.196520740001918881 19.171125846729292874 -45.748760870201266471 12.277153073489772694 -12.201151312681835392 29.197296066846089246 -43.604241412315602133 28.093844110250454804 13.784823653243950758 -16.134196059998089368 39.161318854174410831 -6.6513162320232810387;-2.1461064356949934862 -0.14950522252993603267 -5.3864120215259694291 -8.7811033644007085996 7.0264306415134409889 16.565876885446222389 -6.8535040690018691478 6.0920782129426385154 9.8394923650550207839 5.0772227209727152086 10.950129412532815465 -2.4613755392812284306 -17.939154329419228162 5.6114651412088596416 6.7605948400575819335 9.669304715358096658 -6.4424040214887599021 -16.799246373600176696 -8.5356131651429549834 6.1358829336961999701 -28.382349893837631072 -1.0307027454284600765 2.7521135219638690472 -6.7243198427619059743 12.36570607443293035;-10.25836684801897114 -0.15922309230960554616 -0.050947349777999854925 -1.6472927580504337364 7.9458864768126957756 8.2645361528786640548 4.4791501830095308279 13.423964206156655976 2.804216212129979624 0.21424388211865438847 -2.5975691206041107151 2.4707888236947361804 6.9829286156114225292 3.8369925031693790096 1.3476593239441427841 -2.9266445483451968279 8.4649112070580123657 4.2309420748507537979 7.4706561124917509886 5.9762571156351924628 -1.5283410334000033792 5.805584697180059095 1.3703096166994785943 -6.4553329959239622582 -10.389232996633374739;0.88540607442268404181 2.1587678662416407427 1.0489024795213277574 2.1418668387690593669 2.430680814934874423 -0.30008632274516738869 -7.4800609061858205351 -8.6940922810789977859 -0.95937729289608275618 3.5693083853942466632 0.98449555495936691418 0.97499435006972934303 5.5243050644662625714 0.56729221813322916468 0.39519169649922469834 3.3405225963015263702 3.6009710898482376606 -2.2406330705903747536 -4.3057776652194297284 -7.5399629163874930526 0.55921697805046088892 -71.896414848063287195 -7.0765963111083731718 -1.2162999684155266777 3.7898185626129232695;1.6316733752890506537 1.7466579859272906017 -6.5679845651693637976 -5.0503455913959420798 9.9682692710105378353 -3.4242471556429432411 7.4023314707202638729 -4.8961644090413916075 0.099761546762477629202 1.4806456878773286423 -0.52547590397677412799 10.222557614407985938 5.4453051285615323707 0.32380123886174305703 -3.5107892495555605983 -0.91782745976406998611 8.4409167626846652865 -1.8730319334161331657 -1.6874145525662365142 0.65043550581099285335 0.064557863275118448909 10.603646162161988187 -2.2843213987741899373 3.6689778101965715429 2.5741543212466200252;-5.5570129882313183955 6.3895083582701515112 4.5482762867364909809 -11.175643210725192844 1.7731203399130937015 -0.65455408356866817687 -3.1051177410764578823 4.3385924079110580465 -1.2849106532598606467 -2.6149915833792638509 22.859621917787180223 9.9069577228472347485 4.9305332318238095368 0.80164614685029378371 -1.8283752635747778648 -5.1520471055369894131 -0.088058949982005765844 -8.7986955364881556108 10.233490975179725169 -5.2307404181366408125 4.3882063953407444146 -6.2780522473730115962 -1.8196251878860212337 -29.949732125894882984 -11.469455499740240256;0.25811317050791249272 3.8272635203140081828 -0.41498313939999387223 -5.9715928825831579019 -2.8963048624509699636 -1.004128160191368524 1.5032222970461324163 -3.7776185610711827678 1.8462659293745504741 -11.736668464482512775 -4.2195594657717894194 2.0252836730572241208 -1.5093544845592699044 -0.88566027703466543297 -4.2260820138523298439 -6.5020048343922454137 -2.5282483420718695477 3.44504833670691335 0.80631549779158584457 0.23408206891976898745 -1.308745887333168989 1.2836987141349349706 2.0976991141078973335 6.6365701338977647339 2.4278024852374611164;0.053979761842564595586 -0.076204116237439681325 -0.24129969394246256198 -0.10430289075854566605 0.19921112252604042392 -0.0039456528161500407925 0.04300529539029530196 -0.14021957415655353363 -0.74907778399061808461 0.30199603154953724715 -0.38075062582688706803 0.1189479500058849698 0.10498473088580535795 -1.4781115851020463214 0.032700734116396235063 -0.1244298897953060451 0.081793079308084243317 -0.17028299532145135808 0.043864714663466093658 -0.081769993706945945378 0.069757150502264803071 -0.061004690434642919183 0.053020401665755327592 0.44896364971782176667 -0.053477014617825086029;-2.1114808644237701429 -6.0228047623087457296 -1.0268340762083068007 -0.78251156273851907308 2.1954137632193311269 3.1109850495351816235 -7.5720895304209294707 3.7168067772863593312 -5.5118646469031542523 -0.65885572289791893841 -0.58633707693932590743 -8.4050453422655344582 -6.7026606011589988654 -12.748870362055422234 1.2764185022110245971 0.51205956018116383088 -3.6564272831872748348 -2.2098492548513761768 0.54755235339887897705 3.3531217143822162896 0.90343158484333252467 -3.9503971950312535277 0.37825549235969702089 -2.9709089234210530606 -3.7322155028102748098;2.2380267222570546792 -22.341887875813206676 4.7730432866819576532 -5.7298728625871344633 5.5877819085694317991 -3.5080888833069372446 0.29759045989814048028 -10.164824707758624456 0.083701377399765519716 -14.958580646672679393 11.143087564806632983 -4.5633178150783670901 -0.78127732080714717977 2.310662368330052896 7.5737617696077927931 -0.36547121182199976408 8.245957300643244281 2.1319131889825788662 5.5990066402699349979 27.898478619084333019 0.69787427508187938052 -5.0024338894692590429 5.9811749645769003436 11.816579493956069769 -3.1418256207020722748;2.1668666556873534823 -1.4940511649722254539 -1.9642625624518630367 -0.31503737674504045385 -0.48317168036240931706 0.99613785572838309257 1.5477343914393413282 -0.092994354524310290921 -2.4900556822744723817 -0.20245967088568270209 2.3975520969297283713 2.4596743360303268133 5.8509109359151283414 0.95696789140993421263 -1.4974033387674197115 -2.3329698250172072882 2.1341719682092938903 -1.9891221421024747329 -2.3098520032354405984 -3.9218688356232194181 1.6437835789565695688 -4.9123604982470299163 0.65021570506217962748 0.51123600923292888965 1.0899652216457584863];

% Layer 3
b3 = -0.76063192172314708639;
LW3_2 = [0.0011676629658567267128 0.0045479652422986500612 0.06754485897946096995 -0.01520504173027255497 -0.00018118390029657043807 0.0098662911435363539331 0.015636721762625194893 0.024753711431176293745 -0.018860220833590450595 -0.013443638487437551202 -0.056453781253751528224 1.6043249838508328864 -0.059394773633799136103 -0.016165610635399001171 -0.067023059701634399299];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
