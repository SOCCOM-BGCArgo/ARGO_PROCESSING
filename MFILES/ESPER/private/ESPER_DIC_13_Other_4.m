function [Y,Xf,Af] = ESPER_DIC_13_Other_4(X,~,~)
%ESPER_DIC_13_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_13_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.3598908621519454343;2.0030422855819152161;2.4746974765157552234;-2.4026677444742770007;-1.445210945325684726;-3.4299587151672707996;0.62123143236941591461;1.7739154586487970722;-0.037645881767912531268;-0.88701795389918891566;-3.2232021768147922636;0.58741472890590762379;-2.1006361082704478882;-0.66116322574044938953;-0.083310178498009632153;0.69518729500388531939;0.39031369129357001979;-3.5591562387540154333;-0.73906812718868164502;-0.24329750434661528979;4.7974002317216273283;-2.9049026190180051721;-0.96758327349556361163;3.4534642995267592624;-3.1995772734745191457;-0.047191050489901062437;0.069832084652091439003;8.8747709768106002315;1.4762340758679897146;0.6638556392118665217];
IW1_1 = [-1.424392279924995508 -2.2452650341605107087 -1.047096169614865957 0.77430822060981296939 0.48173845900310369172 0.49361185288809816818 1.4341924344712642103;0.9940229993714256862 0.4859224004157163268 3.3339520759472667244 1.7525542482374492081 -0.89914506050991349628 0.45520699257353441913 1.0898577180264046316;-0.56942595022115383152 -0.07219379308669877926 3.3171015227596396535 0.46697502136637342174 0.78045045504579579898 -0.11622495565519655458 -0.37438816575713879109;1.467160448041054277 0.90256718636142496681 -1.9346874677424614752 -0.013625871108095209336 -0.14348610701237979326 -1.7379665466817502129 3.7435684275568315016;1.8751616434810500778 -0.51253162652955064349 -1.5512175306048585632 -1.6613854030740420331 0.9497900916116898129 -1.2552766680409455091 1.0474300938737635125;-0.0085357336733019838204 0.094135862346715518112 0.20753295873904692437 -1.4561361417293487985 0.56424237450560243978 -0.51703231924106363149 -0.019051958151871002667;0.33737700062450270977 0.070785759002640391557 1.000204216959443837 -0.13799677910991384189 0.38551740890541980056 1.1256831248577825466 -0.25494677902258511271;-1.4826496404766869031 -0.59619469139521508172 0.55958260482590960194 0.15502595281603759325 -1.4270513996845137772 1.9136127286105095724 -2.5186807945847520251;1.7057812754822583301 -0.18053937061000549513 2.6867267694995775607 -1.1668018412550991147 2.1807222425888599382 2.1608490090986243182 -2.5901619618951339241;-0.403291996858797408 0.68408812150264119989 -0.98040305307572461757 -1.213010330152021421 -0.27103570347744199154 -0.43105684158120077809 0.060267682511148799873;2.2733958092046235855 -1.0315400328123922602 7.5308215053159210939 -1.0631818923166220792 -0.33298902374209549127 1.3815289178444218887 -2.4068484541773313978;0.27806037117602461217 1.8698175800343461717 -0.83921492540091335854 -0.18075418791908262617 -1.6924800776286703652 -0.74864703835649626384 -0.03175900747736534746;-0.024070066588036218014 -0.17737904757848571569 0.2739304038749020842 -1.9673363391388161148 -0.30219129243916964533 -0.71895925354831313747 -0.47591162254553387445;-0.41746595009376402663 -0.084432903778492940372 -1.069175298977982802 -0.55605221374925273281 0.77461783832971509156 -0.32072718560203034022 -0.19670605338505775528;-1.6363284783993630178 1.6841700742237497579 2.7938361899451420456 0.6413033677693272816 -1.2157711266319879417 0.28311867883002672652 3.2209721013287460067;-0.17870601900480082014 1.0149742942239996513 -0.53115650727976648771 -0.3013673699010871454 -3.035427777648405101 -0.066623751920667467763 -0.79009299405814892303;-0.011935564977924995392 0.02557707612840394093 -0.87615068696296682926 0.89109099392599733225 -1.2952361454369447635 0.66644723480479250988 -2.2338854815196524939;0.23273916786150550262 0.65466141334136562779 -2.5920704332289155047 -3.6221475226605104325 5.6832676715796601741 0.23124422926420623581 0.19702960079562348295;-0.13503244449084392254 -0.13998802163161844225 -0.76836811140439109646 -0.092626554869639235457 -0.10861340120429523182 -0.56509742465441981096 -0.17737106374585887014;-2.009833983565528559 0.28101910343754021859 -2.9048020824889779767 1.0783785883458296695 -1.2140541429828137776 -2.5530600614318945674 2.4978226068996942644;0.34029475873877079728 -0.22620197031407859867 -0.82502192759381276499 3.555732079100063725 7.547749520204439122 6.1828480533142515796 -0.42961531269054420434;-0.13291210880302159469 -0.75578119761411888256 -0.097744178482894780724 0.3393140517935172018 1.3905957840504736822 -1.682726042864129079 2.4003183975985122878;-0.29920757389061303222 1.3091472110483775015 -0.73361655062430364271 0.60995663547047651587 -2.7069039210271990115 1.2502871489338660549 -0.36646003738513055481;2.6987233211095826846 1.6329096542330312491 -3.6499780265717549632 3.4293495226588657232 -0.41692239477989068153 -1.868427609644332188 -2.8829464059290135225;-0.0035020837179975056533 -0.150297477823193526 0.51248169928778430915 -3.113831028255697575 0.30834100231534855574 -0.94670106433275069691 -0.59107951799281210903;-0.082814739534344511407 0.25150094254115062942 -0.63791405184073823875 0.032818050881527463525 0.73068064799365151085 -0.21847152616500745137 0.25398247771759052682;0.090325448638620658981 -0.32353328891669508316 0.75280428272891353192 -0.020026309422210331751 -1.0111852571327910599 0.26248769713295605488 -0.23602097504108232595;4.5845564797374098731 1.8173945744605508601 0.10506174507198491608 0.42216411346747084732 -1.9225332858791932544 -1.3415426909529353239 1.3812775379191482017;2.2109769839561042026 -0.71331096555505979495 1.6019149555921197159 -0.5453379883908502368 3.2359503033396612715 0.91533200424192640021 -0.11385482324459142434;0.14237902555517090164 0.11464121590812541285 0.73039908930184604952 0.084109236007461202211 0.14791754939127038648 0.56898626962380960403 0.10802624581072263477];

% Layer 2
b2 = [-5.9372391838479048332;-4.5904278987386026856;-3.2179382278324850652;-0.28317467068899410121;2.7072929155068794493;1.0413720464837634694;-1.8245213254200762787;2.4531903304387880915;-6.4050897446695884696;-0.78830890725565427868];
LW2_1 = [4.3083494779614177617 -1.1230961258495748556 -1.496821862907823375 -2.8891805918658213237 -4.1314649282421971321 -8.6090700734793106363 1.6199479570612089763 -11.966634463241863529 -3.2115912571028815137 4.2547473360183527546 1.2926748850356837295 2.9471504798870875597 3.3478521895940813735 3.1497575332465652664 1.1339605228038360796 -6.4078464685236831144 2.8996085776628568453 -3.1521793593173250692 -2.1082712315668192815 -3.7163558718680365089 -3.0946562237074015655 0.69158199136293330156 -4.6173774665037479181 2.3438667485128754642 -0.22774536103713297064 9.5758374073118925907 0.51850872397872593833 -0.71939792610515529425 6.5737238765890486647 3.5447115101191530862;-0.12793672685911414155 5.766328273054211806 2.3988568679701183228 3.4217687547173181173 -2.6778013083169405206 -6.924716243675517191 -4.6208833407435880858 -0.83657132178186888183 4.3411103402632180703 1.6023328983264590875 -6.065022528099205168 -4.2245104424687296429 0.62757666659078825688 7.526350571180175919 0.16196291556845548998 3.8446621776273386395 0.77013938166327422508 -1.4465486737165942355 3.6062051536290216092 2.2663657675643777978 3.6133811314714336937 -4.9512836433280025261 4.4695764246414615428 1.4553062633878657284 -1.3124096748465878814 -7.6648605433585155211 -2.2303262660470548617 2.0326665571084734374 -4.9940389229608026511 -9.1888870040835080033;-5.0369671015194654728 3.2639951798708928266 -6.881141736944423215 0.089848558134079839488 1.0451992286860887216 -1.9887704757073985107 -1.7758384520265650952 3.6595147227781863464 1.3345702028192190092 -0.85677925115111386312 -3.2643027710299352684 3.3225069195368623909 3.6331277646580688589 2.0718916568509904153 -5.5490279013125425323 0.039266174676448585557 -5.8113918729094216076 -3.2829770624548100244 0.17783814021654784088 0.46696912192052397739 0.68024837484350697547 1.1041717706495106643 -1.2874360580445489699 1.2315480209466109773 -0.74895392346245115434 -0.76743105356492102853 7.360230114460205364 -3.795547935829474806 -0.42316106543093640058 -2.9413971572786734576;0.34930753827201016515 0.27486742605011038609 -0.76273714863351782522 -0.48913520787343783836 -0.28622365901357244011 -4.2133506481403140143 -2.9515223311648588478 -0.65519345332914591395 -0.5920301024052886385 0.0010649397508852092523 0.0504738623567304312 0.20998696308019040857 3.5321503061168932902 1.689605488901124497 -0.13715488580983464795 -0.34400706070195402608 0.35107960880928851255 0.12989295231113079376 -0.90708583946575804813 -0.60923845030990775307 0.0094972899013231800586 0.50527272578985438223 -0.18570299199253481603 0.034624752236278123763 -1.9592825310419359486 1.8199292541148859303 1.2241491002520863418 -4.2095736395804141949 0.46041418063783590142 6.1533379076830305721;3.4240976070474418158 -1.1037411773372298729 2.9059204787030576966 -2.1952399787015992594 1.8055851029333862545 1.6305155260139052587 -6.6222819511550801153 -3.1254165641501505668 -0.36098997929901560644 4.7638294163497931777 -3.2267172294477064476 0.78771364868733972919 -2.1435650284982652458 3.2337380852132011633 -0.11417949657568064736 -0.27979407614590462439 -0.37302882376236717876 -0.80159959368322564188 -4.9274911354552282106 -2.6089240443036381123 -2.3226300872235201567 2.306062869115494518 -0.87615178466321941286 -1.0879182345219942096 -0.055782741564246389465 -3.5582909441881827028 2.9467960038502392095 -4.4619519731110734995 -0.91691256429118950244 1.1699178890047812196;0.15372365011686059399 0.65773572239062672029 0.30495910632444167554 -0.54121995389847554758 0.71349148249900340435 2.4118865389178147929 -0.27901268525111133645 -0.17809469969083030483 1.1435744401963432448 -1.1664550388680694493 1.0512547850562210527 0.15292336472313142193 -1.403281898554017193 3.0472151730049765739 -0.056992854090756023266 0.059882632523045251083 0.6195692009096426256 0.49007160521797515917 -0.67080259168666056535 1.2253805104378450164 -0.083296459412945944578 -2.2237704550500656531 0.84776517690921182613 -0.35915874189837621033 1.0564457744872599587 -0.59694422387296253163 1.0360094679021878417 -2.5588612055484856178 -0.24246009894684994457 4.0692861159992270714;0.43660580054943443074 0.28590601947951138628 -0.88629793100564735475 -0.55421541632735193961 -0.32265402820176852794 -2.6017081589531501074 -3.3355893559051370545 -0.77347209145539219666 -0.74050177301634878546 0.045501204947302392734 -0.024340615609702825894 0.20615231647705886675 4.0063933759017542613 1.7736926963448900185 -0.14988399650454345413 -0.36129630967934356356 0.44211916647664278868 0.13278396133981101856 -4.6432797650172057402 -0.75514699542059016135 0.025518834800672345053 0.25382419459550431551 -0.17293925731403270163 0.038337099362190818486 -2.2893560593779493928 -0.21799304386808768252 -0.32752669059062722301 -1.4755666485830094548 0.54432012207902091827 2.8932124436589981009;0.99385252247756006305 3.2858417541702964471 0.92281797241742902216 0.92518836360327494361 0.68179314135964830257 0.29780823045228965729 -5.6408316510469340699 2.0037342963324489276 5.2540277999677629239 4.8477551878216251779 4.8219120698551618531 2.9852649566127915648 -5.3224241889735992572 0.022297441172566587198 3.449696360254535854 -3.1230363798521088015 2.4441414611324359107 -0.24819826873223863051 8.7564742543542077868 2.0681679079721755343 0.87426379352908678566 5.5545715239180388778 -4.8535004051288748173 1.8689719044729731223 -0.13860789801144046685 -3.3459686513203661384 -4.3415251674628834166 0.30116749362084460628 0.83643407656933399519 0.75489038986921697116;-2.1928295582012546916 0.71268429335295235827 -2.113590635090578207 2.468911251653902017 2.7888795947614606341 0.19663324418384928172 -2.376522781804043305 6.4936206781012026923 2.3108944371447686095 3.245381115622241186 1.0020916912642485741 5.5567696819238170391 -8.2645587722339062253 -5.2882927472281009429 -5.0585285838440583461 4.331600136096890985 -0.6022928684194792659 -7.8714913571867359821 -0.22100855614748055045 5.362332025235970967 1.7431918366148042576 -2.9679670845532828416 -6.3511052627911270818 -2.2956288614742139664 -0.27748837610767118633 1.1416662300625854964 -12.493836729844739253 -5.1296225325127791095 6.6967654283907114277 3.5000326950539197846;-2.994102195998401772 -0.16534681705530773765 -2.3063724458254188932 2.063800950625785724 0.61318051950021024155 -9.1645314044075547599 5.7566074097027994938 2.5296767666909687478 -3.1697427757217018218 0.2002897411989652543 1.0851441017954028823 1.518355536141410278 8.0311581555025455259 -1.7910461142098688114 1.0830197023197047912 -4.5995455793482520335 1.3181065598795371763 -0.74196521856910113701 3.7304294996818812002 -3.0193117396403756914 -0.25478026484223020853 -4.1298099521806195256 2.1955380169867204643 -2.2485516426570728576 -4.3385022452655421787 -2.6471837686540320433 -6.3236292655490613512 -1.636966142893367282 -1.4115561724484542161 -3.3942154933049555332];

% Layer 3
b3 = 0.041915915215760497781;
LW3_2 = [-0.016706949023593362091 0.011470251778053393299 -0.063249309922569371678 3.0702688095465715534 -0.027028149850161713175 -0.16289232020413901836 -2.6984705301191032056 -0.022578125157431749165 0.017166030926751535413 0.030441503135013640857];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
