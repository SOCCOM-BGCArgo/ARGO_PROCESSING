function [Y,Xf,Af] = ESPER_silicate_10_Atl_4(X,~,~)
%ESPER_SILICATE_10_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0804981580398731467;2.3823828802918023406;3.9171835522801790042;-4.2965830569065133204;0.66577806201916622797;3.4274910914890610591;-2.2314607380003956827;-1.8998716116735634429;-1.4402100887157511799;0.34010898308951281743;-0.33379137968493272082;3.7565130576917140637;2.287126189091793993;2.4771921517853354722;1.7981160086472272042;2.4991817559252855752;0.13348091652265725582;-0.73439512577670651439;1.8681159438666714578;-1.7415967193821639825;-0.23403006021086958377;2.6903794144899211283;0.055544934911746134121;0.91234546152594542257;2.1005188507405172516;2.5658254128381785542;-1.6405918789768771937;-3.0459112762930695695;6.8436023412948037148;-2.9084571402848293786];
IW1_1 = [-1.4913828567384785906 -2.4147617122731532824 -0.45984783747376795082 -1.0482271010138559664 1.3532651530767620951 2.8641910818956271001 -2.7587259730170803351;-1.8260715551428181591 -1.5039071688309408881 0.42087428241320040678 -0.22611803212749595482 0.12919805936471451258 0.070427243816065354665 -0.46142480750155495661;-2.0241822674451266373 2.0722335486485534695 2.2224086039885384558 1.3519574181700535487 -0.34960998949088728516 0.79187249186245589616 0.45151644935215090593;1.1302649824465647033 -0.78811590887045401832 -0.42983781160431200341 -4.3243204748047219255 -0.70608887984089097056 -1.453483688236897331 0.35889108734002189705;0.8137695186339977127 -0.06038427286510579528 -1.9631007461419927029 0.4759533544934368976 -1.7671907448667767415 -1.2223281772312666327 -0.46571212924722699134;-1.0787797178381965946 0.56755295918596981863 -0.073348233278564656246 -1.0155366542911699046 -3.2799339867904913071 -0.17531350016518443269 -0.69747991374946272103;-0.55844589388738552493 -0.58138707508548403968 0.96050602062693613004 -2.7988905586610592913 -0.86673745292441040089 1.4451922235774667946 1.3286448932773349263;0.14332394505962231523 0.39617707103873150976 -0.15493856517505263937 -0.28311891593100868558 2.925877786282996329 -0.12287988057883987569 -1.4577557617998635475;0.94308769306191919668 0.85889251783516928906 -0.18733690271333805488 -1.1715410378562252092 0.51468476861572975967 -0.4148334160073526844 1.1577646677902155847;1.1430001054736955712 -1.153059215428997808 0.25734084311978872028 1.2148218843508031828 -2.241824483462481421 -0.4810658038075550369 -0.12254103453130166246;1.6211915270072785322 3.3457173272333706748 2.2589688361756463664 -2.5190307333023027603 3.5492167677165165074 -1.1572664998772570488 0.49162929838800006888;-0.65972792370816613072 -0.54731856481597218611 0.13653196530520822494 -0.97420243144576723626 -3.2016130122529773416 0.42381783746640921962 -0.50108110225861790532;0.65906504919850605884 -1.0587733343408471942 0.98423487186126490389 3.0531452170812789504 -2.6587447428582366982 2.5268050483902460002 0.56841594244853110851;-0.071406252024336466788 -0.4763898496277794159 0.26228822163026560554 0.44972366733340951583 -3.963049441281243368 1.014272296920379457 -1.4867518245498472229;0.054172517687199425729 -0.76688013574759550384 -0.91220730002415739701 0.79420237347681021944 -3.6359376361319055704 0.54417506725296971304 0.61633803487762695017;-0.65422280202562199669 0.50652001371061605717 1.8402077275895656339 0.49802941028956720926 -2.6220854183520749814 1.1562941568432063555 -0.77857236689744269142;-0.29692883213270032661 0.22665822473288960159 0.41754868036835762757 0.23464714190461213872 -1.4569057611730500401 0.45412891413100986426 0.45167870972642099048;-0.47386912353057408787 0.85686828112009671976 -1.4746420106874418288 0.21255062659119583479 -1.7225974042709317757 1.3366321618699787965 0.57066090592602281006;-0.31409874737396592526 -1.8564499425956189071 1.6678788020500396883 -2.1817750479401105679 -5.338887057029407579 0.35929627328092544891 1.3847773758757135898;-0.48433066733001867155 2.4100414545243218356 1.8674863951498881232 -0.90683878705806830745 -1.1318052388014123721 0.088369440056391593274 0.52772893772940043799;-0.58016176429251398172 -0.10281326652531783128 0.45833615060416227349 0.49157419898846577144 0.76199516864167149421 0.071662032021150012806 -1.3623522519269957165;3.3750050538501725761 -2.3504054825607507695 2.3608436970255928244 1.8656331838489876862 1.4035118718555650297 -1.755562345783668432 1.3206952900191586409;0.86470197063760501077 -0.83750205533408883518 0.67391283586940042838 1.1348820999949214006 -2.9944409916525303039 -0.61459757367183087684 -1.0076809533427515397;1.2210333097843222294 -0.17217888828238145371 2.684459934480416532 1.1500429548625230591 3.7373925542164445623 -1.3333206212082315822 -0.36545585994384566231;2.6360949674013753885 -1.3389836142109101669 1.4302415773338921223 1.755695589531061751 2.4052366983378168364 -0.63297297611539315998 -1.2704706610666482991;0.91485450188633266055 -0.22057578416451834036 -4.2194348410205488875 -2.7206651479027810225 -0.016227059995393630643 -0.089448148748518946372 1.7906296176743921045;0.19798350617502563642 -2.6932548764642705308 1.4329404843508581902 0.4880117427682645892 -1.7978924609109434574 0.33090269925333354317 0.5214119752627831561;0.33368887936632185554 -0.19441984982954418903 -3.7213836293610782491 -1.7512432639481589902 -3.8493207545306606931 0.72587494612780423253 0.68435305552702974108;0.69506183485814299061 -0.058363559485811941641 2.9878093286271796281 1.4180236224894990915 -3.7787774422949977904 -1.2607172978134579822 -0.7448270644288579323;-1.0102917568415639149 1.1468998808275503443 0.52693007781366363318 1.9151056801908024063 -0.11399286290082180639 -0.96236063725266396407 -1.5331493244496197104];

% Layer 2
b2 = [0.22670332049676203412;1.8413308414772320276;0.15788100163903429074;0.32481038199578404768;-0.68314217502013330208;-0.50881173302710247519;0.61485686353229240808;-1.5352962231917108848;-1.5888018566917780916;-2.8260397603419478152];
LW2_1 = [2.3910642259531953435 0.71449734021052724309 -0.39483091997297609099 0.202247408213360097 -3.0286884119168515639 -2.2895244273180823669 -0.15548970088884939145 0.49700771784443609214 0.079117823705093820452 -0.94768868889715773829 -0.49933949842338054559 -2.050318480698774426 -0.24944733993220288837 -0.33597781667111376036 -1.4898820840786679565 -3.5877359941823940837 -0.27855109777292941242 0.076560633037566216963 0.5015477003493620245 2.4743004430606863053 1.8313920552650608808 2.5085022297482804099 2.9508979030474198346 -2.6166573128768293444 0.98990025993951857863 -0.019748800477291734295 -1.2313826274538888228 1.5554698249911247387 4.3880795724032592986 -0.85657778618612356869;0.312892720080753306 0.21447199878787176486 0.618502553578603953 -0.055326721578115418965 0.82365308079289956122 -2.1990562310621966091 0.49146525619294206821 1.3701131872738292472 -0.40060631474511027017 -1.5299862210326535816 0.2913818071193199355 0.55256310379325512816 -0.10757017940378556242 0.23013008516551328175 -0.86693571386259926648 -0.62945109225161810507 2.4492159154886747885 1.9740513237485146636 0.67908121057357073713 0.32203883792933951646 -1.800231245843855854 0.010285518539550597347 0.99182958073420024458 0.32688813214616213587 1.1607329579588812063 0.56822251185760863645 1.087902361924435013 -1.1473858640896232863 -1.3285853682279042953 -1.1367723448558748611;-0.12898782989422299949 -1.7541824006652146917 0.081084447150440247531 0.23462089308666217446 0.41750727508388824072 -0.46943265167601350152 1.283949227765261103 -1.3357386947412404066 0.63540969397072666336 0.25270854469590336988 0.053195324412271122183 0.32227033079778039104 0.0046418776120290246648 1.1817921910968496313 0.2139161304671768904 -0.18014449725372344568 -1.8590573153992284716 -0.86696414143744315872 -1.390569096036347041 -1.2306873787760121974 1.1046084009253529512 -1.598725357582702955 -3.2947941675543477302 -2.2786577597327157818 -1.1260249019543242532 0.027384589355946210854 0.73235346487508368174 -0.29895926543181494672 1.2575309849892217784 1.1757891162221054682;2.066587328816151814 1.3661707365791717628 -0.2574096029950984077 0.29891953799840642603 -1.3840347262357775016 -0.78247970708516834115 0.20193816246942264403 1.1493799405927769275 -1.7039065851861070477 -2.4871905851675499832 0.41043155938445841091 -2.2654442879227585372 -0.45451569525864798926 -3.3190098115469246487 0.050822001937298827423 0.61603282557512395456 0.52073792241191418917 -0.80181100360425738849 -0.56300039031434068182 0.68379539789229970559 2.7533604219194547369 2.0237854909186023811 1.4159757131315462431 -1.418268600978986882 -0.75450576082980236325 0.67584923213343739423 -1.8193851043863700223 2.3834711812409761222 3.0100935355342657296 0.46209632601684763609;0.28126908430361130531 1.6353207362172208494 -0.14207490286434973359 1.7324550344169677984 -0.70463139982132327876 -1.7932872419566272537 -0.60499674762014044038 -0.4488127915359016451 -0.19357055005569789863 1.7601420422543554434 -0.88814211570811973928 -0.97757011436081198141 -0.71859458522340147191 -0.9615039689863543737 -2.5942562600063809874 -2.3683460915877798669 -0.75640550564997954819 0.48914244751351848572 0.036369065410805735683 0.27332558745767304709 0.73200939012983123888 0.71596130532699986393 -2.9093559632084442512 1.1571910839947288085 0.12230373000732747135 -0.39911987272236315594 -0.086287715629310035581 -2.0077164625582701873 -1.7629978470113472078 0.075729767743491355203;0.099317032296532228863 1.6184981475555317854 0.058892950415458507341 -0.58356610839456146689 0.18844497871494794716 3.4875202032549426079 1.8209177753290348711 0.12405784440238418198 2.3311184447275339338 2.9866642135666903179 1.046283521135720429 0.11435909263740315356 -1.5648351755297813526 -0.22748580484326250128 1.2325966958846674704 -0.0004545384754589196219 -1.9691507297724275549 -1.915682658215667411 -0.14943097929147131087 0.13567889760035450886 3.004067055220513538 0.95919888647365358914 0.47850532875437984393 1.1957856046555690455 0.17833339551370522291 -0.42481752311502163355 0.81893359185791481103 0.062435193830993565567 -3.4913730132849494225 1.2317728132916381245;-0.23768051402656026339 -1.500009394896434145 -0.35177896134072861312 0.19303807143735177143 -0.77064236348660108966 1.050999204004812837 -0.24843759797069092654 -0.92748810566918971077 0.47048299960100831152 1.4339530322440476873 -0.39689034582587662259 -0.028411914376506475222 -0.048017388466965509053 0.066036824611294064891 0.71817550244035610607 0.099703571692877634991 1.5367340806543914322 -1.1192167247229973803 -0.50322770481939926857 -0.42322563291280029807 1.7811486551785529198 -0.51141271610038041562 -0.86539020619597994965 0.29703689073370564966 0.90334192863546558527 -0.40017331278163353891 -0.87998477110731188056 0.36523422745638506326 0.073702023840881772387 -0.62188298983991852076;-0.15008829993613781451 1.2071579194316786054 0.21272033224341740931 -0.30576163035633735499 0.9315875207849770856 0.91797228812923636898 0.83210927161614145486 0.56920833029262685177 0.23056120044922595591 1.2718288733582483463 0.55817121496559274352 0.082995989008208148618 -0.1536949096762651179 -0.043179432625622536646 -0.075828587605034386554 -0.58039354531377584934 1.4454247986266575143 -0.18891881418223305245 0.12440039897796015267 -0.067180138226206831398 0.041940720839790640584 -0.46154808121004942123 -3.9198885925668074393 -0.800208114986859953 -0.11019124599053979618 0.79142118629500923799 1.1096913162398525099 0.52930855460596237805 -0.44162808740601933177 1.1175607439778383334;-0.82462348526294015905 -0.12042587345556009237 -0.15616732774321778754 0.41126868627243040599 0.1071356554019143037 -0.25203219346810340484 0.30744391852002905807 0.58140368345946868978 0.8450935445430426407 0.016212894742724009295 0.24295144197007670361 -0.34920930862766641489 -0.11951814302275409752 -0.21867894679548632864 0.32592191547135612728 0.015654693458782897864 -0.25165484825916750733 0.23520097407372106413 0.17121905733250228354 0.87103617409040801078 -0.033602564834123577198 -0.50267660403383651602 0.59413106559380601812 -0.76175971840107425948 -0.47835681907913862876 -0.68901765679900950357 0.65800269857943283203 0.18497090657473694297 -0.27851671065816746564 0.76948885471299888206;0.030115722249703987673 -0.37755605688827165167 -1.1326916350735201089 -0.66217313560654078586 -1.0238421879591881325 0.92535557278869295939 -0.88709245041396900255 -2.986132005804553291 -0.33061335486152609864 -0.59273601427019717569 0.92219643189566624653 -1.1314272492427472905 1.6131780632752883431 0.99052352411040633928 -2.1333922182926357003 0.31991309584776372876 1.0887445045894412754 2.9285319083939813645 -0.49942056089603531488 0.23767328215551170034 -1.4718328412282020157 0.67026154134999538226 0.60355976261971444607 2.2061100153547901215 1.1289208878327812169 0.8182358270766852959 -0.85243571438118181938 -3.2648066713506533887 0.84863375529399354136 1.4770802652022139156];

% Layer 3
b3 = 0.47882673884836368661;
LW3_2 = [-0.5760055363642087034 0.45986323610140072971 -0.51998660825807774266 -0.57050623087279772605 0.17471004139605336714 -0.099273861143853808775 0.61715463151826266408 0.32486797480243123637 0.61293391310984324249 0.059288879708183458983];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
