function [Y,Xf,Af] = ESPER_phosphate_9_Other_3(X,~,~)
%ESPER_PHOSPHATE_9_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_9_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6427054216816476817;1.8989063432842292478;2.7244303369866580411;-0.95738888728964766095;-1.391792148750984337;-2.9983588336694935172;-1.4969626467168057893;0.19850292877904487931;1.3916844061640090136;-1.8118208232553876247;-0.43827057443829275929;0.31115583027366422453;0.37595052232679188053;-0.35962602804254817368;0.88363228896524548261;0.052011665148599880992;-1.1824515955363343878;-0.054549069162156280099;-2.5651608667930911878;0.035155458645841144993;3.6280799295775505442;1.5330932556629197627;1.0824237152971936116;1.7399673498709731234;1.3363424367147256344];
IW1_1 = [-0.094024891298232701753 0.22291093453527197066 0.0036946793507889440916 -0.094297194368318904001 -0.60147440233807669685 0.66643975237634001108 -3.1682347546321576459 0.0096672140691257818501;0.00060168745333203494351 -0.63678125029101095844 -0.6624625761186548889 -0.39851563163879666352 -2.1808520261946227059 -1.1171327989547945592 -0.45798521799096753027 -0.79905744462924288563;-1.5124642503042038388 1.0597465819957589961 0.056634460778608099185 0.18929227039694146439 0.54136462266611140581 -0.44722924532612945425 1.0285538676385952428 -0.56220102184538545131;0.91418145503294900855 -0.1385074019610912921 -0.38674516621534793526 -0.22651635961206609271 -0.32266272757007841143 -0.084167692835629775994 -0.98594957639169544805 0.12228640088141913556;0.16079393169748193437 -0.9500438758583334975 -0.61364574025585394423 0.10045327233252693278 0.2754902646325949056 -0.22382924722599775724 -0.62367390369212638568 0.69359710061221135913;0.57771882359276971464 0.15312454098706701489 1.2644974123973184987 -0.87973469950548477403 0.32295468321375858656 -1.4826351209838446454 0.45106625689350882125 -0.45802130890466236091;-0.94954425802667541401 0.51588707281688550577 0.54631105073895136481 0.088907513921331102202 1.3120579308403754748 -0.15263058919579530759 -0.53063112678309876102 -0.76170724946053713911;-0.65038765436620660232 0.42410713736242927618 -0.018885108597949389064 0.061417034074953184841 -2.599097899385776067 -1.5203977706064011333 0.8462863115867303998 -0.13697904376800149051;-0.13336396047444668 -0.12249102103862005708 0.35880214235882473828 0.19808240324895642903 2.151653644510830965 -0.14633172332289151596 -0.40370357901877457207 -0.13973039905706968744;0.89261376663736136106 1.0702486433158850954 0.79392116186566008551 -0.1594226265429134759 -0.37861705753906710337 -0.37964465042344375245 0.19739218622140652926 -1.3840715285324842743;-0.24488558484536188109 -0.024934329545401433953 0.42918951442940994623 0.088293164358443504414 -2.4958271018235675953 0.38483288273861487871 -0.0065541430035465694098 0.31129144165360200791;-1.4334034714032448665 -0.61716246394520979379 0.18913144820935931523 0.35841836587107495093 0.14261656100123040747 -0.85169183385311220125 1.5865295326959720779 0.10757300332425698275;-0.22594493418518987737 -0.31429043084526764318 -1.7612878682544670372 -0.029706379492017841171 1.3599301381043882309 -0.32772292906003303026 0.55493250673930882844 -0.041787929013035407522;0.22643240318560595159 0.57565824362236805989 1.398450417573575022 -0.16023679906425247754 -1.0261911627968660632 0.97424992703649437864 -0.46838447426204987689 -0.44220021450909369198;0.69643790090949442284 0.25615165640580506157 1.2949178178465201583 -0.076747338008464754955 -0.089802939701577697007 1.0918289971774151059 0.79351940232782791629 -0.90965927180822425679;-0.048721611752358860714 0.12701800091609244392 -0.12067720880416187013 -0.17345851496051631346 -2.573752845848354287 -0.097502929381305031287 -0.75091526647422124352 0.26540124636007744741;-0.7538614357538515609 1.6500563588042957974 -1.0789862566584378367 -0.2186507868524985021 1.5481453333299457498 2.578708876144645501 -2.7442534892048828787 0.44182970811122490584;-0.14287332529404575543 0.26205702091851845736 0.57883634203974843047 -0.22249122331413900833 -1.0492341488929610716 0.57567016013711591604 -0.65687796149700583559 0.076157705430854927275;-0.080671975942778639812 -0.38864985616008812519 1.0727771020489087483 0.24162524725830999972 1.4847194242295869149 -0.14525324921932727951 0.92646713062508290193 -2.8068986574121517208;-0.1181249794062527031 0.39591346728407872391 0.07986545982720054393 -0.17430876763591401923 -0.52297877410178184032 0.31514141438085963021 -0.16887356020399629797 -0.14203660655728353457;7.9564058992974118212 5.0870530274929386394 -0.38838083417905244765 0.76063608805620708253 0.89698070906335292118 0.51697350983321288531 0.48867371378415358496 -1.5389264569555691775;-0.010338974473544336463 0.16278707933805544594 -1.0919148765595951822 0.32834480310281466409 -0.82648950944888399661 0.70808139289650795511 -1.1543511853622090424 0.71223709909821197872;0.61101124181532717738 -0.46204645492770396453 -0.56388361431464029128 -0.47766621678674497931 -1.8773758200752261871 0.86691332947879229387 -0.69581172391199463956 -0.78004982456792693046;0.50473160120936266804 -0.16431032709805754033 -0.8121711052276473497 1.1965427382206870188 2.2027723515007138211 1.45832971583936577 -1.290703564154812355 0.14849901597963177657;0.50363958997779456617 -0.56365537603856175064 -1.2185327347154653044 0.076511767075065809096 -1.5465762075189408709 -0.23607814384074346514 -0.1862681256208340852 0.3617852199127622459];

% Layer 2
b2 = [0.49709244297574073368;2.5281331835730567192;-2.1397479348578971603;-3.3843765874115550041;1.2690733030399403702;-1.0738919998821134794;-0.090416987204507512366;0.51831191725247116597;-0.70803349999223086364;-3.1248430023792703736;-0.8407315487805937515;0.11454740124675441559;1.3076778601576137806;2.0022789130574274452;2.2936887005830994823];
LW2_1 = [-0.83910309682832573408 -0.090064386291499945458 -0.53748593542887523888 0.2672725352168177082 1.056711011998040961 -0.33840352733582612643 -0.75727400196591154735 -0.50330621161101729566 2.8992989683367182963 0.39509788990808553111 -1.0122103406804865422 0.33894975552485329118 0.401398717092954882 -0.60838070248473463675 0.69900312083635385285 -1.6274715600594304998 0.44442854375018547852 2.7317532140767948334 -0.70252865284634258281 1.2135467536967525781 -0.18913973140718751131 -3.8733376091128914886 -0.4609250032317043777 0.0071894378316129589623 0.84898017044724949365;0.36370701015254752742 -0.12736024005617574417 -0.3173203174569253493 1.2540671110345074091 0.1026594122430606465 -0.58195420782597773179 0.16622523167954586509 0.89935406819866359207 -1.5024226798754711787 0.36195499279115983526 -0.19912608066874579182 0.074203221198110222434 0.32907188305016243923 -0.059383230127794874031 -0.48313926778726634659 0.012584132480481029573 -0.054556236219006924715 0.60735097967951290343 -0.046022513718675314709 -0.90867983381467543058 -0.011405615148484560609 -0.95607726214401844711 0.58818627999904704584 0.85335993915163321777 0.069996698931864234638;0.87087790734739412013 0.60304456039319509486 2.5919517057418057782 0.2783415422735902589 1.2702363163950629588 0.24874583916901230052 0.44190762342296935339 -0.24754360599163416357 1.1452295794669495876 -0.17159958305426847858 -0.16098718134716988315 -0.63284535892225879383 -0.48191263512493071053 -0.91270291770936295972 -0.14075456151664367255 -0.08526925743695336346 0.17169033654331469774 1.1720185888299690102 -0.72344318056190959343 0.055120291033208708431 0.03983613329129985503 -1.2631820086297425032 -0.89119712107463844308 -0.21114430417722454547 0.7890640632446137559;-0.73906368578481096421 2.5184262817824967229 -1.8593495319539328214 -1.871764580483878504 0.12108726383839912843 -0.49767957695550241182 -0.96422392292080683074 0.049583345972768734511 0.37598826020036790752 -1.2035662528183743714 -1.0545664959685752127 -0.67211630705012648246 -1.6428145172061281443 -2.0338919622138558196 -0.93431710530734890519 0.6910714849236446744 -0.057131000715101895593 0.2347885387012079994 1.2576896667925578921 -0.13877310471460779784 0.088955683390966322488 1.258341550409115106 -0.75683640999233170454 0.03126436508745253362 -0.88212676342888607373;1.3316088964986187992 -0.059757534799182061847 0.084519473637702527413 0.99466938257094206222 2.0433669183531679714 -0.16530186110206618322 -0.22160953699456437116 0.47283359487941217791 -1.0886446092276216291 0.010318638147288642856 -0.54386894712904398919 -0.17590318309702984712 0.21745097389240147789 -0.47572456911399874091 0.82325602707758605003 -0.63469104912404594732 0.026224951968657130019 1.3069518948416798398 -1.2109109113359963761 -0.06683227343731620862 -0.14377069459287733499 -2.3640764189998164646 -0.43606612248479093008 0.43725113905114015855 0.29910587920668324502;-0.5050629343222028389 -1.3013797848790142897 0.31196799073623898702 0.19034314373563349099 0.34837432346913177472 -0.53244749639189070667 0.082159001962225877702 -0.2169161377629130194 2.0164118126343693049 0.0012768975135834413279 0.57050683802417423429 0.20925452130837304821 -0.32260149642261831682 -0.13239840863192789411 0.63100721913274648855 -0.61047682105876643899 0.026977761889847767796 -0.78329417513146848417 -0.64101293214204546622 2.1659551664363663193 -0.060036770858886916169 -0.75973856020794472421 0.95987729890014472645 -0.0053314268246434483658 0.44398528367801110006;-0.5350446455439975546 0.43813431999924051796 1.6471347144409218544 -0.13014353168987877196 -1.1900643022711143715 -0.58253416346460551445 0.30364383663964905624 0.13882782800986567806 -1.2519914708850163887 -0.08703625680618076732 0.7228933893990595605 -0.042577986767100436949 -0.0148610705943331943 -0.017284573936624261781 -0.45453088903516603025 1.5782169237361507452 0.16193568788009457537 -1.50234260305078271 0.8128609769370186422 -1.7934956201900844608 0.030575591913041950259 1.0630129135512496052 0.073003642240859006884 -0.25390425347329581562 -1.3982091498441200361;0.95324502587320480984 0.2703939811285000494 -2.4758988285265681739 0.39447282069789302295 -1.6672376320219108869 0.51193598214627544785 -0.58211439106489637485 -0.40911516360781274848 1.1619487487518322943 0.28944638318616910944 -0.54574403665110282624 0.31285491338750537338 -0.15723349868746555602 0.37864834154480520034 0.325203971333500097 -1.3545217845735102458 0.40638426944715450029 2.6896919881985992262 -0.99521015702174653317 -2.372709982070823731 0.19943809750766267053 -1.0200471499145797871 -1.2844174987584124903 -1.5167085473374772864 1.2230998551603298186;0.022334702349655607967 1.7355072893744232232 -0.081316245074964793593 -0.69130265679578450921 0.14847513782887414302 0.80518025151739258671 -0.28890477117677015872 -0.67181055956447832678 0.2529626159226976978 -0.44263267076318368876 -0.81591593884682245275 -0.46801753565953396752 -0.94532174746078800887 -1.2597225265919129722 -0.40500338591035600633 -0.42762247326291547012 0.0025647107604189886207 2.2357436736016125245 0.85414804525803589286 0.31838347409151990242 0.12601124298210292229 1.0800948336671729599 -1.7461777990529605553 -0.536157996593900954 0.60150184781034754522;-1.1869227821372518861 0.94268096500966103157 1.4125453463083363914 -1.6725460437533554714 0.035970779914045750147 1.4014340801237510359 -0.79447315543116814318 -0.40918699634303451473 1.2900356252018512215 -0.90174988675200684618 -1.0176808181150931443 -0.028042547205445706587 -1.4892110063864234526 -0.54263206739785685429 -0.14109120457836146767 0.11172451967869913292 -0.0027756341902970753203 0.24114251958109469975 1.0638111452976504179 1.0370973477789542372 -0.04054281485032957405 2.3034932846624958103 -0.97851398569679448602 -1.1351622966395700232 -0.54580437847336393808;-0.51504717161616309085 0.037601744332800529635 2.1358404712257517133 0.93188007187259602748 -0.19824501609288222581 0.62000639618964270561 -1.1033793597097858452 0.0096552010015886566979 0.36672963241913503207 -0.03974868241302936811 -1.1811126512051386417 -0.13533352913335555678 -0.32307224079236429581 -0.56359509559375731147 -1.3796671172967989172 -0.99745438476284264961 -0.15524976806510182303 1.2673898039542841332 0.71118938062429992719 0.9169661207111708956 0.095301603837210355219 0.56093630709899777731 0.28482511203569793601 0.40195763442312176794 -0.064749140385072664894;-0.65985291290575731615 -1.8921451070364665448 -0.37144884457420807022 0.1527346742483566 -1.0031713468675502732 -0.27932878839338221022 -0.52550886882509162401 0.16972815741061136885 -0.12460658037232746898 -0.074242025259812646776 0.37340936089868453918 0.62218007359806493106 -0.21342799961610428583 0.12110033993116561812 0.76786384998291756787 -0.40297908599953219388 -0.168150158207212852 -2.1056748585990781031 1.3158692461528942452 2.0352733088106744752 -0.01588448417448683897 2.1421508609189294781 0.89220951678433857435 0.027522970622805204011 -0.86296916059177342095;-1.8392975707957592846 1.4828937275990501377 2.7181769784628664333 -1.3006986295526687947 0.16992649726279543398 1.670186025858134693 -0.60900132119669536657 -1.241680340182150788 -0.38275679072131435499 -0.42160427915315906722 -1.361064347663343721 0.1268507462387133411 -0.68685157668609031489 -0.52135163450524035778 1.197634215748680564 1.6230961428679704373 0.35474519611427984822 1.4627783805969680753 0.11312261856875180377 -3.4472952229713911265 -0.11801407850805756272 0.62165437376723731155 -1.3199321267681063397 0.18391457522012763515 -1.2343769460247111525;-1.1286843693935415534 0.35008272730799189221 0.29193593153269487006 -0.82529801127033020069 0.45441124822768774738 1.1018198834913406348 0.4855901109185816189 -0.80429767419023068253 0.54906497755349015222 -0.99788700723605527898 -1.498500232632473006 -0.20485946265828364199 -2.0862668359737805979 -0.81565713679914364498 -0.30596021881356322281 -1.5617376876995541224 0.29267102263386884919 1.234880753024165001 -0.2536056162484485732 1.3933983517481796088 -0.24078726811349465686 0.03699040034986984804 -1.7242536731874469336 -0.9175333958130501566 1.8120027665946329964;0.43777718620527256155 0.23348413466181963671 -0.35078118464550261946 0.50715664689460437931 0.44542628984073756593 0.39353565334957513189 1.0296614166224227205 0.054257725186241063942 -0.12147212676249127816 -0.039834171045320346249 1.0251507331277787127 -0.059251794994113163306 -0.72948834990681754586 0.67664832065233748715 -0.044047950607684766 -0.3286039783852303664 0.0330932048072021881 -1.4697832258294305507 -1.1584553648281641358 1.5298052193964737366 -0.023122289594445587235 -1.4255658799952741767 -0.54948100825800194613 -0.37285066760866836244 1.6123125863971470295];

% Layer 3
b3 = 0.12594317194670134885;
LW3_2 = [0.10715452189132039507 -1.3409088710202035077 -1.2996630996057254581 0.81204224393140389537 0.69647968505323865074 1.4445521428037602085 0.86385580000780792798 -0.34967743357955588523 1.0018394051880470386 -0.60787487530736239449 0.6405110864092773415 -0.60547685976377974004 0.41273061197285343393 -0.30643433202135811344 0.83785038657407229223];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
