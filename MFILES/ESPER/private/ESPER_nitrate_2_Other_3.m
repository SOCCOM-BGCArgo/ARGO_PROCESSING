function [Y,Xf,Af] = ESPER_nitrate_2_Other_3(X,~,~)
%ESPER_NITRATE_2_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:32.
% 
% [Y] = ESPER_nitrate_2_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.56374149482389934729;-2.8438609442773250535;-4.4772891558406548995;-3.8863239048689490751;4.2731989509977337249;-0.39126118732244491438;-0.8380725907585154788;0.89168168140035497515;0.25610369978348729303;-0.56387623709472634026;1.3532869154129880673;-0.53097722679501868637;0.026821048374746126602;0.54684958853517873223;0.39632429496075283204;0.56413261610689502401;-0.8297722986018325475;-2.2548288714956274958;-1.7603024293655626931;0.5583868502298457992;-1.1112412313969648459;1.5980134071568663501;1.9024710978262171501;-7.3027220943992956492;3.0793252858650324022];
IW1_1 = [-0.023705144000498255125 0.3959468921142704767 -0.4006431971888601562 -0.39042607672801882268 1.2650736193667273533 0.31112507947154277588 -0.84975739230886693232 -0.48345850944796647797;-0.18977266194738839911 -2.4014000280751788274 1.4278584227683543961 -2.4445548998826156506 2.3694615884344374379 0.40963276068659093543 0.27391484420073303196 2.0434035137443342656;1.1317504047389472799 3.820394853616320141 -2.4228324919581649688 1.5651584944719769688 1.7657159359890328698 -1.6558898812019235969 0.73300671443842824182 -0.81876356435345609697;2.4791008588095322374 0.97862931257307783639 1.0967551295739932371 -1.3652076300468407588 -0.16204306898136727755 0.75306282194256402018 1.1411694132350276298 0.8253006540402851865;-2.4169365995738152364 3.625997550208665654 0.40092668228856964685 3.5328032158392566053 -2.3053232286539557805 0.60998636896686131426 2.0376804249980295936 -3.3653511771305719691;0.12016868933178920242 -1.7357044444311513498 0.050798292896587472767 0.58812881288802076885 -3.3490355867100611853 2.1192854430150744882 2.4680258005530504306 -0.91714297310279380149;-0.035091750627976737997 -0.38861483941787194896 -0.76339557411049863145 0.62689125053477812166 1.6357042818150582253 1.1299290727326065653 1.8284214389745747642 -1.9821981595898969797;-1.314416836305452474 0.41012951231988609146 0.15702637861248272544 -0.87309916116883123927 -2.2395202332576409354 -0.64128721481079387079 -1.4457471857386243741 -0.60098689193770327144;-0.47778650334019240331 -0.46655862495274713631 0.014051467590230234256 -0.21970215557834710252 -1.2229230792651053505 -0.55983266699744860251 0.47030991348280543063 -0.92056300603544527483;-0.13223165097191666439 -0.087644378312808537967 0.029009995678037588107 0.13678958984276801125 -0.51715873689101765631 0.022346481299192751807 -0.21531078091313293754 -0.8084513448003451952;0.14896799897483614661 -0.61380489499940971143 -0.82019886834620447935 0.69502641860922309558 2.6462227962331366093 1.402530774749892295 -0.71771775111432511984 -0.91298212049315419225;0.010790210464845991292 0.066730310534921330468 -0.83767058174151998173 0.73809078408722295084 -1.6807023140119505822 0.64713804342204250819 1.6499017343839954552 -0.84299305270353364072;-0.00059512961021486085987 -0.1220475230984678916 -1.4472056794848120465 1.2027131150911856139 1.946085391835115086 -0.66357049489704267309 1.352255480368855789 -0.25708781327727098232;-0.61849256425727683339 -0.20055416880905091448 0.8334488623369497029 0.080649765729185932117 0.30273713878580954528 1.1667942349617683728 0.87825792780848543906 -0.19735356651778679371;0.40216310764663287802 0.29717101454134148275 -0.24510946538763056513 -0.38849487340293836768 0.52255531802587751322 -0.469108541853595018 -0.095713460244801359944 0.78679290282039338056;1.4552185356315574527 -0.53159183912671847949 -0.92670360176526089813 0.57119829024077728441 -1.2343824813201960122 0.18223140845556079492 0.62471025049638118087 -0.18051961349548967251;0.015935038515242680446 -0.21041926641089775396 -1.092599727043248814 0.93680455471519308297 0.8605303395684960055 -2.0679390689744869825 0.53693849703579399346 -0.22012842824886463822;-0.29906013903708983381 -1.3089666837693121337 2.3079274193800296544 -0.3965565838403234955 2.0028389919504414607 0.82722036801079878998 0.82886838664777295893 -0.02715669427069801467;-0.58310177927783224394 0.71865806148359123728 1.2482065467290326399 -0.84200224119750899376 2.5145959307209015954 -0.13438000467934077542 0.3290581385210202825 -0.55467281712013738471;0.22379467395499749727 -0.043998052572559571971 0.72400766922911974355 -0.7561302110779697383 -1.8175543765697763643 -0.37387326623375766177 -0.72916862503952228902 1.7581623883944399456;-0.25925718272464626235 -0.19668115924716650378 0.25182064735596404459 0.27777927984010025719 3.4948006277666139319 0.37793193892796045352 1.5112991224502292376 -0.25172195412033099293;0.026953039682625655471 0.29327595747956586303 -0.35607841633711290186 -0.18808509710285842287 -2.1525323020968483156 -0.89999710081183459387 -1.9824511145724394989 0.76296627698731678269;0.33480897344389382031 -0.034798388657407079705 -0.61292593053258326297 0.29945320631273975032 -1.0190054131294019601 0.5184549614278582963 -0.78266941228677222586 0.3098315076851769212;-0.53530487915939151122 -0.78743678176949927217 -0.22894139026786336499 -3.3463208005031854775 -2.4627917245573320848 1.0619356147771661369 -1.0419885834244317913 -2.6452603429911265565;0.12205664539078943387 0.020824879192531238481 -0.41225764584279289693 1.3760724791767842135 -0.14234458525043514054 -0.045942474686656568916 1.0787237952911672423 0.42917579263379229682];

% Layer 2
b2 = [-0.61509513471768451076;4.1232591143921935029;-2.4104799222922057567;-0.77037191924323700221;0.45985473769532891897;0.75107501531435594266;-1.1231098191047754753;1.0806206612664079891;-1.4025072942828231692;0.085831741480834083946;-0.8297525394956575262;2.022909054423454478;-0.43596261690024246116;-0.88075894858530423548;-0.97001232736878695295];
LW2_1 = [-0.37714617973533648421 -0.065232869824984524021 0.22971232338544694818 0.52288847750521139091 -0.093366515820142492732 -0.26310595087630866962 0.12368556051561789555 0.49316090983234767142 0.043901201625009197982 0.43879571837561193171 0.59496142273413676893 0.032615997399356499997 0.52923478305510684994 -0.61908248103104712712 -0.40086089546891040536 -0.45906821334846115157 -0.31959847714565714494 0.1117101351389740288 -0.12307604986868317387 0.27951747036242274858 -3.5375965701786009632 -2.9745909409475581597 -1.0741663558648950616 -0.14957401879750648055 0.77353639661061901478;0.51032623463670545583 -0.63678803176304088485 -0.19821029384722055333 -1.593108309934927469 1.4334056430683199679 -0.05711860679906561461 0.75596181219276492591 -3.1852906649181020882 2.3648778555778866561 -3.230973394341163818 -3.8447284446077585329 -2.7523482557859186848 -5.4697732550993203304 -1.200317059986938828 -4.667824521917349756 2.0634757394435667699 5.0599814952697146353 -2.648928537898922464 -1.3942417916980380799 -2.7956377356803181478 0.34075196729256646 0.76297755371297981686 -1.3302621677715502635 -1.6941856168578226516 -4.9024973945657421837;1.1756083513158073206 -0.30997322757139739169 0.1934742820660189655 0.39739076822250735122 -0.14526109605248735401 0.39727544320416469104 -1.0534908278705052975 -0.47743194474080341561 0.12651441393346743447 -0.12760106553597083678 -0.45507885725226498996 0.33807644450169166417 1.3808293550508308201 0.77261766914482654656 -0.032898278988310367121 0.33446771139002906548 -1.405875714805890464 0.35218694883647411187 -0.038744631289634783033 -0.52247312937024337209 -0.81901482555585880529 -0.40912029259191862174 1.2462116557043008136 -0.67712746750365138126 0.71942926758945169308;0.69840046378085995915 -0.35703356515654488534 0.0644038765939855401 -0.34948122684882232392 0.085002609047816493626 0.11860975886231980847 0.51731805919832130058 0.5024590990526066614 0.50258354668423943501 2.2097501951819498167 -0.10583793031133896523 0.016675098687182206281 -1.6131741861917909819 0.18757861116674540147 1.1495930295374174879 0.36511408170502829273 1.0613277320361171885 0.7234404611714556621 -0.13821574464661193216 0.21273462396791353868 2.3481598478634064797 0.54387429249513141727 1.1640547797709233091 0.52841890716947392814 0.059773919821199637814;0.014834988736911839183 0.31422436509824247519 0.023537232112138452983 0.26514993179200097018 0.11543251193416707856 0.33586353207232350071 -0.35806474458543108286 -0.44449983270170356775 -0.049818426319577856221 -1.1388727493145682779 0.0021062117193021917885 0.58650736896523270048 -1.2755559549460164792 -0.17024744947446288079 0.026412651394527805054 0.020339995193117760969 1.0948872269189191542 -0.02298378417144648217 0.60252120418741039742 0.037735337367955222587 0.74676485746177834191 1.8702005468330491489 -0.38916118722876108516 0.67251719398499676394 1.2854291017209440451;-0.61688243891540195385 -0.10532910714947069097 0.12258769649031416027 0.016362600830471581842 0.054342058843966548065 -0.15400914174736546336 0.65397252210725653754 0.013469707393470677081 0.15655390041797470624 1.6500038546201634126 0.22428566719591908063 -0.44167302767604432745 -0.058301853464600886245 -0.19137547414976374682 1.1133561630658346253 -0.10090869103075479629 0.39124442622296068395 0.31425260342596672558 0.14647874444156924745 0.18632975736567683467 0.73082809526514946885 1.125125404808869467 -0.085214989899046342248 0.67662926911807264041 -0.010440592879324101655;-0.017055696079055156916 -0.098499263117933374967 -0.10858145266002484919 0.26263945548202966007 0.026764068411409384224 -0.12459114063779896941 -0.44116940209412441876 -0.56184151329114673246 0.13988520723032163429 4.5168437497260169877 -0.054868189758815417989 -0.050026737409764994446 2.824324263138100477 -0.086471727649322954745 2.0571708577663962991 0.1584496957716193255 -2.5169201631035540423 -0.66509240681242887128 0.14620285939032157119 0.22699140678443635588 -1.6003320940857732602 -2.1134481166269907249 1.2295246201245844109 0.34685073207357974834 1.861055672100032643;1.7081474465447186173 -0.074080773444368114289 -0.95561575222497774362 -0.10430524654133015161 0.11329996397228520033 0.43834153451607449359 -0.72880399913713456161 -0.40435097823608007195 -0.54928843326864007501 1.4439110848878811133 -1.6534879452668751476 1.0764512719889207659 -1.2334438284792914597 -0.55434183343091403273 0.37055122538201307192 0.47880011780636733132 1.1612676539080624138 0.15762686143561210894 -0.37572995185834118237 -0.21720045238113724895 1.3409312483239337332 2.1935908714476552994 0.5951442944729176121 0.051168215113974839514 -0.13691231030671674462;-0.20084086633640074737 -0.81229953764395546045 0.44291142146557860304 0.02298146403139030361 -0.078683776822299836273 -0.82352991446495615868 2.6374658558741965741 0.21922177971735401503 -0.27192875396286392276 -5.1670500487779165155 1.4303312161487333753 0.17381469081971670509 0.86279241130899797518 -0.62533068426185256516 -0.95370175498171227968 -0.12187682581337963561 -0.34746071261964439625 2.5512794491053694124 0.53156327380667511839 -0.54227231433143940897 -0.37793964078570208009 3.9264060839042063122 -3.1030855742514575901 2.0363655461194642982 4.1007796947100869644;-0.36157506630143088078 0.35073150921673451608 -0.347644128087848725 -0.6620034959528362517 0.12944524589390024594 -0.33196302687548612242 1.3553224065797015996 -0.69069082929235092738 -0.3985588701891082386 2.7096309767437292138 -1.5226100717828694453 0.10139281081548964791 0.098413490637392381233 2.1706035931291896013 2.1167901407427378579 1.2886795481936879071 0.0074159803717819532815 -0.70591360093668953368 0.70656422469676560816 -0.124094282875187506 -1.17552664028774001 4.0605309914344731581 -1.9345408691565286752 0.33593569434706349597 -0.9858205231503682775;2.1702369043977367546 -1.2765324785170439892 0.65416339648403865059 0.049624994315183787452 -0.29649346834593676148 0.69903315729695036929 -1.3119957174330949545 -1.3899985637796765658 1.7088502632103081957 -1.0090676361020209928 -0.43669096348039015965 -0.18086661715773602599 1.6827021692779378093 2.7323029613708791352 1.4911230053753203872 0.45609365460108491908 -1.9991306972824485211 1.0688706455951713092 -1.5898421298070335439 -1.1879457892937930197 -0.85430612161523800108 -0.059435892602220638525 1.2819043249484700642 -1.2288558036787804451 -4.4025878835069782724;3.1662396334797082709 -0.21594914060292938474 -0.29670429479052851107 -0.46967778411901495161 0.43501555585422180261 0.30020076756649866079 -0.6791220238076812743 -0.12631822934692085725 -0.25695674368022536349 -1.9514017597331694276 -1.4284311700092959807 0.58058931596867568992 -1.0349518634846437415 -0.8069621058720485296 -0.12956080819084403455 0.15769381851314329124 1.8275036785483189661 0.55432054651230866504 -0.95381415125388202547 -0.53594062915919749024 0.61897055786984211956 1.4375345979839460053 -0.54855928988556112991 -0.27534890329002703613 -2.0773846609495181248;-1.7581783077375683355 -0.3001805358516342892 0.69922136826199543513 0.4932376795592116614 0.14646126782031262947 -0.4116359986727086695 2.6783442635039884649 0.10771890493302127556 0.50110911553200299107 3.7871522049220067707 0.21023414955529196035 -1.030157197632752375 -0.074971185394256401047 -0.068377309574103539713 2.1030252484540885582 -0.23485195703162450864 0.59086938841743041895 0.87461412660582427137 1.0257070553559604065 1.1642928640495278092 3.3104569882065804087 3.6595673219039306368 3.2532360377695592746 -0.040892802736955419229 0.41788655902482318982;3.8018575756542589694 0.022026649784497157047 1.4776328963391669458 1.0924759637214058738 -0.9064113318941187103 0.27510575809154613758 -1.7230707126966964271 2.9909907243007025635 -2.0825662882636368778 4.6767492254361364701 -0.92068183634380940106 -1.8605765331103392146 -0.51226676869453979801 0.41111639111820436066 1.1492763878952814149 -0.22520400618922684077 -0.10179716043973463524 0.030411144065492393823 -1.7604220738658644674 -2.378286235209130961 3.4949025998201750376 0.45286867205799985481 -1.5272070750942008388 0.25257001934553507949 -5.8564930330630087241;-0.2169134344945116144 -0.11251560804756303991 -0.20629815415958813185 -0.22148405731489076431 -0.1020540919936766544 0.21511017918997438203 -1.0301498930874395388 -0.61172958028106982908 0.37901456089547119754 -1.8545873712620601914 -0.4400315215795673196 -0.59241617447431760279 1.6068743829931628753 0.20478301733486531377 -0.15882931947822523377 0.27957987616983154266 -1.0020515649624701648 0.37141677768289155237 -0.21830248494621509736 -1.7055298885845819878 -1.5798417865073379751 -0.47642542236547080758 -1.1428363795927096724 -0.26586791554119554304 0.84065274186059035788];

% Layer 3
b3 = -0.17665845687235787187;
LW3_2 = [1.06575942813061042 0.77975871206075630937 -0.96693073164725307223 0.59426430463592960773 0.8416519700839847351 -1.8454811406704174637 0.32471496839300545423 -1.8073674525181904205 0.10577209680072315046 0.22239664951581136765 0.25860930897574702092 1.3600843437678185044 0.33128507728360295781 0.17002551795158130088 0.71441055426046273791];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
