function [Y,Xf,Af] = ESPER_phosphate_3_Other_2(X,~,~)
%ESPER_PHOSPHATE_3_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_3_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3004658906082482428;1.4190322971082129921;-3.2308789403093838288;-2.5701424907972558742;2.7608422477286946872;-1.4744600078215666095;0.60456386685897733901;0.84587028282135401369;0.30906610870967815563;0.33661947020336213665;-1.284467641607781152;0.74354327184764890113;-0.097255872794789172131;-0.15873799596747187324;-0.30327378518529640727;-0.97431804692550649794;1.8862796849227763119;-0.64565600782117571477;-0.46764705897876029939;2.5258511049435030671];
IW1_1 = [-1.2286073049661796475 -0.55412930932402393314 0.97230421923269449991 0.14007708353343747976 1.7162430730452655769 -0.28808210333265232839 0.21643442049681133055 -0.59870230577888772228;0.088962092335360926088 0.20593976909354003157 0.80482334445053094196 0.063614041379223787431 2.998750468370821487 0.54583356213386113875 0.071434982748076081283 0.10498257587023832049;0.75811665531371508209 -0.9423074874722209282 -0.73692262909490668932 -0.25968916123714169686 -1.4972289483502647656 -0.57668228367420948377 -0.26603877487195082274 0.009398480061255917728;1.2938065029017398189 -0.10323238634403414382 2.4157630540850019152 -1.3733325255717516722 -3.1630528867533107551 2.0028414582264453259 0.63099722411170588998 -1.147027269127987692;0.12487698665148484756 -0.1711728887905920593 2.7850247517162758371 -0.32028156082839681629 -2.8259064068845356488 -0.28495910221157949582 1.6260883600064770516 1.5832079471386526492;-0.54799760165858668604 -0.54956061293767610731 -0.8769612927453405149 0.026291863382894152534 0.052497049010188451268 -2.731373411374739657 0.19191439897325926478 0.93365893983102132836;-0.64251797218513739818 -0.1794860787205876107 0.40724713932446415798 -0.22909652668819793786 -1.3704142298104524667 0.41219024500140705181 -0.47317724494793561574 1.5711395173086992738;-0.42291015916619922876 0.17905650463964215002 0.5278664720353754003 -0.075650409668850837619 1.3616035731891191762 0.028382702975466606032 -0.42892948355227183965 0.10284311235083680447;0.0050520482040499114715 -0.63223673757547693697 -0.42716222784341384422 0.042943597152137906459 1.7169370899280937959 -0.27888511353703904216 -0.19646904413787819044 0.071826504337092880736;-0.77138692111665663198 -0.07441187481009849114 0.57705555995070068054 -0.22184246897757567418 -1.6082337114309814829 0.16583034275700073157 -0.40967179467039754881 1.5140135844047650782;-0.017103880567836043936 0.81749348278456346328 0.69862037161704659827 -0.14208845026521946253 -3.7814611837281337792 -1.2031723052082099468 -0.17652714638885275145 -1.0195566501837602935;-0.60603211815665070095 -0.30754931227684823014 -1.5038464978993664189 0.3259130261293213815 -0.084630315828045851734 1.4264785011244176527 -0.31062241347027164107 -0.73262306723810155518;0.13862556686165619646 -0.30873564280927751069 -0.42521198594894638045 0.21795813523202053896 0.57050712281583360053 -1.2350201442667043672 -0.73811583949710835029 1.4701226032687122469;-0.10320782709205250649 0.23801656584071401168 1.1196921335131928554 -0.19568651522183921898 -1.298264360432122233 -0.038897633701702349907 -1.1066833483823304007 0.3033178557325200142;-0.58109898085235311971 -0.36805545636819086974 0.26503996926295214642 0.04020961158202977781 -1.61659672913871022 -0.29331580525429135076 0.41372580974589590053 -0.40288923786310354425;0.23178191364206482405 0.19545096127444600009 -0.17586534167284520458 0.0011110627741768963183 0.70509079519254103108 -1.0663985923287249147 -0.031106612381467998313 -0.10482141527966186423;0.91545620742009536919 0.51911372613623629757 -0.6178094361329108386 -0.0035585621729577478732 -0.23811321313027544733 0.96740264509913820312 -0.41528141534217161146 0.54570287092767255643;0.013658860508627680003 -0.057101255787311594458 0.29578682463610145303 0.2844445337539896479 1.5654474870175478785 -2.4088485216673571898 0.060197180480875210618 -0.35563878550019800695;-0.22930644574325501073 0.17147935259729832347 -0.46085003637755711514 -0.23221363709368297856 0.18753489609527357329 0.83428546078902776628 -0.59887633384360106081 -0.65477496799731627064;0.49230784497457147353 0.07988763089772465964 1.3440246276738490039 0.20684425447976953483 1.3263652994197541179 1.5121933533804723382 0.63875682025582980472 -1.0030774175026897499];

% Layer 2
b2 = [-2.6302130398144325518;-4.598920123130086246;-1.0896898343589120906;1.1408262386307717051;7.7796918777367931597;-1.8083782477996450666;0.12080276199151028516;1.5767207168936154815;4.7621539589010746241;3.3395056248416810085;-0.80210729667947477939;-2.9846325805671725107;1.6686235447216957173;-4.7790141442322422449;-1.1671329495550184507;-4.0028307882563476383;-1.0245210447991099922;0.85891095126697891704;2.4506596196288104039;2.6239640709462306312];
LW2_1 = [-0.00041135579388093665085 -0.023995331916052315552 -1.5087546022787181599 -0.14222588506692757093 0.11656847515470174226 0.026056779110580820941 1.2802017679419226415 0.39567511750215450528 0.25879559702014942602 -1.5229354549982363487 0.13590115600149374475 0.11506895927703250648 -0.13846620296818840101 -0.47120842053894668178 -0.31862956340448389536 -0.58630660847350890563 0.0020735386121488817018 -0.52476209625404146575 -0.5321390655198267039 -0.03488164793110539591;1.162460356056324029 -3.6603712826850860473 -2.4702818526551202361 -1.1865262751539227271 0.91529991711562985746 -0.64262449587114844896 3.4633439756886166272 1.0094706974171838709 -0.8408073814715466554 -2.6321740270979732124 -0.49336401331103180157 -0.31856857630738538711 1.1335999169658157459 -0.73015395688178108546 0.29022534623243662066 5.0232971285612890711 -1.561989891254125018 0.068856668657953562507 0.77988529394800309991 2.5083067292076850485;0.35182909949740082123 -0.17195429917530821728 0.059300071740096216288 -0.12327924308013436805 0.61702135192641915928 -0.355360422357481609 2.160208060228534066 -0.40457636052658985104 0.47672809641243962808 -2.715657974227129845 -0.36668665381000492554 -0.62716474528156929136 -0.45311933841389429034 1.3455659381959659271 -0.262041506882397357 0.1779730483069340008 -0.71094420247689238401 -0.714003921488589266 -0.2241994022806324538 -0.49065993618159225997;0.91250016464207983624 -1.7008277041702914989 0.5192995942496312356 -0.58233572512174058833 0.40495330568533655091 -0.41979998584199401668 1.7091530335330007428 -1.214133451477312553 -1.1658303378075878243 -1.0581858003933108936 0.53312618015948320949 -0.28770760183208765604 0.3489604534351042342 -0.34857674733621296648 -1.2661731135531091308 0.48438758512081969698 -1.6998954257807847856 -0.52899604337512884378 0.19872526265682230462 0.36659806896256297293;-0.41901468584777434856 2.2236569149438447646 6.9999017266225127543 1.5166259418571905737 0.060154016458902725972 -0.0010977293707455102259 1.9001464810454442578 1.3440885834727387405 1.0088683395399264953 -0.49787398721601333618 0.38178293139330721218 1.2185774017213797382 -0.30488987473380962934 -1.291390141038470496 -0.52739557627846511689 3.0824949032454886932 -0.60182767043287399567 0.61900093285858537318 -0.51398761060929321065 0.54431340310968467922;0.52313074126653935636 1.0252340884736312887 -1.7806034073750642843 -0.14717683653602334215 -0.17262062535136649122 0.32116358677125217413 1.1625639608880069531 -1.9871399999030436856 -0.70138752874214782551 -1.6768663374776442421 0.65929911486728332015 0.31798717046787849938 0.30648516610496151502 -1.1518684555315703566 0.02673690419351136896 0.49625890903669833687 -0.88649535921571565034 -0.17679313283253828004 0.59071584559337320108 -0.67562818278297931407;-1.1135681456961377123 1.174359209554756811 2.918771627490897913 0.24000761148117705224 -0.087990501220161165818 -0.64651634195148444118 4.1902429750093359573 2.1403892860515481011 0.60092964559550876569 -3.4496935588562358532 -0.35353590683888752588 0.080792676288759926462 -0.7242845700861895164 -0.095805087212617462411 1.4311559648166962688 1.0268439580943864442 -0.1083448125016473057 0.39112019290874244781 0.11792998365763944502 0.12680306903585969458;0.11938421862841963605 0.15797822666080513221 1.3104306341600888697 0.302864391333562466 -0.42457175751087411486 -0.12978065402529728734 0.3662424450607351667 -0.74687276228109245046 -0.57427233050664383551 -1.1900633196900674005 -0.6146066422984646227 -0.45923067531633199323 -0.92629597868624746759 0.65182492259010682556 -0.029359660599997561281 -0.029247418962423624156 0.46684471747928024676 0.35662102880032869878 0.5908060050529062579 -1.6580018294245666421;-0.41237402485009272413 0.91447615304267426684 3.0022853889043812359 0.21653029685688471306 -0.6571929474580479047 -0.070860683184705772208 1.9050315315852615061 -0.28380868656589958166 -0.70273552367087510628 -1.0625551592553268421 -0.27852769009335937023 0.87856011094047870014 -0.21294375832022832684 -0.081863244671369544969 -0.90701575236059073237 1.5888314471604167988 -1.026614365770605497 -0.0019803640570777965649 -0.24119973991384852097 -0.76155424185754372335;1.140348928940320139 0.63038152581474560243 0.49313597045850643408 2.308400736396345021 -0.33258851165837532982 -0.66262867743239273199 -3.2607333939264178113 -4.4424355786934901502 -0.75500202896125268026 4.7013022996395408271 0.31767720017442602209 -1.2100226604905475192 0.78369450805240115088 -2.6446015562519642472 -1.0616214152761429546 -0.1049287332883993562 -0.25963107787764855283 2.3864580002385671342 4.6935219352531678538 1.5758842442416409746;0.15436748748636636153 -1.3039247984944661862 -1.0946877526874330133 -0.16861845788193222107 0.27866731836504426978 -0.27851788512047115365 0.46000059788731501031 0.62242801043804141248 0.46420583021497807685 0.10114155596496930689 0.077267293374033707565 -0.017161768606551729838 0.71247343697891130088 0.4841477188671906573 -0.15879015755746178629 -0.015157590541127870243 0.044323412425186656249 -0.10697870076172849574 -0.33711505288149673509 1.2080253765401556265;0.75945342391455861186 -0.7329809027168698865 -3.5170108810610267724 -0.46451365654064191713 0.16212551954561493783 -0.14606009260473745703 -0.19211279801267319711 -1.4742360879184588374 -0.67655066609487479745 0.2423969253613161845 -0.03406499905944004869 -0.42598075385186962016 0.28288907026018572655 -0.58357620373481611242 -0.39984975277066336918 -0.3153770987681683291 -0.61544582800002134437 -0.46582322531457232007 0.30677212943435244741 0.21118342263026260164;-0.5642936958461919339 -0.82329384708005404203 1.6660856767469813811 0.34350037504262154187 0.060836064069833974133 -0.26942259605717000515 -2.1994675213056220642 1.8582669265111320112 0.52239748565478982822 2.3833384701343205414 -0.76299538986377635208 -0.39668941738328905577 -0.39038099164119621776 0.79644341128851536826 -0.078595185281926799314 -1.1448033294018915562 1.0567437509325132705 0.48194629248922715714 -0.41469316263342514972 0.30974157560990894789;0.51529881062413385173 -0.68493591088075866935 -3.1399599104728399546 -0.28480691652121808977 0.69742108349856213323 0.066168667831501645771 -1.781512631013798309 -0.084078069616844455791 0.72810505613344511655 1.0135708081994077023 0.35116284200483066646 -0.86943712537187622935 0.28036493718054317226 -0.0027226930472448842083 0.90134560510654992971 -1.4241004102596419578 0.88713925864480958072 -0.05346652962898575806 0.45524392039392469478 0.68902766459533326682;-0.85064595627831574021 0.24254600527151284894 -0.94055941914164908901 -0.41008755583880734941 0.5067546271404758107 -0.71652018952218343717 1.1647209176280244325 2.9046500141483604374 -0.027667670070394310283 -1.0997355085085973592 0.50689288724104097916 0.040897000931215454766 -0.91369287729119841313 -2.2369401158777986183 0.38754730398994130525 1.8240265698150566198 0.46360788408356262691 -0.72466012346409403033 -2.3977326165704937466 -0.12512858877578303396;0.17781667263784103894 -0.91304109974595248911 1.1016660029896301332 -0.16515229354646612792 0.65548191356296436894 -0.45584649578725422447 1.9752641986830015153 0.096295882259304008133 0.5828947556121818474 -3.2299167920738858228 -0.5280524764273515359 -0.73195447300097971066 -0.60935144514109862435 1.8456021619298590419 0.28335405543872888012 -1.0774733150681878868 -1.0979361213109168904 -0.58646638279547658179 -0.15851035772103491683 2.4154449724366982011;-1.1779419418254220009 1.1485504823910728245 1.8356166674804970107 0.22538974521523991168 -0.12679645255513277702 -0.62179800399257079135 4.1796285525838019481 2.2325273385355259848 0.48930540008305017929 -3.6620992990374885423 -0.40147748825767487491 -0.032821780086910619378 -0.77369860807611634534 0.042860273424944674014 1.7434208010520619858 0.88524568247537249732 -0.047405200868718889995 0.40504470874390069435 0.11857587907918612502 0.037533545859443913362;-0.84538097787643140535 -1.3030382468592871525 4.2305211041520562887 0.31852413873877877259 -1.0454257623520151199 -0.091827370749302805741 1.8762099617712924005 3.368991935600989418 0.013861919505050470519 -1.6780201416163813555 1.0521230920883573035 0.62019909990844979131 1.5782892854521641812 -3.0900173925454783586 1.1988105799764419146 -3.8329361123553562507 1.8989319835111628798 2.9205206335263511619 1.0671728555466728494 2.3998825424206851054;0.23363537101389300621 -1.1468407332466536985 0.975025091645917108 -0.046032217973591360582 -0.92808972288906188552 0.2030198248310153275 1.3469657289976222359 -0.66160231786348266958 -0.77346347704805240575 -2.1346261079251904746 -0.74177689990971995559 -0.716029619707788334 -1.2827648088378269531 2.0371423358417772853 0.26833430062112501036 0.043829969633171358967 -0.32444116676014461698 -0.5394138601777193065 -0.82284144984225959796 -1.231708323432975094;0.29069849041907869225 -0.70584642212485448898 0.66803242821539299268 -0.24298618661381352068 0.13900759384288466358 0.044492076238620482942 -4.5057936694636282482 1.28586002755273765 -1.0443978936642632771 4.3795813625382615797 -1.0414765939656234206 -0.76953025845199085619 -0.40873518935874358915 1.5515425282758610326 -0.16298474301329046732 2.2926797594843257855 -0.69610425250059448921 0.042009056463722958819 1.1739479780419581623 0.5563255955335880687];

% Layer 3
b3 = 0.082281216403847348695;
LW3_2 = [-1.6183714235562185468 -0.32289046658252218425 3.3551682407319365353 -0.61602875505780463339 0.41067913851456411267 -3.4444447888195282026 3.8335489605619508247 -1.6606383004165958805 -5.8106028946554344472 -0.10192756888998913412 -2.1986803448765508406 1.447421397956618172 -3.5878458368872814255 -5.9339383059782964125 0.44911900424157286116 -1.9870118461181340841 -3.7897342271550247261 0.67240016162204752082 0.81028650517930256303 -0.24295420432502309871];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
