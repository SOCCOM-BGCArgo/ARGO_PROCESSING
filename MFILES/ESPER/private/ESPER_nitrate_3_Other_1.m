function [Y,Xf,Af] = ESPER_nitrate_3_Other_1(X,~,~)
%ESPER_NITRATE_3_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:33.
% 
% [Y] = ESPER_nitrate_3_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.069080154598302953572;-0.32161093097857901268;0.018498242375844131669;-0.99446496670714445987;-0.28913596546639563911;-1.7740410902499732515;-1.9007332084537431616;-1.4437304851715253573;-0.56705984244915308423;2.2201189471194031633;2.0306397422839932432;-0.14912140625088551871;1.112431718845750872;-0.37374701143617999888;-0.96926685302242732156;1.5375213962887421815;-1.8935660742226900766;1.1208555326152436216;1.6176150201186478839;-0.87887710749443259672;-0.38560219239349335929;2.9057099577715743699;-0.63256664350179048206;-0.74042015914166159352;-0.67504625137705132065;2.3430181644020855458;-0.8896355957273719417;-2.8622861649492961078;2.2552114087263173126;-3.2184866096137958458;2.4230234609369825094;-0.94561879501185419628;-0.8450869607987429033;-1.943011199761729868;-2.4031386955443552189;0.70625552107628386533;-1.7020555452363261839;1.1121048911186888208;-1.9854396128056028825;-1.4844384469684843708];
IW1_1 = [0.11309004615899424795 0.0098455027055497201099 -1.6087192843603377312 0.43916879096753469458 0.14167148680420765805 1.0047694253458854252 0.3046610865287484593 -0.59511951352750036559;-0.35994728326355346359 -0.17991798343598361387 0.95905656628673441322 -0.29928852909213604638 0.22276842234805471765 -1.4225109620369762453 -0.17104190954516465539 0.42159211016669534411;-0.23606385514027153349 0.1972739703035117087 0.47637525739748293185 0.15985615542546494083 -0.64319682943323097657 -2.0051026723183715816 -1.7511401026381836488 -1.2205199345796526877;0.098552300641133849801 0.24363519939300462558 -0.20829522118383175799 0.02558452458919301814 -0.27042483061503513886 -0.64199487376944019967 -0.12639074251942189475 -0.30220248830371360116;-0.34324069660453165875 0.29143726837942263153 1.2583341430994534615 -0.22003146535307624432 -0.68337387833878437959 -1.5972446718472415039 -0.67215152601540750776 -0.14089196422709690526;0.052880687418088455354 -0.51502059291641610894 -1.6212753848754712926 0.43244265584182361994 1.5995668491318684179 1.40582134795745195 1.43094113268347356 -1.9885744368395745774;0.30965815912077110372 0.12604830581930462352 0.53585085248469199737 -0.20975894803985689618 1.5158442668178244706 -1.4065631959454747424 1.1399121886444827378 0.096523925778413427468;0.022926793996494561345 0.31927683841883802707 -0.29405894357114892301 -0.14838335102162217294 -0.74341035526072574147 -0.89121690523163188402 -0.40043829964420074585 -0.060912262221855653643;-0.8981104527506920121 -0.31924286539427176868 -0.32495337176603672491 -1.1458003629785171729 -2.5338964217735870932 2.0782195296682064445 0.10525698692946020008 -0.55724815687953355159;0.05755628090023773985 0.46669932884560882957 2.1191560170894527815 -0.23268967505973622845 -1.6555855580746290379 -1.3972285846397267672 -1.5018380631555168225 2.0045440447837274967;-0.24900808755711920095 -0.068077170320707064421 -0.66207638946861591123 0.65554658463697967896 1.2590911514317602027 1.1365801388433518504 -1.2898291850337604281 0.340785893579567567;-0.11840679716931507004 -0.0079339155037925282454 0.45896909268584618058 -0.17451716846782092118 0.14545088253276317047 -1.1378987919262475437 -0.25850843556900676701 0.40952769334719035799;-0.13943219311698681895 0.013620026722063079822 -0.13727034340244415045 -0.21601671861063823088 0.45408141589790262937 1.7490503364042486734 -0.26723122022432554967 0.90465858697311751779;0.18540985461365658282 -0.2870101113385791769 -0.22988855815986439235 0.47347268202455983221 0.60670004610582517479 -0.35746960222767876214 -0.35575917595379319414 -1.0177347950020125822;0.04634852378952502433 0.11771470202522107962 0.43164205099673974564 -0.20072398577767674999 0.7446679628043400001 -0.79534526711867281623 -0.14219100469064735459 0.75320680536853690246;-2.4924771971447490237 -0.25990108982575743646 -3.5694649952636021695 -0.86318806701625461208 -9.3455150889883196186 0.97905063759714250349 1.3544336926888882466 4.9030547478701231867;-0.07671353890670763731 -0.13779644221739836829 1.090805025665116279 0.23072232530646030746 2.3248083005566524406 -0.56708336718271168397 1.5925127603388582465 -1.0830138479050361866;-0.18982576095726486076 -0.075502896613444253626 -0.37653496316543511035 0.074075676014105612532 -1.4143864824601168895 0.73763856884290424087 -0.71228551985071297814 -0.34085810038252128962;0.12061635673168959182 0.73597118157032193064 1.0913342422742102755 0.58533570711618232441 8.2633360049089787935 1.1289277617037967172 0.61387862631562417626 -1.4421282732452982422;0.11787379931822915269 0.016444013148901866911 0.65334431639690249138 0.029966777965063404188 -1.0324383100272478408 -0.68726298637373206546 1.7732082964444371154 -0.17173537550297940379;0.14065625263920369936 0.071954657295653062787 -4.930085773535610727 1.1729529544711854161 12.686739624613290189 -1.0169737247918115841 1.7158767966776213854 -0.62812532176710422771;0.7135518508785657632 0.38023168544178748141 -1.9353562054912658574 -1.2470480437269568785 -1.1152578111730984123 0.85278923285346230898 -2.3738736176552364121 5.0405045708647984171;0.10205412674741419499 -0.18437629953706907715 -0.45757617159869728996 0.56161539539446492242 0.69440277894045476792 -0.45088088394162512129 0.078961332997899175146 -1.3711794060713045074;-0.073008173122422928558 0.05798726381568316407 0.0073795351063458023907 0.058232800838126555498 -0.64387048656300815974 -0.11226069310266405255 0.16814420232829763169 -0.66502876827609536114;0.21725484911142853295 -0.036812633839708917838 0.17497241784005587717 0.33440873034858986657 -0.93210174977722626277 -1.842053334891190719 0.65310585709071922178 -0.61298551708364035218;0.1038442468866686702 0.64439513930556602261 -1.0314822100506775282 -0.16974948644134560394 -5.616462288687730009 1.9774433036683685128 -1.9051036981044249252 1.6406109475518808605;0.042584181375586588336 -0.070063247019763588708 0.15694076220088568063 0.16141679676494655182 -0.06986792757028210954 -1.3380283406310065075 -0.21559908800736124479 -0.59437897756923718795;-0.63501800917544648506 -0.41103727578117665864 1.9791742917153747339 0.93275596880692024371 0.54851300723062290654 -1.3078758216494941191 1.6901273134774459361 -4.637947695276172233;1.0365861061817205346 -0.81773819812427084308 -0.89078764392718368104 1.1367131425842675885 2.2406641213441287341 0.34296498426758381672 1.5122684262083838647 -0.097371721216516216035;0.06220514766653904154 0.017422150265169154826 -0.56424667091997560142 -1.4846579990815844674 0.359924720632860351 0.60652032209505490901 -2.5047877994929845791 -1.163362870345704625;1.0699458043023932774 0.090708719183605304726 0.12923703982933146261 0.99083116843007912333 -0.64569118500766742308 0.52373332419790219472 0.38349242720160064968 1.7536984612313828436;-0.061668393274495802991 -0.11289649673591517498 0.53933592300001576003 -0.014581051778263347252 -0.78651288839887711912 0.12291053227412185311 0.57282637281355019976 -0.23368979678446746839;0.027843234410893306918 0.087355991185129655552 -0.63675250364365509892 0.33182242628463998191 0.59087907279434059848 -0.41057872255516608684 0.062454091469266954928 -0.72456428838153674743;0.24985881712661828224 0.26258809951033451613 -1.1874950922508082929 -0.30537730937578166923 -0.96159138241624442234 -1.259856551529504376 0.40106181443456395685 1.2981477343741489872;-0.10131542978362786944 -0.4056126894876425637 -2.4659788467482721686 0.28722199833065603647 1.468246910086161483 1.4332929213946841163 1.5027968802496458611 -2.0277527879143493195;0.87930869133711242469 0.28408548836545732819 0.31924712558081957958 1.1210015505778452294 1.9660821210761241229 -1.7939473448329237293 0.0071245239116297844756 0.6335753944357779277;0.5805332177955194739 -0.11748748099210748475 2.1501768057325487682 -1.4406684336600483753 2.3778829950012050354 -0.27299735414464532113 2.1057192999229932262 -1.8516278347816756966;0.34057804188963269887 -0.25682183693176940942 -0.040662188663207123052 0.0080362045956101114952 -0.2834687701137214022 0.77157992260773711202 0.087493705254141226901 0.70139676960760888313;-0.55224902172269951794 -1.1225114670612716949 -0.88763360698616167177 1.682993832480696561 -2.5811867819201466112 -0.32094837292848282795 -2.1698882928283391713 -1.5523877494069335814;0.16785359856633846887 0.12706419446353281466 -0.84951470216236979471 -0.31568049710215667636 -0.92128099685037956323 -0.94057419809077225104 0.12822778997433917358 1.1029921525745836064];

% Layer 2
b2 = -2.4692799497361375138;
LW2_1 = [-1.9856031330738712626 -2.0049784155741119385 -0.83091700975334914503 -12.535381252862253021 -1.2041889623300896517 -3.7922245204275819574 3.9547458741943217753 5.4166698626992753063 1.8365137109495948131 -7.4973300122508819143 0.95454811385308280247 7.3800881335635386549 -8.3809316752483411506 3.6060213710081341354 6.931447955709034936 -0.032270790058661749655 2.1408065620877847479 10.286623738181040366 -0.1680199520624897358 1.5560053910125455356 -0.056232731076036386597 -0.36925377837943901271 -4.5894944417217118371 9.8722194132622878016 -3.300960221094397351 0.38171544303500404283 -9.7871565077707955993 -0.46956282202798266256 0.23641379450784333338 -0.49842676336659658132 -0.36560702311674803111 -5.898952579646032035 9.8190514711002716552 2.0798298516650528533 -5.0069430795341256513 2.3110819754991860364 0.10574457044607923906 3.9944973855748684421 -0.17265804974136919614 -4.2482343065434413631];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
