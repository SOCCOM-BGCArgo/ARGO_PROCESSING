function [Y,Xf,Af] = ESPER_TA_10_Atl_2(X,~,~)
%ESPER_TA_10_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_10_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4370048413803686582;0.38608954447030208179;3.8806577652931197875;1.3782453045069826825;-6.1658162356423780182;-5.6388688066499037532;-6.7192881013548664271;1.0667330751905332864;0.73012092475676504399;-1.8813423174609269495;2.1632714509671449044;-2.0641290269037502192;-0.1766470536308151762;-0.046809587211069744739;0.20837286934790913429;-1.1513836227841489634;-0.1829518832091711622;-3.2155882239583877258;-7.1688939810410419184;2.9365203146184515326];
IW1_1 = [-0.39437164677460123663 0.7174302269635954854 -0.33544638025689171856 0.33015766966001924843 -0.49627988938131184504 0.72843838742068212078 0.33148824079798683284;0.091996634877859681523 -0.1402607193747890113 -0.024823482839151585905 -0.037954922050523511035 -0.63323857062813471153 0.015103476990664660776 0.026493366486344586963;-1.5784209020663060308 -1.1130150843733772614 0.071862320675475765963 0.096592874785707355523 -1.923220424006972129 0.10198438047281600805 0.093571383423391274459;-0.1686467177308399179 -0.46013121222106112551 0.070890674021609714761 -0.020821451107830526994 -2.2851634258407980127 0.012220210101866992719 0.028046968035998771918;2.8617210470855032334 1.4559476227630081535 2.3700945726050370865 -0.40795041807818072099 2.3589935237344366037 -0.25186007462303300342 0.40257039663817384412;4.2015546715095473118 -1.3229558506025398401 0.0018925285307645324604 0.031324769048487396961 0.2589684108781624694 -0.17239299893587980983 -0.18450330297225869813;5.5200474833210098069 -0.73728684492372553727 -0.11588632268416466931 0.034545243440018677528 -0.29871438199373262501 0.09170243846696506107 -0.02726133188494187648;-0.86133672537964822702 1.0206188928724941878 -0.37771074279565047815 0.48134549357139067016 0.39454182475737714642 1.0758061346100806777 0.20642570196038803609;-0.51295166025708005542 0.78507676367241119308 -0.45381822825259687804 0.33952290845845611855 0.92776996233171638018 1.0194479715162658717 0.56591277174180754095;-2.0547803409460372315 -1.1894064015857526151 0.8611433138984753155 -0.073742159886285449377 -1.3346081929641258057 0.388653801820593503 -1.078641479154320848;-0.32859029754491303477 -0.1530850242381338322 -0.032889369914831975694 0.056500207443076634617 -2.6624234428733708491 -0.039380999181726522584 -0.022830158482780905232;-0.81548294905181917258 -0.75937326337988964031 1.4536845359880876671 -0.12924630349033308652 -1.1631595075253251537 0.38073547589774270339 -1.2839418424897175441;0.949857198557744975 0.79075326579342308797 0.54623903608026069811 0.1194857905147041488 1.299328022668865934 0.68640634053231819323 -0.48095394911285255235;-0.094469724429289095302 -0.17133679168958806938 -0.19072777538165844313 0.016077013750050692803 -0.75276016551704694191 -0.087684127798519667651 -0.011333084760034462662;0.76043420105206205317 1.6821636813854279335 -1.2544637855510925029 -0.31366283891855012422 -3.6543194944858621298 -0.95952059850496207449 0.38366381797150600486;-0.41649883171289980854 -0.33293454896164031975 -0.36298738877942077208 -0.036692729587934978797 -0.12882107405371504005 -0.22636454552065088386 0.18934724659989859985;-1.027657405091014331 -0.8145758240957658991 0.8867181650362534473 0.16623864093933443664 3.7981019078427986635 0.88307493012041271552 -0.13899542681287785362;-0.31580947924557956075 0.15078422241698205553 -0.39967193182410576391 0.10167790897098109848 3.6200919512018638891 0.0055527292323437624569 -0.072902915078513860769;-2.3322407085317578002 2.8459217245583872113 -0.35211427140119960777 0.35391996828880040171 9.4859140769695091677 -0.96105918282688040932 1.0291263829972208121;0.65014845383254282751 1.8362088925762605207 -1.4507162899612928708 0.57586607918863086386 0.57989338084156272224 0.26808653831306483717 0.60866965484559099053];

% Layer 2
b2 = [-19.533102565541035744;-11.180026120081485885;26.737074042988666633;-2.5430019849703775492;39.021783335443835483;-6.0021057735405376476;0.69560339083765032608;-6.3895526761504584101;-4.5623649791311526869;-20.496833447881893875;15.758424086052297497;-21.809953687730498473;77.115306080298125835;-165.48986439433326723;4.3707582529821848993;4.3562290523079516547;21.487599379613978812;-0.45915416002365538883;-24.984938109138088436;9.1278245932915922367];
LW2_1 = [-4.5668399394190988261 1.0582739846154696206 -8.282543966094101151 -0.64238867720043824061 -3.4817726231479873 -2.0817626716059294267 3.6787982149623861261 -1.686509838187470578 3.1809844525521349112 -1.3614499726340614227 3.3580914977503115715 2.2249502580083015957 -4.8109498454827805958 -1.6377836608040894362 0.2299325416794474608 -28.613146486073652852 5.8911404249169372349 4.3839076841647406368 1.4087500339882321754 2.0329580259760628991;-13.790101123940914363 -22.907651009626324168 -4.8176645599880991711 11.937852592007015318 23.249338275816320731 -5.5647387420783118728 11.526170673045257331 12.070871974162937335 -0.963012997870414722 3.8178871042984012796 16.59523353177690197 11.893435607275179677 8.2574006903391143908 18.113680597348594148 -19.762709024717178607 -36.346609099204599147 -21.395936701737603869 -1.7102264164936991087 -32.217109055952441565 8.9952350038072292904;3.042009792571222615 -4.0509290587536206374 -6.2859610751234109571 1.4094894532354784733 0.061706861284280434266 -0.77603178190397603675 15.069279940895700776 -6.4427517291203502126 4.1776414365461551625 0.74669007321830016544 2.3343406182979626884 1.5477925792414528594 1.4297550756004817618 19.946999011699354298 -10.584700308441592043 -7.9188545697181895733 -8.0257135883361847561 1.1183697518970991958 4.0003054091563550188 -0.96510382282317497271;1.2078985550846303987 6.5373638608976394337 7.7804415818587298048 -6.8919566234875864197 10.696305834550811298 -2.0106060267980851997 -4.174967742656404468 1.0825041489756008772 -1.4710930321270896393 -4.7204712288299264245 3.0736730841604695819 5.784915599032562028 0.52400736898457478397 4.8492015633249874185 3.0066792298991291688 3.4994108470935323396 -1.4028813590798108191 -3.9878949861281389744 -5.3174398260591440035 0.99006537870299016202;-3.0789156406233075813 -8.191319567495616738 0.010575339733361150893 7.8369639834526942934 -1.1194020601695129358 4.4241183540636397353 4.2242945395543474163 -1.2740179195831493608 0.90143482720218393034 2.8556834276998719346 -5.9226286546152211443 -9.8503738552067865442 -2.9273983728316994579 10.772188018746454929 0.70745341841578979203 29.435904729875254304 7.691800046326868312 -0.85438430254824704324 4.6303180739421838652 -0.95167805658315884898;-1.031211278475591131 -18.858888940263518919 6.4633998476750713635 0.41981663303660449182 1.9188530923298734443 4.8056010967812490264 -6.1569237926711410935 -4.2958873828863195499 5.8057536699298486482 2.4106457902292439677 2.3572118372060271163 -1.9323639544857633688 -1.1346882356022827132 -4.2278215860849890362 2.3232831119120023189 -3.3046105685744242564 3.484508934063869301 2.7692653188248574914 0.37592620209735538861 -2.0505856068913983492;4.3887872135461609702 0.59037049590788803766 10.38706180573944593 -0.71983551383696442461 2.4250204804225723443 -0.97063545558370534216 0.99239253408310790228 -1.1895713264667331366 0.92517311996666706797 0.59499448368112584085 -5.3236161107824324645 0.48847057119778847234 -2.0516091358079093787 1.5039600631465446234 0.42851348549250362074 3.3440149650625050626 -3.2348878266508949153 -5.6379574426621870131 -1.7061689798127530615 -1.5796997887312667075;-29.95454173266545439 15.934758660045803325 -32.054938330722173134 8.9379436670784517815 -7.6101852540477397113 -6.2732429651656627101 -37.895318237112022075 -21.882955834693881059 12.883645779283609656 19.95280733685099861 -4.1141541668836998369 21.929612329946561289 12.710839298069140924 -39.913708081431103381 -0.36011035066756580392 3.9105389833370947095 34.047490614056791003 -1.924652020993635082 78.084756823052572372 51.358613875536029525;-2.2824115690067219298 0.20250158971621121107 -4.7678556936678031519 -0.27243145032175464237 1.9600381197400427169 -1.0338961828158814704 -5.6323409982041896527 3.0779985421037450166 -0.025073871415739440449 -3.6935367131055309997 -1.2127908777166389598 5.873746983233210095 -2.312773218235045114 -0.95142155663330052473 -4.1567069919518413457 -3.0467666695641639762 -2.857969183724287987 0.12759583413590289136 -1.9661433820458420474 3.1959568866804954901;7.7491759339307435539 5.4722432977503929763 0.45277822652503230128 0.70131206319417482842 -0.34386053132103483465 -10.040973332905247517 -2.5687242629076130207 -1.1829945762758744543 -3.3824812316543755308 2.2306125141142412183 -6.9946195721051509508 -1.1244550537577515659 -2.4181495542529178877 4.5278785983494849177 6.1967490064860166754 -17.513965538940595934 3.0171262462419399242 0.89891340424750554305 -0.88100758828177749837 0.95593438082848813941;-3.3601241139674953295 -0.60098072431729632203 -5.7300124635458518085 5.8556010618129832324 7.4807373501458256371 12.91257093080337448 -21.355496074114537208 1.3614488088738649907 2.003299594951262641 4.6255380008901205713 -12.474880782651354139 -2.3126959731908178775 7.5039100684860793322 1.6314049944519954938 -4.5630149930755417031 11.881948186054273719 3.4194268258988818054 2.6031976381508763474 6.0377352605071843428 -1.1546168300977848187;-0.10290518033298133582 17.162773574476432259 33.934724832094204316 -4.4257233577841628147 -3.5705223929905653968 4.3152905518295812115 -20.778320322723466518 -7.5055220015412915657 0.77212175790981041335 13.54733572939474584 -9.0104300769904774882 -8.3828926852314129547 -2.5071893478739877281 -18.545599818599370678 -22.559866927064440745 51.627121702365130318 -19.444852446383887212 -8.3372891218245399614 7.3178746126457019372 6.231844049279509079;-7.039369437661213702 -29.17471377233400176 23.164625738894176976 -7.6546498977500938565 -7.8714745230642897411 -3.7438936523055672545 38.129894735309733278 14.912108463733716235 -10.639129384865547934 11.829472075397342579 -27.061275578451098767 -6.0183182634921790211 -7.3396605649897024293 10.79842167749369608 -2.1005934266071504268 20.100712739256096029 -50.659716055168473758 3.8251750657824663548 -18.021666345473754234 -12.036809030507232166;3.3858307397068321265 -2.6219159853913707181 63.433748341778127156 -0.64435305178782875668 12.314254706584996768 -10.015786270679086556 -73.566563259652625106 -2.8048665326515482832 -3.6293736101307909614 15.09250022670560476 -10.507491830969936331 -10.974815601490670147 -1.354457980752512114 0.59593846170102182658 -6.1221660085001623486 -65.975784271107244194 -22.170674025945963592 -1.0124515136049614394 3.3895604447546001659 -0.7866400297871702918;2.3987289726779397192 -4.9485347957683742948 2.331686158636751216 -4.2047453720646537079 -4.0946412311426598762 -0.84255251207365333688 3.3478059427189852393 -0.18110696750383767362 0.32625528341182657988 -1.3521711497951200975 7.7740424568884956003 4.3591990808753102726 1.3430343921935201656 -1.2499133547201122241 -5.409911490463718664 7.5542547509888526847 -11.441016026201809908 2.0411857128935220196 -5.8618228616428247335 -1.4816781511045260533;1.0826935537900919115 -2.6216871952042306582 0.63473205177283453793 -3.0168194253019438023 -4.7676971911561052409 1.4641191744054373736 2.6684921194498998354 -4.6850383379799369621 4.1022133282290766942 8.5720447029042166065 1.9091413746249619177 -9.2062607223601968798 -2.3448740222052317783 2.7335279012344075866 2.7486553066163708081 -4.4000208933646538512 -4.8765780095994735177 -3.944893167737112627 2.0798095330598824759 -1.1221520866547767259;-9.7318372247799249664 11.395488124881312686 6.3332084263667818291 -3.656567833437635695 -5.4621791164382402783 6.7893830698534927137 14.563053585024757552 0.62483761395949666273 6.8677089037724350362 1.9750363143363227625 5.1793926690099496568 7.628675564021056843 3.7559024155344449269 -2.848918290706146994 4.752924805108420081 20.443066292573739418 0.2333110904259688978 0.55419465422820168854 -6.6832070542270232139 6.036204116953860499;1.0339762934448608611 3.6518654867036661749 -0.15688584137809208352 -1.8644627396989266188 0.52743060010894060596 0.56937997627233050135 -5.8117868201301527975 -0.021277148642021622565 -0.58143985716108514961 1.3585468546149996882 3.1268738605425920873 -1.9911637037928224814 0.54811319666317903643 -6.3016984789416117252 0.46967026770711151062 4.9907649007793963847 -0.070386955094470612937 1.772892416087973988 -0.35974281059901286328 -1.0777122352286303553;4.3034823643228570234 5.2895472894604722569 -1.4638635774012174195 -14.526850250830568356 -2.4678474817751601122 5.1319308046111205002 -10.603690619738724621 -11.956879860509443958 6.8307123052887401826 0.2076171166157306236 4.670063781158961369 3.8725349489010567616 -8.0168106404138619325 -20.5870094564829067 -15.032498622045483927 -9.4081049831830938501 -11.164311195522591547 -1.1331379341871821165 0.46751862864523602292 -0.86325979730590529648;0.27720486967341395612 -4.8905028146113904697 -9.1758473469579406867 0.96424842413543598862 -6.3964696733620378666 -5.3131225834734410185 4.5280456863906941578 -0.20036116734446982046 -0.046830252378875808494 1.7778928946772980524 -2.5125875298210322839 -1.6635565429732515064 2.3884663435866122505 0.75434345129207891478 -5.7382393066962604777 11.381983090885325893 -5.9830862472868693303 -3.0029757883082566217 -0.95817500795641830091 -0.26068982357022263407];

% Layer 3
b3 = -3.265027810360957794;
LW3_2 = [0.077464851606969295506 0.0046975007388013250917 -0.03003249894575996462 0.10293393802593686637 0.03790351916586034986 0.044649217546152253355 -0.036628725589224378489 0.0011095252579980980235 0.055082266204630546402 -0.035785021823831884846 0.007546908145219495892 -0.0015190236652377919237 -0.00086933352479754897029 -0.010665025393019616703 -0.02224494463369692393 0.03006856441401300345 -0.028511629954810269183 3.7854946105547582214 0.012247621130384038837 0.18734059703883057524];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
