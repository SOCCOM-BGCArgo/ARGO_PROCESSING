function [Y,Xf,Af] = ESPER_oxygen_9_Atl_4(X,~,~)
%ESPER_OXYGEN_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:47.
% 
% [Y] = ESPER_oxygen_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8123176604998796346;-2.2509566072132418668;1.9996296202162606725;2.8332357411693731564;1.8100115929927691472;-2.3215569993116207392;-5.0601704440859007761;3.651702848649676536;1.0379003600385849904;-2.4726320416453848594;1.7081495919994242882;-3.1393443196123969052;-3.0036952744680998073;-1.1311216175178191445;-1.476838635272040845;-2.314974256269672015;-4.5194104109812611725;0.67870791382642714495;2.6723170646355218771;-0.6864211882941485543;-2.510055059367484187;3.716611894050959819;2.5669059353005216906;-4.8428768988382779881;-1.7513115167360771007;-1.8304295881876331276;-1.3183779475215857691;1.4265404357206210584;2.1749194472773374365;3.0703690517646107239];
IW1_1 = [-0.75859094192291587344 -0.021896752029903192999 -0.59543510830182011517 -0.44094930900860340728 -0.53682250825217536772 -0.49347503009807214269 -0.29318792893280593015 -0.88112657057447352216;5.7750213813678348274 -1.1763208847673438662 1.8016281445356912005 1.5368531895550936461 -2.8064840981359204797 -1.5926246968631816436 -2.0694703556014375501 2.5266284921478847636;-0.36627662898573543071 -1.1560085183872896852 -1.4300927988985911998 -0.37864370868844199336 -0.56755755508642458107 -0.32124351338102336006 -0.41704624718781740933 0.93580782647215587922;1.2288734339965927678 -0.61615134794904014015 1.4795683204600345029 1.0152672602962036219 -0.67754145104698793034 -0.15883638068918623509 0.99438917676815929969 0.48923544579481947903;-3.7492240513548806824 -0.61254691279191431086 -2.3804203069713740781 -0.24770769629655223221 2.0608524115245385744 0.99635022121442884391 4.2285346834437120833 -4.2166577164733158867;0.011039491178949695574 -0.6177787367202680624 0.88217586667087888319 -2.7012425190882121129 -0.67180874575602589349 -0.24182339155205528902 -1.5216492468404119176 1.9890970341956744072;1.0136424960234380332 1.6733385479282003594 0.53061169340526437299 1.5791185996992342933 4.5747759644689081071 1.2702467377167243612 1.5399660700883521791 -3.3349996531748331563;2.9488870447739286007 -2.357859371189575004 -1.2865565260095950251 -1.8045009221221968154 -9.8526165929075766314 -0.31115571129432606501 -2.303900746014441836 0.97428633648098705855;-1.0692976344416453838 2.4520645070483459982 2.2342580038311385948 -0.090836403149131855761 -2.4058855640221086247 0.34154845352959500859 1.0981994113946720315 -2.13006203763024482;1.1576682288987958369 1.1271425479366927735 3.2453959039999817904 -1.4426533001595123196 -0.92354932228063402189 0.81927043289622514255 0.41158275548943001887 0.12983493212604380052;0.11966065172558672247 0.80592747908119599654 -0.60339540484650577845 2.7866578041928726783 1.006449578989969007 0.31173985186400277048 2.0917956191662381293 -2.3902681087538675264;1.9597511291904110564 -0.99228362412464565789 2.3772899755408243294 0.3842867109934526848 1.1038556665990282291 -0.90191921834558252957 -1.3074833896795265975 -0.03143793129897404226;-0.057487013194147354445 0.47715670762271322758 -0.010443669961476831354 1.8697705209348602917 3.4479671991629246008 0.61786836721179982934 1.3743972155470098873 -1.618027656686495952;-0.23973411202275637932 -0.26202680741430045552 -1.3164132353671837983 -1.3393536252442799217 0.75162089081128813373 1.1713508211377361423 1.5310040889271279152 -1.1000494852363027487;-0.34076050173464028648 -1.0479956652317607979 -1.4681771021470031435 -0.39463378986511171709 2.9180785757500657951 -0.22150542155347843765 -0.8271493368454082562 -1.6253988085435917554;-0.18019076336752651302 -0.3325656473953059189 0.33305811333136337016 1.1720647503951628909 3.5994952108518725176 -0.38497029778508817799 0.0415893223426044914 -1.0570223982033055687;-0.045324830940979825289 -0.27834791246062151604 -0.21089299280075005094 2.3157124907994646179 5.2410589067636301763 -0.4293543340582894885 1.6718586412839044897 -2.6921532631641809097;1.2590204872276027359 -2.6293589496037923503 -1.5739314849159378173 0.5166668301238471761 -1.1076011107274621459 0.15429362029967852443 1.0540921852115163748 -0.11988542887505442003;0.67697791368060256101 -0.61793251892118949975 3.3176220556639095527 1.6623532818840141001 1.3323310354505057962 2.9698388703237994513 0.69722630689950548799 -0.31662784769988122635;0.43769370105320348774 -0.47683574458026367626 -2.2874204870157210934 -0.28061110784292869758 -0.58754647309438401415 -0.99558580366015603236 -1.0653568415236558398 0.012863603344065197703;5.3567605897442076568 0.64092945183182015167 3.4806966717667040534 2.7710489917235694435 -1.3102471458138387206 2.9651487839197878671 -1.155169026370578278 -4.1851915272547906;-0.090208596090871381867 0.35542449143219156937 1.8763757771908584626 1.1795209911478246045 -0.40732219278206799329 0.9008280146648135478 -0.086712990678157506053 1.982435504770150958;0.045005061215478689429 0.057994905640425163662 -0.14738292011635217849 1.2268073600699573866 -4.2662896739626079423 -0.23709905425803246004 0.47924917382342518968 -1.0556560167199995348;-0.57089409864524032212 0.23604392874369897748 -3.3944815138947923572 -2.7833581851569841881 0.57551946770690121102 -1.9682187062024272262 -0.73050467087049630877 0.5813537429208409657;0.46809629692558335501 0.25973102912494117067 -0.080783034827692376534 0.9146882947603409697 -0.53331191356529561443 -0.16923838687337494635 0.73741855662013666706 0.35344088202234957841;-0.62717628198681307783 -3.1859224556191718669 2.5701072275551766211 0.4308734167562523476 0.87329123280207299196 -1.7729811059618834079 -2.6918608350998756151 2.8049399358751387901;-0.15554738286002253722 0.15575027759560047813 -0.80454519469544205634 -0.81950933218217736353 -0.25745906154789233167 0.24231828597315210883 0.89954464510993936699 0.18887025790795308744;-1.1932877767530098989 0.51548965837447169314 1.8391245089965813087 -1.3300227953715391127 -3.0195130370530804953 0.19191622544874498146 0.079442349140764367821 1.2623664579694628962;0.409928712724184241 -0.5133265943222575789 -2.1536990201092613972 -1.5680648136453392283 1.5892393694878228505 0.65719716154542673348 -0.33687700893639649369 1.8165692793333181321;-1.6524510053671512821 0.55257177110747401905 -2.7934769445479314953 3.7274304096824839583 0.084482171690182641943 -0.96054807948722453759 2.4078041791781585879 -3.0273384837875645381];

% Layer 2
b2 = [4.47888619104946617;-0.38622736269375340656;-3.4911574790665529378;-3.3390331546470126689;1.9959945420678717465;-2.0056444684830867509;1.255373230321940925;-0.010041242382046728157;-0.98977335758935369725;1.1661569825533559808];
LW2_1 = [-0.9349793076115850976 -0.19597894761721551538 -4.2934005457502388836 -0.47784788039447306796 -0.037649743584713513123 -2.1315977356723867508 -0.88727721687180682864 -1.4343917493646387573 0.90779373312754918501 -1.2649281434124572954 1.5557259815811501635 2.1449204884317358832 0.34989054432478794432 -0.32303625197000868097 1.4532056190445210575 -1.843834947108140998 0.06854791544325818109 0.28382846607624412361 1.8772082145888033811 0.21309469843445275061 -0.071791997686557071368 -1.4353162000270023313 -0.73105975304400783177 1.4744641992714055956 -1.7157847172070250785 0.41543611308894623502 -2.2650905681571829042 1.7171946610423010071 -1.9372302567138022233 0.94529054585693517154;0.32171551394446362693 -0.27439144380261420997 -2.751348368689650048 0.43437399884362865032 0.40700395165291797239 -0.28800678508312432813 0.10408041613181755192 0.34943988383679314147 1.6715508818470263819 -1.8342937964565535491 0.15689380776013711616 -0.15707124953351805918 -1.035641856202853095 -0.14492484479555284294 -2.0692012910459833819 0.22875116375161883009 -0.54260736420186739259 0.15444772035734050109 1.8697881188580836032 0.89181608483203644866 0.17119499515595831829 0.37354685964995243408 0.79157231905391334248 2.8596611754685588025 -1.0833615689823574701 0.27385023088152649073 -0.43186928448277861481 -0.48720573792017701775 0.27382360621379070453 -0.84814862915982647262;0.22479290384472727649 -0.3165463642425987989 -1.8173450920919989038 -5.0083643541243736408 0.66543208553813604222 0.18869258063242838608 -0.81330113144269766678 -0.51884940250451594412 -0.47305491018708750728 -1.7281076189074893179 0.6682794572045976933 1.6094548687378749108 -0.29498824298689985124 -0.50588201823369960408 0.1792016253135435 -2.8752312582323433787 2.7648035231962588831 2.7881282315357545087 -5.7766412651300509395 0.88725416405314405655 -0.46505203498416652907 0.54209187692212157383 -0.75059130278264918346 -6.8154116307271621622 0.3501659655497936785 -0.78015846480125627949 -3.1622431091378060408 -1.1044597989816875572 -0.0040474918061045653261 -0.41085020321884518912;-0.74600628030060878171 0.49359894808869625438 -2.6840387877311071563 -2.5558942621383056171 0.10465985132574827376 4.532462280108807029 -1.4131976199563502927 -0.80276760259206880743 -0.018893894076366202911 -0.38001390820815822424 2.1068748716847092162 1.8829482156449388608 0.35878776336306184014 1.579698756758717737 2.1759781872745711517 -0.11171918787092652292 -2.9002003560430273943 0.03747099190226379356 1.756723555174723117 -1.4496557489086721038 -0.65475084237649672225 0.61315130269218154346 1.6734497263168550685 -0.43196239314412721022 2.0049659171541640568 -0.0031405480239912954461 -0.71482197707722638924 -2.8222107332798285206 0.92354135338779497211 0.61743150987077732861;-1.5454296827009657012 0.06951842461832301312 -1.7049821528986024433 -0.22060097699350525446 1.5197383804281203723 0.84927929528447387852 1.23072585852856764 1.242646964128930609 -2.6953910092541311094 0.31426965460118350126 -0.01352656471061021784 -0.081362911200073689821 -0.77041773890302311933 0.47907086566856749155 -0.75439932402947851298 2.586273265342190264 -1.2363287889758465266 -1.1349403158803572644 1.8434527848834159069 -1.0086903134756040057 -0.30229622952152040982 0.15997422502907798769 3.7581032355917085575 1.3060151073104764308 -3.4662499166752356317 0.11934664346723029837 1.5319234891924653486 4.9104158255608867378 1.0776292024956142246 0.72621829017454364585;-0.01386051091811691012 0.023982146549953745063 -1.0953257166718612936 0.7738062952238433656 0.23272296658747435028 0.81740783104702863238 -0.63940917945122177635 -0.030879872841765871466 -0.26114075198664893351 0.49843563497313814192 -0.37790091443295081852 0.19232395130127410976 0.50732220131378436001 1.1090271961789368582 0.48011814029275867721 1.0399680368487704829 -0.73195751583056001266 -0.74855119658549584827 -0.45391841835363111457 -0.93367050414463459429 -0.0046880990926362296756 -0.94691958407106391338 1.2164838537144289088 -0.44719756064047633259 1.3401410830593898371 -0.017147586790688087305 -0.018751966289355388728 -0.67109927678831338138 1.4939164923099843563 0.16662320227536242534;0.3891597731592868481 0.13125089888149121808 -0.022914838556787546497 -0.79682428298326823946 0.20903655688613329011 -2.0445693153449604473 0.12834627822597788338 0.10674890679796492088 -0.66155857889753255652 0.1552267325998059333 -1.133726680431004219 0.2599791711259092919 0.24512346037628751638 -0.53771907268232610466 -1.4894628308058914801 -1.8108900624397554768 1.4721980393807434506 -0.016626885101448982129 0.29972796428484621556 0.94311041592229638564 -0.067242919950471047308 1.4777971430552450105 -1.1658360830371168326 0.8863878710115905557 -1.8817061659590421652 -0.27935977234503706068 -1.0958045426812539347 1.5114344057786388564 -0.16969900024529399607 -0.38082620555122931316;1.8706535160960457986 -0.3437198901932655426 -0.71704025097842671865 3.9753858926144487462 -2.4544105872711123872 0.93854874958536749219 1.8208951830161643759 1.0043918281442867357 -3.5636733717898492202 0.15843883549500170638 -0.21711701300946384396 -0.10642550595713534678 1.1359228563493173336 -2.0228615079253633446 1.9577167225818465912 2.5508839331247665783 1.7164957762318751033 -1.2120400481555149153 0.5964910927947097985 -1.4912296339212900431 -0.83955197485617394371 -0.67687460184806302887 -5.4971814576013686704 1.962501172082483869 0.48973505777300252451 -0.82429982442741978055 1.6530210973652763595 1.6906036502419168333 0.79477764270894801779 -0.51826125905997244558;0.36707379587572502855 0.72778875751385485593 -2.4801016266191653337 -2.605774640199077119 0.25375549384660250896 5.232681341002869857 0.28141214605891734513 0.49011061284995943721 -0.78269792952137529074 -0.32229593753289309532 4.6671523388720022041 0.56360802314168867433 0.66331646687225709336 1.4013270646319906376 -1.3408457834904394801 0.7064336232230384871 -0.33849583808850786104 -0.54175975177065871513 -1.9158671729214717949 -0.43960865440573348994 0.26482991445545051024 -1.3253012837369142485 -1.5998274409400350393 -2.3762413726851954188 -0.26477627749416693392 0.97492456258103221689 -5.9372756967533639738 1.2170336262198651056 0.094252989319706229066 -0.15117324815063187815;-2.4833071619090252291 -0.10422611503247057596 0.99213868963002427304 0.78688630457808106389 0.22551889460001017795 -1.9113488221485051 -0.073537465186317804711 -0.087045000937384389705 0.092236528049926436168 0.2251152244413554826 -2.3140457318479019655 0.2595201327162618421 -0.87399395704306215293 -0.055584962597941135753 1.6326917083444081324 -0.15659405282060526177 0.38579558315504669519 -0.43608245243461396523 0.26818726175287377345 1.1599140332881452409 0.0097307750221208508257 1.9294831577606819106 1.6789593625415610845 1.1794543470569938126 0.79337027166141149692 -0.49424939423714597808 0.064020899218391047469 0.043768346063112424649 0.12780389519329024561 0.15420668964906875109];

% Layer 3
b3 = -4.3328994280786927717;
LW3_2 = [0.33553320180166645859 0.26849497970776042832 0.081922217071045411174 1.9838503758074441663 0.13675897682186030635 -6.6400709497161249928 -0.75809450149197410429 -0.057133361229246185098 0.34421203374956127474 0.49564839679107947079];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
