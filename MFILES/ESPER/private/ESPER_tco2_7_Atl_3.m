function [Y,Xf,Af] = ESPER_tco2_7_Atl_3(X,~,~)
%ESPER_TCO2_7_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3919439601081345;0.55933979603682216;0.71149635385960008;1.1408655223752397;-0.044984802702279836;5.3107726117613705;0.67185437284532745;-1.9027229182222947;-1.8805705630086418;1.2142669193334665;-0.54402346934343404;2.1741279279283701;1.6706304728420001;1.4537878826966821;-0.59716000808824965;-3.367620374422037;2.2454596503176849;1.2631824414362818;-0.6106802515334766;0.030342523937778372;2.4461742812400606;-1.0615572943625908;3.7304633705783643;3.2689044402873093;0.99421486470043863];
IW1_1 = [0.31930452560675238 -1.1817543186052808 0.10818638242603204 -0.4326268010579935 -0.56333467614949395 -0.75318459071580723 1.8516795749899855;-0.62487437334271967 -0.27296645516107559 1.3093440258702471 -0.30724446523669618 -2.1791575777519672 -0.7577609557556152 -0.95910414474926808;-0.19511684397018353 -0.81657518605411272 0.28522974034177845 -0.28623199876267535 -0.57657442616997245 0.0875032098443638 -0.55911881557583454;-1.5791087905271703 0.954870991497629 1.047436988724761 0.10327708834292125 -0.87282333706773996 0.63735243396351848 1.2716783308093063;-2.1183760254080855 -0.033544601721884081 -0.82559499455106355 -0.53320187162840571 4.1054984122686058 0.53824147997780114 -1.1800397310567126;0.33177876913686283 -1.5650117016074219 0.62956646637271207 -0.20764157591097243 -5.2688446253197743 2.0705657143575937 -0.29627592858324459;0.023218175929383609 0.27929066399643576 0.68061643630725688 -1.1356413546570567 0.070525866502870183 2.1483376877176461 -1.565601444270925;0.58472483295838185 1.1946670335208918 0.14939557944433771 -1.2686463814044788 -0.9319825692338356 0.0044237195422448874 -1.5526613928785873;0.86802887595377143 -1.1098617840146372 -1.060404502157841 0.60558262201074642 2.5153533539193114 0.60357191343358663 0.015344093090588748;-1.3144826724351892 1.414725620505396 0.48602450834526828 0.39587231962879077 0.92118436274247673 2.5454556570641862 1.7367452207392562;0.87303709538283669 -0.80925688324564782 0.36437272058874892 0.53638695317232421 -1.3785776190939771 0.10149923604297177 0.24878227055118815;0.42149810364105411 -0.51267837526750248 -0.90567437577092735 -0.036079269895169304 -2.6330555097055148 0.65754263765688881 0.16544394614804123;-0.3900632786289579 0.7605847937297211 -1.0936072388961078 0.54024727452448762 -0.8303201643730922 1.7792350825731191 0.35610595773203985;0.40530244395211562 0.62095725272298663 -0.10364240822734185 0.59745406924314526 -0.20870305343187145 0.85632624055345363 0.37886196670639494;-1.4486239065969277 0.68680520512003229 2.6159376272449042 -0.94041504792162522 -2.6055846487830898 -1.0566775515049627 -0.030804477493569023;-0.02558887209504776 -0.66472047713389293 -0.3391566849111477 0.1595076213766457 2.9288711291796257 -1.2161043087687555 0.81131729044008094;0.74621244581730528 -0.81173860134776454 -0.83298542417861476 -1.1192010758256494 -0.83973135560021184 1.4583698645424212 -1.4139770229467554;1.174736216984426 -3.1614535782764031 -0.20110008564833431 0.36786258765697299 0.54847434944782647 1.1983912660020335 -0.23389518112244612;-0.58502029570549696 -2.7706458044770832 2.1227576157957402 -0.021147559868045708 -1.6200118035035873 0.48952766489080146 0.53064736775527899;-1.8117977675464096 0.73749329862506785 -0.050947671396766904 1.0833870472323495 -2.9621991247518022 0.37432834231083717 -0.84392970495501862;-0.064736428564890702 0.71403539184995568 -2.8843771011712529 0.19533793927476042 2.0903158188527624 0.30938650533090539 0.68140074142453966;-3.8824605563304924 -1.5691339381428426 2.3214395985544845 3.9733564004401152 -1.0276641883208881 0.14869551785333313 2.4895658693971914;0.30019647493214957 0.12586796340689624 -0.079436719809329592 -0.97452903430443016 -2.9573249708310283 0.4732981421429493 -2.9615556398410625;2.6779898335343373 -0.87188362475145764 1.652916704921966 -2.2182096205074928 -1.3900811018128334 -0.81978319562569257 0.34088145674109194;1.7435046340958187 -0.41815784332336381 -1.0470501555167351 -0.49317058882764525 2.279624339726555 -0.90875336777180749 -1.5873038484379387];

% Layer 2
b2 = [0.44164365202968631;14.764610111706162;3.4113524527826358;2.6007368109902878;0.29562671900924953;0.6102177560320291;5.4199228146595839;1.0710418993564135;0.86577036205142344;0.3270563637898205;1.4020594015523067;-2.8777604417749689;0.4490384998461584;-3.7418529743712621;1.6639583041322714];
LW2_1 = [-0.65090757984064274 0.58010059364166389 -1.3087359742282443 0.7491558142311322 0.72541441893243641 0.2428853199282861 -1.1421804119350278 1.3578035252835587 2.4273050094085744 0.35969693472356906 5.2579321727889994 1.6475104831964447 1.0338865288750123 -3.6677316868981533 0.68783508976286334 -3.1220551515632087 0.51448000610565758 -1.1040633953984527 -0.09285442127581825 -1.9230265572179381 -0.44470822028738155 -0.95502594730268453 0.30869167883340903 0.50258237433903019 -1.258600395505475;2.7033975208622865 3.4011627934043474 1.9930987646346372 -3.7937324711084131 -1.1211509564397908 0.5399232567745792 2.1781674963507238 -0.46848701062157266 -6.0534244342044419 -2.7009904397783684 0.92549120103564542 -0.30881089431087716 11.496702194618123 0.91456476475552573 -1.0562295248364897 2.7759751957290915 3.8500873335537134 -4.9881747721672678 -0.15587242687214037 1.3284016754836476 -4.6256688088706222 -1.6096733447393754 0.57131392270495329 -10.772969297733665 -2.5800283918231153;0.14880284297709492 0.14787444670842217 -1.7773456333713507 -0.22137270252190996 -0.79084726379949533 0.73333138122017727 1.9666187624158464 -2.6298145925828309 0.97581560849994953 0.37313141398054972 -1.5567346571679221 0.70389568923012991 -0.040725810863212558 2.1038678570151341 0.12671178426530993 2.5086153283169526 1.467072061360077 -1.1341212424233829 0.82874464176623575 5.3894173882913874 -0.47750210006125787 1.9373652565820141 -1.0621117446521733 2.8168519356094355 -0.31963028015459799;0.36040194094254591 -1.5189569349557881 -4.8224740754170989 -0.15613223412444174 0.29813753783698554 -1.0839982921838103 0.72326848434761015 -0.85239409193424776 0.060460235670174764 0.09946831153162454 -0.51107473021613625 -0.19786710908538507 0.24804052408862279 -0.89621971297413816 0.73918816774928686 -0.70182957702160631 -0.43329245210371192 -0.60289373796580015 1.2422374317063274 2.5859914733037184 1.5834908458267885 -0.86800369599022931 -0.51090469889667012 -0.080725267858783742 2.8503316436090063;-2.0581277084784446 -2.416162360485238 -1.2985995824141583 0.10033909319920335 0.11766019841014623 -0.65479133961753067 -1.4395411149155548 1.2252382579963708 -0.76650734949630361 0.80311073563279367 -0.41226263206353897 -0.39121603751092371 0.33635626793119555 -0.77088072763653059 -1.528059901885513 -0.45288633172505921 1.7446880211998002 0.55761263815244555 3.6295376895792257 0.34978095715669677 -1.8139028065371281 -1.8097218102990311 1.4910903528885824 -1.0304376666569381 2.2867801068295752;0.83310680866636222 -2.9517759688809657 -1.0943735694734849 0.6436515834872697 -0.58155862458447993 -0.14632240643147609 0.20471445063230792 -0.49673322956808252 -0.62356292998898055 -0.75387817441176885 1.3622133547232564 0.90389559124848085 0.62256672783410094 -1.3497990182541726 0.10527180462148765 -0.65344747127762881 -0.03595539912131758 -0.86096449640985007 -0.072395198292162802 1.2689299471258966 1.6982822007714184 -0.86688381985817031 -0.10095793538576107 -0.54269470148942411 -1.5660768753079379;0.078007970031115204 2.0016745714272854 -2.8187630427284511 0.84030769379177439 0.0002930129772532996 -0.31588951198973225 0.87103357780155877 -1.9806558409877555 1.3101073816289848 1.8348281129340702 -3.1285926416276304 2.0607287550180824 -0.26755003812795075 2.5195098465070078 1.6558266052469424 1.7775415271877995 0.17640295421986166 0.20623670313252432 -0.84637024153131724 6.3938558874837632 -0.25491162508132559 -2.2076479246585108 2.7636801659915475 -3.0706052624110418 0.84815103874834707;-1.1931577725242877 0.033575613405297772 0.059945924187837708 0.66490605142985826 -1.2594806225870692 0.027090235004290669 -0.92519762042212539 1.9511747523212253 0.012806803215526453 -0.27915688471819999 -0.16095650983314549 2.1414190861683267 0.43330933393950183 0.42112290458145218 0.28368801041766645 -0.36930919900151432 0.45135350750224079 0.5954695066800102 2.3716086179984446 -1.1349958994977991 0.44565091568467702 -1.3968108443007672 1.0717763522568058 -0.93983260681904901 -0.43644991563951191;0.91423856954071947 -1.4791355741490462 1.6114981990925143 1.4454466264919135 -0.49664597881061945 -1.3762649609854962 -0.072189841992232273 -0.072872263502443094 1.8755727988122859 -0.69079979501654587 -0.19995709495330091 -1.3842953206208253 -1.2749063605831601 -0.13014385097389142 0.80275983221524028 -0.98899701555075104 1.1781772122280187 0.76910320076463812 -0.1762864391426166 -0.49040174779425783 -1.8269157199762953 1.3943469520011844 -0.90933650810168187 0.96060860264428649 -0.48863905872265667;1.4912864257709733 3.4225261480537883 2.9817093539123212 -0.38872697636011594 0.079473842910339848 -0.062536494137002505 -0.96442853430852371 1.5063844866131104 -0.86424738456912953 -0.095684610598659361 1.4924012104958368 -0.4575056749888895 0.1418900739087553 -0.69829733062488208 -0.15055024778058834 -1.3606332343561935 -0.26517057216620077 0.85400587387429339 -2.3180166253736929 -1.8364546003775142 -1.0371508141290213 0.41381532504034713 -2.2081571839433223 -1.6149180662286113 -0.91028834862865893;0.61485975513018565 -0.083827551638284453 -5.5465841386773409 -1.0844720059489947 -0.51780326407028343 0.82247579573070695 -1.0773062884468165 -1.5054678937092054 0.1544297318079518 -0.60102792630621205 0.60965245290270353 3.4246358497709442 0.12310984554078616 -1.4416358279728685 2.5323927316325601 -2.8608973684262926 0.072657283132261372 -1.4655904224509031 0.59581911740931981 2.2708352670434495 -0.94127925785307365 -1.3512684624513225 0.48350714948163309 1.7757330592332721 0.96439016988699389;0.26129157330121533 0.83733233012113839 0.77272069205078608 0.40019005797703389 -0.30034170539299254 0.057911065898755595 -0.083665865956165514 -0.30914713707990493 0.074230676912261429 -0.80592117578980005 -1.1336122514571023 0.7288199559547911 -0.54358435647840464 -0.46530848496884003 0.28662006135097956 -1.498302867443722 -1.7583821480179711 -1.160296239322139 0.39349449064257042 -2.2720633741096905 -0.082838310865783416 2.0517784906485224 -0.9051912034599614 2.8734663768708777 2.9588927562928902;-0.95240407575240515 -2.4617093159194372 0.88239267457681203 0.36521721122534434 0.83131717071794864 -0.36849543631417309 -0.30871022204954296 0.2813177054325226 -0.34892563751681532 -0.15528359191483815 0.86854828691103458 1.4199004355577312 -0.78626411267425378 1.8012788336981997 0.84567193810155084 -0.001057502572061603 -2.5286093728300436 -0.02559437876532631 2.1939880899210786 0.31790201397416717 -1.2702104062398791 1.3132797330200954 4.2598309291919394 -1.0567310372573315 -0.61298795649425597;0.40795306069531229 -2.8379177345337321 0.029369981584916514 0.59761478641351395 -0.83654856771635122 -1.8928348816072611 0.40268707657502789 -0.15108679600406097 1.4553188890108484 -1.4319951759709235 0.11506669558347724 1.2084649513367971 -0.0082286344930168898 0.57364426218402131 0.65487538174731186 -2.2324084019911354 4.9664983771753866 -0.86483379167925578 -1.4017456506203883 -0.97925391243781568 0.76893350312510578 0.84223880044489385 -0.78571328302519283 1.3683585999524526 -5.0239103264336729;1.9668780540935014 -0.37035844201210444 -5.2692767082499463 0.8601351073698994 -1.2272098990590088 3.3032449411133631 -1.3726695391570085 -0.99324168753009179 0.8653020567450983 -1.0107702103131064 0.31322864839775144 -2.8667510275170791 1.7169278542570374 -0.59701881939864421 -1.4214127067932445 -1.5287234518107593 -1.1040027418137499 -0.99185339887670509 0.15243648613968094 -0.85666145043029318 1.07128833395931 -1.7778379766868739 -1.1957388308747687 1.8927507142039537 0.18412077140906905];

% Layer 3
b3 = 0.17398601120933391;
LW3_2 = [-0.61524236930585408 -0.013647072292677363 -0.025980146840895776 0.046439615406415509 0.026529889697659473 0.079840090818855 -0.017960982371825026 -0.047846944302540502 0.056744298514152691 0.017592489611761818 -0.029935888721786007 -0.061890658257271164 -0.012062879148658097 -0.022515182796795069 0.055223315783770592];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
