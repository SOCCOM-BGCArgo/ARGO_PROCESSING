function [Y,Xf,Af] = ESPER_phosphate_13_Other_2(X,~,~)
%ESPER_PHOSPHATE_13_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_13_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.74048084109969869449;-1.1334430503577717086;2.4445624155183436343;1.0076386343979994997;-0.93635512109723939567;2.4224128387107106697;-0.28902157885734813814;0.84591353544067093839;-0.14950504022777841295;-0.67297166114935580428;0.87538615381160322926;0.20522036772803045612;1.5094635096057591461;-0.29923056022482236171;1.381897549029811767;-0.72699634470844998191;1.4822028238011475398;-1.6901034356299797778;1.4078314552291313344;-2.4270768576876222689];
IW1_1 = [-0.52744016233255697212 -0.40894262928703084548 -0.71688319829538771355 0.1097261011874814951 0.17880307572442669106 0.5915249945211346061 -0.52802458607571378657;-0.21339241605222039611 0.26571270730126483883 -0.70591408905331765045 -0.32976551201203674335 -1.1016753606185845094 1.4421282376635347067 0.38575822385824554139;-0.3496729880771708987 0.36842949484965298312 -0.41141080737323210137 0.12839957090746834112 -1.6358821044872799977 1.0955356501117778922 -2.9930703707529833224;0.12488898609525099503 -0.37985061637479816676 -0.39236208572405723016 -0.26070344845273618617 1.3859745859929031297 1.238128141921814418 -2.9283337064986918463;0.62508756535298060086 -0.4891295677090428673 -0.60989380061113773746 -0.21693088766663831679 0.21485054768606848263 -0.16956000277413743604 -0.43683680841710531562;-1.3751036076952125597 0.74418894738075236361 2.2056033915736881212 0.02993264387339780383 -0.93649420074798961355 -0.32124778258728287073 1.5544901821729097957;-0.20465344303978413865 -0.36639764921965783939 -0.55344016957189601236 -0.13738759074823531092 0.043371771986493640183 0.76340145314076546246 -0.40007524577770409158;-0.38826942562606320264 0.82643879490975391544 -1.7954378825429813116 0.1520208888993266616 -1.0623296099325074682 0.08048076395192677035 -0.49347771181003741159;-3.1468448268579427562 -3.3214983161376032683 -1.0529156055898478694 -0.038878703955363434763 -1.0177878555712265296 -0.65420407055888663006 0.41799666559913445374;-0.72791146899868286457 -0.63477573791239616519 0.44916884182788524571 0.33016704143826436368 -0.37163088496437585162 0.53006056672291468335 -0.091524432175162387382;0.086161544299732772956 0.12227814273225708075 -0.36570440088705175041 0.17159028229182371472 -1.0284208973635180495 0.32904748442906706085 -0.66625872657149298739;0.34103360735181542651 -0.038508926645835286906 -0.25099478224891730305 -0.78531227144099247095 1.5897394742909014553 -1.0296821857548574819 0.013310814085130408604;-0.022071520490211174459 0.010019550626011800021 0.052936094756215149038 0.46425403217110783327 1.8112672804982474783 0.77847344291691844553 1.4580946455826675479;-0.20779033664628787648 0.56026371338206981676 0.74159590578754075452 0.13902848259106498352 -0.88840979896012473027 -0.12575596772687655522 1.2233083253594529971;-0.0026248665304024676112 -0.050798990297497140234 -2.6634034252361269424 0.20458502469499634246 0.85664466369939318291 0.8921268661634115249 0.40480820224614538771;-0.34028534049616310231 0.15562007714076564469 1.0377414781762923646 0.34735386360442993547 0.54641773586078512537 0.74747824182912747659 0.21282328801003208563;0.78524714888182223227 0.55220398662112313293 -1.1437022094013040707 -0.16843820054880723203 0.043162634029063041974 -0.22911761906923924781 -0.37287708947828623884;-0.092693160078729006091 -0.67917177223821656451 0.83198937715648191293 0.2557516005384208313 -0.83224188821737976607 -0.34567665290828375468 -0.37597745380160563222;-0.031140194572731955125 0.16363644665838603109 0.030218880391881128289 0.72734172669355368068 0.031854197859967944839 -1.0060558584890415545 0.83978846069146517728;-0.61234558214471901394 0.28993898825704889077 -0.9057851466702330212 -0.53727313974857193735 1.0129122039111404519 -0.87174636958113660423 -1.8279281744793058895];

% Layer 2
b2 = [-4.1507288658902679046;1.6264034485329073032;-1.1390845342142825736;0.75065300928453781992;2.9008084501122066712;0.79853533782580332634;0.38803834492310640414;-0.84004959105439314104;1.3277299979912438044;0.17257891206834727327;-2.4146708870853150763;-2.2857702875734839942;1.7622747276338321942;-0.66046944275421870518;-0.95255769823995684042;-1.6269802927438448137;-4.5806908008772069252;4.2160131355197565384;-3.4306824862806104548;1.9495451732044217774];
LW2_1 = [1.2979998554576788194 -0.009324090330243589575 0.59636297478530697624 -0.29187814468395395506 -0.7984005889362351116 1.0684511427518992299 -0.90285050829536139805 0.41763040041973625849 0.71253821917125126362 -1.5037100384659127794 1.0356292241056135328 -0.68322697457250836095 -0.11100880752419402253 -0.33307860599581745609 -0.21819555889214478639 -1.1192751424261724313 -2.4938116537211811874 -0.31171114873038402449 -0.31625123886234363102 -0.32898035255913415931;-1.9756917190108282956 0.25249237935542212519 -0.97487124165545924193 -0.69027713032535698012 -3.1282572202129825811 -6.7411849440496283137 1.808772050399682696 -0.50192258067583317427 0.14083138949158505171 -0.60225102560421273079 7.5398254497522225748 -0.0098532856518232583842 2.7358443128456486626 -3.8312131808986742421 -2.0363298578031545638 3.0460760432331848158 -0.75320397503410840834 -0.2565141614920871671 6.1103594407003338773 0.92992784497757552398;0.77774191097703604392 0.22535461290298192116 0.12248915473361049466 0.049542071118220953885 -1.5664638456116151133 0.79670082453431501079 0.0056700942396018848626 1.466149021358399418 -1.409475066887183381 -0.40478603189227574388 -1.7033176856180216596 0.31943910677515863217 -0.66589749752209625999 -1.1088596912932691119 -0.13967536518482193131 1.7349281518986883199 0.20034529469133185997 -0.14856822324242205391 0.13138466342529470099 -0.22709387986275114679;0.65364134141759799856 0.18298717048475601765 0.5694240342444822911 -0.4491067799283764983 -0.099781952108376328892 0.25074044823709512597 0.023265300341707005616 0.41620220616262970648 -0.26626906151873391826 0.83469712802677309416 -0.099510139050355175816 0.15458855469740373501 -0.39267157687508785768 0.77465821661542022536 0.19636985475371199206 1.2766664215016960693 2.4754206499091431226 1.1469534275713151317 -0.22738079251255291502 -0.018531238512306376365;-0.42540418986860589756 0.45233932734007770149 -2.4783381338080494594 1.6685452366799751189 0.76426003754271532031 0.27977402061285694401 1.4423696847221092465 -0.40509829415141102027 0.077535445766676786006 0.067796063545648752036 1.4886093968668336895 1.0217890508274209971 1.0927207255414845832 2.612269146930538799 -0.60222914785950021344 0.32826300734883151478 -0.21846281294082614544 2.5522757546272298868 1.9069832267897670608 0.49418775066254905237;0.20953355326324918373 0.002217051065900154088 -0.00070098434435985051277 -0.1773256491064593432 1.8807245622641413085 -0.40352523638161585939 -0.53109067928090691879 -0.91945495032736190844 1.2022826760661291523 0.025096502625309477508 1.7119175873793888165 -0.36765660166801000797 0.57082207344800939275 0.83148052225268120896 -0.035883163287825758925 -1.8863913745618681173 -1.0597596891954716991 0.52749719350866264289 0.020235407219835632731 0.13301278439327882119;-0.27936638379926459486 -0.52235246039471405766 0.67729164450122714136 0.15219120799860819115 0.4871848886312881155 0.27630796190970419168 0.48768200807133987862 0.72397035981907997826 0.0061116778922286948278 -0.90667993534482793638 0.5805660437101820559 -0.23772481611683973779 0.36242572740290679434 0.063079427749272207193 -0.13012284407850482904 0.57412730549973423066 -0.70883003884254114357 0.360813919262267635 -0.62046562224131551755 -0.12183279270500303737;-0.1580840727218711661 -0.53211854450850426534 0.067506163673385050084 0.52940102852945103429 0.33043432074981959889 0.88423775633252676975 -0.15995617916502308242 -0.6271916605090558372 -0.10233837835084524936 -1.8265471748704107391 -0.37603305078943655149 -0.59273805759652453684 -0.58110441115921473987 -0.032895550529690037456 0.33008974202206881055 -0.87677484311419773277 -2.5306704457952915455 -0.13371821968603017639 0.06791743597266368393 -0.088072399353279512413;-0.42631259385818948138 -0.7995659507691290635 0.98004901821041001675 -0.76052384809515505282 -0.39358515927607284901 0.68708883342241766634 1.8538776526581965953 1.2863813445200042995 0.065123946735352988835 -2.3135165863671574016 -1.8428203434409820005 -0.46208406071054386466 -0.7869489891572790663 -1.2063097142718113286 0.62588557330683303181 0.73719851405357472718 -1.9464143745776754102 1.1867236439717807617 -0.31191636716669085549 -0.10189473723879213796;0.42148012697600906185 0.040594447644087899851 -0.78110667658478627473 -0.51102266557720221751 -0.16230555430378312831 0.67644615820226527969 -0.46211581586634686847 -0.55414612356526493642 0.26414851100548614182 -0.21988543226614754023 0.41462472144027001653 -0.77925890045546264417 -0.52792858967926081792 -0.3717330364553305122 0.0020841556139935572475 -0.98238583276274371592 0.37848700463068835065 0.44120350875148678371 -0.5362425080089380236 -0.19582387654890567874;0.9105123123458523926 -0.41555493077823529857 -0.32426422757315409573 0.047976943086624423973 -0.71757519999427477053 0.52873704113153563444 -0.21893069204409540407 -0.3911892127762983673 -0.064057601573404593376 0.712521273485315354 -2.1735157845751280625 -0.53017869652222404664 -0.70075344956832963383 0.71062084481190535001 0.34650087814652186236 -1.1209497095929716881 0.95946710934717605035 -2.1138705047062837927 -1.0392800843135745481 -0.24090184344686413342;0.26425847796528151301 0.67356094832591129062 0.3695447448745083352 -0.0011739394514652164853 0.5891565110158030194 -0.38491780722053581254 -1.1287501504511960881 0.21382480573803669399 -0.29238203752707769834 0.58308289819014869071 0.91595859527549394752 0.52500354027642515131 0.43163063197313294994 -0.032478206562429348669 -0.6822529820990657079 -0.21259708303268806673 -0.58231517218760797672 -0.82308146961225414628 0.67616732061825646216 -0.20452428177324846748;-0.16700738287156774442 -0.80066201809039494464 -0.01860499278399158421 0.087974349806501137006 -0.48163036391354890897 0.25970420922135334374 1.1656298042818384886 0.12406142616001440693 0.27456097404060203493 -1.1140737882033233674 -0.99283747220952367485 -0.49550058911822603136 -0.47192449861777618914 0.1125526483204333239 0.56167085539071770484 0.56396316772622123725 0.024916347417399689612 0.61238714422157292105 -0.70022187306328831369 0.26706270606406673496;2.6774039207410487151 -0.43451336603270190873 1.5651833633628993159 -3.0495158486152180721 -0.4052114239844310517 -0.17336633025540801323 0.34468371032158046097 1.4309240057338776797 -2.2822474079353534115 0.66811434817552228793 3.6956323468718519365 0.64553527908345076369 -0.99142839397702087201 -0.19473785994836118052 -0.18838127844699889546 -2.3572364524322391155 -2.6442579598192428314 0.51219454962174404411 -0.0095524508493613387305 0.6279918731017740674;-0.24874057720719566777 0.2423116924894841151 -0.1117225474350407588 0.093825344447609829168 -0.14986326254279605519 -0.72438250093279443753 -0.30755132408238772257 -0.10980983473436999043 -0.011844645690318992073 0.40260404986902337265 1.3647589109318618572 0.39598342808492514866 0.59323725474617783338 -0.17200223560447305826 -0.38357618641006901994 0.87995368111626837138 0.18838764151386405699 -1.006820196049919236 0.22315564749740818273 0.38794168153815633548;-0.42208190933334621686 -2.1356225564104125425 -0.32030997552721085508 -0.45494033388187632427 -0.48541938258723410504 0.66711986737440953643 2.1666692910333300581 0.85793741705880566251 -0.056568763066788076144 -5.3385632819666026805 -0.32450954441167967346 -0.26841861202618583215 -0.58402038466920913606 -1.3964305917114532285 -0.36168382162378287514 2.1730860569491348144 -2.6443391128461972706 2.9825169550754404568 1.900245585921949365 -0.39519452329723991912;0.72441943900322214311 0.10454187573366012509 -0.63867212413525209502 0.6942000354464307188 1.020787017323500967 0.071281047735595834403 -1.3237326619595402022 -0.65425897222976081569 0.02415191300183731557 -0.066483734921453818689 -0.85857909782061014869 0.042524473496310180587 -0.19218241172181507737 2.0827583780406162539 1.4803990818350998282 -0.75518597415053478894 0.57656848320300835287 -3.4664999357071226704 -1.1017582469852909011 -0.23531580251451822416;-0.83590683121967546132 -0.065835226894774181994 -0.55367766997407263929 0.79199166305649082442 -1.5679892279492886331 -2.06364258679933954 2.884454928188572076 -0.57866759022455205308 0.088549305974099379313 -3.1037437288174762884 -0.97148709450187886727 -0.113589733109853111 0.76578994319714677186 0.19505902924945434096 -1.1069559267609569986 1.6531829036217278173 -2.9668955462579540416 -0.68422682657800582007 1.3963353324852236792 -0.24893059443101658856;2.0771672473831168659 -3.0729009202979860049 -2.1470102902371035469 0.37528998144537406567 -1.6287826776884921642 -0.42932988662797322288 -1.6696880791212573847 -0.10909347450892938058 -0.11815620594584148872 0.54842298597965655205 4.0167701859707554135 -7.2390646373870390917 4.3648750736913832782 -3.0890992074966581171 -1.8830518482171778594 -2.069126768990301013 3.5660094334308136688 4.5182926052775425063 5.5908901235813743824 -2.215740133515728516;5.6397121597086536937 -0.50636970610705611673 -1.4764444016326523368 4.4628996892870134161 0.1512191154994643183 -0.28987587385468582823 -4.5803272789273821175 -0.60750843894467354556 -0.079749671471928545996 0.96402308555004379009 -2.8607429213300408222 -0.4568662884556042858 0.079135136312993528684 4.7895943845085886537 -1.3414292821728268645 -0.84835534412437230145 2.6117136660319713037 -1.2374845931969364887 -1.4576242747584458037 0.34403246129246117802];

% Layer 3
b3 = -2.1637243379688895217;
LW3_2 = [-0.82556373057827070472 0.31847605663045525093 1.1642779359438801823 0.63973679370631575392 0.44906909265946531873 1.5995253356783529775 1.6337553107366269423 0.90190434673567776436 1.2236746112942067377 1.1738967771617034863 1.6259403562489238571 -2.8346981853973911569 -3.1623657375722222795 -0.092245663716707462787 2.1016968360144518968 -0.92583726812535027673 0.81194689254298435532 0.3361853027023836149 0.081737508123865793008 1.7533794452729842828];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
