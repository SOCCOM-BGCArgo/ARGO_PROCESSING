function [Y,Xf,Af] = ESPER_pH_1_Atl_3(X,~,~)
%ESPER_PH_1_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:20.
% 
% [Y] = ESPER_pH_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0511541973480413859;1.8656581752129643981;1.8654677525863700982;1.5825906672300942279;1.3317785483699431381;-0.96398410490084507352;1.1159801789097485436;-0.72128231675534071332;0.93372726328992261546;1.0881749870078585296;0.096066104961837456289;-0.099834476515314657386;0.082304230173184736441;-0.2857222903879851339;-0.90911098881517515835;0.79792788705633388435;1.2020453553991374829;0.66514149421216373081;1.4194325071191766785;-0.88464337340986654024;-1.2721911577156261863;1.2094019461239224889;1.7763547606717799976;-1.7050035924608397675;-1.8671435793389388191];
IW1_1 = [-0.49089573256058827155 -0.38378573292646644965 0.23738910129826526485 -0.65371318170104664169 0.99358229177099133267 0.078996162603957767456 0.87419142079071654461 -0.28713996468887054148 -1.0380409451381773511;-0.11326116777402422953 0.53247902535133817548 -0.006347926534731310709 0.26575036567282517286 -1.7448323626870905212 1.1907577494896568471 0.046873688083570216878 0.22496509199227990305 -0.47852916759577168726;0.1462774067166544012 -1.1239327974499373486 0.25045789125191991742 0.96850401424354348734 0.52824506844302077102 0.12988958171091552485 0.65691832938966310262 1.4517427389658199566 -0.28017954838468406287;-0.92223829321573203011 0.80918488414390310481 0.79676428657650288923 -0.763838029492133197 -0.62221737431025880838 -0.58301215724530330853 -1.0356178530672024429 -0.31461028321976552968 0.90163243413249749558;-1.0324316031658353765 0.61244998720420684712 -0.84061288804535327923 0.088625692782997200769 0.13959440500009687169 1.0767594690879715991 -0.09433233422386630429 0.59476250661757656957 0.20961321374347394175;1.2915272463310687456 -0.19962454983551311538 0.026726696823679653436 0.92591389862864925675 -0.15146652688446102242 -0.25144742652526558269 0.97927285900490490533 0.10099722086450255154 0.097479172668780700306;-0.94372771127036803041 0.37966156690627628212 0.56795579511412097595 -0.60653272784240341853 -0.03279052150296855872 -0.78341475362430723628 -0.029792676896477559428 -1.1324913857845504417 -0.54700205403402601956;0.40561103257547986845 -0.32629065786741073829 -0.48403146766540505741 1.1239486507375160418 -0.037332609216789686135 -0.93859755739184203005 0.38934127342171531705 0.80306541324682745309 -0.078674416473569611097;-0.88506514528097723904 0.51107743142097827871 0.91748586500845097369 0.0052096096732752580558 1.215728930184864609 0.31548030607006405379 1.7204807143135900649 -1.0533686909730126668 0.3090460027329548498;-0.92778266209877835458 0.19639775953616520066 -0.69541837672735906661 0.27144311197900677923 -1.0243008179316983597 0.23689230780542713806 0.34763061579068205154 -0.4556358832786337465 0.18805715134093159424;-0.17714322911039628861 -0.20004198421817720455 -0.17479622905809372169 -1.622236122210114706 -1.0266939996138484403 0.74759626013282864943 0.062621380435773935091 1.3306889623852002913 0.59412227829393704504;-0.1627684856080986453 0.67225491146636695561 -1.6438706819543269511 -0.021527770417510756762 2.0283292308659337522 -0.82331063615927768673 -0.024039752848656656403 0.89397516539764942944 0.16344887003063893194;-0.84925777920415856936 -0.086316933606942869428 -0.55862895155403058389 0.65673444682987935916 0.29737010318340151294 -0.35977985930985129093 -0.30561370233046375455 0.62775576231606577959 1.4199699503382774424;-0.84896711899934229617 0.20414376076250473346 0.42937286513136813104 -0.31525692038970465347 -1.7874403772075202479 -0.65330740071607473762 0.79840697034731977766 -1.0857790113051675185 -0.46952836817045284779;-0.48521733874226136152 -0.072211597866182405947 0.4582922282247774981 -0.94176982001870235273 0.65853107882049333188 0.60126578444058786932 -0.27750652760670546648 -0.74826841819128475652 -0.16416727989087023798;0.043227550773111654558 -1.0232059750809172627 -2.5920946986063784223 0.56085013924643734029 0.28119852132949496593 0.22389557008005922523 -0.068129766145379896947 -0.31426314386326426042 -0.9578761747921340497;1.3256049970580123798 0.56024887070966189473 -1.178372410973564266 0.38807191137499613687 0.79734439306142834702 0.82142739341516279872 0.22423616043363306383 -1.0631920659442586352 0.74688107527289826493;0.52736503496010311842 0.58088340253343406783 -0.68150306696815476926 -0.43686983007181839911 0.16780424059093773659 -0.77516847676029165815 0.33835422163250417071 -1.2208972052700144406 0.76477057737477882604;0.99897418419356143193 -1.1138311064654575766 0.92519769049396005656 1.0905509523793806004 -0.19242875773537823636 0.14532995460752975991 0.82961097452088750082 0.26288675658846655248 -0.80612702023972016008;-0.44124053434611759661 -0.065882490665261111973 -0.13822929294032762493 -1.1086458657322222354 0.75426174078173935378 1.3493963498071368523 0.61815523019812734784 0.45603564939706991987 1.0846343282478929648;-1.1763215446614212478 0.099858825334603384949 -0.67019567588075723563 -0.23985722687617969107 -0.61365334899438628291 0.72495574212483371301 0.26831763687614995639 -0.88944036639926415955 -0.67195544697603448725;-0.3074569896353978038 -1.0823497035104974184 -1.651697884847665998 -0.14654126664870967267 0.26539071181349804807 -0.075881512793097488645 0.95635555441532482668 0.24329410609014376354 -1.5304641077978824448;-0.26080205998267586009 0.77344538406038931821 0.78960845955836467258 0.050605926649497062764 -0.81630846231197995433 -1.5112660277476006598 0.8090674122624520459 -0.26688565263182956189 -0.67815105782607809637;-0.1199817700464462511 -0.53757577057252281527 -0.44628106331728278899 0.95401590673604597104 -0.35286036860231911882 -0.46613736151070500613 -0.77659433579779857393 1.0190022024284666191 0.74507173886480082547;-0.27946819322670207741 -0.44444629258179463305 -0.86013796976407930206 0.048212740767058934188 1.2190140497814967446 0.56026465222622101603 -0.41160812150840286883 -0.81461709426432815651 0.83330106430042449883];

% Layer 2
b2 = [1.6081788574152877658;-1.4598057228053435974;-0.91285164643535421369;1.0093259456391416862;-0.89251507813303332384;0.56137982533178865108;-0.24008436347977393788;-0.0082315666388098479578;0.19928091781590540066;0.48570592430930126238;-0.73094763340978852195;0.86411862463888744479;1.0331701900179723896;-1.2378220091868068486;-1.6060233935497278956];
LW2_1 = [-0.21522645033205919929 -0.72016169512912275863 -0.28672603048384553981 -0.16673820679626671915 -0.043483800326958636784 -0.030785515388142337123 0.56057972130612765405 -0.3030197050507054124 -0.21609655807929323279 0.21020633386109557894 0.46630309190636953787 0.74675477736986572985 -0.063987603067553910918 0.36734861082230813034 0.15738187264388892039 -0.38642052852338837354 0.63213548486750081867 -0.83067065389782424045 -0.098455404085341535758 -0.25764968225698520188 0.029025780672954925449 -0.90339671576139979337 0.13570636296187710279 -0.25204366961774915534 0.54689006820857855029;0.18113101614025856057 0.37861488497811768283 0.19728725231677415874 -0.44849078858945556902 0.028154656937822476054 0.56992343553369018139 0.17767741891481431127 0.23354434092371281761 -0.67167729563884703836 -0.21374957030746474795 -0.37660715394200788841 -0.79976802652640022195 -0.0088641289435585392253 -0.055584653564191371933 0.60776418552452526889 -0.053801772936933847657 -0.85798404978676223731 0.30139474975074720398 0.50383048967402943585 0.0091680799796703855986 -0.82385166662643571911 0.059821847515375052573 0.62718058934929299397 0.23603786875520624267 0.43924243988007111161;0.43814601375167067099 -0.035651368212114301071 -0.11483611407779172053 0.41910676955201170424 1.0002503094570112108 0.71079688564782994575 0.019445990480330660466 -0.21190793573527305638 -0.062641476719148811436 -0.50939924186657692395 -0.24518227095207509314 -0.070831683513606330527 -0.063034278553554090596 0.2694425181416890136 0.29629823378260977673 0.3238708589833976248 0.29437500697656809878 0.36664120900248059476 0.2135662707685238304 0.58719524551630508657 0.84747901412919013353 0.20038351222894829062 0.31380342531942045925 -0.44020475498647348989 0.18349651042103173881;-0.33232674555195246269 -0.05694507442785871898 0.50149199650626241631 -0.43186754923838011067 0.52140351930384631896 0.046753039024249577749 0.63799229559219283736 0.34046002255362228794 0.3161074137468240508 0.20335425162115378095 -0.34219712123214102162 0.32997700087075565456 0.057741440332580815098 0.3564865042964927011 -0.36480267631080598445 -0.06050524229704828949 -0.4606105436745915882 0.020423528291107252708 -0.091040567575840836145 0.073174832561153160815 -0.44317245399385585269 0.11449316267683146142 -0.3709982151012319318 -0.15134619509699720474 0.29472180547580956178;-0.091618975097401272878 -1.0633501920566912347 -1.0368798701831722919 0.43714439904866803088 -0.70164546121532189726 0.23983898795709790441 -0.39650792125943457034 0.21299239326126706562 -0.36603159676213364859 -0.96611633396133067553 0.20373258923532366893 -0.69736723206643325135 0.1707110965984314499 0.18042597004852153897 -0.19912015011575123768 -1.0906917065187387017 -1.3439014631562427038 -0.29379031944278061195 0.062007476761922211694 -0.39744316378955574232 0.040660910793547833109 0.24911376129699291937 -0.1998334650777091881 -0.16658498505424446101 0.39297541912623595861;-0.14947471856646143973 0.6480748407760639207 0.45216726174598331767 0.31247125939507558456 -0.34837155122363655524 -0.2111441770003387175 -0.36218168122003024934 -0.45526321532372132639 0.12928453559893621216 0.25435671989268288096 -0.80927417947555857491 0.7993997443353524357 0.13877153661751689961 -1.2765832525059519487 -0.29457306349055778494 -0.80751500808011800192 -0.028145517926935960384 -0.248044482106373948 0.86243207621284578845 0.13955389324905745352 0.10254256781148914091 0.61456343964544490888 0.49725733213175909997 0.21122513390941888289 0.11594906364616582028;0.4426937858265175274 0.22046398083323184847 -0.63024277344016566005 -0.49577272451481940729 0.54609900419584156417 -0.098847876364362194379 -0.082822085952698534794 -0.12307804107982681097 0.43408912212841777034 -0.26357693403305537672 0.49674429999693003879 -0.1230123742169479395 -0.17862909930293932592 0.015446090819238023767 0.5017722244393756359 -0.36382577281696470983 0.72063723189596073926 -0.36225874213071818097 0.045157865670243366174 -0.54452823352900725506 0.33487297664257276164 0.47444292729314785362 0.56339968645880844633 -0.026773867578812435286 -0.29139556961624552001;-0.19992084144725361106 0.33253602807420346021 -0.43077674869908400002 -0.026050213026836806229 -0.27806614538603763309 0.010867685224057311091 0.47614512223227206666 0.40551291256966831567 -0.59250509016160934905 -0.19905403333034676905 0.92626107159490111975 -0.5067723640276017294 -0.34715331195572779466 -0.72159768870267337881 -0.26967958190948021491 -0.78423798189606797049 0.18726436647067454255 0.018425170938397343601 0.58467893409246884939 0.47570536146814501599 -0.3870300266123280486 -0.81470700638599147236 0.25209465257108693015 0.50885461812087784406 0.26028061146386932689;0.029669098621114088632 1.9692909584945881285 0.043647835908522419901 0.3036587521976045756 0.2285121256940839396 0.20738632927175779108 -0.060460909226227939339 0.018809776338663732748 0.30132864929388769593 0.34086633169511382224 -0.28770782476128214933 1.0609070991041962273 0.42739583233780842342 0.16659887625188002369 0.56756328451795035051 0.88978051575043315413 1.0590522681692291496 0.50593565425917130796 0.44150338884000228656 -0.32766122819600596028 -0.12833212480150385515 0.92345043144312977113 0.28971450939943071967 0.16662448872096577435 -0.0065573444837659826748;0.23896112237653482913 -0.27811430436092937635 0.24566723046997482327 0.64306073984675105049 0.25472072640338971894 0.43482700495985615596 0.46581953150927996044 0.50237288254461631709 0.1665936160016772416 -0.45903387023833719383 0.89691145661912874409 0.64418018228478557408 0.3250858850532387101 -0.32575116744561211091 0.0077139823196138868761 -0.17254202954834069184 0.40100515356942717515 0.12428673560907714524 0.072131017929114429887 0.5097569683501650406 -0.18921300986796243948 0.59494017533643517304 0.43715144964682833839 0.098201644141930041765 -0.28415065672670458685;-0.38796418271125165944 -0.29629114203480483303 -0.66841398212201563744 0.24327355106915876659 0.11856309385886748542 0.19295881503394568535 -0.1440223810459822229 0.20685665221087057297 0.26323886962957349089 0.48306107727720276612 0.65784657988493921987 0.15310949623162989353 -0.39256492502126494326 0.29046029878322077167 -0.87138803492487948432 -0.57276914159943481675 -0.27964549991875509161 -0.035348368329284854394 0.26924492115964204775 -0.036545643847276931826 0.86976786090978841504 -0.44985851556091505099 0.47351139039385953255 -0.55036338912343074625 -0.16594154797902407883;0.32638847943056681356 -0.29840149537916821343 -0.19902719547267197497 -0.11179274193434927953 -0.35396614021278061113 0.26473195669781696138 0.17772936284122678452 0.039421571075803796269 -0.35353605680791383437 0.19241161315111404706 0.070006230425400314821 -0.51947475471146908887 -0.12067206860607210261 0.27460884286174080948 -0.4012746545265470921 -0.77942442217405771832 -0.497216752948891616 0.021258378117634105231 0.93625556011951738267 -0.47399265216961022906 0.21862253446533297385 0.0024489099337367597684 -0.3033784744083801721 -0.17992315023819052677 -0.51523808230997347746;0.34041246211200176797 0.61802943251985353879 -0.18609948400266182467 -0.75117548237847708847 0.085887887277859065183 0.22895325643673902771 0.1186731460751663525 -0.35134709933423419193 0.78013233843329132799 0.098520075278147906106 0.14989532816518408298 -0.13034883580560951977 -0.071556245129272083583 -0.79877571231424837617 -0.11183413260858740546 0.17082717152887635925 -0.26376223241319263213 -0.099084797145368788684 -0.07870022864493313175 -0.11811400619215067787 0.29681638533772697341 -0.28838634167205218217 -0.19523266156244700742 -0.36829544491975563236 -0.091358909049283509862;-0.26172053836265973814 -0.27071431846716415004 0.079097774163526132774 0.0089704366759911606521 0.32474715184058977613 0.18262787173465369617 0.0068176557496941242106 -0.4812191352231871555 -1.1916675963721707898 -0.047004725117081834485 -0.28096461563045294074 -0.91546337102365216154 -0.22476501370912105315 0.28955348272204900484 0.43116185837026715921 0.50437377906470071132 0.071316843935173346303 0.28117642970713213613 -0.56345419372015237425 -0.16739124477584793604 0.43474926969183913528 -0.35480206715848594534 -0.048287052244455674899 0.43810030474743150153 -0.36142095285988407039;-0.29095509036022049187 0.083871863776849964189 -0.22327614169642276409 0.44847142343953444454 -0.38940462032547701332 0.53111490743394251801 0.15014264189169168606 0.18630099889108833744 -0.66006811825738564981 0.61435680111485724275 -0.00023106592197046191446 -0.10471392826752976002 0.067549392278056202832 -0.076143772699028486328 0.029919173735046163121 0.24375388707339473715 -0.34032821898132958882 -0.039828985730652223529 1.2522879157260449201 -0.032432636736166753355 0.10339855728279510882 0.50044610485848350923 -0.21498483956190153621 -0.27499790050362721283 0.033362520574199736045];

% Layer 3
b3 = -0.89547699023864946177;
LW3_2 = [0.67850095212731909022 0.68755959464453675345 0.74668292306606653952 -0.2991972783433657912 1.4241143631223152077 -1.5291273181467588405 -0.83991880783051997561 -0.37917055623783973983 1.60930993423428359 0.88413397188281794836 -1.0938965441412864532 0.72050204358340996791 0.71741418079836616339 0.87939287488843920215 -1.5079595309389752789];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
