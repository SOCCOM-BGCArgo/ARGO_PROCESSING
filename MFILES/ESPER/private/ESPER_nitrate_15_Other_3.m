function [Y,Xf,Af] = ESPER_nitrate_15_Other_3(X,~,~)
%ESPER_NITRATE_15_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.3305989552502683892;-1.3370945499581174953;4.0899243191328817915;1.8917558583953011375;1.8359256931484941866;-5.581518460979898677;-0.46468832903580964411;-2.1075404397682873103;-2.4534473920401853597;0.070219705218153627424;1.2838351588047995921;0.068954200383662192508;0.84215134095401888992;0.035670724886734672676;1.3048787406850732573;-2.6717004392717607075;-0.53919546260330475373;-1.4598325454896949882;-3.6800843409459118583;1.8690716173507864184;2.6577026279678577225;-6.9684479194218429399;-3.0663982035474721677;-4.3202844372373370163;-5.546051182145165015];
IW1_1 = [0.18063390305943669012 -0.22946574367642738612 -3.761808046726403898 -1.6103190904920969828 1.9258587553370900558 -1.5898765049032030916;0.1064553060068019058 0.01844636914186292137 -1.4327262172920487426 -0.019569016076444772229 -4.378428213876602193 0.86262844598232091275;0.2311032949993656882 -0.40954494070688152174 -0.75598529064988262416 3.3474472006089213139 -1.7701115532204196867 1.1421321011389351519;0.17026181099394613327 -0.1340788009075908338 0.88368609157434929724 2.3913643384103542289 -3.5741237439635162865 0.50521428869950291141;-0.82158445493588116992 1.0473430917344528357 -0.70147081787638787542 0.59088026831030604491 -3.102710335804999886 0.13921534406037872067;1.7400982344977546923 3.9043656007458000801 2.7989932234276881928 -0.38873446181784404585 -0.76921698359771717435 0.025226033157301534782;0.15647898657021858115 0.47159919805917771551 1.6857308036313582988 -0.18175985897731525287 0.85035677177533575133 0.7319854178116672605;1.4423883404926025609 1.6786336311859018089 -3.1905688807996912537 1.1806486285350443755 -0.21126006883112241619 -0.39125081739681399906;-0.29157794463486963465 0.61558427525337566788 1.2101970166397608697 -1.3801502303740789124 1.4103719058023078681 -0.94913316422229521141;0.36808851408173653974 0.40777514062351216673 -0.76166412947860573368 1.2262518597155425137 -1.8462814103273099686 0.82731331105346295196;-0.5145315387797972928 1.4847641708757917112 -0.78485980058173632212 0.6620620729597691545 -1.0101882896689062807 1.3892544148844629959;-0.49605250502794073775 -0.43770042618399240819 0.67506457234526662248 -0.84412118291618143395 -0.09044938244565854657 -0.74486199290643506643;1.2997071622105336175 0.58153531128349655877 -0.81731123064416522084 0.30821118042068734733 -1.8510610070937227878 -0.6307681410949070866;0.44115848255847445181 0.3675074606761875029 -0.53708714128655032916 1.2040536043117313625 -4.8015429095046053831 0.53815298446311277125;0.32485435686624392071 0.09165813091941342472 -1.9594656482334096292 1.8420451619267004251 3.4102228024802050399 -0.40864284479243151438;-0.2161342417970918417 -0.17405611441486723567 -0.39973068771388159393 -1.3863070128105476897 1.3440792704276161018 -3.1432770215135357184;0.25135645658334798691 0.1128253929042373066 -2.1429762906322360472 -0.44471382218787725016 3.5864321410454302885 0.043904170475251372285;-0.47930886303029840434 0.033640361764609320872 1.8488965288782859275 -1.8737368383968118213 -0.6567201358453028659 -2.1209521181289607838;-1.6732231575216134356 0.38264059257945232106 -3.1248282715150472733 -1.3656720773712751615 -1.3060392921335826077 -1.2318073805470977078;0.40951019378687381067 0.66521205842642239237 -0.030587413303896672512 -0.59581891614831117288 4.7136722580486107859 -0.9862030457608177425;0.43700172514135338098 -0.06635111981749115817 -1.5490385144463378886 1.5805903472714653013 -1.4576581355120461492 1.0617082482818802625;-6.3670478622154362824 -3.5165943376291415312 -0.79417813692870742326 -0.83591858287677356376 -1.724895522267669179 0.013849476480874478579;-2.1680966997598862811 1.450938806597680264 3.9352393435351515905 1.5012405800423422875 -2.3158794741861301603 2.2670349115649695015;0.96290048038473907699 -0.60345794666503449477 4.9476473758038963524 -1.2367681798522378589 -0.068918684095406496093 -0.95370987537002183121;-0.29875365854138935529 -0.86466723835142722532 0.7465084426088707259 -4.290620222237605752 -3.7020505307661109029 0.91713622027799091008];

% Layer 2
b2 = [2.2091295282411511636;3.8292457584753871735;1.5284832510435959474;-7.4276049992810770917;-2.4946160331023166101;2.4834737481669160175;1.363845823964151549;1.5178178621511373425;0.88250085221524410262;-5.3061256024838732159;-3.0553230305129441824;3.208185688089423504;-5.9134059330893942175;-2.7764053604937108943;1.9201456311120561615];
LW2_1 = [1.1318613081214066174 -2.7269280742318482424 2.6027747809117225408 -1.0365377755226419243 -0.35195893888773033265 0.23866804089940138467 -1.7831713903395505216 -0.8999178206105555855 0.30150817578139416097 4.2078149117087395581 0.37202307828768055309 0.87276816165728776653 0.021542886386030184187 -0.48496365506261712719 0.098462710355401814044 0.35332456464674732999 0.25166650331007600627 0.17300556574914258134 0.076143854504964525454 -2.1305928056166170137 -1.764582779363751186 -0.029246255526761921056 0.8583435749357088973 -1.5615513879064346625 -0.43529521900481632501;0.40129432769004991233 1.2182909316604937366 2.1525914661604668154 1.671769939464723409 -0.80566022805004278151 0.026539879006687687457 -0.86647332314217617721 -0.32684887531577716535 2.1586911945637461407 -0.59622424727968270641 0.47342028836242738832 -1.2920849832997010065 0.15397809027427886153 -0.31946313849697488552 0.31568003901209340523 0.35979944621996701182 1.2311178146742327577 0.59375443923214543673 -0.16880862590075462748 -0.39233025322081382935 -0.42177188154262923447 0.13238774560059032859 0.6360644325748039396 0.29034331886129288725 -0.81026142857340033299;0.6296339051161875533 -0.21809892163641914076 0.15406315141513554634 -0.0037512453291608681069 -0.41953521581806008101 0.12259562694202812139 -0.40304605152719913397 -0.27789657620316077224 0.22930737829195241284 0.74705656521514862689 -0.021217292929699423792 0.17743716597016950809 -0.49888297426420641356 -0.092566278560124393149 0.19020007040153338873 0.2880913263498243726 0.35990402019861339467 -0.32323970355629377815 -0.45203650507358772437 0.054854424468293298822 0.96260338885874663362 0.028950755529761378754 -0.20697999502446171038 0.3398935703813567577 -0.11277138344455170382;-1.6520637529174053704 -1.338950981563584719 -0.028637282257980203187 1.0076943301021543675 2.3171234369578366241 -2.9071403650749174652 0.31773491416866939119 0.54206717915898361415 4.6787374745707150936 -4.7861849477677775866 -1.858514092047366173 -2.396591515471282019 1.6746559651642343169 2.2578091970365181673 -3.1938361446556267076 0.94990717692685555651 3.953165866080007973 -1.0341284282407805506 -0.28554793212483126075 2.3001297690461632861 4.6316960732054841543 0.72518257729269064438 1.4619177876084759049 0.4477268815479606423 2.2977124168658291659;-1.2057162061217947535 1.5956083245186758468 -2.3821210377141133208 0.26606486531851664123 -0.4979238569168278894 0.92969625637804609308 -0.54772415466043467003 0.076810689160597855896 -2.728871759464783775 -1.5728111855156374776 1.7331090226064629345 0.43961841369525322953 1.2232956643743000402 -0.055955947881826804957 1.1238013310263725852 -0.53390917081711453118 -1.2480061927511516551 0.053706581966060699951 -0.062791061674037501605 0.54745619274068502147 -2.5623425707487270664 0.088129072603673738739 -0.51082597481016778218 0.71614733716481604464 0.17152980172932441594;4.7883362126364268363 -1.4067334639413158204 2.4772170781921425409 -2.2054801301533810687 2.6188296052374515632 0.014165545716602827298 -1.5642076374590290211 -1.0154821445545749725 0.7882182234229681006 -2.2926653268159657983 0.18672404822715416017 0.3970182532339885384 -0.52534438949116835094 1.2649356353747029935 0.96912124030747692771 -0.43053333795220577462 1.2222659781522309252 -0.34609361919945386132 -1.3565413844649212294 -0.73686825849591852666 -0.0084033682142852852981 0.31494364994476459207 -0.73350200677130916738 -0.68184394845591733691 -1.1363950318928688343;2.8137777665265328864 0.010255665568930011355 2.0816315522729209597 0.27592930742180160619 1.4332704319072284704 -0.53391482000897938498 0.29379614912006646321 0.33432588790859635308 2.0099216889806870157 0.5728272890986657595 0.028087936213289692311 1.1625749006542684949 0.77114438136655383271 -0.33562152758244667705 -0.22239093054899400359 -0.27184549612131836405 -0.15167144512247515697 0.46229854468379205645 0.19568216246393682622 -0.15859845747823922424 -1.7242431183138224871 0.026519011393425988288 0.48152403739497812163 -0.66539989122791520781 -0.10895296217826028196;-0.0078921581567942319241 -1.7416319644761957264 -0.85082861566106093854 -0.42950799820148144459 -0.98933590271627369628 0.11302379130873567437 -0.83234069046349579146 0.28610916059262303524 -3.4984807424365786943 3.0020419098294697235 -0.2877762741080343023 3.3360724628696782901 0.45673858432990643852 0.31411528667063409737 -1.5535246279987147133 1.0250095483936279006 1.5211704875006177851 1.0353151401992388703 -0.040851503640672567896 -0.39966443921480554469 -3.0359236988940376811 0.0043801522229170728254 -0.0361003871243028851 -1.4624859360755475546 -0.39288929393950328128;1.832342805624051385 0.93402240036936101664 -0.74513287389551075002 0.69031725438749413915 0.94740124956076932072 -0.15821881043536881184 0.72083117602453616879 0.008309576884590727866 0.26199479044386075888 -0.95281538618627181769 -0.027834416221142601472 -0.74198793691065401124 0.030523882076296155602 -0.23625731261975038699 1.0462812440823450189 0.37750100950279885659 -1.2877028869049675919 -0.60410972253412442701 0.16424877488056296992 0.76880945539274325728 2.243823002898054586 0.002432607242689670702 -0.042795130709747115916 1.3880280652753629322 0.27550036789132997805;-7.2280327118920171259 -2.640301824247933915 2.1683441632766657925 -0.56542330072493962589 -2.5137992769139798632 -0.50668975053716969192 -0.33671749338496309578 -0.0073942891885099386318 4.0768597526652126106 -0.49497265848320493031 1.2020890146844356305 2.3735692146246876177 0.56927810685573909666 2.1366962142653336265 -0.45430401237972856121 1.6469041767549561506 1.311772296531069637 -0.67935765170444339933 -0.37714033954586229092 0.62001338007844952749 -1.3185203677919212772 0.10121401592057840957 0.45014655367473910275 -1.5267187299872608808 0.33389669469171695537;0.17533262665390858537 -1.2104245837360039229 -2.4498285745337344821 -2.6309351138368124445 0.75263706506960803555 -0.30382325979036756136 0.024326231965712048766 -0.77523991095465116796 -1.5707410113353144077 -4.946870687299036895 -0.37872367647848242944 -3.0071405340358321467 -0.58070901366375260455 2.9740169258267137309 -0.80003073612715858154 0.86451222681218886645 -1.151174909341112329 -0.59592067884291866076 -0.54409570622518099725 1.8315116096706196558 1.6163125206732606998 -0.066019746944756069196 -0.12534618531670552177 0.53590817805480106539 1.7327884521526220052;2.3744873894348828003 -1.573720419393767278 1.6708969459952900394 -1.3076501855801063723 -0.33200520604958416726 0.49343551794816281619 -1.3409879135084852297 -0.42381500512179498541 1.408283228680991428 0.83232170093199897565 -0.13844077052768588576 -1.2156682976777832828 -0.97072530711033599982 -0.05017828218076120228 -0.11303640816451256124 0.12908356194393649785 1.124071101446954879 0.56782239740370099579 -0.67572671975577691672 -0.68807628526662689694 -0.3779022795666614476 -0.011653579869201253355 0.043794009640040022779 0.24902708192064124115 0.65040302598194799089;-3.102118220955715433 1.8702955795825639829 -1.9328173455417545501 -0.25076017267655265064 -0.34082234575365710771 1.0790930680042420953 -0.61211897025252126614 0.22352947749648666154 -3.7194747682049444926 -2.6990365573516306164 2.1012984604355420259 0.53702703562370845969 1.5999015879676596885 0.26050180227687047552 1.0996378286348233999 -0.48731203603296657789 -1.3688071531177932183 0.072801582856387728193 -0.42428293229215502391 0.77892736685818175779 -3.7292390369082921708 0.19851063049700115593 -0.27569345190289551439 0.78135662698703756135 -0.35279601393296361467;-2.6425515531260428403 -0.92065813249366068582 2.4238523227117281245 -0.70813212008625425753 -0.33083199011265007616 0.15139707278271549717 -0.77088855304807457625 -0.10130121974107306193 0.64610156800128093479 0.50793911847290951211 -0.21548973627179732193 -0.26850389928914086823 -0.29074333539635777157 0.0019516754367678544602 -1.0751200385370947021 0.041038477486877097955 1.6303234949428322409 1.002647935972409643 -0.15901533699539355249 -0.98309187237846307195 -1.3043185032631929854 -0.018351742561701349377 0.018748949099707500066 -0.94800022656824678435 -0.55442840286976724506;1.2981781067966473575 -0.56296492283415533464 0.42993455687956549927 -0.29727426131911710572 -0.34549692899150519221 0.18726453766531320211 -0.71702735589660671067 -0.28456142835376996292 0.46602631100517927232 1.624430024817596907 -0.066133688912278151828 0.67978823277477473663 -0.55102572268473182238 -0.25621333258207468209 0.10545860629515374507 0.27470122339042185589 0.29804132207130157317 -0.3769118721296176866 -0.66190078010012032284 -0.1000064622933637265 1.1320329361853014305 0.032612025580349368603 -0.19625526058306819177 0.23799311373099871214 -0.09382010626332411285];

% Layer 3
b3 = -0.50844452565946063327;
LW3_2 = [0.7686692857404910928 -0.82560301890343634756 8.4170090706403009051 0.4018935907882332792 -3.3572422632477407767 -1.1856759292371179537 0.72680620471437751284 -0.57459695814779632173 -2.3035694582648220674 -0.31499357006546774285 -0.46403485486522272341 -0.2949187259106468284 2.830330878679376827 -1.502691562683589499 -6.362807891501698343];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
