function [Y,Xf,Af] = ESPER_talk_16_Other_1(X,~,~)
%ESPER_TALK_16_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:51.
% 
% [Y] = ESPER_talk_16_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1518999376762782;-0.46896510169269412;2.1641615568847468;1.0912440017713372;-0.5021089848251038;6.5129725815126935;-15.13350113345251;-0.17087289257144195;-2.6918396092473218;-1.0084344964041732;-2.2479228690243853;18.211952946364125;0.21059371527247003;-0.61560468131123136;5.4247567434864941;3.0176069839648036;-7.2904037493024862;9.5574624929988961;-1.1878750782543368;-17.020492758638724;-0.058478942353391593;-0.85053508733025229;-14.07696137080462;4.1129930989639352;-1.4351307625949106;2.9984979786158097;0.51477506616240809;-0.44730014970480958;1.3132549212052183;-0.52496611998011633;1.6603408631292667;-0.31179064109734944;-3.0442861106700163;7.9674400669057723;-1.4213523922113032;4.0314448177767481;-1.0781315895320318;4.0971694479617122;19.62347267401363;4.7767747716050142];
IW1_1 = [-3.9832018134160787 0.21246535375580658 0.70140201834917337 1.2748637447647622 0.72002497518716768;1.4370279999274422 -0.1350206941937529 -0.093571288206000039 -0.32269511729833672 0.4438836481014829;-0.18145409765997622 -0.42237437026493679 2.7409991729085204 0.79620919708559346 0.97568645030173584;-2.0240517654573158 0.73778003722816987 0.02431091662127885 -0.62793222543633187 1.2154523096150482;1.3690704395717557 -0.29772679692333515 -0.088194469784423274 -0.2765279139086142 0.573649244609582;-0.077989697925543708 0.70227429795798813 6.2526775153266749 7.5897329114368892 -0.38182836028196654;-0.96755167887382898 0.24098470309418993 -1.7979420159193842 -16.528045953357534 7.1382753075291614;-5.3859396057706563 -3.2327760243241035 -1.0544131787129285 0.30119114391913548 -3.4952599244441527;-0.14124788447794412 -0.069895605493910884 0.48211793414490084 -0.23462785954934395 12.616030138472532;1.8990681748840579 -0.68831421867223153 0.071940118827573146 0.62065940192631719 -1.3192479691122947;0.1825089318783501 0.39828529357128944 -2.8356379586971499 -0.7723327449030406 -0.92576971092333427;0.34694312313527337 -4.5290167937847565 12.090853974046853 23.835378751222194 -13.734004878677343;-0.18688015784170561 -0.25975752919845962 0.84313980525489962 -1.3204933690549787 0.43339352376066065;5.082888259188846 -1.5021226909507499 -8.1191237522501538 1.584423342272256 -3.8294074351212082;-3.8749709606217353 1.6237576140780707 5.2177413306530633 -0.68547999289503136 1.9782605959912687;0.12700944535482395 0.065079976637258174 -0.45365733680356513 0.54725356611432385 -12.693295120885105;-1.2308761377614348 -0.013155279613713601 -2.3126096624555239 -6.7954535452086491 14.874109890053223;-4.949921633650388 -8.4972992345763831 -6.4417931806412918 -0.18156140985237296 -1.6710612738895441;-0.80812570374382753 2.1341161748513224 -0.42909284568473999 -0.97750419979887859 2.0297273839705161;-1.7338870645672588 -0.24855356602322209 -4.505500942153648 -19.501814600358877 13.94344792873455;-0.14996803972405734 0.1415299219751035 -2.4643525191935964 -5.4721767170690097 -4.2006444932493512;-0.45527378179820649 1.7188441336365194 -0.25756293185988521 -0.96497961990782788 1.7578127822340586;-11.513291623580672 16.20695249357156 -11.631206103043914 -0.53930843540957185 -13.56212452047887;0.95806749847560191 -0.039446910031875865 1.0103895331795383 4.2960795951317907 -8.4017504660321585;3.5308015817603997 0.86672221382517767 0.11058394652885226 -0.21056953080982485 3.7902362895458319;0.02264343546058006 -0.2761259571043993 0.50332435615105087 2.1373424716383198 2.229597550871929;-1.2891465680263399 -0.22685885815994183 -0.16261769563322584 -0.11048775260930258 -1.612319142049504;9.3391685378356275 8.6734860224691541 -10.332831981215653 5.2857457789796118 -18.541048679428556;-1.6610410813923491 9.6192354269160276 9.1692213935107887 -5.8568969721236073 -8.6924432676322372;0.086620703984762182 1.0953401830025045 1.4968599554328006 -0.53271512479678584 -0.32554606917036677;3.3666536478588007 -4.9391244726059069 -3.3029629186425997 -2.8917391463092481 0.46778018448651215;-2.4516156777706204 -0.70239233055981609 -0.27058979241943831 0.0087333951580123321 -2.0231753737200115;-1.3312629596480947 -3.143266871665928 -3.2298545818963134 0.80436193724042493 0.15160790290139994;-1.7509770080178817 6.7581520360381866 8.9757329618739998 -0.46250293905087764 3.3842550119030301;2.1575117885544528 0.55198222014794684 0.23106081518725824 0.10232187870912479 2.3677868955005836;4.431473922838582 -3.0533828979684348 0.55494832145460149 0.42012952994294878 -2.284264608772987;-2.3700076222051254 -1.1160162104803497 -3.5829785050270773 1.3035399968113355 -0.48403853686470072;-0.67219203659151949 0.1934011677209844 -4.8047896354405957 3.4323154888990035 1.7732225080448223;-7.4036850388370885 -16.084759612813059 5.6407238870332055 -2.7864240597160745 -0.4823142841257182;-0.46682259224470724 0.33452493175496689 -5.3607986197020043 2.8564097743638057 -0.30051615582246999];

% Layer 2
b2 = -0.4037695456924642;
LW2_1 = [0.15859089304067969 5.3006079739937677 4.5747736321674841 3.1269717189832389 -4.9064017796896788 0.051058545518501162 -0.049410310052850799 -0.075989450442715739 1.991365041103099 3.0616981473747447 4.7519118957705153 0.024478382058322541 0.7387893466520381 -0.046310511871946292 -0.15747470176143966 1.9548431855826267 -0.12083290016056832 0.085400133257734642 -0.48145121811457697 -0.044080799297562687 -0.066179948478742784 0.59645941340725561 0.015656465795238234 -0.15933565446117506 -0.6281579782394866 0.32665244942461674 -3.6895274222488919 0.022126643429986 0.027706877859218295 -0.37906144709991374 -0.017786738277593896 1.148821616932318 0.097602766754019923 -0.075002099244751666 -1.6666286093679628 -0.070709858480851512 -0.079560393449057132 0.29367340245836798 0.039143328021204828 -0.29343602304896205];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
