function [Y,Xf,Af] = ESPER_nitrate_5_Atl_4(X,~,~)
%ESPER_NITRATE_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.105212278426687178;-2.8444314914429740249;1.5583012985032440589;0.44509523125421929235;-0.48296354679752967476;3.0827014094484854745;3.9634056587829324947;0.27873943727378347468;-0.57757171253677475065;1.2680718961758570273;0.1326274084676950793;-1.3665891004046917256;-0.47135429566105291332;-1.2702308213185649066;0.98416640928065901583;1.4963313994242706251;-0.6676802441166221902;2.1106395933702146728;-0.32822817492366651582;1.7220604832745853852;-0.96581948576860510158;0.4605452680699814727;1.869381755979283577;0.43448645464808027805;-0.41879261510962056958;2.1621896786157153159;-0.014402478135632668099;1.0061993059962044406;-1.6380299982158652572;-1.8740656430786208908];
IW1_1 = [-0.39220721444947426182 -0.25735091184729164127 0.19527098707516696297 0.52486900591001028893 1.8568380369846686495 2.6184155991029918198 0.34737319800683413851 -1.2778836877162729202;0.95524535109033925639 -0.68291935457414143507 0.45888013964149099166 -2.1675617440422478843 -0.40432131677134280912 0.3825026370220198646 0.64724371474961073236 -1.8873800528034143653;-0.0085098281556182757412 0.17406570582838348793 -0.64275061243036868408 2.0057455804409705102 1.5690909010687812408 -1.067259439020989964 -1.5471216500714417563 -0.16284499031328375507;0.55110299680428620483 -1.0341625948679873392 -0.43956020215312313626 -0.12102074722572425669 0.83657594970119164568 -0.075153994354344721973 2.1584602582281369187 0.41414706767654402286;-0.26409815890512589043 0.64077982704834368644 1.8748841815015275802 0.56911874391982308907 -0.92335859036064960037 -1.2569292923705188691 0.2734433440828538675 0.79747995825847672879;-0.59121040920188971945 -0.29476723420744482818 0.15991040412087850764 -0.26762896892994164633 -2.2315880915005252838 1.6239656926333019271 -0.3638411856153894175 0.37828793479470040895;-2.1508230625267006353 -0.72947418197094882064 -1.7154793832207728688 2.1582640421476408932 0.10385735960862958749 -0.61619013027458113818 -0.48091540625496331796 -0.19747463611461760213;0.82250810399274898455 -1.379587465841917604 -0.19510538123961701507 0.4706432503640144982 -0.86025375983405250047 -1.4292228083570037711 1.8765268123897789199 -1.7842171684744978499;0.64631144496317016745 0.35553787927532071178 -2.7727348520401831067 0.31175267040232418347 3.7917799569570629359 -0.77252539976707024216 -0.15236694130315792117 -0.92468992612098421802;-1.1973377029523661896 0.25253476173938060878 -0.94113061935471153951 0.093968389956069695024 -0.46304164729216412688 -0.85618732746311909665 0.1919880270301330405 0.91106594985027278266;-0.49669952458547667051 -0.26594813125055022374 -0.041070613064247731006 -0.30646821371516758115 -0.48746902417063942003 0.60118245399452852062 -1.0870827527294566472 -0.11626028866345498869;-0.25992423861611496649 0.19669699041480237511 0.69269647377040366454 0.10382580215840506166 2.4107177307174336711 -2.7063203196042349141 -2.5272019205180056289 0.037279831490604119215;0.98557981456855336955 -1.7515234787401097183 -0.042218836589480890353 1.0841204102177082191 -0.17699984003327440263 -1.7307792102162069536 0.87114911969165509387 -0.97154105494043652147;0.066266267433313069679 0.49153955453702230516 -3.5420257569987034785 -0.41926263457259499434 0.65778398483618105708 -2.2208409438817975357 -0.7883330933213493763 0.5960513087627793416;-1.2530060293315008479 -0.0387465346373765257 0.15692876272073974508 2.0453196474428723128 -0.93907022153380981244 -1.1979790352261239228 -0.23540276584300987017 2.2148170405726901322;1.3406663640755493994 -0.98629082775839516106 0.052900295209971380517 -0.50900967196630308997 -2.8737185667522675558 1.4692260123889484547 0.18529318243807763045 -0.33927306102439624969;-0.84237173244612362222 -0.025938271662116204469 0.8946735477515144197 1.6848664062763103466 0.61378786991792411154 -0.99656198123036177083 -0.84433315083878879292 -1.782292753593179846;0.39884706233601646685 -0.23667209508356301662 -1.1845387913126053103 -0.026518583240519491562 -0.91360006619219424895 0.93151905657203937228 0.6659312137908971474 -1.8996360786434296486;-0.58476076028106516169 -0.27792656175179081268 0.33474557245963459939 -0.73170938336637314503 -0.44445960058593836361 1.459367458348968416 0.66612516382576014706 0.32829151172937998115;0.75690017181052959838 -1.0124424372670759453 0.54754011898515131396 -1.3090913760099747165 -3.7095979480224841041 -1.7940137423119841831 -0.38390521427959345413 -0.076715015171301803587;1.2444247855637049494 -0.85926796118371251421 0.20275087777037967274 -1.1423983355287870012 0.14157391443156308597 1.6852521614329856181 -0.1350485923816269751 -0.48693984957184260898;0.69422480302665701135 -0.66863356884972946492 -2.3550581937978356528 0.60777746268597276913 2.792680542016594103 -0.24276397210450414987 0.48920225226597591206 1.6665331741745981198;0.41279946758580132737 1.5496768552646333905 0.09704389749384040309 -0.30441971347904206446 1.0784810116634828692 0.95235360488267639667 -0.42469830849545492368 -0.27242533375283051189;-0.70643999489995590313 0.10578958764463476661 0.13774962160744333439 -0.055026756530825698954 1.0954746600315174998 0.4548174522830445432 -0.10873230363048248803 -0.3880551655985785553;-0.52222703568575845612 -1.7502899917155489984 0.49487089657065957971 -0.35549737425717847783 -0.45657048669085714687 1.8262975266119867435 2.6024493522016096669 -3.6547532216560671969;0.15106994981304530667 -0.58802016971922221877 -0.049420366113275562836 -0.68107316140632612189 0.47994264681204334977 2.8086994517801446847 -1.1728590327053638465 -0.043819405228815430653;-0.84111880905510205686 1.0194715177002287021 -0.49206530038692553042 2.4281382633507728741 5.5605654784927285306 -0.58289117439100646134 0.21141657863009186147 1.1738695882390799419;0.10753870295843116767 1.4136448766812290678 0.94690282366810074599 -0.657844947999201346 0.59418155418329665629 -1.1260669198156447735 0.065406592241513017427 0.89925734575533800008;-0.0510291852461900175 1.1519540560750392011 0.19198619017457410618 1.4453560156287388327 0.91524879987863450026 0.42022166921160991615 0.50297204628309200025 1.1737737132675212237;0.98806226363203031315 1.6017964396513106884 -0.4242366795202577312 0.094657692155794712074 -0.90297928293953533263 -1.7241172433512104156 0.37624301270785270868 -1.2138029019565061972];

% Layer 2
b2 = [-1.8057114829098197539;-1.8485188448833806962;-0.91849745147813655066;0.4299917074056248123;0.54906786959106546053;-0.26608840968776409364;0.090380554322842268644;0.23735496417580775885;2.3250127146994232774;2.1194428822030979553];
LW2_1 = [0.77605121053445647039 1.8001620557930957389 0.41246759911372010698 0.14885921658912809606 -0.54024268903969441258 0.37655707654004888507 0.067908688189153881831 0.91813955642338362928 0.60408239967499188783 0.84092964546045023688 0.082332119199486242245 -0.28637062082079900449 -0.0664588345416851356 0.10077755354572791313 -0.76178120692291539928 0.72882640603477888419 0.36503214523854904394 -2.0318514143386776638 0.7451742463139763295 0.62923168228625592224 -1.1157601081383692332 -0.090339214477891630062 1.0837769914038211105 0.18579246478778876916 -0.77251910120887679057 -0.12110169244374183184 0.93190636298728135589 -0.034500998364416099462 0.94269203437997328709 -0.30746912858498415266;-0.21101872344318919894 -0.88986419622819978859 0.60273790520862446929 -1.0163126682322638494 0.95071558334384920208 0.55023041535829853022 -0.8210844242138376492 1.0122590437267189323 -1.5848225911740212446 -0.44209188522095416163 -0.19814030790564526874 1.4800364515811006427 -0.47152252102194486261 0.66891964019752414572 0.88069735945818217182 1.7243192043664943292 0.39777681152499938522 0.84792452528131145861 0.45283836140646627211 1.0180411401912483615 0.51170536251072196166 0.73438961612605702101 0.12075826786232503329 1.9263386222639409251 0.43419177827937555092 1.2998192660225604822 0.085869673279426420032 0.073189007065762923254 1.2507625498811809628 1.4138570780113821623;0.75688438304782601485 0.72781817587175878792 -0.74373504602845275091 0.24666634567762907304 0.69653265220113180778 -0.64445931063233119485 0.61977331404314817132 0.38995885085261516867 0.5728497502331215685 0.23352341811997631704 -0.55530952235832231612 -0.38486834259160002114 0.20005109539900856053 0.28570634896092816923 -0.11104854883374321028 -0.083090866773272792356 -0.52612122668775362921 -0.53391671717222455307 0.20774835151434065117 0.33285574473738238632 -0.29344406791010074764 -0.72582837876715866621 0.46255907312578087298 0.36384741711670504083 -0.55949664536133369985 0.71385929857509333729 0.172458586202890507 -0.019723447236456286696 0.4655640836430128271 -0.33421313090718274275;-0.70264091578467269272 0.26796735878514871265 0.43449279376221539017 -0.9281423717283187047 -0.16814077959960255226 -0.26038195083683302045 -0.26242034169713762681 -0.2436436228146091898 -0.60672229116473297417 0.18218965962669475545 0.68346329739611944021 -0.32129084614738728787 0.029623542592306466997 -0.29257611088989282644 -0.24877371370965020714 0.79272418726632043473 0.41302499034808087819 0.23216977146182180003 -0.45304699190619673876 -0.23398508060565786915 -0.37947490357765689684 0.95100247355261313675 0.81279168335801310619 1.6973220331933280836 0.13624521842107920055 -0.46735153597567663519 -0.50356408579303979511 -0.3138786606420356784 -0.60026409369246847003 0.21626124711626001917;-0.97768272520746557497 0.43740420549212749579 0.082493695453754761759 -0.49815527071298359996 0.52945488734289791743 -0.37302048404382659452 -0.091999462148536784167 -0.15247169322405298986 -0.66886552898639572984 -0.46340587605868016619 1.6754148624358473629 -0.27689980764381166845 -0.244223192269579642 0.25051304828820036841 -0.19064529327252924262 0.67459346083492122137 0.14433886626803146824 0.85687866636720666502 0.44558963679561475191 0.54920418515549540572 -0.40817654203028364002 0.39169968979765856787 -0.14251044359800799088 -0.0069077884220132054066 -0.080826366893075263231 -0.46939892225510576607 0.17069518620394877328 -0.051437219517897744825 -0.025719585548153803267 0.65422511863696408696;0.22576126916040825665 1.8941574742525049135 0.025615439060919502345 0.066546306013770734067 0.63822653129720574583 -0.48539626815910652535 0.31327610412147366414 1.0597376908084887859 1.3269808676840124662 0.17283618507816039811 -0.50236691063962590764 -0.05631154377334974398 -0.53490894889201889839 0.16798793546539908528 0.032796381413443362329 0.72777490958623336503 -0.17479836354156039202 -1.1340632256637610542 1.0896358542803337155 0.97155756353340949616 -0.77616495517064343357 -0.65142652361702069186 0.50721259297686094314 -1.2933882931648668091 0.27994119828461716537 0.43428693732224010748 1.1007894679181116082 -0.43652713912060947532 0.20915858798828215748 -0.075755665994752183212;0.10485962313036964466 0.092101096720714897836 1.0612675822052684005 0.65903933678673798369 -0.28212583135639973664 2.5639562661639105912 0.32473893412360693711 -0.9242511826700717803 0.32884496914573668747 1.2837769207098548296 -0.45700148515809085881 -0.13250930838942776013 1.0005369225796421073 -0.24816325332125188652 -0.19255259386481649031 0.12684008079843492323 0.27567494119126273455 -1.0267401673745768509 -0.092113389578595467055 0.18531495640066281139 -0.65216866105354298622 -1.2404515731236196441 -0.43199143831531761073 -0.14550278781828229757 0.24360041218605951729 0.11651115740514883523 0.43686295038177874739 0.67575091252075358828 -0.40246816458233147795 0.58094553983519914286;1.1734379674440538199 -0.79265293138975911891 -0.13164940363095961606 0.76626930158223194312 -0.71040421633516459554 -0.60973218101179671446 -0.78614119375585567173 0.5037702306137847863 0.3853927014920184857 0.66972132432993791706 -0.017210566882484134438 0.75241415088702434666 -0.18690591030133724137 -0.11525299518497955642 0.24985289745703007092 -0.96779021100612316886 0.56134309812331240064 -0.77405104336640473406 -0.54164061835434984538 -0.23717268438532795871 1.1491361794218764025 -0.15636822537273717404 -0.3694989721622424228 -0.58928191884072278484 0.25972859256686148255 0.12368230181011369284 -0.23603692830158554128 0.5166075398352152348 0.26461051693843568033 -0.57018002618328800235;-0.42176591679313713001 -1.132866264554593716 1.2646215737557011671 -1.2058965026922887631 -0.33177748856956151835 -0.04184393829180790142 -0.016674460401323122627 2.0285355523682215839 -1.5460935652361411652 -0.52965868288890627369 0.24302005749788616051 0.25421901467211693859 -1.8268999263452385673 0.93260387415302026248 0.59620375671134617779 -0.021585656163079891545 0.68824581689218411462 -2.1308272526292815208 0.33061802343535873216 -0.72056012801498758868 1.0928963630113288641 1.4749316682053827954 0.01845374337976627907 -0.74501093258180628442 -0.24129626263367917605 0.8823314530811499079 -1.8412714300146277857 -0.6573030288437385904 0.016036045643287383938 0.16170960098610409617;-0.30154963716440341681 -0.30560723082382917903 -0.94206963150937650386 0.59778582653570633276 -1.3100825906554258715 1.3276154046298529465 0.088925825935414037904 -0.99023827580904544288 0.62687772586254530971 0.67656454159602419374 -0.28226577435741667665 0.044267882743305696225 0.42865752485822439244 0.088635960959838638873 1.5484415822739701074 0.060229316634513793693 0.68253947182610763544 -2.2098386619970113998 0.12141186621286215175 0.05146443901088296885 -0.26690669552034734791 -0.94234881976790330071 1.0564765805768736584 -1.8278821873317021574 0.15982286256760758203 0.95396002251958411655 -0.34146230044517417168 0.41290938594934628592 -0.384241895943948919 -0.19793989928825708735];

% Layer 3
b3 = 0.13474163155026999683;
LW3_2 = [0.85199261323023001147 0.25083972121330233573 -1.2458419951420509619 -0.76097566858856957595 -0.80502288689637402364 0.50360482938165962441 -0.62314527003484676548 -0.5549319389252110879 -0.16963843543395307201 0.56719047910295616877];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
