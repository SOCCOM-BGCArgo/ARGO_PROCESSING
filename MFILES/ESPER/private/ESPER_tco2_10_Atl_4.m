function [Y,Xf,Af] = ESPER_tco2_10_Atl_4(X,~,~)
%ESPER_TCO2_10_ATL_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:57.
% 
% [Y] = ESPER_tco2_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [8.6359549524861539;-3.322520233759847;-1.2588007417291904;0.28709284390335599;-4.4793397547721403;1.492274749625659;-1.4242836128262506;-2.2880402011385765;1.6022397725169466;-2.8135995087352601;5.2919681633810107;-8.387110259330175;3.4981475828767938;0.30885391664846196;2.1347935000044802;-4.0683666652108483;-3.4360897119023517;-0.11141775181946059;3.6638195808874099;-3.7563068826385537;-7.6830179673923222;-1.5009744898577813;5.2676124920948624;4.4984581274978979;-0.86157573759397998;-2.3782768873843301;0.67924629529871383;2.0860534168435723;1.6028086605730334;-6.94995944491024];
IW1_1 = [-0.57430454274479259 1.5834439915800889 -3.4343336545103598 0.58968291898275593 -5.9296399739526313 0.42207430898367904 0.32527128856136694;0.5105965671813083 -3.5605233897038047 0.1824843872577584 1.6746835472169539 1.1581137049429284 0.31027244218777422 -3.7283237784852323;-1.1998775547803127 2.5300518917462842 -0.47779831469615736 -1.0051996019987377 4.0036404057573947 -0.16810267795445941 1.4134012237260611;0.18791862535815035 -0.20605951413009113 -0.030017041209711996 -0.52267555648118824 -1.5366600412664349 -1.9429797364749806 -2.056782444466327;0.50042130911489791 3.1809995780703955 -0.71210523187249497 -0.12158703299133466 0.1906493259877361 0.84046690449252115 -2.4711616089751778;0.98598954773193426 -0.79603550210733265 -2.1533367953442659 2.3657327306913403 -2.3852125978323211 0.03302279523321125 -5.8680734996419996;-0.035955453885963315 1.6510291864948519 -3.4742674327231522 1.7103933552874782 1.7210998591924098 -5.4412499479422252 -0.073113709139279406;1.7927704523511769 0.8283629442427024 3.9622168579626433 -1.3130870573120401 -1.362294695215587 0.38305942228691614 3.7607728112977505;-0.44639379512122201 3.2983981957975583 -3.2259669825632895 1.2567015078435231 -4.2773164449158187 -0.76288918147573093 3.6405591726333451;0.72266030403304504 -4.9064575031231081 0.96331827625420108 0.30291699050053222 -1.2477672566361506 0.95423318565436044 0.4881561781232065;-3.7917092332971416 -1.1291681206833974 -0.1295047656440686 -0.33882278815746925 -2.4075268145187558 1.2574729085847982 -0.23823973502779738;2.9178979764783008 -2.1345247446318925 -0.14172713023476821 0.6189136022813736 7.6143680303382659 1.2120934539604462 0.6078330948543913;-1.3790603291325465 1.3521640844499963 -2.9615101329274172 1.0674894624205429 1.6535093585259522 -0.55828329233816254 1.5979660784987393;0.46943196673718884 -1.8098344505632011 -0.81373685826563913 -0.58073582276503866 -1.2133412050757921 0.35880783791419429 0.70765153027267991;-1.9954050390777938 1.1792965564037412 0.15249310324501966 0.67641113429693278 0.16034613086658892 0.46893018008944459 1.2018967257190198;1.5369000634524395 -0.76337337446134179 -0.079892959423513668 -1.2616577980445163 1.4102358859798103 -1.3497331340877425 0.87208676199896251;2.0049909594388895 0.2748481685862863 -2.5147897512544093 1.2399926715372618 -2.011745222684115 -0.85707900220514588 2.8055149935015731;1.2410544925490117 -5.8280606384941205 3.5220552369562994 1.7695635975019908 -5.9314423884634246 0.92568640451607787 0.94950623079071772;0.8976944804512843 -0.27232583969126523 -0.61733730413643328 0.31903202449769719 -4.1427935479113396 -0.92076554604770522 0.4890232368102731;1.069890801220565 -2.3556922911170513 -1.212224037292726 -0.4108704895084101 3.2380150427559515 0.77634402766007105 0.99128201666052229;-12.650561899432448 -7.8208442629034858 -12.325674701086342 -4.8993267827315918 1.2775717341202304 -0.66430485444633669 2.4362364639427128;0.42454674102602724 -1.5171629576684271 -1.9410580041149852 0.17684083452939489 2.7782090869453864 -0.39000626332351651 -1.0374859566488377;0.80953354686810464 -0.26898903540915348 -0.88154645666991716 0.29581955432850171 -4.2128418201768829 -0.85417505254534432 1.5184451707418127;0.41733158487345323 1.522695302031942 -1.250117496939358 3.0557691943016239 1.0375036256859749 0.64973538186562996 2.227756003689557;-1.2879316972515349 0.88709571997811509 -0.39803438488198017 -0.48944678514851775 -0.17026774434378536 0.48954912036605264 -1.4242556816171048;-1.443876302164609 -1.1936196699836046 1.2099603869439517 -1.3492806673865876 -0.50240237190089398 0.1155994359544644 -1.0543455412305967;0.15203699649252497 0.52082343629004679 2.0096385174048286 -0.58523606880079504 -2.9439314483402024 -0.54588960831280253 -0.046798820428919793;1.3971910661644378 -2.618113908919415 0.89973044444689654 1.0063171889624696 -3.6931227967487437 0.24333140964029595 -0.40126894319132567;-0.093232665949862931 -0.27890276700327155 0.18833465656730061 1.5790247902251919 1.3818696275268703 1.2442427133226734 -1.0833614438108947;-1.3585723869115929 -0.20374980836933651 -3.6172477316005529 -5.1590812672614978 -0.020378101310382667 -3.2408057604722411 0.55728661891644016];

% Layer 2
b2 = [-1.4215630522228093;-6.1392637245280834;-3.6367627329080419;-4.1573911699423407;-3.2321103576488639;-3.4353186592420788;4.6974898709846666;-2.0763401299384538;7.1390367062317885;-0.38326741456311875];
LW2_1 = [1.8575243982510508 0.81375182119951006 1.6733450293158341 -1.0003059795618572 -1.0763468426779295 -2.223428278498246 0.37057511439386881 2.8925895560970796 1.3695719794145622 0.55652346669870023 -0.4452871599332921 0.40221028966388905 -0.13295460616132823 -3.6733952067238573 -0.01976893031007354 -0.12931659420594907 2.0958471265198537 0.39823450813469918 2.2202182302838542 1.269360436381346 -0.052575168202927333 6.1331158841887774 1.8361723103032874 0.40519450259412926 4.6973241748207819 -0.58889272874970766 3.7318583023579319 2.2903995755246465 7.3294296584415948 0.15316523985335498;2.3269055877558094 1.4965470382153101 0.85246909507856883 -1.1564594338482741 4.1068989715459931 0.34850523577452458 -0.46765969855498374 -0.59939097876601521 -0.70160832780150595 -1.4900482344105963 -1.0316973081912919 -0.51642836506874445 -0.87658055810115154 -0.41694702346656415 0.033460726112489972 0.78761500319915845 0.57831200116259318 0.62570862939328598 0.47546258351125592 0.7880097632234998 0.51623738973333677 7.1281221517252238 -1.1560007821003655 -0.27504429630337862 -2.0864415116122461 0.17987102131728958 3.1967047168840832 1.758243594665962 2.6482075194811978 -0.44971833372742637;0.97292151321650711 1.2462464419371095 2.4158064627527946 0.16529800193604319 -1.5004044183451564 0.50848171145299526 -0.33740707639428119 -1.3136412144567313 4.1564335644286636 2.8168133111737497 1.5787521904635624 -1.4387794840224026 -1.2121918290888616 -2.3926663849882752 -3.1476144662043555 3.0243635188435665 -2.1584873796287583 -0.46219840702556159 -2.7954413774656035 -1.4837599901430121 0.17709194053253055 -1.4616102123414261 4.2695549331194966 -0.20143492691530784 3.9687961402298262 -0.83840262879452199 -0.22402152157507235 2.0389935330262889 -1.7850531364026865 1.3396699796452294;0.14133869751085909 0.40635237433078664 -2.3691034315049966 -0.77799364252860603 -1.5395280524270862 0.96141667920159768 2.138282394259102 -5.5750497716613223 1.5715710951456712 -2.2178601838175891 0.43325131186979082 -0.13181936389725332 1.5881711214203238 -1.8055104023316277 -1.3278922688798367 -3.6582931451226486 1.5671146467219921 -0.68798206765691072 -1.986053320528324 -1.166914043960354 -0.69251061363389699 0.85538282018356704 -0.85391085982361592 -0.49806547722370098 -1.0336609484732304 0.54888804156231918 3.1602413483788174 2.6494707952102066 2.123942921168557 -0.59295628514453314;1.6070049635510812 0.52145752986856919 -2.7706892404273935 1.5945520547504068 -2.2565378543232053 -0.83402680667607976 -0.2397577254216656 2.5489738830695492 1.8750617198383157 0.12619040593650394 -1.2275062375310926 1.9210537848369653 0.93391695048968904 1.1757801324070913 0.19232309176861689 -0.11079193059857714 -0.019036040006013999 0.0028497474552314555 -3.7190969761714001 0.4132570236777422 0.36117471222499509 2.4954154588681328 3.3357343522392497 -0.38258838148160734 -1.251393082606435 -0.73612312631566867 4.2328100889805444 -3.4774653097052708 -1.704545717681371 -3.8734416020568103;0.022008719360788881 -0.32731012238267598 0.015834230521639098 0.35884901271778891 -1.7651948339648775 -0.53213952017094046 0.38059940496996647 -0.61206868293314964 0.022597615347417714 0.64850596751132317 1.9744669764123495 -0.64952742859153711 1.846602189984849 -2.046775297851267 -0.001079072897667923 -1.3925063669999433 -1.4289692339425177 -0.27252545284260338 -3.9614447101724646 1.3280782423459425 -0.16956705039176895 2.5467606834629386 1.5033788952259994 -0.19252516536088807 0.076419465066399489 -0.69882196723179901 2.6747465928388774 -0.38264471217369356 -2.4013911753688539 -0.20104046981346316;0.18518895277749192 1.1708808092243947 -0.75278778598702234 0.40571379276847863 2.3394742040800667 -2.8633192526752032 -0.50838811636524395 3.6823665075269916 0.46420061933391732 -0.40703846908756491 -0.72878556102254999 0.86697418759331735 -1.2769990277952337 0.35310525540228138 0.99356016308477346 2.0468055984138052 -0.03615150117268174 0.41140970198503318 0.010603673766503952 0.90069638484926162 -0.060802721209215455 1.7019997339040511 -0.33564527146869166 1.4075024781694572 -0.92742754106364711 1.6705054825513006 -2.0735562708080764 -1.986240575653996 6.6125819458871389 0.67232815137955837;-1.6591451870196845 0.080079718832722413 3.8266550621911883 0.50668698309219184 -4.2785868794581834 -0.17180599646559871 -0.13948188140044554 1.3108375381640713 -1.0734090577130597 0.43438778980739556 -0.92869578689422128 1.2191845279048779 2.8201310846215129 1.1760793209080966 0.085172880867314726 0.3502529999780859 4.0936052827811595 0.12908663998403047 -1.1850269445882016 -0.59002035591601998 -0.068610666788174457 -0.85136906349433128 0.037159453722394008 0.20234166730301267 1.1935839861216375 -3.7603294820320721 2.1156660931181008 2.495266057468708 2.3744625284190217 -0.34523877205480441;9.8533190145466865 0.69841387272227284 -2.8399989300911868 -3.9709080849960214 1.0965668524114474 -0.64752236630081217 -0.73807673713662103 -5.1445050775640615 5.3763555050648719 0.53380139676684935 -1.4232872655827655 -4.5370768671804784 0.62810379672431416 10.321927582947826 -7.158675094276739 6.821124971342603 -1.8513532222831326 -0.13713173023906539 -7.8563674778160157 -4.2080288016566563 1.1457793691893727 -4.2590441994831236 1.5165485379809833 0.72416898828038678 -2.8562786928794694 0.32820394206093512 0.54483385741245183 -1.6113493929742466 -4.4515497401523421 2.6287223763195224;-1.4101898747713482 -1.8329776812217276 1.6485723254094928 -0.069385272445325483 -2.1365404014108318 1.2859555979206485 -0.15221291165013953 1.521776640489457 -3.1350219838865327 0.29203431803908497 -1.1746697992051496 1.0295168706422007 0.1642590595017531 -0.59130253855539883 0.51719733428999726 2.5666867125806752 0.48256790261021737 -0.77830372744789389 0.12649369843445715 0.65102057292612758 -0.42579511091212058 1.9178605035975327 0.84463053875978955 -0.62446275543811958 0.37225909281405656 0.61912647211759975 0.40646093428485891 2.3287414109296054 0.25835545412235111 -0.31930750662629726];

% Layer 3
b3 = 0.00050233067191155401;
LW3_2 = [0.033284435292375264 0.03653372239809579 -0.74764742854465172 0.022358001509747892 0.049819580011889852 0.056773161656915878 0.044064784158418698 0.058802134441665842 -0.0049318560578685815 0.025846373724201583];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
