function [Y,Xf,Af] = ESPER_silicate_14_Atl_2(X,~,~)
%ESPER_SILICATE_14_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5952031166578131138;0.14149778229514614614;4.6186126771789401957;0.83387386564181587012;0.40615857100705632377;4.8939377839078783694;4.741480789505056137;1.8903402942516929208;0.41182148287131636888;-2.5200246215856783039;-0.84602487358429312447;1.9713436589592152615;5.6723178792945780913;-9.5523486312903873596;-4.1894405737023712177;-2.8911231467182463284;6.961149287053534529;-2.9489601548679522658;-6.1631513990121238322;0.46165791978011883057];
IW1_1 = [-0.089339674860411666391 0.23289253728545725175 0.54519828291872129977 -2.1541611025169355997 -0.7144406536745214753 -0.32777032848761089578;0.12540506313446539433 -0.19506502968147582111 2.6036169631342280795 0.46786637923087026625 -3.4975232944054428508 0.87563382488291430228;0.20756177058372549116 -0.6287992087098431826 -0.6976353201306423335 -0.39163868669046281168 -9.3503359509778505299 -1.697863267166488388;1.0064371805847083241 -0.29807666243058822397 2.1334735410977438974 1.1257192219416163326 -0.44919264000572944884 -0.10548433310141333563;-0.46681596998262114839 -0.32406988218001053781 1.0536770575990970222 0.49129162703782980337 0.089829410471003304228 -1.4633615963756965161;-1.8304120885005121799 1.8071591227791341527 0.56750461934602924874 -1.0120115943487950627 -2.7706845125422723264 -0.69961176937394686792;-0.42761218925222660436 -0.088533690656225502713 -1.3667314049199441595 -0.82084908354689489762 -8.4489366701248975744 -0.72723286800059228074;0.11892328059110633676 -0.3971584616056500483 -0.10060844674006012844 1.5131805445678230271 -1.4185293817863402488 -0.45451457470580813869;-0.26380075433509797556 1.0156142411995374708 2.0055092695133525105 0.67032327175581751799 4.3559480213399597304 1.7021593943890132028;-0.54095672311774045671 0.28711622683167281611 -1.6786085662781262684 -1.4075484703219600657 0.88563983409944713188 0.49967127019090346041;0.36740877972730884293 -1.0764787062017087127 -0.25992303332470240163 0.87909591774761675076 -0.40616965167826124539 -0.54977452577488183927;0.2533386330937041353 -0.35284839418944441425 -4.2139028905728386221 -0.54495465119111163865 2.2593365662566426977 1.6632213467717613664;-0.33844960963325199099 0.21465181042779293841 0.20440390917160658479 -1.9673196444976817077 -8.9501135031343732607 0.44376630948270279209;0.15679490692847991573 -0.72790280790876449313 -0.34505050889255367563 0.98584130196171049221 12.621074243657041336 -0.29203331745917826545;-0.092514220520885037669 -0.15379538517476801229 -2.3850185631030473843 1.1502658112911623434 1.9841656556994082816 1.7985736631537840857;-0.50738662815686830232 0.68492309151596519889 3.8049432554467874645 -1.3585145750250933183 11.315355022360309434 -2.2977967215081229746;3.5592698799213913219 2.4496557929246245422 -4.5813945329621796887 0.44780019556228695121 -3.750626930299112427 -1.1170244700906319935;1.0815526393908290181 -2.2533818509647955963 -0.62895900175367414064 0.47833658477509011231 1.10251083862889665 -0.91915166682696780587;0.35675355691652288481 -0.47485380804169574631 3.2550168683156019966 0.6978370958794626322 4.3696496578935706268 -1.8768270724232722912;-0.095065032300225643658 0.34100305562149801908 1.0845957141770341536 -1.0498006327956597161 -0.49664994188123395835 0.37855004694500077322];

% Layer 2
b2 = [-1.4790893409054239882;7.1268782063254034753;0.39838247054565772975;-0.30509670666149385498;5.7146451343668775991;3.8706167230680024183;-3.0727488547937613639;2.1397081199666043716;3.1778104773813256045;-16.024120122115000697;5.7977215849525443048;7.4812427070651894567;4.738143869605440095;-3.3333044644143661195;0.5319947399471069982;-9.585478268464600049;-0.93000404621716459275;-5.0520282763640880219;-14.647188470919049408;-0.62459523554260099054];
LW2_1 = [0.30181980032576077866 -1.2581849853729374367 -0.40986997129542818152 1.1157536177582647596 0.010828677551963643289 -0.3648699338646918533 0.93572305912953179785 1.63526910604241138 -1.331006004366152462 0.78474247271464547815 -2.6403007025447839951 -0.44749935142959573753 -1.6018150507557809004 -0.14064717748644356421 -0.47162564669083589797 1.4228017322564552316 0.14936699496531122278 0.74289052038826386415 -0.084793689185671650144 0.9494952526729344422;-2.3813046260891090888 1.4431198053672076309 -3.9827010548221761788 3.4899863114911449102 3.1873986498162527603 -7.6320147771345761001 7.070269860983766641 -1.9908045183789182531 0.34053002100984414158 1.1179274409820838532 -7.1624474097578252341 3.4523092463835500787 -1.0266816611063529496 2.4477944893606990995 0.79110850052639303254 -3.9417562801706349518 0.077441037806881843353 0.51183477727905657417 0.68338071812944967132 -0.12323163058079177057;3.8853840448635241778 0.66378761637356020753 2.9287373225376764907 -10.076470616063087249 2.9703093425035858033 -16.624670632209483045 -0.60329939171505908568 1.419917155363202621 2.0112858267251092492 -2.5141754937234090939 -0.040728506925719068499 3.8118101605568197598 -7.4281666250718529909 -8.9874208514015947458 -4.5319643035143695187 -3.509632166947278531 -0.93566431593580012827 1.3747179870015853176 -0.55205679626315917741 6.7651075822832966722;-1.8377809620242726574 -1.9542828459511134565 -3.2953055701696358781 4.0765863454946247302 -3.6639120564068865527 7.0604989682941594609 1.7344709835558513866 7.1388566916916058602 0.62193519527130425306 6.6716211307699540001 -0.45340081407280552472 -2.6219295772021222746 -0.71192525086550562108 2.3933790751676240482 10.80277612973511836 2.944451954182430331 -0.37878010502924297498 0.95006361821653406707 -2.6665206287791578532 10.326898438232099409;-2.1616555389158178535 -1.3846796092562012603 -5.1547704350982570531 6.0602896515341226902 -0.41863579918566667937 -5.6649996228484580385 8.3994567642662172346 -0.50456801089644642833 -5.290913330144661586 -3.0836710478863698093 1.5521771906650208006 1.1478480714167880183 -7.3609282894580037038 -6.9431472250704588944 -1.7951672400372131744 -4.7415427462649795132 4.0079657787750102571 2.7809118194794031353 3.850720711881602476 14.5658599832262734;0.73898195217412876445 8.3020113675058855307 6.3881740071774197887 7.8523576973489737085 1.4147791961591682508 4.03738091111069064 -6.3861926047252417504 -4.6629487169585841499 2.3989252911435676729 12.30780499978549436 -3.6682239009692412246 7.8238055770235686026 -1.4136161109779550316 -5.4263032929675087956 0.022725893391061749438 2.0168957400370897126 -0.13235801021036364133 3.3533392595763378274 0.26682737187798200029 -2.0143251548201628331;0.9921874813486584177 3.2684978601198699799 -3.194828799128092367 1.5481090155046692836 1.1946680416034787253 5.7712758373067041262 2.0274089647505051381 -1.3004143471298081902 2.9845366707679894525 -0.98354932928876614984 -0.29073833227261830503 2.3502891839408159846 4.0428240155188621685 0.029673951745153893944 3.5753195080582069743 0.90375168670539640647 -1.5268906940866808775 2.1581122782352268885 -0.065500153370105354544 -9.0526351324247986696;3.947851229979746801 3.9043713367527388414 4.1431654561414381632 -6.8034447427596802527 -2.2701468316558526261 -5.4368086310795931126 -7.2123547662052578389 1.6001064731245524531 1.8205153064214039116 -6.7700712272021439375 12.282146171110564836 -5.6574550772224032613 -4.7286626785055165811 -7.1885809098941333417 -3.6444834514183539476 -0.70761695098703492057 1.5926598899096642281 2.1618022678508279633 -3.1207996505286401678 9.6193853262751627398;7.164312565466802063 -2.8373231172906332453 1.0973370375215072414 -0.31513566867821818374 -2.5555831512249378434 4.3999724632589112261 -4.214332387923264811 4.0355072615750886555 -5.6562500831930417888 5.8487973536564066279 0.79362936156418628642 -2.9032004665486996764 1.2490994921893914249 2.5505389847703185957 -12.266480514533263602 -6.308544429186571989 -1.6634238663680576131 1.8520040991638384575 -3.0063209114569642288 -1.3644282327493479912;-14.804577484321665537 3.0513122894351183412 -14.114250330768031816 2.952341754534785867 5.6577176711554635347 -1.0338881865757907352 8.6971768745982327431 -15.205638040805343536 -7.1062481091608615813 -8.3254803926300215977 -2.6347620185770637136 6.7931181194134673262 -2.704250206329915418 -8.3551299248598080993 8.426968305895050193 4.3275095761657427218 0.78935526592246274546 2.8064089337931110713 1.7253884740139961984 -6.9735182697598130375;-0.26966262607264201989 -3.3588465439648955702 -2.5644112935924394669 2.527600318000621904 1.4386457949489572794 -2.2253727518492096848 -4.6763545208433940914 5.2513152211688591819 -5.6175003941472088087 2.0854576319330511147 1.8696645256939448121 3.459887281579158369 2.4545225264409613608 2.1426166719637911307 2.7868432305363217694 -1.1075342062127824239 -3.8778904373246305681 -2.9039062437685130291 0.80904296278342502369 -2.6312337357432489249;1.9385458724841813094 -1.1150680159574852812 4.0830475136122581503 -4.3192366817861378436 0.22220888952824632834 -1.4748719436495785207 -2.3893244224079031035 -3.0922457166997805444 -6.4383400785498707819 -7.8163888527893545799 -0.85315105847477590295 1.9325618321999422644 -1.824236568883526699 -3.9249050883804823542 -9.5439192437763029631 -10.809649411036799549 -1.0016190622974359137 0.79758004838436957762 3.1962540501169085516 -3.0216971820065174903;-4.4269050495608492923 1.5812048282738566662 -0.33123552826217228517 1.9640523911659337752 -0.95694890139525001782 -2.0694943327493682261 1.6979691535667791324 -12.025006605769160473 3.8492480527418222458 -4.4332345215896591384 4.9699578964490944699 2.5313845936573424744 1.4662416727883158529 0.16857961101450391617 2.4582898566811413055 -0.79763089964532529752 -3.4730221995574428462 -3.342602399050253581 2.3728402302304476557 -8.4461126618139079625;2.0453228006274590811 0.882728769750130704 -9.1043441444713639754 -1.095487152690753474 -2.9238901892802116045 4.3700568102918273539 0.21871311097082363206 5.8842660356574327807 -1.4484320172648779135 -5.2648657443479311979 -4.5028559178186249312 -0.77165265930473947442 5.5106372557291685155 2.5257046712696853419 2.1057641965360236469 -8.6266006372123840151 -1.8491434328672158305 0.89593946602777507771 -5.6769762376906776069 -7.9864973345688188289;1.4101070526513959091 8.5764785706586241787 -7.7670214879273560271 2.1206552593320604494 4.6030438764004282248 -4.3141717308302371947 4.1678876914727620573 -0.58902449890936547927 -1.7770350032419095498 -0.43487798212351241878 -9.4195717210317440049 8.3793907055759291325 -3.7484439737235222267 -4.271924382280935184 0.19225740488769160752 3.232063700445036325 -6.6209624610225903396 6.5130930376492326417 -1.1765220033760253049 -6.5100870649474007479;4.1305469970886026232 2.5699896711951257799 -6.4926183355306905653 -3.3256419692453764725 3.6356024109109870146 -4.4050864291348759139 2.5265072441339579967 10.0330824761379791 -1.4836126692731250731 -0.97418082047091381082 -3.6064040988713306213 -0.64833930626137092901 1.5282819006468133516 -3.6472213350448949853 -9.1253157604533843283 -1.7630328193873403553 -1.2885504917089736221 1.4728050090718602938 -2.993123753639850726 0.54511047332001405508;2.5002552686416912309 -4.6410482712819982609 -1.8641194764181014953 -1.5583760879965711243 0.54391473760375541602 -1.8689794830897696887 2.1101127164375665934 -4.3814392780058826204 0.86348750920857897384 -2.331460298717405788 1.4200429181205820317 -0.33057253756389010091 -2.1814101778880830018 0.48336227011133714448 14.613655092723423223 13.343665391873436477 2.1442374840225895127 0.4339947911398921998 1.8072307889398713243 1.145930140149229004;-0.80239488821744275882 -0.66321298773678616367 -2.0174079063907619513 0.054444468163801759686 -1.3350188383183383412 0.59789042460947006141 0.28274538693643552767 -1.4164998731782270092 -0.86854728813372783502 -2.594646840657005793 6.7674395980154766761 -0.14656475348770922618 -0.21703010468434763558 -4.8201628376531937548 -1.1218582857158148069 -0.5605940618974317724 -1.8299113332177505686 -1.0353036987070738384 -1.4118504910308031786 -1.7536758636025329139;-6.1110942012272184698 -4.8068775966661236865 -15.985298220902851796 1.5357621734768192034 0.72888032615483000498 6.4062028771982060249 6.5420087874356722679 -11.049496605049448306 -11.514796587415576212 -17.448314548269038937 8.1588150961006498108 1.4419128500806832616 -1.4348896286075880635 -2.546649396272033794 2.3175645977447976165 -2.6726429012771384386 -2.7641345443474460986 -0.15386393199447578883 1.3852522131943185713 -3.9245741282576900311;-3.4352677484838505251 1.9930340006648672446 -1.313006375980652507 1.5880944611391210053 -3.5190186670231367039 7.7548819957885326559 1.4467895377236856813 -0.7988441476433135735 -4.5158984178619991923 -4.9588407424136553558 -3.3597240862709436549 1.087696412354359321 0.94437887007882403978 1.8170452082622281509 3.9165684032271341763 1.1130413395542497756 -2.943397826977729892 1.5649982499507344436 1.0552984997578487292 -3.4750827945459996648];

% Layer 3
b3 = 0.40127236511808284103;
LW3_2 = [-0.15806954538050987935 0.034231741488646549865 0.025600921018195662432 0.019082096445734858525 0.019276539900060590815 -0.016100098855736908604 0.052653394178550604054 0.016576744996125911819 -0.021594548948695901219 0.37269345027367944967 -0.016400862953070034778 -0.032855106910844394941 -0.03077831880492109401 -0.027634822365999279353 -0.010787520547254568146 -0.028962097870394876847 -0.025639392126287022938 0.81364962517970740308 -0.044723884055206747368 0.030661837114552538408];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
