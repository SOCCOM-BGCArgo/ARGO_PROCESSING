function [Y,Xf,Af] = ESPER_silicate_1_Atl_4(X,~,~)
%ESPER_SILICATE_1_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:38.
% 
% [Y] = ESPER_silicate_1_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-8.1941987935881765992;9.1340070226007661347;-3.2817188624584598955;-0.89228178279663827865;-4.3937386934314917042;7.5411481366953427852;2.4455788085218364003;-0.35496445921645464194;0.82547201192748054233;0.33498393170922163842;-6.0273650631894488683;1.1168766152497393573;-4.0716497739594288419;-0.10795036826297475796;14.67293221533285319;0.84213594289002957627;-0.20753301933162066062;0.64057689755097957374;6.3937766392595056786;1.0502058494185970705;-3.7625252194112133175;0.43649591035051926724;2.5533967349414381509;-2.4320201837094543862;0.69770148058751801923;-10.204079707417221812;-1.8900346592849992522;0.54410385587042986444;1.8656363089558829493;2.3710795476267176873];
IW1_1 = [0.050296105236881993861 -1.5011656367424919267 -0.37514045445824245606 -2.0233282881232659278 9.5800390703055047226 0.73090782345615723514 1.6010370875476152008 3.2066444960837090505 -2.3780011397351712432;-1.8159422415812842555 1.3698479531797358444 -2.3863905295468477163 -0.43961762528903491898 0.54281824430174929752 5.8691800519757411081 2.9137100994826421463 4.1783646806602972035 -0.16783950000221919963;1.7879013830018037901 2.1839830572172047596 0.29276207372566315223 -1.1718276332173891419 0.1577125233241639668 -0.3595926309972107271 -4.2569134629251506041 -0.12386678169190884491 0.072846207925214845336;0.48631599906952577284 -0.52939681831852203331 0.33933820550829962848 -0.14832174696943384307 0.83976536335352147677 1.9957923766829548384 0.15178831535248846207 0.69297816310986060095 0.23061669185830066531;-1.3348733798780594295 1.0027712332457803246 -2.5001948307345180922 -2.9542322162750846992 0.27541318061578817789 1.2691900293187683424 0.10319471042052091869 1.7179962581467038696 -0.12927074266129237601;1.296423278724590844 -1.4567214919797837336 2.4573527848798129014 2.5892753894297619865 -5.089220077912359308 0.94237600530844567448 7.9067005218534625044 -2.6267149017197000127 -0.84036994996811387182;1.0852560858612254613 -3.4990180721117609686 -1.660697669336191229 3.1085178996054350087 -6.4952424479795975998 -0.34401778745986655306 -2.4192532365448857767 7.7334268977415465685 -1.6974303233223595466;-0.58017117816999697055 0.4997173943514207628 -1.9673350906931865723 -2.315143076710210579 -2.7499783789756988561 -0.23731300948229103187 0.24506907382101889015 1.0060114446768724239 -1.1814563948224521273;-0.7483437192174566821 -0.33377285486169622208 -2.9326779222319743212 1.6338312099552034784 -0.63546116767354554611 -0.082388735233261164992 2.6192995862582924005 -1.4385726718031390803 -2.5011831753874620432;1.1204472764305550836 0.63745321926622844355 0.2715356281316282927 2.0275866883369308979 -1.7073181179117451478 -6.2962287026913275056 -5.4808095016913469522 1.4371210601413173524 6.0462709415311994832;0.45293159217636203007 0.046990101491775848608 2.5671475567884667335 -3.3844678619140480258 4.5513850060434979383 -0.17100094215788635976 0.55828300282646836639 -2.2342449255480754111 1.9102303286133193172;2.1232036073967264223 -0.88344856898381374233 0.65563495686036343812 -0.79048416340139038283 2.3409772177723220388 3.8468458273514931633 -2.9274387326682762556 0.91765411107168060045 1.1390376341727519449;-0.14717746244000132205 -0.24335002797177002209 0.062479734197186859168 -0.15456640380162667281 1.5387730872633931245 -0.53334078370808568614 -1.2560861353696453069 -0.10816217469370009718 -1.4248565860608115585;-0.61551284723349863892 0.70005805869306902967 -1.2183089564885718481 -0.76255470903735234067 0.14550598007377013587 0.24256960638870755931 0.082830399928589107383 0.34734021950147703217 -0.9449036587109165275;-0.54715568201236142176 0.02087344424226244069 -7.3208875614859394432 3.2987372521202473763 -11.754140652307805581 4.894931562603761499 7.1239730113312349502 4.2846273822545875021 -4.2886755514614529616;0.4077921900315107373 -0.63250812639853093433 -0.43251652152126163209 -0.26769569655242891892 -3.4158571700689015493 -0.77684025327972650032 -0.57792085305822249452 -1.6467000925196304539 -0.11063799860714099155;0.39771026632104305998 -0.10642162459932716367 0.42738597069198408507 -0.078020065483427616937 0.23214670207219154086 0.26866654229246555996 -0.50834618162029454602 0.59221803702508257761 0.34705522582131098641;0.68198652025997652526 -0.065150010518727652364 0.74639517028241164631 0.68588452615155193204 3.3490835727147860723 4.6945192541177904744 -1.5551111589983932504 2.0465073702934533095 -0.16555947309439245085;0.25611578877465962512 -0.26219172639789106727 -2.803729448327180851 0.7273444603532859265 -9.7285501704812009649 -1.8406069135887643817 -0.036858615558048729577 0.84956274976798729082 -2.2486884431318645561;0.32185734473418864399 -0.78006745975676605731 -1.5017758053672130014 -0.044397437558554020409 -4.3915976373183367443 0.099495165774711138984 -1.3847191512856351636 0.33304058199348823832 -0.068269400675370198184;0.23703037810095259341 -1.8733163020600007709 1.3708209795475250203 0.67177878443195193636 1.4893604420350583517 0.74271185305210907224 -2.1956816007584314399 2.5826034743905763591 -2.6292980560821792579;-0.59811923114856935246 0.049445351288759951947 -0.82756309993849530571 -0.12637065054007171061 -0.87914417002820510749 -0.12620853144249721822 0.28697534205897923254 -0.8366163522182200607 -0.38837309484813065108;-0.6015124385804708762 0.37180083531283136811 -2.4921996782141584426 2.757664939973549334 0.71359401710601688684 -0.13506593508468844878 0.22841283784869653717 0.3613167350660794197 -1.5053131789462110834;0.14982638593296079832 -1.6387701711562043805 2.4795070695546823636 -2.160390067982732365 2.6699648751033691063 3.7805331413593434853 1.6227080261843926934 -2.4593640990268408331 -3.8309949597501584684;0.43635203903956626403 -0.67540428232090865546 -1.3213619684990711711 0.18561538029733487543 -1.1464433186876989978 -0.54378360155904692519 -0.13338149130643470186 1.2331800313357734744 -1.1734535490838051697;-0.58639120845737857657 0.087638524467247860827 -1.4727762948076339455 -0.73231685924717204728 2.6402922078149817509 -7.0836888323447215754 0.99496605555450823299 -0.77705321176934549765 -0.60381523073829612702;-0.27476807218744242478 2.1242538013961222987 -0.10224361192501078832 0.15341555151618563313 6.0761422198210421897 -0.79736417279444160577 -0.042660477781393743579 -2.0389755157922704321 -0.80821824124935426337;-1.8729188866945629677 6.1480674712895897471 -8.1201780722990317685 5.7507182945344714753 2.7134095779416074201 -5.1864129192265551183 10.289591242062192222 -1.0133972921041296544 -5.1802937222637224224;-0.15058421282765968585 -0.043333626066822561462 -0.6178444102195079779 0.093053390473765373869 -1.2643214881714699427 -0.11382691912804944467 0.7539797053254329029 -0.13639862600260982406 -0.69202877621836578204;-0.25022049824292991183 1.1732225542852809941 0.26697415479476804823 0.39657344370369879138 -1.0057809111590847451 2.2101731542701821276 -0.76272124562775855949 2.7757357306140280073 1.9990975624659486076];

% Layer 2
b2 = [-0.23243432702186472838;-20.5378782815712988;11.060176311195705878;-10.068720444383854939;-8.2030854539838635731;-12.231634384171293561;19.399966994618068838;-21.207646837899297054;2.3769622513339836445;28.010937895373249518];
LW2_1 = [-0.092313160925305365323 0.095637359363474949703 0.041616355538240334955 0.91024052844458092082 -0.57794609557413367806 -0.033494006957803454383 0.066187849926148817348 0.12615137780455557004 -0.34438186378050061887 -0.049714988059147216526 0.14840817231917882713 0.28133785209367973001 1.390693203318300819 0.26974527111680279834 -0.091474905862949804081 0.12428704505906586208 -3.830824818982916824 0.091038868340371281729 -0.029658656693777766394 0.53893611461915646998 -0.19280961266003307508 -1.5926341316178445062 0.21624819202002670826 -0.038615184040895624007 0.79111954193295663806 -4.5469995259560462841 0.14886170590534622549 -0.0069432205513472551248 -3.489480871674151885 -0.38620382525545193797;-1.8111984720165230645 -1.3202369942926328594 -2.0009074704540563694 -0.0020182564149979521917 -0.68438267342700664919 0.31885079106953578831 -6.390004414232245189 -9.485351921557153787 -2.6185040819388212263 2.1576419272676838901 3.7130911087490319211 -2.0034080523708506227 -4.0024082946735202171 6.6178761694245480385 -0.83695631341542109372 -0.52083318560987146295 -7.7968182488993704737 0.8886440062384320937 -2.5229095724190244709 -0.91970175391850428337 2.1763550841845979988 10.755925524508354485 4.6143332198350099915 2.6403844759087484739 2.0950698045684239545 0.84504879311834912858 1.0969309961450450785 -2.4782057866054292283 -20.977863271752710261 -5.5143866679731692315;18.324636539070066732 -7.2058618453655585157 -9.5409088467341547357 -11.64143397109787692 -2.2884228474302994449 -11.148291022755410395 18.2323287644364882 4.0788042375451594168 6.537774475067143598 -8.103280156702114212 15.289542559745973094 3.7527741941140457804 -24.265290292086540092 -2.000038437244258116 4.5327578668938652839 -4.8201929633403697295 -19.672362234388526048 -5.3082218689009659229 -1.531974966522100523 13.746285091243438004 -1.1752969095169276681 27.615841726429660952 11.519436156894940382 7.2252033746335939668 28.223821076508823325 18.650969123899599822 30.300097928455720364 2.6801467500932307786 -18.220454033294249285 3.7139566580989118449;0.80763928327903422577 0.87671428140961693565 0.60515531583352122347 -1.9870174922954122465 -2.8851349668441681473 -0.38287313379687470949 0.20673659496725760309 3.3610074225020922789 4.2873708172271909334 1.0064182580901679387 -0.51641434711296319016 4.1770163155107473685 4.6957495338629646753 5.17914953198659056 0.38755361873573890286 3.8558377965675232346 2.0489568342962138914 2.1547751335753693169 -0.99750017019247771977 -0.12256980972789086048 -0.95626160201329790667 2.8633387182036882379 -2.0890743932445405839 0.27427966766997402548 1.5848359761161281423 -7.2729328588500488095 -0.052672180131434452599 -0.39673572253743816241 2.181416091531008572 5.1695871804587403275;-1.0248903117598306967 4.023394418105054271 3.4719241365044970493 7.6964804832205917506 -7.3207597795736845114 2.047784917955874473 0.42421640904593155286 4.0868887932070894209 -10.043854292899276004 0.3483841292102995979 -3.2535717660992551359 -2.171069694363491287 8.3999805296327352266 -0.44965055309805257444 -5.2217010775603425188 6.6590403022908493114 20.644227390766715757 2.0182506664364021631 3.1631186006510354503 -2.4354527089840796172 0.8707905042936288087 -1.3162647740887682968 -4.405453651467573728 0.041076358032648238594 -1.7856100207577179084 -4.6123242410493618948 -12.858846872865511202 12.260523218576157234 13.07602365360470742 -6.895875857701577516;-0.44559102675814910022 0.30048654005487884788 -0.034260040961091808853 0.32752680330644790008 -7.6201754717108611814 -0.28009763223531924936 1.1495570475369885077 5.1969268088113000914 0.020853325925536764229 -0.044739605254462543049 4.2083684238465837169 -1.1228695962199257696 -3.0930496193376741942 -6.4006958539220608628 -0.69346735665559122719 0.22909798117545376872 26.605878985722963392 -0.44235659645720665223 -0.41153443301037195834 -5.8253055863742648768 -0.67786519175678805471 18.033314828801859875 5.0004460374661983124 -0.65304843197889428374 0.63482695301907732244 3.0972723045376855389 0.15844562691561367429 0.13403554821368696137 4.3606952436490811209 -0.76833538086165531489;6.8550060175057412337 -4.8719845838584658893 24.698470202283953512 -20.070071755763244425 -11.813316103613653141 -2.9578823679175005879 17.180525528063682827 11.123807494257350825 14.570032073233916137 7.671015150819489925 1.1678292367803331242 -12.496793576472979836 -23.537748558974914914 -13.425056953573394125 18.164522481763718531 -33.295815362120897873 3.6653120626793476156 2.9227022830092197481 -4.6403148439121961744 1.4020295228876908933 14.813340412343595887 33.322439811332642989 7.8009552516594728999 14.336432803479423725 -11.789304659943102394 9.5308386237462929813 13.253614253222425035 -13.164591332667091805 -37.002036895370522984 3.9279241525321046957;-0.30002807547560672585 3.0680691312735000054 7.760244714547460454 -1.0448406546576505249 -3.5957419443986782248 -6.2311614747703147899 -7.834552580111660447 5.9787445870092508216 -2.3425645902459546477 -2.0828269277267894566 9.9117762311998536262 10.238529621205074704 11.74289194391249147 -48.580678923593630714 10.600182669277364411 -13.025266067242636581 12.676404090591441687 -2.3135399437812016465 20.862190769598925044 -6.8729907072091309672 9.5243210778184153043 4.5971654622020627912 18.9842948954398274 -21.392665451053925807 -28.440503251850241639 -3.3022230338490730084 11.683014325875427986 -29.044054806589219453 17.807196688119415029 -9.54897230299702926;-0.15454339783410508957 -1.0562751288529628191 0.28522349574348404566 2.9027032557057443896 -1.4300653729188272933 0.2363648769163728125 -0.0025466561121992000241 0.13361025985081775858 0.032397704916356601101 0.29850651867448763088 -0.22080991307089839482 -0.10975925459255915506 2.2432146568038722201 -0.183267830517271052 -0.062631242756650190584 1.4315157673004867966 2.9002015469844120155 0.89628124644205187099 1.0101567180528336909 -1.1641723527448986086 0.26557104033761047557 3.2667075119550119666 -0.73238064240561551177 0.25480895562246669295 -3.6584809690064243881 -1.844263810933370662 0.062997304653268554331 -0.013508892335005115437 5.8489540198095131274 0.46884890619694680192;-10.829763313857130314 43.660151335666967043 46.335027831689920674 39.374732411590670722 -7.4447669089094610229 43.521521875539491475 -8.7878158050927286382 11.794891372024498111 0.19426175863875441707 8.7436513535244824169 -13.778923312002845591 -12.376914196861253714 1.9311942085368942745 -67.52086368120961879 12.16722950193474162 -83.094883144071971515 20.830744727517547688 -19.539893231582507127 86.647018360615504662 -35.651405691756508531 42.289695008932092435 21.829354491926572734 -9.5373249834511106826 -15.186660530210474462 -85.543853370860929886 -8.1058118457532746248 -0.80075051358194415663 31.323677069697257735 27.969792127294990536 -14.915314647966109618];

% Layer 3
b3 = 0.7507947525840299452;
LW3_2 = [-0.64298014128449243465 -0.0070064693879211799657 0.0046179014942159032214 -0.0078327753889618975669 -0.00290705169633499955 0.035932565752986714291 0.0024431748295100593794 0.0020624111814549527313 -1.0641143433277053809 -0.0012933784971755411634];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
