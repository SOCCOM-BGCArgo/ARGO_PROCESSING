function [Y,Xf,Af] = ESPER_pH_11_Atl_3(X,~,~)
%ESPER_PH_11_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_11_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7053338399168849193;2.1423205362350214997;-1.6069282820893728836;-0.058907438929611935508;-1.7246949505041497819;-0.62531529180613898422;-1.3368139273212211737;-0.49810246718381778752;0.38341887992394713125;1.3108452104856116449;2.4524512672774942956;0.59716101138755772748;1.0211781458936930456;-0.21264045921337454415;1.2003012100105665549;-0.13281618755021112888;-1.1148737049270709409;0.98515188203433079472;-0.80850150527849495852;-1.9235583895071497462;-1.1525704530590996644;-2.191666362663839962;1.3926970992982727893;1.939003534164720266;-2.9830326509342950381];
IW1_1 = [0.93864495195521513438 -0.6658925755146690717 1.5381235200598859514 -0.56422402410438188269 -1.8140047700153969501 -1.5013578581804938317 -1.0772420038986028068;0.52503811382782372696 1.6447179104220610579 0.068974757113883941595 0.22643139311374954614 -0.80787576702184249466 0.066941348082889262638 0.48021483779206702858;1.3532709986129423108 -1.7608362524488552214 1.767293184402747519 0.81904211910886148829 -1.9172316193885550195 0.76490065584475586125 -0.73196616088773414077;0.78708785144287718438 0.58669806080613051691 -0.7372330495821648455 -0.13079424639356712623 -2.7943778350525145804 0.9834392257653652436 -0.43676230814117333878;0.50844006840816879933 1.5022818635991821434 -1.1988238790513288112 -0.15750673582439095322 1.4075080646069446644 -0.27787813659964277768 0.34449844635184723174;1.6002714617404392161 -1.0818128565629760995 -0.18781389937097939247 1.1797448399971850463 0.61774284581955596352 0.95127140686659361624 -0.83706014830939223792;1.787064089176071402 -0.19079313858206253807 -1.0253111599724236136 1.1334294340418675784 2.2316722137657314384 0.45675668949816861097 0.3909057577348041268;1.2487328047689090216 0.58636100140053792895 2.5829290490333849384 0.1777097060339715151 -1.8617685192922650561 0.37767060723314743731 1.4714768236693789305;1.595231502364332643 0.19815141187886448071 -1.1887899532669676805 0.63440954295062024215 -0.3908231045563372863 1.048377349765412303 0.535703671660530234;-1.0025230510168043896 0.05838670225235115252 -1.5063840763104769938 -0.043974265730116618434 -0.40160843716221011901 1.1849318719319503757 -0.078252928769526122754;-1.2717264584390459703 -0.040359547976695865634 0.31241648217046724678 2.2810311470734130346 1.3551658823655756692 1.4585949702698137731 -0.52561553872912869512;-0.48562869912873729561 2.2586993448875656298 -1.1772779040383456461 -0.26024630373023110996 0.35816143190679311514 -0.044018340561870671068 0.19304095933956394449;0.79167941035617594991 -0.35867089266255142155 -2.2933945402507589506 0.78599307170688992308 -0.11595410459104771306 -0.72846912557804843757 -1.6345282396244882328;-0.3004567023538964321 0.2828152236054524149 -1.3358085630780582864 -0.63623799359404731302 1.7595760312748873755 0.066979671760276165982 0.25905859927232588458;0.38692008271370453842 -0.43005067847527755909 -1.4745407123083940082 1.0128980147417869784 0.4442865107799513491 0.68422508402279924589 0.76092067718751477123;-0.78404835095723823812 0.67192299835156699128 0.20507714485289241235 0.75465217030929443442 0.40442233133766369857 0.89174685715655821472 -0.39714421812673866841;-0.33825334042456861594 -0.17746098331500301248 -0.74261001180112762299 -1.2849657205208238064 -1.7357421341040317753 0.63550844754875845943 -1.3823033989344220007;-0.68123756684162717345 -2.0689902584626818083 1.002809425423251577 -1.3120759363687430898 -0.15557074090876760186 -2.1939465954454795416 0.4420681327550807227;-0.77664629251855243908 1.624157826589678999 0.58845166456422137724 0.92794934240653637048 2.758903278411984239 -0.79928527475941391067 -0.1959640918283673261;-0.22115985211304078906 0.71880006327972090219 2.6547042651515146972 0.3211181950047501954 -2.4993677013780919438 -0.57442758022197448753 -0.96889246018248575965;-2.0366166208981750785 2.1775832899698630563 2.0023677489246773931 0.42847483547901915601 -1.5301503808037248966 -0.30615440689916784134 1.6771644916104488932;-1.0184929372164270855 0.55150517901715001567 -0.47121825016054186275 -1.5727212702155148882 0.81746784880109790716 0.97083550049892031186 -1.0322822571579151063;0.086629901122103891709 0.17047731006490310368 0.34574258617265535287 -0.058672547744597028374 -0.43564246054207778069 -0.2779954117468353969 -0.57924317633835553654;1.0880475052118165902 0.21651013802375471129 2.1424052077225659296 1.8513935687677895991 -2.2640941346291243441 1.2605268940824834178 0.22687634609369844441;-1.4573849798068803096 -0.10555428326847612897 2.9417128076406822146 -0.90902086806975546107 -0.28030899556891758495 -1.0421116938883183689 -2.1534943330501041814];

% Layer 2
b2 = [-1.6689922667654384369;-1.6968389008190545297;-1.0214969467882699661;0.16043770197248075071;0.95367420260463076076;1.313171174197283797;0.78641516480194073591;-0.70931485535633376216;-0.54946847922836528078;0.0045751875955897620615;-0.014160983073181128075;-1.6088292791645937285;1.0334787812827899156;-1.5025268660181605451;-1.4737666560248965375];
LW2_1 = [0.65566073424240955969 -0.058596851974906064009 -1.2179190160620421146 0.13560490867448582453 0.30680289728972548469 -2.0106890562978012582 1.9468165491694937597 0.30191385755070609953 -0.041091139919706851091 -0.59580958732362887531 0.6369723929408714902 -0.17521816012917384997 -0.009230079556593356882 -0.53166791899232235252 0.54448189747780406655 1.4854235526587959981 0.19969001106622816244 0.55087012446121652598 -1.6807054001701162704 0.27839989867823750069 -0.90299591986347316208 -1.0413646367836157935 0.060171143782732729177 -0.44875436437480620278 2.1461648771033488003;0.23767228856725289288 0.0072382739495223807902 0.0025928923556907436387 0.27891183872267416577 0.51058745619871903632 -0.52008443041872198798 -0.1373454870783460402 0.45867826584189136385 0.060760437493043044366 0.033563624361768892856 0.11019037613002022336 0.0081907493023360214424 0.97561220288722960703 -1.5765077842831807242 -0.39653374940327684728 1.2038340298354859303 -0.2537524115300219818 0.56924537862712787373 0.72403947376351129872 0.75069424753678615225 -0.24527489969418497795 0.33822304537832997839 -0.60427298619916902656 -0.70960398393433643527 0.5594569006124064936;0.52258975113552230685 -0.14350289732242418883 0.4217236151403658817 0.80183037638906884403 -0.062276519613650736795 0.41817635971927896721 0.61570784727166771866 -0.65623423477471354293 -0.53020915191022155444 -0.36737420977764184693 0.10874093845207991049 0.53238094586578132983 -0.31075728379970474213 -0.13495057226246132132 -0.6354723907440187336 -0.8314579579734537873 1.3821706215207620883 -0.83136746638359670936 1.6879774777134304298 0.38727389749420759735 -0.25996837534993910701 0.17114777366217198695 -0.019673417808950360158 0.473766374561956638 0.45962707933613905498;-0.22483070513120828604 -0.40881615819765249054 -0.36211521565121596034 -0.67828319593880803673 -0.11629648367426785593 1.2323073756001088341 0.32634399891421717044 0.15859967257677204389 0.62719308577597021603 0.19354592377968121708 -0.8462739131985389518 0.41957925593075229287 -0.8128416825094842979 0.30651771665918009502 -1.0474336445517062888 -0.48237417745452809692 -0.061626092373936833257 -0.76349918860143617394 1.023310161426838949 -0.082913222089529975412 1.120003191245566132 -0.82097243793993091021 0.44619118066980273385 -0.24171414267414106924 0.29844154388630500518;-1.1720893172251094505 0.31382868521377782489 -0.23707424595338894013 -0.33844265259310146732 -0.080047018268845665512 -0.64485603306293948211 0.41503574383576674611 0.051287198128327743385 -0.20997228445533200336 -0.29816639012684470478 -0.93932854639922547246 -0.47539954648903537393 -0.94706641703012284239 0.3820258398911164921 0.065341612484662831006 -0.4601713823651474855 0.39727069936344772128 -0.27346255942062819289 -0.25112791639775988717 -0.47797145686581399282 0.028497301503070421314 -0.64135651600751109047 0.086004506526863033766 0.3696843024379058984 -0.082458722406952719708;1.0006537756569580111 0.25187354284697849316 1.4190565375252037761 -0.13610454475219072035 -0.26702497337986563775 0.16614467610416133736 -0.63291080201051808096 0.091068429577890477877 0.4518649671489358699 0.35257443132233390326 0.48939198511757753263 -0.10454268857109630386 -1.2190127929399443563 1.8407109011975344437 1.0211886775318190779 -0.40184548954755711092 0.27324417165252778972 -0.43368542121510167409 0.61830653234951093999 0.90721735192927976943 -0.37520056003486962348 -0.82293545277465940391 -0.42538738279175580814 -0.22741292950308392151 0.38740839069531213257;-0.18430717600306817383 -0.058756096111333158682 0.1847155268450041965 -1.1499476592925055307 1.2652677807178560609 0.12293139158966215341 0.21950898693294013109 0.38631231479698785458 -0.45813036247298505321 -1.3567113410693287801 0.57406142535510618075 -0.58250776751085298066 0.39308093691320122876 0.25796742146388140782 -0.096638748193621532012 0.52715948277640989339 0.39215237855173329384 0.10969898309284473181 -0.40538989662283725357 -0.057936401937168056919 0.29886348222906061745 0.83220477033804796108 0.19950474879761620484 0.46294966638362511357 0.24271118292060317456;0.6442019055380836523 -0.29457818009274894244 1.4569680465879188969 -0.22537368821288669696 -0.52970010025605285264 0.14683512967740208754 0.095062206807625088123 -0.64461456786529114371 -0.034208011278694328006 -0.61306299849888501452 0.61766445094500987967 0.46370586501609856178 -0.41327623877155139631 2.1575685394371015846 1.5180385017606294884 -0.15758323194548295998 1.0112867270837710976 -0.19212118811245315619 0.44926022477259036636 1.9969230634680121828 -0.8705059375039905234 -0.80296328521331250538 0.39673846151688230144 -0.23941013135773944742 0.77930616844219002814;-0.80260176243410730201 1.0544601214123336952 -1.5542074126437859238 1.4915363922925728435 -0.77516569789316480676 -0.11386392211368287497 0.48140724706582910253 -0.9076379907615552689 -1.1705196129485475609 0.43767918436642944124 -0.061506233952935765452 -0.70403625773192635151 -0.0053873771147663201964 1.3646091621735254584 1.3605109558149299787 0.20224306789181817345 0.56534969301899906657 -0.53763440145993013353 0.83787117423870416388 -0.92732512607872541466 -0.87042212873052027255 -0.65966084707283334509 -0.18869374655859366685 0.41252033580827168757 0.30271060250396142344;0.59104733466821934851 1.308209917490421148 0.93372578470960232444 0.36204848649685422712 0.53230101065496415735 1.8034586166299781951 -2.0892047810747356174 -1.2471370811629181041 0.48273908542202748073 1.2577132555264027847 0.995035066017156411 -0.39861395738280569478 -0.15445168335064463072 0.60053131837467044196 0.58715508600577270837 -0.33908604067867043064 -0.81513650790770553201 -0.056900355885467858441 0.64282048885312670361 1.3053643401579479999 -1.1161032236816290641 0.69193699207350434222 -0.79573174085940800992 -0.83184634348743646814 -0.91808734587982399056;0.94610845557840361764 0.66721485798573032522 -0.5087094854726489368 -0.23991029901001975633 0.65076822665538636148 0.31453486273138187013 -2.1368845302668377784 0.5407299465217474399 1.4666330765169945938 -0.63525869963383563288 0.72725493442550848133 -1.8598969418544566423 0.12058025534408284285 -0.95524357246251812015 -0.022433209034748300553 0.54647615096772883536 0.58508767235033065646 -0.44590335368818773132 -0.426509116536081756 -1.4321229917982891688 -0.85428123004238198934 -0.70332244650998765323 0.20656527115455569632 -0.80406089930019286616 0.083531503846730040252;0.89511364374324053905 0.032882007226582042614 -0.74541060206897946649 0.46887714133965718855 0.79435097879455873748 0.16784567814988310408 -0.22875174953101637398 0.39015942238782558293 -0.27136020822519812956 0.3639780372285900123 0.14648145325408640227 -0.40969018216843772207 0.45309018585139376745 1.4547896698202287258 -0.86515958583779295488 0.49644637407889879999 0.68516553394866819282 -0.017825453510601201729 0.44743274679588462828 0.55518531402744186742 -1.2815424411911449099 -0.46827083365206711996 -0.94527754391391805022 -0.4551988189293669218 -0.24506697167092464373;0.65744013448909266462 0.44890975425741741489 0.55089936247737647523 -0.24886154120639311649 -0.46366032689675146239 -0.45495347086705589801 -0.71708036547763209789 0.10341266469815572904 0.40328568879923759605 0.95962555834482321515 0.44790030689226484339 0.43983294051598265106 -0.27887284684389263001 -0.078071985486294029344 -0.12348289961429112505 -0.54587579887218051766 -0.40090271165592772373 -0.23508160416063128562 0.37730527901417310055 -0.22299960469677693187 0.57812916523240198696 -0.10855887978310910236 -0.21403990060462729783 -0.091007757320016285929 -0.054001951013260253431;-0.82395337161049886365 -0.61172091481635970656 0.62969847529412559251 -0.18488035749193654222 -0.89278274638332422164 1.1415586122614747033 -0.43706324306055155393 -0.45130245060542961699 0.30390798601505814025 -1.1328315333305962742 -0.23996559780520715366 0.060087883167605202206 -0.0061642288024295176924 0.561723443442761039 -0.40397975168665073431 0.26997354988253885466 -0.34045813728302504186 -0.0089924360255751595306 0.045078809837962599549 0.67182507188571005674 0.17683234166176617363 0.37799856977237078492 1.0586690097868109994 0.12732293170375924563 0.016289394601037759935;0.31855831257226813191 0.77431470485637121648 -1.0669819598784122672 -0.86481340743783108316 1.011374225353603773 0.48106406163257742215 0.89836731866157426563 1.350181027580831028 -0.97467917736639120285 -0.66747159575916015228 -0.43088362339969404902 -1.3529713444373969722 0.69221836177735540652 0.18469910404959935524 1.2773072713714224147 0.8027860998485496502 0.059699645942800833032 0.17244482206346900544 -1.1647935280946719594 0.47192709597411591771 -0.60309272606001151917 0.65928998575705577423 0.28216302539663135063 0.068850024850476157501 0.37418090398659192841];

% Layer 3
b3 = 1.2626014766900073294;
LW3_2 = [0.91055646897611708379 -2.0662429971461948597 1.7865312481100916742 0.36680668949850658844 1.8253355724083877298 -1.5866951031772149605 -0.7343217039984965 1.405162111353612131 -0.46080922604325380565 0.96108795484379816454 -0.26682026402678843402 1.7614925378676193901 2.0885198669107709613 1.121698951492211549 0.83101207474919869256];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
