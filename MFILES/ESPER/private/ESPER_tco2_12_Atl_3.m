function [Y,Xf,Af] = ESPER_tco2_12_Atl_3(X,~,~)
%ESPER_TCO2_12_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_12_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3236755280322583;-0.35623392150947053;0.47895178589376552;-10.428736988790028;0.64209623244783864;-9.2405972163900696;5.2782641394722258;14.268990595152077;1.0810400632867934;4.0074522280104468;2.6190967576794941;-0.92876334848247954;8.4338428618758581;-0.21389478330265277;-1.0217100040201368;1.3004492540838219;3.1204176574309543;1.1351109718841974;12.552634506264219;-8.9146156432495527;-0.23677507632735956;-8.2713800252050333;1.1608276566137798;-0.74109715409251742;-2.3420309479894543];
IW1_1 = [0.86444391576828561 -0.19336466488249052 0.36354421528206599 -0.25875374166583598 -3.3286928361861543 0.25934860692047124;-0.84238647388070176 0.084956927948105748 0.07139675860212312 0.89949854201491186 1.9539790028000195 -1.1464188258395327;-0.82760966271346903 0.24994734475865732 -1.2455388429344538 0.15300549040617173 0.65918540389397917 -0.60428530741218756;0.67765790723384411 -0.84122734213426054 1.9239480531073816 0.13223173217434644 12.773064838160385 3.389361321159758;0.074562235251005346 -0.1129914665942931 0.10527668284533673 0.68431041113240998 0.46343013124877908 1.1085760436345744;1.2593085244337996 -1.7390234052391431 1.0361915510107591 2.1612958975662551 9.5271625552945576 -8.9587856460674278;-3.684614232308999 2.7487154575095727 2.6512192557992615 1.4613252963335013 -2.0104638679545093 -3.9450999650244269;0.081535793188638919 -0.015206395106918194 0.11630270195794125 11.640975171241172 1.8781725185699341 3.3981849414643972;-0.37511309402338378 0.36405347037517899 -0.79989431658698673 -0.13317735484889492 -0.21619736895920375 0.086564088316256144;-0.319070123712201 2.28342304296328 -2.0991573407404998 -0.58057540087346893 -9.6674091866932681 -1.9235278115901815;-0.56951627487039258 -0.15697077745809318 -1.3428676244096247 -0.55838788685038254 -2.1332771457455166 1.1000019550614493;1.8720074300799501 4.2980277300746739 -1.55130296345298 -0.21005858162784805 0.99364096812327596 0.19207206644193209;-0.66821507677032821 -1.8466238324172159 1.1641472383754203 0.58308287528026603 -14.160155632310742 -0.9768329454643172;-0.5074883645636119 0.7861993696715095 -1.194679171729697 0.026711865640470022 2.9879695964742554 0.34996126532372129;-0.0044316037411927202 0.018925314928701052 -0.049311543876931582 -0.83563639018369118 -0.19286486331644564 -1.2237199461020092;0.74927742153459442 -0.36169132157687939 0.61609210928881719 -0.19704217899075938 -3.1823200288183582 0.45270348157901791;0.65706836665091628 4.459035715759561 -0.12538269860394657 0.36320105617152953 -4.9681286977764101 0.092543163784359866;-1.0287516274589514 0.31764129563522425 -1.9033112316103773 0.20974262492883039 0.52389287856330879 -0.53232385294367679;6.0137185738174628 -8.2316335111341719 -13.655825956019646 12.324528181966299 8.0794879049726127 -1.6205025079801785;3.4576113636772385 -1.4616089864790496 1.6673870100309014 -1.3779269521599202 11.611135737168148 -1.3202838678573874;-0.66554281624104039 0.0005239534246980421 0.003450961832840843 0.39517175086817913 1.3748201941230642 -0.67436939871108281;-0.59453000740626805 -2.9683659336619455 0.52757350751704146 5.630559323036012 7.7709203063485841 -13.536480541154702;0.37844008854985994 0.037577270851097536 0.58760655777117565 -0.025553579714341759 -0.82872880172478447 0.67054565583468495;-2.6543737525281648 1.4383637355445202 1.6579071119985689 0.2003258753521828 -1.2289229807753341 2.579524231845058;0.42219782943549033 -0.46965299274836048 -0.81535384480253692 0.096808057711009032 2.2898365340167746 -2.2443757501537882];

% Layer 2
b2 = [-20.979693129478687;-5.8952800279696156;10.756649032208152;-32.236232579636578;-16.605099539853565;6.1552253687379146;9.3559825831467247;-0.78812756026090736;1.889139874918625;14.178195484507752;-3.3552014970223292;-3.0991234943261854;-6.7654341162487928;-11.96031665343631;6.1584217345830199];
LW2_1 = [7.6084953366882564 -1.1480212514753934 -3.3465344617833539 -3.9792244169073441 5.8541667454686355 10.572001509599126 -0.3086950516851617 1.8165859334834267 6.786728221825701 -2.2569057189090413 -3.8930795462731589 -3.4011762173443536 -0.60605902646507848 -18.156563379217804 3.5257098371744573 -21.230685115855536 6.4097915668900516 5.9354537373991638 -10.172295342094722 4.8622875695160142 -3.4771873671320312 22.694204570321659 -4.1944950340774163 -2.8010342895101301 -12.023545862484259;-12.795732709510492 -0.73706440246040628 1.1692081424833447 -4.2061361435069866 -7.5542281686063992 -2.6570698749333728 -10.263495848256172 19.574219636704097 -11.016732223938465 7.7380868557749105 -5.902955574103447 -4.9213014057526419 0.49896759882217645 -13.324888698623045 0.9427623071095429 -11.436731747637667 -4.3695743483906098 18.466676733318749 4.764956987195732 2.3119236911263932 -1.0764603716128014 -0.95869851719722021 7.8037645756882679 2.3414380659048937 -19.498656885863387;-18.325333698953393 -13.660398063056844 3.9390145637006051 3.0723670235510814 1.2079177564948467 -16.642105606018202 18.740434263981406 -3.4323312962803474 0.54684780688452972 1.5765770910248009 2.2505929857973141 18.001744503902071 9.5507558603531422 -4.2447215979387458 6.6540136946078192 11.31836575770069 -2.3584237471596885 -10.598371132891218 -4.8558815039129879 -0.70955142248902814 21.859781085007896 -23.264555375200747 -22.873674370243915 13.879276904368261 30.161942063367075;-16.738801434144488 -13.947109442862645 2.5292739443641246 -4.4016980917242323 9.1356660969794117 -8.6411425936946351 4.5578459763015848 19.748558342217919 -0.82481076718055057 7.4026910522156539 -3.5619608981078708 -1.5091380983085072 -6.7207629346671496 -7.9612398087398324 1.7877127846683933 -4.6082923382819638 0.47907330440313028 0.95582471484475195 -3.2416026016910848 10.354174920852458 16.021910622075872 4.2104690734555783 4.731312959214133 -0.70796016748685753 3.8995091736863339;6.2991583942400053 20.285760185657075 -1.0988799619919456 6.0371654258731526 -3.5586247606569779 12.83388799364606 -4.2818116506281934 5.8274130049807749 14.460130407607434 -5.793395082504321 21.394766060418231 12.903708583624471 10.97905272546855 4.4951703200485218 -5.2780155649302145 -4.3082829860413545 8.5678321667549024 7.6941776481412578 -4.0677821796078222 -6.4431545028993797 -15.556529699391382 -13.706074927679214 5.5541659662274911 -0.78387948532819118 1.4645425083994463;-15.956109469995289 4.184551924950954 -8.087915176577761 -4.0196583491417801 11.108467286734806 -16.213850247263824 -4.24586763149407 3.0243268714662266 -6.3394923795918858 14.06082534958492 -0.76590882319629772 0.39108280182709998 3.4315826591993148 22.468553398701278 11.70022499778522 -5.8191379944636639 1.0485606582620475 -7.9467180740737655 10.365100703457479 -1.0751572378228522 5.6703508573777297 -0.49557928167891507 2.6071207396808949 -2.2757283104977741 -6.2934790664088442;-10.059984434667268 1.7832289888560728 3.2957621985380672 -15.433409206182318 7.858800196258918 1.8157186021404326 -2.4908589952734514 -11.378381472793301 -9.4122456361543456 2.317822385005083 -10.917049121874539 0.90105712590751741 1.5372862340799014 -11.431231293126814 3.6362996769771523 16.600415160267193 0.14234707621460377 9.4070193184674782 3.7094925127442022 -4.433512565020826 -10.877146325618984 6.9905198481783497 -18.311894012350702 -9.6869647256735849 -5.7948852748971156;-6.0156329444488419 3.760327977769256 8.9032038297222904 -1.1143851868724917 -11.553386314978964 -0.018432568567157064 0.070217662907867337 -0.38767960102421994 -5.9207922094713004 -0.068713612494644638 0.13817368093489313 0.020101627343819491 -0.00011520407872565256 2.9222644337718657 -9.0139318088329805 8.8346130655506681 -0.058175198053933105 -3.7245870583620539 -0.093410607261862511 0.18885127262879894 -7.8208232723333424 -0.056295839265499775 -0.18282342193467524 0.20710982286456606 0.21341712598975482;-18.587208987877084 12.750376139989894 -3.2717422161964191 -17.546450308772641 -4.8643281771614095 -5.3997001854895386 -0.53545548081684546 -13.191757364258754 -2.8630933451063409 -2.4781569266563519 4.0759426531321754 1.1032982765895869 0.92305199841682728 8.8244575795950144 -3.7749430437330744 14.816382437190988 -3.233123675035368 -6.2810174420954539 -1.408322622930499 -8.1603175242330721 -28.4509007916968 -2.0705079736737142 -8.6323768224615964 -13.69055848790766 -0.98026790919270135;4.4243097362307999 3.1485029985679707 -10.390243216695398 1.8234480314363863 -4.294467559525069 -1.1909338520482766 -2.2236376301406233 -2.1125690499940899 -0.96275478667990355 8.5170551882751013 -1.7912524392104681 1.3856285392089847 2.1072383523286944 15.956026849656878 -9.0607715565243083 7.2018213665862403 -2.3214141174045682 -9.7394396035051187 3.0306994972767813 2.7260370766724704 14.329226465889381 0.30579565871301689 -8.5356666800415795 -4.7678781596654627 -5.2732230998593002;-9.7698324976412572 -0.36369403803904921 3.4160485462261563 -4.2103443793776618 5.6296781192844856 -4.0514542044672597 -2.8146101815089208 10.558717114841709 -30.327806815488547 3.4440571517537619 -2.2059659576893704 -0.4349765528391295 -0.51414073518547265 20.311590208732131 7.9126914708803628 7.8614146347391385 3.9504736822764399 4.9741416634586093 -2.6105295038741461 5.5079819776772601 -7.6988307263977855 -8.527921707160397 -4.0169053975374975 -13.730087378136121 -5.6207011235522213;-4.9229891675427346 -1.9646190624614401 -25.837936296276997 -10.459825529600067 -15.552706251742958 -3.5897808439793746 12.562587611558921 -14.399126063311174 -5.1328410456772051 -4.4932444453174467 -1.7547151336521116 -5.8830215233922818 -15.263902619448844 11.615880863475351 -19.892600412245777 -6.888632106260089 7.5228033404107792 2.5240173459079949 0.2828742714138659 0.11420241425581705 35.029267577513089 -12.237971122483104 -23.395597348837185 -2.6719626853637344 -14.945055953488437;1.8359111063022047 4.7838573887190963 2.8124790191378564 0.18373471010943715 -7.6805681026463324 1.4621282672838418 3.2196640350424088 10.527176656742032 -3.7666922086831969 2.9188611753759948 -0.01829704880343145 -2.3538923391470949 -5.6175026659705782 -22.661672485764637 -9.5933220997171897 0.093530781277040093 1.7046358520530338 26.911615371796966 0.58222872674286519 -10.583692051810131 -16.352245709733822 1.7971418091602875 2.4737434731509609 27.719287894644566 14.859116047272119;2.5367144253432889 6.1714905189882368 0.58011140190595401 7.4860144706663583 -20.052181693946221 -7.1952182887672578 -9.7705544869098784 -5.8236222521201961 1.3448290761481247 -6.992704978182009 10.049990296122644 5.3838649599540478 15.591852815478576 16.994502958768862 -11.069693391631846 -12.891401365159522 -3.8894405708235675 -23.931772701902005 -8.5005628977257786 8.2027706160993379 11.323010682129571 -5.0094146909024602 23.726803684236202 3.4016229801420823 22.256649193664021;1.2528321699053797 4.9179691174807516 -1.9387077746002337 -4.3606967264573093 -2.1622833322048773 2.2928800124114783 0.61193502078960338 -0.043502326128267842 -2.3212523794577251 0.73613341661818421 0.363108352894014 -1.5406481549013396 -1.6283916623936388 -1.7287279980171135 -5.5571676320393166 0.73469266521618826 0.0030606704759062291 0.39159259917059869 -1.0649533682802248 0.80654222449262403 -9.8483369560046814 0.14699817016499431 -9.0950061921118515 -3.0024959245163712 -6.6575948233475906];

% Layer 3
b3 = -1.1774647041600586;
LW3_2 = [-0.01835369350412238 0.0048947011042401499 -0.014873551995162606 -0.0066438479218568986 0.0053108401036645716 0.0077757371205046848 -0.018544327506769206 -1.9762825986058772 -0.019341502111367037 -0.02372563168519783 0.011207516546475938 -0.0047950903413739449 -0.011025938300320297 0.0037443779990642819 -0.034403997457994662];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
