function [Y,Xf,Af] = ESPER_nitrate_12_Atl_2(X,~,~)
%ESPER_NITRATE_12_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.5967402057895241363;0.79495649103911292244;6.7925496611595654883;6.6181605191514956132;2.8825195703668029523;-0.020267879810007747438;1.4537517328486020407;3.4408680988505544462;3.8484222445960600822;0.87526018323345078365;-0.154155590989971919;0.88841916152782318683;-4.7057758797535251816;2.7964977059954292393;1.9504226648059035387;-2.1464144057580094582;2.4873984041807895018;1.2162385365460617326;3.2911059929971799853;-3.6430854264122323194];
IW1_1 = [-0.75188793796696995475 1.769778743149589495 -3.1895272794418332296 0.2635426506139775249 1.4195739154330309084 -0.95944147548681235627;-1.3256359848401197965 0.045608571596570481044 -1.914584125867182518 1.1287586443315689166 1.2951953194637630951 -2.397015959006278063;-0.0053642820698196680071 -0.99958532416425649458 1.3644654417103050381 1.6446673340102830885 -3.5552171747030030247 3.6331516006933592955;0.37332632265260606852 0.6917547147314890843 -0.44220262619487105127 3.4406278410713380111 1.3628802908640706981 4.486657708354536922;-1.3565459982699794583 1.0457443513954924885 2.7791826471613814142 3.9468151306003624867 5.3148032069247754805 1.4735808026408092619;0.41263650343532770615 1.6941447075559021851 0.71486245728095965113 -1.6846802494520016769 -0.37189381130777171558 0.42752090354466365518;-1.3697924239407619496 1.0907069564251066218 -2.3798092632425156268 -0.10695901566522227066 1.3215141101025755788 1.769008333998981719;-0.12364416386587880059 0.050167991833021806369 0.1621482990248817313 0.18684133367091679268 -5.5897468097126594699 -0.55394343210023500035;-0.11101563473237101298 0.089224290353153934419 -0.96934329635260552127 -0.55154116489450455418 -4.9957162097646730103 0.71502904896896168907;-2.6884349897252692863 3.4671663826023157995 -0.45270239150078595003 -0.65890164872083545333 -2.9919997217900387021 -3.639017738593140372;1.3849448291970059 -0.86270023510893978358 1.8212716011752427825 0.89349381981581421641 0.68981253232862382863 -1.7744529321518305309;-1.8461906176894018472 0.36524252727815120778 -2.1704121475721267487 2.5374562447644137819 0.67839524536459394621 -0.51322899646498509885;-0.010742742457196278669 1.370872888791889066 -0.9800152229949319338 -0.004950518448297772274 1.959140243562913497 -3.4768527484200477673;0.13063973310401233441 -0.74964176408481630887 -0.53981905693657117329 3.493227637921318518 -1.7233241272131272215 -1.6324480703168438023;1.3675328149392504962 0.18923248793852540106 2.9401540572056292788 0.91670265321787747226 -0.11086840712867615522 0.5664956590918418522;-2.9954812560996484372 -0.0076027239893593856826 3.9506890771780880378 -1.7534959070696867212 0.0641859736608118292 1.2199304801395169928;0.26836439943420709042 -1.4099023860274273456 0.48977913021315711006 2.4028123121070099621 1.8247561705661035081 1.7463333345990146306;1.004137266705073861 -0.62282560937932518463 -2.0416957629199385948 1.2859197130687971544 2.6363959805377330525 0.10307358101711443232;-0.88745453268190332974 -0.43436043497715004502 -2.120578906109249484 0.31559366967921337332 -3.1796999936757366356 -1.9417845905351955871;-1.4084486121626855759 -1.8586513010951200009 -2.4387925041789948466 -0.33929732183354144315 -0.56926118791736313174 -0.38702064809082986629];

% Layer 2
b2 = [2.1493999095273212951;1.8459240687494284927;2.7878486601132221878;-1.8916377599347020677;-2.5771633382509904209;0.77756322576845615657;1.9555910888163900996;0.60030004725787033948;-1.8684735151840103917;2.2252189146881997672;-3.7401153236796162993;-0.30582138820963089554;3.9598172071334118982;-1.0769969328358124372;0.40300286537526297526;0.79493388773800344183;1.160780879487392836;-0.80168941281667005505;-1.3173054245815432051;3.4532584731841211578];
LW2_1 = [-1.0764922167765145211 -0.61839709322161795502 0.058841977909053211349 -0.74007165301050459316 -0.33351650786517444969 -0.47293017731357805955 -0.13231463206937330024 1.2890570876156730584 0.010053080317686015344 -0.5296631133360099053 0.56976973200648506346 0.40914741493834289043 0.30309027440758612437 -1.5913377084850151011 0.95908576373563603212 0.46388005159415551804 -0.81953277537586111112 -1.1366397843998521378 0.20111973231318253097 -0.17773171938316584262;-0.073813252513735966298 0.10505081773894442421 -0.12981256333114421508 0.13483240957560888029 -0.017527486299909352668 1.2663989074542880697 0.49698215572237458559 1.6426637606838654371 -1.1859857950842893626 0.33563873878218541957 -0.73894476461388336475 0.8843617652280705288 0.33526306780880793523 0.74826550477891862201 0.96269246226497096064 0.92648751133577011974 0.62290964966126660673 -0.76575377167000691081 -1.3723754976859459109 -2.0266189759963135764;-0.20102658212785096126 -0.88363938010740028517 -2.1253367637175233362 0.38383589170637782972 -1.0405432838199604184 -0.010051429905475670751 -0.12486865937849904451 1.1203344164114747983 -1.6653853888358287616 0.24700009863041333391 -1.2869753548636846396 0.38364204100995225044 -1.3615141899404474835 0.43403320563037883772 0.73386474131670187404 -0.16730870203094860837 -0.6628060766835870421 0.078419369018095541612 1.0280140145308960253 -1.2343341979293998012;0.14720060096648049375 -0.40889976763444885188 1.6818974312107444202 0.30615385118898630346 0.69437244601711400893 -0.21207186165662347821 -0.48484643146352868204 -2.1759351582974701955 1.5450606498308165904 0.4113818236975740894 1.2262821810020045898 0.37053959290268989601 1.267301458513342638 0.78059730500984847446 0.38777820120797212855 0.31117276998359538753 0.074948946027567131534 -1.0265134680770562348 0.13836323316012025253 1.2503257398474043605;0.51200149980925380166 -1.0975728513500322414 -2.2101429803303123123 -6.3264913217305167592 -0.4441190759342834582 -0.070355751513730718782 -1.6318350545652620109 -1.4053151500886751357 3.3346069491798595585 0.7303075501715378115 -1.8503116050759647049 -2.9065175540848402491 2.0621625743143199294 -4.5440410638651069775 -1.3960917653203199773 0.80816528344537463813 1.8383078894412607784 4.6604820748397148833 -0.80014674672024477253 0.19339105923803109888;-0.68589090535607843968 1.2249200498074717114 0.097759972972123243551 -1.0228093403970885955 0.59567375127879518271 0.82396417611737193809 -1.1736329309172914837 -2.391465142579304981 0.54699075024017851376 -0.13559392902647765533 1.5505099547752509981 0.55971339976893941248 -1.3090477399739031128 -1.6078786444056891725 0.027633366479716845593 -0.61863815404341326865 -0.87729631860638401797 1.2556446001604326668 0.032670510422540363638 0.74434314587288252785;0.43115323161344049074 0.27799597594263281142 0.049204837422819114323 0.39070193257640106754 0.23034039537174877399 0.0078105484785715925677 -0.71338796717909558343 -1.1137684890291748019 0.85701944566208443366 -0.30408726106618699792 -0.57810406122680224605 -0.13885304055997185757 -0.24262089028832839466 -0.57505660231937727467 -1.8669023487722149479 -0.11536370753583313764 0.32290872433845363432 0.30020240992565089266 0.24339232007001682101 -1.3455045267931797781;-0.41316164542258665415 -4.2154705794999278723 -0.2054812782967627427 0.83539179451001399634 -1.4328082556846182261 -1.7722855436814755059 -0.10796095617860798632 0.090965574672853391491 -0.11935336411185938632 0.17632357159220307663 -0.72602115170977365999 -2.9368524359861423179 0.40419014505129685633 2.9474727160996678776 1.0931397306648915624 -1.2374853277715869293 -0.6843142885391280128 -0.41741507520964349354 3.389007799325558512 -0.25981539880978971047;1.1119418036302730624 1.2453344278083491314 0.3296448316149024893 0.39887457233344503216 -0.16808212833445532186 -0.89501983081142100218 0.44098236653790667816 1.6180127453986392627 0.65603252896293740015 0.49598333373147973635 0.0019499091281902506193 0.33773527230375260944 -0.38168999656644281293 -2.2125650054806875744 0.43186842791958551802 0.54846756704575516661 1.4858690174435280618 0.68308461720120627891 0.28672888111588773485 0.037339619174969806981;-0.92009291477536625514 -0.76382154474019847701 0.75548579437942831039 -0.60724430408129603798 1.1498355208110793146 0.21850938335608335872 -1.2990400704965665568 -0.94404056139774816803 -0.23804750150626602379 0.034016398296698745207 -0.032441769659293309691 -0.10354084556935969075 1.0506936524112471254 -0.33467356805974673994 -1.3206868201725594503 0.2598672174304272886 -0.10398431319709680598 -0.51226536986239235016 0.73146536987267218866 0.05898112059487429365;0.27125749842441720938 0.49481481112794045707 0.12803879505832854724 0.80749656854351803403 -0.64220546293599101162 0.32778260209850645923 -0.4994633436062260734 -1.54633689427644061 1.6763434153909755331 0.27051626759450964066 0.90358076997221514759 0.38274307700331289261 -1.33063355718160925 0.24948891040167700539 0.47759861564042788151 0.093215224803779903051 -0.44876034605398068544 -0.28670413612391182356 0.24433913360705095119 -0.24096485629588595967;0.48160910457188543798 -0.51503508265109398945 -1.3041422112204588135 0.81606278985448599261 1.3449137688494745557 0.17235361456258740942 1.6995422310122458853 -0.54434260346792762153 4.5260141600445829013 0.40159833647434317605 0.78502324271641588105 0.89415641605323314955 -3.9436416115033807728 2.3942113786882415205 3.470641537534810972 0.24283569447635844352 -1.3778412718073593801 -1.6474169543365890789 -1.7540442214537566024 -1.5719645380277214031;0.33319664843612467608 -0.046148040865928219301 -0.21482224875305383494 -0.36292037123783632557 -0.40958247972657907399 -0.67425369799746104338 0.11595673844430103017 1.7791904600025190142 0.18606580065402339441 -0.6299653722361679975 -0.58126935270640534004 0.31805769864266808522 -0.30097939602204160092 -1.9855600949619702789 0.88788072383937288734 0.95278503504474632013 -0.60109493222636956045 -0.32775039829321622742 -0.47485396087417275357 -0.53983977865228238713;-1.4960122097502419614 -0.43922216702634514496 -1.5367833063738474131 0.19984877879633833331 0.89408849820271518727 1.9122920110303840424 -1.3030863905099483446 -1.3454937159666500168 0.59017479255198834753 -0.33703294766039199049 -0.1856438350060000686 0.20034314265497144003 -1.7079914589516367318 -1.0544025747786678338 -0.29647282646946848672 1.0329767288857309993 -0.0051059497190619959617 2.6199697349711335015 0.9981769325947518201 0.44787241893536594572;0.19528487224438514924 0.14449210009440877078 -1.024801690636060858 0.2663710880190100494 -0.44193560215658383994 0.51669852393825921322 -0.55038960467590325454 0.41350375597015648355 1.1410325846680580142 -0.27106217058918224971 -0.29835700368007256333 -0.30723798972572652355 -0.33801722147135576657 -0.077717177228807651779 -0.78551601385872649175 -0.13098470793354330399 0.88011563862267883085 0.36746433378487952659 -0.061879765459637116332 -1.1905596457978826486;0.67897076766393904546 0.0755700234802686166 0.70781095071525279572 -0.28029991869053322295 -0.59366938519764178572 -0.76698950186388381578 0.65909490486028698975 -0.16497089499511011224 -1.3560962957294517839 0.057627294191277933511 0.51037670566017789842 0.10220449761003932987 -0.053909670920715607734 0.012373890297140588412 -0.32131029591203558171 -0.012419718313062095075 -1.0139776612106106146 -0.57179615799246052976 -0.15186084845519548514 -0.55464289518944143165;1.1958789180163658106 0.66900317765479100363 -2.2258026616093737893 -0.26644840498198257839 -0.93607087779415898421 -0.51439484402652246864 1.597636980360193304 0.88675125845745539355 1.1608222470928235559 0.027482002539981578715 0.67048730615846663383 0.4733929920391281021 -1.3910477310255260353 -1.0644242959635599188 1.1200981167574799446 1.6052904124146838427 1.9492243844414802734 0.33199366424875065285 -1.9594341954567320307 -0.42251983806015869227;0.32527736407907592575 -0.4056486681147672968 -1.0485673134518067595 -0.17823480537243061028 0.70742593133385089921 -0.68937994901799237724 -0.60938290078641332848 1.9909034492732431421 2.5396517005538967737 0.13773082488263635459 -1.5804676112948872202 0.021719932385718249829 -0.94629480369297036546 -0.37922023986459296729 -0.23812976767983215498 -0.26014122596449312796 -0.10269044811666040717 2.0017385250718988665 -0.89794709149120355285 -1.6159799598332085235;-0.36162592691793715716 0.01952847024304615528 -0.46953518990638459796 0.25403595865440403712 -0.014240763294155524624 0.89266438304931461367 0.088147831771297160963 0.64215633641060421155 -0.40632353536153054119 0.16788922559836835791 -0.51508754322964689365 0.37954107797873132268 -0.30336177299436317689 0.77107068723096694463 0.67483288434106514231 0.59078836726555084002 0.42689443881310557005 -0.07502395305237231915 -0.028474284536732234058 -1.7740094864060125257;0.083378210780340550334 -0.45616287572373404036 -1.1461367861375191257 -0.67173982359516481999 -1.0646893600019657899 -0.21407219328132964797 -0.78692994442802144395 2.4204689656561222399 -0.93226809009034039555 0.68881678450444194794 -1.3678474489034762041 0.51549063906227676757 -0.021321247772198737014 1.1875337406149417685 1.0142681441543370813 0.031004575001169799864 0.81270643567612865787 0.17635608657003029598 0.27678311316887505011 -1.2309769151227247796];

% Layer 3
b3 = 0.086951984946303961799;
LW3_2 = [-0.95559190567526519633 0.51136410197316806148 -2.3290953810313088646 -0.90523728791893232071 -0.16479781098828305552 -0.59992554070793813192 1.0526630694374046193 0.13780593800773635604 -0.36831398273702847801 0.79738831173021851306 1.1646195010423767702 0.2658701722849293736 0.92579104421681257531 -0.37246279628987721821 -1.8435789904233550462 -1.4196734525594527643 0.30966480339412666423 -0.35699544667362831385 -1.468918278603918548 1.6672726770266876883];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
