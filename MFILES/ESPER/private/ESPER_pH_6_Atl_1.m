function [Y,Xf,Af] = ESPER_pH_6_Atl_1(X,~,~)
%ESPER_PH_6_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_6_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9639477171559132085;3.0688402920760524673;-2.1780391363461637511;2.3182514284130011362;2.3057708619330914424;-1.8073938357987986425;2.0001492157713243181;-1.2815310837629754204;2.4624782690190820666;-1.1416130972597111626;1.3506120687052860507;-0.3642963731409077921;0.090504640425165941431;-0.55767064332297255902;-0.15228911934946445794;0.44252082838772127671;0.41743555896605216704;0.63812034011953322477;-0.55401295525964544542;0.58670056420741079073;-0.26414561278404458111;0.84021854017003838599;-0.44879740714929006185;-1.2354064803761772851;1.74807045846198994;-0.87689937757559277554;1.9827761104836945094;0.91817930388521162843;0.18981343446775983397;-0.85552386717492068247;-1.6749091712212169636;1.5136715820841815106;-2.6834757656971830464;-0.81005042311029185065;1.2553028770919796298;2.3083443891410695414;1.8192583974281990589;-2.4274232018201198358;-2.1945918608329955113;-2.5228264583156594369];
IW1_1 = [-0.87458437250406495522 0.18573856678977052059 0.7618147851623607858 -0.79719774913378571579 -0.81751335238078637335 -0.029721338562179865084 -0.89727981564829484284;-1.7830359099143153756 -1.456151714985948642 -0.43961559851716425218 0.36880001431623293806 -0.41161143246891418457 -0.34394629200058590701 0.22054965400824971811;0.23507012558317044726 -1.1193878210231271719 -0.38299729570284035685 0.53251719490670035295 -1.4052944060710041985 0.3739860190322841782 0.99187026329663274815;-1.1242428762535674469 1.0680426548512296225 0.45308693015672063531 -0.99551145862773338102 -0.78288961704803516906 -1.5983047917023451845 -0.44623932554810502582;-0.51385352710828391398 -1.367161093024989782 -0.74992327445467843461 0.28285602625543254662 -0.15317388389459046794 -1.4281602668933417455 -0.21019630325945370952;1.5226233538606648299 -0.20959133059271184418 0.98900041763714385823 -0.3997754082644260909 1.4307132342268564784 0.5881539625121414705 -1.2028329059786646571;-0.42632595128659589445 -0.082251876021799216754 -0.2815572599040122026 -0.5562341475273684388 -2.7208355800798873503 0.52033074333157847136 0.74920521126675476697;1.2418198400854214558 -0.41200823001463637851 1.0689841270699429465 -0.69361907937442957017 0.14748438814013262177 0.39470660372701926732 -1.3307039773009226025;-0.48583332972935633354 0.12003735448432106825 -1.3429076330430362862 -0.22949173564511415879 -0.22272689131537934393 0.80774054313620258228 0.76278746652307671816;0.47851337484947764622 -1.9655005883012923729 -0.043374369628407946631 1.5585625721218661077 0.1087638314581606952 0.52578208645247315189 -0.16593588373355117049;-0.70716171926389748137 0.46500289187073023944 2.242745066956954858 1.936176112828795759 -0.23979471927943793452 0.40160239912996176237 0.46152152804693907795;0.65934522871603096217 -1.8302769007472725615 0.61330793004422068382 -0.49243487588298362478 -2.5659789609979490876 -0.36226695564819372253 0.2604694724040825804;-1.1144520316966843865 -0.16212781237219245356 -0.3738405027762108368 -1.8265005167213081982 -1.0589555330258844101 0.77546070425309832075 -0.32522240231458166004;1.0487041161398138467 -0.43473126301566450413 -0.58663563780884431242 0.38031028720528547993 -0.59306720958939573851 0.037854425707689737246 -0.46282968210769565021;0.74018569084008578596 -1.0051097245055724549 2.8324594433693599527 1.4099171086483819337 -0.054544402468390068561 1.0608852751159940642 -0.27129931145746399856;-0.096424536813708411342 0.23782335945718144354 -0.69183488434643147791 0.51424893807522453759 -1.8093974989818919497 1.4551718396610429096 0.58181925365011577522;-0.65632247052831038658 -1.4809856044079772186 -0.96650225496120956148 -0.09880390253687421076 1.1014640738937937492 1.9268552872613298188 -0.18409860609634901008;-0.29574239557161818848 -0.040601234669028922475 1.405743815717385603 1.1984421751189067162 -2.4032533037515317886 -1.5159537374125382492 0.12799626257339849489;1.4996670904542614977 0.11974796536188481166 -0.50304699686893505906 0.32629937644859180468 0.078496320015532930481 0.038265362564902344333 -0.65118250114610565227;-1.4306602408514477176 0.061784699596918277176 -1.3726049403751123812 -1.1199374577130467578 -0.042024143580623188332 0.035154571973326845247 -0.86739128349668026541;0.076553691306661827976 -0.74999421587127279576 0.35262929256385472376 0.70218281702330898053 0.97934677687163995685 -1.5415173999827669338 -1.3995583306838954574;0.034757562087773495596 0.36823171307158275578 -0.74294389088688339573 -0.6650565522789392281 0.50347528266231222904 0.92447684550018105476 0.28396860267495660501;-2.8364757033768119854 0.15947688473595189595 3.5624474078825576484 -0.40222450187026642654 -3.2442993907305255341 -0.70750865171135679521 -0.094581658928291734156;-0.22514202655967816002 -1.2084097611196753519 0.44053394722949784645 -1.1941349895088952948 -1.1846627702966969764 0.26974343815149154358 0.94970143617713120854;-0.033262617856606058186 -0.49965752463917351145 0.10630206225166749512 1.25004889456028212 0.91272288440615856331 1.2053274013810897358 0.26191689212857754976;-1.219648324107749815 1.8384957156354253538 -0.22538865956062112406 -0.017198792418066554538 -1.1582641026513205151 -0.13428190464918429714 -2.4637363518025803266;0.3103989552805551666 -0.093948288780064823089 0.073004443797939383431 0.089439159861112838001 2.5358955178798132657 0.24013795559532608026 2.3630112412655286391;0.58815442427703901185 -0.42239511050428757422 0.67118844243746034195 1.1486702004687507905 -0.16825028815885612055 -0.36315589679612386709 1.3833293224825569112;0.0886776377395963461 -0.95200264588528049625 -1.0944258434199871655 -0.063921419300777410077 0.04668478056159870021 1.4078787369633909421 -0.60908786576270868007;-0.30051303226824904735 0.058270327748279199254 -0.99733295563261015193 1.3501478420407659886 -0.2806390647605166988 -0.33583489139475947161 1.5640056221557814276;-0.30892918008360764626 1.5610647342772334678 -0.47159711254582159512 0.3576191754202767692 -1.1966518532530914243 -0.57549059238431032881 -0.34036797753949998846;0.64353796828114251394 -0.043592903989185805003 0.35963184074239784582 0.5528712287138097814 0.57863462441510926659 -0.99917382413101363259 1.6387572984972329504;-0.080339790991036566514 0.41697210001352458253 -0.55344087509248451884 -1.6222120228646601525 -0.55120087429998043671 -1.3400125161674512064 -0.075156175980689368665;-0.72076579320049416477 -0.51208586829652102956 -0.27643717797897116029 -1.8352368038636179826 -2.7024071787809202938 0.42692825775788073583 -0.5793829502029628209;-0.45918107306373107113 -0.33319857883925907416 0.40784675834060291066 0.29726675934465585094 -0.9346493591303193238 -2.2651309147277927103 -1.854497629063777131;-0.55044709375191003264 0.37379191674718886818 1.5223658411410248004 0.87149222956646898997 1.6035113803352476491 -0.012100649906907181078 -1.6301249704663201001;0.72120062723844657882 -0.66132440216809407207 0.91943489079485185567 1.7797131459861699199 -0.079875599329682661631 -0.20427159139647563246 -1.36583983060158487;-1.5499119221133206281 -1.2589902882211687629 0.98131687420713675785 0.76102500414762719316 -1.0511484770857424387 0.40399346391827040126 -0.27462035506442616928;-1.7331773444679023921 -0.31779444460129552263 -0.15344805216140366966 -0.898222269713224164 0.89757244125426238757 0.35113697306391478126 -0.7341544521193188455;-0.79533195280958868256 1.0112577504511282012 0.3020722018388982133 1.5430998777916606901 1.0508053999764257469 0.56086078915864689964 -0.29342466000301081763];

% Layer 2
b2 = 0.27789677042839855403;
LW2_1 = [0.65575945585118355918 -0.54869111500454537111 -0.68793766600385364285 -0.96147527455973091914 0.44774026328718680157 0.31667503012634073967 -1.1923365137314401174 -0.51645815889028889867 -0.94419675181284701271 -0.10868134256099577784 -0.30554026974037340469 0.35251584280239112168 0.34156956804776705816 1.2603570648779580665 0.13891685172466047837 -1.4141790126243789505 0.37626548848654400858 0.82425257617736691351 -0.9208002417972442899 0.30049205160032527173 -1.977391326045888853 2.2035087625330644912 -0.2897764409017714593 -0.59934142129849499181 1.0970583779059179808 0.1860636552637685015 -0.67879620597553957939 0.37543942267680219249 -0.82584974582713266411 0.20632927738218470592 -0.45937141060081781996 0.59922983783444583317 1.4345972142754068734 0.78584606194798911627 1.0571745215197509982 -0.46646882787909460522 0.94001175427820005126 0.6778655619000373278 0.30055845908752826245 0.19260968149714974285];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
