function [Y,Xf,Af] = ESPER_tco2_13_Other_2(X,~,~)
%ESPER_TCO2_13_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_13_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1504934919201029;-1.6978026815823422;-2.6585788013300831;3.307586669688968;-1.1613166227925058;0.4211966986939501;0.79291330922115322;-1.2109796522382592;1.7478087843109935;0.44599110099989359;-0.021142607423079447;1.1316712575267693;0.94652769853191721;-0.61975945436238478;0.14594208816138618;-1.3240051307407368;2.0954280304106367;1.4938946320372171;-1.4891756620293601;-4.4840094582479342];
IW1_1 = [0.026679816971827423 -0.35874536745746227 -0.78433508092576876 -0.46634753367666393 -0.99047495587803125 -0.099010481520928534 -0.71844643656916851;0.73948885125320063 -0.16401092571583265 0.29131052981790823 0.65249406507696139 0.69220922198263668 -0.72506805487006476 2.1960798528536722;0.308995968549652 0.35386487016866353 -2.9712043304951989 -0.33659543686646914 0.2177895967441428 0.30066117306565915 -0.26215212374621272;-1.4110689601601967 -1.194056462546156 2.7777531635850288 0.33658798557421382 1.0423612857347218 -1.5661911871808338 0.58628002477067986;1.069176650285552 -1.2626685674875859 4.5074873961435111 -0.48913682044678058 1.8023809963539272 -0.45455118346897433 1.8966543521687427;-0.32055640607595792 0.11937672185529209 0.63693646533703097 -0.39317438611380179 0.40591042640009184 0.93973391716584609 -1.4971983938120093;-0.77202233158586797 -1.0298419056132431 1.540615063668519 -0.093035045623039409 0.73563499839469837 0.98043780850743212 -0.68910423931139264;0.51911139313747101 -0.66634511166322619 -2.415240780966379 -0.13020686387451155 -1.3053515613883806 -1.4992024364735763 0.54027828340154427;-0.14760927921375977 0.11907076199085946 -0.19424564154158006 1.0868827846947129 -0.57743580207380663 -0.10844288049291008 -1.0195548002859482;0.0039240663742167855 0.10031855482227904 -0.55274455933795397 -0.18809915851254427 0.17959828809627063 -0.19978229873372924 -0.54645237676921932;3.4127840234798739 -0.43255981269597504 3.0768887892554679 -0.14828969087312094 -2.8272395549520675 1.0789173800615872 -1.5343012658042139;0.38415036269607639 0.26457933074112955 -0.95446551564052018 0.29913757430278559 0.60126065535746442 0.28617779068934496 -0.082733105892007275;0.23756982155469808 -0.21644699891830715 -0.96430008529463052 0.68564189675528198 -2.1632495517410697 -0.58207877074429737 -0.72037410960243609;-0.46875181031406149 -0.025255413769342362 -1.5096338913577012 -0.96829104032951852 2.7604222657948996 1.1983868625888661 -0.86611998996790274;-1.0588844445324197 2.3097953298566773 -0.86027395253299954 0.94433481065079572 -3.0066126913338111 -0.33721923721721464 2.4996042808801908;-0.46021109045733416 -0.25731643246088415 1.6279881888606158 -0.68391512202364535 -1.1254993940554909 -0.031922493270580714 -0.63604596427170512;0.36840097656682519 0.27834902105525261 -1.8449201166814693 0.55198234082253939 0.48489871337940882 0.041723434190561265 -0.11032992205170812;0.55189234019242139 0.34653826642705365 -1.5909709728017272 -0.44052722800469352 0.56263446515715398 -0.26198680333143048 -0.16316312707866068;-0.45939678078278567 -0.73017713149023944 1.4621734548457244 0.90257609096332092 1.7002084919522338 -0.81475154146399065 -0.46885202168496365;0.0011165162248530176 -0.049964976176267245 0.43298620309983349 -2.6014633121912012 0.11436636427849127 -1.3929607453509969 0.10933357158804957];

% Layer 2
b2 = [-1.0273749259944758;-6.9543070977255113;6.7617217498487445;6.5574219822105775;-2.5741625267463615;-1.8165270175096286;0.47799566886230194;3.2322245210800968;-1.7718988198138081;-1.6206306871307112;2.2619908839205554;-5.3597139198612807;3.2006893046488019;-1.9654191016764926;-0.70301431068113629;-1.06564585425583;-4.5784752745746209;1.6243896388651013;2.6336765595242904;1.2825142198141737];
LW2_1 = [0.32431799223702007 -0.074929795229696186 0.21090266557439899 -0.049028843169742646 -0.25572793063443333 -0.097084574794128367 0.095932360845733561 0.20816348782867258 0.66103382374838549 -0.12832722640040925 0.02289392668802474 0.61452903405190851 -0.4418114557027889 0.20812609827921361 -0.024389882234599342 0.26366126268934659 -0.87583032578442055 0.22278366513912831 -0.15739987023222304 0.44665946298714715;-4.6337930364653994 -5.8863713339557195 2.399790049259579 2.7481150079725123 1.7839599437291362 1.6270870544819149 0.50954394646988321 -1.0575053816486768 -3.4788846576410237 2.451303723355831 1.4980673123705939 0.83393180350003682 3.0798638748343614 -0.68688408750291874 -0.80064580214711967 -3.7647656465663082 -0.071991419546331731 -2.0819788209313903 1.3248412570932036 0.79096657309249097;3.7396625961894143 -2.1791019269177649 -0.79380047574076029 -1.339026820702498 0.057778576983644782 -2.6822135136800185 1.3650571802254006 -1.1457230423706413 0.73241866275076828 2.0787999544754854 0.076016958651140026 -0.11425287574724499 -1.4826785667586733 -1.3592463523701308 0.24896634329113976 -1.6890816642329733 -1.338787970802322 -0.66353938708443327 0.35657241401366557 5.2043774329504835;1.2115978443127069 -0.27308214543620057 1.7344917468991894 0.16670995048101553 -0.34458289355792915 -0.10374815558667028 -0.4853298515373049 -3.0701351788506579 -2.3652046616387787 -1.5020871400825948 1.2305738383447116 3.0513557433863689 0.81028110372057394 -1.1377240003233795 0.34843544168318985 6.3809344908027548 5.7526325837378476 0.37037789607342397 0.32638836073492061 5.529043462753136;-0.89613153772947329 0.77712410384398745 -1.4434003413775367 -0.37956227323104358 0.1117791416333203 0.29652126347248708 0.6497431201162277 1.7549319821498854 0.46323842655029385 1.4133649384415448 -1.1815372572171414 -2.7717378295937323 0.7156263494102143 1.0088483278338205 -0.30007868475208527 -0.42309223518008038 -1.7853390299512275 2.0138922341874079 0.47363189751836648 -2.9755754830980656;-4.5158462572692324 0.29004201837359095 -0.8147564318492948 -1.5549988859075619 0.87876680433500765 3.7146827360004262 1.2298030388316792 0.81060780972288382 -1.0704230868360172 -0.61402313016685639 -0.40421913483707334 5.4820276745142751 0.42703884817321403 0.28565732333623706 -0.58368325122848386 4.3064287497626008 6.792588392773192 -4.4845024697391942 -2.0090473874576511 5.3471198289641766;-1.6051488525351512 0.95280061456985743 -1.2784627034261891 -0.13766488075901276 0.27395840232475832 0.50821382076777444 -0.37595284153849257 0.70584436270525608 -0.88999378578336386 2.0929107046176205 -0.55928861690335641 -0.825031259401378 0.89888943726042358 -1.1396712773206137 -1.0063191456217353 -3.9510284595943372 -1.7293045529162454 -2.14735891256564 -4.1258793608592157 4.178864214939396;-3.2776426215181846 -4.1172922928112792 -0.94488336692486308 0.11601667619171585 0.89070378913920711 0.32193317139565453 0.58273749894513394 4.4253558911062481 -4.9657321475120302 -2.2189206059227935 5.8549978686626032 2.6618358594715983 1.2916221601551676 -0.58054843817202861 5.9256060955474608 -0.77465347655016881 0.44915853419680557 -3.3341396105920409 -0.48185150334822147 -2.1138221494183034;0.92845361189387376 1.4865002807447427 -1.3022687036350673 -1.4994403926205071 1.0843850881977852 1.9424214808232618 -0.072542343593762965 1.3413994893235375 -0.27353932252249297 0.8824118644705925 -0.5158392347562597 -2.37000478335049 -0.6121264593835003 -1.2092182027441127 -0.17904651375626879 -6.3236564413891712 -4.5479600106328943 1.8875094034368458 -0.43477921945511794 -1.602379649116038;-2.5389388101810888 4.5567918311744418 -2.5780705551422121 -1.7990022169412094 1.7717980398588524 3.2034731426418999 -2.0039133269850882 4.0456573285377768 -0.075369079522282931 1.269876335416432 -1.7393266020086617 -4.2543208610012906 -1.0136901120946034 -2.2562390728445205 -0.41514346347013659 -3.1814566642773565 -1.4993806632845443 3.5418048304272882 -0.40280946676619311 -1.9625826227655825;3.335798067674137 -1.0804947579156963 -1.0607447791733036 -1.177085083314009 -0.14820037583190626 -2.0448854432912151 1.4224374370066051 -0.22213366342338531 1.2268924197823967 2.1199623298947494 0.063194044560052579 -0.279310673962053 -2.0753896706633941 -0.29630243596792388 0.016265302690563935 -2.1316837004273648 -5.4096110791148639 1.7894178395455977 -1.1623884187178921 1.8253984275096089;-4.3787358729974821 -1.0822813306917922 1.3695574471969565 -0.07617248978624018 0.7021744852528522 0.88992291317380079 1.0793188187330629 0.31297094949388482 0.12117673759741861 0.57925091917343241 -0.068613199162313579 -2.4337299157938856 -0.10199647118167041 0.83255950386510569 0.04407920679926966 -3.7329512314776268 -2.0906840631793675 2.4569143058042657 0.78007791970820617 -0.52808255190557885;1.2675459534805824 -2.6214405710015272 2.528322639205645 0.63967277749172502 -0.55219022985588828 -3.1868225524390583 0.94256238162436978 -1.5913556373891999 0.6419361786694705 -1.8245118623681227 0.58646501029468667 4.3398380835274093 -0.44556202673164164 0.31099216235343724 -0.11489643033306206 2.4583572926061281 -3.3885134498099503 -0.65103689072713233 1.3058689734942854 -0.84612319014349568;-2.846917790117216 -0.1068616736151326 1.0923453972655237 0.8797089256051227 0.18581488433137944 1.035186921061265 0.42105197552987739 -0.47619042638918835 -2.5709949309740563 2.726073632682255 0.45000682450209217 2.0585930241174157 1.4445822746544534 -0.17883215694184698 -0.1482646068120955 2.5036701293897963 3.5577565976067356 -3.0155537575312232 0.31660076275854482 -0.14597677758489844;-0.31706059398128311 1.0167346158131665 0.80282280382306681 -0.024667966590295801 -1.1220667455190076 -0.1014683878798284 0.70713787207136236 0.20290737517223903 0.31094818997213414 2.116948610944235 0.070504096561083154 3.6709604597766377 -0.56086774148651075 1.4146109736345194 -0.25372733520668628 1.7181236918732323 -0.98304573591519051 -3.7388100798838031 -1.2891677805013566 1.1617269766873903;-1.6770729271725535 -1.6492299054742634 0.60208063606542228 1.0433089645803302 0.10315664469508538 -1.2379670323442926 -0.7473590815450416 -0.66717407722177058 -0.15631198658852477 1.4217924755242723 0.5956775058513214 -6.0080561944861568 -0.74172149704541923 -0.14134391379775349 0.59230758219290558 -5.5038460280962189 0.024269943168106267 -0.3972586809963502 1.3568072233166653 -1.6287095950657453;-2.2474408406180002 0.91669829091101485 2.8680399456213075 5.6816716007726091 -3.2328280997804724 9.5138918041958593 2.1329813056784204 6.2828313085217387 -2.3148969456966912 -1.1092054251796497 0.62683639703507033 0.54719040661493723 -4.0306321025098732 -1.7332309534148971 1.2672137988481493 0.070221678958713313 -6.1709477674134599 7.151505448527903 7.656595519329187 -0.66333862259341536;0.59300470578094489 -0.5154009909258509 0.35832008233136337 -0.52677781905915622 -0.043566043859309608 -4.0222054448776001 1.4098009050081257 -0.81525314832977724 1.1495772760660854 0.8616047227922895 -0.21178141117074811 5.665338400685842 -0.011995381095057885 0.51821657066335036 -0.001813304975306157 1.3733596121654974 -2.4118544119412926 -0.76252611466698839 0.089273521359797395 -0.71636631932381911;2.5964539061973215 -1.9179674038233188 0.40437803269545142 -3.0553224765179166 -0.035371562282636979 -2.1197932162399318 1.3586561504299939 -2.148105245833746 -0.84566567423440597 4.0052117131181744 0.59090226996577311 -1.1747560550028171 0.13115131060696508 0.29860650714500914 -0.07351242948764021 0.54721111599953609 5.0238387601462016 -2.5788155432865709 -0.38953831094167435 9.4871563120747169;-0.086463722747621985 -0.43152672981167906 1.4068580487718265 0.036142607722187886 0.43279036756834222 -1.8415814041395506 0.40582783012035012 -0.7893921254433699 2.2546277115270121 -1.8677745267677646 -0.27912148578047941 9.7157255176133148 -1.331131798293971 0.24927751958894209 0.17179946721689984 7.7530838828009836 0.94876834882131544 -1.9449776588914387 0.36689752775928958 0.78975182999937987];

% Layer 3
b3 = -2.635614506636605;
LW3_2 = [-3.3573717119219744 0.040134597976936505 -0.24848090304001205 -0.11834168830087276 -0.12949540083683447 0.088717301400161375 -0.081240175291036887 0.0066086405883472197 0.23585913757532875 -0.073838898659984942 0.21056039410667832 -0.1014206004961226 0.2085764189409984 -0.2581617905343116 0.4346287314426861 0.086592400803402511 -0.027895809330658106 0.3959666006112818 -0.14692658400694319 0.10589873271238429];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
