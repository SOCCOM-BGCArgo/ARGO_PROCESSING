function [Y,Xf,Af] = ESPER_talk_10_Atl_1(X,~,~)
%ESPER_TALK_10_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_10_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.17551421050746441;3.5333966647270572;4.9080071794180649;-3.3979236419069774;-0.31582408334748435;7.1226137165078081;-5.2072512532065147;9.3800251560684647;-3.4751196549585259;0.67123505301897812;5.6885147263785312;-0.68763112454977171;5.8821603502780384;6.5827136490951279;-3.102368395940045;2.6087940170064057;5.5711936266278537;1.8183810204086721;10.771667716498424;-10.544929605064961;0.91855778682455602;-2.56042022111134;-1.2438121110695413;-0.43519242833389177;-6.2265080705538312;0.55481052791761643;2.8094627803284196;9.4394683615100146;-4.8014010767780979;0.03222370383877167;-0.043741591758138895;-1.1357404837843055;-1.3505520626310634;-2.1571438934749638;5.1389987273623694;0.30708669994681786;1.457492500139882;-1.5734586227700209;-6.7763584194235973;-0.25783023998599863];
IW1_1 = [-0.55388952183509454 1.0986882652585837 2.6854055195927344 2.6247280565904285 -6.3484937979490903 3.1456683369092713 4.6591053501910222;-0.28894994995235518 -0.90391821154176444 -2.5638813199318053 0.13409072304433717 -0.57459942984094059 0.26420490252185813 0.68261314905863302;-1.1409563448293418 -1.2030617702346977 0.42763740098146208 0.14415634550372344 -9.0694653548279085 0.76139645888852414 -1.2227037479071288;1.2437028637554481 4.1740088882747219 -2.4401101748485168 0.81757497995003681 1.1083592635766721 0.26397835161114824 -1.4141620357882254;1.2358539848080039 -3.2234015145429593 1.3236929873189602 -0.38855316987987704 -2.935520422481571 0.32947546307972936 0.8931656710008139;-2.9687595602748291 1.160787962715585 0.40843358385473516 0.23338554051204385 -5.0072152263411489 0.41368537121998694 -0.3225065823437564;3.1080860039662532 -0.67293383867121348 -0.007683393145643428 -0.6190742767939138 0.54985597284810661 -0.77989679115015831 -1.1293708760006484;-5.1113351719426099 3.8108069264073428 1.09898811064126 -0.18931017045561138 -3.3239475302446722 0.10471015329520465 0.22886209717448616;0.62222073660945121 -0.44738641146685093 0.27106737862488584 0.40569478505035517 -2.517399112290605 -0.13045382930370658 -3.3525755325858562;0.72178098075589436 -0.02501455171011319 3.4102849820526844 -1.3956559331530465 0.48157152856279017 -1.6951261081902349 3.3097238768507191;-0.84773506433551971 0.24978738016149601 1.0754916633045186 0.25974017957931894 -9.5569519020316989 1.5020064826594486 -0.47204632907385158;0.53030791733470828 -2.6085534320214165 3.9444502858002486 -0.80972822478434492 -2.5928575505042906 1.4669453042116736 0.71766116531734803;-1.4699126583088222 -2.9297425230032399 -6.2877811133984292 -0.91625008158788601 -0.16643933480725029 4.2345530860852305 -0.40171054148806401;-2.0348780643531592 3.0275036617988658 1.5327024145168275 -0.70522121703611718 -6.0053458577300702 -0.25923994025328834 -3.3042594987133933;2.5456725479959843 0.95865121845802581 -0.88039564414519811 -1.3461532839991925 3.0664118567453382 0.91853012207336915 3.5305609126543778;-0.42529388530881318 0.36075574281789857 3.6298942605313358 -0.96470909815154016 -3.5914026969087161 1.1674639505782365 0.59805831867297798;-1.7987825477159716 1.5445958086241272 -0.16263802340942618 -0.18177662842597361 -6.6017635147411324 -0.082714317527578352 -2.2131441588523901;-0.28751572689196636 1.3091490359769373 2.2363123818094137 0.12000876386577716 -2.1256302744280435 1.8720310521486347 0.40060679382676245;-3.4319060267634041 2.6473927926834744 -0.36876655090628868 -3.7460253793389429 -15.238384142924575 -1.0899863888154153 -1.9580689025677593;1.3778618426885036 0.28214035534736137 2.3487533642318246 -0.64689583530862227 13.096243377348875 0.67335581771562125 -3.7538960064930258;1.4039665971624797 1.1807066484832602 -0.25519862581804054 0.06827623703630499 -1.5662851985133455 0.30866344008032431 -0.23209164095101159;-2.1619272940221985 2.33954190344941 -0.8931879304012138 0.17897253788086917 6.0067150528768494 1.0568317981404134 -2.7421952606310764;-0.56191254559441517 0.66515521968523406 0.53517808674008305 -2.0404469096840296 -1.039152026033868 2.1938257313419007 2.8808549210130621;3.4523733225940099 -3.2483375293756285 -1.7696770988738117 0.092753235074760826 -3.1237381268387847 -2.001672416404332 0.25578901439370877;0.15538032404015276 -1.9408103748064467 -3.8655003964556198 1.8173453895733274 8.6949124822796886 1.5959459923819257 -0.64160446596881482;0.42095286016804878 -0.99990732825129747 0.15562930982100306 1.3301917030949615 -10.413558253965105 -3.3579582828628336 -4.9960848095002079;-2.6477024913260521 -1.6434663742910633 -2.3021431845556397 2.301076253241678 3.7990611535751211 -0.67044106236315604 -1.3506798740926191;9.8667381164120567 25.937657976564765 9.0370361063664735 -0.82879243398290314 8.3986772930107012 5.7212713809053755 -8.0567078684727989;-0.54964903913145435 -0.85383463466806742 2.0622682621272248 -0.78831555296721023 5.7626177269471368 0.044878580927696206 2.0996976597143417;-1.7344502597249536 -0.8402583809169939 -1.4110306048991339 0.036699877540093996 -0.93885398766824291 -0.18464651169353782 0.79740091695439574;1.1565351976778981 -3.1518858265970824 3.8981817174281277 0.85520185159576079 -1.1245734285332527 2.6558182140428594 -0.62164374952251489;1.0345646861413 -0.79940705934018341 -5.0751990324630638 -1.9958729145920875 0.77143782298398844 -6.1114450753563254 -1.0515671369587947;1.4323387229651794 2.065892856433341 1.926686655132392 -0.67238947533388571 4.8516430672383057 -0.41837848375442455 -0.067282189226032921;0.26435435538265273 0.015270169863406353 -3.6055219378009626 0.92075963943986339 3.4625473418891253 -1.2100897424672343 -0.56103435276460445;-0.25485052009277231 -1.3909054054350716 2.9623169276658632 -0.80782614251498697 -4.3339606481503212 -1.6123721041716632 2.0521396701209405;-1.8111985096184835 -0.92357010346246171 -1.4505933484980869 0.00053962936893154484 -1.3969891724714956 -0.29244471413368445 0.90007537670648707;-0.55206956241983729 -0.48612176619493797 0.044634682934091174 -0.00576236119499069 -1.6380336239735285 -0.010981328619860127 0.040711620226363619;-1.8497636705455289 -1.0712278196405334 0.085862444542431832 -1.7239961104300425 -1.8601816119037358 -1.5657614252841949 -2.9274625960050713;-3.1874441547498944 -2.2559871291513915 -3.8757684946314002 1.1685116011553021 1.7394223554132342 0.79761503861418315 5.8568748791566216;-0.68612627077917987 0.29537851832310363 -0.17701321765015968 0.13446897933654034 -0.66576767850623253 -0.44621520221219013 -0.51905367311014172];

% Layer 2
b2 = 0.4002792356813516;
LW2_1 = [-0.0021484680613203452 0.067884783767774293 0.080208589826777185 -0.058899190922317816 0.11072510338785692 0.34474797989761724 0.062514571549280917 -0.13910898693426099 -0.40351201861366065 0.02389814340382089 0.090381966697533705 0.068462731691608825 -0.014452864079954022 0.028268705412470872 -0.0064003671494391422 0.91830349396937905 -0.095192071008393081 -0.047533748473439122 -0.0039271648192945518 -0.022782193732122921 -0.1650365724307965 0.045419086594314415 -0.037630854653653727 0.034119997729348296 0.024479813808169999 0.0087353573561086573 0.019762468071737042 -0.0005122597328862668 0.058242844920125027 1.355059541912111 -0.019226646434014841 0.0022451141951759348 0.083778890197619402 1.0051338001726999 0.026579537303620598 -1.1696460186414779 -0.96885355164496834 0.0024224574783155862 -0.0037059347592591401 0.25423286991014021];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
