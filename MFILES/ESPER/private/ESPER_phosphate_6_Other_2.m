function [Y,Xf,Af] = ESPER_phosphate_6_Other_2(X,~,~)
%ESPER_PHOSPHATE_6_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_6_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.3344690206541085509;0.3203078163565520331;4.4135325482687690624;-3.7014417875194922658;0.8483943039086238036;0.69634516389299427885;-0.79281837786229514276;-1.2039500558373310568;-1.2173220230540784392;1.6748130184803875498;0.04478306748580420521;-0.57492740246582008101;-1.0854480296346851187;-0.30826159576805506335;-1.0972617703100013831;0.43668006402579734315;-1.0060673590271660416;2.7908489479766744878;1.1508270729905440977;-0.81440623063703043716];
IW1_1 = [-1.3465083207967429857 -2.3338599557523447281 1.2516804510424497376 0.3722515733132680249 -2.4663699227766771038 0.004871576300031826498 1.7309675774688220162;-0.46013129786116041542 -0.41154508867855066345 1.0722417377448181242 0.39790737681203619536 0.30358683474683278991 -0.18489030440175766024 0.36837104520339464253;0.47345528098224320956 0.29928424481204685126 1.5237831497670697445 -0.30572366306331588692 2.5135216114148710709 4.324903305034952794 0.1798674175531796704;-0.11550209785610790481 0.079934297223249198283 1.1581408968489450562 0.11937211549880030748 5.3785965282249827979 -3.5510772786205944129 0.14009942206593056779;-0.070585212275283526484 -0.86153718448529703622 0.34045839267861294219 0.055767797714779285267 0.28740009924617149206 -0.10706544284808845735 -0.53049287206113926452;-0.46419676104169610431 -0.063154866868184458828 0.72405958011617765901 0.25195825334120591776 0.51548001516730990179 -0.2923304027575340247 1.1011910435259950614;0.84753118633309876273 0.05972646740758089795 -0.47284040169206198456 0.23585002714809175095 5.2006411275151362972 -2.7812768535182743612 0.07169613162192883804;1.340702342723273377 -0.71034916504900735834 -0.56345498138987615278 -0.13563240785185590176 -0.41738371059926843154 -0.53689518198575025831 0.55074656964304757878;0.76583189787008132399 1.0366337030840073741 -0.20222160804511724042 0.28012221980113571895 1.1078904061597589781 0.93747007207711197108 0.47154802016182040258;-0.61594242051549996653 1.3432987507072804423 -1.1631781180936002773 0.21858825533095757598 -8.0295318363529109007 3.3508370057694469857 -0.035569442282086576046;-0.1485535131228704897 -1.0040047222379655523 1.2662873812370916138 0.22318014785689885282 2.2999842867622168896 1.7636318600081677399 0.84779953129078566842;-0.57778998190293340276 -0.085160444073774446694 -0.046493868058120842168 0.084228862822398720134 -2.0345514202165668749 -0.36743207893339563386 0.64737847518877822406;-0.24095342161546012827 0.22380005303812217088 3.8339401531484966767 -0.099916997303277202414 -0.10311967130283450356 -0.8969638562808149862 -0.62428303589475775404;0.08701018439763491541 -0.081500608935699603297 1.7740171441116296958 0.32084833360597242446 0.27780472044845777591 0.50055952973100248382 0.79258226473932480438;-0.8272179402290757988 -0.78982076593264949338 0.52156591240582106384 -0.24490822327413039328 0.56030017830211642504 1.2826654570523914334 -0.23332846933414874702;0.48783413592390167945 0.1227500990693135563 -1.4019910157949184715 -0.18598338207475961781 -0.63378049645517342547 0.33561071408576542696 -0.55819282059242325555;-0.43641128363950715263 -0.51547933349826979832 0.14452233024126215355 -0.028375145002294214353 -0.018850421888078131016 1.3812417132699397193 -0.47383637883021678672;1.4537964937403682342 -1.4712464914853977671 1.5917818484838537341 -0.73876316935659391838 -0.8352626778248433137 -0.14207337418102955473 1.2271009741178990904;0.60957330100417306262 0.31284050324683460031 1.4951178434491483316 -0.53585306918488584405 -1.8995588927271001012 -0.60416265582879236096 0.96787970596197858697;-0.84218381321989566057 -0.35834975340582841952 -0.60350066558918769033 0.44926207113088856282 -0.30802641620742204909 0.18933976150106698877 0.80282145594397835708];

% Layer 2
b2 = [-1.6091459975315636211;1.8018959420058646703;-2.8400993629463795465;7.7419828833314978667;-0.95265874439507070015;-0.61584817540758429733;-0.98014111584130736432;1.2388298134485868918;0.36711969804592148314;1.1388309798011446716;0.91796286466578913554;-0.30219282371318839653;-4.2985497355396677932;1.4573423993389951203;0.66572764047347010585;-0.060394242886464305498;0.21100070837413048563;-1.9431652214533801093;1.1306125414929915074;-0.82932433126743365648];
LW2_1 = [0.3995011558342106972 -0.61386467850651349476 0.36365295603415526138 -1.0075144158017756979 0.27471637236857771036 0.15871253212941663358 0.42598913934947624238 0.23862413614948579932 0.047328211533995398486 0.08252822140735396883 -0.78502104339647960085 0.39233905911072108896 -0.26716894859170708942 1.1427453496956667678 -0.47325322178068923717 -0.1696846664756137546 0.69187814651318868542 0.38798090429733800288 -0.0030805210457390164343 0.41989902520182120771;0.78835817735176871857 -0.97087692800434621798 0.25821104055464638716 -0.6174904286847193724 0.1394462588852868612 -0.97746396717965922107 0.024157304945321225048 1.1127522264559785992 0.16104107547648000009 0.16042302196037225293 -0.63145590974283027919 -0.14169538046872434678 -0.032764672767884459037 -1.0165383364924662768 -1.3625623165097950906 -1.7665322584774814096 1.2282984308035385101 0.93296013616278472558 -0.22297094689264101985 -0.1621727315673573977;-0.015554136268596420803 1.2917968991689288139 -0.55987220424976169575 -1.193388782395214065 -0.89798401781776293618 1.2462229881442987711 -0.21929141575974003819 0.42007415803035685897 -0.66972930429635035843 -0.28568192486629478966 0.25484763832084289525 0.67910472495514406788 0.62803785135749301549 0.80160813778895756432 0.62573185801695685448 1.6116553736541363584 -1.0383174019726670867 -1.4453240669955347286 0.9591996455337171712 0.21959347403871243287;2.8929927083155346779 -1.1946329928629022543 0.58542181447305285946 3.7886557858787148767 0.53511572163038179095 2.0598670385080568579 0.5067584510415075183 0.96384646415019847865 0.52963063601020476945 1.3495070280821681585 -1.526282694587433042 -0.75374034377710763533 2.2952614526319115029 -0.74876318246104867082 1.9691584770218566458 0.85259350585606830109 -1.4451710697559794205 0.96954223374462900065 -2.9016753830031793981 1.9954392284971997906;-0.078874634088895306805 0.56291154350197303291 -0.87795106683464840813 1.0084629005884790942 -1.9081436415640176119 -0.56362640640871530806 -0.50553947119218534123 0.60055156140627208305 -1.1160509536934866137 -0.26843141220745314612 0.5653810319762364589 -0.54748332039364733248 0.21130083315521491771 -0.054579596717461591193 2.4907355204259484793 -0.17849116054178515434 -4.6962532174027211695 1.0959348310875740573 -0.67187095384506123619 0.044667039502527802752;0.74384531286169841557 -1.2733092649795789697 -0.064734586026945484249 0.11067320911297848229 -1.3904850219511568632 -1.5637691238624134016 0.78291154291055731207 -0.47745138051231339471 -0.071373080073553252234 -1.7932818456333718959 2.3849406037435199046 1.7928752165368158078 -0.68426804830470888685 0.8691503579889380271 0.77483299982569975306 0.89912884939334813961 -2.9075710462810278045 -3.309888235154302194 1.4169493982857206404 -1.5990000026665740496;-0.28680121577500417018 -0.62542140300154169807 -0.091854498394303443765 -0.15755138082541592093 -0.27267451639434081567 -0.061228194936221218281 0.38591028095736112924 -0.27228104189604634966 -0.41208722444489742642 -0.50135076429092895189 1.2082183080955004595 0.36110481535404920228 -0.22150315252140026501 0.10717073627195240759 -0.71273756937474375128 -0.19290508368166903175 -0.3925971327009069034 -0.51997468487790488023 -0.14764394763991958714 -0.56006742467766623683;-0.81722711663921032699 -0.60832549287946657834 -0.71405058902260309939 2.8690412820515924786 -1.2718430374607099242 -0.74265665283690673881 -0.60562413533420900169 0.6254835987735777314 -0.37262110026175332411 -0.21144210559708467856 0.55070310964535129639 0.42718173062920128391 -1.0172574424056208819 0.022012025040997886677 4.2644974450269756971 -0.69242015931682221463 -4.8189802600400994947 0.39489330294995439452 -0.19273210720700217902 -0.066123779353461739627;-0.58017217513895436021 -1.1397723865989872749 -0.64255448373226020653 0.73196418814950303666 -0.19459013862223878411 -0.20157748096191652198 -0.037011139816293642246 0.48416944468115624689 -0.48190599271726353159 -0.35535559994770915537 0.55213271501113747597 -0.76360324752421726568 -0.49816587871582429514 0.47059133227479327255 -0.54898776209400601545 -1.4032210383996808201 -0.028443628097813526689 0.0076449576230548654809 0.44954828662239337822 -0.061750449981979961545;-0.63081997962924685197 -0.3320524125662936421 -0.4826918609391767645 0.42093294575767498111 -0.42857789665570250603 0.3698791029959594967 -0.44533493342508762014 0.5800162665354703373 0.46335629080513957012 -0.1348845686417618206 1.131793131017279519 -0.47917168070220078624 0.47531827927428205172 -1.9525282395159191395 -0.12456244319923438779 -1.8055731524868201543 0.86090960787831893875 -0.27439229587727537174 1.19348233549367988 -0.26964933543838204288;0.66714990761436621103 0.40273425956500935596 0.3361184979818840346 0.27098608727621575909 0.39561902981512137023 0.3482737210582261822 -0.30276542554411994823 0.027562797879194963352 0.2725371031529421062 0.77798521130343767371 -1.7814509268679958875 -0.11582196336837223549 0.10707704828340880443 0.077567558219553356391 -0.48453920124976479489 0.056236705361543889992 1.8657881163437786132 0.61938736159373641854 0.0039651768271712749953 0.57660814748625111026;1.0052033159852473698 0.98307469728452634428 0.60347399106764065824 0.28829337546491823341 0.92144507477440029675 0.92246282363994802633 0.12181918326256728491 -0.3321346309417337328 0.14710389884420707607 0.72594465651145878571 -0.69938742095528849685 0.64277358782404692139 0.11999117223689255429 -0.26089791604868284303 -0.30280951086284707552 1.0003052401726715281 1.0144818327184710327 -0.070981420792401980768 -0.31943423517799490741 -0.43972548080917872593;-0.87319005180873543459 -3.0778731767055633739 -1.6938233326782570209 2.1265064154183268563 -0.47526833723500333528 0.38257450411821480873 -0.97750493358627077445 0.71673706605428277872 -5.0157754766777973288 1.2323312156577295173 0.24275270107526164542 -3.3138759560119686043 -3.5306465840221123997 3.7007132843236636432 0.73971414708166816077 -2.4117094908916194562 -3.0330857003072169142 1.3373624577397333901 0.0055743977280854409284 1.2132164306282924304;-0.13975152312200700422 -0.50661083016421948333 0.32902345203517685546 -0.81392108074028102216 0.26012856483682517128 0.42865803276383979137 0.41659898011808710327 0.64175238110482413223 -0.14718945093123844692 -0.64838315414274183546 -0.78435587765796599413 0.24425823107989608207 -0.010391150368478336424 1.1996007984048957518 -0.2141668960363451446 1.212734324518122131 -0.31069125176267770039 0.17782241624719175022 -0.76019700748510288246 1.5086866004049568346;0.69926178441722031121 -0.02366360994900756215 -0.016985546774194892894 -0.071055242782015914926 1.2322409613721194699 1.5387611893273274166 -0.12948017662958341556 -0.17207041613685689074 1.1118469526054652885 0.4600992451807182082 -1.5470242523341912744 -0.18548772400790466963 -0.32196511664357069238 -0.1532833904212124454 -3.0841936445076609807 -1.0356317794745659722 4.8153308749095034003 -0.14198006680396310641 0.53635378332265026824 -1.3645555052752795788;0.2617584316826932489 0.23352969134056561495 0.4169181164984278043 -0.16429134120186120183 0.16373898454678365022 -3.0350475568131507487 0.58568970304785916703 -0.38710861004778468475 0.6172161749251019458 0.36240268166867767308 0.37384534671078473167 0.40964912754787785598 0.28199821773887684406 -0.90360397482786081191 0.24535961425792457424 -2.9262099481331347306 -0.068592766561186041541 -0.37412315478321817031 -0.31435258953159617157 0.34442246257737696435;0.85607822791962973064 1.0019651456463432027 0.21715316195645784081 0.74363125404931507134 1.0468999286486608824 0.88889465508048648434 -0.10227790150886974241 -0.28110096239242798877 0.19626830537288073031 0.44979227857075337882 -0.29013256262994946422 0.51394350698988788828 -0.46734998738318256351 -0.33348201259262599816 0.52325710779710021825 0.30244232755544819824 0.52880889249248075323 -0.45641589417585476385 0.60548423561675079885 -0.97495451071075334148;-0.74899773540746861222 0.016513810182218174871 0.32863599827440670431 -0.72761357578343843766 -0.42129216833816018895 -1.0389271453095902942 0.76170446814211467679 -0.04703478827997707723 -0.13478838434697648641 0.096058613838756023995 1.3861132780009739474 0.30764665566999649382 0.075745831569676722039 -0.5227735966346197527 1.6282202455834930976 -1.1313364371586063228 -1.6927427520494449098 0.11963226240868900241 -0.19336956187011122843 -0.26231162496434934361;-0.31626952691446547083 -0.60950085739810699881 0.19123323346944853807 -2.5411615486729091096 0.74765614590317441834 1.0838002929894603454 0.87565353080192653845 0.11749693202746819276 0.79884137512222497257 -1.0026566777465453217 -0.86856705721161853173 -0.42523393694626199224 0.1471853976246406126 1.2688385614011927771 -0.66603239601978425632 1.5425144076192909282 0.41651524583693860793 -0.30118462210596796957 0.119614064365036743 1.3867494660040022847;-0.49206384394503199786 -0.54543255778625510111 -0.18886492146490610478 -0.17380097862204343939 -0.44046352027599922074 -0.25465201738668369336 0.33078495648517536321 -0.14470760504561397397 -0.45446344702769009283 -0.63800881345959770119 1.4633540546355776613 0.24073144034262664026 -0.16955322972538591775 0.047129944990641936542 -0.087461849328214227861 -0.17041243638428676954 -1.2164627873155906546 -0.52543337609310936109 -0.13087210485079958655 -0.44194852850020582835];

% Layer 3
b3 = 0.735492839321651104;
LW3_2 = [1.2538700196475662807 -1.1352423836378100486 -0.59483526390860852473 0.12696689261753890676 0.78197574440824435538 -0.24567265656522738193 5.6215562432347256916 -0.64191356056372705918 -1.3022622794592257911 0.67435344368284255712 -2.6378350602890470178 -1.7797316349956211479 0.11532182534226714798 1.1282806057646890263 -0.68467296564677337933 -0.80859761768966298412 0.96686089466324875996 -1.1591875951065613304 -1.3825999838784464036 -7.6024469707978665767];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
