function [Y,Xf,Af] = ESPER_tco2_6_Atl_1(X,~,~)
%ESPER_TCO2_6_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_6_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.2068609653838447;0.58384143533499233;3.3150874030735866;-4.8896165609248206;3.4787418624011579;-3.0864869244225051;-8.6050863682356482;-3.308764851266484;-4.6450063124997758;-1.0929190715520902;-0.94647767271043937;0.61951741314910214;1.008699425747789;-2.1597406185101637;-1.8249158718594889;-0.56304588680181811;-0.47245770155529099;3.0171998208152768;0.1087024327519184;1.2463807727428973;0.97275654210141738;0.16545295668696983;-1.1408782837413194;0.63059542751751996;1.009661907426632;3.5572204364688003;1.1720908304046476;1.2867240148145249;-1.3468273900290182;1.3558613869074696;-1.9503373316212134;1.3946585632763548;3.5497539317650273;4.7125547288078984;-1.0159520119138834;-1.7785844391914203;0.24334086589160861;-2.3126503531081188;0.66673989099122377;3.9851333856620057];
IW1_1 = [-1.3190002211469924 -3.5425271731609214 2.6246290573476405 -1.3882501547331034 8.970071010934026 -0.9341791708354209 1.7798526916752766;0.1602228042008931 0.066644088238023452 1.6110808159300976 1.1843254650428263 -1.6964498472067284 -2.3573461904662762 0.32428690576139563;-0.46875627336175574 -0.10759698345949013 0.59660095799910884 1.7388385510580668 -1.4741635197056808 -1.4766525107965185 0.39079600706468576;2.1058631893122666 1.5655871800084225 1.6377077383933938 -2.3642588916623453 -1.4018190495794081 -0.75415399827150886 1.9500169669589988;4.0834735673203388 3.8477699078355583 1.1777187449342899 2.6667839048032502 -4.7890701367097996 4.2701266444447974 -3.4921597647320874;-0.74951044498333552 -0.041680765487062003 -0.30527686740650356 -0.30336081565242318 3.298052081253974 -0.28125749699214841 1.4956029651976237;0.92719762886638746 0.3359640425509321 -0.79926736621108629 -0.070435228642714412 7.5725947612109099 -2.3558829334283398 -0.066933035471349572;5.8439981996161254 -1.5377860508737482 -0.62495727159540948 0.21690130678398195 -1.3425107588524732 0.3375115763826258 0.36101524058930645;0.64822919959333181 -0.50866968331857954 -1.6073488498481936 -0.92633720150410714 -0.58773223986437184 -4.3460552479491765 -1.0147672047164065;1.4939983096089919 -2.1712744673779447 0.34740816464558999 -0.1910923291073226 -3.943928098914506 0.6734077300424719 0.60045108923606572;3.9680031044352719 -0.73473338455786863 1.0941894172453326 0.46487413812939021 -1.7008424465310203 1.3567464954664785 -1.2892342967759545;4.7694618282415853 -1.0215583367331449 -0.063544073661488815 -3.5344010404312254 0.66159594062781435 12.068206971101734 3.0918532095195905;0.77137392855333831 3.7450079100042739 0.76127073265410017 0.27115699616555811 -1.2436357519554784 1.7365997912568607 0.12934654086611905;0.060395861838320665 -0.46548126540078 0.096914509131252699 -0.54488430150793343 3.3336622994966509 -1.3953910826671163 0.46797686604816979;-1.8881418914459733 0.019518969970892086 1.3630501793483116 1.0285657000675477 -2.6579143867146002 2.2393391398561411 0.73930277323811189;1.4405980899867041 4.1047261283098937 1.5687482990483419 2.3313578551747201 -1.3995721575907694 0.44900645765725378 1.3509334271641662;-1.5640216129885831 -1.0520733921025873 1.6447913100520273 -0.23512440162131346 5.3006618509032926 1.2784145258706987 1.4406241887989715;-1.2005911529365594 0.87497354143150119 2.1251701978990014 1.4488559363376921 -1.9155836998883879 -1.2239050951867518 -1.2066879629180773;0.97464125462557494 -1.1492916051624062 0.020374654078717323 -0.03723545841823047 -0.27812406385083893 0.37747176990312092 -0.46950989012082106;1.7476820346471125 -0.344351642675501 0.29097043605439488 3.037932922481434 -1.1640657375106216 -2.4694473017252485 1.6969121699734717;-2.9114689823584983 1.7136956578098621 -0.25961190177687909 -0.033578216330382854 0.094648430834816444 -3.1420476077551989 1.0852589170931541;-1.6500583522689622 3.0552407469278897 -1.7387277848799361 0.59138071882783205 -0.20726495337849576 0.52991408673793994 -0.65156632222198463;-0.23707929730081811 -1.3549046941201128 -1.1080492269884346 0.18678063461029637 1.3590045019788752 -0.71377296409523172 0.43708814395063977;2.3557829439246003 -3.7008909618920711 -0.82131748453199993 -0.15421737265977534 -4.9303302613693569 -1.0275981023600305 -0.46863463596296401;-1.0263949526117344 0.27865604191012228 1.163297810092651 0.16348470532400489 0.4911416269722314 1.1041790941243719 0.74822789061530637;-0.030423159875388222 1.6271924400871209 3.6605140034186241 -0.72220932347505218 -1.8697240297186504 -0.96688360628801762 -0.3924383976399422;-0.084998000824753867 -0.25032958839567554 0.099574890036112376 -0.020922167379694073 -2.8637461207114745 0.73391703112731432 -0.38357084842936107;-0.41604037018943779 0.35845557929554422 0.41085788765137987 2.1856776113664163 -1.2495685625908231 1.0378932497083697 0.042174771099196179;2.8628389222716244 -0.98598017061519072 4.2267964827047289 0.17996803456036381 -0.76514106050483244 3.2725430930389425 1.5679223893614724;-0.071114916399912492 -1.6993494335596533 -3.5146169746543299 -0.083262931008872734 1.6126098198407148 -4.8126046321697382 2.0902593021606202;0.090632480057488418 0.77054103005783992 -1.2045879242368602 -0.8333198141081537 1.3242937211507679 0.54993029497473889 0.54420057768954067;-0.49180374389974585 0.74444641681599344 -0.16661504294191812 -0.013015791820612443 -1.9816536643891727 -0.24274999229519031 -0.078321078387613305;2.1236529683120811 2.4894593043330326 -1.0747434597031609 0.41513988443893646 -1.1829381850457774 0.44963541018245362 0.083586026027587843;2.0745339971742434 -4.8601281046572185 -10.275780678957354 0.43889152430232869 1.545780107486229 -1.7467404530035293 -3.4779259950566863;-2.2821764506860962 -1.2650364536462753 0.056077906141860284 -0.22858699445986214 -1.7606060578510556 0.47392316902353993 -0.22366515807917536;1.1721416515351613 3.2153115680630426 -0.26112346521648716 0.39754334146730197 0.14782342121421405 1.7567785660498474 -0.48461600506349234;-1.9023226726589286 -0.54586170102044762 4.0552703734628661 0.12130482842985744 5.4747407761251248 3.183346668226485 2.1005522974349287;-0.069202036442707365 0.20934233745240902 -0.00087685473913156307 -2.3093371807741563 1.8271318185462353 1.209316786154651 -1.9207778413382146;-0.68404649971710418 -1.973693937698064 1.7870257015032627 -0.13307989587884966 -4.6454783556059622 0.23808036413962985 -0.45044490727604947;3.5714236351652642 -1.8990874590292433 1.6662459436166495 -0.012056666713110942 2.0831990163059539 -1.9787301990625266 1.4691289393537503];

% Layer 2
b2 = -0.042980227527857996;
LW2_1 = [0.017669557711974059 -0.048643734112321181 -0.1351273579358872 -0.063980521945706081 -0.0092068103376017549 0.1770532193165596 0.26373945484660444 0.034934074400321383 -0.037963552593094751 -0.51868560102012151 -0.029291489956195713 0.0032084712198484147 -0.1198137018380514 -0.29707446948285265 1.3836671888260401 0.012254321241243954 0.12729520006307202 0.049539036240058287 0.51140358944501929 0.021384901141447712 -0.02485972453169084 -0.092325763378184239 0.14727916583755535 -0.098395919509044916 0.13863788471766489 -0.0073127593977611264 -0.5841539428623318 -0.020641778483949623 0.016689666289577191 0.026426822915377658 -0.11578212459983177 0.77821593199941774 0.10717417962986757 -0.019477909665990008 -0.20402103216931555 0.077298491676968256 0.019158710277359232 0.042281407141313371 0.119621266207833 1.3638222037622301];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
