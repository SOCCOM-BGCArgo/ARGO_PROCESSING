function [Y,Xf,Af] = ESPER_TA_3_Other_2(X,~,~)
%ESPER_TA_3_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_3_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3299480779813812603;-0.69465651205894340947;1.7427119577212437651;-0.15915495199132181914;-0.38973848871966559892;2.8429273113044559729;-0.73916832421375688877;0.64680549644631502026;-1.2857831516460467292;-0.48491844050686999656;0.6065539673305436752;0.13276010337410004691;0.71790375556740249063;-0.11591818743406630265;-0.82925265987906704446;1.3114067983787742744;-0.079332447937908737168;-2.3421896699626958416;-0.90865344475820719605;-1.9520353080373336052];
IW1_1 = [-0.077330322149114685826 -0.13602129450620625839 -1.1237418877852591859 0.12418143561132644059 -0.41734804816018877816 0.48593205028071112528 -0.90874021613039046574 0.18452495439940860833;-0.089070267326826671472 -0.2996423410714126323 -0.47865464851964112381 -0.37016919961795524685 -1.0472911292044846387 0.6010617272990401716 0.40272282125700203936 -0.0061758399500992933184;-0.5724221446909354416 -0.045679000753777128374 -0.057796846042203420257 -0.019198089377599127092 -0.19716149064105045752 -0.005391536346958041015 0.21539657789404917376 -0.069612473712322944785;0.020111381698929346046 -0.17052078837565007308 -0.17656620974980374861 -0.23122234256415180598 -1.3774367805027369904 0.30889615872418896281 -0.020265888377554570204 0.41929849936298829727;0.30349121943276530233 -0.34530714935777179209 -0.2548909768937531739 0.44378810453596484464 0.35032403271270734502 0.023400819243866249897 0.041400156813286285995 0.74476582492571929972;0.43193802695579702755 -0.79744727206234222727 -0.76714986101341064995 -0.18128598160957817842 -1.2468411598069550905 2.0028132674701257798 1.0718208837337688255 0.51992845901343753834;0.77636680024831872249 -0.14433924859695454468 0.5584235035106459577 -0.54442285842654258854 0.25334463760709552416 -0.061177998196906870076 0.10475721995338663217 -0.4212539622883293422;-0.21011212393420322653 0.25252161332559369677 0.15672486896889625818 -0.23652136632805487171 0.60321465532318463421 -0.2799152817019445183 1.1864825031855323889 -0.4413471890689097954;-0.47603711853835112278 0.15423789132864063056 0.62230730738128237078 0.42424992396850841336 2.5575873097970287517 0.081777888701935211313 1.0384986182476214633 0.6852969659276404446;0.31714652851381025522 0.018356434397381684448 -0.11291239383329057522 -0.90315193116111247562 2.817653061917439139 -0.217095829799552692 0.82507837047197718494 0.18245775859986501644;-0.076288834679844846898 0.091885813044221983925 0.23126987167555976277 0.037748161600116243719 -0.44625999881200362207 -0.38898426706702543543 -0.37168944389996683153 0.64620005039041783501;0.027499746144948607196 0.0090419501805099559283 -0.29157687146911448473 0.095304767176040652843 -0.92918669094157790855 0.031187136408184407133 -0.30408527815296620966 0.52131176975607496082;-0.26573144624542732739 0.086371819143220604498 0.010048641783124782553 0.13962365095382925362 -0.52097315539644573068 -0.16319029080781641272 0.054535989964105531513 0.014288833232545998866;-0.31395710410967725412 0.17555069530823325108 -0.54591481754654536118 0.28351171416438231132 0.7864710806369623608 -0.11460018342083012899 -0.58673454994901796944 0.049306781849888021985;-0.40493887086317398305 0.078185768176367798077 1.2066308229126858631 -0.7911304253950499632 0.43119929570746357017 1.1275293632990612824 0.69646702056321485585 0.86554417769313463094;0.05992618235265018134 0.60429470186259581777 -0.56828325733287021748 -0.52327359109611848442 0.19348355319899523952 -0.4677690934101065845 0.30819778285824189767 0.26154519092585598594;0.39801806836354280961 0.017044643827798376667 0.82647639329398836505 -0.29574854579475945426 2.8081738497247838993 -0.47136726005498408298 -0.25100772216630778955 0.16403681939797279399;-1.1038347238885537482 0.36498670961638129961 -0.89070392681894206 -0.94845404474706906939 2.4676231696226254009 -0.53852592129182441649 0.57235259474778898969 0.29967719003166565228;-0.23386420524639506269 0.50852180653474199357 0.20764948903109384237 -1.4319532220936452838 -1.1412780432271529829 0.53592763388173281225 -1.1566495310214757186 0.081216600810583058911;-0.72531168066010776041 0.72773303582513038101 0.4860440740253131886 -0.28080274041778258143 -1.5273564680169784413 -0.13675796338210782777 0.56680154767353763123 -1.3444601308060606382];

% Layer 2
b2 = [17.616113831411048807;-4.0530387191908738842;0.22658711755385577136;5.4477711077573571785;14.894852067135451179;4.5533976535468587699;-6.5397445349410592286;-12.275269501140179784;-38.203275679646885976;8.9561632365651107079;8.0437283240085868385;0.91140322913141769146;-1.0652390596257135247;15.606615137000881433;3.2443189257285558469;2.6970186665664761527;-6.5700270946260959093;10.166513059434860722;43.866424945343844399;-13.256545954384900909];
LW2_1 = [2.5448435075952735573 18.127828670370782049 19.785352148637919356 2.6114134563384152621 0.49253708371147880696 -10.910684718534440663 -9.9513566438859868413 -48.736168606981394191 -27.88810668693044903 -2.0456523865451408106 20.549736830691713863 1.1022589932054698281 -16.593526104381123076 -6.8246940424769082512 11.648252167988097483 21.817799821658354631 19.811713592282170993 12.71007554771450998 -11.698483875535696797 11.916403292825695104;-12.544503934992453864 5.8250697624894369753 -6.1853160046449433551 -14.54222899021932669 2.9327635234043976098 -3.6002838385180937486 0.31236177442089790857 -17.399277930739746267 -6.6445103435415013848 2.5557464083673346877 -0.49187594720695343442 5.8859681620825741177 4.7854016618562873475 -3.1057836096730433439 1.8654366543071667639 9.1725921872959528258 -5.496277330474635292 1.6391759056607464462 2.9490647007408172797 -4.9251060395967511951;13.6568035630825797 -5.2497843235718244514 12.368559291751372697 -9.5266735577015246861 0.70940301231871782939 -2.1273891274277980656 2.0218281834523641471 -2.2241723355849338795 -0.28905823145409254016 -5.4491059442264893065 -5.200027938041383635 6.7147040004482931863 6.6179145490908037885 -8.4081564764166465409 -0.11827234309359556386 2.2061348892444083702 -5.1705354212650034285 -0.34734868847981292816 1.1349136753884090378 -3.5471569371222155809;6.141943373084804314 -3.9623526823735950586 5.7577117902842163133 7.3097567501606395268 -0.97172467018646324632 -1.9823733911469325619 2.955457148435468806 7.5123479224585896219 -3.0531839502813968856 -0.96785391013458244025 -2.7395738301804954951 1.3073641379607527924 5.9673680446233392516 4.644375475471509418 0.21175503479382298821 -15.900109680282978886 3.5923009588530927516 0.35467547363219320555 -3.4057933541521792087 1.1012038597050171074;4.8344750103242795092 -2.0953377766179976938 -13.508844366808018478 0.25553027277246537219 -1.9465174002240546169 0.71916446400563793784 9.3025409947089059415 7.5378648307480222712 -3.9729670327766082316 -0.011120641597323094318 1.8111844055812975629 4.1840980504683198404 16.520804078686463612 5.2265730137776271746 3.4577161748869582603 -12.52609868106438995 -1.7027195038480411604 1.673114701767614898 -3.5420009696813017364 0.31107947260026225234;0.91518559295170132106 -0.79816437996712774616 -3.6357148756993717953 6.441033525617966049 -3.5825251023888760038 -0.055735826368624272198 -0.773306583580060658 0.99042263427910015583 2.4195948034757330802 3.0328287253470560536 4.1875668531703400532 -6.9878289699511411115 -7.9772022869299137326 1.0521136713449044109 -1.6455233990478015382 0.32150088853630609531 -3.9804113403812810823 -1.5471178721999307992 1.532337438953635278 0.36314546615048826084;-3.5226087803965282497 1.6946549320192525467 4.2072234106844561552 -0.81461504205787804711 0.9763746000021266136 -0.090755036650066248094 2.340717964896745773 -2.3746708969535652578 -0.50668474641258909319 -0.24398598494603018771 0.83622518993444505675 -0.43750496384657372451 3.2411073569599349042 1.6134668599145529644 0.52744365970968132284 1.9047331091628998401 -0.45687444986745001652 0.31680922529878929872 0.18840871184654855996 -0.36671278944236057606;4.7573736308334124701 -8.0603823196291095599 7.7327429564795773231 0.62845973238755015178 4.298717416521083301 0.56368940164518555047 3.034377009055737151 -2.0492813694593010609 -3.4947095497613638315 -6.917915146499439949 -2.0416722179101092216 -0.68937715466802129693 6.8752607925974302816 0.11063379044090829173 4.8592853159475684066 10.770256752857333638 0.34384352847164828537 1.0103798242546411235 0.3232102047899452768 -2.2553099622269492386;0.56724683933639508115 1.2114739511301955144 32.804959743431055585 2.8405967201861601623 -0.19387404117927226066 2.8292695388361051023 4.3251947668568320182 4.9497572314502855662 2.4229396579965123415 -1.6526428085773128274 -4.3814580038802448669 14.398367451427727559 -0.0060839162949900705418 -0.034634749290702315783 -1.9725689274867990175 11.421653444827452262 5.7758709305510240739 -0.47349267574861869656 0.038927498496756196555 2.5136190499814730082;2.4742162833245684439 -8.9755049588627784374 -5.1612090552538063548 9.2477043952840816132 -7.3940608868321104907 -1.1109621591687426356 -3.5058201474457462155 -6.6522806338291244899 2.358103076623218719 -0.11685560761001627383 -2.4832463635502524113 -4.873396537701260911 -16.889407609422555367 -1.4101987145721899264 0.018789334134885839894 11.29641347513673999 -2.4853595986753327374 -1.7729838186676174505 -5.4146354663285807263 3.7960974863016052616;2.835039702906967829 -2.7363258169937840769 -6.8647649893044642155 2.9883905779488775245 -0.94942883789338849976 -0.11077493266147134254 -2.4001359937581394632 1.5940798970431939718 0.16258198547794275313 0.13494203287073860964 -2.8794486288178671174 0.90822136212745419037 -0.19479162203527219943 -1.7495379835602478114 -0.56552697142871699576 -1.3988650469913752605 0.96034841052951713802 -0.32123602160885583734 -0.28298221133526157978 0.5053956638103788146;-1.625239146460607742 -3.4539621741080819284 3.7585617101267443374 2.910460501846062531 -1.0035762262415988122 -1.141565350699725867 2.8008820866746293454 0.77830659838035254339 -1.0252504690284527378 -0.099205824680948004324 1.4990009547452245453 1.0400584561719201648 1.9297736508827243451 -0.0043088716759383822313 2.8215770604802141719 -5.833032016054955804 -0.21557104116786962589 0.78079558411810845442 -1.1630837132886631125 -0.045916942482846730134;1.3490257105865763876 -11.224151180782234505 3.9329297155300486644 8.5825091742706955955 2.8977246357417838496 -1.1601152744661302751 2.0689464142776645694 1.354779238798700769 -0.408361520961511959 1.6920168786573019926 -9.6692038030120226466 4.5200215505233458657 13.217596999105731825 -0.60399393651134536398 -0.4695161843038275773 -5.5816012876671932119 -1.5097717699346901998 0.4500312557006266867 0.52344751981724413348 -1.173959317058525853;14.239592064884879719 30.318196959626753539 -25.783185051316820591 -17.030259165829964019 -42.802428502155002832 -15.432590390011698744 20.891563582002458332 -14.398892287078886909 -37.886704189402131249 35.934515407092575856 -31.409862251754979923 14.625343767309411547 2.8145178113277107279 -9.0897486362026906903 -17.065778250651323589 -8.9707180957446670533 4.595247508192608521 -0.78115512722305879834 -5.0299862352950173161 31.368449315028676949;7.8943623197197343444 5.2611232672407526323 0.32100499325069764556 -1.7109438348586947232 1.7194976227960341308 3.173859975368103381 5.7770992242998424615 7.3158866429582403157 -1.4349061721149258819 -2.2971211602027468146 6.7294559950701797746 0.098267701317945529982 2.6797140978532545397 4.9834437493772902883 0.5176577229313358286 -1.1784712396972956139 -0.012712332021023040746 -0.69412402198706579792 -0.30103807392383286068 1.3270535050487957118;1.120119317326985664 3.9022046879273775133 1.3213532059868373647 -6.9656042693134603283 -2.6843295423368900288 -0.94704226044312711519 -4.5933181385616244086 -0.89677629200352781957 1.8688246566490003264 0.87929524114966006731 -2.8051821001096137742 8.7039259725011302038 -4.1305700143061443441 -6.3363263712745974132 -0.71164968059497246688 1.0215007864927669878 0.039858826705531619217 0.52793742706139945575 2.4935567463071346417 -1.3760665477925937417;-1.0541544737949579691 1.0212289348821947943 -1.2416013625687190025 -2.1819182315523275584 -0.92986792316223898514 1.9187121173990031586 -0.65208202907172918561 0.42533016578524462936 0.93210397626107233116 -0.19801731256130583603 -1.298774620570393834 1.6616631276674826978 2.5705008706453296163 -0.1391671528625615939 -1.9183304117171713354 1.7409152448134963542 -0.42348685029136495794 -0.31822351695040862474 1.0612750329821349915 -0.79714529082147522754;7.1476676944582795414 -24.541012043530393782 45.300333611409030254 31.573863902106801049 19.11959573048816452 -19.639992593673980537 -9.7096623924514204873 -31.981115499027101379 -26.353262126638895779 -14.431240602820299301 -24.232349159088265367 -31.784620927466676221 -1.1369232800813993123 4.4526219371430535432 25.061821979122125725 15.672694930278007419 -6.7170762443395197749 8.0252253026743698427 -10.362767648026284917 -31.999275575290660356;1.8144113406929320842 11.526366970306726856 -12.548194539345496779 -4.6549749094934558258 -0.96056829075364624781 -1.6277908104112701615 -0.14915602540171618573 13.179357535081846819 4.3068083934897360976 4.7066473397898560549 2.9841540506893498019 3.5606961652482285174 -8.3924844954044957035 3.4708315394801148024 0.88605883405142082943 -29.06043787950144619 -3.8470594904775095024 -0.96479418415097084605 3.1603620419934714825 1.4647080482715939542;1.4761803160548769842 -6.6897781668965530244 -0.99695081165215271302 4.9403541711888054877 2.7058420058886958337 1.237740807517628383 2.2804065198001759462 -1.9148444621415736666 0.98462442653801662829 2.507271806193024144 -4.0010195789456668436 0.2534757940487318284 13.189807425732212209 1.0208970040474281138 -1.018553596890594104 8.7002544194026487645 -1.905053545801976167 -0.99364312012662103779 0.68399641927526766416 -0.8545248434073455801];

% Layer 3
b3 = 0.15961893026606721602;
LW3_2 = [-0.0045426063482539823235 -0.044939655086641772108 -0.022008805780815630243 -0.064245152647864484097 -0.029808667634031192628 -0.10330416074449326469 -0.76090154267596632476 -0.022620262245693183167 -0.034286153791022219717 0.02016874829515202458 -0.75128854323114602209 -0.060924858059808323363 0.12261387365997432342 -0.0015963672413407934986 0.058842409135116478802 0.066579006231266738003 -0.15994870728162172147 -0.0059165943603555880975 -0.026719876650547296631 0.095408277815759751084];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
