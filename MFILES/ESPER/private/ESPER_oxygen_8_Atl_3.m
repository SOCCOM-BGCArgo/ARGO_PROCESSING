function [Y,Xf,Af] = ESPER_oxygen_8_Atl_3(X,~,~)
%ESPER_OXYGEN_8_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:46.
% 
% [Y] = ESPER_oxygen_8_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1227776944841512119;-4.189391741073757558;-1.0129801127463411436;53.770288644941764744;-2.3466046426849449524;-34.707425893831398866;-0.12022238752811867379;-4.8483324812158601347;-0.74900709894881245532;-12.484972045186594869;0.7981779287586725502;0.32972547587826461779;10.207527685733387202;12.383483056688509905;-0.87857037569346085881;7.4510183721569607229;2.2389289463353456711;2.8594490837905124359;-1.6867069990994101314;3.094557795239241571;4.5931312733760778499;2.192710695450069025;4.0460086591812007839;-6.6711372958881716144;-2.1666038187222160794];
IW1_1 = [0.012557220225837660219 1.129160362697891884 -1.9735768809263594115 0.0065750888103807015456 -0.28692643597460115723 -3.8292481966111235892;-0.70083376226514004781 1.3143282006196768119 2.3663394020563632836 -1.6732359032356740602 3.4466887078963539537 1.3905861087077142635;-0.31093931073927605357 -1.1908666470422162309 -1.1266351775977481164 1.8006329761994017691 -0.15195744255285020818 -1.8668361501328134544;27.788743215248167928 62.464715503686115028 113.71608263199884448 77.088329959088028431 -140.79465623533695862 108.43617960446447057;-1.0886219441943800756 -0.45192372558771043423 -0.47268099000341995408 2.4915347025734186914 5.4845403172322999552 0.14228244602297182575;3.3349800391651469589 1.9565460862035275458 -1.3398788679226338871 0.41145442468482396059 46.857065185810803598 -2.1575706615082683726;0.2668501908802015099 -0.44413089486073187295 1.6821334176096260915 0.28814603545525646622 -0.74231229866761316849 0.081236179584530499032;1.0008039875505403415 0.25316345649804411488 0.10635222163161947573 -1.9793540137104044252 4.0627847012195221765 0.33744108343716616716;1.7154594666837761352 -3.397807020290442015 2.7731387299432932458 -0.84448932694151457312 -3.5583715621428710918 -1.2954244163586232652;-1.1309415140952663315 -0.083717169587373158057 -0.91136916878170926015 0.53498216253314168078 3.5125727488726572467 -9.8654904416946411772;0.30838279914190475095 -0.32175835476946207381 2.0713112521288290502 1.3949539007656541756 -0.78863419847811344621 1.2237918530587557076;1.5045669529922449659 2.5613951241872645603 4.4965047387164380766 5.7351407242871879077 2.3679461726966333224 -4.3657663711169405474;-8.5179026474453038986 1.3918676015158732984 0.19320442175491145398 -1.2769086738235222445 -5.1240264397330772539 -0.97382706904257654301;0.23620512355325140597 0.44322765603409119972 -2.9515928024539044294 0.31796332651553887994 -7.1939621044076078604 6.6607049908098545643;-1.1553971455156217818 -0.30260481640956427007 0.31661842705088566463 1.2890353567884607067 1.6969175639427147573 -0.73953462047683549141;5.2651035819435891838 3.6355050456924122848 -3.0850494088277620186 -0.85894829162822705637 -7.6642642941494125708 -0.5660889639058201972;0.71876955174479284505 0.34917698175849987141 0.024867637887879837089 -0.74868804449451686889 -0.96774481996236139114 2.7900152975412537693;2.2975498727934446919 -2.2425332649206426439 -0.65845915105826213765 1.6256554963048597262 -0.57918049692274498064 -2.7931957339115740524;0.0087779976561270407764 0.77518342408415652489 1.1498871254728322278 -1.9878043704037287043 0.050355484610022059611 0.90640825865463559019;1.8376761993791708161 -0.32198639196243089566 -1.9626552578914049363 2.8323443519049709138 -5.5693219259866202364 0.61596543908039591564;0.15204196022959023948 -2.8005329619536709629 -11.470632878683630906 7.7859541050115925742 4.7179033007471105066 -4.3382739621950019426;-0.55346831055467737848 1.1929160393372750804 2.2599843060193918198 1.9250916075598385468 3.5348172854248893771 -0.80593293389087417022;0.60542857775407576959 -0.055466025226953624694 0.98767642977939040794 0.2325170258791808553 5.7516926479151102569 8.8289094427556182865;-2.8964680068714319106 -1.4461250229085802488 -2.3761855835083456334 -3.4917647268534062199 -6.474774262875720332 -11.531531325986673409;0.47839920497214138972 1.7454072355808416539 1.5383442162905869299 -1.9082640085579674061 3.7746727433571343191 -2.0348685488404179011];

% Layer 2
b2 = [3.2599642803877819652;-8.6478368304428805402;894.71929386470856116;-303.71181542137333054;-715.33677359371472448;721.13254128698793011;946.29946866613965994;29.751562978624068734;289.75355012534265597;-702.94957898268057761;-2065.1824596360684154;203.29126401885864084;-2378.2972357695307437;592.36254140278003888;520.19561625839980934];
LW2_1 = [-1088.8244767544731531 419.97877966702827734 799.10818931288679323 158.19297105812475479 -622.33217647509582093 -155.44220327547668603 494.06843350956415861 200.54674350158762763 193.11912021483115609 -115.11553887295355025 -284.1588783910018492 435.30507780065227053 -367.71262271778334707 73.380187908653084605 -62.727275243801933868 -130.6243136652505541 -359.16401659325271112 459.73251571476589561 -347.25256578051903489 291.29556021026712642 204.40242200485377566 512.1054930064541395 408.46275090368243355 -106.68543776919609911 -904.96543395405205956;-5.8014213092833459839 0.58484433878224717507 -1.9764047322955915487 10.956025623656698187 -2.0595993699126098342 -1.6280808131946600259 -0.81406465804546435105 -5.6506783000021281183 -2.1387363368731286961 -14.146933665255412294 -1.0813390858095799363 1.5043088135349211854 -2.3897659139250073679 -0.69560330571765394136 -6.2142201145451299027 -0.70250506040218874126 -5.6097487904263667602 10.94833641773636046 2.631299877380977037 1.9521812790411317007 0.5242271112467590255 -9.2159828842657560699 1.0349840567746133591 -1.8184537269917924185 -2.3673871810265625371;-15.573520493437113643 -162.2164819144848309 -47.933029474509730505 2.9035964377974812223 -55.811279377875543162 57.432062239231996159 -116.69026438786650601 58.927078586726814535 -65.7000881613769252 -114.63732341009684035 90.634203689605655541 -34.033084954530970379 92.192994467518744273 69.822490638403834851 -21.36612183383559227 -24.689543098202555882 -241.03402953792306107 -554.56721070314972621 129.93175177966708134 -59.769309106867609671 12.529898258269239975 -170.09939812755564503 302.2078929674357255 609.40482045896465024 8.9791827454013866117;158.88932239824569592 424.02934954984681326 -523.03484262232905166 36.507023853043378381 -84.166273586857784039 16.179022790819697519 -385.19865031610601136 -49.669720759923649211 -98.13008288866066664 -294.28048701734400083 424.24456536581976707 -140.82246358754446192 -184.62077560934667986 -278.89825110181709533 -383.24312071795088741 -118.21051806118762784 287.96648039587245194 -246.48476447516003418 -155.54868208464654344 15.220449642561472814 -114.54675687042046661 -134.27616775887213407 241.16703528708882232 174.6036331038077094 -108.34771937577882284;179.75119382931035261 -35.73578447894573884 -141.00137461655404536 174.78391990959025293 -113.42579043807242556 -10.981332535471347356 163.36284079318221529 159.17885310112168895 -261.11850172249108937 782.77207216199190043 395.93796872915157792 174.38934661545692961 165.40924875010685469 134.07985225007169561 -107.19655593725657639 205.45968934396071859 112.21961779905578283 362.81822532923359859 -837.10352859316253671 -374.52277123880259069 -282.18277044831620515 564.71154031623791525 -106.68380283413522136 -794.93499806423903919 -280.31757317726925294;-4.0625365982781707075 -237.20198906003460593 -120.77787269333738607 33.537522634809526778 62.858276729909128733 2.2038150476945213008 -247.23132041740421982 -10.079084681016578173 3.9879996990656407796 145.97780399013913666 148.73588604794210255 -38.93707394736570393 25.982184688910503922 5.8102195411275125991 -98.396199034678801354 -22.831362881581984681 -221.61212919468752602 -638.04746615954627487 105.61472591285509282 60.595718841602462135 -54.919037203907159039 23.111772521917750112 -0.38924633836559680011 103.62569638108938364 58.916317310922494244;-3.2326563338853468998 300.06496050088458105 -106.77943202170465042 -186.37989674087600633 -120.60249291155551532 -298.04293290043221987 28.964995514890460981 372.72183393746189495 -278.89224387275373829 419.66200418829441787 -234.04770143267316485 -43.933073228100759877 -620.15884490051087141 466.80449422931064873 725.69908729407438841 100.68472663140146039 294.88061499120664166 99.347021626046483789 19.637749661123269362 -209.87312343780797619 71.387845548864675038 -78.046504743729187226 -86.10126045375176318 944.59812902773740007 361.26534229599860737;1.6230617839777083944 0.90248041524711697381 3.3094416574601028813 29.136623783976823177 -2.131849803700168966 -0.34451050201741861834 1.8602054773699623347 0.65183248528666937194 -0.70070476271162673854 0.93776070709363512634 -3.48998907680026349 1.4202836498217177308 -1.3170436610773703645 -0.90668783522964413457 6.8409570288937455729 1.3593388879818730786 8.6917085146543602292 1.7701158001752088644 -0.77310048669796982423 -2.1315959147049587941 -1.1480815060147715467 -2.6269105636921610269 -1.4861396043508696696 1.3256223776987767771 1.351610671507361916;-0.608433106552021985 -0.23567853248174200353 0.14218165816420436087 294.38396633905409772 -0.15048814844382066291 0.15724750422908331804 1.1549564762311692601 -0.34671417938211207543 -0.6648392167677966702 0.80252786902392214685 -0.54228285438840062582 -0.29399006658722515173 0.26344287123635701242 0.11146903221837177467 -0.45184756844479151416 0.047738031390900603768 -1.0141723566759250907 0.59044954306394814569 0.66301321066378660074 -0.19167882254669726949 0.12076601414120780031 3.8800002097601136164 0.30303637220653734108 -0.10862198549096602207 0.029437477565485457159;-123.76976214244568553 -142.5132499896141951 -546.01231799058768956 382.96009422840927527 143.91436485125777267 -261.87358380104370781 -801.85381904056214353 133.04342399843471867 132.13996754116800503 -476.33219860648296162 347.27832447407701011 -19.749893985856814993 53.592618771663708799 182.35767983812687021 -458.47086419294032567 174.51957403200700014 -1597.0332725111434229 695.99620202249582235 621.16247501943439602 -83.203367897454342028 -94.141049154712476366 -766.60679397451929162 190.54060800401143183 -175.91669904678352054 289.29638357006678007;-174.67659422050806484 -216.17005882504759029 -820.00000970052690263 402.64396560893743526 330.58757397375291021 104.12605490538508946 1042.8141297664524245 -317.9801242585775185 447.7353881709522625 -1435.2229224157510998 -0.25231798645826780669 -83.439892031404824024 -513.65018345094358665 -19.994762289822880064 -1462.0883130858312597 178.7175270706048309 -1953.8136321768117796 -2574.1608855420913642 42.196609024559499801 536.23589812486409301 -509.37898411352028916 793.91387953055141224 4126.168568755681008 -921.29211996258572981 -698.13868223502618093;-1.2180235167709230204 1.653090068616526187 2.0093717074813275403 212.53202025875734194 -2.8972958193293170126 -0.072712474346190617003 0.17625258622907191697 1.7701827942640606661 -1.1693437996453612815 -2.9229692812835317284 -0.44890355278428561991 -0.30243037390606414272 0.29422295282876703704 -1.3649273057194977188 3.8681994689258205611 -0.092398546996030075928 3.5544382530696716493 1.5390645070355133406 -2.9377897172843483453 -0.84002010700987206349 0.35419703364189691897 4.7749183128805636755 -0.21736723706649108134 0.17521826347677088576 -1.0788475036109623773;-241.61859718776327099 -290.74736816205580681 -49.84751031964836443 -353.99092129478566449 144.30163176890630439 683.14977688097928876 86.925143189892963846 -74.214949586303177398 27.761240455371556379 -1149.0022607335404246 59.643283535298209586 124.57577876853630983 385.02837948697697357 559.94480065294408178 -458.81571443540036626 -109.41715570772602462 -944.07183752903131335 -1083.950807966050661 236.11141501560265965 -247.02565704549027714 -334.65958877575343422 169.15617424038646277 17.870031124913197118 -2173.7355979334288349 -97.75369568898986472;1984.4932809455508504 362.09421838711472219 75.119337718572552376 2136.2025495898246845 -115.83683900438632008 -145.56961859606420262 -564.57842368004037326 -543.04056170526177993 -217.65887246482432715 -735.40108521460308566 160.63978800874045305 -149.24032432173717666 193.50287792756142835 -33.465244240702844536 271.07875238852540178 -75.894571742587331187 -1054.1112892552112044 887.47528567443691827 469.56147217837087737 -2049.568239288053519 1815.6050996689170915 434.21732106758827285 686.5366207646723069 -17.694162612315004424 938.73432610418217337;534.81121679393095292 350.0950493318075587 186.51712559541346081 20.972659647893948431 182.07740083112332741 -67.819951982144360159 155.63099065116040265 -258.03104573596965565 -51.011090630815587588 -68.15286463997564681 215.00961392437008612 94.816122493889295697 68.529539286759330707 4.3674820025749996333 693.54754339463329416 -315.3126673275442613 696.42837952563684212 -66.731084010429000841 1.2388710047178572715 -187.99570438458346189 93.746235191940144205 -512.11295127094547297 -227.92241174390065339 -544.66622014528775253 382.63348833894320933];

% Layer 3
b3 = -0.14426632319219745426;
LW3_2 = [0.013660579431233086517 0.041882401289366162633 -0.0069897264035806618704 0.01021247138074523296 -0.0069654253899513931397 -0.010099995090632101283 -0.0078654727018765760449 0.093076736684660973942 0.42559496246491568261 0.0058942837845991349552 -0.0130553701672422931 -0.33827250630037170032 -0.003033275125265172574 -0.0034955325204722685617 0.0031027417570814708712];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
