function [Y,Xf,Af] = ESPER_silicate_13_Atl_2(X,~,~)
%ESPER_SILICATE_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6481473586836776768;-5.1577531016291375821;4.0953458180368764729;-4.2631266466190993469;4.7878051007080832946;-1.6909099269807019716;4.3408547476219432326;1.6620574328426598321;-1.2098157505479625318;-4.6257159138285643962;0.28912475512772101149;-1.5029727854408907461;2.1172041443581375297;-1.4722019536240291693;0.40723749926237595709;2.0120688973345264294;-0.94958258234464332226;-2.2262232578674789885;-0.14801615905583573318;-8.8101524841973830604];
IW1_1 = [0.68779702077567672625 1.4968898881494403508 -2.7436304676025078386 0.53241411390384529856 -0.43957111290179518015 -1.9679783768380723075 -0.72409934638314232824;0.0055833627343205988192 -0.58642269434888916191 -0.70814085613479460513 -0.72236819921725270444 6.191247964212180932 0.7883546866762154437 0.3176508234834947153;0.32471641243982296565 -0.57553671942086048752 -0.43590298242568081832 1.1730827329781672308 -5.3089638376006105247 0.49681421905023831487 -0.026965497277802962656;0.25746259433486723411 -1.8073580087757386003 0.5947212282036912212 -3.216304861349019717 1.2731353315777993451 3.4395733619607695708 -0.97729790693981788419;0.22763190233187552414 -0.075554707936106899058 0.010307361483572982999 -1.0198694738244924451 -7.8389576278908066342 -0.55772244756392674869 -1.9419387456356020927;-0.29610970089709853781 -0.13264063843174439539 -0.28632549343603413972 1.1424728646414825661 4.4152722090937013277 0.31113077507502978625 -0.32530052540285614437;-0.37009382654628436571 0.42090987728926254619 -0.030629983854122647124 0.17036477481983583471 -4.3694574276855995265 0.32099821756623925229 -0.15114641276234355716;0.63363816982163401192 0.20565096895165094204 -0.70975810788763527004 0.76568787581207065074 -2.1808923249859932803 0.49685909195236505065 -0.10664928122388364629;-0.57824980861614283523 -0.14756299505591416454 -0.04430872690638338468 -1.5664000004429263768 1.89865271463667451 -0.69894675470010036999 -0.82806408787215524114;0.096370628079787259979 0.28651911121853490538 0.40028127019867520975 0.86421653149136579142 7.1141260899147411578 -0.56751945909500156606 -0.10065359578454176337;0.45175407999942968074 0.20569626800629295382 1.3630821863677342609 -0.25139054474865762945 0.46773391341933373555 -1.1459813248625430049 1.6064136909521882224;-2.4978948630944755038 -0.43184019908621046335 -0.37130955283550226564 1.0141297469224799244 1.2751752613509204082 0.62171135630869422961 0.68360561132541519669;0.062330499475631545581 -0.11273399950583302964 0.2965320465812387174 0.85821470023091606105 -4.0633395657729876049 0.053539762111953104196 0.19959718728178396652;0.073295436629084123603 -1.502742175234883959 -0.26593461008607438556 0.68195672355584113777 0.63994153454050928254 -0.038042139403822207433 -1.0422983167853934194;-0.16677546821285407774 -0.07154994738752437633 0.14915970452726529105 1.0999240604564726187 -0.12643416293403181294 -0.50081892722073906299 -0.34554448969812778802;-0.25357996253955022992 0.20545107256062741796 -1.3583021938487747082 -1.6205210656368971289 -0.84074324791159904535 -0.28573352394777162822 -0.64397534266597122876;0.47992822627423736837 -0.7491285016667607044 1.2888469034899199261 -1.1879740781519312343 0.027369769945022267427 -1.6367723851132756074 -0.61519750716559762349;-1.5832394744983835366 0.34099335546470677105 -2.4581554415788251511 -3.5523451030360910785 -2.8415954862745969045 1.284425981852901133 -1.4194726280492138137;-0.40789698603129204146 1.4060926931517809813 -0.14903211748252842561 -1.4105685445681368506 1.1226457970485177462 2.7840463713805752022 -1.9889487055715437958;-0.31097860113487862943 -0.23703502179015797924 1.0935637941382645444 -0.44784248953516736513 10.874524383244088099 0.86570488256379374281 3.2753790924733854339];

% Layer 2
b2 = [5.142076883668319276;-17.26344861268218267;-0.62342622524493740421;-0.68887369188369385054;1.9041425401362603864;2.6682240991694312626;-2.7035230435977544161;-2.0913887475793031534;1.6269171716843706665;-3.3579543875062576319;-2.6237071671418745744;-7.6182750625637982722;-2.1091184839347296709;-4.1805654621878725052;1.7313147134470077138;-3.1090701165292067287;-2.5976504564052440571;-1.764802755654236277;-0.12221151393807701269;-0.36651333363954519129];
LW2_1 = [0.78126683642925531803 0.72781822181187372234 -2.9548997322340500027 -0.4051850758236384964 1.6152772954246281678 1.9444768992749514869 -2.3341452058230345301 -0.2526924684179228664 1.0324922078890332866 -5.8560859026503635505 2.2395680304257492566 -0.30656801917473253116 -0.060580509232263449193 -2.183735176890559071 8.4391979146697000402 -1.0464420802767562257 -1.0490267028463682308 1.1750552520224728514 1.3705791230933563885 2.7381105494597166583;-1.0785097698730488069 -1.7314010342340260262 -2.5954998231045851576 0.69669782831455406846 -2.7835466380438207423 2.4995347417607574059 9.3522877074208654591 4.3292612579841511788 1.1735443646657826022 -2.5070880227320500033 0.40955292020601491432 -0.034244275992999353986 3.014623741419852454 0.66411166270438171111 -11.759534647902286864 4.154058059577456774 1.540089066838698173 0.51866626019124106861 -1.7683278214429574149 -0.93486881745606853489;1.2605369665418744152 -4.3236831443414551757 0.80749205300219539794 0.031275770285248347125 0.80684446689894895322 3.1423356630496810382 -3.0639400514299501843 -4.8511034099583580925 -4.4004003530139916833 -1.976653363950628739 -2.6910437224146956936 0.26964083632612928509 0.16649945030505428067 -0.53905625779276677978 -4.7635005675743178344 0.58563383119104261976 -0.88562545953433069457 -1.6819725642449685488 0.039058479446982395655 0.19255966288471793035;-0.41924391012918432731 -4.9420068193321222694 -0.080822745831161529884 0.38272759305821896225 -4.1028881209294567611 5.300490617937146709 -4.0409954799227945088 0.20146508083742784012 2.4579124011861113175 -4.2590417352610101531 -0.67900132123458223354 -1.1448188376689709678 2.2938573721630239888 -0.013951114230096310631 -3.3920249225638539059 0.63751135124480085015 0.72530893591667133791 0.21583864107745520666 -0.032728846029073742352 -1.4352550984429675029;1.198859161554808539 -0.16859785834912205393 3.5137408822393010333 1.5427573243700118955 0.09954673116559180357 2.6507818432560292798 1.3424716850317237604 -1.853456628534496442 1.3377303863606946344 -0.57202943910402459515 -2.2531194774087373034 1.8669997591553584293 -3.9619573055100882897 -1.6524171019707181163 0.16200525447109087596 -1.0820253686473664256 1.1677257682479900147 0.82288433149065720595 0.42138659374487935638 -0.59529161922713125232;0.33834909302494114991 4.3116632129771863546 1.1685078136872963928 -0.073670460821883068658 2.106335990983231099 -4.0586318575047455326 3.3943626121200365375 0.013225012889585587017 0.558132113293114962 2.2433218578698763679 1.4853275434059658444 -0.51853863223786633707 -3.0324644361935009229 -0.26729311319739595953 4.9753640384658730511 -0.86703566166733314624 -0.59649640772855605508 0.59319480806155222563 0.77153178861297022628 1.6215941328700465007;-0.22013877374318430169 -5.6638208296324386026 -0.92447922732014542468 0.015182188827471793449 -2.0611330506134315499 6.4166237092169460254 -4.9925568562848567922 0.50265655877193327061 0.31239896202235734046 -3.3611027479865245304 0.05535944932178975264 -0.1618820571451818624 5.5166784437447944356 1.6309290049420386293 -7.7889827360091095088 1.6419849373668899961 0.82485943788184346026 -2.0873086628468362491 0.35175957863052631502 -1.1198801870552370641;0.60003707094388181176 -3.0191847684149375475 0.5287388538055494136 -0.56284022538797728874 1.1729091656512209418 4.3391266303989413089 -3.2675806098070463435 -3.9221723331718822969 -2.0376640822030087641 -2.6338405018646344757 -2.7836208873513252904 -1.4358857763545320729 5.51510161175758995 -1.8912815038895074427 -3.0131339886219694613 0.16492580384037977548 0.49516156653976106661 -4.3774587527448307611 0.81038401344749821931 0.18371824928377142316;1.137645602319365068 -3.540587278405944005 -1.1035262017666696011 0.87538442650330228201 -2.2390320919712491943 0.17908912267091373072 -2.6239502536748142703 -0.50721848781502720804 0.79268317169490154495 -1.2411198059842685204 -3.7570384203635085463 0.92146845717416026034 2.0593983555383870154 1.0848245212409470817 -3.0014284473696672961 -1.5333185864470786353 2.5788557175532758059 -2.2032927079192177189 -0.059454922257482230308 -0.57494410507179871672;-0.75080695204086644878 1.09832043653052569 -0.20928708102099000121 0.3803981940203596257 -1.2731323361319917264 -2.1776300712121758885 1.8052136530024993633 0.30394663776443331393 1.1571365364069499115 1.3746856077826397069 0.96911109705978548678 1.0805374875815667579 -4.7937942682261347471 0.85563046756017258065 0.61335479938554782198 -1.7311551708621097934 -1.192048096794722678 -1.3888285853595989661 -0.64182741485921435132 -1.3848406876383942965;0.31074588653434143115 3.1608076106536651118 2.4997155232782510836 0.24072190386673558704 0.81261310255161944838 -1.5579479781162861585 4.2544823765968882157 0.3655030384127725962 1.3163862557181724711 1.7742247869829264051 4.0196953483586090883 0.70155940250520354429 -4.0751775776389269623 0.010724532651619489432 0.6333192019979678733 -0.84266323161563172484 -0.43083386505117299281 2.6596307983334659397 -0.38341792357668147417 0.094480142976836559154;-1.588624639200004296 -1.6810427668936900325 -1.475167946363721283 0.024394783304098895116 -3.7919527027128152596 3.8752741409482167612 -0.18524144497895222994 7.2450529286713951649 1.5835563701615338328 -7.1322621094813438702 0.6802200231959513177 -0.82460481125276796632 -1.8635115566015287847 0.13105670527162804895 2.8771401079380445331 -1.8538939626648194281 2.6943698737895087625 0.48187778187583074629 -0.28724177907016751332 -1.4693378978716451488;0.44349167523808097346 -3.773226767697187789 -2.6424132118512471123 -0.4808376136945975432 0.034279927985053554318 6.8778016709742546553 -4.3020009752464209996 0.85182446094864439079 -0.49050170136161469481 -4.3418505383435324063 2.1460387438706436392 -2.6544832000522049498 -2.1281437246146204245 -0.14715681178704148602 -2.8907968703168624991 -1.2810078580679145066 -2.1844944417632081723 3.5649811930321004816 0.30441474189307338172 0.75087486932846547738;-0.6239199225165612539 1.496884873764315893 0.27467041864921520888 0.98296186889144498977 -4.3597745302417187929 -6.6480381694112793411 -3.2098013867361463447 3.3635346445826947992 4.7485787647665214095 0.27345846307091437044 -5.5737199880685128761 -2.4619924075960657461 -12.33565521354836747 -2.3978858112796981317 4.5000117466919622444 -4.8974773045052799603 -3.1781281986000418094 -5.891925138907331494 -1.473826951473451885 -4.9572157862113304105;-1.3996125960060974425 4.2341150988174804937 -4.0180805731666175973 1.3890588845743523372 3.7745398259928175655 -2.2995441483370218094 3.6441314218258615831 0.45633464443002330624 2.4791243987273396954 1.6201068663949385051 -0.76858692934180317113 -2.443068269667568071 -0.61400203872868741595 -1.4840494608936380949 11.154617302620103203 0.52933173993473658925 -0.63375805550637709374 -0.14599644645687653854 -0.71347859347734887692 0.69045754501751155363;1.2773551257225088662 8.7220343848414554344 3.5565185866345867538 -0.62504344904461128785 3.0215923346411517336 -4.1946103918516310927 6.8499287137319164742 -2.9611849279871536034 1.7731801766637953488 2.263702349670906333 1.8844518091430944029 -0.94539701383496976828 0.58701238684656986688 -3.0245079600101867356 6.6504825928548028102 0.9953383149583642231 -2.0577764843574306575 -1.3598411188493360058 0.98390649090443105251 1.7911931708978749977;2.7523877319073442038 5.5570006865263890106 -3.2968408488042166837 -1.1948814694058556007 0.8417054193412626395 -1.1527674908173608515 5.7766734580725112025 -4.6647942978561971472 -2.3990523594024062426 -2.8104297522758203698 2.2167457636230341045 -1.2103141010579456793 0.71895437572207798738 0.38163632117661910881 5.1681517359577480164 0.16102666194356266005 0.24838836386747897844 -1.4500028931016029077 1.7400586427435682513 -1.1383378118039269022;0.50023124909284566453 -0.84541915328202066338 1.9785283344089961144 -0.52582805234655838333 1.5127865674324019185 1.6735405494486430555 -1.9889155197934766939 -1.7521754279826864398 -3.5175448758518563785 -1.3162541926216391186 -1.2213048345567443231 -0.87516949124399168181 -4.6178406400783149621 -1.4820458865778871616 2.0020936290816524483 0.00063300617366530346868 1.4425340853807493424 -0.17313547483885699529 0.59827830337359788615 1.3555682355930327443;0.64116276345913902901 2.8057192405284880898 3.4607551622261651936 0.33984893958995487928 2.5141096613717679453 -3.2142057524496414622 -2.9322619466003736477 -0.096543982851401102807 3.7842508305495416998 1.7164720880057826591 8.3979015853576672868 -0.13941295727563385309 1.2040662165134499162 -0.43088577098221386708 1.8622777969874790838 0.35101503020395585786 -4.1649629775864625003 3.4182893657781230345 0.020332571287356507317 -0.9442390544720611345;-1.4993066662511269627 1.554054710786601623 0.19840316995100673592 -1.6917185895126047868 1.4419639582028680458 2.6364143214879915966 -0.43624167101919947287 -0.23222888113717779501 -1.6168213768007742015 -1.4490015862299590044 -0.045211298561064157397 -2.0733659477066717081 1.3409351838970262616 -2.0282709755019929787 1.1290947664317541044 2.4711175297901508685 -3.3366114396286068455 -0.57299608746328734021 0.7995819098957963611 0.28384433420193189157];

% Layer 3
b3 = 0.4615163811043282438;
LW3_2 = [0.49033921959738380192 0.097563917053054449724 0.11934623856316066426 0.042496122483229738231 0.22816169010873030287 -1.4253306716063001147 0.11211892162579098486 -0.14642070974345772205 -0.19293550173634552158 -0.20090338851131051001 -0.18545464901809080582 0.34990144613412038632 -0.088393972081414376452 0.031846576619087317572 -0.040239977535966885147 0.057666655888388554385 -0.18204256070015512048 -0.12225661993701467112 -0.04730117719594189446 -0.12180038471556442481];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
