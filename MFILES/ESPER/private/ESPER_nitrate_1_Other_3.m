function [Y,Xf,Af] = ESPER_nitrate_1_Other_3(X,~,~)
%ESPER_NITRATE_1_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:32.
% 
% [Y] = ESPER_nitrate_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.0470101536327085512;-2.4269596391144889758;3.1813661677890383572;1.68546875457614731;0.6069903766742926754;0.19468928292308254613;0.34356007635087687513;1.6260924473057596362;1.3149300881259733398;0.54622789050403863786;-1.3516617645858763908;1.6431698924500000025;-0.63310320410792664259;0.27265589750518343104;-0.53463346136871769954;0.64773137879072728573;-0.63133801641341558142;0.58814069450987793708;-1.7451263134100856167;-1.3762085383474562672;2.4952687432773204002;0.70130538709345213721;-3.3536973516011485685;3.2030880762606308565;-2.5798933761973450451];
IW1_1 = [-1.4476296244343644926 1.8415875424140533134 -0.55314422303813404191 1.5210724974342326732 1.7775429311224624218 0.29376045960126007106 -0.34261180121461187742 2.90531875189230826 1.4737430372735369488;0.3477651350451840262 0.49466733838171522697 1.4521999274662189539 0.16020606884108654078 -0.061691423999255548538 -0.033715407261959290386 1.9578793263699736382 -0.16139852916198407784 -0.49648362032273712918;0.01089684516474037114 0.28966800070967241298 0.31804213168271355805 -0.23976125014354007781 -3.4274264398690790223 3.0471082837930549836 -0.027576135466440193644 -1.1880416625697309829 1.2183509653378092885;0.27472456237315040495 0.63497054703962807487 0.22897467903501791953 -0.78832820102128253748 2.0426209621955937479 -1.8178383698038957927 -0.25173561544604761142 -1.3579090374519322548 2.3242157419649038808;-0.24490196110028539245 0.35092266021679413557 1.8099428964485171356 -0.6042942591355583426 2.7434345283626750955 0.52860079835158702011 -0.64505186909252321126 -0.620969477811511128 -0.12816365105835170191;-0.20369861418415657894 -0.023982455908158940155 0.32768806556580981626 -0.25768938079641251493 1.5564063873715099362 0.95578200147642788931 -0.60756960406568816246 0.61779316791125160613 -1.4458297673081141888;-0.34404062212915370589 0.0079421562903443775755 0.3195391014694392573 0.10731804527674777827 -2.0418864189525800512 0.41214642486371011465 -0.23128901344681435104 0.81664555317218134878 0.19663424224369324689;-0.0031541431583291968527 -0.33421388490960740603 -1.6073716087958069831 -0.16555842941983525685 -0.048868209830320905041 0.57609595717761541422 1.0446835028506582521 0.21873617883546650487 0.46592004134489345413;0.13826537411535169686 0.071387846703983737218 -0.34802397489845543488 0.10347255866028977345 -1.8778769144142577474 -0.13103447802187012661 0.21258820103184417061 -1.2152887769463565082 0.53105148669054691446;-0.57434031915370808985 -0.043755902539892706227 0.41907687304512375448 -0.07534353952032150914 -0.71245117707669003426 -0.130666519151541205 -0.73558969654958472617 0.38612676762579495326 0.94647109110229821205;0.0035557210900943082843 -0.12968069438648868741 -0.1462362863549525327 -0.23943224286195560757 -1.6786639345714438054 0.71100872752583332836 0.91052229668550799246 0.83836809396599809574 -1.7789809210197478073;2.9340380406662407431 -2.2720082019010838792 -0.11764587847100269058 -0.42620396601058557762 -2.4330329997171511458 1.8471193519998192478 -1.7172741242200717515 -0.12704602394579719848 -0.27684346287879102455;0.11411296012253478727 -0.72004955105685741756 -1.2212544073209414819 0.69780156232784451564 -1.9185184559876407029 0.61697002305268811018 1.2774176655370776956 0.061995989409061834363 -0.34491543744309105524;-0.083063558819118879506 -0.012227714494176263049 1.8206255254208978389 -0.65717016508508396821 0.36164064813995266956 2.1500079371321105803 0.27401311241000025909 -1.0254352424209560724 0.58613343672526918571;-0.22971649146069941794 -0.37909833254903757549 -2.0945803417599235807 0.6295889859188860127 -1.9833018492926106635 1.3401957801528676661 4.5751535370955940252 -3.788808500470734586 0.14877975377912455723;0.69803101565809344553 0.33878987676142569008 -4.0983653177579348892 -0.25704903349706137439 0.27282341993629416477 -0.95551694284378430044 -1.1048150379213481642 0.47220964571141232913 -1.3298079757493190822;-0.69113920170722875636 -0.046506912297498169406 0.13330850118805487314 -0.090231966847011485511 0.41044749196014862491 -1.2597489807773669668 -0.82594009214073704772 0.01673881002523818981 -0.19285227756833633883;-0.011583209416956990329 -0.34504169789649058453 -0.097018542980548808097 0.76492962427705990525 3.147110408432638895 0.39838216792466801808 0.78317079111153975468 0.63957497565245280402 -0.21953062558760449985;-0.048831797116001988968 0.13192108096888691127 0.8158119461159002439 -0.71760866740345641279 1.8706577520796541236 0.38728902199959253094 0.02591655258837549311 1.2825935231524103752 -0.31165393303199623309;-0.54180899669173465671 -0.24156381143843369541 0.67337237753696810305 -0.29452868902730672263 -1.6727858247606319786 0.90388598889472837605 -0.34343608886985449447 0.52197406013263436542 -0.9096597908369493668;-0.038256150694901347453 0.27414253835112945001 -3.2688106086207304735 0.074833422903729268638 0.53875863107372534699 -0.74276699441656190981 -2.4158536300915316453 0.47468945790762662185 0.10269916817321152192;0.053297751226583332806 -0.22083172554110155894 0.04663681634255971431 0.096115914034109073416 2.2211364353128995042 -0.077713039083137674945 1.0676948293773695919 -0.49574818097224010449 -0.072390443617411467936;-0.21517683289156816495 0.1254339888699513017 0.80087221642846551095 -1.0703270644152840241 -1.2343049404650081602 -0.97411493383139113877 -1.1196519980513768289 0.28256603063976321044 -0.91783514465562854312;0.063221516330550467377 0.054555737864029944795 0.82702792800148838825 1.1273899626128542906 0.76687499340411957593 -0.61270867802070594355 0.65060216924673197614 0.60336578612832203472 0.36875466348550201001;-0.13439375380433121743 0.40441761309936208324 1.7844324414336474316 -1.0811565703743595268 -1.5921200856777821819 -1.6263813639946993472 0.050949801687250717563 -0.94628917228840170317 -0.45055255822622514161];

% Layer 2
b2 = [2.1670256849578310998;-0.88196962825321190138;-1.769252693284074196;-5.2118887464263536913;2.176180637079522473;-0.17621235829022316444;0.58810337571691195802;-0.69935242653340790042;-2.2232980821854071429;-3.1129906719917634916;12.513377786711522788;-0.63533052969074110816;12.84312742595964707;-1.415783936903322271;13.036325516226025201];
LW2_1 = [0.090460015529737064499 -0.66271833878968022802 0.10325305380493776664 -0.14605827823214515004 -0.075504290410344440665 0.40129758849395330556 1.9833231348150950346 -0.52440629748014955247 0.95961221934932339206 -1.1345812870755311863 -0.55616565304253251512 0.19352966677568758658 -0.078877707158103965712 -0.29618850204237501256 -0.19671075101040597088 -0.65970458383214958253 0.49234074696292173812 0.55441359717549354436 0.36510606578474846806 -1.2188965358127361593 0.94967141339746219408 -0.020706234480093729106 0.2455139773560547356 -2.0676308355210064605 0.68494499847605383458;-0.82386464320834773556 0.4783877028958916644 -0.18289461592384154143 0.23295902920249658696 -0.8514013309682807451 -0.29724626928706260331 -1.4038771919735475446 0.049147461944617679142 -2.3774842570973908629 0.66689727261721298834 0.59431992740732708658 -0.17845155047424307582 -0.33749003152365925073 -0.22515336037688332693 0.21565100487811814101 0.53627202067639911931 -0.47827096439048599752 -0.21836615907205095266 -1.4680539866960329309 1.2276461568922092393 -0.93653618021809958982 -0.69230946814261984379 -1.1294591194100724874 1.6688976102780939126 -0.24122841666271113703;0.097787866840027479198 -0.54472252022846723296 -1.1039112139787849998 0.16646954133333838333 0.34661543538125355601 -0.34285930361235600339 0.28851099551627534812 -0.42122339888259224816 1.8509983398295963841 -0.40551147655946329085 0.22973480270137899839 -0.056805775638760665214 -0.023026445551441655779 -0.18590582443167133486 0.12781723207240053286 -0.018381701908938632983 0.35478872611438089235 -0.13951295395742263628 0.75083210824106649817 0.084751872223320812161 -0.025888675592768823491 0.63456322778706575338 0.18607056664205259833 0.98005456538809587741 -0.2390729015519425793;2.1681437743314515565 1.2678706507349193355 1.1400373762560152002 -1.6314724647231770849 0.60113814982536728504 0.46185432682773686075 -0.34894004258821992304 -0.53285253868041060343 -5.7866686748102980076 3.3165523379302266349 0.90614125506854104053 -0.14638891735717293741 0.50938815240948331908 0.62060177664455029589 -0.16386082823338407599 0.67247688779143688365 -0.12737893421110382808 -2.5940521821428261795 -2.508702585871389612 -3.140183234783492594 0.67171977826881823503 3.2940475195242289175 0.45417510090959983815 0.11172742718584158239 -0.49636561728763484158;1.1644736662815875494 0.28640805584340112144 0.8945743177907123922 1.085879601843454223 1.4197964788895911514 -3.0322750030126064402 2.0934070745729784768 -2.8100658741330630797 -5.6912141551976125342 -2.9122366781845383521 2.2852781532511561302 -0.025320975492736989138 1.4470302201577351919 -0.70058203299830301702 -0.54517896560566059261 0.39311479338773996917 1.7478028449709153147 0.26687580929767090732 -3.2595138055660437537 -0.25088485802790699841 1.6238214296963608962 -1.0413358238884105056 -6.2096300696240787076 -2.527100868470696593 3.1196575431307120851;-0.14390587011159930442 -0.13011178906728934623 -0.99096185912251633088 0.51566239630627952462 -0.14518858152506036729 -0.63108525222020916967 1.4871068283820034761 0.66201047364508680548 0.070644006581731463856 -2.1729861189409329647 -0.37092948238156053797 0.0083803093101964057365 -0.10228258326193710726 0.023897749045407257196 -0.23394327526740235634 -0.28620439753923859749 0.54518617914646594347 0.36119652678573022087 -0.088783780439707332688 0.41802696884781032072 -0.10037160782569665152 0.28789152301973353065 0.1777086304812730555 1.2987852549424441229 0.32346469773201519393;0.74667868006586457508 -0.56957458352816980884 0.093976193098890173361 -0.17951068785958063101 0.79710680385708365669 0.33048154380596278523 1.56738989660306971 -0.054411740780488826452 2.4624697643154180859 -0.73067953144900998907 -0.64112040252875213131 0.18361694974953582382 0.31316922277337050362 0.00258521706432872974 -0.19530136707962841847 -0.53982638401419935636 0.42048941718923177335 0.23278009758701406762 1.4520774212537437275 -1.1129104791834945054 0.89693125781295091059 0.64874167993924813924 0.7325702389529809011 -1.8092261452585223225 0.34932143474471083477;0.11342799991635056645 -0.63234585185333724855 -1.080982771265227127 0.018413506793646908233 0.28850912932650796261 -0.20328030020433648928 0.58733898592169286879 -0.45860610557934089471 1.555103288898153302 -0.38976531251997104111 0.082814651633759006621 -0.075312858736939547466 -0.071452296736481415995 -0.27876875388245375698 0.16674231828683155898 -0.0036005738232004974933 0.18347834736449653015 -0.33855831713950457207 0.85226823431516385288 -0.068925721299283079779 -0.052162003097415754471 0.8287708232863136848 0.3052187883230465526 0.12485268187987240418 -0.25462961826407748411;0.3475802754960545804 0.99405400441561719838 -0.49047309402669952982 0.098825300248574693418 -0.84660129860112398603 -0.037348185122893270971 -3.5843896523610609961 -2.2249987213649973228 0.16723829197718056983 3.0972319309387628117 1.4351548567667722356 -0.088798636772514094595 -0.40650092642690227596 -1.7500180754036482877 0.16885967401550985856 -0.033407203723889958291 -0.50196560711927340481 -0.63604900093859495502 -0.2446137602926443666 0.98875709818386248173 -0.5786407413705525471 -2.0544684787836362538 -1.5083102753640518223 3.3994351780494462822 0.10968571310824072607;0.38412522184893843624 -1.8316753096466638073 1.1764076347705312298 0.2469000576147830639 0.5470558250714024906 -0.21232126606206599972 0.81367137543532974675 2.0173241587777375194 3.5948012407975271643 -0.92047760276301815452 0.46903048366218480503 0.069951391723681075052 -0.73773536595587874132 2.1418811292640862476 -0.46605097418905999662 -0.061067678738331236665 0.98244617173338288918 1.7639177176667555358 1.3489993861725533275 -0.97352556082127628123 0.32901349702464899316 1.7982706698061814432 1.0189533898236056153 -1.8565728075746961157 -0.61298967402623294465;-0.64193607275956177105 -5.2971598660121568258 -8.9989905891943902105 3.6865858455129525417 -2.6658577863510961592 -6.3515093464385241617 2.0062767639669663033 3.0251390573041723187 -16.078079375819601893 -1.9920966332238352337 -0.7231262600263144158 -1.1479506939930941289 -12.505852753657174858 1.3880214088963900299 1.8733761677336178142 7.1280719032603840901 -10.985768335369362703 -7.1308319198604799283 -21.933878864399737552 12.695973716906001627 -7.7813492530683801007 10.192419205391702874 -9.2419382675182326636 -4.4062688800822673585 11.254453287938973816;0.52055385170709778109 -1.5184928726075774819 -1.3864225524369635512 -0.441784258297259258 -0.10507416177858672213 1.367727774167305288 1.1704711492554520369 -0.37729736186046325397 1.0193076497623179133 -1.0305741758488562443 -1.7683802937564867541 -0.29911435822788040584 -0.61618296089927138137 -1.0833137321450316826 0.51138482645788441161 0.022201415405299608496 -0.67006202624236033127 -0.59853165700756327805 1.3656772222757636026 -0.043945680739114173496 -0.1674606792223064522 -0.22381564513426902008 0.33723074366622701747 0.28283159942266433706 0.66294521622677238248;1.3157846508779882377 -0.4807226690877539621 -3.1336691907815295011 0.18261998742488527725 1.6043740414890581558 -0.69946719308091198641 0.21904789986372918964 -0.44633733688609911194 4.7746538540420946362 -1.1629837899901984688 0.91817514393234966885 0.073051389268775468455 0.080395297487876687947 0.36512710340339299409 9.5404587336833213129 -0.25386501490549945315 0.87743949174942303948 -0.15810500704102722902 1.766792216613634503 -0.44394733513039746908 0.38655138853571380242 3.0715523238890853897 1.7390460602059787387 -3.3252067024619940128 -0.95920993667895781964;0.47030939022650941617 0.84333528823576153766 1.159176866622766866 0.85122745685974832153 0.90709362924250191984 -1.2601736185838816606 -2.4881016091104317667 -1.4553411666865843088 5.1343303897084187071 -1.4762017917915584153 2.460930639859126412 0.12552501092863638243 -0.89443270143899300528 0.19335504478697018715 -0.20657137389142093964 -0.50005287308112422728 2.1192088583058747986 1.0399393458954260261 2.3693608585820724599 2.066277616099176484 0.68164517203030650094 0.10937789239853026868 -0.95995171671465473473 -2.2274015087586604977 -0.87920419994005460929;4.0876731737150544532 -1.9087614694284940065 5.4090503737103112769 1.4947911502414457097 -4.5854324951971676683 -8.2086675674607540998 15.91916139332773561 -1.4857743030662635686 -2.3654529392321563819 -2.9818580070147664429 3.9847944870740157342 -0.97263957703408987499 0.69543219889617635676 -1.35858630289955995 3.625533095848283871 1.59152280438908722 1.5771225153700509924 -0.41373496561021477769 -1.1972502143540735275 -6.721546799775447667 -5.8055553044087666592 8.3075595744106909279 -9.185358213003301131 1.015738402600381729 5.5139723344570636954];

% Layer 3
b3 = 1.4400865174902173216;
LW3_2 = [-2.7982271957833511067 9.6475742723151629576 -2.0009855638916351772 0.51768901702861813696 0.14822332601909019023 0.54101078881963060585 10.876480240331716232 2.0942910195115489458 0.35543210852227513641 0.42430802292953534449 0.45772927664972734574 -0.22235239508697121624 -0.47415888176390108555 -0.18917155127025095385 -0.044816016264075518583];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
