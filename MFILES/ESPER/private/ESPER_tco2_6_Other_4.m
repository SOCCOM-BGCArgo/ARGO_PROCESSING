function [Y,Xf,Af] = ESPER_tco2_6_Other_4(X,~,~)
%ESPER_TCO2_6_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_6_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3158596129567701;1.3403079347422544;2.4824530978632051;1.6301833119773415;2.3033337865231052;-0.6770690331288497;0.9062198201567786;-2.10339075223887;2.1338176736136316;-0.65982975699929169;1.1538618625398813;0.23160812951260493;3.3863827621987901;-0.79272155162935398;-0.48894166288900254;2.1900809378918797;-4.7514998751660524;0.52137172237855389;-0.40450539893260379;0.88074588348518146;-0.18886140418262565;1.2554297439549837;-3.850725490368041;-0.61916501100484123;0.52483446106008236;0.67798618661124721;-1.4678993488544188;-5.2085447317742855;-2.0189077844026837;5.4529458994048836];
IW1_1 = [-0.69150823344882439 -0.056335774127999678 -1.0628402809127382 -0.31219707235638217 -1.781161649689788 0.11196201759075852 0.28895491846593307;-0.19143952713395879 -0.36056512336654789 0.68896866227119702 -0.1450850448214803 -0.30197485138168223 -0.78598872365121675 0.57289502852840746;-0.49557920114499904 -1.0378554891924272 -0.84679287172902784 1.5614935781752495 1.3854220853062962 -1.3447437277662655 -0.39682733531211833;-0.042407765668678057 -0.088870913047525785 1.8882460758444521 0.66708646337158739 0.85012691973487908 0.52044255601109879 1.1456055961417571;-0.82362639224251943 0.052284290019492627 -2.0821442824424765 0.31479374829593187 -1.3241865161752995 0.47255913375191877 -0.19550839147453614;-0.031331333204813808 0.25869245102054361 -0.51636375659714129 0.18712284456084161 -0.69926536146712825 -0.38966088933135556 -0.86051520445376062;-0.066883507266981265 -0.10643269631479922 0.50933495089240421 0.03831180710568436 0.51337964634654198 0.52950886642793416 0.57288601952225104;-0.90939430681624189 0.31004593096471583 0.98899841353849605 -0.43864928219900839 2.0390782580845861 1.0831761364589423 0.2439744799929375;-0.43901103718800705 0.36226188010083094 1.1420900643856697 -0.18351265010074944 1.8779910093055634 1.81956899308895 1.6650218870722309;0.064872694281994936 0.011047070053224813 0.013669017419816035 -0.64207334773404623 -1.1242319920452297 0.93925634317824935 -0.0027092542201543036;-0.65601813936932685 -0.072652764887860488 -1.5041194553921426 0.94374014320511457 2.2590880540119147 0.31555695791287292 -0.38792332147200359;-0.12376342010305445 0.20583033909380288 2.3560646867485602 -0.015591959652761014 0.025257125726898328 -0.39435540600003277 -0.68412935316600532;-1.5603861470448019 0.11166584255298871 -0.39068933229503322 -0.6479564010028811 -0.60111549876482639 2.8878780698761677 -0.41354072693761135;0.85895851072997764 -1.0269090200867252 0.90927592813560909 0.1918645851937936 1.2192594815790043 -1.4934469612924852 0.82781927979543157;0.52631088249659919 -0.11371180951084024 0.047930316975586668 0.65616892916973057 1.7706183599850593 0.14596207392261051 -0.52267515585957325;0.083073444594330983 0.067980657780187026 -0.23106298232830508 -0.97764074914349497 -2.0815843741309745 2.4416075333911378 -0.35926437860793425;-1.1508032182760994 0.33649801909083105 3.4904717411397446 -0.81310282447818905 -0.25599667934995796 2.4252084339921565 -0.98128704679513956;0.22181648291605818 -0.23100540599480482 -0.30985269897437628 0.58974757278253087 -0.19243552377653256 1.5937410360101161 -0.52934659333046086;-0.42316863880847078 0.66403342515092045 -0.49646827476475425 0.016126458644908286 -0.50988983419154243 0.021560206755069301 -0.14892344608863553;0.2169817435823673 0.37836275599086344 0.98711184070128888 -0.35496716831219555 -2.7225908999971238 -0.015598099466590978 -0.37535509711379372;-0.26322740447094672 -0.19517200720293992 -0.6143690893697229 -0.51043400624774438 0.46233655805761431 -1.5133094917103225 -1.8462112387656113;-0.060440882546723175 -0.42023262121548782 -1.3144934888453872 -0.36377136460849069 -0.59837606661712472 0.6856483391471746 -0.56496928403867364;-0.20804711025246675 -0.406153038601131 0.45215495371373482 -4.358399898172296 -0.19914302665801753 2.9674567760113519 0.73098056858325788;-0.040887313604997255 -0.13186632412138313 -0.74934791191915273 -1.0002899553806783 1.7595570858386562 1.5205574239878534 1.0577203247908846;0.097875800364648033 -0.72753915553671933 -1.1177998348590141 -0.87725582769507893 -1.512764057726999 1.4036090151682385 0.042496961625807336;0.092367018137138573 0.4523236172041265 0.85113073679582418 0.34129297970348166 0.5347687005553019 -0.57836232634707696 0.066115113056471414;-0.059422658396427797 0.39121529537391481 -0.7324922850150285 0.37137740351073373 1.1616732397832947 -1.2664806753285058 0.11489036661626188;-1.103491900942255 0.51193208575223026 3.520068975471863 0.32391092079216571 -2.3343653225686394 -0.487194216393463 0.25384602829549557;-0.17882536568613902 0.67876991444391066 -0.13252781957434531 -1.1874444339286923 -1.1762235819168569 1.519901449498765 0.49584921963624301;-0.087985994802674244 -1.2523039510988856 -0.048249821441438745 2.6875563802967504 -0.35384617311692268 -2.0976095263054408 -0.78107087085810023];

% Layer 2
b2 = [1.816048764646303;2.6402928328748501;3.4817235973801206;-1.533458266574798;-1.9778292103211088;-0.28116869850642973;1.2119418626695184;1.7487700634291166;0.85226149078007485;1.9865113731929602];
LW2_1 = [-3.9074510845176889 0.25540558879624592 1.0778265735250609 0.65549612534581736 3.2426811506317144 2.2977613258639047 -1.4255222792418198 0.12552448071627259 -0.92094853368981777 0.15525250697651871 -1.1401116392573767 -1.8832393704601058 0.56263587460074593 -0.56816723038367478 -1.4426175790686098 -0.70707482663310672 0.010488074423879643 0.57815836307385404 -0.9043594527118195 -0.4030503057042093 0.54218628997424279 -1.8491921309464121 0.07048842062277999 0.8979110018912615 0.064741456210217541 1.8434964784775887 -1.4080274829206023 -2.7504303165289263 0.4790459098569218 -2.0354745268488914;0.54326147293906712 0.60683872607283884 0.93498486564696415 0.16299833430496835 -1.2230317389489549 -4.3987880525038001 -6.7939303515018823 0.0045055168839414185 0.33336157691129714 2.1873439314136509 0.85013100354384019 -0.035153046095217619 -1.1284088351105437 -0.21494615359653207 -0.24247527867166474 -0.2480737957337589 -0.51807531094505455 0.83569145127792344 0.13193019677822618 -1.5063506179626085 -0.42886344040483892 0.39008132739556495 -0.21407094107511454 -0.65638454720514416 -0.27876083304843069 2.5961037148878581 -0.76472239948981735 -0.29774018837247423 1.5914368374748318 0.98396863297790804;-2.0870076200435457 0.99661476334081722 1.8318776494125244 -1.1421059483269465 0.19819022019883795 3.4210493772941772 0.59615215178515202 0.81866487972251079 0.56522536735912454 -1.4066188195159668 -0.7669706823217074 -1.4934217995182486 0.48338291152497292 -1.3738136231804305 -0.74762968495669724 -1.1307417203738175 0.30147975033963742 0.57387434323507136 -3.6653776498653525 0.85145741777133732 0.30001571438877644 -0.18517311616600821 -0.88597249723375804 0.63179636150594098 1.2565563774008153 3.7863670704310919 0.50534608742550657 -0.87871018315578642 3.1438757506657611 -3.4473266200633099;3.0245016129736877 -0.72068062408193012 -0.89474880024501868 -0.31449379598176108 -2.6932087332914629 -2.2010931639338178 1.0523462674017492 -0.15990743608412658 0.58965304838883226 -0.034164172931023251 1.104344356046846 1.7854138854899819 -0.51749021782292881 0.58322144780811525 0.89530597141637946 0.69410214214576116 -0.11733813750150558 -0.51187184589082779 0.92757750996493504 0.15901953882613507 -0.50768454023630405 1.6629024149332268 0.023220982600809632 -0.79810708349561632 -0.1369412769528264 -1.7219979193887567 1.28781487183633 2.6527892721503457 -0.4004405949102795 2.4788023261125072;2.2811221717324206 0.36175190113128519 1.7943000689007571 1.9641079765842697 -0.93929300039315311 1.2225280976774902 -4.2371441765176696 -0.060026734805445361 -0.090832714069959075 0.012336443229804404 -0.23582341896261449 0.8001834586237766 0.73420369008912212 0.22794172215886821 -0.20085733843547771 0.0088399141336172639 -0.92788031493294709 0.7831677920245268 -1.0074765162214447 -0.77386543129443008 -0.17297328714749902 -0.61784969760796027 0.11221881315423736 0.86877813082956901 0.92989817648775819 1.9057598792513271 0.73307548720883409 -2.1883254411776756 3.3056069688660239 1.3940299436814825;-1.6540332611089532 0.33809663514461974 -1.473342724540319 -1.6338986524324486 0.68587936846490605 1.4647729105780845 6.1900480128290702 1.9343951604427287 -0.79257502425269355 4.1838465234461468 1.0957222113225593 -2.0438121550463126 1.7431594006150937 0.71693664547984481 1.0300525833869152 0.55160049741090078 -1.0424208526252696 -1.2693809496468895 0.018003087376782842 0.24310869460686682 -0.046596372525693312 -1.8001513235148499 -0.96847467949812993 -2.3557341606506013 1.9482872663833788 1.9693864946842554 0.11903873938242632 0.27322990886111365 -3.6834402721479904 -0.66050170910190897;0.68041228498478545 0.8967566836495483 0.89442284914812542 0.61477049676903428 -0.53027639686613603 -0.01803834842470757 -2.5483813195716696 -0.90524377175637027 0.8107577387345074 -0.90925612717244475 -0.15894593897997938 0.74284756350392411 -0.053370260871538636 0.12459954429352108 -0.0077654689678388041 -0.51316770303177228 0.79242500171536068 0.37051465109017051 -0.14959632178922758 -0.24018126841681781 -0.18900837375837007 0.10246811035791782 0.40736263433644238 0.93168222501191478 -0.81207203676142037 -0.38491227889248286 -0.47372433563879579 0.41927910404458152 1.3026244001747744 -0.5673596783884175;-1.2636460445039368 1.0322652505462071 0.25080327735730817 0.79870574573452113 -0.96388632189272971 -0.10881992320709655 -4.0058163889607004 -0.7067556339425749 0.33062106920070794 2.6810164998185479 0.44064093695574125 0.026869193853936171 0.21117980455548735 0.0033375955679301149 -0.61640393423603768 0.58744297983166327 0.65165438628956196 0.056120832577608387 -1.0478007521110595 -1.530969020718544 0.2489037722211391 -1.8555257154922338 0.081174215183368426 0.3197633050636251 -0.84283375752531708 0.98672344963599401 -0.46711404609389662 -2.0059819864901183 0.3679910735161589 0.051048631582954654;-0.84682828147211331 -3.4420289129210087 -0.094864350266645442 0.49697467184119343 -0.41554135471256903 2.2096368797016885 2.4549634953390003 -0.23509666585696523 -2.6464129763039859 1.2072759298838238 0.46273704408768057 0.044346335708415174 0.21089806567866537 0.24128002609911708 -2.0264680510852475 1.1277634179931879 -0.39524549851389157 -0.38116598905403976 -1.1387975449201664 -0.53773391962532224 -0.94244307319869158 -0.11860475129534408 -0.59006534669500432 0.53654758154697701 0.40486873429124426 1.4561582403211035 0.74497680027289803 -1.2198822917261982 -1.4861697547550379 1.2972931976577837;0.3836447499993475 -2.0506681278272851 -0.39330339845348056 -1.2799609353743688 1.8820151572552222 -2.7594697555711494 -1.137720356877082 -0.32640934765211893 0.52602713300509474 -3.1446168450926164 -0.4340826673581441 -0.042647503905605642 -0.86449153980808036 0.11558204523861282 -0.74473408515229911 -0.37187328216257981 0.68891586033442354 0.97233851533990634 2.2132376958943052 1.2343366161992737 -1.1690007008204704 2.5694309762923839 0.16494496678424497 -0.55651236690667483 -0.72930530539909322 -1.6959130161980482 -2.4038001191511968 3.4880768766850729 -2.2890199691173501 -2.7957055920704699];

% Layer 3
b3 = -1.2443420699419816;
LW3_2 = [-2.1958829089763721 1.2103264294112048 -0.30737600313643848 -2.6295442249985896 -0.30789970327883237 0.33006933319466203 1.0335623482580794 -0.63280641118832781 0.48741512749762123 -0.35980028514900708];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
