function [Y,Xf,Af] = ESPER_oxygen_2_Other_4(X,~,~)
%ESPER_OXYGEN_2_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.6919521720437549206;-2.7054087909591095773;32.370260154283457155;4.1311399767427579022;5.2203995215769456451;0.72380968954695934503;1.9704274112085320425;1.5295440259729062848;-0.048329618771976709524;-0.32134435580185832793;0.99547970203617175411;-5.8378249090359544127;2.2371980595619462839;-0.76884784389459814857;-1.6765715101488796179;-5.8004732962328553469;-1.3047282853451804829;-2.2122315840665813802;4.3837131507771438521;0.78262844888218563444;-1.6608088339821045487;0.41716997238941710968;-0.0002414353481235316512;1.632435341447623367;-5.4748757717469969108;3.202870050461861684;-0.59892149683664253068;2.052000653167173283;3.1743683073899080505;-2.666537234719616567];
IW1_1 = [0.66808053776424392023 -0.93504421543048155119 0.15307325848685698899 -1.1470005666695346491 -1.0238889740862471278 -0.91627645288779047128 -1.8731812520125534771 0.64299693395884238711;0.16531011978694556963 0.18941154542890120682 1.5157740781063566704 0.17174861354058035268 -4.0934211299688323393 -0.81513297634436854278 1.8866418415375671991 0.96069915943488848331;0.36939096084456451985 0.26268367859377816931 -0.17094828825483823764 33.10145340414000259 1.0576034446678403977 -0.89142613345392918145 0.74132201731960845059 -1.5930042016545680195;-0.0085431099863912812742 -0.24280197110702217422 0.40009598644181387783 -0.13832569776549588636 5.8873943078257626738 3.2308035207680934064 2.102058401889014938 1.4397873108296559419;-0.6899804179927532255 -1.3544667125651248529 -1.4593535053005119995 0.086654145705640062136 -5.651033377942496827 3.4152537312236028733 0.080329716409483845063 -1.0797674010847397863;-0.44543568507178665783 -0.16427231630793678874 0.20368109686476212894 -0.26086596779073689678 -4.560682409919253999 -0.080042933697166335216 -1.5118201748904354087 1.2015357364344703139;0.05672827374374282694 -0.55992508417093478368 -0.21578495833337796306 0.034256886848719254879 -0.87865370108848661612 2.156050061108087057 -0.31970221483264193996 -0.60847977980666889675;-0.25388907149250566908 0.11574643588743867284 -0.61878532120171370057 0.56649128873589837951 -0.61049894848159447225 -0.92749325923597847332 -1.8235278270590580263 0.72049000074996416565;-1.2673457093868598644 1.192790498713275138 2.521170478278530247 0.62262998328508623036 0.36215797606258870456 -2.3295397306929728209 -1.4110429990040935788 0.56776183593987439302;0.44863317393509000164 -0.84299322719453695374 0.74361263348363604297 -0.35053858922001812637 -2.972732869935376776 0.37217406301684591297 -0.97878762193948964931 0.14129575697064591933;-0.59462663192155862379 -1.4072787900147920581 -2.9797571545484244915 2.1666964556890411231 0.82595151616178819065 -1.3742672124968517977 0.018676626446538134585 2.1133106353840047653;3.7286518290967811673 0.51189588186854151353 0.71153913423152514994 -6.1422907355529252627 1.5562470493888751477 -2.7071826938277494534 -4.8898494256971138938 1.4969641741417383241;0.038307466077542484673 0.35262196806815676586 -1.7662867596878106813 0.58619517276193167099 -0.59081942886746185994 2.2744604918368507285 0.22609700000573190737 0.25562024134464783609;-0.73813403336782057451 0.039751684421743635478 0.32138416610343040203 -0.33320435168308076834 -2.7678542286964860075 -0.17809635596234599242 0.19014797436476346681 0.035167052125984317457;-0.030287623380232765041 0.85107313514496507612 0.13920855259496847656 0.029526183280528622149 1.8235069487791994991 -1.7587359652494789497 0.11296835428380926081 0.5917770844130346708;-0.31284268925779040726 -0.021347021668916207893 -0.2594070452153362516 0.07286991998707156859 16.879634866915743885 -7.3424010456257935431 -0.016351230510885550462 0.63005129528837100494;0.19236172386359270958 0.011931625443212197368 -1.1898471279826472458 0.38583510031184803379 5.9302705252523155721 -0.54137879457500714953 1.5451081463653058012 -1.0233707524884245732;-0.31204668345857011769 -3.2870987158358300206 -2.7626137844172080626 -0.75378921591474612462 -0.20593772805765955813 2.3480275366445422236 -0.045985725222985718297 2.3449185755195154357;0.25925054084345633409 -0.16561000223525323971 0.25355805374696233079 1.4608723548565270001 2.2723817581787670861 0.73696324491678566471 1.5738326209839306191 1.8845976445117593734;-0.5509163773097854877 -0.18749966657011765681 -0.30420076696073006239 -0.17110270082027120853 -5.7126775231669641997 0.068739527923829313316 -1.6550264962774972055 1.3432361308924709586;-0.38667667637980918105 0.29917582294380773433 0.89119758505711343943 -0.21796442011446984233 0.014896976442343879549 -0.23677774591030922857 -0.97434248346842178279 -0.6639585538379622065;-0.088605695157371169857 -0.088634444555859087655 0.71953879016669675117 -0.19422476584250505938 -0.7031710002680370275 0.66971590319991780582 -0.1445739999949574861 0.69304863016569551171;0.21693057141686486466 1.2441800073859465847 0.7041736242563401138 0.029875194075141643657 -0.58205321992673308973 -0.15169947995502977567 -0.42536975712883079437 0.71844563778758474548;0.29982657886122310309 -0.21435936820335094177 0.34222103809638015903 0.079184592326492497794 1.9389934087638021065 1.3015294644609558539 0.20310416719181267897 0.50663972366296750049;-4.1273542208791642594 -0.16210127833682105858 1.4223425744649227376 0.058270028799426429322 2.5994666871771165972 -2.8358608367637101466 -3.6392422529170644907 -0.14564085627998785144;1.2987243623637849677 -0.40969804058021547233 -1.2900996292364930174 -0.023939167044216034391 1.0107813089852217825 1.5986396389971222476 0.53528091948845568648 -1.7299871003454105889;-0.64097626792942064 0.23219363522888930573 0.4700745500600792548 -0.41084840449364379289 -1.734687520971799346 0.36194168003770615938 0.16230705333697686976 -0.14688722805298487506;-0.11579088859864763994 0.085589735789577417457 -1.0628222772986655187 -0.20875436901312449667 4.4564513549456332697 -0.68031847214594987072 -2.1186960935224692371 -0.44806052013048514038;1.1604215656001815038 -1.0064420814263754789 -1.4012473977458157481 0.38529416768400853721 -2.6236429707950290613 1.1116523030864760013 1.2876892747646973003 1.0880836678956058439;0.60739514699867647174 0.48361075140483317236 -0.89474947353721645538 -0.16940529303340104428 4.4403839174190995465 -0.25869296993703572163 -0.69867507964263797504 -0.14207375717845985297];

% Layer 2
b2 = [-2.1924284420541897411;-9.2276614634684968053;-0.96095651850706897967;-0.097219307559213208325;-1.7137309774278666197;2.3323283124583462644;-1.7045528858107079628;2.680890412894599617;4.849805201937880561;-1.5319380746430588669];
LW2_1 = [-0.56245667111094721502 -1.2264730814057482888 0.18815695557553493988 -0.71182416885003896301 -1.6756640683069341513 -2.6725847221753942229 0.57937977053048295151 0.84077143925663111457 0.12299878695729576927 -0.33712343711436582039 0.08434583179118476659 0.092535959389102862005 -1.0741951923869756946 0.97186963714020768723 0.28407335323645571679 -0.49362018852187578011 -0.8227126376011956177 0.12955081077058880346 -0.23753596048347502823 1.4736753831080628974 -0.34101226755352082032 -0.32139436921676917125 0.28801803601142678124 1.9893607324944602155 -0.16208705132362308254 -0.23347735867083180272 -0.25703219451071990242 -0.8195661019542865855 0.13428091568793681931 -0.98211605544451330285;3.5862688529621267186 2.2628999636813329488 1.4512059294743988591 -0.068854562137592445481 5.2799121935446162723 3.189291095106784546 4.1003086638208747772 1.6992866765384240235 0.27485909385098444835 -0.17765796373918277262 -0.06796542059466983976 0.20245940108592427875 -1.0784036356173154481 1.5329491424861823035 3.4715546480078458558 0.31323166202169649974 1.3813576740378601393 -0.2535711464246352409 0.33666029609730080407 -2.9730532733666730216 -2.3860215782378930705 -1.7634874875420771811 0.82953416658912604298 4.2626283296246967325 0.29613155086193287957 3.2870809290556191051 1.8796656974789740513 1.3669303752116952477 0.16337921202031124857 -1.9156132421233731389;0.6881850327369213316 -0.50006436235986106986 0.06758558706834350005 -0.39378972601250372687 1.1815680480203951674 -3.2775154166183706472 3.3745953533004717784 1.5713482659786444096 0.12683439216125902416 0.32717329412012802203 0.16669677148545972156 -0.0018755236521583304107 -0.29304731597658145725 0.6801654965304371192 2.4822472292735815458 0.3307153445503654976 -0.84400358510664763578 -0.47822606295064457038 0.58790254137143038715 2.0383496111071246482 0.0643997136756248173 0.53899330016442537072 0.18005178157876175482 -0.062618251662968610338 0.010409907250879162424 -0.18372147496938656674 -1.1053467055465253654 -1.5183913897242713453 -0.063335191800688250829 -0.7131055957091714248;0.84299233714307086895 0.38163306649453060393 0.48119809067773755551 -0.0026277816167429536229 -1.1877375218842021187 4.2121802671524264383 0.25454042702506873841 3.2530088419869001015 -0.17914812076327094048 0.81111691884390857421 -0.20579029305310739262 -0.31436221009703724238 0.098551441940996381552 -1.6208503495553503448 -1.8144751113321333502 1.1485403485502467813 1.1576799320651620651 -0.736270340203451501 -0.69051790221144471182 -2.6741440836600123276 -2.4558739282620685174 -1.6708919936876218681 1.028024746666977185 -1.0646038734130320869 0.26535694935784903681 0.5444927519324442855 1.8418181912250597421 -2.3631479590324739881 -0.55854339297448041268 0.21911216741115763229;-5.5344170623539072906 -3.4644207606619250583 0.35586438949141968591 0.40449176581523083041 -1.5168134018541461483 1.5136349963051249912 1.39072011289029418 1.7785252637328199388 0.12486542245349438462 -1.2950539427442413487 0.27611039506071655136 0.34147012626040157413 -1.5925389129171798608 -2.3452909106929071825 3.2207365541751897808 0.19228157331496767424 -0.56826332653112421323 1.3594026069253710709 -1.3158985688599065256 -2.0215748548071537094 -0.30241803345819784354 1.1788842805292325533 -1.5994343735544094276 -0.35675062042505084614 -0.049201850798293200739 -0.32822236999775611377 2.7290076629728816648 -2.8927672765938976518 0.18609733950579543382 0.72546822308810354762;-1.2116572349457563895 -4.9801924757861000259 1.6648545628831377119 1.6605953833605424652 -9.4786114948203668007 -5.3013598352303512584 -4.2500862546278481702 2.9343604535657550336 -0.97410520309845738396 0.97100289502301562194 -0.78654075194128469928 0.13581395929600492689 1.2631095316449707511 -0.031648980467363238556 -3.3155500117511724767 1.5078830981491195828 -0.74774168479658320585 0.73679647830804495534 2.5466455777756191736 2.5039456388907486151 0.43977973142463111511 -0.81304746700332686249 -0.17317413581940085954 -1.1077213528115923413 0.057755714580530616298 -2.0025588780636569552 2.9343849506162760221 -6.9395461594023766239 -0.51111435740337840539 -7.69255259401135838;1.838836042602598031 -1.4117078989768403474 0.22624598202413620518 -0.99710238692742281241 -1.9454402543417441684 -7.8419112133239252671 0.32906403207363266183 1.4477313761912080636 -0.9213066288401059456 0.48200564810763618651 -0.93040784523350217317 0.17508041865742537957 0.31397264877496555702 5.0933225111378561678 1.5091583864752367017 2.8921092202315796804 -2.6111764585983845421 1.0422711155477997202 2.1222263528198426208 4.2396342043042993808 4.3885935411535728079 -0.91981487183455545864 1.0164866573497044477 4.8239390358732379127 -0.19735967643301299823 0.12871172487299462062 -2.5385193233385994205 -1.9577635119830210098 0.63318339832011194535 -6.8665007778157693963;2.6216225072303473986 0.47232069217925620741 -0.37554178439614843699 -0.42366416520820809888 -2.4196687698715231285 -0.37838873360882058217 -4.9669706666532276174 -0.061200074252784272821 -0.080065003362137010523 0.20543211373210759629 -0.16498451076745712651 0.081079320487834227738 -1.7081224483816925819 2.2511305026758541281 -4.6254471857300529791 0.019308313176441604941 -0.16359154656672791894 -0.12396959040117605522 0.56331905971870488425 -0.04794920322722714956 2.3575286499615155655 -4.8301595937190135999 0.99476492924385728767 1.9192212280606077979 -0.20103203656303830771 0.24456616600130082206 -0.99511816587833845649 1.7676238697601525107 1.1489185808680115741 -1.3651160612890593793;-3.3282734251290380101 5.6353446844799757187 -0.56197816304318748415 -1.6112835987724840603 4.3399082196420213364 -9.7732195035346745016 -0.81553123896240198309 -1.6954473727625443136 2.4259124547593531318 -3.3270149131432655842 1.7771176475170522568 -0.96847312941776264594 1.3261547567139375658 4.3602859877614168482 -1.0493719865998678564 3.3899737497929987029 -3.7926566844501885534 -2.3188473305900374477 -2.3720108870548535229 7.3891576161651038035 1.6301071877107511376 10.259799609316944569 0.18117499203996306756 0.74243648112111704229 -0.80735562206526800821 -3.9022361644160623584 -12.824572453947610029 4.2638275799838130098 2.4846911420211106325 0.58213637882786717359;-7.00942206226427178 -0.31249243542443722044 -1.8547095854554533911 0.026052345281164339397 -5.0306434802845085841 0.26704604234985157563 -6.6994419817219679203 -5.1639640287556520803 0.021851972918917793309 -0.40891394582389883894 -0.05977439142481873191 0.16861945014555898559 0.93054599296765738714 1.4879267832628286783 -5.6226485387111102554 -2.8158441141149759268 -0.79531209682488090973 1.1171495000819946508 -0.45154904803412110326 1.7811413948951593245 8.4525426616558370085 -4.3912274413588718858 0.64039092452618284756 4.4479369615688639783 -0.61820835462435330676 -1.3868772425420019534 -0.510055962657441464 4.8847678042033466639 4.5097293632848050038 -0.022933885586855190519];

% Layer 3
b3 = -0.45471211339206363267;
LW3_2 = [-0.6974938793696360273 -0.15296226659029318884 0.35876436885860357728 0.17220040155012755756 0.17239140193816143709 -0.065520588259442277823 0.11693205203370386769 0.28428339142340597334 -0.16051616616014313665 0.074739203331108047812];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
