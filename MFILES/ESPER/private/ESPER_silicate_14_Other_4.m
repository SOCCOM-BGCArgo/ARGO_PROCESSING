function [Y,Xf,Af] = ESPER_silicate_14_Other_4(X,~,~)
%ESPER_SILICATE_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.757002352984820881;0.77245718354268877448;9.5957092746659622406;-1.530658296644737959;0.017474452209698128347;0.2227171609917131534;7.4325541609053287218;0.41097668213598403941;-4.9103416167383784341;0.32005527695177976577;-0.62459466741440938797;1.6058949222454530492;0.44532181299079265369;-0.33923361100168675231;-8.2833704361108164704;0.010236771032584399133;1.0535268251170784026;3.3490140653137383531;1.1351235563761632452;-0.28546479325560497609;1.0119396375933520371;-0.57861128180004550714;0.46371016818212051902;-9.4160536795070104432;1.861399337847530866;-0.052850901621008847253;-0.90364886789610388007;1.5116294623645383233;7.7669214809274116362;2.6669337609306849046];
IW1_1 = [-0.21859912791113250696 0.31205075234399387574 0.30601014210070520694 -2.3840106200765025513 1.3568267012587837961 -0.15953718688113530111;-0.82568560707587645986 -0.25139059105188282794 -1.3020190565961586859 1.7843465920501009325 0.30968695283650954364 -0.4186843658431657067;-1.3881448700729377421 9.6476558730007813125 15.458022635500384467 -1.9914030976629044645 5.6486560401332974735 0.48823316896746338234;0.18599021057291670322 0.20185729026914803197 1.7361121555330223387 0.33992853288352226082 -2.31305681100830407 -0.88205514361871917295;-0.55138014897768461431 0.066933327887832419489 -1.4464040576668091287 -0.45856390835796845273 -5.1254421048399096961 -0.027217433086011124516;-0.13108530895809336614 -0.036225299317310839797 -0.24141157794946788151 1.0564378735094810402 -2.5690096421294592588 -0.347098278017655415;0.66765665544333674397 -3.9579062570946201838 -3.3186377864541136695 1.6073748972227319687 3.4638699382256614712 1.1375047571129928148;-0.45816975237232876461 0.0091684525071088849441 -1.0394181429908984082 1.1123253195213542721 0.28324363203526259358 -0.016996864582783204056;2.6085646880028376948 -2.2854642939944116442 -0.34223458255722144505 -0.010433516933144537653 -0.91556204080462255668 0.13880963291966691431;0.43723379960547431589 0.84351626639555632448 -2.0419892724402783912 0.98723396887139880373 3.6813640989364415645 -0.83833856985470800449;0.031574256227037904299 -0.019835688357695984568 0.1420786355654094224 -0.77619878284892329656 -4.6766378568614177524 -0.38703547296683910028;-1.4083935564204188573 0.4419297618461054955 1.2620116824392650923 0.36221227148029200293 3.7008655844417410741 -0.09105595214749639954;-0.13139572056286466517 0.097746548941672561917 0.84806654919608992493 0.040867580552950914796 -4.9141043836531546063 -0.48117416923083572433;0.3292767245966709555 -0.42735614645456665439 -1.4947670180076599866 0.30090123670743451623 4.8319740614248294364 0.43474021290098308068;1.0563942016364504806 -0.21103925405931450721 -9.4391611191455329077 -1.3533412807994202876 0.34613761168817225311 -0.18734417945507447767;2.0018160758606677874 0.62575543898589092162 1.6358675104024142932 -0.03230331108094876974 0.64685573010771724167 -1.2505966066612559384;0.09581809425217951981 -0.1903944652128634063 -1.0642781361215636338 -0.30250945257729683346 0.20759295857306331312 0.20163758145367793873;2.8374530686405399216 -0.46324052177334412717 0.23708100862740111303 0.81360556262558769713 2.4089236794191442037 -0.52658072658327526039;0.73867991414264588812 -0.77749339778215575958 -1.0405702710718944815 0.24154422268262040752 -3.7519854016002445185 -0.15165713364013361231;0.91444183328114303499 0.25989244884039630623 2.6019124383517073795 -0.743803383764136683 -0.030427738188245279788 -0.54373577030928588183;2.1310405386944943906 0.86737226184121352102 0.54028534010219275707 1.2078639484399944504 -2.2177766608714577501 -1.6651808433040706792;-0.48864698439509224315 0.82334049887151072866 -0.50362397286322968526 -0.34587867892241508372 -1.1715321960693070302 0.16775787516926563003;0.46926232205204398973 -0.277689976238920333 -0.54817233716892266315 -0.21128314948851889543 2.0820205735617158815 2.0066817676383656988;0.65196031131171794382 -0.14403975611938008017 7.1345636117442374768 5.0311691598721450802 -5.7104452903533191588 6.9951748927838890424;0.050321367451865051112 -0.059603890400170396469 -0.035160186292318387768 1.1333636793780612617 1.4770076552244955082 0.6585240826526918001;0.36559048494943446883 0.69393505686190626314 -1.5900994368069334417 0.21257187897011370348 -0.1530059892533769117 0.10444537684095300811;-0.35149801667997765398 0.26077473013410007452 0.91607586282415298662 0.60866928563748756709 0.014170083824731338762 0.1667610924609679024;-0.14585911767176129583 0.20353783991272894616 1.3042590805026446077 0.27969805450650908618 1.6275998102792275102 1.7465835888482927896;-1.0251072750994796312 -0.25720368884886418703 12.951834562527407613 -1.2267757317055296706 -1.2806629208062474401 0.7360438273479719129;0.048167358949744311369 -0.026368837605716389377 -0.74336614377846432777 1.3690284256994253997 1.8092865882862785298 0.96943852691689424983];

% Layer 2
b2 = [7.6116496979125827238;10.346239737774268974;3.4808462022936859093;2.1199997362917972765;0.36301226029880517832;-5.6871866040782874663;-3.9718677958880324042;-6.8212627736994697614;-15.267206035431721389;9.3663641617049453458];
LW2_1 = [-2.2258944105496274446 1.7325120158415661109 0.28886113065021701285 0.30077725489971490758 -7.9706675865998102282 9.545899018288267257 -0.23702381694219717967 -18.592926129254664147 6.3120874689756689691 2.3409446118898853406 7.5657881379326354931 2.6953732420318297081 -3.7656512547565288429 4.4971819809969151294 -0.30616893015643142917 2.0089345014339454742 19.021568553089316822 0.8509002474591665921 2.0148837920744497865 -6.2313108261255596432 -2.6251443306764059571 7.5434520510492282241 -2.8119422570249188453 2.3849161579837119262 16.928308657818146088 -3.8216729291270334912 5.6681257674210927533 -3.4314836214910591217 1.3745353755091156422 -15.333032050570695404;-2.4869769970931150382 0.81784647351782580049 0.059002145502180441961 -8.3982060446263648856 -4.6817413320867595772 2.9949022568262044786 -1.2315885383842453127 -0.4566479647388310692 1.434591045413085908 1.2350396749684033892 9.3889208637614327557 0.26030944016472989944 -12.916490410960467017 -5.0217331575063779425 -0.99100016741781060681 0.28123716367420426021 3.3050946821968172351 0.52887984149937661282 -0.20665341281097965309 -1.0220998689278575355 -0.090610847812692643655 1.4526201591696914495 -0.064123967996990771656 -2.5426132012414703887 6.5723744307712275159 -1.2304235808183736633 9.3322940723723366574 -1.7828756108462229246 0.94669516450899460214 -12.125027335772134762;0.19610237627214441303 -2.362258940957139508 -0.013259794089761554187 2.2553366709712907578 -4.6332813864673632054 5.6987182676101051371 0.59869540323619552247 5.4033522010336083596 0.48299768820347732667 -0.25729219092968796945 13.622571126007349207 -0.62936362033612425204 -18.488498772464748043 -8.1216993603889608977 -1.9991558480926785446 0.23974596916095339272 14.731945571220583346 0.86588256058813473093 -3.5154420118315097277 0.25196082470351244265 -0.13194200201730182931 -0.51428006136896020628 -0.92542971004749796649 0.1622688834657108059 14.947841861685814635 -1.23805115138996924 3.4873602314063405494 -3.0206155655099586888 0.7389569454940216886 -11.502479166840863911;0.67116680155623398285 5.9228380847004551413 0.33956873067390996868 -7.9511244957864883887 -0.5468234671669257585 10.377783973953455643 -1.4092412663085152058 -20.032586359611673998 -6.168962521917029207 1.76810620094630222 7.3521069869369881644 2.0847606853899565138 -9.5338416475604912392 -1.2464474968129612975 -0.98210445309573657369 1.9844608912532595291 0.61530985105254565326 -1.6039543191032064051 -5.3420353010991954434 -6.0750961209319100931 -0.093361376113485036732 -2.9809112177582059999 -0.3077026466631910262 6.6785748067087755686 9.5263090431354839893 1.9974750411650756821 -1.9429533672622814056 -1.073569853746938918 -1.5463711532072041965 -8.4432548558162316965;-1.8586105263225136675 1.81329397552563365 0.44349865438874136458 -4.8239461679986375131 -1.181499052503848457 2.8736142627893026535 0.25600700569258089123 -7.1625018356363439054 -0.22787164115538033338 -1.6363407645090113363 2.1293466029832255337 1.475791807310469439 0.31905195934597135876 2.8612306018492685844 1.7858608343753243908 1.4568239869084611549 0.95593325173258780758 0.10716094196530717708 -0.63814276424100935259 -2.0675870519430494809 -0.79390804378208224001 0.38537956765385861235 -0.48229585783352779682 -0.31230999469819048509 1.080717961029090235 2.0026619853849632058 5.7201004183145505166 1.4338887282637351461 0.46594504720752755178 -2.991527158971579059;-2.8461866395381600903 0.12953297864101609438 -0.40222656121573541199 7.9594093751943493231 3.9069840316064663455 -6.2584907510167697708 -0.92341321784647145687 -0.94378542333908710393 -19.032580082805846899 -2.2152156505839672995 -6.7123840666132377208 3.2890003790485820012 7.4214631223327094389 2.1038829105417153897 0.12881725198263152543 -2.1312710264926320036 9.3792144932327925488 -2.5097512646197022157 -2.7035905510185900269 1.7343872246358336131 2.0662137883315816467 -7.2060041967917491945 0.99356831277802304392 13.817551224119826614 -20.38434953161664609 5.9884971542471312489 6.4000978968759190124 3.200309027040930232 -1.6867955152456572954 15.416190541936661162;7.9480517709481537381 8.514665089554126709 0.87310241697681956197 -25.824318466628909619 -6.614083167536968233 8.3875845601504916971 6.4504253245695029051 3.6151414330403173203 2.721523814674470465 -10.651416620657952805 -8.2352823012408506997 -2.5991817645861368113 12.893296287555518376 7.6512973438403513171 1.3249237036260148592 -4.9595618127900245042 3.3584935615600359782 4.3308149460402702857 -15.888600197271466996 -8.9245162839872858029 -3.4720207874780091295 -3.8041268114656472399 7.8238188436309599183 2.3057439619668484987 15.07951402703267263 -15.132882370561340224 -0.063764953768365051356 1.9754770431221704285 1.0558999545112575102 2.1532156019578825301;0.35406592594979169331 0.13019839229037324935 -0.11180373483965334869 -12.900633075578822329 1.1840879549189855524 -0.91415729820189961519 -3.4303922930386083756 -0.8263313410202217657 0.98248289702623181618 0.062635648751080769125 -4.1206368356349898363 -0.78901200575240659774 2.3220348131439139117 0.27679337331354125773 -0.066481983541500699886 -0.40804684330785551127 -21.771085383521835865 -0.20987057402447004129 1.5517983509119976926 -0.2177590049953048168 -0.26673139921315003331 0.2449170554309025305 1.461012199735641115 0.61639602981312968666 -4.275791820954473188 0.89301950639029059609 -7.4604931387877293503 -0.11809718460115703476 -0.017424895434930427751 11.540098184229382383;-3.1341761040122917414 4.3177722013041393012 3.1574056482306640525 6.1757467554666751752 8.9550139492370313121 -0.839267157553930776 3.0978072758475256876 -6.1394448690191714135 -2.8890369345145585633 -2.6841530322424822508 4.7062131629505703501 -3.2386147468252506343 -1.0544366919195458099 -4.9821175642600605826 -7.7461899469356740866 4.0103928180833170458 13.648679722694891936 -1.7590835866136376175 -9.0062962366056957819 -5.8835504249932188969 4.8253842428927224972 4.4460928775043697669 15.347252608925250783 7.9611371144614020423 -8.5933056404522094596 4.6656479209445622658 9.0423577303011573036 14.649308552704862763 2.1536992386338664751 -1.8836211720673385894;1.1530076023356286008 0.83241495236803619839 -0.2806784400306371885 -4.400174541629161773 -1.6796210834707352433 -1.368457734158850192 2.8033514495942464251 -3.6522248071832281724 7.2274654618510618675 1.3069857823617752057 -1.9166312583671980541 -1.264049674933022116 5.0752389784540250517 4.4893425757575053936 -0.53541141041483986118 -0.61044275231563083217 9.0959334011682084764 -0.57015674692850160099 3.618643820183552684 16.922285504781108045 0.66114042038832265824 4.7301901917189290714 2.731773710308629699 -4.6126052635161478577 3.6399043953750211955 -4.8125111022156232821 6.5712738108326034236 -4.7273346412831971364 0.54206656641670036834 0.15305254913596635924];

% Layer 3
b3 = 0.30092682815649490768;
LW3_2 = [-0.060121455099386281185 0.26058137433180539322 -0.20514133288563643487 -0.077303304707808523366 0.17858322696374528959 0.11050938018978022359 -0.0035174339642204954792 0.71128693762370298614 -0.0093081061987620120762 -0.20429915351001259882];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
