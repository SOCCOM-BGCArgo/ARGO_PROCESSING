function [Y,Xf,Af] = ESPER_phosphate_7_Atl_4(X,~,~)
%ESPER_PHOSPHATE_7_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.0183564160586824343;-3.5292815027355461943;2.4759064420704355314;-4.4046026065051675502;-2.3334295791342536397;3.1913442761897434785;-2.7198217201563767986;-1.4423300939828564982;-0.716548502197129622;-2.66645585275865038;-0.027309780201955548284;-4.8499316600523272314;0.56170774584634619586;-3.0255818320353853323;2.2553582254490041059;0.42328989446335590907;-0.24353654950319436612;1.0175180990057675068;1.45826430113846639;-2.2567377282164278185;0.42112023440233914418;3.639692508170248253;-0.56185641323831636562;2.0024799131021322474;-2.7135734322235185445;1.2630718333437729317;1.2217962107193134358;2.3314434022552852355;-2.4874362716932401085;-3.1040451507784942997];
IW1_1 = [-1.0526022337493499137 -1.9030349167527718102 1.5452576772733130905 1.7604494748348857858 0.76371259285262627081 -2.807828883473621584 1.2464314046476854259;2.0542221679944230317 -1.8090219935993148148 -0.46927970974168065066 1.1670309906458864457 1.5922008495065240741 -0.078339642320869373737 -1.0054085087704653922;-1.804728873543950618 -1.3678876031843285599 0.6230361989849825255 0.82241410856325580792 1.6369962177790424729 1.2633065292233520704 -0.15048653447465584754;3.2247126785072053323 -0.49683675623110479247 2.5432270733341155733 0.27465204484753408254 -2.2901702973717528167 -2.7576512501123593424 -1.6963143681122916373;-0.12479732833614469445 0.16455360203649835316 -1.5861127019508762803 -1.3711449803152475635 -0.058342501059540613495 -0.13251977452716201533 -1.8672479517931412918;-0.51788521096479323003 0.3072626897945260338 3.159563678349716298 -0.35933976772792430854 -1.0556989551155717688 1.4550930592997206592 -0.61245430378692355955;1.0685186614222306201 -1.4989249899683005918 -2.0210059105018793879 -0.561770141678731183 -0.15185709344813308475 1.6745703212339198007 2.0639419899346491682;0.82508536721889036425 -0.92658810020845272515 -1.4328580828534098757 -1.0565281329986826453 -1.5876700228128606263 1.182593798442139299 1.3238381710470985553;0.85388438092794827217 -0.1256043514030014685 0.20778265299312678738 -0.30800701693739590548 -0.17442130687364118535 0.41252867838399087663 -2.0748088364277008644;0.70274041621460880958 0.61707032227220470766 -0.23525563012529729368 0.35099063455879803142 1.9154836554137943949 1.8301931108677866877 -0.36714726102210365477;-1.0215359809186168594 0.91191015730956082042 2.7679396072524142802 1.1366582760401640062 -1.1441046905435352521 0.88283990932952705055 -1.9743053084466195557;-0.075550715768479506651 -0.21223097819168848521 0.48190652563303160161 0.52799407982449664267 5.6414051413304147076 -0.79511391326631830623 0.47180262208902090659;-0.91894862860268411442 0.65350960107370481555 0.27508784199580227359 -0.51691446318550959838 0.06187871708749999311 -0.54486564834642181587 1.2545545532585717918;-0.48866832454256059481 0.40154601013396723497 -0.30652090731315789762 -0.20719361607735975461 3.7486128252630188662 -0.85675558317326727664 0.52488606226361333995;-3.1189980820998535194 -1.4384457535659005423 -0.8243030186092895617 -0.566457578213345192 -0.031750547204130792622 -0.26713286809026581814 -0.030008838514964997213;-1.139922886704186622 -0.73180591783369619563 -0.31061118691115485735 0.31757580326198320275 0.40858845380344033238 0.93362245647533814719 -0.3341635672173836058;-1.2432934077189430333 0.16648672921955998127 -2.0574312960000105122 -0.86687338823433957025 0.60910898352652187437 -0.18218034446168254736 -1.7163769722900759085;-0.0021424268640808439949 -0.17380312300375158618 -0.25258282194859354997 -0.48237355824550581795 0.36027394641098792194 0.98012099379599826321 2.232087282300272868;3.0734710085888159448 -0.92588926630370604887 0.87835228543976484605 -0.50829102339609677497 2.5194724979980644974 0.77859234505813490479 -1.4395082774837910655;-0.17769625052633858386 0.25671086018323657774 0.17093071046294711079 0.63347355639477187506 0.94757783268581707858 -1.6016758688109440367 1.117843030731806353;0.63486354798771849062 0.50541958971911760123 -0.0053229432752873893572 0.37541301987391467732 -1.68016194686692244 -0.73396511050004042964 1.3319278594705303842;1.5830993395378809563 -1.0119445349005817825 -1.9355389264008764361 0.11256876647538004155 -2.6633354606241930185 -0.82293176184296212838 0.55279218198599144873;1.2099058736428065508 -2.2929146260301989102 0.46046958980057328681 -1.1661892178393657993 0.49935346009756620411 -1.2721175279012753023 -1.8619006058709348661;0.053671419795761197979 -0.76378035738387539677 -0.46217665155489162654 0.46717824329702367647 -1.1726862304990457453 -1.7203108822157224811 0.26202331120110117224;-0.38590645884421975742 1.2279592073771403715 0.16383609772228832635 -0.33105942811952498994 0.094130741017293434458 -0.64830883577500053594 2.1680897476879277264;0.21090020764404082687 -0.113355749437179118 0.69103891889880031396 1.0000515759601218413 -0.54452543121677998705 1.0371628656518425693 0.43406532403049929991;-0.52454711700841805122 -1.5921322495940473107 -1.0061803141358010016 -0.72545815293354243281 0.20719622042731256073 1.4541878118067956827 0.14026030777033526853;0.41473910264305757778 0.63806052925202960679 3.014245888936691653 0.5608598131664123132 1.1778921557507175955 0.35395475059764514025 0.8056770027997061101;-0.69391100290825080688 -0.86176084631020777316 1.1545765586482139575 -0.39662909600235979335 -0.19505189634054409531 0.0052324117368371635128 -0.082432800478827228385;-0.21718535497459132144 -0.47743340675768553005 1.5495106099966708957 -0.76648021852559933276 -0.016194745520770409408 -1.1217387289455371668 0.079990449034970934061];

% Layer 2
b2 = [-1.1162896928752232828;4.4523290145702762999;-1.7462025313048488151;-1.0944487960078643773;0.64700801396985208047;0.027635810422653551283;-1.0056925570962118588;0.3805218039304846811;-0.75234320098566265234;-1.1095095498833460468];
LW2_1 = [0.79292260100941969192 0.05107790509583540195 -0.011157311008650590278 0.55179014287432093244 0.06441952839252011731 -0.030769265933141685954 -0.47747442529510297771 0.1306988359501397301 -1.0589900135011174331 -0.48935588579641386975 -0.016542466506380876928 -0.53545993540679059919 0.28652362739850628648 -1.5394373566151098309 0.12828545418640965869 -0.19673994320869200858 0.094081386394063520884 -0.47253319855201825206 -0.3834911358474526466 0.45979077223381664696 -0.54856690625157400465 0.061852465762239641767 1.2331817334446952827 -0.20320750437333387484 1.9344600491278578502 -0.51986604147026349576 -0.13867376929711033862 0.17596420461821521419 1.4321879988694825592 -0.80735325261984358658;-0.1725343462339014311 0.13146352633886512762 -0.5224617194372929152 -0.69442143337767170408 0.075981073107761629148 0.24686362544857781698 -0.10827286846077041615 0.03611317952594984837 0.17136544280982102251 0.2148428106503843249 0.4005082803981258599 1.2128188194906799335 0.54541709863618315079 -0.25522646943766508221 0.45676273292558572381 -0.22160051526498131258 -0.38939248198983550386 0.12272789629378035026 0.21095216521726928294 -0.22857475206859928507 0.16597140445695046651 -0.34130747448582227088 0.18630108038156314998 -0.024163465303631365133 -1.0790716481866364784 -1.1938942539827073208 -1.8280440644791557947 -0.11792635292541610303 0.08522773113353183938 2.5447434289505861393;-0.23500133783546783839 -0.42157801194667837708 0.52958190489457823702 0.44509491111777588213 -0.30057899908116092469 0.20406166041380896514 -0.88286755845884345995 0.58489740615017904446 -0.57696291144919331639 0.83546288531574253167 -0.63879988763131645424 0.14214346397328572746 -0.28682121857104431184 -0.48931373813700801412 0.39750570469238621918 0.89007452949517584795 0.042878915119974020387 0.062755646343602256021 0.41630317719959020195 0.063841850784618306425 1.1517024313684871561 -0.32034230523125228896 1.4233278090660836934 1.0949715804148147935 0.80780907849619987271 -0.59915258692738404545 -0.67810870849001525507 -0.2062680011334633301 1.1393781905355386819 -1.1440857089120386458;0.51754832229296809931 0.48201980300024266368 -0.23332229927825259841 0.45126405127355045943 0.43935435044110587866 -0.30617044921536873403 0.55240215419232863159 -0.77431860530096208173 -0.79410973593272893289 1.2460417739324758379 -0.18731694862745290608 -2.1410984902724217172 1.0104285257661320685 -1.2942057040134031798 0.22615023649026416708 -0.45993780801466571662 0.43601872925659163061 -0.62382554140510615426 -0.63560719878025573326 1.3619309882984502735 -0.86096095161415964192 0.58662034613557223484 1.0647434259572696735 0.92280349069886702384 1.2218476510777582789 0.94952018896131162862 0.056441463898441818214 0.22506385616585300458 0.091063387459185671235 0.27744958202811109693;0.19431177684361394808 -0.1709394070787114972 0.65691705643752373867 0.16262595195861750952 -0.19746008650054217015 0.59551165137698147678 1.2428898589924017859 -1.1532079274601705343 -0.59900686260330660016 -1.58356352516021337 1.1351923104560885935 -2.1034921161896158459 -1.7684283670114491205 -0.59261669000680583519 -0.70304961600986015657 1.2762722841026452603 -0.49061489209771280695 -0.89137997262614176996 -0.80251036884909665581 0.68621014786758938175 0.49166667721126167123 0.40631853482394636456 -0.21821223993233371252 -1.7052917369589772889 1.0916084531142555836 -0.53167589134380199845 0.5432535163466820638 0.49836763879877388206 0.73422673179138708832 -0.022242321286199177865;-0.84357602879542359364 -0.12836803954787703863 0.025307546588572708141 0.016246727218727281816 0.08007558526779204322 -0.030598899843331892751 0.51232579123052057746 -1.2244687766014865637 -0.63624435057062667109 0.72887502035717488535 -0.74624000184294647653 1.2249590464517632338 -0.38163198225408995201 0.37922314774709264817 0.40692451850224103937 -0.715435427687076686 -0.25117003273151378151 0.1918535768099325356 1.8148538907298619183 0.31478179984554133242 -0.68203288468858103144 -1.9408086283437695485 0.17496778566124460141 0.86729796291503402639 -0.18620664615299536981 -0.5772351973152407556 -1.1657546556145035321 0.17231594782072093275 1.6909290323197667671 -1.2780755002636343676;-0.50699873255826000129 -0.88635354142119759935 0.08066327001536173491 0.23177183187435299039 0.83252469384527383323 0.2002588674704373628 0.42710570288585936183 -0.66219498342996274687 0.0093926141214604082219 -0.50964618167059927423 0.64266281307916373056 -1.4713808536932302395 2.2179972001701991902e-05 -0.52770387311449595824 0.055458896641534284611 0.44360178792572246831 -0.06790053475091319124 -0.22108555938230148308 -1.8625157371807463669 -0.080651588528864739946 0.36192954088736578599 1.6827051642416925858 0.32428310216475486616 -0.67880967142818349203 0.030112487021171085999 0.34111374899620255929 0.36552731341922078956 0.10170892245246720975 -0.75392529343703684752 0.95351900515155407767;0.55472193896530708201 0.29768126042134473996 0.20988604270254709872 -0.18662130072891983112 -0.16724903185059986077 -0.70821261184713146797 0.23026431675259914633 -0.22615477777501791223 1.3390157087426366456 0.48433715748597550022 0.26164508273646769343 -0.56087162231864839956 2.1990816333052971565 -0.89004311438501026998 -0.038144405329340033695 1.6549508163233954683 -0.44926519017255656108 -1.4319567769476302388 0.037204319128684465445 -0.15309965512889261996 0.88995303471000852813 -0.14203868740026351358 0.90720186372698730093 0.45713654976400536212 0.45775178705944341573 -0.71413347367540824795 -0.48113702161129057178 -0.15599197079770438235 -1.9862329927998609858 -0.11656180003345352481;-0.49356976769950844375 -0.87063181445685156046 -0.248082532955028634 0.39232926459608885583 1.4335568970061665084 -0.18585436497454790872 0.62713966053456282612 -0.56321755109716598042 -0.080904621145491101286 -0.81406136646913951349 -0.92970476441441396442 -2.0425375074183862445 -0.62357288201807048456 0.15899030273681508119 -0.16912051470363476113 0.019796407375016492058 -0.15755950071788452083 -0.31973563392949799766 -0.021842566028537971357 1.7696982001540391138 -0.18401404798202453117 0.29217323945748230329 -0.67654664608129477799 -0.59405917218963100179 0.067752277393642465486 1.3146795365496084518 0.34090754437633091767 0.60933450741130434913 1.6688163827745190471 -2.3561903610342125326;-0.34223092584702241581 -0.81326757263295157419 -0.47155876615745750957 -0.035985056864740530558 -1.3329376086080979569 0.49429828828930444384 -0.12717308460636705947 0.89023649487487743759 0.092376063693188334436 0.49741244960678343556 -0.44664094267049170295 -0.78735772601580733543 -1.6826604465918750808 0.76405498570684104997 -0.075527887167689197745 0.6101217456384401272 0.67845705073704598576 0.17073258226478515986 0.1960380616353583072 0.38376557974717173671 1.0291764002505068287 0.70416753437264500981 -0.56729097102231740291 0.12730331422548335496 -2.0142501390543250395 1.1970050837370036501 0.52434664545118458978 -0.88526699203292202878 -1.4944005600000733747 0.94046726245491929497];

% Layer 3
b3 = 0.15072068650424449987;
LW3_2 = [-2.4878954624771170145 1.1047323104064394883 1.0171767866494851873 2.2293331961298270549 0.46248550872439675441 -1.0751511999209479864 -1.4355417235928860098 -0.75094465968497225994 1.0643118312614905374 -0.91008953180440932407];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
