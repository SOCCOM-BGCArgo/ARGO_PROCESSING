function [Y,Xf,Af] = ESPER_talk_5_Other_2(X,~,~)
%ESPER_TALK_5_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:45.
% 
% [Y] = ESPER_talk_5_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.91237287972070158;8.4262856264376786;-0.51234266162842879;0.5555730325714201;-0.35140466274756893;1.4297768176038077;-0.60155306986978552;-0.20926159516203416;-0.79370789919853668;-1.5861836191908449;-0.33961951419880548;-0.99153274796487445;-0.067461734433990173;1.4870253784921006;-0.38402919450682732;2.1932989192230399;-3.7453306136043536;1.5071116214272797;2.2486562227978806;-3.7766482443535283];
IW1_1 = [0.19445552680695261 0.060328620263712517 0.10800156373072856 0.10460051505270467 -0.096379667338914274 -0.35687222391758183 -0.13961482080814824 -0.015206044485248361;-0.042575506771205085 0.18878671875108197 -2.0053238224583163 2.8519214645335791 -8.4129660696936313 4.0725843732341405 0.023508971108477279 0.25017188951007163;0.13456598606712344 -0.046579615387859534 0.076071695117047644 -0.0020141398477945428 0.26331078103027861 -0.24382787321631624 -0.070610250279602896 -0.061630931554984079;-0.12733722701042524 0.14779458454394309 0.28548231900344817 0.98878061912349935 -0.10858323927623738 -0.24359217804871761 0.099750595440560183 0.18960165271070473;0.35688591337195386 0.61118473072244983 -1.08696700294725 0.52972073491428717 1.4822194646109148 -0.17893659836915243 0.13683318609755643 0.24746324228044447;-0.0014370138299936593 0.061553861759638513 -0.26906536033678558 0.12487538141909407 0.12129129643065156 -0.29001579598233124 0.015649208728657948 -0.093687631585877937;0.69131026844191867 0.62646862942780035 -0.018854767716988879 0.24697267557693389 -1.6690106804264231 -0.62754401027277995 -0.61436117936483969 0.40875725153867221;-0.45948524317253275 -0.1591053900264415 0.38419957479097566 -0.90869676322414417 -0.8772268350820136 0.65459601327829153 0.50340407639868534 -0.46557053277543103;-0.18693777080487972 -0.47205790519549712 -0.43921987548812735 -1.3943467605884448 0.067239755678367014 1.9792886142153641 -0.11154375453013753 -0.025642143373648771;0.80447846678028312 0.58050161533983669 -0.50301067717583847 0.4206314200263413 3.6479102503037963 -1.0155730879860878 0.37031089516715199 -2.0207721145170248;-0.24041485323015307 -0.27275901864874752 -0.099701740837182432 -1.4754388149851889 -1.9113500233817249 -1.3834213577430006 0.25489712816849874 -1.2226077789549887;-1.1471761497659398 -0.58557554659205469 -0.085491833178922463 -0.087976010921416312 0.9509980586049992 -1.1175012382855489 -1.0446352506417453 -0.26465622492600754;-0.14906988419516118 0.15374682227447256 -1.3051021076888234 -0.27950281783980546 1.1315016979237744 0.92959324922285547 0.40629216580358785 -0.68916379816311646;0.36822601243283087 0.60911969843990266 -1.1863870352306922 0.73080771544950351 -1.7295960887022335 2.3313236415820806 0.73213651275769287 -0.69050113845388195;-0.25548123535588435 0.08752185328715896 -0.61886318839780163 -0.33007870167420211 0.8080982500609577 0.25545265818998864 0.15081955021105564 -0.2733850706522083;1.0620163355343841 1.5004726775201975 -1.4891138505642003 -0.35410610815910359 -3.6065243803744051 2.0283015524038808 -0.28047380803514127 0.95511892789767316;-0.066300209933671 0.090060884859324591 0.21784444123382168 0.28365303362593797 2.6629985219239556 -1.7228397767839621 0.28632976867744375 1.3428048920581031;-0.61215437639739045 0.29391504584968425 0.82606018298354078 -0.48298557535955677 0.24947520410829574 -1.4790774190882485 -0.80210258749413987 1.8464293672998227;1.4620876349566814 1.3986169211700155 0.45107496768748889 1.5170665660206402 -1.1675581451745536 0.42010332040951315 -1.1232593288790875 2.0851974058210532;-2.2829906601029788 2.6709877282037477 -1.1123737030882908 -1.6734067972525213 0.050691641001657115 1.058871682462764 0.60479756216542979 -0.47345153532644785];

% Layer 2
b2 = [51.993263835465932;-3.5361262234408395;-23.246713377581013;-115.10098053010948;-5.241325340537287;15.699526651858122;6.1365958434294088;-17.868725937704905;-35.928817378557063;-31.885234204722007;-13.85023100274246;14.91996605755107;2.8407619454273045;-87.439283661860614;-15.033061208004289;11.830595066802216;16.175595718915826;39.665067159251528;6.6949609434371595;-15.045039359093803];
LW2_1 = [-24.449421349973196 0.68012398425061216 9.7724195411402519 1.3089945105189233 -0.32749237465713082 -55.906779199875075 6.0651025253266404 -6.829084336196833 2.1991925483945893 1.3136845250606701 1.5726918289029777 0.44111447359091754 -12.746884549617935 0.057760618491730607 16.016585143014762 -2.2987973106048485 8.0994271725868447 -2.1346444810045795 0.19284648929814055 3.6067004867990442;0.64934488124020728 3.0573007981088556 2.6837062684508792 1.2437508841601268 1.5461479932089564 8.9406614756298772 1.7269607586852105 0.4487382175342971 1.2103112327092591 -1.1466662981728326 -0.24127289479612216 0.63408737471306009 1.0718686606984489 -0.028490527031824069 -1.2474752059882168 -0.53567845687095939 -1.1833409537646531 -5.6274270263223425 -0.4946416112096087 0.62593222956742312;31.503460371202493 2.2271747683528367 -7.8010426655159524 -2.5108457654850254 -7.3771520414848446 40.043583103670166 -4.265833464650659 -1.5951608050978399 -2.4774770998831279 2.2167369759175068 -3.1510641105408168 0.60682776273747485 -2.6173515241417191 0.37877836658634206 12.263413212498268 3.058070026468628 8.8560320728985769 5.7204491618090429 1.1438468534722677 -1.441676350189061;-40.586778619088996 2.7443638794745246 -17.176910969134564 -3.2632978399827115 -16.589876189376799 57.878416077451391 1.7902632585886626 -18.174231049352919 1.1132597946621665 3.5608602871025954 2.5090823573392291 -7.7668892164467112 -12.661674181499974 8.5853079448308094 6.2203318348041181 -3.7786604898220895 -26.48974714922953 9.0456518461662796 -1.860074642526405 4.2966080251039713;-8.6981321395959554 -0.75605171894594736 -7.320933632370985 -0.74288342320348366 -3.9231726039469028 -5.6259188607254753 1.2169568147213778 -5.3052988400344594 0.44985474808929249 2.0998127629593499 -0.8478107050019521 -0.97489355589572613 -1.5786423240964331 -2.1468840943442067 4.3173437053141095 1.3122172274616244 1.0098005669564163 2.3603250118744312 -0.22873619242679491 1.6909763723776339;15.212403370063004 -1.5553168732049412 5.967944214707245 2.7754359341509045 -1.6414090325527104 -3.7395551617048075 4.7529373624181535 -2.8809103048791895 -0.48664499074079026 -10.883683263439305 1.3192215416397626 -6.6035649848102089 6.5160638127460633 1.5615498186292842 -12.714485188414661 -9.2755595398630213 -23.188105305912902 -11.542230723741453 -0.88755391463691979 5.9346306632564296;1.0971237100710107 0.068693641125322655 2.6304227869988015 0.50378678560143986 -0.091905412290693156 -3.3748136700693032 -0.085878408119899011 -0.13975686882799801 0.12620398614002395 -0.15603711911368742 0.14579051751269484 0.035555249350771916 -0.53652848259515207 0.26761157550399733 1.3767002131536814 -0.014853598755641557 0.34852022671938271 -0.4265117593822369 0.036718415238241667 -0.0064231867620955299;-2.4242564289190969 -2.1915152398785009 0.50164117527524177 -5.4720721602360882 -8.5729780609414785 4.2856347707832505 -6.8538546080712957 5.5277075943623304 -5.2555517940533134 -2.5636696521461437 2.5053181878669166 -6.3031219316182669 4.0746707338866965 -0.89912570428131755 5.7707906679725376 0.33111530458866173 -5.9647152416346936 -15.469172859632399 -1.0549733099111949 -3.8282928316660207;55.854298837010354 0.53542215784731728 19.500788281428001 17.191255505959337 6.7565522432468761 94.126301272093173 -21.385263972192352 -25.93068422103417 8.8310123559975384 5.4822345470330847 -22.879866228724556 10.660006700035328 -31.346584002899647 10.254578916302117 3.9290209589167233 -31.293366768405271 -50.838940181821094 -34.832178533305687 22.302474889992286 14.874678334165315;-12.432976711980871 3.4610724781460958 -6.526431034792366 -0.80046100017073929 6.177270414317694 -7.065190966693554 -16.924551343777932 3.6601739221631804 1.4456933383754864 -2.6360611326280412 10.354293178660843 -0.4691444708190739 8.850027619585731 7.7692707997614798 -9.563159869282515 -4.4020240453845423 -2.971946310514979 -1.7261883193043273 6.1343811263019479 -7.2691574547277567;5.5115256066812846 64.062476608975786 11.991634194497243 15.4502979863892 -20.673093320427245 41.472190476659613 -55.652344075596154 45.818162282376036 -48.897360479699664 45.869555413547758 -79.471947005680306 -45.38443087239591 86.676249374032054 -89.834361311137485 19.224767402063669 -7.1578875624700373 -4.2802302695061849 -52.8933041136711 -47.840702340416129 57.216943442835344;12.469577947332576 2.2075931918466245 3.9682904523252822 1.3514076727518536 -1.9814499048608369 0.086972321194498825 -0.67235114408792152 -1.1237868508360371 -1.0050870004481933 0.96651958462695053 -0.9376817031386242 -1.6377912879282952 -3.8355731464303089 0.023309195792149212 4.7237292995608371 2.144116877484211 5.6061945630639327 1.8172865561547991 -2.615041533181897 1.4986232464932825;1.517838593547453 -0.34908424846723146 -11.157343903029309 -4.8612908664538113 5.6551594524099835 -13.507139263571936 0.39097538793993503 -3.9953793291651114 1.2270982451155452 -3.0436417591397507 -1.9376485092340683 -2.4706198829013428 14.303203601435731 -2.8216325933624824 -20.346466782074604 5.9234580674855151 2.7480032277566941 -4.6228087963051845 -0.70242707535640936 -1.606648022955443;35.053078880826789 17.581535945086845 91.572061521275955 52.304467380945418 3.0082195489018178 -29.890380245114152 -13.43794922276296 -4.368370441576598 -1.3250907981055107 -8.6485237481286514 34.312840886783263 1.4783867629895431 -28.467451209471875 -11.261671782193584 14.565792577006453 66.155077150219171 -2.0196052459232336 107.69881243037042 10.764413804367805 -15.078585492706187;-21.678464068002917 0.62154175701838033 5.1459105145051112 -1.3082640411753914 0.86093302403746097 5.8578366396758073 1.6907542217872387 1.5407988105749231 -0.98164631803329783 0.51687936431306003 -0.69929795204972534 -0.13925525637789754 1.0223138349616905 -0.84606060049502885 -3.5921501354224308 0.19435779213152343 5.5124585566757736 2.1186134884083136 0.014716249505152726 -0.01729871670439306;-133.32925626083824 -59.149633574524088 4.0310001017333441 -7.7078000018377182 6.7940706760776948 -82.549863198131987 -4.5421049258686317 -12.303099511327504 10.562267395062337 21.06658447275635 -8.4223324468632494 9.0751559138947773 -14.607949272275111 -17.332109561365879 5.3800292709582012 11.324460130257089 4.0772463798706156 10.586579452261164 13.59083095879312 -1.3674793745834002;-22.310127014186865 8.7404234973186838 3.6196099245198901 -6.3621193547915897 -0.071859221323723549 -28.101803862909268 5.1644965155926608 -2.4413303606480059 -4.2915625966383288 -0.96838484258722402 -2.0736069692841395 0.95456877794599904 -4.1042333770585087 -1.0656950866044639 7.3715917875951833 -0.63808335536541472 -9.3362262355409342 -20.724424015932019 -0.96662788433435143 0.93936748911943435;5.1287572603618452 5.5764438300575891 -7.9853275693456665 -6.5832936221887293 -3.2810054015190278 -28.25216627417138 0.71306266946235308 0.17756195740719455 -6.1498050138684297 0.14594467724134186 -10.22111571018351 0.36471055443006406 9.7872696168528535 -3.3871725415598775 -0.83897791751100503 3.4491441554810667 3.9610397187518274 -18.738495296644818 3.7534207663470558 1.4446388000689354;6.897947060070071 -0.50459750036002815 -4.4615516323020596 1.6926188403366957 -2.9857702573661897 -4.5203667327749297 -0.11317665865724739 -1.9129244857409438 -1.3006284709456275 1.8266488958417615 -0.753510094237968 -1.3019053834369418 -1.7568613317148762 -0.63459490526746676 4.8310308126177457 1.9428177627817296 1.1326872695645624 4.17990931316222 -1.3242284151874946 0.56951870487580281;-8.6081007310436561 -10.596182191865303 -23.788317520796376 -3.1756643702343483 3.3402234500836827 -14.417895810705588 -9.714046196548674 -5.3931056062867624 -15.861158046335103 -6.3251477199605368 0.049456276352174637 1.9563983913429668 5.8546950826349438 6.1931060909022664 -2.2048148321637986 2.9009820098245767 -6.1955882041290913 7.6984963205354227 -3.9146737735710229 4.8005769298875451];

% Layer 3
b3 = -1.2736139943155702;
LW3_2 = [-0.022910030619400373 0.13375777472331007 0.041758966196348279 -0.011056553737897913 0.061817488947041255 -0.013416331961663567 2.3960809385427049 -0.02588934278754635 -0.0030225034782179546 -0.01013332364874602 0.0034222062551911123 -0.084316259665494345 -0.016165692810884532 -0.0039914561858878476 0.41265331582741493 -0.0090432943826351878 -0.032626436466212154 -0.013962087282491325 0.11026385520534161 0.0075252151594681653];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
