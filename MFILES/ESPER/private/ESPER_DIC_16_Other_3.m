function [Y,Xf,Af] = ESPER_DIC_16_Other_3(X,~,~)
%ESPER_DIC_16_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_16_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4197413338899596003;-10.224030721257271637;2.046182183797720544;-0.10632322598502967625;-19.886863406803581;-1.5011534011188916171;0.52456274729463070461;-1.55629775617503463;0.0018925882445559073786;9.03682725079350746;0.98149418999422710641;-2.1130824688172737957;0.1998452952510266778;-3.6326593358546790391;-2.5944490234988166755;1.1714002127246860852;0.8195749048800603509;-0.93698764220076469211;2.3349380488240965015;-0.28270444438604441784;-8.4400180798544308658;-2.1505630949380654116;3.4196182911582613251;-1.1190284754303909676;-14.485342400582576161];
IW1_1 = [1.4049042074007658254 -1.7602413340654967655 0.67298407634910051289 1.2355776392049193646 0.078088771196126921526;1.5697183630226869688 5.7040807261833741393 0.0087596718905996046045 -1.3251385607032222236 8.0890659016284338634;-1.7419572153584494956 -0.73778599594575167142 2.5387297773015662372 -0.80082870948799578237 -1.4120847580453914638;1.2071529458645835486 0.41109353575874824083 1.9468105264413329003 2.3632274522263547745 0.98164038139280818118;0.16088977636784573821 0.18804407676549911299 0.93368671365057320788 -19.925476164987184546 -0.95863925746436351449;2.0420528962881885349 0.73000630810181799113 1.8158869207361849618 -1.1735178938002543969 1.0096198078935245679;-0.87345094357213737268 0.290364442637016551 0.81886390784969553813 -0.73433470431931047173 -0.49950056297190703614;-0.10492448777216181743 -1.4013368370186447542 0.68078389204194666995 -1.2095805241752333181 -1.3137866115325371741;0.65842671709791256163 -0.58380073850341451802 -2.0551795107166133114 1.0355918976988267577 -1.6919011986507095369;-3.1133498042789575777 -4.2725420486193650405 -5.0990125041443628007 5.1931300640501918409 5.7822953916519530537;-1.6527719400001883443 -0.17409258085066928179 -0.96149236475952093439 0.74168724835676780316 -1.4234903255629067775;1.1529375373400647664 -0.46214913554034897647 -2.9050129025962290186 -2.4853878832889422235 0.96663291220982006102;0.54423947207407163962 -0.33595879191891719895 -0.12052913770784808023 0.63814566624310375964 0.84638455751046404174;-0.32808670054218752599 -1.2713977039531825231 -0.74449661143975431887 -3.3131783126726270794 1.1995021527119014149;-0.44965719165388035039 -1.5373651017919798267 1.3826874662684660588 -3.9631830250895405676 0.41343784795460797321;1.1453104218860228336 -0.6143262852018408493 0.10792089069360949471 1.0123231853735605856 0.60014824156822765833;0.15291833562772710886 0.076548521668864971668 -1.8113323269756147482 -0.5803113063350799905 0.48593194752809265591;-2.4110489157736805232 0.48913141598393761189 -0.99624421680170616167 -0.17374401063447297844 2.9814848647883609445;0.39004088032811207176 -0.39828889832666425352 3.9389756100676662776 2.2470741626560886139 -0.83573563724965638233;0.29709786327243864479 -0.33723472115161290397 -0.86926802028634597708 0.83944535533970165986 0.8844929679811635026;-0.35989136919774911139 1.4095251365801699794 -16.958502636968329824 2.9740499157085098503 -4.3848553054419472375;-0.18879253503082449317 -0.41135633187275949529 1.3696960885633979732 -1.8722656472901599845 -0.49108609627388161156;1.0992062742044415025 -1.741665875304585942 2.9047221284076898407 -1.4382973051074661175 -1.8090863543924531331;-0.71733631060832858672 0.49461885134677913145 3.0546573236037257715 1.2148599820650591852 1.5694874277354649017;-0.92867350911067547692 1.0209496078270203778 7.7997622104111936636 -13.486378026457662926 -1.186292205700928859];

% Layer 2
b2 = [-6.4271453290600115693;-9.7913388568674726287;-0.33588836410866657056;3.9900564082512732789;0.14656760697134441074;2.1104255706041259444;9.7086804710522791595;-3.3384011410669565123;20.262989233101059483;-1.4936391034453224691;34.038907948444361296;6.8249311329737141207;-0.60987513499822065821;-0.55931999866567050361;-1.3361177462468785127];
LW2_1 = [-2.0112298175542333567 -1.1740519101978619254 -0.15043653601739653825 -0.088959105472128860437 2.2055819264811158398 0.2715501208140678191 5.2323552753671114246 -1.908177940514532267 2.4041159013078079454 -0.071468350430266100459 1.4920790561708738853 -0.67724041873604956532 11.723458881023487876 0.61875794275404627509 0.18562832556484190616 -2.5494811029464292673 0.25259351256175882616 0.023108477117954412394 -0.54372098635772669883 -5.4150306430752399578 0.29601295055488635599 0.086546373758897648942 0.93673980960897806902 -0.77935166408411149508 -0.55104156820486804857;-3.1529298667934120282 -0.58344421586461803209 10.798054715916544311 -1.0923909914630796081 1.2165617804868849028 3.2633450816623219559 -8.9929956229631411446 1.089857879953656461 -3.867002626980808877 -1.5506624251136793546 7.2409960625211544638 1.8141264413045778969 26.908510257166135204 1.1742073406008397551 -0.006994967806793147419 -10.464433657367111508 -0.73764133820737287639 1.8733616114430478028 0.47645005734751955107 -11.79402301674165443 -0.63894929054190774398 -0.98984738491931312243 0.5926586032371401469 0.71783625189484556728 -0.1404982071778750341;1.7960260993273085006 -0.55965300516627536354 -0.32671347998515976041 0.11197494195088962543 -0.14863244357766122739 2.3429517074559678136 -2.0089334676616235065 0.18235298225599946842 -2.2044556344646468737 2.5946857735760211483 2.3372801802981273411 0.97537106521833472073 -8.8501914896515412323 0.39272021578635118999 -0.25629827716841474539 1.4488602594781170296 -0.16432103182194168767 -0.43656354522225016002 0.3310202261075593233 8.4741910387786489878 -0.4708377661735937969 0.60025175424699106497 -0.54949769292072481175 -0.71621949554764574586 -1.9815520373509527552;-2.2619934009131070773 1.0808202382945371056 -1.5382389543962720069 -4.908061068684701489 0.19507501898098297821 -1.199174708168349035 5.7673102298730691828 1.2357622195969071299 2.5180264942404710915 -4.7571621347426296111 -0.21190021187581861706 -0.35025556803743346235 8.2782239312529632969 -0.6137332140644425893 1.3501490125616579796 -3.6463175052676159993 -12.015668667085146026 -0.41725925327521290464 4.805006130953613841 -2.0788259156762434188 -0.49790851018066295541 -8.9645708579725802423 0.22782780955956316582 -1.8014074390632113243 -1.7203237405534457238;-1.5543485763698241531 2.1978457595842257888 0.092871931278807828836 0.092379997174751787847 0.36585038637959244046 -0.16311485441695897092 4.6016485072181056992 -2.6916034251120670717 -0.16345022577992404655 -0.930909312080781981 0.50276138039917606104 0.10147094089071545531 6.6995938167554305309 -1.1052963157011816975 1.8642933225455562418 0.92093907998741486587 1.2886538660742323792 -0.38780445616362274608 0.21688506933990375769 -1.8534526307760819108 0.22107522868222617696 2.8969295897510796145 -0.34482333456317659781 0.29858584381018410392 -0.89510604965768847396;1.1056660376083717878 -0.36962111260430957627 0.69766180133545951936 1.350520957269837341 -0.24665309045443045699 -0.78490611018935885212 -0.48131326944595614892 0.99340947355084185943 0.43023631051849142715 0.54957730923804259948 -2.436200465972334861 0.66276340506877751135 -3.2241915495247490675 -0.53301209664947546418 -0.13597377043599423452 0.26292636316804557373 -0.8448220823178823613 -0.17027278211327381841 -0.75490578370383143447 3.0479986604674196293 -0.17925328119304043129 0.15117783739962323275 -0.27715069553923638024 -0.11576135708189778939 0.62574276022912678208;-0.36068502282450792817 1.2430507212367454262 0.97078163718857113373 7.7841734092507204323 0.085221870460877868769 -2.6475627526705913795 5.3685508455384800541 -0.77047843830784190633 3.4889490189245786489 -0.45185822045945817083 -5.6827837593028238672 -1.2580348084924573016 3.3258613270933361505 -0.46615019533592283452 -0.38985866852288064699 -1.7147503626375442121 5.2680332264167040179 0.47234214902666160629 2.899021338118563218 2.4423826699915243132 0.95292463865666821032 2.5556388518949115785 0.027915501577193732596 1.8270298438546275221 -2.164522281789697189;-0.81059274235698830502 -1.116449581207632713 0.40754647046406045074 0.26696009917399077249 -0.34030331671408153849 -0.93770591269738123863 -0.5762986964957843572 1.5725827008630492987 0.62626315675684018913 0.56451822208534263581 -1.9786054296870974056 -0.70693311802129121801 3.6873007504012358382 -0.19528167075581576162 0.17361247248589867231 -0.88758543865629546676 0.55563874581243821726 1.527315058424694616 -0.29479059610549623871 -3.7577088892037795453 0.17198194655822987564 -0.45763104770637952345 1.219615063427352597 0.43421219572745084481 0.0045304111173603382745;1.5396760318696529612 -2.6756480524371331065 -0.089103280047844901635 -1.8145383517193360845 7.6355874115221551435 12.050569262716850361 -14.995425625634625888 -4.5310887287227874509 -2.6217479772688054851 -4.5276898396234832589 14.67625680654678888 -0.19426769649952030372 1.9788663524688385742 -2.2123627331825947984 3.3866953471084237925 -5.4169214141782084937 -8.7397769288444600022 0.7287421746751032714 -3.3650370312854729349 3.4848752366965727312 -2.7471059271108444477 8.8779033889345182473 2.8480727479749603503 0.99101012920706343934 -9.7236178481093347159;-1.408971967565577188 1.9630606679259221536 -0.41655732964104902338 -4.508271077091575485 -1.6569420113054329491 -0.42416014798191242763 4.9142416913145439139 0.47684781725215069637 1.1966729379474543293 0.25976181957700722469 -0.90209185235908406764 -0.36405937391180509533 2.059678390231786782 -0.95471346236131149343 1.9017245102988673544 -1.4382200589204570118 -7.9032033431400741108 -0.86088742569568299512 4.3858296908893397159 1.7187563472070512827 -0.38631148481538396533 -5.162332208344701634 -0.50549439617790858925 -2.4468145197711379524 -2.0453150761086669185;17.58403046581644702 -1.7944147284021310096 -7.2064090784457697225 6.6849123422677454442 -0.3805434107414302769 -1.2791736936227071642 21.248902395617953687 -4.0649580102475573185 7.8859415338388441086 -0.9973824308955379081 -2.1352480223776697521 -4.4962368689910263697 19.170826042287185231 2.0185505218740478206 2.305503874808931819 -3.000303209547854788 -22.628292824738785782 2.6423328440890756497 -1.8801773008446087676 -11.983267989390409269 10.499487293148842326 -5.94229519195689182 -0.28750592891395460038 -8.8904718489124920922 -2.2662246132047676461;-1.2155009948785886476 0.72827760816425168855 -0.56841275806676139215 -1.2656686406978967518 0.26730247904608545051 0.76866470665425523645 0.44498930300411704275 -1.2753942851965096583 -0.45871745944146707918 -0.50337606340299656527 2.4792583380430444073 -0.62150230332966893698 3.129325037862622505 0.40338835203268180729 0.23329552400722594618 -0.20990773679707480648 0.88817669794741893607 0.11787518694531268215 0.72448448238524043585 -2.9887230433824742981 0.1526036675668374365 0.6521634754997149841 0.3083374494608654981 0.022080381159340568137 7.656499524273264079;0.93253455191016387804 -0.66571092349439286995 -0.33523944568646302233 0.37807500428197821085 0.31148358047554780548 0.37281307850091405243 -0.67819095544762708627 1.5331040615198996413 1.1327681434309133657 0.89578249281966704221 -1.186967859244983714 0.18820970607821574383 3.151536834362855366 -0.41055406171687508499 0.18162885233603240365 -1.992024364344219034 5.0835899203936669721 1.1350568598951826793 -0.26547612459716002364 -2.0161147282126257174 -0.055005081219278065263 0.73820425791043708941 0.093469476686620811545 1.2598427952129425123 0.15734802632773234321;2.3774094273056554094 -0.17373035144707302257 0.57612393292681518542 -0.5173229993470797039 -0.019007174492002391897 3.947075317264016725 -1.2153267765518871446 -2.8536264509023809843 1.2582071679604813763 -0.50250101318976236886 5.1240305068622475915 -0.54155790224859789994 12.44434683893700111 0.30510534195219740639 -0.21694946516191371266 -2.0642111632964925683 -0.1173300771361849848 1.421403706417447399 -0.53384865098810874162 -7.7711005245618283155 0.60248110509500463206 2.0144150350656979676 1.7936748836970470844 -1.7539062431017249377 -0.12164333025800945498;1.4863660355228649479 -2.120209127726154108 -0.068543696049054692043 -0.086368426457104685579 -0.32969174178521243324 0.11849068685570680881 -4.3628307607390306444 2.4344818119119864264 0.052567371763958307962 1.881405802276477468 -0.52131856655900410402 -0.091360724078551419636 -6.5324296988830941046 1.170059246919948226 -1.8223008909029221325 -0.69449179031268837292 -1.0706447379948982324 0.30914060527801001665 -0.20933000664511766664 1.8142767321290247384 -0.18733082617674604031 -2.7633894184517848736 0.26892911774215894072 -0.33758695894374679547 0.888730463320395625];

% Layer 3
b3 = -0.096811114558679745024;
LW3_2 = [-0.2704183900778271421 0.12355426514770605217 0.37051505246010096872 0.38859592273589355083 3.7813622233238568526 3.3671505322601444909 0.29114731399924659305 0.40265558689355174238 -0.041766497568140034669 -0.38813081534924875893 0.31551800038607979992 3.5233967766337870309 -0.3740977163978268516 0.17955000118446307056 4.0736396338737606015];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
