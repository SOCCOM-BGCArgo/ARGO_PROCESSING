function [Y,Xf,Af] = ESPER_tco2_14_Atl_2(X,~,~)
%ESPER_TCO2_14_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.7852184373583899;1.0329289375242301;1.055294521778817;1.8278823567411113;-0.24011617203315572;1.4909873889865057;-0.4051030008774279;0.98215074430332283;1.7218638447796148;1.9309401828180575;0.85434253779746161;-2.143336867769468;0.87882596406637803;-2.4451886915734424;5.752535177724746;-0.98469905739708907;2.7710048843642019;3.2305969166711836;4.2208614048542481;-3.0361208239917277];
IW1_1 = [-1.2654461649649087 0.21218454418125979 -1.3959451469285167 -0.3385145121733984 -5.3357097053772371 -0.79782751982911493;0.49931318536175401 -0.61045177521001603 -2.1890027852378253 -0.10246873444506621 -0.13885878942889829 -0.37811022568850933;-0.74996550774797854 -0.5225503189325853 1.5130369519995381 1.4230918315211218 2.7712233102486192 1.1004609553638862;-5.2879650382035344 2.5032877353529552 0.30551091153296894 -0.43230156141511583 1.1093039795611097 -0.19770957661098146;1.3454313026685587 -0.75266848152416199 -1.0207370001109137 -0.053609607120366033 -2.2992175873537963 0.35499600808546139;-0.25359312839586728 0.2852234498901034 0.89545582752323927 -0.7836384566261968 -1.6381675458141516 0.12197312762682536;-0.44878769012509306 0.6467786117002402 0.23699636118308506 0.21969150717426494 3.2544893574869755 0.58019338851877467;0.12733273177544208 0.26836151232748007 0.057091833758127208 0.49931128751086867 -1.7850103523359464 1.5263007474311416;1.3344328573887099 -0.91894503060847388 -0.56412121702682017 -0.23564042375757113 -3.3221533055655486 -0.85878801286685413;-0.44727009584975547 -1.079567267991808 1.761863664129067 0.13875490111659181 -4.6263313208767558 0.37232639560326375;0.36142144991526948 0.047804333307014543 0.40793284059536528 -0.24219915728435293 -1.7636572855049581 -1.271898839577259;-0.16860256618853162 -1.0972633226450115 -0.18543692807414652 0.64752087545271653 4.6350066355633635 1.342855351081075;-0.78810963653488642 1.7009080954804601 -1.2986396616201077 -0.41129734277022173 -2.9122530204706467 -1.5791741413987155;-1.9316348547878308 -1.194374661027616 1.1384692262734084 0.13036814154095869 1.6800772533230497 0.051864539453205016;0.41827156507592961 -0.34239277776490223 0.67589951124599246 8.3936188196361048 3.0563298814683559 -1.5233794018713358;-0.72839922979154559 0.59498760105973103 -0.63302778869326382 -0.16314204863245485 0.49952354519334846 -0.51435588308270097;0.05583539963929951 -1.149778423100795 -0.83062508435442073 0.83230924288814279 -1.3911191011791828 1.23000556301407;1.6581180975772325 -1.2700575986392109 0.3170448146842913 0.54261877746623099 -1.4317069441102968 1.5055176848024991;2.2585119399388054 0.94348188759117191 -0.70528930655997069 -0.1864751158327454 -3.2760046573748411 -0.060834437381946833;-0.88436406590759364 -0.53429505450432424 0.61271671312383302 -0.5150923203838218 2.380617292013381 -0.70381258794298851];

% Layer 2
b2 = [2.9391652917461424;5.2862662003024132;-2.0251079484441736;6.3708181832393551;-0.17954521736557838;2.2328430542204214;-0.096389742730011843;2.7159409425472432;0.3094577849264879;3.7970813181775189;0.5775187257947122;4.2820134081112373;-1.246959880407565;0.55132567145526412;1.9566667232861665;-0.40645634799699126;-3.3115782871789614;2.6691245815522797;0.6848888198703984;7.2708275476333455];
LW2_1 = [-2.4498064752917701 3.680839324385051 0.8934796610467175 -0.25875243527211134 0.35682005987172188 2.06887540962546 -0.25470310244928124 2.0581174950521488 -1.5348650515624385 -0.012738912798728096 2.2742611829486048 0.48170684989478346 -1.0167931316339316 1.0326110819487897 0.74576941380900741 -0.77205728264213591 6.0170802314046892 -7.9569002083686371 0.47093582162125514 -3.6992277960745401;1.500717751023803 -1.1544837330230928 3.3523943476430369 -2.1073710878121052 -1.3314374054292073 0.31305752841434203 -2.617860776357793 -3.8421363683155896 0.91393290538883354 -0.21433372827758407 -2.5779623113482799 3.5512685548502896 5.8689932927193373 1.4384825867570004 -4.9594788434559396 -3.6621830881451567 2.303342888029253 -1.1370552872400452 -4.1340431147443315 -4.3909319736133661;3.1272703998896088 -2.5414195101152965 -0.17789711214382231 0.30906019674860624 0.056186028434111301 -0.049597906742397439 0.26591072519480446 0.53827243767445587 1.8877214008861998 -2.140846566131918 -0.2025922945521583 0.11201841752073954 0.40566654432709143 0.73321895564065187 0.58241398055640414 0.85387652883356802 0.81678191406303169 -0.31041295443827915 -2.1449339800562481 -1.2114915549340317;1.4948687367375961 -0.79150889821569181 -4.3959375547505282 -2.6330691681076415 -1.586798809798087 -1.6741115002202258 1.7684574753496725 1.4565605043720311 -2.7724704241823046 0.92500425628540028 -2.8029829423243213 -0.5466750152537343 0.25328834533234867 -0.9689349606210611 3.0829070036382156 -0.94013656768298748 0.65195718982236739 -0.18996192890551433 -0.61408473980829226 2.0898035439084501;0.32658968815593531 -0.3288720549118469 2.2253671069199514 -0.81456615215406269 0.48647832280145109 0.45894483075732101 -1.2590389868859995 -0.10735851818600871 0.034663947592749725 0.50666329218500994 0.49778504399470846 1.1223872793360625 -0.94482848572590827 1.5055396547012845 -0.014106739009955509 -0.14738699077220338 0.10027983610605545 -0.93718046901091434 -0.73304335099040396 0.73479645394688498;-3.0195713760646297 2.9836112479913779 1.5254326409552053 -1.8259196818733916 0.54322467932224416 1.2684287564128638 -0.44218486794912509 -0.47258539281443857 -4.2714749326624517 0.048001393556819115 -2.7421061185908546 -1.2921685361329092 -0.47184649019155972 -1.2325190459865336 0.09177320513047485 3.3268051018403928 2.480848669580872 0.47949941665808227 0.24957227370956003 3.6370681267134524;1.320443849436516 -0.99822759344065726 0.86335032151117741 0.78286412468973843 0.9668220883629195 0.30524616881394501 0.10436514481707346 0.48470397708315788 0.70245262430289257 0.90098969025026099 0.61921671919411858 0.81700317861551019 -0.84785771791032039 -1.4181178035633317 0.30408166873277348 0.94026349813914356 -0.21707006146689597 -1.3210682173243633 -1.0902703431550071 0.51121922395732178;-2.0600395126410835 -0.77771695225925797 1.8949209429893004 -1.5935794313851328 1.0147868117677776 -0.37969422574618356 1.3623947183537164 -0.72103421129776302 -0.21400987386370596 1.0031692838813908 -0.15448396468230691 -1.9097167529552099 -4.604447085815548 1.2836262382224353 0.7500774120959981 -1.8479529180236962 1.819148182943257 -3.0516455286313313 -3.0699223343456921 2.6634247181545594;-1.6739815684105968 3.9127145361196973 -2.4603368640036742 0.48057819868446749 -1.7924199500216929 -3.288120456293206 0.30906120011889726 2.3507735474828553 -0.43666805960605154 -0.78700780296402473 0.98709540651224514 -2.7530115300083167 -0.32980884886625694 -0.795897136509786 -2.2919956000099768 -6.1108343309607429 0.46692869054671682 -5.9561980589117836 1.8311551624207985 4.4576353075434465;3.3092538707235954 1.0315155781421579 -1.5318929482259132 3.1257931311102647 1.0125851497821061 -1.5424364666462034 -3.1382622366894077 -1.7364034164284226 -1.8552182289618699 3.2478087264644158 -2.2113144868529107 -1.8947870507152544 -2.3479151463641816 -5.01819300071136 0.17620601337862712 -4.572561352490875 3.8931381964588212 -10.624638342470476 2.2999501799871114 2.5033867812651596;0.38807023172896266 -1.8075585952624338 -3.2093672259115813 0.2153087940594117 -1.6788284546362142 0.027793708799096199 0.5344990442387898 -1.2277068806915161 -0.26535133940195943 1.2185472863364966 -1.2619488573498709 -0.43361178575651971 -0.91161265721601348 -2.4381570695825134 0.38572938087997738 -1.2238755640915775 0.58129517235774897 -1.3629657855610144 -2.3825842136205759 0.96912373442796607;0.048567832740690563 -4.2034551630853185 -3.2116300170480336 1.4076794427123218 0.31692148901727479 -0.58574452922627918 1.8012809829956873 -2.3410193040962253 2.3024453493397914 -1.5896077138220233 -3.6099920091582578 0.80387915435478341 3.2831010822513496 0.49929229215029614 -0.96457617470113344 -2.1806108294325961 -4.4933922640948927 4.9950252027001669 -0.74117605733678016 -3.708047301995002;0.05549816078763721 -1.707879708257025 -0.75015333720916544 -1.0109180078323097 0.19072776675251343 -0.229064627684505 0.42628048551391412 -2.352373134214206 -0.69598840235155779 -1.6034425636497314 -2.2637179315246687 -1.2512333218984475 -1.3259317318879478 1.5003299784925435 0.0046730417875303666 -1.2068526897086582 -1.0677223526016351 0.62788953571146711 1.8531513444954721 -0.15669413729523024;-1.8414987908326457 2.348352001258823 3.6687583638961283 -1.7268304806216739 1.0227393748839184 -0.46275660131013041 -2.0448901641675992 -0.43909683603966221 -2.8160646799777616 0.6107995354141833 -0.23035427605681749 0.55911660137284036 -2.2964764550167436 3.8479640271755171 0.0098390415226288323 -1.6975001647736319 -1.8847406315344639 -0.2203657730704075 0.55534029285419151 0.98509174201061911;0.19109737141049613 -1.6839474079664472 1.6062264015386298 0.67037492841440571 0.16275819748125425 -0.17760563802637505 -0.65952640565095322 -0.23440884018457495 -0.78056503926974075 0.81430168453598994 -0.43959341157972975 -0.12024045049575409 -1.3649870111068507 -1.8088982063043786 0.14185312979610218 -1.3095065909269665 -0.87507196123039033 -1.5602930499766303 -1.8487891236028895 -0.31995088579312642;4.2639871975933703 -3.4410223677489151 1.5569448245684854 2.2872975242800155 1.6720772196300839 0.771724805760854 -3.7832589566620918 1.1971994590813966 -3.3966654901711935 2.3629498044963957 0.00025024910961235491 -1.1979443412238506 -2.473490370136834 -4.919333835183723 0.17353307787841493 1.2566843501690954 1.591451719982794 1.7531489299572003 -1.2826390413830575 0.31693778172744902;1.0258308258008013 -0.088844902025085437 1.1132740083596502 -0.08313334762844457 5.1067607619133426 -1.1848304984423286 2.5268803325372979 0.13179928230162774 -2.5955694868369852 0.3454464732128516 4.4597954865127027 -1.6324552397903536 -2.1134276668260696 0.12824772531061074 -0.68016920590446128 -1.7926559242636795 2.5385401205987175 -1.6049230444231646 2.9906101742289128 -0.92576706132147679;1.3704570824966902 -5.4199966252363172 -0.6297769751047666 -0.13166398001747934 -1.3137583494559284 -0.074690489511168454 -0.2508446402933987 0.41266956565750174 0.36247669654164499 -0.37342322012902868 -0.45550575899324763 1.0669090645248192 0.98195064871759297 2.3381734631341451 0.10301857897004117 -3.2342605545631353 -0.19130717846850925 2.9027304261314266 0.16192301605423998 1.887361073152938;-0.15620019030136476 0.025010118467404963 0.54255777873007649 0.34058990385003224 1.5188446128707676 -0.29282281967283386 1.1192443450454337 -0.47907073421105428 -1.2847540865686295 0.93596567925244278 0.55946548133026164 -0.46278278453705324 0.72166703612992689 -0.81862236659865872 -0.029546278263574342 0.75191161740544543 0.10670127270079885 1.5064984282065692 -0.15472755135631949 -0.37387662920730924;-1.2903131940089492 5.9378258449910843 -1.8845570001628893 -0.023419411336421385 -0.53391478598396436 0.75728090011935434 1.5304549734843249 1.7658749200903934 -2.5384334025132151 -2.4436307748010813 5.1223285871464421 1.6907199773076567 0.53390812463892612 1.6446463473988495 -2.1995951109330094 1.5244259806065021 -1.1424248666379975 0.25670908386921271 -1.223910310105325 0.19878894937491029];

% Layer 3
b3 = -2.6908584696933153;
LW3_2 = [0.016652554031251449 -0.024385092313271611 -0.10914128690160652 0.11040234862492618 -0.083770470999326968 0.03999744545583634 0.28896546395192546 0.034842747789405465 -2.8033639564405339 -0.022003804949958041 -0.27054289488352856 -0.012375242147649342 0.11913114441461424 0.081280535448934141 -0.27720063252414789 -0.032398206079258689 -0.056054070427789628 0.28671786239078778 0.61568188096137733 -0.075292715596610021];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
