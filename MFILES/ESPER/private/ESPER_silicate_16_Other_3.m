function [Y,Xf,Af] = ESPER_silicate_16_Other_3(X,~,~)
%ESPER_SILICATE_16_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_16_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552];
x1_step1.ymin = -1;

% Layer 1
b1 = [14.267624567377664491;2.7405439465689118705;4.2210044791355816329;-6.2824066390670978421;-1.1805262126670470479;-3.2880436625463018707;-4.6850129250884471332;-0.42659997845378561099;-3.1793324560192068873;-0.61120461756474053772;0.57870778258037847142;-0.35181367316129924516;-0.31231760354105397859;5.4555124827321002101;1.0929206149400501058;3.1491693991360092397;3.1486274211459233108;0.56964756124584881025;-1.3612476596345863822;-1.1794473807483787375;-0.24288835660324023524;-0.28568503889062080159;1.6499518672219048998;-0.62546398913209488857;2.7676338388366592547];
IW1_1 = [0.57201040047077078565 -12.326035480823691159 -1.011953700020862934 1.8335665454021534693 8.9447489943727660489;-1.4604104369163013466 0.50499920203742354463 5.2167643354547781342 -2.1066302338135032279 -12.937972983907537028;-1.3430515449245479243 0.81448205651121707849 3.4821877487456167621 0.54869125995343470681 -1.8425166536886481428;1.2133575883114295912 -4.5848753394531662764 -1.1297917464930018472 0.059964757933897057385 -2.6273335418433068078;1.1261016783258956941 1.484990628335191909 -1.2400261078528660441 -2.356208948399540315 3.8441703436849499198;-0.062993759999061219035 -0.13458383082627187188 -0.21911229630321849005 -3.0066387441747153275 -4.3668398390660625452;-0.21221795203361393245 0.37414044064629131681 6.5814549519628791074 -1.7906923318559977432 -0.888252626326471173;0.68005249808175227688 1.3580131680444762488 -2.8979223192105081353 -0.36821261950195366408 1.7832392820600440064;0.32773811059101243259 0.32239180210396506387 -4.7673598740559857134 0.43546290151304556382 -0.35290724722451599638;-0.14975489981375747495 0.17905763873683552823 -1.964673463051543445 -1.5391916094848812069 -9.9262895152846564173;0.73821228292811025273 0.22723343233127368812 0.77780252805236471669 1.6245590656606090363 -0.51757968674639742712;-0.29667902398212092629 0.20461312300330947167 -1.5851608167360577983 -1.3913224372488814939 1.4248763145992613399;0.49785708498838066038 1.4968017217558919896 -2.3759216458406866579 -0.26032988556989361539 1.2892005964251449512;-0.47826511490068057686 0.17689845520472657903 0.89191068330893297222 7.2828465762054701571 9.1631324475071771474;0.54579202944437843481 0.44055258224193272198 1.2636446693255145579 1.9798336303898704802 -0.69755895355726138529;0.092598188475282700027 1.8759550994260874024 0.16951289353395759818 4.9581536665328984625 -3.5071432430246565204;-0.13141245515436883462 1.5764598179739686135 0.14828640315463240129 5.1625144532998241687 -1.3502198378905401199;0.81159977205614164397 -0.19446418095069661902 -1.0012980111790641402 -2.3506077455132645682 3.2186800517610691941;0.47362107145717802226 -1.2613902231998739278 2.1712166378297612646 -0.41790638125298029681 -2.1339697500202072789;1.2348769053707295829 -0.50092444971378713436 -1.869117869512516128 0.089199528560046592585 2.3506445767600165908;0.4143390127301079251 1.3941042196428612421 0.23308027591655958166 -0.69425954899391340014 -1.1908283944826145717;-0.88092290787710703093 0.091427646196341832985 1.1696666131583519643 2.5123243227539577838 3.0125453490091307351;0.56716989914093673963 0.54806158545546257432 2.3961434012711051444 2.2618495427566687184 0.23501597933950724162;-0.49898406170888454092 -0.40968811353011808096 -0.3508969319175238577 0.42929837882991339626 -0.11555398636154182168;3.8896910884165261102 -0.34879875280953848149 -0.16653286614405726773 -1.3673481516894621102 0.28308952123368646969];

% Layer 2
b2 = [0.51888998887613413391;-2.5350420123668508943;0.50724168498061417143;1.0132631493834540759;-6.1765955164245802678;6.7528473157551616168;-1.0583843055033186342;-5.5719854638257579893;1.9649542888533038099;-2.1366237105878393976;5.397492967200478553;-5.1052168263592454522;-3.7200101904361959626;1.8639112150889205477;5.6069443423240912239];
LW2_1 = [2.9206783368835935732 9.8202049498425232343 3.4355039849634683158 -6.2236018389614109481 -4.9806425043962514465 15.22813487881326644 7.4755133607792565442 -0.71811884594760932998 -3.4747153490901117046 -14.387107855975854065 2.6187650427734774361 13.536334224581679564 10.620895181356171832 -8.8683000122307849011 -11.966409643882524705 -27.308435029277870143 34.528004882503260831 5.2058555474740604296 -8.7933142100237660088 14.263225461062127408 -0.56629940664402245165 1.5339597527756698714 12.755922061249131971 10.979256997912322902 1.9684461857491810655;0.7506723428187271896 -1.6755684444577370051 3.6826607197762526447 -1.4951640532277647999 -5.704971951723792678 0.28133752089414576503 1.9491529467301567102 -4.4433022397367301082 -2.9446280741845205497 -1.510484285086811207 -3.1987346394416045214 2.5749206022803932115 7.9060780687924205878 2.3637393097542482856 1.7489049788890576043 -2.2481152023146719898 2.9661747128267763607 -2.1382242608076378332 -5.5185560512759117557 1.4847292744008895315 -2.2711881066322385792 -1.9616096547916450632 -1.9670256323459398562 -3.8090339880028452058 -1.6003043469987823233;0.62606191950876588503 1.4117140179216627338 -2.6749587658543849678 -2.5567168709087768619 -0.056687673269742028248 -1.9280338797530744976 -4.0994824946684316203 3.1816927757720390169 2.6510676681383364972 2.1225928364140069782 -13.330713838886557809 -8.8818377724340535906 -1.9086438408506263276 0.2359584091937046435 14.826842972898775841 1.575283246156300665 -2.4674349554045753585 4.8973933027685605524 1.029640316712941539 0.46297267704072658789 0.45307304576610790692 4.6352473916397967102 -3.2835998596269946326 2.9488009197532343286 -0.48784980037219244364;-0.16485130035039813334 1.570318168341581444 4.9257724084697009914 6.2899196120405518329 0.48159480188743419848 0.18536508941867393951 -0.14378360508210671909 -5.1934651489722325479 2.8405617328505434749 2.0164638155868415126 -3.7467752298265000199 -1.2733093659005432219 4.9528269478868232056 -0.29679737946765055723 7.1833645010389632901 -2.0490348286794564103 1.3749953271178962932 -1.1554776014271141982 -0.93559829075303857504 1.229879685307715631 -1.5310218657365757267 -0.30423624710999869203 -3.3511128366374038912 1.1457017493498027338 0.12785241329983529357;0.029569403583585805728 9.3627410925045353451 -9.9877524273421940393 0.21783775035501767858 -7.3625740133977624069 -1.3076716258941067927 -1.3667485481955290449 8.9073517740488377115 10.15440849691434444 -0.66302011821170259154 -1.0595721965226807537 6.5642033821527263626 -7.0544751907106428845 1.2176635600866811959 16.0282046681848378 11.312653002467433438 -10.80375391959699094 8.6713818675871365826 4.2977742264038436559 -5.0392518799824577158 -0.96477912024103762434 1.9182424503752038003 -8.5893289777192887158 -12.780796667727731375 -1.9621610421464437124;-1.2665528926345241967 0.41414550595106203179 -3.9719856149763774766 1.2728012810244848652 0.60504805425534213814 -1.11799256281789261 -0.17251170533141682584 6.9490284432209463716 0.79853830647647594532 0.64989240394395364486 2.2511286003236850028 -3.1098278316068679317 -8.1702454438840543816 0.19353232024531327737 -0.22048431888773903364 -0.17262895252283053105 0.28890622495682338755 5.7045206565672934573 1.1042662556765339144 -0.39649167728028339441 3.6689063176956357992 2.7423836795940483846 -0.27485865929825636922 4.014982946651885598 -0.045445293851440402011;-3.3159761716398854503 -0.70542776982122956664 0.49351437250404273094 -6.2930228414383160285 0.1441225838940868309 -0.036502828267095589754 0.094828324634811292371 -5.9944823253326822154 -1.6311211013235349387 -1.6186627600528911142 -0.10973583466595440705 1.9644894463339357404 6.6641694385049659033 0.37052726449575262846 -1.4952652806747064318 1.2841090196992805961 -0.87244130590290680516 -8.6364794729661262807 -0.45921291973532812891 2.7679642447784522652 -1.3599948350161565891 -7.1884339325427495382 0.33626738417309581797 -2.8293474540600924705 -0.30692760020781295616;-0.26693826786321672717 0.62294027920621775074 -1.4353414364961749605 1.0647574833297253072 -0.78928050601914845341 -0.92032342467108096962 0.32552478214095664777 4.2597905453343516413 2.2059891077607987064 6.3808886872904082566 2.1852883040074404519 -7.6564577516139822322 -4.7795353494239565251 0.48715510364406222621 3.191828515351940343 -0.22117529425928619813 0.18205126556515580094 13.082365597898947485 -3.9731217917991470401 -2.0235513971428762403 -0.94424232591351608956 10.309420025318875247 -3.669318156776540274 -5.7031167107371896208 -0.79977547148391858745;1.5548914104157844918 0.35026349021759856095 -3.5640142609167195786 2.7951305339794476623 -0.46150865522937745133 -1.1334651050630848435 0.18033373858903689602 -0.6750146784151163093 0.24452918492065359168 3.9668967515087145692 -0.3224482895929417503 -3.7171218514020245571 0.87033830264210687577 0.37106172196438841349 3.2667498110089248087 -0.28585320939021485742 0.32140109946427253274 10.835553180366524373 0.43706918925273779974 -1.4324972239377213867 -0.023371282657112375097 9.9664801720356361869 -1.9386194938829339751 -0.434118861831375491 -0.63614204854910139098;0.69815038451897759586 0.40709228296300825622 4.2439024923909940412 3.2477559528748654039 1.6590764427322439722 -12.63330962631597032 -4.5092130775219532168 -2.7276314689747747089 -0.94740319963782659851 -3.9329558509355484475 -14.55030095447959404 -0.85791332922993368548 1.1729351001237071639 -5.319770353112094341 -4.9157431949818963801 -12.480599615068530994 14.765164710123501735 -38.985404379383680862 2.1742863727584453848 3.8076326454097357832 -0.58042789154733887003 -29.430727546699610997 13.390306747506183882 2.5965304286484922613 1.1459178843065134235;0.73346105141382078596 -0.30480041257416179423 4.6199319762337776041 0.16179351697385394027 1.3380859580457116209 5.4963292019128058286 1.5663788101655873319 -5.4325024984620347013 -0.23319107527279578362 -8.1201537282025100239 -0.70037969821662282577 9.663479229397621495 5.7552036815952609672 0.30280882517670298926 4.2399793517660144815 -0.21811989216024285643 -2.3764678150734628304 -3.4139791307831242051 -1.5876097742019146253 0.25601496289057623645 -0.042311074805487673689 -3.7391979993181534425 -2.1690590651472954065 6.5730627513978880927 -0.66398968647845046931;1.8855356929746036609 -0.97621537493227739102 4.7977681842874293494 -2.1150541077702791348 0.72782767940463732881 1.7765500627362202923 1.1775326353745518837 4.5320469222149757371 -0.11738101394874858596 -6.1071869265414804318 -1.1719459321781073857 2.0864591697331245079 -1.887949253353841339 0.72714121357276073621 -1.9297888097152238185 2.3286100414954407078 -3.3773113419572631244 -2.4591528326143823335 -2.1476216398860450418 -3.0136443121751645968 -0.10969503681215116153 -2.2428511582747412412 -0.11323792964594782406 -2.5679859553268484795 1.0231364842176435825;1.0297389101434950565 0.383252694311876696 7.6817187024896593783 9.4036785375825555633 0.60188898472025698094 11.44661944872857795 1.1192516797262028749 -5.1951593672261591195 0.13272902569571395914 -6.6531942418759957292 0.28118152150686270829 10.887486450420306383 5.2443997785960760893 0.10411476569090302724 3.6007200691795353542 -2.6555672017575222554 16.810898501037289776 2.6147691268280386367 -0.6574590043839821929 0.13796562456878316838 -2.6047822337287809269 4.0623198643486189141 -1.835089116105194762 -0.55771442701914819562 0.77429240642870800215;0.31795996393381859013 2.1876708165462601663 -1.4816175076746331829 2.4292237342811642264 -2.5408000402270563001 -3.6408231319168535833 -1.4856551050881630083 -7.257582715237933968 4.7413829382523706713 4.7595484944647976633 7.2958136055721949376 -5.6174055704029832725 6.9442528965562937415 0.53685646462167790904 -8.6657225505290984557 0.46823572959731002419 0.39074577178891639617 7.8759488941941242501 2.0768015157726278375 -2.2783136613995877973 1.1085417147081035871 7.2974868026100798701 0.97683767595663684169 -1.555308232558959336 0.35873992154918232789;-3.7923461028789176019 2.1683229619939909938 -2.7189952685380442965 -10.068149495781504754 5.0276877169752598462 -2.1306956643527286133 -17.223125654284814345 8.0365865043428037495 -9.8072281170518404991 -9.8904006887882029986 -7.5617017675835001 6.5984732644995238715 -17.222119618948234177 -0.066435629665457851534 -11.079457167125356776 -3.3642223031602438432 2.4630046312406155273 -29.304371700795407207 8.9953988059096214869 5.2725744754267784842 15.150052282712177742 -25.124164224681159396 16.056575414765223542 16.946628952427019499 -10.344211159759913343];

% Layer 3
b3 = -0.95700071452609203337;
LW3_2 = [-0.030871731163996090491 0.20076641767607983358 0.17854173579474041933 0.2600507484487825649 -0.047863981790185125553 0.2347183308048952366 0.29286211945980605842 -0.27389396789458464454 0.28389492989447612237 0.030842428933510700889 -0.10454096099376215812 0.14946011206134421356 -0.25796736471943221281 0.092617804624129759783 -0.079530648720933017071];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
