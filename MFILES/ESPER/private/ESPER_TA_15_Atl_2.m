function [Y,Xf,Af] = ESPER_TA_15_Atl_2(X,~,~)
%ESPER_TA_15_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_15_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.4564384456508809862;1.482710341189930503;-2.2380629691412443627;-0.89471937731348627487;2.5081154277961053012;0.38720470287877967186;0.024945414083940648658;0.31738017115015348946;-0.39164416845737676232;0.11043889124256853207;-3.5457302371798906648;-0.94852845881495662095;-2.9234089642540013187;1.563025001370069722;-0.075053229272056778965;-0.92238342556692853869;-1.4875100390294611064;1.9037402012274504681;-3.4536450890594196927;-4.7712055547424974122];
IW1_1 = [-5.6448577931138297359 -2.9019659693568828907 -3.0889741965000587776 1.8309269477341938437 1.5153411548060240488 0.62657099662931436956;-0.060791399986279977263 0.1070975175821234221 0.12878320021611111557 -0.25023633077995161011 -1.497631730840003339 -0.34365949448977556324;1.4493099615696252158 1.6339993155943715042 -3.6219862789112364787 -2.9774378395509715212 -1.6832157311039450676 -0.85271336650999551843;0.73348315118634266341 -0.23340980543734599073 -0.28927917988633633506 1.5162109710759967829 0.050721873962631502941 -0.13996672423772738014;-1.2985622378068188976 0.51807737368206352446 -0.92215881249705122791 -0.94144999838263287995 -3.2354778042585734532 -0.58988570820196506439;-0.76670978837086234403 0.92835488807096366859 -0.35395697629248407123 -0.38786753130086071284 -1.7674399249227417119 -0.2537558636607898932;-0.18488277811980530219 0.17232322127282345692 0.018446886824285559092 -0.21136049176811499972 -2.1462199013196583408 -0.25696911344382022957;-0.10546338703012209104 -0.36547787853423258086 0.94037538208976123588 0.90720067381942992579 2.2522374957590192146 0.38307966765663259423;3.3635560760632552402 -0.78162807159574076987 -0.80490030896351749679 0.66575950065901612351 3.2228797488026468265 1.2557419382284331633;0.45524442066222498005 -0.17695222981938305007 -0.24138297371481626241 1.2044242348525531217 -1.1562758806013371249 0.4163418127959608861;0.24370311024104190922 -0.11899140397242752298 -0.06390094715271567305 0.17957570595284241821 4.2616121547086498467 0.25828109202659038646;-1.1294005620696974113 -1.7535522483317385056 -0.051127812618215320861 0.11379540235713792029 -2.2080299936314404796 -0.1283690901169121934;-4.4180163587875362907 2.7937560379794263987 3.1844811004918991415 2.4343827991150748247 -0.71485127377406465499 0.26848484022271668081;0.17931936669187942268 -1.0728787115449318623 -1.5423625025453258086 0.097032648246429306638 -0.88270823871843173691 0.10639466382768361652;-0.54417181403147052432 1.0994308726808013077 -1.2938649851584189676 -1.0700345513913689377 0.02162196914117507987 -0.34101272141793798065;-2.9773025133776580553 1.0674961648265668401 0.67369999954776871309 2.0806788291638658173 1.290433620427991368 0.26885409210699684479;-1.1855156990862316668 1.1841911497898240935 0.78359429196904373249 1.4583469711823051629 1.6332746827336834805 -0.29581820301120725913;-0.40223341629100817229 1.2629716066401612817 0.62599301972248688752 0.90241343073852986478 2.0539447539401933795 0.33213188392706116669;-1.0572384684830236079 0.53659606104863677434 1.7366268407962792697 1.3840957097961348321 2.7813922598200355729 -1.154582672373040797;-1.9516502510879707444 2.0429714578244966283 1.2598214035204495787 0.42949473258311871016 -0.87220004749230239938 -0.93839171190973647008];

% Layer 2
b2 = [1.732068942455341487;-2.2773968176492465076;-3.7391105915978606333;2.7371067983279795399;0.059297768661727798256;-1.054907728338660311;-0.067407022211302347614;0.874305026511683403;-0.86187963845873338808;0.25915662600641620195;0.84115205030276662956;1.3513356467901462832;1.7072181501597518682;-0.74928087999245551742;-1.2251523032209910014;1.098409421664743979;1.6962811623426468088;2.5517828448790891294;2.9228064606501868994;0.66114508455192722014];
LW2_1 = [-2.3399048809019515893 0.44308265641616734198 -0.73781106736709589633 -0.40183717349004433039 1.7597684248330336398 -3.7311606087326634196 -1.0677959401173331422 1.8745800870939097749 -1.858492187942429652 0.27808522309020178298 -0.54438844167142130814 -0.83340138220496440269 2.9331847982857515156 -0.3265181118426271345 -1.651685483691446521 -0.10440844557551151595 -0.58971052408413227042 -2.6487544106173799285 -1.4422581874002187163 1.3903741426727840302;0.75097556415338206914 -1.3448186771681618357 -0.076633750051064139508 1.1216838213915332201 -2.3482371541729611941 2.0952950739689590876 -0.74576876378188594607 -0.6652891632705378866 1.646471729059769018 -1.5989434280813856759 0.82444523478443221265 0.14178477159293756404 1.0359334967608166966 1.2469132406799687818 1.483002483144751471 -1.3584631199703440796 -0.42444675667890296999 -0.69870093523080001319 0.89228402508542881133 0.1497297809692401116;1.2054223590464152593 0.87310389428138768242 -0.56673597081738147363 1.5724280124138176884 -0.46768755442789866628 -0.26436085053817692803 -1.0632173600445367079 1.2604697087019216539 -0.43191171267820288593 1.7296319202107190982 0.49833477995168656838 -0.69148218641678305119 0.88792231255244302712 0.946792261185785744 1.8400678913106842671 -0.073091074675944667227 -0.22679329391978447772 -0.21423779263144984708 0.7506354129083834259 -0.25481111585094723404;0.35784635945651099842 -2.8615071655092521041 -2.5142557055172654046 -1.3025516009455346822 -0.0097145408194978799532 -0.39268054996854906413 -0.4741242306325891831 -1.3781820864680240923 -1.2933126418566902593 2.0469105305438635156 1.4235871160558528636 1.4210469222488064656 0.795177162936128612 0.705078188631086622 -1.78130418896467968 0.21363525891217488573 -0.40190696373881168446 -0.178283337543879844 1.9353479067304335537 0.035487676126055626991;0.35581401827530673154 -0.46270153157593102433 2.3447629163885661541 0.080034899002807746715 -1.3931195546080856751 -0.16956838552202690984 0.21345139807711135949 0.43707797470651948979 -1.8857173851153821165 1.3375641004467875295 2.1656818306350600345 -0.59116231683885256398 -0.1520388492386044732 -1.0770582006689688459 2.6457828440413848625 0.57434716060988721953 1.2105978405467536785 0.55928681031180593752 -3.9087314001776483074 2.5728227330003470286;-1.8365042172400392051 0.83068788845716801106 -2.0292554256058847884 -0.0052268482996460172846 -0.34794284444540257706 -0.89386901634955207019 1.3282079616097370867 2.0587830353767531122 0.62985368514640116544 0.19148373801717799569 -1.7890533513519522035 0.99080809508351452841 0.15745294463910278204 -0.67722447777184824336 -0.4032860516346054025 0.92698315956702259655 0.29353250236895417347 0.30883605138071867913 -1.2110615448845105657 1.6797123814399570474;-1.7375469816614481644 -1.7071972327911972833 -0.16676986599615958862 1.0215333446932890471 0.28504351228651125805 -0.6910780540527756699 3.6072422229186154041 2.8583577287996009275 0.41971509653068161949 -1.5141245885333134424 -1.355131944262667254 -1.392682746792280879 0.55677725237473962849 -0.17542257814560141549 -0.81729936796213542571 -0.1664217438069409416 0.52909714835679910738 -0.8372705335728671816 -0.75363110538836441954 -0.76281730246656709316;-1.0487143064822634919 2.3437715791521016584 1.6662781178245553715 0.60366898504425436922 -2.8595327545422284388 3.0726377719088349139 1.6658390550474992953 -0.75795606232343593067 0.3551320910700757616 0.13654933291843818211 1.5671311090630415386 -1.722684538810346222 1.3991483131749711255 1.4599247280731755261 0.55355251720426190687 -0.65153565317805028911 0.30817876019549816924 -0.63575544836194763931 -0.76796053281290965753 -0.38996936806176857315;-0.029039691925997417055 -0.1057729251199149012 -0.041741910997966154284 0.91550045789545397845 0.47046295662427384254 0.99287540870280299732 0.077036183294438578817 0.81330780395592561227 0.12560806096511364927 -0.84165344745228332091 -0.19050879988749436222 -0.36057819102166183134 0.56158076236140574977 0.48973229187495082027 -0.63603174985962518395 -0.35698440617447940726 -0.84141951050436536441 -1.133770453291461866 0.25751004508553299033 0.70471954256304203401;-0.94159217125173100271 -0.18956554325478702783 0.67969521865222715107 0.46282824700744823465 -0.18668234510549139293 -3.5133453588281997604 -1.1072769982145427292 0.068782885341146404734 -2.2440051036475350266 0.34192879135007436808 1.462565750111653573 -0.3241840150550677202 0.24621440173551045749 1.1916452828550749832 1.7876933166102007 -0.31572869794159030832 2.6415404817237364554 2.039955378499702654 -0.79511729557477872632 0.37420273957609717641;1.5009998533345922933 -1.6153213974127778041 0.47293026754844025294 -0.10074772845418328293 -1.0362200064499966778 0.28223031032670087281 0.75935097142677387971 -0.89753626701395128329 -0.48688194483433061555 0.1316187052154749737 2.019250755058886071 0.15688287184363530757 0.65663747784328452273 -0.47324982713319374561 1.3323214198293784616 0.52928246723641092508 -1.4804209638211063282 0.80040475846367942214 -0.16461730471477437066 -0.6767481742312073667;2.0448021182953932673 2.648520921743269696 -0.46514779232705161238 0.1826118889860014749 -0.15775324450147865107 2.3663296537780773576 1.3753226273611822705 0.94367889710700936234 0.18902838133932534093 -0.72557863976958791863 -0.30529259506255684853 -0.36465942795822059441 -0.13282026863372195513 -1.2891414060384256413 -2.5707482351460959613 0.52151618395928978078 -0.53456045232551829827 -1.9583716366542907039 0.62280432901226268072 -0.7793248703639223951;-0.87694030016927648763 -0.21809553466422160195 2.616048539170621634 0.94276313252890187044 0.99965651769203744959 0.57784407419182026722 -2.5137775252326712838 -4.5193293349392238412 0.98420610562960564316 -0.81348455448682022162 1.8925493295040352049 -2.4319407678805622375 -0.10055239252947036077 1.5737623923453996078 0.11480840826259038068 0.58584580149019549467 -0.26468808257809173234 0.92664255886584623312 1.9606663582043095673 -2.5780546563108721614;0.061772362180487927485 -2.82308961730723329 -0.30402284898352460729 0.69121903940726936444 -0.2180118045098988766 -1.2035002198850108801 1.548011477561491267 -0.45576463434430791732 -0.44983247903117429267 -1.4484786917637459958 -1.2545565712359627586 -1.0143478323602026503 0.30732570688337651488 -0.46426519530593718388 0.23907702460526103483 -0.43458699484440310723 0.63871284965078323204 0.69564826254263967265 -0.4693891663851201268 -0.43469029167166262084;-0.61031926056568730488 -0.019744381695512812358 0.48254165843758678456 0.54120029481619613687 -0.51052168018238930358 0.14604859002201731055 -0.21654887753895435409 -0.65065416669941156247 -0.39956681463108745245 0.3533750451511267765 0.06298594362656718959 0.6401782111027379818 0.90688777725311930933 -0.36617576476207269742 -0.088490836743262316078 0.20262412453251862909 -0.12725129095042220229 -1.0377419388015427515 0.41966017783853393208 -0.012628120820560802956;0.43290226694111594297 -0.014947899864755609736 1.5113861714568759265 0.57658418198680216893 0.86126520786304461286 -0.14586181692703037438 -1.1826424673425057765 0.62952378354979576791 -0.45359703438648929508 -0.52040919039301614113 -2.1393397787463128701 -0.152447837448146023 0.30947383836697645032 1.104822726462189264 -0.40725576428126092354 -0.019839223114933416531 0.11335492516179318523 -0.63051042493708897574 -0.20423204051629806344 -1.4016000638624477315;-0.77032706900456116017 1.0841355809787696085 0.53740491548429647484 -1.1442897294467280211 1.3444142474156886014 0.27347424700114142393 0.63690598698441669434 -1.5448170699962242569 0.32779688018541697225 1.5414642691604356628 -1.3032803508209709342 -1.203208256772607232 0.44296112961172412481 0.086797453956678261022 -0.064026262567964370431 2.0315599109924717958 -2.7367171286478040315 0.11532933331507122521 -0.10368573877446962683 -0.70660135419165082116;-1.7264781789443732762 -0.22125432543580483835 2.1618738829446231264 0.061792587021823282278 -1.1621327453388377027 2.5097840146111041193 1.7581957553507845393 1.1830661750978890279 1.317857959529466827 0.27685340147771458907 -0.88734957275625014894 -1.1372270899667595856 -0.19804141123191171259 -0.49908635546587581944 -0.51838355474824893143 -1.2882820932963507943 0.75179292912238282476 4.0117926419548748385 0.61702980248335015379 0.90003617586061457345;-1.0597359284309970651 0.77695079096530961227 -0.54699210486654814556 -0.066001530640791714055 0.98916924481805790226 -1.4076943341051022518 -2.6036608926085276217 0.7521800245885711389 -1.0138525814685586113 -0.24355560930735578595 0.30501768882463725641 -0.90106282592290420919 -1.180878642683250046 0.59462163532714507053 -2.9183224406596659506 -1.2517450954097442128 -2.2334364206124019958 0.62304991058544867411 -0.77376973330126164186 -1.3033466664743573737;1.4304928433871109128 1.693915016201131607 -0.84071939978896814694 -0.21504176899612539864 -2.9861767095380740145 -0.27058502222381702884 -0.44774927398030578418 -1.5675824326349292459 -0.99919662608184667274 -0.069092014798638967665 0.74097294578882555438 1.0698773793245333064 -1.321848112350473281 -0.9631477223648217123 1.3135079055045628671 0.22642359516413659848 1.845256332905978125 -1.148697461230488992 -0.047865068872108465503 0.17505159776601017518];

% Layer 3
b3 = -0.60353637798430326278;
LW3_2 = [0.075744328353739384663 0.23922564363116877173 0.0016727481653401523199 0.011326239677931509639 0.018462378447297811412 -0.24730829624740804928 0.39769930835091865662 -0.076021092323960690051 -1.6229781736987325402 0.070280031289474492739 0.090918147854758560311 -0.018558001764161724534 -0.084840346288557660914 -0.46170534226260645516 0.80242952596244432328 -0.41041860563949428276 0.08474915146471746763 -0.059754928627107815886 0.83504769295362601955 0.096010851853880085915];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
