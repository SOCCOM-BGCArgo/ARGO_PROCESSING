function [Y,Xf,Af] = ESPER_nitrate_6_Other_3(X,~,~)
%ESPER_NITRATE_6_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_6_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.4464911507840625404;1.1586062030712018789;-1.1323996564448302049;1.0959009137242228249;1.5455854161390487622;1.2287037775449536348;-0.82792398848681181267;1.1062876966633723441;0.81784533132850867343;-1.4947311007871115773;-0.57267451778589228972;-1.3279393612433665339;1.1166795974181136231;-0.39932153852859236798;0.42801107052097553396;-0.45143987278175257138;-0.23176575345415667551;-7.571359449740998393;-1.0405670251344381061;-1.0899276943900457759;-2.6911564276641395388;-1.9870788081170815964;1.9562316842072986489;1.2009503462358510628;-3.568482077129017771];
IW1_1 = [0.67716558777531654645 0.39017518754301783179 -2.4495013576778710274 0.097998236893045737039 5.6855474619938464187 -4.2675532646684377625 0.80651999951506503361;-0.068823453419917648977 -0.2258346843520290248 0.15610939768853815401 0.37256003435686507741 -1.0559345820311136777 -0.51427915483090402837 -0.73143603845729787682;-0.13365553300705465545 0.33101840280664479588 -3.2268366968661861272 1.2145820149944139832 3.5044502406510611436 1.4935788751274652331 2.7492031992627032899;-0.31734156956134007554 -0.31823933413539912118 1.689397329428804051 0.043695646912423752317 -0.37166163636812049598 0.99256408788575389845 -0.24935846517840981607;-0.36190577195652789966 -0.25729566279787924321 1.7310157907419507772 -0.086181585725081999438 1.9929441050258402957 0.97006453794325164797 -1.357952612045226326;-0.78682454672675206098 1.5049439676974531999 -2.9978112864953248007 -0.74605754189257045272 -3.8998574643536887407 -2.6997775196015685317 -0.60622001677624448579;1.5137952469820008528 0.5757799957363809451 -1.5634405662411334781 -0.013185887510734498398 -1.0197012326472196797 -0.13976409968703268349 0.17978485410760608465;-0.28457025118351447768 0.62455249416959512931 1.4189514352355883098 -0.32896249018588696877 -4.2316433216310329612 2.866190300947967895 -0.41712028164322517698;-0.051146520286343803707 -0.017888248254879227789 -0.42473880577164835337 0.29219939412219719799 -1.2717552800591058748 0.17254441069340084591 -0.84457071330996547065;0.21279097246318343095 0.32866511560243905077 0.94293758798119620135 -0.28709822855710265266 -0.039952971448381328912 -2.8329001558888893264 -1.6584128749139672721;0.46987181987739329303 -0.64519124944866701465 -0.61546753245263863263 0.022403081404833175699 0.26296533949218720005 -0.14850898321918731826 0.21919805212852744303;-0.4038820765990352446 -0.31791627805250510796 -0.10387435625017843455 0.43809730930492873924 4.2839622709030251713 -0.12979076731449673554 2.3916085093426624475;-0.2683712746239083069 0.21742217902293120568 0.72357955203447288373 0.066533259501557764914 -1.0430377626031566152 0.74372904008612539251 0.2739631470864596352;-0.66336522639160933057 -0.20876072437553858108 1.6403687684366157207 -0.28673664824750860758 1.334680150529542475 0.78238964513322795113 0.12173637226252408128;-0.2454377999765666174 -0.13429403446077417539 1.510616739057766722 -0.19158150308274124463 -2.6104620232619581977 -0.23218676233269536224 -0.92637504525213476558;0.0052696895787442583903 0.099869626329998642533 0.44085629026924488816 0.047000748991582519398 3.7782683967381962553 -0.18384165773116306619 1.0644752307229050636;-0.076048167662424115409 0.029564632644211521345 -0.09562907792719031741 -0.61280844138210577299 -1.074800210159438052 1.0677825400803344635 0.2016549170256744794;-11.38958205098881038 -3.4308851450553286 -3.4825804060735929824 0.082451201665398696217 -2.0969439244208056827 -0.49138272023863738269 -0.33524686204631226616;-0.060976298082292934577 -0.096995812077356330372 0.21483611952104286758 -0.092528984213358048128 -0.10436956535226080134 -1.0101625642052394216 -0.26095998547437437853;-1.8996023586305152975 1.198495680767735605 -0.10513271999182795258 0.76553208007990281025 -2.1429296583755137462 2.2159840137882778066 0.10779554584569300824;-0.3623179466250207037 -0.13316644198726840242 -0.93061660288606007363 -2.153668622297681523 0.2084804266010585605 1.6603102206246136419 -0.11703818978416959118;0.064198550335952425661 -1.7748247980194191697 0.68557609157143939438 0.21400622526619431096 2.060885988964777038 1.5344085560420874792 1.0077564563315333235;0.024494426071552759944 -0.078918598006568724257 -1.8662386572400151419 -0.31162799731788498603 0.62721420560709084668 1.3245894613435265086 -0.90556782723765683052;0.21844892943942884056 0.082523985082668532831 -0.043405987689151472042 0.78551068097084630892 0.38580603505155963706 0.63066899213766125509 -0.1616228844892608485;-0.11932245182902463665 -0.14863093530336912718 0.60083367428761780271 -1.0680819825993563832 0.79510069333026700544 0.34471980857307965573 -2.2092620731895804553];

% Layer 2
b2 = [-0.71058119370530603565;1.9645951735369746594;5.2347063319222701949;-0.83687695701811415372;2.0873195466992027214;2.7152536145468020301;4.4865964443158432573;-0.99949715148999229708;1.9229502284117208077;-0.11677289317519386203;-3.6596730206742371649;-2.4787759346212316913;0.98491186073388525823;-2.5081807378431895117;2.4817967244071534871];
LW2_1 = [0.51343302376653254804 0.080551826580290780688 -0.49713140801005639702 -1.1001291243565993749 0.23551765026623322496 -0.040109366582512226418 0.24871756752077686659 0.4545534673162470729 -0.5257371788380168498 -0.55531632856166757151 0.036116192874196595408 0.91606527523687386605 1.4381315718284439775 0.41964832195195073128 0.43591486361054715415 -0.70703117590297115402 -1.3140686496063171962 -0.16687408049460628057 0.067916231865471049511 0.25839897643222692336 -0.32465541294776223413 0.69469677208551638969 -0.017085628791035950558 -0.9697359202555581037 -0.8879117030086070006;-0.56178501109676548531 1.8849269108259030236 -3.7221998301347478666 -3.4322925320261226112 -1.1535031470920178442 -0.7497553450738372316 0.67785994872043087156 -2.2087037521592955969 2.6885900721792155288 -1.2625419766218182183 -1.6187415867088497112 -0.51859800260213151368 -1.971014900564682204 -0.15713917054371706605 0.91492213015188672554 1.0032952740134803982 -0.68009920311705673868 -0.10373456960981219943 0.99169033419469265755 -0.14866218868913727569 0.94917679649976338663 -2.7335544921346333069 -0.64337884970285064146 1.7813594378198374102 0.30395729915327290849;-2.331802050991391706 1.4194172938493068159 -0.22705716658682395526 2.238081831698653712 -0.39466785298376722002 0.4040804246475404593 2.1157948555112322531 -0.33656775323793308718 -2.3441734122960631304 -0.24492061990857810772 -2.7792639901932250091 0.16133380854885218114 -4.0010547779645087019 -0.94638294985871762588 -1.8772350911161044262 -0.61844988712965320854 1.9359450307813619307 -0.047724142413297920839 3.4325243431320200393 0.50564974897427916734 -0.51127053592789162284 1.4054370341919464327 0.81528944137772640932 1.7085331893718669338 0.68302738885260416701;-1.3053747290379504875 0.78172458997933003122 -3.1235125848524565306 -4.9914752158169930496 -0.7653845364209067581 -0.87707534023861510875 -0.74375356287779947895 -1.6525564537767238882 3.2609801806463383222 -0.85871198623044719955 0.8027573265248421075 -0.76964927543856154202 0.40653761707774482836 0.20315385057264415125 1.3320982324443721989 1.5006945001558096298 -0.2161262168449834542 -0.078619787569401730631 0.55868708569458458424 -0.26488353229750494222 0.85500001470338682363 -3.5611081749213417957 -1.1565193898779857484 1.7863706143974946716 -0.44008790540740838626;-0.53158128211832433863 0.46664154071601843254 0.70244099149083905065 -0.09392644855683800198 0.14898801681069576142 -0.11854929299807084875 -0.30252351534079119366 0.040948273991396270943 -0.030337394808153464454 0.35405514865046644468 0.47260886166891447058 -0.67588637413604035764 0.38230872102367174925 0.44415666551268062623 -0.906403679113065186 0.45718492112870490196 1.6081808087978046728 0.083278767405970552384 2.2887570394562670728 -0.020793746374863392168 1.2262627133733354778 0.14219163933293360591 -0.50370518912890682728 2.6598135864970138265 -1.6933368183737214085;0.023531568027588881803 1.8628146961197804554 -0.0055516200873522341189 -0.10627965844307049603 0.54116286586719530849 0.39732711744840332191 0.091054411102376872633 -0.097921665954866482506 -0.95132513721211497959 -0.13918707005715105773 -1.4479419074042985116 0.45999885032973925059 -2.5505739825931543763 0.53756209385936504219 0.035857439364397641901 0.10406217995927802278 1.1729165231572955541 -0.050670595107824165093 0.86461350847443885215 -0.017538261964452135644 0.23124988731519957597 1.6405281571722407641 0.59345070546367206799 0.21190881551560236673 0.97215013824722906755;-0.57785371969756960109 -0.35223156693476520562 -0.15142760231802190884 1.2657572567121171403 0.24137785133993039377 0.49115932959628216814 -0.00088497422419224719241 -0.59382345955664062043 -2.602749750369504067 -0.0811249685302541379 -2.5201583050743803227 0.0080187440613674436374 -4.5263509772118819541 -0.51952630988004844248 -0.6498821264561417399 -1.2742952090974684065 2.5430445419453451272 0.06020006328826619374 3.1105181163125616983 0.24810089431093348966 0.35589946124137961103 0.53584706374712187671 0.43557262566335214204 0.80720673518356711451 1.5291046918021875545;0.4338735730320895656 -0.22996913094091317453 -0.41305359772578920108 -1.1420506227293576451 0.22280941156373607059 0.14903813592751910533 0.26643501057103896601 0.3019374269437742897 -0.15360061127784041535 -0.58862500871102163558 -0.14767697477656169247 0.79015032172380084141 0.73150466190729912519 0.58309496710302566314 0.88781771231666428701 -0.45601776055720949499 -1.5959567559468363918 -0.15730865383146869219 -0.93445275600314969822 0.19066857590998906313 -0.37828368594319822238 0.98498227151628270359 0.045917838664924992553 -1.2498400014891306586 -1.1017458991496102971;-0.10116566086558499704 -0.69652768287387722967 -0.4097745110337299157 -0.031898051555182597994 -0.2194471476922794928 0.37504605254826844929 0.087209412060817753654 -0.33763703015550106112 2.0818309021738108378 0.64813268203872054229 -0.052769464426601041251 1.5613053198255635312 -0.048371584795865001094 -0.69934430723194063173 0.17914484085179166462 0.90858376219207592772 1.4491122187210405681 0.068381394018995608763 0.32998586076705604953 -0.26095521086258499643 0.22255592878637514564 0.33044935872781888708 0.25552662848463614242 -0.20406714316008445209 1.6064612465691887611;-0.31005807899240311887 -0.37542376089842582898 0.23580145595476395548 -1.6101620564006584591 0.85448952731366700775 -0.24652628052357031252 0.34767705619132044381 0.42916336035550062267 1.2886583511449971606 -0.35106292308394893009 0.56540531564285134714 -0.83274809893528167759 1.1200976722201376745 0.25006821407497897836 0.90252824995949021414 1.2629260530679553565 -0.16923527157477694094 -0.059297814392514976156 -0.10170045584313924802 0.016958907328431895023 0.23321354313925560242 0.32138696221676821274 -0.13857227308678654598 -0.34924227665683793553 -0.76322401589197175209;0.91603939148002611059 -0.36848022516967399165 -0.48276661027766071266 -0.17740677054417805514 0.094784177604842700937 0.073802621707805410312 0.0072853022625642008606 -0.028911307258546868615 1.3623217100106435051 -0.5270622937597625457 0.72961804768988469672 0.41305199273883241862 1.0551084479249674963 0.23721080469926181244 0.36480361071905043069 -0.091579024873878256408 -2.0625800786143857479 -0.035133659802577259235 -4.0904302690624882999 0.11976197253866925629 0.59684486611302478565 0.53580076008435950641 1.3886160086333763086 -1.7869945186161135808 -1.4582860112461299984;0.54579863857750465783 0.080862285537814299063 -0.1421922433897092608 2.5461458438788242553 -1.530641847314694548 -0.78109185012230952783 -0.0056865604495292491199 -0.076187142793461767876 -0.082697003046440814567 1.9994726958806019468 0.8992726928534212627 0.039235330628163735123 0.47337112360351502049 -1.0850994756027345645 -1.0897755836424516396 -0.29054349292029124641 0.79982568720365088133 0.037599184059292072024 -1.9532444716787540351 -0.38283403107096625195 2.0436455234547357129 -2.6981309574344485291 0.20139374444352586835 0.15915899785040729664 -1.7345427257664745024;-0.18798155542308200849 0.18058683644404946445 0.25203763276591223397 0.63529470951444533267 -0.3982875718004108001 -0.2505221326573438545 -0.11426574852122975412 0.076861041928596940398 -1.0714206794338143602 0.31660221910609237517 -0.23790917658093632681 -0.74132814719865258724 -0.28980685413101675563 0.074867621958394525716 -0.50193115670330301636 -0.69422418007982245047 0.092003323331487932291 0.015789754215657484521 1.2476301905975792916 -0.018028945818360918307 -0.20145791708356239336 -0.81062198805440510707 -0.88856421216084435777 0.86907687068962469201 -0.089882122258590269048;1.0154774022638413111 0.055997690263564582625 -1.1625783115134433743 -0.51545966480306282254 0.16385141143894496607 -0.7433458833038232294 0.55130350879069278669 0.37922969005875845072 2.139077259730502778 -0.32595888164099862117 0.75318421186512762855 0.80584837924481966809 2.6474653770116343132 0.18910715151792006905 -0.072483915298077766787 0.77702732026164700319 -1.3919069253404434683 -0.15933096038538641093 -1.107443417987073131 0.29312600078753403565 -1.6536890033220112972 -0.30280997770834711114 0.53806982495041377756 -3.3785512060057127925 1.1871808252071462952;-0.34976808883989712884 0.67162970053469905896 1.4290147991568502572 -0.17942757797396835517 0.36709391340124924996 2.0407990978533798732 1.2167532205200755069 -0.81171692018187113771 0.81577067444301232246 -0.22861445212615727485 0.67791743601727805224 -0.9304685724708101624 -3.1705914122637439689 -1.6790734626744665547 1.2302935778959851465 1.9686262584013236587 2.5882972150144700763 0.44628774358356676499 -2.4604621345394828147 0.20079536151124879884 -1.7904208913728985042 2.8698151755960545906 -0.10543473253944804502 -0.52867332332712968501 2.9853863629890375897];

% Layer 3
b3 = 3.2099679057432894957;
LW3_2 = [-3.1608344176855807106 -2.7759182656872378736 -2.7260410528630800719 3.1386706679904960993 1.5784867450112542997 -1.0875082203278998438 0.56313665283512326365 3.7361359477974867005 -0.6353686088513774699 -0.85006373377654775858 -0.63520592462015701418 0.16350416083942695411 -1.3907857567988968217 1.0735962328801038623 -0.056365861470480622952];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
