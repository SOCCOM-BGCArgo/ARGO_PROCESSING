function [Y,Xf,Af] = ESPER_phosphate_8_Other_2(X,~,~)
%ESPER_PHOSPHATE_8_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_8_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.3418429684631156817;-1.5706576486399841386;7.319765715668592243;-2.0433282336061404649;-0.54519645903457691904;-2.4759188010766166599;-0.86594241725443665825;0.23717092257822303125;-0.9603892069287200961;-0.29580233750503515111;-1.0505956935142850561;0.83143901944029818818;1.3745845147233690664;-0.51155726655272348857;-2.0033493371085500101;-0.53597681546559983179;-1.9807060568844911952;2.0039816579646512196;0.071056788219935412831;3.5784083727303124256];
IW1_1 = [-0.25200950036937169729 0.37155043689573974408 0.89590936742925886271 0.073782997351024254273 -0.67214680405591820112 -1.190071276405984646;0.38818992627967296993 0.27993404131838356408 0.85418844120778980589 0.14665044127558693465 3.1902482260158904204 -1.4679230145322847978;-0.83407647185136479795 -0.87510764687965758579 -2.6560869375945959092 4.649575409371333734 1.166909592413970298 0.74994761047172830981;2.4682954930021496764 -1.3137927002782570085 -1.6597087147221811776 -0.01054361025313946959 -1.9907088073827745589 -0.027905590617008133036;0.46183839047828789681 0.83892806941814979105 -4.2538787364704226945 -0.88462989610915909733 -5.4791206782677077669 2.2738407316386246571;2.1455436302705859219 -0.89652165526172278298 1.5837062494348168595 -2.7132190585457860443 -0.065305301445387042847 0.22683694654322864026;1.3910830322406158022 -0.61574102459977664292 -0.70609600576219744283 0.26593808500897875291 1.1874450201661888027 1.5924924491056411391;-0.31678744035850797678 -0.1884248123863906943 1.0458834094741908949 -1.1706813601122942892 -1.824579781200887485 1.9898993815483687619;0.046164381576769060456 -0.65565338658586369558 -0.66732198859421143489 -0.65144626110673253816 -0.065494073389123524942 1.1969210168207764511;-0.30271227527209720876 -0.34168832015633321397 1.0703581992511899124 0.34991203519169633562 -2.1590262913350333207 -1.6390594180714603834;1.2769769505809009935 0.78140959209535254537 1.2117321268431422432 -0.92794670403847812068 2.380197189762076615 -2.7024348359974923461;-0.03364168391302582023 -0.0010492349719496275699 -0.54969579268811996631 0.097906572805321334663 -3.1538176178841732522 1.4266230302439220079;1.3161280650745319498 0.82498879283682491348 -0.68724015146800554454 1.6411292306487312853 1.1400146076462107647 -1.2772739933107473131;0.064789119033298939176 0.33225969502563318381 0.82518075223621278891 -0.020517176488924645378 -0.34036659197940299926 -0.11069767878014399876;-0.10451684360081463232 0.31237855939312586528 -1.3916159117730819705 1.6858101530316911276 5.5993052306590094247 -3.3279716822006499832;-0.036209514875069355455 -0.82058030508942381154 -0.14820723194736193373 -0.14841607958520400268 1.6180132007582435083 0.82615935466949341759;-0.32425166384451586943 -1.2620183267900877411 -0.18934463089912087486 -0.64148623086097844581 1.8281224528690365183 -0.33766612018973474196;-0.0070833296956168308178 0.42726673420626748445 -0.45668414418887487427 0.66438366713450403012 0.53675561044198427663 1.0031494895167636372;0.10925464939344879667 0.1502540117408156517 2.7154736355847322038 -0.09862480498354951608 -2.568832736700244368 1.0304801103607259538;0.14834633264656710283 0.52039309213965201373 -2.0989888052150758035 2.4727514266489318828 3.4224345959490070079 1.710864743195133153];

% Layer 2
b2 = [3.5097307781953084316;-4.8113096685139575825;1.2384811107846411815;6.2751361544586528041;-2.6329342719061235023;6.8843705607911713784;2.2357671684836515347;2.4237036490863896887;-3.9357140524500349166;3.5523314389810276559;0.93420601727005125881;-11.168104460424517654;-1.1466426468024022434;-8.0307169883454108117;-0.050985487820854193119;1.7530898258389044919;-16.199243980486453864;-2.3054979391077057294;4.7025090729935925538;-0.51570930306632989382];
LW2_1 = [-0.419849482023662679 -0.19867783146543388506 -1.8512154618025937758 -0.033118514511136759593 -0.16339069239998027516 -0.22495888032689226321 0.68900778157310749172 -0.28913539177485203524 -0.79603034821086415818 0.46506218699209922463 -0.10612195783489668244 1.8117195119145190763 -0.0061255544240101707926 1.7816515796049972042 -0.22599554590164006029 0.90772468211333701138 -0.54139086703054983829 -1.6224859304423169259 -0.064299231678854429362 0.17452532740285528479;-5.6720620723219266068 0.2618088786884686936 1.8220216780500468889 0.41338030537938807996 -0.24035329689667739306 -0.12054423416292947557 -1.9780720455214060305 1.2195713627464732642 3.2624428705541026474 0.54718770079861367428 0.10023553498524913341 -1.3098367390709482194 0.88300707580542314723 3.4791040944310509531 0.83655976596590220229 -0.65010585029893963593 -0.49582987915526838263 -1.7067621432484665345 -0.5318082629101800185 -0.13825346787101058799;-0.13787401555262351893 -2.1270482759208952928 3.4147548611925810924 -4.1933315715107388755 1.0099247387078229554 0.063108308257575365663 0.47967425940972385767 -2.8095319189239682522 3.0759500064989504509 -0.25137355793549998051 0.53617724647728948195 1.0078634027249373517 0.37769766151548772593 1.5017302505512710731 1.5582646879302983756 0.35253186140149467276 -4.4878930910289387413 -5.7531877398008557378 -1.0891656656504866696 -0.24631732266542907817;2.8266803935284370297 0.38939814276245282576 3.4476591844761590444 -0.15484784762665865232 -0.98858644353007507632 0.27112637978536935357 -0.11110976207386799586 1.5116963206492364247 0.80403884908650657959 2.2960173869572297889 1.169068493116635743 2.1270172276449872406 -4.2245265919878027816 2.3670202153173183213 1.026134105359012505 0.86631167271563280785 2.8133950763899195913 -0.56438408410909302049 -2.627498865158533814 3.3293990532494190937;-2.1691539804484420983 0.35834124833589392489 -1.2552735095732217019 0.2261856456307937413 0.40820940339119204943 0.3563087000449813857 -2.2352468576729225269 1.1422944431778945251 3.7086325707835694487 1.4125647198234143609 0.34255826675852163454 0.49655405452868739413 0.29329518422807504541 -2.7937545320936250093 0.20510262841238852127 -1.355889763171353346 -0.93806350027581475448 2.4844271243273809979 1.2218253492746076194 -0.19066253647053593712;-9.7234763563684403209 11.388446419442532331 -0.66099895736421843129 -1.5207785583811348484 0.91817960286369737499 -2.2244651029196695902 4.4635734422331170279 -5.4270400455442437959 -2.2521545586169993136 -2.2591909959124492069 2.2098721894660977583 7.8506439305490554048 -1.3302751533474421741 2.1191971438429226815 0.80159823000787799874 5.9137638631516216137 -6.9620953200524029469 -2.1493001305698533621 -1.7470767407381628811 -2.5648096837473399745;-1.6556330604113826954 -0.53965212673332019211 -1.642635786626593708 -0.5135751839907368721 -0.45339741836370006656 -0.06180566559890271483 1.1512310921641026873 -2.0313102161221232578 1.3174857501137768878 0.95217347915803218772 -0.58134310563887414691 0.15254385505796919098 0.18833860157794868329 -1.0968551455985213749 1.308988445861644756 -2.6447121750216999736 0.11200481178827896567 -2.5208528657915025839 1.8979417690930353579 1.9472182434691696074;-1.7709619351045917668 -0.49493803399666885801 -1.7713949743847250407 -0.52327479633080642429 -0.47325858380609775455 -0.078259837217909800078 1.1447916279031560283 -2.0475370646606689817 1.4342129362689270966 0.9346881769897585901 -0.54945967882985802255 0.17473574821657009148 0.16927220947308252441 -0.96512530588835421241 1.3432801782652634692 -2.645886468182803597 -0.0056444507286763263842 -2.6338580651345835371 1.8187747595110277388 1.92479557073134111;2.1986808580424757054 -0.31212733429469413649 1.649522742109204021 -0.39691227053902744526 0.14163124093411930127 -0.066360432826628706904 -0.88212582807348338676 -0.27554950389582838488 1.4370796372750573866 1.4809721744180182057 0.26680638833146308464 -1.3562127029852639737 -1.8449346761656897353 -4.6725490893477221732 -1.3544070487016623971 0.58342830809062951047 -0.93301505568564746529 6.0641100027955472385 0.74756392710869790097 -1.1332660487474657263;2.1183861789367584016 3.7451822008920974127 3.7144113400768752342 0.48274008849861682613 -0.043319575741890249676 0.25584321714547986204 -0.023317890737224740427 1.2549408549789975442 -1.4111402183105614672 3.0831860919301381507 0.54641407497446103925 1.8241045138282037108 -1.6618389440967908932 2.1992854778072201682 2.7405313963126483046 1.5648229372342512544 -0.23282679740898790111 0.21339814535571000054 -1.7195232535385436279 2.6240328945299946639;-0.92721048997420418836 -1.547449367441112944 -1.9183547644553391454 -0.013292370435814966981 -0.48388530232014254073 -0.40603236443671653078 0.97462737790594333731 -0.27351132831352453767 2.3434273843190016606 1.3396825831183960531 0.35580200676725443065 -0.2751780431078116318 -0.62517377385425743075 1.7476395050244069029 0.40045256921875499456 -1.283190973529871215 -0.96854239905460837168 0.72691972053052045233 -0.63082842397623484221 0.94655546569892856645;-9.5656410358941705852 -9.2503434193865619051 0.82060938636596691964 1.5145665151619054356 -0.25274862029486722115 -0.37836674870298081519 0.66958079295929540109 -5.4190515229423299459 1.5169298513583704402 1.2617464466443182314 -0.31346739323663019849 -3.3180526458446193416 -1.4407009865498543455 10.31618275195394574 -0.63386213677759495333 0.10336291834078108198 2.6022055669432218039 5.2439953701650585671 3.195910745049691748 -0.95193584967244371242;2.1841625891513545277 -0.31725281507731312169 0.99861903431917098395 0.30245591837003882318 -0.099275605988604062602 0.295903121437652461 -0.45682611838655745595 0.25190817284535460541 0.77126487318197078924 0.18269410830087454145 -0.12118068482662269769 -1.0187235553947822098 -0.26230827833716535702 1.2122050728930560126 -1.5833721869211803135 0.042186851264029913422 -0.046817153766559621575 -1.5034001418788422999 -0.88413376992727676917 1.0649714904376359481;-4.3411928585866093044 -0.62935476197528916753 -2.2058656670453737902 2.4572168920956394267 -0.71637742693157691054 -0.16374107406920290764 0.15042246684307622462 -4.5699579331965605178 -3.9419985953663418954 0.5865369981354152662 -0.14212880041681677512 5.0522834154254940842 -0.49496838325527697799 0.86826232116150114937 -3.3980199743277617053 3.0236864357908705969 -1.8759369904185074773 -3.1244474819778393915 6.8174456857335794524 0.98492404495898000505;0.76159942878611885941 0.23350861075801976341 -0.55555096151989125097 -0.19626112391095118515 0.55704898920347656333 -0.010703378615455134276 0.5730636408936877757 -0.2073344915795484189 -0.11919561461242150768 -0.25868047092874602022 -0.089448278018768381803 -3.3248830090488086242 -0.11109326940250974225 -0.3214110785520887803 -0.38263376620949529627 -1.034314363193623576 1.1879939116180386893 0.82151024128566141336 -1.4318885736277757736 0.58662067650037297284;0.023796332685096257403 1.6057427863264051027 6.2387996972295214348 0.33515795065535808339 0.1867250651927991334 0.42448526329986330241 0.20920458078365886112 0.89839272167440253902 -4.8666732733426796287 2.2507007084054970747 0.10504988394302995636 1.5808503805968194822 -1.5342261164017849673 3.5402571362265304877 0.031654219997402005538 4.1246436035994671343 -1.3068534454112818999 -8.6563599880125519093 -1.6005700304427092906 2.6920981087070430249;4.6622492245850333248 1.1990168842539989935 17.808676255441827863 -0.87714545702404767002 0.26009169661182696132 0.32722263802404788491 -0.42700427904932802825 -1.1571244752940232914 0.41574938488798862668 -0.95926549262216875835 -0.13548132910367308157 1.7562105621936208166 0.2729854779718396407 -1.6975713578476041565 -1.3080255522171402305 -0.13092100466354791855 -0.81897889939823909078 0.028213622198019899789 -1.9844784133011743599 -0.90524086642480805498;-0.6137157091255023289 -3.8793396565159503631 -0.067110253315865023294 0.45359475145572142329 0.86493155499328699953 0.83806310568807906858 -1.1245394251068698832 1.0556127713048188976 -2.8906821995839711015 0.58180294576762792147 -0.76777965412870319284 -1.5608838896356811432 -0.55287134691945671872 5.1577195389857282137 -0.6631943208274607704 2.3368014424984333566 0.17055651123700463212 -0.51661230273275082769 -0.69226417212249591326 1.5197529180433915208;2.6030649917616912603 1.2656210772561828914 0.53314034810985411195 0.27534763127966932483 0.13763183375123264063 0.18507113576930622756 0.98378945400304695923 -1.6646517294283049715 -2.7972171234461975509 -1.821140767309139985 0.37338068848286759538 3.0511744030367333735 -0.52041526050411412996 -1.6257516345749838393 -0.27446173359790954072 1.3347695816864184604 1.3213674724526085491 -1.7412900850794419405 1.1057009354784774757 -0.64585762525566603465;-3.3755485548354715597 -1.1950369077855176325 2.9619651398806587927 0.11136521420024435292 -0.69027965050555106785 -0.27617846747073332425 0.99853428029346202877 0.40726090672555392835 -0.12673434965110308426 0.90711938575287920372 -0.40536562709103979296 2.058698471972000732 0.53633613131419122233 5.0620608394811332786 0.30010993851726314174 1.5742034096628969575 -1.1829245785496615984 -1.7616753544039658319 -1.1200422601814488122 -1.3650181657120341594];

% Layer 3
b3 = 3.9533444502223122896;
LW3_2 = [3.0628982945280709416 -0.51695376803935222387 0.60729005647067679785 0.63029642831574528294 0.84524676885068383836 -0.27123788743722493377 -9.1001389503983354246 9.2718451357452149608 -0.6325378260901146632 0.70346206621712470408 -1.2608839520306116544 0.16229833272875460182 5.8949886980198256126 -0.33057560133566021854 0.88517333803107611789 -0.30863944077964322599 -0.37608799288033611941 -0.41372913461727217621 -0.64901694815270472017 -1.3285622977384887733];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
