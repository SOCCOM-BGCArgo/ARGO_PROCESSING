function [Y,Xf,Af] = ESPER_TA_1_Atl_3(X,~,~)
%ESPER_TA_1_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.9738221379087459439;-1.2791124547287564539;-3.1334724495954309198;-1.4178768181776404411;-0.73340254677953375939;-1.9651894211575156035;-2.4820944515549623333;1.8271641030142111717;0.37341207193647363294;-0.79051524848140353185;1.0389255523326428321;0.29172489843382354291;0.60110897504842408789;-4.8691791244777009595;-0.40137002797709370183;0.38682924136236651602;-0.94206803146968998153;3.0017333608873477679;35.650476509153975258;1.8789406385473821359;4.3996693048737887111;0.1754492191808724455;0.16377488952423741031;15.042892496017966408;1.0964639873397468151];
IW1_1 = [1.3983561102259483011 -1.9304704147914595325 -1.3220483873766020189 -0.37714670192574478724 0.68228435669593823221 -0.31587914630706098729 2.5403270261424064635 -1.1858820628647812612 -3.1394428696419529601;-0.069245521331997628156 -0.16504926357449287155 -0.12674900122119597823 -0.2752406032418620585 1.8746043606901532375 -0.051256741678153291963 0.03275961178832518389 -0.10139618465846511608 0.12944788586226935179;0.27809101283015452699 -0.97258825287937988868 -0.26711977668922132212 -0.26328764514230962313 2.0996311019504396711 -0.84388618854264840774 0.2715331318684153783 -0.14837120476112414247 -0.91071151007403683408;-0.27973026227921427012 0.23094481309008660364 -0.27880537813003314351 -0.19753593865437443777 2.1184889677816611808 -0.4726420348609422506 0.036535164413523460447 -0.067746529369143299038 0.16290434188860342113;-0.055042698206930744387 0.038384424959861940252 -0.16930207928001450579 0.00085422299453432031652 0.50238019834696501231 -0.2833396966770943548 0.12449199151796921936 -0.10237602873083651023 -0.25373714541427599967;-0.3759998448553713013 0.45056673118337431383 -0.10158584604212654579 0.13579608087147770901 2.1913573169790718786 -0.47631216157563283087 0.21900939642432792898 0.045292365719298351145 -0.05565060427922079167;0.41638190287330967276 -1.0372566634935294072 -0.17077438315326601281 -0.72312202048235307839 2.0655059376331013077 -0.63371244980120811086 -0.49562200954455287727 -0.68518581714844117858 -0.48886271181512808148;-0.26236927432930229331 -0.019778191230752823621 0.018773217733819753256 0.10421559854085107877 -3.6154430628193132691 -0.014904074356458985387 0.10599695098990667697 -0.015430985741394306551 0.10767783180740010673;-0.2130938683077902851 -0.074187466014676795023 0.096921683236718389476 -0.10886749870713627319 0.53406345534333210523 0.55804198854419340137 -0.1232766460868745112 -0.027651742405863963953 0.35210758691403781784;-0.19905515810011192857 0.34363314830124785937 0.068661278815387971619 -0.013234465742682678321 1.976710887299726771 0.081775671307627334494 -0.18012328136891420094 -0.015128088221763588 0.23158864057978037487;-0.92925671115134256262 0.3699806517649790738 0.50605752998281261501 -0.71936592967371137952 1.3354825000149372904 0.25388033185672231884 1.4645406407740222399 0.63943348939017286003 -0.27603292712750304716;-0.0035500696083623078936 0.030190022021567987365 -0.13816675043087003893 0.062147961693484000956 -1.8121317695146068605 -0.81062693104303329417 0.52512840357519730006 -0.16026668973758886882 -0.14914280055206374787;-0.15996665026277007149 0.43550943112640588817 0.0040459416175014925945 0.05852345201740796754 -0.21772736916669249707 0.32133925505076599283 -0.036526205271978459677 0.0014088010204312169382 0.087996566913189105952;1.2701660774570808776 -1.6768551376846767553 1.2832277010911576909 -0.12319178381417783541 9.4672835039259162215 -0.17408498640970412885 -1.9508895621982227375 0.055061118182873028393 -0.28292598286571546407;-0.48125304336538476946 0.20997464089658626762 0.0068885372166226730567 -0.26222822857910416117 1.9349360472405927602 0.60514116333062129005 -0.18868815970882690802 0.027132173506291976106 0.4411247358775346461;0.14366260422036453148 0.16507418899236048215 -0.0557922125319962256 0.033001326764555437288 -0.096750375621554821071 -0.078025057702431496742 0.096268521999424247482 0.036873224668723100783 -0.23425111596500960975;-0.33363084175768270567 -0.0010814040433719451437 0.11278379354105216859 0.0090381991753581570476 1.896374907682818689 0.077049520176883365408 -0.23667529150470636989 0.023713684181116845978 0.057864937386586143275;0.094242000633959599476 -0.091515467656016147302 0.28816534247184699691 -0.027634042744975956946 -2.6950391649376950198 1.035705550273916975 -0.36321212914146339124 0.1409308269199413266 0.47663142450170520315;-10.172793220028186312 11.89690584992860245 2.7069248347721788228 2.805487665246022555 -39.621625815963639639 3.621287973386141168 0.10718649677374057771 12.977275289253649149 3.6896356324815560157;0.046334001931033833022 -0.3697997199791254741 0.37485178348745867849 0.19719150311259786568 -3.1251299053911534287 1.090886325216327668 -0.28373451144400141377 0.12421745530332957419 0.34351575868266337466;0.82061466119889292514 -1.4697965982752667635 -1.2862697151951143493 -0.024560800368147745615 -1.0956039001822617251 -0.91568612450283637383 3.1158834175525083054 0.76134353745874983055 1.7378718549582166109;-0.028936115635997860379 0.13168719026156577856 0.074074571723779347732 0.0063126839247028432994 -0.92053029186310619814 0.30849256822426157632 -0.065153331687430135477 0.072923336057702542456 0.16967894429496019337;0.088892434086350946565 -0.048831423391265602052 -0.13134534592339863757 -0.045862040924200597747 -1.1102587530042131725 -0.25707641066027481225 0.11661328453679827011 -0.046781147889440870269 -0.018368396715889835635;2.2259776532343784616 0.036207563482172487601 0.91932559532394975133 -0.43192865563378313176 -15.625387303404414396 5.5346925431378171112 3.8996114085363964286 -1.2360932380783118401 -0.96044226380579378333;0.11137162810206864549 0.026112560083100064962 -0.056201538882958673726 0.26131669612047836448 -2.038166514393631612 -0.0725685068104085923 0.22073210762672385021 -0.0026891800238456444253 -0.58905521334001853528];

% Layer 2
b2 = [-55.636673739182590737;-17.833753326973425857;-35.881310405861135848;-2.9661620382345263991;-1.0053899396871130989;2.4268191689393474597;-7.3885244418363376084;39.702356694731882669;-7.1151902586861677236;12.578376797617908167;-2.8670497649216826197;12.935492723646293101;40.448635289413331861;-39.877044751296573111;-37.157002831852445013];
LW2_1 = [9.5838287525898628871 20.315512806354824704 53.895342105530090748 -11.288406006551337413 -35.281750401500879377 9.6987771039547130414 33.798248172913623932 23.151233839694175032 8.2082433869289417316 9.6664565148369696601 60.306610096046590286 19.201749692636074229 -12.226617439406902932 8.9191598699298673125 -28.480135751704121816 -20.386877301966244147 -52.570402380266891385 9.1371917786380834059 -6.5929659853346347376 4.9663652407291536406 -68.291848029323034552 23.307736036968027094 40.692021168514919793 59.012214736719656116 9.650307256603005257;-0.55188935452239384905 3.4494829868182068644 2.7484369339965089019 -0.26479974912246562191 -35.516955883492485668 -0.8797940101280299352 -0.94632348089200679642 -2.2764272832584464545 2.6093100592236662116 3.4982055360749231276 0.43932413521173957482 -3.4568285750859319982 16.464668785271452833 0.15658914249981975564 2.2116106260274519535 -9.3991256107859797453 0.81054046159866166565 -6.2474830181771769944 -0.0023315150529109301275 -2.3043116322109868932 -0.048330350876252231584 -36.002618587983960197 23.205230683195409824 0.0055494218676118631239 13.765510433095856868;26.951946010848683244 4.435335538341617756 5.815472855094221849 5.7097448529554588603 28.417069561909624298 12.016499238436677999 -14.632592424536261078 -12.059900912293906927 21.775021643041540642 -1.3566453728697305259 8.8676694212474806989 15.243159465922934359 13.520893454027662628 20.248824232124547962 9.7137290701742937671 -30.946447395297674632 16.303460722087709911 -11.568665733158926656 9.0752300965854537651 -28.828816013768889803 13.20793089678008414 9.712944282202201407 -51.691641164244146012 -20.915543070762385724 -16.866752750857912702;0.26134126218930531227 -7.4053393883914644391 1.4171586663504425196 3.4599542726916614477 4.0665193204767531299 -7.2461342986430059554 -1.0298890005820315885 -0.86681742475724088415 4.7225584696398286155 -5.5553654702689172495 -0.41052133543648633429 -0.20640530522901662236 3.5031804801026455998 0.92691850738442249646 -3.0073502219490326759 6.9470103199325734522 3.9497284214376180422 -4.5093092921817197194 -0.038129207070636800259 1.0584254813928579697 0.083769284956911799211 6.9355949391466866771 -4.1529878576645282706 0.11693227885453942594 -9.0881862678092275587;-1.1049002615121148452 -24.32281232404476512 9.4421602477356465499 -2.3566457236931230845 -19.669906265733978046 9.7678281714162054072 -0.59147255986865354682 -12.002796340181589585 19.405676523844032744 -15.745308361924696072 -0.81872535230574272624 1.1242345599419505398 22.933262932218514862 -3.449769063919212897 3.7250442775404226659 11.241494950368728922 6.1069454977734682899 -20.596313130677017966 -4.1486118906988087573 1.3771947228846446176 -2.8095239619528813435 -7.2151598671720318379 15.235031249224018524 7.1582437051526808247 -15.235463129006127758;0.052759798572918438497 6.309395174006249718 -0.56611527688296414684 11.69808500475298807 -2.2226693820430565296 -0.62977563021554916478 -0.38313229869339454625 -0.23240584566375932507 -0.010408454992097295952 9.9491132121008067912 0.082109510581904326942 -0.041071362367686561901 -14.348595914266029538 -0.096294047430164494972 -1.4998660171974032007 0.23401616807474687199 -4.8696387864720973582 5.9492872589164127461 -0.065816931290409358413 4.6175182266820744559 -0.22186271599917942177 10.752489477088571945 -6.507800408135833159 -0.25105424971884410246 15.283035618630092856;-9.8090021300689524963 -5.0052024211555616873 20.163071764977210876 2.1578814214487178624 -5.5293492675838660233 16.050447779001270732 -18.557937486132590976 -51.471726432558455144 -44.175848814147528287 -21.397785659857166962 -15.604734121110961809 -11.421003707080194189 -42.262088761523479263 9.9398172573094694116 -4.9167067326174098696 11.344490141424442342 -24.180215403607281388 -3.0465543519321105492 23.31814164870781525 8.8586959971596890284 42.619125465397182495 0.64932105605441636786 -31.794010378556858853 -27.604989664040818553 -11.797683876021279659;-2.2618307327013780217 -23.061223247998128727 27.670249829386811768 3.3755010399119198539 26.84907887522519232 46.127004411819193308 5.1656020037773995313 12.815068794570139588 -45.152957479463097457 3.4955877532547696696 6.3425219243364683308 29.223507509648992908 11.642744394202951597 34.982175154656985683 2.6965789953008347801 7.9199324008282347975 -19.570172809722190976 61.816438150748325597 27.118172809684583768 15.723381855329874313 -1.5969306700614043226 46.319950670962775519 -57.24235946842347289 1.3424737588525599286 -37.539605330415433571;0.75660089621317883068 3.6585758924114415436 -2.2576302359179583057 4.1466397719226177898 1.2970118715615301941 -0.81238586343973961945 -0.33660222505052872499 1.809619025745297316 -1.7395911232166494376 -3.1964495509574555321 0.23397548323071098997 -2.3939403745919074495 -0.077786205821512494074 -0.18502175378695173702 -2.5697647931343405858 0.43546221422682074298 -0.7487883132023953614 2.7531213874245992201 0.063498995110809766662 2.9137696258297065555 -0.037893584023878407185 -12.77924863294136415 -1.9123702233054571398 -0.50393342768816906663 -0.087036367580481679984;37.66900269474070484 -10.219061097938135774 -28.20958495147971945 23.527452992367329898 -30.585713389736216783 5.2690344093815495441 -7.6357158062893901729 8.8093736479720234911 -14.422825556870039421 2.8250965457806800352 -24.042073476028285484 3.0099421100302778953 2.3446413207872995876 2.5801267508618108693 -34.396173313123441062 -14.448099697039394229 -2.4533917535377480768 11.591161354238314729 -8.0313898425695526839 -18.655285726859315076 4.5484861016268380851 15.622078580459502817 5.8644371905915662069 -5.0897388582307598881 28.724236092717923441;-56.937874980423380578 -19.950083044903543339 -15.748863146628654164 -24.371481029374645999 12.95694709452256177 -15.074111758597000588 -16.993198244994434987 -8.2946538521456520954 -18.849660007987928623 33.368812700408660987 25.209915222609488694 -54.494914937665846821 -29.763601748054654195 -8.3507956808672734184 -34.379853745697509737 2.2001640246393563416 52.246965987102775841 -50.821201409873140165 23.930625855575314631 5.8621844078193658945 53.492554481386932252 -44.309933968500345713 -47.209935230265628547 -8.6152521729556994501 0.90351832224330608234;9.1838142669824023301 -2.3665930832044619336 -21.32904121022693289 -0.44731943017991127043 -22.161678142285545334 15.050566408537186192 8.4754265412078630959 12.266734116817778144 -2.9641121223873914126 22.599339647542340259 -14.97520270287779276 10.661167619300044862 -12.093820413485625309 1.3340817969167704238 22.17268583704618834 27.916813300037869539 -5.2671956743777759158 15.412863305520367874 -2.5522820805792192367 2.0860747644716646221 12.118063948961012244 37.521466685193423984 -1.6112355300686824755 8.423060058909880965 19.756597168604578485;2.661645394442433421 3.8886538465693525346 4.8117811568568402691 -5.4617556537357856428 7.6430153258065312016 21.80292549935261448 2.8170669729782655821 -0.90210856744089273906 -59.807143649223661441 -8.6931773599035011557 -7.6029211141539123631 6.1985614318945128076 15.616681726758926629 8.0866640933859699203 46.786540333719671025 -43.871839473784540075 -5.4434704292106284029 26.266156906297183582 -1.9812772493357317938 -0.69284608031886196766 3.9417469861959992805 8.1526391101571515918 30.559723792523787012 5.6328114635949484423 13.852310279212922239;3.1024280533006907135 35.185462865599745896 1.7483716690190667098 -26.109749347993510327 1.7229779013709343172 -16.564789613646020427 -1.9569498242401910382 -12.573733152355696774 -8.3846269316964825435 -8.9335370914831191413 -2.2192073531404585829 -14.900814626455948897 9.7656569412020850507 -10.786325044320028255 -10.584988776846659064 -21.804138563138874218 -1.3046948008564256405 -28.557272890888057759 0.015474788674960132662 0.79761770597049752585 39.669288688829610123 -47.779425113609619302 33.186842029218070138 -5.7571492010767215675 -22.06256939498814873;2.2689620046108571749 8.9891358157672556217 -14.832707390722257301 13.241996245740399019 -3.7812124815094603214 5.8014369052637810853 -0.67683163026739856516 -15.468683464055109411 2.9116663271079130659 -20.401272741756645956 0.010025149356363317887 1.9342835961242799137 -33.06405739176378944 -0.60358419886153291678 5.1523713461464479835 20.451237102798145884 12.015197709572385421 4.5592335652686388769 -3.8465551653533029963 6.1643520888883660547 -0.76861694318764084422 -23.077416737946006009 -12.877178956132935284 -4.4493993845612074267 15.265078599391564751];

% Layer 3
b3 = 0.45967707822560383013;
LW3_2 = [-0.00076793117630141478208 0.59328443264792007916 0.001423832559603391279 0.63019895439521800284 0.006077568774375593369 -0.135651809301441717 0.0012729188296736809391 0.0043290368510044679312 0.14395368461643096025 -0.00064925734497974397098 0.0013905422334336357392 0.00079559375556217460431 -0.0060532385768354507807 -0.0019144602929311081794 0.01117781740266892733];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
