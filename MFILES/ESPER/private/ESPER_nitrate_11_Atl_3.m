function [Y,Xf,Af] = ESPER_nitrate_11_Atl_3(X,~,~)
%ESPER_NITRATE_11_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_11_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1757393626467145253;2.2754277890804530671;-2.7065190911293370846;-5.248179154304078331;1.9285841765876563514;-1.2597936813493770813;-1.0712986949862846053;0.74394341805164754255;1.0826883687076218621;3.8319455751399567056;2.7173662220794261302;0.82198118862113056515;-1.5892737718656297918;0.76333510569517160071;1.0168444522795554441;-2.5442201665638473074;0.44260349452684599747;3.3810252365422490683;-0.039244846302946244376;12.164537101443094969;3.6135838840404574945;1.8705281127410402497;-7.0179170753073707445;-1.1415602741667771891;-2.0254801838029701244];
IW1_1 = [-0.13772138447290047103 -0.89996717162595596395 -1.5756628509057897247 -0.036646399504350911369 -0.64819235878872005774 -0.77734812970944933141 -0.74693484452184100153;-1.0664692588642992188 -0.57974049340736855118 0.18075828117072539891 -0.53951474061704018936 -1.1514551442016243143 -1.1601020724726898159 -0.8103776476268037543;0.74686591052184558848 1.1524034526461806038 1.6203358103049865235 0.28183613902944859575 -0.42286664866815698582 0.56441370027460602277 -4.0656466018167130017;3.9391024404273236037 -1.3890536395049597473 1.0637433682324037854 0.92157224645561774956 -0.83208004325742512819 0.840654894526046359 -1.9037646598224109429;0.44766877483413675121 0.30657034528763277281 1.3920034027017769152 -0.44283504410221236069 -1.0267779140348820555 -0.61723653380857834705 0.13799258847580864185;0.8491524204100782125 -1.7664354598909235428 0.64664542153440673911 1.1157036636665420559 2.4282996535518281966 -2.9243244656468734277 0.98914522910247770771;-0.29269995050103719825 0.090983787417399430986 -1.7862250916950139779 -0.091023225158517614974 0.3932588167254728595 0.84949889979782644556 -0.60494906944619541989;0.037700866851915121325 -0.42092763488190110266 -0.33967964473976663964 0.45290848529365307362 3.0334562902139419194 3.0750926081891640784 1.2976412974010906876;-1.0660288490480638313 0.95570047134771995978 2.2614058043873108694 -1.9524343383241500316 -2.1058453071969278625 -0.87304842681631333878 0.19193160925819680029;-1.2678123209430818275 0.65014196073707009038 4.7482837787542999664 -1.4596230681956834374 0.90449294403588365032 0.95390163506478853339 -0.52750272589946345381;0.10230920452262463882 -0.6684861595980693405 2.3018413859158424195 0.76155102742728186804 -2.6912594325098053716 0.57103134601826066596 0.92051040458300914526;-0.12985799192839792005 -0.06753093837266677113 0.94750070229482019624 1.0251316240138033109 0.60109542440239616123 -0.45063955700234126223 0.66864389099575716191;-0.62692620879269866929 1.6404294650136890255 0.6136311025856001633 -1.2872553385177298857 1.1208892749892538365 1.136482407663044647 -2.013954451987425287;-0.45977062830290943429 1.8531600246676112054 0.5301954347607116258 0.34500368598975278411 1.5054111479934637607 0.58074107380586359461 -0.039112823559655264527;0.15415531218867983831 -0.39772667174610337737 -1.7105715685599081066 0.71213673844692770842 -1.9017815723641171566 -0.79552933501796108118 -1.7561662694055937273;0.72643362309216419348 -2.4923021293195035675 -1.2749516817529173984 1.7122638427536753802 5.5599202821104380945 -1.8074613447094343144 2.3862324417057223513;1.1000425050408340066 -2.5492516187765850155 0.58423644634700033773 -2.7267338727282770527 -0.35585787173589888965 1.3365937294096017496 4.0361068990132293877;-0.22951090209257174468 -0.14105616650809751911 1.1239308623179904423 1.2456260547151474238 -3.2561404637031055032 0.81238091365235298724 0.63319957374377033865;-0.31842257922109634682 1.1273296642531327461 -1.526870856559694678 -0.70153409852311143791 -1.8166668648519868068 -0.1297683099783023819 0.03815750037196100064;0.58113014731372547583 0.13411939912519210694 -0.058956605107419360334 6.496225028375849142 1.849402710180765963 3.7425158000538183423 6.6504472022097500528;1.0185952859570155393 -1.4212072588275614926 0.5608669817355605991 1.2268855082745051543 -2.2964256506003866143 -0.88072262491590069811 2.8870284915817143734;0.2752205548052582551 -1.6151666225784708786 -2.9761776171521616696 0.021688106789654500173 6.3328970093996437285 -1.4403386448690809196 6.8822749031964551847;-0.86385770197433298101 0.1993221547414257 -2.9144346879794005289 -5.0740392497948221262 4.5423133187341138139 -0.68888470450845840087 1.5998031639938665727;-0.011593049028270307338 -2.5650526680724605733 0.487830066133343343 0.16402463347706586205 -2.3448835583396241411 -2.0833070059357190473 0.49355181465428715759;-0.36837399923487168518 0.49373290987828150067 -1.6561318806965628081 0.46365555428467497556 1.833053791207145844 0.46003014429449839984 -0.31421419121427718313];

% Layer 2
b2 = [-4.4427099103269327429;1.8005321553665210033;0.65742833574311065892;-3.7482629156332949449;-2.0308229734425657931;-1.2101430186659110078;3.1709758895941231316;-0.99750043350251105245;0.70680035326696133424;0.13157782173428267392;-3.3197565616428321711;3.9693485408523287994;-0.61219684489148817885;-0.84551200111737379039;-12.737218021921080435];
LW2_1 = [1.9695060799240067251 -0.775208896709047246 1.4654590406691885285 -1.103561473947978433 -2.1692315039015648281 -0.17362570214773986876 3.6392617377611435892 2.8498578459139221053 -0.096613956474382103878 0.12170809891651651613 0.89638993125340948875 3.2490698663407924229 0.75033060731338707683 1.2580769199585486451 1.3904247885842575538 0.61894716511232139577 0.46703534572417743087 -1.7364864885101398695 3.9098546376730425322 1.1614520781626611612 0.68749248381187710866 0.63695129379640913481 -1.026592668384600282 -0.29682307570173410705 -6.7139428990082290483;2.2562368766305103129 -0.37176134440248204127 0.26174188563103073513 -0.9556482582102495682 0.727972465955512682 -0.031508548526968459258 2.0923041307441478942 -1.2124081620702908957 0.074474205647170707567 -0.63505149991804377141 -1.5569790817236448532 1.9280500902242083683 1.296782637406628691 1.1321057649147736601 -0.030956261314676849355 -0.48114529153991353327 0.52801462503788665348 1.628116330425265712 -0.73519713982972578759 0.17060499703994941312 1.2641124669011176707 0.44268148958081970923 0.10426101385072029937 0.621047989516433252 -2.4723759378881395854;-0.62322627612868741753 2.666651857875496745 0.74084491294089704905 -1.0630315105226444405 2.1765351383362196991 -0.12356938531709199536 -1.5592842197779153146 0.83498335634555453932 0.33650260469285991904 -2.6054054824439547566 -0.63431208977821984529 -1.4143758572580873434 -0.56094763522062529582 -0.33042836120856361459 0.089565667366232032398 -0.15430890127532087552 0.068148984832416964474 1.8012564023368904387 -1.7004284330680679016 -0.82946791768913352705 0.75276771632743921803 0.42580504824056547575 -0.83235453311283214006 0.50310352630790577955 6.2214488704434094402;-1.8603423363351327957 -0.5860235753997273811 -0.014799234314989922687 -0.4192518664838093545 0.044652185003694402909 -0.13167896642076901137 2.4813321175863625179 -0.013671800604118740721 -0.19297159608118955032 0.12676986549760335676 0.60709787494116007611 1.1205113517562415026 -0.80026742543055484624 0.64834206905945213073 0.059611385630447349948 -0.84075882560496417728 0.22219073035242156711 -0.40164792855438696817 0.43941479824066964621 0.37097587869535436633 0.29511362387706241428 -0.88511004291840700287 -0.45508876423044991588 -0.026560573022344553806 -1.8228142620561442744;-1.2412381274426624866 1.6505117894848342353 -1.2508026327977654901 0.41125552031167705858 0.4305082556440223418 1.0493309364972736031 -2.3172119447758841027 -0.30722177013251289468 -1.5193431559096208794 1.0966599141621513613 0.43470565462385896138 -1.342360663564351464 0.59198854026458269662 -0.41660286208437918853 -0.71220260988010775094 -0.81165236250442251986 -0.53148839771399902787 -0.34189589890721588938 -0.95146626174605997139 -1.1439364395704947341 -0.69626748945184624429 -0.83452306814226584475 -0.052666023725503274822 0.12322397398457335393 2.9813066944230728339;1.2831128270559724047 -1.379023743140218583 0.30845439566898608108 -0.39183258449959562641 6.3037695372052464649 0.22808033927025481158 3.2155412739487383433 1.9929559651719623847 -0.59765509989717557904 1.526279343624296736 -3.0377433154094317658 5.0922885857095820938 -2.7970762048096822205 -1.6897292074714957977 -1.9730049954783968058 -0.84446191519597813002 -0.40174198808089545132 -0.95581218432696535281 -2.3804837568443502072 -1.5901725727393039023 -0.16869172685658426203 -0.48313698471442961813 -2.015853518845857284 -2.1007951610681683263 3.6604491839449786461;-0.41247297057748216753 -3.0776700766721845071 0.55569281659746172508 -0.2941250502710407444 -2.3896297437012066212 -0.82883118150760770604 3.9096396593295175137 1.2394119799976976992 0.44204313382636700736 -0.15909343582983420662 1.1616898151399634997 4.5881575146675555033 0.13861795122922768164 0.59812670569055992331 -0.70385246039136151186 0.53801972124589936275 0.32916631163179405073 -3.6567715773923574751 2.0732376374684933218 0.34446907792843889373 1.0550363497819301717 0.23980421774905649746 0.00076798087758889188592 0.78150778183229829832 -4.2827688871480065202;2.1782299099307920187 0.37080010101890009677 -1.5707674182361830439 0.21251098872913598559 3.8593124443967274928 1.742169502869756359 1.7916413243333937366 -0.0632861577614562687 0.42922933303596344512 -0.35716251594470332931 2.0371789832417168675 -3.0335325888335216149 -1.3285185767823470826 0.72923335090870355923 -1.339568854617494198 -1.5979240705379309517 -0.47295698165620914111 0.65443468672354054849 -0.064719828162097009505 1.5477955346497882516 1.201682777493679799 -0.38565077387583318602 0.22515989853483342475 0.070284160283839006156 2.4791451096793903908;0.06718190725725566026 -0.17141520725702288908 0.26745006394469250655 0.67939742656005752686 -0.38669661631521384804 -0.3238663924647744996 -0.017148523834469235616 0.25680671396282023222 0.24808327905075952535 -0.37852424225795266999 -0.29076676452877059376 0.9258003566967972775 0.77949904342916609412 -1.0114210321184262664 -0.82501749444455041438 0.62144350471577458617 -0.047623772582315412882 0.42298283352617532804 0.68951895636750282215 0.83279303748908073413 0.44008487548036195891 1.4170468856355920018 0.53337764503728135601 -0.48822154630819353249 -0.32122701873037501352;0.33147588422986690171 0.86882175322861177058 -0.28286775891524723603 -0.085954566399896487061 1.3267458682484596366 0.027859620484152046449 -2.9675521298756746269 -0.35078489498332365848 -0.16448789953537679143 0.4685062229830571634 -0.90660424148724660931 -3.8105439366779698673 -0.76373187779357309957 -0.90958786729548879446 1.4505750282146214758 -0.4536136039193584546 -0.20909650666991685952 2.797298798257997543 2.2025222363691061567 -0.58187483118389471404 -0.8950525519413510267 -0.73937967773490143042 -0.2359537075615880386 -1.5569952337678572007 0.99275873387390289881;6.300087805670121277 -0.73486682034758377124 2.3526703028135904638 -3.3439591974134472707 3.796535269317833805 -1.2467787266378964617 9.3980531788793530978 2.8323451552095391115 -1.2458285535415671852 0.63947614903749416815 2.3817541676887250546 9.2133647733121009082 0.10535752250331860413 2.450196197890085692 -0.00098796472814085406489 -2.0324615144486761764 0.63025252880530069355 -3.9705191215477637634 0.92567814351236854531 -2.1329102104623234304 3.5172531587702335898 -3.1009510102737944948 -0.66549752618796376158 -1.235723076152682065 -1.5283285582428478566;1.2674660127310044544 -0.052821078824608187763 -0.12053673151126041707 -1.2427733744501543445 2.9940889714945568834 -0.053732842359732212179 0.074804398887236112081 -0.50999048594707907522 -0.20899290927656025141 0.13217992489808885748 0.11619212560983704918 0.60216745797984416733 0.72412955713495419374 0.45176046445586498512 0.11118674007042561591 0.40381353510778483784 0.20063083454858920973 -0.039962061767855688865 -2.7902609402556133311 -0.7565588035423869151 0.5570387555716298511 -2.0049221976736117945 0.33998999610830804574 1.9187512104710471306 3.1058799077558152391;0.075866303060714679329 -0.68605516965712598498 -0.06512177307910237134 0.27026784537934867014 3.0490503624683720219 -0.76070848627734655167 -1.3475596155209992322 -0.084217725586654940129 -0.049803842067786173453 1.4409563894552657182 -1.8180640828556320354 3.0432541708853912965 -0.20870302298299014954 -1.8050411113070268243 -0.02617642446350763874 -0.3132375428672998785 0.022677587661553460369 -0.25344094082400364654 0.22985710518564331228 -1.0589098882893375198 -0.50368766201048553732 -0.71192211105839764418 0.79247537208241158879 -1.0558736065685996319 1.7261419288797787974;-1.5341718156461601197 -0.73832383668433088086 -0.82888932106760626617 -0.84971670257476272781 2.2676439797310221635 -0.78448343938998899016 -6.406733483492557113 0.042049824391875566254 -3.279289613540210091 -0.31988723864031270994 -1.707422335313218964 -2.6859317075611408576 4.2197531572390598598 -3.3042226251622808242 -0.3936745257193053904 -0.1029934901014427362 0.27969624190344999359 3.2252572920503665976 -2.6373088370976431882 -0.74518651789143719455 1.2329683515666618465 0.76381920775744460705 2.1718327636412855242 -1.2379373955536341345 4.9916251977438399479;-6.3186096642664351108 2.5362354185111013471 0.71191548871937571086 2.5699900226386129809 -3.9098414416968383378 -1.8183069573086538817 -6.0885340803205565408 2.8630336106124794071 -0.53894405064389849791 -1.6976196495276516529 -1.5874694508268889503 6.701244589766677251 -1.5802064319066746467 -5.2939487269415463899 3.1770441163652378691 -3.6421193694081819281 0.87277186362098746475 -1.2250517917271717128 3.9114872379142280323 0.21133038426556460809 -2.2133726926658008338 0.99974549005223345421 -4.2369615513403440232 -0.71088956774829603624 -0.1235451469541103825];

% Layer 3
b3 = 5.2385277710506823468;
LW3_2 = [-0.24040429897549175919 0.67755166448766523946 0.19641058819276832614 0.60162308630217564698 0.39914348970696023056 0.13328745659745960817 0.5088968138929224061 -0.1599404255124951546 0.42787096611753583364 0.4163599549869949068 -0.11141304189979756023 -2.4173829385345531051 -0.46621579182050809642 -0.12401411449309773793 3.8605003354312281694];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
