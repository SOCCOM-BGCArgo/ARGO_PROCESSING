function [Y,Xf,Af] = ESPER_phosphate_7_Atl_3(X,~,~)
%ESPER_PHOSPHATE_7_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.0317780529515161447;-2.5647948098417048257;-3.4005464773255242861;-1.5510846777837317134;-2.2864638639374645912;-1.7060847253876574303;-2.1701814363902736105;0.62438961265751646845;0.8791823753052918633;3.2654194636897910797;-0.64164200498438639375;-0.68060156270582405913;-2.3696847235231310869;0.37020036864051153458;2.1613593564670234848;0.87350878347907812138;0.38289330972558721644;0.42987373166909909061;0.55912079826626992496;-0.47060341291033247479;0.14202880372505624629;-2.205131452881228693;1.4172090137386523789;2.7646433432172217159;2.1644046954122058146];
IW1_1 = [1.9573118695514526433 -0.11871980747245716725 2.7302205517799364998 0.065996678645677681052 -1.054559454804117502 -1.4097034638150469643 -2.1018304019301874419;1.7294872954694602285 -1.7249241237151520245 1.4124779135007883291 -0.075201785380980157303 -1.7750329284917214512 -0.29703062881497871439 -0.54887012647174493463;-0.018633517665256078139 -0.28713156716505833232 -0.27689221703820726672 -0.13660093712745977057 3.5064818778547524047 -1.8768143234081200443 -1.3417365785251802457;0.51470577105201553714 -0.32676153132665936019 -1.4612375053318844564 -0.13982947552191751783 -0.70438037771294914613 -1.1751368019385564079 -0.52627942016933659808;1.6558338428509484785 1.8351517723353374389 0.50129849512316826399 -0.38829782843971283324 0.29393144649665481349 0.29870930428377417964 -0.19119169705171965012;0.55678701659917151368 0.99041553001314475146 0.76114845966450839221 -0.84558745141956637159 0.82735416106505410561 2.7183038051589583084 -1.0786567083146747503;-0.27207673978570895423 0.79199016198240745901 -0.63178211425920061117 -1.6004496248082142884 2.4083926845699337171 0.68998620984443004289 0.69578691524382518807;-0.55670662427948935935 -0.58780316059031922915 1.4315485661944731266 -0.66392904744830461006 -1.9699742952056016332 0.90392911140054732488 1.113068588062828157;0.076599656458846726581 0.54932858294217579154 0.88333008763261655627 0.41461926596876774731 -2.502775502160505372 -1.1031557171219170677 0.69357987286886391143;-0.4126336860435357301 0.8103229776255528316 -0.42584040027801878248 -1.1029315792678071606 -4.0092850151127086278 1.2443568547305576821 -1.0487474137320698109;0.082963635574924671223 -0.17166090241823847573 -0.55363326025883707882 0.038762995470424749245 0.14583046108314492995 0.93777279536197732934 -1.2014307020647532198;0.72105397496307210847 -0.29852496175279408241 1.0515160376730916525 0.89554514441915555878 2.1312512344048077928 -1.2215127144790705049 -1.0239052531269359214;0.74612553555519978143 1.3092262127739904276 2.6351261335693210164 -0.082093771484130398375 1.2848512838845529416 -0.1702031042595456567 -0.54302855307871122914;1.287143733375873067 0.91719478446300295449 0.94868609571639572753 0.74626448014075941195 -0.78067020530633990383 1.2611100785828299742 1.5299121409004305949;0.45798962744318794105 -1.5734416993927871076 -2.2032742415889337018 0.34452818399323364984 0.29300215714959210178 0.053840405858097468983 -0.16636335836087098872;0.14224730284217348975 -1.0885244728410179427 -2.0320015062297902553 -1.2110974454206133721 0.37360200057692827258 0.14155303817944664413 -0.55321283267108722903;2.0536077171603386304 -0.012455509351141223762 0.13659709194168156987 0.48921267974463555905 1.6521798271350416343 -1.3714854120323025644 -2.5368059712709616349;-1.2656308939884539644 0.17258917458471578765 0.67155196387128501812 0.10543655493171091853 -1.3005063892542962911 0.97720171018799439899 -0.74271391953340648584;0.89733176709826267814 0.86659101634017532412 -1.3164165897582762454 0.6541201639767668663 0.29300375289445512728 -0.58905448926614845107 1.2171489128783139488;1.0200216322062218843 0.0021118691876830806078 0.61478862869727590734 -0.34218566278296369543 4.1905621890999276147 1.8399294875985927611 0.15836946996276626831;0.48160004260933009235 0.48135508851188668622 -0.66403217208433329422 0.10291298601719264805 2.3509357768695409163 0.46868304898881352205 -0.8204333697931716074;-0.15081006608217067955 0.062608961225138468065 0.61148728903053450878 0.43234706702158187674 1.5691205180326144308 -1.124987738031060891 1.1741733673686371997;1.1806075700929217209 1.2469121196972623444 -0.021319967472949945264 -0.4733236697217239608 -0.53848109369609087338 1.15384794213499009 0.015612688585916790346;1.0912084308082721229 0.0063285187089531218935 -1.9335504832243453066 -0.14201058602905641814 -0.22594122299366398154 -0.45869945461548455867 1.2251792401272225685;1.0692497411680934594 -1.5175046178339692826 0.36986023625719977037 -0.092240868210450160936 -0.50302878034146469854 0.45669988317662651989 -1.0767066557657594128];

% Layer 2
b2 = [-1.0945948615266627435;-1.7807764789613809153;2.0114748980197640904;0.71996556200589123531;0.6432609843687329132;-0.27729623401029163121;0.23860429818641651356;-0.23480084380059906835;1.1336017474952864159;-0.75304063128410603234;1.6539826106275321571;1.417270755823892614;0.024669477381011047784;2.4452192913040384781;-1.8879332711534497768];
LW2_1 = [-0.23261722795747571957 0.355604448403875395 -1.0464568342093361064 1.1816594728317666441 0.45188383184271374571 -0.087227747492265195195 -1.6470295871187738967 0.53536309989027031087 0.83448407039116312411 1.9436751559388449895 -0.22610414985549978639 0.3218291698174235993 -0.13275404689002842651 -0.62101522571500400449 0.37694448428739618651 0.92040738663452015267 0.59518463914201302778 -0.78644513361496348747 0.56615848482791086838 -0.16085147278718175956 0.14274431840003229399 1.0810647336723215872 -0.11682166363153489996 0.34787330203283151064 -1.1628057275905994139;-0.43838679426480486878 -0.65127930652333343442 0.49510848765242920777 -0.38644468263846287748 0.27897358124406779201 -0.54304580254364642755 1.0053796738742684092 -0.17852368436391236051 0.23339796219764963325 -1.5206682965700675236 0.68746330739284344791 -0.10456554572713350204 0.15945966328585767235 0.29575018506280187358 0.15297318613221316808 0.18739858312710835908 -0.24959129569089025247 0.77943670447685087233 -0.2244387426168885924 0.64324363544920226676 0.89291960894049082764 -0.25444058133327557281 0.40064806572363503845 0.77514510902368150003 0.29972677688400084506;0.047069078170377892656 -0.56049026075157548643 -0.34111156660229358106 0.4952445762617456726 -0.19095409817141431597 0.99474627675671745131 -0.49498801369501094216 -0.21110476142183215442 -1.6553760826058578903 -0.37084491902194660629 -0.055832185766637371094 -0.87633150104534152103 0.7523508646189533966 -0.36717485258904963841 -0.024468369755203531885 0.73575040841907779487 -0.13944653125152850492 0.14768996379920057427 0.4710249683947849153 -2.1250324105114324347 0.75361340706471358075 1.4406684723241671708 -0.055768627422310534936 1.0701547016377077615 0.39008266130723934229;0.61531909681116880861 -0.62310923543710472483 0.41072666838937704759 -0.37455892958995384845 0.78199927975381922085 -0.5907271282756169084 -0.24130343028387976623 0.66199871860365533394 1.1991759659687841744 0.78674273634175007075 0.30382070340127004249 0.25282093313581549543 -1.031144947096868103 -0.29585335236931370462 0.10902767202211602338 0.21974787065053269508 0.55481568505749245812 -0.29892436352525186827 -0.18061613619083100035 -0.64248814845584267808 -1.0537726718651787561 -0.10618136477821894792 -0.20683523897943056902 0.43295116113486314946 -0.39392196018291808501;-0.10212385311994780224 0.56709848333217394156 -0.66822475322655927599 0.47036453402286476644 -0.27800146128119118671 -0.23626529732068088374 0.4367697070750974353 -1.0292012180276211009 0.7921399110967670687 -0.16650851273390970819 -0.7411277109756886361 -0.81279709373154973573 -0.65410734807630799281 0.014676543814801247534 0.12024614770608479941 0.14605102995678057032 0.45360885998360733762 -0.067577300704034670709 -0.086353875876654051513 1.0739529614864737894 -1.0031275036874705009 -0.11802498081356074811 -0.39479987142866157512 -0.028974049803167672978 0.46523614301833771112;0.34462747655380210343 0.021309450454650505358 0.99583749577152869126 0.29130915083575420477 -0.36752015404939519794 -0.42090732634111632793 0.63629287285959756915 0.47364534545868353099 0.28340588006305750257 -0.58192307696534439909 0.26568486635169613619 0.12812641671237845475 -0.45337218507172910575 0.09541867984514189327 -1.405015601937926073 0.67347600917819927524 0.82347782203535468959 0.77388310984862196396 0.2316482107556797343 1.7404647540989164334 -0.55983609542515755386 0.40223878713590799361 -0.091791344266358154691 0.3211666614051382207 -0.44597262674145304873;0.03868919594375790777 -0.12924903193816197899 0.61321427391010674413 -0.2609611471739382571 -1.2194665608965398196 0.57033785291682859153 -0.074293661925392884271 0.64125753391003470494 -0.64478167234954930631 -0.17973885034992678755 0.26738260461564605786 0.53287841048715633985 -0.013861075928851850081 -0.2020134391673125418 -0.65760123960204230897 -0.19107417366485424104 0.57259449484402202835 -0.36133260994104293706 0.49825279760794916051 1.021720647048073527 0.41566915542639049086 -0.41435911983423873162 -0.64513537471199566831 0.016119619888517539019 -0.84314794387910851903;-0.23869644577117746231 -0.16063684387072418858 0.15026725518238234769 0.04657326788014239799 -0.36782624508790923157 0.42005851498187973814 -0.20113147038307727099 -0.25594019175043064562 -0.74702865882122237995 -0.3407324287295998011 0.058533538724782840923 -0.52058112892594898824 0.45526216125473567553 0.34558818032922772323 0.059133336582068304899 0.58958697525211678503 0.078798537660164896801 0.16937211999929746575 -0.01900518967402017867 -0.83354018730810119919 1.0587932699446407359 0.83189035540073696939 -0.38510947436837389413 0.85517971968399597582 0.16338348659777884864;-0.68821607840344889429 1.8610684005491935356 -0.48644729917493773064 -0.1481536372916739952 0.73389135931152926773 -0.10325986651314682241 0.22331693879974109929 -0.69062799494638715814 -0.52513483652964088044 -0.13113860775686289606 -0.30997577773163087489 0.10620027451118989326 0.30942162161034830747 -0.079797075057941257992 -0.4496341736416089585 0.29847576962598626471 1.059409712819147531 0.39789076639902182242 -0.16624805442004417233 1.0337730742607575962 -1.000370037781798338 0.38145504001374153091 0.15976192819344489648 0.14185422599438346491 -0.14309758345001807878;-0.83207722001398032319 -0.99191625584828435613 0.16512277526085802903 0.41795288381334899652 -0.079131176462426275342 0.17326817023030902098 -0.5442842389247565249 0.17183004789371059129 0.22421463605716185352 0.27198949673184996678 0.16157924077713442523 -0.49830181712603682787 1.1295485235902777976 0.053468469371990096084 0.26364606915272731369 -0.40889420529490566603 -0.13967903729788727629 -0.48786140150198253895 0.06177322579796075408 -0.39893178193273604037 -1.1161457517921635763 -1.4158815484847855348 0.19311056479482002768 0.037434066689890133084 -0.22593565793895131755;0.9403353303181912759 -0.044772090088793445317 0.32903059499403108923 -0.25967870961690636689 -0.24813821103200314755 0.20527658285521677151 -0.12962367705499361348 0.66275811296000786133 0.20243795911905121399 0.19561079068375714085 -0.010208195732933314503 0.13954110127932969898 0.038098785304746932145 -0.483501033799093205 -0.7851935020005643695 0.45886974437602051635 -0.17968958443938207181 0.23839559766814716335 0.28923707310917656788 0.044144784326982398903 -0.44114852538285836969 0.857192628265172063 0.20942362930074512328 -0.86103236084679557472 0.49491467547642681302;-0.84516304930652574878 0.60818771009716510179 0.10281750714142250114 0.96962296861574492901 0.6226095080259151926 0.41133850025354928848 -0.14276903539162050238 -0.44703320894859838175 -0.67057207867912327348 -0.11143102395617539291 0.29606468142901620766 -0.30862082938847523739 -0.16972357868378440404 0.28556953993101058531 0.62661313287634001767 -0.29788717641791917501 0.209432424000056433 0.30832445678988240623 0.25038993703561818194 0.2607311539641327669 0.90768120435105903443 -0.23660187324639544992 -0.62223076703034352342 0.0021023433383976766406 -0.9639525680227081228;0.54750846348913795314 -1.4184441642906837622 0.36562784396046588142 0.51590876907435700982 -0.20433607244450199825 0.032871939632431172729 0.94934665598319301072 -0.35266365855072406843 -0.50976683808346134885 -0.6347700610779009045 0.60882643842156669578 0.3373676330229024023 0.20553612874377935604 0.10293217748197588945 0.65552286821017624607 -0.66687669698992924072 -0.29235117288646406131 0.76721129312000424516 -0.33890908626353999367 -1.0744937872906752396 0.006584847106175632965 -0.2907464913305854437 -0.36299472424301287843 0.36205762468576752067 0.72555389239058454276;0.76233168622243363544 0.81429152619439648664 1.6458263208732926142 -0.69033600961553887032 -0.33299204602398935204 -0.73283027604880202066 -0.65583080124050974202 1.2094720223846704421 -1.4890514399540757395 -0.43531600043749896223 1.3617220296474084051 -1.2703378213721900902 1.1675075043793921026 1.2808076610680152463 -0.73115467671225586876 -0.41141268188451945997 1.0523599424314968864 -0.44735468520446297624 -0.37540907107599108539 2.2867987426665319362 -0.04595126205662607155 1.0103801279079969166 0.094691959196714650671 -0.29133439878971906234 0.53802840351401703956;0.091961254675532067004 -0.5341947682944409026 0.68071880467840195639 -0.10551364080261160794 0.10216819285913947279 -0.3869960855662210597 -0.056789445392762399889 0.91952255155586692936 0.70489623333935247373 -0.17737103837075374191 0.62109682211777406113 0.14681225353354881991 -0.49241735376590750617 0.16519186579921468772 -0.1568582419328330424 0.39494746772198136009 -0.33277527261416145477 -0.31545178601172590982 -0.055663656159846322535 0.0041032424898986910589 2.1317258979714579503 0.24114747804977029744 -0.20971392598402230356 0.33314266363504685398 -0.22960172227998285055];

% Layer 3
b3 = 0.201046163051413318;
LW3_2 = [0.52459486485093276276 0.79903909135048922785 -0.94158794820004187986 0.84397361831711203983 -1.0596077340128668975 0.87336832178460921394 -0.62330551979577630828 1.8703927930578108096 -1.3776524055839070027 -1.092614547543904413 -1.3706449417853017181 -0.95922432255830092362 -0.69563564541219269355 -0.41453503300470440074 -2.0765184161748946323];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
