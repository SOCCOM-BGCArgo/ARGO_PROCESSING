function [Y,Xf,Af] = ESPER_silicate_7_Other_4(X,~,~)
%ESPER_SILICATE_7_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_7_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1044149703947019336;-9.3380292897171717215;-13.385594231892369521;3.5474770451291131046;5.3099326677975478006;-1.2366134882133468231;0.63528044624954493891;-2.5021558908171739333;1.6114293969105875082;-3.8585052927063498984;0.11422266345350944039;21.858508029832297126;-0.78386336222871555446;-0.23299630476117577649;-3.3741089600713771723;1.3075829113360373235;0.19914800921499145603;2.6458112771335962066;-2.4331053652152174749;-0.87813719894948760736;-0.13170554643733259348;-0.9133047318479421417;-0.18682651671060929166;0.25141234993025574074;-1.0985585951427501161;2.7337718076411108292;-0.24819803175078461455;-0.059088249097847822533;0.20528501576723823252;4.0975181829835216618];
IW1_1 = [0.58234487602219708879 -0.74330231079441078101 0.10495343215124677827 -0.086087597595134054962 0.51892605306477423976 -0.70555454408865247995 0.65405993453722532927;-0.2691355712881209894 0.093029854796882555101 1.4624159033516332951 0.53984135591367266027 2.6228651485814467037 -7.246893781799643719 1.9490755131139922973;3.7933696509214618331 5.4950470770938206755 8.0059895059911188042 -3.9315059777202132629 2.2478036696840191233 -2.3065800429523330983 -2.1873326055626240993;-5.0148277207503717534 -5.9752784863462293785 0.61237526361385175022 0.87503447075006224321 10.607175709673771991 -1.6308058007171379877 2.6251263872008263611;-2.4132054492113037547 -3.5350144822098528152 2.7755775830652198444 1.0852296566223256225 -3.2980189890981912448 -0.33696137405861925629 -1.6248660548142175308;0.29718728340916694686 -0.23186103600027699323 -1.7230862168375802312 0.0033080034837882294277 0.8034811351834016957 -0.25418310086424367178 1.1079489292502671116;-0.044099000937158953917 -0.054198097007336409892 1.1451787251673941626 -0.21261609066707970461 -1.4360279188817055562 0.5192859760988931539 -0.65110653725683642623;-0.1253609950944857554 0.048145804287557623924 -0.32297546334532123424 -0.50551072969524357692 -8.7631170122530139821 -1.8811051911430101136 -0.63337068968871179653;0.22411716730175762491 -0.35371144038398588672 2.9939538783656631793 -0.80750870596682422509 -5.8737397441549354937 0.92068871847398348063 -2.211497673397206043;-0.017316133381476476322 -0.64787298923995684241 0.49999459931725087625 0.30953367095107736651 8.2763775112467126149 -4.0651817605345677009 0.59665127289337172023;0.59704858403561533731 0.22098732121851596966 -3.0832256033219969105 -0.18649035757104670541 -3.6960413831873277779 1.4577204711464679665 1.389023384964355845;-6.8889092864648455716 4.206725266433989141 14.472745581537534321 5.6682638344506592887 -1.1250025478125680323 -0.56145302143779662885 1.7344416068968160349;0.61676196257689452906 -0.56368177961770737916 0.036083729283289824041 -0.020189639020536144509 0.50425538159207849986 -0.38319657401432449806 -0.082976868706556711208;-0.17986795128386681708 -0.19515586281322083728 1.1318354153863612321 -0.47065113277152226257 -3.422946747242431087 1.9559680089494853039 0.40422653926775592437;-1.266355276450973566 -1.1061016368343563609 -1.7925651575889551825 1.0052380078922342754 -2.3095583287277494655 -2.546337678618289857 -0.69547513215654199747;-0.60628159811305681881 -0.18674566071919895816 1.4424150380863027809 -0.37920806831208242471 -3.9395325636705686989 1.4237531452502276696 0.1719775575965255543;-0.25934805867319027373 -0.23012687134059894856 -0.2374882905472723571 -0.24801840789783252683 -0.80927326928229548209 2.6462663500825813756 1.4088444319993251863;0.27259139717506203349 0.07578308984126556902 -0.014114797969365638214 0.22372122722618903445 4.6643117933055098234 3.4310335613568403446 0.55139984164789446197;-0.64840083126682468428 -0.97458753741051673547 -0.58731500102434430755 0.75505786924450257747 -2.6896093153890423544 0.41441107371514596114 1.8669127247295917993;-0.35573656185447410927 0.4585985131380924118 -0.75378873740837859518 0.59948908868067563027 0.31560593191167046756 0.66089569451686103196 0.10285012194734935442;0.10354280342547650395 0.096809509294205453589 -0.31062912827753413891 0.49871970895244088773 4.0349971102671746692 -2.4385492541435200842 -0.55533132243742799883;-0.38977118382726860801 -0.26915815126890074716 1.6626220157763609286 1.4116272216232184089 -0.59784628208766743551 2.1007139289007454863 0.34342236151056182436;-0.12007622237137426102 0.0056338462804386198884 0.15578402014376832585 0.3070692882150274361 0.32955347280065305782 -0.51130231706667450542 -1.6786782105739950222;-0.32408491137767481138 0.040952909949809664092 -0.17495594651856627433 0.61799540562991039927 1.3063134904033328887 0.91410509726793631735 -0.19196908353115851864;-1.8930024263147426922 -1.9451111385672337217 -1.3759704250700335315 0.064245436812660206005 -2.7778914760114008509 1.8603068864415013284 -0.24706802490982510134;-0.033868446243850415522 -0.17849012421161922215 2.0588299631794293454 0.23371365094893989389 9.6961170561216558639 0.40303127147267325814 -0.010403413178527172456;0.0084434597240643262384 0.85026749133018908466 0.8035156519626730498 -0.040806137916015672307 -0.7123054642061292796 -0.56262306639079684434 0.31220574456504607275;-0.17688403022087903493 -0.66194505416067705994 0.22647838995736913059 -0.67802667731512922256 2.3695347694059591959 -3.1676600228565878759 0.31415349695561517462;0.32566604049915937047 -0.31109191224780263774 -1.5292900590270712691 -0.01883507419616211459 -1.6739200080489655686 0.96597390625410739506 -0.31548865034376055716;0.86702662512190487032 -0.49033512397188083742 -2.8301719346020148826 -0.4961104365998619814 3.0965257846444322887 0.31678514109181832303 -0.16385913076137079147];

% Layer 2
b2 = [-2.891970940520876443;3.1641531380030292198;-5.8834242456924537024;-3.7020154922674768372;-0.61529015302911949092;1.715998065707570186;-1.0177195861154504364;-2.8902491671070702495;-1.7550491839317403642;0.54933013916571649116];
LW2_1 = [-3.9314667111043890557 3.1082118497591992856 -1.3188602496357830773 -0.090041581022184291605 0.38046319689863028479 3.6714622829921075287 -0.46829689545766428616 -0.26090304741796133126 -0.0040059554709655203347 1.4229991750956170193 -0.11411702551101088332 -1.4435649503642813407 4.9191424904240985683 2.3428709899648039183 0.56263251530247682108 1.1763126886283536976 0.18779358025901976559 -0.23857509394820403115 0.036639337359244544823 2.1776951126020129834 3.0395804232379322052 -0.59157456628373117358 0.011701282861765339993 -1.6727212419436148227 0.76255539539260563942 1.2045934505060891251 3.3543704336149842149 4.8413741125394045284 -0.30217684988153281633 2.1806478478199249338;0.75343906330343524136 -3.273049934764843627 -2.537430590332351521 -0.58597820262235245092 -0.083218858350045707417 7.0767283921567010196 0.24795527719458052007 0.95607964303511538962 0.96327371242269876905 -3.356416948917046561 1.1405369747419289439 2.1767164238768259565 0.92398849815151673504 0.65363621286725082093 0.40950983809022867277 6.6818396659707062213 2.3412066571156451289 1.4006982329802850629 -1.2244220694233454161 0.64485553571384479632 5.6903548159293535491 1.2286185355503733696 4.2619172768788189387 0.53542872354952775193 0.25560679939406028005 0.28180814205343057699 -0.63351824246702670429 -0.57210478215285975878 -2.4020131109583355844 -9.3459668673267479733;-4.5888197349782178236 2.1453609436705756153 4.1274550986826996635 0.038025994596328029085 0.32697457642299249114 -9.3494441075859686663 -7.0182160496856607068 0.093606454215138815145 0.081242691427712399044 -6.5031484068671669974 -4.5521493285471548162 -0.042224865661221522295 2.1602247313135940487 -10.54158719826385493 1.8281688322561797655 -3.4434023243534790382 -6.1868996677099765691 -4.5097380412107570535 8.9655791595960803164 10.18844902916359807 -5.4959927130192687272 2.7981473305964814635 -5.0614651640451935322 -13.685605468276245134 -0.54947796906701973363 5.1529176267000806888 -2.746655123748299232 -0.80108362274824240767 8.0460939423985262664 -0.099749126346926134112;4.3134320809524249185 -2.9660584208532494443 2.1356235886075429775 0.09251833707992687672 -0.19822437290064881532 -4.1931204470195684308 -0.36889856613207377967 1.1992962592464886384 0.016125971606370321371 -0.97055660149408573556 0.22356468074317009664 1.3041306371411687248 -6.3225516522688778309 -0.8421471518625130992 -0.46561774862203658687 -0.95251679923502852176 -0.024751216616915434898 1.0050917083068022784 -0.63078014745505650573 -2.7155373769835318143 -1.2369539125623494336 -0.59764639874214420256 0.080701191467767205423 3.0584535060679507446 -1.1362251162995875564 -0.34975663876161944277 -2.599645559665491934 1.1773829877660724197 2.2770157743681900264 -2.5378558655901533037;2.4560043785156397966 2.4203864183629550944 0.24230614193340105356 -0.14017360073003304333 0.96195607311129793793 3.5271572134643793817 9.6134058790990426502 -1.6340059476325048404 0.062471967304722778036 -0.14758872986706852992 -0.49919905844702083808 -0.73499239790412917994 -2.1224396206903239914 -7.4721217689322028122 0.55154739675579689262 -3.9822227657123185907 5.0069622840199539127 -2.2879688101081603335 -3.3179732959486032406 9.9564416301661520237 -2.134630132153582327 -3.4075201021948018365 -0.90166946441641693255 -3.4059467606402651363 3.0909474279956472564 2.0481417771464811572 4.6494391084780950507 8.5997179905500242825 3.3898913405778943186 -4.5009447593496734186;0.30629299759266848113 -10.587904906695085216 2.5423584767337610302 0.054160626360703442717 -0.57004694999357286012 -1.3203738758481589066 3.5213400690602933985 1.3889368535787760539 -0.22090810019587797663 -1.3679238412744529896 -0.52636473306368691816 -0.012915990934550081876 0.50106994153514006207 1.6115502727036348229 0.0759827759389776064 -0.24489956410582383595 2.7918818227989894432 1.7109319879641617934 1.7075754693958618002 5.7030585722340614296 5.3240485225086686683 1.8490156952041316707 0.83549703891160620461 -3.2125488662228725012 0.13705946389701628707 -1.0440442701869370179 -2.0240488112925287822 -0.47003444864080257126 -0.42492859598889842765 -0.60636160036857222888;-1.0145721488149828104 -6.9356360544446049587 2.3123002162921060254 -0.96166839194130082635 0.036865677741865429673 6.6417694543263259277 3.7716461728743970738 -5.7729095682533149159 3.604685494186563588 5.533420386912832889 0.87326734729840027605 -5.2165398041281187957 -2.4165523966323987359 -1.3490555468529299432 -4.6301430687052187452 0.41030078828426441717 -3.9896648235008416172 -3.4306880163388822069 2.668669238542838329 -5.6755680418547607147 2.6322469720432524198 -2.7941916551951724301 -0.80458386619224031566 3.0085231186223699851 1.8543670190895105154 -2.9156491445665411177 1.0309178733189989785 -1.7347783006481589663 -0.8129428563251908102 -0.47108010754910967233;-1.9215969636661585085 -0.88325355651365433651 0.73053081431056832162 1.3073861651081282176 -0.68381531962829955607 4.6874815665714217872 2.6381578425883609462 0.41279339582306812106 -0.8741422072887256034 -3.3491499235093575848 -0.38206917823212893648 0.52766795357365681163 -2.7589812987777828646 1.4301872147527205925 1.776947369929381626 0.95865563664969666302 -3.0629085947734440154 1.5230923498755513101 3.9807010268773250772 -1.4914103267033465006 -1.2409363113063878181 4.835915416800085076 0.30440987984385531329 1.3541743620436061946 -1.9984587869367091972 -1.0110618798954391639 -2.7824434116954468443 1.0982143419315981703 0.27351478546902696642 8.4086014233046828537;0.20725927080679648618 -2.4141542652242149458 0.14553991358788512245 0.038776452018766512098 0.14940789537517681906 -0.19885484727444294184 1.7806467514396489005 0.25321795137546054821 -0.37688264364171164544 -0.11438238202860111226 0.23203550487548571524 0.010530239207144728719 -0.2728929891799775076 -1.5392073655489144635 0.027480489669058322938 -0.77896376408164647032 0.30299815913955452373 0.31634415958370126765 -0.28778135764524331863 -1.2097245621508243563 -1.367744873854719323 0.24988099834785998388 0.4958524176183908283 0.031301831482258297978 0.22831196410927420692 0.05847145806343492791 0.38674574792841881488 -1.0022810153494920993 0.39872991702226689981 -0.029298782943949257945;-0.11154249654491432686 -2.5713397216957694091 -3.8204326641016117527 0.68719289260426130728 -1.798082768088051786 -5.0657820249526865908 -5.2946134121555354923 0.51071338428568135992 1.0453122472421887412 -4.1701319644914889295 0.019232434775414176953 1.7450103061195179066 3.2794265412488607936 5.1307881933283585596 -0.44708032985741830156 -1.5601195665400797719 -5.8933732009254864437 0.72484611225684592029 4.9297314163540288945 -0.23529117539661509317 -1.8837999756659649098 -1.6831534962615530837 -0.3138308949176329965 4.9472118329060457143 -1.8670660901220827999 -1.9549886408010439531 -2.258163179272129284 -4.3881826119837423761 -1.6974789845967617197 -0.68629382068098465641];

% Layer 3
b3 = 0.35114355840704125633;
LW3_2 = [-0.61163348040674392347 -0.037437686854276445991 0.17770641789819915934 -0.60666591039538331209 0.049941293131029740326 -0.41372747663956727093 -0.013266365968220401872 -0.053938933560812515888 -0.65997513894409987056 0.04843335401129478246];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
