function [Y,Xf,Af] = ESPER_nitrate_9_Atl_2(X,~,~)
%ESPER_NITRATE_9_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_9_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.0977752609853375088;3.0498607419475458613;-1.4908919082107909837;-2.8999774945017353645;1.7759554815171532116;-1.0366405900900368398;-1.3738063837937346534;-2.2293337690730150591;-0.01480026457716933537;-1.0404352982595441723;-1.9876063598980890923;1.9784769261183521305;1.1441708735023683463;-0.16751591344299462949;-2.1289484785398222755;0.032357418037655523435;3.1812874231208629894;3.2524107066134870792;-2.5265753118578975212;1.462253668527623951];
IW1_1 = [0.51436789394687021382 1.0537290767062734709 0.23861839389205216633 -0.53415103012313291941 1.2270807194586648148 -1.2577056112037325875 -0.21488065499864672514 2.3809876787756709682;0.1259183885210885534 -0.46239289932164528985 1.0781706121287102373 0.9557738398579491701 -1.4816006657548299597 0.43263294597016305199 -0.34964740182520498424 1.2782326465792019921;0.059932363817274680873 -0.088656376279040521871 -0.68167165812439589612 0.16081823914512219376 1.7663211778618281844 1.0398709807396202542 0.22647320822811659036 -0.21329887360180749267;-0.68480773840182629364 -0.51286829899805208566 -1.5877449580298350629 0.35470511629234591222 0.71633636660737143309 0.6805855430343522583 1.7068942327392493397 -2.3582867237292060025;-0.41916074771588407444 -0.26467965512786223448 0.16222859365252942365 -0.484662656082958887 -3.3637982348688613143 -1.178598004304982183 1.6585225507618444052 0.042504558616268867111;-0.44762569835315818567 0.10060293575583939552 0.30955552367404137737 -0.1641715407637041324 1.9629481469438474495 -0.96767811552263915953 0.83297837028625820732 -0.29692877611870505117;0.98424690269735792825 -1.0708664927293303215 -1.4624777962867867576 -1.1404409345226027561 0.90434567803390442098 1.4831375059772555769 -1.363281173513437583 0.20653800182290332765;0.56312316912211524134 0.013020133482380546672 0.66400001017483489818 -0.75960930947960503268 -0.42652363427555334274 -0.24558906332514437998 -0.84079296406484393955 -2.4236442856925366485;0.80934377182649075433 1.3141502386331020968 2.6914429218115181186 -0.53564889168095652927 -0.62149150750142223565 -0.56564880939994155451 -0.76160825842441970401 0.29994764815707980476;-0.86047115120302086755 -0.38457777611686894126 0.98243593493677960904 0.9459008095254116677 0.75175943765378838712 -0.55925730932224293479 1.6893321249065680334 -0.096278666958852565649;-0.027438730599580334751 -0.52509022188102760786 -1.0509120474317359406 -0.13087400431492832165 0.91351097137500658629 0.39024819886931505497 -0.66036102579728583883 -1.4398455007493218272;-1.0524569067756643914 -0.22388807748334305092 3.9340186209399927719 -1.0053103225070705307 -5.9851709235431513889 -0.087730742167474298765 -1.3482641084565234468 2.0362050522073835701;-0.4815380809158151254 -0.097392691974114348197 -0.20891642707372884424 -0.79977426177372878957 -2.3060473519263955389 1.8244655036579677798 -1.2912098679074448526 0.036865225926656933209;-0.53657879149632303761 -0.65076110623548955036 -2.3594385420893178029 -2.0784287794188824883 -2.2867596807269379156 -0.4039846538119281627 1.4637990756591232611 -0.59892370362054625499;-0.49494484424800022637 -0.1678137569546017116 -0.44962250860443825351 -1.0719993348280341117 2.7113380765384937909 0.38491332461739075077 -1.4430539360857206344 0.56701054179148180356;0.91674574940066189122 -1.4703747064557131097 -1.4573371592931616547 0.67970447535480826851 0.79705195722458255236 1.9393364949172058331 -0.67219013771944546853 -0.7233189718066330709;0.054233766731033528075 0.0058914969228523392242 -0.51045520825159629297 1.3462784749194918188 2.7883903012682211831 1.2887235444422107111 0.83926766832097710047 2.6932338338113024356;-0.44993677651109864613 -0.44891681941820860136 -1.1882175124634040131 1.68027569039221647 -3.1673141825550943373 -0.29566429108126868197 2.0301371919798003596 -0.79046008379995147397;-0.16760651619917030231 -0.052080564353589479942 0.65123629688898643231 -1.0788180368102904261 1.8790539693609720207 2.2329561162637756588 -1.1498480590485100628 -0.7258731802529793109;1.088473919803130352 -0.74786250186570968346 0.99025684927280877012 0.22316740778611857121 -0.48116792278156395035 0.73497551016560291881 0.57266759633511132854 -1.0050122015116877972];

% Layer 2
b2 = [1.3019423167453045842;3.0097034395097486126;2.2061768456007002648;-1.7017390785914088269;2.282218050995152403;-1.5097635265632809443;-0.43437497533277863448;1.619338090052596657;0.79785908122108428753;0.40095879048761895458;0.71803943963226146696;-0.29436922849766922194;-0.52133959025315501634;-0.099033705200363614241;0.59255548426910942261;2.0825849714364199627;0.068627105697012386054;1.0904173320119447954;1.0317704234594389234;-2.6486344845146136961];
LW2_1 = [-0.037038527817257443919 0.46435481022462732348 -1.6963182070114994904 0.37555536002648337579 -1.7317932968298574981 -0.19086025002466655565 -0.9661135821398350032 -0.4644700182486330986 -1.4027179884832821077 0.75467230005834651241 -0.06535292059375469309 0.51038960439932412605 -0.68800639207144009823 -0.22667831803976046245 -0.3055744319939545095 -0.083201418144401281807 0.07893447926518679103 -1.0367116971073950804 0.16394981378620579471 -0.068136798019815605909;0.95069185511113751819 2.4112349476144814275 -0.44659614413758619289 1.2151122849259317071 -0.10130128425434895001 -1.5661211724235957199 -1.131180372249963817 1.9808191773299488325 -0.18792351094687786972 -0.56846843447224038037 0.95720893997734446401 2.6454992411163753552 -0.037559760774805779626 0.29451238464241769055 -0.62588929373643475973 0.17245149433983569809 1.6019969764930224176 0.0048423946575432974537 -0.05795575132077993713 0.55982012225988608822;-0.60569687459844057109 0.89222715899360116598 -0.71329447312725346997 -2.0363231561395100933 0.33507701037703424563 0.33347270509685955631 1.3693018526704692217 -0.025493388846641047707 -0.47485064335546534053 1.2662141926019727656 0.32771212891272133438 -0.82108863736764448049 -0.19218448511962249459 1.8798758223713889493 -0.66442769201597173812 0.025255541618982840085 -2.0057989295864757651 -0.36623215602031206073 -0.6010882374774043635 0.90389068569274222398;-0.22472674950290491558 0.5514507334320682963 0.51039211523623362332 0.74619298944556522457 -0.70707181212797709513 0.60694832618168437222 -0.882698007916675631 -0.58727046340954791592 -0.31438819756307323505 -1.4204268858101687378 -1.6453220572610027794 -0.25284009198120388495 -0.78463679917181305967 0.46939777334406551645 1.7407995939526326179 -0.056946889127093586191 -0.28005577536511599979 -0.69909882723578498087 0.50482795980403860625 0.12394148715877484346;0.25536183830934899852 1.1583095978036948015 -0.4719093462620438939 0.90650056694437608495 -0.13589977769316244349 -0.55376177848760044231 -0.08223523843261310029 0.93687949422591676463 -0.23012673141753614559 0.087263327641951132785 -0.33530211585708052935 0.0012717653853621096322 -0.29335912556305282495 0.20792436972768829628 0.42855880669972140629 -0.28406180145652487612 -0.97513520180289814387 0.14623530045974877933 0.13878215269187146874 0.33408980377546143581;0.3975947203589708101 -0.56536374081361806532 0.22634479775977009441 -1.4730512998520750578 1.6343619027247928699 0.27962106547473941642 1.5112430613544516333 -0.57036895186918434852 -0.033588429111562685681 1.3179656387130438411 -1.6203289511771648002 0.068359399223203984319 0.62323234312169251137 0.62221300403076007512 -1.0074324503222069627 -0.72615840894285721419 1.167369285297525261 0.5284647919467971855 0.3862344371647442598 -0.60068144711780602218;-0.6353944105780154894 0.13879955307063626679 -2.2053236785717280632 1.0075527298861624015 -1.123710092114503567 0.76592803701055489629 -0.047253966417705947634 -0.05503868803344423577 -0.42584405451312651314 -0.26499382609380828235 -1.7256206273857035427 0.25909068759510034408 0.38666591586976128969 0.26326589166904812434 0.60458732809070814262 0.03637584866461496258 -0.74666193442340178521 -0.21151460906025615349 -1.0451836514572527825 -0.87356507258043170072;-0.11473470852764901251 0.38903049887933827122 0.221398882371315886 0.53424342698406068752 -0.83254688891972472575 0.55117619264619144293 -0.14519122316294133523 -1.065855506249856699 -0.47751545061892758381 -0.22938761745960137284 1.0985825719563599989 0.081139880663738769839 -0.88223289754555400677 -0.54145512392147721048 0.98028953108975569464 0.22205558064849018063 -1.8809841955274073655 -0.27009975462990093442 -0.21833302518058991804 0.76634434039662080451;0.44538724018860764708 0.33777171524329463459 0.17012327474748417666 1.1805319038858255176 0.58565237351491605811 -1.1373205113317719217 -1.6685955383667947505 0.014407979592167238433 0.20057186248791442074 -0.5099696363478853911 -1.8783998511867245895 -0.072317593438893934543 0.28470591935394462535 0.030527988106697746817 1.1588058758574266704 1.9944161835151978934 0.50410683622450580543 -0.072759462265722926744 -0.60064583964316764497 1.4458101360716322237;-0.052460671425258759148 -0.35352468730768032978 -2.6799354259191168204 -0.013214710305899411008 -0.45897217431818060351 -1.5751146059996750104 0.35355291547782952133 -0.83672002116692656415 0.31370113947666034004 0.81164325177791674104 0.39887932817378779493 0.19873680028437826217 -0.24773307919584414138 -0.13390655924252903297 -1.6455732675086323091 -0.0078045137517061590263 -0.37142876167413529931 1.4368523239171564487 -0.098315980587827228598 1.5190267589052453001;-0.11394758913643444898 -0.6441621261223029471 -0.22766696897584806636 -0.2422070404725459869 -0.0659670160709408121 -0.12631414809043578495 -0.1554313952202910909 -0.42257938358628771569 0.21470699673580323497 -0.080946371681734463621 0.2105735827056164633 -0.23746383981508017991 -0.35770130735524802157 -0.070587714303687085216 0.14699713498387512178 -0.15784907434852696317 -1.0058131080930643453 0.14201561760365633003 0.25902319359070441473 0.025269097968252295094;-0.072374179633938107159 -0.65325408197572831792 0.14386613591084784769 0.16744780932539993223 0.2440606860934238509 -0.8735361171785805956 -0.5011010141805727347 -0.35765657084693946999 0.24335179249814181679 -0.19515489879356776037 -0.080748532252858259972 -0.65766606194415810904 -1.5877017668735811107 0.051343359568084841194 0.91898368836456845177 -0.34314728743744488115 -0.33445748459141755315 0.34255997774933394373 1.4665088195763618106 0.79056469685512031909;-0.09700978046070846128 0.7522792513567765349 -1.5694239753519101388 1.2910926474955537469 0.62599725857325350109 -0.31175638982519565667 0.42097708892286223037 0.43926006303037556933 0.094246717259172066439 -0.42782715223137718352 -0.082206621578621283386 0.16745852773945341108 0.62135879724281950498 0.70602502967820568447 -0.60645780523101278092 -0.46406624715651834112 0.45736311712640803639 -0.41371022786279371131 -0.41464999910091115964 -1.1922029600255077408;0.79507839364038102037 0.31906040954669406817 -1.1140436921162011341 1.9988106411302983823 1.2768768575077447114 -0.075088792599353915147 -0.0039623574420870871088 -0.22607462122169524887 1.0032389706055375722 -0.91197938098478725788 0.2363958175741241452 0.18405225640295425071 -0.32092823559522126731 -0.08962863030785975238 -0.14219536530799983809 -0.58560581953616852591 0.63729324620242644439 0.0014267938289753111236 0.62488713008848728592 -0.54948428063416965283;1.153433156538665294 -0.17816225723139511583 -0.9444466436798205633 -0.66601672830533542591 -0.91182489049200221576 0.44454094747016992262 1.1645571098768345841 -1.6950508479999877309 0.028370589447310405606 -0.1420565772394195847 0.55222302192365946283 -1.0709683577844546498 -1.6700555485440473635 -0.81949792497409434944 -0.071317096492869019864 -1.4387375824088062259 -0.30852125626253312785 0.41199279525219939524 0.75920009266213617227 0.22933376136356006803;1.2785178175313209881 -1.1861475129778769055 2.1909452487359839523 -1.0405823835691712098 0.32857003640178161774 -0.77359018596035067361 0.69873518988561456045 -0.29589524729158461769 0.8921299288113188064 0.58944342183253839451 2.2135974815386170178 -0.72267653784691865404 -1.365353449003186892 -0.93395847618327498818 0.44352221068922137448 -0.54833026777201343549 -0.15110509785678746808 1.5033068586233937491 1.870249048355919097 1.2490702825715869206;0.23210488417693667107 -0.73569862037319933012 1.6907107702655488346 -0.55983666673970511329 0.39039633724130190506 0.24538973425887491975 0.1320732949353335961 0.23477081105641181558 0.27869054028356965436 0.40496340521122031753 0.44627888441562119093 -0.78198703656481383106 -0.96399041059214773952 -0.12868423659642191925 0.80075428168463669287 -0.81649765230027393503 -0.61070936574413725584 0.47434511748799151887 1.166458501636941536 0.74655610232356617306;0.097691047984623899381 -0.73644248655609512166 0.21522500285166049072 -0.4215615922038458141 0.36419412410530599411 -0.65793157304943072905 -0.20252669379235901936 0.2045391246033513577 0.34914021831538971652 0.091171417431750972904 -0.0025586547632786525719 -0.52720716856451232957 -0.28238284212903475012 0.041046077295670904683 0.23066813175913419842 -0.29959038679466526434 -1.1186841197660615244 0.25310141038876848851 0.2640852664475238365 -0.27869555952548469291;0.57159095948536953191 1.5586761058699845073 -0.45303485082833633291 -0.7022739739294223682 -2.5688728373349687395 0.076276934307791324774 1.0390766767192998188 2.3343859976736966999 -0.85466258814863105275 -0.93713642765652727107 -0.37552210407770852951 1.0314486439103176529 -0.52936342245866863099 -0.78253690819261256806 -1.0974307126804501156 0.79514650261728425651 2.9173636622549121711 -1.0318763829568888823 -0.5392828615921696489 0.13147015376960441424;1.659696785261902674 -0.21938880250507294956 -1.0883868076815694792 1.14579718723683599 -0.47519531781758339584 1.2521716408319831793 -1.8447944635214021947 1.314703459055265089 0.22922141600790341132 0.53596728288171291421 1.5999718901913606572 -4.230792389854619806 1.5828058609335231566 0.5047030815773196899 -0.81287178787682223824 0.44333945618542203171 0.25428510808590876202 0.24439718969020490791 0.53130784302002509456 -1.1078065283732736468];

% Layer 3
b3 = 1.9664756536873062576;
LW3_2 = [-0.2462222713179237632 0.51121987418515790758 -0.78062003333433382934 -0.46313624669629122055 -1.4624097370933768492 0.096931567025131754045 0.53732226791426940249 0.33855709122913590914 -0.67935464372780995923 -0.33176217333505336748 -2.404662982355078249 1.2057319796693914959 -0.60214352940047166651 0.32445175213003041303 -0.1391935306124633398 0.30683061592216059887 -1.0487947058591293725 1.2160012330933971381 -0.10120616895426470805 -0.20524439074477843215];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
