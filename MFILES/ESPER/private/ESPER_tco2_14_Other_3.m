function [Y,Xf,Af] = ESPER_tco2_14_Other_3(X,~,~)
%ESPER_TCO2_14_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_14_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042];
x1_step1.ymin = -1;

% Layer 1
b1 = [20.7430981557746;-2.4901738113906768;-1.0059937777611621;1.7644217099775266;-35.880399407807779;2.1017168138679012;-1.5839727551627871;0.84701458780689365;-1.652636056986605;-1.2827213816680023;-0.82796547821070954;-2.5814160007991958;-0.18583307570761995;0.41516245589611289;1.6002696997713799;1.1335013598947594;0.17933050610638071;-0.94247980430705092;-1.1497028540736225;0.54715011691597115;2.4021279149264174;2.6410373343953033;0.78741125119632704;1.5906728454154659;-2.2442816883766601];
IW1_1 = [-5.3112796862482741 -13.099583780238603 -18.695722075110833 -0.67414202417607094 -0.21000499499094369 0.54090211664974186;0.77496949645015667 -0.78244174968152724 -2.5360802846305948 0.47639609790644938 -5.4802043025766016 -1.8442973255999677;-0.223191153585858 0.26082997745705666 -2.0404215212700376 -0.47451999858028754 -1.7349280298742635 -0.33843024365804686;0.34760923377706493 -0.35682456619939168 -1.4255507101998754 0.63113141929231453 0.032880015742237 0.41249115330473507;-0.10284305965249742 0.39293023864273485 2.6254050106123663 -9.0867778216319142 0.12035699725027885 -27.697056870944394;-0.75046230144934478 0.19982937937222289 1.0915576699770742 0.075202124623616182 -1.9262905608047673 -0.41888656796194151;-0.15143195535500267 -2.2476262850971565 1.3760041829307144 1.2595662911923717 -1.5811007329145585 -1.2993327524259779;-0.27184795471700701 -0.26677770881074486 -0.58698298278484617 -1.0205685897984451 -2.5676917402830424 -1.0305076219713032;0.10233181653189875 -0.18594889371512269 0.65348952079495481 -1.5330998127299791 1.9034794049354715 -0.010044198878955631;0.47637594637933678 -0.4402997919367776 0.21444479897489821 -1.2365680543340019 0.56806873840722005 -0.1787816525627719;0.49112334117684492 -0.039144614206914785 -0.8019850723756603 0.54877165447235787 1.3337681131861523 0.80375296450007605;1.1797272656530435 -2.4602152687210999 2.9112571248515273 -2.3534350395224464 -5.7706797978174604 0.80488512714083571;0.12240010229462023 0.016019528323902507 -0.15564801475259568 0.39656487053516204 1.3186598038947768 -0.33963266287250943;0.40991572251948982 -0.32231649531120238 -0.16151744260473161 0.20596093607579463 -1.7286886894945332 0.17436110959996909;1.6481020260340082 0.53011473099388562 -0.15642167046724095 0.15542730564767596 0.82197927166360041 1.7653314619300355;-0.030615318481147735 0.41912541405196091 -0.31529970042429822 -0.025604447649534321 -3.4291659250096052 -0.033292076985993624;0.25645599939312574 -0.25946740641067645 0.96692481554013376 0.61877429528386851 2.4079379198335613 -0.16620555703744549;0.21729212440153617 -0.27267063576425654 1.7657946100585897 -0.078820865922271305 1.5916717692214948 1.9545067440705435;-0.46338594394694288 0.46325835944754212 2.8145260136299162 -0.11069037965263973 0.052051775195080661 -0.12514806867879322;0.10884824040875341 -0.22748528605374252 -0.16472764638407184 0.035303533699775937 -0.11427596736857096 -0.48740084877926271;0.38937459454342616 0.16928337224372683 -3.6819232312076733 2.4465099419192811 0.75881429014614388 -0.37972596965941868;0.27939954647142301 -0.23691029221565688 1.1089806493434542 1.2254216493388004 -0.1138286700007316 -0.59432683942191955;0.20979351128991805 -0.10925179730236227 0.35831007300955497 0.99810595531453017 1.2579574964432336 -0.0047422480409033199;0.35003685264185547 -0.4858496009773331 -0.96631068969025902 0.31144320739827269 0.32280038331521621 -0.25963314409303323;-0.19545715715737058 0.42195619221683656 -1.1839716559967113 -0.56703482441105368 0.49804016513447663 0.90227048657428088];

% Layer 2
b2 = [-3.5522449943524612;1.7497490435132581;0.67527462002111838;6.5774055953397026;-10.241458101655098;-9.1593732802590591;-0.20860697632411596;-6.5901127404619988;0.77565902260879227;14.84675325046506;-8.700238340846159;3.2348200267158149;4.0545592844908533;2.2011410568098304;-0.13924108765793633];
LW2_1 = [2.0587008739368478 3.3781801182741145 -0.52274739591955377 -0.30997218250268321 -2.0928851522606804 1.3852528667279358 -4.4763365398608173 -3.1719295085159787 5.0221237733120736 -2.5754695175114248 -1.7139329820477862 2.0906150159390298 -4.6372817433884173 2.3871308032428851 -2.5890330384129148 2.5013981666568803 -0.055125813633926796 2.3339043957922825 4.3723947289034539 9.8463694952841845 5.5884938536450326 2.1073113355760738 2.1714533933038194 2.2506467544913442 6.3632239245608098;0.00062953082945018442 -0.42270665329402385 1.0311012013444449 -1.8865062554961798 -0.62193683363550178 -1.5165393859964487 -0.67001217536487423 0.16281571845889864 2.1831742097001694 -1.9874065588393968 -1.6918329375520871 -0.50814893902558744 3.7745836542484503 5.1462808831435671 -1.0917616000070456 0.62324193748577184 -0.77817092409650623 9.8353257348623773e-05 1.0790400733182473 -5.0758040849439912 0.33166157442466354 -0.97143458493440282 1.3256301324336095 3.9344755175536399 -0.71413669216236997;-0.5312639146234055 1.0159698765550909 -0.79033824506523287 -4.4429602106149249 -0.51985003501208826 -0.33476785663455383 -0.067490468435756526 1.2132407370513341 1.1455238835767001 -0.77889982960675663 -3.6160530984236581 -0.10217357259089134 5.0670371093906086 4.1354169709614865 -0.39525369389643467 0.98492806274711353 -4.5864577200389194 0.68926220893171353 -0.1041059492898917 -3.4274915336139 -0.26781557686866558 -6.1283970665821377 5.7583817688288912 7.2438244506167084 -2.2499085309556053;1.8519397261541573 -7.5160709955181106 6.3107821484201203 -2.5729658425662048 -2.1282865633192016 0.89950097317627098 -0.42239256678139586 -5.0053040393938844 13.405980524846926 -5.6189268657481177 -5.0376431126038304 -0.1723566268239963 -3.5834689213523236 17.532090580876758 -0.7007681342474108 0.15875577378640976 -0.38470451541336087 -4.510613600133242 1.1356349653928735 -8.0468737786769839 2.6420650070361127 -1.8571095347677102 9.1858514788017196 -4.1761536350384771 4.3865500001367774;3.6721155862913704 0.34494551929181794 -1.1417099446989525 -5.727177129503441 5.0737483800688041 14.068156061342306 1.6575033801614893 4.6848136319855813 4.5601960521554936 2.7917542442150993 5.090036583486917 -3.3241731540395461 -6.3586668784187133 7.8819355509817832 -3.4578089634564728 -5.128755270770025 4.0795153912089788 -3.6104898719871619 2.1221580420016033 -12.326908534357056 3.6127630893346891 19.058041242805654 -8.0387873769642191 7.9669876337708416 9.7553511775600121;-1.0832446046549067 1.8080440598210235 2.6901704531186601 -17.46299149058984 -5.8024361146074828 1.3573699046646608 2.0969175658435222 -9.8065140944463902 -1.9979092579012259 1.3902517406824069 -11.186604034785031 -3.7395001520147986 -6.7463807580395905 5.6130801669742967 3.0616178105199023 -2.7042774677743893 0.35389745690397545 -8.6768836631186979 0.018976126322372087 21.223420243965027 -3.228916211953456 -8.4222269306509414 8.0565978588031815 7.606457412546769 -0.27433399788523011;-0.15553015939722711 -4.7947701654716885 -4.5170007918002169 6.2962787922102077 4.8524087654460804 3.1568426703105774 2.9927510498318672 -0.7841384685862921 -2.3367132633243051 1.0453956457170335 -0.54691979058010431 1.3462713730943372 9.4605117247044159 -0.90497595836071443 0.876359197854084 -2.993643569462574 -1.3277970547308939 -1.8240037137915963 1.5392388653474132 4.4343990525153467 -2.6869463280688883 3.0070982797686221 -10.092099509191923 -2.5708042159884124 -2.0729090423589995;1.5169116441151314 -3.1994820502434735 1.7147451129302882 -0.65121270178263668 -17.513165000267861 -3.2740482935311639 0.66786555415528059 1.2718334159473885 4.4644973435436617 -3.7586431599096541 -10.537534206880769 -0.68373508742025069 8.7470870635007856 12.3710770664572 -2.0895320582056063 -0.088500201787355098 -6.4767456914257435 2.3874091037935092 -1.5553127550217258 -1.146254418884405 -1.2477125402460667 -9.0762097708426452 15.326922126691784 -7.0232795156463439 4.0079752189888751;-0.064277274089393557 -0.07134583083559265 0.36539359364311647 0.67126160923803413 -0.18859578565248228 0.47368068924135315 -0.0081553662849457812 -0.018815329937281973 1.9316579439254946 -1.454058816710462 0.30178883734063239 -0.13401812676207386 -0.019694624808193447 1.6276136844842162 -0.10816510768677474 0.20728765615027869 -1.4744055207078941 -0.0074117730638950056 1.0425252928817479 1.2637585205087436 0.19514642784270822 -1.1015655255752839 2.8420567954064837 0.090666856168652721 0.087579907039057547;7.4120808455054492 -5.0845447725066535 -1.3930010764314236 -4.5515665161622518 32.221711780762199 -0.30086198251730478 -3.0727002598280664 1.2461808329088875 -6.7269219316636999 -0.84573276842370515 -2.891825610301372 1.6769686586581718 -10.72525917547495 6.2428089895859387 -0.865188228622633 1.905497489871101 5.7137377955230413 -1.6853941459671358 1.7511371030605347 3.7090494583386251 0.79497256663314242 2.2418114540141763 0.85984491986536316 1.8616616690562038 7.2318434459018865;-3.3535221700413032 1.0979097409526666 4.894705097550955 5.0005524397459498 -5.9978304174373296 4.7631734611569163 1.8541690154715402 1.5202435089051962 -3.7044260356433814 2.1896989823274766 1.2280900761389419 1.7146384273092983 -1.9894549388977913 2.4621741193213427 3.1296427753338936 -3.4473308892302601 10.659867344924937 -2.0960253241246245 -8.026923303055197 -18.203382671868706 -1.4991176291376473 2.5079001558630369 -8.3775109632303675 -8.5253926351322225 -13.572490821601722;0.058456134120826078 13.959767274832789 -8.230178421867679 6.5560237412818649 -0.49243457244490207 -3.7667147440310398 2.7130107727887616 4.3402480325497308 4.5377003168180368 -2.2709131597843881 3.3476439532389186 0.13668776920196868 -9.7153956771977423 -7.777018028909878 0.20119516559580874 3.9673152076040687 -0.99484104982460642 -1.0546247875622365 3.7517508057131419 4.7899155954156374 1.7476222922358831 -2.1656846296110523 13.186961035116457 -0.57923427076654088 3.807945360357984;0.18470699321422551 -1.2577946763279706 -10.059386776384569 3.6761964463804961 6.2641718875478496 -0.30465064495289074 1.9233100944665722 -4.5850653233756971 -6.2854214663437435 3.7229695446934286 -7.9888803850027603 -1.3579363201248242 17.006115892657725 7.5184064973305187 -2.3558004653798519 -4.0754025935453662 -13.470316324992856 -0.0082434728883138287 -1.5354566818188453 3.0921171861010657 0.16446536453958391 9.5220601435808323 -5.9387199030598143 0.60835144397986651 14.50746853631262;-3.9723730103293589 -1.4357081254853636 -2.0122424676697475 -0.44744773683958411 1.2058831203037259 2.7249941542197589 -0.62308675100922095 -0.1317284533645289 -0.6538078701016522 -0.60926065043472155 2.0412248258029888 -0.91586187978760925 -7.1389891918734723 1.7540970196847177 -1.1479873902418991 -5.9691526625438263 -1.6214746702744898 -1.6363808304496494 1.2782878981268402 -6.5331521256547012 2.4981422807007037 -1.5889048096478962 0.98158862273472236 -1.1190573105983543 -2.1103907983395991;-5.8935884656055411 -4.0348378263096922 -0.075417933269017315 -5.74931407971724 -3.8158165056206839 5.7935008700012824 -2.8594648003605485 -7.1199095137246102 -6.61748064539632 2.961425690684603 5.6312323260816699 1.669675825231135 -2.593121036096365 -5.5055962477624796 3.9836245615659225 -3.1621308775110473 3.6526870837495635 1.9557654289093174 -0.64876901770265727 28.537465444237416 -0.032187267825489675 13.124840285633123 -17.009733456213805 -7.7877710749855904 11.534103256231546];

% Layer 3
b3 = -0.67560850961012497;
LW3_2 = [0.040315721824530817 -0.31043971167340184 -0.20713708524183866 -0.040956228165064709 -0.018146201386702913 -0.025034157850491061 -0.040932360412399907 0.044168331716919175 1.5369411555150323 -0.020233236688714698 0.025389222399940851 -0.054025583495798016 -0.039175868663550301 0.072104349542912005 -0.035980707411708411];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
