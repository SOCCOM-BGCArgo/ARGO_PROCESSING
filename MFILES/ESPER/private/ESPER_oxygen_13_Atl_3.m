function [Y,Xf,Af] = ESPER_oxygen_13_Atl_3(X,~,~)
%ESPER_OXYGEN_13_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_13_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.1013961368753726333;-1.4174032463147145933;4.0533865562366075963;7.4325017534244226525;7.3316984499223876171;1.9827338746897706923;1.9498595264895905999;4.399933751631505352;-2.2669600523291459915;1.090405052753637527;1.0209426873829350324;-1.4080868278064364585;-4.3992752323603010467;-1.4207046814030417359;2.1282129267997422772;-6.7904329506911915715;1.8421096061066315475;0.99422330742675613102;-2.1009569910333296683;10.561230265612509882;-0.59658137190898852253;3.561546249153533239;4.2134365194750715844;13.711861560287008643;4.3122240415272683478];
IW1_1 = [-0.84703637696703093507 7.2659173108830268362 -1.0567964971838572641 2.5623590488218663808 3.5532124825302862092 -2.7390450619074635519 2.7083795840900166674;-1.0955821558784346603 0.52752518618254162774 -2.5146187513911231193 -1.1209209717416943608 4.3544133156957585129 1.6414884007726653348 -0.6582028551208690681;0.32662115692754062346 -0.44350715688328889996 -0.3637610769885508688 -0.85455219634020318509 -7.6058444999060697 0.14263751543483965678 -0.5323618444397169025;2.0549394294723177801 -1.1564785751487496324 -5.4044892060623990204 0.56623733950390242597 -3.5477598578197668822 -0.20467193221439666795 3.77311425340047224;-0.24546588993596327177 1.2839282757626413467 4.2831832008753929486 1.0662646233365433712 -11.525329269211818328 3.0871340791782575508 -1.1776870306312878789;0.44464795300305431924 0.14852951303838127228 -2.06636707560213706 0.29458083875784152328 -1.8368547241603987441 -0.47890516035483943202 0.68559805367689541367;0.45418218750329519828 -1.253639242174032109 0.41379610044102288491 2.2006342938307406065 0.26771527278357876156 0.21509093522998815051 -0.70575612753397420907;-0.26921241994002970133 0.58677120434304208541 -0.23148127689142242169 -1.2806957360153010672 -6.4304157211196262267 0.18802254908065291206 -1.5175948432009152;0.78866720417208857619 -0.98305863164646078989 -0.82771621879384715825 -1.9127020269890966375 -1.2285140882906870896 -0.11834993658435272179 -0.056129219527302674775;0.43228553743260694775 -0.46407515316854219822 -0.083632952268232377269 1.5588954536124335348 -1.5777088151526743598 -0.50748372646522110774 1.0635021213135888996;-0.074475073352812601324 -0.042458371691581377194 0.49479914684626680188 -0.071252185533028963849 -1.8894634007425041844 -0.22199048959096015499 -0.49598824108220657125;-0.8006842688474248293 0.74802024480369888604 -0.4190699753035220243 1.2392177583528038998 4.0568276761647616979 -0.30778472319274013946 -0.36867943241608908123;6.5866902281897203864 -6.1794255161025688494 0.22719349917000822292 -2.7034214150685338396 -8.82040926470204667 -0.18681324477419758434 1.0260348382257953315;0.51987656217622724153 0.2192432355313929937 -0.37398243960852922685 -0.73898818629540252712 0.80312740456543207923 -0.38885804666454393264 -0.30544446548906872829;0.40676573983983743688 -0.39137271511923887868 0.72307963313112766368 -1.2018812654309509735 -5.6808303963496777911 0.095575575987875999173 0.27003557937964156599;-0.09567847314443679585 1.358467949718693113 2.4664350715524707702 -1.9400768397151260114 3.2332492984678178338 0.4569665350624671496 -1.279268115281482654;1.0621333384052766835 -6.3346783133276538535 -3.8100637315948819861 5.0508610475821784647 -2.9897782269422288337 -3.6599367245199121434 3.9040131546249572381;0.3135694660597264094 -0.097405231249084414658 0.30259453988567008853 0.2331783177384427197 -1.4249663238863312653 -0.98500376090885355396 -0.025073488803697384364;-0.86216698817827008838 1.3471213507086152728 -1.461222281946122914 -2.4809646745834967874 -0.46327342060632209497 1.3700842867258420377 -0.7507076316694251128;0.83822073791645212992 -0.31242771922707007759 -3.2627304973411979105 4.1475822805831263906 -7.3742200738383809622 0.7425045644275164447 -1.6605514836626003028;-0.75605275257859727578 -3.5710797819107633622 1.8794891393220845011 -0.25509168656309155754 -4.0210338285245050827 1.4899076067083356634 -0.50906452483413355825;-0.50544247664666897002 1.9379702229618060993 -1.30434473771603332 0.83935081095101737869 -0.9310512207350268854 0.42099853078382465377 -0.040190219654021350215;0.087939206399486893884 -1.2435406258490266929 -0.76683229249923068327 1.9935787225746774975 -1.591689141016379816 -0.049059234842764060103 0.2660638846548564751;1.9340433427433925129 -0.81272640558516728859 1.3591597105063419892 0.62058757685213072897 -17.061224512949195287 0.92494926481044825728 -2.1509911403386205997;1.9367232897497672628 0.99322448005008356908 -7.2696883401035377048 -0.49655890605449459763 2.4955047946693227345 2.3967342119692087721 -2.8361651665371434561];

% Layer 2
b2 = [6.1378285182217044991;1.8899292204405813145;-1.1958993465853531291;-5.2889934868004653268;2.1121463639093813747;-8.9692428887949198213;-0.23257845223842557592;2.4818937731175196859;0.030271000727507067773;0.26845506912234556873;-5.7457424007624116058;-10.737945175859243463;6.9141451001397413734;1.8788136673852811054;0.39445629798577930281];
LW2_1 = [-1.2477513187608004763 -0.4350208297835294613 0.53327233572637555703 2.1356080598311826257 -0.13226611522641751328 0.99964364105643965797 2.5325890940550532804 -3.9017113375853349488 -1.2782257811435611128 -2.1694540410886360426 3.1554147211824710162 0.75030846478871471295 0.43021044394540064459 4.7768763047526254795 -2.2108736997745954689 0.10334401518800977182 0.19458460127363477743 -3.2767789986465638563 -0.059800232532947819597 0.65649314742602182804 -0.85470751023392832479 -0.19185693570146547526 -2.4797899489800716566 -4.8541598941309942461 -2.7451164203554312415;-0.2663033669250047808 1.4147586541641647973 1.4471405829160983725 -1.088505258697498812 0.88307956544806831545 2.139176916983815957 1.5306642181625649268 1.6809893248281884137 -2.0686192901083213513 1.4755314667982764032 -4.1081636731739257229 -2.3570331725500039965 -0.029217254294964613293 -1.7585999186536243055 -1.3312012700509103791 -0.39661943927166409818 -0.15228070505224089448 4.154809657078016194 1.0054322588170896413 0.35037960130627321398 -0.12827381154181990985 -0.95762473674673354029 -4.6805633009336773398 -1.4904246108397691817 -0.63230805929231548301;-0.38226018410794893043 -0.67775650360911843251 -0.059684581446774805091 1.2212520212926776253 0.79272109613205099521 5.1909250880820643204 3.5854681222138085062 4.0258283597534587628 -8.8666348542408179867 4.7925089558146511948 6.2946793154388194225 -3.5993634379088459418 0.5565328497441982547 2.5213168648867081423 -5.1807502023880962483 -5.2149446383730575505 0.59397898421300820981 -5.9147770849438083829 1.2741598270858542907 0.79837099804561084682 0.38977316466847489185 -1.4109677071769188839 -7.7012417262693846354 0.5865144439749856442 -0.2759924986072079256;-0.5293725506159092653 4.9506419496126525814 -4.1756124151766744745 -9.9376586344413198049 0.04227425184185912288 -4.4297536988891348386 6.5299490509236983726 2.7860947902630166517 4.6938912248585760167 8.9052495650648957337 8.3114641482671469674 -3.0498681870231112434 -0.061842978008586756145 4.7559758586448177553 -7.9712422187222715664 3.3301614014807197073 -1.9364458141086862142 -11.19990727370139183 0.46187837967855432941 9.127431960664846855 -7.9097681490070286259 1.8722115141949637884 11.12843765045782618 -4.0888534814409078777 -11.639935827203744978;1.3476003304865864507 0.83440151544609608703 5.4544585599941326493 1.340020966304570571 1.2214922532827741097 -3.0253051778059383281 -2.9555156841698155823 1.5678886374518254954 0.53148627383814928127 1.3869113505815249265 -3.2362329353940011423 3.3987407896053656309 -0.5163764642537979066 -0.28336828137666802974 0.74341798750594945133 -0.5956879619022007466 0.58222168358782444564 -7.4429018560533553028 -0.86544921731684965049 0.5518018447864833087 -0.76349738095976604768 0.3738985439756183915 3.3257283637497927486 0.93107558917888033623 -0.67849531885479641424;2.9744561413109562586 5.1412528052556965008 -1.8450271505168285291 0.62546822988089501028 3.8193600350978460511 4.9613328133509666529 -0.92704490430948538471 -4.928450816692129699 0.88040508604150813365 -5.4749353079955023205 -2.7376032721714751439 -2.0536043699903716586 -3.5293351472242364686 0.49300504655563553991 1.5388486527342506438 9.3552209983797247617 4.7015286122353776577 4.033918366087217322 -3.6895439108205487777 11.086457435228016521 1.0205827690015751852 4.7004758042930987472 -7.7055736761144935087 -1.4882742922813043673 -5.234292336351255237;-1.918449141797122115 0.94761345997725032753 -14.980678874257030486 1.1036791859736574395 -2.5134661140684175784 -4.7360302675676466677 12.722507544532572155 -3.2785389486531988368 10.224242031153581323 -0.37700156901395676101 16.384626929925389049 -8.6413393259940090019 0.44006790734800471654 2.0821801862674420569 1.2808006788560870604 2.5434744297870404139 -0.88273685375078581039 9.4044187219511474751 14.856955990976116411 -1.8788803014125305957 2.483485088126594853 11.859978625382417761 1.4759170395171867796 -2.2337815601576265223 -0.04761683919320720132;-0.076950905590477583496 -0.23724454261150904055 -1.6725164645034447108 -0.3235524385693497873 0.23802439345730597164 0.68199760846905554956 -0.79240389457425963737 -0.88516003659493969202 0.60973977955838154497 -1.2107898244729984327 -2.582459831120884175 0.021970334554948983685 0.055604155197040018577 -0.92584048501681226462 0.47452215957508242505 3.753754316488659093 -0.43818081339011133446 1.9851043577763842762 1.1515545737773940083 -0.42391097203837935226 0.47188600626443832908 -1.2268066644283648348 4.663406175512921692 -0.90245290503079633737 -0.29731444935678469355;-0.72524974506762307502 -0.133922461743979343 -0.79134990030760365975 -4.6711174838523312758 -1.4589663541283304227 -3.3750333041192654981 11.733603867966031942 4.4932234977297849099 0.85533516319546243345 0.74645514837426030219 -8.0610467319609782066 -0.55999855995654534979 0.020311454152694932707 -4.8257792065180131758 -5.4745955272078967724 -5.4961791771377859206 0.59815538773523346805 8.5172400932496294956 7.8169534135254732377 -0.0026937902856942023966 -1.5762592767189906873 -1.2191200088008051772 -7.9736609276848318117 -1.5000609018042960763 -3.0254558695211386521;-2.0332340968082998067 -1.0181383689973682038 -0.85644642346797417165 1.2115911285704648037 -0.91958925501954147386 -0.9291808949680052665 -4.1632941157416407663 1.9031849776455602719 -2.4643014588452971658 3.0625665247181883544 3.6868165891391382338 -0.31697475309502359808 -0.15732938996752318661 2.9124826080889825164 0.45763266052358686498 3.662132207534865902 -0.12452452229432493802 -2.442195637268536057 -0.23871481278254136349 0.75507148169266891102 0.92645774278541881408 3.133507786223328484 4.6126396779062632802 -1.8522971172702029641 0.0067654960584584752231;-0.11986181966326156512 4.3072073716126899612 1.7831675737161463147 0.88594966035858324638 2.0818621090336160151 -3.3764881330312199736 -3.5261708458248253173 3.7873144758629035955 -6.7684009132664417763 4.8330338292167045466 -11.052592506872665368 -3.6050924188083701694 2.53072577851495506 2.9868636952900953219 -3.5688216349843124853 10.897089909597841739 -0.49945427318583013321 20.289780081855678162 3.6818179420307268757 -0.78097110402730762768 3.6579120768161601518 -0.91190971162519374182 11.766841237845982349 -1.5346625146445762589 1.8199009172069664508;0.77846969828469159136 -1.0898231947879932768 3.8905375261334058656 4.457447319004137043 -0.1933645771366862276 -0.1169961170460548372 -0.94337141224525278282 -4.7691294067069858187 -1.8332460523412072995 -5.4715393152897915385 3.9412304187369153752 1.9687400949781337367 -0.43576601604770426324 3.7356182323086066788 -0.97700447486035579825 -3.2663578913715731744 -3.0488141921605045326 -3.3699835861534057635 -5.1549089109456867064 -0.058263604758803398675 -0.95793468793432756669 1.7652928432309227258 -0.28742860229199757027 3.2765479315890773115 0.26258971897819705088;-0.52462618856369114262 1.4320647778462640698 4.7522564330884664585 -1.700489468637730095 -1.6464507606679390506 -0.19558433926006515979 -3.4268257491739082532 4.5920731448623959281 -5.5102580545960533343 7.0964214891486632197 -8.3460547059233274325 0.7984865426924585563 -0.099244454671841578208 5.887257461737211095 -0.96160470361273442386 -0.93538034201477804341 -0.85158496096460611913 -1.5197940466271089299 0.54410959521387614046 1.4587030183360831792 0.11161928937906497039 -2.6202227015870609428 0.0010431983057686902705 -1.9804090505023086433 -2.641580209116523914;1.6297841003137156779 -1.021703708767854657 -2.9462621198265104283 1.3791410391294869342 0.45822990237518063106 3.8063722241537449875 -1.2078560485806966174 -0.96086239781745219624 0.1564648074557062063 2.0025342036194619944 9.1663292485599683346 2.865794253736107855 -2.3381229566801975395 4.0106416482330313755 5.1576732449900788424 -0.22617650410100520464 0.020016966869947187824 -7.9832525245829453198 -0.66363760419034600879 2.0932961656360187241 -1.0463099019660084821 -2.111500465100964341 -0.27454550154517504135 -1.3229010573716080135 -2.4550901446355029023;0.85109328130891437336 2.0540211399877397191 -3.3960084767910267978 -1.2992486340739635153 -0.48454370741785479648 -0.64976792946258765671 0.57809060233132514295 2.7193731908211296044 3.1915250260553489348 4.6513318404628378744 3.1325180063067055158 -0.87680834726469736307 -1.0529701501807748887 0.4387891850646028491 4.9575279688787299293 -2.4545184040294416583 0.68586390565347288284 -3.0488835077708680288 -0.70801641798163994501 1.0244682385750298881 -0.77172904688967147724 0.061030830510680575407 -3.6558501624476118508 1.3329290603157351036 0.52521492987266438224];

% Layer 3
b3 = -0.021593141407386017006;
LW3_2 = [-0.16738633586044820989 0.1656427134678596369 -0.075980559768807159893 0.031352063808627352037 -0.065828249610618658205 0.024097112242824039047 0.032749324276933639011 -0.24665332706182480083 0.035384071713375361834 -0.17645254733682402826 0.095923140522091582261 -0.069132201786164179658 -0.080182663506637261164 0.13909378320410875629 -0.1543670897368743522];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
