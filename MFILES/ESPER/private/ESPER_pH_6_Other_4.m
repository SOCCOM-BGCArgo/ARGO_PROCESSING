function [Y,Xf,Af] = ESPER_pH_6_Other_4(X,~,~)
%ESPER_PH_6_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_6_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9628780954942692816;-2.556308761217308767;-2.7879920128454709349;-0.77252973264870550274;1.7107346071062317083;-2.0427500383061150124;3.6225136497864753871;1.6041678541438777472;1.094766669624866795;-5.119745859274304145;0.71899882032266926313;1.0735559808096988288;-1.4212839239208399089;-2.5410643778116037694;0.43786259821347561783;-0.53976876397258022333;0.45791128046167717258;0.52402447905857740817;1.4420875033141173915;-1.3096750863108266305;0.056218823720381241871;-0.36733266635155265023;1.9348399868257515344;-1.7278211239147922562;0.64801402414244457795;0.20010815910409296414;1.7587854044645210294;-2.4928891915837412263;-4.7019162395939648746;3.2274114058887963807];
IW1_1 = [-1.0416311933944566448 -0.93184336826804159415 2.1939849040867054342 -0.8588511840877057768 -0.87540299215790118303 -1.7151392287530202729 -0.26109760873671838954;0.06500005744701592425 -0.6606381794558173759 -0.053675551233583508604 0.21719270547339575295 -1.1788885129648793981 -2.5652207377642293196 -0.59107654233270434663;0.38319904893064998808 -0.79348491329335513189 2.5224883077786031116 -1.4040592942225382789 -1.5728667333865331557 -0.16797688737279833915 -0.25778775439852930074;-0.089680224162653671138 -0.24007859863346409091 -1.0787495309300707547 -0.18237937641530302391 0.22072155191924308637 1.1846753775375733486 0.30933176780621124413;-1.278566872940307908 0.31092839235265135045 -0.30794773659290414214 0.14411576375642623504 -1.9581772112151387688 1.9947584112914120702 -0.29232925326340220007;-0.19656241841538746318 -0.56609935871046412892 0.39164774291628795533 -0.13583217587956977757 0.87053102514689661984 -1.3008966005647455422 0.28069242779770214868;-3.86649136404195648 1.5900978885738128454 3.0446516391877600505 1.2533702555642618481 -1.3631635084812956382 0.16949585622695331755 0.37465614508375805203;-0.84670920335410237989 -0.20127131034644549223 -1.1494493295400303179 -0.97559125623434173047 -2.8505413594401769473 1.781406673401592311 0.11055859584272831331;-1.7708864969397002387 1.4220163054416354864 0.20333794936292798328 -0.40597735906173654241 -1.2431549479315247009 1.0042501908649161813 -1.1929518983451194991;-0.12028653275626004227 -0.72739752143623925829 0.60809866624957586989 -3.8721309260965370846 -0.57554472226074504526 2.9155000464607878641 0.028395857616031347503;-0.089063302111221737123 0.76841950365252509325 0.35672397921865939274 -0.29165242372154775996 -0.76358947647245756229 -0.23514821142602529425 -0.47108913284341691341;-1.0648764784854567456 0.83631802199441107604 -0.49007006993948137863 -0.024457800684713214973 -1.8636392062517028734 2.35547460207006365 -0.24594236004542927021;-0.10784235475733393306 -0.47706526367580659453 1.1955153571748071695 -0.54901172350957549995 0.705340284891268543 -0.60577075603828345329 0.38564926598529869484;2.3727677965545526106 -2.3161398481730643972 0.47628856224871846115 -0.027715772545595672438 -0.93494989747152879023 -2.0788067977070543435 0.062104487993166701543;-0.059421909164918379487 0.9785640536145259194 0.54913174552869725709 0.29517884687352924367 -0.085919278330079854045 0.26342308857631030472 0.46084002095489190465;-0.39518389983710111579 0.04767631142483787221 -1.0912235255405997592 0.21832868371441438438 -0.86602195850618468587 0.014859649465486454017 -1.3284609446220880802;-1.3305271645900431654 1.3343874873323284813 -2.4228032218009034615 0.79434299491640969482 0.68351175792385443497 -1.2991066421706491951 0.37837566204245548507;-1.2871396308286933152 0.14592517554739925512 0.16896162791639601775 -0.11818091926970790417 -1.3061728034597190895 0.16601575624487499572 -0.40304008414643804903;1.7816915347812123382 -0.37307379069001656013 0.075105048437291405117 0.35918148373082747771 0.24249470301448383669 1.6460790032376237946 -0.76410639361561771832;-0.027809314664647439425 -0.45507686617529963247 -0.18999770420027728424 0.072482028959378844157 0.79982170638823657516 -0.94369974279849111465 -0.13573327935356296892;0.15398894296232670809 -0.68123374404420011796 0.23068706490344473292 -0.35013452134097605706 -2.1170579575824608476 -0.51736118599023261933 0.045980709854139545367;-0.48354483121134922419 1.5124027416698235804 0.40454047301995688102 0.05548768292411442038 0.58186552408480129994 0.99639048363372273442 0.75748569888376682258;0.65730505053156407236 -0.17801773494353553828 0.36691408706522044003 0.96950928053316653976 0.081900122940477271261 0.52177225597878473806 1.2411252163013335448;-1.0169508172649923683 -0.20312916455623986067 -1.9232794296239112963 -1.6169326442950520129 1.0000226488930947788 -1.1055991276900025699 -0.033218486049383828818;0.34804137117566896764 0.048964445041478218967 -2.1415531301285000154 1.2524180979304999628 0.58955780480807817856 -0.39451930369802701293 0.40416732036915836712;-0.046391055718987384004 -1.270143333871413649 0.12241851809485305991 -0.20504855119698103816 0.55310565964462932165 -0.71049601353439495455 -0.43979363901138435189;0.053768587062150811906 0.2515707156609597317 0.5679178597810286 0.55839383541498843755 -2.9273978484325136051 -1.0421744470205771549 -2.1367301692467690621;-0.95995032430699966941 -1.3686840758797353956 0.92436225267503024927 -0.20770704707371959175 -0.0038159632038877689883 0.28570746615953829251 0.61198457111166948419;-3.4973355212149388471 0.3032431278351091497 0.33234003561742619937 -0.084723982616751472574 1.846226624145431261 -1.6791844694964805917 -0.49591610764297744396;2.3313304245126169612 -0.31163835145068446986 0.0056555571924055379751 0.15315927104057097674 1.4722857127675181843 0.27223741903945397613 -0.24792790334936992691];

% Layer 2
b2 = [2.82809373602497649;-2.0240788160708875765;2.4900049819086582659;-3.6813496075248806072;2.145794560857134492;0.78869089420627591647;-1.3618473240954145353;-2.1706357627882018058;2.5196510093743560432;0.60470574501266594059];
LW2_1 = [-0.85683744028691966044 5.8385674328426402369 -0.45338355405359409556 0.38995515504268091211 -2.4362855532698808325 -1.3517149022410701598 0.18537733924469676494 1.4409152231271782352 -0.86230868985881425903 -0.80547381330525247289 -1.2183726303854385264 1.6902153149226770701 0.061968848724173831999 0.78963627915964185178 1.364600321320522891 2.2179241445690860424 0.15754736818287728983 0.90853105495786223855 -1.0843577541692757116 -7.1518729047819888933 -0.84711673200259596239 -1.6600023568158315257 1.0502238008115880596 -0.49598620750569000215 0.84754342596124021547 0.93756944322534863101 0.19348788982053638508 0.44501672049002560794 1.5479577345066353189 1.9694907393191460887;-0.097148374860808683895 0.88263293916467033817 0.82866972178166564689 -0.3338172607589321994 -2.0425386670303491421 0.98344768903940738003 0.39412474742756931079 0.70755152993773506864 0.19717588435779287437 -0.73131680003643184662 -3.3525746352654492988 0.16785813627651058333 -0.036080124526410600749 0.028582073152790463816 1.3362850403332238169 0.089538394793061026888 0.26736220174214975209 2.7771794877033686433 -0.057403693472857036939 -3.2379329221845645215 -0.358458532283807918 -0.63734643866417184377 -0.46979600679569749611 -0.18079334050984680049 0.46123308376977079082 0.47304027375155388579 0.099089192135930176386 -1.1323360031245914836 0.32219756503478691467 0.7828355479861233146;-0.096537458515070478926 0.15214651006498086661 0.12127257483057909959 -1.2251430763704627136 -1.8831236765872088057 0.71360842265649970795 -0.029306627691718486334 0.62034647480289806243 0.64760767792946083432 0.68844286014328193168 -1.0697424757006128715 0.78670062567040000001 -0.72839239987739690108 -0.18138944276630661334 -0.43946720148076817702 -0.05472240522945023139 -0.087487368367493253962 0.36599592023039106969 0.1150130699929307887 0.36174302394778667935 0.25123998753169635156 0.27033266579903580951 -0.22387052013441516296 -0.13001282118164575463 0.24370672841763210692 0.18639193571914047798 -0.080148472318656113766 0.0028851076422412628118 0.21079843245914267613 1.3001652890248054373;0.89588685893844743902 1.398142715641546463 1.4442213260252123597 1.1506781826721621531 -0.48162514452417937161 6.4432236301004133239 -0.17336434037231376881 0.17365149860519493719 0.6554392206347376959 -0.15570382600541735063 -3.7752960301957378952 -0.45444428484790316825 -0.41804390903383487066 0.12122036317215656442 -2.6903823905960799756 -1.2260439041724320308 -0.011656177709484296171 1.0226735500286787683 -0.35608025770283718847 -10.936175654127985979 -0.012620722328110900445 0.0098720861177888918903 -1.0862584897706168974 0.29645443088375950103 0.64918887965327021217 -1.5997343378796673452 1.4709368292047884097 -4.2505184492127048301 0.1396148926398181056 0.6954592426680549222;-0.32143293555738761125 0.14043402715342206966 -0.26961596844851903887 -1.4157085308249068856 0.067442033590151301281 -3.1020259181331595322 0.44262060257759472393 1.3270870829933738566 -0.0051286205205959964001 0.42877050816661232968 2.3437083682860131439 -0.5515227394513096959 1.889472026891593659 0.1255463126026493681 0.89524724632561769599 0.4759990744070270452 -0.28339980391361735412 -0.74512582336328880839 -0.0028086132677093778379 3.5174906143087629751 -0.078362453365272158323 0.091567883582836087641 -0.003631606609986727692 -0.49126547027479217089 0.00615594335021007414 -0.10551027749867965266 0.24902801420370035412 2.0981544632532909134 -0.58601764321487392895 -2.7721540129109762951;-0.41045681936128225464 1.3110609714608449927 -0.43700865705731467559 0.19544532893573568488 -1.7848322523416515484 -0.51859604649335244719 -0.2160494066173965777 1.1254459386146180577 0.096961491714499387085 -0.2027658724071945695 -0.47310151297092206679 0.81933958803199224974 -0.082215945534764786617 -0.099715172714487251837 1.8179244789761122014 1.0364399752796875642 -0.38545855160989822563 0.87749914871330159105 0.11813582606844776068 -0.77328272639756956419 0.65214527835074520556 -0.45121042320139048698 0.23038261236084175976 -0.15541964733515070685 1.123148972875193996 0.4436990959674828594 0.16197724060315224492 0.22755750102154143066 0.49654898132138258759 1.981873676510969684;-0.033545989969002820708 -0.75547067286401825559 0.061377921921316691556 -1.4593694459375790018 -1.1341827557729282638 2.3650882449519539108 0.098255996168936918234 0.00065594834663668458163 -0.0097608793560168063963 0.85324067235765310713 -0.57234297747167883763 0.47962838588129769191 -0.26752184933362171959 -0.27396464093366379444 0.51478719506427361718 0.91860074907767785835 -0.050755893291531989364 0.80857288470500665589 -0.1253793776968134821 -2.1896103533769730731 -0.68224132285689120803 -0.20304471587560168899 1.2168061335882576213 0.34216580472222563047 1.3305411661156705261 0.93270302052700315709 -0.11312637288466069474 -1.7208790914696980856 -0.58752434382745832853 -0.2446454350723577531;-0.27071780530413952492 -0.23590020325522506606 0.46328910047784854775 -1.2552194114750507836 -0.76994669205508647902 0.28353865528857824518 0.29673973034183642739 0.95152274037041484345 -0.38882278422408628193 0.1417583835451338703 -0.028101537858865231756 0.16953727704254456521 -0.39573459339020311543 -0.36743515819367056352 3.0735651928974476732 1.6417432416145596452 0.068583209620521431993 -0.14380454603358716614 -0.07576026432815866074 1.2856825099558852887 -0.85473926538065092551 -1.0640189757619562538 1.2722897155440728856 0.46054230462585438177 1.1272725656558928442 1.3327755216130108273 0.094963261213083877132 -0.6844824651602567922 -0.35104192684723828366 1.1483905983753814883;0.85690243720012648776 0.16508170516276673978 1.135748439804820098 2.0847954331043796472 1.2088708851077307749 2.3971471755563289463 -0.077163137869895995213 -1.4391927976355003427 -0.098122281447143633315 -1.1674555999615954249 -2.8499429064620880325 -0.63256831372049893147 -1.8254554184593518862 -0.03060552347775354412 -0.57574336436951956131 -0.054604016874517657953 0.051839288507554578955 -0.42325660313451102246 -0.086778085865894374895 -3.1414796893860041926 0.0032255650262372100034 0.084030983051753868618 0.38164068422785002443 0.75584751749291501088 -0.70513423599451630075 -0.56664436765975667587 -0.13206108876229924465 0.24063565724732149942 0.57424831335682458011 1.4116677751235553462;-0.088316390674643391323 -0.80824437662653436654 -0.3161788611060900589 0.67784790605407818642 -0.53737321950447469732 2.1657636067760206444 0.26478082488975879238 0.036891893430034058965 -0.095884078683030740664 0.46235962478944403475 1.3013866154758011451 0.13437854655996933628 -1.0103168180830148781 -0.11037216011788235359 0.64891965359739567365 0.70156897560463282737 -0.19582954218842163474 0.13738359425354343402 0.1129754615783025995 0.71813879318326134804 0.28744941542237012477 0.56854213560093369573 0.49243438262825112162 0.095823706592070678756 -0.46322167036632333481 1.120090731621242286 0.25904025441596179036 -0.4087590622987984923 -0.12211432050159375107 -0.29455299655618422117];

% Layer 3
b3 = -4.5239104486881043243;
LW3_2 = [0.98382548427548943692 -0.35674582774516150341 6.8061163469463350495 0.3664440168587804747 -0.46150611271971980765 -2.6094449662292875658 -1.011859775719873511 0.74506793165228235587 -0.69426884143205591648 0.66146112230620246475];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
