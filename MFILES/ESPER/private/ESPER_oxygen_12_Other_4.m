function [Y,Xf,Af] = ESPER_oxygen_12_Other_4(X,~,~)
%ESPER_OXYGEN_12_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_12_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.2991798256247464316;1.4814024787237922709;0.78616252415379384022;10.483721849562078532;1.2867493464153534344;-5.9413942108521196062;4.4699486825816103774;-15.866557318525012832;0.47204666497490749277;-6.5941691187606590319;0.72493214865271571323;1.4843434790851548488;1.6705674195332154142;-0.23084561105284254201;-0.53557186564613612489;-1.5850624610396295555;1.4598191771243655968;2.380589431925330679;-1.6260159414299879543;-0.69256578953758063388;0.11540797066407747218;-0.094680214600472295539;6.88887690939784747;1.4373728505228151597;-0.90090202447790357354;-0.88842520854343598469;-2.7013693055988627911;-8.0538392366959818958;0.15254605551658731444;56.484172058806002781];
IW1_1 = [0.010430900844921328977 0.30307457133739135191 0.018300925147161046375 2.736197778870630426 0.24889072873358600302 0.56482882559981140158;-0.11434527286488885278 0.57646774157955760209 2.2706956444373607162 0.47941363455374363944 -0.019080347414934827055 -1.7446607157093456664;-0.37937967998718596929 0.9718506990877464613 -0.69450330405049154336 0.80333582605221720563 -0.24140703215487252509 -1.348982150468397645;-0.14364995244774653171 -0.47630016207490483149 -0.60486279835463863108 7.6718630541186652039 0.62586497023357801073 2.8557992014617590293;-3.9236850673265730727 -4.0126066689989858816 -4.2067844914337353401 2.7273632883967593443 2.8892557435544463651 -1.5867649706055251269;4.5727175722841835181 5.5482179494591861157 -7.435388030372645396 3.8319233095178186765 0.79234268049895384411 -4.8002996351996021218;0.33476201895102908335 -0.73146116134533523123 -0.34166747153971227524 2.8996040554438442527 -0.89782163189598018782 -0.44247203545655489076;0.087184367256550529546 -0.77804333923119584071 -21.399767998495857313 -0.47136308312195851489 -4.3316811549228910749 3.7498074430528336443;3.1590851538965982748 0.99505957576684778143 -1.2940177163735289145 -1.1300235755515921632 2.5164245825492201902 2.0307907737698069894;0.56729112179346719014 0.082426376200846113163 -0.01062203979730039563 -2.930049788478195083 0.54846442269076645104 -3.7191428057920732364;-0.084374050876675238397 0.59043519859814685979 0.50984867831217239864 0.4457234302336271492 -0.83637983064998855376 -0.77673496868831026774;0.052076097900347589897 0.39107075897166171385 1.3962583507968351348 0.62680411034277183635 -0.70473098843908521527 0.040127215639418442605;0.11914464631944954309 -0.17837829667511240217 0.95310993850325786969 0.43911056559148914369 2.1980652006537213516 1.5863154847443763362;0.07121379382581169426 -0.36790920475415372914 1.7699200404479602522 0.18430448572588228884 -2.8098280122397714109 -1.178258117113239356;1.2929121074237726052 -0.65344291107692731302 0.71353711146211917793 -0.5377042891495074084 -2.7218368401260715217 0.53937479628096818285;-1.311346339084238366 -0.56917696060288569537 -0.4618110029673227479 -0.14585211163713976412 -2.0601485080203860711 1.0347818443296323832;1.5748351396890705178 0.27911614587487909578 -0.54585653466986072679 0.85939358684442679337 1.8201126917096535074 -2.1582817533366407403;11.2003216981438527 1.3234565283790944434 3.4657554861625743392 0.34796981606913818252 1.8201297470540593881 -1.0141896874117573013;-1.8414617762059943828 0.24511318519615074574 -1.7144985965359884617 1.4117919360312187749 6.315231755243508438 -1.4221207770302222162;-0.3224992666378948547 -0.4288302140807453422 1.4894545737681901265 -1.5335675030304016797 -2.2210404355922235276 -0.13407547629692576074;0.41746698187762482091 -0.26146384789061422049 -0.088131111796710126516 -0.28514390071251338732 -11.283176616955650218 -1.2336512767556124803;-0.20743416825377658519 0.26120840344444834491 -1.1757500043418807056 -0.83796143575465042996 -2.3562806390912371945 0.75249690128141555334;-0.49570370564873372787 -0.081550604635326595648 0.40014472939744188951 2.5502926014172406788 -1.2248544922035611293 4.3214885416060804246;0.62472330123752028985 0.29496740626317041745 -3.2767164321946880001 0.2106388419684469826 2.3910349189238400136 -1.9420337845290747136;0.24069785386926270676 0.68437989154046363627 0.51105156334536905316 -0.75945305344359281818 -0.97879438582656985712 -0.62546414717266873851;-0.075176954150735109117 -0.23783213702548067214 -1.0463135140303005954 -0.6281786809927907278 -5.0866313376301448557 1.9568286165608104188;-0.2442810143374497811 0.13158170741725580544 0.64931379301831526618 -2.6245254601392380422 5.631074849382465608 -1.8225377535933497963;-1.1942094275785120061 -1.9966068490715878081 -8.4320904206474587284 1.1839352699630800725 0.70835028878738481861 -0.69481468234127252703;0.29115043614099739289 -0.38144110968801020478 0.66624218885341635055 0.25568498307697823391 -1.8424601267369711266 -0.34246002823537691206;0.3900185483897058436 -0.03432777680951010213 0.16573399032753946547 48.885208710496399931 -0.65154575260464342445 7.6331398876519171992];

% Layer 2
b2 = [2.2644559045106396056;6.5207558592867655989;2.1004055899075551039;-8.6325442419542994799;-4.3760996748241867138;-0.51028280528821612361;-7.3893656090611887777;-1.176274084002953968;-0.96542746021477476859;0.52097609627783292296];
LW2_1 = [1.6082794901362591489 -0.55563810830405668817 -1.8826009955664395612 -0.004920605692009850235 0.016688350847590158882 0.12866189182727053031 0.010331110322046498096 -0.35517772341218240006 -0.17854742990873012642 -0.20000025301955903778 6.4994283123721263706 -4.17077924242020881 1.1848006003925284357 0.10882190635800918777 0.22594021039100253834 0.0094868968806389643994 -0.65743255926247923249 -0.019659130623666982995 -0.04305904060109756043 0.12087682159848855967 0.031131777931114650027 0.31814739810571235346 -0.81097133627888384755 -0.075006831272096605168 -0.63671304312754561927 0.4460364860429957834 0.25932491805938190366 1.6825026875645130442 1.2800388430734976897 0.041848126270273566796;-0.018548633535509308906 -1.4395774366497531283 0.27494728063838497212 0.36294603087824872656 -0.051548408831113563811 -0.23273030529716792758 -6.754227434243764705 0.10926684344467119114 0.46653005888037873961 4.2934263715328642164 -1.9589208497837733436 2.7885499617683136009 -1.9161808260674779714 -0.50731067365131143898 -0.57842166289779128885 0.43187918900670296818 0.53361928766500676957 -0.24159358461186494771 -0.24907664864419337691 0.70639061886462539697 -0.64251036229903724095 -0.50323197333871971804 3.4415460256158438845 0.12537220048885175383 -1.0245855354153659 -2.2309325852919061894 -1.1385160752854730504 0.058070098052951373002 -1.2529744506915356794 0.21649623628631509131;-1.9263366018532808166 -0.50300532636669004205 0.82092381537140424186 -0.27828858878771151053 -0.017516818530453517888 0.025353772192013599579 0.95157874625061156237 -0.029213590063614392617 -0.29751065439216262121 -2.7397548478593023447 -3.9177760514178965323 2.557240317348695946 -2.1140589031664274167 -0.15899338198208545769 -0.10030945390271915618 1.3074343104724757136 0.092993639650215703663 0.13660503032646192922 -0.14609058921269249542 0.48556313645693022218 0.094921000355491516598 -1.4134868115563115065 -3.6025094685692611307 -0.76468475575368810571 2.1007466883499921195 -0.54655868079756597666 -1.0989871724555886345 -0.57944820823385545516 -1.0099935445651864185 0.19644629620923534374;0.23649901428791469948 -2.2365005788331746572 -1.5867944050039535231 1.0581522871192898805 -0.54009196862421215979 0.027562115031092928458 7.9984107132790960293 0.93631230350427729903 -0.0015801899941213554037 4.4283118078005259122 5.3862799441743982598 -3.8482738415350636885 1.1832091004085960595 -4.3665035759735344456 -1.417001128064621307 -1.3347184737277428823 -1.8454545646152635818 0.47319383199654541095 0.96550122181817088496 1.8398408637391607812 -0.15223844791831989132 -0.7881798090068199425 3.5625747921636494731 2.4483252480110020421 3.0401321821017863734 -0.68318758672240320617 0.084226178075771221399 0.055114658974833613536 7.7149699077901736644 -0.48503448665359355507;2.3904540781611722799 2.1309754382081576018 -0.9844971340113480851 -2.8545614946836130876 -0.13219280799318089414 0.25179024353936585445 8.1593930644823586817 0.94050801704867725839 0.10098952164469113257 -11.851032404156082833 3.3735404218058318015 -3.0694550829185351937 -0.91682921771654490861 -1.1491440287726060188 -1.0591009925544929704 -3.4177171252832247994 -2.0828187129246944487 0.12013991193418037395 0.83733997445950714145 1.0199142477805336338 -0.14332030307254961521 -1.0636767502026711618 -11.054038174806146699 1.7766993007362021917 0.53870630893463311573 4.7256200266926011722 1.2710452398249492134 -0.1842411906842752467 5.8712221935949333584 -3.954545681091323317;-0.38400818951068699247 0.14741874686867931232 -2.3170257282470472227 0.32489454365922826318 -0.047804180257016284927 0.29217826083396630787 -1.0559464691982174411 0.60378437769266501967 -0.070818208838797996885 0.18164300514889658578 4.899515527118462721 -4.5661389638443363737 1.9768557294567423721 -0.49524242805672896717 -0.44444339058413012689 -1.2243772228260600965 0.035127384160418093084 0.58645043829086573872 1.5439330241368363072 -0.99685680986244762369 1.1436096082781612715 0.28971678795706223841 1.2560694912364687159 0.76626247334077179918 1.5834023333999907024 0.79156547332155446917 0.52185210921303226694 0.30675791028155607876 4.1655459724268988353 -0.30762553742090836817;-2.6178539906875215593 -0.71515893780406369906 1.3438360568936900119 1.8431580682552235473 -0.12298611534853841343 -0.13330678084393129956 3.6921051067227077525 0.13949109630385819747 0.18232308486381113011 1.9579775350078540974 -4.3438392859111152333 4.1127924960229274021 -0.630041057536514848 -0.59708303940286422407 -0.077738471364861588819 -0.13413857876889828669 0.54677418156227675095 0.030605260895320483133 0.37995326611954360896 -0.32168084524664158907 0.24590302083302476022 -0.36459706758434207163 2.6352504699137875299 0.6737056516252366567 1.1339183067082700962 -0.53917274920741142807 -0.15844876348669298394 -1.7192017574039044625 -0.98979833063605815457 -0.3633211752088466584;11.551421778560113651 1.0731733516724955013 3.7422511284123887165 1.5799133935294167319 0.083067504300029570974 -0.060724061219704812686 -4.7295183679842178748 5.3338272490782969726 -0.8026553735529599054 9.1871565176367244732 4.5570503640213217977 -1.9827000774060281607 -3.2185087392878952706 -5.9590735314654263988 -0.23472895511895797149 -3.1496910984755230878 2.4560957516083798957 0.90497632296947949637 0.47241853534880495769 3.1974424617656675984 -1.2293383863937805689 0.29232157745686943029 6.8666537986078184375 -0.93699745591656957711 -4.1868792298295787191 3.8481382769044794045 1.9159332854516304412 -0.53915260395715713937 8.9520796433902329881 -1.137760520533555475;-4.9547612903710627208 -3.5734958299057937303 -2.6131046397977826246 2.6573989404266096237 -0.20253719019100729914 0.08299342388493771705 -3.2950399759481334705 -0.54372146977482438412 -0.64062793449627297715 -4.2182623048087783957 8.6869573554146928274 -0.56991225922592847475 -0.74952216160993734295 2.0957098526732984567 0.7920569931197685154 -1.7046848589946681507 -2.2116069538557145968 0.15337731466339751818 -0.0079548437156440852946 -2.1662733530180804387 0.023336842119095778381 -0.36276952683044738635 -4.2078691410586515076 1.922957792170399971 0.023703269406173427258 -1.0150780071351372946 -0.73040851158746522565 -1.068240168850307148 -2.1021747780622659363 -0.079126660057731237896;1.3057224415782948679 0.87822680877670322719 -2.0921295210909884865 -0.32243872315030119857 -0.072643422467741330939 0.39617685502091026795 6.0213238022047184117 -0.66293955082414168789 0.47450060740496635692 -8.5816557295062612098 11.299551860295048655 -7.7732654727866714595 4.5096635853315119036 -2.9548108910124861737 -1.4945103925524694244 -0.93647169565592836005 0.70990397370757751805 0.042856002742245297155 1.239618862885593753 0.56178260757784914681 0.22256086764340349271 3.6285011247165801507 -9.9699209842737115395 -1.7304858250753161197 1.6206800300415449279 3.5210982666635008975 2.676695395965054125 0.22850068551116609061 9.271540322706508519 -5.0228461120405514251];

% Layer 3
b3 = -0.25147806238556003056;
LW3_2 = [0.92959295481705128683 0.43026530233380688717 0.57140194435231506098 -0.29616104136726240093 0.31529297368773434584 0.4540523600926306691 0.56453529737484797746 0.11950419484028264316 -0.39897262904725233623 -0.16240629283996890764];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
