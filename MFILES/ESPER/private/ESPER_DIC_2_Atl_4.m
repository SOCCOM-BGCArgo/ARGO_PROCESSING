function [Y,Xf,Af] = ESPER_DIC_2_Atl_4(X,~,~)
%ESPER_DIC_2_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:10.
% 
% [Y] = ESPER_DIC_2_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2458729374299872816;1.488845922093426033;1.2433334097078005964;4.5263932213174022934;2.7613958722200693252;-2.0338773199579165407;-1.9962785737718291568;0.13607612440572947055;-2.7951007197155188777;-2.0200961946906330624;-3.2015929052335576621;0.028844573822985844491;-0.16950884626926077114;0.33561421815069830688;1.5686319011823539604;-0.88156565637998562934;8.1272541646620695133;-0.051288127606478384202;1.5252790897200334541;2.0501017000016830139;0.52876703298287919264;2.2173049218576412756;5.039583681214041988;6.6409721945372890417;2.4792825489076393275;-0.23405273562804024268;-0.17645871360385387283;-2.0512382721808899433;0.22977754812234146842;-2.5472688253963671201];
IW1_1 = [-0.94616588463856432512 -0.32748885997897836386 0.33627408410907722036 -0.55592093361167660426 -0.089845131020026600122 1.2340288933155436624 0.083428405263443403128 1.0534956269371387183;-1.0058768329969967059 0.70958996387689254881 0.54919338016571117578 0.20274408141165789488 -0.56280012430549619662 -0.032619730727005441517 -0.089083412405053810645 1.3466690732825354893;-1.9074706729809107753 1.9014450610769078054 -2.8883666623244739213 1.1870191249915895693 2.1533512165079886636 -1.8173402837993588577 -1.1648013929615277373 -2.7595627020417761166;4.4143173443233125752 -0.61813338058634614836 3.216610015878342832 1.0387559798422434376 1.1615444641497700839 0.099919363322078000311 1.5475466121831475963 -0.81938493817940083463;-1.6887336146671712012 -2.115668280748502994 2.4437672447987712765 -1.983547014770065342 -0.59686138052357040618 -2.3037634759880551982 -2.0723173744901526305 -1.2742240188561013703;-0.17306504025222474441 -0.21673277149502739869 0.13233741049989281025 0.67307837964182648527 3.5526625471946973178 -1.4165309745614500514 1.0654867219579242654 -0.87615655986406726363;-3.4306126647245838157 -2.5026846368822073252 0.16871379937775601854 -0.2750175621581316121 7.0204658695708408445 -0.98029487565590012199 0.52866876555626474143 -0.51385590800596603334;-0.038012415468004295827 -0.67199673404858917269 -1.3182075895008240618 0.34146295992104985784 -2.1763399501864229002 0.38612809588776986214 0.29034387076953649398 -2.2973581531834619263;2.1749949539440143198 0.18468279998461017977 -0.28362373337215951441 -1.1376848396025780463 3.6273343427025785957 -1.3227829397060963945 -0.96916810029657063374 3.2034469070836175675;0.85385326563703145553 -1.1197945595291669552 -0.17732865531535252357 -0.54307408967085868401 1.216716108341070024 -0.99551842098015952409 0.14581754169259095177 0.02000746445225086434;0.98107416752925802328 -0.12249331937410165572 2.9263074500620587237 -0.52470214002750270588 1.3921152048329756834 1.1873327210597939274 0.056587317265361883334 0.67532827066640888081;1.240080072866449612 -0.047646540580381480101 1.4285926836652924621 -1.2331795563066374477 -1.4352726770694348435 -0.90091867540281900251 -1.5979799207991396415 2.5703665150538523854;-1.5766435492431687404 0.0074202175831735717182 -1.7305506932606624648 0.019227985634112487734 1.3623784526185329646 1.699200752149067517 1.3974027601947121013 -0.7292652261267279501;-0.15297879969767133601 0.31083778762793451422 1.2043190079738377296 -0.90279950077829362876 -1.4268565478816079839 -0.086341108695967810904 -1.2274390842580902294 -0.31201522476166254627;0.057967043139407155306 0.49473669386738039488 0.3078855179543615872 0.33421610261207052028 -0.9874753899453356798 -0.30333420131548471943 -0.93585255856063132018 2.277673128743959996;-0.026054458409956807174 -0.66781559441713767011 0.37186067241750853096 -1.9200189116220935936 1.6828227679498029001 -0.17286490138128282612 -1.4031752916712816326 -1.0863867577430756928;-1.2599176671953165041 -0.19162061914653916173 0.14280042452618135762 -0.36542022890777808852 -7.1997183327687572785 1.469709351803681896 -0.27827631117809881189 1.3954427997675553641;1.9075355359999213167 -1.9599335936160884319 -0.67408211717452248823 -1.0508470930056277304 0.46255516608124980227 -2.582403417487937336 -0.32157928555566539508 0.62126190618072163474;0.62801344479090881467 1.2648498069136673294 0.14760760193905855808 -0.10489327431115670619 1.5728167838168309878 1.0034087759463985456 -0.13282493877091522405 0.4659673594966122212;-1.7761303398818573118 2.4267448366609949417 1.544252929869117219 -0.57361069350258131472 -2.6892115488603351992 -0.79447185637165274041 -1.58448042712596604 2.5632782559352218499;1.6240602261833907427 -0.23894920588543760998 1.0156528333523204832 1.2625498056588808637 -2.5170272704769303118 -2.1509553140958508344 -0.85906211395566933753 -0.17520881125521287069;0.56889606775930856575 1.1956427866067933508 0.28781887397386468619 -1.3035159143651648961 -0.26688400419227864546 0.37132073537036786037 -0.17706038786655439732 1.071730441696681968;-1.0024929620241422867 0.82691090331283911841 0.3597810990365302164 1.1844045003979160047 -1.8430196057492500561 0.42710019219295913828 1.2491817369727520326 -1.0044205211658319143;-0.057150806099936501958 2.2135784768231792086 0.69958788943662331139 -0.99381615327504857493 -4.2861130859093297119 0.26621953167435552512 -0.71546283227354612322 0.37891064246094990908;0.0086052536075268710319 1.2229109558059305662 -0.729310532634007469 0.95163416432106373577 0.88034039105258776736 1.8198680501816177912 0.7791537026637934682 0.013901736112982884808;-2.1369132349490391753 1.8511009457737226391 2.0000031293144933109 -1.4852567517583843415 -3.3678615830546005938 -0.62467536567456560803 1.5228990720537294301 1.0142347898174961518;0.026633628740252442146 0.51614359664679476669 -0.6040716118190490036 0.49761965765903798387 0.13690644951190716894 1.2745832608914338113 0.50375183339178997155 -0.029561842662957353578;0.20946026336351192265 -0.044456024603831745257 0.29639294615147221412 -0.66351418629373215552 3.548210481858704135 -0.25042196487133994154 0.46049428117151741668 0.69195599068231461448;1.4510064287800326088 -1.585920828110563674 0.00017778178624860106749 3.1273300675027582152 -0.67361255797273689172 -2.4961073224212895205 3.4202786441202781553 -6.0908570832613815327;-0.2922946149478030109 -1.2750219227723826876 0.40645234701556398615 -1.5674474312766839557 1.1700381627501363901 -0.36873378300985637512 -0.95211299996779275023 0.75106140724379988338];

% Layer 2
b2 = [-12.97294869884343349;0.12597462462283792739;-9.2145417802471261126;-5.2341770954784099246;-0.17129193858346847268;-1.7932731920110431822;24.463665436278038356;-0.35489558488977757111;-9.6192525749017470105;1.2239771284433007548];
LW2_1 = [0.64705959285809822035 0.24151686319178014561 0.13332174658565695835 7.7328264961673189859 -1.2430943070073192658 1.2627909115576381183 -2.5859707427611380304 -0.32819094253098324288 -1.1974178303694942294 0.048048439124720593307 1.2296517504727664249 2.1646758166547153124 -1.3056162791460379502 0.71038036818482941381 -2.1787127876993932496 -1.1801119938737303361 1.3513211401596942896 1.129645454791562198 -0.23057603458486747305 -0.50244290259787705022 -2.4518989246183311437 -0.27439160944018731181 1.0324173406822607646 0.79028175395233102307 1.0915284731156844611 -1.0712317237627175803 -5.3171890145284850249 -2.3192267392716501284 -1.1895874348187573943 -0.78199648602917726237;-0.4147975444734109951 -0.11762502562897098057 1.5406592593707064687 -2.0830863938438839433 1.2860450994755141529 1.1267078241987338316 -0.82934052596843055305 0.33670323224638276649 0.77123879687169938357 -2.1575782972867969534 0.97575580952581830729 -1.3400253966012585227 -0.4843172822631375829 -0.13800064360838071309 0.98875040356495691451 -0.1201969116888966238 1.4044162301990141817 -0.62045607810321867781 -0.36588722907314963351 -0.043725263440036341023 1.1141523649969484744 1.1538966483476067459 -0.25168351042643727355 0.047539580838229386628 0.67682373611396218216 -1.0088061962489847101 0.94183174637361677384 -0.14539771600294482123 1.436283291786543348 0.58604907546357709602;-0.175047284830735006 2.1090674467605730058 0.86572424473219655727 4.8760097199993586159 1.6638622035585579617 1.2975877619959375053 0.78134920713751176979 -0.29276625706605530208 0.16848842419334245091 0.43039852704055531207 -0.90358034319811064705 0.89480398376648973002 -0.39640518545534220163 -0.40999184319382458996 0.76875402422632865829 0.37542738797593955269 -0.032956340739601408529 0.63876846087760597026 1.1060505458191147721 -0.28793965023591439056 0.75547689296479036969 1.0529352721954485794 1.0603094994163837494 0.013776492908095870626 -0.027145036508509863549 -1.9429273750188873482 4.6584989430176779734 0.13331315451191014243 0.95605720214194933604 0.027714426469634859118;1.0341121866603810719 4.5524809716530727499 -0.75422296207942995938 4.200022549127504945 4.500264955490404617 -0.93951022228044145379 0.89848680463916785754 0.16619004983670421227 -1.3719935136054906 -0.75181633451378504507 -0.12958316071938394409 0.17533288460957599519 0.3680059066912383936 -4.6158858165058074263 -1.7968550977209460928 -2.9352000189147009479 -0.62170360889058817744 1.8886051376869250618 2.5897931153463726872 0.64076130326774216606 0.79405443702133871042 3.0487308498914984511 -2.0822371537512194273 5.9038540734164577373 -1.1244647762845925154 1.7372794539366158695 0.4221040267216626396 0.5781181444395192548 0.60223460347223312095 -0.347192862013420811;1.1872331824339381612 -0.44714257090046627408 1.0181654525158698732 -3.236537929093155519 0.52059193661622249483 -0.4505868258841789209 -0.63356424916676201686 -0.037325294628589057722 -0.020949803924768226754 -0.97523868091351229026 -0.67872457476841863144 0.24006202181156860442 0.43149971705684464496 -1.2010323463640115715 -0.080075139431154615521 -0.41173502585408305876 -1.3534022876596880636 -0.42945816757542315534 0.97715368558647530683 0.15704431151957068402 0.43415665088557764406 -0.35968614081924599191 0.29734414768310640786 -0.39034732098981900217 -0.92404785021502477971 0.025276075871957251473 -1.5593482204286814863 1.1597080065755542844 1.205387120915065946 -0.042693577995473006026;0.53468838414695696315 3.1206689246702210561 1.28049505355293336 1.4786773448585299739 -1.175256231390827466 0.39012256172223108708 -0.38322623155609275569 1.0214372649991776409 0.56050233950162453578 1.478557070956614039 0.94196930117026556051 -0.9591371235663381789 -0.66141603910229307406 0.22295008639196298161 0.79285881870075791689 1.0726897352069961755 -0.21346858289957298949 0.17231678600606803453 0.90595142576932985445 -0.89125239006159484578 0.4599359729795734486 -0.6634242236677861948 2.8026046764462098082 -0.11019583888519515757 0.78781204588923869903 -0.44849595572816630673 0.81086999606310494748 -0.10317169779623783232 0.022943053351379534555 0.59449798032324330244;-3.7757994421323237688 -2.4702083436814037398 -1.1114059894575689658 -8.4576485095046631812 2.569471855368457458 0.59872844026702254361 0.49866441940323485982 3.0858959077523513415 0.78072277340284879088 -1.3446521706269844998 1.3498108705462807944 0.85656553580418859362 -2.0510702986097881784 0.042115248296317915611 3.7339123918011489778 1.2814646347586033936 5.1785648203890124464 -5.0848180537630698339 -3.9021981368964646641 0.34458296907479213367 -0.54920499270858180729 -2.1232838821276880381 -2.2053686297724484078 3.6170324030628195899 1.5368857972572631532 -3.3295972454511666427 4.6962941191782938688 2.2226990610220473954 -11.873755569867695314 1.9722556582576835638;-0.055786719592981981464 -0.38211068280996041135 0.89464769874471827826 0.18282933788521624208 0.28975136580350591142 -1.0638871968815282187 -0.63232633447938912941 0.18319114956889329116 -0.011387890243365266646 -0.07708000338009859953 -0.25354380536638582155 0.72739907466051001439 -0.11939565441276099589 -0.87005446809408426567 -0.85291903165088522876 -0.64572234823158991546 -0.026024888711356622406 -1.0336608041371824207 1.5638503608149523227 -1.6502217140631019188 -0.28490537697786666449 -0.081545119999781923159 -1.2493490296352163238 -0.99361234851850344096 -0.67048178624218868205 0.34726183174251457064 -2.1845618231171402002 -0.66351187552831636385 0.089883012749630716853 -0.3310342139916687132;0.096835941082318049977 0.037042784322943791975 0.56038504572202407772 7.0956413606422445994 0.51088291569036370365 -1.818286750710694788 -0.49774510280871248069 0.3133272004530732735 -0.16382688015584820351 -1.2438493606373308697 -0.19486040705052867783 -0.77961003846852017229 0.87403647545563389887 -0.42329846878928256704 1.2985993762831125053 0.19874379901322672404 -0.99037065649890676511 -1.0092453876239628752 -1.1040739285601630648 0.58930554298326831564 1.301932846560394319 -0.26211016255583324819 0.068155351939720651422 0.42929229218335551721 -1.1585989452976259706 -0.89941072962604018404 -2.1819016059848039824 3.3106124840202317827 2.5513102564248750781 -0.057591772045554510961;1.3797880488233233987 1.0491202133053301182 -3.3689290861967671198 -2.3977296651858641674 0.35810536328316128207 -1.3992973255838940805 3.4966312170521431923 2.2872253131631632428 2.5985908350675459566 -1.7553286912478198722 0.29553019795818397109 0.34465894495884918936 1.191863310781978269 -0.49247526908193400841 1.7850664691191087119 1.8258121611757969216 -3.8895622538934611079 -0.77643311548061211269 4.9322527597623908591 2.8189689005281892697 -0.90507597671209916168 -0.31106026119829743859 -2.5838660746523198775 -0.079781066642357886809 1.0113448493571550735 -1.3678787773200029587 0.65820475649141896302 5.8729678522820520925 0.0073233167866149709302 2.8355360893355490148];

% Layer 3
b3 = 0.26057022815866959231;
LW3_2 = [-0.020479801757124826977 -0.048415561901322172467 0.018866781150419249108 -0.67073081603961759445 0.13603408724837032229 1.2254903098837905961 0.0078048842673452013124 -0.094857179802187802098 -0.07592076390196415836 0.0067363579839743222694];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
