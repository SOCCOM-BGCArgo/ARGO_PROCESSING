function [Y,Xf,Af] = ESPER_talk_5_Other_1(X,~,~)
%ESPER_TALK_5_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:45.
% 
% [Y] = ESPER_talk_5_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.52511139791139105;-6.2851321790061068;3.194862055760975;-0.47545557309248776;-11.276215867987636;-0.71313333376953492;3.4836567221018062;-0.61131995394123684;-8.0728623979375858;0.52783735632998519;3.1898131388155493;-3.0558948411717757;-2.1001813372713984;0.60406696698321372;1.3918288226784323;-2.1297869665500726;-5.3474577493505926;2.627683154015874;4.0928082379777058;-8.6275017847522246;0.20442858535349809;0.96092526914274579;0.021446062623135226;-3.5949294155449198;-0.79960726309302754;-0.64936205824453208;0.041751419863248242;-1.4492450661310936;0.32873683540582571;-4.4787963356525253;1.0089518578601364;0.58642760500146829;-2.7529535259286133;1.474496884885127;-5.4005189630454762;-5.406366225235602;3.5088975641402511;-0.076853549079981917;-4.6891754723188228;-8.1427457140354651];
IW1_1 = [-0.67568226101907825 0.67402235738530392 0.23562397669146903 0.55208370756492786 -1.7741180738218643 -0.71296583335716035 -0.50727999649315625 -0.080002747693997761;2.3032196868350958 3.0858171788536457 2.17767943002836 4.5639254876245658 -0.52375598052378824 -0.54001088112455942 5.8200198793082327 7.4388636229758607;-0.82453227239529925 -0.18246705918376141 0.034292752420083762 -1.5944456027424609 -7.0172889760111072 1.7324051682422643 0.65632717432470178 -0.36895261519182831;0.55219329946329332 0.919526657283252 -0.78594543970275099 -1.3963716177893399 -1.0422965316609429 0.63397645424896831 -0.15975716542580537 -0.069918749434659838;2.8343910742267511 5.5148676376365602 2.3011632314417487 -2.0915750499003951 6.7084298307211858 1.2993040111385681 -1.0563452941387734 5.2373912595411127;0.23045084368661475 0.051502513434363989 1.1672448963155644 -0.55400145329373462 -1.0260872871383786 -0.21658962706612764 0.32918927079938343 0.10111605681562576;9.2979777637007039 -3.5056752489085019 2.2051612319378533 -1.9779555979543977 -0.09244756571560761 -3.4814621526898502 -5.1878815531106355 -1.4462452284107203;0.60219203834468815 -0.66280047969566913 -0.36256785027598409 -0.73116992783363699 1.8699801018392945 1.0116503209266228 0.53842497831223279 0.35389792739501424;-1.0124901943545095 -1.1202013029756721 -0.44370076358648403 1.5089387704828969 11.154815761258996 -8.6070736621416692 0.69688656222544032 -0.73454427131868072;0.2061548713779531 -0.3075870063331369 0.023529588329798477 0.62796886915957484 -0.66887847784939969 -1.8430258809459519 -0.55819652403515119 -1.86447292079574;0.29424445732888099 0.0047322401807147526 0.013715014151580093 -0.52040893914430064 -0.20358520759309467 1.6496541386619481 -0.50238296673826655 -2.0144008949235555;-0.33535358202772819 0.025097127845751535 -0.059592177440114802 0.61184145083355157 -0.78608272416515435 -1.3974775138528113 0.6826427792715164 2.1499158574534976;-0.3248752422891204 0.65707301014586883 0.84555171713083532 -3.2321202598144012 5.7716967354442819 1.9178949225586663 0.31486275045932138 -1.621424174711567;-0.17396484664270706 -0.07184410424040269 -1.0175968553923771 0.50252784937163353 0.90248981288822938 0.20346293761390005 -0.27922509090057646 -0.044734190833021575;-4.8902926018282011 -1.3487929725194514 6.9325145528083292 4.5914545724237561 12.083167953161771 -1.9531328033548858 -2.4707106071290044 -14.868315372713656;-3.0464251975547456 3.7882094330662852 -2.5569247964058359 1.8131916005684681 -9.0768220811024793 0.8850450209934827 0.90242153485561238 2.0421518043373235;-0.099518812682428862 0.65568945902075748 0.31084364736513753 -7.3964937722137662 0.054448014385714047 0.46663383520941099 -0.65124575262637718 -0.74279914189003649;-1.868537447406226 0.53840625148408838 1.826048685326481 -0.86477242856952485 -3.4931893668461824 4.8836934408497648 1.4461437530410608 -1.3510213684767365;1.5663192720688608 -1.344199610705157 -6.4516172296453682 -2.295903110770801 -1.9712625649910835 -0.057359772508283613 4.5277001764625622 1.344452054359375;-1.0467056253647367 0.27336844758426937 2.1354077146624513 -1.6739120444868159 8.3503802038460879 -5.430260770471528 -1.0073971972491893 0.93539451226552872;-0.16887035090496352 -0.19990409988565161 0.08350711851877371 -0.66000127426070754 1.943516364498922 2.2026044807518907 1.4443289817059703 2.2737573072415889;-0.068262979740966415 -0.11597943943100032 -3.8095547174126789 1.2780445174223078 -0.34311915261017906 2.0540655914068697 0.99067935360602566 -2.2295390580064112;7.4270996730774321 1.0032672950014627 -1.2823283447994531 -0.13328704781698225 3.6685550497343806 0.23060487570714269 -1.4204844068002609 0.85433701534100104;0.64079884874578108 -1.5614958866136226 4.9748698618648453 -4.6507387668299742 -3.2090035540563648 4.3565581587849316 -0.4541777287006929 -2.3346367680150228;0.66149390677804509 2.0193183417414735 -1.7203778970060655 -0.29659583289105346 0.21847289787642984 -1.0638201588666942 -0.91093943692452417 -1.024060309761363;7.0058796764258036 -1.5280823074132865 1.5467138844487396 -5.6454836045689216 5.0356242736773265 -4.902027076016001 7.8019433918646417 -0.093551201105077253;0.1114458959112798 0.097947459209239099 -0.54815349888954623 -0.96054837475756349 -2.8000231242116245 -2.2301885737532539 -1.1812730533691491 -2.4577337858867074;1.779712117423718 1.4264975446219603 0.46014455084591455 -0.4887386088383005 -6.5090687584886329 -5.0685407454979092 -2.3054065376561073 0.9439385135187327;0.26191216014611424 1.792995799259764 0.88602697097126315 -1.2493843360839532 0.89619505838035585 -0.71464192749090405 0.61268492015785092 0.46529375883627128;-2.3795485563692567 5.8330565100376708 7.3676323267331387 1.1945172684971976 5.801771008012591 6.8088950986465928 -1.2961110680351209 -0.92790100126606345;-0.21045078097792713 -0.0044972471119529454 1.0006510726637179 -0.53341112876338781 2.8812323547872154 2.1973706597033345 -0.074493630572932054 -1.0811535389614098;1.4764981564373243 -2.5523496599530593 -0.35763714513842998 -0.8416588344479875 0.067533205230383864 -1.2501435082345658 1.5029303956748281 -4.0076968520593468;-1.7883773214278866 -0.91806552177840572 1.5254006791865651 -3.48433263931169 0.92432514333081206 2.2186593017844545 5.9432121408892131 -0.4806942154145149;-4.2581197987876136 -3.340041619948527 -0.59035578040386727 -0.36307767915292632 -1.2965874356649367 0.12018970669912166 1.090632664470899 -2.9294342489545646;-1.0263288956852195 -0.52109167063959916 -3.2854258777927199 -2.1366159307381274 -2.5295839520615351 0.14469719514264739 2.6739214699800802 2.6944046638524815;5.5910176288662452 -0.28153238647203765 4.164721276846584 -6.4040458326473866 1.2756007040766164 0.9940432027074414 -3.0462315851977273 3.0261337046039407;1.1463981887328547 -2.8817147945342132 1.3200886589811405 -0.4224706121921083 4.3780351519465048 5.6259951375944022 5.3053854521300394 0.76322287784707254;0.024128040841113071 -0.1147370525476986 -0.10251388632083273 0.3167363729564075 -0.51095590391841272 0.098929595339009899 0.047816906914318474 0.12497290473363412;-2.1162420184092015 0.92560700097334492 -1.1860278291179551 0.31724901898418501 0.43347739555765813 -5.6148869772119889 -4.5421157637894831 -0.1963075722072784;-4.7795763691212239 -3.0295545250817724 7.7059768369560926 -0.50499696823697626 4.7767584125958367 1.4655890081077838 -2.0064426779015623 -0.33017277090630004];

% Layer 2
b2 = -0.16835054116435114;
LW2_1 = [-0.45232153397126978 0.009456924794995122 -0.062512672906475136 -0.068419852367910802 -0.057241850664182033 1.8763830105817971 -0.0099220813177363244 -0.41702217126075863 0.029248787755779635 0.19539005313444813 -2.3630105665549124 -1.9405306493682781 0.08240069637218736 2.2473271663506753 -0.0053489567559309482 -0.021782216947821793 -0.043561293372808042 0.034343416133087758 -0.020213164887581032 -0.10492555937822849 0.12845193904985056 -0.050120578337264812 0.035000661565959573 -0.017586396952603077 0.056401603382748335 -0.0036512537028988855 -0.14883395141434108 0.025403003111108543 -0.070827712202356535 0.0095422238442386259 -0.16920598640097179 -0.033634025757333562 0.019263799331022159 0.024442281496601496 -0.036885832449670961 0.011478582915814238 0.013760357098206357 -1.5230971010857195 -0.032001875787561383 0.014203563222839929];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
