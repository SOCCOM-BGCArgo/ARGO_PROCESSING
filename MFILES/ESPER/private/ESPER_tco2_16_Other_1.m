function [Y,Xf,Af] = ESPER_tco2_16_Other_1(X,~,~)
%ESPER_TCO2_16_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:04:00.
% 
% [Y] = ESPER_tco2_16_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2019892899769871;-0.064390850322563559;2.796146419819781;-9.2153667986094518;-1.8749527270261184;-2.566111088566208;-1.6865414070850957;-4.7499731839721084;0.70724683311981296;0.56764849102273807;2.9450680404467002;-1.2240022929432277;-0.09453479541324307;4.4907463835636214;0.53585870746791242;-2.3351744795871321;-14.838577212118796;1.1314681126828958;-5.4964347302511456;-2.4424789524567529;-0.93677023874513077;1.4938109614972268;1.3595947734175335;0.87612966508239909;-1.3118682037286173;-2.2421469403070566;-11.972797885384969;0.48083941616842851;-2.5631498582641457;-1.2437499228150621;-2.6065684381465992;-0.38731021464242033;-2.3544759760346254;4.4296901356230309;7.7021342820673384;-2.7044087942240083;-4.6307026999707874;4.7026077751827975;-0.85147159194896038;-8.5519119767737966];
IW1_1 = [-3.4099487984198902 -6.7862002440179578 4.4030065503755171 -1.5693252810858591 5.9421923598202842;0.94009061198043276 0.30735091376790746 -1.2075930220362325 3.6231026981590206 -4.8973857953843547;0.0028379644859927188 0.0010334509013847977 2.1753046654860313 3.4982553551872484 -0.34233696049142281;-0.33690227119089122 0.48312903081757219 4.0956585217848547 -7.6290747772207164 0.22604997320913495;-0.99308880427241053 -1.8510995944780799 -1.2183558595565296 -1.6222954331892763 11.584283161371966;0.040412404661259525 -0.093771715594189287 -2.0525000887320126 -2.4080104389092893 0.63115120155784621;0.34653652853082373 1.3417427073400956 -0.58302042791611297 -1.3167949867777149 0.86289492374611487;6.1600144118384978 -7.6966281224040687 6.6102706776960387 -1.0300377823532647 1.0796710327422936;1.6240087460806232 -0.91602079266076097 2.696396236472173 2.8192491652618017 -1.7005516462064165;-7.8679727634623511 5.4704329912305694 1.3304562864348377 -1.3769088597164627 2.4322273360802442;-1.2442585398660582 2.6028638408946758 -0.43563301684655031 3.1081157067052492 0.05145095735943505;0.25719377980559505 0.22447419637318108 -3.4636154592391826 0.63952630221137796 -0.77514979023578978;-0.86850336299838937 0.65029388165594282 -4.5215955736604485 -1.6685279320954916 -0.16030565406935987;0.64151269037189551 -0.41139620980900965 2.3756450318765441 5.8669442241574341 -3.1029023760283256;4.3868431459723727 -2.8588534905467746 -3.359967007312386 -2.7622562153970946 4.9373461503882927;-0.94506010130083418 -2.3375329335297588 -0.7094550393270187 -1.3566042574244681 -0.1917248260665359;0.15715278052097351 -0.039079494413803727 0.78863106715271636 -14.657475471064419 0.016079001975967445;-1.0404629373544065 -1.8896002462336716 -0.65619266975173429 3.7079118920250962 2.8210287793464794;-3.1449975969483002 1.591847475453664 -7.7119197314845689 -7.1303678701071158 4.9748471933587588;-0.53857660157320331 -0.21859519003611824 2.6978784706051075 -4.3264104517549375 -5.4267618155433004;1.6303151453961848 1.9102788845336318 2.9092476679927777 -1.8877805906636664 -8.8227526293732108;-0.32935686213512172 -0.25432134871128143 4.1193453212977582 -0.52539117035365879 0.66196598535055051;2.0505564816629769 -0.5984210964990011 0.96675070365350657 -1.1346483996225649 -12.468256448748956;-0.21365888190872467 -0.18982159951788835 2.6253436254544789 -0.7755970921104679 0.86080847863366794;-1.0257516422968229 0.53033062692856736 -1.7359327712854535 -1.9635163121806196 4.4280324579452932;-0.60987454901194738 -0.18794830854790337 2.3738378524474175 -3.8931923783993261 -5.0914587705549952;0.14247120452866377 -0.23715973056885542 -4.8257718189866772 -9.1979503336374862 7.2724154332528954;-7.3187097623569777 5.0398978713173817 1.278472051986987 -1.4107942798940025 2.4096248425094728;-8.8136688539880659 -1.0317614865672255 1.7578092343913703 5.81760556163632 -0.51136541125041024;-0.69388512342339903 -1.7704955938900948 1.1611601719831557 0.32324407023338897 -0.78113035470725956;0.03461814625350422 -0.051762038973108479 -2.09831011515536 -2.8400494633928486 0.42764597429618789;-0.95730207591136618 0.68691250820864713 -4.8253735105276405 -1.5091400078683042 1.10581318312549;-1.803332949788826 0.8266575040747175 -3.3188600391618541 2.4419959083292144 14.467403839983525;1.7217622373207906 -0.13715963118133059 3.2064143128055504 3.0606161558593401 2.18390280006505;5.693984273687736 -0.19327689750993859 -1.3073768583916194 1.8371049169750933 2.9819639940162741;-0.8281484400140221 5.1035563376503772 1.6016810741485474 -5.1749039397872805 2.8939308442622531;-0.70047004126421042 0.46428721954764224 -2.4230211221828566 -6.1446194940821393 3.0871192356579114;1.827127143942638 -0.23438881753429805 3.5382206867263712 3.1145323592149388 2.4895377640871517;-0.28451545314064486 0.25316489128015851 -1.1543865498466801 -2.4696529582678326 -3.0914300624531741;0.049951160323464264 0.32803649982245547 4.5731026441620539 -6.6679892016751339 0.20922966444334218];

% Layer 2
b2 = -0.57747704435374136;
LW2_1 = [-0.056715263140064677 0.10705063750052256 -4.6952995396524759 -1.472777674390664 -0.095409236617499657 5.6634380902771655 -0.41742438926094927 0.050564160987405488 0.27031501416641551 0.57770786078164149 0.10968293304450351 5.5554184990043396 -1.1514629638122456 4.6143155898141623 0.062972013731132717 -0.17160367712466215 -0.51554723391590396 -0.08926932342936908 -0.068232998891092758 1.1963040649690255 -0.072048414648105893 2.8788251424451761 -0.15457057229977533 2.9566059503736319 0.60274846427940842 -1.3547725140521258 -0.12441150867057681 -0.61110441541391403 -0.029373466583376934 0.19213221189345453 -9.6655418285720405 1.0757974134075752 -0.092532017597545979 1.2079811096893978 0.25975699489016668 0.041089164057613592 3.947545531705082 -1.052608260468791 0.3236444976536999 1.5427374822872204];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
