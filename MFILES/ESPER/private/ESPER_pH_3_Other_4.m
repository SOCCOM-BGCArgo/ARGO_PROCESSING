function [Y,Xf,Af] = ESPER_pH_3_Other_4(X,~,~)
%ESPER_PH_3_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_3_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7174658725473026522;1.6816495573678562625;2.3827582433199490097;-1.2564873795930104894;2.6485600367516890508;-0.068472770254988490901;-0.90176434826887419405;1.2557462357551438803;-0.25225905016471339426;0.066310681381698849401;-0.99818458264932496959;1.8059374031290207352;-0.4349710465731193576;-0.52161686449968780455;0.35042855836327380104;0.0052140194900246071216;-0.15599146731135191124;-0.26212386854828562122;0.96070623350984163391;1.3369245382313978965;-1.2964290494075174642;-0.54106064468148329372;-0.72231389260643685812;-2.5828910704249019581;1.5636609817026083658;-2.8023042305894407811;-0.51188727489522389824;-2.4194677413108269803;-1.0408875629365748061;0.80839250139795304495];
IW1_1 = [0.058988600235697359608 0.35717039858592292134 0.79498068446163161482 -0.086730204708384120438 -0.22131827656445468566 0.99086659730763337883 -0.56757298558398183719 1.3354600864471042332;-1.0942709641883370253 -0.060662318569013121139 0.70138797793197305008 0.65919100572847122432 -0.43510317714349111551 0.77207906962599870404 -0.0073032103009319339695 -0.41634027173234283703;-2.5320179738100887512 -3.2872425828887910093 -0.27625140412951604274 -0.34873869261698714483 3.0848112379727830046 -1.0777980151055781555 -0.50733483697103265442 0.022777737521411805383;0.24493103534395485599 0.18454217910602302433 -0.76353536397776944344 -0.36713471411513931564 0.97317013789687056846 0.56366923658922241103 0.38486526174768326269 -0.70096150457948647183;-2.644339134384761536 0.84433295682176101593 -1.1690833409444327806 0.64453336009282080621 0.57545245246256826466 1.0152320608676732583 0.73711278356468012962 -0.79319108121869230654;-0.76965219874551149548 -0.50763825067232382082 -0.6579604875863223068 0.22069358052879109455 0.66125485311281750889 -0.044208895836854056327 0.1140728008566766899 1.0158914273238692783;0.84404442269671187127 -0.4304391992090156327 -0.80631994977260457169 0.0013753702919613369424 0.93936473496501382563 0.19243607829567618839 0.61952287218322110718 -1.1271137550957890383;-0.35841423526677407274 -0.66082564386680331392 0.2725859248132423418 -0.86262504543365703391 -0.82666677963775647697 -1.0077636260390934186 0.84462505314947855517 -0.4428135601305903668;-0.050843968506478015579 -0.84038121026425349758 0.073023338698486969789 -0.76477244228547747174 -0.7912347187200672316 0.22035817660450426891 -0.73264786407273962965 0.12179662357078621659;-0.066427905646571472342 0.80851526159447018038 0.72140949306934454288 -0.23003502215445154055 -0.52450891870832916375 -0.33193295097807568039 0.31494484317376569837 -0.035146641618513038696;0.47711864223205591173 0.94840371540227186298 -0.53175556342916030506 0.53732964190251264469 -0.19042190667247282931 -0.60428244791615037812 -0.97682682313718127709 0.58610975103097628924;0.23700085747973220762 0.1028995753028928567 1.1992541849138236287 -0.70430977021003204896 -2.8308798659544547327 1.1263531934465031981 -0.020837417191080457451 -0.69465789712335535011;0.38762258793988263461 -0.31797879327413086648 3.0546387425533403359 -0.32749503681227798424 -1.7430515892695050972 1.088783311184215119 -2.122870855367754217 0.90044714130981273748;-0.43336099139103495537 0.87778069232298427949 -0.72566929323687379139 -0.76948481033262539075 1.2110335600916679599 0.66934180354678463054 1.2004012890475681541 0.91620567154731813453;-0.3723696214175655772 -0.25917384169898405322 -0.6423222359558913297 -0.56836217045494075162 0.55465527612842413507 0.58096975716871990247 0.097250310705584083748 -0.026236555145565044339;0.83765471599987417761 0.45839775753065109543 0.84387332680824045372 -0.067142061934924140987 -0.16361524106531982747 -0.25344758272544082311 -0.39605485644755683561 -0.77096812948478954386;-0.56310708577567281097 0.60226511788951531123 2.3880450605880190196 1.4809372022319500228 0.51570301879590485505 0.33802164045143540116 0.83238993584389875391 0.20522535353513401968;-0.8733379732071017143 -0.38428162877498078798 0.15195674527998526138 0.1674645138382862275 -0.97683165938981120213 -0.6111594120193979407 2.5170601884882932708 -1.5260498077774418135;0.41576806371166868947 0.44029463168044008503 -0.0044574808024052175667 1.2277057893600307192 0.6907536678373247252 2.3237934766261849617 -0.033260497977735697939 -1.4605376969170722479;0.28746715174230119683 -0.11136100267819357135 -1.4187807441543416331 -0.85832109013105650774 0.83694698812246515196 0.66655336493628802863 0.78076044698900770591 0.68588069896195014152;0.3399870378166090501 -0.81596245475240058997 0.44285289824357243482 -0.97361582951203995417 1.514278152317887205 1.6260321828999435567 1.2178769040121353306 0.43062335230672738051;-1.2710354901122848936 0.3093814860537575373 -0.22950120823266695336 -0.081776564516253452686 -1.0312324063082682901 0.032180841482667386921 -0.23848740344781596545 -0.42910167251017539147;-1.2441086859168186685 -0.45912211346432679759 -0.26436144978666198391 0.26773534053897168894 -0.18241598406251124942 -0.10683594240720728497 0.96708454135202071011 0.71085837644591254314;-0.62138490982771543703 0.8927018816286200753 1.724812031279121971 -0.70517477466736189218 0.89588265445836579026 0.95662668736849065798 -0.24043898529127030739 0.24345157242031090217;-0.21595720428337086827 -0.41266334675532667653 0.4907685605495796799 0.24773165565290955481 -0.78013524451512972213 0.47750788165023511089 -0.14649593674200181437 1.1857335589554560684;0.13183392377122477024 -0.11575512114123347185 -1.2530084525567419806 -0.89470760025111606417 0.81846626496013841212 1.2459757315901438535 -1.8519848019910614134 0.17352384656838309995;-0.70709196841251165111 0.29856206777303517796 0.39436643820216377154 -0.4048722640629365821 0.53184066667249818572 -0.97916936361425110924 -1.2588270272609076716 -0.7430703952627863984;-1.2063984023631451059 -1.4755019313255581803 -1.6837065563483275543 -0.78747486080698869682 -0.45118189324334267987 0.24961145343429774757 0.077136026685526881685 -0.53009880159420474932;-0.22820425682991149485 -0.6409708800396061168 0.07356111618219562942 -0.81404534868559352834 -1.2864598132837836708 0.82903845836876088882 0.98076214739322586933 0.13142355616618653369;-0.36250119240326844627 -0.053360689020020453388 -2.2450296052190341634 -0.58735863305702740167 -1.151273230635045719 0.5127205885523509199 1.0534299644135456386 0.111350243682328362];

% Layer 2
b2 = [3.3222733941170852212;2.5255493005086773195;-0.21307925462917609583;1.1457276577284785102;0.58358143104134518886;-0.49883591676346905608;0.8171143899486533746;-0.71360874867371215657;-0.022394319391363229355;3.9109993214699860786];
LW2_1 = [-0.87310874735718191353 0.2739657214271990493 -1.2618949288981056167 -0.55358171171331360672 -0.33500914541961523962 2.6983531395858868507 -1.7486710434488825783 -1.2067685263553207253 -2.3898657379891394825 -1.720384517645324518 -0.22312499938465440996 2.306820741731770763 -0.4779941194205717947 0.13724781548017173094 0.60427672762632200776 0.57628203708090930402 -0.26070209632705604319 -0.68943210035311208728 -0.032778204375130251536 -1.7464819006310843275 0.23443107211871719309 -1.5520550691137977584 -0.13100717477661161237 -0.87775653511811557728 0.36389340435193645584 -0.76177932948586124517 1.0783950420232817358 -0.72644812664198943342 0.94148348324973474277 0.63600584428507522805;-0.21288242829502249109 0.84262503019540624383 -1.3686378534899339421 -2.9808073693854257868 -0.1961580893210707055 4.1631943149236114721 2.5417656986182777246 -1.9747256565901989411 -1.489497188653913673 -1.1002602583370926226 -3.632775592239255058 2.2236292397374533003 0.058935118397990426953 1.1229855420881860173 -0.86821710421086584208 -1.755511606700855376 0.76037541891612048239 -1.6801811910681456741 0.26937908493916634667 -2.3288584313587694652 0.058206529161210281142 -0.83917842886130034064 -2.5512800897258798294 -1.3505313766407940346 -1.696540520936709262 -1.4783934930568700672 1.3143326591688917482 -1.1801677073976173382 1.3882511533027694917 1.5278198674962057968;1.5730956712454458035 0.09963897475023289485 -0.1129817807688700132 -0.45114891200441958885 0.42055647457840977799 -1.2721488599894354987 0.24135988249089065927 -1.4260236588824004578 0.16560681251090983435 -0.4455513251913963968 -0.68328193955635219137 -0.12015402723839475885 0.76652806864662503816 0.024831523029325688889 -1.5437577738833869745 -0.87975918054539270496 -0.25619526904086936669 -0.17572135612289213613 -0.1810715451906218243 -0.25125439392783865955 0.45516380653271953927 0.32883399873464647101 -0.024033640764033900594 0.29274467280211186049 -0.83516388646765282733 -1.5449314564858971366 0.10534572822737847675 -0.0046002049242423433476 0.019839108112297804132 0.57435272499178446903;1.2206110257297082544 0.90775276056478837461 0.35571925705058776712 -0.16934707038070889729 0.25636397307012315228 -2.6313261456496861435 0.23847852432473901074 0.72359439521326018863 0.73500062178683045477 -0.55379450982172429008 0.75427407725695894136 -0.51177751278490013487 0.072507662425328300859 -0.036736253215747867451 0.25200981482653689314 -1.2176440437287119334 0.60591853168049503164 0.40264452834637681766 -0.89668070348132788983 -1.0202258392766085926 -0.2888485717647282236 -0.63828559999998479846 0.48781008191086294712 0.52462000507300976526 -0.8235680758228052234 0.66509239333893743762 -0.11564845116635107114 -0.33210530765155149568 -0.30656475255099469024 0.878077963290884278;-0.17087713921604530398 0.4430856082384935779 -0.080710638304211490546 -0.091745112442018939003 -0.95831405095801958094 -0.53694340956926323027 0.082439929916947859989 1.4116767668239047495 -0.3911681929293868154 0.23839209551682882804 1.3801835083821027972 0.1029253933659535214 -0.48176920164324371632 -0.12996678355892898882 1.4268344532546055614 0.4406226295080934996 0.18352983258240107567 0.81868242279586178611 -0.22198922879520924245 -0.052616813066529863341 -0.75340402973938924713 0.083433812124228262652 0.59015040216625314073 0.20006202890686242135 -0.15963837305763386998 1.9066843907119330748 -0.95059023906215545097 0.30361666824507499429 0.44820054488507854451 -0.4309591073820013829;1.6821071379335437168 0.33084266377406401638 -0.018169138877486872702 1.0117798136947233623 -0.57153093959749923236 0.23281402672128970188 -0.09929988913119519589 -0.3848753056384989768 0.124007283461026796 -0.57789361253598381385 1.1411400198638668169 0.14788538125449388061 0.22733196020229104461 -0.19515736203959713202 0.32606011895552200475 1.8278142098876886124 0.37568800457899809153 0.85123086347515386496 -0.52721623872659328924 0.96003213662950837026 -0.46127080207799797673 0.29348955063848630731 0.7861324672350956666 -0.26838090773154560376 -0.5778104894898460353 0.042135994657523580253 -0.52641657084994175619 0.33058344154540564297 0.71935473289906537442 -0.54715951115428829166;0.57367062894687681496 -0.39631728656927689425 -0.36251418874902074929 0.45528528026036446663 -0.3407129463982940254 1.184501820827942975 -0.083543548614512117001 -2.6876480313300414871 -0.90044482994306940249 0.24314939596770529517 -0.62748364445466253692 -0.071657646100116573207 -0.40592430844460536399 0.34757680919547528919 0.7323211218889380536 2.3237557931931012156 -0.25406148845145926085 0.31952769658106938699 0.33243207692869741754 0.36232852882190391686 0.14662273934685157717 0.74903477701288712076 -0.35315253969964421898 -0.82472010580166965621 0.18159241259425629167 -0.31346050382166451564 0.17767273731129387682 0.29657559330349503313 0.61990847221399980604 -0.33915327783508913972;1.0720185652644396157 0.05902435875026797174 -0.16435509497085934449 -0.028932103347683119088 -0.042950907601250004619 0.2469426818217385633 0.28534840330467858838 -0.79291446046171576434 0.086481422043103092778 -0.66998472290878252622 0.071100429036662152193 0.3755979322354855432 0.29780867937877142371 0.13117421159087966354 -0.5153797530485103584 0.73341747508986554482 -0.37055186171881882018 0.086852759805149379324 -0.12645169774927420003 0.36786397796244851843 -0.059734459512146169391 0.60073087097967581283 0.12057380460519499799 -0.1131881745908622644 -0.28919310889877020143 -0.77028144249733021542 -0.12619255766031081678 0.12038678104900088495 0.18343546873774485562 -0.57126064722234692894;0.51665347837199948611 0.60002639048444283976 -0.070991677751932602547 0.41424538633605495486 -0.93578100555374277292 -0.42054116157416721045 0.0068712703000186718671 0.91306487473385977705 -0.065246979895154946782 0.14592889662426453135 1.5613838399645754151 -0.098519261349273579143 -0.085992172688761484012 -0.29623865984925318307 1.3621580410547755591 1.2200107029861904095 0.27805620802048741647 0.94033102954559022457 -0.47359314645597111459 0.50938498695499923041 -0.64363836845080280025 0.13404907833299323228 0.84267941675707414007 0.075951414771567277162 -0.2497652209714157634 1.2372953270073596688 -0.88807316202403308036 0.32767881747135685355 0.4482949882416895071 -0.50646337854300615966;-1.3861755711257812695 2.6267041560817192547 -0.79628728266220949461 3.5286279098848827296 -0.99206313087329167644 1.6585145788774677822 -1.016834926526975158 2.6520343104249941568 0.071850796252234463979 0.1913647258668983997 1.0167353121115652037 -0.52224720549385761359 -0.23289921807199032155 0.044710759641216644977 0.90680945806770218987 2.4892996292056381868 0.46567050432469270227 0.50885423901001558544 -0.29310917596585311928 1.8017741712830945833 0.85105624138246704913 -1.5118329309275384542 -1.0372844935011908962 3.3867044677431699107 3.0522791934544528658 -1.6500299769659709792 0.21184429169085469691 -0.17701376466935422882 0.33289977168217299575 -0.46425022508829488777];

% Layer 3
b3 = 1.8007074565312857217;
LW3_2 = [-1.4149085876587019772 1.1484132472914385659 -0.72386389093106617842 1.9931721288666559566 -1.929759119022146141 -1.9404190295705838754 0.33518710375672300383 1.1879863037465316911 3.0561550718391612413 -3.2415223330284930192];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
