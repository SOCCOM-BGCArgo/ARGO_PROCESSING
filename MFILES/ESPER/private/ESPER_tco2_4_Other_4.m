function [Y,Xf,Af] = ESPER_tco2_4_Other_4(X,~,~)
%ESPER_TCO2_4_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_4_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6630033205045289;0.7939019121048102;-24.96616418418629;-1.2812243333438322;1.7969421098355562;-0.63605730466368426;1.1720860362810068;0.0093041796054778043;-0.11381644618405883;-2.2257354897700172;-0.73609962216942115;0.14902287216115925;2.1566606311151122;-0.0056718414248585255;-2.3212904532611249;2.7990041419329201;-0.07746882735362598;1.1432759886095265;-0.3597172609393901;-0.31726324974804782;-2.095837918190298;0.65687929962541558;-0.18486064435846136;-4.5087629834124749;0.93680831643253726;-1.3829538048524244;0.088061721582724739;-0.96240929223991389;-1.0949623637822772;-1.786045330821046];
IW1_1 = [1.0469434341794435 -0.064101882092884047 1.0492369909115831 0.22126776718142555 -4.8970815521200333 2.5868684822169028 -0.26123806096947655;-1.2048142264284449 0.28821071373320728 0.33472117696391041 -0.53625824064169414 0.86090121673532904 -1.5482344461809785 -0.22560879268143194;0.17541380717577137 -0.49878940781982001 -0.12961463509805007 -23.963931970530425 -4.656565073660885 -1.2726359863356256 0.03211036268354673;0.087258990490457031 -0.18854621599197013 0.5996700761765964 0.086208513562618327 1.8811840379658531 -0.39476087544076333 -1.9252790500552381;-1.0021834828942966 0.61380394463978238 -0.62889482206232017 0.83266392691200131 -1.2863176022570888 -1.0115519046838455 -0.60310561650073313;-0.070239793858424493 0.1382371930180909 -0.21917721351744759 -0.46485816315099515 1.703998713711629 -0.4755180974331078 0.010934121657367884;0.39335406366954617 0.021945110727468409 0.32683279666496362 -0.097009649774931789 -0.31449017192177986 0.64725035138945142 0.61837230205381799;-0.090233453337780198 0.091748823590231621 -0.41657549182604031 -0.0092203074332475633 1.5531377736786962 -0.079831509832912512 0.44184550536769523;-0.24168517340547302 -0.046638332103767166 -0.14479602502737934 0.0031598132476537135 1.1145715897011079 0.24177412683252258 0.01180734376160365;0.0021770602399840524 -0.047244217387642895 -0.23541720812664207 0.52542171752080691 1.4436541318674143 -1.8124029725351949 -0.070984642914970808;-0.28263859673147984 0.13026006590810182 0.1835708956607463 0.23501286621159545 -1.6637103998706824 -1.2138965817445388 -0.38232605062167757;-0.04016858176670151 0.073512545148824798 6.0246782731923174 -0.95020361144201226 -1.4695594879837184 -0.3042714032001923 0.31842173816550023;-0.070307820668558951 0.13153957757612256 -1.7489261686955531 0.49400317856687076 0.38286943268973944 -1.195082006024851 0.40536297128810284;0.18824791049374601 -0.15857420661028665 0.15201669218634456 0.40050633771907235 -0.54842793270779377 -0.31532851082459074 -0.019678388129794003;0.48903073547540199 -0.090350326234256248 2.2399458755367663 0.24199676767750361 -0.83119054399562309 0.64481675878882383 -1.1589218996421446;0.41698599615318543 0.8429659201116444 -2.9871448077102025 -1.8814638667642458 -6.5854697245080871 4.4069610077670482 1.40390804147701;-0.093754251450787918 -0.10275381733801353 -0.80735045305503161 0.056148587086005786 -0.41121383118033134 -0.87852547845840701 0.40935824300968121;-0.062808180127535126 0.44038418195488227 1.1261345036937065 -0.030056365353936382 3.4549870319264424 1.3283372967904332 0.70430681245528337;-0.25828312741083154 -0.22915168033402958 0.42197710701868651 0.016280480127240954 -0.4503696967307414 -0.71034274149952192 -0.11984639974308781;-0.0058618742536573941 -0.09185999169289974 -2.6331313891018873 0.44211095622332763 0.53389842285976885 -0.19437241471191974 -0.13833567391254903;0.81838340762520745 -0.12918282278913149 3.7019730588031923 -0.41507777614577657 -0.90404479708225216 0.38563213715216016 0.21426624832424121;0.40436186906480909 0.13786108851881693 0.61926786832656366 0.048189000878473151 0.4723988778083556 -0.09646529124044316 0.66215177208997578;-0.18042092938098916 0.82071083996058913 -0.02734865174529388 0.091590035669352185 0.51569759583964647 -0.88894032571851089 0.8690108998306042;0.17484734056964901 -0.21567969245984819 -0.58694628552081429 -2.5249017834158676 -0.85538428973024661 2.1703077562896449 -1.3016881905436786;0.023450405945871146 0.058139981075637927 0.22952501257057364 -0.070123566325335812 -0.84118885843891122 1.8121514887795407 -1.4554671915909083;0.17134820801295905 0.63688894794599271 -1.5101294312931275 0.14474563112173472 1.8899783508309735 -2.7739122117292405 -0.017457705873591745;-0.58265257075463395 0.2883728779686805 -1.013679838593128 0.71416028314867186 -0.13789706427557882 -1.0225468754759548 -1.6483108907671948;0.92057021578317821 0.89568464639196932 0.38638994644543884 -1.1438249315341182 -0.6478676820385828 0.99092781334826563 0.37092887927163992;-0.14935342133322652 0.36429874913647664 0.13782805475392149 0.076276104723564372 -0.0015817728285715078 -0.8455966721294419 -0.31057190202175922;0.69211711132657561 0.3687100120668762 0.98137096248232569 -1.0487800953904998 -0.25389714582943895 -0.12911747643365715 -0.3684547611348844];

% Layer 2
b2 = [-9.9581741409797111;-2.0820007690048188;0.37929095483444675;22.758834515119727;2.893296060180552;-0.41871805729550227;3.9904172035224796;11.472195613268328;-2.1950667515584201;-5.7934591491694682];
LW2_1 = [1.5484349006783176 3.0322899247731834 -0.5821599763799109 2.4311834970672677 2.3796687063677364 -8.6142350095519209 -14.409882844837005 10.300092743495753 -14.190755980512343 -0.048240704433066231 2.9818493421062819 1.6549156509476897 -2.5609484288687958 -13.950840680451389 -4.1259379482134664 -0.20476387254085454 -4.2466776153391219 -1.5602842989582746 -3.2065757087253703 1.8828655229786539 0.58069134744609896 8.5970208525132232 -0.13957049211345759 -0.79954973183735711 -2.1753842865731596 -0.068700991885942392 -0.93382166506758624 -1.82477345103188 -9.436648474389564 -1.7763463816132221;-0.97319639241026035 3.6807291584886577 2.6188741846909793 5.9198662984538988 -6.5613382659643706 -6.1273713625957393 3.1699307335868476 -3.243093182545294 1.9087953940057072 -4.1164302209412051 -3.0645428347415802 1.0597066523689469 1.3536669702581905 -1.3149318760018054 -4.6886260229075525 -1.0227725518343087 2.5227886011381435 -1.0461557450595842 -2.9726200863529009 0.13294192015991757 3.1147199062150914 -4.3323891285851799 4.4964728947294113 -3.2778289891646142 -2.6034886543298628 0.22662332085683348 1.7286885291691811 1.3850625528357936 1.3941503234817756 -0.82654300284762516;-0.379284594767057 -5.2674863875928271 0.55977810148272567 2.7958302827431711 -0.18878564764457817 -0.94195148696988507 14.57572534196842 3.0667572255717968 5.5093019803565797 3.0512498632113192 0.5359598588854021 -2.4979839935302453 -1.5191822604586198 1.1902678121427317 -4.8838659588551758 0.48182975448525156 9.5599752947079928 1.2695271630417955 0.79624121619693988 -6.3407363138669428 2.2821233525433029 -8.9592233854746599 0.1095983847843576 -4.0518454084143753 0.03378005466367176 -0.11976169375694699 1.8411433780856863 0.1685872928965676 3.8787344359274387 2.562872045052484;-3.4944943669472806 8.9574436972629154 -0.38997717764193246 -0.16997921490121423 1.4674777760861055 -1.2807123052672005 -2.7386261883386243 -1.0150782621056009 1.1056345733319162 0.88842518683530647 -0.6376394818384219 0.68418895578631578 -0.53876038705545215 1.0122356750890094 -0.43506914039930583 -1.7844936418341679 1.351747574706925 0.20656542256746085 3.0232689265432828 -2.5838707770102181 -1.7757143529633115 0.48535901897388689 0.53068766123932154 -0.51858108307405848 -0.80464863523166485 -2.1600538690298832 -10.882174534028103 -0.28157666793783959 6.1629545432680546 1.6465610539014257;-0.28826534476986088 -0.40178349195510277 -0.023060555215399351 1.1728864717131531 2.9723133136537205 3.4998003099003725 11.259997133727556 -4.4052938203293062 2.5578556759277649 11.08417076753587 3.3025336021061338 1.8763388192636681 8.0035275164659545 -6.4355914646490167 6.2995047423520747 -0.22117351785197772 4.5788901348431708 0.88637562615167609 -2.1873080861506891 1.4762929413483239 -0.09876308039120095 -2.2080290398543543 -3.0684087116585981 -0.83380376214257623 0.97338754228656554 1.0643678352231569 -4.3412230130380483 -0.27713833618569267 2.4334630705024329 -2.1810047833064998;-2.2865152988906909 3.495345945026993 4.0775035873711971 1.8828632003922883 2.0555365400451615 -4.286085881431192 6.3665226777165849 -8.520019030236103 2.2457117722276334 -4.655334465604362 -8.3683588113000145 2.6641243824234957 4.6445422617547845 3.2061064093303582 0.44757138403859326 4.3641874182831062 -0.77844547236817019 -5.3343508512657758 6.3701018870316988 5.2088594204507297 -5.8966973100558837 5.1737446905949716 2.6351429951700491 6.7826282215020868 -3.6338125123775766 1.9367564125788024 -3.6357361454783561 0.40998370116209326 8.0049872824680275 3.3987996007898169;-0.76412807178977371 -0.4512029999056541 0.23050039148679269 -2.0159875304872856 -2.8525024688405236 -0.48363187177888656 6.131631759548954 0.35364616638909174 2.6796255079909206 8.0958530256651997 -1.8005678677115335 -3.8531557948878565 -5.7404382064935424 -2.5172356384250945 -12.644599944938269 0.14669154846681845 0.065130414083004504 -0.51807459747758677 7.3084244691863249 -4.0398608159069989 4.496363916406608 -0.7959642486200984 1.56132737445919 -2.4830183429692325 4.7282469262062712 1.3554095363378795 -1.1278713650160952 0.75878356166730709 0.095244494567018181 1.211188470324368;1.3443596894328149 -15.925569915124809 -5.0245562776679593 5.810687219527841 4.4462271493353365 -7.3085540118235608 -8.6438002231905866 8.3062486684444057 4.7131944382534749 1.6587962656077173 5.9944261119779938 -1.0201943016998629 -8.3217053814606281 6.1058607411739478 -1.6901566251425382 12.598549948507166 1.180296872382371 -0.81698122148518371 5.7678436618207831 3.5400816801449984 -9.2076778845697866 -0.97298292092336647 3.0612431842899328 3.2780502240981995 4.3289777078237295 -12.99574720361743 -22.02413585283189 2.6610615181753441 9.4479354125175128 -1.471483424186848;-0.43193855231937178 2.5798309783660107 -0.54016300065962275 0.24869221859930282 -2.6592725224496254 -6.4960976875307441 1.5597863851913352 9.4308105536796702 -3.2453338562722545 -4.8625906420045437 -5.5055598046596321 -0.44761849147171062 -1.9499551448829937 0.75130164563256308 -2.1543263118782776 -0.19946159775291478 1.2694357534957632 -0.66848066357788627 5.2145101739677466 -0.18767435219838116 0.57796336467314868 -0.95119836544066694 0.99631874499869333 0.35005187546729338 1.2386987438130612 -1.1868983625049003 0.86632475627293271 -0.42557522658280844 5.3230248051131461 2.3109015320863961;-4.1255392983213426 2.2553148537477266 6.8588602422123159 -0.41223054180240315 3.6670778191728326 4.9236868588927845 8.6247864101749023 -0.15494591707335695 -0.040218842052416097 5.2926005190647931 -2.4344431993864899 -5.0483038737082575 3.9210130839881701 -2.8374356037493507 -1.843123148503869 0.70856202179959804 -9.191974605702427 -1.0031130542555728 1.0386392066463379 0.36717100870176778 -3.2597446143130213 -0.022953905887840829 0.36244191273225446 3.4204111283050342 1.5214503678756357 0.13133396656209054 3.3078757477411687 -7.130493266707207 -6.5580552700487429 14.317572024288179];

% Layer 3
b3 = -0.039480230441735181;
LW3_2 = [0.13610045765314005 -0.042043659911128142 0.16391398247687508 0.0637407448887711 0.31562798170225248 0.009813628143088669 0.11450871174673347 0.0083975086375535756 0.26242637747085884 -0.02153464797292225];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
