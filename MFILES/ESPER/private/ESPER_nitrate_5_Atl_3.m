function [Y,Xf,Af] = ESPER_nitrate_5_Atl_3(X,~,~)
%ESPER_NITRATE_5_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:33.
% 
% [Y] = ESPER_nitrate_5_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.65813426430881794;-1.4302544002081740704;-1.7023049450295801854;-0.93544594218083054749;3.2198347322615252786;0.17967991482587605812;0.091926258794639351124;-3.9065599355370799195;-1.0912490493204403119;-0.84359601308272913478;-0.53832528906361132304;0.51918735284985428891;1.1984952136489170904;-1.040861621996070463;0.19812568519935286337;0.043201220788929607652;1.5341988592494848476;1.0194900194741025601;0.2680811594433069045;-1.7927085364156525316;-1.8240849853003227032;4.1045643088321170922;-1.6636512590193188732;-1.5217288139689768567;-1.7713729201105827826];
IW1_1 = [0.067613342964681438785 0.15394687606299045646 0.30549673061130955265 -0.21226025298705186728 -0.97697817138017784 1.564679980003468307 1.1801399203989235698 -1.2474930760899460847;0.47608002620445527553 -1.2499695194347806293 0.12719792776572272364 -0.85673098044164552878 -0.90126760814988793324 -1.2263564679457268358 0.27401212034331484668 0.092724614389450718543;1.6876516526794997919 1.6958853340652721986 0.17296786140234832185 -0.62445004651996416367 -0.9240261715492116279 0.047514553317883713446 -0.74019827900242329832 0.20467945746439020205;0.04014076808560133186 0.10778214029853565303 -0.45773924089923240244 0.57563603360218751348 -0.04079372753945287311 -0.85706403559591282093 -0.22473445242985440329 0.4792537887971054511;-0.31662720188249066089 1.0461286205535300642 -0.17176565001419266676 1.0019222435619867806 -2.7201451198548065591 1.1304353368195423357 -0.13894717768231468202 0.52132894529804907346;0.48622473911583607986 -0.18985597768205003666 1.2221279260567974312 -0.23464873538779645878 -1.1917759010851953771 0.060277018694151661415 0.43794432343862288448 -1.6038731503582719373;0.17271012231602594911 -0.73881651591800223677 0.089414153299160997745 -1.1007180304199080112 -1.0750709352175520372 0.58019389963057366177 0.19680184525607172241 1.4535953381976158827;0.98581878318820559404 1.2587830656368002025 0.082597487085764503822 -0.2190562306121052738 1.524506948131166606 -0.30504294557888966821 -2.6379548975222850693 1.18218335754507331;0.35140598751383766984 1.3614822938099886418 -1.2926187221076999023 -0.84783176105368995845 1.2041093520688432861 0.2751365864589229715 0.053084119406251961681 -0.78472450933982107468;0.19289832965733516579 -0.33867275656969181297 -0.51041777805574828353 0.34565277138860589501 1.4723289910173775752 0.71821046472071659039 0.68281391557495296762 -0.30931746687988037614;-0.19559980379098612646 -0.37936582580238037421 1.3888453646380334305 -1.1346641164777713229 -0.31941125614615173411 -0.35123927534537957573 -1.4152643627121108683 -1.0948329126222611229;0.52890348844036372267 -0.15788891885831699002 0.18550601542242697861 -1.147943169615488701 1.4015568318051756513 -0.41159863141414282373 0.61905224290369231799 -0.94840945684053545861;0.44743366220238672826 -0.79715064775154886867 -0.15606805163075521126 0.69850416546817239993 -1.8656710704834900127 -0.29132762250895083422 -1.7638115311759576809 0.51665352097215566651;0.18253416816243822618 -0.78253912613015941258 1.1507271866489718892 -0.50411103194419015772 -2.8666442861852043933 0.37192786143246170383 1.426414046299109728 0.38461542301955864431;0.53260470781919921901 -0.37089801579216924443 -0.0046358470626619956156 -0.55399762213985515036 0.31806659266465792113 1.6304402698487074908 0.99696681317211821582 0.65240881930840843861;0.53386558811512241363 -0.25749376112404948058 -0.28229838003467022656 0.52820349782663889027 0.6813727649324573532 -0.80241818958945709817 0.0742226373361419417 -2.4902356223493762322;-0.29029585028591486928 -0.040577119658751700793 -1.2645759291532128188 -0.18293004933274978341 0.52074862343500682993 0.64969854453614450662 1.9182690987243506964 0.4454547297371688197;0.34095297810902036595 0.0003925696265403128514 -0.00053494351684238265754 0.71448349875450101187 0.81828643623423669151 -1.3644477748091130564 -0.73346647547805055023 -1.7069986994471175734;0.18157972064514676935 -0.42036274238456078356 0.20002031722186497387 -0.98976351284469132885 -4.1032463431374619489 -0.66617198449595904641 -0.98502156727560219451 0.64574468738734569495;0.56346282736596686735 -1.4161650784475157128 -0.29555919757509302448 1.1567990003919188524 0.076841978532681959324 0.86833178345783201824 -1.2365655062306160072 0.52493583305698632291;-1.1179409879584667475 -0.61154932731285538416 -0.64446617891798696487 0.067794890050275877225 1.2104903337882086944 0.32267219812132125201 -0.86297802412190449672 -0.26895160029480968955;0.40314189784378001713 -0.49099453412894844551 -0.19824768347096902166 -0.96301451545001415244 -1.4285823235717993729 3.194592832380035663 1.6420205297335881411 -1.5517958187174649698;-0.80217861056030037581 0.79702664053336846894 -1.3204268552147027105 -0.91144209499540318475 -1.2892959858208321577 -1.6942124381192626981 0.58290547639016943027 0.50745925192916607749;-0.41070887662119243133 0.095618524713304550722 -0.13152422032028643351 -2.2200178067049449737 -1.2167750260660321615 1.4543777894567220255 1.1459035642189931981 1.1609295850922505267;-2.5143538969462833066 1.5578358060807744323 0.28520051810005320192 -0.010761687898341330827 2.2754144998791470123 1.5802787968253366735 1.2217289225344221126 -1.3094096363885612266];

% Layer 2
b2 = [-1.8352772613040313487;2.2725170668633714044;1.3915198752647557345;0.90033337683473246837;-0.47564382977028668575;0.86225856576481774152;0.23795506057239920739;-0.68159440135827287222;0.66213244506282009638;0.57568406117656967247;-0.15015816562449058047;-0.39914454881978977951;-0.90322695054332791109;1.6765632849346314703;-1.8558622102143331745];
LW2_1 = [1.9885947185261725334 0.44409384276065844155 1.0302508819281779306 -0.74385460299063932421 -0.66890274409227457042 0.693888613709040869 0.57097350239161970276 -0.42811526140100419902 1.0338777316127842898 -0.38796341677593787489 -0.35091873927079025863 -0.29597424170040814717 1.2342938187703378361 0.47017300675699386092 -1.1053359493845120731 -1.0796799743040981223 2.5619831079016841535 -1.2247397598669436114 -1.5030631782060599466 0.27803334963685111259 -0.20931809048029681453 0.13776149382808358657 0.94119739172531446947 -0.16249529089167744078 0.43785648725941284098;1.7096307478174652683 0.76351961222525788209 -0.70473834801167345443 -0.18031680895744806037 0.40534250804043303607 0.069031967481624934013 -0.99735618145738025309 1.1656495056871076788 0.36592600935656022232 -1.5127535374349365682 -0.69418306911155358563 0.60576697787182787192 0.96585040076114359042 1.3979998157482096399 0.51180705485326183357 -0.52644611665285367952 0.49664096215527470113 1.5385295762062864977 1.3395861346275543813 0.59917195415293489358 0.61984614032799112415 -0.63512074588491340688 0.13917526147066613951 0.0020464332027666201803 0.44005244890663702817;-0.7621986680827204097 0.75326064978485385293 -0.062084183393778642757 -0.073140219935524705686 0.1644978454277092883 -0.024563670779422688839 0.71320011866115917698 -1.5932555735228730587 0.43565174426583874734 -0.22706483753710987594 0.73555900472210600238 -0.77451362220231223521 -0.62986559636257721806 -0.13494013003970992126 -0.23184478665201269099 0.27639788255904351733 -0.015536088860577813853 -0.075156347763626368819 -0.87221735573677217079 0.13131846369390381968 0.0019116581847781581593 0.5394717709570194808 0.39863839373329196247 0.14191873738587079679 -0.95246250284653666274;-0.15562208716040853984 -0.20238789763198442029 -0.74262421347365548119 -0.82951216350100009933 -0.12170880916631447721 -0.047097449750849569583 0.56249263777863156566 0.55620610905290657211 0.18788730089716931815 -0.050744150035556337408 0.13499034493214309705 -0.58897271662279659932 -0.23605541473067051528 -0.56367484775625442683 -0.57403651679185141443 0.67505973910788352743 -0.17677058973357612226 0.55245846118078034692 0.72538417349147454871 -0.13461898229286953232 -0.019011474382210732242 -0.14035720685280905773 0.54500083892583228717 0.36021953572698434121 -0.1674726849688041308;-0.55407339082293372012 -0.61345628173950994544 0.61142636100350289396 -1.5342558457240837999 0.29547730590104875903 -0.79697346482038733395 -0.084272847595716557367 -0.50025181496757931132 0.94828113191889351619 0.8212674234607931778 -0.37258257403531896967 0.17591540704362687575 -0.16368755046205793469 0.35167523121192834079 -0.43630573668851474478 0.33642922608450792632 -0.31076884074961763638 -0.30918625707770941435 -0.1582197175598278327 0.4967382723966063951 -0.64345883130743519729 -0.031092122932797696538 -0.16963841562097567439 0.69977135972276294229 0.46253121403267538625;-1.0842437679116092575 1.4428399336611577031 0.97557071751165669315 -0.56873082765882176925 1.0671419808960296294 -0.90033024255584737094 -0.45625558787160730434 -0.39956256827268604725 0.58553797604104784735 -1.4686647341634710973 0.22325318435181878973 0.12343146878897420793 1.2436065949452592694 0.41493143277508115485 0.86496539324785570724 -0.93847076949377605803 -1.1286936308819832675 0.79500782749342002731 0.20718446672909229811 0.93516004726710610928 0.34962255696233152102 1.1528809211635975274 0.56487358799952391841 -0.44200169662986088515 0.60889240370562336402;-0.20332038423191930998 -1.1570551663116417362 -0.21713176783680257498 -1.8464035153349476204 -0.27506700849172366352 -1.1160263917871509065 -0.014878220684856530154 -0.52953844196543564671 0.004728715044633359163 0.18963371617130359015 0.40872153825640644698 -0.81300025964965383363 0.058904086458670061599 0.22738335120723152105 0.024803168039481422041 0.5883309778555817493 -0.56963299137497824809 0.59123393529149670389 0.71752812800866150322 -0.12227222649009164557 -0.25476830659561050529 -0.045758166290249431551 0.26141523048178100241 0.55049437632181263957 -0.27648648345884585531;-1.0002171477995547288 -0.88158425189045597214 0.035632042169107265572 -0.75030619630883765847 0.49500915003954143456 0.0074174850268321455837 0.6063286907657120528 -0.90682061379458300809 0.16126325994070966896 0.083388762553316897463 0.17235908713427933181 -0.82066298521763592078 -0.62746372762601998474 -0.72645612119170777099 -0.92756610828298280413 0.42405999975869834717 -0.27751996288244729083 -0.12024017159438889213 1.0729350119842373523 -0.42293614148380037632 -0.37901369849711474824 -0.30552847041575353915 -0.24316165823908156285 0.14617577941904930094 -0.71342390101671016023;1.0363080562131015139 1.9697281881954504801 -0.70540303487131839066 0.94887076351953913989 1.5419491708455244083 -1.0675236968166168516 -1.7249084739921138887 0.72134191526731306077 0.44976587710542692555 0.11184446489902706567 -0.65801290778303467288 0.60258987116850371013 1.0566682155579831814 -1.2663854593537300364 1.1454602143410355097 -0.37084721533179570985 -1.8595868940170507955 0.90281800343570273171 0.28479692993245059318 -0.64165541637588996426 1.3532303711461661777 1.4177306319936597845 2.1368471732359415327 -0.33773952940875323625 -0.17803870289917705927;1.5987238755085875219 -0.21347772609190152071 -0.9080834356025671017 -0.68741640747008891932 -0.462306759753962071 -0.0040436995722907976419 -0.67826754042413117674 0.39080082081923778192 0.60114866412787781869 -0.3145485947645556557 -0.31604558442243646521 -0.56593971045489011029 0.59093594770542257066 -0.21219932162451227153 1.0048715966617627338 -0.94066335976078074843 0.018362066898733864911 -1.0716369594975270196 1.7031184070489331361 -1.5048234058124114743 -0.073383010661143832642 -0.19225878670290130756 0.69668199365952587776 -0.32188339038762842081 0.03292420644739499358;0.28781114523121675841 0.89535572011918418411 -0.59787095041453386379 0.08259973099543913011 -0.012343395764418675989 0.9540635971827570172 -1.0382559615587954038 0.54742177876370390344 0.10860356421891947942 -0.087073866418462431138 -0.46059177673892187643 -0.38149908964139328527 -0.091696433564244630987 -0.93215865269598241483 0.91768625164884332079 -0.63580129329300594243 0.81464358071600795341 -0.47984848305446153871 -0.80062461055725275827 0.048697870851526062208 0.563046170078476238 -0.38988730175054048255 -0.072971275754241810008 -0.84472066347420349253 0.070998425524312167023;1.2063625749609918625 1.110419099629827544 0.29970466860395256203 0.2103325108245452657 0.14459747930593089271 -0.9451880219751279677 -0.17520943154276019671 0.69738192155742551037 -0.35718065550334077152 -1.025477450254633327 -0.39008091364164010351 -0.77635518803062897319 0.42587313208143673382 -0.30861430609030926497 0.49042202311848681617 0.28621380201789659026 -0.37355743426867099588 -0.57688598555333636675 -1.9272744774226922004 0.97608205840733353043 0.22018562013236431252 1.0856845881871619586 0.0061271645601053657815 0.0042773523564334260672 -0.021577207856117608387;-0.73657326414284185478 0.36200246231623417481 -0.070718153695122909497 1.5801863752945515262 -0.82616820293351345139 1.2291646596317324924 0.2273642388611495091 0.3057196018231559953 0.34631669104958484606 -0.44720627302871884812 -0.093651502421108340224 -0.55439996933931556811 -0.50182748881072736236 -0.60653433066534756524 0.0068467125369887247774 -0.41631676363847186506 0.44803213838727451446 -0.2532726739930674098 -1.5767776983016466019 0.51795950686802794127 0.29329686631747353687 0.24487850949043127313 -0.29056949169779505704 -0.29148635026891961397 -0.14092034819681084623;0.34226813824983881585 0.19706886434684373066 -0.080323494552939439517 -1.0146776865007465229 -0.15759777086493256815 0.59448132233060380081 -0.03623292843539790975 -0.069405359723536549921 -0.57510451020124098154 0.013186247060693212507 -0.075583421387393961988 -0.87474931251154042222 0.021394707390618314391 0.010622815206769893603 0.092101200434804367245 -0.17935755002817166393 0.44440730400344363726 -0.14491021029107814533 0.027514198281322899131 -0.055637699424096319356 0.27654297957930323859 -0.23751983341332272293 0.42767570296370094329 0.021633566226112344033 -0.22920555917098026089;-0.1842582680863114053 -0.14406439888501978985 0.2276475299304519806 -0.27672340294176811515 0.057260285975099210753 0.71102350868391961392 -0.038807556221868363955 0.56384106665244815293 -0.021058169056149524112 1.1374665586398586825 0.21097747684451248484 -0.69319153136467315246 -0.49520688119045447317 -0.26615931429223305127 -0.16877536926165326303 -0.5022013251959749347 -1.1441085446659700064 -0.13264959086381919451 0.58491098316270906388 -0.74228226704155464422 -0.21345938830508459638 -0.51316346382514699265 0.19841361597645507109 0.60213747971415387816 0.34123999185731407335];

% Layer 3
b3 = 0.25337802897718175732;
LW3_2 = [0.38921729531799048596 -0.59798070452854701351 0.37296027019349853315 1.2237009093351649547 -0.26803170118309677106 0.33551619789754361101 -1.7058061763006244771 1.0449569911545391054 -0.18392413481605257575 0.24346681300238462442 1.2117195250545687024 0.72016244927821071453 -1.38366279898410105 -0.5962230624988530403 0.7759310671275697624];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
