function [Y,Xf,Af] = ESPER_tco2_15_Other_2(X,~,~)
%ESPER_TCO2_15_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_15_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5831611564267964;3.7116034946473482;0.54074911190183761;-3.6011092137209024;0.41958038761757221;-1.2580365698927829;-3.0676038515984896;-8.7561853963777896;3.0959158402211107;-0.15435646896719807;1.4997028941590997;0.88034901617593153;-0.78134893542596462;4.6926582272176596;-1.5295325109063276;4.1887712117083078;-1.4405325599336254;-1.6959148524302434;-10.889163640490512;-2.5806209189626577];
IW1_1 = [-0.16766529448720402 -0.81428592025395996 2.4237198304306684 0.30740016670135689 1.0422800464386686 -3.3421253672334865;-0.68359517352497079 0.32769298582284401 -1.4584827751896923 1.4261959206150523 -3.2262619756933217 0.83795988522254161;-0.1029597116650811 0.2555449991684855 -0.15739572576057231 0.41384147288592388 1.0536961915953971 -0.12576081697679053;1.1328613285720317 -0.49597602250352057 -1.4980991163204369 -0.89747541567200573 0.30036936889491866 -0.74858914803489862;-0.17781883544238131 -0.063094451190511616 0.55832277583985779 -0.59551843620048905 -2.3645117275631851 -0.42177521139547791;-0.063471396576820868 -1.4324601590222641 -0.33768079711000842 -0.25389579009828328 -4.0932980222796918 0.57977714465212893;-0.041142429050039217 0.018183127248205849 -0.35270165760606426 -1.9741910880484723 0.93575456301927706 -0.54646846885815004;0.84296550478876198 0.17933519064140094 -12.112453634356132 -1.1898499738211608 -2.2404711047062498 1.1400764230895892;-0.030984696353771893 0.12655922316179496 0.30728514240641663 2.9367851543619956 -0.40353594075051763 1.1272041141842313;-0.18523620276353478 -0.096833972219843148 0.62971561224830397 -0.43781207936432159 -1.8065223059841589 0.15917072229670243;1.388983431552727 0.46069710771580424 -0.15637436884775308 1.2562066003659962 2.9602793883415042 0.26186591706478124;-0.057368230729569911 0.25319645063202606 -2.5832500335443176 2.1832134844173088 -0.28600701659533079 0.2401667229736511;0.44798853811688399 -0.27154147961983871 -0.078415140422682036 -0.28507379057543708 2.7720160302072574 -0.53022356273973448;-0.99549627687161968 -1.0477526508848123 -2.205516023193439 2.4013599730014596 1.676676792819348 0.15644895941197054;-1.0712884729128447 -0.44484364410370192 0.24630795272786801 -1.0083929895958383 -1.9982442225502595 0.14502761925826654;0.99192684970443534 0.29001054228773931 0.61068065161373575 2.3772319376232747 -2.0470305402677678 0.86060499350427155;-0.82684875066697838 -0.47937954839940455 0.47794414178048428 -0.60412799817414931 -1.0864901592418781 0.40592707450328241;0.29970667599310974 -0.15148216953403873 1.2643225848203115 0.12260351437573073 -0.70678894857402919 -0.868045143890116;-2.1114922224990096 -6.9623744484799444 1.9680247732040552 -3.5383745371492021 1.8406416123811831 -1.2965927557602279;0.3591089901494306 -0.090108972485569844 2.0904230449992758 -1.0391552238225612 2.3098949219175493 -0.9893336431716695];

% Layer 2
b2 = [2.6589779052880105;1.2732034399818721;-1.6539655168869267;-13.727071957693582;4.2345603592910637;1.0620201774619114;-4.7760373853436846;1.8387091604133112;-0.7713950337804012;-0.13643365880842562;1.6669033983845085;3.5329255455295971;1.5602995668499731;-2.5766401066641893;0.67129980181393012;-2.570773610832886;-7.2991248258642205;-5.1118020837743838;-0.31286944253480403;-15.325156330774064];
LW2_1 = [0.31680000243211925 -7.8354242451199534 4.0266990408187429 3.1256276358949493 0.62585988720244923 -0.38617188385793477 -7.4745581466430338 -0.042001340372082308 -2.7813101549903112 -1.1931560679714452 -0.69249908197721355 0.75655504903224691 1.3312891752061056 0.86127854252235247 -2.5177983165969193 1.875163143674945 5.7467805717023275 3.4767121449178786 0.65880675516230269 -4.2459814259192781;0.116717397822417 -0.95824418328877159 -1.7651585214349967 -0.94499478198997977 -0.52424246091942195 -0.31648277449730411 1.9143616120516185 0.30185623329550165 0.9210480096601823 -0.78805177402748339 -2.2095246820245347 -0.2060914626061526 -0.24075834206287183 0.33400916779165085 -3.4128219593895244 -0.30212094042519605 1.6821319258386609 0.27564286410936945 0.54839033335482024 -1.3064806909248046;-0.7635964239357057 -9.1907683326129224 0.89066630510647626 -1.4479006087806354 -2.2937830211549 1.5059563577423312 -4.5311520859213976 -0.29503554291262513 -1.6714890610885045 1.0053185233087765 2.6775133568508904 -0.36646124536200536 2.4489164921634159 -0.10518963125339884 5.8520380305551836 -0.29813563994134307 -2.2738938050318507 -8.0050131614232569 -2.0660197096978434 -1.4874977163508583;0.68400901901414901 2.7705588001833945 -8.4170757293190803 -1.7440020254697506 -2.5843359844350333 -1.4999202855414426 -5.1571390918179008 0.17634654768766544 -5.8263911142318108 -11.474829502249461 -2.5542976065589413 -5.0157289233909781 -7.4367759645918508 -1.2706415200062882 -4.095178613009506 1.0796441015001601 3.1405523539057865 -5.3850061814410175 -1.4111898464992096 2.1481828261507268;-0.41773100259820978 5.0420713225895364 2.674231345651517 1.4363546612095479 -1.3527546211403072 1.1219235478471152 2.3789625040436304 -0.6225601022840469 -0.42248777477478033 4.7681742786172805 -4.6779827374989376 1.6087511373908605 1.2113395685436592 -1.8352940319634867 -8.5363191938273921 1.2026039815854288 4.3091396416378016 -1.7754397008940523 0.03125623869040299 4.7959256270642996;-0.098937805104736459 0.41195367327382859 -0.85718317218867102 0.41390488908097423 1.744978795691347 0.41573228476787671 4.8978839277189969 0.16124258812304434 -0.043689675531677526 -2.7238179690263387 -1.300416087763558 -0.14785983956737905 0.12809084862945805 0.37389058075832454 -2.4174479068097887 1.6083727104204375 1.3258081945944693 -2.2381005041009292 -0.5384661148523151 -0.34148014200710114;-0.50925604231452903 -4.8787925067013536 1.5045395217105757 -1.0114821825299958 3.5284529573661083 0.081333318547704092 -0.78137454001407147 -0.33911264191004831 0.56572837185531399 -5.2763346503514637 1.0203780235583011 -0.078916305041375853 0.6567302312401021 0.95750109675740458 0.46075071785033445 -0.46912734274956003 2.4837634568562597 -1.117046665963038 -0.65796970362040619 -3.9146299457443563;0.30925202484722891 -2.3640909655042539 3.2983572912717665 -5.0404756321632886 1.1924485206653277 -0.51913475026657319 -4.2934577947368364 -0.83205930875906764 -1.0386241962187364 1.5146172380690532 2.9167251457208576 -0.22740804368573311 2.0737227069052646 -12.118825685814768 0.58146709250981077 1.1272777957174616 5.6662587065663397 -11.718404182292435 2.6695029577687324 4.0453753960797521;-0.03819564706353263 0.070261673022873491 0.0062527867294029146 2.3734329728547108 -0.23919469015425543 0.30887773469012653 -1.6947397217986142 0.10141663922267448 -0.4023920005404174 2.7458042337643445 -3.7416565158896131 0.84689297172816813 1.5956436676875767 2.0099549506404659 -7.6526340125465593 0.30062357018126079 3.9941396975718324 0.53711101187144306 -2.273757023098947 1.44526050356485;-1.7394204182522066 4.2828633152716078 -9.7280272574157802 -6.0928428572641495 5.1364954872515485 -7.9855079480967648 2.3749789466538256 -1.0128690024397646 -0.50704225221045662 -8.2158042556197142 5.0956517386030677 1.8833363928926754 1.1914083415166794 -16.426146095215753 -7.0359522164087087 2.1907828003430234 16.280785343406581 4.0952093723020244 -5.700413621208404 -1.5937776152567118;0.13572653540749641 13.967032699768385 7.4279874321925616 3.4774068359432135 -0.50430136141278159 4.2044927473785725 1.9612587235161685 1.7694938192678102 0.79052036463685882 0.41524100564103239 -7.5489468383657998 -0.36737237375608961 -0.33471721275683169 -6.5721613026647798 -13.997967662286982 -3.0886178511397882 10.032612658879753 -6.0782051920714064 -2.0098605131706222 5.4145966231408966;-0.036823230752733749 -1.1874512776998714 1.4194320720903233 -0.49573638921827584 -0.34331529715175974 0.081516658437180173 2.2653772667125227 -0.27557903325755279 1.0897798297560732 1.125895998277429 -0.47124157010171791 -0.21135582878640699 0.54909545982714847 -0.46962609157447327 1.1543580091904575 -0.31265670305793658 -1.4150982073716076 2.728547039342712 0.96166589382799839 -1.6311824251510705;-0.7539585782440722 -1.3071960031929146 -0.89138984721706505 -2.7972802495573457 1.689715316144351 -0.77920731957888201 3.8780339876982293 -0.72229493145711099 1.8644571652503239 2.2175082119839336 2.7901781962543053 1.0509720681584058 2.4839800885095089 0.96071915171847511 7.6610744583498533 -0.086687819410311451 -5.6712230813005311 1.0398518374865431 0.65739411047985641 1.204257857352528;0.41982491642067687 -3.6801977769168981 -15.302143005148908 -3.8266088650439616 3.11994752079113 -5.6963622266740517 -5.6381032906425244 4.4416843025170003 -3.7668443676885848 -3.192663284864266 9.4493106763620744 2.1095239357314761 -4.0782332187696051 -4.1735645868477818 3.4280280085063857 -1.5638682282087453 1.8272959995960003 13.606507875401473 -7.6293667738669422 -13.60650164573441;0.047122900705802884 -6.5892910363151618 -3.8385779294502194 -8.1711112038562437 -1.0647720468677679 -1.74564428279836 8.1373511651719319 -0.37567096319784088 1.0613317458959273 -1.1286952984340624 -2.7579041759598355 0.62435888826119412 -0.52959469699839934 3.2484012806713749 -3.1761994285099511 -0.022047008990751113 -1.9260102582269278 7.7680438813763777 -0.83630373602077746 -5.6720849440672625;0.063323837341160968 -1.7783531871306528 1.1433540663706834 1.295673328475512 -0.40173302284851364 0.80822613573059821 0.26559584862242008 0.51979834944371284 -0.34661813284142451 -0.85450607087622943 -0.88442805511827627 -0.15307462449381018 -0.37634657167343577 -1.0469537230160602 -0.76461947698575672 0.56792938391901793 -0.38049719125527476 -3.2189435822666579 -0.43865153378945632 -2.5037263365238638;-0.15145322979141893 -2.7964566022756001 1.5792416134470402 0.6404711350635327 0.68095054315685688 0.33237958145867574 -2.9202303960242104 -0.03000875717292787 -1.3561313343148462 -0.44028983238569186 2.4411863405007579 0.20076857646270499 0.43479653112243172 -1.0408667927467086 3.6031381400393876 0.87213995030399061 -1.4233567803671658 -5.0422016294597372 -1.1664119696798314 -1.8495780683349103;0.26336693868929789 -3.339252624244573 -0.90358987780246935 -1.466125710485392 -0.23686826567151703 -0.59914393280946221 -3.7889882773187495 0.55492219749814442 -0.90321724682720717 -1.2813506006656208 2.6061031012089511 -0.71071330051713477 -0.5567707776839218 0.54155937387027209 4.1655318180550589 -0.022861261194541377 -1.5433548314471479 0.9302505880897276 -0.72957772115793995 -3.0998292662476659;-0.10130715583618841 0.29697445347406992 -4.5579966553190943 -2.2830011091562352 1.9228454656351899 -1.14618725357773 2.2840023130230254 -0.20252829591409419 1.391987001602214 -3.2319145728117413 2.5946222545681521 -0.21631262676480326 0.12418062961602232 0.90523058971142245 5.7098880887739218 -0.2897066349326573 -2.8941755066739003 -0.58826582829935581 1.2158573470820428 1.552764795584495;-0.073679778755051217 0.40529952492688343 -11.773700295737509 -8.2483091412847287 -4.1263509329566395 -2.3103597184589342 15.599552423741736 2.2963970087462515 3.4761405242165333 3.9108441598017314 -4.8686557980319947 1.945687453639741 0.23555105507436569 11.433917780435763 -2.9510799472581533 0.92732313463757587 -5.3644662011229149 -12.209209117690394 -3.7615999898138117 4.1663972307120911];

% Layer 3
b3 = -0.4834180286945261;
LW3_2 = [-0.10060063991725852 1.0335988560290552 0.087621643843235814 -0.31123422126457795 -0.38236699259879836 -0.69129565005881954 -0.28815734309651975 -0.10550370272049472 -0.2878920144020336 -0.049162615115122897 0.061328691042456918 -0.97461032975054485 0.36041143556118799 -0.016207118249143299 -0.11076246102712105 -0.71138407657716152 0.9347964173799943 -0.84220718875572853 -0.54546876829327051 0.060135051534754555];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
