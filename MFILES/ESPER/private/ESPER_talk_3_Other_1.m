function [Y,Xf,Af] = ESPER_talk_3_Other_1(X,~,~)
%ESPER_TALK_3_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_3_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-8.2941962720667828;8.5982444334425363;0.2247454909396896;-0.72556303477749418;1.4596248572022625;0.75621345875367085;1.2162133819763594;-1.1952038616945773;-0.37682382440934664;0.51486312944621349;-2.3525453856960379;0.75042456489355047;1.3251168254506971;-1.0914064019401071;6.4922411485311908;2.11037772529808;-3.2284179940416715;11.049201778187873;-1.4704437453653452;1.2574394308838972;1.9484108048827651;-1.0244701771431795;6.3146108978074009;0.13133500103440679;-0.68461206866564872;-0.50195242627123382;-0.16137934725397846;-2.5057962657804693;-3.0139414052297004;-1.2448919884276874;0.52804863409145231;0.99190264681757145;0.97442140014933665;1.3761495700180588;0.7325544735718551;0.22126388828899771;-5.6504586630839553;1.6387590183760485;-7.2717525143933921;-0.38089808916581258];
IW1_1 = [-2.1126192733958917 2.3711229518176342 -3.8309835038847178 -1.2984557292209973 0.46872796569729019 -5.3709592214438935 5.8119179513694963 -2.7970104680821524;-1.2540650219823717 -0.08063321427632085 3.0514812063865668 -1.6255264924546213 -14.327163546115449 4.3226852731350114 -2.1865891827767494 -1.4640047203619342;-0.066950100061980489 0.4108276119978298 -0.25153024137852242 0.4224816368180504 0.024582634043050399 1.1766102264064551 0.58847207225499276 0.89934458074787815;-0.081878902994115307 0.095888263620824768 -0.074918730214396753 -0.075354564472684654 -0.48689764249131073 -0.44338501786875595 -1.2283453925524479 -0.085169378808806775;0.51724135703557605 1.9123999139690608 -0.07630294551027017 4.6670589428219689 2.0819140668452936 4.5709203462084682 1.1381794702536721 -4.0440972289124568;-0.24249563521970632 0.24401155708179859 0.19142090210576035 0.47188863365829403 -0.26143689016824639 1.5604023188485652 1.5305167495646226 1.2532217227821072;-0.4086940300367079 0.31071450263194778 0.3332152212516114 0.098240555106295355 0.60947162373347052 -0.36790652692476944 0.41398425223874596 0.61255874914411379;0.38655122437132883 -0.2365321180458273 -0.27510295452632166 0.026720352872609762 -0.24826822233005036 0.39008785697174986 -0.42419662904814398 -0.65710979810992298;-0.011277077684581355 0.10044091031972181 2.1860936624575085 -1.3327007292390984 -1.4636798042268886 -2.2967339403760239 0.013512955345042757 -2.1474385590347005;-0.65902332118120632 0.12725421947925783 -0.42911950932797721 0.20369750939756312 0.94694341888975386 -0.87721564427557486 -0.76163714799181925 -0.61702139086958574;0.14089654819863059 0.36803148465128577 -0.69677390924664961 -0.45927708064404066 0.24056306368195388 -3.1369550702866467 -1.7457062849466236 0.12633013920592895;0.45761867675816059 -0.043128650616357143 1.897723396008046 0.48857527306246062 -2.2244976117456807 0.076834784989102969 -0.82253120334533592 0.30910525131543987;-0.062037167094886166 0.35050128081800636 -2.020946449530145 2.819538385829536 3.6976568878886296 1.4590130514717035 0.061700017573623353 -0.28754253656287238;-0.048366556373085776 -0.12761928482522336 -1.9006718367795068 0.95070036987317807 4.0154212471092787 0.81156913688082699 -1.5152566143830974 2.8970882609584976;-2.4248676658126307 2.9796664782784505 -3.8918388864922155 8.0856195853546495 4.1384595656402459 -0.65353959478192669 3.2766253307824975 -3.8036371742948205;0.45024257601895318 0.63759300315145639 -0.34073277956666459 0.9459521289367665 -0.58958618097295923 0.98507636839045809 0.46102325567149821 0.8307074150264685;-0.34846653751184148 0.090269723043269134 0.28730400464961275 0.88871771548549272 0.33824917647037361 -1.611580221721536 1.6526829954604252 0.8623231295164594;3.3287445397376105 3.6331652518953268 -6.8945660159140534 0.28891274741038669 -0.32612174741590905 0.76067637948745215 -0.20547166814555295 0.86096260076673103;1.6971548730703547 5.1647981920043193 -0.6144385410886487 -3.5124044561823937 -5.190804090230527 -9.6898236549177561 -3.6639379631370521 4.6102668839077836;-0.10502510538473317 0.35192637232635837 -0.28346494343898382 1.1312617316366393 3.1711766151960341 0.17792193060845071 -0.40859049437908029 -0.47669987826371707;0.25231018658250914 -0.332524039032628 1.3396937999871332 0.24955656690339909 -6.3713470158341208 1.1478426002492339 -1.4669848972477255 -1.1754587481867789;-0.85179327530710058 -1.4047282038344642 -0.64773857987050665 1.3095610808490892 0.29382426454486144 -1.2153768512256713 0.94459142502233262 -1.2577922949715599;-2.0721181009655885 0.20957924027961164 2.5215651932768695 -1.191444250586744 6.5158693924818083 4.1742226603896642 -8.5868003376847817 3.4066570830743421;0.92040902967849025 0.15799013238187168 -0.30197962277564527 -0.94906288839350195 4.4971850980613768 -0.32582392301978397 0.00074847204909572751 -2.4730240041169189;-0.72659886427360665 1.4748312575973515 0.5817650089926707 1.408142497289242 1.6210103951137191 2.4556964234232654 2.2028092187396404 1.8969654308114401;-0.098208892653502494 1.1982022538068089 1.2347484228940309 0.78181835549914125 1.7166677520052005 -1.1563900836205492 0.076898722515181553 0.11053390882138109;1.2846411504254089 -0.8794421419247801 -0.81719872789717707 1.8677618103278555 2.1421444833167964 -0.16587603886019309 0.21598165226941879 -1.5968700174875401;-0.028637864330167885 2.6226757330963979 0.95580653585150988 -0.071489594708845167 -0.35761235509225964 -0.2980459420862504 1.0945167692170781 0.45366870941697968;-1.2335219455917601 0.21732607007527802 1.8969810956810353 2.220023470047908 6.1112822560606412 -4.211371113459716 -0.71108274359185952 -1.1906955004606077;0.93565744340990065 -0.22408473549710403 -2.1821431665899604 -3.8912586872114434 -0.54083173190770106 -1.6569848984539135 -0.79403784939317279 0.84946498969146644;0.097726764063874663 -0.13226883027908948 0.012645022777855924 0.12139286431682196 0.5173291392640107 0.43395751818899791 0.80757912346787575 -0.09994573788347863;0.40750019976252005 -0.59048413910584552 0.9258065431245377 0.40057206014797753 1.98907970867616 0.99042263135766118 0.55963121779849101 0.51327745825305271;0.41760519753833392 -0.56865842577302417 0.79974879857087788 0.36463746232358984 1.7710636232071284 1.0566482564349695 0.61892404106282639 0.51398067387574742;0.41549439775276764 -0.41161168864144132 -0.123271543971523 0.094026480936431747 0.23227501365049286 1.1811223447302757 0.44896843314947965 -0.26474115060171016;-0.011348847511795698 -0.16170364109873583 0.27807164817842417 0.3730596754358817 0.50972314164032773 1.6759854912907155 0.24596235774396352 -0.78653604849105652;0.29947052424930909 -0.57621270398530178 0.37864602856587076 -0.30397130637560582 -0.88224996936318056 -0.8236104353634045 -0.25987096443096425 -0.93331734075352812;0.54280231216533958 -3.8408252311536346 3.6786234626675069 -0.31734193925641979 4.6058146255049905 -1.1298092442081533 -1.9054729410512825 -0.3261868610035828;-0.5317645914392678 -1.1200282015647076 -4.3146251488721523 0.53384773390924556 -5.2908572975282961 4.8888405850607439 2.7732607781244174 -1.0079657284138652;-5.250599319572876 -2.4217884459215311 -1.5834711187635784 0.66698631710191503 6.9974019433545944 -1.964563705809053 -2.2860232489943924 -3.3206128803712414;0.097984523864235618 -0.46352375392401651 -2.7105575601838319 0.95071432029390246 -0.20609382303193424 -0.60642787319810432 -2.6780647093647012 -0.58579727874879395];

% Layer 2
b2 = 1.1342788502252303;
LW2_1 = [-0.011660013506319036 -0.031002927932010271 -1.6394378530045761 -1.8941512582726594 0.0096850327132229578 0.40402544555571718 2.226198744140488 2.7236464374836498 -0.23054922158710664 -0.5868302254341361 -0.13348343644107763 -0.17229113155887255 0.062988660820144704 -0.24495105489603075 -0.030408717091692627 -0.25086059073749217 0.62126308579643907 0.054900841259348784 0.0075283578636073326 0.32664049212018181 -0.056767861839405659 0.038053519204732544 -0.015897024748817497 0.230204386442807 0.059157218296389945 0.12034881334498328 0.040199252194925768 0.076210908213974402 0.052513647881553785 -0.028876517822022611 -3.557344179639959 -1.6414120011986819 1.9118265514900361 0.93233915652113508 -0.33717891756017943 -1.0462760406475082 0.083310095198826678 0.034200228060098842 -0.013610255869589267 -0.067929410871866269];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
