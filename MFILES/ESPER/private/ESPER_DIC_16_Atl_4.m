function [Y,Xf,Af] = ESPER_DIC_16_Atl_4(X,~,~)
%ESPER_DIC_16_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_16_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8554144924602722355;5.7582165960657532011;5.2093169248702633212;9.0643651960124689282;-3.6924738911715722089;4.900947593546559844;-0.57417161893647095106;6.161454030018925998;-5.2584576066958437224;6.3017456801540481237;1.4209483861745941802;1.4130221260567346064;-7.2915119089162505617;-1.101140569493529231;0.12179328786003429386;-1.3103066293322191971;-3.9297028921139167679;-1.4947691389936754724;0.64087713170608473501;-1.1391616547012191063;1.8155750472837648424;-0.26476838017238996104;-1.8646469765720234957;0.93884474474439683078;2.4688547629045101139;-5.1992433289314456957;4.9186810820412443235;-2.5092483021586353686;-1.7768286743790915327;0.97944624754213915896];
IW1_1 = [-0.35355403646382321803 1.0538086569573821283 5.2192532847917139094 0.24349479050945471714 -4.1482029023860444994;-5.7308191129754462168 -2.2630651220821063063 1.7373919557601404939 4.7180382650698309277 1.6270098253119242848;-1.6200441713450894898 0.18873019681702363215 -0.050829673784879007836 -1.3712785834693734799 -5.1595995575757118701;-2.4274148658641543364 1.4976285030564187029 0.76558289906125676083 -1.2893051511897390959 -8.6940520033952122247;2.1962136279413253526 3.3042239264105663921 3.862868816043373954 -4.6215717774465190359 -0.6896759239249893314;-0.18828599007057178483 0.40712209923684705704 0.64991995327084706169 4.3427698534910668116 0.16493782482286192814;1.5803372106132937969 -0.72597805278368543469 1.3075873772938213513 -0.98758162858041453891 -2.0481669070596355553;0.78256192432313453899 3.2680176903956428269 -2.272997353239932572 0.3148905739190454578 -1.4716424115915165416;2.3626465170128243543 0.44370865999534042645 -3.1927015111658012536 -1.3070510413749549805 7.5368880033838658861;-0.12131996246319180777 -0.90690687487414434198 -2.6648462326387045707 1.3930565919016306697 -6.4619458073746676163;0.095445499263176469817 1.8859180238362072135 0.36128487061446740158 4.3036553174295777424 0.024066876397520250291;-0.32412271363917821709 -0.66508452511007210006 -4.6921094308031650044 -1.8747406189295452439 2.3141726876947896763;-2.0166090162640526451 -0.59514705470539208676 -9.2469291151529322548 0.20345441314163656421 6.583142595777817796;0.35727598332962545724 1.4862899122184674017 -6.0181158437399941974 2.7254065289171869324 -0.043459523843865338621;-2.2628267848371534932 0.33846763550019998146 0.29229857895607319618 -1.5622444525484102673 3.0949193945492345925;-1.1646550556751398275 0.5220408492570723924 1.1253220958736722679 -0.49593228551539092486 -0.38331639682304563532;2.3286023412306153801 -2.2715636934780594203 -1.2958216493014882431 -4.9306381637772238591 -3.6693049824696877259;-0.19809204695570242771 0.55915331567013826231 -1.3373218059986577977 -4.7098009373946112532 -3.9328067596901492564;1.5943104131261423007 -0.20255663736575416078 -3.7655657269091968864 -0.6621256256103454918 -1.2558356315415406534;1.873739261768123221 -3.0343955022118236364 4.5360584758051905041 2.0291657315895319513 1.3220165201170923641;1.0982771443263572575 1.7355063095592613287 1.3801869175826371183 1.2950967303095859418 2.8000331083880145577;-7.1769251828254114756 1.8267987598407202654 4.140226067116604014 0.854154924682021921 1.8180606658817317633;-1.751791595743106722 1.9338781948633170238 0.79502283221819813885 -0.95207110669856487295 -0.95859414966702749528;0.45613692751871165454 -2.6706652774196149025 2.2700888353761805583 -0.93735563735580063049 -6.4129929380945815964;1.3702065314127671591 1.1884382060105775913 0.40258344925138023207 -2.2826267454794297862 4.1489118488812941621;-0.04216643280960182677 -0.61700459787972328218 6.2796262166517839987 1.0282828981279548142 -0.57577699530383452675;0.52832739014499874308 1.06231645685681797 3.1599918151344299488 -0.37049068547843977406 -3.2141108952863901571;-2.5060476536161386818 -0.74684380650373882737 -0.65587574991092378873 0.19490483630742183596 -2.2379190019421586477;-2.1439099206914300488 -1.0842294644959395988 2.1501322079145945843 -1.9641938535149847667 1.3670704889977558505;-1.0293667791216023488 1.3906719848390614036 1.6838532982865042076 -1.2195877217570452178 3.601129662674813936];

% Layer 2
b2 = [-2.0595046242379630996;-1.5624036546730182273;-0.23925340897736097068;1.423866593380394896;0.44831777322924615259;-0.020752945211618037402;0.52096644357964694283;0.2121855538215680903;-1.5773255775102470455;1.8685621872164490664];
LW2_1 = [1.0294436095783652263 -0.43115794070915591796 -0.10602618928262901032 3.0051354641550300784 1.8158972357082092675 -0.56123306221122737369 -1.8354536362723932186 1.302614458360742189 -0.57579907260241436351 -0.19627692565859736207 -0.050845684138130300966 1.2023127611461639219 0.46762004127554540611 0.91921707325524304455 -1.3216706380196658888 1.2848894883970738423 -1.6741290440395009131 1.4837118449219435234 1.1085858491139231052 1.2481771188639376735 -0.65590370748220550023 -1.7480844033928737424 -0.12798908723780935692 -0.1503957483724970845 -2.5048473771230250762 -0.96859535825877696169 0.032988429875787088352 0.40336696243684616592 0.45812231740160741511 -0.41673660820902552748;-0.051304165029655873775 0.021050107187401141673 0.33624500799738660239 -0.77273774171882314565 0.17544580461611128386 1.0732471679902089168 0.15152909730108068964 -0.70170262651543813259 -0.061287493801945827632 0.44236455972703775386 0.008544746267513707999 0.68126507992311191586 -0.028114991481332885642 0.026006236888937595692 0.09936194596671697743 -0.51407749944058434011 0.13528554538195944335 -0.080408938135186763807 -0.049215575941035677454 -0.018841426593319537258 -0.5875500223237838382 0.019207902863558827533 0.68815908595715635787 0.30290645442890740124 -0.44870839318808514173 -0.40618766919315468789 0.25645921150853956405 -0.42086991366590426056 -0.19427078290754301593 -0.36237066722607486069;2.0366041519001307769 0.08271633909927970929 1.414435300564882203 -1.7312851871722507724 0.54994805828718928975 1.5622975195622275102 1.8218605902994902124 -1.2091948798738565429 0.19531102418488471839 2.1923933419245824616 0.22866684866449318858 -2.2066599816711640614 -0.19332249695817987911 -0.41853512010980686853 0.27548309430457790237 5.2035693057121576999 0.1693105670119952888 -3.2707719382424356169 -1.5032573427919446729 -0.59972979189816155721 0.47921108952608543197 -0.91018034162024807898 -3.0948195879789524021 -1.9137287568023564344 -1.1001943593589063042 -1.3739990049011523432 0.23316314856617167961 0.44459344454599808438 0.89373105557317555903 0.6832908746175123671;-2.0918480770286724812 0.9524483504477431195 -1.2377097084644741454 2.724573807549645732 -0.76424559700521055294 12.726253744648944988 0.27750340433195125334 -1.8226204193524828678 -0.75965626131046304348 0.081716931554896121703 -2.0165503174979653167 -2.99434682558535048 -0.12644590558264404145 -0.88181743348394248105 -0.22970672218818330435 -4.3803650262450863906 3.0880193906203121657 0.70038087728485687311 1.6193830958322013025 0.70703314397423477899 -3.1783324730366553368 2.0776852434771133638 3.3721454716307657229 -0.78022003985744015075 1.0077272114761106625 3.0932121920769803936 -4.0328370087273883726 -2.2883006249785955433 -3.0635781252947782427 0.052494760621272500145;0.12155151010626756569 -0.014522539334621727136 -0.39101330444500342898 0.83705196021225392045 -0.21787958349054922791 -1.0889677722407058447 -0.083898004176737886461 1.113957557111940222 -0.069459190063524633985 -0.5992023731285249788 -0.010653538482229803555 -0.63349473539393574839 0.10685070307181294968 0.015710447172900168789 -0.1534104403506375558 0.86031998618413529911 -0.21939299977237833317 0.33231407363568349345 0.18865607357548913603 0.060582645116467014057 0.59968829352632724294 0.024526454678361050976 -0.86538148157597527543 -0.20899543944333145995 -0.88937001602628429353 0.3094932275406200306 -0.41770138872093109939 -1.5511077937987736153 0.10673860259451951882 0.57754415389881208487;-0.93880285254847795073 0.31189582405751309357 2.1199192911175770426 0.65680343572840105271 0.017565458758286026791 -2.0252974945795543249 -0.40004695766332976081 2.093296092174638634 -0.38555985661181729762 0.068322739624636100175 -0.37217762795417330679 1.8860683576946377649 0.17727102615105494454 0.34691849968226062817 -2.681940164184404729 -1.8643360984769417055 0.092527004885877908724 1.5294685692947820321 -0.21724842916753425714 0.71755343210986466396 0.070870416665638355513 0.28814368918433608258 1.3031346180770524423 -0.21122033980015589294 -0.1964500450403348919 1.7068253746967523288 -0.38019867726679551501 1.0539866072713857115 -0.60454503796678582539 0.046473502864713543692;0.2656356272098204796 -0.43327643034607604688 -6.166850297068294573 1.9494325886881878063 0.0013910614269574284735 1.8643403101653968079 0.88567623495986402826 -2.372163339029176754 0.2196726827234007362 -1.2787409071674666894 0.063443900875421385677 0.65310266531619987074 0.87107634492534102844 -0.27796879381079631077 3.8436383277688155324 1.5481644628925852469 -0.13901533427282003474 1.7384524876532272408 -0.0077953071869895076626 1.2403565136487413323 -1.2919926058828319348 -0.25173232632465591951 1.3312722779763943581 -1.675333769840103626 -0.42128240222563123618 0.11215097606884560921 4.2438304572616960542 -0.10456663692819898048 0.96707671635905156915 2.2819002081265726822;-2.768765227075328017 0.78388013734718597902 2.5476368779221547634 1.3746307087024829396 -0.84445684654557173765 13.666347714720618711 0.76276805544096615286 -3.1942145663038199466 -0.85882302700152679531 -0.47838233615131203758 -0.68140759564287534111 -2.5154482977758272355 0.67581835057717676296 0.1160943628883702311 -1.594217344120950175 -2.983837265873567457 2.3894111455815285616 -1.161552868171153774 1.7323757466265035099 0.9911116959542495275 -2.849262560283883694 1.5462088530703914646 2.3487193540099173816 -1.0379956604752476057 -0.17006138377881091506 0.7809337605473579691 -4.3860041167060508371 -1.8597946535807343693 -3.3861620151345199758 1.1029099006229172719;0.43434175352664061709 -0.87791929138774404962 -1.1740662068583391786 2.6390056823285443777 0.98269646149812051039 -4.5269837764099616351 -2.3751361251645062289 -2.8796088204740764027 -0.21661858738397676838 -0.17733915324671656322 -1.6389597691205695096 0.075257509282286236263 -1.3544542839701636527 -1.6732884423888434444 2.1618310582720483559 -1.3528992074042622829 0.29845827367376692729 1.3266536420437124999 -1.7611682009901186152 1.5983985454022535677 -1.0266897358995417111 -1.2239359314850160043 2.693822129390242015 -0.15247915032257131074 0.33524034613583714171 -1.5246758617664419866 -0.99447990327531110566 1.4451984631473853149 -0.76187805782117878906 -0.93816549476073229918;-0.18394032225019071869 -0.030130436041869580743 0.18539255125733547502 -0.064806757806065845573 -0.24879079262269354622 1.0636047675568680582 0.63451106574807525362 2.0296612250851016057 -0.55140671681385000635 -0.74627548309881819311 0.13224243004254898626 -0.72944592642507555258 0.30245498423753497397 -0.050340220695672198425 -0.21039559703362173404 2.3849298952465876056 -0.39480649709738663278 0.25449951563558781409 0.42280598604272423557 -0.27815795755212635587 -0.26494996773598100681 -0.12337742631199100085 1.9549770930086154408 -0.27834504905411211473 0.06583121106674810763 -0.24019775037964277709 -0.25624681276866462243 -0.94612359146259250586 0.021989697695701172775 -0.106930590125549424];

% Layer 3
b3 = -1.9266076099239515251;
LW3_2 = [1.5228895657783501072 -3.7515093705944164704 -0.10809292849823214089 -0.152761113589530928 -2.032663138063357966 0.15000992213423103294 0.090764770202137717847 0.13505714962114823141 -2.3584975722627494754 0.25871977561880932228];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
