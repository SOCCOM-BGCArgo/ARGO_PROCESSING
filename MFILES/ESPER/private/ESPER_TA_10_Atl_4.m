function [Y,Xf,Af] = ESPER_TA_10_Atl_4(X,~,~)
%ESPER_TA_10_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7213076168642524877;-0.19524193309142909292;3.5325681608543200163;-10.435084486554231376;0.26793119570155865539;-3.1177026483907801513;-4.5041500981396547232;3.4113642767952851997;-0.65947950062998705878;-3.3315697544143105802;-5.8960102409085779485;0.57124663139830955672;-5.0996249563624935774;2.7805926833331207071;1.3380722743073445447;1.8954621936580502428;0.024916437662429614247;6.1033031328158298123;0.69126594661190199353;-6.8071765034028093311;-4.0887509997913458193;-2.8849933978915465183;7.4373383842089788587;0.33745791072886743844;4.8275519588587325615;-4.2532697512553223618;12.685289213552334076;3.5984930612395293892;-5.4821790181210472426;-15.449487091890560464];
IW1_1 = [-0.59985394150301174498 -0.60458351808190635701 -0.16512122362933398523 0.35980771687972129547 3.9415153713569321958 0.62708140491325603527 -0.36252956461935637034;-0.96225981906786561826 -0.28158458964983817951 -1.2776475910073152864 -0.0024621647534891033353 1.7610395452987137599 -0.063615091925858166522 0.10293688278868956543;2.1592548842238836748 -3.5941060442567565048 1.6877071715602633972 1.4984594358030967065 -10.597319873390077305 1.1576288842511697208 -1.3228940883989124266;-0.59360538917167404716 1.3271024091600580608 1.3228732868187456084 -0.75500240777646532297 17.992198879034472014 0.42864344486879857321 1.0997345737918009512;-2.5045859066744351473 2.8763433991424522951 -0.27425871495406289879 -0.48088798891894690701 5.6006094566426911641 -0.48672158233664430949 1.0627864199678509483;-0.59512580772690004682 0.27239355920546537426 -0.20511636783733153133 -0.30250686480295996272 8.0855782190104790175 -0.42972145237289177677 -0.71463322692224107158;0.0076650051307427134392 0.038185604801617221982 0.94203009693252426349 -0.12161569087522727806 3.0243139122170199506 0.45049269044486256464 -0.6889878001575616695;-0.75760862781088722517 -0.91787221109271988073 -0.57730119088051379261 0.7723577373524297407 2.6539435090458116662 1.668397265738581714 3.2757040260947078991;0.79325425986233000231 -0.057836674407852929625 0.94597945869553246023 -0.1480522071917303728 0.41897643662726569147 0.18804738786562597008 0.091026401375148321971;0.79207333282977587796 -2.0001429347234958023 1.3576365532712706408 -0.2829956976866075391 1.4617154386915227615 2.5908457729582532458 -3.4635345674152815398;-2.0964458656989317653 1.3837799497301594975 -0.42188204877178814289 1.2335163491538709835 13.757281193194909719 0.37236930067789875132 0.66282097666962791482;0.86744578628373880669 -0.40196493568286634224 0.50442861637580727052 0.075184964099683226912 -1.4107393170247453096 -0.11624327487635521816 -0.1830768899902038005;-0.53049057720953529671 -0.023585703489589934095 0.48880461966405991392 0.18396668051529399546 8.1531538135239856047 0.35110875337626534787 -0.12995512996896652069;-0.4982420054669186027 0.090683656281306562752 -0.69466550542371430232 0.054725097153132937211 -0.56874573086515656239 -0.19174172777330741879 0.063966339454967519051;2.2685268659270465541 1.7069041065022740877 -1.0078469097527460452 0.48590550176250574266 -7.2750394472766313214 -0.1935440226627802851 -0.19403343262796712843;2.1430675256254754224 -2.8083614451514895549 1.190115901478706828 0.11512432280204770718 -2.4206766855800676552 0.45707189385640667467 -0.64922335036777922834;0.25990289764176793819 -0.09990298379632678305 0.39732386545349124285 -0.003103762068273536491 -0.97899251300356626704 0.0060307270772764964492 -0.12253529151053056678;-1.7718436451270844767 -2.9890892559437682863 2.3703056213630424587 -2.5756644461253488387 -8.4867398430220344352 -1.2633776204063891235 2.8783321794087322054;0.051145911727064820307 -0.029477882160390836419 -0.15353958846778545388 0.026080902533106437025 0.35273384120501588557 -0.0058312473084146335817 0.38688224849951857731;-0.92159226693703955036 -0.054015565139866938971 0.82215837898217936086 0.46826300102935880521 13.51723109244360721 0.49302450086847743327 0.08589133793812814277;-4.4991285999961885267 2.0530835551347133006 0.56269080832746798393 2.3426112428571532753 11.093408382593487715 4.178144142119000648 -3.130599807751226038;0.13534158834350046297 -0.011076011001529554451 0.63940295833477900356 -0.067588728764530023319 1.3846504749204344709 0.28157185905723769448 -0.32301647177648468157;-0.78971438934444782021 4.692737188717108765 -2.1601883820655989332 0.45520995927415486282 -5.7215917555844990616 -1.7553091579551294288 -1.6036863666406018236;0.029055791475755474162 -0.0049863230106927227195 -0.24793991789514915891 0.029992844738951331823 0.6912132896783450553 -0.015702868172670084862 0.41726773864558935889;0.51389423774113252019 0.017708536275613785682 -0.46269745418514118818 -0.17459201742841801153 -7.7413040315352601439 -0.32632312571239413534 0.1348427244908511069;0.63795842425478277438 1.205111523410075991 2.1252573831410441763 -1.3329563357793690059 15.529498189346956138 -0.34224746156605317937 7.4927984533947151746;0.64484794602302808464 -2.6524832148383321595 -0.31246405124866016845 2.3067368708793072329 2.5566220087734992106 0.85447306678510770439 12.258904562736868016;0.24784012647916286998 -2.0081939816011216138 0.38394381960257151221 -0.55603563850690529424 -4.6531578726513238564 3.9357636175444414839 -1.2362898403316044948;-3.0730077855250437224 -0.99476716533499787154 -2.6289848692525201734 1.8103469251452422029 6.4686105270887699348 -0.25837850802688594465 -1.2701679831842016544;-7.4416638259404974676 0.91544179461132690889 -3.2468757967074184378 3.1733135767670690441 27.642808637880758482 1.5410396951187839143 -8.7676819198153754797];

% Layer 2
b2 = [-12.443151917940848961;-0.35928562950347564531;-12.224636357721495372;-93.097480094277187845;-110.96797265077341876;-21.11241790590181111;-22.629664626596060373;0.16477864930139785038;37.973771209801121529;22.047638343172117459];
LW2_1 = [-7.9065287792367540121 8.7695948241200714079 -1.1022997930010389744 0.19444828393382851406 -3.1662712762036475667 3.2423485520666188719 -11.771240939946171267 -20.430240693326663148 -0.083786951024526198917 1.6055561390002981437 1.7089385662609777317 -3.715632163737839555 0.51836364936524681468 -22.730997444888920711 4.6577780828453123618 47.137905987105476413 12.883655335950898291 0.84658607577760847107 10.526248920771406503 1.6669658526372865825 1.0916748591836227256 26.007061813492896363 -0.26445783569290615134 2.3062878343855817143 0.047726412771715860661 -0.14261704287088111665 22.383908295780500453 -7.5326687048088816212 0.32423150924630572689 -0.15401484917340166336;-32.019662329067635653 12.409292973156386353 8.8723424601257789845 23.771805910195006106 -28.223561977509010745 19.730491966020704098 11.831125306206498493 -5.8665649667936721201 -68.587232877956950006 6.655140408422450804 0.61690714335146978886 31.812400391790720988 -23.546645530682329905 -2.9562082712205457469 14.37408336374721074 -58.595545997205753963 29.582831638700845645 9.6719067134933620622 -36.983787360629143848 -2.253372103452098596 3.2313539461757034843 19.825183784219987615 -10.821982245453963145 13.16793967049995473 19.179727586811328166 -13.384160998978805068 33.141963136671911627 38.796937590719430489 3.5921931381077549794 -1.5193670280924842508;1.779718681375223488 -0.18394900770066455187 6.4076730933217795894 3.2657761229811659298 -2.9572576304426512195 -11.491199273360628297 -12.759839740295140231 -8.4173483101548001173 -79.324001480815965692 13.683314930374761431 24.817084897213852912 34.454952987076318038 5.6914774043402553971 -47.708275950836600998 26.999468140384969672 -27.988291860091372598 -2.0682354713269783808 -33.900919948822448191 14.598292994647765752 13.015644731370692 107.4741177155200802 15.403159320294355084 -8.2919535383012004104 34.670579009970261097 -61.374745425596387349 -2.0604848386446499298 -53.373455922780273397 27.825277515160639297 36.415729935671635076 -36.025520899051841184;46.049359524417333489 37.140366608980500018 61.542961469700827593 -33.589953664037359715 22.872406678789463541 -19.106072296389353227 57.139629974844986293 -83.613624310605104029 11.40702206775196359 23.224381444849644396 -59.895745717350550308 22.83803899580911434 39.698697928877706431 75.554816934848773258 24.03631450466003372 29.214109109389188035 22.84616906833559824 -2.9148066700754764469 18.926838390888729435 -13.188243613946951882 -14.721655587129001574 70.112682964839592614 -0.051798885421009542573 66.256142033428844229 119.35333450825861235 5.895102053234681172 57.643318952151950896 -37.339505348273291929 -22.792189983779252316 -3.1889143972598481547;-34.317593240707637392 -16.266980159591589938 27.92223823037500452 -79.001059603328116054 33.805987955573080228 -9.6520591228259604577 -21.583156110306500608 16.605518660642673012 2.9049172951958417421 2.2066462241949378331 -15.627359154345713321 64.404328807893463704 85.74556235280169858 -36.857216146802819878 -94.167035079950565546 20.695368225339912271 -23.568139480577258382 -2.1224335901739603827 35.402669791636981245 15.345969274907680813 14.232147170817338377 56.599567701522197183 18.87666075718528802 -10.146272344119172004 37.056203124965819029 -4.0088206939251316285 -19.361959610387085462 15.424773471290482263 7.6819432362293715855 -2.930578932079724197;5.798726574440657977 12.925103955799141175 -16.800879558595035235 24.969429896753194242 28.072360298333883577 11.512094214525580682 -21.000645063120593647 8.3185420025305933933 13.1264304246438126 15.20212820546512944 -45.250576061681520912 15.800892559690229433 -21.393527141554674387 -13.930420647836069037 38.934529958547258843 -33.99345426800140757 3.1949778691987367196 -6.7429059489166327523 -49.998153419728751601 -12.310670667816063784 -21.727065445390515208 -53.85256819440169096 -26.171901654277792915 -27.357550098189022947 31.09162148870192155 6.2323701587179396455 -17.974911012955285372 0.028544760475656821841 -23.260797823675620322 -7.6046856141821903563;37.614318813747701142 42.5606078799284262 25.495915049032120692 72.488561268547272221 -86.037411842002583739 27.298799070792973964 83.652515860480463061 13.182664234787667468 49.341428778032017988 -13.643034273676832413 6.2780083122192529288 -10.314878381496599857 -41.9004685033703268 23.56390711346725908 69.631949394041754431 59.386871769703269308 -38.824144545394467798 19.826902483076601413 76.908053103943714746 -26.847355238412522027 -9.2623265714188711684 81.726740832588191665 39.670159702475729091 123.62444610493855635 -64.669370458989916983 -13.630144517316686859 -0.52901720903471749491 -12.584273012517131818 -17.272467235584123557 -5.5971145723506214864;-0.050014504075717843012 0.25574565163728701922 -0.011084219279494848462 -0.0057468909949865351616 0.012886437081119897843 -0.15071991682212027008 -2.890185555090242886 0.02003902802778732492 -0.31937930989077906174 0.017598856612415180595 0.010735167029079700773 -0.42612543481443515558 4.9220314383423877658 8.1068172196561754106 -0.01922594000413512666 -0.028921680588736817935 3.5586572301496968151 0.0078712830539394585544 -9.0316661264930147013 0.15382090954367166891 0.0037046965325789479005 8.7493398080964741581 0.011163705679393566908 8.1250965205175482708 5.4101522474045591338 -0.0077172165204537060065 0.0028728600891528002434 -0.007484078582546551707 0.017277208711372608885 -0.0030988702291825215816;-53.487815030419710638 -46.3131982283357857 -45.046974221991440857 -33.601528736696259614 -54.754201107773681656 1.129089989790197146 -35.315101624358447907 -4.8085875345635544775 -40.724396545415338267 19.270174528034029748 -4.1299693032792585967 -18.687327949344055611 16.010892616579464942 -16.307342080114526794 -30.330687372034766724 16.575249501366585037 21.446227087041886961 4.5129740564274110071 -38.812081762934568019 -10.323800875261149201 6.2143170892882189094 47.353093720217103169 -25.370127947014445624 9.0747017433949270782 11.395534274413673614 22.518569428009243438 -6.0089112598365126416 -4.8838908655820061355 -12.249988533529814205 -9.5630261010545947187;-9.5924622637130116942 4.4445389915100825817 -2.6852978703922878445 -18.850733881258449287 2.9095418527931005137 -8.3227487254026861763 3.8328534563479887964 -27.258421382177893122 -30.420681520793003472 32.653986138094907687 -32.533347154893434094 -2.0145784715746426485 1.3293278617481967263 -17.017999066557745635 -63.778529223060694164 -15.161677956165881653 -6.2719118859964684276 16.500039411131261602 13.749680654994401507 5.7324993353417443842 -14.166748729378602079 -28.272631125944009511 10.413571534246269579 0.73229083060799515792 -1.2188132288516047019 -7.2117975977928567843 8.5196923140210625292 -10.452033001399499312 1.5181490314127117358 -1.8350231126750917721];

% Layer 3
b3 = 0.11315309930419922835;
LW3_2 = [0.018576892171498573386 -0.0020752684110275040376 0.00070274002811569714552 -0.0004106921081582930763 -0.00077504630692927349318 -3.508197587220992299e-05 0.0013402036302874954701 -1.2771947970510459935 -0.00063605565928800489404 0.0019756531588893799095];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
