function [Y,Xf,Af] = ESPER_tco2_15_Other_3(X,~,~)
%ESPER_TCO2_15_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7930331307175271;3.0066653657820703;-5.0799928332433595;1.4754564122788267;-0.46367349493063453;1.2461174325404132;0.039189712769175489;-2.1771444947560612;0.5962793556251903;-0.71170999513355393;-0.18989491853573073;0.22160030223112992;0.20883671506758703;-0.28505162398063316;-0.50459281616973561;0.082167476106066631;0.57920087333441506;-0.81013207962530431;0.207123563866116;-0.13474109998252864;0.71046837746308289;-2.3588462750059533;-1.0604261123805154;2.0277160573890884;-7.0609642293096382];
IW1_1 = [-0.12884606122596662 -0.25549930456043929 0.45404062294065173 2.3008876756307455 1.1365661742943638 1.6470032923631557;-0.15898504429465143 0.0044145327470466594 2.0261318858609902 1.7219957813795226 1.192736560658993 0.2464547073008295;2.9349989251316511 -0.002199161988637289 -11.121140461683771 3.7014966976292643 -12.883338234297153 2.3674492385328443;0.12379211674909241 0.39312589934392289 -0.40440985068208973 -0.79363683993970402 -1.2637915813754714 1.9157821098662582;0.82017324726836527 -0.015253086284748018 0.30571599029765584 0.82958163754578285 2.0951041511564044 -0.55384588155873726;-0.064429839686463403 0.014919861944002395 2.568202708525082 -0.36892537039629963 0.96303664045703763 -0.38832023240034913;-0.028844420298337493 -0.15521392486108951 1.7953555089695998 0.099470155384464146 3.7291161503235899 0.72308174088756905;0.1219402214657347 0.20621474079455598 -0.77867619031520774 -2.2359404578863531 -0.59599232303245586 -1.2984562232847316;0.077494580538306601 0.2687593989537625 -0.62287144713723097 -0.75879514860342068 0.031603475837626752 1.4534039054775507;-0.7952926200475553 -0.9908617646074509 1.5939247033743584 -0.057018424487591528 1.2366611205697846 -1.0921384877662137;-0.10451246943261353 0.080716763972037836 -1.4494732730684496 -0.046733042641161737 0.71153681363557575 0.088482133211556624;0.094635137368933933 -0.085907484313756582 1.7483660398220864 0.014612731290070111 -1.5037627537001517 0.0073136492760933931;0.048074389130022752 0.079895422761145571 0.58570479116246565 0.33793219613784992 -0.11260987366159303 -1.1536283831635894;-0.33080962701084415 -0.63924275571831812 0.89775821403373035 0.51367612689424624 -1.5051177658975905 0.20979748300107037;-0.15556638662512282 0.16688063897979352 0.3700238432959817 0.39788053395118034 1.7403550021652341 -0.78964397362375582;0.16469947960177908 -0.28357935856162741 -1.7652211689421893 0.53177778026853539 -5.971966184714697 -0.031688634252076388;-0.12907674120076179 -0.0016522526495101305 1.3741776844452762 0.069997604475713515 -0.25671926482101587 -0.12200924985862215;-0.43896692048813518 0.252848331947714 -0.69228890505106611 -0.78800731315502248 3.9872308321696837 -0.74028734167361265;-0.29510376982267694 0.0062913983999141488 -0.7795870490521889 -0.37892497353361887 0.48530578579258349 0.03672699605281713;-0.12932967175834273 0.15354068703164084 -1.7598634326853562 0.48127784945796293 0.30904089764886528 0.478054838237228;-0.59250845386826601 0.19054406475806623 -0.83651046012348662 0.067713054562362818 -1.1716798570249549 0.47234656896091309;-0.31116935397289375 -0.26488844712723059 0.74686918227721366 -1.5402260109251407 2.9404816214273257 -1.9878536333265064;-0.40661942541333973 -0.34742337489547559 0.32245233271298529 1.0843939012456596 -0.20769155433827272 0.39681699510824647;-0.047908677346527651 -0.50997949525353148 -0.33069391053912994 1.2060237865151904 -1.6185642137286216 1.4058300704239379;-3.705626995122381 0.89473167417977539 0.70659245861640407 -2.4571564141178115 1.4192495101246068 -0.78717563400663615];

% Layer 2
b2 = [-4.7860651184681071;2.2425173859963472;-2.83792586907142;1.004533090405652;-17.973810833362318;2.1823395000061589;2.2123839995074315;13.873211962667794;6.9857881073392738;29.995322533489986;-2.2593077136326065;15.909230897156208;-2.1388693580699147;-3.4025353892109136;-0.016006912259419387];
LW2_1 = [-4.6630877496418295 0.050974967347492642 1.7064376303960742 4.8310876738519219 -9.5747627787254856 -8.4022443873043589 5.3771859312180554 -2.1656865422553824 -9.5279092648543227 -10.290595742405461 6.2644298678942363 -5.1873906144430766 12.23965843544141 18.070526360792002 -5.8377858270228984 -5.9766827111047105 3.0531459715296752 -3.7522466136191501 -2.2230472036959554 -0.29624394206657195 -8.4457566072313508 3.9076256045740876 -12.168346633470891 4.3365020263760936 -3.3176970710481726;2.6341571387967528 3.5021479848965154 1.6336066828034912 2.8329831349164443 0.012656991639973199 -3.9696583852650043 -0.62341427941173189 6.7020886220275493 -2.9176423193615886 0.14688117345077581 11.07321188961415 2.2370902043077066 -3.9361209361680465 0.092562850463167076 -0.050449620672377432 -0.15240972657820773 8.8173004249162439 1.6097584048256333 -4.9854673686495419 -2.2397671310960221 -3.8566920313828983 -2.0066353717624357 -0.95070078782791434 0.77975789680422636 0.54493308326989032;21.62268881041819 5.4579405912916501 -0.27870623171082443 0.77915694808704772 9.7004802450292171 1.7359824353707434 -3.4739560337129047 25.005902239166502 7.1990562784121739 -2.4229012678437543 -9.8705032045019578 -4.2421250415732494 2.1504143447887158 -0.21638426535338515 3.1033682848208208 1.3921377854934593 3.8668596247558744 6.0294428413550376 9.2961307788184779 -2.6544274694355301 -0.12774271336662238 -3.0857901636909699 2.8315265862704364 1.7980704109562473 4.2325051630607486;2.7137592747975376 -1.7650608080486152 0.30673592717644826 -3.8529097219279582 2.1215188711740596 -0.17357558166212905 0.82606072730078139 2.4477351460436281 2.2293547997784136 -1.6531018397553001 9.0964016007428192 1.4425976778367762 1.3606111427266461 4.4602425961948828 0.46699392383043131 -1.8560424663608379 -2.1971948870499212 2.5137870132447375 -6.7282286769534076 -4.4748812563610851 4.9381948030058771 -0.4443467181265609 -2.718763100185615 1.5845433050599975 -0.50359309528540708;-6.0458844888777286 -2.2731589647229322 -11.033074837012006 3.3708899967748316 -0.34691318900366386 0.5647723973238219 3.7751026089705353 -5.7977384392565581 -7.6634909945994387 2.6418806370822314 -3.5397750037151088 -5.4597371662545067 -1.7648933645336056 -2.9601205252110407 -1.796006452859666 3.0933563610439565 5.5007354080983895 -1.3184671335856935 0.0010128756245367868 -0.53123299845950567 -1.2228279991921649 -1.9643845217197615 -2.4232469532564722 2.1372763947304811 -0.80317125732340611;3.4015859615610768 3.8915532513331055 -0.39298522326266072 -9.2852189490698969 -0.049179254921952853 -1.0574735132598514 0.87220086888091475 7.356130178882931 14.160367219003385 0.91151274245242209 12.76789825249535 10.829801151884013 6.2223233140332592 0.95350148387520606 -4.4627266634308365 0.77160213738562178 2.0938327766234113 0.74364552603544143 -7.9568559045143132 3.7877741172527108 -2.1057179319445605 4.4074089068039974 1.4885222791422577 -0.21367479177416893 -6.3668331176036403;7.4482272107157854 11.045064217545001 0.31233910906002543 -7.6547481874128538 -0.77528218872251731 -7.1949611714133965 1.3773163496805989 15.386871119879046 8.4600162539146595 -3.2164498501567556 26.859336428865767 8.4762517594972291 6.0247657540601862 8.1202281988206657 -7.7934536639841507 -1.1161382989177258 17.880817769569774 4.802999633509506 -9.8598197824830063 -1.1372390550492026 -7.1654184717474276 0.73229514676932073 -1.6340857978411933 3.4388358232212011 3.2655466763398775;2.7951237307775352 13.566256250666147 2.3331471417626108 -9.4709387202621684 25.895212753288313 -6.8391003321071491 9.5095563262200162 8.0368627072704317 5.7952996832301409 6.7955806289407032 -18.382568023869336 -21.249249667580234 2.0061407907542819 8.6880380505599231 -14.579362739006672 9.6990822541173198 10.844003443967809 6.6791221083141687 -10.232695240163727 -3.9972444164584808 1.2129568282477659 -10.433496833164872 -6.1169191406842156 11.72347799437974 17.949722916352783;5.5111752970287382 2.0518297108212127 0.13992987272864588 5.0747169033470296 0.74036655240091742 3.4437414678824556 -4.5864941208989114 6.6678512226446935 -11.485678431711779 0.95269625895456156 1.4464832410077892 1.0080365793637509 -6.9635165475827643 5.0605003060777873 9.4722226513755743 -1.1996335271697431 -2.6907120910823337 -0.96563349727368708 0.64817165170679492 -5.7038453000320013 -1.4424246463700428 -1.1328637100591137 -1.9724750184766546 3.6097343058009983 -2.1223167664034741;-2.3341760042823347 -28.762298772756385 -1.3444410046458422 5.1422493625893848 -0.1573703764936541 -9.6473378665707266 -2.2418097428790866 -1.6296706066524664 1.2191680105447871 -0.79374257897045641 2.7213356613840975 4.4296945293137142 -2.9072649476481875 -0.20674122738246586 6.1428844549538617 -4.557590218151403 4.3984616366734892 -2.43160566334367 4.9906661857055461 3.857636343617143 -3.5975782130158405 0.22673100778310612 0.13290297760059844 -0.81869368218973482 -0.27388876515988542;-17.796081472869432 8.5135195491292652 -0.10636637194907222 12.386312898925473 -23.165921856040448 -7.0373435220280189 6.1099056029540231 -1.5802328895371285 -17.352001302301886 -10.619512909754095 -37.547109277690367 -4.6056171018102958 -12.32566961199969 15.310062233038858 23.782536490638716 3.22463368936973 -11.678810784105162 -2.6116224761050018 38.880783335882228 3.3037268253514318 -29.50750298218712 -4.8499466371824917 0.20752273508692815 10.540289243940155 7.4434754417336375;-2.099596183859112 -4.5441620043859352 -2.8696293785789702 -5.9939005578320756 0.2712389655635265 -11.580109555117385 -3.8620908326696473 0.35753460952641514 4.8498850658880466 2.3066206737956607 18.297667455573745 -4.4541446204165416 -5.5801197961727125 -2.1071205954004677 3.7484902890500145 -1.0812920090094469 46.579919241920699 -2.9563337891591046 -7.0513898134966384 13.635030016033234 -11.309468167421096 0.19293106651224068 -0.65810316515692002 2.8375928303982554 2.2012349805993239;0.43170644021001237 2.168567678692904 -1.1070932133273097 -3.6420015532020402 0.24245911967725417 3.0113764663166624 1.0958926041717783 1.9150848642053531 5.7768671908482006 -0.76309394051091373 3.3322995187861646 0.28033368101006817 -0.049391530710016757 0.75119239534202531 -0.1719468605386355 1.3377078029766576 -3.01071891700692 0.88712287058990769 -6.1359158319900891 -2.5382765132920038 4.3050797984949494 1.7527350353707347 1.7239371862177766 1.404764392623375 0.22534136493741649;0.86478264412757599 1.7894226607188861 0.057837144019114314 0.55777588683105017 -1.0765301318779594 -4.4787558807287162 0.63396813989790557 2.2629377937931978 0.62527533069889729 -0.23052546412780969 19.062834974242293 6.4584274900048184 -0.29363890977695078 1.5032371543489826 -3.1510567095237123 -0.052531515755919654 7.1162472170071212 -0.10367829124179623 -5.9259224745250538 -5.104422402035472 -1.4913019118771307 0.47987403370336013 -3.9047396023499341 -1.0825989314788143 0.25729524349056038;-1.4894467854206581 1.4405520418291704 -0.092499669863147713 -4.1677727753587348 0.025725044331605815 2.9389082633341475 0.041265225578510964 -1.5037807045229565 1.5822582327384529 0.36363413404006761 4.4331231275048255 2.9884059729549413 -1.2082778937058347 -0.56156940061393956 1.4602279779603913 1.1618663373073408 -3.9528873097042725 0.12033946709158938 -1.5319617317397807 -2.2570951027613768 1.9379353944748299 0.40022353675294181 -1.5848339808519718 -0.48343186587956072 0.32530528774392559];

% Layer 3
b3 = -0.51713773369697724;
LW3_2 = [0.024167050999035739 0.17050015629364257 -0.024555605908461942 -0.088286568777598981 0.17988678270471856 -0.03506953055918452 -0.068392043302769059 0.0026591374980752705 -0.063690177506858445 0.16703069683428334 0.01575016190247093 0.44964963035477823 0.2625011116667717 -0.4772557665138511 -0.43338751139549531];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
