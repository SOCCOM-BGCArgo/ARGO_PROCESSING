function [Y,Xf,Af] = ESPER_tco2_15_Other_4(X,~,~)
%ESPER_TCO2_15_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:04:00.
% 
% [Y] = ESPER_tco2_15_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-10.918378288523281;3.1654953039634797;-5.4484301712745662;-3.6119117603562074;-3.2676925846400464;7.8542990162681194;0.27198410989724398;2.8701970246983244;0.4764545279243953;0.41012000069657367;-3.1728395462404793;0.011915106650933984;-1.2244684060689157;-1.0077340464026971;-0.20565821370825757;1.1942058174894385;0.013957770257244819;-0.2847513295950716;1.7953784281375933;-0.1011879992935695;1.8289199859441052;-1.698631689850052;-2.7529324591601894;-4.589125431540455;-2.005605329079966;3.6455968222413748;1.7440332317158602;-0.95826657403093096;0.64104843052428173;-1.9186956435929881];
IW1_1 = [2.8767736973508993 0.4648050397596975 -6.0563821935695641 -4.5966509565104934 -0.40602498911145746 -2.2256515788086078;-0.155048118818054 -0.26930958289138629 3.5910809680627471 1.0522464305971002 2.6009055203244906 -0.17132251846447949;0.44869438637451708 -3.7387608300649755 -0.56373161938973948 -1.1597963672327816 0.49869205701774605 0.37256593632525842;2.2716208549667511 0.15077287621128815 1.3157731071082048 -1.2023415608633141 2.384799557154627 -1.1864066712756187;-0.30175350092888148 -0.72768483011011231 -0.43845974047525543 -1.4149606202408 -1.7080674176831878 -1.3646537789402728;-6.0039830110952721 -7.0621843042127441 -8.7237386943482456 -0.51249362415484423 6.8048643903159025 2.0954217349347291;-0.8483929363985746 -1.1416670980418842 -0.5548434902727627 0.66330590590775562 0.24507666658005225 -0.91138074300248395;0.17579034901750326 0.61290830296814214 -0.64288612737337913 1.7282405922729711 1.3659166774347193 0.14771411153741343;-0.62721219177469723 0.32217171409888873 0.24380428043896182 -0.87938795103588052 0.35206289277226033 -1.285180069148947;0.26291780408901716 0.38599740249761205 0.78912714551315 -1.136662979656496 -1.1639127260436894 -0.43628976632296312;-2.1373241272311834 0.79376805114597604 1.5639051076244157 1.3325160705232619 -4.7165266555271517 -0.92664455343711538;0.15358318196980061 -0.15657038601228643 -0.28359077013353695 -0.1967917242808819 -1.1739620564256357 0.12679427572797158;-0.17601398119522982 0.058954896804160613 1.6927502437256721 -1.6723009059087652 1.6065219541648701 -1.0053229880435759;-0.26162367816046761 0.1502896020607021 0.67551920165471491 0.17384632465004002 -0.50832904100147225 -0.2692837012472995;0.063817285676526198 -0.10963096744289395 -0.64153081761353237 -1.0242860523870587 -3.2341578645576567 -0.65264017577271827;0.14858812993477302 -0.097023721824374465 0.15158589067465603 1.7439052330577154 -1.1484456005068471 1.4899043997400752;-0.13732782993057274 -0.24985969794627746 -1.7766849348136535 0.55068885054341299 1.4728265710947959 0.91959515081099907;-0.66367719457874164 -0.73577852862806992 -0.75599339201256344 0.66871529625412129 1.9513840148216226 -0.52897452763316422;-0.15574670856531356 -0.41499560217856457 -0.37638762456040059 1.9708061693513745 -1.1330575686069682 2.4924046404844553;-0.20809067985507237 0.11096990618748195 -1.7919283318074617 1.0613496659197361 1.2483510937403837 -0.675992516019703;-1.5040264653262461 0.59467545757569573 -1.3279662095267772 0.88335103598456022 -1.4841942190051358 1.1131641003349102;0.45846801027373507 0.475732426635808 -0.70503342670116742 -1.2553999189559057 -3.64801781717108 -0.24506211229127506;-2.0780247994867915 2.2088936554572185 1.9523635228482399 0.28020923741677356 1.047429077085275 -3.3505371096289576;-1.2454999804475915 1.140457034566025 1.9264622922872567 -2.9311070340232455 3.2603783114876879 -0.13245138529729431;-0.024299799528399016 0.60854470888700551 -0.43795431314310257 -0.41851830842546028 3.9518261432251416 1.2943921556794358;1.2149827094128798 0.60078079577614019 5.0784059613906329 0.52111070935957404 2.1353889740237872 -0.17860665328872483;-0.16636987781672666 -0.42408086315037835 0.95219465588857455 1.8326006021271284 -1.1447192059097138 1.6419604859516532;-0.53719013929712112 0.2790061640705564 0.67317551034732714 0.42850676597118037 -0.33823491172410974 -1.0968351047562437;0.47876341140337481 -0.50777000940390571 3.9681645065710405 -1.4355298921866149 -0.75377609300131343 -0.025025705367789541;-0.71655552195817851 0.052529759999803374 2.5550939232777576 0.53997117497044611 0.49319299166833069 -2.4072171630581507];

% Layer 2
b2 = [1.298495539296308;3.9218507736511699;3.5463783406887934;-11.94209742359692;0.062242241103983818;0.097458923801652081;-0.12555674528851882;-1.3221098705552663;-2.7058552248202266;-1.7444554878523328];
LW2_1 = [-0.18542370338400668 -1.5631633051503315 0.70616407734904085 1.0533593941114943 0.78793709209682938 0.2194447633820473 0.1246796185974406 1.7464579844189738 0.44381266117722196 0.24003417942115166 1.2328959270223896 0.5154705108530504 -0.92201963188465808 1.7031469055468396 -0.36763478272620809 0.019094873725582901 -0.31178308809549776 0.66288922895387625 0.052899370650685333 -0.5118944419374778 0.98712609572852639 -0.57644072641366984 0.19536271993261872 -0.13269340824570999 0.088984626875866196 0.89569910404995634 -0.17763794061372312 0.23516377060314533 0.077178615282908383 -1.1891549614117647;-1.5016820006364073 -0.85406256426514915 0.67559932488448393 0.01850755471445948 1.8281423329827826 0.7299551093313571 2.3964138709053651 4.2644699127019043 0.88526514191841166 -3.0928129765890189 -1.5200930723990111 -2.1438544999938034 -0.38069254923471041 11.098518091880736 0.38672513626712818 -1.3934715405615732 1.7353684179731326 -4.0604316479010381 0.80237194333943318 3.5388576478925464 0.34138723011288752 0.7267662604230436 0.42408946921997392 -1.6121646485722521 0.76432400525208688 0.56249607678665614 -1.7182602644974481 -7.0431384993434332 2.3156425514472696 1.2826881343013885;0.42628551179816038 3.0003792315122082 0.37961102821013265 1.4777893629758334 2.477088913182993 -0.17731337159333238 0.092457987529648664 4.2393277890920169 -1.9469466038346299 -0.45350804714371351 -1.7734251176093372 -5.2909192324114169 0.70265390798631311 4.729775290112614 2.0746797279044809 1.2739251036332455 1.3281740659040995 0.65317380992110541 0.91318845587860331 1.2648017266693214 2.8730941672026051 3.4270409888171236 0.60233112604036843 -0.99025925088277 0.061470049157176028 -0.11343247931355641 -2.0603907114635471 -1.301964259553575 3.228781141353597 0.82330567200635107;-0.59482734860236652 -0.23422044357634009 -0.30999546948311263 2.5450837946522751 -3.9594284728953681 0.2540886780006037 1.403201427114094 1.9691202983839007 -4.1154020323959273 2.7486100981404435 -2.0961870938841916 4.8714610290482652 6.4535519661785008 3.9863431611759341 2.8039172660715077 -2.0486230687153304 0.76603110443899969 -0.85485844447093462 4.1206296500278645 1.0469954222298359 3.3191768284643026 1.2670195074132271 0.60223477125416225 0.7589828357243541 1.1103676428247706 -0.96626375476685433 -5.3530103033128107 -8.9689126226828382 2.3903434772554455 3.5619029003267157;0.1057947303518969 -0.30281792318690282 -0.81424722489059376 -2.5601173249393274 0.32781534849679456 0.082100206431859987 -1.707665290053046 -2.2961887671891694 0.31457745933020614 0.87290596567776968 1.5908307160401984 3.1310333540381192 -0.7596337207368582 -3.3317274768111562 -1.1919816678161743 0.6780444685032011 -2.6655855751841475 3.757477561132792 0.17015030926659475 0.24766109244971016 -1.356861190351706 0.49500696457383581 0.32011073812354024 0.92866694956514406 -0.32435770456958479 0.14796088432826085 -0.1297333494282191 1.8971300095534824 -0.26824314950105438 -1.459598805548497;-1.132321392982107 -3.0105325294209275 -0.2464020346404126 0.36265651167161927 -1.9288243534989207 -0.55939137486887403 -1.4888286880580217 -4.659945948338172 1.1308942852137762 1.2631279698181319 -0.76885105872092352 5.8769161520181514 -2.2208246434473891 -4.4335892783793813 -2.6809450295431665 -1.0174586293919623 -1.4737734350835612 1.5338947872992179 -1.7647041470201981 -1.3599506567129129 -0.26562933571012953 -2.5896126716432151 -0.45071786284146381 1.2148129374859757 -0.53433844217656223 -0.035185117191927684 1.5357898784004587 6.268168597758546 -1.4872951663935525 -2.3251232640956578;0.58167115711131367 0.76365670421978393 -1.2092377201934186 1.3465577961043274 3.657921971177045 0.1251599694740497 0.42273101848199351 6.1990997253605684 0.061435990093973207 -1.7875158142528602 -0.39216312536696557 3.0172309672898168 0.9385152929784889 8.7819836743180932 0.35075343029330236 -1.6791923970465075 1.9618976709789475 -2.150799781140575 -1.2789884111015308 -0.16525064581388971 1.1919044278770063 -1.7147653571020227 -0.073014531283802836 -0.41714136885121295 0.41424985121958058 -0.22064422273394796 1.8412520836758162 -3.323054597037165 -0.081193052529271934 0.44338610600966949;0.23139532740132893 1.5158960059470605 -0.71792500490610367 -1.141307505284505 -0.77498621612854524 -0.2520830452688807 -0.19818682340500596 -2.1420261305507369 -0.45596094557453115 -0.11248560413245419 -1.0598989187797589 -0.7663677269046546 0.84589748159712042 -2.3966809161379161 0.43083696886730632 0.22939410265123611 0.16533882246443776 -0.44203741502076477 -0.055577628439231037 0.33580273441359626 -1.0277430022392804 0.46110366259746682 -0.15422193036496315 0.21322562321530134 -0.15730121436718658 -0.88092861180768511 0.00080144695125246909 -0.24892920831156043 -0.19698795097352098 1.1497271548340897;0.5120024624271079 1.2299048983700989 -0.34834861565685027 -0.9457649068046653 1.8121380826782629 -0.34332961680242774 -0.71133445803253037 -1.7384855017906173 0.16850927066059593 -0.39255036935044485 1.2094750180907952 -1.6783999471381834 0.8810064917044621 -8.6813999036505134 0.15914606954256577 0.40023324973410884 -0.78322334209927669 -0.0072128108153882093 0.55688234148018245 -0.35198075626564018 -0.43811825531726278 -0.52426883915181866 0.17790064487579077 0.29098595681866868 -1.0008099287328001 -0.11504696597992724 -1.0533480113058002 -0.44423323034881274 -0.77023661309937586 1.9866749398988743;0.84431862583582373 0.9856508439625109 -0.93293297394461361 0.65883796447418563 -1.0213158755510054 -0.39086843600904464 0.43555360020347289 0.88064290678828461 0.65625842099231724 1.5936074123901656 0.83116419700046773 3.2268636489187248 0.7497128422598035 1.0817641950180454 1.014341950509122 1.0827216482600825 1.5927664293098858 0.21298529195646346 -0.64280345117852478 0.25459940273185955 0.71391826973577366 -1.0894575822426857 -0.16972866754257698 0.31945987536079884 0.44949496017943225 -0.13363289944373125 0.20708542923355494 2.2940384647129313 -0.036340128418109921 -1.2317436808194453];

% Layer 3
b3 = 0.051071021430091831;
LW3_2 = [3.7724134967578888 -0.38042629944913248 -0.1383310548341814 -0.26431624929548991 -0.28941333146354298 -0.22731441995126225 0.23376577363254245 3.8108343391775339 -0.4136880967643371 -0.28847819374816441];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
