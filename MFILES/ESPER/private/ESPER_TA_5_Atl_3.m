function [Y,Xf,Af] = ESPER_TA_5_Atl_3(X,~,~)
%ESPER_TA_5_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_5_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.1104990289569984796;-2.6003935405084388499;1.1067346607957739835;6.5601038065301713331;1.2686420146298966749;0.94654163043688344104;0.57161031999070355258;3.6122906429928338667;0.1538864602630540257;-2.2038434060459999309;2.5574307691720181701;-2.3847582054382381322;-0.30001167108740783851;-4.3767419652610026759;-2.4205514916019006399;2.981854466670989634;0.017478900437373073862;0.55035092390177187127;3.1028891248109626844;6.9310515068001130601;5.3400855780925757799;2.8081115023619034332;-5.4977535996994175704;-2.2462738704822338143;-2.1416786292723077878];
IW1_1 = [3.638952619278916778 -0.53857640879588086769 1.7772697885530122086 0.40790686316277741108 3.6951899747404906016 -0.69999945305392974326 -0.01388670676411520033 0.072525657700982737452;0.099066401788272293039 -2.0959588007867360204 -1.107864714838709741 -0.12198044475749349191 -4.7029433653034136142 -0.46108971128486531121 0.052001888420374842159 0.51846911246073013046;-0.30708289593400495132 1.0018928005692764316 -2.0585931540822173247 0.28624982569500895258 -0.64750670584795211315 -2.6381949163742053344 0.45910162444751867472 -0.13956028634875777827;-5.0212879848758289469 2.1992057123772772442 -0.88030748178814344218 -0.41659944780168367551 -0.36021980568982808757 1.3543532561466400388 0.89995394280148732769 1.6808255383576675701;-1.096733527632994365 1.798798358417272425 2.0036682487758863402 0.20574472157930764893 -0.96242748922712184623 -0.87924354736958965084 -0.25918876371852417329 -0.16500682852551110114;0.19379441270992389668 -0.56195251524104250507 -0.48007210717874754247 0.11268640880738423071 -1.5128914458153006617 -0.44746244571010340696 -0.087851773669738550399 0.15605517614754438327;-0.96831413586063863619 1.7737454866465949266 -0.49601139130057425586 -0.16243985441269839787 -0.16933396152975899174 0.062624375026282638745 -0.10658130503999933836 0.63040974169609154121;-1.7540605744537587363 2.0584605203568067111 1.3586419977849519825 0.11823113302745719144 -4.5360737246321303218 2.019892095159493195 0.91015563506766405943 1.5085340769692008323;-0.48187494503541833391 0.18735801990190745214 1.4452571084726941741 -0.052970598112714824268 -0.46379118606894181864 0.78413172230997141288 0.12549083616205133906 -0.082767809693689034511;-0.72461957965092305134 0.02062343483813399575 0.57656368059258833458 1.0132500522949361432 1.9133317161226854886 -2.612507302910455298 1.8326438998097656086 0.0078132757921905715559;1.2483763729192871583 1.1029099654855474277 -0.7730253939163440613 -0.2863636801940603327 -0.44423248811424298488 0.52194703226277228136 0.34259735436366595129 -0.31401964714995089789;0.96566629670734582813 -1.3414698773103133078 -3.1432212293759054234 -0.063583355124503151967 2.8818898295432946455 0.22434744445314017125 0.13877124848275473878 0.32733656732707872017;0.72451737101240198946 -1.6889017654423310599 0.19124261966122846346 0.22989123721604620698 -0.50493689037139577458 -0.28828335915097325071 0.041763423759044175643 -0.42835362868854304219;-0.13680797016621856765 0.15259817159228686312 0.40524650496109487774 0.26521732761956762214 4.8045148305498059926 -1.6030955376965663195 0.23396417995767804232 -0.71767874066079706541;0.8992134000091976942 0.36832584118957334418 -2.1880781281641543679 0.83883131265679744537 6.4790757743885531994 -1.9801246434927626261 0.37915561068248115895 0.23626590982285311515;0.16276191524538902167 1.7338715860451059392 -3.0329868987246544343 -0.31172347593549992739 -0.29816209293156364923 0.38083708945156258263 -0.014506800742899665646 -0.68027660117707522414;0.51032189657524484883 -0.13629733429896678798 -2.8996924630127134392 -0.14224237310652462773 1.4416081164438008244 0.33763416383362720996 -0.032263114747306899377 -0.095388728372614611795;-1.8310330836644179708 0.21655062844704267566 -0.45545542772726632652 0.15112135390592276729 4.6722468209899181701 -0.31509941169470290223 -0.0020873009329002278206 0.64481328530147408173;-0.3369216467978876639 -0.86106634020781913641 1.7314079938048430041 0.12308292149114058445 -5.971398741636505747 0.70674476787191964355 -0.16543198672595682552 -0.26321701241300377028;1.5797494588228000456 1.2995893168363363834 -1.4583516019786921802 -0.30063213158454665797 0.029109941334513562972 3.9050728618644043877 1.0824746723188183317 0.50772522897986260837;0.38238083587882254477 0.38446786338966781882 -1.9619555543429358924 -0.28895927576796232028 -4.8947357159245861169 0.17982916562538672767 -0.28569854363978286482 -0.54715603695469550161;-0.50194249481344088704 1.2814222783249891169 0.81102996361309065421 -0.15280983073840018194 -2.1045898998365064614 0.44163335382648738481 0.25196056058702559488 -0.42154809752853356075;3.0075436588133550586 -0.15312014117195760221 0.11712606053102700421 -0.14560645244086925509 2.1091582147275418357 -0.08915753317456098781 -0.1011462299788220276 -0.54819842600825108292;-0.52348157134205330898 0.32560223747051436627 0.69655041161494690716 0.13912197917103630296 2.2687214042779078049 -1.203242431159139425 0.4240037754122640834 -0.57064795168105419965;-1.1403981112195662462 -0.34728973963543607884 1.7035769891140255528 -0.3261741116718063771 -2.4053953844852773436 -0.22769308954862607641 0.84075390448343589878 0.35682577087201644561];

% Layer 2
b2 = [-9.0540276591506962944;6.4578859835017023983;-6.0067425063281714159;-0.24731040633795081662;8.9353351884790352955;-1.3947339418368800423;-1.919451293135624681;2.735990547631627301;2.6550512883859505031;4.505258015774308511;2.2366883238041288529;-2.6702301499875931157;-9.6440319753845979989;-8.8919398196676766588;6.8341373419353592666];
LW2_1 = [-1.1024080694462137231 -3.5304263329999114873 0.66280210672242600989 0.09888874084973922618 1.0213067153161774492 -4.7898772415046355633 0.27924508163066880106 0.33717468794298266488 -1.514835300748951008 1.1852579940833771754 0.69027676309385999076 -0.38239267856653047506 0.69889875025073944226 1.1706428023475594635 -0.12949581487043790307 -1.9644373108807904327 0.66574264382072811941 3.2298693570512062578 -0.66728080567530567713 -1.0443816913408807689 2.5481728441748696667 1.1676158303560193463 -1.5413524398011111405 -4.8210713153700286426 0.6444603591724122893;-0.3145867247432288516 -2.0025459733184769462 -4.2476675518972415446 -0.63293921149333109977 0.26679247634872482742 -2.4362644957130177303 -0.84940055074804887703 0.4247471664126356572 -5.4673285682771490812 0.26494250875494429476 0.63517113826368321039 2.6460857946473730351 -1.1766552537597105843 -3.2846047063392762588 1.5033548598874844071 2.6192526213720692674 -3.9264868787373701231 1.6603693943078376982 2.1306798850133992218 -6.3050666968315161043 -4.9516229178880806217 -1.2766973368669620736 0.13259387059477437121 3.0298499396648974624 -2.6909867438320311805;2.0790468749047121833 -3.8920623469355613011 -1.2638450285546831697 -0.14481175490141023898 -3.0238780731825176673 3.1425264702106048276 -1.4698192030651489048 3.3062556131864346831 1.2922480254526944599 -0.42031263610490743332 -0.20280574308615612056 -1.0895314848474182412 -0.15349766317061602772 -1.3210148360313567206 1.0231289346016072539 -1.1179283017379391119 2.0479403289127060539 -1.058443539588453941 0.7265543098979111436 -0.31106981395296878778 0.75105121217864312388 0.98983089476218144576 -1.8623147707034179987 4.5758851817342058865 -4.7108026157097580011;-0.0089237170962132347091 -3.3276582204975255763 -0.56081072877392834641 -0.42845545204264617878 -1.7788502385201589995 -1.3248811540231566486 -0.012457375000073935348 0.33802712363122289219 -2.0449362505016384084 -0.11623467891535724239 -1.1464274256293789378 1.2038110700549429222 0.38345314964417953618 -0.32776774436776884292 0.69417491670719200236 0.62347799399120407138 -2.1468010396752728042 -2.8300395971100558157 1.4492479348364899483 0.7611075075388883393 0.12289123302219163991 1.5618788546632222936 -0.74081660567640927884 0.66759870594230719121 -0.12259724079012701559;2.9273470449326084442 5.5941752702029976518 -2.4154047146528343504 2.9876960691816289994 7.004302916320670036 -2.5881195780869470369 -1.5867614914221754852 0.66798471250149638045 -4.1500370232268375403 3.0451039466109897091 0.90847265532497123441 -1.104168645726243847 1.6355611168168056047 -3.5454872940995327824 -0.21992888332030885445 1.7584635351441757489 2.2602246031449828578 3.320624044121777807 -4.6419263831492445505 -6.5864596106515156393 1.4683270989184264987 3.7207321739381904457 3.9069775573456797524 -1.8954444239440615405 -2.0368648003274820724;-0.19408333409024658422 -1.6483227174581662755 0.21600260027115711359 2.4809192959033317116 -4.7271398674332933965 0.97641189827935837009 -4.1557585295820524962 -0.051722397667930977705 -1.4343235945044789936 -0.48862512896050497302 0.96570514645753235961 -1.8889888203609248585 -1.2118763967143881821 1.0550940406438900077 -1.1373044979002719934 -0.88651155091544631137 -2.2292239082223570534 -3.0050672034546237477 -1.6267363868484860934 -0.1858872789513648649 -4.4032504141432271538 3.4634829346482667312 1.8607479009632355016 -0.98488599033808776895 -1.6219607913498526042;-1.9752917867440520361 -0.49171299447993399578 -0.30096010796142552701 1.4156629289928781557 10.582978939653907346 8.989958249925839695 -2.7864816336427455923 -1.9366308757829984177 -2.4403812841224250541 0.74192476945731211657 3.7013076132704458843 -4.87393918731962561 9.419890249197619525 4.4850064496066632813 2.8040083409195752928 1.4883430824934196224 0.020117619367736067071 -3.4956257685838032501 21.397541760954837287 13.902197960827264112 -0.82987575517666378744 -5.1005204374937331835 16.048921475975880924 -7.5148986355798603753 -10.936367657131187414;-0.33930157193191667897 4.4515694923599271604 0.35983702797843547527 1.8513009789525378679 -0.40783729042202598869 0.34661913141751732326 2.4024122329271468956 -1.4853524979953685037 -0.30058744394727587856 0.057704796030007554641 5.2880622075561314333 -1.098390256099203155 3.8231607820482023108 -1.9487763292864306308 -0.66590597547008067991 -1.1195378045998232164 0.223490610891166952 -0.67061327485029009754 -0.84954810443328043768 -3.9653335764515409423 -3.1002893146801624447 1.8100421915618576385 1.4804019190820449925 -0.39590542895245151023 -1.1521727223874103085;-0.5265499313081166699 -1.46073961583957046 0.19565824788884003671 0.33397544328073791586 1.1863920302112878069 2.6643165242292830008 -1.1080800854748542594 0.85815509709807868965 -2.5530642438643988967 1.7145949497140204887 2.7567611758140868616 2.019397408150775064 -1.7407548735244953164 1.0854009340802557304 -2.1482136755781806592 -1.366437843229936 -2.3505353877776644644 -4.3090153035644798152 -1.546832229524900626 -3.1867446235084986306 1.1502992370615230389 3.8309391578307669946 -0.1814045560162284576 -3.9655532040018850459 -0.63188267033243949999;1.7139206229224459577 -4.9490267853566320966 -1.8904507592391259774 0.20542083487503826067 -1.69638705538060508 -1.9632021685466334304 -6.7945386911314855638 -4.7591858913854032664 2.2918439793796898662 -3.6453611771546490239 -8.2709262792803759368 -0.50440691459356279402 -3.7422580967548837449 4.7267556798290071285 3.3499702744389114883 -2.296535181748426524 0.22382970751280834021 -25.857398243810365557 8.0490414172253839098 15.982390495759156934 8.6418358921212021784 0.46174477930747870325 -4.3012786549370876088 -0.22255327999470719824 5.5654915959613537879;0.013091228527702987103 1.7677138310526114839 -0.79834903206837881662 -0.39839347473198710725 -1.8691978361787147112 -1.8481940234798877043 1.5924715180089528133 0.069845307989917573832 -2.6643614098072094798 -0.055156053383165509763 -1.3822558343141124748 2.528211591006218395 2.1780795105962882374 -0.13527762878747248698 0.88125895082869787345 1.3445776583167610152 -4.1582523163582676418 1.3057673176620032685 2.130702376468601944 0.62011888246409263559 0.08830137833277180992 2.1764294658769460789 -0.10542399348952881388 -0.23134663183975337497 0.58376510056115749059;-0.25141408526203323781 -7.0533917973646227395 -0.2171144586150157707 -0.48369804410782896165 -0.96839063781473977421 -0.14642709479083396151 -2.3179167508182598745 0.71327024006752925978 -0.92988390478316451659 -0.13014502476484846039 -0.8152246702092996733 -0.20562932865357563816 -2.3298205392667195035 -0.23971986727553457053 0.42883909344426307531 -0.026527003515378851095 0.16338157823420124126 -6.2832476042480580603 0.78770871551273546896 1.0445681114519007604 0.15312341033372420251 0.75818922633422480839 -1.7598702511036974361 0.95240301908216451476 -0.95362690273723571543;1.6683133034998358646 -4.2248571337324145603 -1.4921372914933903608 -0.081276811931990960991 -4.7010507206859566409 -3.0539802524663008931 -0.15252971828643138719 1.6874634432039856691 -3.7280090822870226575 -0.40443962791382859212 -5.7019598711645702593 -2.2520299742636633589 -2.2909351919546798726 2.2861342385202894079 -1.4800036441102464302 -1.6174604113270878436 2.1467434999177013033 7.4076778001593552858 0.92922773806722913648 1.7548497514256888863 -0.69840583797804978161 -1.1032379134878076421 0.55289144632948761249 3.9614385651236081465 -7.265482826517816406;-2.9072802703430182802 3.2938872979618252224 7.5612451515116037015 -3.1912747332778379494 -0.5656610903005074853 -0.49352991856706945883 2.9509992256726267357 -0.7441296204658751634 7.0726560808015719317 0.031279033650867732463 -4.633089617386243475 -1.161696096704240011 -1.5198698820648570695 -1.5081183637913213591 5.2179111012761056898 -0.57687645144594978941 -0.91537642767616544948 8.6790551419188890492 2.5449154833320823954 3.8294780984952438985 1.1587306994102037905 -4.5010839765836907489 -3.2690231794419681854 1.4336720641015994193 0.73836398655271906488;0.80021250351948880475 -5.7228160981086713122 -0.75289480987021095704 -0.65639894880528759646 2.3531597269412225515 -0.88882780786374804283 2.7137411120019971911 -0.15320252084888807964 1.5555443252620904104 -0.65796592503916206951 1.9711124824631618413 -2.5638180841449851322 2.0565820480086296485 -2.6870395403101969833 0.74491702100694845434 -2.952272294424869159 8.9943203317384767814 0.13881074848328017746 0.36022827610303681523 0.48148203747225104543 -4.574923697119416488 -1.5862580344917411868 -0.31984310098688167878 6.2428429120895820859 6.1354483011728611075];

% Layer 3
b3 = 0.37550541147805949205;
LW3_2 = [0.043199820794514849631 0.092883860641873303154 -0.04030519865400020163 1.1472760346680390686 0.14598800425460842223 0.026121798392644435954 -0.0022382245061461697108 -0.04579862979724102362 -0.022811258864940311269 -0.0016147719748046053968 -0.69650839530182206971 -0.63679234033517506663 0.029698244368627512574 -0.0036305297143809948587 0.060359517786290887986];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
