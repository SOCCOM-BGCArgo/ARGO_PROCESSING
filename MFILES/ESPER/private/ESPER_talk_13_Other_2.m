function [Y,Xf,Af] = ESPER_talk_13_Other_2(X,~,~)
%ESPER_TALK_13_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_13_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.0297996584919902;2.2160778677297235;-2.6000915592667173;-11.97549941309129;-0.015576996982838353;2.488483685372354;-0.83456113067174131;-0.52270781407755373;0.74452962081422025;1.0110700810795175;0.039120285522847797;0.27290239958945023;-1.5864572395056782;-0.059942005073338724;-1.1028225431236167;0.30969441414642784;0.55554768011927136;3.5417753071903455;0.4567489479439813;0.78901991116456316];
IW1_1 = [0.018200186695704623 0.03323212491142518 0.4601246738307575 0.36466260250451937 1.7511581594098147 0.37248296599796005 -0.080890186153273619;0.36917735850025896 -0.62149090006188112 0.08332943886168899 1.0420995894061638 -0.1608621194875364 0.084603852997761353 1.0157344944166071;2.4886986344208042 1.4996206586533842 2.5089742477042392 0.05278341641962541 -2.7626674188587521 0.30881388856672543 2.7113524942020621;3.5939466020264339 -1.7772333443515143 -12.214266200168826 -0.043408650752109333 0.78431832969415294 -1.0032569291048508 1.2492025807175198;-0.0062398005817260477 -0.19812600323137813 -0.51144789326285844 -0.11450444767436413 0.0783266394291523 -0.18315119103331684 0.15602389421686971;0.26038988726211926 0.024015507724017206 -0.67713463394670959 0.92437105062225544 -2.3983893509208087 -0.71166567706959871 -0.40367266891873183;-1.4104607207837205 0.42067837533787084 -0.40962432968814871 -0.22909907461355183 0.36100019434091807 -0.66915743450152654 0.54086452167316124;0.40871790419975168 -0.76361618466786385 0.72414203917740927 -0.36961790429291241 0.92308645145116686 0.13497659823178226 -0.88474774134411216;0.058704055467945937 -0.64489442885567139 -0.064556868187134755 -0.36002830480607867 -0.58832834823355473 -1.039641330027774 -0.63787812172684277;0.31067560666243643 0.055341183226345195 -1.3716184238352864 0.17150603276666476 -0.32797029966578228 0.40706222453089197 -0.28226806571818452;0.4477058257095754 -0.29097789253809692 0.4567401619279679 -0.018381511810726069 0.44264678334615642 0.28355610291753164 -0.65206242853842278;-0.0066705020297232083 0.41106757691657814 0.72697241973311033 -0.26479342977329967 -2.4861340756459658 -0.50106988706668776 1.3249014761604918;-2.1886126978092215 -4.0858004566663677 1.0407136615246417 -3.9949441497834801 2.1583235079536593 0.56948468229846805 0.95191437665939893;0.095143271767538992 -0.15223164243662668 -0.87921859177252371 -0.84859774376973918 1.3994954679792231 -0.45158945288746782 -0.41660781732590374;0.94809421449772358 1.5323486820598171 0.23525571626122996 -0.35618158321011706 0.80812209922673639 -0.32819342101231919 1.0981937683147041;-0.11800431925526593 -0.010495154266666985 0.64739415376232334 0.89778546779245361 -2.3023551595590313 0.1971972883969785 -0.21119876413374677;0.048345866063931417 -0.61391938686964587 -0.13636360318446439 -0.63130877579598355 1.4838778846293204 -0.75379484074146486 -1.6469730187844305;0.0093305826125328201 0.078993966569855328 -0.22766638826515853 -0.069816907480102275 -8.9262363710146388 -1.8072455035469779 0.66112141001221914;-1.5609810857126025 1.1555137201498455 0.19744511665714939 -0.58069098854198953 -3.6576375157500252 1.7883955368730748 2.0433728411814944;0.0099122054458145401 -0.062332917431962474 -1.272217756668987 0.10240424535288764 -0.74919995313604271 0.086535775007115762 -0.43081830074281335];

% Layer 2
b2 = [-11.292197878889212;5.9263247943501423;-2.6945063424446558;6.2166406157663543;4.6772309267149117;-6.5356912468027799;-2.1759388564170887;2.1101893116083246;6.2981426771438738;-4.9900086485550057;13.071410963320675;-1.8707960603190517;1.6044606583251977;7.3383432121605194;-5.7803646943219409;-3.3229998360229369;3.7688708755768321;3.9591794255185868;2.4599235807846203;-3.550270054523986];
LW2_1 = [4.3894408807410654 -3.6525868200442222 -7.1738874193127558 9.3355877097859015 7.6236350966833708 0.98474006806777359 4.9894307253777477 -0.46069401291347123 -1.6280413751636034 -3.4314621492459181 -6.7367094690203633 -5.1977964355340651 1.1139594601945342 -13.434619623595403 1.3387908394418087 -6.5233444607270723 1.8469489271804731 10.485013228386208 10.444938639354554 -3.0142765792525941;14.814044048935926 -1.3225925972755512 0.47757454956486839 1.0149394823942377 -3.1635876569743817 6.7697170735703311 -1.181411149787486 0.91761251779766262 0.81690792093002051 -0.33417167296197658 -5.2149940502912484 2.5456570748759422 -1.051475621103773 -2.9711567789224262 -0.55603613281698994 0.66146372787849106 2.5839306411645726 -10.448327627959195 9.0298174799413875 6.3665173125408714;-6.1062661304405941 1.6369208226298493 -0.1785314245262884 -0.19428090456729155 -5.2773202530797967 -1.8130226904094129 0.39635868155946652 -0.56011016671186298 1.1520021565509844 1.9456599822270646 1.253902057738703 -1.1153813895401867 0.078719240699171952 4.0655321900280796 -0.089572854487767972 4.6812633670321135 -1.3300228181243556 -0.021434933064557467 -0.011265908540541858 -1.63910716860977;-6.979685060607201 1.3354268181604989 15.29050006007045 5.8344871264203384 14.016116482487153 -7.4406285138222508 -9.5170450976093477 5.7326348810664136 5.9992059838923186 2.5545078125055749 4.8215368947054813 -11.516393892446812 7.6549337709767631 -10.287285063873547 15.83514198350808 -0.68779269053837266 0.18688052969518901 1.4268658057661239 17.822196280594433 -12.23579938263665;1.4793142939418924 2.6261411689310776 1.6873645828426349 3.8778592323712364 -9.2358543636664319 0.56073754547776833 3.9301751817355566 -2.9091782654723781 1.8801465911213817 2.5169179868560985 4.4153132660977388 5.5368666187700279 -0.88275184724971512 4.1929790730641994 -2.0612995916739942 2.4505430499931831 -4.0460466178248176 7.9315531650969229 -13.39300007119682 2.2130579911788302;-9.4046124209927555 -0.51698592068555327 1.7675362131061021 -0.15067279672707146 -13.00221273622153 0.85734647312056989 -3.0959013863842997 -1.1453075352880893 -2.7170361250609343 -2.3483891515850286 -7.1783634626247537 -9.7440747086889683 -0.6737809067268854 -0.95051577194667758 -0.55211406201895252 -1.3639059591549441 2.4016996303779017 0.52688461652467955 1.6772231529970323 -2.3314214270672666;-7.2376371339090957 2.8324457366236713 0.063100623074717296 0.54341533167404366 5.193932980566955 -2.3877854494260475 5.540739814801162 -9.2567811487349783 3.4675288208789006 -2.8801537408800013 21.654741634494741 -0.87039530531093168 -0.034767927782495558 -0.35331924080165344 1.7120168001364917 -1.2314763191998945 -4.3015421867691943 -1.351204640805185 -0.92571828742923612 1.9592746464763993;4.1423194417624725 1.2080780499814745 0.37456325478591251 -1.2364583559744822 1.9319923341825507 -1.4081164089775795 0.035947662167945961 -2.029651790697375 0.39848703876538694 -2.691444981591347 4.84632711136081 0.91260460008967137 0.17031498609707316 0.71449804186586285 -0.18482329403099296 -0.11009362996337986 -1.4320567538982611 0.061150176505138244 -0.19042353947164856 5.2857152338018834;8.3069711256798158 -2.7488043507274846 -5.06915910825583 5.0211570052250121 -5.6951409208669617 -1.430645574444313 4.2318889963755426 5.4139984715442004 -8.128887261504369 -7.0377260583685919 2.9409717858922342 2.9724936293359501 -0.6505893039376055 -17.753752260278539 -0.61297638386323383 -13.585840317986257 7.4672234573995615 14.259655901793106 -11.624418169640737 13.261633286650461;-2.3797671883667633 3.3134459060785071 -0.1761418192022321 0.23855917263623297 -0.35191663644696158 -2.2257877117216571 0.050247636182648776 -2.7877860566001709 2.5916705315567308 3.9980177255955143 2.7069290297376885 0.69831616913721428 -0.0076449341414239367 5.359092747531137 -0.58246022443201484 3.5169077421386872 -2.5415417048747275 -0.18307291733594486 0.3948311997331701 -4.3022704749660106;2.8253807284179384 -8.9812534063754708 3.4039511085896925 -9.5835035190835622 -5.5799265319004334 -10.895234135590503 -4.9688687902105011 4.8289791985190353 16.650752870182945 6.8163552353896018 -12.944323981189596 -2.1305651002917316 -0.34158705012923479 6.2804395367614845 -1.7434158843635381 -1.2188605250236129 -19.265996756400426 -4.6514808879062004 5.9397870418121395 -10.608660182256598;-0.19644162255430725 -1.4455620415054427 0.38607903920425191 0.81528451203608543 20.588988503804696 3.1195022390527036 -2.9206927073835085 -14.280668951274155 -2.4450237459835562 -1.1790925113771336 23.156617515710522 5.374611398687474 3.5142931664628998 -1.5050434481424779 3.5634136686586961 -6.1297929640379332 -1.3724993068412825 -0.93197177241202622 -1.7139254979521259 1.6753983563735473;14.760034378594481 -19.612882270187441 3.8562043136619502 -17.704277043939893 -13.795680600517063 12.781355305766144 -5.5302645208017083 8.7098075597390423 -4.9245354201721394 -11.789351436337762 -5.8983908647143775 -1.83097312114164 1.2277400461449766 -2.0894604182365115 -1.543195765524908 0.43689392834219737 -3.3343032055758695 -3.3836827396677203 7.4494879350389445 23.214336001617756;27.306634871363059 -8.3442023145680473 1.3329251693604616 -14.215894001646996 9.4426749191163033 -5.1027160368383919 5.3341825584673828 2.3800928629695366 6.7356160626088091 3.0368456531144599 -1.1699770181348135 5.7129126573658384 0.34418449676314622 4.1530739990819923 -3.0359293661375437 -1.6560170105395142 -7.1229653853422707 5.4751239488946322 3.1567775831473868 4.9112300732909926;-23.779728938004379 -2.3753180998879708 -11.514307649467913 -6.3376430609488184 -10.018829535877652 -11.07093988098792 -9.8071137381287432 -3.4756960705942404 24.562409339422878 0.46466350967995385 -26.208612521968529 -20.036566783882783 1.9505048362163111 3.7326559405499333 1.034524777963276 8.4126260352103142 -18.77865101963884 -11.794649856554349 0.58877488185039295 -13.393566214889709;-2.1470968256445588 0.27650249473019167 -0.39223106554617271 -0.45492333711052985 -1.5404225553208568 -1.0465084514119589 -0.35221888621172953 0.97892819572311218 1.1116813091519255 -0.72314948375585786 -1.9535678146444893 0.21896452405814215 0.18800222241008105 -0.63604334950667774 0.4063348242513673 -0.374590389247905 -0.41728733341850449 -0.052474075928822674 -0.10613941774633687 2.4110741959361013;3.2763552545642751 -9.4549950173975414 3.8978709733074628 2.5390537535080515 8.5650562123047642 -4.7824734504048845 -7.4611483343743572 -12.738975507821486 8.9447810919829269 -0.68684447174906393 11.910442281232125 5.1095823935199132 4.215887113943408 0.65688948917402101 -7.5955565206136377 3.3059479828848573 -5.3673007700524344 1.4200583248860512 8.0527173104425955 7.2157956038808866;-5.7888552257338919 -0.15647006088292278 1.2843012789662493 0.80881639822627582 -3.8709242112454807 -2.3782377277531843 1.0973965221032143 -3.5433574697735715 2.5550372818762623 -2.2170384152765785 2.9203106165310335 1.5500917586944913 -0.02714005412875517 3.2823306967924153 0.90103391628233342 1.2453461421199377 -2.6822736218306606 -0.806188256543801 -5.4833948919514253 3.068384306600572;3.1271363072811211 4.6447556320416652 2.0165802012458633 -3.6603315334297943 3.5596308804599186 1.1133057444431591 1.5435627865361319 2.5703746363001905 -9.3811022327946709 -9.5744189746121151 5.3383649186675743 -1.786168300750882 -1.1624319653696034 8.9764664591208057 -0.848507909121477 7.8284286577969793 3.1236016534456081 13.266943104539621 -11.177404046801348 6.1245765468107667;-23.42851125044508 -2.6060844417020692 0.11342681236145433 -0.76291136571293927 4.0859309720331769 -3.7343543657306375 1.4714710726767857 2.7697052417431056 -7.1866061590222934 4.5370449832493236 4.901712027132425 6.3324979699244457 1.1491768742531576 10.000348731823989 0.45867221695645644 9.705029227163557 3.7762743146540383 -2.9934467987134821 -4.0463667550469209 -6.2660398092796523];

% Layer 3
b3 = -0.33361617250257519;
LW3_2 = [0.015933339918892672 0.01789282367831227 -0.20381208110938584 -0.0058374496310041558 0.025814441875935436 -0.036110274749766913 0.053929728760623276 0.13289536831302098 -0.012232137302699401 -0.16832886459553925 0.01399142443202887 0.014305065118991458 0.0078204526444087211 0.016734953620879973 0.012876158751907752 -0.5622241889830063 0.012540400372255145 -0.051382723116081691 -0.021960866594765878 -0.020396585702482265];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
