function [Y,Xf,Af] = ESPER_oxygen_15_Other_4(X,~,~)
%ESPER_OXYGEN_15_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_15_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8681249558237107422;1.6475149194432736621;-2.261336196726450698;-5.0759894148388120527;0.60285790420227691744;4.7814995412271752429;1.9297308293334078932;0.096192386499756254992;1.3535799600826241562;1.383087755697871124;0.38296513903499085352;-1.4023388282467399435;1.4451905105144948749;1.9740928603153429233;0.043749394004162868443;-0.34870996321110675487;0.077412138992293877404;-1.5339847496517255987;0.77880919474680432302;0.97134706607651999377;-1.0900443248977729205;-15.039035315773078949;-1.6042605442462190002;0.25409821018878359089;1.0447961153079790009;2.6755051773617193334;1.7952262075901039839;-3.6316219385512180651;-1.6828170549316745497;-0.35396984503607165085];
IW1_1 = [-0.85675725809781277942 -0.062636554147763062739 -2.5283895888365961468 -0.38130485518827994529 -1.9086319457228442253 -1.3397120374291975331;-0.74674341098307450704 -0.096926618423175445183 -2.486585740754550411 -0.22779783941264319935 -2.6737522782548719391 -0.91156590049496455386;0.81384428930185426232 2.2407432645683829087 0.22495110684624256003 0.55008808282056331773 -3.5379944355324202121 -1.5692294363336947161;1.092940494092361714 -0.41775222058865929542 -3.3829967415150488108 -0.76871998653934259238 0.62245472732587114884 0.34855136717233409227;-0.30511042968462348535 -0.093671799192372229292 -1.2121622160216198871 -0.26849058067178638298 -1.9223952418090599625 -0.61349372185052719608;-1.1014212548378738976 -2.8847716899591548945 3.9281157336032404004 0.60378057193550849213 3.2770866352293204216 -1.2328505795875110973;0.35088010457725193891 -0.16998196251049493832 -0.089523308958731992457 0.77410459897556249675 2.7565886046022929357 -0.43215853496829531588;0.44065577673466177488 0.19529802534404452907 -0.95944115935530194239 -1.1113799422709382814 -0.053896443473957160453 0.52290449085735046797;-1.0055085795441580654 -0.44268038850897406533 -1.4144639320881036149 0.61766157862548687341 -1.3764760736922168061 0.034145348194245708773;-0.031350004066595681118 -0.042705205825525956176 0.41335414956978183687 1.1376408163790130423 3.212596485041784522 0.66811237775353926605;-0.29788964920883959087 0.1188099351227538264 1.2096444828512944447 -0.58074068986019822258 -2.9967597783334172235 -1.2889001927248611157;-0.39037559041723352005 0.6882802490582448085 -0.71388867386376497759 0.4261535212739036016 1.6541114297425170143 0.59947684769102138613;-0.6101904871842954714 -0.89006122713727942042 -0.073033456774265342881 0.39877135504847838199 -1.0189041342735793982 0.22607681560852435632;0.16204948414581396565 -0.0053247945104849311176 0.63438593208194948847 0.97204526807567182001 3.1735889211192316317 1.3007379603504465315;-0.29816778739827554112 -0.069071220457646270718 -1.6776169200849317953 0.065285360057927829813 -0.22302060209378749001 -0.34505393697751679527;-0.43471637977272237219 -0.54602641281504160631 1.4644215435935252767 -0.64655806395952186705 1.6054589017797706862 -0.5379052715800720641;0.28382994179470166785 -0.45536965001289136934 -0.98516531618267910719 0.49626677481164738204 -0.24732666016054768998 0.81646490657757198051;-0.52375179310243358266 0.32435357586700486188 3.699376890743529156 -0.28914559042175191905 -7.5020765759534588923 -1.7667063402302882746;0.15383362459456642601 0.0066869055520382665939 -0.37408072241376394418 0.15922310012117052436 -0.81398261425185747253 0.67791792764756697576;2.4763224159334513708 0.58691758002843608111 -1.7943991323316579312 0.73825176124934333011 1.4493008389255972457 -0.72356847048439365544;-1.24424643569865645 -1.7044609106045960356 0.9616933178752770095 -0.19634334398487132689 1.1482763225490000281 -0.40497289689580096006;0.055660268119972509948 -1.1448558259238550416 4.6105198046868514083 -17.158986647417460603 -2.9126995977665477433 -1.6406404224660735558;0.28013478988482970466 1.2901807513586911469 0.091537060576618464736 0.22025453160975116962 -2.8640934681395830985 -1.8099086753731763455;0.57123450353953431069 0.19168418953501883961 -0.7332188393563023876 -1.2531839315002764046 1.3744799520060126952 0.27129729838997240776;1.1215799276061981793 1.6379970856680299285 -0.87037021224169019984 0.3583819976731898449 -0.39412264077447017874 0.48796921142358884449;0.95000023736642202898 -0.7598690066023973122 -3.1487205071150183855 0.41621447775612724351 2.6446353836683753613 -0.51872610860780388187;0.10564700403109192339 -0.2645592290582844397 0.66245435010806441589 0.74870967936173038471 -9.9331172292843525895 -2.3973388348380773039;0.0011001667566627258265 0.42783605787575074153 -2.7214697929093962792 -0.25730667296783621412 0.5372965632069660602 -0.32052793729985462612;-0.098147143595650646053 0.49107562358968559479 0.21054431872417292415 -0.42152144447606643141 -1.0138386900616132014 -1.7094048072593217569;0.47510258275750499868 -0.47787355671712161698 -1.4180453826136270035 0.68338339981129270218 -2.8346247452051107629 1.4677478157272938475];

% Layer 2
b2 = [-2.2771583631171914419;3.6226779889753903952;-0.20743643495558383716;9.5729886488900515218;10.921868845615556154;20.466665576619519129;-2.3405966745075228452;-1.1906801381718894461;-3.0235191576478301911;-14.102135316928404052];
LW2_1 = [-2.9113118297186910688 1.7563736052997749315 -0.47944210580028673307 1.8803946217526470441 2.5831766378783767024 -0.24413222897097786035 1.2812353246971663889 3.9818224175550125388 1.8955358347090169868 2.8208348341818889615 2.6096872493988256814 0.46285210991018549409 -2.5853593264473517799 -0.85310680885593703771 -0.96954420026936272148 -0.6106907883270076276 1.3466902431449487842 0.65646007585060028866 -1.247799452243059104 -0.52266408843965017628 -0.08263538452828221581 -0.18109850398451740605 -0.21684484849102475534 -4.2753664976442582457 -0.2817766530458812313 0.72818599301890252207 -1.3579934262068134032 -6.7073955595899841242 1.2285695927406443673 -0.10998009471729645881;-2.5387418735043869589 3.1377765144594582658 0.69040663027598836443 1.3861452950565245068 -1.7049560258478739794 0.08651889739939831736 -0.80075727003242225255 -1.0186377111628319714 -0.44241456675299900558 0.64029244960379494422 0.68091936950438836096 -0.26130404064807477571 0.061565743837880167189 -0.47256346993672920798 1.4102978906141550031 0.52098727171762182486 1.2804354339520123141 -0.32354671293780890018 1.5219374132241476616 0.11870492050548027418 0.34607075514969265484 0.26612782231302739566 -1.0509751054290870087 1.5884914843064088519 0.63338449189173051668 -0.56789964266533232706 0.0074404006176528496644 0.77184507380240785501 1.7685627864818984634 -0.59600958114647450969;0.16111688922919922828 -0.88639397600025437995 0.290987108637335401 -1.8009903148858967814 2.1519612259764135942 -0.051123001243748467104 -0.66800056680596453518 0.53459323160025329358 0.80619413681717466691 0.85437743867872528725 0.77093030337555035203 -0.22339486690466894836 -1.2628588279279335804 -1.285773018968043635 -1.4024229919170725367 -0.20253664491789030722 1.8268961516187323113 -0.017617995168180376753 -0.35989709593352242623 -0.03822837756271984383 -0.64315192817719157858 0.16684742000824090424 -0.97396167296689950543 -0.82137174846081839608 -0.482155180913420911 -0.33262789575346984883 -0.42310409090933714937 -0.91349703419268712956 0.76914058770348880945 -0.56097957539038523223;7.1158336426229089611 -8.8527145911984579385 0.88139117143078837824 1.9742216906156593303 3.3636517069973974614 -0.38698378559124457787 1.7878444763988960986 8.5350552181771224269 -0.59456229887422451519 -1.490992792176659032 1.1510806826647781431 -1.7453242099717738434 6.5881277493355892005 3.046123078509439086 -4.458216847537932459 -0.81445104885134689265 -3.5262360987307141968 0.8499953095587937657 -2.4765327777853429758 1.4553688337615566795 -1.0143683986513163386 0.13023075862117261536 -1.0368628003318445252 -6.9142236651880821796 -1.0188817794952564899 0.93072702609764423887 0.25421276350548915879 16.656647287368979704 2.305265920386089018 3.5019617599199697189;-6.8484976535826982413 1.4452312667431979065 2.2056329275453276928 10.283314107641846391 8.6017614847649390697 0.3669066622143035139 1.8356157359598404 15.262407153389045078 4.0513012539165105252 3.3273036386580194801 5.3906946506014987719 -0.47903009413024294494 -1.13519581545279169 -4.527513654092262918 -7.8470009787146173252 -1.0027642719698783846 6.6100523423836285986 -0.0027458113435847655848 -10.423602811856454764 2.2589784861764643509 12.162054331172024391 0.74357460975354849886 -2.8933786248248458683 -13.484652237269195041 14.28413302181809108 0.23517055345616275086 -1.6501288011646575438 2.1943357587923801866 -4.0705703966518367309 -0.93776900757517966944;4.2376197443493310857 -3.5790905203559564285 0.64864559018848833016 8.3210744186516176768 -2.6234211609154778344 -0.62250465898266527098 -0.029236852928568379112 3.2106083317333919958 -0.46959899824485790143 0.94092917862947689223 2.4066606263901211271 -2.36960732923541606 1.1136018707604267153 -0.29188741802762896427 1.2658940374870357726 -1.6353305307073415786 2.6539726445761098184 0.61671151665658829888 -6.0211768270096959199 0.054327436592518776881 -2.367456425262066233 -0.54494296694402566406 -0.63714653703379708904 -2.7935322090287328933 -2.1009253525650892769 0.49209869955946128339 -0.087675109757944069688 11.639687406632676314 -0.38246762631619285466 -0.39992547551596996369;-4.3647886913498128436 3.0898910854317649388 0.068253952147725199806 2.1407391354061791056 2.8269916381999622423 -0.35367720768799049136 1.3265056854689021293 0.76667103929430790998 0.94837206269389240365 2.6627234819205605199 0.84015994041510688728 1.9798565074948055731 -3.190776207788701857 -2.3090814042543565954 -0.31525359698098803785 -0.82773804305189135899 1.610957069249746354 -0.59072119170562076285 -0.40329085967529637591 -0.80472685745142713554 -0.57422412438561765136 -0.15367959012096044091 -0.7762460360868456144 -1.1944977335234512328 -0.83905386822025385118 -1.1938355689141582072 -0.35484263196068760449 -9.2145407924761588703 0.27522652248526302543 -1.2660492373723608583;1.8715246936607230488 -2.6004185807682596021 -0.4051927603162787106 1.5057243171313610119 1.9925468969171260536 0.04354950480555384168 1.5766818089455609808 -1.0822434183377791506 -0.44353995513326033295 -0.19118229811743706059 -1.3849288179101133522 -0.44438653706610148353 1.4862556983357426699 0.58272262265969587691 -1.1200086581189869772 -0.09212998839744228341 -2.4726388029450889761 -0.20022434807013023139 1.5168283587204109963 0.045978463730859592262 0.7992518750504452596 -0.11754157179118095156 1.1527739132289755997 0.60006248622916158464 0.55439460939545259777 0.32219028610942040958 0.19987122865365000712 1.4533026673299334064 -0.86314967741067749607 0.55188628040125664587;2.2942808770395006768 -2.887797755848630743 -0.63858328154078136674 -0.90152296582836699557 1.8304212513553062003 -0.084793806573984373265 0.91749569642480544029 0.88205662501670212272 0.28739295796969255292 -0.37667121070387976633 -0.68000399358319318921 0.039058814848278701481 0.15419768820323939695 0.35870833370604210399 -1.4415446493604160416 -0.5242255218520767146 -1.4307142856794741181 0.28882830163713674176 -1.2020897968013475321 -0.1216329001104769908 -0.32265163030349924833 -0.24394862584203019784 1.0369803971681759158 -1.4457691133358792079 -0.60347316971688269582 0.54906642377692116419 -0.030096211705906605188 -0.15054651025409340748 -1.6663486744955879892 0.62318505137672819405;4.0665716795090611768 -6.3936749340434806399 0.15671696509934637809 -5.4041145171997042596 3.7453672537232680639 0.076142267018000031609 0.24301716728710689996 -8.6366494606862875827 0.19427994797754891132 -2.348549536851548325 -2.248335320380346225 -0.53118217407192525048 0.61284408896630182539 2.8240690850048011384 -0.80237514169709145406 1.4287358376202687893 -1.154613253421238328 -1.0873592481949878596 8.4300502534756063255 0.53488783247832549783 3.0107389661227315081 0.12477524888374284806 -0.6772168590442957381 8.13470083192205351 2.9640449863406841402 -0.6619309259353535202 0.20781999031964010216 -2.5270568142791356436 2.6402486170541896726 -0.99791916914970302255];

% Layer 3
b3 = -2.8797684890106265421;
LW3_2 = [-0.89357929222306542449 -11.428326466943605766 2.875096904681665233 0.41707516988470655361 -0.09102031552368623768 0.44308219543137433716 0.8889023317614910269 2.6104460342581035093 -13.534563528558853918 -0.74383276272559217812];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
