function [Y,Xf,Af] = ESPER_DIC_16_Atl_1(X,~,~)
%ESPER_DIC_16_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_16_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.6071945930445408202;7.8941523054205466892;5.8713889214751295853;-21.070277289966934831;-3.9623688188034273949;1.9329083461608171923;-3.2929388710247944339;2.1628972162100801313;-6.5106699282051589961;-0.8468453826504861448;-2.4851768618689717982;2.4311134461054928479;-1.773318138198265892;-3.2627019487690316346;0.18787934433531783274;2.3979455134917513348;3.8128688535675179239;3.8014491726860111243;-0.13271449952578828757;4.6435035854718798021;-1.0933569373631415456;1.9706130400260446489;-0.077629903406752451267;2.7688878631490592142;-3.7022674668036383849;2.2880029554536012171;5.9140503247114430962;5.393073199563260367;12.869578213120247412;-14.963048218205390327;-13.470966604953762413;-0.75307992827542180603;0.63285923542739941361;19.894385800706881895;-0.49651849133699921257;-0.86633302923548827223;-6.4275021414429307498;-4.1276105141687970956;-1.0649678119245629127;18.602175902772110305];
IW1_1 = [-1.0563573995544432993 -1.2418401736563353666 -1.0098211376109484938 -0.04005599298477824366 2.7439974654159713374;3.3987578076339857169 7.7715694631652478819 -9.1416741074099370223 0.21113785491976191921 1.3277101533946020773;-1.2409239815453458888 1.6604177435673315166 -2.0327058222769944784 -0.095887073122855701057 -4.1518769207090224782;-0.50318412401026835212 -0.17707792987782586258 -0.17742333436512400247 -21.982871533522317264 -0.16903037899269701683;0.59292781210181355611 1.5203033050788985481 0.35416238822352930082 1.4221830604033536272 2.8680075059707599294;-3.5555466661519607996 -0.67904799662957893158 6.6034102424055927116 5.9293208208275975934 4.4766000850653355769;2.7240818226558012327 -0.83021766583384859484 -0.49518043555444946069 -0.012770862609231697221 0.5722882749872849617;-0.17048035297898359031 3.0934204107034619646 -4.1065959707938954892 -4.5934278329419200304 -3.4460957954117668045;-0.81210580866549109125 0.24906773907879328767 -1.1487532388109080728 -5.8775846170067369556 0.27600171808176487964;-0.91201094557070405688 -0.25174546249400631126 0.15002958460004461871 -10.007094086569107816 -10.664420774256720748;0.5310375156075181069 1.0862025442818905585 0.23832615183576794093 1.1708308853041640152 1.3532178058802228904;0.26254252197036942462 0.56298883051153492119 -2.3454867056046917462 0.2076145635323722316 -1.7714590841099520091;3.5070225678022803883 0.75799541479843668412 -6.5998151245358149808 -5.9445150167151608045 -4.5820029314287680222;1.9485631011279809233 0.52516705596505697251 5.1285942421325945162 3.5421635053684696892 6.9762783084549528922;0.38899236455159047487 -1.0053839829832298403 -0.32867650051743979578 0.25480592582472738616 1.0405561493408403972;1.122428285998569919 1.2050762424268668394 0.92150492777178960591 0.094075758315737820214 -2.6156484510546649247;1.3257266213365348495 -3.0334239593106433475 -3.6041822793847533291 2.7094444593405673238 -8.5835323958847471459;0.41087615475558836309 -0.76457820524624708902 -0.86643263199245668105 -0.6497158301315464346 -7.5753743713929324599;-1.3669164806386120414 0.50953939284236648977 2.0292050825256553459 -1.4024665235132391938 4.1549885544074145471;0.9344879000064377772 0.43312181007761724194 -0.31060339547215792821 6.6550243257129917396 1.8283944044063766832;0.53274672047522730889 0.25807814751738783476 3.576146016995358945 2.7414987198059308504 3.8226088035689480549;-0.16775049829122776202 3.1603824152628132715 -4.1643582273703163565 -4.6690695601625149536 -3.1960434385427127779;1.9944413110538836698 -2.2725305549514711601 1.3308107424985742284 -0.93851970113739602297 -4.9266606006686739505;1.3134433971281600506 1.9760949276113843887 -0.16564097231002070099 -0.23138776245760431238 -2.9268334324622511389;-2.4180131737221572941 2.5743688433923610503 0.68257268663668912989 2.5112813046469417699 7.5008346735103161862;-0.45487689411663906336 2.7409738801927288065 -7.1577406284911200274 0.501522174807066623 7.6710570846361596509;1.3376596908670097541 -0.46412258553129182026 1.6976311173216680483 7.4016864264052886213 1.4906340578103058903;0.98255212996254526203 0.51029586350387190485 -0.24867220712954335449 5.5156362417796378494 -0.45021954871958164146;2.0561010357938060977 -0.79063961915075930964 2.6853138205534503591 12.366001849461936146 0.40266677713682030859;0.92751347936467098965 -1.5626647152590154022 -0.86003164820732580509 -8.6864241127732206849 6.9756638896952685158;1.8961370053903965349 -2.2470858215235591793 2.6369480350321712336 -4.06080198516619717 11.455981661904214519;-0.78519099626069766007 1.535444823163863326 1.019009190818681132 -0.36526360832484816576 -0.16187356130062049986;0.53797035158276906852 2.3907699674195628248 -0.885699785031300868 -1.6882337342811108982 1.0602568683189725895;0.43334525340366897295 0.14752904713292985805 0.27481351093042372113 21.333069091021233277 0.86246773261928466603;-0.54174074866670351991 1.3283471578168259963 -0.069917364006300233847 -0.54069262093227876687 -0.79907777412362834824;0.063039887834262717248 -0.81301523414656640121 -1.4839759567896084747 -6.6018630059900358376 -8.8415364810527687922;-5.259215314359620308 4.5489341315317171066 -2.7044270441583777576 -8.3902088722261805032 -2.3353752204867253006;5.7433438120167830121 3.7815436843886995888 0.82859857200370534702 -10.429586461641010331 -6.3612251701216822042;0.77518674544794696768 0.33059143603643142972 -0.22149862983317455956 0.77432059928833085749 -1.3018649828500745702;0.70479840883629374382 -0.18715202868151570303 1.8905736990579375956 18.853370280398436876 0.011381024130447553802];

% Layer 2
b2 = 2.638004164622989034;
LW2_1 = [-2.5786581340563614617 -0.010617377293156319423 -0.5199434800344080454 -1.1266011811596039482 1.6829504169102829092 -1.8862872202718277137 -0.43291010139844998683 1.0886043379642569295 3.6496477987771056561 0.17739708397704467835 -2.5192484454935701876 0.36663057579050151169 -1.8978532017576044133 -0.075800463369462944829 -3.0468929623658915773 -2.6670065584727473684 -0.034714706968542563548 0.22978467686918785384 -0.080966421674568606059 0.82651178480286258132 0.17494027374342538406 -1.0250263777369710283 -0.23828175540931079146 0.38980409741274446578 0.086990626262061845897 0.049682483375334082765 0.87229032290904850999 -0.6847965908627247078 1.1725693352212209764 -0.14829135149024005869 0.025082496563432945397 -0.73493112633704749115 -0.075897661779677355609 -1.1739027229257072982 -2.004351205899623789 -0.16443520953297627307 -0.031877993640686781707 0.005468454401296504036 1.6552772197292824341 0.39907995614030800091];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
