function [Y,Xf,Af] = ESPER_talk_1_Atl_1(X,~,~)
%ESPER_TALK_1_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.2647198201873766;-2.9694056797807384;4.6561882156268126;-7.1188486643585867;-2.4530563550216109;-0.37451032038195498;-0.23486144565775985;-1.4099766643914053;-3.0850981925593293;-5.5158011440825474;-0.37813741364225256;-1.3152534746764502;0.59748161765687702;-0.1142052235479471;1.1722049753302743;0.21262155013155523;-0.28303996724123759;3.5127216779569692;-1.4775092052788308;1.0508866007981941;-4.1879624981155938;-1.0310867613285311;0.27715889117295017;-0.71796509678788445;3.151646438592179;2.0231019276424691;-0.95854091812624387;-0.89774012502018929;1.5817269965608458;-3.2426298555933202;6.5979925758857281;-0.90527994340597662;-1.7027320898730731;-0.55404121091219816;-2.8958506144425726;5.4360247590102899;1.7937750119989493;-2.5888064713897738;1.9080653163166528;-0.89092962136412024];
IW1_1 = [0.37342093937898174 -0.75155743410190778 0.78192266782337572 -0.1172857928007949 0.15656402478667558 1.0604992956600681 -0.20680073024481932 -0.2082412142362719 -1.4660440068203036;0.18578211526329508 -0.28371603097660197 1.8154531140835648 0.27931707438739778 1.3263112923610718 -1.1925007990736125 -0.29636496320458161 1.0562432080559085 0.34512333809331869;-0.87804089950349617 3.1562957925510733 -3.2146827451355078 -0.29215345518242913 -2.3499627992874563 0.22617256224461413 0.19403685572605439 -1.2300813476904353 -0.30606666835520763;6.2120960349492238 5.6011798067554102 1.97962296022856 0.38017884491957993 -0.40423442833402579 4.0005518604891162 -1.4681567421401505 1.9689324372338501 1.9436695109043693;1.1139083116031823 -3.4092760188339621 0.85419040188292084 0.36675916926565816 0.95158755316619759 0.88672702435704509 0.12149896753143054 0.7802295884672259 0.62804134004365297;-0.36233750914541707 -0.69682965675381203 0.26447472935512661 -0.14130579644491406 -1.606684870063553 0.39134759982407258 -0.14118554805230649 0.20571367565445586 0.24401792147232704;-0.98714377494805283 -0.35756923716086647 0.36337585864566313 -0.80912679100031282 3.8837267720166944 0.25985305572633949 -0.23935968612672168 -0.02610729957912198 0.076882667504614005;0.13249552156299063 1.5100114555385857 0.79938086062288327 -0.10341024179717911 2.1103489036840264 -0.18779208532890643 -0.52507354356726599 0.27406125846093116 0.39700951239757087;1.2186135567290148 -0.3532446846674791 -3.001139349971842 -0.097582048101805721 2.3283509724285509 0.13591223988179574 -0.1461960670690271 0.10602516059702292 -0.82062269493588347;4.9853086300596665 5.3440232968950312 1.7898346490522739 0.42809762350557568 0.010266179515406412 3.9984065676377054 -1.4650732794693471 1.9225595404196043 2.6642922657031769;-0.089701688331618262 -1.0455172646238897 0.94850064211314378 0.1554364396590302 0.70404728235659964 -0.082936334581681606 -0.19782995609971765 0.34631639548375659 0.11769647176258556;1.9611290711991156 1.0494146077498847 0.33518477815598691 0.98649211397035597 0.40811827325333738 -0.050086078450100158 -1.0878257678304204 0.42130013614016515 1.03690499606291;1.3137728948506013 0.75149566917929667 -1.7848439531986147 0.29818655006536843 1.4655326819653514 0.14153202572344353 0.067736510132623995 0.10164345108515165 -0.97071744868354137;0.13068544461629988 -0.90310240095407834 -0.33949902283505629 -0.22804093821877802 -2.3899846724867495 -1.7925242551188498 -0.26918992816571641 -0.48510556920504633 0.24368469863916065;0.80024010166433857 0.97765067876092371 0.34452980834703306 -0.3539310612421257 -1.1408778701495124 3.0894477671730445 0.48914671378298447 1.2348746783646085 -2.107704351679021;-0.27905739143743141 -1.1700482464061996 1.0118926154451611 0.18948397555757807 0.16106905072688243 0.042513682865249973 -0.17427284112723904 0.37015571545851 0.17862320731995832;-0.05148717172210119 2.1727665167348191 -0.32237003536117359 0.56166061497545372 0.72261950287119525 0.47011566653567471 0.39560812323907907 0.82153719143761106 -0.81135440985728702;4.3343500347164143 2.7420870044999206 0.67610541836670002 0.39399079328906134 2.0867740813144002 -1.1959538026898744 0.57183840901284344 -0.38735110455090638 -1.570392891080983;0.45724153055787808 0.32672548113772992 -0.70797766478970769 0.38742977708402632 3.7352487431034866 -0.030365607011187075 -0.019494808765154293 0.23816220136996735 -0.12482928428502621;0.35300894536994554 -0.50932096900065282 -0.071974115725058241 -0.071930066450495114 -0.81610513444613675 -0.53555961138587316 0.011058117170701232 -0.093193107116112062 -0.18000317362287885;1.6030995354982824 -1.0088708028541831 -3.0067571622882134 -0.043385045794770025 2.8783891405606519 0.21049382847918602 -0.21012336686980074 0.39568334351135487 -0.83186201165251683;-1.83061849206271 -0.59495495697749012 -0.57201698471697782 -0.67944378944206185 -0.53808736877266305 -0.02026550016597941 -0.32134799190018615 0.49624075605171997 2.8292300215224482;0.29456233361404788 0.22544541471433024 -0.52573210177187524 -0.78237968161234717 1.1568747356582656 0.32830940872058267 0.60793362337768153 -1.4139883045985362 -0.95840301280815288;1.1392022696381083 -1.3928477477638075 -0.8773318485275412 -1.0095016903956215 -2.7887938321439845 -1.6701637680109609 0.75882204769522366 -1.4341625725791696 -0.14724597061642933;1.2556310604163325 -0.068981607732454001 -1.7555218132704009 -0.13329551165428308 -1.0803839215459998 2.922163436582863 0.08223729469424243 0.6469403671580195 -0.18483648235590816;0.99034909978566976 1.1420853744928599 0.54209048736949694 -0.55895844212204326 -3.0302609392979649 2.7757892532033956 0.48717769549568379 1.0346671702479198 -2.2312682454074562;1.4917652936762722 0.72404150519375543 -0.68598781535077369 0.47295215805126195 3.1568458174734988 0.27444658470460248 -0.074213873297478472 0.96537809492923565 -0.5901602999101937;-0.56004044731457825 -0.11608375587105166 -0.44620248188928663 -0.69595444394414796 -0.15254108795618299 -2.6967875628668652 -0.046443359814164302 -1.3626043679471509 0.43908520655629329;-1.3839934912792407 -0.53145325083721495 0.33364565066312146 -1.1944598477273891 1.7750097193393517 0.15761350412119043 -0.38792816489668702 0.42913032038202753 -0.063846067854810062;-2.9818345229808716 1.21903760558118 -1.5601355211926331 -1.099903880832001 -0.06614991054560615 1.0544315057288027 -0.092173162200882133 0.018839130456424467 0.22068104071213601;0.4244827023519176 0.88582600343065043 0.70368579500133954 1.4670458029191078 2.5559662026497247 1.372983687061462 -0.34692135736085944 0.40723337252389807 2.8167738367492454;-0.3530776106194905 -0.40125424133381365 -0.1047791840492598 -0.16409721829147547 -0.95634833195968016 0.019819143343671974 -0.0619076453981037 -0.082296276478781724 0.025296913223628741;-1.8191237619750527 1.0039343109439458 0.28321078779291048 -0.35554641555445349 -0.68586494113601837 0.44334601878585028 0.36483496522331338 0.28707188100253495 0.060104366550625662;-1.0187212633991609 -0.80636465677185676 2.5845056095703036 -0.21063729689130087 -1.8910246975118086 0.10030359263893759 -0.034135992913941572 0.08333591135612485 1.1632769467185022;-1.7264497730479265 -0.3804485216074775 -0.76787203324446196 -0.38939969904848731 0.49650166847541399 -1.8434178016781453 -0.33369156487866775 0.35448071777358914 2.0369169792148827;-2.0404629274316406 1.7811252318938131 2.9165314319440947 -0.0076698849384695773 -3.5665842561724954 -0.29926148140885434 0.283618097527708 -0.73481839041219943 0.75165112122576838;2.6860418897151646 -1.5788779580712082 0.30132238199884531 0.51915279721893959 -0.95696176870091498 -1.4489379368708155 0.54806720955840249 -0.12957852784679566 -0.78947144456358653;-1.1353038500630606 0.077459105910713574 1.7677965828011721 0.15158713715644548 0.38785774920133453 -2.6534894557867212 -0.061914876015082027 -0.42299725557119855 0.12131797615301251;0.90082701082865024 -0.48111763633894172 -0.72679591658705889 0.14667829866259588 0.22250788221032788 0.30651497614322953 -0.3522488998405916 -0.44747095591663155 -0.10650614954783205;-0.052279934224165832 -0.33033298982343712 0.70485990304784207 -0.32062597899204048 0.085528428262788211 0.83000680193850807 -0.30174225534457921 0.08127643359551831 -0.41720182916929655];

% Layer 2
b2 = 0.2414221633810657;
LW2_1 = [0.14909764897560629 0.17751488011393565 -0.090894988189561765 1.7414917429151362 0.097952782432132027 -1.0619229332387583 -0.82002635115899714 0.10516108679073238 2.2797080691990388 -1.795321626921911 1.3882202890844544 -0.045252469254146187 -0.68785324521976809 -0.23780063923176378 -0.10776861522635373 -1.2758417878754977 -0.051166255130031112 -0.35576903055470938 -0.46204644052707255 -1.1771736155851062 -3.5504317499878884 -0.14416576629822644 0.041259305752846955 -0.036379678631571266 -0.95117863586478313 0.076877341884281303 0.29682978571312801 0.099183279315599254 0.50237720841895239 -0.77707192280888537 1.9167682684920773 2.3012861683088133 0.82167600687981013 -0.4940261123401431 0.21786593367829321 -1.461188033983269 0.19593116164303923 -1.1215095464639426 1.0432028883551625 -0.35964774792892351];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
