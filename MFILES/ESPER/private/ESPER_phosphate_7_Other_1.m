function [Y,Xf,Af] = ESPER_phosphate_7_Other_1(X,~,~)
%ESPER_PHOSPHATE_7_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.9937112534202579006;9.9186320533794471999;0.3092656833415538542;-3.494631438018040992;4.6467833092358787894;-1.3753317191153910937;-0.018086798705418835609;-1.7463309095520895831;-3.8716962766090072812;1.1842994920601466191;4.4362579635912666731;-1.3865066098945544315;-0.28783178276293747144;-2.3525392144633108238;-1.4665206818605727168;3.5175458605064875428;-0.61215533310822323187;0.59718601678363603114;0.58871153870295256372;-1.2976233039537761194;-3.299245987717435824;-2.3802123449084997553;1.4049948556382749754;-0.88079161949267181786;0.33599993386458887334;-1.0056184355968929012;1.5387734057978716962;-1.4450438188560896791;3.7898884656215305888;0.77180265256202418289;-0.81037711551142477262;4.3114728128359152137;2.8516962428088787895;2.0629553561672464568;1.2309344430279511862;4.3256766442506320303;1.9731745675205110135;4.0464119945487135865;-1.7164597350588011171;3.5840837966075098642];
IW1_1 = [0.99502746638547245883 1.9673008490201235876 1.6160146360245970509 -1.1449961187960635556 -0.09674594846719854202 0.58102298748781011639 -0.7325553930946216985;0.36673918314867093304 -1.8397831886755944275 -4.8321174961598547526 2.197594231911777829 5.6965435169214284628 -0.35377384696956581944 -0.39035505736180398095;0.34182974823653206053 1.2125774458186691085 0.2707120461191572236 -0.13748795139917280306 2.4536384556215353747 0.82196566993100883547 0.092944114336241889784;1.0065444152886409146 2.1725744467427512419 1.7437948073569786711 -0.66276285746311769387 0.21093605632007775275 0.1282696094476276083 -0.75481504319284531412;-0.22081961638309907658 1.3586843794306131539 -1.4942765280997643007 2.5332139187042588269 -0.035741841527073707485 1.0237636984861291367 0.79982336793582198275;0.21889055527607884089 -0.028109836799441036831 0.0061729342674172252292 0.62737386249017401685 -1.9670196123438052904 -0.79126416402184640564 1.3607973676279212505;-0.58059257092278293566 -0.469046966383402264 0.4767643442775337248 -0.36197368768938353867 -0.17874439562362509637 -0.1975828239254324159 -0.69766752232900564046;-0.27665913060960389824 -0.11490331293152580838 0.29504157607946174258 -1.2860849085486909527 -0.97771286256918765734 1.5410385587556296727 0.091901069234931326291;0.010733490929017194815 -0.051358207407688823143 2.1164299395436318996 0.73152334821792497355 -5.1906369727278134363 -0.28447182692037553675 1.8053674822728318361;-0.016128230947684209229 0.1045978321381062226 2.1378881127563231779 0.26665144373873611583 -1.3171072845325799694 -0.9779235183962494693 0.28341476746877974913;-1.9860602625725656267 -0.77470133251719786038 -2.0528685158106898534 1.3917264008340004544 -1.664157542534189238 5.0083648915314267214 2.3619043482923123278;0.074004384107448958896 -0.0030421713194325812786 0.084505572798272615698 -0.70594692669145908681 -1.7324138585175399285 -0.55825474799483698618 -0.31290705340447766414;-0.054665850927987064134 -0.19198249529002181513 -0.79099366737350818024 1.0446342850424541471 1.111127276976074052 -1.3509130633390760146 0.14687057356920099616;-0.30800947211654228219 -0.13609565080730867681 2.4421269136282974799 0.46149868146269701352 0.88414610445952257489 -0.74550296587939968163 1.0851175789251232828;1.1618780635884395913 -0.52552222012120886063 0.33945838831477209707 -0.34983555292826673533 -3.2181715692955785713 -0.16736101983308523944 0.49578376318145117585;0.11650216140509535301 0.69744653373333831414 0.48459443346595598712 3.3581305425473213511 1.6300408667633159432 -0.96840444555829752193 0.35291981579186443296;-0.22938307914302075163 -0.49440691340284953492 -0.61129896471837541494 0.10645410707637599501 0.34119174015930958666 -0.92161921752274511555 0.070351050128636988257;-0.026165735433433905816 0.071944849778856581612 -0.58093571281661060546 -0.070996288424725495503 1.1040493454441442367 -0.78839591802494379813 0.098089338331789871495;0.34475838173977191303 0.77686975830823024047 0.39146600087266503198 -0.060753105480966074214 0.47088338640500998489 1.0941282151423838975 0.092502909594780816094;2.6125590073263222912 -0.94040963874642002907 0.51739453449718375566 -0.60230388476959473287 4.9661740224867649829 -3.1472619108893935547 -0.8710598827846153247;-0.11849950467561853884 -0.64071132173072986582 -0.40782873343187986404 -3.2265304541018591244 -2.0571158284867743227 0.85487625950565027111 -0.25927171774319529574;0.063890697516030700576 -0.33679541353807856963 1.0278714849200354386 -0.16742375321014699163 -5.9680152427668042847 -0.65238308715558745998 1.0874135144042353929;1.1695746822531196685 -1.0786619563986385995 -1.7547854800818292187 0.27556133421559914076 -1.9725726255176505575 0.66305697348104775113 2.3380068270794547303;-0.8472202026056164792 0.055776434586955539463 0.95776473839903009111 -0.27123380875127345302 0.39117458052469883389 2.121687002577993475 0.12762783439013564157;0.00079623663972689133136 -0.10116368318655118153 -0.80582664296146278016 -0.33098031528675808666 1.7911464737861750862 0.19162550312902101868 -0.70609829851393857147;-0.011856025205375618492 -0.14485935459022017402 -2.1842887949260698655 -0.10033745699593227263 1.3922545354439941345 1.1995828730924373851 -0.14021735885376809816;0.054921615790182419514 -0.087466342356164655802 -0.44833641385933553636 0.66105353902290853174 2.0570311533279399541 0.61843524970203078706 -0.0058367228590614382219;-1.2903648379715462191 1.1053237391112749055 1.6196769812399025579 -0.15742457177584037731 1.3572649599595698611 -0.44943702603298668619 -2.1184410509623674557;0.12153689413064049096 0.77626706225210717616 0.43460580942231391566 3.6436630551724431548 1.2606682031069107452 -1.1651911874802223235 0.42258155961734655826;0.86472268509723082541 -0.089531422930800366733 -1.2217160529877097996 0.15769508150060337903 -1.0354712922630999739 -2.1957689269624118822 -0.014148395617511766789;0.021287941474363792499 0.070748031803829047881 -0.092149716780260126914 0.83515987241774602978 -1.1022348543255842124 0.018860332085648523481 1.1528495232509661239;2.9559538524159916228 2.3020382886468429007 -2.032630596837890824 0.48907375887960741201 5.5534157490481685926 -1.9855080443421606606 0.47655895108250645453;0.30382633745251713675 0.27601077245426214324 -0.98500067469984464719 0.0043412114417757732832 -0.287195781660214422 2.5783901240202058425 -0.19885524451962399706;0.54436419363621568746 0.42221209378180823979 0.78266531354632529194 0.61077373901771825349 1.652578527649384732 -0.62946978202416070669 1.4112793851124367794;-0.085815767253391433966 -1.0179503583500326691 2.4191689249271082218 1.1146885580159431317 -2.4369164829752136825 2.0910949720066183133 2.1394448526235905206;-0.1357064575951521801 0.21963641283529355963 3.3523520430705349149 1.0286715573571185711 5.0194804502443322036 1.3415600142165318154 0.34665179271107204872;1.7797727065460413609 -0.34016801856697087558 0.22625805773407348109 -0.024689418792024273724 0.74684702013052894909 1.3538616219525141382 0.2431855661012587988;1.5043475156887988753 -0.50000458453021567884 -0.55190961032924501506 0.37263403035693382082 -0.80519021854002148508 0.9531431474619666 0.28461553877273249036;-0.6921217725530138809 0.26140053460335932467 -0.2652322944076349609 0.93111759573882091345 -0.23461617779542734419 1.3915219482801814976 -2.8473319051852876704;-0.98195720758696347641 -2.229811868591057511 -2.0080118296186761917 0.67890368027235625803 -0.26053630820082457342 0.098447893738160083266 0.83267039578864499028];

% Layer 2
b2 = 3.7819694195853359453;
LW2_1 = [1.8763995051227673194 0.76420776384861532904 -0.56602034013906243892 -4.8246396035521517121 -0.75761970651703591795 0.87863592295094328222 -0.51290732733176147562 2.0483453582432584739 0.86558333886131078039 3.9837755743876543946 0.087090729479992370909 3.7251702595379523331 -0.77455226027285128954 0.38073634233776038061 -0.58034114209547638108 -4.5061495953563470707 2.8051490265310503602 2.2898274986903475181 2.1374684905363525722 0.047741203201673722278 -2.4433940112167982228 0.45454285833406149475 -0.92451084735270161463 -2.5421786991091859242 -2.2688319937776233459 3.4262654585712883915 4.306454314155252483 -0.99426255585014811089 2.3374707685513858024 -1.8865340751419679144 -1.9613772720222644175 -0.11330390489435347712 0.91011786291814189553 0.54536060009445908037 0.094371466083267990799 -0.16464588733801030496 -0.28701073858353021162 -4.7140106914866626298 0.45253438936202178278 -2.97997357412247732];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
