function [Y,Xf,Af] = ESPER_nitrate_1_Other_2(X,~,~)
%ESPER_NITRATE_1_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:32.
% 
% [Y] = ESPER_nitrate_1_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.1525328480362713179;-0.67779606547436599406;-0.91568127764443341121;-0.053204453260642367574;-1.7176654014297731976;0.69547290003477235665;1.1858026737345366275;0.24377995166193860976;-1.1499383533927822754;-6.2725738403134316812;0.61878102878196561409;-0.37310948736660021208;2.6868612061178911432;-1.2858338123668022757;0.38103090011497325884;-3.6638593487279953465;2.8561151594612361748;-2.5884955824821158643;-4.6935257621289236951;3.5612290841327811641];
IW1_1 = [-0.080472953959295975834 -0.20402742950878333117 0.57935889390888406503 -1.1308896057395647627 -0.45334094704112232188 -0.28879756841706660797 -2.5417844238095206322 -0.65981176465026258882 -0.71684432562143285406;-0.070666844264195380343 -0.031496347909205864302 0.37857024585904569536 0.19527242782746984107 0.38255907412751605223 0.69069449463727472516 0.24617086043399277751 0.80856779327929195755 1.3068920540947763786;-0.077763024903758568018 -0.069766982408821870409 0.35575163200008091957 0.082403462811843533609 4.7387342102000973298 -0.83046290057389537953 0.1965803131250967728 0.70273597822806233015 -0.31727464041152747543;-0.44127734945129876154 -0.24986286195231643958 0.42082160175262139923 -0.27371947359556025869 0.088847489411933100456 -1.360027670088455487 0.49795830899594428764 -0.72866737319458363409 -0.41530372134267712347;-0.15912515073924832221 -0.31070965583834214696 -0.78106593115593248022 0.25119795793035382125 -2.8112644311369039407 0.70645307931098288989 0.98283591476136167309 0.7496550230477401211 0.32519568938787218881;0.20098235992201604616 -0.13902093761235620462 -0.88734403183254928482 0.13785833658176641081 1.9547004590909500266 0.051363374773827963349 1.5320381425364613115 -1.5148469515798426155 1.1264102520821599462;0.1731184555044245621 -0.025937358462017622712 1.8266723798853903293 0.10515434343371356241 -1.8997261264773741551 -0.77324989993259518606 0.82129608868974435243 1.3068835738423645321 -0.73448809881793220011;-0.10336728476641367236 0.21831850018537551916 0.91612545362425157336 -0.086344192094702232332 2.6809208832209017181 1.0058922439289632589 0.21729381311334414195 -0.46528771784288280866 -0.97471459839573693085;-0.010805013443270261239 -0.056911054733986339571 -0.4108263041270093785 -0.01914959487299780494 0.74526985544287549512 -1.0490591962416762062 0.16762237236655169736 0.097360621139236130928 -0.28985810660853295051;0.013419200967699728561 -0.99389151294851096896 -0.79730226940681026004 -2.3609973117031954892 3.1044814818099673026 0.40760395183609099412 1.1029816186797427591 3.063285074272097841 0.36141037028777589502;-0.71327634399667694254 -0.30446983182153020131 0.4677309330915161989 -0.00094867921463832709239 0.90363595413147057567 -0.016903824502230657689 0.099437340930813133966 0.27413413001529945978 1.3181747849331233446;-0.040795189019857819313 -0.011845400007364269637 -0.084285659568250001494 0.055022343264820069986 3.1309823083606573846 -0.54654301493673906887 0.8085859986404040356 0.40747222574572206089 -0.40256201378945732916;0.25972480404227155093 0.074051774673532855253 -1.3413744696123157674 0.090155759797307846726 -4.4293761315714448301 1.2015713654293795898 1.330330436618609502 -2.700985725091441747 0.90678768619370297976;-0.046929864078032380859 -0.29937831863575731228 -0.11935366079972255238 0.043866573963652136237 0.54116478572012360893 1.5202770610405536011 -0.1229690026650693685 0.69551662227046728848 -1.2705781163573290904;0.047995363937839242985 0.14617262729239516306 -0.50140761085716900602 -0.056707562061474960091 -0.19017657553375511004 -0.63834701567301710412 -0.12081197433612440861 -1.2774499356853559195 0.38436234067201541231;-0.20519250340923564369 -0.11581026811043892977 -0.3010096249538035118 -0.13488301231034091621 1.208430028356096031 -0.96548833733568772963 -0.60251770385700720301 0.77851048112564602555 -2.1533663390163084728;1.7940182555624315519 1.90581218915579087 -6.234008982962857992 -0.58357726241108698328 -0.21224446942409708194 -4.1632011744251498087 -1.6891155059196667487 -0.95418265155161274826 -3.4081388348050563053;-0.042250687947939895295 0.49347614921844079605 2.788565158761395768 -0.088766900863101336205 -1.96232806404286797 0.069470881933263700647 -0.88890215889553592099 1.0884185656890967842 0.74944113398993428277;-0.23686662276436570851 1.6139116408611264841 0.97906464638059831351 -0.0056767315084414711815 6.2019675017059467947 -4.0233880502257513001 -0.4399576903183570753 0.7616897952257485338 -1.2124099823276244248;0.21000969069728808725 0.21804949231437370516 0.79261171875146874122 0.0304752191280794546 -0.81100208106294757737 0.41491410174830867241 -1.0212317786212614656 -0.74222932244037098659 2.5986786492774500701];

% Layer 2
b2 = [-6.4703191342031161071;6.867236909911786924;0.90488972738992123901;-6.6270184615713940701;-6.9890936820657758588;-8.3219125498017945119;-5.4204322309885073494;-1.4683513972160888716;-7.8051328651970983685;-0.55392863939206615775;-2.744905120749058014;3.2498139667593095581;-2.1474280225865571836;-9.8179185964318271829;2.9121191997138788921;0.5660185356407817503;-4.9230548340055593215;-4.5004327243246740053;-0.70169458454505140299;0.95339044475025724878];
LW2_1 = [-0.62462220184312855498 0.77730689811930020472 -0.98023810925108412206 0.76239880756433653364 0.013096487752906194393 -1.0897485270112352573 0.54203669734519466239 -0.35189232407079196197 -3.1891021370620875608 0.18164446590545521576 0.33686387600619804861 2.5896127370235237919 -0.077978896117702894974 1.7439249842638540056 1.9282015567740065087 -2.7279163311013401305 0.052181874602521660655 0.3700703222810017845 -0.57629178242784573349 0.39649568992653444477;0.41694563038161069901 -0.0039826780696473069315 0.18959991031119796667 -1.7414504379580364457 0.66703953454578313043 -0.17377021513130191943 1.9319481681685135577 0.86049259017340151701 0.14397211938239556916 0.88695908872915052434 0.11375527846787540642 0.53859312566618688933 -0.51456583220786322741 -0.098734201335268764743 1.2723777440203469791 6.5924812933147176608 0.15080746657498370067 -0.77240877921879647072 -0.14735953872478732563 0.69181537493750455692;0.2547005341143749324 0.080982223748908857552 -1.6699288135332539529 0.40740656288315874045 0.23008410311939275772 -0.27097192833293509695 0.032032547026471146212 0.17472468821893819002 2.7833316924118762792 1.6510083435495763737 -0.3882750605111236486 0.074198321703778019609 -0.4304895419034366344 -1.6814341162393713347 -1.4654709358298749766 -0.2723056815188608093 0.092758864170187568798 -0.40184641389812714163 0.3766635969748473034 -0.23981335719386745464;3.0464205541643183395 2.2139311391518416983 -5.0294953328049913921 0.46878559646089101864 -5.0498617013857929336 -1.2590125153540128178 -0.13041017495025292172 0.37422305236351482982 3.0705565231467484288 4.0475771381026914852 -0.039071193929834865943 9.9083478315787516522 -0.5046898767501519778 2.699473032565287145 -0.012402133248938511378 1.5001959036942293935 1.9890865754330024906 -1.7985814926979355466 -2.0173359333196478893 2.1831948041359336976;1.5639581484315556725 -0.32173544019354050061 1.3166684301083420028 -0.73162738609779853771 1.0057842835154273686 0.034636359182094934861 0.40700564322505411452 0.10244531311765656123 0.4457402533006983858 -10.265191172402239772 0.050447840147742721573 -1.9250988463708791354 -0.59826705284126924234 -0.38046993143719004538 0.75424168313771500216 0.77220447182555884691 -0.064823902837266716981 -1.1014112955618262646 0.24174776422492696981 -0.89725754808738700241;-0.41038245444250837091 1.1455337677552792641 -0.62356578934910722456 0.084540521868864459964 1.6927161889594664057 -2.633706932021808278 0.96983240459676145484 -0.20737726930335556585 -5.6354691921621036244 -1.0699743364507201537 1.6907818873913176283 3.3564903059625970094 0.56278391343019051885 1.5360217528239787921 2.8617103726627712845 -1.9915867278859151757 0.12225096479228343693 0.29556943606387875434 -0.89813539239352946364 -0.19876422622914985405;-0.70805859241179835983 0.78851158531595744172 -0.71590655747144960053 0.77749918293522435331 -0.48203789443870431741 -1.0431239238444287576 0.45582510176616863884 -0.33209324367971820857 -2.4991949750713762235 0.9158120114175322124 0.16058652299771314365 2.1130351561804778804 -0.0041165332773404703787 1.6500177696219140433 1.6374869622548002823 -2.8026816214419985052 0.029571680246917964735 0.34052618203177331679 -0.43502611598598950327 0.28587039395084318238;0.78996778395192979172 4.0593619797744109334 2.8260477485507053963 -3.3525407203917207966 4.6193588753388032941 -0.029146527139330472705 -1.2217112438083055359 1.8469733616659753661 -9.4540303683331057272 1.7571316200949367303 -2.4319941065989203466 -0.32614314524899196135 1.8336510505382606073 -4.3394269171884261027 -8.5630624087036615322 1.2089339462146355686 -2.1101685906015394956 -3.6066210429175091789 1.1162627673653440219 -4.6888526721821044418;-0.79047378046519600758 0.30076931584899446737 0.36665864511752965793 2.8350732227096919758 1.4048231374232100777 -2.714343325296613596 0.15655266305226411827 -4.1593362749270879064 1.3725202270076799493 0.39163676898058424891 -0.49842317951596842862 -0.14930316158350140365 3.8605152610934450053 3.851351410878952386 1.3500296226694066259 -5.2040581886983536819 -1.1617883569640667929 -0.70622936204208341948 0.049762282941705066053 0.57420523057467942607;-0.07664079682330342258 0.63120595834835035998 2.1847356828731863132 -0.36911490741340585719 -1.2376431119487196764 -0.2011440968453782896 0.42081686343449270504 0.46223329147668107408 1.028965178570281358 2.023931885757053184 -0.2764565299852340674 -0.97721223079780927812 -0.27238464630303810265 1.1604210909522965078 1.2050482631487302587 -3.4162848670684740071 0.11857907405898912567 -0.32489251738546692794 -0.012887343846517835752 0.85085771237885743368;-0.62589717367972474982 -0.91742249544751797163 3.0610908433982420007 -4.0598544400790315123 -1.4214741995270876451 0.61869575170246726703 2.3406375040114046904 0.78112987802828881545 -0.10435277962922302752 1.0354248195251258835 6.0899339162688637117 3.4114733019779301948 1.193908958108294005 3.026506564112007247 1.4370603441837961345 3.2086338962716398626 0.30371072727852316264 2.6562795807747523469 -1.9716343521707673236 -0.68334629359410803406;-1.4989830151602838715 1.1904525276448210125 0.28632250815825527335 0.91576317856218969471 0.54414858089192297275 2.0735621480904207203 1.4093205360219172029 2.5571194655001021623 4.557773915992342495 -3.5534274639028353704 0.10099435502783640772 -1.4809959208083096627 1.4682641152402149398 2.090702550650203051 0.60784170945177162793 2.4973187212150960157 -0.58305315766831522506 0.28626513027942002143 0.53982757055582042405 -1.564665518984647008;-0.46532746496958293791 0.55549034536015529095 0.064568442905336656534 0.49409995524830568892 -1.4067115107814325281 -0.23802289575820417822 -0.42182405834775515974 -0.26455966401116343123 0.80710667934982949223 2.7953962718841318669 0.056939465368566810621 0.090463705971742677803 1.1065326993853432658 0.54535722842763101337 -0.071257531718684208322 -2.3441248852750207199 -0.24268370976505890257 0.65396850320672783585 -0.20891805116316375379 0.80447694873743735844;-2.2917291378198423324 1.3709742939622424629 -1.4360358993590136567 0.97352121730355678508 -0.09000948843724833337 -2.1805717919493559087 0.12478123587256771676 -0.51269554211960144396 1.0632054085778286368 0.001798001720146824578 -0.69003314928920322924 3.3637958220670878262 0.116448580506158611 3.7117898139687848236 1.6292793348163432388 -0.82183074008154510803 5.772740748785319731 -2.3315665235076972195 0.53903259696025740411 0.45548635410041660165;-0.91876789054993701633 3.4216605054142239517 0.6388246599437720219 0.22064282074152913316 -0.47249404078964518661 0.097474911697840935232 0.13445575427752581854 -0.74426143809030276266 0.4542444637551708575 -2.2939547233723884823 -0.23032185070751962086 -1.8170489803569289666 -0.69712885612488273424 -0.7545040535645116675 -1.3898131898267183093 1.526486925313849774 -0.48213857237693386049 0.17008964563579037632 0.29506659538449470093 0.78862262121712745078;0.31001154415833759304 -2.1732428047377392311 0.65331883835930093518 0.29480866031256613979 0.021175091584428564623 -0.19943650349115227272 -0.7524540094946142732 0.18301813142943773594 2.3119055071943908075 -0.19653116750677382396 -0.34341758939164890307 -0.91035421420922202351 0.50791420252813090919 0.25202478228645652791 -0.72297627462202573856 0.68541518458864103547 0.22318683589799354072 0.72552287268987980529 0.43331957236087842444 0.13063654108861152969;-0.6627571015376494401 0.5709817275525046476 -0.099233716443655500816 0.28027960432453169481 -1.4878017374124452576 -0.2862075300072182138 -0.31046178139122898587 -0.24646879794358267368 0.70083735443362160655 3.0024353007678779015 0.10977212863251475938 0.22602275351998152297 1.0927662024266961982 0.1727914930358362966 -0.11239981937143654622 -4.9240323311314142529 -0.25672372550296684857 0.65851191670012598767 -0.20012444213386540448 0.4933108048777093968;-0.84356175510192754619 -2.7555833865878280875 -0.11209548114997014423 0.59814622519167204295 -4.8021607684779317182 0.023213395175462323006 0.1246591199740889333 0.48632485792142149394 -1.8588713761306485672 5.9410147709341964983 -0.13477055478164032265 0.60743810883404503187 0.016931904590119735421 0.86876619413895050936 0.40575195300711597302 1.3901888166810971725 0.4487028013650788405 0.71482073852655625412 -0.78941137680802253573 0.45583354192025815621;0.0033182029015254507764 -1.6416935563651509078 0.81923846069542116677 0.29770871551112415565 -0.90441783737760617079 -0.54310780321267870807 -0.8044884753978431835 0.5370157746987191949 2.778262124064176497 1.3113780170193751751 0.11532415801304368719 -0.7006315679917390904 1.0722846052449490628 0.69187590269635446116 -0.062237988559197175709 -1.1866178148439239237 0.32238036884650805858 1.0090846712554801812 -0.19584692013692031609 -0.2660104440803595649;-1.0720862479110540022 1.2001687019905002973 2.5026958337009177491 -3.3310640635920316655 -4.2474520129961153003 0.41500974805259577272 -0.77847077377744067217 3.5325723190919338101 8.8920056649425323059 6.4200961024454397119 1.3001633581949139096 -4.2883166039230866673 3.5205932626899927307 -3.6135531224088794922 -1.2767750997978255523 -3.4024882281890653779 0.49710820938462640939 0.70105896846199167172 0.077182671912137373882 0.47242562148373279385];

% Layer 3
b3 = 0.29594649491956176446;
LW3_2 = [3.8615716331018732355 -0.30871289515686417548 0.35140643472781413204 1.429510776660429805 -0.30173227210814607124 -0.60763231636645120837 -3.3342706641580650562 -0.53916842640112505602 0.072661006958748663997 0.35174431351155327485 -0.23484389459235757713 0.074878258706724626359 -4.6544275662631733326 0.14619267165053975721 0.37427126157644724502 -0.83569472142541567639 4.4691848655129646772 -0.75192168400505088321 0.92168567509825993778 -0.067386022103369427882];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
