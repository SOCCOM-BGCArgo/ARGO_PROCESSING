function [Y,Xf,Af] = ESPER_talk_1_Atl_2(X,~,~)
%ESPER_TALK_1_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2402647306240016;0.54189121585852162;-0.8975194805356066;6.529365483618073;0.81890413060013645;-1.3489283441698394;-0.9494206289141085;-1.4971153811496152;-2.7165890716632468;-0.42412889348037436;0.014955679396662586;-2.560788913863199;-1.3102007382343916;2.2934099900231728;-0.94832648871220493;-2.1307972952648733;-1.1824508160511242;1.4703760271016231;3.3550202667430726;-1.0165518117515395];
IW1_1 = [-1.6145449097129272 1.1783878156647558 0.72549426339189593 -0.35708760557621722 1.2125700153315997 0.62437228699882208 -1.4400897987786496 2.1276139264389649 -0.11730995315519131;-1.2501742783032856 1.3418138915914122 -0.31259879211672675 0.29309819573511708 3.0513113932854621 0.01386196691381783 0.44561740978419384 0.096043169382489149 0.79496658945735388;-0.093779176322430449 0.28296264454630171 -0.323677427987688 -0.22366957488248992 1.4079649723557359 -0.24018722892826275 0.084142372010384131 0.37142596189632632 -0.21175538757214485;-0.79577951367989563 1.2725672665056518 1.3621026376045655 -1.7463856354345584 -6.9899154651791129 1.2398697300063426 0.036895947290454513 -0.72574420652164284 1.2634132635907542;-0.60299115843587914 -0.28908960918891452 -0.15943047367322905 -0.028613413972728111 1.3675398784318828 1.8639403379834165 -0.044712371219019102 -0.28424820324891564 -0.013059658314414035;-0.82660566307789984 -0.73247216992805098 -0.1921778812166885 0.71716598047523528 3.2236696305584482 -0.89203208587624472 1.4717520810610676 0.78264054693231599 -0.27008509129746716;1.2467672209476239 0.2125199224157818 0.7091811550031768 -0.34062797258706795 0.5938590954815065 -0.8906562215987478 0.084776594191854501 -0.51378743156609086 -0.67305283704231589;1.0155699300682246 -0.94431187156036811 0.34316076545465601 0.2234146289501335 0.35972345950492451 0.20377560170619025 -0.45612812468591235 -0.4951212878376644 -0.95644134360574606;-0.41806900893661675 -0.82130140352815217 0.55721227503725512 -1.1046800456926498 3.5401383177746673 -0.52325350333444287 0.43405713186741057 -1.4771449348663448 0.12517705591813186;-0.71271173839263346 0.51092659740152868 -0.55495557133425943 0.50829149311890265 1.4726041632509348 -0.4224442566826776 0.52587705911818639 0.78255524844561397 -0.92291219608053832;-0.078349521927048513 -0.08434131408602985 0.3068186810921707 1.3321002372041628 0.33108506385495035 0.91734074844964608 0.78240163158817333 1.1398785952596735 -0.32629912506972641;-2.0594251659493854 0.54906044700155554 1.6166548119283768 1.2779558077733069 5.0683742324059402 0.56061441622833041 0.73665938824061095 1.3476649248396588 1.5393954926940656;-0.37916739787235482 0.7764498887876099 -0.071455144847028668 -0.56832043314431813 1.2578063539401934 0.34331583561106621 0.27533207039068297 2.1330086288124259 0.13513137080911666;0.78866321446415211 0.28144878332935103 0.68568694522957319 -0.30723712704471001 -3.284372121437618 0.29680065957418555 0.8384046011751497 -0.98214674220145981 -1.0365125325860955;-0.031690039945032854 0.43220173227087944 -1.2291254166294552 -0.16826563363291916 0.56031770962914296 0.95484839497207064 -0.95985402908065554 -0.85565875966413185 -0.22872721910069882;0.083463408216991844 -0.5499458162456321 -0.050845621332308771 -0.34006479557460106 1.645810283664666 -0.85350529893551874 -0.14556602201138211 -0.96984739078788207 -0.05881745592263242;0.75415879401586927 0.066743576226690804 -0.8374168068500093 -0.19261181192162113 -3.1201332920365141 -0.69823533640189195 -1.0327628378334139 -0.8450412811695257 -1.5249022755469923;0.28879921588860491 0.10382227689343182 -0.098114608291171246 0.91373586979676658 0.83675838136153013 0.31557415368201502 -1.3657228316561898 1.8340133717710123 1.1616350010218686;2.1557719174045786 -2.3906074145680476 1.9044832443520532 -0.77149379604076185 3.5333179469691904 2.8515449027478401 1.8363389409474973 -3.2121290534440847 -1.1081970050861814;0.199486356277745 -0.51430335438284347 -0.19608907317439803 -1.032889997099103 0.0051643366385317564 -0.9840389059546869 0.38346311398250665 -1.2658624635783819 -0.37358164006999117];

% Layer 2
b2 = [-7.3330183204444133;-0.34120208806275626;-61.115006821343854;-22.923170054502691;6.7890536733859959;-6.6680257985581015;271.77418544775702;386.91581052296664;3.4966549461836616;124.4356959656289;-108.35275911409828;9.2995830031797588;-27.939341242968343;-12.079730127584501;1.7834361871126039;12.188096394903084;47.852071519855983;-4.2865611530463559;11.780067817478836;-1.566358143111356];
LW2_1 = [2.547697168645275 3.8135723297968918 19.157108098088557 -6.1322453372883334 -2.3606502004659604 -9.5401245106523653 -34.518641205921469 8.4981258707978533 -16.280324966509735 -2.4292055072859502 3.8130398008038568 1.2439209475729351 -2.3201425042659722 16.4193293777859 -19.839571225266628 -9.0777214009027585 -14.963187152231503 -20.175216037212902 9.3917613429754905 -5.0408032265791647;-0.016191783748569086 0.13573398539953002 0.2767474273718864 -0.072266188817651955 0.057123220577816991 0.01408498236846239 -0.04707465821249035 0.030236584258797349 0.029703327938445951 -0.20238556758174087 -0.020317258062507604 -0.013750944385531649 -0.012406866259071383 0.096788345015952515 -0.038897693548897938 0.16739476850589061 -0.0016173078050245484 0.021287620705077268 0.20906026926300028 -0.21826627167415388;16.042114110079702 0.29146950975825181 -21.218454258563227 -16.967444363179705 0.55278679772217687 -11.129180866544726 12.015197196589742 -29.778911081792014 12.127057819446454 12.360503914418111 0.68360882720291305 -21.599515925049992 1.5445817430025395 -4.5889656700445043 23.101890247505334 4.9440367426002103 -25.038204748261052 -22.739351370721192 37.526889196209218 -16.877675301395136;-3.587564222768608 -2.5108787689136003 -4.4811933733991536 3.3993930154178451 -0.57712732498748598 2.6662919534553207 1.6230394943897253 4.4102573130820115 0.022073767468434698 2.6831626012484802 5.073582000571756 4.3511622567414765 -0.55248379075988707 -3.1993726016249648 2.4684588074472491 -12.277178996230415 3.89057927786323 2.3845876354249711 28.35201047928534 10.685333327953288;8.1080020162611266 14.692068712093125 21.427379981053562 2.3232039745205841 -10.622610365073237 5.5781259744232399 13.408292284699321 -10.419513640464617 14.317391835488962 0.12290643635075472 7.1089477121018438 5.4938479488914496 -9.6569223107286337 -4.7182799000087581 12.864828477137232 -5.2975472311818823 16.228176813643906 9.0500595947726037 -16.770145899028915 0.68734249191959296;0.31120673553851663 0.26495220743555431 4.2616362693629268 0.69383328619630746 3.3522059918940341 -1.6391586830045775 0.77238228194856129 -1.2154569457562627 -1.7693422765858144 -0.76528067140515255 3.2673133713366815 -0.49701473707130306 -1.6769814005807537 -3.7398304894181149 -2.7535299501351913 3.3442340255321534 -1.8279194164660348 0.30811085537369481 2.6895382517915345 4.2292931517340762;276.82500812726977 -232.84196753600671 313.10176562858857 24.305115714085144 120.64025448127944 0.5027990889771583 -203.02139100118691 -94.126237917051711 -139.85517410294236 2.2173796307416724 105.75282555974081 -139.59224240338213 -72.120555170497212 -144.98182679234506 -8.7343985419707355 113.10930513950822 -22.329311521924659 -268.66713137854555 -145.48402270515598 -85.130128614037261;0.062323206956516865 7.4524474035335961 9.6060936599265823 0.56618441875297321 2.1735113612048158 -3.013426318583067 4.990696782147376 0.25467848683008915 0.27561511550345752 0.46484490859180394 2.6766487682673001 3.2942067728439204 5.2746329972782702 -0.22612414679075513 -2.4225586033811499 18.795339098048704 1.4467171826344061 1.9294595852823495 -388.34880904614721 -0.9836047624171953;1.3761276635032045 -7.2259004136170626 -0.50503518209640963 0.35630978841258643 -3.1239506203922796 -9.6665466521428201 -1.1154591151772979 4.1148599865664988 -0.44124027508439589 17.599222113209358 -7.530431274145255 -5.8040007541543854 11.612146685426563 -11.88144178986593 -4.1403193023762999 5.5368650296793689 -1.1980941750702541 -0.52675565077657394 0.6502803597316511 -6.0783061900234783;-54.063031674547574 -30.7935978599075 85.016800187828878 5.0900189370158069 -43.958909139504811 -11.859898736219847 -39.263363637578188 25.882318695766948 -34.07992102523653 -14.882806082963185 19.96604144131333 10.285996855216245 18.846177905773654 28.842029667256 22.360953877833534 116.6735473312846 -114.68323123550725 -33.740244780884289 -57.102745592364911 -25.56780076670336;4.3557255602287634 -1.9832393360958556 2.277152065146598 6.0951546289102927 0.96534090934278272 -5.6366044976708629 -2.7955250274538996 1.4733272295794317 -9.37057416927391 3.2671531681764954 4.8261770051162873 -0.53194809585872149 5.5292530763349887 -2.6922002627171246 -0.2860307698082093 11.109213927395681 -19.57844672290722 -0.96619709782783336 100.75589906522865 6.8914922076969436;-17.19675255826365 5.8315601582429695 -11.811145930776215 2.9366644288693373 -17.424753989270176 -4.8442129214410317 -11.042303039125255 16.583256105732509 18.543655961191828 0.33723258556956004 -4.532753280723723 -0.91421590661794783 3.7435955334879591 -10.341535844970602 -5.5634595242707947 -22.905320019016894 1.7527527355316637 10.5698200118714 6.0638102877179296 2.8263774013565017;2.2467546592339218 5.4840021105767436 16.468278743065241 28.503064265614626 3.6654865990469587 11.879276328554907 33.050030356383118 -3.8080389189692543 4.3982895738568564 -0.22938135457051759 16.211671445753492 -14.226369964612001 -9.9743291779632557 -32.803219668043823 12.397873846587666 -4.0072176827276751 -16.25746784901655 -5.7859890861149816 3.5622470187742064 -0.083808484997835442;-4.8375081629669703 -11.068525324892875 -23.971912637740765 -4.60387921195868 -7.4464225446502335 -6.0481191859465158 6.0470986579537529 14.341150052659259 14.416195999108822 26.84946904955962 -15.274658992303074 3.235956267513965 -10.741374891961589 -21.823667392535302 -0.055197603705229831 -45.401740841339588 13.060872917578942 -9.3505949817768244 24.117363168279063 0.3631731637097606;1.1652587692864838 -2.1042221355822681 4.2338660543679678 -1.4006082078205249 1.941932396175768 0.035998498420454848 -2.5101291160096486 -2.1521061145694036 -2.1839158641822163 -2.4627929932141592 -0.61939225394929998 -0.66061724924979792 -2.1991941048902026 1.0128060695086383 -2.0883706585147834 2.3065032950564994 -0.51558235468077085 -1.1783762601336332 -0.55044612894640532 -5.0533880187391995;0.78997157544395868 -4.3940011237851877 31.246659859136582 -10.156346765088706 -4.7461953551628024 -57.136590411278078 9.9586328775628523 11.57092672377525 13.555698981405389 26.894676400250948 2.1790960505618431 30.872174886015916 -28.035617091617723 -15.645744118403112 3.1850307811520104 -19.288653221708735 -40.513310953933242 -11.110721641447844 -5.0276681715323086 16.093414328770507;-13.570480321832799 -1.5670151697948571 20.054872268107484 1.723640874169408 9.0963994696257071 -2.5984866104834405 -3.102408592612798 -1.7935189623297307 -0.51559883814531804 3.9729051700187035 9.269089060562262 7.0830739704867849 -2.8055756621915506 13.948354942539252 -2.934175516982954 30.708700251368434 2.8891213551289057 8.3134161712301697 -44.78704532075627 -6.461205942342426;0.80461284149117385 -5.1492683261968084 -7.4902808103192653 0.45164147990602388 -1.4374687255614003 -2.9328296190231544 2.6570431625287569 -0.30884896304969972 2.2075088651539945 11.014333510171564 -3.5353076006166426 -1.5985326410059371 -0.86232380846309409 -2.0359953285426435 0.46234708588417733 -5.0831989318681483 -5.7269591063276302 -0.73960800792714754 -4.9258042578757522 -0.61902797722667091;19.123476704464803 -34.853639671500986 -69.12957239935416 71.168892502051634 7.679350056062316 102.50537153078298 51.783109562928502 108.87281461035904 16.196728764711281 2.0085116918343475 -102.39198508616326 -16.880345147125936 153.06314510160124 -173.35565875549915 44.807622751674479 -89.597732588051031 66.822400779440329 21.896356601645817 153.46802771087704 -66.617600682189021;-2.7911371337772408 2.3409253736477567 -0.89040978906565649 0.18430888346965077 -0.32578499994453708 -0.4548300268189252 -0.35360412458174012 1.7778253787916998 1.3475102747686296 0.64640610903389506 1.1888599881705868 -0.57801797374065134 -3.5863990972139574 -1.4673841909268617 -1.0705017624772024 -3.8141678290474421 2.1643886980821572 0.68327471965349562 0.48823996518159807 2.3532001746315556];

% Layer 3
b3 = 0.53904706436588967;
LW3_2 = [-0.0027364762497659712 1.0996639445410337 0.000838623976952426 0.0079396377789116689 0.0025190846812410215 0.011321792688845847 -0.0022741005916427789 -0.0056114724734415127 0.0051785255855735946 0.0017997856510160331 -0.0013430315666628165 0.0030818283520481376 0.0017457767989745006 -0.0036629007212721121 -0.025714809155657558 0.0034613477095804639 -0.0032587782676394179 0.0019371822539216365 0.0011944639441946905 -0.022579473432459047];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
