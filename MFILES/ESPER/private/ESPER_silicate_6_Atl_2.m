function [Y,Xf,Af] = ESPER_silicate_6_Atl_2(X,~,~)
%ESPER_SILICATE_6_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_6_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.62735151945898504078;1.458023981888299847;-0.092087821664129668187;4.4669198690578859612;3.0094814586679881074;2.0397422292876430383;2.3466728107449577045;-1.5420294457169443358;2.1220048749882427508;1.4025453020726952325;-4.5227326720829266193;1.2642094568085302519;-0.409991850586566009;0.25728880917497876091;-0.055194415870446156269;-0.97358562408804827371;6.98764445879290097;1.7376205853286945668;-5.4699288551996243513;2.3857802175922255827];
IW1_1 = [0.0049907460481709697148 0.54424135783750848816 2.522153899023501733 1.0926591389428372825 4.0598845769922817794 -1.6827065272737273816 0.1633537852340407881;-0.15651478909381424942 1.4158366718975941012 -0.41120857507660024677 -0.37041333877540938424 0.82010824227226020167 1.0883049850947079662 -0.68036372030579650438;0.25906719762839142129 -0.33909049531926233056 1.9617684494616602908 0.019995062183577060749 0.76485648977338205334 0.069904000455830242466 0.80914165950326177867;-0.73538835866492036075 1.1194976829115195205 -0.74862525731180185051 -1.2495874185061062178 0.78082887750984319997 3.6507292893973462 0.79859542250858084333;-0.21374232920678351566 -0.15632141721736350637 -1.5363028586524059005 2.538800836549441442 -3.800700531370501789 -1.3262203126645619733 -2.4796480628312598249;-1.2205312344405045977 0.67298780285276282864 1.5355985554796292014 -0.50769344732277443821 -3.044652948817387017 1.9238772158906751741 -0.8321997477239936325;-2.1522984707109378277 0.11343516547989748733 2.4937525838878693563 -0.6717286031178031358 -2.4209591418574820665 -2.986762433323570054 -0.18143633483720295052;-0.37466230960840746222 0.11284613849719137002 -0.46844680878270922308 -0.48261978933024352045 2.6000422786566539379 0.040963167199593322754 2.1514411187883180077;0.7424179316319881039 -0.38335771563281328955 1.203617103974187863 -1.632770750784042324 -3.4393605136111786713 2.0674760411166492879 1.4401337203556048294;-1.0410320663895789028 -0.16161684038836460209 -1.9336519360348154439 0.54940290077655717926 -3.460383301281564794 -3.3231913642603441161 -0.14735329232064633964;-0.2818624330896910557 -2.0257481847551486176 1.5215650228153911883 0.12626968796206383683 0.85872939921030300159 -1.4104565336483951832 -3.8976277401779397813;0.25064591164954197477 0.071004186590206019858 -1.9475265533236045812 -0.83136108230178007439 1.2350256953158762485 2.6462489328836551472 -1.95753698363988482;1.1223284112874800655 -0.90018200369356893287 -0.095429677035429510967 0.95684633762191784179 3.8717786086886323282 -0.82562846850439042257 -0.69214264121699242693;-0.55498041542279530347 0.42159350469931294869 -1.7754017252112088698 -0.61113481346080800183 -0.90583335931621766779 0.14304782557958989342 -0.5840261869266007988;0.25842598550730278006 -1.8916022708190218804 1.4080722059442949412 0.89964905592354937891 -2.2808109608060562756 2.5864091361464538465 0.12642216113029461355;-0.79229264807719845809 0.70674019269367149843 0.36269423037545434063 -0.81992367514841579812 -0.92299120535017975531 -4.1992870929782899481 -1.6890801609644310322;-0.66357745760070752095 0.1060565770162979482 0.2843160569596709375 -1.3574673431054788963 -7.6814132924079281395 2.0211214127277834507 -2.2329977904108258002;0.046992556396742289626 0.063026842424090415151 0.99377370445408264032 -0.0039908780359257396003 2.1744286709919458112 3.4655657628701814765 -0.90755992798107787412;2.7110077528013651893 2.8065697388245078869 -0.72950104741399068864 2.429969776548258853 2.7290407686971831502 1.30004913198031824 0.80189711229418281224;0.87964834703847782915 -1.4211428852082448326 -0.76509606224220083615 -0.52264341701760563819 -1.3817618865874934375 -0.93408514800098019215 1.6977266502239565238];

% Layer 2
b2 = [-3.059618027076370872;2.0609198616434216689;3.4181860951927682812;-4.7316501735397817896;-1.6265442403001280081;2.5205982767763757124;-1.4732890714222730555;0.12121828611689919319;-0.15453649857894111164;0.22673302465153882812;1.9984038720366381625;-0.1626312844205310415;-0.97620374673392851239;2.5533101632701318273;-0.36589557433344305215;-2.1447486792356365015;5.856775275643463452;-2.975704484199603872;-4.4822042957749799186;-4.4336556023258681947];
LW2_1 = [0.47362207426025182411 -0.97423909190602542285 -2.9462160582239493856 1.682855606051854247 -0.51675811039780683576 0.140948351771396585 -0.17719558276079927506 1.0674797395554578294 -0.022334633017608816752 -0.15412757554152883843 0.035854385513990089107 1.2304274675378248372 -0.44927085970107510926 -3.3025076801654211778 1.1092539502062774837 1.4142023825553049488 -1.1085589871791232675 1.5145582588004664615 -1.3183976000302264353 1.0286736298615843932;2.291739739857105107 1.3299093616250763361 2.1450713206067741901 -1.3243832965160855508 3.3614351438115788184 2.3829604853537533771 1.4040812662154997792 -3.1074669249025661522 4.7228666903634923813 0.050571468849768583254 -2.5351082276429872664 0.43816228322836364706 3.602450358553924481 3.0620930883169430459 -1.9738202850755217632 -1.0211643996873887019 0.59366638296802276553 -1.53829374717054157 -0.33002591380656265407 -3.5289678260748678085;3.1404031105441694294 -2.6323479942551690769 -3.3911014272729365082 1.8138129827372444502 0.15525139395147394272 0.33949092371690059444 -0.029314155428665743253 1.7926658371159278627 -0.0051033264208028500733 -1.6544348849110479538 0.49487110702784009586 0.21045710589519422973 -2.0261698593354648956 -1.3358909863608079416 1.0582968611016005944 0.11112607832049563317 -1.5551064359350292854 3.6515334281553073481 -0.35444298432897280993 -0.6303339279457146338;3.5382081287126361246 4.9331592629615830248 -4.3965008229357414038 0.38757042838514110805 -0.383425809820713559 -1.3959715640961785077 2.4557907464676196341 -0.95634219846124590703 1.9059086756189160816 0.86387291565711199492 -0.096297128682772945019 -3.7638274685496591054 3.7620051318999387924 -1.1957423089800829352 -0.59239051703326028875 -0.316768008806887158 -0.48297468166292689684 -1.0446799126745172082 3.1070988260768581668 -0.1844163172813901852;3.278077298377731541 -0.05090793442013891168 3.2402705365471446974 -1.1849802907670483609 1.1571481094492901409 -0.43865457586766037901 -3.7810106703178596455 -1.7330007276726537846 0.5121185137169923518 -0.29307103635632059113 -0.084089686147230544022 -1.2133261638637207191 -2.754645064987847114 1.2992894711973697053 -2.3401715948262014066 4.2425323410581228245 -0.97101511873251578066 -0.56178139231736701209 1.7758354135836338372 -0.91085850282367186725;-1.7572518249385939981 0.61179738580244436008 -5.6678580487288598988 -0.97534825042147355045 0.099555252050348513881 1.8966159339899197889 -0.25978460643681539066 1.6896487200481562496 -1.138221678676802906 0.48297150524848930786 0.13127955936568383444 1.1664126661914451244 -1.2308970607776241746 -3.55448522952501067 -1.7416490820769878756 -1.4632524910016109221 -0.12470374299498707127 -0.12972826741499368652 -1.7863265279433842014 1.484742519925814852;-0.01132072422145355417 -0.90941794740161430166 -4.9771008652740720279 -1.3658366319093109276 -1.1994005527498949881 1.6378336500030052925 -0.32408054087124466003 -0.48959468581080961558 0.018336164134265031667 -0.91270164211679560839 -0.2009604331672924793 0.70583035245453540352 0.83780884537162514381 -1.9145824543450691291 0.4354897976693910544 1.900637310924399026 0.5377435498310293438 0.31545442223815134408 0.60355875257121194277 3.3309572566016028006;0.21828462226497383214 0.31917051280026303983 0.9800452971803652602 0.46712177342214211695 0.2751294727058076206 -0.32135740671092677401 -0.14600104693694565539 0.28736817867350927802 -0.66582910530124816972 -0.48433900612949498665 0.10587641947860347569 0.67313879152396016714 0.78675809408813290879 -0.22168321994089568161 0.39205733875908654884 0.088009927152240971515 -1.4075272516581591731 1.7557703136857933934 1.0387321708880683513 -1.0957685635589831108;-1.542037831806418513 1.1576665913652188777 1.4159076982034037862 1.3995605065348282192 -0.19967196458746250265 -0.47778027489952046292 -0.19748691870706466811 -0.49601047849129492606 -0.63683135625998199547 0.22477219164949166497 1.4238508043142479309 2.1822264247338969412 1.8196438900750822043 -1.3213992814702666401 0.52728817169356645422 -0.25898914452442517442 -0.55583582488351779283 -2.457911320501608099 0.055043265563652049588 -0.15972888093274895116;0.50890166109936973982 -0.82250041272756202471 1.5727387892625499521 -0.64052291821817985973 0.061017301405701440675 0.5281535163324648785 -0.4416485145591847461 0.24844369609553898504 -1.1348633259888711855 -0.70548522341230202048 -0.75130823692203352326 0.51957028746585731671 -0.56647556059551640306 1.0471540861691714941 1.0118325516029322841 0.66087977383376372842 0.26691376032632335713 -1.4321015024847827402 0.72654840501063489011 0.89464285022211331722;0.33210608415873599242 -0.017470063073362740447 0.44794766878321684578 -0.92952923119801200702 -0.15833589918020340992 0.5093647386626728446 -0.44375926419962313796 3.1556177532224842786 -0.49738981492651423988 -1.9666972853771191865 0.6136050452466205174 -0.96606094151897348166 0.78398546992081741269 1.4226622270018218774 -2.1582970095829785429 -1.2560597581634669329 -1.4595629437013515339 2.3866355041159192929 -1.0574200622355178769 -1.6702646520204349478;-0.077915120558772310577 3.5601618688798724044 2.7688507660252259512 -4.7669882008926043326 0.14537433184322906543 -0.48990435326715919828 -0.62458765975354735289 -0.31702068879216793729 0.33242988734791917294 0.22449308792440228477 0.16102464256684015376 -0.61438746798793764103 3.3868170688979750693 3.1080776382077903719 -1.7935639454435001738 -1.137074517236629223 3.1509196269268957558 -2.4575661517547935375 2.7251548912014964543 1.1896125027042641076;1.1888770672191832922 -0.19950152793956438257 6.5390693461025470867 2.684540775773365695 0.49441696249592886891 -0.27942409492187647579 -0.32221182308562179575 0.35603311968781115038 -0.29664512876771265137 0.25355937855406773807 -0.097040246883059760874 0.70184923583438585393 4.2252106854675890446 6.5804690467914426222 0.15226682949947212276 -0.88127002812454979797 -3.9799302999597636621 -2.5091773228200620061 0.55500076522542107771 0.26075303716530695564;1.0472162436080121317 3.3938890383386577376 -3.3629628068310344347 -2.9884550940325196322 -1.2274307561116122312 -0.42843937467582565715 1.0521216909766277769 -1.9843780043558254533 0.2059653990428944037 1.2295714454779782532 0.89740351662491468776 0.81337721093824677521 -1.1503927163915022014 -0.98240225590559071556 -1.2857052315348533877 -0.73406229652347432246 1.298871502710319259 -0.063399156850117252548 -1.2870536877492930738 -3.9938230659828537483;-3.7053663040728745948 0.82163579014198517836 -0.47654977338749476834 -0.7188349805949104665 -0.26164430391173970625 0.22593765759869963161 -0.6263107790921440543 -0.98482063645080741843 -0.75947909438605210042 0.76577850109236944576 -0.53436365458102419446 0.26595526969233479475 -0.4498722031157997292 -3.9236345568910930837 -0.95833736226458121621 0.71072640958952970625 1.0178369557580888571 -3.1839876598083272086 -1.0399838281314630617 0.5269512501110973357;1.0483718549136040732 -2.3352877612500151372 1.2221656902680442247 2.2656130051820264626 0.61751641967692127988 0.27390071347908656607 0.15158206619203359877 -0.447207297995167119 -0.13309865479775170871 -0.089694668592772169857 -1.377977553058662874 -0.78737509587137555211 -1.2643806430328516921 1.6682264065479468496 -0.86943976836073522119 0.21706184982419116092 -1.4904185731457286757 1.613526355049363703 -0.077018602868947877438 0.42890626808370863055;0.14408210469426865896 -0.0240547019415533192 -0.66800880305686305416 1.1090796770967563667 0.94191516088375382143 -0.21114906785963760694 1.5516859516091374704 2.0648278295127604487 1.4015195244423330756 -0.15964330065906232048 0.15373848754879979039 0.13727845425713908201 1.1255490008500566024 1.7818496729174202464 -1.8761236331856299131 -5.5156903477740213404 0.54582416040349390762 2.722945659739826052 2.9730985099067064326 0.024969855314508133948;-1.0210814890339603433 -3.391614443394049605 2.3465098956301426725 -1.3438150106541906226 0.59703197681427655485 -0.39209569034076352523 -0.79755502549722778749 -1.6864727275152975317 -0.69725067810121243994 -0.70663028381589776394 -0.83661122691073586122 4.1162230848007785866 -1.3054426395133020833 -1.6809089054347885472 -2.4053860781797262725 0.016238356165893905181 -2.4037841685785386048 0.74179723212042025793 1.1091452260385261663 1.795022521560234452;0.39954010875086087839 -2.6637357047079408545 1.5803242903619227899 -0.30700670334958468644 -0.36412075034056395895 1.1464443300400732895 -1.3827880626506912076 1.2390663196961353432 -1.5584545537059648623 5.692227405004610219 -0.72263079585221945411 0.47467547351207167727 -1.7853653450708133477 1.7759970673574712041 -0.0086067480662330303476 1.5467559186783461644 -0.08206852351971169468 -0.044045128760100776821 1.2150499245230172995 0.54431239991280089274;-0.92815754380458326267 -0.29683984976274790935 -1.2927129636653742484 -0.80770790887384025236 -0.37746412860285499802 1.2682110608008687613 -0.39659227090058324361 1.5192336946084061822 -1.2615884270295782965 -0.20687065929578249412 -0.26458082796553566984 1.0618071256381036438 3.0115057491942356371 -3.054750590687319356 0.22339489477514778981 0.2326151305777702516 0.97437660298141626214 0.44708674554264343781 1.1288931523647263155 1.1960802833714903048];

% Layer 3
b3 = 0.23230872290231507904;
LW3_2 = [0.13448972554030916293 -0.76506050320655893948 0.1329350164852513283 0.049460228830891413143 0.087146754847584967374 0.075684192662492238979 -0.035238989687477288715 -0.10121121585742233473 -0.085648248153487857581 1.6343123089104973911 0.046854561088545604308 -0.068371966882100010388 0.064990465064678731855 -0.061527801487743220832 0.12665961210119014435 -0.14002217609864572867 0.20294646164469309912 0.048061716597244889815 -0.55436587121152114399 -0.68001048055672708159];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
