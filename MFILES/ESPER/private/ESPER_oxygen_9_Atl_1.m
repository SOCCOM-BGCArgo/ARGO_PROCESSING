function [Y,Xf,Af] = ESPER_oxygen_9_Atl_1(X,~,~)
%ESPER_OXYGEN_9_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:47.
% 
% [Y] = ESPER_oxygen_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.6309473696404559462;-2.2425553763473971003;-1.1374995340876032923;-6.7765713137297662882;0.43083543766344090109;2.8640993263691796322;-3.200802370703630384;4.9127401279186040384;-3.7816696603322714765;-4.1318029067992929626;4.0693978632492253666;-0.6240464350204709687;-4.5987907999371389067;5.4388099064322883436;-4.2001091052662946623;1.0877689114977509011;2.5120052657060552015;-0.65941628887273173731;2.6285890558027347197;5.1536183723329864748;-1.8344375540194972629;0.50480315268913922289;21.382595897553883901;-3.4809904696396398727;1.5143436772274836422;0.66328555333050598364;-0.767393866078744602;-4.0673746464601823192;-1.5289584184496929353;0.31237285420060073582;0.59352471023993647048;0.44576404309648393065;-3.5501598773670171028;-9.7741645586657330824;-0.5094234440727850588;-2.4562291328851295624;-1.2571194541801029576;-3.0029481351056199756;1.9199320655186149498;0.62022534841373233583];
IW1_1 = [0.1887020068104534043 -0.3995336816217593956 1.0616492906405665675 2.4071158785965272031 -4.1464090963182913541 -1.1723787105828029631 0.58458519187885227275 1.541555806091162939;-0.87166172928918073115 1.7356785777746703836 -2.3534004838658773018 -1.0117197892502240997 3.4992223934797652696 1.1752717377674906096 1.1162602260196741177 -2.1655103219849101137;1.1943112195641660822 -0.046917540869209170551 -0.39941825773082828555 1.1383416105947516961 -1.4960340726228178454 0.071850563754316254528 1.6757742459229592047 -0.7536823722210258536;1.4609373077913916372 -1.1155497522269837152 3.0826489449221314842 -1.7858911359440978739 -3.9412170536675605881 -5.2258921670561271355 1.4239940345339072714 -2.3239052477640571581;2.0024773493160723525 -4.0511500067843257966 2.987974357399137304 0.72779320456368601366 -7.0003007819344373885 1.8286674627700489904 1.7734229232421359068 -3.1372124650269679336;-0.069104062851050640504 -0.67780805743180749801 1.0966797705383910522 -0.078067685225493940737 -2.9375555686539791544 0.27388097740891992338 0.34281488477260674275 0.16991338318152987563;-1.2739237269542491582 1.7941055366080236322 1.9390636519992725528 1.6422666993768217925 1.7848126385685072481 -0.74015586096063856747 -0.1211596140895715018 -1.5637305880822849335;-0.38280693068428184311 0.84646692252801669643 -4.1146680115347162854 -0.25639135415053604383 -3.80533955992848405 -0.53976404572467484577 -0.29191844006736256123 -1.082576342492141741;1.3607522064950978713 2.7235899532435090542 -1.0066952268324262931 0.038346057193220151049 2.8917842776508799751 -0.89596223939018482252 -0.61735368128409051636 -2.4506720239466730504;2.9404766666010058174 -1.6499419667052679372 0.38590436028466007512 0.70221413392671072629 0.80697589310440620558 0.2181796415817504331 -0.16780811488266703102 -0.29264507252854943253;0.82168706332377083879 0.46357863690890743769 0.52979486533281550109 -1.3485398855020991338 -3.0085950425592598023 -0.014349612207824533061 -2.8203448136604483132 3.0814627518338530976;0.094989399364893450928 -0.18220881298364424716 -0.87794769909701186883 0.7301610586537010672 2.2712289710850712687 0.066944662261025342231 0.12779333789764199536 -0.11313374392055272621;2.2604987649553827112 1.6769441078007165657 0.94418960820682484858 0.11202338187351848497 2.7359692480462132202 -0.070212700949966427855 0.32591504696208040137 -0.36063543755285853987;-1.8388001936537565761 -1.0453605067792055561 -0.13531624021998692187 0.43315772488176335075 -5.7770120901789505652 1.23731580541210473 0.25927980863879279694 0.21748916778312554765;3.4278894638612213974 -2.0280493355921507259 0.41743010412040404411 0.70427125896714748432 0.26680014977137628263 0.23908553094142051543 -0.56937131860860734633 -0.0065232223124605179243;3.1909958058741576536 -0.1059466381841579069 6.2131153126801299535 0.52806479295326635981 -4.9427958958739024453 5.3005257356572386129 -1.2048816459964384329 -0.653993091155432138;-0.80331596692656348502 0.41927811122915903397 0.27457951606129599176 -0.065786716841086625984 -3.148602501471974513 1.8136355749102119894 0.55514992794247597363 -0.50793179510033581447;1.3950904861052018102 -0.35802037875797582123 1.3264752511202089202 0.26151458973772329086 -1.2778170781537045997 0.052928571926980673423 1.1707003145196213101 -2.3761832640735551792;1.1659930573191934489 -1.6762319464168387029 -1.4472506696392526404 -1.5078493524056968411 -1.1750900217614395071 0.77536477283755200762 -0.12733567959444780371 1.82468059978296826;-0.30430292004418835194 1.3160220222192311468 -0.43783015138293690516 -2.2000364114318160524 -7.6032584476217746072 -0.54350057992210720759 -2.6689385127612075266 1.6005862359209142021;2.7144533629583187384 -4.2851615535096101439 -3.719726449892586384 -0.80908901137243394164 -5.8144466122510163331 -2.5972116598012950917 0.090042594528647129648 0.54262336337911454276;1.4859987509016734375 0.13528266553536247296 1.6705092169112865097 0.21294630314781520797 -2.1779653226785233855 -0.067773805168718045944 0.99077731692088732984 -2.0456434258672717696;-2.0220203749621599165 0.56349231954081113738 1.2667038117150888343 -0.56736798931727294715 -27.078855995972428872 -0.42868897093353430794 -4.4180996781658379291 3.2997958004768199736;-0.75864422124117680823 -0.59671807120750974818 -0.44131213033255256573 1.2423261604153694737 2.3044891591648259954 0.24507176443691111589 2.5530364971828776177 -2.8057424232986205581;-0.47804709497897923676 0.86125008967712157748 -1.1999493982518647517 -2.009801913379253957 -4.4803616565052779563 0.28050630680594845767 0.45206321210707622882 -0.94637589313230863208;-1.9347943161830263303 -1.015789355772665159 -0.012539312333952310624 0.92163059167812722006 -3.7523729630104636357 1.0202679306391562175 1.612392538184143076 -2.3020818338012971616;1.9890469690907452982 -1.2051398510554924837 1.1352852896272107586 -0.33267909545727575304 -3.9460009434269904816 1.2927960093467976144 1.3939850768712409579 -0.27368366374396924101;-1.7569013114575096068 2.1116372386869053379 2.6455668670773904161 -2.6265510286128392892 6.6210390777280103691 -1.6911342968696085887 0.021394274296048353817 1.3346703861249276102;1.3176229062413442605 0.91235282058088451596 -5.7623140652361346525 0.61145397334708306847 5.1417845642736565992 -0.15202660543449086905 -0.012520964394275538312 -1.612523526410989394;-1.1500204753788567658 -0.41875158801247830409 1.3104050682361672031 -1.0512789110014593152 0.40355862707110906618 -0.42377032495882605012 1.3851677044512322734 -0.10688165121489487386;0.59443310956092043629 1.246024088122742457 -1.6652299266391212829 -0.18860765236768473052 1.6367770739726690277 -0.58191381103871797631 0.97051604966004167974 -1.1455119656409296081;-0.40844639961699580333 -0.46137007787667450032 0.15943637751227682231 -0.41667568320527514913 0.95636663445095415614 -0.59708868650120894284 -0.79245360872174708255 0.45197314477058048166;1.0365161373195919126 -0.694017834023413549 -0.63700853717018068867 0.33290278364258346633 0.82951918608664554355 0.86895510316761215286 0.51604982462193338399 -0.89435183565126219474;1.4558221861696793997 -1.5279312001858622594 -0.19011168800907934928 1.1896234429232352969 9.4215063907332616822 0.65661432458429902503 2.5906534107872460915 -3.0524510823989237096;0.65385291691988323137 1.5772963863421864961 -0.61134555265725898376 -0.59504990842240146343 -0.91540643616577310748 1.5584889502704188935 -5.0293583786756075327 3.1091596075127259091;1.701833890539164118 1.4819105894421469305 -2.9513726965513527034 -1.1451427986885018839 -1.8746222838080779383 -3.1311302383340100519 -0.039809032667498620017 -0.99075860428589213047;0.14284531808952852239 0.28048309140798205474 -0.43814025052931088178 -2.5578902880785148177 -3.7071747852713561322 2.8541589788916001957 -1.3615059845251245019 0.90520911717643148808;1.6230780818389471953 0.46006378783425466716 -1.0778233092867972598 0.65762967261298965749 0.057239913592858612801 0.32269370183468376601 -0.36786479236944702453 0.20682443190436475278;-1.1355699179452762859 0.89500080331426834501 0.63381138405292369864 -0.23558043544641363298 1.7005458206382506603 -0.65377617169561641486 -0.24080506008743862711 0.61183059056352639971;0.70433022824343805013 1.4694923800410595316 -1.6156532560237923946 -0.20383362524480888589 1.8990561078562291364 -0.50901336097504135125 0.75401244759853436328 -0.8286910344930058514];

% Layer 2
b2 = 1.4556753954584780164;
LW2_1 = [-0.18444673630854330204 -0.17340782250539496512 -0.77267125406908665486 -0.091432254731765222333 -0.068083372568623498622 -1.1193826537851823133 -1.3735194166130060278 0.398329547118424665 0.15041295665825024641 2.9504758662109051848 2.1817495883732398454 -1.1593622627236157552 -0.32095733800021597482 0.29686362570950930451 -2.1176439419534469621 -0.064383614148754153561 -0.51497702526310518145 0.65059148618152862209 -1.5186370907829811472 -0.16572262968797635274 0.10726943859702965656 -0.47006978918125064126 0.077176288940850198972 2.4414643846786310277 -0.33107224010287200633 0.40736388994065447777 -0.27478106818819281187 -0.17613752654472281112 -0.22011969750330773188 0.30298454849989397974 -3.7236731583891451436 -3.0927124968076662448 -5.4467005360041733653 -0.37229266037763009134 0.12864919534176350036 -0.12065613861575311128 -0.6768160806287728537 -1.2125824722642000175 -5.7410344351504152272 3.4356335101571331414];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
