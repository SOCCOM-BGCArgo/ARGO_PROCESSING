function [Y,Xf,Af] = ESPER_nitrate_11_Other_3(X,~,~)
%ESPER_NITRATE_11_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_11_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.6727115531757164035;-1.8646861485508785528;-1.4665060578707209693;-1.1794073926160342225;-2.573142090917114988;-5.2812984396515911811;-2.7793908131170432796;-3.5817856547928714761;-5.128833880258452993;-1.6385759237835142432;-5.182808365821147234;0.72468737508823477533;1.3537170714535891047;-0.87572324765604914187;1.7650575799377516972;-0.074896889154144899448;-1.3783405164993325354;0.45608890516696426465;-2.1010239348817183469;2.0852093723696776273;1.3528082957283411591;1.7634380583467570425;4.435388165654363668;-2.2347738243262602609;1.7015599900964970548];
IW1_1 = [0.065123298591142589342 0.099984176618811190784 2.1599660118728731817 -0.12247940744694502113 -1.6151765155972064303 -0.63715808667298889922 0.81946422643289329457;-0.13766480263909275372 -0.084166737764630905616 -2.3719931975475772035 -0.059607889081111600782 -1.1369593600746448203 0.056086654377727758469 -0.56331371042238276292;-0.11654945568642553766 -0.10231309172999482338 1.0326302126605337861 -1.7099240561158159935 -2.4930906423876719735 -0.12366265945875279386 -0.21955835826477385075;0.46234261599777093377 0.0564656253873593722 -1.3109220253190765337 0.38722215502819518074 -1.1738713430149694261 1.1494759165440888715 -0.55865821057623832324;1.9825766218033555877 0.41261654177651235775 -0.73428780544724026047 -0.1128214119139792776 5.3416222435910825084 -0.072086927983043169732 0.26787195077719944125;0.16185672730715047751 -0.37003858357105023913 0.4479341356511025718 -2.3402375208860486389 3.7766558949161015413 1.9173161973411212422 -1.5000127805477190268;0.076717769888176162718 0.30487721756717545141 -2.9034620233444439208 0.29607459059766605414 2.0746930055367962531 -4.4796819638112754802 -0.55380205527394965603;0.4916323142233148813 -1.4535546788441875421 -2.2163219974354455566 -0.64830095039975399462 -0.85831829486165556187 -0.24644788394104261142 -0.28002936532534788983;-0.66234896855945601946 -0.24136150296675468185 -1.0719041987117210457 -2.8889028237493157292 3.1208785151018609838 -1.8569662559856370265 0.30296938479516194453;3.3821988227563690721 -0.94571304907887476787 0.061738362024409430828 -0.15392716665834177414 0.71605092452309837547 0.67442305646415645626 0.082804691101313332435;0.14975329034661008509 -0.28854281651328189673 0.94165460970516257078 -0.96910831303266453673 0.12338769514297635854 0.53187430021352211096 -3.8382246819456589115;0.062297068355535577255 -0.035662380490958163481 0.35942271090830502089 0.4000347204858143435 -0.51141818930620019934 0.30659326750916909843 1.0258992914097606608;0.64959911368806344534 0.46435403258749280431 3.3303036976447142337 -0.89430690564324055725 -1.3681107409131039176 -0.91229032806982457426 2.1104885113533193852;0.15390193635597762545 0.023120505138023710046 -2.2240112864192296271 0.43198375875576244809 -0.44061027259621848851 1.137950601289790642 -0.50154472628933211009;3.7996275575099938138 -3.4338570278519653378 1.536198412029989635 -1.0027925102312940098 -0.52341190680727744944 -1.6277425132608196456 3.1369442721943006092;-0.34142297036380264696 0.10927990604406345732 3.4558528635521383876 -0.77479328096498667477 5.2800630821924965375 -0.060803769839052883295 -2.9334265644648294113;-0.39723502559222723107 -0.16892542824428996573 0.84330030526907517885 -0.54598551367548642244 -1.3631383232076534906 0.76809078117295792598 -0.58872676516689759207;-0.3078972035251532624 -0.082335198833937459084 1.0493398128061453001 -0.067016436821992583783 -1.6331840911350585799 0.29003940975459557849 0.82404163224976145763;-0.4474328483429800829 0.45482522301955741195 1.4788619472958952628 -0.11728747953074460109 -2.587077374602746449 0.51642756303258574579 0.65695312296993269019;0.48591299918591263074 0.34613062985784553982 -2.3609596445077611904 -0.26020930641011386086 -0.026547916429645462832 -0.83592072186009080959 0.48533769134689469515;0.68466077318216234104 1.6745353889601219954 3.665951127097999418 -1.1213282998185369888 7.7349837024347376513 -1.8157325281887297663 -2.4494696100142694384;0.34559544647721723853 -0.14679443650979451252 -1.6104953428510104807 0.079202998294633258913 2.3688165215629695126 -0.28200944457852328284 -0.28525282324542894363;0.67114052566151116697 -0.11962525654452016433 -1.1569233084343439888 1.1143714176339865052 0.96874939032639140191 3.1322945583791255153 0.93177615195818352944;-0.17559663785214255083 0.080248440275078408712 0.15633325835883732369 -0.72177137093407195412 -1.1736185506160978775 -0.89097325413789152382 0.30529727380320670349;0.19490272580872072816 0.16295667124572785212 0.858086575518444028 0.54704480144206679704 -0.77903621165158265516 -0.59715004368459023709 1.0987710738087645979];

% Layer 2
b2 = [-7.3876177249613625975;-0.45684613223928732806;5.1714220773330179526;-11.743548091343374296;-5.4351387632438745712;5.4922180143150205467;0.80405713949115342754;3.2253975389984770317;-2.954007089480360726;6.8272025733195862429;3.6874432826243399575;-8.4108070527392051474;-12.481623695444204358;-5.6325738624075905037;2.2456457934950169175];
LW2_1 = [-1.8434831682369290373 -1.7993857408577511592 2.9669522706340947238 -1.1682127311274852488 0.46682441206089003716 1.6624270868917510047 0.1028683773384179434 0.25070241760141975806 -0.93971836158777255488 -0.039212560281383923577 -4.4357712128978850075 1.1568219195816069611 0.23309043221399453061 0.24674684640767813315 -0.011184616485142224659 -0.48963936950177866514 -0.63884969910342515043 -1.9199975212364146504 2.0892887018914483299 -0.59892542422718386685 0.30508660073957333259 2.6329367518173363294 -0.012809132926128348473 -3.0615707865184895731 -0.20524680414911952719;1.5912852198847668994 -0.12775149309056216262 1.4138060031898320723 -0.42719153165571921438 0.50320147467215081694 1.2305088073430672235 -1.2943025082561043781 0.079765953911629758344 0.73731703160060280133 -0.41933283048883929212 0.51490504344400567227 1.0655450760431239843 -0.33594371289959701343 0.30504699942928303891 0.12042910625408786984 -0.31462347955537456334 2.2225617872829284138 -2.878016808904306334 0.69207625774589986989 0.21587564595766850495 0.57144269842152861649 1.6391750421703425999 -0.48402949831237163103 1.0698518823317861859 1.2476046136587561897;1.2745035653296752365 2.1671728908865017793 -0.76292439026255454149 1.2528544486122072943 1.4768449175099733761 -0.26196226224967072982 -0.17971463553681815695 0.50883220772123005649 3.2062039145315712751 -0.26820985778205191918 3.0434880760921063647 -0.69165969835521512454 -0.22697444482288761658 -0.38996402784089301274 0.073649574063596401352 -0.23307803630666387718 1.5942995075681078987 1.8392713730355034762 1.4393751671525680802 2.0743997000262703878 0.1884747689420258332 -0.024587469596558088336 -0.057598024101274465647 -2.4695812261932474918 1.8832698397442730887;-3.3250128883976777239 9.3813384299117164034 2.1537253730402623475 1.4320674229037801961 -2.7988548821812959666 -14.015619837094877909 -1.9293665461478302081 -1.0488309217387030703 -1.1612867520584198022 1.0534908031712493237 2.4904965522248438958 6.6818286917323073126 1.27409085316266113 -14.718498499051102968 -0.42722771342224741264 -3.8227352120080277942 6.2167846300390303682 -10.116306210996707904 1.8157127438776921036 2.7498026329647693444 0.030092814657986795973 2.7551621397113530421 -2.411897952686646196 1.697370316571979787 0.28897937372043569493;0.21585640378850029508 -0.93952700622770701777 1.4012418511695592382 -0.56367300330956271459 0.30026340972585341405 0.42425386768345085819 -0.015590509738694366751 0.070715837809692941307 -0.99840336643270088945 -0.0098621476456543788469 -2.4790841751864056697 -0.29869130259555765061 0.37902816386884008448 -0.16924504278319221773 -0.048661634605928150155 -0.58280384879336821768 -1.8484405562167121051 -0.037913115557669518907 -1.763841127568519962 -0.76639719706907849517 0.24388763179404171488 -3.2982267248472791898 -0.39007658610668760613 -3.6805198584652982774 -1.9256901735991240887;-0.50330421925381629844 1.0141951492942711255 -1.4070789406687913559 0.59156656738508606175 -0.37608622084280196596 -0.51274624720592165694 0.074267546884645679883 0.082263078962877392297 0.78799354915281571987 0.016529688789583146108 2.4495821160853954446 0.25439279706199047215 -0.35230099609886583734 0.057194687429490041752 0.043284614832074734536 0.57940032394846341379 1.8592520066350550767 -0.029006228915393953566 1.73537440953532629 0.83190603092812687169 -0.24017640456630487411 3.1970790251774907631 0.42244081206394401562 3.60517677977194273 1.927266954341597005;-0.080452750439414785766 -0.16460217107929697722 -0.81340093062684781788 -0.50765416216347092337 -0.9493578228886048187 -0.99520661925967202066 0.016202253832212999696 0.082220517817018903828 3.8376536497238333823 0.26506130504039543405 0.15909761026325006106 -0.28486853822336161146 -0.023389528428625686735 -0.015846108332961707926 -0.011938532044978836591 0.13845794008500336703 0.97246303240802711709 -1.7708663314694215174 0.82048975774825949614 0.97882947387830498975 -0.066439135257469028595 0.42416219434795537913 -0.10724917030664248008 -2.4186856843391706384 0.76945379778610223376;0.37758487490227943262 -0.0095413471797729590418 0.2304300834038273682 0.0022349320167549553001 -0.34040742331559808997 0.055344416098059588671 0.1891062056006500014 -0.1248513653822122399 4.6773089428430179026 0.11953103319654237446 0.18196510253169612126 -0.024485827178328617437 0.031754123461239930348 -0.022944723421461778873 -0.03872289608873275002 0.0078821166371052589494 -0.31013685818202618716 -0.20263883036943858285 1.0854790841329504669 0.56519312820508516015 0.014386652500599955359 0.09786698530926515871 -0.50959418173961268383 -2.3743625888485624387 -0.93262575005094872083;2.7785601693672417056 1.1653903789381796496 2.2748755050695375068 -1.2068985306824620007 -1.9873497006497358175 1.0482525192643101786 -0.21645746719146577441 0.38084778566284782642 -0.89041748479200244493 -0.065517890981921456106 0.88023825142702571966 -2.3842703493919858992 0.058677933585621025459 7.279337343289807194 0.40127205598167514644 -2.058146239277754308 8.8130951691340673193 -1.6666338627918511062 4.7471527746196722219 -0.044684444772860890116 0.43072041394609250631 7.6925305535291466086 -1.1151145197241960627 1.0995182972907466823 5.847575492209239556;2.0614831746746498098 1.7718445342764617134 -2.9395111095932562328 0.16253216352959301561 -0.84247965551212711244 -1.2943840600925105022 -0.10755464688799307171 -0.55498817836114433533 1.7377035883968987573 0.12425694509930883258 4.1758980500541165171 -1.3032415263297709718 -0.72356267972790744292 0.84067185990418746844 0.012577165730848646752 0.67492552892013502053 0.66488465757435344372 1.8993395113618551928 -2.0139655444244106697 0.53753504591020340175 -0.33634859143550016602 -2.358484113980320096 0.42655303646076547786 2.6312477083294871782 0.62256763344454257858;-3.1247537730690115865 -1.5843420835307673311 -2.5124161663217328133 -6.0093238286883554622 -1.5015326861093833966 0.37015406012991358686 -0.66685501558246507159 -0.59821797676045707082 0.75423659455021940801 0.43373588304383370318 0.89640601044162526723 8.3411728032482379547 -1.7014210214415812494 5.3743656001643556053 0.10796753912842595169 -2.7092125883226123584 7.9224108188449324786 -6.0186021490957575253 -9.2739736083781494358 -0.069223192937642091804 0.57612970559607423748 -1.9396480796933137647 0.45848508727300230081 4.6316483999095181545 9.2825497652774728863;6.9096238516465007251 2.004987498256492362 -1.3867976496073917136 -3.2837210868498303284 -0.19667519886922962824 1.1779010064458346196 0.066680959469907291615 0.44486922931222477873 -1.7124713749350719549 0.51930106085759963896 -1.6359945703199614275 0.37460018176064580064 0.62960142210680736241 3.3931539600644704535 -0.3541645557223980223 -0.86108236165777674032 -6.2614090445505148352 4.2430960264231627477 -4.1820465083544791085 1.5267764727388219992 -1.6374274526690482112 -9.0990754599301162386 -0.69749225967300221285 -10.47711958137214161 -5.7275223000982187216;0.99612788676114316644 0.21425025987281859363 -0.03711850867585056446 -0.32438408577226141016 -0.30274085685192297923 -0.8875874096755301812 0.092163374837576320098 -0.021913613495191233693 -2.2244551097472893275 0.12831813866509594879 -1.4459279925535670763 0.084296353234843829361 0.023507392211055921222 -0.38388643259191784773 -0.047152254619864615581 -0.14812670857650622747 -0.099529645311163636445 -1.3767198047989408494 -3.6962707726164762967 1.6800364272078309735 0.015067710577993290166 -5.3973651793553916178 -0.75089833636977121323 -6.7305093070435981772 -1.2752979474550751871;0.14497762304522518462 0.10670898689847622964 -0.7285200201508418294 0.20100215798527235056 -0.18735206704996976157 -0.67207671871969487665 -0.10609912736755716667 -0.042236503223702114018 -4.1234331958021863684 0.068868637235549867714 -0.66240107490490129916 0.22234962909706995626 -0.011972248270714897986 0.1378804846276998064 0.038025824749436450134 0.12071263495242634534 1.1397188890852099075 -0.68952350143746043987 -0.49899643768185936166 -0.12192510647561925763 -0.12930386626121004312 0.51522134303183431125 0.30441389409468572191 0.44906756444244760873 0.96329486831238386735;1.8446542827633143347 1.3099062578176419169 0.037950901059890074229 2.6630780452943016989 1.1228182691990973296 -0.68512049165089672353 0.17535164322601481945 0.47716522197974708952 -2.5682873664737191355 -0.30081791108003608226 4.1578635028780661642 -0.78215419083607229389 0.33951415076177060559 -1.3979367315766533242 -0.030940234547265989956 -0.44042654749459597685 0.66313627814503262048 0.16667329651911247379 -5.3089708335013066076 2.0358905182115898391 0.16061906263865358135 -9.0432291136132985088 -0.083761144889364827493 -1.2952619404232341704 -0.16964811523657141734];

% Layer 3
b3 = -7.8016641837938509596;
LW3_2 = [-3.3011146930768897612 0.74652118574637194026 0.28311440270765309002 -0.17689256287203336537 7.9139995845829540499 7.7131045892087488625 -1.1214858347262814942 1.5195527606357430717 -0.10305608366084037519 -3.2221990983806141351 0.241752506882718321 0.37926026800205425715 -8.3823164353518304637 1.523609617579678055 -0.38307436643974246415];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
