function [Y,Xf,Af] = ESPER_TA_6_Other_2(X,~,~)
%ESPER_TA_6_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_6_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2120298226866479396;-0.5393699603132721121;2.0487835064723873835;0.12783207355305872821;-2.4199370204818135832;-1.3484013696626331313;6.4945639365610210447;-1.2370983472317025331;1.1591314192971198249;-2.1803017680756928698;-1.7107754543830488991;0.99313867699029778624;-1.6765961979711467844;0.79278295988813896056;-0.56697508205696300898;0.54757623389411047565;-0.54262506072075677999;-2.0419797324623334411;1.3124421593830168931;3.7236932704937486527];
IW1_1 = [-0.35878528539781212592 -0.92777323983069170943 2.450875833302994522 -0.51623024269862571867 3.8739859814045347619 0.064412646706771048422 -1.3439235610652271458;-0.2280475053256601492 -0.14950808774328477879 -0.56821639348104147071 0.067340328936458651587 -0.83018893962807638331 -0.45126155877079160428 -0.74660123338433903584;-0.32113575971814922738 -0.055789068381976288091 0.53047360429779655266 0.47438358968366667323 -0.34839277825012709977 2.4134617141831982146 0.10311269460067215564;0.22521552845425152345 0.027653542186639481354 0.62694895921085946888 -0.29418945122809325721 0.25884309805345839806 0.9458312154073031941 1.2914527517786007493;0.45098499592364638122 0.063005418510808958166 -0.5522243388111569562 -0.53461832609306847441 0.62828210992550881375 -3.1931634888528384053 -0.2934302640984658983;0.22189324462242343561 0.060359459031969091292 -0.76418740856791878002 -0.041452120952442134127 -2.2736414723944906591 -0.67644210934781101585 0.60316094810436826634;-0.20181647178281669763 0.19935909822648098522 1.1458379473866397991 -0.61730938449345895691 -7.0561877644784081198 5.0310019627489692695 -0.64570649533789359342;0.33523122053155995914 0.34852284435141611674 -0.24610044370561581784 -0.074619468499801000494 0.42562715974294668131 -1.4115997183055084552 -0.65125814388576064307;-0.40702115125620830227 -0.38031954252373373349 0.51307326117166873747 0.057987337852181644604 -0.14163655940517744236 1.4890911967803035498 0.70608336837268492747;0.2110746509595141096 0.33142279300110510931 -0.12800373107029022757 0.21124947756395948129 -0.047134944532090501668 -1.5696847385687076049 0.2389708836760588706;0.43258057634345303821 0.20545223102287496486 0.25991598534526344499 0.060170999374464045895 0.20922216014096958747 -0.53066316130915502924 -0.13739392774579264889;-0.36744007284352092624 -0.38870378263375859884 0.58210867381126429887 0.026331686485222851463 -0.086003364102732321461 1.4754130614396347987 0.56813694040018369869;-0.082989406593661940725 0.012489716371647049606 0.80299264365355371709 0.031628249160819722763 0.43409779081303673243 -0.081718343026319847922 -0.19362427760666947596;0.20842725159534855606 0.0012628861594081448438 0.27157636844684912569 -0.25899788446450522361 0.50973152462519299988 0.92010469081823464954 0.83616944451837482699;-0.019769234406902102402 0.032500414812124005237 0.031433421392463162247 0.21223151671757281567 0.77129282688438616233 0.10978323656034309763 -0.041987852230455612046;0.41259120827228112915 0.30480915412544934417 1.1469781003772396843 0.074754247846302329661 1.3874377306865586235 0.33550441288682192331 0.74666607678545338089;-0.19760074496452928461 -0.061826624147545396204 -0.32045440553110743354 0.33898731861402114918 -0.46167803797902601248 0.59795129269172919706 -0.30638531639066646228;-0.13461688590293052759 -0.033808336154894778891 0.17090726053745752822 0.36087388635997252884 0.23544893429683994013 -1.0803063561665156023 0.19986066837593091661;0.25204674137226351638 0.28808781737301142334 -0.032240642404256850129 -0.143979791921497291 0.21849667757009305635 0.58969799813440249014 -0.0066654033892582197074;-0.66978940223159755263 -1.1388884912799310811 -1.674984047483747851 -0.49873182101213442419 4.3868696893313616769 1.9786776935016636703 -1.2781591287338645024];

% Layer 2
b2 = [-13.046699796562331031;-16.223902925708653555;-13.805226703890575379;-1.9679725353813153355;-2.6588865710656941488;23.988013523304076102;-6.5742153206847575575;0.25524715367753258999;1.8475040295470293028;6.740525981174177339;-8.8661760811356593592;48.846180422803939791;25.217006961895794603;3.223043389416935689;-2.089223240208953225;-3.8964476830108143446;-6.3636936778028569961;-5.8419514345553444912;-4.1718072067446740903;-16.269965512236858274];
LW2_1 = [0.51434227221420636411 -4.8893157269343241467 -2.2340336300347227727 -0.86496368171889415066 -2.713728181249428939 0.62406569809637402191 0.42264332382514530062 -5.7643249010563444301 -1.2376025819662672678 -0.27953012526767617718 -3.1891219109900830198 -3.7951138965322064323 -10.12881362225841464 -0.62741683157723782127 3.2522025917876642431 -2.3049613358505531835 0.69944154250493262293 -1.8139758775797194534 -1.6532024206343824968 -0.79408428081803661414;-9.0165429813763164901 26.565257152837308041 54.35150429085014423 4.5284101460799526251 49.437148188662440873 -9.8581360660498091875 -2.5870269728877461901 35.29601880052872076 31.64476595873211906 8.0696980953520220936 25.329177554282154006 4.3292375318440763365 -37.845608293934418498 21.468693262845143011 -3.3937248257071876978 21.381009709442601263 -9.0773107630112157551 4.8678703718426454827 15.8856478229445095 -15.948822136231342483;8.1770442502875440027 -5.7450351887589006239 -13.969105385345661929 2.4337617990745363805 -5.8758875579906950648 12.744581673126049282 1.7233055065747646672 2.2708310738066912471 6.0363918404913041726 -6.1675044427066865182 -7.1775851332805338245 3.9463526621709839048 -14.387485705396169777 -8.2083483578912694867 2.3984680792149077888 -0.069098453390428804521 5.0077783005567546581 4.1958916792477793933 15.493864173336730161 -10.526613390146071225;1.7640090994555248649 -2.718388404023347249 7.3996725957258204787 3.6923075774025941875 4.0221966233067698582 6.4857709414074404819 -1.3485290345045639615 0.12504149143398948785 -14.075755098489354467 -2.0975454534609925261 -13.579070364846895558 8.038551489249803339 3.5597535832558651059 -5.1765055515165769862 0.24141471980360618144 -2.7304121738893094573 1.0902226712165570266 -2.825011644451323356 1.720867795190454963 -1.0144611105226231107;-0.13814348550771196611 -4.7975661442461596806 8.8678617224677793729 -2.2044755851532875646 8.2236906973853169944 -1.0966347049815707848 0.38760611704267372568 -7.4337805849297700078 -12.929758599585998269 1.1143377282670789974 9.1575835173014628054 8.2710867664795326704 7.7167243793545132746 -0.079835218023501089424 -6.4432310225815845328 -2.4242105226715269239 -2.0923683782418471822 0.84357321650168082261 5.1346974389459330013 6.954774772265282401;-3.6102856867145431963 -2.1553327754998132804 -6.1827874877395272435 1.6623749481272427353 -6.0286617937854822813 -0.58522181767545999875 -18.607976678786492641 27.885730870051595787 22.502380616980648398 14.379005552519235067 -0.083815137845899612135 -2.2578009635608511374 1.770597380772627405 3.6443836758288035149 -2.6787347614621692671 -4.7434017621391166841 2.4011508443717257677 -15.87616459367032995 -3.4765160315767436039 5.6734911962695342424;-21.571179445006773534 23.871169230888035884 -24.511948060197866539 6.8859912587589606758 -6.0263688593764923596 -43.83180883227127822 5.1562727695790551152 -7.9425877263001423145 14.182417028833098627 -9.2837058484328682795 82.446770871800978853 9.9472951724996239165 -46.439492899417480487 -17.852816490724055853 20.947599261084118183 2.9900717844791149247 -54.467157666410308536 2.7143713139731433515 -0.84187443170399689496 -7.3030078429529936557;-2.91475394928385656 -38.97502526680923296 30.142178506981171182 18.204727524344090028 6.3064001120751091989 23.855266494682769718 15.148950081184230143 29.740678777258043652 22.316208599181745598 -4.7362803126675663279 14.104471107282725129 6.090608908143640754 -12.469282567604800249 6.701840168596103986 -3.959937625255902649 25.571327486224600278 16.050327891548938908 7.9573913510023475126 6.2072588622198452413 4.5353035204922829138;-0.79431041947734370989 8.8232590428489778844 8.4639178364137954702 -1.8424705307399420473 6.0874219320905282871 4.9319601559031145399 -2.8576379100913835707 -2.6485733817289758285 0.091496664435718036423 11.597534771105864948 4.4198740848303756934 2.8908000201957966269 6.9057253202181687612 -3.1697780224387854808 3.1229408456492926405 5.6940443184035123281 -8.4516778411470809829 11.494480245397769025 19.612590188425688353 16.727094441784799983;0.59825103905132370752 3.474326043167473177 -8.3300153679610549062 2.903166877230323184 -5.6983924465178086294 -1.8938034906025598136 -5.1986212848937691788 -1.5500293324528764405 -2.0021760378039821227 0.90506462849358892964 -9.5519203163176076288 -0.54525008773419769703 -2.1598503826194126454 1.0322445993172026935 13.962130186606486859 -1.6054800191962481648 -1.4954876706004502918 4.6673833435274127979 2.9440746418390539851 -0.76990808174478009285;-0.60683519674050834247 -12.185235696173275954 3.9566770503813013526 -3.2769270805107137967 4.0864261433289499337 -0.050706593581714830277 -1.4368203135026542672 1.2654199730522193157 13.285314519264783684 5.2361807760762397734 -2.6029749527924512797 -5.7262769871648515618 4.3497455644629043903 2.7017979643329530504 -1.0370845761666964702 -4.2867710746086133966 0.52566721220729917263 -4.265953515040572519 -2.8311109647724705951 2.921903654487944646;0.98796958910092125272 1.8267081585849151981 -0.10944293967714853466 -8.6953026312196275427 1.6153238399798819369 9.7610770631210641568 3.761316979947641137 -8.185939671996516509 -2.5381044355872419693 -0.5424767112657962187 0.45758916294476498221 -5.1110718754949369114 23.297773102324288885 20.902787666623869001 4.3947215832890842435 -0.93120434659809470102 39.34960430165948253 -7.4874926178957785794 0.25939932262297210608 -0.66171645020610225796;1.5069813328005425834 -8.123557826943656579 -6.2453604704722476271 0.1319722210655376593 -6.8978020615480248878 5.1756361802009172024 -0.28146096371128453972 -17.398781920506728227 -18.785208788749130804 8.9525445896939324086 9.6733378671413632333 3.4005238088532916407 21.000863639325579868 -7.0691722216835293224 -10.211306797244731115 -1.9563383961594913441 0.6745455611598961676 -18.667778378276473461 -8.2346251956415983386 -2.3525616758269491946;-0.14079696848147513211 2.0082902841721068654 1.1631339959636395331 -0.2451533621308333577 1.6897058412441405828 -0.69392357887246602921 -0.015654816519332766245 -1.8349468277473026667 -5.5133634024192730294 -0.13002992769423604713 -0.057436321628295622377 3.6912274645613720736 4.1490499707098029702 1.769550247271909349 -0.40147678009429710322 0.95845445693512176799 -1.0688218832693192617 3.7755182619424609847 2.3622609478197649224 0.47780156950278113159;0.30830953948275813259 -4.5947181625802278049 2.5013986499716045486 -1.2363175911724868516 4.5399002296642905208 -0.63304480633082771401 -0.85320467212174033733 -6.4125264405578903393 -15.51138656907409441 -0.84175421392655735975 -3.6792751870305715478 12.144703975760306136 7.1879993154278976064 -3.8043602826333420275 -3.2562202965055693227 -0.24676026935773648363 -1.845380549082915822 6.2829255588669594701 7.3953735365968080728 0.44553829267681294146;0.26719349116190255211 -3.2309257997446465538 1.1606096127294625031 -2.283888903744067278 0.4413302659527904015 2.7062345067097508533 1.7720630739083611527 -11.840444990779911194 -15.198843118277730824 6.5555375816695962143 -6.4173012002713516466 3.4798459539997947942 2.0943492319897023535 1.8173235693268283697 -0.24684347119707614193 -0.058025891445580075889 2.5632349649755177268 -13.225894864588152444 -10.627780932702584948 0.97458800038272908051;-0.66718801770802327322 -6.9407748316463964144 -2.1112854267186622614 -6.1011083889957236082 -0.18951802629908384712 -5.1226671469173217233 0.8285544077263403695 -20.237273324761957838 -14.960676911748164386 9.5522957868767903733 13.051527221437195792 0.29748864731018220819 2.8123494483879643013 2.2916007573270595898 -12.12934216489260919 -0.062974971663123199828 4.3036603184046429149 -21.898114385719065211 -11.991372382421589649 -1.2123744932924744866;0.75230514996551645091 3.9562810543088144932 12.665890971781044172 3.4082744731352199175 11.474663396367287049 -1.4648672471049495325 -2.1511467239667321216 4.1958037141596902231 18.598190817338473124 9.6487700733760135563 -4.069116314614729113 -12.346645687562775251 16.997302130094965378 -0.99439326576241293676 2.7989149165072455538 -4.1229505790205145388 -5.0586423772978150737 -13.327800889412548813 8.5492523559245761078 5.3048595031603795746;0.21266273734184198974 -7.771093041996695483 1.6382162250945306869 0.70099973703183360296 -1.2387862908088662639 2.0561044596411561791 0.52342790584306264634 6.1102984593353921738 10.510290149932366432 0.041879582997806343025 1.6451841574676864255 -7.7096444490225746193 2.3979496867154632689 -2.5590893146494311239 -5.244374588527334069 -4.1306884874902536353 2.8292626293206231125 -5.0128245868057774715 1.3732455497993245608 2.2790467542032923909;4.4578500121972668424 -3.2670664242731843885 -2.2582568377760448008 -0.41616591932627450268 -5.4141502277099755602 -6.9299798102952134826 -3.7033326523849594558 -3.508705834548208724 -17.71312464810087306 19.096361357816181936 -25.258867095516386314 11.982784593525087402 6.1919506374155064421 -3.0364108933875511021 -8.5077525643423168589 0.76570383240929984492 5.089512295986523327 -19.508667321437581421 -10.345918398677943273 -2.2450953630501548908];

% Layer 3
b3 = -6.2475127117125603959;
LW3_2 = [0.2297280687649005948 -0.0055339160169085221605 -0.018661208290335230126 -0.22073527469746828666 -0.12026833798127824215 0.085896574438906928006 0.010363465510523379304 -0.003796903650449513605 0.02029177603624687104 0.10790412583716960104 0.16315412576167689918 0.1276814271949152646 0.042552545616873049816 0.55680830237022072016 -0.23221968697342337817 -0.13539907873509771097 -6.46042711519590096 0.046875464778379304087 -0.12425127488779852403 0.055540758462589726041];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
