function [Y,Xf,Af] = ESPER_oxygen_7_Atl_3(X,~,~)
%ESPER_OXYGEN_7_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:46.
% 
% [Y] = ESPER_oxygen_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.3352189121124085069;-0.73069410561697722972;-0.36337831168029421924;-0.55750946607590556869;1.822570678535262001;13.084583426312020649;0.42595449034463594984;0.027538692838935757701;1.4074985297887880886;2.1648457644888940976;2.6004533344141318452;-0.33164140682439902097;-5.347881765350505745;0.43900617431479910246;0.84337490852762730942;4.6720446610235084606;0.895537973107153773;1.1544983759396580947;12.467802207945180015;-3.6733722869610221373;-2.7643280930314304555;15.621114396361310384;-6.9559771059659061265;0.61191176563874583039;4.035590589829370245];
IW1_1 = [-0.17325442910225416493 0.11374157208195936897 -0.5775144108574253865 -0.22532897441952981499 2.6079334104844700271 -0.94109672340141636848 0.62954706709143171128;-0.77764864209265860406 0.20917647518029011677 -0.37751918418514024411 0.47079465411889515059 0.83526849220022292286 -0.96864557555223373964 -0.30982453973752399623;0.22170624194605453861 0.10514889883423089723 -0.0034612312953687710514 -0.20715222632808732994 0.073020304448982498169 0.68226428289456764187 -0.2553568822407870087;-0.48204580625144904937 -0.069976658044704348471 -0.32266878087340605807 0.10331034343174823331 4.4241142854013579822 0.98519699629730994594 2.4497449846521073269;-0.030428192482602704066 0.30684926466992501481 -0.64807458080135238454 0.54463249867384100344 -1.2817332125616094363 1.272698815842213671 -0.93734478509181728967;0.027580227476038082779 0.12670968340340579839 0.2927926183694843365 0.048428088488964730896 -15.717842003718507371 3.1026387198031599723 -0.68028069918400968508;-0.25965813428544581853 -0.12164228493192384695 0.11217355635075117182 0.38346368716766249252 0.22884919736069514462 -0.38102382970905757098 0.036931490221373743099;-0.68192544966019863484 -0.049247446249118927153 -0.086576473115772267786 0.45712610478239473766 0.82244048138048919672 -0.33459102136865620514 0.1922667585730265527;-0.1927190951119577278 -0.23022285556913707483 0.12820750683361925581 -0.023991784947955067248 -1.4827727730472366474 -1.1957710926211255753 0.38000723409692072075;0.42650476985646718076 0.01021313992457189429 0.396918754169976018 0.37489201509801928225 -1.6206264044924305612 0.94570394604156571283 -0.19165871564028344465;0.43034439653929407177 -0.075922604591816919561 -0.094456626752544459169 0.20132344281396233332 -3.5820232451757409997 0.83872646246113446988 -0.15096041442656904508;-0.13188875555905396619 -0.10222749322305237085 -0.1218597755263015614 0.12920773706032401273 -0.71771116644103216675 -1.329975611195220786 0.39484596833473478705;-0.69850059770921846258 -0.034455752651090514049 0.83198253847322922727 -0.19090176318966511904 5.7646869797433266669 -1.3031393216602258356 -0.51945044942597262683;-0.84787181648735987505 0.066836112461231014792 -0.11084071318390693872 0.15384766743884700779 1.5284402195356012744 0.58878967971434870154 1.4707381447374459071;5.1525520291932505046 0.69850486947376499991 2.7267715078344538782 -0.35715158908817218331 14.974035045708868452 8.723345117424205597 -1.1896104165200038771;0.01857294069817450391 -0.067387332514863618194 -0.38606978665483554503 0.23557704141897176098 -5.4007738373674190058 1.0996601144656314997 0.6364844274071711494;1.5929017802684499738 0.071392667781275037653 0.81037897176916706687 -0.29585344518783224244 -1.9604063907148934209 -0.88368520392343241632 -0.31945741423391676994;0.89684348484981801786 -0.087082733075921847643 0.6648086452723401818 0.20740658360062827481 -1.5189867901039217912 -0.24070806511664535887 -0.22632154398536738493;9.8481849623148587369 -1.8647093575489444017 -4.7373098605256025451 -1.2591387768811888037 -9.9101207229700598589 -0.24447338914691965628 -0.37495922950331916912;-0.061849350588974685849 0.02343833895564334871 -0.91616775125936933399 -0.083149744613962822681 4.8620661285728630219 -0.59119092666410688608 1.1367043786250512483;-0.0067862110230037450687 -1.0158436558163632668 1.6870565386706550814 -0.94443887554775829418 5.3514501210252136687 -2.2059498488061342059 1.3806082549836851125;-0.14816886098384496329 0.060760833798197064204 0.14907437774203871617 13.125010345188972138 0.98679884738340228889 0.61186783903028851839 1.5914788094312082301;-0.78821256146093277017 -0.68855039596260125823 1.0669831911857714513 0.18068324684001507707 2.9472553707661863776 -3.5715948182607344386 1.9366335013830511258;0.19260380026463680414 -0.37006198443556492794 0.46518448604428885851 0.022765983623182751983 -0.84886082093483905542 -0.25997655546598058551 0.36026964185051946199;0.79384274210050065346 3.5056526551421378635 -3.5288570399022209934 0.047071807852473154798 1.191553387723798707 0.89469027566586656341 1.4637157456228431229];

% Layer 2
b2 = [41.932981085032942303;-1.2745395596165447483;21.42862350501357227;37.0921678973760649;8.353969910950143074;-17.812989815199912869;-16.033458125730518873;9.5829684420516283438;5.2611778608423600545;-11.503810781579582923;-5.1923611603660919656;-8.8691245450618172441;52.650276824148903643;-6.4449931421515538332;-8.9136370226297874098];
LW2_1 = [-29.616046141403955971 25.805313785954055561 36.913883137262253342 -27.675442136249746028 0.69995023377778808893 -5.1499128682338897178 -11.189035245336759417 1.1152226652578705046 27.536575285893839293 -32.93136032207834063 -18.763469819420382834 -14.389291770088320277 -35.779279789858726701 21.723241839993281843 9.4896755783002380014 -17.330074132851532198 13.240543353408236626 5.798522477067480807 -23.977618757532955129 7.4418086335382387375 -7.4476635771264643182 10.396030582304858214 19.275471063000118477 -6.7296482954727263603 -4.9594223567377149209;8.8512765242390170073 1.6453032332795005654 14.838139824230909269 -23.090828966695205793 13.866847992015365776 -6.6756005099429449601 42.619334605243217595 -15.774154209181723729 6.9280813468719975035 7.4550734453302549554 -15.797112617694390124 -5.4652682751364967118 -24.16462983036022294 -0.21316128684416835171 -3.1385929534653924655 -6.1432460589912043503 3.9323138104898487377 -13.310684010794961551 10.649171628175835735 5.8113523966466420489 -1.5224245454459317539 1.9056720512317633087 2.4406226513707416359 3.3121136306560488016 -8.4309326324506947969;66.501405962125161864 52.49477205207374908 -22.702658911708692102 -45.056608815800728962 -35.877697829652213102 35.49012048570254052 3.0700891606954736623 8.5556988157974309672 -12.750337393952710485 -73.03818758768525754 60.738364838876904628 27.536012703217995323 20.897673047079173614 35.544243093034289416 -15.274860452334909411 3.659874410120496524 -21.670086603813739856 61.366376782590329242 -3.0315354395873073123 -39.532246411928618102 -4.0017298914730004 22.247197138462844634 -19.72249755059284837 -10.7085091261102896 -8.4077688080881838317;15.116987673451324881 20.48618344894033072 -61.646155103067641789 -16.493838311719084544 0.60237725953574661197 -13.055442823383717865 -33.997976653053015639 -3.799463609428142874 -23.643171208586167609 -2.1608674850189864003 27.679760503517581327 -36.742150021167013563 -26.24288427493533149 15.899662105639931653 -15.622357354589125222 -33.393605083654129828 4.9970047459591562244 -12.721846064505912821 13.183312553371766995 -13.60165844257512191 -4.1008949446222944246 1.0310994370441222134 23.75624018746418642 31.665247502826339598 -4.1272494708476283876;6.3992078264726330872 17.654426467416421076 16.331261813160576679 -3.2927079019344214217 -7.2211664349030533216 -6.1398380182860305965 12.825960898752434503 -13.175995935886339439 10.810744243135157916 13.486494664379131692 17.060430099989755348 -6.7736126364390933929 14.995839658687634355 -19.775906592728762945 0.86092277007116413401 7.9349666453704994495 -3.6908705930693765929 -7.8957865896432073427 -21.752230505583675324 17.798152324535692514 14.905374370257968408 8.9982048876640359225 11.898062802717030095 14.151398554299428056 0.18633636025344266218;2.4095436786896411441 0.60612920210708787216 -29.113951187031911871 -0.46301175565612745499 1.1491689275236323109 -2.9982603173540862684 -30.259447257378937479 8.9872439808034005893 -7.9655919523180598318 0.42359697635665399806 9.3013182563568541639 -7.8823145014642870265 -2.6747954364505845959 0.92611609843562214817 -0.16869383319839792446 -5.8192087894401325343 -0.18662049784994169666 -1.9296936954090284644 18.525424430150689403 -4.3607052648209343459 1.5447689721058412982 9.8055992980512485246 7.6372025649902939293 6.9107020588476837375 -0.29889918673604948252;-4.3054807506805028439 -8.9649292008004568544 -11.766862634947715449 3.5431579254262604017 8.5621900655476466113 2.1487686098657015066 19.789392495250641701 -11.304715237416068874 -3.6910751241603811934 -13.007965424436273238 -15.044815458064251246 -3.6037223187165254856 9.2266830672122832624 -0.31984929036604259345 3.6114327303021833693 13.432796270805265948 -2.3251147008063015598 10.048212223916968 1.026803874132929284 -1.8595242130856057816 -2.0572042286431080349 7.5633833643582235595 6.9410550886477739851 0.03166705383073597363 2.2165749027475567523;-3.375800702323989988 -2.2262523477966169594 1.9109195082147221179 1.2455423463945289875 -1.5442915273086113004 1.7220184863973764244 7.2591513850853450762 6.8787237664995117825 -3.2917858254846987798 -1.9723256481314312971 -2.8639040992207140945 -0.85971132134795091861 0.88700070503044370351 -7.920216308367095337 1.3125658031374196621 4.9378691270200008034 -0.31294619671241596937 4.2468089403634952106 -2.0095952652141217953 4.8350908022192111702 0.98145900413399023154 -12.757203601252486536 -2.2824172693662778677 -6.1602734017104063824 0.21860580739942533923;3.8786748788665188492 3.0611692921237159126 11.933826074917361026 -1.9462404945009972312 1.0207185152189914845 -0.96192045180311058772 6.7047253808033513423 -16.102443202541266487 7.0802456026105042852 -9.1594858944930912514 -0.33906662248099850299 -1.0684233787129913118 4.1920998293888267483 -0.47292007059873730768 -4.3139830210484264583 3.9974985668063025557 -0.48349884452098662591 -2.8071955530225243258 3.0815834093470280131 -3.9969985306932600544 -3.7972143265350535302 -2.9865619414248447683 -10.000649151182068763 17.897641362810919219 0.82708805577666910658;-15.494497770243258472 12.043712538068904294 19.168684503584987766 7.8628464120825745098 3.8562707196974010948 7.9844993636235157553 7.0909611198121442754 -7.079430414152052542 2.8023128341910585881 -24.013040189534141433 1.8738040716015047504 3.6085580582121443705 -13.732815144052864298 8.451999225151533679 1.4768061045201379411 -13.050569409689213529 7.2683371235776599306 -0.54466561426075377206 -4.5668657818889846212 3.8291522007194873645 14.262759530547096887 -9.2348966403866743491 0.38640064388681910623 21.926169156929500303 -1.8801853976940725577;3.5279641649309088081 3.5977619036831103294 6.4847985534728760371 18.138658634048564267 -8.4915148355777940736 1.3316112892926892375 -11.155327466288470717 18.534310349808968965 1.4428071504721020624 -10.571224934736450862 26.033284282597250581 -9.4938995397772707463 -3.0823040143718349881 -6.9612428911100368012 -9.5457113742367472042 -16.496109715335315116 -7.5575759085913363222 10.747550370386440122 24.498136708975952303 5.4217589338999099269 -6.1965357303072643447 -5.1368088061787915422 9.386042744494389467 15.311058593797143956 0.17054628865344670374;-15.094925023024481803 -1.5641034853237123503 -0.454329436411529064 1.3144034061077454201 14.089054116664010863 5.357092772749323828 3.9740953834888244067 -12.147535064449211717 1.6105197564152231582 0.9941348221782931871 -14.505028831196904449 11.022883975638851695 5.0564104681325714452 -2.9250176750376000179 10.80937916548640132 3.0697968737949032914 8.3765110851685733451 -20.222756038114269472 -8.0638749651585577283 12.841544494885074101 -6.0617369061967343313 15.350101228201909365 6.1481707208669611475 21.169123403950528939 1.2735237311173324137;-40.546720186431301158 27.237086492724927211 29.179340146950377033 -4.655726356491472373 -2.1820236947461402188 9.9335019975217662136 7.2093709383616353392 -16.388357533884367001 11.258983676103246907 -3.5842842867776480986 -58.219397071435416535 5.0179358519124130922 -4.9734813758305689291 -7.7264504464296148711 -7.1450590277334802281 25.675623956002862514 1.7203356172951818071 12.537865658951893977 20.871883999326701797 18.221234620230017498 4.9494837844501242685 19.606031234260047569 91.648114120384178705 -15.585527027940599964 -1.3118337929652166274;5.96050739746978131 2.3743099602507853341 -15.558701071680227201 -0.23623152073551703656 1.336525609771530787 1.1029818082867326456 14.980231624139825897 -13.081994018699500515 -11.379973963321056374 2.0641156078586009315 -5.193699391836266166 -6.2354045259030854709 1.8031109808326946098 0.28335878056725644081 -0.16158993818738776049 5.5341754419429314282 3.5477396206373623677 -5.4788265178218962248 0.049365493746368990791 -2.8723989895187314048 -0.26601058282214090633 2.484744562729298778 1.7640992263114954053 3.8882197618942115902 0.057949203867932751189;1.9888245040561076671 1.2932609955535778745 10.860416404505276233 -0.62574462364247107615 -0.93381509104934079524 -0.21996219890660653751 -2.3433259730348323657 2.9953737907666000417 3.2620093509224723505 6.1523390043090087076 -5.0394543371824678246 2.2527057637773171272 -2.8363556745175442231 -1.1991379831677313472 -0.10817609292290128464 0.61480090323078206982 -0.36839139318272584589 -0.9395402637100340737 0.11690834251664163068 0.25283138631226420578 -0.035393563405022157586 -0.50477858024893884625 -9.4929196886444611181 0.8167168205078754184 -0.49535062143089042541];

% Layer 3
b3 = -0.33067100104128666072;
LW3_2 = [0.0084395165056055619635 0.013150033846115075781 0.0044295376843295443045 0.020180298173358177799 0.026495070627701643173 -0.1628094318303882071 -0.036992882624869709296 0.04524140233269190875 -0.016186637098251476646 0.017951582200811212059 -0.070148467561243418866 -0.05635003398955500814 0.015668468535415765175 -0.24481392960123984914 -0.29906268745702174749];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
