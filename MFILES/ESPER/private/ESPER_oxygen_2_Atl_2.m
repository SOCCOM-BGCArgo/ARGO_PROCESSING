function [Y,Xf,Af] = ESPER_oxygen_2_Atl_2(X,~,~)
%ESPER_OXYGEN_2_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [10.16311309241795513;-1.7328052568689218393;0.95378566041062784464;-0.42683110015811648319;2.2238747467959676385;-1.4354826834703597882;0.79359750103853565761;0.48440057797727809064;1.6184371022423522657;-0.69735939064589114178;0.57909849271633906387;-1.4532884285279268344;0.0062955521803771006747;2.1606839205447387897;-1.6071107947401122029;0.57759056852448187325;0.48001302897255110347;-0.9514335627795810213;0.91511533448920256983;-1.4401027247592028679];
IW1_1 = [-0.289685967160953739 -0.50055183750203757764 1.3967310595274928797 0.6679626145674097959 -7.227977081737043008 1.9519369750557957754 2.3677454779096334114 1.8388469890313325905;0.13980034615446751411 -0.072877762396089992847 0.53809231670349622068 -0.31253682006152749828 0.25163150410367585152 -0.35915189658714785637 -0.55899311721803601749 -0.15478042115887938324;-0.23238206771368452586 0.22743253047742700845 -0.72113703634805070841 0.29434915642495185217 -1.3041826273773002853 -0.10887256345138776603 0.63091555061456128239 0.52748994474871191418;-0.0078803889765137139639 -0.094322758515622981412 0.11345198412020475465 -0.40947070708854887977 0.13758131732694856009 -0.47561980183057195326 -0.067201038348748104445 -0.18315994365979204606;0.069037677354504181637 0.13428787590252072581 -0.1472453542372067492 0.30916994895409666277 -0.99363867788954418625 1.2138304348530051247 -0.25100452488233959691 1.3491433594545125807;-0.16509769099694202033 0.2080846660215087407 -0.56241461650134783046 0.20070080714768487318 2.4312436548234628297 0.12882854209255983902 0.41226387674470710287 0.92385393997625009366;-0.23685355873679558858 0.46028817875721383945 -0.10825156998970546229 0.25970415026695425897 0.29494420825730827129 0.61733520251281881475 -0.69141039263019388184 0.28512024169648714222;-0.12026246467353569891 0.21946300079293254437 0.2766916059169965969 -0.28662487250623824853 -1.2322410808961867801 -0.44348394722796469214 -0.20443281550167119454 -0.59024915509248720991;0.030414834126455181362 -0.13531004208211222517 -0.57492251436936148146 0.39087668652456503127 -2.7420587203099300311 -0.092338090322439059232 0.40892784128259151988 0.83696198466840443508;-0.016326650357691020743 0.19037354174330978207 -0.23205091645886113949 0.29114446346725969539 1.0459548106316378657 0.69631549745523324546 -0.018466595550541652776 0.65064626067681996524;-0.055434960714552949934 -0.037887081493537234922 -0.6138643296079340228 0.35662148831805196014 0.70819493243198283761 0.12876980714135097261 0.88653771003134740347 -0.30247837526619564263;-0.45251829133120757831 0.19510304575324291521 -0.82978357117565726409 0.27188395501852008485 2.2328740060554195246 -1.6329829618450122375 0.47419289205174536272 0.43675411202460312499;-0.33494971627445935258 0.077211251581484702244 -0.44223671989993701414 -0.61388946495022966854 0.31961433961586938057 -0.93518863557028686362 0.45605975711707458231 0.76597888318269702346;0.15163838694607884028 -0.54500924491398294869 0.01603776046580171824 -0.7297451886896840767 -2.3591154231115507578 0.90040615626433340157 0.0069217235633245565579 0.33443932880823107334;0.25199492649575699899 -0.25728894518108880174 0.81948011789276042904 -0.31758401399565061585 2.2139222435788350474 0.050134326619203403719 -0.73120619977863465788 -0.46702982101353068822;0.15715042994070871352 -0.24910605180380310242 0.3567816950286978317 -0.49364892537674659456 -0.88204990018306239641 0.83926965673296416437 -0.43399115435603097257 0.0014670178718786917871;0.25479490348488154083 -0.070983788512431103546 0.013886061754021069431 0.69846660564012996719 1.8449815398733053762 -0.18716770666047194416 0.67291436447265196019 -0.25591855357103437951;-0.075260561339336895514 -0.33815445505218172384 -0.11248778246308334394 0.75374517887044645281 2.343326959776104168 -2.4913577998429339289 0.11565524018879960733 0.58006926010107429104;0.075573174326469996775 -0.06547021316639713151 0.054737365309733748697 0.13012576745260334699 -0.83462460229746504581 0.26176793447435414697 -0.063387179464011386698 -0.12321360847865525656;0.2669280194251532623 -0.49826514965133389401 -0.18235876426400376982 0.037238179547407539161 1.0679015868778845011 0.072378296386392412809 0.91376627769777274413 -0.76854663511535759035];

% Layer 2
b2 = [-20.384373087804473101;-1.4473323540560485423;26.008481632700174657;-3.6885823893735727452;5.5518730831730644937;-11.159972058432403585;-6.3317210903837146674;-25.273265558405114461;-12.850479301940922028;-267.19996829535995175;1.6445544832332186225;-16.955536991056920471;-20.341534693639093945;5.6129659364261046406;-20.116156609392220389;9.1207722047310024749;-85.918931328906225531;6.901787174257024482;19.468727143843025829;0.21305569550443592686];
LW2_1 = [5.4593186049476170041 -22.811469149044430793 0.79467355947329465504 5.7323002483381282346 4.022861624983510076 6.943682375974453258 8.1166257420620997465 20.761827643699721335 6.8632653233145051175 17.989589533951544809 -21.950018541360876156 13.015216881118927716 -4.42783357485050999 -2.0351388921699031798 6.7268867395156348721 19.796633864086231824 29.909336085936132577 0.73780785090898715062 3.3408222417767667878 13.234975155059029106;0.18957193966985000366 -2.3149381930829036058 -23.284601906451090514 -3.7745107114133853443 3.8502183880093263646 -7.7877478405748794543 -8.4048287491718216558 16.702899422027762455 -0.52610917002471468962 -5.6306613724177712044 6.7447752315502533804 -8.7105277730668770886 -1.1744484283468226149 -6.0844566234002970262 -13.991375842514615968 -7.5101983454412319929 18.851954384507958906 6.7110527771561709898 25.851089569285768732 21.336770169576439571;-3.5517574048929438923 -68.196157758090393486 22.941382135423388888 71.245527135875946101 18.547228908469172382 12.469810418839887944 -37.477121794180114023 19.171732990060540658 32.442517788989697181 -12.852894682390644476 -52.678954149499922721 -21.222131269082854743 -3.0222543857202226469 -22.114998107670889027 22.420079298721734773 -33.253007260863761019 -25.970414423001326298 -20.918474053445489602 51.101236527438238966 11.846801450747811657;2.5432282589134129758 -10.171189686521190154 -3.0426885495506801327 -14.422916114992933245 16.348726692840134689 26.365391998824005526 5.2495010762102518598 6.6733764003820699173 4.9511168249884764947 -9.1425621622921493525 -7.5499209187771931795 -10.906145096039843168 4.0122289844627347932 -4.6919440506773533173 2.0767561404704850681 0.019836086399670032482 -32.112426653175603519 11.158772472385360075 -1.6775248611840747337 -31.965060238031956175;-1.385622890388179318 -4.3170448839804009822 15.187910910077627946 -11.625288474058091737 0.33397237562991305415 6.6372262182521337692 -5.4965999036527692923 9.9397205164609161443 -6.7356910861105205868 1.7206222187487434372 -0.75354246960669091226 13.244134139377257142 -9.5304103214557702728 1.2388481650839442416 12.299350029388152805 8.1648245313930996048 -7.1648390953014251537 2.3481234447004286636 13.121244208421487087 -0.3503024637716001255;-1.0082704398515083266 -7.413516870535947767 -8.3163301050813789317 -10.739086697372890455 -4.3018389213789278713 5.6380640090535161235 3.2563125689360452597 1.9122216178114215257 3.6975846156985090474 -2.8649832245175379519 -2.387828794707655522 -3.7964547487724531472 3.2703384990991470893 4.1730554767328325028 -2.1586278603831452472 -1.5486322871192992334 7.0391553736140322073 0.84731591193359379055 6.0686285496090528468 -0.81131773447530519672;-3.8252278495594427277 -21.962542124995639625 20.540617869733505785 4.8549617484838236692 -2.49883579293277025 -0.82705442675438989308 -10.806448102678958278 7.3703568132390264722 -13.040355981359246229 24.255648488912580518 -28.939311550114499738 14.589988488007691103 -8.3283567919284209324 30.654667111558214998 16.440615405408756544 -32.914996703781056908 4.8596095165665067483 -16.454726813861594081 12.470053438366491605 2.6099658398238294588;5.205832538071627269 5.3535835086363787738 -9.1619724764183949617 -13.73833587131774614 8.8920766299540350275 -6.9821898140337932404 3.7223576966313749459 5.4996074578924192267 12.914005212186411953 -4.9955014255758412034 9.5037813025442545722 12.640320208752834574 -12.402294825185245841 8.6291697112955070281 2.6776430492341511957 2.4648139437308032029 14.254268501017532955 -0.74727707630373407799 5.7337270468076315666 16.533187902089572674;-7.9939282365068580205 -21.968671288192147983 2.9805657125667819329 12.542172457439432876 -23.052332787398611913 -0.98421433591112139627 0.64616699688217893449 5.6530810840541567686 -4.5975470875123383152 12.958788089052010406 1.0855336063495926169 -3.7234623391358923072 -13.480176849944115247 11.481313853716830664 -14.895298681802882967 -15.756309834808646997 7.9359442966565909572 12.308336846694025724 11.096586588418471564 6.0137585372941666506;110.79697645390083949 -171.74838724199935314 -101.48971945247268422 255.22436425573982888 67.000424251737243253 -393.77500571714705302 -231.84947173234317574 -115.81304434870588693 241.14158720925254897 286.85955299172110244 50.28894674133301379 108.86930169703578031 -61.134560336402259395 -260.15625491816950898 -45.038332866983687097 212.80222562828848254 273.81370345374170938 -122.81196435243023757 -54.597858066521609999 -137.46319470039892963;-4.6204356010378786479 1.6111282524708654407 10.664550408284593885 -2.6553260080378593422 -3.9682790292761764839 1.6741370356883644721 -9.0521797744405496644 10.553993933522283655 -1.9440043109020861412 3.8085812540480037391 14.789000850792122677 -6.3787504447422334053 -5.8715575452994972494 -3.81067239325948659 1.536788528329251946 2.2665964709672552502 14.783517331788903704 0.23209924699072223553 16.041246807507135941 0.40876921527897475128;-0.93356849323176427369 -2.0203318507693546202 -4.1610661103509487546 -7.9865023776991019844 -4.5518090806331423792 3.2700244002045049108 1.0839707897254553526 -16.344309852466942345 -2.3326000473840058369 -19.919912386994766962 0.88869986037619008723 -8.8563422742884814198 3.2574795430114358297 7.3678211274424221244 3.0141470601135305074 -15.301160074180376824 6.623714427599769472 0.46766164929778969439 -13.851810977782802681 -10.000189603288944795;-4.4761155582473657333 -0.094598485948607813345 -19.083078297472503948 -10.92760238116573035 13.254138948336231962 -0.25629234348850510328 -4.8796875908225363361 14.769261826081930167 -0.76946570453259965916 -10.142876914461448123 2.5911496668413804834 5.467170797821464312 8.8741513348188032495 -7.8372640443814640676 -14.856950780827830272 13.85583750168541961 13.629871408692354251 -2.0436999051170392505 14.670851594880140567 2.780560480528492473;4.4926348990464397559 -8.8156340262074071035 -28.029483338957874139 25.005561681433150056 -8.9475220812022371319 8.6186015069161285851 -14.896712144580678938 -31.57239138912908416 -14.41757568519632926 3.4039501760688466447 -24.356648288756591825 16.127855847741884077 13.537998694108075881 7.6256356192405858607 -17.877805924406636962 -29.576637612007115052 -45.158796778968074648 -7.7567237502053218989 4.3143034741694687995 -3.0167430707346194474;-0.10257962562294579978 8.7232756639184678704 -56.349945240594415452 -37.723755503210995244 19.631726555174342508 110.12975560237177319 -72.953024593406340159 33.182761601539766616 -4.4048676397388843995 0.34723742529832812842 55.316081709002901334 -8.4392816469695262072 34.452173563103706044 28.699514923942949451 11.159128476148865161 -4.717517202485788097 34.842338417926939087 -35.071417788007998695 5.9912112680759213035 -35.840170881890237808;-2.6503612154747733243 -14.911909558076283489 15.760137717831234738 -13.680487980541231607 -2.5040622170853836792 2.721253099474308712 -3.4597374164441707656 31.861315264548029091 14.533695045283712588 12.509220728816575985 -4.1232433414225626578 10.258933752187276767 -13.224537136775186497 8.0402172438809209609 21.045022323321276758 3.709302496987068043 5.1750537217574583693 -1.7662374849724891135 -14.521701090612214813 5.0538835861607145361;20.79333470252497662 -7.9249617776261693791 172.10260452137185894 89.075646334172418506 -85.491073740072991427 56.892956961178924757 34.032893011640915404 86.928378784221081332 -3.2070961213760700304 128.39645628661401133 109.00206436935377496 104.82866375137270154 -78.751709202278817656 145.32916774573024554 238.26903692372437149 -25.408520808532703228 0.27523679948059570632 -27.731756786534816683 -69.381493923725699347 -65.656284464307759663;-2.3496804639273283222 -11.243528070095806015 -3.6159194375787002684 -15.635495084760702156 -14.250184496110804844 -1.9882130768784118668 8.7211826082768926227 10.635915586766790497 1.2603703292663295255 -1.4548587054908748151 -13.428020314077839359 -9.1577834950430894168 12.049246649165981538 -11.722205896312628326 -4.1933236716962403179 11.719877194304510581 3.8321693673951746639 6.2774665008103180952 -13.63890423569654331 12.275163602591335987;18.759458811479600371 -5.3429991173943642835 33.658438107378138682 24.620255039463060598 -2.7615927877911263799 1.2309046304335380384 12.675594609025612414 24.339256085655271988 19.107216838619212496 52.433389197541970361 -10.593542500570634957 -0.14397947570675420637 -20.319048363557740799 0.25867341703562002353 2.5980953132528066263 13.077056632523442303 14.441266979832883877 12.722832891246794063 14.654518275438189079 29.508651745972372282;0.73129999124166888969 -0.091821586385788522833 -7.3415489444527679552 -5.9588593815985433366 -0.80811089541883140974 3.371904375380058827 -2.7061639115688347346 -3.4510813619767359839 -3.99903133452531101 -5.9368231274284424259 -1.2526450342222306134 0.56832125697530799791 -0.58308103628671614782 -0.5529116872491894874 -7.0681911978047340384 1.8973746336333410234 -0.75894818953083398316 -0.87833615271198905994 -6.5117902167297083693 -1.5582153703920693655];

% Layer 3
b3 = -0.4350390376581491636;
LW3_2 = [-0.057860119234101226038 -0.014705474442233927926 -0.012761543811824718753 -0.012715830522842657205 0.031724636774884205914 -0.15499409775203218387 -0.037987000711723596658 0.0053642633407870021073 0.007370389798467254748 -0.001770113482933831188 0.025050787984016029825 -0.09448390341781420787 -0.061885678109387783075 0.04107562961003901475 -0.0059502897328638434948 -0.048801748763318650304 0.003714404100343606397 0.012024197734998621351 -0.0068170099959744354795 -0.48467062244507458368];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
