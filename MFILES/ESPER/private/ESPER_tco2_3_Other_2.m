function [Y,Xf,Af] = ESPER_tco2_3_Other_2(X,~,~)
%ESPER_TCO2_3_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:53.
% 
% [Y] = ESPER_tco2_3_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4461039227037455;-0.701989177161916;0.57255424605438987;0.31504747856117643;5.0804171277377854;0.52715993156738661;-0.2318151080894173;-0.18201608338703504;-0.048696235754446739;0.49831329759134929;-0.9264218136371416;-0.82433118819299467;-0.38611174959326972;0.73532070422681317;-1.2875179829380823;1.0140079265426052;-3.0648177570068782;0.87863817816849454;1.9125388323243477;-0.40106325350422595];
IW1_1 = [0.1659240588323673 -0.12001283471705464 1.4687975444865509 -0.80952250992231733 1.0122120332992648 0.58557917981490759 0.89957356119417375 0.087500185412160744;0.015332649844552682 0.15640122229319345 -0.044199569230394212 -0.25802763820581881 -0.42560761671511727 -0.50245073388815997 -0.92895072105623988 -0.11645354650886076;-0.15434121478471813 0.11243319649201576 -0.023365997478669895 0.58255059815771193 0.55226586906171748 0.41433294045204372 0.042645669358525616 -0.101207119177641;-0.029184208531081723 0.020772387881310694 -0.049271666966137585 -0.1113337335862568 -2.0346144611060724 0.31965847828767319 0.44586508518516405 -0.0029343951518212212;-2.6722512803255376 0.99488662397470884 -4.3124458852057375 2.8043175801510762 0.56460518643200708 0.30041429692968546 2.7501912584720061 -1.1806662906938556;-0.066245183763387824 0.012361005778200478 -0.062785904363905035 -0.11582543589906324 -2.0538560893125268 0.37685893519301528 0.30211774231427968 0.096804710597502439;-0.12289716284932656 -0.085567740711474174 -0.13639480307812901 0.12131691642525427 -0.71649890689976359 0.49856530762377993 -0.10089837572320567 0.40640721480612302;-0.46987720617818463 0.2697338259296756 2.7614318522505128 -0.32889447579212372 -0.46701959332004622 -0.032730446518939943 -0.14848205259033931 -0.23669734173053239;0.48653776219955491 0.33759038734577718 0.09225037611031861 0.10084628128301223 1.5485025897999738 -1.3746794621050218 0.54395282534038114 -1.0667144424588899;0.15498161965318444 0.10792420123404749 -0.13690154991312745 -0.010714367256189771 -0.74059312778017028 0.8491062332518684 0.07127564579415796 -0.22883972917406631;0.56175815353232905 0.017590752853855429 0.33745419814368383 0.48815870797751232 0.58529686493870237 0.00081943954946756795 0.65759708962790708 -0.19360407010305375;0.28073295309795232 -0.18083762780715135 -1.5962224374669716 0.55131935787940223 0.62566168561386493 0.41526207567515283 -0.066225080793194072 -1.0848980170762559;0.013433128136530133 0.052110181289380275 -0.049687140856155596 -0.14351132571588468 0.33423045508148352 -0.29021986215361234 -0.83301216018389246 -0.080335624173030834;0.19957457752593361 0.25088763504106443 -0.2086830723376023 0.024383239253512261 -0.055436085583476305 0.82498714812215956 0.42341729197419159 -0.42254028250565712;0.18181526548611124 0.037538118515970179 -0.12079990633185023 0.3009706312301878 2.7621039980783424 -0.8111099016278992 -0.02467354317794905 -0.22928470703068715;-0.43760313353797398 0.29827375683560403 5.7792849642535282 -0.93223140752687772 -0.99086164223783757 -0.10613118736736991 -0.79430247637391582 3.6185843177570152;-0.030769587469859947 -0.12061293825183494 -0.79407107564009549 -0.28515919716233062 2.5162632091796104 -1.6668097469406535 -0.92904913175245907 -0.099445682592761805;0.21645671715597317 0.31818172206661116 -0.58876240525173218 1.2623318533402526 1.2035901423794728 -0.054856176895299182 0.72256683153982559 -0.13925193936332766;0.20049525626021966 -0.43550643239876224 0.27993866733413564 -0.56992281966812874 3.5263865300420556 1.5398749359888957 -0.84640605746640685 -0.36728396966976123;-0.0049953171936932168 0.042866445514317404 0.28005440531459552 0.099789748234461309 -0.84004046006504762 -0.51761212239405241 1.0886247785687357 -0.14330749712228324];

% Layer 2
b2 = [-1.0174269238481128;8.3025404709226134;0.16722003260724555;0.38283228308630229;7.3337191618074673;2.2697371072140169;4.9207513965833964;11.401702315675649;10.869914509258692;-13.926007732915281;-11.25773273830451;-6.7641296580716972;0.69777639178668127;19.874244312985205;7.8750201526948063;-2.7873500712525661;3.8754329948067361;-2.6342516490015644;2.9460722041468572;18.556224317098316];
LW2_1 = [3.3684459860688047 -1.1777245357415389 3.210985911505488 -2.4481712550285 4.0651676849148721 2.2072600334982204 0.21898522587714875 0.072367134288400012 -0.68519431618730886 0.75021578512907372 0.1176235124222971 0.27796155058176347 1.7889126413592968 1.2303424650518473 0.5927610799521762 -0.20793041650910696 1.1796979247906461 -2.0964767719829394 -3.4909523668343048 0.59948664813214192;-0.79022624023939481 -1.1170530546745792 -10.89476427688091 -4.5408051872886102 2.8558126007243785 3.1424899280879441 11.152341487685996 0.35527252581179225 -9.6652040123651943 1.2801733942508964 -6.0915425934529255 -0.96240553617263969 -2.430688787039359 3.6665951758577848 -2.8850241419420857 -0.36297729673102569 9.6907954222346095 2.2652720684244736 3.8233497975212587 3.9141386981014312;0.64780552160868765 0.48792428302750057 0.60493857056901901 1.7244703194125066 -0.058253373739205097 -0.17534619382061475 2.7208980995048879 -0.16316643537859113 0.7120996804041978 -0.51763549892566962 0.50782114832896297 -0.049530196428159784 0.18711301825251758 0.1008803072137926 -0.06139838450493465 0.057750721960479083 -0.70179909278830965 0.18297145328545972 -0.0069047183767510806 -0.31546523867464005;0.46276752864537746 -0.090516853851926052 0.64445011534600738 3.2124603853162288 -0.12934310708416755 -2.00487529042424 2.3533220239402857 -0.056559801503094968 0.64337185931627305 -0.46464758199650275 0.30795465796196658 -0.14461230195734168 0.90065525098090271 0.028383467313612389 -0.056461071351277904 -0.059880018940839705 -0.46700258957970409 0.018703596831545523 -0.021704579605904734 -0.60874038036927747;-4.1281729956932658 0.53514503970683702 -10.161469021850227 1.4826695933564995 0.96276112254576218 -3.8306852237334157 -3.2760344582314653 -2.0417092572602002 -6.1707819185933044 2.0343208971828006 -5.1453864193749217 -0.29701040777013743 -8.1978193717967223 1.4907310812289098 -0.72297790119156213 3.6013459509509262 3.5879168672301005 0.3740699116675249 -0.21548074765015846 -3.0843609319276477;3.9427852273770982 -2.1208830117740396 -0.51121568401734396 -2.1726270249194752 1.5374835285513018 3.1703526130389492 -3.6206996487707257 -0.95076663729600996 -5.5787929249391235 -5.0240324890844095 -3.9751798481972886 0.41785596186528817 2.1084896917921361 10.326921448094227 -6.3493637335279036 2.0969279933809712 0.14565988860160925 -5.8133198539512634 -4.3103558030375639 0.91589532807339946;-19.474625269825477 -4.9672992496106998 -22.777362036104424 4.5171110170272186 7.7923139291884009 13.643489791569166 0.71225978334807749 -3.3775189098125113 9.3862897077246057 -11.807137791993567 -6.4807146601232413 -5.5768969479880832 5.0503647153326439 3.7838234798180195 -3.581961318026929 2.4293258720902293 9.2599301899860738 7.023340980835707 -28.567910640940266 7.1614524670521815;-0.94191386664094756 0.6666671546538514 4.8566451811827758 -12.850035138704017 -2.5082041200361864 4.3729453725834118 6.3048728429938423 3.5388574863014814 -4.1433164409828871 3.0328472315282844 3.2968575711279224 -2.4272201756912115 -5.7356785828378873 4.6727803914736628 2.1335058425631614 -4.2156850211860748 8.0973010778142349 -3.8420707370302396 3.6516140353876509 6.0684958545309966;10.752673838283531 -2.5513027297734312 -3.8189209625983618 -0.52691651084465518 2.5373588352984289 -3.2814508355598599 13.645264517300639 3.8551134482740155 -9.8608342940059099 -5.5821608700291572 1.1590224182250579 0.55828585241096162 -10.853026087643727 -0.81868063496833776 9.1654974979184285 8.5880639450321752 -5.3214723489991815 8.1609244917722101 -7.1620467184630341 -7.2969650937613419;2.6866521401370722 4.0737608903401146 4.0638523200907919 -3.1285816337064229 -0.40570121228220013 2.2294916289173967 -10.464175985866188 0.84635484513356896 -1.4019553260899522 4.3172291730113326 -6.6077637179436772 4.1351249493867135 -6.6092088370145294 -4.4607936742815291 -0.09980565163645555 1.1237214657931802 1.0038452157743474 -2.0156124056763125 0.96726415521970699 0.39914396138238933;6.2414945078748199 2.2243757518737239 9.7499138922100475 -0.45180774441378696 1.2676233693597829 1.2670158027194129 -0.038536332060056744 -2.6173781449158007 -0.8250181725022212 4.3414659571589986 -1.6251410962389472 2.6189081061740378 8.1318008698364199 -3.5184093735716631 -0.016114951876879814 2.2243077851200557 -3.0345947287503803 -1.2048216529907456 1.5611209583541965 8.2449944736906282;-2.5041601191298586 -4.9072265060705211 -13.604070244799479 -14.112719162634859 4.5217666622904797 -5.9173336564139154 6.0346716502598374 1.358331238648439 -1.9510572278311378 -5.7306344680609245 -1.9755917241310963 -2.4504630821811775 -3.895083521750851 9.9343053374537753 -9.6771252682490889 -3.3980051384858929 0.054735650015564116 2.5387748723404067 -4.8064789444408618 -7.5375880476115302;0.33125025654093743 -1.3127801476010414 0.69517471073227011 0.43756193836153928 -1.1816562155620416 1.9838602351149817 1.9037251133109956 -0.051730762325097518 0.5588658939321961 -0.52110755402725251 -0.077790319290441071 -0.22772146662452614 1.9750574816448445 -0.21562077779119063 0.84757759831099644 -0.25609717214112926 -0.96411242738832204 -0.21672343273992756 -0.34027076922406507 -1.4443520365045286;-13.916858154177749 0.97687153774980584 9.9995938792410932 5.4968375708826738 2.3480365917255894 10.728417029815663 22.407690000406355 0.89271020353519037 -0.016931738881082712 2.0375657757201604 6.0168747225418446 -12.930074391832077 0.010913041862331024 -9.0309714959693022 2.2271926610247914 -12.61517886182056 2.3666334154195474 -0.48956569940046907 7.2187456144375313 6.6235248869183536;3.0045965442579439 0.14779488979875519 1.9549206855433732 1.6274587417450905 -0.38499161329684195 3.5924948435016559 5.3685717459426341 2.4471013543530602 -2.22721940860268 -7.3786564410544511 4.6041252190045174 1.7863296750591395 1.5155801899687853 3.4758593718381317 -2.1903081829816755 -1.5301309761273008 0.62824486910643573 1.9151458366030778 -0.13285864402249881 -1.8719159807816566;2.3134100692439734 -2.4615145019615503 4.3187531820863203 -1.3249459370542984 2.0184244242582947 -10.944432972075276 -11.08564091010007 7.1240458647367246 -3.7386135045561568 6.1287911626567313 -11.552787642646944 2.8512836546444484 7.613251244502897 -0.959754033413174 6.7069474080410565 -3.5432731681669951 2.4948268557248623 -3.7398403784703906 -7.7107206587028996 5.7535062464981443;2.232579453758766 -3.4938488565948838 2.5693782419028177 5.534434518743641 0.88995411941975877 1.843864753310017 9.3356787110990975 -0.60780573642586389 4.8895423475323039 2.3083023440831067 0.28791830815919561 -0.17335601453261673 8.0503225543781056 -2.0806120459982367 5.7931649044564546 0.82817397293111616 -0.075913486449387252 0.13663915354458428 -0.09759928527043607 1.8707870748952977;-0.19846148235481531 -0.11070583825715634 -0.54013351264050247 1.4979644678934023 -0.31871943953952742 -0.9554119052820218 -3.0816521170802154 0.48300123248843063 -0.44170297798533453 -1.6917883660595774 -0.68274365425006123 -0.40952775635030092 -2.8233643199309038 0.6501070316765345 1.5428060971098922 -0.52940949658203884 -1.44763211412329 -0.56293566714131005 0.19975712650564459 -3.0142708299086229;-1.179646290616019 -2.1718537403871734 -2.7595559664192995 -2.695719779744532 0.3540150467948871 0.17320739862336831 4.84930637423248 -0.12190049631565687 -0.61368340144606504 0.26615135384946326 -0.34745234885809811 0.21465478451709044 1.3514821327782138 1.9973633551426142 -0.51323991943190694 0.21441352972297931 -0.23311689550545731 -0.56274270839206941 0.20836327647811839 1.3670018494439478;-17.800190442587649 2.6421323275464013 2.3312360934315812 13.092962344919984 3.5602189019620374 3.4143514280868441 -2.4228849762490152 0.83828268738992096 -7.7719026563531681 -10.356029012728255 -4.6765737176482229 5.8854383267862671 8.5486156691106352 -9.8065272295294683 5.7738298367604308 3.3493069255905072 -3.9102699052336054 3.2318641596895645 -1.469824662515905 -1.6496991361233893];

% Layer 3
b3 = -0.68796014705059128;
LW3_2 = [-0.070021131625566585 0.0056599602662219806 2.125017889587097 -3.4055668562262302 -0.0078734966323317172 0.0044538538311131512 0.0020514033875411535 0.012717134322580689 0.0069930609649572909 -0.5139576883686241 0.14987733795588237 0.0099023692080285001 0.42448753883763413 -0.0019007845931931226 0.17330654739647816 -0.0074910463631605523 -0.096916595916406154 0.42356117176711328 -0.17447040877154843 0.0032580206664783833];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
