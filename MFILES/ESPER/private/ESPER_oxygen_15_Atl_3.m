function [Y,Xf,Af] = ESPER_oxygen_15_Atl_3(X,~,~)
%ESPER_OXYGEN_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.3471206203885044417;-6.2940294930287210562;5.1068764868336478102;1.5856886992860836916;-1.1226880991690446621;2.3773629856481774958;-2.4122894087231130378;2.3806332443372242302;6.5583096367524031933;-1.6141854939463311513;-3.2382477828217131055;-1.920554306723890603;1.6029648641647176177;0.012539370567051746908;-1.2206876582563488398;0.77828999453076996851;3.1352471768814220709;1.4743479829208696597;-1.3094057550688789071;-1.8399145569610662054;1.9675325524708369151;-2.8102900660335676797;-2.4262571557519212462;4.3965268659852441147;1.8056840570526795364];
IW1_1 = [0.67406563197414148814 0.88277667746704502338 -0.41014615722173120016 0.062968881269213974883 7.8500928237939975318 -0.0053729604105976032022;-0.50385652565764516009 -0.63424754714255238142 5.0645572955228477241 0.0027565490162139633969 3.2523523288133961984 0.29002126549031137515;-1.5835736131380542258 2.0779911563343169689 2.7711571765217213326 1.1841154996109217734 -5.0858605225903987801 -2.7169099717218214707;-0.57936487815668769041 -0.46221466575495206985 -0.43832376786607835095 1.2645217798483245897 -1.3641770580013079517 0.48051744605111712527;0.41314676987233450722 1.5636269457704712327 -1.1591029264894201489 -0.064399010443070295318 -0.71257254427573191169 0.54181597569859185626;-0.6590104641177323419 -1.4008011411553715764 -3.6129980396250140906 0.99960066101790145954 -0.55380952674486749743 3.1361838628094345083;-0.26659146450257409366 -1.1513916252759843761 -0.13748964569071414621 -1.0775322024588782632 1.9526854870983636481 -0.91058379900306163357;-0.82155941674388366369 -0.36501987745489983261 0.017510931897682009001 1.6884560608167655804 -0.99471121362418268852 1.6927566366509700924;-7.5072641690220001109 9.4046272577163563255 -2.7949310125264599236 -2.9033286586048774325 3.7219113594970436587 0.27768055491561638437;-1.0759042075034841446 0.29628866074270854281 -0.063654053839474727949 -1.4436726444982010964 1.5410785386906284966 -0.6278102281662467643;2.6396291001477441007 0.2095928513015421768 -4.7502404816078174221 -2.0728756203276672565 3.2746435620801026545 0.62864090338158939986;0.01585451161247868751 0.2263761154849236179 0.11500320766459146138 0.38255214049347791017 3.4061397322810620381 1.1098821660652200549;1.2535557444301672625 1.3622035428792651501 -1.0804442595332905963 -0.33174940668510805031 0.15269871350715796821 -0.080797667130034195315;-0.38026184812922358969 -0.34442706535921518984 -0.64594237804483478627 0.79067919486262927542 -1.7899571150185600299 1.7385107482070938367;-3.0774818079649377545 0.1624512383203498278 4.4283807062535132104 -3.1399573354919700918 -3.2005383408158527558 -0.10901180309731756113;1.5127556226214369239 -0.11370040956411876787 -3.0191320525058973345 -1.2373872576398530221 1.3627588986311425234 0.95865990490630592635;-0.22584502942515177759 -0.054987032438386089506 -3.3770520271833817105 0.054531583152557829008 0.27819224752159599223 0.87857869186259895944;0.74235532054933861534 -0.98566363092493036735 0.21917041096628858687 -1.2965010581798936951 -2.670212538969927607 -1.5020565961564893431;-0.053100909463041488789 -0.27440920847512684233 0.37843354620767788443 -0.49983502588953526713 -0.029458058122572648718 -2.2225704627845752626;-1.2546514853296883985 -2.457166433357468982 -0.63140543265636994708 -1.2541351236764213262 -1.5860245097371117318 -0.11074678297985855735;-0.024133476786251856216 -1.0802748941676303396 1.6243623558319570943 2.4091822150778887668 1.236723766744493469 1.3536035514871840313;-0.85515097426139896619 1.0328835456688176819 0.9084557670260847706 -1.9048149199205539617 -0.66510190055409246224 0.10862508780784776996;-1.1163848232353126289 -0.45667370464509354777 -0.87059184175420145646 -1.2874364081270359694 0.76807563490622654534 2.0345060883188201828;1.2089604988040720812 -0.40038441318866779817 0.54676921085654262011 -0.10304517390173704994 -7.7152983012789491113 -0.59280249712147137231;1.1395000094976446281 1.31722142038007628 0.23515341842176387677 2.053437741290218721 1.7500295477538183597 -1.4484721795465258509];

% Layer 2
b2 = [-1.873729687973064939;3.9134148437440914314;-3.2988205361933831128;-2.2596763524407430523;-0.40161430464569675136;3.7856252233907481397;5.011621090658675115;-4.4207151115140526088;1.7739744206081939915;0.22734592622868138312;0.98188550737210056329;0.11026767869035801473;0.66576364119725761626;0.85387532283527478594;4.2369191850357408313];
LW2_1 = [0.99442847811058121543 1.8186068575175131645 0.049521062041983254787 -1.6359143067645749436 -0.25419863386189084364 1.7407008079600314598 -0.5944590539500252957 1.9714166508182762172 -0.31913518033934890061 -2.570072319052796761 1.9295178770647560818 0.90159058517455659132 -1.6789562799110173685 1.2341609251364351607 0.13352190495628860067 -1.7269456891608714333 5.9310999251056122361 0.12554149424665686507 0.89543943737794740034 2.2834993567374124446 3.102005592941027956 5.6957032380853638287 -2.0486516997697181708 -1.7400485447922102722 -0.18074110307673824094;1.0432243722078244907 -4.4397234079391738604 -1.3700587167032036717 5.226018726128728531 -1.9341589096362161726 0.67707368221592956203 1.8964750053741155078 1.1830119194740995603 -0.42735498895142581821 1.1047267725769975844 -0.79342388267792607337 -3.2612867252546964281 0.8915085982943147247 -3.2117846109581877911 -1.7411915981540679876 -0.85254135394526076031 -5.8393914620207469923 -0.019327768150171481532 -3.1719276496159225509 -0.45995699968180536743 -1.3409319504045305038 -0.70570842802510858061 0.59282575736753806428 -1.2733983652808764653 -0.086098726036701184183;-0.045540523493500892349 -0.8072425766807087566 0.77643965715990970189 -0.7756667258746374749 0.64682276913827640996 0.35087411338817109385 -1.794805542647651686 -1.1666705887577677458 -0.033659400028329379551 -0.078947506192920360868 0.86931864877611653153 -2.9784258548010842382 0.23957494024895611973 1.422663853634801967 -0.65755150475607426763 0.32401081366314071763 0.088674656803387402748 1.888074532480324752 -1.0501533155886870752 -0.25904216664284024363 1.6961670347729973507 1.7310863070709194833 1.8347344269918961501 -0.93982997442731475157 0.89461478463804011696;-0.97564787387179929823 -1.735896880154878863 1.0293132577921226822 -1.9705271002752562381 -1.4657273615214689855 -1.9203349079276037514 4.2282826936779294158 0.40634826689938913225 0.15473448708224959991 -4.0067273684510009701 1.2460024932313675805 3.1795158227203468293 0.69650665171576187085 0.10958252897833796469 1.3683163887641127676 0.6619808927985741942 -3.6186003178084051868 1.1034064633890219298 -0.48052861012572439803 -0.037122305999931708154 -3.1399758456764792491 1.6201704204423019728 2.9379092259039563118 -2.411520333064844035 3.9025795113731702735;0.32792076202874542723 0.85147356664406725901 -0.49748949565476302537 -1.0182592104582448567 -0.69292129626371412598 0.27406009530705283117 -0.95177838502356393313 -0.47259911844772223288 -0.056136619767042386653 -0.35855936437433827413 -0.65005937632799370984 -2.8101665871904102367 -1.2453302557769128089 0.68734132591148167091 -0.63479385871657445506 -0.012245449228637083489 1.1484286137395982585 0.082965730177451763039 -0.66366019588358404757 0.27110535337923402643 0.32508799489886824885 0.36993400141559451555 1.8937107872752070303 0.33679946377294633919 1.0638634765707848384;0.40237693880462782614 1.0812055240938696077 -1.0364663996008529612 -4.1598484215295528088 -2.3719703843520201225 0.73502325429459403061 -2.4165249298359086083 1.6644096092665148223 -0.2112671154244054883 -2.9040105742146047341 0.5471335907877851179 -3.2427036975140479669 -3.8375223869608969807 -2.5849969997563806423 0.8120835131753093572 0.65169412440466933933 1.6241431630085911841 -2.8809545968588796683 -0.18269093186477916579 1.5186975607904025232 0.56542991215842364205 3.3476767706351426845 1.7602973421784902097 0.28462900867925805537 1.7513362018236702244;0.25393067462809959522 -0.69310080320643840945 0.21804030187704476207 1.4075425974461175382 2.1157154466651326707 -0.19036177725095582147 0.60542881007658944092 0.18969393150043076246 0.30470936499140516274 -0.27907650882166978867 0.83006841010045018248 0.22406519363611415718 0.31135583948629180773 1.2019205457838026962 0.69889183214805827848 -0.99365161831342374565 -0.4160648711840208569 0.53173877159315063867 -0.38974612428093879934 -0.15988056738652084432 1.1297059670416917943 2.8844566422515494075 -2.7607241491107541442 1.342116372765148169 -1.6846800810836635165;0.64052586463778049541 -0.46628799349856903111 0.29798131822882356623 -1.0499092096765647586 -0.44817533483457278054 -0.7887701898157583047 0.17735620433438806232 2.6066772269923248473 -0.31301315844974042513 0.58613912139294466197 6.0392599454438915529 -1.0672226766209371718 2.4365519168709601772 1.0483014449792498191 5.4075011017022305282 0.015489733677409418811 -1.1795328151972830355 0.9392437936497955997 0.48935902450110402295 1.5511108695708992755 1.2355503032423853504 -0.019389836279613728576 -1.1607709424980827695 1.5575162301533247433 -0.16200947251408848171;1.1514259101140937869 -0.19501707326287345823 -0.3504429419731827644 -1.0234606093411211525 -1.3586073252997101779 0.052156273344964608485 1.5234503053879555612 2.1986269481044358187 -0.091625468543378690844 0.055913367727110419025 -0.70639431642872119177 -0.068024809465002514242 0.77845704705361573605 -0.19718987331373175054 0.44942291800129358093 -0.20360766462135360122 -1.3714889073354445959 -1.8100542602459506192 -0.13751815451843707461 0.16567255140636427679 -1.3566585727200008993 -1.814420865202601707 -1.5481792769974020985 -0.028167861558201605365 -0.67946139414449657767;-1.0220354810941674195 -1.3187116257849869072 0.27347977027790032478 0.010596585384610151398 1.5011696541160404195 -0.62791247592077570339 0.36095780378572522862 0.45246478089093683517 -0.28367598794881931923 -0.19262074758803948704 0.28031858040431384405 -2.9865208052266609684 -1.3725859517341654215 -0.41642155597248853294 0.51543237226002114326 1.5747340064371264656 -2.8444138329028194612 -1.2333641739385079461 -2.709098839694906502 0.72182907060358869611 1.4706232226770838967 2.1330722551341474436 -1.7856250569867866407 0.59830016535153984769 -0.86626066527117051574;0.80028846145412824153 0.02162798078935738999 0.27998829887449155907 -0.79727257784132488094 -0.0087828799519318115352 0.55923112036966404759 0.18006243083876166677 0.069820887472170717336 -0.026151688925179578105 -0.27426074953121731825 0.28515120134613247682 -3.6159459672079283798 -0.95289910757967133392 0.90118140347688546754 0.73096671941403745798 0.64384451333663639261 -0.69556868109768910102 -0.94466610473645395984 -1.659937129182672555 -0.045205469555701746631 0.67943741913246269437 0.82442123302204906032 -0.40661892350086231707 0.6587583087013184624 -0.51929074586071599651;-0.65587156674596025496 0.86077447573632415168 -1.4856512835906949821 -2.3508331775596005286 2.09486925241948585 -0.11583707959469541349 0.67465494998470776356 1.4020697438150393488 0.43806519614388361727 1.6427580109428701061 -0.57894940875945388736 -0.28723505468221094405 2.1112149234639159268 5.4504048645471669943 -0.64086395297936882276 0.11304954438882383605 0.65955717728974760927 3.9254142923337740356 -1.4945380897167979128 -0.55946270996577562862 -0.54837793323373151821 2.4506300310425452871 -2.0143601522353127287 0.054410637143431153651 -1.3792450422066622195;1.1107902229656767545 -1.0748306859326155482 -1.5627506553996539651 -0.510335362027811823 -1.2922897985392594045 -0.61273866014462463614 -1.5576249888362434515 0.38986933449490024373 0.067942575829330636994 -1.1937808490150056961 1.3356676007518777372 -0.82543352569723671408 0.59166084302312105248 1.3523914859598686888 0.68502997376894825265 -2.4591537745167695306 0.86503573858849569511 0.5163211348898639752 4.3383466755497028799 -0.20217075460600186787 -0.40988247117929416108 -3.2601156418440568885 -2.752853602799953503 -1.4544938101589217627 -3.9718488123838855408;0.47889055113439588096 -0.72035741623234350595 0.029083090142730735894 -0.46041436019573878102 -0.68451124139548191749 0.15346183865713972083 0.2369993149147846534 0.99094151454629142428 -0.10753156948447328833 0.29509003826379598401 -0.40552247879735514591 -1.5697142345526002849 1.5461367042861535737 -0.54737613830234888024 0.21281258820209991711 -0.91833452616158928183 -0.93622580580519498827 -1.1374720575030263792 -0.77647085170430740764 -0.13223908978227486011 -0.39975849533998714103 -1.1701558175258079952 -0.45569139728838231607 -0.85108152156319705206 -0.42771608484745049505;-2.484259732493975914 2.1813114660757166874 -1.9213830315595405995 3.5018170297004984626 -1.2992316723733796646 0.5028873784526391999 -2.4804969698862944227 0.55781664524213803169 -3.711549553224616993 2.0898261990576219027 2.2792840254491375518 0.96108951363799344225 -0.85673955372093102412 -2.5258236421453870157 1.1376146996841260961 0.45939162578133985182 2.1721047050539921131 -2.6658511577041825724 -0.30325247967776070013 -1.3958844896051334494 -0.52712581470324681998 -3.2808371612317217547 -1.0325006816866684201 0.8929791395964756795 2.5066107776626345149];

% Layer 3
b3 = -3.7250508008214500144;
LW3_2 = [-0.096745351141580629428 -0.19648473780668720967 -1.5107221286608838451 0.083026964245622697502 1.3539122434778709803 -0.20079195964246354666 0.41360319470400302988 0.21729074139191090209 -1.9683213135179224995 0.52670939581131237528 -0.89659090814808528602 -0.2237580665690663273 0.092871730001811397814 5.4278096713070507207 -0.33381910688154403655];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
