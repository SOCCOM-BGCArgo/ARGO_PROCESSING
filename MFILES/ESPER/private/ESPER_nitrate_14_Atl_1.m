function [Y,Xf,Af] = ESPER_nitrate_14_Atl_1(X,~,~)
%ESPER_NITRATE_14_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_14_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.4123866224333578856;-0.25436594258054484596;-0.071382634277584539051;38.070247753369287125;-0.73055221348117904689;-7.1142799557481168904;-4.3052627446251685583;-0.43917451558577697002;-4.3226641112801535982;-2.7636440875634327163;0.32883888928560328635;-0.069632277505492973235;-5.7682804446185258485;1.9985302183701147971;-1.3996218567805713828;-3.2315111142280112944;-1.6790641215567834177;-0.76463152366007847149;-2.0084969241118266758;-3.6665999360317620415;-5.7538153519940280489;5.4647704098435214703;-0.17218922283827889363;-0.060567615004422606373;2.2071132969438336247;-6.0619107367894597971;5.7276387375756590004;2.1034530219726588207;-0.86901465234822417028;0.3137433017910070121;-0.86850349231058832089;2.3017398824453829675;-2.8592223112991073108;-9.267501461672967622;8.6767338530571773703;2.0524132245070911829;-3.2696996569255194487;-5.9622924310040943396;-5.7145250500323587772;-5.109038744866123416];
IW1_1 = [0.40879919554089189093 0.49129637046962476576 -0.17847519774674144855 1.4717270869267842226 7.6725556818560036731 0.87062266641990193605;7.8273890854818839458 2.6053907589184817084 3.8124042758250120677 4.8199053015916826226 -4.1255317651099545628 1.8788468922159557994;-0.083933689700253069632 0.19295734806334000067 -0.43248882945426664337 -1.5408257570683090432 -2.9861715272708053703 -0.28986002504230001797;-0.028469936737307900004 0.28024192325915331381 1.7699962851878892067 22.981707811979063649 7.4686380897333393136 21.287620016390832234;0.27870777612686936653 0.044564592473032467457 -0.68851437017126515538 0.61854985476815627088 2.0302002344561231872 0.36608060787964802341;1.3586017729460708736 -0.044941941525623418929 -14.518392554530359817 0.070090509449860699531 -11.703807291622194242 0.48815555583935665851;4.653725307125427868 -4.7560089511940013551 -0.79744423718819645863 -1.7326889017352953282 4.1476003884979242287 5.3551786327961616863;0.027090468954626464176 -0.14314141519893372467 -1.1654557166006604962 4.0271112971690312676 4.0498702749330020012 0.64115278029836864082;-0.23593461723170877642 -0.08346772105556343746 0.65954560931388783729 -2.2938200561674779721 2.8789713933845089144 0.70678119091914737293;2.2629586026278847299 -6.5806138426895026683 -2.8370755892672252507 2.154865603993242118 -0.32479883377437429592 -1.0389227364291584443;-0.34602141299129818286 1.1472162620391603838 -0.76743901560151361885 1.5638973406636240693 3.1631273156128418833 -2.5146167639329797261;-0.51960602061297678222 0.13358902024356958393 -0.94215632891046119379 0.42028343684386271217 1.9351805733524736208 -2.559297226645631973;3.128925487353162449 -0.0029549602794817237533 4.856010361472584691 6.8594959629790368538 12.271626785361512191 3.7623764168838547128;0.055859151533043854831 -0.32543195919255191173 4.8188942657726441254 -0.37428190426755275633 -1.8433071371686187145 -0.87063063180810029706;-1.1453933931457245254 -0.20040331594526414327 -1.422931763835681096 -0.06395455002341779438 3.3767096785722943153 -2.928090037054582595;0.19156106881822893007 0.70075011427290412325 -0.10075193049192503192 2.0275944495618984931 6.1902534462970990603 -1.1804212775774993727;-0.81083741311209145408 -0.24795228605851288295 3.1782128398926960955 -2.6397517790751128253 0.77249169069284373546 2.6603615888815750345;-0.99141232975111204251 0.48236647073910976502 -1.4478868789838794662 -0.29716652552295935719 3.1412668887336514523 -0.16229566179194176989;2.4599498734889446716 -6.8747276025463950333 -2.8476488028503008643 2.4616871249115663822 -1.9394718311887213513 -1.5760908840016381038;0.45382160178496255831 0.25186208757353173437 -0.23863336932392420486 -0.32013183604474687582 6.2433583193740691542 1.3612991084607932724;0.51435484160597855219 -0.041764308055271592846 -3.3014759618670419528 -2.3024267216231022459 6.9072553210234284293 -3.5061956803778917546;-3.0947813248887956483 0.0072481170180616347545 -4.7826660904273010644 -6.7612999532987370088 -11.766669750194989064 -3.694442835236460887;-1.8109164606398375774 -1.1969978134727270458 -0.62959272328117255046 -1.37346053313092753 0.51643581299635854531 0.33800773031177788752;0.19050737067299311489 -0.67598503759374617417 -0.11215670820014143894 5.780021085341801701 0.18466581329744657936 -4.4646918419570198466;1.8455943712222790953 -1.5315330987556572406 -1.0269332720869641662 3.108297601209168981 0.025837491263913228701 -0.58634434727736373105;-1.5564918330738763963 -1.1663358438468973688 -1.214925315471555356 -2.1164295314615415577 6.6010487886466195917 -0.35687897757410508293;-1.6309885647745814286 -4.2002066451618675913 -0.58389363874174982083 -1.5197913515805203666 -3.1809747548884415025 2.3494519778592319881;0.39002912597399669314 -0.099044400306746577245 -3.2348166835720912893 0.47270532529202413663 -5.4948131138137119578 1.9449791919638137472;-0.8240282069860315195 0.40735814663392722057 2.9522561263401612131 2.4147885695711637233 3.2079561776484109004 2.8156534607810645987;0.15963286326762515799 0.060472645789169492125 -0.06361391347282852049 1.1159114168415631418 -1.7928015413675122414 1.3617905312478311153;0.39094772287390877619 -0.040137486293600033171 -1.0460381459224665779 0.93872169400902139014 2.0798382824584296102 0.30127130567152354823;0.42637415854409471683 -0.12358374360567388195 -3.4633897821935302197 0.50769504648251706502 -5.9919512315509937395 2.069538435369894902;-3.2253022917833442662 -3.1355637487398846375 -1.7089160886230334579 -2.0880288835825422389 1.961437930711031008 -0.57696009253647473347;-2.3478835018598842588 0.50953550854157858563 2.1983335624413204989 -4.6960564948927663309 2.0205675912649252446 -0.72138627033990043724;-3.0514105413359868813 2.4274652281151896105 1.5982994962097756275 -0.25159742213137137323 -4.2658121693771313687 1.9224964484122974984;0.84958283756561758793 -0.13968660828761364501 -2.357053166570582281 1.6114177505309026373 -2.3981071503189834715 -1.6409266362735954736;-2.1389805493272970871 1.6928722804061486773 -3.3981420244547568821 -1.0607592760051600678 10.790060668431788571 3.3775498709734770308;-2.5583020605183279805 -3.9648095440752566532 0.20912680637739508582 3.1198867084824377649 4.2478797847653329001 5.8148744864179748859;-2.191285732363275951 1.8759153886503672215 1.7360736835510208742 -3.8136283807999280526 1.9503788836208437729 -2.2631926382168328082;-0.21726525242523073156 -0.084037577933188098434 0.67746976051617679992 -2.6727364301577973826 3.7118748152736338319 1.0076469753120667061];

% Layer 2
b2 = -1.2603775713748766041;
LW2_1 = [-0.45045278287902656977 -0.016631287371702978967 -0.91320554099456563435 -0.054025650110240588941 -2.0003569506177245607 0.034839238132371767864 -0.061550154312412522217 -0.11247259417694289996 -3.951734094063734215 0.20037087116071056192 -0.28210807363041245921 0.56454351626459819968 1.2868487085227144906 0.10560801884996716404 -0.25952936954466176989 -0.32793599102293519154 -0.17188299434791601272 0.27715039095551047277 -0.14800621844810835093 0.37922958193552724904 0.15823680632594880335 1.3246328259994482046 -0.13550330501509041947 0.034517143480227635566 -0.18562472812110816789 -0.12201822943833978696 0.095857843544425294646 1.5834030963068805864 0.1691177420383767338 0.61516584467968227212 1.6607147334549792195 -1.4089501733543505768 0.035910976019808700521 0.095084632873458474478 0.13884996630997933909 -0.43662015065827913807 -0.043707559034962699396 0.018522006921607304941 -0.14338827066940765254 3.0728776738743364128];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
