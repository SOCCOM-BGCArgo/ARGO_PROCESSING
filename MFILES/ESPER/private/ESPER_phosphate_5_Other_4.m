function [Y,Xf,Af] = ESPER_phosphate_5_Other_4(X,~,~)
%ESPER_PHOSPHATE_5_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_5_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7863457101811437422;1.0260134533081524122;-1.224185242906002502;1.5103128508655934148;1.0876390479075441764;-2.0798309944436343955;-0.2779425186041855067;-1.499427472593485966;-0.6949213318638309822;0.88313998992597564364;0.25550941108871610963;-2.3316981552217166396;-1.3333859237672782694;-0.089800514842621803613;0.75544776469053187551;-0.31578077405641036268;0.35491771391892473764;1.4159267567265303445;-1.0366973790196867267;0.27327672095221855475;0.89048085129772747148;0.42715558049342283731;2.743979192450312965;-3.6196805451832227973;1.6534530702471701424;-4.5416615786847538416;1.0747560605275430223;4.7292795925637260979;1.073475700889211959;4.4315311591763064669];
IW1_1 = [-0.7043469044287895553 -0.78670234103733682751 -1.9442849063961324951 0.73458577023145144036 3.2706776078428352328 -0.82594640744312963765 0.53989748017763783405 0.029083452182986923445;0.19839611766002993032 0.015849079800374671345 -0.58110887907530561769 0.14917424991124142442 0.94610445739626969353 -0.16488255289961167849 0.68356698307128538339 0.15516362555817944657;0.52497949913808683586 0.10578768552270920167 0.24867194569100753432 0.38739156998031359924 -0.53591427954819759183 -0.12229477463769214407 -1.0526834841236596407 0.020138752744147982165;-1.0161056853543894984 -0.45222771349837259658 0.62071176564660091035 -0.22674097900917825066 -0.4478755817760558533 0.92913949742730150838 1.1944212852643807388 -1.2572805604540651103;-0.60986668532276655519 -0.17937707263794760992 0.40499895247957745648 -0.14011589919125322368 -0.29236380292078417709 0.55910651446372228168 -0.090749572674022033203 -0.32194947840074011891;1.6444412504733258995 -1.254005185090897978 2.1867734033090644452 -2.4430580187904520351 2.1128834541342866871 -1.0449823147883243735 0.17392969732619975587 -0.19195268193966499859;0.5706924849372001507 0.4444953430328170696 -0.57745643877720642667 -0.19753662562467111385 -0.23241843517587704171 -1.4471914969953003638 -0.29716919505161881743 -0.034919308802003744263;-0.59468988676041845132 -0.072313756985371555053 -1.2489335967051709009 -0.49400735260106765079 -2.6815118829359771979 -0.83218984734539092063 -0.059477182356281674269 -0.98889472270659362074;0.17206946269682268924 -0.15271672882600470511 -1.4447540862600989353 -0.32974518121096124679 1.7114261699171331443 -0.52529364955801360892 -0.71076801093977337587 -0.26979874591903996173;-0.45321623497757212995 -0.59686675168805403136 -0.37122833245033748373 0.47007298524861079736 0.85259858939065658046 -0.39200232108284738253 0.98932109109600530061 0.36546490444862944624;0.77117126606664931909 -0.94128223023501689237 -2.0147995533240226074 -0.60581538731814199572 0.43393570387803959143 -0.0051865130394014311369 -0.9037299064635513357 1.3764903750305619301;1.1718601372824548612 -0.40249205992884395933 0.39874550146981702081 0.4059643712751707656 2.7778473020876299771 -2.2062479706113435896 0.80904642497839440729 1.6430285952450560671;-0.357367773033217484 -0.28589550891313147973 0.3747808087041605285 0.15481440889207043199 -1.086266413714622292 -2.2403084811878750671 -2.7560603499771350045 -0.93430022123637557208;0.033628010448224228413 -0.49867909227141149486 -1.1681971904727908029 0.29707473510326226629 0.7956981241591409848 -0.19624301732480869953 1.1295596398185943077 -0.46673881295209018738;-0.60215898285156388425 -0.55110258655903754388 -0.62236709568162140727 0.014124064683590925595 -0.3553473744463946371 1.1240423631226732493 0.13319127473026809438 0.057852006246978462944;-0.67999158073437038219 -0.2923285602032322239 0.73086224979102409893 0.089979262927728148602 0.50245117470977518348 0.70061581333217881618 -0.0014234594638507847876 -0.29363715956112401706;1.099529984702550367 -1.1753979258356932469 2.3834599517987906658 0.15872375468834720724 -2.6042824456047424242 0.89298248837853599902 1.3450043625301111305 -0.20351823832574467144;0.24829855975953132874 -1.2909026272721904061 -0.80187656134138896036 -0.37599181738010328813 0.35604594131653449773 0.026375553625210084591 2.7208162845305956523 -2.3410881261739704406;-0.99605858134267943882 0.3782831227035379773 -1.4912928815001382787 -0.1078283426527271438 -2.0535364762383374604 -0.02536472037191825693 0.27626455035356767276 -1.4562909131550823005;0.7041700979447057529 0.011204526875814350972 0.079984979842492961999 0.13118127630167392139 -0.60642126191650680411 -0.16271594884240792034 -0.23623585162487883982 1.3957913510935118229;0.98092442168478977127 0.81125545616196170773 1.5351835308389041312 -0.82685765301898328516 1.6283079667450617301 -0.6583759945633350652 -0.47257465652579810911 -0.79147812798026095926;0.14800277342054579677 0.38503785852199284845 0.34845641014722184003 0.072939800263253737334 1.3293674720187587113 -0.01016247165719211254 -0.1292548641862047154 -0.87483631237991577034;1.0944933804206160577 -1.1035986869992617798 -2.7017112154588569517 -0.48280439123077895092 2.8811560070226649444 1.1593156726963451675 0.47584634540510101219 -2.3417376689663629286;-0.59855343237022029523 4.0118153394519318056 -0.55253591995555051408 -0.0056947976976648266578 0.72615477158648966682 -1.0416631112310184015 -0.48563596240398765325 -0.40837527652226468522;-0.46645958057090897153 -1.788245334544077636 -3.1221930450754502573 0.65547242600807786861 -6.28657308706279494 1.4795349988785373441 -0.47200609151326211599 1.5522892405623012202;-0.46541211657792086465 -0.064944394228571664107 -2.4701054858256874525 0.25537366463673116801 -7.1779140951687612215 -2.3695368367033866619 2.7906699715680058915 -0.13173761451552870594;0.12740264113639268584 -0.62855653796943378175 -1.735342749036014931 0.16314900173034524444 -0.22698819681327617181 -0.75250139666340754019 -1.875167628929891972 1.2104626406978089559;0.35251088409933589718 1.6369759959906438063 -1.2108519777984287913 1.2075017175305573502 -1.5269157906452412998 -0.80616000481964866786 0.6769122994617505773 -1.1026185129011543129;0.21443742485693706445 0.58854594289327344381 -0.96543798389670010263 -0.031655046098010515554 0.91174798134197465593 -0.60329272458546367996 -0.75213509802325484443 -0.99519472867168046193;1.6412454678428181065 1.4133086681852617961 -1.6250615995795374413 0.021886557457695694773 1.3795062899177612525 1.9782145726528557184 0.46300182464587735787 -1.104620018543569504];

% Layer 2
b2 = [0.87910094594269871937;5.3232125648319534861;-2.5615002277071265979;-1.3422373212456009117;2.4300698359524659509;-2.6208206504641351486;0.45617482038675249978;-1.7569776248637729577;0.34541201340639104966;-3.7244432223859522679];
LW2_1 = [0.34803324855035649987 -0.60221796234166535822 -1.1810727048815898854 -1.3397995031396812138 -0.15582491454056213165 0.24949682920883245463 -2.6692909678125351647 0.19950163991855091039 -0.41336915766035514652 -0.37131492273877841903 -0.39227804663950632813 -0.31348239694650270604 0.18240864930222833173 -0.42572357411845995756 -0.099947656352484773312 -4.6301437259142836922 0.27570075649432773668 -0.17561860986251559558 -1.185529309402291176 -2.6039257823007546655 0.22315124592319574015 -0.75704965302290017082 -0.12762437273810134375 -0.096092141418455540025 0.21827629807444454135 0.41820877550808205347 -0.48491551643717939468 -2.0402210187479181691 1.1127770231979710047 -0.7077140326624526967;0.34473890294260134404 -0.2903949664165130784 0.94734193303045632906 0.60883093358952644625 -2.8534168195278413194 0.063176297573877840397 0.78658519796860104645 -0.0021023341469654545366 -2.0084703851781289252 0.91115989566298671853 0.53093772815532447318 -0.65024027087781532952 -0.22017310643696005878 -1.026500203646984577 0.39741128018058730076 0.64083728727066446851 0.22092996139325296601 -0.10824149939745940363 0.35682658774696135451 -0.14232706309266329736 -0.047112466112407221097 0.40530413186833619266 1.3408488633780717425 0.0047857765884257632422 0.041551428045812008327 -0.44419735394961712416 -0.070789510087940515914 1.2734094435774556686 -3.8097942128381605542 0.54401663779097853002;0.55433384626700155096 -0.60426033800024858689 0.36373644089377044075 0.49878108685440991632 2.6972648433350081554 -0.29235637293916555413 2.3133831842418399738 -0.28298704847712302657 0.62333951805478604591 0.71089714872322029571 0.56004618548272189216 0.28506787321707260929 -0.18209279350015444843 1.3531038402512245433 -0.53311871167481506006 4.0701212623158111725 -0.33961224844256099331 0.32305411888610657822 1.3300719765629849256 3.0585031658179815395 0.75592276715256379038 0.95463408285980244639 0.31552421794561658075 0.13088767114380209233 -0.29596200110626302848 -0.69710251774499432109 0.3158676898110894804 2.9008266062529384222 -1.334905180059783758 0.67098799047000579066;-0.20437750805325172188 -3.0086770141959569003 -1.1111565049076079781 -1.2794156533399223541 1.9715975015213389465 -0.0040176030632680598612 -0.53874272323594729617 -0.072645473925531556247 0.60575428240643069966 0.85814799160082244622 -0.33917547834976213839 0.047318974858736172207 0.17459549812537553115 0.71648410942402662727 0.14017695862184662015 -1.9043613834926995665 -0.011981445893528874444 0.077830766167112472309 0.18690493259544949112 0.26898934069900531929 -0.13831831479440215293 1.076639375877939564 0.14261286850336299392 -0.032561107261435587312 -0.24879750541191444912 0.38770162666980628741 0.18341317478706864463 1.5977423952017157927 0.21245230302363277142 -0.76306723676910626075;0.32957662067289678065 -4.72026962322716237 -0.30995396654971357764 -1.381201313487898874 2.1155942825422329179 0.37614214525026667957 0.1653903825344723022 -1.1505111435338994941 -0.95469693490244211809 -1.3096805336736867531 0.48189855505344908471 0.25698949032459800224 0.32806264724835926261 2.0488826517537548355 0.84892468608148874409 -1.3346858403714005892 -0.39476646857707198279 1.3952338306925369249 -0.33248852810053602935 -1.480064460577376062 -0.098710074346697068703 -0.68127611646118491073 -1.1734432087863018168 0.3543317321626070493 -0.11541095290865152623 -0.45640545164391693733 -2.1813127066288990896 1.7284213814006206267 1.1538907713954458245 0.74300178214193757231;-0.77231464576366293251 0.73961959533814403134 1.5616473918451587721 2.1397830105600803563 -3.5572168327952482514 0.094037140335305607897 -3.9633853467828843442 -0.91071349722441008456 1.0143923080391290537 -1.491653058381732011 0.13924343969866079251 0.10639581699731051612 -0.15619718798272919091 -0.89424603709513383887 -1.7971698094216259634 -3.775659396171448634 -0.39721492767679206226 0.56098094765954198415 0.38342294822822403644 -1.0729303573767821067 -0.26995678474407885927 -0.52933897043925071113 -0.34188944712082092181 -0.34190926391309017784 0.73797047165231810517 -0.070090206873231877815 -0.17284219325159608238 5.5248696505614578456 0.4556793556461210537 -0.31410780015712425062;-0.062396741060989691086 0.35091432460225979728 0.98063579438292025614 0.5165959472982786238 -3.0991678128213164811 0.63451039298003442113 0.52510924289626426109 0.57585155528220255405 -1.392719830175784157 0.49690062259901279784 0.79560512724659615547 -0.93670040615851557497 0.29962291530042783894 -1.855566353893864262 2.8582305457477694688 0.50928614502680236154 -0.16211481505470398679 0.017187322803759827461 -0.090651621174847152318 0.1514562042619088944 -0.78886240987527134205 2.6208358533609752428 0.050419168784177272047 0.23317564424312636762 0.18786628159367546598 0.21432067394972806329 -1.0527400405220561641 0.34296550700929279154 -0.3349739907849388354 0.47974380955793971548;0.56915164755934188889 -0.90295284950211929242 1.0154885944483516003 -1.6968509649460417066 4.1886873839665996755 -0.086452824565354163822 -0.046957056675546032798 0.21637277326227447038 -0.72369118444110291932 0.11775075728888471926 -0.10332265855308855884 0.22586698153112211296 0.19923104205140512724 0.87045457643645374191 -1.1273618806743277432 -0.34299641210894904475 0.05010116385173370851 0.48856961949602611961 -1.1436936346560453437 -1.4250296439176637353 0.691442527022971265 -1.5132379941013438529 -0.90551790577661106507 0.15049914680490397711 -0.19027820843832080056 -0.073623485353311091117 -0.32049393470029868825 4.0873674710700127477 1.0354018589127484962 -0.52347664959685435981;-0.42666061785666054007 -0.68994613908503099609 -0.40812022332036324013 0.20602783774753966051 -0.14458932851391845253 0.06380693197033292241 -0.10861009534800197818 -0.31271690614078173631 0.30496519712998609863 0.50983146089429476344 -0.046618796540209388179 0.047292912346683556313 -0.079290400317085868442 -0.16143767431492689335 0.026388253468463344908 -0.67268173660113372847 -0.16237456611764053416 0.11235723312736280166 0.33202656925610191108 0.2855225525770559436 -0.50950969386717348542 0.24631892029593641102 0.15029340607262178797 -0.058049043899215863052 -0.10096707946813926471 0.1400093030682999784 -0.23183863071224644625 -1.2921142417721873663 -0.17557297859865916845 -0.12096166017029767736;0.30760535409532718809 2.5587480140610914248 -0.50064254782321293558 0.16861584548795699456 -4.0998922932985388812 -0.050555825085667471797 0.44916216996837077247 0.8243628345363155363 -0.78326705722856693193 -1.0695823348796829055 0.054533036401633726287 -0.08453148716679416419 0.38948324495253205946 -0.17381210668872545955 1.9017253296331053658 1.0861964229497655943 0.12822119098447570806 -0.27625853021486113104 -0.16340962568529113219 -0.58522169407689783593 0.68083390674061272652 0.20657379613907053684 -0.79358884960918207874 0.26149022858029546956 0.22682437200819821621 -0.17418560073468758453 0.41847853836745035894 4.5675760106428180407 -0.62727194692452503677 0.22209696380216942257];

% Layer 3
b3 = -3.2245617450863668374;
LW3_2 = [1.4348640166982293831 4.4389867000308456113 1.259693879052240284 -0.43200664970956798028 -0.18683954102363434235 -0.22382869823849715907 -0.18950473858558131157 0.31598708063259778323 1.4829920882046760955 0.38340250015772564529];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
