function [Y,Xf,Af] = ESPER_phosphate_8_Atl_2(X,~,~)
%ESPER_PHOSPHATE_8_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_8_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8909329144721063187;-1.7549083627295452015;-1.7688694986978403811;-2.8014047951611513732;0.14705508274143525016;1.2816689603739670478;0.48456282899582125978;0.77983080594748555026;0.92043190028272092729;-0.42509001362173376437;2.0536597909623659497;4.4651125347036506597;-0.20336232220061814524;0.12288135177408149312;-1.0192072663137632382;-3.6349857754487642225;1.8070636577390135624;1.6251737260446763589;2.6144213162853886523;2.6355146941386911053];
IW1_1 = [-0.7013917719363069736 0.7446675164450526907 -1.0905234341630758443 1.9530468119083057577 0.84627717792703738287 -1.6523918157020280884;0.55620996757890728279 1.5140011808662381387 1.8221946835386961805 0.11453454368072354952 -0.85265063784805739111 0.80509973934842116172;0.9757035085953611464 -1.6270590600629692979 3.4979738101011359497 -0.90882340863462041103 -3.2121036346177258558 -1.312758566218938272;0.22929003664089805947 1.3635920162460368754 -1.4901620928287393486 -0.76256063903518289671 3.8571114234185239766 -0.60503279023536549186;-1.6085521962876352386 0.39159993590570663091 -1.1178402852103874743 -0.68231308981349547693 -0.53996346586208432416 -2.6660430856323733551;-0.96813051685623796594 0.083202269925955182894 -4.4179056551519853002 2.2911386360981826904 -1.0277953107861188542 0.76691549673855019531;0.50795361962870877459 -1.3457554812739889183 1.4536306302177068872 0.52783555552674055189 -1.7954287513495390538 1.2868130476842822851;-0.031630929413164192432 -0.28896886744034322447 -0.60652560388393161883 -3.07306192859813887 -4.8395560970610143059 1.2706380765081093376;-1.5273958315124482876 -1.8315026412284001189 -3.2063721968024312403 -0.5644170338914966667 1.2664551067984215482 0.58857373025834758273;0.71873385769087905217 -0.72487777760425475826 0.13913282082644387594 -0.78071453543647240103 -1.6996907964200358432 -1.0742325702322776948;1.3626160460321450341 -0.0085114880751393853786 -1.4106153744247948989 -0.53120029314882166727 -4.5708018903008653666 -0.94546957310751500447;0.086112911104608461099 0.19531662728429433074 0.72486357655416122636 -0.36204501202358013723 -5.1209691083223347619 1.4619374076354565428;1.7667058812309457405 1.3813417054252148386 -1.5087517750972425645 0.031931545587517713713 0.97552130011716653435 -1.1092796863203968627;0.51238866133119365109 -0.83044788099832089756 -1.5642009985776137437 -0.83539816873037331391 -3.5869439462280423569 0.81834729613766299394;0.54282061304212403385 -0.21028828311554290109 1.0994249163825446924 -0.97878167321391873479 4.0453764760419357316 2.2373040532806300895;-0.28106267815065466564 -0.99271287861964252475 1.1267328886660801235 0.77443463122523570341 4.4627810961583715965 -0.38536066478443670169;-0.057121210018207038694 -0.0084302211806863529275 0.14985237398429268607 -0.98423326776470221322 0.82821250396980494735 1.3983424320525514872;1.3314527620653882067 -0.65920798098484745253 0.18942428702608241076 -0.3441423714148531543 1.5212112424436365909 -0.67287392015359792641;1.0825876048260387741 0.51450265070279033175 -2.3697483799218628242 -0.86204584481718327105 -0.79261015045358662601 1.3147374205712918371;0.62287876092640814818 -0.9416832628674474126 -1.5130857233953149965 -0.23045115850379788158 -0.34325534452909284289 0.855885488514444015];

% Layer 2
b2 = [-1.918099438792335576;-1.6710357275879341721;2.4728208829682971626;-1.0442146813987007725;-1.8497969714102162619;-1.2978501502106214449;-0.69640484178631445467;-0.1209258811047985438;0.3373855780234614743;0.11443489937757847508;0.25516163336612729395;0.2116022774264290085;-1.4641546307812156602;-0.29689341676180996954;-0.99753493010445870581;0.91971309403299239538;0.046850056941991229109;-1.6677316734167868528;1.3354746760437201658;-1.0237032583948466602];
LW2_1 = [1.8081433144295919746 -0.62631471135575356168 -0.27136537064670424035 -0.88316808729513185394 0.1837241867695413311 1.0032451284922814239 0.55388714873938182937 1.306951482076882165 -0.27781585305587402912 0.70814402583638880184 -0.75236930968519000196 0.94810487353682637579 0.25671214074227294288 -0.0048337107420136065511 0.26812732801180666486 -1.3476944402766282138 0.035222114783186514453 0.12535169915694840959 -0.52321904018428488925 1.2564149107733608712;1.3483831572817712718 0.34699715301443312399 0.63960694186155753194 0.22853418762231564321 -1.3145250865793478567 -0.11168188509270349229 0.10020311763744288447 0.36113146977842536245 -0.29706598796072875013 -0.59958358847370019085 1.1136127279996121953 0.76215558701753316484 -1.5840133926975419332 0.26105575725865470815 1.2345808538164548818 -0.36791683971062438818 -0.57321396270701507891 -0.23717877612232152185 -0.75051583531683541128 0.59747980651220955473;-3.1074165463214584726 -2.8245580949433719553 1.1012509707486415333 1.7652058247968580584 -0.46788008795581320642 -0.14169739130391814652 -0.4093227410001580302 -1.1320464963924448121 -2.0904177629442135533 -0.091367117070717179805 0.34463085751092059628 -1.5322401618085736974 -0.22828268964761394555 1.7124772965854138107 1.3747071826681562801 3.6837576885273874971 1.1311060911325052647 0.54549018489313694236 1.3126287846246389446 -1.9592705772575511602;0.0032667015753077531526 -1.1393439931528077658 0.92420621755920639995 -0.74620773542149743118 -0.76371575722669027275 0.35031079901324757575 0.28778977292604823734 -0.95801096443441202677 0.69712613321567196145 -0.69495718390335259329 0.6734875886350357721 -1.9140659766832046618 -0.65412227984866933017 -0.1826658140044235823 1.3768865546185107274 -0.48869416108125246501 -0.049181487692602408879 0.75309725125185067451 -0.16289261648165132002 -1.5761804535999726085;-0.72963625124589304161 -0.77840002124029505914 -0.069919543077623519389 -0.63190695856216927417 0.57077765616825071326 0.54735639042325956449 0.40491417405691015885 -0.35510845375748090191 0.65341397704649528677 -0.51071214217929672419 -1.070988805405188371 -1.323383063431940343 0.12725941094598980374 -0.33199573506546170565 1.0365489787174677616 -0.95064629335995110004 0.10674565909097369354 -0.9612215031762548767 -0.56023810226741077578 -1.5164582465542075784;1.4593065237231614972 1.2934338950222479259 -0.3605628379444321685 1.3208650690290886232 -0.56074272894669441314 -0.82310827166363398355 -0.47053391691875368075 1.4834065789845234384 -0.5889634738853453122 0.7417735212511716858 0.11408650491039196151 0.63339188111641819834 0.18479718077390952513 -1.689750851737419346 -1.1104572849475518037 1.3532070851652759913 -0.055731194488430654821 0.38616817797409808133 0.73125643687123698111 0.75290655280362506208;0.77559855031071234244 0.42452908630806029944 -0.66126357215641362597 0.0015351105832756839487 -0.21905272453755972317 -0.67866105671610144068 -0.70337087477075244113 1.1442016720941357022 -0.6358244483956068116 -0.035325341895006079351 -0.11774526257801444518 -0.24132879139684307312 0.45091517460600255562 1.1372346784122653318 0.26219835205842084713 0.12418330414917364002 0.86505720771812166792 0.15445796786967019854 -0.65635313090561508975 1.637904294575532882;0.80585981808073214872 0.44232299795886032001 0.17737657644030077608 0.62315055890050108367 -0.20078270898698402647 -0.38244017596647844615 0.72882560937965745751 0.059776128617152181344 0.26556942121154192282 0.53816896949509540615 -0.10940471745798327485 -0.94286923356047747102 -0.50262031396687245621 0.027023180175846560347 0.046020774987875059936 -0.25238655850195101937 -0.066997223232219502154 1.1399577925653425758 0.73209552009338885181 -1.0380683718818897177;-0.5360227310370010434 -0.81055257482440834504 0.13866920597682494409 -0.44546267974687159263 -0.095923601987504603095 0.76869906224516360016 0.37366182469379954911 0.014847865473432152877 0.32435692680569327973 -0.62698263876300508457 0.30565655901582278187 -0.31274807836746626455 -0.18038524110337655904 -0.77913319474760367456 1.2051140353682976425 -0.15840592639277026321 -0.43048596877597822274 -0.014341368674583007681 -0.54598584702339658659 -0.20151878990794369617;-0.20826883944830537621 -1.1182720568440500664 -1.063042328064471409 0.12959753429859086071 -0.52107662938341881009 -0.93361139348819632833 -1.7510979785765192762 0.50667168908581217135 0.87648839202493611378 -1.1092407386912608303 0.10899877631592741478 0.86426889987375543623 1.0153486926523387357 1.1688146491816107098 0.14546149572109468018 1.4466786094118870842 0.25756895596269013815 0.49140609680247354651 0.34361259639978991576 -0.79155027244985365353;0.81190909363136154475 -0.59231422819295842519 1.6398036165028455624 -1.2383167413124338552 -1.4956908657808765106 -0.016728823785901840437 -0.76115659170989247162 -1.8526773733361987517 -0.69411309718623059872 0.035674835875699181797 -0.91574679668867819959 0.27109591164822172127 0.57182051524990173963 -2.2265285418545892604 0.47974094158117458475 -2.6000387439718868343 0.85810322004850203559 0.90070704607254425955 -1.7509454254256733297 -0.3257645339353623104;-3.3392725178133666475 -1.8175218366034191497 -0.59209480429453476003 0.58679692748356682142 0.88920837122955409537 -2.1960046428577548738 -0.4697126474010844821 0.29811692390321237189 -1.0863302855661833846 -1.3071814944359299027 1.3202605126840536443 -0.39143825462565989826 -1.2008735654182360886 1.0240791003581470875 0.46323317617196446694 1.8296969760817756168 0.1572139066591385359 0.46203367355797325677 -0.082734529582006860471 -0.90430365754815500434;-0.82983302125760083356 0.56048892561590391015 0.30251742237823880943 0.15673349700243283111 0.25371785898512616564 -0.71064463681987721788 -0.87898840678796219539 0.14524791057518868231 -0.42040682631725456719 0.10369331135279603873 -0.1884845974441413663 -0.089884274675124359311 -0.54045655351895383056 -1.8120261416261072007 -0.22784871159178474165 0.48029083291451935001 -0.58706945489077022593 -0.98074718480838041224 -0.43623820167355781274 1.4379545423894688483;-0.10753448657059376525 -0.44268387252279395305 0.050732074252950849769 1.970933038788751146 0.61739469417902537174 0.27769608881754082041 1.0702472892329237819 0.90617373365996423118 -0.039712242809623210515 0.20025743108282728633 0.92557786302149658297 -1.4428235358153145285 -1.2512591570725082324 -2.1728684862412626089 0.22698585662276959951 1.0878328137744934789 -0.31436270829311907526 0.50530288837121284384 -0.10214502468166132554 -1.4340388563417996171;-2.6558714902565561111 1.5422816784446231608 -0.908022156353103016 0.28130725593433647536 0.40884582483642795125 -0.55722368004440669953 -0.20104112086843090035 -0.54727435878008534598 -0.51320541562688126724 1.2362639801650077143 -0.25894843186224736353 -0.31775674387824898171 -0.8156667183389455511 -0.23884208358327863042 -0.60338942231457426413 -0.46299114130705470993 -0.64585563612129526234 -0.0055643250672961566683 0.61963302597328473453 1.5238258392393690954;1.789571013770244079 -0.74419015187878578832 0.81397859931500449182 0.027462539180953725315 -0.10223825235066699713 -0.52165885788332932993 0.034736970100184484667 0.65513873502780373137 0.81282923321555744511 0.33705597674364179417 -0.99982364259630274184 1.5065394436531933664 -0.078318457375918762442 2.4373685958980217947 -1.5310294969007602894 0.49606925266127804841 -0.75125427208090445053 0.082717345076670389936 1.296343444401734768 -1.1916891918598713218;4.199528298500275092 0.090263310708151703321 -0.011102970203170641969 0.50879549986790573168 -2.5551900790788790729 -1.9877416037674036087 1.4688176913893558062 -2.2909173935350937157 0.96689991453478518757 -1.5967979575856507957 0.49284438510841144243 -1.995622701758674733 -0.31127791692366718612 -0.33556168487262871825 0.84298028627439924865 0.097410742797314639474 -1.2617065537079092952 -0.81662394838957574894 -0.043229126607485804379 1.3108392273887166102;-2.0106074920931744643 0.45487688697187722564 -0.79898539061206863554 1.337075918132271779 -0.045191884028429163411 1.1401953527082999695 1.2307593949572406267 1.4719545210207980457 0.55823564152687354945 0.28107308475455677899 1.0910277456456496381 -0.65978897584602524962 -1.112655212896552559 0.41075463230946968052 0.58811733236450225437 -0.00050317422307454701125 -0.19007855146463986662 -0.95565506815910283844 -0.31389806223724603385 0.083384798192436604403;0.098844210997993384171 -0.63586474783671975697 0.67280939650123161577 0.52890578988869529908 -0.33303422290828998964 0.95501484339585063221 0.25423306579567306329 0.5375366949098100422 0.99405581857971780924 0.32142869301404702886 -1.0397949061458859887 0.2981065836999046148 0.053848147659902201312 0.0055257617194727978727 0.57119047624514651673 -0.4702844076265417228 0.11862300832523409166 -0.22580302355557357874 0.60067566048031262316 -0.94243411408339849977;-1.1285577607611878559 -0.16864590594202627516 -0.73095020720823544735 -0.22735012656582909152 0.1914745028137791738 -0.16047930439021770854 -0.39342151738661201854 -0.26198621327521004476 -0.52360273779608546008 0.19252491017111883487 -0.25571487248076568699 0.53842165675282160908 0.016415524783484267829 1.1634828601748630206 -1.0732664029061884658 -0.36408516511208521838 0.29246482475025920023 0.80034097157560624147 -0.023513114818817633378 0.30759289370193010349];

% Layer 3
b3 = 2.3014353988217171043;
LW3_2 = [0.67406635819103799534 0.69848222842084695117 -0.27709909027747453569 -0.94123989962847609547 2.4141053917639028192 0.60695707456002123692 -1.3957840526349323262 2.2184065348385386685 1.8319240020466220908 0.54901969694461005833 -0.70959010698269242567 -0.23264787533815378673 1.618109101855864429 -1.2069859269544125357 -0.95616787761655541722 -1.0295156567663008573 0.29465647392093174961 -0.66837664085129466773 -0.8241233217285744983 1.8981569919394480905];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
