function [Y,Xf,Af] = ESPER_phosphate_8_Other_3(X,~,~)
%ESPER_PHOSPHATE_8_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_8_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2734896690428099131;-1.7515302639137788621;3.4458514314933550438;-2.7772272906247308377;0.86465036940347184125;2.4096530358288958951;0.053407843105251165405;-5.4048743033016402038;3.2005296779483134451;-0.57572959411839719213;-0.065622946266041773389;-0.37964648685423751928;1.5641317223439648032;0.83074620990006908805;2.194359092098091768;1.1641111209775445445;-1.0284967702078462448;0.24971310883663661029;-0.47443049634248402047;-9.053679383775868672;-1.4267495649008266057;4.2155934204253506792;1.8443620836334932989;3.0175649089616527476;-2.0628850665005060705];
IW1_1 = [-0.67606012568858275813 0.32291789313769486691 1.7510994892665563416 0.21605638532055382317 -0.59756053586973312264 -1.3169065303912126375;0.13078710260066991888 -0.1543901980044809219 -0.60967366556331559213 -0.33377624123936022738 -3.5343350102835358051 -0.98568605796592556612;-0.26402100559180713413 0.84590858910244093316 1.0345844641096417771 0.48751420032378650626 -1.4071091013605061537 2.348850030850599957;0.37812171692054574734 -0.092372318138871617466 -0.59137287224864798496 -2.6531349940661321796 2.9677695364436189607 -1.537034735470740543;-0.31027481720862309933 0.0065942186947013509135 2.717959544380268877 0.45487838848953726645 -0.58650742327950222688 0.22316978948855661913;-0.93254938537962095424 0.48607203247849556371 -1.3259985990156479829 2.6007994588434910632 -0.54230749108111730994 1.1752108393378608575;-0.50613731819440066495 -0.75291977409230625984 0.39801846956476627515 1.0371220750074898742 -1.8125716256887889344 -1.2200319455852679518;1.929744027662663397 0.85238794487784985687 4.3366644458713246024 -1.5747400246943032975 -0.38749897859824083968 -1.2125068538325498579;-1.8971925419855071304 1.121382924523072866 -1.4785577670876759449 2.9538235183330296962 0.36253767099402456342 0.88892702738870643664;0.34903283906148580007 0.20978374824469828153 -0.029762971170329895199 -0.01002943075103617486 2.5058018702899320651 0.3057523485997767354;0.29877938346398114078 0.10892118862975759541 -1.2199113351325221455 2.1866682399368762013 -1.6026342486588716074 -1.699461422009021172;-0.03424513376221987454 0.97872698460403662057 1.1532212432762001253 -0.72878446636915517054 -0.85639263044190871987 -0.2418851943679785621;-0.048409530862018587682 -0.40065052756203251016 -1.9214990555503246306 0.76392051528794346904 -1.1975944819616297643 0.43223753426159489122;-1.0243829085735303153 -0.37172397121245304152 1.2660123942810750375 -0.11299657405777800701 2.151497551777316275 1.8380048377016704464;0.17909043597284241001 -0.06117797814433015291 -2.9071274052562827706 0.27728528109342232 1.8651958640840584636 -0.77944612411285096876;2.1776082108273064897 -0.019504106921524218266 -1.333210212340359524 0.65743493155682064533 2.5249050666684498268 0.76001267655747362095;-0.38884876470697077311 -0.24514090319748413349 -0.69941569843736151046 -2.2582988039592559737 -3.5596053193541283832 4.2044253537051083924;0.68808964902967972854 0.66444869215844049037 0.49033987542898227474 -0.38213301932965587637 -1.5360541775533207431 1.2272475490605245785;-0.44551816527181226091 0.13482860014504666202 -1.2962396061088590216 -1.563552025831296266 -1.0150683761646397407 3.6385704707730317509;-1.2863753256336347697 3.7989887249119216328 2.4014191769220043504 -5.1922599278847805238 1.1470647902455437528 2.6809725162057445047;0.062091397238028936401 -0.40272291001560750479 0.10453337339931532968 -0.20673392150271674428 3.5934064006526083013 -2.9872117382530669616;2.951488428307267764 -1.5169291111897222901 -0.94159867479434700144 1.0990813351420334332 0.69095553884169924608 -2.3933438381777700776;0.27467857457572969482 0.86805223510986351254 -0.62323358682234730743 0.71210690298217749206 1.4092074141998347514 0.43739130559655658992;-0.13617532755391639765 0.072162549551779406332 -0.5293821755715739652 2.2445363057956959629 1.6207355095404509804 0.66494140450057448444;0.11256666008130399026 -1.2326204587399576251 -1.2435743287228644416 -0.16482389454042983834 -0.82319000616390491931 1.2537548424542515058];

% Layer 2
b2 = [-3.8624499030104959552;-7.1353050396403112643;-7.0677303923135310626;1.2432477419151730658;2.120926645200331695;2.5421480201532893339;6.1029268216391869828;4.1653041435662450098;-0.12633868028535139016;0.040447773395053676637;1.3767496751108756481;-0.093283685461855253562;-2.6302028142182680703;2.8932243853206940365;-0.037934008554724826801];
LW2_1 = [-0.11093507055581876275 0.98376625811717754999 2.3818377958633507596 -1.5341719042030337317 -0.45961320573812231016 0.11468127697714020075 -0.29753455651544691296 -1.6091733604135969316 0.32932993437944979576 -0.73355116267150377585 -0.62399794050936652212 0.045384827643258671137 0.9433379548984811569 0.86474242780101584493 -0.30614337885017450791 0.26390854413736880568 -0.88976483478362333734 0.29198728926470141065 0.67235533627647336985 -0.060107926060159945492 3.0856776902436142684 -0.14533393550357431856 -1.2212508897289588994 2.9692577157015578315 0.014140669486634338536;2.6967846716429799692 -0.018870319054647931994 -0.7750322022368352215 -1.3564770772228613716 0.19881885567492185718 -2.1831776222669274645 1.0292977004324423973 -2.9742770253453740814 0.72945191665050379548 -0.0051730095765118670054 -0.67107202132960286356 0.52058222589243252632 2.8729953936055543373 1.8164948475974282971 -2.1965143986835236056 -0.10149025342133635719 0.47283345700515244658 1.0447622257685049707 -0.84475781684207973399 0.36581533560424372986 1.5186903337186636875 1.3051501217489518414 2.8322210178052600327 0.75482457231361443917 2.4357405112684373805;0.31153450171442409466 1.5509697128471751082 -1.4158899596481857586 -0.3600647041858452968 -0.67566651294428592411 -0.4394202909051471706 -0.42469602347039181467 -1.4462949534839724119 0.46082483429535242569 1.066229235827670152 -1.7350487712633537729 -0.031042514146278090553 3.7149905903774049776 0.53818347094025509314 1.3163458235609333258 0.093629656464032151586 -1.9666166927875110559 -0.25664581277764542122 1.1218893250120101079 0.070323167859836596683 -1.1328417348570509748 -0.11497601587252220812 -0.37012930589010262228 1.1739891821618220202 -0.41628652963228746087;0.34059182575077867616 2.0447716760774130584 0.64871309450826353249 -0.072634452625166295858 0.43228917384155590709 0.14621646494320097998 0.4160965953627896452 0.22308124546394061949 -0.23609497066285092814 -0.37963572979656629025 -0.59311983789802158462 0.020051076779353169816 0.28791675637887548245 -0.45255981759636332296 -0.57456220810098268537 -0.11195377386282881482 0.57316183541588661132 0.42087188335299990927 -0.8057301814006643248 -0.12220579133359901758 -0.56073030465711282133 0.25354180031999062894 0.19713844729501131536 1.0154732106093447008 1.1771163862308404724;0.41264688794111359371 3.0824463271713047341 0.65296188492365303535 -0.15137690714975257644 -0.59003493319070532408 -0.10915935866010625932 0.083143284091393598878 -0.50540392450752036346 -0.049570317868419817853 -0.57233043731793808995 -1.0605488335487478491 0.12230902379236345545 -0.053339281529479670718 -0.22082317545711857565 -3.6048558679575872787 -0.15182302856836973892 1.2760566990539554677 0.36771429092896124047 -1.1800683614976150704 -0.15239854661991827922 -0.45783352391562837091 -0.19074195989524950212 0.95303164363263748182 2.1086347139469916456 1.6464519969139705946;-1.0382350237600617149 -1.0644262857548005829 -0.26103258466480794286 -1.5503819607970679151 -0.59736052514580706418 -0.55789187410020468771 -0.603903378157852333 -0.70159098992599089328 0.55856147164241554126 2.1051537539340365868 0.99845914983236139228 0.98493328441112748539 0.21830889247732324088 -1.8489627611651158201 0.89493291073329495067 -1.1826427122565021932 -0.87834308370217395456 -2.7241596411292450242 1.3336453835778099286 -0.022051244275781003296 -1.2668613136708202216 -0.41590106487664463275 1.2394730071937631877 -2.6947794637117254979 0.32833851702172628384;-3.4574626876633134387 -0.5532990990551285293 -2.8772878082154624835 -0.65523758306785939709 -0.13366398794127587468 1.2259549870287369533 0.37885399861851754011 1.1209238432118400208 0.37045482062129420076 0.33334869787446130829 -0.30788856029953282079 -0.32211242805165718472 -0.36670544240471647512 -1.6524403638742020117 0.10523521006234830277 -0.93103033846875271617 -0.12259194098392479921 2.1420825997757564352 0.49312386755343723399 -0.84485783927088631273 0.83698536595651384928 -0.91707461743932561227 -0.38674818394442062042 -1.4764205342349991934 -2.8666686440165403127;-0.41664869919320374203 -0.21539054039602281709 3.8832744808415391446 -2.2657799080999891927 -2.4624267099070618059 -0.98956850765130310865 -0.26753491573398530123 2.9546932739761913034 0.82570778809557288103 0.16148179959090372404 0.47273727131678183744 -0.69573110390567272088 -0.10939286061619277191 -1.2186767134961471459 -0.25321643844468644247 0.18435138826696523262 -0.79624045196365589305 -2.4361485515539742508 1.073802384244141539 0.44813752823033919936 0.20248877150564542626 -0.74911662123885636166 2.9864358417725074268 -3.2097707825787988867 1.1250652140288690539;1.1720877465906658355 -0.45446920074518465382 0.13176675495474002298 -0.75784947047343242943 0.4338284335824766913 -0.67762344324687984187 0.49853103555337369146 0.14488186746497339064 -0.50015910456858680977 0.14077897186660343065 -0.76344526050842731468 0.38794896804968237447 1.7978609277496779839 0.59598451030003152251 -1.4002547396912201627 0.03182328632325560902 0.71538482086666177473 0.28008637776869671487 -1.1910962562976166179 0.13027367873530429354 1.4808593251577282235 0.14007533617677064841 1.450136321953113594 -1.0256537694062868304 2.1774904304872522154;0.14977611451021777267 -2.0874698293153874928 0.80285185744350451298 1.756016391826923595 1.4084417732332494833 0.8450958990700186968 -0.19625602403599345935 3.6205877070609795432 -0.2756353003591757167 -2.5181123653119699135 1.2678769544050290108 -0.93181088137728951271 -1.4735277673360713813 -0.34523084453377828051 4.0513104917496738366 1.3577727007792574909 -1.0706150500534095116 -1.5343285596849944863 0.26025064429544741973 1.3214655656743325984 -0.95591357179047609094 0.3468021188205620553 -1.6430828354532847069 -0.7919184278903526053 -0.77324882989476506623;1.0035304877121842271 -1.9254102660657710366 -0.18731424637213658912 -0.32635848330444500176 -0.66134677937938213255 -0.80904477313854539222 1.4277968979720316867 3.4630929921708597519 -0.80316179576791058015 0.56086296372250576958 -0.12262850822249138361 1.078311357663945369 1.918059325113017799 -0.75947149020695869925 -1.3009882347685317594 -0.63078039836468358104 0.78673984427057608304 1.6290841019209336693 -0.21569697547667357473 0.95262256541945133925 0.72449646226287855999 2.1327108716632205976 -1.0445075809153512303 3.0286071837293699893 1.1987954507768416867;0.011742758376390948633 0.82578229543243186761 -0.91132634626594366534 0.18431705089889036109 0.79311992104860640218 -0.68153846460580269628 -0.8287628621023938047 0.6561007070613910086 -0.12877037665778967579 -1.1698641375985390223 0.34911341398486961385 -0.25857263307607658565 -0.18435833418451474941 -0.2520701946220620937 -1.058369557964496499 0.17664504684492024489 -0.45192063874454746486 -1.3803580950361591384 0.35800496455816588348 0.15158662950918866397 -2.661017722867808466 0.50953345263425231515 2.464562570004131814 -1.0906126777259048666 0.21081126739907926626;-0.60485269397691898696 -2.4664724411122764813 1.1401896895654264341 1.9516475336170475696 -0.6112651162458362375 0.64326230095390513064 1.3268118832162438814 1.3193394962838429496 -0.45905715281279679818 -5.2015419655072046012 1.7796937570862521039 0.63892630930571625569 -5.6860082614411897595 -0.040346178789147590926 4.9475274657222616526 1.5163602259729380695 -0.72612104900659735218 0.051319211509710707664 0.63728718857449762059 0.23199950799721774652 -0.10927706407945769751 -0.59617513942649069669 -2.3543724090776478874 1.4858680623880518024 -0.60179064565126527686;-0.31012772171726421533 -1.1175911709892800694 1.4742150753098473004 0.25263596584056158267 0.52618195710755188976 0.37061711883721876193 0.18334993957058287606 -2.3881131868173954835 -0.41969804706590996268 -1.010355583867227125 1.5291568302738929308 0.059503284082019811119 -3.7365202646462787328 -0.48377570606685144083 -1.2670893024846365815 -0.10375318307251252259 1.8896416076500481829 0.1744682885012899809 -1.12190148769607001 -0.054452499708506747755 1.2784482725088643917 0.10091649145582698432 0.28072950425343334846 -0.69299324924301031192 0.38008833811512243717;-1.6250273759889555247 -2.05299082313369885 -3.5793014048565279239 -0.91670535566967159546 -0.41781975892027112263 -1.7618801571392743721 1.7881701970629653164 -0.89011090565686645792 0.63762344819209115787 3.6358237635086276818 -0.053251511209501140032 0.66182813766972803382 1.2107183030137367297 -0.75168293464153479455 -0.24231811470934927488 -1.3108875427366768474 -0.25212778502815758053 4.6234986457278823835 -2.1942541756074542825 0.8168685959101990024 1.2661069015796047044 1.2173395658476342529 -1.8070194584590530962 -0.6801810685598710382 1.0727394605512472481];

% Layer 3
b3 = 6.5751770052688858215;
LW3_2 = [-0.34677652827308802497 0.51613867920669220801 7.6567454046495591058 1.2953184464298330703 -0.75918036618704654028 -0.46661917993567547658 -0.58812191507313249517 0.49133099383438222363 -0.8669248285876280935 -0.64889987812328653316 -0.22936542321274219769 -0.54761185309722903991 0.46442785642965755954 7.9579570412161020343 7.4196447090746335817];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
