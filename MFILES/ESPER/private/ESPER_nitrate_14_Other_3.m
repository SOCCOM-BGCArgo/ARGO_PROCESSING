function [Y,Xf,Af] = ESPER_nitrate_14_Other_3(X,~,~)
%ESPER_NITRATE_14_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_14_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.2633328917433965799;5.7946680902166418647;-1.2354602162356296269;2.1872256251283497264;-1.9010872697197171988;0.93436144309164126387;1.1762341305666486058;-3.1908275069990983397;2.3139807916953638589;-1.9283812638848030208;-0.041537128424853103636;-0.35764740431754121763;0.94064639342991251958;0.85253588460695639561;0.82703232116730840406;-0.67103001699119069201;-1.071316949500307647;0.67699139798352447883;-2.3172269951748596384;1.5849151739654667725;4.7705206468224155003;1.9238303780793788444;2.0459893094198946528;3.0643882917305531599;-3.9184132862026981314];
IW1_1 = [0.68797812448870332425 -1.1433659629665260393 -0.4512868968109307044 -0.19668838794436638295 2.3546786618217794285 2.3453996657080216082;0.11048260364338234607 -0.33176068815784354182 -0.92425648171502072792 4.8622288791611190106 -2.4627393631521941053 -0.18662520489053469053;0.9995170846705145884 0.29892348953754094287 -0.11707637435387431568 -0.22217635991973538889 0.61350945920841082337 -0.87896674286150844324;-1.0754949250730334587 0.981058319569528825 0.22549202351518782272 0.53710678992809846033 -2.232267613920905891 -1.040311719426153525;0.03274633296522948267 -0.63399044619709854498 -0.52564721644477152562 0.04139874020278400818 -1.9897924218991880352 -0.75234996647574892137;-0.8070490731024428932 0.25934835568286285223 1.6332634601448239309 0.225679502372443469 -0.56506606435859840776 -1.418577083862085475;-0.27380346322593085429 0.052639720905438426579 1.2773701594538759974 0.59351801685813188048 -1.2751288673178424737 1.2519008661973884955;-0.20543312115969994402 -0.20121924992784040453 0.42558587542166764761 -2.8267829116138627477 1.0910437891746023187 0.6909338804770123188;-0.033016418955504903132 0.36640499862190911706 1.2027444681553753902 2.9327881803055952936 -1.8500314136457887138 1.2075142285089757177;-0.37916559025280111017 -0.26831373585037510132 1.6227655905376623391 0.51178121844564272713 0.030097945050586077942 -1.5745856999654221919;0.48484858963723415082 0.13460846243706506287 0.13355468287896715696 -0.24755401605696095158 2.2033983663731362412 1.2221273396469862771;-1.1010530534231808275 -0.9335276072774663092 1.324441924079786892 0.3440272698257190731 -1.1824746901588545356 1.1759922056938136858;0.12770011879595030702 -0.36273220582259324551 0.97493549522344080671 -1.0365137571140847772 4.1223350013093265076 -2.2567917955013672149;0.61192799716998835802 0.18775900164303713225 0.050390998219366579802 1.033418367657710446 2.3327185861864259131 -0.31838125359317936969;0.78881393958506662578 0.4806468207780154045 -1.5929036308230519747 1.0163237472088091362 -3.5522904973526840955 -0.50738939926070381059;-1.7232701621394523883 -1.05971329846292317 1.333359658328190811 0.50405187156429076545 2.2484358212576500691 -0.989500590921262968;-0.66891222080309487019 -1.053020545667143093 -3.5949384993800137522 -1.0196647773648466195 2.5468186065151252606 0.25587276787506840758;0.44911324009476022434 0.16946254165869573116 -0.26234756270886633311 -0.69492385099393971792 0.63555991415507151476 -1.0824875860520166704;-1.6925877776854687529 -2.1546211258070662176 0.35468281160324288681 -0.51430112690467710834 -3.5413505054327640842 -1.4509552604660875819;0.4158989245989924699 -1.7163814133871948542 -1.5852008016760548159 -0.97106893525282078627 -2.3934307856542456072 -0.1967848338299016675;0.11298683862778381715 -0.12961889850213637043 -0.35821750209858721492 2.6301436716810795424 -0.43973365217499588153 1.3998433878634202188;0.8931970266706752426 -0.47863888499778656227 -0.064973128390085774231 -0.10738598510867145008 -0.55370522718707249066 -1.5264301417291659124;1.2853568378817119555 -0.037137983114122877226 -0.051412569397711854746 -0.077086397788991997682 -1.1479713610114170574 -0.46090833556849181152;0.3566486780990136829 0.22335615624443430627 -0.92574712371849998682 3.2297327433767457627 0.98184929024769052042 0.25177522762097415132;0.09326041041428798084 0.36238634221962179316 4.5353016996818391604 -0.3566485169645632336 0.019971651480437394716 1.1195436439988628585];

% Layer 2
b2 = [-7.1168077244258487468;1.9181595604030283742;-1.7201945392564326198;-0.984036805296942374;0.37853394668038231607;-3.7721642324009923009;-6.8168924515654039098;5.257119439267926353;-5.3157633082037776262;1.194328034457561527;-1.6081484862991244356;10.680058680611859145;-1.8373451405520653257;-3.9515571967285927357;1.7489184877726540179];
LW2_1 = [1.877367459427318197 2.635970966105337876 -0.30018140044467944705 0.65229009559895523296 0.9600047277692147496 0.018777415870626527894 0.60156753107953087056 -1.0342848457512077154 -0.35762609686999585756 -1.793279944851394303 -0.091815485373925115331 -0.40269530407256354243 0.70269531778802352129 0.78171039068999437216 -0.46171165375138728537 0.031556794358918574539 0.36841966762489952725 0.13422975148955987312 -0.16243614021924007718 0.017096168460107624004 3.1135091927555476055 -1.8558911261405035553 0.61274267515706370979 -0.48784750168211443722 -0.56273444717486287292;1.8252793955517798707 0.064713572467013757983 0.054904538436216843156 0.69523317059027567311 0.14925902695872472759 -0.594414435972065891 0.99568710096982060431 0.95326622033530694633 -0.31632409653841547792 -0.0040733651485833112516 -0.80484409563014169819 -0.30448397832100893012 0.17614844846912036669 0.068771649495778866545 -0.20092074561290007573 0.21334647383626853534 -0.0051146993981980217597 -1.1805916084600935889 0.46312379723542534959 -0.18031228216843603329 0.65262139117688600098 0.00069519181213035467076 -0.11167563852741113628 1.2921142033740093957 -0.068818552083522277485;0.34386898379251323865 0.40291448256912987258 -0.40970625963360285393 0.9828203821414766006 0.61060031761864652644 -0.081156064942473460366 -0.22999448755669563149 -0.23091773639825069475 -0.063484022068320974941 -0.12347300027647559184 0.35690309076076737194 -0.16507838506831951086 -0.025079473688924314861 0.38468279987688719368 -0.23386644773073270165 0.1208337599196729617 -0.014862741236542829221 0.43110611290292089048 0.12443328467140900295 -0.11755667840973295368 1.4688821104731106804 -0.16972481333888397859 -0.089332174900575600507 -0.75823084416142816355 -0.2414024487491592541;0.80065120454993943255 0.14364070659316502399 0.31083960624522627425 0.1003758292646198258 0.36767942865570740762 0.223638301694269237 -1.6763439514164522048 -1.0093193808880078777 -0.18259723010741971128 1.719020888060815988 0.80596487613461609278 0.61504732083590796243 -0.28601913795584632538 -1.82627350930974508 0.79209565353065247706 -0.21673553634879796914 0.060720224003217422581 3.4108338596242187002 0.11908373259187066129 -3.1535393145272871962 2.9920571209974315963 2.1421102627830750365 -2.2450340819418932448 0.11851267567255126256 0.69835297240547644648;-3.2524631183262044942 -4.8548278670441504801 2.7932425903830773173 -1.703287552675150085 -0.43759420072632931875 1.1985439642656536829 -2.4772952487631441088 -3.6679050079008024277 2.0946737487670161748 2.4692106688055699415 -1.0820663105005519089 0.5642842643635426203 -1.3930834214794760584 -4.7865132822560294557 -1.3127605224337313139 -1.8375110558328855426 -0.30684507631149915419 -1.2721309407601140151 -0.65287269277528880984 -0.0033444151154149647995 5.9626951354120985016 6.203047689705107004 -3.2820493792391305377 2.3379859566913143709 1.9514686037230786209;-0.037393632858813356801 -0.073299441378107649259 -0.094019486633865029246 -0.20633461591537652358 0.28954726992266388574 -0.0061890716869923067742 -0.052334209675633618086 0.22735966715204902755 -0.57962745367725132528 0.19362908891402097478 -0.32189880291886185937 -0.29788000631300853849 -0.35609591202553286804 0.27297816172627664688 0.042098697124472700404 -0.43020862878374360738 0.057329081685864265172 1.2009075525844161714 0.12058110211708160386 0.11900960088081302679 -0.029307353976956253272 1.4368486757387990416 0.28064752301541645574 -0.30214286469059248308 0.46015392375694869065;1.4397846713151563058 2.0266236005429427713 -0.87887167703446322786 2.9167722883769062747 -0.1313765296871959587 -1.2771330482998635159 0.88552460676994493305 3.9073453145195293779 -1.1025235409003475429 -0.53499518332308138024 -1.5901248427907253014 -0.23457936480208860242 3.0288925923809646434 2.6352396546465537419 -0.51076723477631824633 -0.67087306687303482899 0.4290994529869244789 -3.1792845572233670026 -0.70528442464000307144 -0.54431187246514367573 0.27551955911442677083 -1.2817015554270096978 2.0850942923230721959 -0.44344259937005947592 -1.3445474383590845235;-1.8128252280440526611 0.67952268861634357311 0.12308356029939937493 -0.6006072532094705041 0.06016500915236287772 0.25036261591466052456 0.21184215444060738864 0.30519322414819971545 0.19015667509511713362 1.1685074988845012278 0.72755144341033861632 -0.066436636395021231305 -0.30042947476638659499 -0.54274627332463032392 0.11971798497910174364 0.21684148734245542456 -0.17929859470772702146 1.1332899500556443684 -0.14299583820891934027 -0.28558143363328303277 -4.9166550322562736497 1.027077420757324111 -1.6675919139577031203 0.39873841813518812183 0.13679859526572454853;1.6942724874826118331 0.37345124696941711662 4.0437516822604342437 1.0645693676863037247 1.8243059335416100808 -2.8586499315529572129 1.784571805168829961 -0.90452288345963038907 0.2861627313310518006 0.29603284063358981104 1.8396262783649244277 -1.9590077856648460131 2.4931203790672706866 -3.3404372577486500795 -3.1592345944995741114 0.88517903034945011331 0.92681206808256033636 2.4229107793617421507 0.50220121882653101508 0.18632798635942238175 4.3408090165044219688 -4.1751332043395548155 0.63509717161611156655 -2.1064052469154397329 -0.33345578377376916546;-0.21384041037667911311 -0.10011079241904621839 0.35930946560433640879 -0.56788575224482351622 -0.43654388951498412919 0.041395641264337861009 0.21436457871855477131 0.41633893215754769201 0.093124632365996926064 0.12644629304358265265 -0.24449464798946449196 0.066044743508220496442 -0.025999748658481654229 -0.34491280392884993145 0.079828538835820819775 -0.11103567644383224855 -0.010737457753750076841 -0.097700568367942483561 -0.15599006280005625613 -0.080508851895059213577 -0.90818621619289685576 0.35039536416445643541 -0.27873669951045682014 0.68446771301675923826 0.19526578153852616748;-1.5417404811362207528 -0.19622609664039830646 -0.13608423114608853011 -0.51371531928313396431 -0.0082493294780630541108 0.61681960751941233845 -0.96173456249033562049 -1.1421294827077288492 0.25913491741779559607 -0.21283303614261989134 0.86005750830117522199 0.3459174852087037455 -0.090985291844619162194 0.096527187571127076593 0.18244933434564772345 -0.25509278496418824611 0.082677060400033308696 1.0931969887815982112 -0.47615849587247038865 0.2387548926209794864 -0.84675062230648701078 -0.044422797758337413676 0.021507142669559071307 -1.3886889606736314562 0.099743032752112936734;4.0516586334374444789 -0.96652750545132415372 -0.41962059462228756823 1.069533037386400931 -0.84335966666088568733 -0.83770846203803528418 -0.027899303401683527015 -1.9818482814529372327 0.42017822411919075742 -0.97489279055491029347 0.38642942835973864701 1.287859706859845188 0.64190705410146842169 -0.27148370290105489078 0.70143518237738899934 1.2094449874045174464 -0.044873723873400203632 0.4080608098656373639 -0.78286186890280351491 0.23092972771783332187 -2.8033574194421624348 -1.5693725018808404315 -5.3651318263560243693 -0.43264127500233667822 -1.1705415421320835012;-1.2160856450468844336 0.39988661515337486918 0.48669219167156940742 3.6349214864452523699 -2.908495293597241016 -4.6717772383136582093 -2.516113540610103172 -3.7111088993080332266 2.2811987967626490281 0.060566159184312018393 1.1171652868625956412 -3.5667796174582928614 2.1917767817685422926 -1.3214049811249293231 -0.018051275431340350897 -1.4134695284951581673 -1.1312765155475172918 -4.493862627516117314 -1.2805525367166170625 -2.2591964937925803625 0.38995010583630856926 -0.22266018121989386569 -4.4872979136940758238 -5.6687512166642290978 0.0056282965752388752767;-2.1798454212209441572 -0.49087959010182730113 -0.10994750431458913398 -1.7910030678920261238 -0.99935652974880107013 0.18884566846959416342 -0.039454002210387313643 -0.90406416047672844005 -0.083223701637497968231 0.88992957567521246975 0.37011487973392170892 -0.0060295938409271020164 -0.076549504540988966284 -0.39609963858362223776 0.30066266953034254117 0.31560521901787264021 -0.062492424421556683201 -0.43675107127633494564 0.21508764540918953734 0.52492445833488021734 2.1695343769811139545 -0.84199680080477290467 1.4111427837015662057 -0.093473835281630501814 -0.29602003307295371437;5.876750732346221362 0.17387191040114391427 0.37840284317474831566 2.6557423167544058629 -1.2646814097826921675 -0.72440736556280538316 0.76597833832054551539 0.65482281949202381099 -1.0001347501477502178 1.1485664163394362358 -0.64350104254293349904 -0.71317465403775470723 0.15357672972686919888 -0.057630570838153830082 -0.39561401157769371384 -0.53190632102173340812 -0.023929613682582864115 -0.75427743200617203279 -0.010616911267999684654 -0.89212037364093221825 5.6203658108859437803 1.2418569311966178859 -2.8403727334678889882 0.5317497744038421903 -0.53373473831423012825];

% Layer 3
b3 = 4.2309211544723774878;
LW3_2 = [-0.91592034774432917743 3.8680511398646935106 4.2618077739383775082 -0.23958684782572151062 0.17785303144598402225 4.2660736561244343434 -9.817997710389212429 -1.1438236309465086293 10.767791582277569162 5.6164787598906871224 3.6857969276297226635 0.89020899318815460699 -0.047675166864132548228 1.0426079599231539152 -0.45169964037153081948];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
