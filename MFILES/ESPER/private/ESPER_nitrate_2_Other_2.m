function [Y,Xf,Af] = ESPER_nitrate_2_Other_2(X,~,~)
%ESPER_NITRATE_2_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:32.
% 
% [Y] = ESPER_nitrate_2_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.4869954959869629008;-2.8231046372453749704;-0.50567961237965564081;-0.7768394978560325681;-3.677833842777602058;-0.46343651369454402777;1.8091866172836936766;0.32201657758582441504;0.53877858568065217781;0.2250229517650611244;0.53542603788025644462;-0.70743702344160075413;-0.84308484935280569861;-1.017731451773915774;0.99532603542745989866;0.75593279976878158255;-0.36257463174282228424;1.1613297823224479899;-0.84263580632837742357;-2.3127872334093977358];
IW1_1 = [0.24961666426209075387 0.012490880348154612123 -2.2286125402078522661 -2.7167632957268188498 -1.0434765336400819713 -2.0714407846124016643 -2.398028329493055999 -1.8784407396488476127;-0.10041937716742128928 -0.50736127615309534189 -1.0807753256818455334 -0.26549673007042040584 0.53972327675728970497 -1.2828353790468864926 1.8348066824841222644 -0.52260511692309852272;0.078815859925933123842 0.0094408764163111183465 0.35434132084869041091 -0.66713780336460182241 0.77344823537055840124 -0.637798800447738512 -0.41349089548562301122 0.786784013603295862;0.67461431411890193655 -0.069586290895977273574 -0.43729518582640680702 0.76261756627511900763 -3.5436063988503825328 -3.2937259038279202983 0.046136873578616843794 -0.093537260171121974772;0.25268332488597472496 0.016312110652562737678 0.65823144729877791637 -1.5902500296991146644 -0.67251705693252450402 0.95768904145644639936 -2.6073410643455683378 0.69847346499200024805;-0.32973759028818172556 0.24812369786422441842 0.95619715516615189088 -0.54059106256523403733 -0.20223926360469235419 1.1162216242567692959 -0.21952240661311975267 1.0694579704481401716;-0.24535332753201039013 0.097583192918870340082 1.6033794918376000904 0.13121640178892607365 -1.8123013603631152879 1.096949309711815701 -1.2456897552855186184 0.95886098449461176774;0.091600035758625672488 0.1733646808574488829 -1.0062648491044023924 0.95614017593675248996 -1.1747318425874031522 0.68228026343991143854 0.34274122766192799405 0.24858257506899933409;-0.033099515641828565482 0.16243730313099677409 0.33269091438621506418 -0.16372538386231028085 -1.4924511879428667971 -0.17075775479813312674 -1.4866943798505360963 0.34857603253088043083;-0.27127001325489930039 -0.68309701445889903226 -0.04174913443969464899 0.52485221364847711722 -1.997370046682646505 2.1024502169032386334 0.63512070343994597721 -0.064954074120699881179;-0.38651815217784502021 0.1586181662755053734 0.21877613985107796646 -0.32895248275699318086 1.3730660109025891735 1.4650846716669851943 -0.6153293416238344582 -0.30672481506165871767;-0.61987260005198152601 0.38254099249189321696 0.30903986142826583849 -0.30599765390527183806 -1.4923022826753291614 0.84783881734649557682 -0.031291740468660900198 -0.14920806814591083822;0.013886466671044744164 -0.034709143337582001876 0.11012461044374123598 -0.10129655972393074304 -0.84709999232320010165 0.41991643166801639886 -0.067981193911277285058 -0.80767688968314643727;-0.35705618965241869844 0.24007380679881923369 2.2474522499350380045 -0.55471768480364735954 -0.8676940700713436927 0.50010005308996496876 0.60559040483779469355 -0.13388421118322210712;-0.18620587204231178746 -0.075944805171001258937 -0.20173964149760006959 0.15147783451512500386 0.51208893264379873322 0.7439703750617032707 -0.36687088803943018744 1.0750014990640519574;0.77425340666730801953 1.2742056784831494731 -0.74283311953694752816 -0.5669113666334185675 -0.83817178487382681951 -0.51741278332892137737 0.31514835248891148733 0.057649005932516358963;-0.035652290036001677009 -0.023121869616263217295 -0.65934377272869049147 0.71814699926342273617 4.3810421813918409839 -0.39813282523319698525 0.22650772207004510328 -0.28244554899027202177;0.45389890356076384448 -0.41005911857577159729 -1.1373588423773699496 0.18823656303689567659 0.78549826773427200433 -0.74341012752416191223 -1.1440907630146961438 0.60258262561306519256;-0.62118179534547079967 0.45771550482022016482 0.42357981391376453573 0.35831357357098708727 0.52739348455943391158 -0.38762912524506498713 0.25060041069352151366 -1.3047970901478525008;0.064293058006538464366 -0.16266577961618552961 0.36123793299585921224 0.089194230012481418024 0.83809153792376755998 0.28050201234440752529 1.4298564816497039143 -1.8451416593429090796];

% Layer 2
b2 = [-1.4563994755661289204;1.2892198685440401373;2.4718607512617856159;-5.2294636746928855331;0.73679986887801862672;0.79389834566381312086;1.4175522193082399358;-3.7576504964533827824;4.3044468552357351143;1.245979245554841075;1.4855669487773839332;-0.059214170801247287268;-1.1396632294547048847;-2.7150645443153433867;1.1211762524992605616;0.99763697237544557428;-12.511676722426154029;3.134161348608988984;0.2116544655779285522;5.6771822804282150443];
LW2_1 = [-0.12959720770228175257 0.18195992237380018142 -0.1553180608594998402 -0.21833265990468481155 -1.2934941471718377493 1.4140436968757743585 0.40360588811242192886 -0.70133512353593430166 0.52499862747118919426 0.45082756878311464055 -1.7870171798070448865 -1.7540567356760228268 2.2713573589308779788 -0.90673493470873600675 0.22842509804353561265 0.63052894241188894853 -0.56844943712052697915 0.067510461214665279384 0.479963262501958976 0.34176124361669069085;-0.26587562219735910718 1.6210207010389561244 1.3911154433938750508 -0.002635452515878300081 0.68892190085787163856 -1.7728532702637160856 1.0344886639570418652 -0.0027983252356597429662 1.21799410976681588 -0.49524426963601592133 -0.85231640393666641131 0.52545777361261558625 1.7330404184120415945 -0.18981785104995907432 1.2019569051595060394 -0.57481901351780251286 0.15182004824491115991 -1.7026373557413732041 -0.042424485997136017479 0.72454966961824096572;-0.11614664250485771946 1.8629957470805822428 1.758142640670581569 0.062479656493407503826 0.82453350653598389552 -1.7102151665240361567 1.2041906779321456256 0.29636037633747247533 1.5472658204845339824 -0.6352136687025020656 -0.96715811714820831835 0.43077367800654620122 1.6544477362248515284 -0.29406777128613220684 1.4879496027396603708 -0.8256620599539081784 0.13902472223482442715 -2.2183931543645569739 -0.070733392744814618802 1.3958013159017395033;-0.166351193497714267 -0.61592546634889200341 -2.1423957665940620565 -0.7431422997583092549 -0.27068572235751831023 0.044179725920829970853 -1.4613614846012452642 -1.9837114903692030232 -2.2578814583986304143 -1.1955736534891991951 -0.21810929800831041492 -2.0330990514991977847 2.0685731818605890275 1.1082049820785890848 1.4354528118412075433 -0.52653443022593826583 -0.59087277486079681221 -0.23039379594769757165 0.77095947636291561889 -1.8744623099628485718;-1.960904217154709972 2.2779309929601279094 0.77911945201137988715 -0.079522814602443328558 -2.6489262362441259313 2.7685845087348948113 -0.99288716526108555804 3.4171856398223070528 -0.67988348939777398794 -0.80586872517373442371 1.0890236650162123944 -3.1525478483556002018 6.6665500007516591552 -1.2213016925356463549 0.6104796045193148224 -0.61744172218490334103 -0.036761449116718650232 -0.17954970066520148375 0.9070472459861710357 -4.0636910820285194745;0.090539791315324025245 -0.33186215211275049697 -0.59202799354486934647 0.3506087859106548632 1.7282011183631051932 -1.0958451003484368513 -0.65433339149079328134 0.92975958541800818313 -0.50724404091027575081 -1.1027742185395836838 2.2739459442508329623 2.5043751116201193874 -3.4365077770357390641 1.4822863310120548697 -0.27321514898751164679 -1.0167851609066278495 0.37949795403119412907 1.2980945074722349819 -0.53828359346607002056 -0.43325198877429021982;0.24655629130507819569 0.82021988226408959477 -0.43316438677028873405 0.21280199401187641084 1.2344879509699677733 -0.86554270949773959298 0.42867603936054254898 0.62386970561691668102 1.0278590350174718893 -0.65686312303428573411 -0.13407845202407051022 0.93001674113933008314 -2.4276442733726328882 2.0437047069914320296 -0.77609007795763862436 -0.24079603197173712892 -1.1583467600560615196 1.2791185955063681945 -0.14804075576546293913 1.7982106074150157049;-0.16629549993157680121 -0.66173064785487312189 -0.32673928275185171177 -2.1321377841262014741 -0.72905185790125182077 -1.3650174557981984425 -0.72428665092775590395 -1.7500163597789244463 -0.60692724206093762174 0.1190713794080887622 -3.5596721776034812024 -2.6278418761029760375 4.3282208426978359128 0.44831472241150349678 2.1908134824781466676 0.25932119901435379816 -0.38542923808033952016 -1.1416123922625884823 1.5103738887652353728 -1.0321806298664166768;0.35760576456030140902 1.0344949859582799334 -0.8320858723801428658 -0.057776544602237571435 1.3942413423888253554 3.1076794000783776184 -0.078901165871581607769 -0.30144942120135764796 1.2193325936331169679 0.61199830990331893776 0.45218719137073554171 0.69676871726613165414 -2.8090053144017561593 -1.3085870837715019022 -3.7066093380426861081 0.34878370419590537521 0.88695444289962876994 0.23897525125187463191 0.11023284449104375771 1.0585744929878728726;1.0032783690471904769 0.083550100156403239726 -0.040150826500646802364 0.72484005497088732639 0.1823064659469175175 2.6225962941110250171 1.2129139290935047057 0.68988720372316092444 -0.87028954741664110717 0.82385482068868565175 0.81095116803159195129 -0.46136740207054166563 -3.0835589315519396081 -0.41658541165565149411 -1.3392236839052937825 0.52921053541887286276 -1.0466525378526787549 2.6653625741487450007 0.55048553105739062019 3.3056797962733499574;0.42385514371118071519 -0.30409965430662128094 0.55358335908074207676 0.30139938197148713472 1.0969862210319683005 -0.25863123993443476456 0.055609297886071232253 -0.27078601341462654739 -0.50198217041567416707 -0.63012697273641682383 0.059935497836909136515 1.1127387803141608469 0.29041568289227187583 -0.90174403282092085998 0.51950896847874772355 -0.42733095923385422399 0.25885942035069653411 -0.38719220031037027141 -0.30376556360604611839 0.18928607630807539608;0.44513289080950790844 0.93753024977497489978 -0.61200295727065223694 -0.40090402512128914259 0.60048195250843550141 0.031647166749402003139 -0.57937262576669046332 -0.10724612414184681031 2.6469451233020619974 1.0964234906248739865 1.265939513731577426 0.34841369334514915579 -4.0727933024346603119 -2.4352529309410364533 -0.91231247919756808251 0.25998917937628601704 0.49635280023302175145 -2.0778812660674232937 -0.62175325467422903891 1.1346582472093191818;-0.5346507795370072369 0.27646718413590104513 -0.19032869155454998356 -0.34392261115388572668 -1.1533698487782817477 0.056898267925872145212 -0.049234462562291317345 0.48051505371854502657 0.51608805689772396796 0.67223350236606704833 -0.1542969782374303267 -1.2365466321979299291 0.19446802240399740924 0.92378117119476443886 -0.46237399830178010918 0.43305725499792746547 -0.19378346870173898675 0.30568086624975226995 0.40683293907203155193 0.0074337277361914162049;0.79377753246574267454 0.022312395344559254884 -2.246859842733378354 0.15851576254039509428 -0.98479955231226667944 3.2474988520041425666 0.19092890810483348352 -0.58397517154631206626 0.48615401924156603775 0.66744641785958658264 0.94842697934423736417 -1.4967087067185858018 -2.6846291526216541357 1.4182793783198259785 -0.88799465980418468281 0.58334254028724541463 -0.23522713721265781084 2.248704189479309612 0.18855429895904957105 -0.67858222999947281906;0.32237051468881844363 0.82062105030026000207 -0.5971191315022981172 0.28426213214867934731 1.1451304452589685656 -0.63232196639551629946 0.60757315543584367035 0.56267339830421569946 0.7969929745005758237 -0.66567044508950246051 -0.0064008132978148396183 0.95851213194409257135 -2.5128998582491792746 2.1070869435612009646 -0.92729665408013850492 -0.23233213108052611084 -1.1345397828904570936 1.4803244038692671136 -0.1890898054449215715 1.5428416136300899808;-0.11036171256872341628 1.3483873967482906675 2.2107697395039256349 0.34782963693372964675 1.4022835793965158224 -2.9491306722949333086 0.28806403948639464074 -0.4973996865694514935 1.0201026910536101777 -0.90098237756988686087 0.33553859893990078955 4.2288179335310154272 -3.4540205287293628267 -0.6651407863712684998 -0.35306400946435756438 -1.6430683892786752676 -0.3069216088959286215 -1.5029342608232649781 -1.9411318265139252404 3.2224950574351178822;0.16893223570975879344 -6.9422461745552936918 0.53593881037843782433 -3.6873436165538766573 -4.6820570719609211352 -5.2696869438933573448 -13.842300647759598675 -5.5626642501960095188 -5.1776611679199735505 1.7128187663895924064 -4.4565931345623974735 3.1972296262740647066 4.0580728533801160296 9.7745507443236085976 5.0782081043661033704 -3.0761170495054965812 2.9611845372459368875 1.6604610888623574372 -1.7928261216958445434 -6.2646210449434986955;1.6688941030983670544 -0.26874126019091998385 4.0122139873687823197 0.7084155301258630022 -0.11548227409728152593 0.35681942738808064552 -0.86360727990962382616 0.83221735949197783722 -0.50626703932664174346 1.1068914962815883385 0.7199756182047005737 -2.0903148168483927094 3.6389079519907570059 1.061769001357076192 3.6855726347867761028 0.32726080024594284001 -0.50248507592377344988 1.0469908599050414821 2.1456226776288991331 2.3058069493254214066;1.1802513177108271414 -0.47595864911745183745 3.4503347535281472247 0.36320442390118107268 0.59919837187994107186 0.060553276552497800611 -2.332317105669497348 -0.48773307570913371212 0.47753979365982246463 1.0469288906880727108 0.55808905365806138477 -1.6124205254355474803 4.5667175952816068119 0.1278284603983739498 3.2491302591690600643 0.32177573564359585045 -0.16627217692534645987 1.0418849962052922908 2.2288726735335493423 0.7546438560216187641;-0.19589320815961361322 0.55058962241703068852 2.3251153871099692338 0.14238576316753290274 0.59444735267556003677 -1.2702530273495440394 0.92594587585928145312 0.65339389702758243761 3.7417291682317426194 1.2909331384155471323 -1.0498671577710692038 1.8438831263204835675 -1.8273376621499417549 -1.5826746009665597636 -0.16830253464262959207 0.31506573615084931816 1.0116053754483145255 -1.5044877753882945903 -1.1215715138504660509 2.1871804776123742187];

% Layer 3
b3 = -5.3025862376860652958;
LW3_2 = [-0.65133479551019290987 -1.5654009571533611389 1.06196548025457016 3.449318499068844357 -0.063921147790346521944 -0.33812504573793722429 2.3333626371965969781 -1.1286666407259537959 -0.17478241617179882117 0.37310038611046958401 -3.8591374566845981775 -0.27885390405984666895 -3.3097268737944114392 -0.30363273493608766707 -2.3777838038929153264 0.44565951163081424236 -0.7295194958968297394 -0.41815813139435897838 0.41960647910425968865 6.9784585808172163723];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
