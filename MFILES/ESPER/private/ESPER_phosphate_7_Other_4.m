function [Y,Xf,Af] = ESPER_phosphate_7_Other_4(X,~,~)
%ESPER_PHOSPHATE_7_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.4341760305250126351;-10.807509271997032485;3.4044806648594363452;2.7396581980451975014;1.4481547710029916143;0.59331834292766982841;-0.55522631609001382724;0.051291566384818833291;-3.2689163597473585021;-1.0107490588415717347;0.37039624646359237126;1.5621295997729278682;-1.444152603810892499;1.3635009297255424876;0.39530584788773098781;-0.57670394346918085748;0.57873898911165111425;-0.43737698838453820116;1.1016665107167018522;-2.0262971212084259776;5.3848559005287066626;1.838346076721502298;1.6139640969492747846;2.2362442735921228554;10.698135969108060195;2.9455866114696349634;-1.2980874271360085537;2.1173311767291109753;2.26445382521529881;-2.3147481295231675524];
IW1_1 = [-1.5520354884852880506 -0.41144804313648769556 -4.1657026798909377874 0.97246072833872776453 -0.043626726028203104135 0.85211086162244231712 1.1642137669226835239;2.0776926133344804093 -2.9602368586607910039 0.23291001572297229116 -9.0884460807456779463 5.7591341966758768933 1.6493188594622270049 -0.10764163718518346413;0.019447293037928220505 0.065686175610143726633 0.83376132172178818447 0.063638934050982295942 4.7555563368460012086 3.0149701435506615077 -0.74353552205456818758;-1.1589087647265163827 -0.42062137361104973143 -0.14351966123003517817 0.77696397455491539308 -4.7655414229701564821 3.584373250418845025 -0.27925901388666213299;0.0078266489391805738746 -0.14929294366423034868 1.0564969314630192621 -0.015992328361156687988 1.3681071557108970271 0.82531256517600604106 0.64631276981071716925;-0.45505132090655253663 0.019373945989375904175 0.33748848827767219394 -0.23986319571532774275 1.5158314658201683667 -0.12037486539335554014 -0.7998419096028693831;0.68945096033008823611 -0.15709776092880853304 -0.22350232588772059317 0.18428948374876535921 -1.9478252364660912921 -0.00053223612144824008693 0.41491543263093721983;0.39719570250145830315 -0.077080782174151041275 -1.682133198146450459 0.82642294849042574612 -0.53851551894427196476 -1.5880003009022491955 0.71431505801724715088;1.5983269778223034852 0.13336642490407546457 2.5961599504954864237 -1.2551164869417197334 2.7365879511846777916 -0.93010984636257865166 -1.8244425515198638976;-0.073106292433025577004 -0.12597774977098016858 -1.2310825547509844924 0.2569910973588418468 1.3403360241435162692 -0.31901488968926566825 -0.45818343934441252419;1.3270270306852087749 0.89594152990716580121 -0.76488189480351642668 -0.11504137674447409423 -0.074698669236645767744 -0.5598940717432013825 -0.052168614168214139104;-0.27799357662422108373 0.45385443811340148157 0.14224139115381204124 -0.24301198160318771002 4.9821943877712762117 0.39705239164706790378 -0.48906949125352755514;-0.63081028656245552444 0.30146327281040463664 0.36267910250625512436 -0.26960763103351270686 1.7133377588939391334 0.69367750020907681385 1.6625628749947858331;-0.51987260893853703969 -0.047014989154422259787 2.1138006819681796067 0.22475769620693419881 2.5285350954542549218 -1.9877632982126007821 0.27913692379916571484;-0.08497507777816770691 0.30331108538030360222 -0.57064378837346707574 0.14976282888077152577 0.95042345304702768871 0.31531151217420844146 0.30707989843776867245;-0.34616263157694371344 -1.0312222136906428194 -1.838199284286441193 0.33346687107697420283 -2.8739992948978336784 -0.043694796856266371332 0.89138667431193641111;-0.53614534841897032447 0.44949546253433103615 1.5446052244009171872 0.19020430115432199192 -0.95618009219681299182 -1.8553486497996594107 1.0019126845092125588;-0.30608528151037545095 1.2807277974067174942 0.15403550377650493397 -0.13156429898144433865 -2.4574344429770831333 1.4604409530086239766 -0.73560806373426834703;0.25161576295559334726 0.09517804418185010773 0.13917448189809938919 0.35435313057590123176 1.0864017697618668645 -0.96165480365536026852 2.0599293820713220349;-1.604943848794636363 1.1066878681302456666 1.0430799027894184228 -0.09779808991552427222 0.27640915057502307706 0.11072177325147986027 -0.3229052164490225918;2.3433951250955935564 1.2876890339779003547 -5.2151845079477556766 0.17918908182976314714 0.63958601415625548903 -0.38163665860615519909 -1.4481429848015465733;1.6213787324522344058 0.38525952889770065379 -0.29399252747689608167 -0.12907291566423104157 -1.2724971623412162369 1.4921296768769805041 0.18705040562442692975;0.012181399534721987915 0.025026537925527538031 0.77066802096224551466 0.083625221121172155225 1.9612887964752070413 1.2517899792061126796 0.94719073214973326102;1.6273387807496089152 -1.1245782415545197974 -1.7614705728952553265 0.13542319996694057727 0.76434644734995749182 -0.23472485798040174099 0.51987819485809372289;-0.68898453268228199153 -0.76200148028686742752 -3.9405963684998845942 9.9660243240154855471 -1.3994683344918745771 -2.1972417004433912879 3.2439578036710563502;0.16485497264638265813 0.79738399577477592217 1.2333188733575313201 -0.069675926832130655186 0.25481249318326582021 2.3879863643090102343 0.93381362651911925532;-1.5830703597401236671 -0.56796544081906275014 -1.3319389756473525299 0.32979664516435291954 0.49975964589430210694 -0.12436954053405514797 -0.097812793992841026713;1.3077159491211349795 -0.060327608877155505795 -2.9987319272590493568 -0.63707774830852070824 -6.149822823627722812 -1.5414068394017081953 -0.56555675665805815733;2.2632524175225277041 -0.81908311405820122264 1.0549138159749742449 -0.1213122874854949268 1.0124447546400792142 -1.1141463790495633734 0.31194405609900721643;-2.4199246921714978598 -1.2902885963726267171 -0.23719284065468063116 0.17866854920151672981 0.76100703124518231935 0.0029677768080575255005 0.17103341150102585599];

% Layer 2
b2 = [5.5164612911025212583;-0.023751231686291979228;4.5808259597783669292;0.024269448676501739065;-0.21296759501207468412;-0.37743331889345405061;-0.45644926460129725543;0.32638651259648465697;1.9584502447167062567;0.62127617982841076838];
LW2_1 = [2.4631765263410847489 0.03711405262303627689 -2.0254005679503408466 0.2793482216479464264 13.215488256950944645 -4.4255987652608359539 -1.7152086536502191283 0.79246348098811525418 1.8089147502495115383 6.0921648140602542298 0.25024648740669913627 0.72742395931398806663 0.72686015786031987762 -1.8043564007343653177 -2.3676710174128574593 -0.56616906945275247143 -1.7474603568694888622 3.1646713216116526546 2.6757408306830745559 1.5900514458854781985 0.073125691384608504375 -0.42807362648267022198 -9.7200556876529518036 1.0648951659973269201 -1.1617879821642116411 3.9608982231714322531 -0.92553608651335161905 0.35061264658117963222 -0.33811411593297957534 0.95968385026094815693;1.463786697455280672 0.4230998033313190243 0.93445520192046871433 -0.55780094096218446609 -2.0172978711694677934 1.2871054519605948929 1.9714449166259333523 0.31673323352443272238 -0.46392763229109623691 -0.86349149328094887412 0.26133884094187470604 0.63293429212951823892 0.04989398910611646254 0.63184297311421599996 0.20010513032142690504 0.3716256402250311397 -0.67757139589795567503 0.26813375831819125095 -0.122274163778310338 1.0929440518391777548 0.15738718162045817195 -0.78366859471069105769 1.0796324195855850903 0.44486785452778276895 -0.12179025653744453284 -0.61304991462495450616 -0.82162664343447722182 0.094640671479600535498 -0.017409973766771950215 0.54510488625825637143;-0.32131162197873525121 -0.29961192535546110616 -0.076482022566099927552 -0.0082452570018153453768 4.8985028706837887569 -0.85805924009939227304 -1.4726979955071226591 0.72685981744867833587 0.016568603470115617765 4.1351507651292154222 0.089903158502123090012 -1.1333074707043504503 0.40852860805281471235 -1.3073318984775925689 -0.71130786365463782861 -1.0930676338518885427 0.92048320835364605408 -0.18069879197730498444 -0.39180001842567535597 4.0427634076556975273 -0.36862189631136910162 0.49612995015894184592 -3.9483767317745801506 3.6580150476411708027 0.075937906474751445951 0.28581280043448892281 -0.38574113299804396737 0.45833362898439039546 0.39283734685476606741 0.69716939891443985289;-0.2577850403111326405 0.15488559144324845485 -0.50055952961090410813 0.097257798217582985822 2.2864557447339066698 0.66453973159859935915 0.31899123406742579956 0.11348618247468304776 -0.40095942417364122123 1.2565035691028489939 -0.15940163638483678676 -0.3229340698135618748 0.050094627082820648856 -0.065752417276649724465 -0.081701516238107160794 -0.41826977145612487252 0.02932838469459294814 0.24868896384415264955 0.026342706240806465501 -0.89641845590275870403 -0.033162393623886461669 0.019942333864254525172 -1.2127517787726760368 -0.42009335009937415206 -0.021109315659683530048 0.75773324755557069921 0.029754479927586542642 -0.077153216460383630682 -0.18333228325373332468 -0.28021473909658328738;-0.71181253201850491763 -0.01017276466262540327 0.51754301339547958971 0.53160618918860269577 -7.584313794945427567 -3.3815054180493500091 -1.5143041999274089449 -1.0197403038826722277 0.099773990269547668808 -4.0669152801929921992 -0.87746504085733767475 0.52493795070019733107 -0.43979989948241998698 1.4246781436556070766 0.56290271248704260021 -0.049643788549348651096 -0.74185714523937307252 -0.29455936013629857584 -0.022060222078853768124 -0.065658727241055356294 -0.24899620290580132265 1.0580001193963617379 5.1728206265714717915 0.024496558604347025423 -0.13704708505137003227 -2.3582729589648732116 1.4446566176034649764 0.014884297547085444113 0.47179157998488219228 -0.70221237586093532279;1.058814328922462078 0.26846472996104464581 -0.22452744353158171631 -0.049508821667203571637 -0.22453900957730901777 0.55889611611092693266 1.8531429206417948663 0.36817827864308816377 0.45425608184482724194 0.20982088536417867197 -0.41339098697503418034 1.3637393135788236087 0.38757749502575378209 0.56660226928293400128 -1.1460302196708775924 -0.45496666212727854273 -0.45876393303972695659 0.39641528106526197073 0.083317872188979041903 -0.29835111448398360379 -0.033295165059905915128 -0.097958270327700200375 0.6720317036249299214 0.078331960432784550341 -0.1583880193241283818 -0.0090854644776324784 0.028746284706977012074 -0.14486325431299051925 0.13168700990497692049 -0.52285346286473532995;-8.684988228179486569 0.60234679371787924751 -0.88853841425280333244 -1.085707077390827946 -2.157314893663734523 2.5698919433984559468 2.9447816594728073447 0.75668793631400510513 -1.4568823903633068007 -1.7934033124852151175 2.975581539197535097 -0.29255728292955368586 0.28093823818910657053 1.3422146813098441154 -0.027979960685954825828 0.27536110683496989315 -1.6666305856708911737 0.74650497664886694693 -1.3978683987451883119 8.504831207614694577 -0.43247475939338836382 1.7016665871989791192 0.7850791741697584758 14.397704245611267382 1.6745971164875843584 0.42676812007783293534 1.7124613592978921162 -0.45445397064032233558 0.055812730104585053792 3.5629565032478782705;2.7467583124582066745 -0.032895365587275252062 -1.5767816241244250186 -0.17535073439846071697 -1.3665083189262370311 -1.3656383036970263234 -0.022228059643787267952 0.11849864218812086736 0.077202615516285585939 -0.70203286568387612832 -2.3279002271425968118 1.4985426901959009172 2.9284010427779167962 0.89503817562852761025 -2.3162039778299114978 -0.30982036888198549729 -0.061254377021933432979 1.4849929866839510773 -0.56978585400714021336 -4.1621088821482041809 2.460703205873967292 -3.2653764842016634873 1.4643931311944646811 -1.3054040397305612942 0.078245338969790800832 -0.51637098731341612989 -0.13377354370106200876 0.93556751248205261007 -1.0592290364768714994 -1.471792260481075143;0.062901819925590601867 0.17945206389349685483 -0.62956527334109679828 0.26735999102738916555 2.9784922604197205942 -2.0168764045372609139 -2.6390405037607815864 0.6132958259802209211 -0.87645290346890891708 1.9153502345622883674 0.55018718154519785646 -1.7158389929452524392 0.35102764909396250159 -0.57190846288503460748 -1.2534318102814381302 -0.96652796234102666961 0.12263594209690123482 -0.21803118995672315927 0.097284955462225625178 3.5040086775945220587 -0.2707383082138482 0.25048171416335307526 -1.7350538801803490063 3.1966542579920300682 0.0087759489146333937576 1.1075551937667738045 0.42583784378489275557 0.44501653342136598956 -0.2632706013237650633 0.31220879628851733179;-2.2591848102771585616 0.33938387451548457374 -0.13167695618283531411 -0.83547610548087125615 -7.412358293304409429 5.1679307499218207766 4.0669841161292357157 1.0842070256354765512 -0.33578228246415309233 -0.057448344967967981956 0.73349609166942708605 -0.090570259474394482213 0.34121165268911324286 1.7593969448977588854 -2.3675733668565990264 1.3266794890974857868 -0.95944279305393986856 1.3220615802185051724 0.93461390872188732093 -1.4658739301368697294 -0.6584069615724923441 -1.4468835321814486061 5.4299403218256134807 -1.7052286540631365064 -0.18424117031465889194 1.2269474993773579197 -0.66352334442711546902 -1.031684929377898241 -0.069652860464503377202 -0.24948149419238374591];

% Layer 3
b3 = 0.30142592997303385705;
LW3_2 = [0.14276066389396335765 -0.89908264963947515103 -0.74837609844815955462 -1.8876508797829825159 -0.38053185189677785072 0.87045493786431227257 -0.56103089498805747137 0.26340062143784992443 0.93508370222904813041 0.44020490583002874763];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
