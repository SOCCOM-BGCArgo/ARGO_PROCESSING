function [Y,Xf,Af] = ESPER_tco2_5_Atl_2(X,~,~)
%ESPER_TCO2_5_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_5_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8384134715338374;0.35738267963389314;-1.9960623516140084;1.5720369636146223;2.0582253354410103;0.30195950361855772;0.75605524506604838;1.8453279179274311;-1.8979489528922593;-0.076011830155404234;-0.3550829928752009;-0.626678326237608;1.3318065126272307;-0.13995589736756087;-0.26621937579657784;-1.9137594144474099;-1.3126085317788632;-3.0484257435979516;1.5209247160815491;0.0093590381709064627];
IW1_1 = [0.71494018645050306 0.48253966616483474 0.9248766878787138 0.20143221028055927 2.322567085207262 -0.40579899323256102 -0.33871420925214629 1.8800850366984352;0.74969272974561874 -1.151116917669053 0.028964275022999194 0.26349198778595984 1.1167006731599569 -1.8452693147519548 0.72002914597928225 0.61018609586074191;1.1411317415899498 -0.43567015783923546 1.8665840026960496 -0.081287860626177405 -2.3350429416268734 0.5094003437841732 -1.7601156393346562 -0.79859770037775157;-0.98644618838390552 -0.90557030246811543 1.3419100154309913 1.0788227944526469 0.1418253304790838 0.37071492123110089 -0.014662538439082603 0.88295549537668672;0.039382872950503703 0.28751819828960296 1.3701414916499444 -0.88506370574041349 -0.73315133632373797 0.6354687021030262 -0.16062526213874856 -0.40090376393388749;-0.79501344293109366 0.75669853624228622 0.87410611901858615 0.53836508630816837 2.412671612703956 0.51591334801896982 0.85095248955041192 0.71212404251215922;-0.25530644602182323 0.71294238413898336 0.06954887450527672 -0.057697693174098265 -1.9219086498800722 -0.445663367929029 0.62995124445654038 -0.83639665054946588;-1.0222309431816266 0.097086867561765794 -0.33601757913346714 0.97363699398290449 -0.82368995614290452 0.29465655859343498 1.0001257348937203 0.0062088584182520695;1.6617386991303811 1.6013918539617147 0.79547686902846992 -0.54927503402086408 2.1256504961511742 0.72597305841650084 0.25337971654469954 -2.0881760628372166;1.1436833952376178 -0.81242659705920761 -0.45270384319470314 0.55940059032961686 -1.6393377595396144 0.45966659246026803 -0.084499793022445119 -0.052707178083428216;0.7989635213544477 -1.1055692437109421 1.7043211571019428 0.12233745731521152 0.092994041321356843 -0.66440732326830887 0.34811364784268284 -1.3876081745873532;-1.0478993930551135 -2.1684905477787924 -0.66060906197840386 -1.4447978204337084 -1.480726213172423 -0.28186493454376715 1.0520150382655227 0.41911230369523261;1.1818936599093819 1.1696440596902133 0.30941575940105281 -0.39812303118926989 -2.5742391146834347 0.52360875344806057 -0.11721823466727116 -0.24662048806731385;-0.72048357236102234 -1.0003091472617369 -0.62662808773581613 0.015293470682859047 1.112100665639397 -0.25410607109627881 0.10797960673713261 -0.69309260622430824;-0.161336740444253 -0.00012233338082060213 -0.85374430136142987 -0.25909095745678823 2.0385717352579404 -0.51675713463974093 0.63158898984111356 0.24631738784873156;-1.5332784384607419 -0.8605772031028871 -0.87065420292669071 -0.54177482718110492 -0.7232183917727858 -0.082225599813442282 -0.6360170624066267 1.0851089204024706;0.07551438699697044 -0.46510247834564666 0.10959023118667699 -0.00098906028348959979 -2.5252851867785697 -2.0148145913950497 -0.42652093517248596 1.1293733018083185;-1.0870809686672838 0.027683058131760387 0.59049509473567663 0.94329262246698486 2.7782487260980773 -1.3103022072071446 -0.73486504278210818 -1.1387700777194307;0.11122368341902032 -0.050216987427058817 0.74046846882426842 0.8197126083300329 -0.53471154467241133 0.25708757973933383 0.40257806208378483 0.69289620724815137;1.354456643698482 1.0068881088960855 -0.083507069978997164 0.70603559422177731 2.6140874776143233 -0.98237958098606637 0.16083133406047156 -0.92903847760664204];

% Layer 2
b2 = [2.7419579310026565;2.3789019175826258;2.1842678373709612;1.0200862751922448;2.1035717967490806;-2.0934553283063351;0.23919975009819525;-0.44545776935721282;-0.77768879408956915;-1.2729860262252433;1.6914203069681544;-1.1917806173143359;-0.89126126390523841;0.61086046479407563;-0.38721157252140381;-1.2721622966113924;-1.8431774874335547;1.6402515172883383;-1.6199370861270876;1.1439668701875796];
LW2_1 = [0.33661947189725755 0.94004996680286657 0.81369769420314664 0.96292411320771132 -0.49611699394409703 1.051337610902128 0.92330161842197411 -0.6000573975269774 -0.12165282962645922 -0.082787975406802064 -0.085820733423832271 -0.17076453376349621 0.52092657386837249 2.7904896612925407 0.94797047725894967 -0.14804431241862576 0.4960010992772646 2.7024887732911815 -0.46522644606990526 -0.92806371590827552;0.41827295414495813 -0.78700971196401537 -1.8755090032293185 -1.3849793029355049 -0.25521027912790939 -1.6487438981275373 -1.5741534722341639 0.99420277223839082 -0.1536181355237235 -1.1913719214360607 0.25574547474220433 -0.62735351113098303 0.17112520856109401 -0.12257363762082499 -0.57069327211142484 0.69994078497225576 -1.1711415717974987 0.041729258487958609 0.16898769259827054 0.00096707690170337764;-0.09904901569763841 1.2290549440681426 0.61250025467273161 -0.70230163327542428 0.41349275194392204 -0.53297567639865007 -2.3120914235324697 -1.5866543548525525 0.9946338440997694 0.0042459954057885926 0.80678027907847705 -1.219927141306429 0.95931342500301431 1.0975573735709663 0.6006312118600291 -2.2587721811556039 -0.16632314363010386 -0.74887075823960025 3.6096061606987382 -0.75934161429415081;-1.0464500107579786 1.0801522738217768 -2.0032100307072205 -0.1910926903178384 -0.14322255382079371 0.25860584630017336 0.047308661156105505 -0.049890245315598443 -0.61251239397229529 0.11333624670186083 0.30888131788265888 -0.025585654146117895 -0.63267078530693743 -1.4091848952632933 -2.0229668586209568 1.5053278027070709 0.18572363521488616 0.37327755036275223 1.6853186897924946 -0.93441254758827574;-0.90057960486415167 2.1384816390258856 -0.50135360105539684 1.7127583604045955 -0.29090587729671297 -1.5868547884601443 0.14377692200777539 -0.89518267432671716 0.97968620508657289 -0.14845241907952361 -0.8436061180861788 0.92690094862427408 0.13485911230444697 -0.39425893274935553 -0.91189473076640393 0.053866427403392626 1.2942522274041688 0.29292135079176918 0.71207818104104548 -1.6523132559483142;-1.0299872906544871 -0.99916162212567572 -0.61669583407462658 1.2176514610085729 -0.69215423293500855 0.68684114335119184 0.58241635831692473 -0.61009466435940829 -0.78480787786205397 -0.88342251635173241 -0.097234612153439579 0.26342951782359314 0.65821538451091621 -0.24938042805740648 -0.34482463781660694 0.29449006145011025 -0.74772330798385733 0.042256615061038338 -0.44054572592898644 -0.077438801601975582;-0.99687895605082488 -0.29149537830339439 -0.47985969534872175 0.16584778906376815 -0.059857258426455361 -0.19764157461391998 -0.32214346835032814 -0.13163726929921923 -0.36028089000593477 -0.16532405265266881 0.51449551328259024 -0.19255696133844979 -0.089135047045643317 -1.2793369070352711 -1.0058154500416687 0.61706877053330755 -0.52161257831688379 0.3359480108483775 0.027261013938082772 0.22946942083024699;-1.4428286230420984 0.081068128704492634 -0.018039960860840455 0.6686226355528998 0.6624325737011928 0.61296949617837904 0.22712785270553179 -0.91178601273322946 -1.4619310099726861 1.1142771111447809 -1.3432648569130838 0.13945476255780628 0.77193086368270269 -1.0660003963949987 -2.1833314536912347 -0.54975217054072012 0.70516498072088551 -0.66919759400276324 0.78264571031399355 1.4035454740326787;-0.64712235751713976 0.98928996295364235 1.6455952806046419 0.13760789200088522 -0.15635333219254299 -0.74069324486654275 0.38872847956504852 -0.4730474073950578 1.1039667501991031 0.45755831897617716 -0.58939575052033732 -0.32672098716688558 -0.67929719198845429 -1.1036174288568665 0.66308872177990563 -0.17081132016717127 -0.51842411064650984 -0.17653300780588502 -0.1461736711870413 1.1801825316164918;-0.46522175998323623 0.18582284665265369 -0.42757334491331966 1.3221858943368765 0.64405894671484931 -0.61969044154190656 1.0063698915295387 -0.86578199801601741 1.3599565782255296 1.1593590646275937 -0.9221338371401715 -0.12448655754235423 1.031207351659474 0.29170703651149055 -0.17904310950159183 -1.284100104258963 -1.4687067940202485 -0.53341439929985246 0.91613629810671993 0.73962253240506803;-0.75700881875673087 0.32101650301584628 0.81464564301673426 -1.5004817405976953 -0.0010082483054619229 0.2392130398172031 -1.0023103268411839 -0.15446431265751503 -0.13839963637944713 -1.1128267280506736 -0.38123175673943899 -0.28851727435345603 -0.27576093176241584 -0.36695583054952596 -1.9305898815686848 -0.91471033150638015 -0.71019177064818306 -0.39165180623927742 1.9137777169674415 0.2308280991879684;0.57184351738845995 0.71337427200934278 -1.5915689098839318 -0.27880150158562017 -0.23822339379321295 -0.39363664584209235 -1.1122593775954104 0.25202168642251233 0.23067906681772932 -1.5275137899457925 -0.57691820033301644 0.33233753569625479 0.72783040930535259 1.9281114478818588 -1.9939239311970938 -0.52292943877547426 -0.5561324211766655 -0.15806377457674436 0.98103534998387376 1.0540361055561132;-0.24088331013294656 -1.9425572568467895 0.66542926682956738 1.050557263434506 0.77131203725461139 -0.62875478643576233 0.99686895613513271 0.58499303207127684 0.70411962824319119 -0.013831296307001098 0.34618267492242105 -0.42519381608970241 0.041718755026379777 2.0926769951630284 -0.31942835590343049 -1.0843129651435022 -1.5317444589790139 0.54299730519401934 0.60782945101563779 0.1120446044615185;1.0542447708307461 -1.9254607862759077 0.21690010173829596 -0.70869418588780009 -2.2848187107410092 0.38014519101596345 -1.6832600179785246 -0.76486385925019917 0.73903330245807808 0.55643103533932359 -0.06428081925962377 1.3394953773750402 1.0164910650122234 -1.0898208305980301 0.1559828702701514 -0.80511711390603913 -1.2490455330255275 -0.054750123714176216 -1.1934059180436876 0.51506418067835991;-0.81358479711147524 -0.85575180298384168 -0.6499682390357846 0.18115488781900729 -0.4910057292641864 0.42696733918387481 -0.47995428128343903 0.078934726778566167 0.21837711474714275 0.80918611251249828 0.24180579130342073 0.12723065925714278 0.12131491375077076 -0.59760619912859336 0.18932743667686802 -0.092217730345983628 -1.3045866071632148 1.0303891662187827 -1.1604049435444055 -0.84296995166766231;-0.465770883650656 -0.18045940336488714 1.8433858920633774 0.18478212693681725 0.39043823865184851 0.8266807501487865 1.4039557676100214 -1.1642353019009049 -0.10686325495979568 1.0870844493171929 -0.024605606401323834 0.44846632406954839 -0.18222734170307181 -0.48222564908985732 1.3487607278235303 -0.35590781532973631 0.93712224310143399 0.56458791464954139 1.3871584649849644 -0.40509006688423349;-0.54930313099531802 -0.26906316762963112 0.58325916189923277 -0.23134027595657813 0.51917451933476477 0.77743447599132331 1.0371105906507321 -0.387826374651007 1.2837961316032376 0.77296083262643933 -0.11599094485112363 0.19951201700015886 -0.10894637989529879 1.4512764545026877 0.20431607245146477 -0.26990385757619823 -1.4042959566593247 1.8699108212020568 -0.43104125665264348 -0.79128101525123695;0.40057583388888807 0.67736155965232314 0.19855383346041269 0.59663850042914179 0.36675607200178389 0.52008403180729468 0.75330340553093766 0.17784080964322818 -0.3935358095804703 0.28158051591879069 -0.67694266818967108 0.060089110059124623 0.99240844526728333 1.2103606119618842 -0.37778730557487072 -1.0251290839162563 1.0493700338388923 -0.45588541122007797 -0.85797901986085301 -0.12564518459920812;-0.3571407756775643 -0.72512379984055642 0.88350294044926292 -0.25125473946742988 -0.30075625145827456 -0.36155394369096461 0.22407118282214539 0.66081776313852014 -0.50629236374984787 1.103655526739505 0.24121895117842226 0.31412054479090945 0.12236379885834447 0.33550625736522521 -1.2130019750234029 -0.58262974077827656 0.19138799928648045 0.65852618167191912 1.3294847582332694 0.87364709174440291;0.056556632358092968 -1.3257007541433428 -1.1315902149295687 0.43051010927457217 -0.33859011863323646 0.48977362968768229 -0.0012102852851502525 0.3522254967227092 -0.23618034773399568 -0.10792271182103547 0.32385211616908288 -0.19464781074983151 0.34523229389894816 -0.96938267563396618 0.1850501098967719 -0.7407955850749558 0.51584621348086479 -0.095449542756506939 -2.1217430494610925 -0.66434049954441488];

% Layer 3
b3 = 1.3801879299813862;
LW3_2 = [0.066458220322282407 1.0657043021314401 1.5201468121411468 -0.042754555418936531 -0.023791528714314492 0.14242359144968242 -0.23682279758007252 0.082890856460347176 -0.032174049747092107 -0.042935380676281082 -0.95933372648458881 0.89015147897115166 0.037894307986115164 0.020789305766177747 -0.27340591711366374 1.4150443633336425 0.14405763236657382 -1.536046125231435 0.26284130740083311 0.11096341185420235];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
