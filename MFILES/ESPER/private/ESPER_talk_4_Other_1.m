function [Y,Xf,Af] = ESPER_talk_4_Other_1(X,~,~)
%ESPER_TALK_4_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:45.
% 
% [Y] = ESPER_talk_4_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8886783747654743;2.8347895952240272;4.2055488392823239;0.3626827495944151;6.7830872786715339;-4.6436147249167261;-8.0147398112973871;-2.8881065127196401;-2.5859154773278665;-3.0001394876431862;-3.1453447895465469;0.32390977757284017;-2.9862030604746268;1.2309164843637264;7.5467997172374828;1.2252543018590656;0.59233442311595441;0.70299748065934953;0.28823736229078767;0.67550226950347758;-1.7866723236078699;-2.1262889335684747;4.7723047791934867;1.7594858789695351;-2.8085583260842109;-7.1854391678174832;1.273929713572213;6.1995883303892247;-1.5825853673026073;-1.3350422379396065;0.28399774568231723;-14.016748423303651;-0.95403079984947292;5.2601248835448207;0.59011802323320184;-2.368382882173282;9.5562876561103138;1.1828186462694628;4.5753433775429624;-2.8374480944947575];
IW1_1 = [0.12562359101098208 -0.38110402013145372 -0.14547783401988645 3.6608764177550852 3.1558550211813685 -0.9751419729072015 -0.87493781475424726;2.1906925220728026 0.45544700957186146 1.7966773983950466 0.25985105530044939 -1.5789613964996885 0.67327089595884382 1.4449018587170905;-2.1373598020660851 -5.9928446120743351 7.8401231540020104 2.2504105326566823 0.032540018312911201 -5.7309884231152584 1.072412970673138;0.33156231152027793 -1.0717822178455172 -0.62572511495456873 -0.56421946261152722 3.473814365416644 2.4223664284447852 -1.3452161671887339;0.11639153137648822 -0.0078231479660558663 -5.1868140983817135 0.46990849314623401 -5.1679001563071436 4.2600215233527381 2.1957148596026963;5.7885343006738292 -3.9891393598734579 3.3886237615055279 -5.4485341599307962 3.2695329944408873 3.2011772886720986 7.8487587998453705;-1.4458465107290959 1.971904899662599 4.0440463988520845 -4.4579561755813266 -0.89417339496087966 -0.56540721485364409 -0.49267895853587901;-2.3518907363932815 -0.68024731086894596 -1.915802123138296 0.18684574890859762 1.2438770092410654 -0.79689716625125628 -2.4689382974556375;0.0020076914447286617 0.016531086059582891 -1.0242396359952948 0.1951202102085012 2.642229852243041 -1.2356020308759301 -0.27833664272073722;0.22212087924102661 -0.29919555766782968 -1.9421459992122132 4.8164544447036564 6.2157462283968723 2.6345179222812227 -6.3366796665982639;0.05314258160509934 -0.0019846051065849669 -1.4918200912711483 0.13814665304111037 2.5576026067968702 -1.2309553882982633 -0.55061940690931299;0.38354040170849973 0.099748187622259538 -1.8009045253222222 -0.1128653741158379 -1.1517167084501898 -0.30952444191787531 -1.1112640503356421;0.40746370211039129 -1.5284823444736817 1.2560095625575762 0.10988288348945852 4.7533791220626131 -4.0678323014391582 -2.5497104741254568;0.14354587357560025 3.147037726768751 8.0131987759618486 -2.7887604637995529 1.8388177611790366 1.1953522662360274 4.2453024663845431;0.058961954844435574 -0.24870523415464318 -2.5956678882911439 -0.57261139421259744 -10.279548933713668 5.3464877490408638 1.769904816146199;0.039116346874826645 -0.20184477898472944 0.19441342184856911 2.5204406042859686 -0.93607808995827402 -2.4840482569267399 -2.5880373989816277;-0.30711135666827655 -0.10657566213479058 -0.34752910149282695 0.70515877863820531 -0.51904526532046957 -0.38609565818109209 0.29078939254620056;-0.44258800082402755 -0.30075777833533451 1.0174184451490642 0.5987450376330461 1.0723486111558536 1.0860768083760461 1.3596508421608398;0.29543600587160279 0.24199368857374809 0.72238380161200544 -0.4607515904358388 -1.0049871621761455 -0.038818797578345353 0.20973788688999562;-0.47461432660719988 0.065239215448330307 -0.33255287345826989 1.283953080276709 -3.0182295781646369 -0.42234281860659156 -0.63396165225403478;-2.4142426385496667 3.8877209616793591 -3.0055113851420732 2.2453035272381507 -1.2907404615667486 4.2717030108002891 0.007252577053890874;1.861776330295106 0.76592162777448614 -1.3753136666696963 0.2737559711457983 -2.032928073998411 -2.2622594988841001 0.11381615818891415;-4.9846813013955753 1.8234825671886181 3.9604485412631778 -4.1969531003172849 -0.37733629790385415 1.3159855653482861 13.307459456175591;0.74697536726209046 -0.087240462326822338 -1.9642477836386845 -0.11252265879402781 -2.0543768547882308 1.7851562635772811 -0.93368799594067076;-0.21596136045383393 0.10637588859153888 -2.0593854311743858 0.59274698691955829 -3.5501177909877271 -2.0804866121713887 1.2094165849946166;0.78642890588788028 -0.70752174079357288 1.6962103011736869 -3.6341356975772801 -1.7067095783875512 0.98968163297081546 -2.9125048934446727;-0.1939344025983637 0.57455441797270523 -0.058073551656739275 -0.16627517319431465 -1.2377435477848355 -0.6916703509501263 1.7329249073557709;-1.2006164440616769 1.7218855905796713 0.27688258799839938 -0.33215702882844955 -6.8679660901098805 2.9783511542474868 1.8162094289483799;-0.53980660225127708 0.030037461391238293 1.9513162443096357 0.13671499922394695 1.6883351454053208 -1.6269138641862089 0.76928756664097342;2.5683644266857724 -1.7594764467799009 -0.40491240561861308 2.3858927123746589 0.8467515597384242 -2.0362320329990453 -0.49749133997693157;0.3701939418519074 0.093538066448947937 -1.6421996727278021 -0.10061319429862786 -1.0763687724559479 -0.30795237330517816 -1.065246180458074;-1.2778627089088306 1.8249119844804249 2.457503365244551 0.74094709990200469 -1.786250289049429 -16.96656508985933 0.64024977875556233;0.28930576925586504 -0.72617876107993373 -0.63296165641906055 0.64212912442543046 1.9243803537264317 -1.3896847246335278 -3.1770320303647455;-7.7797555527032092 1.4698922066629552 2.9486336515820515 0.98381912105840819 -9.8918947837601863 1.6394782412498927 -1.8061692978873236;-0.26395472908024903 -0.070409921997273528 -0.38775072108112207 0.63196439649363711 -0.64904343188359404 -0.25777413330162546 0.25280746786113262;-0.88775987410184776 -0.35678002130937769 0.99893190171007573 -0.25774888254129008 0.68292622346437504 -3.1856930736423084 -4.1444531611508664;-1.0078384386975094 0.86964279340653461 -2.0718574703135593 5.1950917830680741 1.3493602448007793 -0.64895575520228854 3.7681879602817756;0.052490903677570616 -0.02036983482019665 0.25656872522627022 -0.33953966973635413 -2.4044970672078105 0.93296897564370562 -0.46682941917848281;0.3108671081726459 -2.3392878805932771 0.30394382317722074 0.087964784683581446 -11.892015206462407 1.4526093770970896 3.2844239032836451;-0.070101571551170319 0.091257421576313849 -0.90861656481496367 -5.9156106002718039 -4.1152971771651607 2.5731245794132405 0.48551228241696115];

% Layer 2
b2 = -0.24251125795046577;
LW2_1 = [-0.13671895884650317 0.13020316430824327 0.0074129408726461314 -0.061432274132696106 -0.079383146722064368 -0.019033907853913703 -0.033915557988077001 0.088143897698255952 -3.5198086549861851 0.0278181651287535 2.4077651498811119 -4.5896321974206069 -0.049129144989909078 0.013689108159386041 0.12290321232933127 0.11667371404752098 4.1525881963810791 0.39251491831296126 -0.71352265620360644 0.17507277964625106 0.017728000967047484 0.061233600920513401 0.0099108010414754883 -0.92962454031347574 -0.15041414774815443 -0.60764294331659241 0.25982861454340361 0.10871606881867751 -1.2632879421163028 0.026521575095653491 5.219731798715725 0.014780826728172903 -0.13443632264545358 -0.011712341028803665 -5.5629408698330476 0.033037563869660898 -0.52976444021299496 -1.4402180930945447 0.016858753056575547 -0.066481709223777066];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
