function [Y,Xf,Af] = ESPER_phosphate_14_Other_3(X,~,~)
%ESPER_PHOSPHATE_14_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.94266980592788507387;-2.3209297963839214951;3.2688642191414607474;5.5708754840605720915;1.02117172940210299;2.7916271749969645555;-1.6903668021625470885;-1.1097831610011266168;-1.1140354082041485917;-0.26011849046010648845;-0.7566562032453746367;0.031484759076742432904;-0.56118908512386889154;-0.77395010742101910672;-1.5742221119620927183;1.3633110976689759575;-0.29512050022060604126;-0.72115469247460584068;-0.59038628969190620754;-2.9722447726130711843;1.2408363183814969943;0.61463580611136059417;3.25644285396294908;2.2114453812008427747;5.6611929788203116942];
IW1_1 = [-0.44499887416713557187 0.76835292553331968612 0.17759629858309908257 -0.49177077718364048398 0.7487259146575722113 0.27641080145529273171;0.3904131580042976557 -1.8583866632844807665 -0.66742470939025377863 -0.24769611069133498638 -1.0816628392330900343 -0.085186095442302184333;-1.787954366307084042 -1.8915393131565139129 -1.6196066232686063824 -0.10500687518675370924 2.1326039647434766877 -0.24627645275430271044;-0.51591389535938025901 0.54165004080291645483 -0.38534899642211467574 2.2483763591297445394 0.50978170216227258749 2.7497841335096873117;-1.3738128430700058402 -0.49823593695274348558 2.2212710246643907475 0.1667898844567666794 -0.022444873651357794692 0.89750937679619946508;0.062899386575889809636 0.45470487664690012464 -1.8376214983394545399 2.6465490877738271358 0.24763400135769078614 1.2411011493034442843;-0.17834381965383394597 0.18847466869992748895 -1.8092802726134096236 -0.39362740966434361933 0.021755264481811049243 -1.5209791759504995845;1.5270431136768283231 0.731717769914855376 -2.44439686558839675 -0.10542606723850014849 0.29521863396235742405 -0.92914677221153330056;0.43068801556953961729 -0.55230993142964190934 0.71759350625425966097 -0.56961646290712075746 2.0286044465496408939 1.1387774712015956702;-1.0600346497648098776 1.1027774772791907321 3.1899120527548077142 0.61959286989666539913 0.14525352174945718731 0.97416825321527178438;0.78594823669553637302 -0.15420041252652974539 1.3440571804718082216 0.11707267779712578204 -0.85787913192978926258 1.6078937122362952916;0.85957735332768625547 0.47128202337232621977 0.43972851969882997825 0.62018695400274570506 0.64676504572348925137 -0.13121196048300134973;1.0568872874066630452 0.0091367369170462058026 1.8196490542072809582 0.28702575830698551229 -0.66383315398460440715 1.6317963713693206529;-0.40216370274708040933 -0.68612028117806034277 2.0814548136330142114 0.0083147756293412526662 -0.98469166245436823282 0.62109302918225872681;-2.7042584053521454557 -1.9067716052884715605 -1.4797752511743420545 0.22056868142109212205 1.3387266941462412362 -0.10714681829908513644;2.3870001108848386551 1.493479162455802367 1.4955768528431228059 -0.35064358605590983942 -1.2907968210369509254 -0.081877248592114135195;0.2023468366046403677 -0.14131161613224774154 -0.60164904991708378912 0.080012260549060465475 1.1143280301441034208 -0.71501115553699923222;-0.20210947374401186383 -0.54823496342835409401 1.3243165164732484396 -0.69445259054835384305 0.049437860665089865264 -1.0364426863909288468;-1.8613247382719122491 1.0944937570900110657 1.3626582207145450099 -0.15800423322301376805 -0.66511717814604354171 1.6954146913010037512;-1.9858947347582107668 -1.6731240316769255827 0.50360847529066132822 0.2325414501517925614 0.37951117767409281445 -0.89638385660841246594;0.39011524051977791716 0.13498246825092088952 -0.22219764661929927718 0.2964009939502012525 -0.017975362787463238651 0.89815096620352130596;0.10593388981935542015 0.66751777654205490808 1.6327277342693158335 0.24827961138383949913 -1.6565438884413139498 -0.82637974560707949667;0.10806070262397335369 0.54719310618655758738 -2.0806401917913208699 2.403870645204521761 1.3382266431041565102 0.72974672925224148834;1.6348207490362662853 1.2006185682136005788 2.6268479254529211175 -0.38533098288398903719 -1.933452544188636768 -1.575939685893747555;1.7087925928723968205 -1.1218734567010029135 -2.6986500422375994113 -1.4145346580413487025 1.0949409462844221785 2.8769118792074310775];

% Layer 2
b2 = [0.79595006675575519228;-2.1926843410836012183;-0.35454755258781178728;3.2253897335747523378;1.1524216550461412467;2.8993216311832963328;-1.8530994591283356243;-4.0229155680717880728;-1.8561788967220513857;-2.0743754849817390706;0.59429114365106605611;1.9509570219855814077;0.75581041395180414977;0.54194414875041108104;0.015809776163395697357];
LW2_1 = [2.3567512344707370886 0.55186141972999636085 -0.32698757234929498594 -2.2995051589545933979 1.2935633641637600544 -1.780722218750931285 -0.88165900450067180572 0.38237401370529627842 1.5565645643806977905 0.10495921417168241341 -1.9093596464855564498 0.77111821953605752533 0.7039138720646376246 0.8664443575942898379 -1.1479937988324040443 -1.740142901739691661 1.7078994742026898379 -2.8373297703062645425 0.27434432248923029674 -0.81706043329061450731 -1.7901232499410879573 -1.564534546548780769 -0.83385915179223524252 1.5043616903839216459 0.80654858307678234386;0.12048740032732620231 0.21381126851243259512 0.047687419346717954682 0.83641224571256844733 0.08544224721970773706 -1.6530108118304647213 -0.77235435384800510406 -0.31829311071776811293 0.66393030072076764103 0.11135708149529953415 -0.57922782914485926309 -0.032304797957314113077 -0.48740429062182477615 0.35918215019022814438 0.20898145675596352389 0.37527184593017837155 0.32532872485163844001 -1.2281107548328202839 0.25025320581706128609 -0.2440220926330481932 -0.21623182882309036068 -0.051124705070035213195 0.70118937342370413202 0.64218078686486057549 0.82257771720948125171;-1.2663950637611818273 -1.4472977729181433215 0.12178938391370532079 -1.047038621880858944 0.5535489105401957266 -0.13898509045922607941 0.37458473594080143876 0.92826498295841597397 1.7533233232428504511 0.28755168724833374272 -1.9356739623911662918 -1.8178812192125890501 1.4188956842467452812 -0.74610202182514362423 0.43287036182069321688 0.35588269104475156457 0.036617516317029606687 0.88289292680589626094 -0.39925124542558332319 -1.1125061432110836535 1.7070973062103966811 0.85728574666960144501 -0.334112702251872562 0.16310961936130677352 -1.1576616184443750956;1.6964988903842350698 0.84376918602188344387 -0.49766560696910178141 -1.0463654543052733903 1.1889720226684368232 -1.6281231632378418972 -1.2828113269637839711 0.65976084346967023286 0.41814724699016531106 0.37760409037859732351 -1.888622715446128808 1.0399703732855751781 1.6182508652889271428 1.314248843932768418 -0.021826908819009494672 -0.083530298763106511362 2.1626189731005505124 -2.0533971684079368458 0.35414909301284958065 -1.3351111996526792147 -1.2127110139221271012 -0.95064714794222837657 -0.17704374710972120566 0.1208952319605905712 -1.9113957320579360033;2.329711796089442899 0.50287287940594926905 -0.51093131972253835738 -2.3087014902408484751 1.2054765152641100379 -1.7440970331517668956 -0.99056523962472009526 0.23246553010640774728 1.6063918812498203526 0.063758073713385071679 -1.8926807207651976661 0.70609659856380790899 0.66549935372336754824 0.87978412339741907111 -1.0224322059686912212 -1.5528001836490943344 1.8754055731934689 -2.8113451059281158173 0.28228974746468687984 -0.85630252029300768513 -1.77999829253079489 -1.5663537004308034639 -0.82224156893879574159 1.4769973117861940892 0.55050148671826282243;-2.3735832655246231759 -0.49955005439300614878 0.0015747450524853726095 -0.5998493226560518421 -0.74659723688255119622 -0.52832717800696493704 -0.14947601966292328735 -0.80653382805482654039 2.099516066129251346 -0.48755961355373661492 -1.9716309918061516449 -0.37520356935153137412 0.62727549918596137157 -0.15627322021811018704 0.46600128816186831004 0.04673833580705485935 -0.46129055861800583038 -1.0011604128472277875 0.34560680360125300981 0.59966961944371355298 -0.605839711366532363 0.86609639323111664577 1.3007519317827491712 -0.1273302102232049815 -0.66782014977983705784;-0.58895412155204329707 0.50755099183163421284 2.2795926648738480402 0.3729708718161019454 0.63628015061252352069 1.3726832755583542323 0.7147801229326016248 0.22686912201334744066 -0.45566912529917724672 -0.38834693636889955348 0.87648607301452086116 1.4662893309293023592 -0.70478853197288027221 -0.94640532210774008792 -1.6557797701581140615 -2.5200203471514446285 -2.9617271609187092452 0.87829859765403317517 -0.377638964528940968 0.74460895229654200378 -2.4563930065865076102 -0.07021673285890944749 1.0257791069895101366 0.64018484177409595848 0.9644910828388940649;-2.0724520579067879922 -1.0270929976658760285 -0.54483147879367399558 -0.38264229054305953781 -2.9903578465144597942 -1.2510938048415167767 0.20221934868083873971 -2.2137813431058033231 2.569314595244165389 0.1166372830878762562 -1.7493739547161843984 -0.68507824256359861614 0.64832214039106028647 -0.10580690538511292043 0.16387531495600149434 0.08996251632698758216 -0.10379918696002893297 -0.39096955054401699714 0.56471096797570186077 -0.08184572861801953092 0.58485916222419442878 0.66636846714365882693 2.3526672797830121553 0.7570774025747796232 3.2121511736630159461;-1.1158686920345783911 -0.17447149874757419963 0.77101880086758367572 0.74497927569626787303 -0.38684089483998274073 1.1671547046747516863 1.1899812558183142652 0.19431961422837928932 -0.67658854464691897679 -0.11848289417434888782 1.2057679612503831024 0.22284061155032383605 0.1846296590305323837 -0.56360118818614290959 -1.0184639334157195023 -1.3543091727773020061 -1.720965309143030586 0.50805550504152363622 -0.32708661365535351973 0.235993566938334981 -0.76914580372137242303 0.021821518251683460349 -0.42644732043478256189 -0.51340677282185154251 2.1697506026966428827;-0.70910458628494976718 -0.0099772258742064773296 0.97840694133754713135 -0.69368264233067045144 0.30642132775079106155 0.86313123629525101421 1.2519858907084453481 1.9192404236010438545 0.27363444315077101177 1.4428031791555406826 2.2952525772402205817 1.0886384354157152554 -1.6074694825641588913 0.11275475960374811701 -1.5227245523622654488 -2.3631790442522819795 -1.040546239728803446 1.4318041434108315091 -0.57950247350497041676 -1.4891400260780511822 3.1451009896129842325 -0.6109756272118852527 -0.35634443671453597258 1.0081808940773462346 0.109394744392050422;-0.98064365773932815618 -0.37606797293363364298 0.27716765725215358751 0.14210737742533607886 -1.3190656156915947506 -0.49925588236811491161 -0.89865060842859134649 -1.017466186929456784 0.15007535913831823726 -0.25929239692908978565 0.61191589576594551669 -0.42259741145808182861 -0.37328925487308461939 -0.2039533700595649035 0.93488816431829457887 0.52339053239633948067 -0.29404047694521889822 0.081290326935905210526 -0.23162413447650265219 0.35744079069269829585 -0.78972521246078453139 0.23943203358721573681 1.2117079258823637566 -0.36705346961251750226 -0.4006128196343264336;0.21201007168111923873 0.4214605109588260845 0.3502354773957714329 0.43487285716701751248 2.7777938028577797702 -0.89810598819577791563 0.59177596143157096265 2.4172366221352028504 0.021478137379439286858 0.30904011723785257404 0.87230227284750228023 0.18239856691711028858 -0.88500451389929069013 0.50195855870824168665 -0.23340560797317774777 -0.284818404204161435 0.11861274417129623326 -1.6242070212221391134 0.13614853942935661868 0.47671737471163549982 -0.42096542148543086848 -0.092706028735428436249 -1.0506862047593492626 0.48730629464035185583 -0.15342887624664858226;-0.81651085112424715007 -0.38699312975727617747 -0.83015394327096692084 0.35897612801842831987 -1.1595040782118064548 0.6929367939843005253 -0.19606700093532791751 -0.9822302106189836346 0.44908298903654597645 -0.41175311579032308762 -0.8017889409459338923 -0.59483479514323234216 0.15303617538035815815 -0.40695245073767277733 0.58517035688286933581 1.0124161029878004925 -0.11612624130434374969 0.52302181237972156236 -0.019453702380803385152 -0.67213870248931995022 -0.61194169984422142061 0.43107485629716263409 0.14817778818772642246 -0.1744779476502391069 -1.2757830415786819422;-2.1941069747455341776 -0.95262206814781069664 0.62442601582647128122 -0.83716859248101260782 -1.3531095418180294487 0.28898242650447830693 0.13080205320178137085 -1.52577044151750707 1.7292452424994428917 -0.34447214105503731751 -2.4352705218404104848 -1.0100752516383253443 1.428815613277665264 -0.6703764107229031044 -1.013643843890773999 -1.4305015819064321736 0.016732447239225525792 0.60677934818760603797 -0.17981813121469020222 0.45521055962238204939 2.1744138852465564327 1.0562706598240607647 -1.0491721171123058465 -0.23337859411435873946 0.74506176993452033486;0.98447054006451384378 0.37458751448000132678 1.3899480861103836737 2.3408176763657611019 0.99184212060060128469 0.24609069999937391304 1.0252625720577261959 1.1120246773107782534 1.058539552858111632 0.069482315198732644279 -0.68677494571597097472 1.3508811551479622537 1.4949687207837187852 0.77655313296045791471 -1.7393945612923633615 -2.2539052368315268815 0.36882386965301533488 1.5290749686468778634 0.20977503795829594013 -0.43628261626257985872 1.3072088145870182085 0.58596061501957874551 1.1671742949351653351 -1.805511164715309036 0.10008000184693303936];

% Layer 3
b3 = 0.18601152652728430992;
LW3_2 = [-5.1012876492900698366 1.1855561603003064164 0.70637279842238309691 -0.56290580453630312263 4.9683381734322882295 1.2799020487566021842 -0.408985678779172801 -1.0510102732025599082 0.87961654366433827956 0.23201217799505086115 -0.9484585170041160973 -1.414840617861780725 -1.5478424263295202934 -0.80455289355579973076 -0.21898663194426415401];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
