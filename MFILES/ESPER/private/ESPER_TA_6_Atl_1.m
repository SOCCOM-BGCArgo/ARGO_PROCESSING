function [Y,Xf,Af] = ESPER_TA_6_Atl_1(X,~,~)
%ESPER_TA_6_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_6_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.36276291092010320982;0.9793315660989337923;20.293757572278742884;23.060698026436512009;-17.0087096494726282;37.51893666368995639;0.75077112762213205066;23.112027374885894204;7.4934067389410037308;-21.794495884810274333;18.252230546343469086;1.2054513465701028885;-45.009576499924847326;-1.6779553442595200874;-1.6536439107266487358;-82.072989783578421452;2.474422419265017048;-1.0023115556137560667;2.8701669444449833257;9.2528755469157619729;-17.969005757661935974;-1.8174056401152722806;2.2717792767170759127;0.64299544267050212643;-3.0457300100409150367;-3.2418320023897089222;17.347206559124433767;15.890534398166698438;-2.4975874921901701775;-4.9504044364784123289;6.5252882697856948724;12.187730487469526253;0.68487950284079990304;16.357987162266194758;1.8452834013002654689;14.365285261814943141;1.5073783128693869493;-4.2173552813431403052;10.257470812518759473;0.4986894667028575201];
IW1_1 = [-1.0143920315322212389 -0.16366585339834188728 0.37003190569159816192 -0.058486582565414092783 2.2782684739178140632 -1.1049147408604527154 0.33279341260545897141;0.052571360846935207001 0.35826848232550484452 0.16369606929529120776 -0.58829814144352032823 2.5452597569850694548 3.1952442840096075827 -0.24424587669847541704;-3.8871791321002211461 8.7899206776474976266 -3.2030678998058297324 2.5631060620851862097 -17.634614214255158515 -2.1085819775658967146 0.035683914969085114843;-6.1910721509606725377 -1.628409977018869581 1.1987198746950777917 4.2011685450578344359 -19.627153160495801387 4.5516413423591632892 -2.9902997547543259671;-14.138616236082244271 -7.8681583439023414783 -6.6919677388025871068 -0.67876087340387347702 26.001861107390503491 -5.7723525411396359175 0.14601803163307633393;-10.047255770581589474 15.502946592843702689 2.6701081777832813557 1.6709472105747857906 -29.069280521801736938 4.4318240643050303973 1.4047202168872707784;1.2493663142310416081 -1.7977816752597235439 0.3705475640521048164 0.51463445645918259874 -2.7925247775048398502 -0.1540068257697884968 -0.53797488928752246196;-6.2142510244130413355 8.2526261855527174305 0.15054035770166379615 -0.80431299725496974151 -19.788104091513151417 1.6452013240613267975 0.19798966898777653478;-1.2361972984292466382 1.230080834130186318 -0.25145050513101729894 -1.9687097082117657187 -11.525434391337197937 0.45814196683372521157 0.68345226777688128372;1.2391657607859738466 -0.15683659234282501527 -1.3976812306636285932 -1.0682618772428420506 26.411700362842900347 -4.9746749447316638282 2.4212202920278085294;1.8701404505846279669 0.7318687835918038509 1.7116581933946870553 2.6359700285453797619 -19.379475057454229159 6.1755390881496365907 -0.11723389289880654929;0.041794781217854688748 0.37560347359495871444 0.12463717363179832587 -0.58655676359816044663 2.0478689458896113251 3.0727784785226122111 -0.17403330324545110419;27.833856262683099203 12.059836761897047452 1.3286081169934957913 -22.534230494335503181 28.019422329853821196 -8.8073196679047658364 -56.847226431346967956;-0.87105495431830037845 -0.98922628203953077985 -0.42787979366360351374 0.71736688502194490002 2.834679124948067841 -0.42457649220825410818 -0.42283999002335037609;1.484443023533133621 -2.1815238157580663092 -0.47052956381236554773 0.0063867099958538689486 -1.9051952285432687262 -2.8023980644239649962 -0.9591272872969257568;2.1951063346644512642 11.659488403721670835 -19.260289913241685156 11.854671738379526147 92.275229613455366007 -39.186925032742983888 -29.878397330694344447;-0.83524456189278883933 2.419711812002589113 1.6212652726462881692 -0.66714180256573796246 -3.7416895967815917423 -0.46421928203030132787 0.19806546306048114503;-1.1717543029153081324 1.6285182966252109704 -1.2320240685479235676 -0.012823698198231260961 4.8435143365037882646 1.2926448182840308831 0.16013698903510997784;2.582316855212140716 -2.4101977579820723641 -0.75875144816600004205 -1.3092168108164117246 -9.3793529703734623837 -0.49455774434198174205 -2.5310521327566810612;3.9119396974995450655 -2.976707658541091206 6.6267712676654983994 2.2126955359885780439 -13.171651196515336224 5.1557850455652634025 -1.9425312118577873211;1.1859683349457688095 -5.7946760182889116564 -0.96905071484988525299 -8.1118777020888916951 5.9824438072769430264 -18.253676667396920408 -4.4002917642235592766;1.8526277245084414869 1.190663190846636299 4.4344081374395587503 -2.731520651800346311 -2.101097038760214808 1.5061691084133363994 1.2488239097813160772;-0.77602324792365706685 2.2821491984690580601 1.6791136748790345123 -0.65651649316156635017 -3.7038555544725184632 -0.53018431181265279761 0.2117790378372683413;0.85109808100427131183 -1.1187371127379124314 0.28690155502983150093 0.44435070656362829489 -1.3335592706020591436 0.23541806141124585472 -0.43344439000493939496;-1.1187022745743253616 -2.6129183161439253347 -0.95051323041036672734 0.37345701781229406757 2.5380191380319327976 -0.54326733708656560484 0.0023947720906966618593;-0.1132636569760587103 0.3742490983953646877 -0.06174018699923325415 0.44454809625341784596 2.4684904652162913408 -2.7242487966244870456 -0.30913192479349910213;-1.844952074152477639 -6.1315085281586734212 -6.0502300843258476348 17.489859175262012059 11.269512846850211929 18.480174278373770136 9.2802635583425239219;0.68706673123071626552 -0.73566555082119455822 1.6204382204782534771 2.2571144411736780988 -20.55734936043332084 2.437265404938855351 0.31597877227537268796;3.4430289040727459771 4.3330894835750628502 0.42972014584904838497 0.1129238829174357972 4.2404569001360101765 -2.1614148244245727781 0.24851539457034321767;3.6215135509924172297 1.0101038517716522946 1.239440770386561752 -0.90645517737939340641 7.0217755249772224602 -0.73024496264424132441 -0.57600927342981345092;0.085748348256803927359 2.3349359158031193218 -0.19733298329582127373 0.33011272358589949238 -6.6028742522648711244 1.9069380025131097423 0.2380199994672687891;11.179058943675240556 6.226971356592915896 -3.5745182055214828054 1.5665253125741249729 -8.0695269206957203068 10.577946717062364002 5.8092216654549524435;-0.45447319389802409706 0.1147417663681134653 0.11272304406904661012 -0.18221319325926296773 1.1930440899585121883 -0.069263533242163610737 0.24631318874088695137;1.5479818034128645099 -3.6606087916822604988 -1.0660074747910910364 2.2989446094111034569 -15.44843898121902015 8.6263328082428909482 -2.9297999624844046629;0.49232849009159185272 -0.45070564135438162534 1.4999702333537558996 0.29727134523953985257 -3.9664727782467190664 4.2886327009698872459 2.1790447377655888239;4.2060063245155934197 3.2992901675251324889 -2.6025754892537187324 -0.52886899687188926311 -5.928817894982469916 4.2279522222309715573 1.5363175473141876815;-6.2904578310731142921 5.6109326003799013804 0.62084920542105093144 0.97558168608689654899 12.28797811266859874 0.064483516879951810474 2.6342291513397162461;-0.26053134044507125777 -2.8590794938285624127 0.59639782424142506745 1.0598803086853780808 -1.1368036698079921898 -4.7070238565865327729 -0.83280225033885968422;-5.1727220398000772761 1.5512623650536909725 -1.999803601845855594 6.4044419903357088231 -10.113020210232120277 4.2011551579411232638 -2.7260319024447099423;3.1878692226436688983 -0.22380575410577788209 1.1518257350523264382 0.2317025985274427935 2.3907070251249713522 1.6644194913607905928 0.30808853135305885873];

% Layer 2
b2 = -0.83879933400445039204;
LW2_1 = [-0.19108005412665121647 -1.0981977598635390692 0.0065592265578022683828 0.0037468947029982708867 0.0049473927157438887456 -0.0088178493531743187828 -0.25342033033217298277 -0.016489571117353999524 0.037358005591889710539 0.011604369983061784549 -0.014140391026360801113 1.2137325249627424206 -0.00069800654924438395362 0.10514517098824563424 0.071099575431926978486 -0.0020422044521733167394 2.160492359510596927 0.088531618756446064933 -0.028500291029995034747 0.0046662981702611161169 -0.0051502955664619850043 0.016463247869257107564 -2.1228220384350962036 0.43135325051945316854 -0.084186128620938813216 0.14937830401954180215 0.0016718932517886984316 0.025560295399043884979 0.0090641517802363992529 0.034613185541557435487 -0.073969907969421350158 -0.00050674009485997002084 1.3680307221611560653 0.017518527830897964032 -0.043432884285630843357 0.042076200360484782015 0.012008966843695867768 0.01898784891909687314 0.0049504766666946765571 0.046609966430626509348];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
