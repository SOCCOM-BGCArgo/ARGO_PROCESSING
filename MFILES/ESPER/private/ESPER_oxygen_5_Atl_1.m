function [Y,Xf,Af] = ESPER_oxygen_5_Atl_1(X,~,~)
%ESPER_OXYGEN_5_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_5_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.2837568549238715931;-3.2929297648085613659;-3.1644086047242532267;0.36272128228604350042;-3.8856805457180469965;0.54601563932689900494;5.7813356851769306388;1.6939868161720967876;1.6096647552898968314;-3.8978644482873749944;-1.9287581880690367608;3.185191258027422645;10.314698907851385101;1.494094096372432956;2.0864322735296538802;0.098095172623978293958;2.314680311198300533;3.2846585444931539755;1.2727818829789849797;2.5430194312166740644;2.9299919339570177357;2.624959148789259622;-1.532583186787727314;4.0508631337811848994;4.3504783801240982655;2.4511422045685380411;1.2976782611596835437;1.2287622696410067658;0.11643663631798224778;-1.7986736709997752648;1.4333646160958173343;-6.1485647565687013838;2.3320997128401446119;-1.4297677606452889876;-5.7059237559911020199;-2.2848734060722084571;0.74451444914698927668;4.1639940555609520345;-3.2265601949903484069;2.5083057869798990325];
IW1_1 = [0.76718570216297077291 1.3905744089982099432 -3.0268782927084294521 3.6049532481438251175 5.4225210539241723851 -3.4389188167941564522 -4.0490177882512439211 -2.2806846134984759544;0.035712827607568546628 -0.37853918337929276516 0.30045382240160500853 -1.1133060936650751582 3.4230561342694159066 0.16916660464184102297 0.5569100525200270102 -0.01517601812382125652;3.7715613374327499052 -1.6092233491936651646 0.053827969713185520872 0.85138189281510512352 1.2636163407382841051 1.2727460043226306308 -2.7994756855008300356 2.1999011194416486781;-0.043483266451136294573 -2.6237847999012080535 0.59790629260274563705 -0.69168727826354448052 -1.1766839671009785562 -0.84226130335202098465 1.2617056792002045995 -1.3572635640462047402;0.027417221222679633713 0.17681280524802014953 -0.049098656299654902524 -4.8426321216827226124 -1.4504798165363752549 0.57621982854211950542 1.0672461719937045288 -2.3598165753269886302;-0.26232540957710936969 -0.75890961382627553089 -1.2713766177143843716 1.5774812450665047781 -0.16484166490530607896 -0.47641395516074769301 -1.2005336029237021478 2.2026528207015938499;-1.7702315078448047636 0.67822689890770360144 -3.0985908171778415721 2.0976974035687248055 0.42867995990127699679 2.4996649229119700664 0.58423056531577477468 -0.32283203630694679021;0.40895177323012127379 -0.91087322841220341729 0.6769237982990446989 -0.15256213432405371644 -0.1977301349869475533 1.0300127156099536663 0.4951693684823748054 -1.162419176010765165;1.2255038879958781717 -0.22222616046458676387 3.6516719214211215139 -2.2614018990315418733 -6.0566761189147069189 1.3611731097463446449 1.1483369183713652006 0.22716133175194702654;0.82539082196061286378 -5.6980814163411785955 3.0784397297741459276 -1.1764580697558482125 -0.78203674873305872861 3.0570869600637706753 -3.4567351430857029548 -0.76148606525560635916;-0.072095534056297150283 -0.74537211018110294258 -1.1612283938528458194 -1.3731445177907797284 -0.44558977239017755201 0.89584038341892990864 -0.58781203931400793916 -0.070785171760378795547;0.31434881704035444461 -0.49651384845938612012 0.66825228850383788792 -0.0040126154291368005059 -1.818135953017137485 1.3221203877338092436 0.35758304041565214249 -0.83724445417158577243;1.3624317176308360366 -2.2920294944294425932 -2.1809261825477341823 0.13132191888340391528 -7.8278062465861708574 -2.2447768628782003297 -0.19394538789760604192 4.6848332297133694624;0.57394949612354173585 -1.3700564799433261332 0.97937256499992730863 1.7960765996417222823 -1.7763032866235635154 -1.1053364641242082733 0.25241653024869220578 -0.13002151668605813062;-0.17427363272327833776 0.35984758987286313836 -0.20928151750062914949 1.2087011557666198502 -1.570874397924514998 0.24382311879184381809 -0.39439361164435637885 0.63983542000301452113;-1.6949091863019185578 0.89928121202938515744 -4.4801564267339122338 1.4102181916817881913 -6.8317908858532367944 -1.6476214694054005516 1.0477776970523622335 -4.7847964078775042651;1.0802389406093535484 -0.96810747726985624251 -1.1711656973399917625 2.6315740605614097447 -1.9759345929038563128 0.94289047333285558317 -0.79950875664608167526 0.69696191736661250449;1.0103198533107431434 -1.3350585406067936312 -0.3676824825014659015 -0.47519927398695899212 -3.5025345914317620455 4.0322946132634029937 -2.3061860547356660689 7.5631210574184937201;1.8585194008751719785 -2.1283775229618546732 -1.6789509124258272799 3.4316190050351695895 -3.4634196317069751991 -1.4411820485910766809 -2.2363737556071847656 -1.5676611008635501499;0.27517132125966686784 0.15984235809735214406 0.68101135259630485308 0.37562697804747380292 -0.48538979892073064182 1.1239550405216365281 0.48729030933241634926 -0.89400309825354595805;-0.37801929543533979716 0.39866981846581450721 0.80087809014330202384 -1.6962729061664592045 -5.6132995472951705551 0.045567541837142983008 1.4343241093737315595 -1.3672966766786536219;0.036170600813980206822 0.22229609555618837224 -0.12669398163321310413 1.0133481363451997126 -2.5566989523831264997 -0.1730280184946595412 -0.24448334278318856194 0.005194497923918722955;-0.37112707643564318838 0.08527372440172506507 0.028649767946319421724 0.66484318223576921447 -1.5170976853767301762 -1.616137830438786116 -0.3565785993139528598 -1.2394667975559257034;0.81305899680303284072 -3.4492474978869416269 -4.0790006181549181008 0.76788887123989224559 0.80683528523798442311 2.6910943484146505611 0.080111645092212913077 1.8360737406668115046;-0.22349928382516801029 0.02990574388290796054 0.25632497263788667219 7.6442313062880167251 5.6642350995475867492 0.47689368626525868722 -1.2061085800397075563 0.25721876446402386351;-0.26693166924488009872 0.27100983273909040605 0.80207924745227687779 -1.5475834606868281718 -4.7333381934441804972 -0.03532366758967178666 1.2465987493516053064 -1.0623518206608368875;1.474685123670253839 -0.25603228820420054213 1.3661384144727999335 0.72207837564821963916 -1.435952965571524631 0.97228687426314985842 -2.0118284443813831963 2.3358506203471125495;-0.015332691053913613879 0.25055571808617976837 0.35068278362490123978 0.79359900746722988885 0.40325530510278040364 0.12004562674087293495 0.38334157565999277262 -1.3569635836390789851;-2.3099259499789766004 -0.16406619149481091458 -0.70324214570393428492 -0.34991662709034165868 0.1664714882952768038 -0.51660821140851576061 1.5356770014228828813 -1.2942876621037138207;3.9625276244877500886 -2.4436931091306348662 2.1276951609434195944 -0.0033721318887849271659 0.63593879540304409925 -0.079761538413500601696 -0.97277789889286714331 1.0084841298552598143;-1.1783638591505918303 -0.91206452664325443624 0.49017426665110597206 -1.8042998810604038429 -2.0639480450387464039 1.3649818220948239933 1.0650952100027655245 -1.461084183134377712;-0.92607319306877777798 -0.88970420005187744739 8.5197394512662505406 -0.23190140163683536922 4.8310164424117054693 4.0825297471057648835 -1.4275730335845353558 2.7393848085708669693;0.090253227604649405302 0.49782208576113118337 1.2317129263790280724 -0.51036493760493850669 -0.8855174221927328837 0.88936460109725512524 2.1400118059642458945 -3.8960762390832410773;-0.90522081908032359099 -1.4628499211944230307 6.4446805714559278755 -2.0788567971492737385 -3.3381446572554489549 1.8719608649712822235 3.7418083486507405233 -3.6188806940767297426;-0.81860118197446185562 0.72914130175470437401 -0.89410537952179303112 -7.2013687598816886748 -3.2849331635060234902 -0.73720381639177767763 0.85915783122037425734 1.7225534650118317082;-0.17998570094192054003 -0.83570089515152601312 -1.0247606442769845447 -0.61154494005500836806 1.5051741695900209272 0.57064844564085526191 0.26973358561602872596 -0.41785159093658336138;-2.2035967342707758476 3.8638132473947894852 -3.6399644377344024804 1.6822197428534924057 1.7052281706169361009 -2.8009230741861852465 3.6613459966057910755 1.5953764655316859944;0.45827536204212426796 0.28288006482931143948 0.54488574264820188731 0.9912445241230198878 -0.22309877824251961309 1.6097550414257213447 1.1580298253129222008 -1.0022245066069699337;0.97080000483844630654 2.0271873429223732366 0.79400243321623409365 -1.6870841450495499547 4.2429700882559808761 -3.7627182826164258245 4.0627461744829398427 -3.1411889153427270394;4.1596895711700989651 -0.14887240926681055697 1.0858832311934822901 0.2549617736364820364 4.4023169153294690048 2.0821259274077639212 -3.0486827440391275346 -1.1415913544094733467];

% Layer 2
b2 = -3.0600329782178001814;
LW2_1 = [0.016222628517772910706 -2.6116311464144366106 -0.091584402304604406453 0.1129513537824015923 -0.21453829499093535205 0.24750210842903749842 -0.13918264221120105195 -2.8024683777789776151 -0.11439295047237071912 0.025440288380807224433 0.4533907097392773089 5.0028433632798270381 -0.12183506279706492192 0.18389564860061127782 0.78219240538426126896 0.12919355927504269643 0.26119354590794902071 -0.07317264752641970682 0.055595058222499244005 -3.9398267533452888678 -1.9894610927999871741 -4.6835429768350236301 0.49066505384053965555 -0.073106716425451662156 -0.30341023651079190859 2.6230274971375902027 -0.19756239865119495924 1.6536529037214995341 -0.24658218101600046235 0.092306487365700587433 -0.13397145350458664059 -0.061071567755069500194 -0.18763277762928873282 0.059922855203459843287 -0.34538281617002120072 -0.69094747384189059147 -0.021677586376972701743 4.3964660421806467383 0.062969278953509219554 -0.16991171000045887651];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
