function [Y,Xf,Af] = ESPER_talk_6_Other_3(X,~,~)
%ESPER_TALK_6_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_6_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.46055362309762166;0.48055763829222764;0.6412314757693478;0.70697231379100722;6.3081276922129623;-0.38805520502322016;0.6258743498923699;-0.10959295668647717;2.5582649107865088;-0.9465940396136735;-0.85331949171516452;0.46212857186320122;0.15726264806831317;-0.8587396587062559;0.41526637027605262;1.8112764272628106;0.22119400305927622;-0.82406679562581264;-0.61655665194161768;-0.17884927521890243;0.95780898921783353;-0.18863701809634589;-0.021394903015858412;0.13561227925596164;0.37560313880988083];
IW1_1 = [0.52363561199450737 -1.5249973234332141 -1.6148171930524824 1.0067542113193686 -3.0232166856192793 1.5754360851184457 -2.1185383836074618;-0.19789234072237336 -0.024439365869424998 -0.035258388867106624 -0.12675548261641642 2.0871233119078472 0.08410808750569658 -0.60980175541962556;-0.0086213970429510275 -0.19620321214066225 0.084707219577595333 -0.62325793802696239 -0.32118389733235292 1.1027964108979798 1.5806395960482673;-0.83559908140983274 -0.16942759719157494 -0.28699759578940404 -0.032566859522257394 2.8220167255032771 0.99869965958130702 -0.42887992768361727;-0.045318506423826468 0.11828246075308377 1.8826629163657564 0.024935427784474065 -1.3312484879134883 5.6885330664494838 -1.7303947055520286;1.4146016872643283 0.94470551738866515 -0.46596823378606872 -1.1599295117593851 3.6275604059262712 5.394156582281024 3.4487299882657432;-0.03875136185847125 -0.25849812703314684 -0.72853506663329826 0.63027809017427538 -0.26449329491332713 -1.1549111895960598 -1.0776066463272072;0.52144091902588885 -0.19305089488173291 -0.1790276035182308 0.41325537578276245 1.9422462492552257 0.6834432574513315 0.62137269306536536;-1.9142640542952765 -0.33912068884943003 -1.4651507776966139 0.14767788357290515 1.5000314883618917 3.5998868710357144 0.25606706821952313;-0.21473304151476527 0.20601030250986521 -0.33476396484066256 0.12071706458792297 1.5795776233294163 -0.056891679606467654 -0.76246582771920923;-0.37581402053932594 1.0837492874577652 -0.12188463658860196 -1.3175915450295028 -0.59804520728523713 -2.5014736023513171 -1.2883486673108975;0.33798702963918209 -0.55446672399801633 -3.2677389723397394 -0.051682271193654532 -3.1614411358900782 0.86889901661058355 -0.11731753545106283;-0.67884586401806568 -0.78924048831821314 -0.14281152136048056 0.44324310431698871 0.96628269351683294 0.31040578577629929 -0.29698869770901237;-0.033411209508614301 0.35851647727863839 -0.43436802693435722 0.48565382735814572 -1.2236985051554088 -1.9396317665737814 0.5852210832567063;0.92536439260975678 -1.5808340556081031 -0.13349367546080099 0.49905645749226685 0.7171928153033611 1.1434828295946537 -0.76370497263081782;0.084328094617842533 -0.32924293241086044 -0.052406947924449172 -0.031229598193357574 -0.93946904090537742 1.1324678375295725 1.8350589135589894;-1.1786027304547644 -1.8505802509278806 2.0302097251239215 0.18609487831763991 2.6913154458417239 0.048029968313023627 0.76249088770664775;-0.16998301363384136 0.15110840380319152 0.24224110920404712 -0.55106327632505325 0.96846321070660957 0.79661358933119086 0.61299484956370176;0.62262278716276775 0.37008348638015703 0.072108511251897753 0.48750707610919369 0.23416974559435347 -0.99711604598726766 0.43075309789222105;-0.28892631134970553 -0.081106328350114526 0.58894453931835233 0.78601694708362102 -0.032474320530155427 0.17926421659594219 0.75250457432279882;0.69790278890958235 -1.2473091432400449 -0.22646644766368745 1.097980607743168 0.5277377931035081 0.95821721437568341 -0.83845549607799597;0.74578722192110636 0.067370622642846961 -0.14201790516932097 -0.84475785957407867 1.2845070272453631 -0.047576168965469165 0.51074061456841713;-0.8708197647279432 1.3677586401102926 -0.52418183319177702 -1.5962552100235279 -1.8080157583358112 -1.4731083765092949 -0.47137969062273194;-0.40370453778030835 -0.39857366006924982 -0.11838639728909535 -0.23510995308414973 0.85172030356370687 0.34901617037952321 -0.34284089622568747;0.91301854132416871 -0.015740334596899837 -0.28537144140382792 -0.5604092019359771 1.0531037478149317 -0.28293519802414924 0.80683896482265161];

% Layer 2
b2 = [9.2229707236240799;19.670414690809668;0.093449048164402831;-13.601440111667907;7.4319703134084127;3.2109722670306891;-8.3616770791849522;-1.4089980253079191;-0.46298499173659713;-12.450983258507;-7.2094589558256157;13.313869737597603;3.3605732248825184;0.85693610654657115;5.6003190086307875];
LW2_1 = [-6.204103465334299 7.9020256016214265 -3.2113561147219993 -10.137232901569488 -1.2741848561951747 3.4891659755100366 -12.952307516834116 -10.109064055522472 7.7434658347345895 2.0699431398189034 0.19923570474958757 4.3131290601894685 7.3992921652825592 0.90436484290548458 13.151880658616951 -2.1062031737286602 4.4985119401191582 -12.016144350003076 0.79645443132446947 1.210556656958069 -7.4149317799611891 0.2410118174193949 -9.5127487108942503 -13.766139701783617 -4.9496289883781177;-1.650667739757719 -3.087975799496995 -10.087180763150164 -1.0064030847755687 -4.8467060441325325 0.093260098276233785 -4.9459737389406859 0.97402740736238314 -0.82615380137882133 1.7810651201101109 -3.9352858903287045 3.724241862130544 -3.2730258855485164 2.0370099159077819 9.261173151875111 3.304378159937623 0.55358598037221118 -1.6865090586490687 4.0509636641828743 -2.8117392578729845 -15.212760951623819 -1.0343292133326676 -6.1284153638948657 16.902327953292893 -0.29766094566193424;0.49810189215668893 -1.7024762370457034 -1.0298776078665466 3.5342814045282238 0.035195625526506555 -0.13131999733704444 -1.8370468233826376 2.5834021892210992 -1.2784754872348612 -0.038647840275078164 0.024281605821643813 -0.2680100500919298 -1.2086454577538173 0.57836688205637954 1.0504278143354668 0.35106843822273887 0.57393681391228635 -2.3476199542415839 -2.1746822808315573 -0.39362051421633426 -1.9007219730669751 -0.58061823472973484 0.18705450519953398 -0.70145973300881037 -1.2975864411342295;-0.25150037091028005 -12.696011252193975 -1.9908963752752138 13.147963470683122 0.9707236646707923 0.091303476523425409 1.846164826212906 7.0670223636873741 -2.1030702523065421 -7.3334795785815805 -7.3743256664700354 -4.9435918191625374 -10.31388390919483 4.2974511696331703 2.6439628782789328 3.8393493319603929 0.63302913641306624 -9.98968633911627 -8.3858134506297972 -17.357051056255983 -2.7305630437210446 -6.0540420327345323 9.5059687258771355 5.504558721983555 -9.2148328299109377;4.0013692208749054 -7.005516051214209 -8.9392386407551125 -4.9663067369247749 -0.76754982725403642 -2.5867831798122203 -1.0671096195927845 7.5487743062707864 -0.42529103729992057 -2.3532912812026483 0.32405339545760059 0.78196986560090731 -6.8662088496674247 -3.1177310865757901 3.2917920177492288 6.7721886344507443 0.14056775493978693 1.139693449021409 6.4992078146362076 -0.23382778236689039 -2.2441125360333878 -3.043978552951867 8.4246533724963921 15.503669133704197 -0.79770928018352172;-1.7064468259263541 2.054498920727879 -4.2264153328639287 -6.5010515971272538 -1.815881172070835 2.4769174294958325 -0.65177043205127994 -6.7071621316924723 2.4293989519759212 3.7892773205153136 -4.5520644179373475 1.077967768035619 -4.0237540071494022 0.3827920507035209 -7.7736907894313454 5.015447888225979 1.0034102989069762 8.4490805103006323 0.176394596520279 5.2630507284361183 8.6689399388290145 3.1558992755095048 6.935519077985008 5.7520643035428325 -1.0385555144233813;-5.2091444856264548 18.673156961178037 9.9934048726460034 -6.7236948352776889 1.6975428988916039 -1.2283556736833112 3.532692369419975 -1.0354853722974258 1.15460160869381 1.9376592984125831 -3.3532816920692659 0.096163626701248214 -5.8714423223270895 0.93522264220606044 0.64102467946416286 -2.8757302704945689 -1.884030768923177 0.59754470411563043 3.1200971629213026 12.729875962094814 0.27377414415442392 5.1266177585940635 1.8386722608377577 4.0912963406812706 -9.3469359404555732;-2.0397140102242615 5.8244179616850493 4.9854618806704458 4.0528235673628288 -1.7587589363409373 1.8877140019502627 -11.759941770507776 -6.9748586330854705 0.72935810293988979 7.4953985275639985 -7.6517687565999886 0.17077007499998578 8.7905682334396378 -0.06395272068723834 0.43728875791916672 -4.0611556009832901 1.5268354648755129 -8.742633978830213 5.7761402537942459 -6.7648177420977218 1.9718879238999414 -0.66452868586081848 8.1440266595697342 -15.83489240109229 2.211958140317785;-0.31852012743403546 0.47914924638285122 -3.4157506210754662 -2.3291247037697698 0.16483860038582884 -0.15937838433854318 -2.6264320722361054 0.20337382720237096 0.87317932856121061 -0.57772705711612671 0.79483028179017423 0.47728875018897032 0.12308374382386483 0.3515865898677108 -0.41865086819049147 2.6741417271081955 0.077177142297173373 -1.2598732210409853 -0.86351529301464824 -2.0660882513300125 0.0072940238820418694 -0.40401613364584282 -0.9612673962724485 1.5171714236175808 -0.10839661575983822;3.5478837298377099 1.1684391066645035 -7.225108150817305 -2.6705927620141172 -1.0300486773040192 -0.12533718247178413 2.8180722396098243 12.250327930667771 4.5680519845306566 -11.505178663898878 -0.5274849530759198 -3.5171699476276617 -8.7793627277268413 -0.24576636346407812 4.5736997374997861 10.242738912180359 -4.4249389048756251 -4.3599355742907671 -4.4731098678860679 9.4866269805960375 -4.2516445502257252 4.2918324831075214 4.173583127812627 15.472728184158287 -1.03189531016292;1.5185220527147629 3.4683940696185944 -6.5524327872727053 -4.7132987940007913 -0.62810592124074349 -0.050189397171255194 1.4090843710668393 3.7070184073492989 1.8626633343255139 -4.3069375536223049 0.40065552748894884 -1.1096384414939127 -7.6664729176516797 -0.14716639592884079 -4.0279882955210473 8.1765847275142622 -0.00047297699082330183 3.3021820529653216 9.3626695114144436 2.4013191636199283 2.7461607877054024 -1.0477029212912401 3.2400380585816828 20.529359587543638 0.73650534802843393;1.578119758310113 5.0733509846252147 -1.8462736418068932 0.036580976752593218 0.90447557111377808 -1.4508433577796123 4.0230124524442354 9.222786815154981 -8.3567719491993149 -7.8280579563967239 6.0757670547176454 1.7475423383741293 -2.1295838986986362 2.4034966888862868 -3.3594388255116017 -5.5126569588397833 0.23858997289453165 19.027367824117267 -3.879101729941651 -4.4210334197729511 4.5848941610741933 -15.022110902385538 -2.5153174198589174 -7.5666464510524589 7.9234220189188038;-1.0940883097923555 -0.59582579866550411 4.5579613266710357 -0.76648695967687308 -0.45626149480850298 0.483662955045495 2.6432170457562747 1.8393244376594577 -0.36301319585045128 5.4427479537259051 -1.9813928588664893 0.67279774585734642 -6.1032747270159255 -1.459426357147833 -9.0139704766425641 -3.5017895202764091 1.7436249358433094 1.0486410281950855 1.3301292525084367 -0.36838228650754828 10.109731279976007 -16.657141413385482 2.1270644501819627 5.8897475665592314 13.745469025002523;-0.015895228122472529 -0.93573115212840252 -0.17128357245818712 0.20777184013148242 0.027686955367836108 0.053948709145996851 0.31066673875920348 -0.27414184301521494 -0.075793845220744935 -0.21141160185047267 -0.077704451179108777 0.0093598407638162476 -0.043986211519472802 -0.18474592483304908 -0.062845517749320678 0.12607868715587819 -0.049572854518754504 0.37806113149262605 0.29426538127027901 -0.13984350111504548 0.12619719657383716 -0.042609343467204443 0.062619338084747192 0.41985337159948977 0.10624566712800169;0.5243796848888187 -7.6351262060371168 0.038616483805398186 3.0851653510253128 -0.8124020504429621 0.1794309859509077 -4.5032273645837941 2.3701155257206112 -1.8325897112067742 2.8231385585846853 1.5341303777658821 0.090175367191830183 -2.347400381541946 -0.80709610737170556 0.041333758648865827 2.9473723138322585 -0.10394129843889184 -8.6495322130293673 -5.5420240019341769 2.6548243106159126 1.8574943409459861 4.5633586839813125 -0.26536147518173203 0.23471781245221479 -5.8067705456781615];

% Layer 3
b3 = 1.5008334192559576;
LW3_2 = [-0.0077602943451341071 0.1572817305194332 -0.19370339931081695 -0.013984000327496847 -0.02239538799779988 -0.02073713234802109 -0.024528121120209231 -0.019641643064495191 -0.19764309111040251 -0.021215760189421402 0.038443423496139835 -0.023509591073424711 -0.099728648706935499 -2.4688450563138287 0.056712862325121634];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
