function [Y,Xf,Af] = ESPER_TA_13_Atl_2(X,~,~)
%ESPER_TA_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2382111778704052441;-3.4419841024371966576;-0.3720096873013255534;0.4883936154867578594;0.66171980887224979284;0.6776405549111721438;0.27164955641195942526;3.13260777722273831;-2.4335326909020080777;0.82632411929498539305;-0.62179371851250087033;0.35141594040852591752;0.26079050370275347337;2.5365042487701621177;4.3701985487540566666;1.6978243312311218638;-0.26973538180898687378;-4.1910682387282793826;-2.2599710879206891256;-3.3778502808617343334];
IW1_1 = [-0.91841946562767728945 0.9853865151391674182 0.38914919379666701449 0.48426425159483221794 -0.95356004466670996056 1.4206514220997095155 0.3020589509721700594;1.8869363577139548482 -2.8250466028436145294 1.3902334954137658407 -0.36982099661346384822 4.2689204587548461589 0.39305214619096368045 0.77928334635858687029;0.046321859019313120498 -0.21156036074792283763 -0.76078065470023292782 -0.54596525522401040398 1.89945608041757108 -0.60764343246622920525 0.80199958917605462805;0.22784926320775558684 1.2607654752847758939 0.47613723798490303896 -0.089590444867422194819 -0.93009613342877295317 -0.73121167126286545912 -0.047096926107200606793;-0.076426650353567063267 -0.37419474758119958269 0.18558394481402620824 -0.063797813046322537911 0.1490847187343470881 -0.015857833039761074639 0.13130434507411209433;-0.17821278485440958383 -0.12405308634651210364 0.56161667193201003645 -0.20845121877663369547 -0.48634420061523464529 0.15174235307801439698 0.010597761331670479956;-0.011593899789645841295 -0.057123777519431401251 0.20574052622732347251 -0.10581813600628589556 -1.0140275031807599593 -0.036374734256197305271 0.024918967438428037131;-0.46522638253059611646 -0.56467486078166340135 -0.29653862082437987269 -0.54879239271742741302 -4.0028918704134852646 -1.3868210313389610633 0.63785655919997474861;1.5834774633630441798 0.33509199623266106016 0.42620334440088381012 0.58909220945711660011 0.37900534790755696646 -0.022969874845872227664 0.33739424786130406408;-0.21037440217293473799 -0.51340119922142191111 1.16887797369329971 -0.063860421109333195822 -2.5905313490053067937 0.5170747671964832648 0.50813923294425311639;-0.15656517859175156371 -0.29470618565103540165 -0.39713730460801588418 -0.35562154255949018911 0.45186513418023765976 -0.86075943636026286399 0.2153086854483419188;-0.88709082260398075537 -0.40388132512924607154 0.56262024513386388325 0.36592274859835993706 -2.4650325935766566054 -0.23974547823623043596 -0.92969990318755157954;-0.069186019333362130945 1.156343065472734688 -0.58855443964031806114 0.27339664504660882161 -0.38670139171062123395 0.21740199204162444224 -0.1997288351173134302;0.86200218710065812378 -3.427334040829705053 0.18669155384691057953 1.1722545299175741729 -0.97977994842230264894 1.0657026227937889118 0.3938408481471419309;-3.3382560448294924527 5.0213888594664162213 2.8095725246805907105 -1.8789756555703440721 10.184117892362305469 -0.93142848188368321249 -3.1806518375455290482;0.11861929327523595967 0.68414002728697853595 -1.8943131145151992367 0.73554411722157864162 0.68773578522562406334 -2.6115213954497829008 -0.71492591276265549105;-0.79570273947928438218 0.098715765322461249132 0.19441627174274203615 0.76800071174524064954 -0.43520460119656034781 0.53718141349778314453 -1.021898114423945847;0.86089836193620872251 0.35109658102307095273 0.47718623052503189585 0.24245067949422288711 4.0782714407882618701 1.0809114661474812369 -0.67991929000207795841;0.15358270502636187094 -0.47999410191281344229 -0.70404644863090293239 0.21565840231089902779 1.1805470602532279756 -0.26266768868558704186 0.46363172073067132617;1.7914195894383713181 -1.1629624669938916082 -2.2493670862123766874 1.2568895752452247105 -1.407530168634298029 -2.5876466682373249206 -0.49924479093848234124];

% Layer 2
b2 = [-3.3007611044808728984;6.913153828824323277;-8.3409685060286964386;2.281818317886306513;-13.946409060030429572;-0.40018247799358991346;5.2151653185976076799;5.0957677171044970521;-1.3495673967401327076;-5.1598396638273511527;-19.724298176665641336;-3.7880695778692361486;-12.260297803079350132;-0.020211447595758963436;-4.9623163646418317896;1.7582042007057279154;5.024020401512176548;-10.69456308267175082;-8.810739141391454865;-20.019324841181084906];
LW2_1 = [-1.5259110730882985418 0.58490301842099867713 0.45046692692277290337 -0.40580721335264852145 -1.8312813247095254265 -1.3842634672403093532 0.88560617009409947631 -1.3590656967550744927 0.026367082141453626609 0.15556435481192873449 0.70001892294575052134 1.0038321164052259604 1.0855745771160443258 0.72110752420910473326 -2.0856978633580678384 -1.2921025060399642381 1.5546780527207502143 1.7615317962542749175 1.1245859388978165505 2.1022281263524922323;1.2208708425381824547 -3.460811199828111917 -0.66276488098881980449 3.0181270035174305733 -7.0676303187580726828 0.59835546684257012728 1.589968406473555973 0.82291036776456538693 -2.603034765256873051 -0.30282109406379614791 0.079543830025936623773 -1.9539998207197424307 -2.9334250336063116826 2.5669733822707683224 0.42172997168869075235 -2.1527834453860825725 0.13737699259124172557 1.1445935775429594283 2.8514351286786463469 3.5312154521248890759;1.5427728680222405622 0.20154754675724423363 -2.5060987886513017564 0.61740208906543192491 11.249568009644010047 -0.28023850871489502934 -5.2255822646404812559 0.011207271133463822879 0.090413676250519922628 -1.2265938107796647838 -0.11460554190188790291 0.057435541964393918568 1.4437428220351102848 -2.2892040243618243522 -1.8300133277791099662 -0.70767512932569898165 -4.7160312423927290837 1.4528391942950835691 -0.25773806805907961692 0.61319696349611074737;-3.7821914280153050569 2.7953968559042130515 -3.546843365323590902 1.7461921795457482354 3.8823471319562870008 7.889678001257420803 -2.1877792967993769935 -0.046812289235572616952 -4.5226601582179268846 1.3063803515809984113 0.30821087351938181165 -2.2005451154872464059 10.965204414572285785 -2.2386047748742874397 -4.6757745622749249392 1.776411834773561349 -5.9618597227668841398 1.8939825449262095436 7.5287871744583867439 1.6174923222365285014;0.090272036685152379221 2.3037080761656367756 4.7336578079204372216 0.1337816246619201177 17.152825837149048738 -3.4806196398491433541 -11.269686074103029583 0.78265227259795455694 1.103339755504527675 2.5513067157963997822 0.17583845410400797404 -1.5729367025126685942 1.3932468449725545767 -3.9290257844605074311 -4.0798585170201704386 1.8761723039437450122 2.1358347701500641769 2.5319275546295370027 -4.743942848587402672 0.036262313604892154606;-0.99003142095110785448 -0.79854765473737154835 0.18365946694653709215 -4.5350652980455326002 -2.6902586245834285705 -1.9584511466582192885 -0.21156877082960021119 -2.2088690102177901409 -4.5857207803738262442 1.0063811065200876094 -3.8247080268874995568 1.8983266184570009028 -2.5599806543933829595 1.6225812399788219764 0.91639940280324461153 2.4942735229298160782 -1.0752156293582459945 -1.8153420682899092942 -2.2583018905224085948 0.76849204697497242034;0.35239783608185082375 -0.96748298236429008945 0.53011025962857982741 0.17081680694628489925 -8.3532846337140114201 -0.16061917280456533552 -1.7436437821413821592 -1.507339293694915261 -0.17961925963990540978 2.3136312754909553746 4.9077999578426023675 0.38374694345893972658 -1.2799969924093215212 -1.2466525653574107579 0.30938492380626869682 -0.060217252041476786173 -0.50725133702913138833 -1.6184626393305807657 1.6777498610907788379 -0.93283551517567042666;-0.27969692477009955311 0.38805172724273984119 1.9862779121890705714 -0.91151152968423410083 -25.735238127158172716 3.1089762507535856351 2.7756648529959737637 2.34890985311478806 2.5617924000039518084 -2.4699118414151057799 -1.8568242932743439511 -0.76950554375061042123 -4.4572047567235921761 -1.9876187399434006586 6.7303040585724387412 -0.2746123125571302559 -2.7059229626575969085 0.68991491265243876096 -0.072783572094855086831 -0.50902441429837952391;-0.068241755471704038105 0.20627739953885754209 0.83358481316289390062 -0.22465566656638311094 1.5493021956206480816 1.1633202180422232974 3.6131568251146877202 -0.090220247631141586853 0.46877184686129691471 -0.75857861171035256831 -0.57899093720225591753 0.087351505939313761617 0.45699352181625940705 -0.28514508555677176016 0.7040331536163704218 0.50833204053900538089 0.081581935835123603473 0.032506663099555001273 1.399235335234933375 0.46885481279143365052;-12.086056098314767127 8.7205165057940678963 6.8847814554241635321 4.2727628836931943468 -3.2235781745344280758 1.6545280940341990927 -36.698600571930377612 -6.0452710872310433388 1.2795404538030019648 -7.6026604885856627902 -9.0150349763360697608 7.8586403352307918624 -6.8433105394215489881 -12.330689198631288761 6.392727812751338945 -0.037064470402767973889 7.3674523499123836245 0.12970348522414831827 1.0545263730696647908 4.4626272030768516785;-2.8623559327581138412 -0.25620419785552078773 -1.2052386765104174948 0.41795326694954204605 21.81207616992259446 1.273627694762305973 -6.2389396409649746644 3.9838919631477316408 -5.2410710679139249635 2.6568263994343621626 0.1169136992283690557 3.8403797389389184858 10.37557233432110948 1.1316018283997668625 1.5180886599465583942 -1.1068198443543366682 -6.9390526829214902449 1.383386250878370527 4.327546060892937696 -0.52127154150339682914;-7.3291721574258099636 -3.7000783546648854383 0.21251629133486860113 -1.3047780761607423727 -4.5954798756505317314 16.468311314556547842 -0.54435345250622646507 -4.3938490047216269829 -4.5185304375129788923 -3.7101685945959870239 -6.3688201573510117015 -5.1350544967081601655 6.0283771918704633919 -2.2588865097436774398 -1.4469350562852862918 1.4388899989702883531 -10.662210280257140127 -7.5505849894514049936 2.4392944658767521382 3.3250200914663774476;0.1907314988893503982 -2.892142231098093319 0.94076815614213726846 4.3008014226989059736 11.54816816909026933 -0.90147854873253985275 -2.6468195930214544198 -1.711963588351592902 -2.6149829743479502397 -1.1645052939707893902 -0.53021934496185585406 2.323869270716831803 2.1069808036951500618 1.8310618669239173695 -0.70967235596484201654 -1.8645748919412949984 -3.8201117682454888147 -0.80438055697726573712 0.20558916829368265033 1.1287520776382471421;-0.097823976887804392488 -1.8937020002860369683 0.84532878879798400984 -7.2557548257234785183 5.1610139966522128319 -5.057267112867696035 23.453223978086150225 -4.7640452545136255935 2.5021287030459049561 -16.167320999394554804 6.6231284334065465558 9.0052837957770588417 5.0650563994057620221 0.38799559141796680084 1.6875526053415528249 -5.810658056488338552 -5.6781832192266650239 -14.71713744764830345 2.3906588668122332741 -4.9744273912456380415;0.79266974658677114007 -0.38099229194283340538 -2.6942483970585646702 0.19688063844184588991 13.082159809012603446 -6.3571726484876656116 -1.384011606544686579 1.4601388761553613094 -1.3929065429360443229 0.69498560993439728595 1.669284022496200004 -1.5251537533699868199 1.419454757126519473 0.53581983355610773856 -3.0764011450852737362 -0.71501699793645967507 1.4776337526238505493 2.5311961175895345555 -5.0188803520562936811 -0.66470905444373096227;-1.8119200973914302288 0.21611802037771712937 -7.635369475176663201 -4.3677559042702336356 12.347547753540158766 7.1558743435528988641 9.836160538838624845 6.7138177075040834652 -1.7232643686383355419 -1.0678243059568046647 -9.003892636819822215 2.9913480146151973926 5.137407158627250503 3.5905093155677336725 -1.9543902688375074383 2.0378832004128244471 -1.3880590938746208973 3.1518048641847227209 5.981594586588379947 3.8395974737541744837;2.0819369805125016448 2.868101085455285304 -3.6198266160203611541 -0.19035769284060111151 -7.1215566669491767726 -5.2938632333079489456 0.68009492318548814271 3.0998020787004838539 -0.24014217016919450765 1.0299968637941643301 -0.73474625309808383467 0.64822536402695651869 -0.5480615168901207257 -0.93941745047759606102 -0.073380569294926784041 0.24161826533957203589 0.48130802257583232828 -3.1885303800422639675 -1.8610380483708699462 -1.0235804369274550396;2.4719386334233788283 2.0047667984834331989 -0.1346357278952654557 -0.14501938958586038653 37.056511766800092289 -0.73451414675088111395 -8.8380445661636333199 -7.2530984351081269068 12.587324274465890639 -11.432170555087651564 1.9210354373220361879 5.6179969129442479669 2.3283152976603451734 -3.4095969728062183179 -10.167140945274320885 0.84757157552274209333 2.1683437489941792542 0.036719570206680020308 -16.638378831524715196 10.082500778718904044;2.7836251311084327931 -1.094969972591297358 -0.28647608578414079927 -0.28126809124893953351 -2.8621731974793225284 15.702151858339314927 0.10254452670976588191 1.3017762856873358324 -4.6058261542882537043 -1.3295852219128019289 1.2141543750204024654 1.2411841276282848945 -1.6943258240545808757 2.1854859483348709759 -0.56665511981611238479 -5.2061212666249376824 -0.6294560119650294272 0.42747342124097725824 7.3505847723421471329 1.4004222833382029556;1.8167765915141060873 -0.33283451169111905044 -2.4099108036562593149 3.499578044542687838 14.92281059013935085 0.95969867307989775718 -1.9416652687927824505 6.1528073244635024253 -0.51653989863100191471 -1.4957814545411329821 -4.8712108928128827756 1.0809469636834676542 0.52880356146667994999 1.2663221052733872884 -0.82031180304598749764 0.51305169476045719978 -7.3223453505615268 -1.0699997147988813406 -1.1766213298598502401 2.7820782564249659785];

% Layer 3
b3 = 0.082712049860804798262;
LW3_2 = [0.051879402194875676169 -0.015002784998091808766 -0.077611498518807178759 0.015298101429017295361 0.052321751217844353343 -0.089708192721260238134 0.039702579524195716343 -0.026232086497067597097 -0.68314981800955676405 -0.0044031433210660773578 -0.032178100046676073875 0.0062208547247937333313 -0.02632836539141997223 -0.003787742903805446041 -0.16799550343919006368 0.0075930924870436381294 -0.090125669704293462359 0.0037352132623051743573 0.00010760562752960562815 -0.030998792412949654346];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
