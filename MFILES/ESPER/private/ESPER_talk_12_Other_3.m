function [Y,Xf,Af] = ESPER_talk_12_Other_3(X,~,~)
%ESPER_TALK_12_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_12_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.20473474424329355;10.011752607505613;0.2210212460508155;-4.4869142595812423;-0.43458549713545691;-1.5299331164033567;0.50329016197581289;-0.43931178691817141;0.59411970752172516;-0.078885445245652039;-0.30101202433724805;-0.76362711687957563;0.45690427177022752;0.13735841294477677;-0.63354759116456227;-0.82219474171269957;-1.2531454485491178;-1.0586488169770032;-0.25491914487603706;-0.1878867303584317;0.71120612829295027;0.68035342533755105;-0.30061732273505426;0.8917878500876647;0.44262129959654645];
IW1_1 = [0.018273394377742124 0.15239115782217244 0.12230140365156258 0.098296831893410541 0.22495363166315641 -0.55256272201865353;1.2195548779859346 0.98075366063261415 -0.87376301309580129 -1.4463234618755629 2.2877639713289981 3.0723466259056362;0.12517286776600151 0.17211982704236306 -0.66392237523523523 0.72236810661984641 0.28114033813945771 0.21866072069943515;0.97465540432911568 -0.79816310556014292 0.8549248341851754 -1.6966707268823089 1.0766713085172654 -3.041110068666002;-0.12185595068870148 -0.53529753124048707 0.19382454160022927 0.040548405304537467 -0.48519113744238374 -0.13875198374290471;1.01652588246366 -0.54634380628993906 0.10963647173120514 0.22447301910593837 1.2378334400593627 0.43950195761116789;0.096403321960290708 0.20699659935634782 -0.50330704099252732 0.48300633048153602 0.071670137428345507 0.55113744834040668;-0.28114637725674102 -0.22351763765884869 0.57128648550525363 -0.37451152882022859 0.26240158930748148 -0.38274117527190327;0.013757919672120478 0.039212441731835745 -0.011172263645274513 -0.82525402074329846 -0.95723905893703154 0.82384292687253025;-0.055565639847794807 0.43856166507324035 -0.039601764152937834 -0.18704497936503392 1.9405830776642055 -0.96090286362388189;0.10930221008902502 -0.2025602550917612 0.028233747347393028 -0.080861031806021 0.51328998716541652 -0.29881294358689769;-0.068996957050001001 -0.0042227410708452363 -0.013253463160574845 -0.037268268718088568 0.069013114306633247 -0.21878928296798808;0.50738507470203886 0.0011537864241384095 -0.14295536334825737 -0.63936756285375818 -0.79454316546109816 0.56344386211388564;0.1104810338614596 0.0014597500074368182 -0.10152584504876337 0.44436416781281307 0.52480241301711406 0.16471742732798952;-0.38815492247207967 0.092328461457036951 0.034153344872525755 -0.72926450041795809 -0.55450296255602716 -0.015531287502547064;-0.66349790809111742 -0.14493446091762144 -0.18934041215954814 0.28859925587725321 0.60456428790221262 -0.14795733793593235;-0.34936781670696898 -0.15057656612241818 0.16736929937160658 -0.076672647104822689 -0.43143928479278137 -0.30162748215144425;-0.7486100149409658 0.058122819505663073 0.22389137797930894 -0.18016281271929588 -0.15690550148546104 0.056463789686524671;0.0480318851144894 0.0038345701446195974 0.71790063579337016 -0.20939062541849485 -0.56711913373194089 -0.2563687692358283;0.26921440023437615 -0.013111305378401356 1.1538696182715384 0.046309995687898314 -0.32758510807467489 -0.23771671098041405;-0.20145074488973141 0.03861959412383266 0.040293052725456642 0.11381885237397502 -0.14754906331582446 -0.096585905564618255;-0.18287652656560724 0.040220917337217457 -0.84108568802102046 -0.24920141718188549 -0.0428635901427862 0.16033756878591515;0.083638884483195758 0.41833090150820845 -0.02938104389437475 0.40544825759999387 0.31557587747082405 -0.26465479718897716;0.032350012282307106 0.39383130399539279 0.057715516476293013 -0.055965732493180119 -0.34232770864734746 0.36937271993108367;0.42817510262170816 0.2403745538205577 -0.49132110667482998 0.25232790986465153 -0.44865285423011181 0.52926462284573983];

% Layer 2
b2 = [7.3419519294469522;-10.051764379430161;0.83775167595336941;-5.7441453634665267;31.490617622026111;2.5162342533233977;9.4445266848027902;5.3200567693577723;3.9153739539057102;0.56505383123919695;-3.6832886077304439;4.0157850377262232;4.9724504589653726;17.559726800120274;-0.87597345064715415];
LW2_1 = [10.409233872552155 18.025760799911843 -2.7846995010510409 -6.0300505929303547 8.0337497359460777 -1.525874898676655 -9.6386654561890399 -1.5482120152428502 6.7425150258137094 -4.7536661902094268 -12.802287978154814 -10.132494632961563 -10.027903231586359 6.0926268733000244 9.9258283990520066 3.8699172339693497 -2.8624202077714975 11.28808875487719 -1.5648799662368917 -0.74040366643078359 7.629296021346911 4.8948483606319595 -9.7607316566941122 -3.1639937897356574 -10.813256322860191;2.9191517389531727 22.543598780945008 5.4552208590934859 -8.2833931744095963 -5.6159608191914403 14.55245102464877 -4.8753645569708208 -4.6775679002791808 -3.4359615782043322 -12.134672741565389 9.7823072697241233 -19.598528313615297 -4.6758473333228556 4.227072991546823 2.1248719304973931 -1.7206850422799851 -13.265301245166183 6.8763094351922156 8.0030859295225323 2.2427202509808386 -11.004186263144893 -7.8808565101702461 19.069507728280236 -1.2509885465023176 -4.2147750637640877;-0.559526920699007 4.883561469015711 -1.2737170237207949 -1.5336118808663848 0.55850402668398991 -2.3336834435813243 -2.1571397631281979 -12.46225650393685 -0.75217401343715906 0.28032357182414241 6.2990483059943543 -3.6950279218864477 -1.5454572600108951 -3.1706708837103514 7.4704717264386611 -3.4847257239640563 -2.2145246662966103 5.7973506348310471 5.4148114002813426 7.3730396355008088 4.0527936480572633 7.0222009801192069 -7.5629158093535578 7.5136273802455182 0.78927011037363659;13.107783107016342 21.522828122911438 -3.5475564490646194 -0.25580803493055537 -8.6478830760291672 -2.9276753787005951 -3.5950626222752633 -4.3964047163837439 7.6207291529779342 -6.3459509831977421 -11.823310550572499 -17.568227848040252 3.0545396661958564 -2.6456919362580029 -4.5380338042072026 2.3660127535612983 -10.469545530534836 9.6688467886683309 1.9555778090712657 -13.104838490539697 -1.0550045456139046 -29.520106536881048 0.55183722496189258 -30.536451771653109 1.6183313839878715;7.9346117876399909 -15.136714433975635 -18.760732450491215 0.85351220635468605 -6.0528826720157509 4.670376864006843 -8.1109552123696549 -4.4936765961363667 -4.7794274842101823 1.6170728488016533 1.3649382677161777 -1.4321132873346327 5.8528849342198912 13.563901691801458 -12.145427107123869 7.0657483958007807 3.3603632559120542 0.26753436954286103 3.8602669260945204 -0.26954253407367856 -6.6903398381916581 1.0633091980661009 6.1228009689770033 11.345076829352154 -2.4790589091242685;0.27581327860505211 1.3185473507038212 5.9208762244232309 0.27591517564719265 -5.4737405981436007 -3.7664528148090568 -6.0351530762418868 2.7032788762040938 -0.056558466622171753 -4.0382106551888333 -6.1613579774369782 0.043706939778597617 2.6796814724145182 0.47425547397265144 -4.4927407239645172 -6.9197624342394803 1.955543342234781 7.7346204938194454 2.1173186290386141 -1.6162690139042903 -1.8941085519648502 0.5967076055342323 -0.056441401883878285 -8.4746785119554939 -1.3969939506748286;-13.565799728555492 -4.3138537908396559 -0.35343857296187281 0.13261080844727707 -1.7318885561358897 7.3972276464194886 6.2890998447392938 -10.956563083907989 -7.4204370723677009 2.7848820939675374 7.8135097341824951 -2.2711020002601741 9.551910312879178 -9.0783524710311578 -2.9819635467060372 7.6298978025946464 16.790677551753184 -4.1790771922911158 5.4867726935050083 5.3609801225293152 2.5792670164745668 14.429377891021486 6.379215925797368 8.3283336875817362 -15.56554126292165;3.05015416062413 1.8998244838563683 -1.8954678394225577 -2.0269103370739892 5.2870415938556397 0.58874995499386862 0.34144775368670671 0.1462812572445493 -6.3562816623345331 1.7339597357395349 0.13831465578668131 -5.4229678859624419 4.0198230357914886 0.62534453030752368 1.9144104138077465 2.1874162558561636 -0.47969828842267409 -7.3070577771797689 -0.19901299114005699 2.473383889472013 -3.0593662619986048 -3.2210936823355349 -3.7255779773244524 0.91158332040525736 -4.6975782785812923;1.8480045060337622 9.3873148576793444 -7.7145618612488605 -0.087141398943874807 -2.1898229661734088 1.3568487579986384 14.781653714322427 2.7848306374202396 1.0602005801638004 -1.1568139809136788 -1.7062391125466996 -6.4822157339626507 0.61185989644168814 -14.471390768569529 -8.4284158121387858 0.55747241399825032 0.037940562688527614 5.2126769823915415 1.179674441388056 -4.3923115837027424 0.24426259550567608 -13.467054273835259 5.7021526200665775 -11.998400718259006 -1.0906898967178251;-6.311457154783656 -3.8696619133749328 -5.2570977206104788 0.23875225170543984 -3.2991299542138393 -0.9620790986979405 -3.2169976648293264 -21.167204434678368 0.49904817272570345 0.94520975238415006 10.487622235537488 -4.9074799524753496 -2.3405859437712295 5.8275898544826044 1.165764714078295 -3.0998405375401061 5.6372816702661952 0.19611204089314702 7.0607220692492092 -4.4381331279581397 6.4456771660224508 -4.3095559290095062 0.67669317366694526 1.9755670105162191 -10.001314745995399;0.77991364231198979 1.0707512305217497 6.7358624564684675 11.804602674250463 0.80047556294370614 -0.093788271160862358 1.7120630131642955 18.019951218374612 5.4558650646896263 -7.1454372988524231 7.8833235863077604 -8.7981769760699748 -4.8655376496367868 6.8326013402041461 2.3171788888953282 -1.7845028999569061 -12.706479979110386 0.77257010589783792 -11.892777145910333 -0.29615661151772288 -10.334470128943156 -6.9575487275365759 -4.3983186833672105 16.713813016475935 2.3253498714940894;9.6909637979974317 -2.0573002014734616 -11.893867192019071 1.4941719073380322 0.40798304050730172 -0.22772028009941375 11.655882918232958 -8.9231764252237511 4.7688681078712758 -3.2949004226461889 -10.598083872584256 9.7897229044566352 7.2375985922507216 -22.202660562535264 0.41823337315592513 9.0693159784136022 -11.23628071811255 -6.5489927576734752 8.9312610742726974 -9.00564093223527 14.386674561964758 -15.498333887461611 2.1935075557170371 -4.8172763438651272 -11.210427707071355;-14.004284039980872 3.0313596224705424 8.2406283218356791 -4.1670011705247498 -4.6806340932778134 -1.5994065830255491 -16.375085575258019 -6.1813287208329122 2.8168923217950215 4.2755074089282603 7.779194131362515 7.4778088721973379 -10.103801382800674 11.080003947149764 -3.1592092258889699 9.9777159566421521 4.9985261567619332 -2.2772705265760611 -5.7703498121331505 5.4301262441956188 -6.8845069918795518 1.3663451691088817 -10.461795931936912 14.643513390390449 16.078709071576693;-6.2381355553118105 -7.8645608689026263 3.9168448489816883 3.197961107378831 6.7178193464249416 2.8928758810085573 -8.2107939787971578 0.098878336534324748 6.9553095533633185 5.9646001086158291 -14.860339837647754 1.8777215468581805 -4.0254869299727805 15.043484141683725 9.2728441151641761 3.5166878018740433 -3.8204640881612515 -5.7403366933076194 3.4194764898634196 -0.50467288112568875 -13.788380011122303 -2.8975080780696172 5.2240270807125668 0.85151571760736511 -0.32114249263885597;-2.4033274104967792 11.822289632865463 -1.5959655717634436 0.014385168444642228 1.7565148031143685 -0.29480204346131494 0.033946686944628587 -4.621743854511287 0.52541107505331031 0.45512366972293206 -0.64597343613997749 15.693008129995913 -0.1679454911626464 4.9017799658971288 1.2006505325633727 -0.37261523778897659 -2.7372449087033366 0.86982837270803881 2.4616069391294766 -0.65836899926319881 -6.0109715017245566 -0.30520802529169239 1.0816183080577058 0.64540998336560684 -2.3328771821549168];

% Layer 3
b3 = 0.54213042289939384;
LW3_2 = [0.023950942872978009 -0.0052890042988096063 -0.094408038134950439 0.082333491154153213 0.022234628185623096 -0.091151238033931589 -0.12422388053821368 0.21900004007601762 0.2845515186762651 -0.52734708729223134 0.0056687973810258911 -0.0018789001747846214 0.0078943242147091041 0.19397912349424282 2.1245534682402791];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
