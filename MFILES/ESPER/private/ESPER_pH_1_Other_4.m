function [Y,Xf,Af] = ESPER_pH_1_Other_4(X,~,~)
%ESPER_PH_1_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:20.
% 
% [Y] = ESPER_pH_1_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9920854536621597219;-0.48951526790436555858;0.16211390176623474702;1.2336687819816289924;-1.958761299089287089;1.7631283042731547006;-3.2390306714308909619;-0.58091720214390007992;-1.0850288471054203576;0.26605412946470002877;1.0209537941832445007;-0.12683371009059929424;0.27304963340159460472;-0.017031939038960382943;0.38917966956960009517;-0.67088657192563416753;-0.030697948597175037794;-1.0870637479937985681;1.4103990918315685299;0.12665962373421502107;0.74707687766365837856;-1.3717869765145480621;1.4456968036268211808;1.7639460468565890672;-1.1721617760911913209;-0.17470233823248679239;2.2206982666714232266;-3.1111824256607190087;-2.2871249205835124663;-2.8538389472016003623];
IW1_1 = [-0.47929441543218853639 0.092105124815944836025 -0.52605505317732659254 0.19689226925018868397 -0.69752394746047519103 -1.0171631279458268615 -0.40157075142377407495 0.33286059048827038032 1.4867983903961394798;-0.2105662054498098068 -0.60385038818065983612 -0.97039187120407099929 0.70331056780564960018 -0.20890771760560758463 -0.30737267338846158138 -0.62037811872858406037 0.41152946529403894305 0.64110236234206174899;0.058734222240114236646 -0.17067427074859120584 0.27169122178565169312 0.14557378755450675611 -1.075854193138186421 0.12895573322665462856 -0.0062527296418121323593 -0.21315292643823527396 -0.26244802703490510698;-0.49292875980309763806 -1.6119732686917382924 -0.55121920648824129785 -0.35335029356315739157 0.42694995857257411753 -0.21130445764878622028 0.15494611364841556767 -1.2206889493887047582 0.11980838574987744127;1.8621751676653870433 -0.66008644924959536393 1.4317146442584984811 0.91074132149762121458 0.40636273758257684952 -0.30596322371029388565 -3.0204860210472785909 -0.78214705069293666284 0.64293289804191622316;0.96527697553943725417 -0.55481788036161516775 0.92795845347167882355 -0.10131530643265983238 1.1941216642869185716 2.0520462651527253684 3.2549222966768636134 -1.3762368498632406855 -2.1799458439854526581;-1.502204365058696478 0.88437202036175255326 2.8414205326657628881 -0.13877091042020592293 -0.32437711714556732856 2.1741102843336479467 1.1323231882975386409 -0.12074828467980287805 -1.7486598179415939747;-0.068681541066840379184 0.74434858552989813241 -2.6385367648923438999 -0.26251065178363724995 -0.12657012689774269076 -0.26923413648766753026 0.86495288837713080188 -0.72433030581744206611 -0.1403843782404950169;1.6069081504088895684 0.74616790158950996315 0.53353722644692269661 0.06716873061294079128 0.46228906139718428658 -0.063960346157748190765 0.12768350858528723646 -0.056723023519254775482 0.66019728438085123479;-1.3176088578923177419 0.056554000535384646442 -1.9181405254416126205 -0.53610773270059552953 0.03834207165241756976 -0.66650997394441680033 0.47687428989963004389 -0.33012650515727243183 -0.63379617250755815316;0.2674870274600398834 -0.020019451612158931791 0.35218736793080251957 0.12875098823012437466 0.33270270461265449846 0.85774204646955831688 0.34448685799899131377 0.3767921998527148375 -0.022014456633146741588;0.44434895021769910128 0.01058501837743608745 -1.7932794598933088359 -0.16930119949995409145 -0.87072648466989077676 -0.79462890280755682504 0.24161997750737734814 -0.22698165386642088492 0.63250216305478235146;-1.2984535313354232944 -0.63030601766825267163 1.187613186694204126 -0.037623634093416381818 -0.19997014295157478081 -1.0808887632446981808 -0.070128716261025639267 0.52194692321563262993 -0.0089242349198607184846;-0.61495965195310164919 -0.012682245998156106356 0.11683516164659737968 0.34385020283310874234 0.046333160807186676844 -0.36175386233633965993 -0.013171732287416478002 0.16004027977257470616 -0.47597227243357992377;0.062316619089710471868 -0.37477538307439006715 0.46014664104909547282 -0.60091137841942920961 0.14093518491788148417 0.23534799396368719093 0.3089848516317740823 -1.1415738065283109748 0.21452448582319660897;-1.1051053185213401964 0.85705372426032233601 -0.59599966416600491659 -0.63188382488838357176 0.69937532485261699744 1.1970412576244271463 -0.23435826393066036544 -1.4905935548905648869 1.0204964974289143509;0.5099101785255583108 0.016247221183154875873 0.39405130683647976442 -0.069425010423698807482 -1.0910985665457924032 -0.55858625407129902651 0.32616563439567547444 0.1554501331559414723 -0.80477703420403590151;-1.7410586617342787008 -1.1775540980506100652 -0.17280483708092111983 -0.26659072404012923441 0.18521218967552943724 1.8093714516392622738 0.75090984144479089313 -0.42869679312703456997 -0.5852837429141686254;0.13605669045816176643 0.12292545648449548779 0.80781952665417500192 0.29465049887036676157 -1.4573022758477582883 -0.90100231024767207799 0.62393770655540892189 0.23545949008347830111 -0.38613779049334207016;0.49284126594388250053 -0.22801714892831503878 -0.53652017026457765603 -0.44278343206095677198 0.085674662849031496537 -0.64925418765851772296 -1.2272331526946114177 1.0738649195695881833 0.35797103959214165991;0.76502655810474773368 0.053602109783784553099 -0.51142964386963973844 0.38343978693230912347 -0.0011669994082954640059 -0.9608352816543996866 -1.0543282903724107147 0.88355458385637886121 0.52404693148875802766;-0.77080235939291763536 0.42762590514199400049 1.0596258218423968422 -0.36936865000427510086 0.85071133437920898324 0.88231993548111109504 0.47418011693552403196 0.35929128906386764708 -1.5699735511799797205;-0.15288608791056881864 1.3486297785140441974 -0.55767617356427634512 -0.48922730295382854671 -0.7599528657647689478 2.5016244895957360228 2.1358656437874583567 -1.8933786605551010673 1.702857136253792758;1.8202062073631493089 -1.0571792692383881196 -0.76326922588974166484 -0.14290212269301655335 0.14161553784781785725 0.89483780290994863194 -0.89396642022170269559 0.6474447040305476575 0.17385782710951955266;-0.080910178987458364341 0.067683871419927044144 1.8019032420569045527 -0.059836079361687069533 -0.98449832717518170888 2.3772629644593155085 1.294898448294416804 -1.4791621349223347259 -1.0506515034562409205;0.32942402445891694196 0.49899169307269575224 0.023263149100815710274 0.054792423987120433826 0.91612689452815454505 -0.36465552091397707146 0.73510523990071230394 -0.39062327525616230561 -1.2220263316307575785;0.02064492716424790042 -0.46554748269083517931 -2.234341313698352316 1.0720102360221817062 -0.27072826001183586397 0.8061842635601220719 -1.1331561956704330196 2.6752944102774720569 0.42322316118789404804;-3.1693384625077043459 0.80742239238973068094 -1.3609383510531869454 0.0099623919598590682245 1.6212845145936145563 -0.34720214523499409731 1.9183018461902234808 -1.5306505424970875406 1.5286298439103509494;-1.3332838305299754555 -1.4861305808993998667 -0.86625355183003704962 -0.06703533739862374552 -1.8979152987352427839 -0.03117043388963603584 -0.58889242638689054399 1.1692620199513652501 -0.24600642707978953583;-1.4242484810229827374 -1.2651193100846795936 -0.9662372780089388824 1.0073583696890828776 0.29756585570128407658 0.62110772484707787999 0.40659976916220180732 -1.4115433290904952912 0.15922865226344382061];

% Layer 2
b2 = [0.03460859550970839249;2.3394473338687231667;2.0479610127498459882;-0.009051497550533749159;-1.4504210215503021697;-2.1887784756319224044;0.83140258532310784556;-0.78209986007820231357;2.9758045004603488337;-1.7027465356697575327];
LW2_1 = [2.6120498257211282045 -3.0068394064520354014 1.4915718896622636169 0.8442559955641369962 -0.81411297613169431031 -0.83482491152985494054 -0.10041132924545026484 1.1836846924267281356 0.68884478073609933801 -1.9344264567232147822 -0.79618756011171198939 0.60839810196573773649 0.2822099242155979848 -2.406391572096321152 -2.8173955254155389483 -0.23069448311782600469 -0.91527254035958827139 0.54794578266409887934 -0.26388377455463768451 -0.3280540503151089804 -0.4442603226166230157 0.58908166816258134002 -0.15445676644372258179 -0.91161794208633428749 0.81397176640933344149 0.14259291153088421433 -0.88192954131753997782 -0.34145993796078527582 1.0751328761655574162 0.51288911409121906715;-2.2057190546443536938 1.0231556895206683766 -1.790164878150510841 1.3482821101710162903 -1.5546672892197646032 0.55467017310472432889 -0.31488928540141242207 -1.8115392083904500176 -2.2523543933372804915 -0.25605569483568546563 -1.0089286311945597774 2.5093946179281658715 0.67203794983293674292 -0.1872765569872051894 -0.27792439593729056924 1.3209253946046461969 1.9528570751592602139 1.2448783292934331168 -0.44108922345845191781 0.96792784741814830163 1.507810023308745917 0.46311768463908103977 0.96913248223973047502 0.40794924380193808844 -0.80796379671851870086 1.29431475065077084 0.35453110567232282158 0.032342409450100431667 -0.36468962400703341942 2.8157438749051513227;0.55300968463400912434 0.2610142984509798425 -1.7804251507944459654 0.14347496520452324154 0.25140469286580441333 -0.28948078407916572052 0.11401547743325500528 -0.17834553810209280433 -0.54996977407553815365 -0.12843565229930570259 -0.23223270140332280542 0.45915946086532438697 0.0068294898463703412189 -0.85862991716470415948 0.5113316373610703458 -0.027247170838450105596 0.11701473551312403798 0.13884102923899083182 0.4420264216624875675 -1.760450907410718191 0.97751928209213223564 0.59151365405795153229 -0.27888700499183471937 0.29407933781777872984 0.14190520039140103181 0.07691665840206193816 0.24346552327590958997 0.16719847714624233581 -0.086859421515467785668 1.4991753452645319999;-0.29472403602128272038 -0.24945374776350334733 -1.2830974317465000389 1.2176388545088920878 -0.53475684505648168887 -0.20179516557188667547 -0.1854195217336521706 1.7371415245793722093 -1.2827745724866359556 -0.91036765279755615943 1.2127413743960429038 -1.187538261202912393 -0.64426626249237828326 4.6353106945833459918 -0.77657927056471931504 -0.057713609590978875996 2.1120940788236115537 0.70009165335439438316 -1.1232490967477357646 1.1603356414720196188 1.6179973691671698521 -0.53961233816727438573 0.78192909481841499364 -0.017285336490236585805 0.66439839501278086242 -2.1223974835691508112 -0.52898053315809623331 -0.15101277669553370142 -2.0874653553794551009 1.3978760396912517372;-0.21623372146464789334 -0.95689977057151054396 0.43316497188489289094 -0.73261990881785676866 0.28092249852081357941 -0.085016042523197221659 -0.13334097733323499457 0.13583972541940822487 0.17156879677954947616 0.13053539190040219786 0.87939919309769964961 0.44319719981392341479 0.010766092905681534653 1.1413596164805366318 0.4685317317637593959 0.13637091541372758918 -0.59289300508603104412 0.58345935268992532574 0.5156525586719243881 -0.48404837968508246382 0.26367680395345344246 -0.085805259876015810283 0.10233588482157592037 0.25954831528175570377 -0.097209938778833063222 0.010701356138904098703 -0.26251162085898271936 0.073182544998588089369 -0.33954984627004286546 0.080616568123934334578;1.3495460525189963974 0.24704712649119589529 2.4514522578687261145 0.29807656416246502973 -1.0262447549680424608 0.35888733177469167579 0.20200209875227384537 -0.45069367182230796187 0.14755650812807019623 1.0762656494899363047 2.3659797581350034967 0.71682038593663843784 -0.59553948006230406076 2.7546956818826275892 2.6006832553681733522 -0.90280020745577194141 -1.773521887959469856 -1.9465470816567078671 -1.7123034792455016362 2.9721441012877405363 0.60132331900440239014 0.75345267901135237754 0.59070217772932287481 -1.8885634624705052165 1.1966048835362983471 1.5536530177674072739 1.4847318816794443652 -0.64143547062264127945 2.382406068591186088 1.4255294564652425393;0.40408003025773781003 0.75863993115209538143 -1.1626991456461956975 0.29587154549251587499 0.15340379092731940003 -0.12939158390885879824 0.063138711943422035078 -0.062420966753453696607 -0.13477622334422065253 0.16914048483264107481 -0.52933501124292259288 -0.085993212390284443081 -0.20861957266889100127 -0.021941109479255902631 0.77098600485665813586 -0.059908296726874268878 0.03418186694516180818 -0.15015027718389928335 0.29782398525989584037 -0.41840765266235208086 0.53023104911394514094 0.19947183903409551609 -0.16215584558069465193 0.021868002376801955189 0.14942013688442598585 0.38886672078728046209 0.15116540693704366705 -0.014224754903738886722 -0.21698977924839008002 1.1977755978184894126;-0.12872824100584348561 0.29542215094547108478 -0.8668964526513539548 -0.45827469421760907986 -0.38828859129851078791 0.0070571460272967102834 0.014969765427966871471 -0.017517299746845904629 0.12756944498439404256 0.18817549927485929806 -0.87384670870746605775 0.6326861259546335825 -0.079497190432935863069 0.30818840552677817524 -0.59948601946152735298 0.37796779270169150733 1.839243827262194042 -0.018342593177197576843 -1.8101047801803340498 0.21088663449954653251 -0.68669878416345231376 -0.57534603466621536683 -0.2651318704197353493 0.47654609048766494173 0.65123595622059149424 -0.89799109904384621927 -0.59419403614583543582 0.24188014091289752883 -0.47563470926383111248 -1.0650792183493325016;3.879859047412495876 1.5857935571756318627 -1.9730800648345325765 -1.2535218099876923592 1.0632278621665587348 -1.1784036523047973777 -0.41866955995815929858 -1.9908772203948681412 -1.2207966213115386545 -1.7674458871222431533 1.0598117469958248105 3.1783418719609346503 -0.52445736695880706968 -2.4515920178677519381 3.446589829149511619 -0.86644074575714591369 -0.61096482429914822365 0.2040911245351322012 0.51186302553397211579 -2.3428824194126214309 2.0269169136835936129 4.4311035637124422948 -0.54069796053654106682 0.24216422447922286709 1.1841501366337106038 1.9595961186184069902 1.6029409223555231012 0.77843607663818958908 1.9835682199003321635 -2.546023881118687715;0.40848936664486895642 0.58104904681732794103 -0.3750096979289300192 -0.20711975037132374089 -0.51738245711912678182 -0.15846011427094727764 0.39310464863955835169 0.10229282138396031399 0.21608942750505075181 0.63243317391238629277 -0.038724475894246226937 -0.069246614109887652533 0.078025300636507671781 0.061284472924270479155 -0.69145475026602032376 -0.22424512575940128145 1.8817802826511473846 0.13687606986821213018 -0.06602862065247258605 0.14135556653776060188 0.46269106699635842439 -0.39664735972075615411 -0.076028876368440662104 -0.1789197885214550976 0.35578463066729826281 -0.68138665426738986852 -0.63297798891690570944 0.0093856924657222343816 -0.060991281256514227882 0.10401913027093591391];

% Layer 3
b3 = -0.81813707328336637836;
LW3_2 = [0.41484270312612547826 -0.14661995518741183231 -1.2378587398428504418 -0.2624414158250539808 0.98243824365432896872 0.15810560788919442166 1.3151374413859162615 2.9519910751902074253 4.3928190881295661185 -0.98115347775704697675];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
