function [Y,Xf,Af] = ESPER_oxygen_16_Other_2(X,~,~)
%ESPER_OXYGEN_16_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_16_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.3037046985673508281;-4.3210109078123668525;8.9581089546693970505;6.3959097284390740157;-1.2331468701341734562;-1.2450660308425955947;5.6362354048955269903;-0.54312359611306004759;-0.52121446017844008658;-0.00013441481422663166534;-0.54643164766577789759;-2.8065443334757920191;-0.8335533117298383754;-0.56335616435237056976;0.36128547196089522142;-16.295050040173137518;-13.878888028025398782;2.1094617915056619317;0.038310252277183799718;-3.3671529650382856502];
IW1_1 = [0.21995536588983527482 0.028960127410847472801 -0.74618886190525612889 -1.8726746204368043269 -8.8610416579382338398;0.18571531494521772987 -0.023871735026491733983 -0.58717675427764248752 -5.0944018291010575439 0.084086862993112285181;0.28581004555730726846 0.3044485540224182718 -1.1713443693537053392 8.6864020038938534185 -0.23042488515972056606;0.28060653638712967917 1.1091521077340926738 -0.54035500988380702481 4.226537998328267598 3.7453906506995457981;0.40846751952048038214 -0.14113887847942374609 4.2714608932329811708 -2.25108340805432805 -1.0591635241764545405;-0.04358756639972604513 -0.34720443052801686079 -1.7033039696725311707 0.66938496288048909832 2.9869650570838586212;-0.97955698297736226721 -0.375879262386044799 -0.77964317532014526524 4.3490235428066306156 0.69181905347526684302;-1.9413884525374924817 -0.76431905331308236384 0.20636470403082118885 -0.34842746404874652688 0.28088160467614886606;-2.2357929032505969857 -1.4938774068973801334 0.61519519654380927509 0.63646086276856761454 -6.9416361918693656463;1.4144051804370039171 0.27040728348400916436 -0.46161660197879589296 -0.35799826648650995287 -1.7439955217311953195;-0.46730151403510428176 1.5174173249836351296 2.3583966154785072078 0.56991923633849161934 -2.9657225301707579312;1.051647259092367559 -0.2498451706592716981 4.8088517897796458911 -0.34529476560377558858 -1.4775756160337627509;0.14576624480426980668 0.20391134346193204308 4.8411065884120354497 -4.6122913349219878398 4.3756130285846959183;1.2960930579277607499 -0.054579436234122147287 -0.97848127268582107963 0.1232974718110118606 -3.3067492258735438071;-0.15144346845984027472 1.0185270169385356176e-06 0.27625993362744222237 1.9103690983889587418 0.29964970262965351377;-1.5109085218347106938 0.7632114005455796768 -7.5597663957226899356 -16.482875951025004468 2.046718585079356334;-5.3986156351557621491 -0.76904753153008598154 0.85030378968991882083 -13.096147669448301443 0.51463716768482126174;1.7742777183057538704 0.61162328671579047068 1.7060236524995726626 0.14070391753374342225 2.1335788822744330417;0.2603093770965237419 0.38367323025577698692 0.1898577251962480783 0.17241834562247843055 13.509661236261830908;-1.0868288022823857641 0.77359760655398746021 3.8593760489216673015 -0.90026505419530622465 0.085880593079487574371];

% Layer 2
b2 = [4.074684784599020837;0.95795343502610907915;-0.55656619133803042487;-29.050532635108567092;2.7720553182352984933;21.867784834119149195;-2.9246261100906441044;0.2112412427301932627;9.7497618943453634444;-6.4147325785914883767;-15.834912693899610758;4.4858920343962918054;-0.4719345062046479411;3.2488325748657200798;7.518592431846370161;6.0643801027690082961;-5.1760452373885827981;-1.5390368672446586018;5.667993804447485573;-7.4087005081039336574];
LW2_1 = [-2.3380475143962935469 0.54756240463973004928 -0.8912611874532576639 -2.544953507396312542 0.76337384448205369836 -1.4007973059380647296 -3.7302235372988219453 -0.4214665650849649392 -0.84267221224999722118 -0.047046753686247146098 0.41683033477219594287 -2.545375760657969888 0.60419055229246121375 -0.0188341636562785672 0.36872141384116924323 0.13146457073294101625 -0.084959712477086932192 -0.53881358007400126375 -1.124330734921867414 1.2707102879698559672;-0.12589658238155654324 -5.3742928213395622095 -1.8113356736379797596 -2.6870930796922816164 1.2926426851222654335 1.9408068261457822601 -2.0601786024244406192 0.75986762884684022623 -2.875544369810562273 4.0442886488665656941 0.4857412850476197641 -0.45165595544005482376 0.84927125688806914816 -1.9680150759111618708 1.2279345992040440194 1.1778585634142690886 1.1195590400546735488 2.7023043276758453857 -1.1011262811551469909 -0.92590449104638372635;0.031548617985327764845 -0.075968429777600723907 0.20210379437700029537 -0.44604841648924481445 -0.20669395852269448199 -0.10332338823521770854 -2.7638086772928187607 1.0819217082144052533 -0.12675953673258050225 0.54097699962228174009 0.21969371800437662023 0.14766838889946959368 0.064270001771681115055 -1.0895414488403227793 -0.60869574111865609733 -0.15447689979407963623 -0.04138979007425082346 -0.21513179429809972665 -0.059915130127795458714 -0.42421807298258729091;-3.5013735462443342783 1.9347956191747466281 -6.1064031626259946961 3.2986223981462678978 11.893318575265753978 5.1091125113013706738 32.735276595298600455 -3.172576651884920107 1.9980197253921636591 23.078745153108240373 -6.5446788468402319339 0.92928626953913884279 -3.7807337809067562695 -17.89001605788658722 8.2432874140072591729 10.594752531707110066 -1.2656916229004360197 -7.6169869508560115179 -3.9543423594481281746 14.482110220253742838;1.0809530954160588845 1.3422222064772983963 -0.58414946940316436752 -2.2383479622766788708 -0.27481135499889652873 -0.069977939913541981065 0.66630897418813284094 1.0236095153610160757 -0.93275562083160568072 -0.42281400194557783312 0.64178351080426665476 -0.35269036923201479983 0.16868535235879186795 -0.0040416036124895984849 0.1637267697957066892 -0.18537807904376243928 -0.074128637521694420998 -0.76988660893722560274 0.24176200540659364968 0.053368311454125363924;-0.071610018203091943545 0.6163419511873660106 -0.54060362167496667229 1.5182122575922740726 -0.61213800699447129539 -1.6551018189357582511 4.1512805783515966951 -0.75397751212318453451 0.028912733360566916091 -1.383740934929791111 0.51168908966757842283 1.6949207322215982252 -0.03555466529874497239 2.0412113903383883873 29.02963471898392811 -0.86635185917122314869 0.89497954903569032492 -0.41632820794803138131 0.34247923226266757668 -2.6064040016073670714;-0.25882238983982386316 -0.38697541265063645222 2.3905825486329996821 5.1606819601053635083 2.9833587289656255948 1.5974860344430159564 1.7649766280821861386 -3.222103196371180367 0.22859761606233183762 -4.0615424525504755238 -1.0095128693507584572 3.071440198720035486 -0.11468681358840338014 4.0039071578130469575 0.41212190311204555115 0.47106208166447038899 -0.060491828994545589204 1.8089094146853517131 -0.91833419075342548332 -1.779549741192317569;-0.50103804531337292616 0.52584234716508482244 -1.841954406401781652 1.4064358494622384299 -0.39934664075756048929 2.4826661311884836714 2.5221491829601179191 -1.7210424905026862064 1.199415271214278933 -2.9411905285996393644 -0.34114570252757975277 0.60073195886508401475 -0.51849523999900637428 1.3070647629546519042 -1.5229992015188131838 0.19991382028541249127 0.40814207703135124694 1.3752322944034618413 -0.2776658129877796477 0.089090072988551288757;-1.1317543352763865805 3.3266272198368866952 5.5514043926409408769 -13.435755747250206937 -0.083262765844214631228 -0.89993041925705341555 -1.7573111735199893335 0.3527415065721678511 1.9273326825217622638 -1.137593694321751725 -0.22453750992153054256 0.57053652539691945833 -0.2083074360546840198 -0.72070557982396610264 -1.3106662086712399518 -0.98274296248012615873 -0.80996389233405219343 0.70264544125460437485 0.68917408749869235596 -1.4004671978541538557;-2.5758866307381644845 -0.90749642154276699557 -1.1335784314669286044 7.5907089346400535845 -2.280642692953073869 -8.2710001028018158564 -4.9381736922825085756 0.36063363758756783461 0.88338677008147148406 2.904105753542035373 -0.10503517446737474506 -0.68818176675315090307 -2.5511440047066691328 -0.45915932636060274863 2.0578185203609931087 -0.90620033661355037236 0.10250946906383574808 -0.178014499791028874 1.1656922097710518127 0.00081950218058536399273;-0.28340160644106671128 16.999714615975868526 6.8276265283998682776 -8.2903344171220609837 -4.147922579648214203 3.9360452752796031284 -2.8698816895782672809 -13.753213000261164112 2.9352022035402014488 -15.402035125003802563 4.2910465192654703159 -0.53548144387146168199 3.4698155760977278383 12.031186471932365123 -0.33763036031561438621 -3.7360957585017167126 -1.6640639131543675244 17.599236233193092716 -3.6684184097470535768 16.536855338028754403;-0.16999893298352847237 1.0451977601951989438 2.5055330749077682206 2.6101881576269034824 0.17104969060837413308 -2.3916957902709392592 6.9934769670707064293 -0.031639923724569529728 1.0033891024478647225 -0.5393795713379260226 1.0650967353573157492 6.5139718595812547974 -0.43423502609467340418 1.8163232355398213347 15.371242272946821217 -1.2676782162812056942 0.077299519229352797733 0.65672199810224130001 0.60080682216209158053 -5.6133917401833040017;0.93621962450472584472 -0.84571713769745793243 1.6156917940022568203 2.3358684314799531556 0.13378214589779030552 -0.67868902776482553652 -0.36963840751021398434 1.1483657487212819426 0.40746812476578397888 -0.71321408775277050918 0.66012304549073985704 1.5924680434196201162 0.63647212914095929737 0.87822506109659226325 0.32945568283722398428 0.015914662733982832404 0.53741992299591445637 0.33792846362983264275 0.43472855054026093846 -1.5286242013752218138;2.0592266758134289972 -4.1805834921591653597 -3.8738841479516312738 2.7092007161012054972 -1.033948755948585374 -6.6209817507637893641 -8.3239675648167299471 1.3218744598633518361 -0.49395711426445337855 5.2084105510820490892 -1.4245898391687457085 -1.2441739714749917578 1.9721821851579537377 -6.4029792551292938896 3.3808521717434962817 3.1962237372740545105 0.54569494644237137582 1.3340347848758165039 -0.017485636073006211033 4.4445926775001387554;-0.37469979298224986852 -1.9484491629400442214 -0.39553474041209452094 -2.1208882565240370077 -3.5333713555260333194 1.6272489066710045247 -5.5926387059106330568 1.5575166125935904216 0.59041591259057524255 0.0016684985689744760706 1.1922656554292432318 -1.1022615801415802661 2.8377083313483013605 -0.58345186346708777236 1.1793676930977248229 0.39745986595096050031 0.07801414702207584706 1.99450396553761089 0.83886915126818040189 -2.9427735302401489825;1.4777270880297073141 -2.1863310430544484753 -0.28701193403006075577 -3.037036216192738447 -1.8320178765214927274 -0.48638814670907165594 -4.2423321024243243471 2.1417069045369383495 0.20821471866919119553 0.96578480890758922062 0.44629262345672676693 -1.671571541997967536 2.3596877321464053701 -0.23405084996833314115 1.3593994329092076168 -0.011697959950534330895 0.084186450777337343276 0.59895540342502651132 0.1820381095800787663 -1.1854602067783346353;-6.3473063807603873343 -0.19166281418041347662 1.6846908982653538978 -6.8159988786558480811 1.0828270582487182772 -1.2862870712214071744 2.8038908536360573898 1.0998139957620562956 0.83494069291393291365 5.0073520686161598903 0.41853494329645901662 0.82398532165834204033 0.0046539316185488927013 -1.7065090985029549575 1.0944545485350212211 -0.62185960077497770548 0.22529294841393901483 -0.806213795541431133 -1.4530591153480867384 -1.4276430009574017088;-0.37704348276045102084 -0.64343875538701422734 0.61328887215051386406 0.47248675296160430603 0.86124892270987196685 0.55625724443360113902 2.2458705470378426128 -1.1567932186496718838 0.36008647333528703838 -0.2388751583868904127 -0.37727167718828774623 0.41593478389351690172 0.0067210695588179655141 1.0007612478479408491 0.62339006663827434274 0.24887605862731043693 0.15739560864117901895 0.60608586395899977095 -0.20071923644818212562 -0.54465567376071100103;-2.2111775017649821784 -0.12349888602024866602 3.2137279954293598294 -2.7692588091546439522 -0.69140927139461527684 4.1215474874478159606 -1.736885005309818597 -0.10015626500546889743 2.2162956260395723085 1.404442218315582025 -0.32907095730935986833 0.95979593692185549703 -0.94127123822091152139 1.6615180992495139911 -0.72977133420462259039 -1.0111112499618399863 1.1320919584463251528 0.6259219508439849422 -0.19339834837380659449 0.37963469242121694602;2.1811187350536278551 1.064530766445266341 2.8817258713767448519 -5.7520305249265613057 2.1008144338567280585 2.0472707605268372077 9.43153193800977796 -0.4731634839033364015 -1.2848979777412352643 -3.6687405078130383984 -2.36298707280055309 -2.9710624386837642952 -1.863820965854415368 0.25295396077347431785 -0.30395683409081064585 -0.14183649303166306899 -1.3130902819504417511 1.8386627953897287657 0.79041234717485409078 2.8332283663809563201];

% Layer 3
b3 = 3.2213196113864874803;
LW3_2 = [-0.3260646822481180207 -0.095550253191553982668 3.1587144074127264659 0.38598419700761282813 0.53454659139887272801 0.61136567693817722713 -0.1925602217990284859 -0.32348620786270426697 -0.15076207887243103789 0.15301245445635139331 0.18632919202523887114 -0.38221434760873479464 -0.60984893247035210084 0.089852560590893859604 -0.36333110209406127566 0.39730448507097698707 -0.27282848631191003452 0.95372957264288171775 0.12726914262924909904 -0.35317280532402617332];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
