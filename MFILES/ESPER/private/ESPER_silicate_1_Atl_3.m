function [Y,Xf,Af] = ESPER_silicate_1_Atl_3(X,~,~)
%ESPER_SILICATE_1_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:38.
% 
% [Y] = ESPER_silicate_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.114349259724113958;1.1724338796694655507;3.0870481895526675764;2.7456973263658879247;0.56250030489331648287;2.4062950945126395652;0.34510066713892384449;3.5213824749821127646;2.6681347819566409996;2.1475816467972044244;2.4544477785688427751;-1.4912406896123056033;-2.3530444316287471018;-6.990788143950751099;-1.1798898347978570289;-1.365186441827449304;-0.1294037914310913473;3.1316150738017576316;-0.68002009066037694129;2.7413515102610186425;-2.5154853296412076347;-0.20641617186113719873;-3.3567274749081441598;1.1223195079465473345;3.7947209355953446241];
IW1_1 = [0.72260593412420859316 -0.32256979503013405441 0.52342204784372592385 0.77915277046531195015 -0.68893703874396339248 0.2003020970023891012 -1.3135705337329401932 3.0455454396496230984 -0.046543280564372319086;0.53985097699258066672 1.1349030240741464493 -0.041440427271694092737 3.6677198985884871263 5.439548510700936923 -2.053121244681435531 -1.0340697256666311343 1.7517367248356521259 2.2270315858314524426;0.83258950640671058885 -0.56646649317747954644 1.5004508315514895056 0.59926371863481786573 -0.99422479370523186848 1.7488448743885691705 4.7998407585490792115 -8.2011443426025998349 3.1838443513604688384;0.0019029264007604223402 0.14678342373631436679 -0.087739259307863845527 -0.29459285703661353129 -1.3965046440461374999 0.54832639197868282555 2.0470542672506177873 -0.25343874890821604939 0.30221759675538334422;-0.024418320032819306603 -0.45542960725848413706 0.75667415196373333242 0.35191877736366505847 -0.057960147580993465199 0.6294878806599251142 0.46343511271692505726 -1.7084530127809780531 1.3678164737829265896;-0.18094230988748194466 -0.037532493035687834737 -0.70702570657395136244 1.2242815569370399942 -1.609136585717243495 -0.44600311108649826064 1.032543306269017247 -0.76778653056537926602 -1.148643877825111792;-0.49306743674765413088 -0.19858716835475706541 -1.4464029770617323756 1.7995435808340654038 2.6290912239109696102 -1.2408411512354500239 3.3735452110302350803 -0.9864691793632421879 -2.0031429095349100322;-0.049787711065697140556 0.27507382047198541963 -1.927446251189318227 1.5530134881069386221 -1.0866340546851502857 1.4890373242225927175 1.5193992590792122499 1.4526981680652775175 -0.5679369964582442476;0.071490658875597107302 0.78366629474012505785 -0.25048033176778083941 -2.6526011329600089894 -2.5038377046718918173 5.0057965039633698368 0.87726227792653965754 -0.11949655482519322414 0.40803418789111611797;-0.10394881261259017458 0.020067452766875090719 -0.54943608732202775524 -0.086763899078454484459 -1.8997556886228494921 1.3650771825214544908 0.81344815770477396644 0.16686857529050680427 -0.34403934573290390064;-0.1434709997936959025 0.055287581617145357959 -0.36739354864139484036 -0.30284139601220039228 -1.7402932790999372514 0.32869743677317886377 1.5138777998270933622 -0.46504342595326025878 -0.30254414336527357676;-1.6985310346076811783 0.76436524469347877364 -0.045887804533455610334 0.70437690356802007408 4.5669131710417660841 0.22753247391452102733 -0.68602869907906049995 -0.90783857316022098516 1.6205283825945424603;0.20939836532511674205 0.35747510480481453632 1.701105895154567671 -1.8466121788648404145 4.0135142047261238574 2.5949474792238085286 -2.2914558770842652358 0.44982432525880389207 1.691119963732931053;-0.5847782081825719791 -0.12866692433885060232 4.06821575396641677 -2.1625866723838296224 5.494182262589932364 1.6350077371449420749 -2.4786558687840090087 -1.0460098928158438891 1.2910320713476297616;-0.3559257862413240936 0.5300597875988639629 -0.28442805515077901335 -1.3983949267923045934 1.2375635883954732019 0.35883624087529064628 -0.17505482623259460695 -2.5962413450538144311 1.0048646560117557858;0.066361690749598495342 -0.01480530915210676382 0.31103553219352964021 0.17435453060118030755 1.1078971699008504093 -0.33175726190356485956 -0.74502435583668036312 0.08386018974925028846 0.19100497298371829635;-0.55097572305651421054 -0.46678923106049707847 0.89305090876270432076 -0.76065533088645920223 0.58528497323319317314 0.71884858243727511873 1.7746767524227473611 -2.5379869694524099799 0.45507563025844777194;3.6270216821964744724 1.2050219121906831088 -3.5968610517246033531 0.29320383248112402708 -4.0665874624941427129 -4.3988526087471111481 0.7804853437322138987 4.982614823045931729 -2.2259764606635550344;0.31177808257238737166 0.1604280058267378295 -0.37516103906852504846 0.088797117765800265277 -0.20529707301061028701 0.12967530987051609226 -2.7638083201862548854 0.89814950819622740852 0.82008912328769290045;-0.013467502282097542493 1.0712351763646588143 0.96199341796487503053 -2.7239987377888330577 1.6463324223239208521 6.5334122168388732987 -1.4880610709052641827 -0.85517849037018023317 0.67757206829598470854;0.44358957500943413388 -0.22508266358633971516 0.77643094184630956356 -0.054531329118476537521 4.2881769706377852458 1.6640155520973620717 -1.0908560839490237804 2.7356914399494205448 -0.73247297972680980305;0.45678967158208533261 -0.18174526337707250234 0.22814459549506388436 0.62564479691024599273 -0.01436952078860540688 -0.086511624830815148091 -1.1943580047398325572 2.2815636042453890653 0.022365407215982423261;1.7416843583546322005 -1.2317160818576322612 0.38215594264723046214 -1.2097455064402409253 -0.23654428299387880719 -1.3416928694371437203 -0.9413145245395649896 1.9751293102339895214 -0.96181088858376817541;-0.49226104383729507585 -1.1466873101512933264 -2.0341238164352426487 1.2491657034811169957 3.0081693586452069589 0.0034153444550745204467 3.2014081470618633851 -4.8542697776301331203 1.1562189374117755047;-1.3956666878654897523 0.92713171645109082597 2.2589592806163287797 -0.64550670480820793173 -0.2918954815376650358 6.8191426509973291914 2.8304359442937774283 -3.1752622653644690942 -2.413177550301367269];

% Layer 2
b2 = [-22.996304857962083901;-84.432407056418185221;34.602770863636443721;-19.525244313725963252;-2.7330176971516979556;100.40041154912900367;117.25520241876580485;17.334175159100254859;4.1156905527551712609;2.7094054232220097234;-127.06078450549085801;-21.538120887303673356;-63.312992087144223774;0.19030735080016780714;52.583762746464188353];
LW2_1 = [-42.840205514664205566 -4.1741487920416728841 -19.535350189728116987 -44.990118030339182553 -37.82840190462378871 -70.788978532314516201 -9.2699564278087436264 -1.1035501598200898599 -16.226429309482746532 18.380753116738034691 58.875199587379690058 1.344788282205645169 -3.8487104508870135788 29.425699262944004175 -40.49830618284280348 -15.114598038918749978 -2.6837587468973613802 -5.9681690561756974844 -56.549951676797682865 -43.519282037554745557 54.859440785169148569 -48.943096053946085533 35.844067879470571825 -17.667601224303986385 -9.4806531868896968263;15.927864814431909934 22.964606084634539229 -22.875005559026899249 5.8314356142318697351 -50.874249139453887381 -13.417078957930742789 -6.5136517696743929662 -3.404809095628365867 -34.90943032563443893 -3.3335202213400894067 55.575057664476048558 78.127012756943770455 67.587924341623775604 33.187989484321249734 -2.8130532997659885019 -122.96635931180988166 -118.24667224785096664 44.40821012281191571 -119.97020255878094019 -61.719076842366575875 -53.449327796943116198 -97.65148602061526617 120.1779183991394433 42.504368202005302635 80.528811813564857403;18.14590760501044997 12.470332640466530449 17.36894638028837079 -75.805964001185699885 31.548153525135489872 -8.9982144916274009461 -8.2910771876778479594 -12.122429933170115746 5.8527390474285683197 -14.808960513613641297 -10.965490280410376656 30.471409666410558259 16.688091304825103833 -6.6256894827809338366 -51.789247106796928222 -116.44379283391982938 -14.413064798548441914 -16.229098521343512829 42.644405871657156126 6.5658593419494168941 -32.723049277469904439 -50.813506340647137449 -20.998864733290471207 7.1434600706050481733 -0.58154281183425959867;-34.183926903786165497 2.3319212198498893152 -2.3970185144740554506 68.466042912697361089 34.491121630672552101 30.459072047744296441 9.1516393194675913492 1.9340246108627283661 -3.197581578553084114 6.5701321370388674481 -82.228772359993044461 -4.5569101975130239524 23.739460611616443941 11.357844884237621841 37.376902352225833681 -68.395040079454588522 -14.391595126291997886 4.7147495931894214394 5.0921548448933258157 -8.2881502932192816502 3.8628913703828553494 69.946821298402085176 -8.5408050120919689618 -18.65055745484892924 1.8059548853515217104;47.649911414622245331 24.683768337995072528 -26.145177165009137354 18.111021861497512475 54.515041761646941154 22.504339674541849803 -29.781603545416651002 44.896567281474752065 10.819211339167258856 21.643341046279719109 -19.239788528089093234 -31.129610016173671738 -52.509494930485971054 -2.3247304494173914868 -16.86040486640401781 115.88724948048482588 70.235407064881087535 -29.583332837143064609 3.3533929107838296169 57.350354928030249368 -23.76310255215142675 19.054888919223547106 63.94644086137168415 27.226202903994948912 -17.725953865877041693;-112.26688894337230806 -25.101153794898284133 31.808298549084785378 70.081095373247421776 74.7268709160525475 56.391596471067906293 3.1071244546390079933 1.8155774817745344851 -6.4683967723498172475 46.271349235489751095 -50.273493417249866866 41.522993956525475312 28.271237718661250682 20.377634584710392573 -65.909724061570400977 -140.48534945109389582 -49.690639453376064694 -35.898398063954793713 -43.740608538903842373 -16.911561027326158069 -30.892803179341843389 6.4931577870694772159 56.885997303913590883 -42.221960991839388555 -59.718397386208067701;74.995275217743198937 -32.475861822389916256 80.053557851868959006 60.871021486313139803 59.489731630607899149 98.801100378549918446 -49.932942745753820191 -13.180533506538127497 6.2697780088132342158 -11.540120714673792079 35.397979932049423724 146.5652183987438093 31.941953282374278444 -21.220874914051883309 -2.299789184782300655 -51.353158916544764168 -98.495101828140562361 -28.013398299495214872 49.433854529568911573 72.287896891239896036 -35.920254717059698635 -8.0088236718956142823 -2.4533202068970108023 54.55848938323887154 -7.2714022411063261586;-39.290962251527332683 -9.8178338843295236416 37.143719603465378043 22.88896971952363657 -11.291296699127455483 16.483748426969345502 -5.4737906173585280101 -16.979543848784523163 11.013864429398703138 -25.894313616701307268 -47.475411324510083944 7.8504303623219948705 58.581142970281710802 -9.7793288162756066839 -13.926565971194909466 -101.93069281810677751 -24.786555191524332287 0.62924992330076667812 40.727073635299994692 -41.106914110379555893 24.174451515725561279 30.896432449002531939 -48.780744541589811547 -3.2776827522767222334 -18.535682039858638603;14.805278318112396363 -5.0569535831229091016 -56.378457472529454719 -85.813446157309812179 45.600995943834959689 -56.028651159920954683 61.497446764351444415 9.2947430201314169551 -25.376775634536574699 61.176647547711674235 -34.26126998068804852 -21.257778597116001151 -3.9000158799914341756 -18.193206483842903509 -27.947525460372318662 -119.21821206631997825 71.793153652769504447 0.68062936860147793539 -13.892042285354824216 82.170511573529410043 -45.0478507296967976 -11.330386188698682304 28.757369806795889389 -42.428972155543618783 -20.14615171667604443;1.4266864648199155674 0.18718902529394360057 -0.012231774266548091704 -1.6754501099087517613 0.41141074933661087032 -1.2585270241406198988 0.45232461102771670536 -0.413824191976348843 -0.24772707466469023885 3.48469752126923904 5.7301697669339271002 -0.29250310374962767979 -0.50306212241018677389 -0.11586867570847439457 -0.48579596647827888445 10.002523688095962484 -0.57450600989624600601 0.051749631054056284551 0.55195562517237395372 0.14632394294470837948 0.39564480125869677662 -3.698188480170979453 -0.24598377476053931434 -0.14225942636579194667 -0.082778197285554869223;-349.98650778433557207 8.4274942392210032693 47.739650545722220443 -119.78714918789486887 -101.52442226931081848 -49.338347586600896477 -13.674969140336864726 12.696480710872780406 5.9467046142211454907 -19.311270180538528507 40.74618739173826043 -143.58461371656093775 73.77208347533976962 -73.450642926705285163 -79.015886336440260607 -42.845403788842858717 -92.561031362126442446 10.210481021406788926 -112.15249572350906249 -37.732605597079292181 262.86645527375242182 12.249670181402040114 -139.3779423972285656 -123.29842358421245763 -21.899423804748327171;-45.410466835269218677 44.883093641730162915 -6.8875353117106916656 51.780129399250924394 -11.376114312337476164 49.755822551291558398 4.7731404152605669822 68.579835055072749128 -12.8202785615722199 3.1737222988897353382 -17.760792130839686109 3.5099726578420420431 -5.9001840290243281473 17.562655983350822453 -92.647320735924992618 -22.633636701470926766 -38.600891932926082006 2.0305916746563035247 -6.7067124874737249485 -0.1620781972820933281 30.809865639709606455 -28.929672848806436747 -0.67913578201270941026 38.552726604282717915 6.5493390353311040641;-41.443012752170446333 9.8055172524010618673 -49.250433574091871947 93.107136903933692906 -92.398319004336798344 -43.209034220857908792 29.944563624744571229 14.258281780770154512 -26.189522112528198505 -0.81973329925600335599 36.17183246003805408 -168.15914054070631778 44.995868041380610691 32.623111579168885044 11.693649550410613713 43.971444810371693279 1.2766492359422279002 -3.7198152816187359804 -41.090791064526165144 -71.857733417498096173 -31.716774578972920295 -37.415456232637254175 23.045581052466548755 7.5116908480310442542 -9.3706733879487433825;44.678770877844350196 0.88799109133980613784 -29.168369484421628357 25.356006351402164967 87.208520688114646191 -26.895739818976515778 3.5620744725199462444 -10.896766354992472259 33.263279037755467016 -33.002342829635011867 -24.236052264210549367 12.776048372693484367 14.970096462102791435 -39.66286934961927102 -28.54333889961890236 -33.935908790902509224 10.050804864778546843 -3.4163924684095090534 -27.507720393421870142 16.678930834431447749 7.9240770010636580878 32.163648887887944738 -73.086705607060721945 -26.515695351773480581 10.245900879996089117;47.68489532301857281 -61.057655648885230448 29.154220117854357852 -87.500018022685395636 -95.184546477084793992 15.946005475022403175 -20.392132333953529866 -31.825862378895934057 13.827046098337321567 -32.017097499639767477 87.290964102878817243 69.85416414838782373 -64.192372380490027695 16.578592192845540865 23.034157784436558813 100.697344091129807 9.9840691987101841676 16.570274085405198861 -13.541057023530216341 13.328640549765237822 1.4489324790360111894 -10.761534060998068085 16.637792232431937833 56.313829526602184217 -1.0240609383531174004];

% Layer 3
b3 = 0.5890655985810679951;
LW3_2 = [-0.0036846797419692084614 -0.00082043923961535171301 0.0015142585761133303159 0.0037196244398464651734 0.0015027966323117117071 0.0020450389733764179866 0.00017759921959978523342 -0.0019144815568249247059 -0.00069152581153989086098 -1.5607618785962527053 -0.0012668884328085492849 0.00027094294837499136768 0.0011281297466970436737 0.0025951454682666074379 -0.0017411208817202624213];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
