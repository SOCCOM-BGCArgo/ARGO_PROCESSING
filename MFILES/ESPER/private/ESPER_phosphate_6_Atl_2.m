function [Y,Xf,Af] = ESPER_phosphate_6_Atl_2(X,~,~)
%ESPER_PHOSPHATE_6_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_6_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0847759460828081401;3.5373577871439807474;1.8117958962042768345;-1.8772652728160525992;-0.83626874417945695761;-1.8294005069746344105;-0.93728202229585377836;0.17661132014490557585;-0.81882821315664555684;0.99951027213423837559;0.26960537550989049915;-1.2122622433878029735;-1.8831636186896711926;0.40422003998398503555;2.4923677114434661384;0.10365720810485601344;3.2559222962753735509;2.0942042949245669448;5.3709011717382484363;-3.4302900924882750999];
IW1_1 = [0.58254619702212995236 -0.17201905475216497377 2.6646759391627572455 0.70478028245672474927 1.021064134258287126 -0.91649232777228628599 -0.26223679147491318897;-0.87744873061794614877 -1.285673047377335898 -1.7134300880117394605 0.57187739643656532174 2.5251346557862834885 1.1853420043914908444 -0.81540550695934177483;1.6542397424223176383 -2.5236458144403211001 1.2562608146579774537 1.8630883528448993758 0.70095404671273586761 -0.76974560873881436862 -2.7673550078057629342;2.132217237999053161 -0.2011182939122731772 0.13472806847033039213 0.76234074770919380004 0.58932968373001226592 0.31739718111859177574 0.29445223018666716319;1.6627639543356702578 0.4395761819729210873 0.09879308685025794956 1.0339187123290523029 -0.36657327503367881372 0.18355816659272417013 -0.42716874836862861464;0.080296166316824360565 -0.33108654769050516187 1.424080045275389228 0.27212167689842509111 1.2652826636728893295 -1.0457109873113006326 0.48402868508357416166;0.89481495556171475325 -1.2581506133791822144 0.65609892277536219218 -0.15857634771656387018 2.0599536419076716065 1.382878373200526978 -0.54183326136427634179;-0.045153083513080019551 0.74254534122855364586 -0.23299029558825576358 0.79386193188580433944 4.2722487304396574714 -0.063450194176455559925 2.1182799718179743387;1.2129317937648615988 -0.72546211184224640434 1.333660823867280909 0.074110848376270022086 -0.32165018853261612142 0.058900497572834581428 -1.1459304821521110185;0.044317029288211046145 0.089772966025235073628 1.4178705385776364523 0.017275173749619631564 -1.9290744033885116604 -1.4393591180867053581 -0.60858860193292296792;-0.71377662483077486399 -0.19146327198904511402 -0.40296590515795621679 0.35808451722520739935 -2.3665000482226825618 -1.5286790912016632316 0.51624790067558945506;0.29159651702200545254 -0.2325042685373310547 -1.6972948419235089901 -0.18827590326862644887 1.7829770120105135067 -0.70982207201589120338 -1.9657180712931459077;-0.15444777173239115919 -0.40899779960528565015 -0.90791034941611581388 -0.1966496721799981251 2.2916792853700016508 -0.36452255264234662002 -1.3518409818337455697;0.94428786431027078585 -0.021025755640743295366 1.7868687681159667324 -0.5120840285324613772 -1.7465513847544236192 0.61475318255120137145 -0.99267258921162626617;-0.36093689002435724866 -0.5612888476936785942 -1.4596241502068998397 -0.71698632764308045662 -4.0271668907450610675 -0.71882222584227828399 0.73353587786769347545;0.69678083071062602016 2.026436045014667453 -1.4790286907574738962 1.158369729634789902 1.206437294105905611 0.89119684382071995277 -0.48721201129988961354;0.46959686442827830444 0.46030444888754190602 1.4223669640087395205 3.0112085759511706406 3.4403279261980195258 1.4222102377110386051 1.531026029059074034;0.8952306826812326257 -0.42154462369509249076 1.594899629311933964 1.5154889610309061343 -1.2113070876822287225 -0.64546427232298053678 -0.63188071061732997702;2.8905998047883723068 -2.4862640966496991624 1.8586374655214210616 4.9276337353590600188 0.042891608949856989408 -1.2809868490180806866 -0.96571622646199972717;-1.9532778084945601194 -1.4438960996476846166 1.4799538252328356958 -0.35117290290296665489 -2.7771565610851616235 -1.7338311988849579581 -0.31783713151848408396];

% Layer 2
b2 = [0.50125174124341242976;-1.7578707466957246286;-1.8936365443873766079;-1.4056770925357966462;1.8805046271729550789;1.720697524089902064;-1.2670914608983823157;-0.23217815366659833032;-1.4329633883894177249;-0.42082730115902838852;-0.9404019873007433139;0.712284789018900244;0.93270212231127591629;-0.7573835906638971549;-0.89118552369262915569;-0.68062778304257176565;-0.21889123830119458503;1.2701833135389251073;2.5215397082917649918;2.687696757701011574];
LW2_1 = [-0.64325180434529283247 0.43983451072789181424 -0.10766394743281328117 0.20906537030825689261 -0.40758606874447600443 1.3657866424072140354 -0.13281734129002623068 -0.093659175741445263585 -1.1552185758413531236 0.010191626896805638935 -0.16682481131205995073 -0.42540404280820148797 1.0064935270813351043 -0.16385204719641960347 -0.94517284438801640878 -0.21990279749937186038 -0.3046203122843027522 0.42774481292180605019 -0.097404259064888643049 -0.47125671781634714819;-0.69049409474144229915 0.20416521935686907097 -0.4847447658690618999 0.030215653173153934202 -1.4860426573184442045 1.8352394371456701716 -0.92277186858604620667 -0.82142339755337778762 0.31952597374128277607 -0.5109652695632250774 -1.5825224009943770209 -0.55936370118647504857 0.050821807118071250786 -1.5153070987576555684 -0.31280207720301989038 -0.496471575719069802 -0.048025687886589250863 -0.16456158302952161865 -0.63101863174082228891 1.4746831616174962409;-0.50378149223034363047 0.19837121434040952406 0.089792411737875540978 0.10774094505719744586 -0.52727183528036181137 1.310359497253738903 0.60545323761395364315 -0.063133168269609171719 -0.36555746059257815395 0.40850560305435595909 -0.043377389002197189183 -0.74423036897558647595 1.5909167363610898782 0.65043302863815921633 -0.24906696663852329054 0.11028648609250425727 0.54756296359241041216 -0.25760313040754756475 -0.50497083621741578607 0.10306841199311003732;4.0842530400659660117 -0.0085612310330450240581 1.0398005462169159774 1.2107424001712627781 -2.4317587384718430954 0.37130285632907539251 1.3385522944450283234 -0.16736479391298958452 -1.1610844741811470193 0.44638862396712009062 0.90821876401015078084 -0.66725049717787188186 0.3304704283362193129 -0.8669005027900852367 -2.6619213909613681501 -0.28618436604811198221 0.31639172214593974664 1.2817110045697435172 2.4582713156604882876 -2.2605835485166174692;0.45292116432477769195 0.071994750839318860658 0.012142057691339417508 0.52479020276619281482 -0.34475663948903401135 -0.36944612897488121606 0.26016256534180537408 0.16280419038119867126 -0.40994161491548952725 -0.38861648542536852968 0.24777678083658699615 -0.82812895860019852812 -0.055356509132525419381 0.45730268146168262522 0.29275385677496523762 0.099462113149657263578 0.11972833167540951338 0.40943209191602236707 -0.1194024909189693312 0.70971612777237180758;-1.4826227211281717278 2.0752629344630015851 0.54045413960399291131 -0.5252196588270877653 0.67949691514478205434 1.2375669905370516588 0.6715490313678446066 0.012479885245033510432 -2.6152543209001120061 -1.356400309457208575 1.4447842360029545805 -1.0131073930822136475 2.3036093032540669867 1.0681435491692345963 -2.0895635152254277145 1.1365965537430633425 -0.61611861767215192476 -0.12608190099477986634 0.36037936731047109928 -1.3429690681288370957;1.2929677990819072875 -0.95277458636598899577 0.17058759528871381139 -0.89087023984098445695 0.27862766039552877562 -1.3856812756268594988 -0.21135393508644734206 -0.21976985679977395494 -0.32096160033359377728 2.8514202298869997243 0.96797815502443684821 -0.12249082187752428907 -1.4273441872569787581 -0.62636172539621159938 1.9656252364370010444 0.54718707979177760858 -0.85681005941840338025 -0.66492128035448261336 0.9507016790979218035 -1.1064251605775989873;-0.99194591613086768866 2.1723237863410993498 0.039026064315212154188 -0.64396214041009403051 0.79111622314040208614 -0.36283333392536104567 -1.6896486384499092015 0.4960554682166970486 1.4962727809204052765 0.82976819481126218303 -0.18505477926300542557 -1.824140328900863528 1.591876868340955431 -0.91493447326979415735 0.15759325919162536778 0.079429739343181884892 -0.94935340198167694759 -0.50801117116388128103 -0.22999047932737443078 0.35379149721702979337;0.89203558645287772677 -0.87839648046018414806 -0.42951732940135023409 0.60641927787435723207 -0.099824835486342966551 -0.89504751118912395658 0.72291996009447123672 -0.52835463125092108072 -1.2715345896908720746 -0.42691476126435823346 -0.14294793845812578392 1.076093544933236279 -0.3415574280986443112 1.1735248581173187699 0.31597948072825637889 -0.29773601290846329892 -0.16036206871095085025 0.37417449283834514073 0.22668296935719886576 -0.92396685809969059111;-0.77552573086604392749 0.055321784208453371467 -0.30056138657786996005 1.0136471411400174159 -1.3586665276322205109 1.9833423556040155056 -0.37763651361134947804 -0.31502748161224869428 -0.31573077817984923632 -0.038886198823157948345 -0.35819664945663104438 0.1678637832448418854 0.9186812120931046044 -0.040363919255625824167 -0.75030440363295314299 0.28341289073665837384 -0.32573849263382698149 -0.34296161654174295297 -0.20778457730550645155 0.041561031727564035076;0.54237410739801994453 -0.1098319651900116628 0.30326437342892820226 0.40692782799726046061 -0.32181609243993847258 -0.067770292579745705641 0.19953726097827562125 -0.41607534517582445144 -0.7065012846452228823 -0.5387411858387027852 -0.19022432831173377576 -0.38832293112796573142 0.67908054442759124836 0.67313824650611131517 -0.25721370439042506861 -0.33203978319223448334 -0.28811813922674162081 0.59362193059223156144 -0.17266010456228275682 -0.3965204608071246084;-0.26229631541115006055 0.94389299599594134182 -0.82101061737764102766 0.080992103546244476053 1.0134240810747987549 0.89431885184657700094 -0.68276549988415313752 -1.3732988507990404603 -0.069870992746465326872 -0.35062225399300384066 -0.83280069263223632792 -1.9945533109600450672 2.3463109954022578485 -1.1033859171991833303 -0.28059936431410203994 -0.28631936542500324716 0.29937554678811623132 -0.067027557644472698928 -0.55357530480626926384 0.92682065816626002519;1.1496122613479380359 1.1574051814899066759 -1.4133168083711420415 0.11272499845418658404 -0.85259032987377481039 -1.3502823518963926741 -0.56553375247677029058 0.73914894835000077844 0.45455755243486434258 0.78204895384761108357 0.045365219206077590786 -1.0054941828307855101 -0.38095907981331889047 0.33148502524957873527 0.26890487130490736689 0.17905489199741764228 -1.1191316751317421652 -0.36430368669673590665 1.1845648324271684793 -0.66908936419294851028;-1.2498155671362376484 -0.27643511916689639252 -0.2501548344921742939 0.92771529734321123151 -0.92412829198719959045 -0.94493453083056699882 0.3432276276709770868 0.69541841031084117297 0.90952032945394378771 1.2677773793461402096 0.52233353393614645466 -0.19289300205074005889 -1.7806724897999306467 0.70001677821035657168 0.1781431248493254571 -2.6952689561658362827 -2.240872003440066873 -0.3642995547509789156 -1.0096197153092327792 1.6499868840196516562;-0.58987054215179679506 0.23069677092637072557 0.36590211445266651591 1.0263726467396976361 -1.1238957257594668349 1.529306450291220143 -1.0171151107861196028 0.20648832198728278575 -0.13152474813670364528 0.091366601772689431948 -0.78377277793265387462 0.16546403648813523546 0.4121874631353636409 -0.43438613999022990253 -0.25687509215987336386 0.21531435699856982247 -0.75519241477304410726 -0.20261974362392332072 -0.49561411571553393163 0.46324267531602886239;-0.8242125121763862472 -0.26530343285592289382 1.2656359815289368598 0.81474907748334168822 1.5499450402100751756 -0.83656562483967344956 0.615127063617111558 0.0087692775296288587999 -0.021029109425888280194 0.85649916474726495164 1.2677908440280432067 -0.87735194411531070013 1.8897502197022264525 -0.35365826172339664968 1.0379867999802454559 -1.206057350144960516 -0.17620204918558377005 -0.10385322894469842248 -0.54179152792647067294 0.72460693440029100287;-0.69390849344297289569 -0.55498824072319563605 -0.51689968686356024818 0.50124646793222449315 -1.0118061563064533193 1.5438402181005606018 0.52482932671999260599 -0.076390118517333141512 -0.21573334971220456402 0.17788320686967615258 0.20210508037350310984 -0.23218337540409000885 0.96011244641772419683 0.44373841037557570921 -0.41193782438802495349 0.38644393175986008204 0.14780313809328332608 -0.34919975618473902967 -0.1029205487495151311 0.12990732573786631376;0.99322931507851996979 0.30612825184340319851 -0.13915199725225010918 0.29603193392434734577 -0.51645696831999876597 -0.65415415985004876642 0.74004448452015625382 0.31784521476078647639 -1.274328677904033702 0.10703163977733706758 0.21833601622596249259 -0.42974669210330063152 -0.37235525002540570405 0.60085493761907093901 -0.11480856297914250608 -0.11679868534047850581 -0.44196081419850991034 0.46014516033722074884 0.13888539190984697247 0.53425439158696796937;-1.2892710709840276007 0.80138669709770149474 -0.20206430079444398507 1.4409031878009159744 -0.59261636822221175347 1.6470536110980087408 0.23919549864107850223 0.17972012394397882118 0.38009737960902545417 -3.2003003799266536156 -0.90664466542933419557 -0.12214341193543230835 1.9172901519518352753 0.73164220524562062486 -2.0521609980372801374 -0.41216977399471166343 1.0073695740122250442 0.60670706290775422431 -1.3929137160702034226 1.1490482289921004622;1.0191909134866043996 -0.39320303314851562382 0.023382036904352546114 1.619426882102888543 -0.97765697536051288097 -0.8578865669964761409 -0.22371371528030653542 0.18734084527163255562 0.22882153881668459983 -0.12323412857590489156 0.36770675211716868924 -2.0447982126321782026 1.1705628468153264077 0.76076505551679218797 1.096535528079785049 0.28158086258922399026 0.50304419174534820147 -0.16377237386225379501 0.044997853502348431065 -0.24253581575701346762];

% Layer 3
b3 = -1.2395740753531725442;
LW3_2 = [1.6454118799097230408 2.1168530790499833216 1.6996436482712378169 -0.11631884823205371204 2.6404666114421364576 -0.47642183628209971991 1.3280925742942717438 -0.45313049590427395552 1.1267380331561107631 2.1537459526986624248 -1.245666485035383575 -1.7620463493142586309 1.1157408632968894846 0.21244663543323008548 -1.8865581212157112034 0.32214948555888117676 -2.8138303646751445797 -1.7724566732130899727 1.1832055100744227616 -1.1987095338552975488];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
