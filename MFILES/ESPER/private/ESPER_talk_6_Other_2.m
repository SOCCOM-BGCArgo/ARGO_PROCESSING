function [Y,Xf,Af] = ESPER_talk_6_Other_2(X,~,~)
%ESPER_TALK_6_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_6_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2120298226866479;-0.53936996031327211;2.0487835064723874;0.12783207355305873;-2.4199370204818136;-1.3484013696626331;6.494563936561021;-1.2370983472317025;1.1591314192971198;-2.1803017680756929;-1.7107754543830489;0.99313867699029779;-1.6765961979711468;0.79278295988813896;-0.56697508205696301;0.54757623389411048;-0.54262506072075678;-2.0419797324623334;1.3124421593830169;3.7236932704937487];
IW1_1 = [-0.35878528539781213 -0.92777323983069171 2.4508758333029945 -0.51623024269862572 3.8739859814045348 0.064412646706771048 -1.3439235610652271;-0.22804750532566015 -0.14950808774328478 -0.56821639348104147 0.067340328936458652 -0.83018893962807638 -0.4512615587707916 -0.74660123338433904;-0.32113575971814923 -0.055789068381976288 0.53047360429779655 0.47438358968366667 -0.3483927782501271 2.4134617141831982 0.10311269460067216;0.22521552845425152 0.027653542186639481 0.62694895921085947 -0.29418945122809326 0.2588430980534584 0.94583121540730319 1.2914527517786007;0.45098499592364638 0.063005418510808958 -0.55222433881115696 -0.53461832609306847 0.62828210992550881 -3.1931634888528384 -0.2934302640984659;0.22189324462242344 0.060359459031969091 -0.76418740856791878 -0.041452120952442134 -2.2736414723944907 -0.67644210934781102 0.60316094810436827;-0.2018164717828167 0.19935909822648099 1.1458379473866398 -0.61730938449345896 -7.0561877644784081 5.0310019627489693 -0.64570649533789359;0.33523122053155996 0.34852284435141612 -0.24610044370561582 -0.074619468499801 0.42562715974294668 -1.4115997183055085 -0.65125814388576064;-0.4070211512562083 -0.38031954252373373 0.51307326117166874 0.057987337852181645 -0.14163655940517744 1.4890911967803035 0.70608336837268493;0.21107465095951411 0.33142279300110511 -0.12800373107029023 0.21124947756395948 -0.047134944532090502 -1.5696847385687076 0.23897088367605887;0.43258057634345304 0.20545223102287496 0.25991598534526344 0.060170999374464046 0.20922216014096959 -0.53066316130915503 -0.13739392774579265;-0.36744007284352093 -0.3887037826337586 0.5821086738112643 0.026331686485222851 -0.086003364102732321 1.4754130614396348 0.5681369404001837;-0.082989406593661941 0.01248971637164705 0.80299264365355372 0.031628249160819723 0.43409779081303673 -0.081718343026319848 -0.19362427760666948;0.20842725159534856 0.0012628861594081448 0.27157636844684913 -0.25899788446450522 0.509731524625193 0.92010469081823465 0.83616944451837483;-0.019769234406902102 0.032500414812124005 0.031433421392463162 0.21223151671757282 0.77129282688438616 0.1097832365603431 -0.041987852230455612;0.41259120827228113 0.30480915412544934 1.1469781003772397 0.07475424784630233 1.3874377306865586 0.33550441288682192 0.74666607678545338;-0.19760074496452928 -0.061826624147545396 -0.32045440553110743 0.33898731861402115 -0.46167803797902601 0.5979512926917292 -0.30638531639066646;-0.13461688590293053 -0.033808336154894779 0.17090726053745753 0.36087388635997253 0.23544893429683994 -1.0803063561665156 0.19986066837593092;0.25204674137226352 0.28808781737301142 -0.03224064240425685 -0.14397979192149729 0.21849667757009306 0.58969799813440249 -0.0066654033892582197;-0.66978940223159755 -1.1388884912799311 -1.6749840474837479 -0.49873182101213442 4.3868696893313617 1.9786776935016637 -1.2781591287338645];

% Layer 2
b2 = [-13.046699796562331;-16.223902925708654;-13.805226703890575;-1.9679725353813153;-2.6588865710656941;23.988013523304076;-6.5742153206847576;0.25524715367753259;1.8475040295470293;6.7405259811741773;-8.8661760811356594;48.84618042280394;25.217006961895795;3.2230433894169357;-2.0892232402089532;-3.8964476830108143;-6.363693677802857;-5.8419514345553445;-4.1718072067446741;-16.269965512236858];
LW2_1 = [0.51434227221420636 -4.8893157269343241 -2.2340336300347228 -0.86496368171889415 -2.7137281812494289 0.62406569809637402 0.4226433238251453 -5.7643249010563444 -1.2376025819662673 -0.27953012526767618 -3.189121910990083 -3.7951138965322064 -10.128813622258415 -0.62741683157723782 3.2522025917876642 -2.3049613358505532 0.69944154250493262 -1.8139758775797195 -1.6532024206343825 -0.79408428081803661;-9.0165429813763165 26.565257152837308 54.351504290850144 4.5284101460799526 49.437148188662441 -9.8581360660498092 -2.5870269728877462 35.296018800528721 31.644765958732119 8.0696980953520221 25.329177554282154 4.3292375318440763 -37.845608293934418 21.468693262845143 -3.3937248257071877 21.381009709442601 -9.0773107630112158 4.8678703718426455 15.885647822944509 -15.948822136231342;8.177044250287544 -5.7450351887589006 -13.969105385345662 2.4337617990745364 -5.8758875579906951 12.744581673126049 1.7233055065747647 2.2708310738066912 6.0363918404913042 -6.1675044427066865 -7.1775851332805338 3.9463526621709839 -14.38748570539617 -8.2083483578912695 2.3984680792149078 -0.069098453390428805 5.0077783005567547 4.1958916792477794 15.49386417333673 -10.526613390146071;1.7640090994555249 -2.7183884040233472 7.3996725957258205 3.6923075774025942 4.0221966233067699 6.4857709414074405 -1.348529034504564 0.12504149143398949 -14.075755098489354 -2.0975454534609925 -13.579070364846896 8.0385514892498033 3.5597535832558651 -5.176505551516577 0.24141471980360618 -2.7304121738893095 1.090222671216557 -2.8250116444513234 1.720867795190455 -1.0144611105226231;-0.13814348550771197 -4.7975661442461597 8.8678617224677794 -2.2044755851532876 8.223690697385317 -1.0966347049815708 0.38760611704267373 -7.43378058492977 -12.929758599585998 1.114337728267079 9.1575835173014628 8.2710867664795327 7.7167243793545133 -0.079835218023501089 -6.4432310225815845 -2.4242105226715269 -2.0923683782418472 0.84357321650168082 5.134697438945933 6.9547747722652824;-3.6102856867145432 -2.1553327754998133 -6.1827874877395272 1.6623749481272427 -6.0286617937854823 -0.58522181767546 -18.607976678786493 27.885730870051596 22.502380616980648 14.379005552519235 -0.083815137845899612 -2.2578009635608511 1.7705973807726274 3.6443836758288035 -2.6787347614621693 -4.7434017621391167 2.4011508443717258 -15.87616459367033 -3.4765160315767436 5.6734911962695342;-21.571179445006774 23.871169230888036 -24.511948060197867 6.8859912587589607 -6.0263688593764924 -43.831808832271278 5.1562727695790551 -7.9425877263001423 14.182417028833099 -9.2837058484328683 82.446770871800979 9.9472951724996239 -46.43949289941748 -17.852816490724056 20.947599261084118 2.9900717844791149 -54.467157666410309 2.7143713139731434 -0.84187443170399689 -7.3030078429529937;-2.9147539492838566 -38.975025266809233 30.142178506981171 18.20472752434409 6.3064001120751092 23.85526649468277 15.14895008118423 29.740678777258044 22.316208599181746 -4.7362803126675663 14.104471107282725 6.0906089081436408 -12.4692825676048 6.701840168596104 -3.9599376252559026 25.5713274862246 16.050327891548939 7.9573913510023475 6.2072588622198452 4.5353035204922829;-0.79431041947734371 8.8232590428489779 8.4639178364137955 -1.842470530739942 6.0874219320905283 4.9319601559031145 -2.8576379100913836 -2.6485733817289758 0.091496664435718036 11.597534771105865 4.4198740848303757 2.8908000201957966 6.9057253202181688 -3.1697780224387855 3.1229408456492926 5.6940443184035123 -8.451677841147081 11.494480245397769 19.612590188425688 16.7270944417848;0.59825103905132371 3.4743260431674732 -8.3300153679610549 2.9031668772303232 -5.6983924465178086 -1.8938034906025598 -5.1986212848937692 -1.5500293324528764 -2.0021760378039821 0.90506462849358893 -9.5519203163176076 -0.5452500877341977 -2.1598503826194126 1.0322445993172027 13.962130186606487 -1.6054800191962482 -1.4954876706004503 4.6673833435274128 2.944074641839054 -0.76990808174478009;-0.60683519674050834 -12.185235696173276 3.9566770503813014 -3.2769270805107138 4.0864261433289499 -0.05070659358171483 -1.4368203135026543 1.2654199730522193 13.285314519264784 5.2361807760762398 -2.6029749527924513 -5.7262769871648516 4.3497455644629044 2.7017979643329531 -1.0370845761666965 -4.2867710746086134 0.52566721220729917 -4.2659535150405725 -2.8311109647724706 2.9219036544879446;0.98796958910092125 1.8267081585849152 -0.10944293967714853 -8.6953026312196275 1.6153238399798819 9.7610770631210642 3.7613169799476411 -8.1859396719965165 -2.538104435587242 -0.54247671126579622 0.45758916294476498 -5.1110718754949369 23.297773102324289 20.902787666623869 4.3947215832890842 -0.9312043465980947 39.349604301659483 -7.4874926178957786 0.25939932262297211 -0.66171645020610226;1.5069813328005426 -8.1235578269436566 -6.2453604704722476 0.13197222106553766 -6.8978020615480249 5.1756361802009172 -0.28146096371128454 -17.398781920506728 -18.785208788749131 8.9525445896939324 9.6733378671413632 3.4005238088532916 21.00086363932558 -7.0691722216835293 -10.211306797244731 -1.9563383961594913 0.67454556115989617 -18.667778378276473 -8.2346251956415983 -2.3525616758269492;-0.14079696848147513 2.0082902841721069 1.1631339959636395 -0.24515336213083336 1.6897058412441406 -0.69392357887246603 -0.015654816519332766 -1.8349468277473027 -5.513363402419273 -0.13002992769423605 -0.057436321628295622 3.6912274645613721 4.149049970709803 1.7695502472719093 -0.4014767800942971 0.95845445693512177 -1.0688218832693193 3.775518261942461 2.3622609478197649 0.47780156950278113;0.30830953948275813 -4.5947181625802278 2.5013986499716045 -1.2363175911724869 4.5399002296642905 -0.63304480633082771 -0.85320467212174034 -6.4125264405578903 -15.511386569074094 -0.84175421392655736 -3.6792751870305715 12.144703975760306 7.1879993154278976 -3.804360282633342 -3.2562202965055693 -0.24676026935773648 -1.8453805490829158 6.2829255588669595 7.3953735365968081 0.44553829267681294;0.26719349116190255 -3.2309257997446466 1.1606096127294625 -2.2838889037440673 0.4413302659527904 2.7062345067097509 1.7720630739083612 -11.840444990779911 -15.198843118277731 6.5555375816695962 -6.4173012002713516 3.4798459539997948 2.0943492319897024 1.8173235693268284 -0.24684347119707614 -0.058025891445580076 2.5632349649755177 -13.225894864588152 -10.627780932702585 0.97458800038272908;-0.66718801770802327 -6.9407748316463964 -2.1112854267186623 -6.1011083889957236 -0.18951802629908385 -5.1226671469173217 0.82855440772634037 -20.237273324761958 -14.960676911748164 9.5522957868767904 13.051527221437196 0.29748864731018221 2.8123494483879643 2.2916007573270596 -12.129342164892609 -0.0629749716631232 4.3036603184046429 -21.898114385719065 -11.99137238242159 -1.2123744932924745;0.75230514996551645 3.9562810543088145 12.665890971781044 3.4082744731352199 11.474663396367287 -1.4648672471049495 -2.1511467239667321 4.1958037141596902 18.598190817338473 9.6487700733760136 -4.0691163146147291 -12.346645687562775 16.997302130094965 -0.99439326576241294 2.7989149165072456 -4.1229505790205145 -5.0586423772978151 -13.327800889412549 8.5492523559245761 5.3048595031603796;0.21266273734184199 -7.7710930419966955 1.6382162250945307 0.7009997370318336 -1.2387862908088663 2.0561044596411562 0.52342790584306265 6.1102984593353922 10.510290149932366 0.041879582997806343 1.6451841574676864 -7.7096444490225746 2.3979496867154633 -2.5590893146494311 -5.2443745885273341 -4.1306884874902536 2.8292626293206231 -5.0128245868057775 1.3732455497993246 2.2790467542032924;4.4578500121972668 -3.2670664242731844 -2.2582568377760448 -0.4161659193262745 -5.4141502277099756 -6.9299798102952135 -3.7033326523849595 -3.5087058345482087 -17.713124648100873 19.096361357816182 -25.258867095516386 11.982784593525087 6.1919506374155064 -3.0364108933875511 -8.5077525643423169 0.76570383240929984 5.0895122959865233 -19.508667321437581 -10.345918398677943 -2.2450953630501549];

% Layer 3
b3 = -6.2475127117125604;
LW3_2 = [0.22972806876490059 -0.0055339160169085222 -0.01866120829033523 -0.22073527469746829 -0.12026833798127824 0.085896574438906928 0.010363465510523379 -0.0037969036504495136 0.020291776036246871 0.1079041258371696 0.1631541257616769 0.12768142719491526 0.04255254561687305 0.55680830237022072 -0.23221968697342338 -0.13539907873509771 -6.460427115195901 0.046875464778379304 -0.12425127488779852 0.055540758462589726];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
