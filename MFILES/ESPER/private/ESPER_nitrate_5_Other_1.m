function [Y,Xf,Af] = ESPER_nitrate_5_Other_1(X,~,~)
%ESPER_NITRATE_5_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:33.
% 
% [Y] = ESPER_nitrate_5_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.4038035202939331825;2.7158779326158883904;9.1624732766356782321;-2.1418652006119538456;1.8757540496279931919;2.174298661736925542;-1.2179893394918031024;-2.2581297633032941796;1.6213615003273345039;-1.3445911233939420448;2.3576160576212275011;-4.2338103155350985674;-0.18675191294184198543;-0.26419513409839973095;0.28581639868341002231;-0.35201230142196338058;-0.17284885342346165138;-0.16933172813806393608;0.98842174835941365441;-1.7370377028994503643;-0.17158237109454760327;0.24076400873857090046;-1.1482505386050152474;0.060115304200117486433;-0.27626300962222838375;0.755538458756688458;-4.2787528747299363729;0.18989355406690025529;-0.26547901989561561997;0.9233862727904634804;-0.45252557719628827559;-1.7665996870854094869;3.3220814394974915729;-1.5961850689124481573;2.8751604297193749105;1.7679870443784198031;3.1384215306816649615;4.1165928030843188523;3.1424911286255419185;-1.7718082802671744069];
IW1_1 = [-0.97117150549098940626 -0.87028158421561641056 -6.817744513210258539 0.015241198878777877795 -2.7195723739249131334 6.1065062513934913468 3.6225744495966405445 1.0368125820893681066;-0.35038719792883937787 -0.20243331983114185024 -1.8122677758352589983 0.66367424026160570794 1.2426646668922465278 0.51683841480987446904 0.10895767760365901444 -2.5758890119779009886;-0.058359277280075852468 0.37960609711549819778 0.58753043053602793666 -0.84430372934822162101 0.77483135919880963272 -1.1431318184189791509 9.2236779809306561617 1.8470546244470535946;1.6437741548782898171 1.6776903615421630001 0.11459311075607228614 -1.1510643912350293494 3.7930539123900617327 -2.8819683548918249016 0.1486094899036482786 -1.6823791255675915046;-0.12674100279419889259 -0.4497656013269114017 -1.0243289465611815636 -1.0055574048636855 -1.6088425861584469967 -4.6387268318657266519 -2.7878699595888751794 -2.003254698419765667;-0.045384320450294127203 -0.53035602179519547583 -0.77048767171377363638 0.31687929187475138981 -2.1589751862907453628 0.033542485154400586422 -0.14303101421861311171 -0.028958849242114524658;2.0451854585113835583 1.8108848847112333225 -0.45697077874085290095 -0.2003243285663298956 2.1166991153471879095 -0.81274389736006524831 0.6833048828067567193 -1.0519174411060407959;1.673278046557696408 1.6934980931774994417 0.17784666735946727534 -1.2361437404080164448 3.9812192935389734139 -3.0661503804280827445 0.08760772115577662722 -1.7147742189654393563;-0.027202846057184953965 -0.11862399561972516993 0.53165621964228626517 0.82875000583436619905 2.0412276738040628921 1.2382212782707919807 0.073422734067067105257 1.2483083484282035958;0.14586767462859634437 0.051376697324651082743 -0.74048456262332240652 0.96570617700164629316 -0.70746086645015138217 -0.55397526828344334504 0.19664543915960816522 1.5423870772961485454;-0.34089316373589556575 -0.31556847181471187058 -0.88606969391025958149 0.53175397275844060729 -4.0504047355487333704 2.4941153510539701976 -0.045845200420016281317 0.82333450732767932134;0.27425185284081721182 0.30298864166669509101 4.1110475600465745671 -2.8006699494109299486 -3.2239278333298444501 -3.9004785689027934303 -3.3740699847941417744 -4.0679585003937512866;-0.12469818015527925348 0.0055793924987972394816 0.27670753642067424938 -0.55355866549690613265 -0.9529032740252753042 1.6016839551286241594 -0.51042931896912702161 0.17521028822766154809;0.26594235364861995574 -0.72067901738434436698 -0.70127195705720024588 -0.32840772143130364524 3.7899822165746175351 -0.3427323439355500212 -0.32855859276674703739 0.52946670211487567581;0.15204292291232240908 0.32212003669876315692 -3.0496958788451737909 -0.21485475795856678882 10.060358800501406407 2.908509373738296766 -0.6268845677280603379 -0.17840811910058845813;-0.12644587682912097892 0.027032142328401644743 0.29274076947604643628 -0.53510454899233139692 -0.98761543186993538956 1.2763528500092196083 -0.65669525488092606036 0.087935056180337659026;-0.23869967157510302291 0.081035818079404964287 -2.6122529210307190439 0.4230615556809010358 3.2567537899553458125 2.5627507031279619376 0.070563568201494120125 1.5287116939230354085;0.0062983494412745836752 0.073257631094119229909 0.19153118487757425648 0.20403856659090544023 0.86484386687193515186 1.3564879693192062327 0.44571851503383591586 1.2837530391085276715;0.59907847822434245888 1.0401727011556050062 -1.1525913869395472133 1.1313149526994534799 -6.2194176155546569973 1.8371940696498441081 -0.90806104774962836945 1.8773648775688411838;0.12150982442441063403 0.36186971628930025835 0.96922905183621044234 1.0314235741339545793 1.4651148855278988137 4.4999929775273308508 2.6276602966490285596 2.007400481381206081;-0.23807081080519751359 0.068708490739114863599 -2.592086782776059195 0.40277629259461578126 3.2188643942134569365 2.5717016048481555757 0.086080724624857760108 1.5511028849317907152;0.17969628154043540413 -0.15045983426573972253 1.1809691480620847504 0.22586021458020683061 2.0552568041266554566 -1.8208405261877300685 -0.49124604363378215899 0.14761075341482074452;-4.3471076620123119127 -0.20392209912187686527 0.66348666557028501689 0.24238478824277776003 -3.4391484241073038142 0.5182691489533223228 -0.87946108655850008251 1.2711826372171615152;-0.1343072173183755269 -0.038021752973466098335 0.27631933433576127968 -0.55471252552473437891 -0.96476314202759205774 2.0561776509359135368 -0.30561219557586372098 0.22778023844768105488;0.14308033368053080236 0.07703433307664110663 -0.29224909640989676918 0.51481396247899990914 0.99436340482425789045 -2.392088251458572401 0.15579271627491630969 -0.24879915222022955246;0.228227977612191546 -0.088284174679959789844 -1.4151289994128546379 1.6588701905330409669 3.4194090711795310789 0.44836988452677345451 3.2063729755306829006 0.43669444890813641225;-2.1608025770954761846 -1.8972026216433592882 6.146807414695846461 1.6824150656924017344 -2.7982271264009623835 -11.033592538537869032 -2.1867449522079174251 3.4731630662673689258;0.34524289752859249614 0.50293912230893611515 0.32250450963912952185 -0.047520993814289119728 0.99672353211751352209 0.12932618920122429529 0.39126214003808185149 -0.61221734306053188224;0.014458465278158409706 0.095341089115286645206 0.22175801103423506411 0.13618454019996903415 0.79882924367610952388 1.1952854655905982284 0.4252855893498364015 1.1389187635348747563;-0.8979203892913139029 -0.0083581756999527578866 -0.10721751787584955784 0.77427416460058762215 -3.4715032639363228029 2.79352842520094935 2.2582268003853473992 -1.1846000972956514108;-0.048188219949559546462 0.30125720512244286153 -1.2981507606638804653 -0.05661675812795982643 -2.408991001655794495 1.729611134373304937 -0.10028244567535803122 -0.40928198590499065279;-0.90745973656442424637 1.2888972611037066152 0.42804034472050744853 0.29942464660386863828 -0.81599423151180772162 0.85583287568792831834 -0.38071306934142773448 0.22601053088785430512;0.16390102562286515409 0.15199208394659330379 -0.28045051742505833214 1.513786258818280217 1.3077771517570047077 0.18799426007671102279 1.6299782778233924407 -0.17813000482005969527;-2.1004758544901953599 -1.8397279712692937714 -2.1992817084788804927 1.0773655285352048416 -1.1528845681062245276 0.70010358664733218781 -2.4619970143494787074 0.53763812471081495747;-0.0042017238324156261017 1.5070816249907403872 1.9909941870060832159 0.34537792560439312117 -1.4866323223749098315 1.5992153610376094175 2.3030141405442687841 -0.33494551546709222523;0.85388860621658957406 -1.1221606365833303176 -0.51099449537221597328 -0.31761267044569846396 0.64450600698816973289 -0.82854739211716221803 0.61034116566953999783 -0.43410717801713455399;0.22013692532800399615 -0.00087662099198947259979 -0.12343805864075665935 3.1123971453412018207 1.6978773690848778521 -1.9184278371193490553 -1.8123316054044600332 1.6749848254978862983;0.66503539576626791163 -0.23370284982156985798 -4.7269204984706867378 1.9120266755149162297 17.82697591207558574 -2.7171547239810598384 1.4242075407814238641 -1.8354649998388212762;0.10966790452577385162 -0.0032724231227632214619 -0.096322404309405779133 0.0759275892781626216 -3.7460727390032908524 4.5701213433306824285 1.4043111606895732901 -1.5024657577165412281;-0.79038130430077457866 0.95054038136989371655 0.63717073322025141735 0.35083070098586582874 -0.4198689323617239566 0.78719104910473380876 -0.89539034366456060621 0.69607586759825490486];

% Layer 2
b2 = -0.60550780761235845073;
LW2_1 = [0.3540348965000856829 0.11673734408865357737 -0.12277820338510427034 -1.5929730108114077414 -6.3288392670732518397 1.5589102479246292887 0.13067242418925273384 1.4683998929626511654 -0.45815284132091571578 0.57976507203105009935 -0.43446623273051698799 -0.034921366797254056735 36.936175177722816443 -0.15270089120418192663 -0.040425171284335786881 -15.358635329798266511 -5.4471166796434111745 -8.4992665938465083997 -0.081671960911090343838 -6.8898390738083676865 5.5257948758524984001 0.60643239058178310952 0.056338534064433849757 -37.397923477005882376 -15.606520850950834856 0.11355844033820076955 0.0087281920110387246903 -0.73783637160346893236 9.9329379268427988592 -0.16512931550517784274 0.48525815435554181532 5.6008546249537154438 0.84643139031783698467 -0.037385556689562504662 0.10947556185347823154 10.843758362065136325 -0.27027429335320490855 0.036980103857739490825 0.25466863052103899667 5.366411123276876971];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
