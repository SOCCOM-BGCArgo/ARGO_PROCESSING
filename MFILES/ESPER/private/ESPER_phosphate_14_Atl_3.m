function [Y,Xf,Af] = ESPER_phosphate_14_Atl_3(X,~,~)
%ESPER_PHOSPHATE_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.7934084571728492463;-3.955098928768845834;3.7018248780067453119;0.11684868848318637202;-1.9560968520860542164;1.4681182716674050504;-0.11391009578377940537;2.6286030729411593576;-4.1279523836867877407;0.026614748624197985538;2.890222418761611678;-1.0768271238913595944;-0.4078541967373915389;-0.30721259239662013218;1.6514485206468858536;-0.39424493175095048914;-0.9760809412281707953;0.57257140129425887487;-2.0921658741176143437;-1.9407913638597218409;-3.2583889489015107621;1.8385928353074845187;-4.0178438720544642493;2.4070245427653791381;1.3065343167721206186];
IW1_1 = [-1.3461707039813579634 -0.48124093197407807887 -1.8754769383093619073 -1.650498997283965652 7.4976222076658425308 1.5580930929372978078;-0.79465431104378869698 0.43772523426290044224 -4.1542604511781027199 -0.84956699045901984402 3.1688644533501344469 1.4087043891408919105;-0.60046504996677663168 1.4034768660180334532 -2.8276727113502064803 -0.037418162096224547031 -1.8470039233696966541 0.83189644303430687611;-0.27113571962026233875 -0.66701647519866036351 2.198783552580714673 -1.5412448742062281326 3.3609822138518956613 -2.1222729817123999752;1.0555370834085120446 0.63165888217070187416 1.1143109407653049026 2.2746676244328534189 3.4138156815221880613 -0.94761432892400609962;-0.81093052588323677465 -0.5824579387284842813 1.3099432861766031611 1.1684365141273742594 0.10456881892155334146 1.1875056545967090926;0.24277335288081960951 1.4454035740203776683 -0.61223590657247606295 0.6864981361266463411 -0.043062863136746322434 0.052014129371021712578;-0.91708212289075730084 0.69740497520082278538 -0.74271459202075262862 2.373948152377433729 -0.30716546921768911327 -2.285498502953293265;0.023013447001222011451 0.1107038351552238481 -0.70522054283129598229 -1.1996086045585598878 5.96826620733831259 0.45793013915646918477;0.95766352419849010147 -0.61570505640369666001 -2.1098636190667794388 1.4253444316613583798 0.16453128559276836151 -1.1997696679155802624;1.7050503409014006184 0.062939657127046577667 2.1920142608258585959 0.94153642643953994185 -1.0286021036752939217 1.843077705147157852;0.05259230726608084272 -0.44965154627474412941 -0.75380425170422371561 0.48063291408609626343 2.4766813147025850128 1.2431369264309157785;1.8356256965492230293 -0.38482357190739846509 -1.0882381804395484526 -0.41575826548018157691 0.58841920874173403444 -0.23745994612526793999;1.7550997359936195696 0.18587666707548591849 1.8551507648596963218 2.2035332890509660153 3.5493960775303485811 -0.45589564421980488529;0.22007686710367696525 0.34512733110161886163 -0.086277524231164429147 -0.066757796787105555536 -1.1697530285636019709 1.0363835886623751215;0.46171166997628737549 0.6802748723881303361 -5.6420660193032059482 -0.17289535977917430687 6.8556464287715943584 -1.4574487132337803352;-0.0004261701702522676001 -0.82203692985504761559 -0.12008387125603470214 -1.8715932885154691334 -3.2925751883774041495 0.40833051653908031264;2.1335376799344509813 2.6179185307499985846 -0.4042532422532919556 -0.72235900798867269668 2.2250160325935892658 0.3384435791002749494;-4.8551722704491560023 0.8834025247752274046 -4.0830284189060925826 -0.23866822528619485722 -1.4159957543023218296 -0.50044588807502854433;-1.0404500989852700776 1.0766585041061020878 1.7912337043569426243 1.3199098584133699408 1.1070044746306739736 0.18706534606612804095;-0.028362858668444485 -0.53808375825018106564 -0.98893325600270154396 0.46096734501073111101 3.0775092698293722293 0.84894701496667024365;2.7999565668560411069 -0.046235743779089608085 1.5158145261831434958 -1.2393345459884794746 -1.7968261767197364343 0.98151254748664840122;-0.75052255304353743259 -0.53010814462724653584 2.7589930985310191502 -0.18025958332248476212 1.7355869121465294924 -0.61191181107902814507;1.6600830471043170888 1.7719249404250800861 0.90053529468015514059 -0.80496746762668869302 0.15572846475166396418 1.2721818388507251107;0.54822269065999051918 -2.3118771818974619414 0.39255186009500231403 -1.2875748925849033188 -0.89702911681585728587 0.81075734179302372251];

% Layer 2
b2 = [1.9232319489126457057;0.58233644044782306715;1.8372783750738674868;-2.2389773823951308884;4.6707483598297603322;0.069602692654748776757;2.125861414902266322;4.9157886741028518074;-3.4158348293861116041;3.7389156867510617843;-0.13440587352264016241;0.99462363199157721727;4.5069085966541111432;-1.4635514271458613944;-2.9970002010655472091];
LW2_1 = [1.8232193424131091231 -0.19506444039747308783 -1.1568587888932404528 -0.028892748599912334434 -0.41316633650384543275 -0.73436858653606751357 -0.91894748792679903371 -0.22526260638794856628 -1.7484735695662994015 -0.017502610663899357407 -0.11477037577813455071 0.019809981533391290281 -2.4860698614632212866 0.84929323046984217527 1.3244654696056858967 1.4112448457197619422 -2.6944280119798005302 -0.11113307761506417692 2.4195069357281657751 0.08632040527058040813 -0.60420224507071207398 0.78002404817786397118 -1.8856323235302387964 -1.2182174533738046041 -0.25257185489813521739;-1.1377648668016293598 -0.3271365817248699237 -0.15098211546027073826 1.9738343828602578078 -1.4090309137345682355 -3.7066049079051999193 -1.1392262080044441852 -1.4869330281475170441 0.08680094695212306477 -2.5281599079239271965 -0.88076246092940224663 -2.3637227342920685835 -0.90928753104286541564 -0.73028881016226832035 -2.9235174859432193628 0.22847282987670797239 1.0246525175466576485 -0.16988106645720518761 2.3110633296681348803 -1.3648175688996866395 6.9490701103481562484 0.15806727005730308866 0.074504571224680987696 1.9123966700786667605 -0.91704993561782555123;1.6133057941717130479 0.71412775952592910667 0.53967985192748491041 0.31135002733364935956 1.3430622289498261868 3.3979091167834400977 -0.78785763554632615158 -0.71448044524270970523 0.0041703179925719367424 2.6119148818716824145 0.55434540829062983747 -0.56628697706131336798 1.0172630752206355265 1.4513115161857919055 4.2023904454430853761 -0.50728228959906107587 -1.8469733990775456522 0.060606629802568798282 -2.0493169565557320944 1.1198060713286350776 -1.7247078231550374561 0.31003568916481966111 0.15274975416509120607 -2.980962827018218686 0.55884746382510508411;-3.2281885459160593044 -2.5825586108769043037 0.95255604747791033926 0.40019681970377046776 -1.2846242472381481647 -1.2393934088721489939 3.4165944182565461951 -0.40185979194518733904 -0.2199759786381711435 -1.8972881604340123829 2.5965388673763998284 1.4997423882802181083 1.9616789691984428678 -2.4314047832546497041 -3.9472875009724699424 -0.14597776915178589663 0.29322345099630803267 0.024404768494028172832 2.0175603476962531424 2.0166839492229788888 0.88392811715210195533 0.19875655434356218065 0.86687986804053096535 -0.71511163107376829462 1.2989002474679791632;-0.53743269026510676056 0.91300277745894942161 0.85962330488602045619 -0.10582516000046794657 0.078993422707783630954 0.48692115036082522783 0.080435945157734611843 -0.013953740073385017748 -0.41887733006784388934 0.11862588016881268904 0.32873316739438562806 0.029903736123464551289 -0.093092151083880775309 1.5907738989157114151 -2.4025391460875424876 0.52770207807620728158 -0.08175076928291413747 -0.72807408638357151709 -0.062209859339867480676 -0.085846776416378209329 0.88680615633170389867 0.51568669168569070127 -0.38864138644737439288 -2.2324555513640351734 0.43388568700709817527;-0.27680380018715394774 1.4677340541884256186 -0.053379125370269800421 1.2337508289380059168 0.49928434519870384944 1.008545285414311321 -0.19612272036865927016 -0.63106028179582174253 -0.98209429383558055626 -0.97048780795170597191 -0.18432457595069856593 0.71196877674473035835 0.44268001560499165015 0.70237948915977177489 -2.9075442792873733566 2.6236619116128672147 -1.1878735659110215561 0.1333578738366199834 1.8856407453954080466 0.93554422103218848328 -1.4123173284730234922 1.987022837017763166 2.582443915812009827 -1.9293743466109156692 1.649356284192187605;-1.6730193624403664199 -0.2498330920675493616 -0.25289084348531415403 1.2297044934112042469 -0.26110503521106870339 -1.5861247873530888164 2.3121429670847359894 -0.052329509846522383187 0.61401754917173700932 -0.42373460574667487499 -0.12890085144297583342 -0.75858615095672066175 -0.35685264168400404605 -0.93649228137433038199 -1.6052576578417507847 -1.7877576748527688189 1.6343079505605930812 -1.219685410776448764 0.051433966179944078101 -0.10853982995113120591 5.1136977318643479506 -1.0379770434499067111 -3.4839712706706684742 3.1845347318090659883 1.5885125810925011525;-2.0916772476474831954 0.28086032500235813547 1.3561832857180979861 0.32239028439234029833 0.17791504173859470916 0.27431477874812115747 1.4449673766914610251 -0.77311880570927471457 0.36985690942970933515 0.14790708334219729303 0.39454215419237242957 0.053506534494274851643 -0.97990097687375876667 -1.1800809795250910561 -2.6974361027436217775 -0.61230005433011169824 0.45686721306709643375 -0.02318549025701652222 4.454582118617858022 0.27930479447775269364 1.6927729433127924885 0.81906467315263586926 1.6037391043616897601 2.3823812054541075867 1.3904456043506387974;0.43403595391439792062 0.12290167873414249711 0.32521840334583929089 -1.3380975949068705244 0.018539969108652958052 0.79933783499444732712 -0.52699080615283677709 0.1598291719852349968 -1.1957003747441381503 -0.23097082194706108904 -0.15876612017440547286 0.51657165386152570363 0.39105836201919902395 -0.2557834850736413479 0.47575321707420625827 0.30668348584438370752 -1.8091330396670182168 0.63070577882594969221 -0.9616645621177286607 -1.3401635515422190004 -1.7153690401485657269 0.75757016027027046512 0.089407709892270315066 -1.0422547766738772257 -0.44674485159970156456;0.39218441883275545479 0.10252736831052415567 0.010778569770509307396 -0.52317059985347180717 0.024894786218858724891 -0.42915900264401524167 -0.40285464406705090434 0.35121714172580098534 0.17553916070291225582 -0.57570880518363454215 0.1673571741781582356 0.82921792688069251298 0.0011967011541468039297 -0.63157040846403966761 0.15713839591441997046 -0.55222604654062978913 -0.73185671804748408942 -0.01796832127679461738 2.6655544619419293539 0.87969418928112208533 -1.6405797147787639645 0.80297598179387563722 -1.188321678462038955 -1.397178551298727589 -0.067641454786865784499;-1.3292280959919331451 -0.33326278850053359104 1.4333165779333478795 1.6906355234916734531 -0.84169366352822938548 -1.0290373949371798279 3.0895062884736859132 -0.029133754848544468619 0.15931158483773624757 -1.3546419330876060538 0.67802782428404539949 0.21011815579848272528 0.049441413081467509849 -1.926822258855945158 -3.5797301831118204518 0.29261678752704212148 -2.6292042096464793843 0.34535441800782978872 1.8859314372422104622 0.25705906951691515072 3.0341026449801713483 1.7125859424822713617 -0.28924207000620444363 -1.0321918131862803936 1.8944099489072352416;1.9354232929818648845 -0.31078140436762435872 -0.98847448197812404214 1.4521377279884122302 0.41215431705117216987 -0.18169153200932772196 -0.40706261682826544446 -1.487066817508813088 0.19904647535108269119 -0.735932615540182411 -1.1715882300021551732 -0.54150754550524060615 -0.054196082712837732875 1.9072770684835795851 1.2665098739688467333 0.070331155605156583932 -0.042470134629704781037 0.28384835314744288892 -1.9244102628807464583 -1.8458432903686978754 -0.57231324327411781105 -0.40680171977369405933 -1.5529362086316815805 0.72930453043366305632 -0.072450402826291560032;-3.7800894735825134596 2.6034933275167166933 -0.18283280800902471097 1.3933827912652914094 -0.12870138069011985427 1.1211401099046225394 -0.099173391317265990885 0.16312857498733626671 0.63956073482308106737 0.1196023243852745721 0.57811828031401479855 0.36575189811508779236 0.66027330940577733109 0.063637110376298489101 -0.99311261631228231472 0.33081648948339892335 1.9260142402774149684 -1.8034501495137886806 -0.31865934535735929156 -0.19599213762693859509 1.207631630927088473 -0.2499243350274313602 -0.20507861141636521407 -2.1106009929753430931 -0.92584720687615884582;-0.070101449487300418473 -0.12529927118639613837 0.089632479984918189686 1.318722022803479943 -0.16797205217320448911 -0.2724290783622118628 1.2192882364264270301 -0.24216205727843329032 0.16742209475642413907 -0.4491884629075132418 0.33234483556459376574 -0.42246531513346019526 0.20316331877497997849 0.530237512962427604 -0.40378175440146568675 0.53276627187398462038 1.3835346939355017692 0.032147050790718438573 -2.2612881471088943641 -0.37249986829644454733 2.1973651334570218907 -0.59442101596570917632 1.2299724975553212314 0.038268356006496064003 0.63170485686878308229;-2.7186725424002569085 0.67276177739765774533 0.20303383022760068677 -0.38267715708116306628 0.039965067390057430752 0.88311921243270885551 -0.94904940900515266655 -0.3266135132203502045 -0.86717703282376845664 0.20872393114393997249 -0.39101848541064926357 0.10033739198356539379 0.17428487541964635121 -0.97616295952084686238 3.1542477074517552005 1.1326391685335077675 0.31955708864744580833 0.071877759347161424008 0.92432791669878711094 0.95164186123281513385 -0.032616018112287092912 0.13814897416436466848 0.60658918715668974642 -1.1374427862617766394 1.0095041134855635701];

% Layer 3
b3 = 0.967247173017238282;
LW3_2 = [0.36442920394680672347 -2.3208224440830327318 -2.2547293756946054089 -4.1041105155094852464 -2.6862171570207005189 -0.13788131090110034016 0.15722549439996963416 0.31058442782273415483 0.4429248047112722686 0.9487657058206433458 -0.16891701850507112592 -3.5120250003244550818 0.56117119805975435032 0.74105375203698442554 0.32227899089989292536];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
