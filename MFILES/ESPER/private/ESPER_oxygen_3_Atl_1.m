function [Y,Xf,Af] = ESPER_oxygen_3_Atl_1(X,~,~)
%ESPER_OXYGEN_3_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_3_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-29.111995431198049999;-10.580654099053090178;-4.3127004532754469324;-15.350254545865505307;0.27997902203242885921;-4.6342020057834973912;1.6087836496879166504;-4.2865991826289233657;0.61512604525094638497;-23.069288702971057603;0.081006553102631898011;-10.747954348894310783;29.844448020073215844;-15.391875699849810744;8.1502386768971479825;-4.1080573036965954969;2.6231659179404478444;0.80458169566929549354;6.8730204728008699178;12.261948880492486325;37.337311139091170276;-4.4592819273079991049;-2.7944862346173069412;3.1867202129656848619;-3.8193511656250973552;3.9543425473768385459;7.7903073671745355355;-7.6360855439889796514;-18.108490115193344394;2.1883459261943558616;-4.2341747890485548211;1.9417872738743799932;-6.5475840132757863188;-5.5305165215540057488;-7.0549939212404169098;-4.8788322706304985132;3.4129578186703013465;0.57911061897106019813;-1.5522127516913175604;-4.2200434995527213999];
IW1_1 = [0.92162296590560288667 0.1743461770328302296 -2.8488935962168047134 -1.6676576564900078559 28.399219334605266596 -12.726165846665750792 -3.8378486727519423027 1.4505003511480054623;1.239861069938160254 0.79316195033564218519 1.1423706491603016211 -0.57138740293576129048 11.741437553959961804 -5.1585398943993077125 2.5383434812347620557 0.52047883449141174594;4.1648835875432306253 -4.1129855063954439132 -1.9579936164018745259 -1.2941463344816750425 -4.5001013360078552239 -3.5786877731094666188 2.8000478638311285806 1.5233830121188223217;0.23111312011492601837 -1.4852006881341359712 0.74936329991577410592 1.449282655370692563 0.43326144513512421241 -15.612777074944752087 2.493028103704120646 -5.5608989727544324566;0.5297934294339312622 -0.78785954434419580572 1.0594630551195916013 6.5771636681949372516 2.5642498799135062804 -1.5809529729840157142 -1.8983699218346996584 0.19070558816633467747;2.1608635162432610066 -1.3938020169013685123 -0.37275636430735714644 0.64402621296835682596 7.8576802522378539351 1.2874881701010261192 -0.39547469022084791312 3.2147370945363804573;-0.040700979536971007566 0.28940755959136260644 -0.34876552668148691483 -0.53288742722881099478 0.16376774310415975755 1.9404468666202385752 -0.54459830842787426697 2.042851865163909153;-0.77918051052627457231 0.84011458659659155046 0.31555447482359655353 -4.4609358960534697403 1.4381839905848978756 -0.77340393102616888932 -1.4136415253470528963 2.0067486660700937229;0.74205416382869948677 -0.21698472623304498885 -1.8250852182951107228 1.5282120924436926046 -4.6660046931925860392 -3.7611116207163988179 0.76464256370928818107 -4.42789354176852612;0.44303094427126260557 -0.4495143873065960971 -1.6116197046147151539 1.1185647528151143604 28.813570258154562964 -3.3830298109981362664 1.4668017436790432573 -3.3345407278641956417;-1.6802622732374785652 3.0452573603955745973 -5.2319078194319299513 0.37293786953789653804 -1.8055634817687373772 -3.5387797034293506648 -7.223864668943742906 -2.5160843301514432824;-2.2028769799112204453 -0.32719096116081142211 -3.7828180537184121768 -0.77466633827943254254 12.08302405722771411 -4.6076919701219569703 0.51419546968412832566 -0.77620083840139630915;-0.47151143714378868088 0.30266313809920630806 2.3654905588109218506 -2.4709762569373356911 -37.338851179385919465 3.6377712519477816144 -1.4857413439917834808 4.6899143612997180597;3.6652976336044638117 1.188446728853511436 -1.3570844431926818441 -1.6774406425290240286 21.866314566028190569 -5.9689140686183872475 -9.5621252855887330924 8.4468931679349736896;-0.70025208495155333299 1.4487004173176107891 -5.8169875305811427069 2.8140913814020951378 -3.7448357561285132711 -1.6973865908405771918 -1.6336975116451308843 1.2167512736007486396;20.181465510289548604 6.2055374253574422383 -12.408365742709364099 -7.9617086109462587018 -20.699494311829877091 5.5898078460632945053 6.4989730717846789787 -8.1871495291818980888;-5.5264706937702516854 1.3962392629559938761 -1.5047537361432112846 -3.0358869276470703547 0.22230710807051815014 0.85070745904968891882 1.3062968906468348518 -2.9956464850164645775;-0.23351296935282042644 0.30538830772548747339 1.4271365802580624482 0.88366982196175036801 0.37323991213594881478 1.0495873611707555728 1.1003373499826145654 -1.7163725618833458597;-3.3303041107047905989 -2.0904480136235177312 -0.66465189557868065151 -0.32093550972478190886 -6.9404910971023143773 2.8478066163347670603 0.59535146609153699604 -0.50467036537814391473;1.791601050137686002 -2.6174672490993393659 -1.3452912543074355689 7.868764571844208966 -2.3665876427233945023 -3.2214732632158944448 -4.054687288348449492 8.277209693833624371;5.2466014874511115451 7.4812096527465996587 -10.831928900405985772 -3.9846448129918687897 -25.249349926159279534 -1.0615350541866335199 6.8106686682261887711 17.748253895398889313;-3.0015376116957672714 1.1236765736205458488 -4.6732980066378511097 -13.301263098227313009 0.25599696131907428986 5.7655151722749087284 -4.545775724226897907 6.1437235270125594155;0.26721699613148558461 0.44705898491076090373 0.71172765975774843206 0.81006652824644642674 2.6012474204323901006 0.14806473263305330867 2.2326315848068358783 -0.87993611449597997076;0.92599377746898192676 1.2506079578007711639 -7.3019994529218879009 1.0788684295672215097 1.0603179178251391779 1.8079269758616274277 -2.4390218096006450743 -4.1122671694405061871;-0.45505147470305651325 0.63559696875415638839 -0.19975773906444560524 -2.2426109231344941719 1.9846066682652550028 -1.1173286814189229421 -1.9268347747677612158 3.0542116545204782696;15.235771186026683566 -28.987334055696393875 15.270690429367427043 9.1875410629632821014 -25.536943667800034774 22.182870590811244682 6.249218423601575978 5.5852309001716449188;-0.41748202841578740951 0.92437745200823695502 -4.3486594463148122713 1.4135370870936774246 -0.45982361737807436741 -1.2986857128055999677 -0.27310995001733112675 4.7005006781872342714;1.6245525689984421369 -2.1464934029116302661 1.9851348542084432669 0.68754093805368543535 0.97433321082303425698 -5.7436445263999598154 -5.6485938453174462381 2.3280289437632157856;-4.5936826395378318466 -2.5496249683052560897 -3.0946999401623904724 -2.6288038045498156592 1.5099136781191160317 5.4653805992799346924 -2.8253150055258648976 -22.592243246127843292;0.019810871879155658726 0.080017331580782224965 -0.76268538116543282968 -0.96130737875293081895 1.7205797382041561061 3.3885951235151314798 -2.1924894440742828117 0.7763202305228109612;1.295456329121976502 -1.3037342883523725945 -2.3233132332137960141 2.9839763646528707497 -6.8236557261228512061 -5.3758497940913771984 4.5105347288262134242 -10.752527286980878785;0.31264603510837041256 -1.1633246244254931145 -0.60796035141668336443 0.577916313168945317 -6.8109489252271755433 1.9935877211998265235 0.34797854874683642468 -2.4168899633991500764;2.7387741087132737583 -5.6443401778760042831 2.3815767366977924624 -1.4721137335705163363 59.70302010306944851 4.9410761682694701591 -19.109888012252795875 51.03532783174969012;0.19859562564241825533 2.3328216013309579502 3.7869585385683119938 1.3372290519053611213 1.0516308701904686362 6.8197667421964807133 -1.7453244090653674547 -3.3318231898747456832;2.8223664646523611843 0.69055911905739786327 -0.2291634567869404171 0.75355061501459308371 11.561989834621545725 0.06363215131478774933 1.835810527423210603 -2.3453587952515775328;-0.1136524515722327211 2.4075856460179085872 0.5119156775822462091 -0.39724042253877206443 7.9810500171356837384 -2.7764641908544120952 -0.93659860326769317496 0.27949802326884432002;-44.188811760814104446 18.655374678053082249 -33.954035462976740689 7.7785151797041818256 45.116030590080619334 1.0738207078748056578 -9.6733771890497024515 -5.938151578402177222;1.0356596148483800945 2.0098167284965375856 -6.5949135998642907097 1.0285293182105554877 -1.4878021985450293752 -5.4944074449071775845 -6.2680379665006764611 -1.710341430367500859;-0.42237187240539253441 -0.28604189941421581667 -2.5480408768741305003 -0.91156311967441105981 1.2667263298887747602 -0.36597130498827312728 0.10517553118004216439 1.7274691348548922853;-0.14999385124519928891 0.35247051052842409691 0.45899675989714866509 -1.797000678242089311 2.5246824823481963662 -0.98614447051493525631 -0.30231160527749867395 1.9020115953185954272];

% Layer 2
b2 = -0.47087083209505836701;
LW2_1 = [-0.031860521547389476782 0.046731347690744308443 -0.034131106811074174434 0.02927711560883729941 0.025183752542500884714 -0.067551596334278610212 -0.30026593093663084266 0.1824224625944854683 -0.089781916808495565441 0.11994892544915762567 0.02074203890028897268 -0.034735016228458336085 0.069147561953381481148 0.018259157032839531259 0.071966771635238582783 -0.0065933880013246586385 -0.018498414514330770164 -0.39388764336543197198 0.040019880795980164456 0.039248804753204531715 -0.0055444003324244019171 -0.013545484572967737488 -0.18817689018485025954 0.061790212033713223794 0.42315484157172350566 -0.0058119542750171976353 -0.1597786301301188927 -0.038634875496196929845 0.013242382337147369509 -0.17374357163202552856 -0.036944746172214243396 0.19083760435601648808 -0.0093064244045309683917 0.073452821781734664586 0.068056756035072080158 0.12445240987989875103 0.0038700189588873048704 0.035315314798912568472 -0.12801361355702486899 -0.89835729976845246636];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
