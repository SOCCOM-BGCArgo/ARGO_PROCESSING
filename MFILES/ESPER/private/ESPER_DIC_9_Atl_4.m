function [Y,Xf,Af] = ESPER_DIC_9_Atl_4(X,~,~)
%ESPER_DIC_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:13.
% 
% [Y] = ESPER_DIC_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5282312237882016426;2.5702907213454913027;-8.446479388457017734;-0.34448969649704891394;0.76366669759743621704;0.011632903893131242568;5.3454789132226583348;-0.5583535050890001683;5.8689443904509035477;-5.5249822991648045445;-3.2228547420296878023;2.773006745926445582;-3.5205749717651744213;0.68951744009791782197;-1.9269597067926031997;-3.1796666095034793464;-1.3501477954839147255;-0.30332283202540682998;-2.7965597812683555823;-3.4539711932094090407;6.0215359601080153951;-5.0343924969495024158;2.6342783077408657988;0.072021630691596755236;6.3519663963553787411;2.5125173352521241732;9.1614766873240647271;1.4672990919794695053;5.4887718589667375824;1.4138745546587740964];
IW1_1 = [0.19096887141525642484 -0.12538186720217631143 -0.48759256164173475634 0.5461594330686218024 3.1249435358246286931 0.11330469834229418835 -0.053372499848989701787 -1.6777787259944278997;0.92264534727949243376 2.0506626720962333188 -0.33601316288355892459 0.31332105097622903189 -4.7251328900240414654 -3.2014070051731966515 0.84628293500128759508 1.6770521014150951977;4.9656791888473783558 -7.451733167991449136 2.2917331178823499016 2.3291861144023480179 2.678219373070343412 4.8307864012662262709 -5.6888711672560718924 1.3293717717082591534;-0.37132276341081238424 -0.8610607681762048049 1.1581628298647697051 0.12952732227817384536 0.52972658583262688392 1.0322418508211022026 0.20019700506994370093 -0.94849487326545267596;-0.033343536686442430683 0.098094736675603907972 0.88053488392638268323 0.10253239065046036715 0.40220470907237437785 -0.40721432381364175423 -0.88579546464177760789 0.34903258024454936193;-0.34845256785302319846 0.75304175833491282521 -0.51781506035432789403 -0.045154559958819444343 0.37927357761938557124 -0.30914087146060159617 0.2130852367581841933 0.21924233432216053141;-1.8686708701165850588 -4.179886115329950691 -0.52697940415613919729 -0.97467379832946055007 -5.8201690313500922258 8.1903414537057450673 3.1528235269532216556 -10.16095077154905546;0.41329611396450044447 0.2228233301918829401 0.19780117894479959384 -0.6577773213863438162 0.35495620873443262111 -0.72063270640697718594 0.60447476073532435681 0.6696923492300158598;1.80049387201878619 2.0992983759289041146 -1.4125184519707014719 0.043638430705382771913 -8.8062731160586409374 -1.4790049112868401959 -2.7215812048821064195 0.65038781837716275191;-0.96442269860387952463 2.2785348003209939804 -0.10792955096311990237 -0.75685653756412163418 8.5995509182731080244 -1.1288873482076673405 -0.48369092478037267746 -1.1560416733834912861;0.74403747965896616101 -1.6390690493613804257 -0.56246327280692287598 -0.40191597023685660117 1.5431626889815523995 -0.29776235294560005062 -0.89327896581289500944 -0.33369201303563539307;-0.53237116262216110929 -0.75780823525877227809 0.63590261506167966576 -0.75109138193772795322 -4.7028563882423926046 0.36842874858653140713 -1.4462681249669522288 0.47527601288495474607;0.36054335159506351038 0.83793280379102286215 0.92284661191558692295 0.32434699029576685714 4.8673150911798135354 0.75751519411654577585 1.2001251950992593009 0.49318045754610373432;-0.55869993937987061372 -0.11392384523117818351 -1.7167316405933794599 0.24237567914031332705 -0.68613415576722147637 0.025965666909756112551 0.86963220326100110213 -0.49533849564718857028;0.41116248443080466446 0.2886883792017118644 -0.014181923991918603603 -0.78633401558747428872 1.669288328060859028 -0.79300050600818361435 0.064593828064728561755 0.050208978424496543413;-1.2212020285443609957 1.9546217495855913171 -0.62868550368993125765 1.0458852385546892894 4.8805657125397763352 -1.7963297993469973246 0.7631761784134708515 -0.89879280827815311028;-0.73274285347778866928 0.75048932029226722573 0.57167568713202043806 -0.21380583870251756995 -0.49306631991864557918 2.3732600510171044661 -0.97702438391908774662 -1.8453112554520609834;-0.50353055548433900412 0.68954971280950261292 -0.33263783827747406274 0.42871953652382760458 0.18465293835370980013 0.38718085145691455429 -0.4121224346642096692 -1.4660183770218224719;0.50002704328374392162 0.52285793328598306751 -0.61020823095116016876 0.61201542828035493393 2.5334260106475383623 -0.68129153337864323259 0.89129593801247875007 0.033926833624772709253;0.2085007233472271071 0.83521358753251284668 -0.15421801537709434182 0.25213968565470157301 4.372850206732313616 -2.3603322899054570705 1.8868225054101288585 1.8124955068280881321;2.0972978361465894892 -4.2688187675608206817 -0.3393063705325277124 1.7460979088383856705 -11.766451319470547787 0.9985400105003849891 -1.0748508386387103375 -1.42499275431128547;-0.66327519983616034516 1.0535218676012823025 0.24336377865207334259 -0.34318732731342765918 2.5408964144333490154 2.7376967773535580974 -2.6389174471078473694 -3.862701895354959003;1.2102481364012982468 0.42927150474824821158 0.84657298449701889886 0.3222886731572758845 -1.9507648469644360834 1.3010299072863669156 0.073090735571609624643 -0.79839391831149586487;0.72262230216689304907 -1.2915983205448453575 0.82295737358277354367 0.23769139124699292798 -0.034982700409671191322 -0.67947787021937333662 -0.55577138833517003569 0.50263121386554743264;1.3642456752902247796 -2.5427783348030228439 -1.8363322582246093262 2.6658497657974167261 -1.2044782528327084847 -3.5427129384525168909 1.2011185127767731728 0.13557408470746024065;-2.9655917612129005789 2.4754626308938498802 -2.1269076052910005359 1.0562873289151863965 -1.6746456472218680389 1.5270624092578699571 -2.9748035949447166892 2.7548772967187309391;3.4890000237985652198 2.5899391783734224681 0.26342482176455667142 0.42389811892516865433 5.8850027651904532888 1.6360172664813941168 0.56028852981718069159 12.57454209891449004;0.62852313138216209243 -1.5029895944561832977 -0.015005367292896702042 0.0059583209685970441732 -1.5521734170380729889 2.3136505786528758222 -1.5084586968508468807 -1.1757113955615152712;-0.54492216929262460301 1.0367535072096205617 0.85596211249248332908 0.34834949939581366651 -4.4473857545388701951 0.89532771627097085254 -0.31226468868562884396 0.37064395922444515197;2.0059580790607465239 -1.0557259399166030178 0.99097337265584917176 -0.68430578140482312133 -3.05260481325604216 0.18313100808281954079 1.2920587286333367061 -0.67547799278303877202];

% Layer 2
b2 = [12.985733894929172294;-141.83028090571770008;16.526365698671952487;-1.1181902951851119266;-65.696763168114458153;111.91073807918982652;381.5731974837405005;-39.401906529642033661;-304.2727108517511283;89.881864205949739244];
LW2_1 = [-10.378856338178490404 4.9922978020714783298 -2.2464167407375539298 0.90922492913486896438 -2.1516548566505524498 4.6819135490998000648 -51.583170026171416112 -17.257233377160808629 -7.3355074613552941898 -4.2670712374879986584 10.275321602556982015 -14.613404399411535906 -0.80978681858224166312 -8.011273991643406589 9.8523786151796777233 1.260169730122071563 14.66884947363261027 9.5696141430307726239 -6.6651453342608730779 6.7649447452388260515 0.59889184815390583694 0.95435659269794026471 4.7302656888536196433 16.298053525302361066 7.4228050106628504778 -11.830357400518503042 -2.6068858752105565912 5.4168763829295665246 -6.2019574520119418182 11.53636212360925839;-63.875570217392713346 -4.8983392299209853604 27.039879742450182221 20.943152878256253047 -61.622695981201950133 -7.0714354879229048834 141.99262982480499318 73.737024272583227003 26.765148100184784852 2.5867627471406691164 8.5097650828881068463 -11.427529732687959907 -36.278159141114947772 -39.365436518150758616 -41.675386913873104788 56.676265224058880676 -34.8870325719051948 37.757201808780195051 43.047622636181849032 19.637812939934121914 23.045312112475322408 10.020257434109407058 -81.538632091014548564 66.14174868249084227 -23.682192699045515383 -109.82560943565268019 -0.46000944536436655374 -4.2621797592072931948 12.379709980978665484 -30.074002262212236047;9.3368055176091413472 -2.2578816632836655742 -0.18094963516241505119 0.42258529959170804124 -1.7007842944915552152 3.1087222455433565216 0.52306569267183977701 13.209539181782110617 -0.051462409879726431217 4.7004268729081015721 4.6602234609688313327 -1.2403067537205103577 0.16220437368283793789 -3.4656506058503375733 -9.2606650845328672972 -6.2678637333976237045 -1.4573834589972032294 -0.9358860728373786797 6.5681361677674132693 -0.048243509204429046999 0.54921366874637256306 1.7578210277600891942 -4.1744561293164217375 -0.42205303143241779118 -8.4369046311778639335 -0.56926319755822418767 -0.1258307057291697395 -2.6506332091317705846 12.51408165099039671 -2.02655605994310406;-1.1680595778247251371 0.1156626017212060431 0.0023289822336701013379 -0.61002332848282669886 0.67575784845454400784 -3.1061942061395049208 -0.06201282103847352567 1.4687973214468446059 -0.056896067898776762906 0.076365991202333449728 0.52618719017020709749 -0.48531899839363129567 -0.29516480650671372832 0.15172558012827735974 -1.0579805770483614591 -0.3744496022222584819 -0.41223590018598849083 1.6378131391923094196 1.1843549343967749721 -0.51834998206972360268 -0.07727846016121926731 0.32897902748810459173 -0.64249358526210942344 -0.79285219117812766321 -0.14505258632047776657 0.14401070363550563802 -0.030139105343189091096 -0.40599206636803375492 -0.39029467834974662654 -0.23259274061443963033;47.606803904668893779 82.716951209737757722 13.173603584358788865 -70.091206804591564605 57.198140592001990967 -271.46077496274966734 40.373467876086223782 -332.60581370050846317 204.02060088586711117 13.683538468270677768 -136.06366034204810944 167.68649177673955819 -40.446023356603191701 -10.006283043345895578 70.901963137861628184 -42.33401074379305129 75.265000132582912329 30.158960843077519343 -211.0296337941862248 -6.579072793842461131 -29.191311013317399414 94.796914880779453938 -361.53901490387045214 -99.077899356667984421 -106.95340492568442414 44.1811176589754524 30.355964699323756406 5.5163430744116128679 53.863269593539719438 380.17877578780780823;1.0158221744593260993 5.7566060528550710984 -60.918797544365880015 -51.36824655486115887 -11.827601383063692353 -69.877486506787349185 21.826513291498862657 7.7336496985549807448 44.975162376731539382 -29.594530189309477208 18.907437286031974821 29.00448576088123076 -19.389470487016971845 -53.807252905941865606 -90.925495077157137302 27.677199302351844779 15.708691531938198338 4.8030813648943304628 -25.642239691701568916 -57.570948140449772268 2.1248905302141460893 3.8732162755588785963 62.09665931051516452 -25.83294114280453968 -188.35003543816191041 41.409958971620334012 7.4405797744146369155 -35.690579573713073103 -51.254245342247884309 11.440637473191358708;-127.3565948110027648 159.75741180491274918 -30.69887527713744646 9.0029544369675242876 149.45122437308179997 75.655690254183951993 -325.99999371642240931 -217.24267906527023797 -120.66635638298130573 11.474907036464019328 -39.493084426225642858 -171.3702318584948614 -206.78129527959498546 -18.975204350393223507 -34.393933570939516642 59.796429785989076322 14.690403435709747271 41.004618010745232937 13.362497174976775582 429.64870640722079997 53.139815289196022263 261.80486290799734661 -115.67439789529306893 -47.470254336079385382 -13.101190357721993252 -137.03968035931234226 88.564301014258163036 189.84795023789047264 -11.568082340935388785 197.68626912440700494;7.3845282890064387615 -51.457761158651209143 1.3040385665646518909 3.8607751667554386366 -78.031347205121889488 11.42066260509923481 10.67558620375810996 -49.417976420901247536 -3.6038424125598917946 38.981401674052641226 54.286041041026635412 4.0109822197036066882 38.621147774556760623 16.13187258227622678 53.006600061296168747 -36.27045592605098534 42.382653561953048893 47.684441911328583785 74.064119282709171443 -53.731826516517308789 -8.5367475615326817717 -28.83537997445990797 -82.347829058015292958 76.435344354129512112 9.2542101739091791046 -56.880566824391671332 8.1400724507901252025 -16.566165313637959855 166.19597812712373752 -32.844519521421808861;-50.323557282003115176 90.294189569212562674 1.8548884751484162603 -7.7286285746687397591 229.20971065932332067 -120.2832426591140802 157.40152111844119531 -310.29681938234432437 -60.939391255975948525 15.084951644800650428 183.94690288445798387 -61.482594174818537169 144.21679443936764642 145.9028819597864981 304.7365412460344487 -97.711103772504245057 -203.99293943741406565 12.702985766995066541 -16.18311495962651847 8.2094188750390770792 -25.067789498331237041 -96.174573092363942806 -13.922767202970771194 -190.90174096572661711 -193.14089448293890428 25.049085416608587451 -39.048619217103684775 -196.22811132446759075 322.2032309123147229 207.44919222329508557;17.567778109145063326 -0.52694078966854540624 0.71640964811804042078 -8.4049186707143856978 8.6573166499218601189 -28.879827489044725297 16.882115905364759811 -17.009233032829548904 7.950295674534632262 -11.44971763245842844 33.780720122012816375 -3.0169781093799858951 0.099224855651171617321 -5.9024228538840626257 6.4226997421028251267 -7.0026869160992148977 -21.644519387290181101 -0.24580657234652059095 4.0484039628409211886 -8.6400524845559960596 -4.6348348556681395749 4.273186111483893157 -7.4445677882885217258 -22.588634657614150569 -75.843432173753981829 17.797659630891647708 4.1499775406580479142 -12.617320102774696622 32.65201341379407296 -1.132290333565998619];

% Layer 3
b3 = -4.3991027453059237118;
LW3_2 = [0.0071820771056210737718 -0.0025714572881164270667 0.014954026018242236318 -5.276923935607787719 -0.00081031015039340710451 0.00035457688983203726561 -0.0015911819984199464337 -0.00078873768647623704146 -0.0018089441139073475767 -0.010825691527105250206];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
