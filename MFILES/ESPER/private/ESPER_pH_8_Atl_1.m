function [Y,Xf,Af] = ESPER_pH_8_Atl_1(X,~,~)
%ESPER_PH_8_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_8_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7121873283850983505;0.32841735544350408871;-2.4579062714391839428;1.724470846658654466;4.399673407378212886;-2.1117750475725500792;-2.738462086388624428;-4.1688939802779998445;1.2198689145801688838;-0.37619313954898631058;-1.6935746390478805257;1.0990814077619168732;2.1876431771440292273;-0.60101423575348089656;-1.483539159355066861;0.80977031864329740429;1.4177621840898222416;0.22172764859643273594;-0.89780139115230617186;1.7071874301671998708;2.2453315274154759251;0.78118141218139491855;-0.67833724506018200362;-1.0496778569995102171;0.57060188225393038142;-1.9261942733843704367;-1.1699221412587421653;2.9899921903560811032;5.5591570093752427084;-0.63928939183247168732;0.63936062651292746573;1.5780011642845339637;3.9521577872918705054;-5.1321414838085077648;0.86330164372643503068;3.711030504635477012;3.9844154804937552683;-3.8866992885200799535;-2.1694563159060415991;-2.0569235046421106006];
IW1_1 = [-0.55915139353205944861 -0.50302974007814837965 -1.9817382401349050713 0.071260165464195751595 -0.17096232003407998978 -0.050395345900320354104;0.13900170531556821363 0.25898139531041985961 -1.7909320012748548567 -5.8921870336895540987 -6.9210466064272502251 0.12681049475142244787;2.2079867947517657356 -0.86984363792895347256 -1.968797848428842423 0.48039090819924445963 -0.67506952997211178147 1.660783877400691555;0.33322892345633520206 1.0078325056203456533 -0.84788160495388753546 0.39273310262638827517 -1.2785296182474779059 -2.536844775271054786;-1.3993222636936746284 -0.35129750707815993183 2.7178551622819955291 1.7734059518058309379 -0.87409786621793716943 -1.3698891286552363766;2.1819463884610126314 2.1452111108714801979 0.10035195682850193977 -1.0775907171903866821 -2.877662832111949065 0.35278461447294817699;0.84762161694892546038 -0.53642876970790209779 1.3279325470517286956 -0.16891403916623512482 2.1749285767485884158 -0.88366770926394577756;-0.1585496616170540829 0.10553090078499119397 1.2019461654800518424 -4.3608895499615236702 -2.3772996515468682865 0.96524707097125905797;-1.1022263669618694859 0.032088148462857367382 0.63807619620174382824 -0.80999873628010587989 1.163383992702265779 -1.3318100299450457147;-1.0987125887614501707 0.42125124696335991548 -2.0078796602245696512 0.63712814229375847042 -2.0318253533436223535 -0.4471205061916474488;1.7194155701326676589 1.5951491780623157091 0.99258918769525583681 -0.39809986911049566327 3.0044837391700682794 -0.33971382922130100024;-3.1688221633897151186 -1.6159588800570086065 -3.911871292768087649 -0.22373337738513290884 -0.31426871706952042018 -0.11706308329852797845;-0.6220339058897466078 0.1439324900843702848 0.27223578449484248098 2.5967199440937096533 -0.081102788945141848775 -0.21264527536736030355;0.74300862210030338417 -0.065914567779596852648 2.3962474668753683815 1.3334714471345436859 -0.10713295953162926821 0.7359048784634817375;-0.15156623780434666515 -0.30391400960015202415 -2.5288755073800159856 0.87280325666306546317 -1.7076449425279360828 0.26507822708787354138;0.85791824139974670604 -1.4644807773246164562 -1.4912585879235504827 0.29536767545612230279 2.1038841293190704285 0.68192874997775831947;-0.31928170436951974764 0.14940922074761872618 2.0500154936331211886 -0.96386026957376069735 -3.3993683289609766263 1.5268624231251319845;-0.089164162430602947329 -0.47509804274283706782 1.3192747741280870244 0.211632258327399847 -0.80436439447549257231 0.72322393152589625753;0.21552455136000975289 0.64502115647815472244 0.49927008760672808574 1.7040881215725400821 1.5754799938762673595 -1.7176517874597818647;0.65162815551338482134 0.26873046382096027473 -0.7038363405677907636 1.5911370122861092646 -0.81442715337024040867 -1.4692283570347171029;1.5062724875342266007 -0.92900613928788389195 -0.22821233431076337617 -0.91590599592493937564 2.3159657364556989201 2.6305580258432228469;1.179181495199191243 0.95140914603656168147 3.688178620656113349 -1.7574411636634550415 0.65679688757223053663 -0.82236090016951701731;0.05804194502317613219 0.013339772031816387807 0.55064251500897154479 -0.15519950624114783877 0.083329207980749359086 -2.6981631597800119771;-2.3416378523163285941 -0.6053300451624685774 0.96059146079506352311 -0.088462129935544669967 3.1858526974434999701 -1.538967321259503418;-0.11018163986582876768 2.3844190830441167606 0.85565087903536363179 -0.90951577993896226548 -2.0954818909837427121 1.8935291982663007282;-0.3948119320999953219 -0.55999411302552526415 2.9890195096294021049 0.094194588833335465838 2.5636014546690288896 0.72312352006276758853;0.3366152199625976893 -0.034742101854270346362 0.070784895854573301466 -2.1119424155716997049 -0.74731294513341528507 0.59410869928397802564;2.3728658597918448336 -0.72959919385732618924 0.2523564961471853052 1.216037416557222528 -1.5243695835180897102 -0.7563557043207893571;0.43052111281292831935 -0.098195226402911214847 -2.4558238030193959567 -0.32119571098331078929 -3.6511801553495599748 0.72673380933148268301;1.6365150635601517504 0.44292363133183859647 -3.1087072138437483737 0.22508570170580616265 4.0659127033547726171 -0.098714060324157679172;1.3778402314091802161 0.57980714865491744803 -4.0025353864211483668 -0.12408496410477613814 2.3667144093222400869 -0.091340853299338484184;0.30471967099012076119 0.21013396953100202391 0.145693765052318569 -1.5938041321532081529 -3.495278185424825601 1.4215779712157392556;1.0231361111798962238 0.24981651503106203083 -0.29639659368294485331 -0.87726918318168767286 -4.2197759583234022429 2.1125196620660022795;-1.2319606926067518948 -0.2044730582151480236 0.35570824686638069512 1.2151147791482574956 6.1159017282265413229 -2.1274393026812972174;-0.887652291181393438 -0.092674461452215556312 -2.4721859122303118106 -1.0084115760306269216 -0.60333345900600121592 -0.81419979333675085442;-0.90102706256285813868 1.2278980537701553732 0.24039794820396825914 0.034563227976997915047 1.4476366850670732145 3.6398492654583902706;1.3320980066818304266 1.3037291377255271208 -1.8100990542994308541 2.6559633312445760644 -1.2910355257113506067 -1.1975600195024098671;0.75408995841443671182 -0.52136532256287748677 -0.75111567832797354605 -3.0128188824920152378 -2.2479445318305142365 -2.1107054570453267495;-0.85215198579316653316 -1.222713874105502363 1.7838783856228284108 0.44538231904137565165 -0.17723587797644166364 0.13892082303963726453;-2.9881074829098488443 -0.65828813411545916701 0.58766876768428899513 0.74830118803561396224 -0.20241249771665756341 1.5631034560038541414];

% Layer 2
b2 = 0.065769849734460261725;
LW2_1 = [2.5531884199375709521 -0.32073863627688714573 1.3115400224126532169 0.83341339554319848748 0.51423247975691299683 0.91293088783903630912 0.83006199158054339016 2.6763211997904892137 0.61237889552830415685 1.3541494316788826868 -0.23405785607883694555 -0.090644291538965707233 -1.6041204454413764413 0.90984783177175376778 -1.6249197706204654423 0.68703537493973321215 1.0486504779442371582 -2.718357746838119926 0.4074595926730336104 -1.6829199727385113494 0.41660395325508736697 0.14295270929041314911 -0.63128168530244499479 0.44383854429893943028 -0.33552056938799318386 0.85038284746052728025 -4.1789673673599017079 0.85572025409004726093 -1.6842096879854489 1.2018444618144503711 -1.265144726946842324 2.233423433844241579 -2.0494996734438202246 -1.5172680678169283564 0.95183332999911907102 0.84485759570147034303 0.37103450201160020905 1.1384376510115352676 -1.3577525235020779792 0.79197019623668618582];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
