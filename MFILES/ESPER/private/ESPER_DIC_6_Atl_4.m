function [Y,Xf,Af] = ESPER_DIC_6_Atl_4(X,~,~)
%ESPER_DIC_6_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:12.
% 
% [Y] = ESPER_DIC_6_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8072523322226268228;-3.2151973653698662226;-1.1470047987328924055;2.1037869607950292483;-1.3465689869801040768;2.2354357557809620971;1.6519807533012651479;1.020011754119229952;-1.1528803843279098462;0.73519751192209792379;0.83170133775535526333;0.1824752489765794905;1.1732462716795988289;0.34329525616809591915;-1.5395317582734917572;1.1271032138336838369;-1.7445390329594143708;-0.034636626969681796884;0.82884888011860147206;-1.337177605844388717;0.81166045350683690973;-1.1507009790612747757;2.3018230168827500393;1.1065728271719754705;0.30191354329129288514;3.2787105276881089999;-2.0115680491648744166;-0.57015534946297685703;-1.1496352121503141674;-1.1080299461500826563];
IW1_1 = [-2.5129729169469947614 0.27623539645360906114 -0.57925879434933591483 1.8970999923577318569 -1.4816045246929578916 0.96954123011351078798 1.4749210146342326411;0.60383858631352560487 -1.5939066973657849413 2.0942208375157087552 -0.27014218891809949064 -3.615867334221303242 -0.59923520076187386518 -1.4161429474958493469;0.36720328716145755887 1.0432425741146853504 0.021929028513727740618 -0.80331585709144504026 -2.0618613393754978702 -0.63554083292582919107 -0.71082698528229282253;-0.98515656804033346905 -0.29208679404439402694 0.46064347445970327266 -0.68664530815535185226 1.5507483692317343138 -0.7658879497910744405 -1.0018205774569868272;0.16302373447338558421 -0.81196693891733051629 -1.4551596295770248268 -0.49341389106160699063 1.2380716141525358598 1.5922681751719378607 0.83357800667698456198;-0.85600960739916798214 1.1241446477306504814 -0.51311461832348626011 1.9163153837445292549 -2.0317211643275321364 -1.2972341138212979406 2.0351077267175701202;-0.50467733677893578115 -0.26726837188420898839 -0.083741546046788142843 -1.2963418113583071722 -3.2014349916921993611 -1.7912528538844019188 -0.82171838735627378281;-1.1245346070574284703 -1.0645255505596229462 -2.090242588011678837 -0.25283347516970733349 3.0153990106531778359 -2.2430495272133854634 0.34955128949153663198;-0.20644273634027296427 1.1633169322538017276 0.71343587027332833195 0.91326838019776868105 -0.13585177521376173848 -1.4812878508434919045 1.989884837452603028;-0.41227032162291327166 -0.42730508319765259095 -0.34105903311376845055 -1.1909037569388198907 -2.9981894850731243274 -0.24370043287500392504 -0.73478308337559461449;0.3613483209229896298 -0.73862645740324872623 -0.65770138852060777701 1.4684458233887571765 -0.77730350287681537758 -2.0238286653254635716 -1.5247896486259151505;0.55882787888160279088 0.79948324160047079534 -0.27300868867536060014 0.50537575314495142287 2.4707064412972266076 0.44412860086300892659 -1.4940113736430562508;-0.43438120504925903376 1.9995919513571822623 0.64593592254889864446 -0.012900551754704751503 -1.9395395644000064106 0.083830001479023752431 0.31096698989553672732;-0.15142618333363444538 0.40425369679652806143 0.4943110528489544353 0.49631320672231188373 -0.9412512453216486108 -1.1769423784513843856 1.0317623510216689109;-2.6182085359751670062 -0.47181582941556970967 -0.63210957440973825072 0.70752516117304353749 -2.3187070734273191874 0.80736038007092969515 -0.97053450688204145891;0.027834768285575225977 0.47605034643299776187 -0.99485053703084291854 0.72044681072544070055 -0.043873353535772999234 -0.0097181246888997999123 0.11826274220841324902;-0.41084082251232978411 -0.033026742282456333921 -1.3795149125491616982 -0.27651001509031020165 2.2070777199399529422 -0.68268176899658072898 0.071147897721567571194;0.98248441778931905333 -0.16049242005511518694 -1.1687445483160550097 0.22409414207877223491 -1.9536102268872437282 -2.8275068015514985831 0.17453600731640692145;-0.68453373595319810807 -0.37417453723532073662 -1.6094281287355949317 -0.30408168391231060745 -0.90468985879812602313 0.088292154206697739949 0.52118331085030467076;-1.540277840753866645 1.9411534463075845736 -0.50750457631391343583 -0.39756272171736872778 0.62420802987351231561 0.11723415911415607793 -0.220797867967323036;0.13180714869231430209 -0.14407851871956520173 -0.52075634020538541513 -1.470614375651508654 -1.2755818166552832515 -0.4698620175891518036 0.49396558920151867333;0.20298999366798065047 -0.25328477382736491741 1.3378707812170880231 0.23900503563304986709 0.23860638900470579338 -1.6304451598608378227 -0.75182730516419127298;0.40318178964519402196 -0.26471474192535482395 -1.0105216549235676027 2.255365747569885837 -0.7373872500205881364 -0.35387540420328167379 -1.0606907705501400496;0.29346749159665591611 0.32615075449670188901 1.4562298761884038267 -0.71820175236669481222 0.15724236828147272749 0.30898203278633523672 -0.36974351871243221757;0.010501663773468311591 -0.28571960726510492456 0.075429136892716269758 0.38982456638010021255 1.1273643226221132796 -0.61915070523295689942 0.18242243412778025302;0.77568512809334511093 0.55841091822804267419 0.81735180348444702592 1.5152953876447354808 -1.6671641297940946735 1.1891374256420916833 0.37891458325424376419;-1.1643703045682145536 1.3389719609144461465 1.9273681826297202058 1.2766906674081677231 -0.13776684101016212214 0.36625847266669014912 1.0857522953341940397;0.047721633889593897959 0.20602428860670859989 0.62562047986068936023 -1.0146997256814072053 -1.0973555606341884872 2.2371059220777222976 0.52508057296487165022;-0.4564103017022747566 2.0732445713796421316 3.7941443231776252887 0.75456353543158960484 -1.204888378916825209 1.7242053454618253561 -0.79213039453764966247;-1.0589889493292001799 -0.90261921182010262932 1.2027596718228561468 -0.33886554499152093944 1.6111607230537898783 1.6832389057935237542 0.80429178256089983723];

% Layer 2
b2 = [0.58516473666131341158;1.0033792044987621672;-1.2305865360460719327;0.70012084137905561398;0.53461687329336027297;-0.45012890303677960402;0.42445134527627342846;1.1019548704969568398;2.2709753884705801141;1.6785150348489963346];
LW2_1 = [0.1155041566851297552 -0.37813537129840613105 0.010594458873274120725 -0.59192472719041555607 0.14663477788504167276 -0.19522680869510708468 0.35953657275740236177 1.2982929057672449868 -0.25799450727659389848 -0.87662872368400523992 0.010761881009114886848 0.56559520006976438111 0.17477066231502561 0.4408320689028230599 0.81622458940575981501 -0.25027155400504974558 0.70048441470696298783 -0.018441915531036058573 -0.28985864302784325464 -0.23642798718937335645 -0.34225502438866767241 0.3366425494534863172 0.15105754736693047247 0.039661808657441767478 -1.6387909596706717874 -0.75787497535408798743 -0.095001309255828586542 -0.31787028482851492628 -0.045134384760693833927 0.32392999973932501412;-1.9435327895169660639 -0.29456737361850765522 -1.4377533102570121404 -0.12514653870750155895 0.10383507887132741032 0.40780393015784049959 -0.085109468557329689964 0.70731690981574590893 -0.99019280177461743708 -0.390624872963470815 -0.47266548958113369094 -1.3087428251122632528 -0.7836310975463531836 2.049654914256829219 -0.62439079974776456883 -0.64345753311261577601 1.2077713788664548034 -1.0218708057100172049 0.97971537279781273355 -0.13740725321428604033 -0.16956709745340189932 -1.2877181302186393452 1.8148008836798441568 0.1552159503550709363 2.1150926715759510444 1.5621497236423511623 -0.80858659625279749594 1.2123641072044102351 0.97562743107366145523 -0.2708093985326801012;0.3650776361812078652 -0.45988502066966857607 -0.74969067768038621935 0.22846625084220875679 0.47650575677928508345 -0.20728396892757411374 0.49845931368474766243 0.12319631305978206992 -0.18044383620211898456 0.019571227828906193752 0.48551814412253901931 0.75215582611566167426 -0.58243063835041564147 -0.27501515066494969242 1.3052073416887441937 0.18141923687596930859 -1.2292349546980045893 -0.029298903481312848357 1.4195743270253866619 0.42668009555170088865 0.5047447670245273077 0.85555298133416901596 -0.39931838760559212886 0.43116761911609347013 0.82435949057303392618 0.0082067341295309296362 -0.011143522992850535616 0.36239479851493527907 0.89333147530654022361 0.09495712110561961572;0.33366342769843371219 1.1766577305083492089 -0.80390387917806138685 0.16393267192208615946 -0.3391060122889805184 -0.31442085243604561695 -0.50811415921081881653 0.94126495227021655943 -0.41691414896454515038 0.86896058896600725241 -0.55049520561723774836 0.73822016369170895267 0.49375517237975147244 0.58293197794287032742 0.20434709695530131612 0.1809693781850887917 0.42942798066414011871 0.60442287872190603171 -0.27169111100671561321 -0.91226979746662739679 0.4480962498538104688 -0.24362314794250367056 -0.13678042600544143559 -0.49165931895649711558 0.018351535621144950128 0.59221791819352953556 0.1913959548775766295 -1.1249473794608342292 0.69899311425286636545 0.015335147795006364921;-0.51672676485063184781 0.51743705225918279478 0.76534016947248728613 0.5091240705701434166 -0.82797093088036588515 0.1995233333576016399 -0.45808001798002739857 -0.57217807748127236245 0.27565225824763517348 0.1852607411056554354 -0.72354103956813609067 -0.81479060852115259284 0.54742202902109959872 -0.2956093801482543304 -0.97833104435204931715 0.47242275828152568984 -0.024118447719797708739 -0.22624224444840901338 -0.82197945684709028402 -0.94236315962427286141 -0.155616369203438909 -0.82283238029208505271 0.51142766270319173216 -0.75870010435760248946 0.55688129764549987311 -0.025169134192146152412 0.37443696375230722806 0.28317550763538351655 -0.80004179589569912601 -0.30911783563074224368;-0.1883768749381276586 -0.46127846473884109857 0.10267443379485739763 -0.95973136764692934531 0.005147573157021109562 -0.20497534963759611593 0.96195998112562297599 -0.53431938552103586115 -1.1712635101114741154 -0.62739511114802881675 0.81525006549699208236 -0.2527429588003841654 2.4172390640117797922 0.093004999801448676178 0.76024122541761585126 -0.30212472066664264325 1.299943661297795261 -1.1077866393009030421 -0.28965342374529867708 -0.39656930388908739893 -1.3646110381859917204 0.022824655478149987603 0.36024530772463336792 0.14545540994506656052 1.3226345897640725546 -0.39354948562224578712 -0.13586741342991284776 -0.14044943829136027902 -0.83085757466655318915 0.58846128321821300489;0.15351094951450686144 -1.1526244879752027828 0.008986099932721307304 -1.3285056649266431261 1.1944656729799887351 -0.51261467859788723 0.40805147484251136358 1.0898695060699712389 -0.45137821137079453537 -0.62374119806748462569 -0.34337661341263070458 1.3464008664120032943 0.48194542552502089849 1.2479539853770003077 2.2947868976079348613 -0.85885109404252180099 0.91652099768366868116 -0.20539042839916085703 -0.3961031047697647911 -0.6344271748029818303 -0.15442280098025029655 1.4820587849381918755 0.80925127754919334855 -0.12163095731138282019 0.29325515273127222837 -0.8391019751484865008 0.057289281267670008613 -0.085438101272332922509 -0.70675753227168991444 0.4873631413107877286;-0.042190882124468136183 -2.2372487180078612923 0.5789397849815028918 0.096553626779365547828 0.0062208953377159911802 0.00084122267036437292989 -0.74340978266976187605 1.1000864747755796369 -0.17850683596048108615 -1.0951663595528708939 0.26021364789906237247 -0.30978685634515079617 0.22660679322650412182 -0.52380678658525403613 2.5523900896317432974 0.15706579604984163834 -0.7929287370272447566 -0.011976719335438677089 -0.70450229130200181515 0.51004860608249835696 0.907154608745728952 -0.65318848297604881203 0.33996995450019612539 -0.42135007359003334715 -2.3897979485485856266 -1.0717542124710031093 -0.096502389870534999172 0.33701645151895387453 -1.0795806635993618894 -0.18498325450046201879;0.050973833478671549957 0.12058102910567398969 0.72330624941672638784 0.13543934173834557 -0.71277642109312921992 -0.36157515994063593734 1.3215965173477102201 -1.5623788619483813811 0.10370757233850333434 -1.2129312637432236865 -0.59312907017963845124 0.71799374161729456745 -0.79689175385371169291 0.69836341029264914493 -0.26595850011153510106 -0.87554573778909283721 2.1006265008018325524 0.11307345462517155721 -0.097223462840135610463 0.33778748151627507879 -1.6033881019366054144 -0.026539914948540674344 0.20042738024443695899 0.54133137991226432106 0.25541994297888537258 -0.64523454544281466649 -0.41302593078617788613 0.55275741447445092547 0.77066742917465658191 0.52244730720439369609;0.50500000173274428583 -0.6119369720519056699 0.81926104210713035503 -0.19199191604529086685 1.0615696729943291388 -1.1519172540376840796 -0.57768337107805578512 0.093166703642599324464 -0.18411038730566881005 2.7132951102519498043 -0.1717016482871110139 0.19980500291556133052 -0.93274825226642443798 1.2504448553753912954 0.058023753240639054651 0.92696613816852579948 0.089550963158613203219 1.3108938380021815107 -0.62523339282518908266 0.97590851480074358726 1.1153712619191855637 -0.79599865311943052149 0.65125314516067922543 1.0123891047733331039 -0.56767796608063714192 1.6296612629767173175 0.68791241258207758147 0.53166413314101179655 0.99068827062875430833 0.65536798616432245801];

% Layer 3
b3 = -1.4239636058023219523;
LW3_2 = [-0.71544663127126173485 1.7212210210627398865 -0.28496636404866187986 0.65614501075906161986 -0.2882767238777564911 0.094001532287737499249 0.22874610798549574464 0.24484290612455189562 0.24044592781012938398 -0.044100789325953126951];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
