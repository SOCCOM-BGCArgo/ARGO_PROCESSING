function [Y,Xf,Af] = ESPER_silicate_15_Other_4(X,~,~)
%ESPER_SILICATE_15_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_15_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9023927354686789304;-0.15104860861675284411;-0.76613300183010568656;2.3288863621269948467;-1.2927693359878513757;-2.5060500822293430012;2.7378966964995576916;1.9174305667185989055;-1.8098883860877963414;-1.438791413230572358;4.0168165560517978818;0.8698549768655420289;0.2564411969694682103;-0.70713709326909612862;1.1218396742549165968;0.25753789852337460875;0.014503650015411559057;6.2388000085453132471;4.1511244331526766516;-0.13771166591375583188;1.3911844340668906295;0.72506926506531710341;0.039543467999025666559;-0.38097925711982760788;-2.1733784996981699855;5.034998239835773326;-1.1645024074192618091;4.2702353733391404944;-0.710681102713371593;0.61475490427447121444];
IW1_1 = [0.17260686910709771569 -0.10907631519240809648 -1.7540512887475234738 -0.7609504347921055567 0.64517697273467500274 -0.25689116250943322406;0.070425663748219291538 0.1824778604911017621 0.58281728847777058977 0.24881605313260687917 0.19675808367603819793 -1.2354236705667105412;-0.81716902797652590795 -0.026411852096135005757 -0.27859973375849994559 -0.58682534439203926091 -6.0085325409404770625 -1.1711789181074911959;1.2753600170653220935 0.18298943857911287303 -4.3738846207910357933 -1.5418414611453978846 1.5620200002573707554 -2.8676683873998514152;0.22351493299585847851 0.75083793007499444183 1.1472528728350031013 -0.17723927501736985723 -11.387008304726000674 -0.0037462292883151220024;2.1827557989053865128 6.8247899584949944796 -4.024850199062231404 0.27076956672604235443 8.7985013231993143279 -8.8979900743677831088;5.4379756356347712654 5.1640551439368236331 -5.8839729321452649558 1.5360659555233253659 1.714544161258422017 -3.6494864245129390312;-0.26606170702822912189 -0.23911981348539071424 2.5170874910202609698 -0.93968529746502837963 -46.453048130532103244 -3.9697066719926556999;2.2095594186084506205 -1.1857643676358509133 3.0811837924629466023 -0.60570727572975702202 -2.1465995534958253188 0.65883656686896951982;0.60031446328511772759 0.050227060669584780439 1.6649640147296360659 -0.81117541823970551462 -0.83983699135590950124 2.175885759353597404;-0.61498888996742262503 -0.14975183140859252284 7.1362266415315200874 -1.079721890112593341 -1.6395813806318921824 0.29658920664692045577;-0.18319589006464467862 -0.099370658512815498997 0.057086790415963720169 0.81871377769269526592 0.46831066027291473608 0.87518182657925047696;0.021186826061088823853 -0.53787868209534916986 0.35425578781523114902 0.61355768300030677498 -0.91724382481637412035 -0.092753860640921295677;0.053985930486970326592 0.30342409946512194363 -0.61266436147624037112 -0.15131511567815433827 0.17051500241468720009 0.33260690937892722907;-0.19083942881976861949 0.031631655017238656524 0.56405916693227975411 0.68818554806773424293 0.92309682802534409607 0.6089416707044719157;-0.239609886818927309 -0.43231086915189192998 2.6804888652636447155 -1.2380805575755096104 -2.1842081322684858691 1.5376698941835313938;0.046828653742226035439 -0.096547269035561794626 -1.3827368714352690215 -0.2164938790706335825 -1.5510482890489478702 1.6181405872971681426;-14.130974128647844523 -9.3702577345327089375 17.431980002743149072 0.61199908897126431562 1.3767445976372008065 -0.40270734403082864006;0.71701899958389203604 1.7801434601210988085 -0.0066865832603121323763 3.8276942488559875244 0.10565176213714018438 0.69425381648599204798;1.2222563034511386704 1.4768504542854992145 3.4233237038552997156 1.1195720868790546287 0.12981382552605993941 -1.1719443174570285393;-1.1333087434602280297 0.52081362727996283191 -0.39622359818557634226 0.12299969083644932133 4.9816730391138381862 0.70010818398232110837;0.088571323497268636404 -0.15739953767791431405 -0.42320508641647847092 1.0610148470703530954 -3.2595631223441756674 -0.1124622988761719844;-0.11024823997280708276 0.34730514441060672537 -0.80903319520995820024 -0.52081665355835238262 -0.46630618477170232561 -0.45806085260393303304;-0.10034297853702803249 -0.68231737602150654975 -1.5685410533973034308 0.41972301353927676804 10.525106051784097971 -1.0772620313087319932;-1.8680366392078269211 -0.2104451772940898191 -0.56326274417965527253 1.8584478290019768032 -7.037263535345508636 -2.7280432711869964102;-3.6277784734804181532 0.70283704578198480384 -8.2739956911611862722 -2.292968961854739085 11.69547148559100691 -2.4448569948850642497;-0.032133473939459117341 0.31864143524306537403 0.50545550853559362281 -0.85695185915031424351 -5.2976998626489733013 0.1931005267921029056;-0.63321106056534970374 -0.17255382919643880157 7.347718842268728956 -1.1733045116249309903 -2.0155227987447665861 -0.22354200896916287533;0.0056745538277203945443 0.073995122286850581461 0.25013421659685664 -0.76986133557826263996 4.4605320048268648492 -0.33170418785125421746;-0.018081569002133136143 -0.29722190768202261246 0.40295076733686308046 0.83761959997372836817 -1.2894890430659062819 -0.28346502026393527451];

% Layer 2
b2 = [-3.4339574729399977571;8.1753100820023760775;-6.3870671478722105263;0.16582933745619407584;3.197957254840313901;-4.5949515319282063786;54.306013685705792682;35.94879969006615994;13.828814097255540005;23.48296989782277322];
LW2_1 = [15.925420456937839475 -15.405225894559531952 -8.3157087825641404777 2.634814431553176739 1.0144530590823568339 0.81928613998327370904 -0.43037976752848933204 -6.518565987209116841 6.563047851565468882 1.628957626959463445 24.438884475764179882 29.404207770771510155 9.8520216931350876877 -36.290665741054539239 -23.734563714450313654 -6.0458465881260599062 -8.7733186738909871849 0.36945392832177986753 3.7369675852006549732 2.0754904565407770178 -15.077943746207964182 0.96437802319130139228 31.570862405215013524 0.14560675300997147352 -10.166469955154806115 4.3542084919467862747 5.4800147867289084047 -13.08483915483247273 3.6830086893579760954 1.0126433923363018508;4.0882492475985028335 -2.387752129817905189 3.7967397088740049149 1.9553426526598902679 -0.086074267013821648131 -0.337571799682787832 0.87323379758216301827 0.32866596209933301997 -3.0965210077388651833 1.1055757459235451279 17.505117816778263062 1.4692197925359573585 -17.082767694597670527 0.7143793926606115674 -7.4162284507962183966 -1.0283305646317635329 -0.74010415234562754172 -0.86530750264139744132 0.81098787017757389961 -3.2859785053180159409 2.3942916348502785162 3.2446259523933940194 -14.70906348341259573 2.7837127194972834943 -0.11052812068641119925 1.1593998914872964967 2.4021568048387873517 -15.648643944186531485 12.4527023278947091 18.50383676110860165;2.8804460789802561749 1.8942398393399568768 -0.93899041588470721909 0.50758110476360940311 0.30114725045820167626 0.12800953628471678503 0.14438443956305843652 -0.094398828383027280631 0.20030910327059983644 0.81566477184497510056 -6.186184621346373369 4.2675227137523510379 -2.046566396253904685 -8.5931455068020436983 0.9948263963324422976 1.130717373904318368 0.70023552169829117453 -0.08491280480999735536 0.44858713793933735481 -1.1661488912777173699 0.14773102243221392094 2.5404844010623119921 1.3168970107658244384 -1.2042464054311199373 -0.92425068436662005666 -0.091213657852888069266 0.53762144555678137436 4.0269164840956985785 2.7155246618512789425 -0.69858907522438751236;-0.90178682927444797635 -7.7345937348570172887 0.15778328063158630901 -0.2657826089192668606 0.42153040296939187082 0.23311830671635441758 -0.086604553571049652794 -0.12520889237927884663 0.42142687019389313274 -0.84321800122170054159 -3.9067543438575516035 -2.9371877601867630858 0.031701202856719179479 9.6096496963457038731 -0.29543254353539649681 0.70124925161731010981 -3.3871825930914423175 0.077599358149889871572 0.29285662008285284763 1.0070966294297687416 -0.72031238785751106057 -5.9386798913770117991 -0.51742520126732083341 0.53295726639410612169 0.33577448386636798983 0.30934183483753457944 -2.6436080170021409863 5.2012466330209274901 -6.186535863798127366 6.7891725478949940253;4.7723741725109372069 6.0531836485346621757 4.4335922898716262353 1.7192457423857441245 3.132233912510148155 -0.74231412354359582739 -1.7825824955093427793 4.4636471333518574767 -2.2556101635574887787 3.0483179992058300201 -0.044253947204001588267 -8.7943439879863767317 -10.920667718178552974 0.28211497293767145988 17.378366770118283569 -0.41852099536709891359 17.37728447058401926 -0.88504544125486073192 -2.4478662183819066556 0.96035428327395699899 -4.3997046434896489586 19.959416032412075737 -13.311726351713474514 -1.0408981270818360443 0.026922708590210377155 -4.996913602765313378 -5.0093622376655044803 -2.6526806677172136695 22.962215511346382613 -1.9997020905514217848;12.763369645335277625 -2.1493654315793198073 -0.57087381864723785174 0.56603470592552451723 -0.74204388026748102636 -0.40020314229087744495 0.028628759192454816124 0.1900533110322932262 -0.85256426000482887773 -0.67935609399110696849 -1.3185971690745628138 -15.393041966164235035 -16.355008498163730479 -1.3666523895966460334 22.058928953070253698 2.6779732155334197152 3.8287105109908194933 -0.44662809617294024767 -0.90020037409328934608 -0.88155254079857736649 0.87977712028593435534 5.4702860330393630051 -9.1811733758338469613 -0.28535372091720645482 -0.090135121443679494524 0.35823993983571450483 0.3280875186465189719 0.80462478768138390173 0.58161624306057024825 13.706926359336964794;-45.152559386031107636 36.766008549087658253 -22.379920486561694304 -15.399984689919655523 17.971090711632722758 -10.756537913258499728 -11.971244064167924748 1.4922836558025509568 21.985403202676792489 -14.360192283906751953 -37.617807184211116578 -4.6050896657703841441 38.078789019372372593 90.284517254882047155 -16.699847374746120465 5.6500284553243975694 35.079400117507461232 -4.0838492117080358312 12.15105539169407578 13.743119393149747509 12.118087412840710115 -17.544333062362920117 -2.0973672294114571457 2.8021942327618454271 -28.821502352092512211 -23.628771861409521904 7.1406055587282626362 29.100244688088892531 21.368716829722082196 -9.6014826241931512385;-35.113895608337863052 -22.340783199587612273 26.510804986501145919 -2.580485502477367632 30.131064182732213652 36.977309913025059984 -64.958220341274085285 29.819765810568522824 19.018438972323693292 -8.9663199217044944334 -91.479748130602615674 9.5002948998740439635 -1.1828239137550193849 -17.294070272508612618 -6.8653712475743651211 -62.779861325757167378 -18.383883827433983527 -33.323914563559597468 10.291873892997745799 -1.149243350892795279 22.607741421781430091 -37.033718064776273593 43.62210941992155 -27.804719259899858486 13.546355765493808931 13.654894901456936296 -5.7723285697376507386 26.121846222233671142 59.951941082184383447 -88.475447168631816908;-3.8201835934604653211 6.21905338570583055 0.99599943069474106139 0.0069235391407091867455 -2.0794673834075974028 -0.091015328141188039934 0.066686485883327095703 -1.5717849420913296843 0.44256669025775208226 0.52279406375319859013 12.062697209273091303 12.048994256961481852 -1.1081316151369220435 1.7905756091529012597 -16.474270872102369623 0.5088378063835397036 2.101251396591601317 -0.093420245884527255975 -0.32223909147990842383 -0.13854583326877509264 0.58756854607281117087 6.3497673192396861808 -1.606875401753526944 0.65259022015613277201 0.041248043916545670817 0.12730868881822396399 6.29501084396386279 -11.412856688896331647 9.5012649135721556348 1.9859075096148934847;-8.0544610151535334097 -12.792811443513672387 -1.4618702393177949173 -2.9499318623043615517 -7.4535543739571101796 -2.958856862214082728 0.23197191092202684715 -9.1752918580617173205 -1.391934372587442903 0.98705817612512725123 7.8822571828009602157 4.4676525463099165947 9.681330221396713398 41.256438081933850981 -9.0106941534395410542 -4.1762196820804113884 -13.673686933377400265 -1.6433421340261848975 -0.0089814548469631036443 1.2924854752194405716 1.4208608866331162712 11.371698919169931585 1.6371503296443208342 0.78275715680816559949 -0.61956509682156202246 -0.3082431808759653058 12.009047147237790654 3.5791304867471089857 11.426502266490356163 2.7865125088993041302];

% Layer 3
b3 = 12.965945443119277769;
LW3_2 = [-0.020290600593761119047 0.029902660312608131399 0.42069768128836393384 0.24200673952636989061 0.071911905458582489614 0.20795063468385022176 0.0095779249885622023963 -0.004627484795021434387 -13.018511686008631401 0.020781287895596918525];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
