function [Y,Xf,Af] = ESPER_oxygen_8_Other_4(X,~,~)
%ESPER_OXYGEN_8_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:46.
% 
% [Y] = ESPER_oxygen_8_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [9.8905370186180849856;-0.053763086744656636562;-5.9091217243381315427;1.2896173233472425501;-1.881247527703619582;2.1839724732568015497;3.1535325413911157177;0.97988593613083152523;-0.075586162845220017381;-2.5081285627992100373;-1.3976366481663844432;0.25844194175827034377;-3.1131046153485586458;-3.4269929586541740818;-0.88346112105474317033;-1.415885041712879211;1.1047605667287263564;2.2025209585267022661;0.032436569202490099506;0.51499999021412357081;0.70811971012523911018;-15.302790935004916051;50.515825653284984753;3.4120123256595111805;0.75801715519443324531;1.9037536012082074688;1.3506177969605459577;-0.28238697970505893808;0.13348589420812531636;5.0824817609782702021];
IW1_1 = [-1.4482744332966150935 0.11129190376699911458 0.77961960427911625171 4.3747774069160385579 0.08392213168489016939 4.0498125150749109125;0.30957415610986427357 0.15795139722294901374 -1.5125883624846931941 -1.3365101666925582879 3.3669964960168123902 -0.90390715947883948367;0.93020907592051726986 -5.688166168897802244 -5.3097446111788242362 1.677788934350990635 0.51408760033594025352 1.848238340324853457;1.9056932936833346215 1.3173434914569261966 -2.7728086306998203092 0.34882813898345632619 -8.3426072644543580736 6.5530702202763775333;0.04962903251493717971 -0.58489413016398061895 -0.055091351035305997919 -0.65653986859680024679 4.811452726282077208 -2.8027020345077957586;-0.66451965107236943275 -1.0708881645945513839 -3.3993210523538452961 0.037025546194206525319 -4.7028722976690877644 3.5762371943644866157;-0.2238687088798407554 -1.0419855998370890493 0.79828263077992422936 -0.05231511130807967036 -8.7207114867453867646 5.4258493843867379169;-2.2383857942855205359 -0.88917429688436544488 5.1918841653843310624 -1.1644870462217919993 -3.5828462148217927741 0.098692844782557589967;-0.16727463647751333875 -0.15159888286891792797 -1.2304396550336866856 -0.10162056209030476128 -4.8777684307479605152 -0.30190114630082881542;-0.096945898969501356768 -0.37110206394213479664 1.9510684510504769928 -0.64282701758596061392 -3.9720752417659035416 -2.1578022165004888677;0.46749136228882887112 -0.50190159073309170701 1.0132724043516572188 -0.3749733624978225377 0.10855340622497144931 0.24556440736216370024;0.44697804908887117659 -0.27802162083671749793 -0.82625900088766268681 -1.8149307042202433848 -9.7967461194291445281 5.7242023733739282321;-0.59843944805386362074 -0.081940245279208165363 1.4469065731301113953 1.3258400984277189938 -3.4109864022992630872 -2.9085421602040240074;0.16258076482089772741 -0.0086333925255347911815 -0.15157001775728315418 -0.12494380608319891057 -0.78232594297448709852 -3.2452144066266690459;0.50518756982424140034 0.33969425727071567156 0.061824006827145047693 -0.27678741981702614794 2.1279919509986284787 -1.7162739388094265802;0.11547974087782221508 0.17549063947217097281 -1.540859190550972091 0.09785970418601443177 1.610900894592715904 -2.0028574868262469799;-0.47757099835455746328 -0.66257850222138570118 0.66654341482227408289 0.040953503724739041825 -0.26077095618943307853 2.8055545033447559788;-1.8179047517713604609 -2.5980251908079612377 1.0801815160642012081 0.010361201038146267833 -5.5294548210397191923 -0.088334874721424844202;-0.20458367352999629052 0.34519243487701140038 -1.5068929769265368979 0.66288879130790456795 0.93293674764250711373 -0.46807672719904941383;0.22115537684512634464 -0.73934900099942824081 1.2944073346427742432 -0.91876590559987147966 -5.3703417482805893002 1.5224462766493904731;0.25157807856837755001 -0.10085919729578707305 1.4404499702103550351 1.0040408796546114178 4.203619919890964951 1.1073523979326318489;2.4929978526613472134 0.17322566345646339681 7.6288934108434673931 -11.678624864864870503 5.5831599128002071808 -2.9684415748638417476;0.11764844009747123244 -0.028326745412469666457 0.58234081679584326352 48.917237196428246193 1.6049149076582907014 0.15331021072202455358;-1.6376725466674941778 -0.64710054190117216599 0.7333830421133232802 1.7437290768089379611 -7.7052731450271485514 5.4202207119256833323;-0.15722459089265028442 0.36615850336829947054 2.7163348335770156616 0.29625574095082374271 1.1733686698758178935 0.82325601803526893274;0.93579667266957122784 -0.70971310161932787963 -0.38009700793838674393 -0.59179920847338352008 0.60583284472770737583 1.5972865314658424296;0.8132677851342066111 -0.66494586836693625465 -0.41162028691493890431 -0.59961614664575024758 0.17747837221950901743 1.0373072648385657235;0.17217818398752565701 -1.3812604305745361799 -2.6046625696668814776 1.3060950558458885862 -4.026032721961073868 3.7162770135163136764;-1.7707986567078619622 -1.432590854435880523 -2.8389468240250934628 0.89584807005705724414 -0.76182274439186203896 3.7811003913120195818;1.369212688704134262 -3.3918930559903288646 1.0874585422541180879 0.16152817131467794853 -14.715952877856032899 2.8821820004504949964];

% Layer 2
b2 = [4.0710272121503194853;-1.7849483234073737492;-4.1088702289535961043;14.15128056361656661;3.8996284520355315451;21.033857965117107369;15.557414811490199114;3.7124116984390607143;10.564025014959637971;-14.230850689711862955];
LW2_1 = [4.5487439008077430458 0.89161886008002433357 -1.5133657392888457682 -0.39477814802906513458 -1.5754925451781198742 -0.46793636787171938307 -1.697057585499629706 -1.8253992187046903517 -0.35090973523900320652 1.4168731906648392993 4.9154851629780127453 1.039059435231628914 1.3870724801302458662 4.9307673243935994378 -6.0146153692254076262 -2.6990696154039923726 -3.9129777357254971193 -0.98488368049913144198 5.0175128094577008397 2.007492506818207012 -0.20703351652402612881 0.61604980267640674363 0.72577131183371579315 -0.45095111106098995091 -0.96330319292635935291 11.078843483216623156 -9.0901052987194361776 0.80160198613799860112 -0.57413885868391933975 -0.76697811198529053378;1.0469788742344556809 1.4931061192693972917 1.6303255241821075217 0.36069271528472152122 1.9440025425859221997 -1.2396734352199203499 0.33677601203574220046 1.4881210083648583886 4.0799817906824538127 -2.660488250557663914 3.0683904082730326657 2.0261736165806891741 2.2996618694315436038 0.65489915630255357559 0.56048705708234447531 5.3117247117278010293 0.78644920367356996316 -1.3667802301881355476 -12.480542248039540709 -4.1780996491076454191 1.0834148874234010851 -0.63987040264932693034 4.1342516810166189956 0.49610411815202004604 0.05111998350340509617 -0.8919639003997141824 -1.5881473427931653841 -3.6815882401150847869 -0.26790740099454329881 -0.42517232181507835787;-1.4259454785527376774 -3.8981685768556824101 -0.35044100124944432828 -0.22682604776095879884 -0.40862501505147053038 0.47740700492088522511 -1.1988927654094969633 -0.70686277471586778098 -0.513213582757359843 0.32789320337921690207 -5.6377290092313243619 0.61739220826708263168 -5.0797380668017062533 0.43874269888008410323 -1.1684204456866467137 -8.5707719425337902663 -1.4582329589546130233 -1.4745627419125033608 7.7320627337572140902 3.7518665125939119065 2.9426116186993978019 1.8187336549412185249 0.66572997038785808321 -2.6538220013896491878 -1.8127579654293612954 0.1572461534583695919 0.7993394914283121766 0.61296036851494350994 -0.59005518455648309217 -0.11345943823047961729;-4.3451092329801763725 9.3125020375194988986 0.38842983931539987186 2.3031560415347995807 2.882653646521535773 1.6622181359015697488 0.39965079939078718141 -0.92675366775418555054 5.8746928729009209036 0.51609073620749057465 1.723325120611518102 0.26466463800457440403 6.8981693910467791753 1.9743852980860709945 1.8433826282549496955 -0.3287151526972095783 2.0692201489040966678 -0.80760385550736202287 -10.180448603453784884 -6.2260316790160104006 3.4349759461946574035 2.8325409331200770424 -1.2786460060920070703 -0.42695801970862734542 -1.3699104766434484493 19.794631788882256274 -24.909490049481043172 -0.70488962756181461344 -0.017926242481766434256 0.76915616931146968405;0.14852133638348391509 0.076718856830944828773 0.073884784929718214097 0.18986954394190258544 0.8807952581415710025 0.19805334158295517799 2.1562172555296763576 0.82724159370470062846 -2.5128183163441142334 -1.1114712001971838173 1.604495407744632951 -1.0668873184949554389 2.0541229626896164717 -0.86133020710934848907 -0.073445998045618257621 6.1470432615611532157 0.69918436787016335909 0.87275920295482045663 -5.4301086854661742009 -3.3285465966450193953 -3.0465740458253458556 -0.35992173009118544336 -0.78273404942479030133 1.0011510079675376428 0.98907714074381880565 -6.9799123098808371068 5.9676823482327545634 0.53302680752814934895 0.3184929207871599055 0.44664256582748973479;-0.55994567817865115167 0.76654728833942831212 -1.8879627765811757278 0.71730979964427188378 0.12432618630567036921 1.3666484956128237549 2.1228776891137224325 -1.5473863558663578655 -2.0200124840687871952 2.1369502658813677165 -6.7304495914258293254 -0.71942907697391744737 1.2093934626609330607 2.2017941652062793523 -2.9012312215893985012 2.140374003653590762 -1.8070960129644393355 1.5449634320945988541 -2.4485363907051738153 -2.4331426951870440689 -0.17966782461603650334 -1.0252111042302742838 -22.088756894852274115 -0.65131884469210044042 0.76070477722556573141 5.2641071674750623544 -5.5678438763118585086 1.5233374679023163889 1.1509029649980837551 -0.18873118394727531055;0.83880198343999068378 -0.42748424601494816599 -0.49579625927868181678 -0.076658471124908242333 1.7150664298517863671 0.52480389593182952268 0.58172157407400937323 -0.55081989943381248764 0.029971269203287746047 -1.9141525123060714186 14.002442130344784132 0.20131045738403641199 1.2685570695994752288 0.85586870123990888004 -1.0021758773193261138 -1.2194819014622495512 -1.1058164247036572636 -0.77839821981782064686 -0.031230457380598798667 -1.3623931164296796403 -0.9184821964994746013 0.21122446759508836656 0.248364210893562809 -0.75128199640929049785 1.1548306466417279648 9.0856972552498795892 -12.10050463785889896 0.80132078171173448666 0.70962158214093373765 -0.20328397979452600408;0.81868321909307795181 -3.1144721659486092058 -0.25768289201431499036 0.24676749929741539913 -1.0908856121718024657 -1.3744368880042208136 -0.71334372028212222894 0.044858871787377310736 -3.1583993836288501988 -0.069645446628858090343 -5.4156793268679468412 1.0138736537133166138 -1.4383033385926240477 5.7049464477980214028 -4.5674815756736242278 -0.56442873009378458082 -2.1672724303471690988 0.14372850919991114749 -2.365819326244569698 0.01566369848897741085 -2.1373680419466221103 -0.56749895831123575718 -5.4749992638396651756 -0.48940312828538040657 -3.4277722187210919458 1.5700034040478130226 -0.66009656244923731183 0.22123613980567657933 -0.25422467465626658045 -0.52512911265496842184;0.13949479083996238482 2.8948434248320773499 -0.67589664718859454595 -0.41396410222631424558 1.0383899279032551277 -0.64142240957514928823 -2.2282486972130444158 -2.4144877101584985013 1.1245644610190337342 2.3205263394870390137 9.6665498524008963699 1.0483352522414428609 -0.30371190302493417112 4.9743607336389894513 -17.109779885366961594 -3.7549869622323703844 -6.2638691503252044157 -0.84836586625134213779 -0.5367274364797187669 -1.4302727427280015338 1.3734197389048310445 1.6695740066573132587 2.3010925148534528972 -3.1275684185584471386 -2.2567859617566470298 19.868514339899178367 -21.294863391293965549 -0.75393028711839493727 -0.94688288540422183015 -0.4197883824384734397;6.3415907142462222268 0.71430901399274437935 0.5681550566672463054 -0.07977773487306764888 4.6338049166748609409 -0.32454113346948981755 0.31526027487747770861 0.38416662191287126449 4.7531806729394014965 -2.2814226033182496423 -0.96937223513752368564 0.79874730619013689648 -1.9205614501571020014 -7.0207262100441401032 5.3615794429216956374 -2.9708280307304844037 0.92885643190992794871 -1.2438369692834929658 3.4795370832130370076 0.81129256971553576072 4.6283567313117899289 2.1038916161663010485 3.5306732883390963273 0.78251144588566901028 2.7066798956111428609 3.0159216856469277523 -5.8911057639473822789 -0.67953046249160620196 0.78965110853621867104 0.18701040039419844496];

% Layer 3
b3 = -0.23220564801130216814;
LW3_2 = [0.30855804924261870381 0.1287030003189787164 0.29885931127986303801 0.12508756535911599861 0.40157089044257909816 0.26134957311397771784 -0.18552503171298057039 0.27731739053883391888 0.12691683507841627909 0.21598398610406818743];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
