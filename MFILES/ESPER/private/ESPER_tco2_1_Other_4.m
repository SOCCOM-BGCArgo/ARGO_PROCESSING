function [Y,Xf,Af] = ESPER_tco2_1_Other_4(X,~,~)
%ESPER_TCO2_1_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:52.
% 
% [Y] = ESPER_tco2_1_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.21092834091654611;-2.7941772066131314;-0.84582341675758355;-0.8446448005207452;-0.14122333032116011;1.7509164159409247;-0.65101432162940476;2.2648583488905611;0.010308371751252708;0.30744397290053749;-0.67592968348570925;0.84279150873940556;5.1721343186758277;-0.60421173915906545;0.044213639586740135;-4.9612345523274994;-0.37140389911411348;0.56943233190785258;2.2257331926111217;0.27318273192126374;-0.14963449330401807;0.25907001283454262;-0.53882148108176975;0.35618701259464597;1.7757541245313744;2.0477870505557969;10.585585775673515;-0.13488542945234525;-1.9220983476447038;2.5288697533479279];
IW1_1 = [-0.14430884100333152 -0.24947402846078731 -0.087250788367161963 0.15722494704484308 0.23907244408492415 -1.3494407571783658 -1.0719488983938554 -3.5527068957465748 2.6692460672157368;0.062438377650016162 -0.018000265623079933 0.97638005910607994 -0.20343541432933088 -0.67732149790130025 -1.0285765463536283 -0.60375993627407532 1.1662354670642459 -0.081099005320550019;-0.047127790069447721 0.30608205071630956 1.0112003537359486 -0.72058461833471132 -2.2089823165636533 -2.6276035651986041 -0.46307122373636378 -0.31413547525496166 -0.56531719742328368;0.05337763200715806 -0.43569650263222404 0.21772651902477066 -0.55952950494815457 -0.46215504646704325 -0.65767469453880634 -0.24689509329059775 0.1574876792916507 -0.37740905095736632;-0.020171904748734724 -0.057867919375269271 0.98855992862585096 -0.4951639749087563 0.10066550217442323 -0.77729766281549639 -0.22297042567449135 -0.043442118568792584 -0.66258454640724151;-0.23212973980227658 -2.376006390175168 -0.15610029323779515 0.46714751481115219 -5.3885151146328427 1.6877320770441213 1.0919552369370158 -0.97555277329640266 1.288395190214418;0.055465986854108064 -0.17328800705478539 0.12815812751792974 -0.26945154004149363 -0.18294373358923502 -0.34536341276282784 -0.066244362121399031 0.12251814987622769 -0.24394135694542063;-0.30224707913843818 -0.11814348268234583 -1.7025993578989498 0.23894537671271765 -4.4270942445432011 0.039838095083294688 0.98891154667283343 6.0146957911202357 -3.8405059511394768;0.010776666276928821 -0.029881261045373732 -0.12468678994243051 -0.0071380728155736204 0.099118200904654868 0.062137638186083304 0.046396581742638311 -0.10378017578140303 -0.003402112110891942;-0.014132274409769078 0.041032482212084317 0.84287341589817744 0.03037904416011853 -0.60481532253463466 -0.48535149324287807 -0.13162912695564613 0.7301159152854515 0.022041901395218319;-0.15210989518588133 -0.10408765931837451 -0.2600428579403336 1.0408402441735463 1.5305479549488703 -1.5864208472091503 -0.72381352215028127 0.8992534450106453 0.085902229994113816;0.23959417472377018 -0.008748593355416721 0.79870355827724226 -0.48981734756824985 -2.589419027884535 0.28819246754019617 -1.0245475468194658 -0.86429758509447863 1.0515245716018156;0.23187950667540999 1.4508496917866247 -1.7628475253144813 3.4231872815575581 1.0744205891066898 -3.2485766389812469 -0.63292889408817943 -0.49127014969355803 1.2145313427356026;0.12881134209646167 0.28146305815803185 0.023770311569492494 -0.080771896009698876 0.42736667247016563 0.57877961683651213 0.82913978326682036 3.7463307936417696 -3.1329568223328907;-0.02338929867467714 0.24396194710506314 -0.41786500807997728 0.43647287786474298 -0.00866680603359022 -0.12587781697514561 0.019194312869107628 0.12755183752358823 0.38260524209264873;-0.66581044738771478 -1.1771846926473002 3.1744996431399515 -0.69549175192370505 6.6561657332640758 -2.3109389162659326 -0.48025355155348098 -0.60137663877110747 -1.2758059930094305;0.022341566650533259 0.08901077428652146 -2.2787439977632684 0.024746951636258122 -0.14712660859105109 -0.89827981026084025 -0.65144154031271284 0.56788852505821308 0.15123741268455873;-1.1069000956553985 -0.04571130213972998 3.5231568326530933 -0.48233776999330696 0.4767317480237418 -2.5030006189707175 -0.89136126938159366 -3.9379904744319543 0.71896539275541937;0.13165261106992188 -0.77088724880148107 0.23146267429250833 -0.077372403944216073 1.0411429674991377 2.2750390810916121 0.24069861097020348 -0.97699864486830668 -0.18851578256090074;0.25680245589145956 -0.16139102283461715 -0.010144855467796171 -0.13546580799091881 -0.2717491243553854 -1.1586493045264306 -0.44769429662760307 0.51514171225276117 0.52454394372920643;0.0075640989058894242 -0.034195526936936733 -0.71152436811795983 0.026908925716275321 0.47085280013660802 0.44303097767114052 0.15204173568719853 -0.6179129778648994 0.027213455278651221;-0.68258769163771082 -0.37907989654901153 -3.4211569963127522 0.11408127612208771 -2.1149746725506069 1.846081608982391 0.61790299094323553 -0.73579814951257128 0.95166299539200583;-0.5044126597919445 -0.028106146664643242 -0.75579133244689001 0.71981961368982883 -0.57789116755741976 2.0863560246515283 -0.75657859659527116 1.602089606351103 1.2982727101734981;-0.29283538730740272 -0.035244866308421045 -1.2921854981757801 1.373455777121563 1.8698656943329885 -0.31544609636452264 -0.23200518286619423 2.4161644567484042 -1.2397142478510801;-0.32261414515748588 0.36939179127431804 0.9431529508899944 -0.040993337979624213 -1.0593615494066351 -1.806569563486045 -0.51410123145192876 -0.05598029953126963 -0.63910144474403718;0.51364599697111002 0.72395080985228355 -0.81787787354679853 -0.51702023795997376 0.37084427444883278 -0.022323510647980011 0.21268562611337458 0.079527266362554486 1.1105579124165998;0.22990826539996043 7.9287155012641115 -0.06729507767922252 0.099310550534553746 0.0032197833792459492 -1.2049671941920819 -0.1470215547787993 -0.28818514722657018 -0.16008139459890616;0.5888171716159466 -0.40774348397267363 -0.38005824883951328 -0.31133734012278091 -0.21479950597603148 -1.6770284248311431 -0.68687585844166443 0.83644814915626253 0.57339658306763686;-0.52380035169302952 0.22014981012495147 -1.8240102677076515 1.0010855678000103 0.46072023280497959 0.94354147697524504 2.5320160583751266 -1.9544987233847284 -2.5004331702879377;0.46765866149624991 0.050255269336243656 1.2136098563111686 -0.27391655774108858 0.73331983001391987 -1.7636116426285953 0.96024730982018625 -1.2489195305844318 0.56869026436562797];

% Layer 2
b2 = [-15.949022928295772;0.90779213573343387;8.672087872391689;-10.328235334272545;1.8593917355502014;-10.060147940513986;32.531641564302326;-0.18348454274938289;-18.13449177395124;19.434044282876446];
LW2_1 = [-0.40033848353238533 4.4421258567513338 -0.071219007313488916 -0.70812966289487855 -0.37442706080203203 0.24121768140996502 -9.7508964635414799 -1.3956817321265014 -2.8718781213322493 1.1585818906548591 2.3012352154690721 -0.03792404008253647 -0.686699851926446 -0.53111573126831479 -10.900051588393467 -0.38957546669950993 2.2547706289939256 -0.70324756783797782 -1.6641323499304568 2.0049336618307425 0.52044697071183954 -0.60436940806352912 -8.8105171411761987 -0.87600066711037161 6.8211440475277234 -0.45133891391305209 0.97652360236959124 -1.0063605260793906 -6.6527272228432066 -6.5103980202699594;-0.28505297599859286 2.1627766397376851 0.15354965349334002 -0.55046235201868265 -0.91732875866435959 0.049516087191437033 -2.825896799027797 -0.090981279850974109 9.4061521199274178 -3.0871104823767013 -0.038886323899410123 -0.024837678410791847 -0.013981196654994114 -0.20605407624495581 -2.5375430444197526 -0.005429986851851587 0.48898383322063643 -0.013551278261280325 -0.13408814439690642 1.9236207759183988 -5.6547640071232248 -0.013502086948088932 0.16958704239653322 0.0546176291034896 1.2157001974593602 -0.20258236596673815 -1.5161559864303931 -0.79093028464280046 0.067776257031748166 0.45726031678996254;1.0829441140652774 -1.5935479955012164 -0.17737648749738713 1.5691807391004928 1.3020514140599999 -0.087620438679547955 2.5408886252538849 0.034902716314052208 1.5290495834362061 -3.0664503764069506 0.33217253935399466 0.03108062789846508 0.054334036248126424 0.77791617148995962 4.6390097529103738 -0.10766157133574403 -0.8267389272043888 -0.0029771336994820555 -0.029967638211093352 -4.7128724909600761 -4.1451261970969417 -0.0059581187695993626 -0.798784209528141 -0.26305372992847825 -1.8021643028557679 0.23545329780253496 -5.5402989120175343 1.7597372329491745 -0.077857529353023425 -1.7330643609506422;-0.30568916905567345 -8.2469996438437096 -1.0478647703803032 -4.1174250593636907 3.7006685608739018 -0.19516564158219973 10.431879821131737 3.2210289049509711 -12.384105765773242 -0.4596018457172793 1.239549022037135 -4.1548020369954681 -0.67777878377649148 -1.3229960306384623 3.8288171426053994 0.36301546847614413 -2.8186200031438684 0.52042905734271605 0.10266889669354662 -5.5895921366326125 2.7726753581346872 0.51398706103175851 -0.85017726053518139 -3.6212275442717683 4.1957767708138878 -0.99104898796881968 -4.2973229724925233 4.2550497567890853 -0.94611456339036959 3.2650241217010598;-6.1136580775099159 -4.4640732567410168 -2.2294889397382001 2.7627744915601147 -8.2650120177141648 0.43956350046878928 -3.3298658491208246 -3.3866925249523931 4.6104332960524008 6.6920023397947546 -3.2501012456788825 0.69702924649788023 0.064156283165025335 0.71548478663861514 0.77468341918291306 2.5740280084787726 3.1369416259552398 0.99969512022790985 0.39151050824988265 -1.4381310751246608 -0.62097038989637876 -1.3893869457534964 -8.000801751714949 2.7251008125832965 -5.0677701480723139 -3.21062038641583 2.0836679220009402 -1.0801092553867679 2.0204959220408996 -6.8591581882634403;-1.0137763025677307 0.84114138085590717 0.75404486239339796 -4.3342793454133108 -4.2496087041676462 0.18000035755844768 -4.9404975264016482 -0.54281050585630397 7.1411742054844849 -3.8214200150026674 0.3340661826511141 0.38453573477245595 0.19597528509221726 -0.84886229316748119 -12.771303023346114 -0.23506167461891905 1.9540942723262607 -0.099398034104394933 -0.68642165055385551 7.3275486396581773 -5.7435948810654471 -0.20756755995284398 -4.2325197701952009 0.51436037121053413 4.9634878481408329 -2.1134121042749796 1.4400820561941947 -3.0083072287212622 0.35940624005280397 -3.2840914503195684;7.4330295917936393 -9.4845355313560873 -2.8517346927584732 0.59843008257101282 8.0809456296126836 7.9462688301492737 -11.89462543810008 -19.460848576103484 30.478807081492413 -2.5286708675266367 -4.8738248839466074 3.824626808274695 -2.1524151404568355 -11.467976500956295 -0.35474493267396306 -3.8722228816926556 -14.575062147141086 -9.8928124505560291 -0.60859259220471074 -8.6116849299011147 -3.3732222051874245 -13.284970724536841 -8.4521456858494837 4.6933881031722509 4.6407883430119208 28.385395682502338 -37.689264572706925 -13.688073182493644 9.3251346942257616 8.2139115015948203;1.7351610499024002 4.894293121927678 0.67437908415731429 -7.7301732434446464 4.1891483142723533 0.83452339207978543 -2.1187458825521914 -0.2415721317171633 1.8730310922253706 -2.2275472056867147 3.6395872146259309 0.23940235903628157 -0.72624648514306978 1.5623027720947906 -7.1686922027642952 1.1755489474110044 1.5290320208830412 -0.94781395556230574 0.24179962402993685 1.6182872622053048 1.3065294304943624 1.0071252182232682 -0.15159816832126027 -3.1643760898830005 -1.6911122537025252 -1.9274976559255863 2.3959350680697651 0.77073528386613166 -0.61713557642077832 2.3412837272488298;3.6964976168196833 4.6528904042760688 0.86712436083739819 4.3902090574814023 1.9830123377083999 -0.27998973339622318 -5.6189398142312914 0.8436351173593204 -8.7450755783124698 -7.4160496623436245 -1.5601520162340485 -0.2654291824924781 -0.16314998706446715 3.4873252895207503 6.618783813874189 0.0051089296509753005 -3.5667895084794417 -0.51925095885928663 2.4533206467618767 -3.5433398152765072 -3.6383587188813498 2.357326949788479 0.96246892430594022 -0.28737015106392377 2.3998039839812741 -0.13408646263554511 7.5721698834573026 1.8878328660338783 -5.918435892962064 6.32836454782103;9.9964060404479476 -1.2016607683976332 0.3489567420770171 -2.1550594105755398 1.9354835966583759 0.057540386747905833 -7.5390484523506407 2.4771569895411201 2.1800887918752752 7.4299385827110926 -1.2529073073704431 1.0502254428952065 -4.5152095383135631 9.7187828058658887 -1.7861848731268724 2.4705483282590732 5.5543018833141904 -0.10800118653639906 1.7160067006806115 3.8923073960482424 5.846817382776039 1.3006851266721253 -5.0518444391209023 -0.54293593104110216 -2.9363144473069389 -1.3499090165842378 -23.421813745478644 0.67094011378267604 0.21789470284121334 -4.7723976244231796];

% Layer 3
b3 = -0.82415113148090047;
LW3_2 = [-0.12234411935420655 2.3501804530849637 0.74107452419958408 0.043245860871475875 0.0075419282931735755 -0.26636840359944108 -0.0019932253210957103 -0.038452884327330725 -0.30644721938331176 0.036414181963973308];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
