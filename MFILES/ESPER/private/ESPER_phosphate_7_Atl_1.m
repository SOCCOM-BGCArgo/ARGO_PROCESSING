function [Y,Xf,Af] = ESPER_phosphate_7_Atl_1(X,~,~)
%ESPER_PHOSPHATE_7_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_7_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.048218578179589730026;-5.0070993785760400385;7.8097650325426899443;-19.841969584546045979;4.3707575318828162381;1.4875592132721104921;-5.5024722865050748055;-3.9574486574463176858;5.705980366849357388;0.8923904152794296385;-2.0587390728384864502;3.0367562695808865136;-0.92603333562568868054;1.5811107846048755299;-0.5343532978404159639;9.0788030021258787627;2.3525399800926569682;5.9816178422862664732;-1.4920409349076437788;4.0332906665437517901;2.2844252104579485518;-0.18113892871154216313;-6.8907871013492689727;0.53527647238630304827;-5.6501629364967609348;-9.0399452828552728789;-1.2836910557620249129;1.9112993085590728182;-0.047848872908742824672;-11.927280811882825518;8.5194019567810865823;1.6069346569541334002;12.434816023521889861;-8.3565859294869113683;-0.92861787474524237762;0.28850834476731662681;9.9912055350414608057;-22.95843682903494809;-1.7079297107477560136;12.547686235455479675];
IW1_1 = [-0.45815613264734578181 -2.2038390826420917179 0.24071554326552965786 0.45475198260500271363 0.5230666279928474216 -3.2870274331344186969 -0.18136583130145814136;3.9038730204446578931 -1.6333954061476698705 -0.21520018929449946654 -0.17258650728961136278 -1.7405636846423373498 -1.6161305828069700841 1.8295504469405621251;0.16416004321656910148 -0.14026059404421514776 0.39809725662659845025 0.45011820180420708537 -11.688416262388761524 0.72669633585512305451 -0.25985714947392679619;5.1541533033870239322 -12.461256204864913144 5.7216178963525781143 -2.0778338153389750431 -0.059655302941930922478 -1.5598029359885015044 -5.442789855202844862;4.4718817104280317309 4.8448292007207856003 3.9636133825713146805 -1.0097166023871637641 1.8202509651887359698 0.90880254010122640818 0.95894434314043752732;2.7877813120796646196 2.7485808403668978706 3.9623586090802014326 -1.4153933517634573747 -12.156618913611293209 -3.1910890193885239619 -2.7884684426817583081;1.0996933598819229605 0.85820037106023872031 4.0264462419308939545 0.22023352957270744823 3.6171936526511578869 0.50737035416764930673 -0.12310499841126691656;1.6944621002979673996 0.18439372006410292837 -3.4880999100920848655 -0.29794973396813995148 2.8974612852791539197 0.77644803011328611397 1.4641770128326165867;0.23640987998713697271 -0.32832279849458445575 0.5578357949702480445 -0.57991323484853485315 -10.278735058026153837 0.62303256473053703068 -0.3913626513110619598;-1.0283362933466944078 0.99019259621386934711 0.17513614201874766474 -0.84269394733855451651 -1.3415958683732014389 1.0374303236870343614 -3.8020443883682624175;1.9308429525901227297 -1.107263308795871426 -2.2611960090643750121 1.3738350092619404652 2.6016613192045632275 1.5521192476350325062 2.2783375045318194907;-1.0879990520510764984 0.11968973729463426581 0.076813628281057116931 -0.88701178734072316789 -3.3595432078180036406 2.0983764658220103172 -0.054954731914196683351;0.5100278647764393547 -1.7459877000322268081 2.0077689626047106053 0.076318031488418897057 -0.78254242263715034778 -0.83191865294927880292 -0.65354635774881542076;-1.2702722302225959439 0.16741357785360014288 0.26107130196175448722 -0.50531139968156357778 0.16812403527120747815 0.80457171360641133173 -2.6495332466320413722;-0.22181819250472678551 -0.61820104552159493849 -0.24254153561423993923 0.39766280251780239396 1.7332460370112214854 0.43103985808258210577 0.68243547625284695091;0.35725398259050900052 0.82339701275564125549 -6.1233858581132185606 0.85509936432974675835 1.4515764953290966055 3.2266879077817951504 1.1628828581485377569;0.98593364705273556226 0.067377239318580695038 -1.3324470584488670166 0.67580943669828408282 2.3287260803088702943 0.13764867712462108829 -0.092314999840733033554;0.21226644632925392719 -0.67918378152562119965 0.48758948043526928462 1.6003246662913197529 -9.0787665378444586395 -2.0151483069404840798 1.1984793627666219251;-0.86500870636936222358 1.2159436307007926992 2.4734795945646603776 -0.60359144439494261114 4.8485303370176646709 1.6802326096884101503 0.60000173831742031894;-0.42880490400073983936 1.3864420659372060918 -1.9139920121752025395 0.177481809689247233 -4.0665865188628194105 2.5643573702637163514 -1.9708853275481397205;-1.3067935988948413684 -1.5249113793549522455 0.83753169982159347828 -1.0507834502172888058 -5.5944406171299112529 -0.75537587307619091792 -1.8739668377984903813;0.27241449367028403028 -0.69913186436357688258 2.2360331753680351419 -0.18776742037518023842 -3.0215208772850470353 0.16847844310254878053 -1.5671352976177328475;0.47903516867833734194 0.67943843977333429063 -0.21586484210768891456 0.089861513967506689848 9.0593201442861559514 -1.955503822866001995 1.3300061284063497968;-5.0266999758218942063 -2.4535935050409896085 -3.462844224796089776 1.1101177192905018476 -4.7887382975516414874 -0.48011496453563384801 -0.5641972070528205041;0.67113328630143254117 4.3747653551849463582 -4.2326152488665833573 1.5605935478697876562 11.837000861130803742 -4.4436653660010287936 -0.93439425618690430397;0.82368524660048225705 0.44179272005118030986 -0.42201663034268394048 -0.73491636895773793103 10.671572940721652856 -2.2938239023089774804 2.6169306725598020513;-0.093831029612742158919 -0.025865150670144179679 0.51240592753250546743 0.046944602706705550188 -1.5086386538266121082 -1.4513516101853896068 1.0571615682220039112;0.72500983173227717682 -2.8338543535794173955 2.8796331823791052607 1.6408604179474020057 -3.4957023483593760993 -2.3056668598879848098 4.0443396981346770858;1.0827548491507439365 0.79096360172442392589 -0.08558784553996680311 0.22677452395416830555 -0.92106766664666861466 -0.39518238305852210202 0.70504398023419945218;10.243611045578358443 1.2737871863701244468 6.1123429288007962157 2.3637423186402504172 33.195619560353350153 0.055986614626573505404 -5.3368831563906740101;3.3964691642845270536 -2.8217436304518410672 -4.7503285321048309697 1.0964952809678540913 -4.315054749659557487 -3.3369727455991262666 -0.62168450559190902016;-1.075503927800413928 0.69031263422404032237 0.074564185797455329041 -0.43492161274808788241 -2.3074418641066158919 -0.17294759771994577813 0.49852383700759583807;0.041670890308666053148 -0.46063362863499529576 0.55657894996111789698 -0.43216253735492715649 -3.4878786264896088909 11.942836432665217217 -0.026425087538594245473;-3.3748396855027982255 2.8026314057465606666 4.4958278793742714186 -1.0935772554857550176 4.1492896927112346006 3.114740154905022429 0.43056301921339612537;-0.16562819499859654515 0.009525597214088667164 0.30880921833739388704 0.033776920323319283013 -1.6840851039759558994 -1.1493975277593040385 1.0515021894823748383;-0.33108324464882604721 0.7855203490868540861 -2.3885657341557049449 0.21045413337831109235 3.0072212227181256416 -0.19599311126836471697 1.5522855314491359469;0.39469089302200233149 0.91133737959297966835 -6.7515653881753037169 0.91621914615459720821 1.6136768085093298186 3.5631873666593203431 1.4315177146425250854;-0.52766320253628573589 -0.72855006032925684334 7.2615701163138464125 -2.1108344702314765229 9.5384017185927856275 -8.7575088059225389969 0.33537646824334110818;3.4103875889986121628 -4.8384010979411922193 5.9744165403422542227 0.99912849442663898003 -5.003612245390641533 3.1949657461736142849 6.4020997500158483007;2.6170938775844723168 0.32997044061302244211 -13.704685316769619874 -1.9165840539761689332 4.8573357885146846158 -0.35269355535006796654 -10.979964643902562216];

% Layer 2
b2 = -0.1351762187112703073;
LW2_1 = [-0.1156318243888232733 0.44658974863678574385 1.3272716092191030324 0.095669179029444606499 -0.13580862435183169157 -0.074541144161182890104 0.18963126068233907007 0.14751260327609400091 -1.5921519418001444102 -0.20026732089294049799 0.16004276316566151683 -0.30451792482147393981 0.27681625876800708408 -0.51460555774766358894 -0.96421997165969985932 -4.8263079191092081999 1.8132507125010006721 -0.15921413916498633467 0.15182063026134659522 0.19844731389997366522 0.19779484287780868534 -4.5021768099314263267 -0.64229030518371343916 -0.14740802660983196026 0.042817440220006747209 0.45372654564141501332 -6.4308188159664361194 0.091746511175322925657 -0.66621940743337493274 -0.14854126575322745829 -3.3174743034589813107 0.55663961104088499621 -0.10057378013702227004 -3.4452174243783479923 7.3317045874126138827 -4.0768783932159617933 3.9691982604734761253 -0.27237266654868219629 -0.026970112931130857392 0.11728680690917092644];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
