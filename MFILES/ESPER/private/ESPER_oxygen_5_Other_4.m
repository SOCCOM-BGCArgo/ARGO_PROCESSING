function [Y,Xf,Af] = ESPER_oxygen_5_Other_4(X,~,~)
%ESPER_OXYGEN_5_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_5_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.70674823622952631652;-0.22791606024136434883;-2.4296834728826226524;-7.5251682857617003819;-0.45270424551803084556;7.378064903938571284;-10.083433707367582599;2.144966520437356472;-0.83768102176362657652;-0.74207356761243026266;-0.91430712640314482087;-3.4199993569108015912;-1.0214631997114731465;1.9299858223222612352;0.12346344443353288178;2.0709115734606315939;-1.4585684821036219994;0.41726128357772734878;-0.57645051526090351768;0.60499671405546961989;0.44171681636352072564;-17.187179282772873989;1.7649523886808728967;-0.35398807621204697593;-36.332047984666409945;0.13142643021689043303;-0.70628219530190095021;0.93189734290372028269;1.6005313207188478497;-0.48534513669183992901];
IW1_1 = [0.90231888955750771952 -0.10545674000727847663 0.12402275783748761828 -0.054354719813819410423 -0.59551369977726409388 -0.61380609138008224157 -0.67555260139138706421 0.24177932611588551226;0.3997503357628780507 0.65733353296542773592 0.2297703950498188874 -0.11281592001456547392 -0.014237525550810524802 0.71908780814342243559 1.4397902359498833125 -0.033192350845207906074;0.7611199025480549496 0.89304891307017997271 1.5575871450097056314 -0.63028113177281208657 0.35686616270674392792 -1.4400408308365395538 -0.42214372641290887067 -0.75137505321965003535;-0.37810744805587315209 -0.17793931115676281385 -0.56445061212407388052 -4.7701608831044115533 -2.9528649023966795362 -1.5083534252977202073 -0.10466626049889125871 0.31123771041644604507;0.17788250312684175669 0.74990751335335947836 -0.38329047556928697027 0.26456797794485598097 1.8696806767672480287 0.20741521795976231024 0.88519442111598845013 -0.73661117802123177167;0.70098688163795186412 0.36734269065046704084 0.371893609669209535 5.7705677270265134382 0.96755590526782830896 -0.10446276821217180542 1.2985904601279565362 -0.86232128570883170848;-0.35980544907508899 -0.061675319765423571028 -0.052933748051779722088 0.033954782273525351 15.881050340927071574 -11.360611102271878536 1.4653964395511305252 0.23655421830169331976;-0.34098984468096354972 -0.59243802669341749656 -0.95977832875897794995 0.47060979553845538881 0.050050766001633967273 0.59015415164977280682 0.057748073317850381891 0.3724981318521873308;-0.26608791510809687297 -0.0083680750200353787305 -1.2685707773404080179 0.27052791758324784555 0.17234745826003597391 0.57411558056233880087 -0.56508002826657077744 -0.22694404872280948826;0.15950706913584444813 0.15072888672101844576 -0.18566665993392100775 0.29900000413717009451 5.1324679712059788628 -2.1092910341774344651 0.23837339788317898903 0.27907111966149206195;-0.19426721573509386776 0.035378391737874367862 1.3351130875299670464 -0.39009512449724503824 0.30998889153276859565 0.36056768348161660764 -0.54531958265823921028 -0.24999890703185664864;-0.25921445179347935017 -0.038502903721538549175 1.6367394870576654764 -0.35171199233781669236 -8.2475323246425240598 -4.4303372253046626739 -0.3284288799363802025 -1.8448555955521563909;0.25624344664274056882 0.24327879704374197334 -1.237499121422125592 0.47803415302126395225 2.6113588312612634468 -2.1239312998871073823 0.89345595245614761737 1.4253766972626347176;0.58865450939922547846 0.48190899418818516908 -0.60883140381706579713 0.87120396869672256379 -0.74340857277954786042 0.2452503799475049262 0.29478798222150820463 1.054596615826621786;0.21276953941756812649 0.093442099913591730731 -0.25690436349482204115 0.09167518754736718456 0.79301011090120121505 -0.42889529772690543341 -0.35682155526078179753 0.098458722431807532693;0.40276218050211953781 0.41265503605242453977 -0.79586424496744612167 0.93221973994075535419 -0.12522114628848610152 0.23653972946535534172 0.59236630584964833357 0.65698714371322930461;0.19201939735453651958 0.059211152804154169871 0.12639989978310312013 0.0051305116664072036511 -1.9052192846189832665 -0.96944206612388761357 0.18123207927958426278 -0.16037499385519968231;0.33125577730814043109 0.11725692380671833004 -1.5006535146417907534 0.3189119312257071015 -0.050988452024429885279 -0.27806104821916760583 0.1904050504550039713 0.57949274602037770254;0.33275472481653040058 0.10864153070102845755 0.051472969685528578709 0.10762117169065751887 -0.92236848153682071683 0.017424685061476725273 0.95662908795419099306 -0.26541818350029422469;0.22792755569448910902 0.088672218425879148485 -1.1737669276165207943 0.19126696492461023325 0.51668962365419612848 0.4479881516912121997 0.16569784983030050318 0.35246510471963832245;0.087637753293885914396 -0.17377225136718063569 -0.18955549702768917375 0.25891992363203575334 -1.1383139756881059945 -0.35319845659886600631 0.424719508898310949 0.17673264176201383679;-10.885444647740435187 6.2599596083110329303 4.1553419105422539914 -5.1670948263361511366 -1.4752565150768512936 6.7353041841370382414 6.4062666293797665418 -3.8374161991496840152;-0.059675072317331816218 0.058685412715653778593 -0.46493733281586779871 -3.143898493299542185 0.058039781682175863031 -2.0092246502938451158 2.419084913676898374 1.4044167831620955056;0.20079455003136262303 0.034880490533460296876 -0.54154915048169205427 0.81203651330701764888 0.92971442720127850379 -2.1511122737900403301 -0.37191983947093215646 0.17438619050949322187;-0.29799934666240684988 -0.19144424297123643908 -0.36781296514795380759 -35.787550188980993937 -2.5943875569137238024 0.73347152019384853627 0.046555793619360061331 -0.92805340189605833867;-0.30370971506154037511 -0.14865343307859363309 0.43746559050862410256 -0.083941782649410143224 -1.0565757400857167525 0.1397644567451209463 -0.2897853356246761769 0.081922530527088283092;-0.029830055413793139796 0.001500629496139190347 -1.7449066491481248775 0.098201995502875408239 -0.18042551518510110964 1.0470531418046173933 -0.14721660007101225465 -0.28479159105101359284;-0.10579362562954695848 -0.22859049942300266323 -0.28226821253588896266 0.038271280066987482804 -1.6191264802890519281 -0.62322175845675586991 1.0208362590838377937 -1.6866239145922956588;0.40575074201516192485 -0.54867185553987751767 0.20649237965456632149 0.32113796055638355043 -2.4466729504560835728 0.84033048154845535471 1.4484358408877506807 0.67348139439380716453;-0.79797976482256915975 0.29187845064353196145 8.7022154862368843453 2.0977994274472848701 -7.0939317203664113975 -0.12216687175874678395 -0.58463371040450873295 -0.66682754053681003725];

% Layer 2
b2 = [-0.92653076849929705272;-1.087851774230947921;-5.0376029371884314401;-2.4326660415406995419;-2.0212688936021891983;2.3370758828185036471;-5.8842472268631986765;2.66682419744334398;0.29597767658543544522;0.92790451346571001245];
LW2_1 = [1.0663093884112433418 0.49709280214708229106 0.0086741505029905748014 0.60548416619672296157 0.76042269934134620879 0.35213434880220984002 0.8224085357601360613 0.9705197223556214503 -1.7420191211244335783 2.1476839767054789476 1.4421813371198946019 -0.28410257236025293626 -0.6632308958642187946 -0.63056229106725159017 0.52557104706720259024 0.23284403186050300905 0.39623844917179867897 1.3740983089867617739 0.34048960771254216384 1.981489705161546544 1.4222426015040419145 0.011368378131621923594 0.4663088364710239464 -1.8746464001929790122 -0.61909453754933940761 5.1574268302785721829 0.98086234114766468473 0.21483333258381948072 -0.69646832149374349186 0.17921181467818350641;0.12710990184618201071 0.52721906429540887906 -0.12424695028558338517 1.5347164168142157781 -0.034649346825271237771 -0.12777274917081277161 -0.66172464458396851317 0.21235681747203805081 -1.7702918334289234892 0.45298352090507110201 2.4498600595359487642 0.33723995367672748857 -0.31981161362735699427 -1.7374209470341142048 0.43846890969840879304 2.44903123184412852 -0.47599071304453405284 2.6708167982995081324 -1.3768749675783025221 -1.3446193398661232532 1.8991508568260988543 -0.12531836250839742397 0.067335101764575661099 -0.38246531125002675155 0.17363801661322095238 1.3098643286380364792 1.5695448131612237397 1.6104719991790195088 -0.83114909808990733442 -0.27494303354653076843;-0.45510877889642581406 -6.6102167959422120092 -1.8674945548104626702 3.4596739124456705738 2.7897505486570008948 6.5953461970009179538 7.7027005731481983375 -0.98030052913988219299 -5.262275004104449927 -1.380986769445810447 -1.4718298004082073227 -0.86068581958228329576 -5.5466724266887981187 -0.11341095184120970896 0.20063072647873211873 1.3812306487749872463 4.7028265682705123751 -2.2438329435153425706 1.5365288876279667996 -4.0202936814054250902 -0.85530360432176422147 -0.30411099169720329227 -2.531850232727938188 -3.4507563952848432365 0.59210484605386981549 0.4304892465963799375 1.5929146834063347971 0.038602328004747617218 -0.53301755091953306742 -0.9063298618710868837;-2.7674472475363063317 -5.0078172954335631317 -6.4257418917911888201 -5.3685885705590603578 3.0682485771705749755 -2.3373197923644264407 -1.1867214271440906792 3.5604748658952365403 1.7375844276777061559 -5.2742049829983308484 0.51462820865937453085 0.64834006359048745871 0.74082061893673578634 1.3056516075776900543 -9.3438642788992005705 -3.0836766998772708881 -0.38477941712515056905 -6.3351051243839613392 0.11865977323522847175 3.4293228687657864029 -7.2317100895201136268 4.079958234244396742 -2.5921059777087598341 2.0933410133935304032 -4.9353117741906338267 5.8766975892491073452 6.034337048911901924 5.7121309116560237129 7.390697258920210011 1.9887138748362127583;-0.046143390696842680188 0.075084582773319849536 0.040087302934516316766 -0.1053716475147767756 0.15961850958050755045 0.099008791743752030956 0.24327296481253388172 0.41744971962437094071 -1.4485655138846373902 0.91566929723105083827 0.60346478853023088895 -0.20208049909710140701 -0.27943590374332200055 -1.1704639070545219681 1.7271496201323255359 1.2958314884610504514 0.92566442525106806816 1.0308784558683765642 -0.028515963506634926794 -0.081094759922322470769 0.26889154382166169377 -0.010200253098474942881 -0.1562824885914707862 -1.0771923409712043096 -0.084478269514643614113 2.2444056740113960124 1.0023016170631244837 0.67665849092813135091 -0.14884521590334232055 0.04311001191776780983;-0.31446935643326617837 -0.64240824595263668062 -1.4844538905356858827 -2.1037448631981132685 -0.34414941365581253052 -2.1054125103125462815 0.661080690675825422 -3.6018877219492053676 1.1968130635091807079 -0.69717875378889193616 -0.32842848972548321917 -0.42958896547191666171 0.61995193822545235918 -1.2274390275785145299 -0.5330091963474629102 3.3416774413676506583 -1.288754319137194404 0.46580895804931715665 0.38633864520590427416 -4.4302225816625027122 -1.8825208244844380268 -0.095222976398676148491 -0.12584795173598892215 0.56960377941789575029 -0.25839163130861475537 -3.9209808646400170495 -0.80455570878533777535 -0.84761438335990313409 0.8043088761593555347 -0.056426587701912750417;-1.2201054987413275654 0.023277805748326291929 1.1668352425755492696 0.98331769472221230988 0.10873197635396833483 1.3607357256651595456 -0.42897437197447879642 2.8013141754140478135 -1.5570910420851513667 1.4370479462534777593 1.2572690542038444939 -0.53571731687609336348 -0.37937200699052886499 -2.2542191863631986237 5.1024098414096332732 2.0239381467588524188 1.1281367804148336731 0.82211591436989117643 -0.14014342511192434682 1.6005789782103443386 2.0486322423452194563 0.14225337768628806834 -1.0639629522062246103 -3.1242713338580281324 0.17740674136321032961 2.5100885386461597726 0.95625898323857894123 2.1484830676911088609 0.16022937211014434689 0.31876036094764542694;2.9350512470666276776 -1.6564360900997334713 -2.6610232739233832255 1.3752621639144653187 1.9901896571273867131 3.6669784785925720882 0.30213282664154422763 -6.2301594200354335484 5.1396043247768661288 -2.9862093729298821998 4.9480132598106374431 0.87578132547186848811 -0.19756316303618626229 1.8669096896103516414 -11.921597757129434925 0.21838814472095291475 -0.13933446121624837311 6.4897733749619002097 -4.8632042571173732526 -6.2048434777601251255 3.4129846531220229267 1.461655871271133833 3.7947281942630448626 6.5668630960864033952 1.5406060038801503431 -8.7441457757294500652 -3.6796862890904411536 -1.6674221156546886746 -1.0722386044400045169 0.077250044549881505263;-2.3104860157490270112 2.8501051401037829081 4.3315880916032059034 -8.8933589939759958298 -7.8215013577596996797 2.4558920352459354675 4.9424150805924131902 10.55567294534287015 -2.8602657846272641073 -1.0085104069115260472 -3.2220990775014599627 1.3839523181046313738 -3.0058208546262630279 -0.55450556381292082087 -8.1772900724114858662 0.08339418370322766727 7.1731348694991936554 4.8092942094889883364 4.5600247433671698971 -3.1217417106262108639 -5.7403394866290238241 -0.27668105923069419294 -0.32989743071402261032 -1.6862226461510565478 0.83867397241809227282 -7.7095807331984467226 2.954837816910021342 -7.1643133780401502264 -2.8523275491188444519 0.10240059005234111722;-0.94748450328100186635 -1.3528521096504038113 0.21784023311947106616 -1.9480777234059976077 0.2038858582549475662 0.24352061518327974832 -1.1398076491642998853 -2.8949131359555568821 -4.7129743888637731786 1.094000421719921734 -7.9478149064078218444 0.2885616476424688881 -0.28261020146919813012 3.2613728294194839208 2.8796696137535291449 -7.098447646754968865 0.18906448374711362637 -6.3194100088637910062 4.6631817287346990497 6.6202258685391548454 -2.7734284034972493949 0.16043529588190516555 0.36898995497773107166 0.3700214062762913203 0.52201354489320661578 7.111981297322212292 3.0720495543273615979 -2.6754230580302378328 -0.17108364659728303447 0.33598097630381329459];

% Layer 3
b3 = 1.8419511946860296359;
LW3_2 = [-0.69809161444440748223 -0.45602209945971833305 -0.0621753248515132112 -0.0094883492193952694016 3.0953327300103641306 -0.48846016697054628342 -0.47423137321616065654 0.065329145844188446501 -0.054674417753067472425 -0.22833034221768630512];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
