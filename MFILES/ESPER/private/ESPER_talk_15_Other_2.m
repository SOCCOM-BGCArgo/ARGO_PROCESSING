function [Y,Xf,Af] = ESPER_talk_15_Other_2(X,~,~)
%ESPER_TALK_15_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:51.
% 
% [Y] = ESPER_talk_15_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0077798922598027;-1.3570329022516165;-1.6662897821512459;-0.20977365548777105;-0.1930013040751912;0.32380454586158525;0.71327473246676254;-0.18115049997000671;2.6877541192773058;-0.25351073775815314;1.434471822005303;-0.93989445712983377;-0.17704427732994696;-0.20511553655485532;-0.76341555848871001;-2.3943275380887248;1.2947575817775649;2.5373938682319488;-5.6227624195200079;5.0461629047418715];
IW1_1 = [0.84314170341275885 1.6295864110349889 -3.9226385197090998 -1.2628486388179707 0.37854287746571003 -0.97028425382389794;0.86893132373837645 0.59895953104923294 -0.8104604700061051 1.1750381021889851 -1.2906819838932468 0.82150582271928352;0.56680602262678059 0.763129330267865 -1.0153248167226041 0.70903876456763593 0.19264347395241424 0.052863628395231427;-0.20657869972180004 -0.088958570412080745 -0.10721833452186502 0.097369867200572391 -0.092292831778089904 -0.029806389608953012;0.11903055919512315 0.15480559941864611 -0.41262390225644074 0.6066596569348367 1.3007778575145676 0.58303299008981802;-1.3799670559531731 0.13535375795023649 0.89407093832818396 -1.5255665359869441 -0.24876176422875612 -0.77372771334013368;-0.52721554219310629 0.16925909137007059 0.28786616109249852 0.80003161089718999 0.91636943080403832 -0.27773830923404746;0.017624298170989174 0.092677547849681421 0.70375466457630165 -0.69481239964012464 -0.022760762034488562 0.23310671816617007;-0.036635723708783499 0.18953503777674649 2.4008655603941884 2.0054401485881934 -3.7385709438631705 -1.133003760928238;-0.24158932415682668 -0.14486824257105854 0.0058258569802522257 -0.25537574593678053 0.032302756333691784 -0.29173838647480527;-0.1967727659138821 -0.29179896714539483 1.677381806428788 0.50781219082129381 0.56894331707874124 -0.28304341551003814;0.073505865337803039 0.7463461608000399 -0.48701075786878956 -1.732334641426271 0.8032490777688327 0.29759279920952619;-0.51374353932587091 0.16590100910899805 -0.78472797342149869 0.027637052047670869 0.53097891376727613 -0.58284047626109892;-0.047889612277631999 0.084845411925192904 1.0138285137687051 -0.96715495282234087 0.19818393423970498 0.56684287554666246;-0.0526185873040989 0.11273680356584286 0.02532969008946356 0.37119683882421883 0.99321242776746366 1.1698700193172249;0.018880311804600793 -0.062191102017375814 -0.52292388834157899 -0.3701462956749868 1.31573141064553 0.94524405890644947;0.59116705368511901 0.052944542576326588 0.32454241146969931 1.839220365361216 1.7348444893936759 0.52906013901832094;-0.30415594812736063 -0.75663257526663197 2.1011881692848458 0.47493049573947083 -1.7399544231528394 -0.42568145550928121;0.64762261923247189 1.4286408796788692 -2.5353293875324376 -0.59044752385605892 1.1061039293997839 0.098030389196076401;1.1485481437513205 0.79115289666077238 -0.3423289917114008 4.1291743503889977 0.27655102899605977 0.83312178312118934];

% Layer 2
b2 = [-55.198779740731723;-92.669250793026592;193.18372268532113;60.377003849564623;-21.957293131727436;-44.112702417387219;3.0202057285664368;35.608119172570262;76.468344561783212;368.58660762804396;-34.198405091277586;-13.753365958810333;-144.1714219458965;-64.084731687280694;-26.685955454981627;-120.00471970377586;2.5575128843067394;-172.16300557969186;-24.028922799787811;68.099196247072371];
LW2_1 = [-4.1824037297935019 -27.643854608853832 25.489543798305462 -96.907274412781035 3.1789785610788064 -3.9467639664776741 24.217630058956566 -69.882528442497659 -7.3293867792116947 -1.5148785156230729 -5.5265744053913979 5.5619834175360534 -11.893856479794293 31.276874584367231 -10.851411126567218 19.03862819542595 -22.420117090510693 13.280938269265251 -21.76491118228784 7.310525698640661;9.382459126003198 13.546420270421827 29.143671947188317 72.356772520842156 -26.60393279060353 19.055460662379229 -5.089301744162178 62.859005775871623 -0.36656380800119975 -20.748377494348226 38.345286889616233 13.553225727653409 -26.408897615272767 -92.538875878662026 -34.757067237402673 16.94457154123609 24.574030726497831 -39.779225592191267 -156.18485212395942 -1.6075674738976624;2.2084318175670989 51.115322982736693 -33.639123825832556 30.468124005351395 -10.612132334754309 13.483146388202261 -12.289883659918488 -43.145940843181087 4.3199645155852222 42.115174766892217 15.172886790665912 10.340831765898802 -12.927633071274755 20.109396915090166 14.671072585967554 -14.093807014531654 13.71463360275205 -13.258498367315479 180.30558760809794 7.0048822394371388;31.679634874976369 75.565075667020935 -42.165532408517478 -60.909849810564026 -1.3333412513906067 -14.908829285317717 -67.461556638264952 3.1923963490266987 -3.7908210335524553 -19.739490519432184 28.810267946152887 4.5142636002762915 43.071175683461341 28.338075629293431 38.107225388882519 102.96202024936829 -31.2326916588556 19.110742282028006 -95.70672368243342 -25.193711801389327;-12.242530038517648 -9.6093962048260977 27.320396392234851 -8.3534173444395705 -28.583566587225519 12.966751484318117 -45.257318897304479 -8.958618158437746 -33.248658169321331 2.7340634516439821 43.730129646280325 -20.813802419583826 -31.43922301369302 5.8046371449015632 -23.862324115631932 46.741007957566865 -6.9707458621120271 35.551328995862207 -36.460517396794138 4.0454132145132604;0.1224726444769923 12.697302726936957 13.259959633621609 -14.401744962616995 40.551946980692811 6.8851342067850387 -5.0242721527990337 6.8011880567043219 5.4950517737089708 18.639329209795594 -10.738897328594719 3.9969586931816234 -4.4820940547194548 -0.76686441515724579 -17.761747196024828 -6.0378341981204198 -6.356259402911232 10.296493434129347 -53.750581850360149 -3.4858659442637339;-0.057522816634884288 -0.040591891869786387 0.7403681418402388 8.1242296833918832 -1.2838430904837572 0.26089179420740699 -0.14547819678748497 3.6921799648525431 -0.27743644565027958 -7.7375715495820652 1.2613158046727706 0.066659910440595022 0.096351722629752889 -1.8859216184380798 -2.5137649292417712 4.1085157142325972 -0.41585192474674043 -0.49983077906370049 -1.197474014871718 -0.27264751700191386;1.5995539775672678 11.129989163015001 -14.535292516057265 3.8572224639921169 -25.89630487857816 -0.73514093703986583 -0.69612476430324033 -14.561652064819871 -0.2024535019986235 -20.927212098071905 7.0061307137375213 -1.8115899817017698 9.8809943865495846 11.248795777159229 6.096317248876872 3.40295059019906 7.6930298172066651 -4.0802707374381484 37.532702300944024 -2.1511277214053055;-44.095321189311818 -143.63831353427446 24.068631692108781 83.484029134541785 -13.295204127089281 -53.087388844726966 -34.237192179208471 -99.508776971804053 18.468621692759665 -57.986369551413269 -63.515153807751837 13.303274711980963 -13.300392527029503 83.891909037120897 -22.818565474253539 14.805356757641071 -57.941315130333223 -106.17505416965021 38.113161042129555 37.485603255203415;-58.055210106217032 30.668443140271446 -108.84763484292692 -72.884632999289494 71.478783718542488 -43.459655958302079 -69.630617619407971 78.025628202597929 34.0955142861865 11.967304415118971 -189.16013831481396 -164.96179342051198 248.89361882564268 268.07647138705261 -5.845038497381732 375.95782598517923 -68.58366419362585 -31.843723685582756 46.479583137797235 132.96576959211242;27.326246174162911 7.2260582143837846 -73.888794049559451 -101.44227393532086 -14.866477365763346 3.2162578073868255 62.122885170216357 -56.934672811844273 -16.161821839318659 22.252132265380219 -35.412604133425411 9.0021874873094117 -38.81159849746593 23.277091575684643 37.750526353931491 53.317006153936617 15.093555525919086 13.203115572803284 -26.983185714029538 -33.554342983150732;0.93347283554820693 11.447834155671842 -18.65230797227774 3.8482316257101155 -16.563508993817802 -0.42430584375087016 -2.7667990909630458 -7.6520374562591025 -0.60390110293135868 -20.18824682393214 13.01518984822034 -1.2926829701589675 8.6228243686396837 3.1411685767809785 -0.024039710120163885 -8.4984577583843972 3.8700693049397219 -10.545830942725035 1.1437085381748837 -1.9540286717914312;16.464791369084594 -76.221141201494618 12.678488306791943 18.163269132548187 -26.810229635197832 -6.784564041338303 56.129136781981686 -62.516384134817642 36.873556157644785 -16.273253303399546 -62.879574579409905 27.731105314712277 9.1114450130718634 40.186659495630508 44.457755066673002 -138.73065448858875 9.9687266232007303 22.489684693724683 33.54824423721476 8.8149793712159212;-11.033455369808468 7.3951712877536693 -3.2882265722095374 -3.7017243475047694 -8.2031120049737218 -6.818953739068836 6.4674558515615166 24.679038883209131 7.1165838068148028 2.1585458099677846 -22.086834511001442 6.2775845866812032 7.2756161152820775 -16.923362322193171 -10.245125201790309 -9.016873832738737 1.2087272009103951 1.0160940236793736 -61.639710997864093 3.490295816133659;-132.5051447970099 -27.08473073661089 -4.4518544327074059 -130.8990894031115 -139.63148112374989 -74.577575353550145 103.23204060222362 -200.01668174181646 -9.7257495029921017 -214.25300288284393 5.388276684231915 329.67928225491158 -151.00365226609827 -229.11680620607899 22.633844912482829 146.06096090854606 26.968823367857496 124.87846785542519 15.088085999250596 -200.5367946117365;119.11803326282703 23.485923431514532 15.808043502749781 46.885135388866317 -40.785851962756816 16.236937779812081 10.928418041727349 -62.914974294171394 -4.3769568520377913 37.824307586152869 0.51304589519070287 34.573091837619273 -59.030865232665121 -1.0015414416296167 -7.7717781232609875 -119.29849925445569 41.881816986046623 16.109306731323361 -138.00679600124113 -14.826463922400402;-0.076423386400410395 -7.8739199207201729 9.6020195999958364 -7.0509507028612495 -1.56563509958129 -0.59384005379041249 2.9594682433499426 -12.073077438063528 -0.66057538990180764 1.7766754383062735 -0.21654836900578142 0.12425754886893876 -3.0658200892528931 6.2806736675104196 2.6715665618396507 2.3711864496962636 -1.9120370737893873 0.76705181260919331 -1.4291874541315068 0.054287946016047778;37.766729406091173 -192.52259579604072 -128.38649424350524 -123.74150540953826 -22.413899121984628 -47.636397802500284 -26.802505445946885 -67.066368274964205 35.870754776861595 -152.57460032548065 -88.423081186811132 2.5162706361120861 12.74295889314827 21.93849446527728 12.511196349991524 92.373306165772718 15.057184767239072 58.556376279844663 -66.495592084146153 -93.846152053131036;-0.33105391032425313 -7.4963230291261667 -0.9578634012091426 -8.7263691427306469 -2.316795467252549 -1.1840205026059059 2.7738038014954198 -8.9739244215501568 0.18150284255341431 4.6283903599035465 -4.2778543458477545 1.9828490536107313 -2.0973886648447571 9.1898483816685435 -0.13883550237364092 -20.983621177910504 1.7593272510223603 -1.4877913274944583 5.9619114578100429 -0.55303657443593912;2.8552061839846834 28.616564308856386 42.099919263408943 -74.000704349278024 41.986803425220842 8.7241788360802524 3.1030610180476597 -38.396017499544946 17.798322932935047 -7.5700586304116788 5.7786979286150437 -13.523983983466735 15.941198952389552 10.43876121642114 25.376217496656615 -12.380718223727053 -208.44544232031132 -51.819112285500516 -75.680644972185803 12.936434512486768];

% Layer 3
b3 = 0.0684781894613576;
LW3_2 = [-0.015818412458107594 -0.013307458126360026 0.015816033033049307 -0.006769948752810253 -0.005398502566307679 0.032265839383209087 -0.50692565813563628 0.060988126125017098 -0.0028239164759037644 0.0031258778350036114 0.005462450028845699 -0.037875851569036369 0.0052443207771760885 0.01322033813430353 0.0069735137321139751 -0.0057768671900708512 0.34569954944185505 -0.0077924019897695918 0.095869640351137334 0.0028597251764940091];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
