function [Y,Xf,Af] = ESPER_nitrate_10_Atl_2(X,~,~)
%ESPER_NITRATE_10_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_10_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.2865243566529018793;1.3412484110001252624;-3.8202341030091591101;2.9655774101076990412;-3.274672193992246072;-1.5944922438912378926;0.10369980611340003096;-1.8923767593984910373;0.16163507170648203082;0.35888639925242016293;-0.58966463021415604917;-1.2108875494338671164;-0.89973514921317909732;0.14410912053139082745;-0.63945088014715456559;2.3729057159788262688;0.85568277182222229893;3.5009633868800960066;-3.9400865368629887087;2.4079979252078373975];
IW1_1 = [-0.099260975158800154872 0.34093773433886004343 0.1250523182971716718 3.0124089994994909247 0.9493670505522117109 1.269103684928958975 1.4062580677687899211;-0.042268866142333688662 -0.12703516204798828704 0.39292484312618414233 -0.11889106756898970563 -0.033453495305623547063 0.98382346163209066781 0.72474793614645427464;0.067882093342712723771 0.49076513710119962219 -0.72170573954410854878 -0.25205011133149557434 4.8110331029857809071 -0.86615751525785289466 -0.56448280616661916653;-1.0081129625456990428 0.62136657106540826856 -0.96422380324140644081 -0.32149965101464794692 1.259415839873353038 -1.2409066365029752799 2.9815174926596585969;0.10975091340904295778 -0.66855916850841312637 2.3348587146593171582 -0.32361312797891522708 0.7793398079430998715 1.1765984956925821248 -1.6876145513144291677;0.24826395697651873484 -0.88751627686136225215 2.8544058106914147466 -0.99360059750281171098 0.58673659502541863908 -1.0380261060645281646 1.7869399556613829727;2.1230186805957367291 -0.46815157074136143356 3.0823285076280915185 -0.12888713448730398925 -1.8499566813363552686 1.2222291960075153394 -1.4863383745437226402;2.0894393469083785142 -0.60306346382293862796 1.6203625021258400984 1.2206418248475532362 2.2966980057198038701 -1.3043359133696301733 1.2150487924750992264;0.041001126029073679813 0.59973544554571112108 -2.5044977307845353032 0.10828143388647754053 2.8848267287849522766 -1.7563363828924136723 0.68143572177101618959;-0.070158682089745669219 -0.52145884164559719309 0.73423761539532439446 0.19686111868203889919 -0.26024638591169296786 1.5090526029419166765 0.58454570939892824821;-0.29268458810930647607 0.35627270290490875571 -2.6608064361645906715 -0.85204369669342339133 0.62323683334516644106 -0.46410820054085488717 0.73103623100278047886;0.15009712194645924432 -0.24525518697522086242 -0.93537971292181609773 -1.7267153993896169339 -0.49322456826072413882 0.2320021293798523454 -0.86771789306362856475;-0.095951169678542988506 -0.31349514070541767419 0.9537072735774870802 1.3724272583326322383 2.8284919246126780656 0.81210647960251258759 0.45731330546707937845;1.0780865054809647408 -3.9495189329107289744 -2.7658416645238617093 1.6716641997689603016 0.12557435552819307123 0.58629227064718314466 0.86167189601778659824;-0.51130436128013689867 1.2488763272829683793 1.1318915335277124345 0.27908740968505046931 0.26573831855104734778 1.0955806423973295516 1.4580606946316170269;1.0495012182753182817 0.39443114765931897026 -0.26495209281794462886 3.2406616238233407756 2.7189024335786862174 -0.29070155000052610994 -0.81298998520086362962;-0.29760115225545741291 -0.12328358876560911728 0.45189610663894208553 -0.38747033534480179728 1.2000373934443924195 0.3728292491861055491 0.055799246696981302795;0.5314330658719457201 1.2573728484167687736 -0.66899105685666704346 2.479006629426382613 3.1339546866794831814 2.0052381641962386816 -0.48469008467622082259;-2.065298291606016079 0.71466112475105414426 0.22759357545623606911 -1.1461407693440401889 0.72029369544696120187 -2.8176029852929920239 -2.8432547707968143236;1.0549941535042428598 1.2069935882812437011 0.006629458124472921085 -0.72765167933017327329 -0.87954358510514218938 0.1676121133159437504 1.7438284948767879268];

% Layer 2
b2 = [-2.5616662263546667866;-2.038194019340512142;-2.1682566736141044572;2.700599008583506766;0.1377683333587970127;-2.3571573391271343212;-1.1874879352405258714;-0.37250647807207726281;0.23816342801319012601;0.97882114819433385655;1.4519752353195549688;-0.44698622560701928297;0.10739308737634517543;1.6357604261596236928;0.44700639141996290071;1.7066148973403729716;0.28770712448407731454;1.9454702017050389262;1.4085620464843839894;2.8818976602196615389];
LW2_1 = [-1.2079624094296701475 1.8804335916719210342 0.93594038409733970596 1.1601676668755052102 0.62620935659572130039 0.44491084831580729464 0.10264343423548809298 -0.4378254908572606352 0.44801258415391415069 0.24084984683980503739 -1.9999971072751212553 -0.53128665327040680566 -0.28704439196096570575 0.22119701798554070038 0.12623137671334522247 -0.11546958744248406181 -1.3778119987243255817 1.4323275088727942528 -0.13392810958842435443 -0.48916718017541116481;1.1179038048788503268 1.4066641930849945741 0.57295817846375496352 -1.4445318619929017334 -1.9198641091057075947 0.2544756028289092975 0.53503743799087288835 0.21251346689022526659 0.76139679223570622124 0.074237296607950323257 0.19657302900571818616 1.0572643721262422467 0.18884985248394967061 -0.16978729425834238054 -0.4796123367511105906 -1.6546100681141504563 0.86115939835343957576 -0.027751775851561549802 0.61393442905451700575 -0.18172095749603073278;2.2335612880359274612 -0.089906783608549090125 -0.51994257818490530187 -1.3082141179380011309 0.033714324020542869864 1.7985732327640544526 -1.0310997851822352178 0.49354201366135358464 1.7491797911511992591 -0.77900045469303780266 0.62788255649346524923 3.4533093683199149737 1.7842833932043293821 -0.68755344562283671195 1.5017739006887744768 -1.5119203501897902076 -0.87285244038238252173 0.63337844199159720748 0.54045412346956778205 -0.037478617617454912381;-0.070932702663443730762 -1.5426376041132685568 0.45747095157165873491 0.031189191552575060151 0.96047005495147086407 -0.25680659850828574386 0.01793167151463545203 0.3372770942777889025 0.62982733895574904981 0.19880113659076048549 1.4446884270538844497 0.70610324764921561513 1.2023677134868153704 0.04216566601328326086 -0.5025888469075449061 -0.55536359568457449587 0.88823019112910517325 -0.64272468292203299711 0.34961801417479354548 0.2184082034695647434;-0.6808628054333893953 0.94110415073642106343 1.2151834135115806568 -0.37515743530880379941 0.11755519486869486778 -0.21064365892376776812 -0.048662100270243840994 -0.20750159357953359973 -0.48125698906544528421 -0.11518359272733573462 -0.45633882714047452334 -0.76528310786016984224 -0.16473812049396169277 1.064125811740190608 0.27339392637831244626 -0.22910378762187100232 0.93180614955951446277 1.1187654649495861747 0.52167326041315864593 0.98947642771974453346;0.2170099178783033711 0.1203558242271838552 1.6262408006380539849 -0.24496570404965450907 -0.73208422604526446342 1.0293584308669676552 0.20228056339251671014 -0.44045126974278203669 2.2282666093312948341 1.9669234585503598822 0.33659749825883533703 -0.73092918098606929345 -0.76517532196026893931 0.18527782079868232445 -0.21430263831446214051 0.82680009239765317464 -0.70147928071075704715 -1.4340685931673977649 -0.60717407040369275606 -0.77820496210387901659;2.4249175449035180741 0.64249642525680272787 0.13086821218026928326 -1.7374822691211586623 1.3615444236416029966 1.43330498886481017 0.095626378818182478092 -0.52362775309698961212 1.6316315427557948059 -1.1776144224219760037 -0.20929270072934508251 1.6986122857417078613 0.3112510947199483291 0.52456979034599138245 0.4950358921473103635 0.24346789015566705494 -0.58420744283841352651 2.9094523038610793364 -1.2967582998494779911 -0.70619727037338542175;-0.30364566063933157158 -0.39271742454633040698 0.64903907074847089209 0.51312327254533496301 -1.2450915476489552436 0.72852426263658598415 -0.023147128042500599715 -1.1275750398540125286 1.082327393216985012 0.47483515716407470597 1.5994199469068191011 -1.2413024259740486066 0.17020244444438370479 -0.76816253337189810413 0.69859272405725536537 0.62569602769044685431 -0.54415702243931618476 -0.17213361606444907426 -1.0351564254848124591 -0.032501126271827163183;-0.43000331762492216559 -0.27572653480682024485 0.0016838665014808074094 0.86079677422951350607 0.63822804025846557874 -0.055618727053645330982 0.087732859653723821447 -1.0077426874093475817 -0.83067563114423115245 -1.5462042290929343125 -0.19932471001987575598 -0.9925244345822146208 1.6248140167594606886 -0.38662778317000978667 -0.076192521326563317219 0.72536483801479156863 0.090935793425731104023 -0.11032199016682278647 -0.83872966450240404868 0.10755416979686706347;-3.9881902592651101713 -2.6080957659111136948 0.049150674074214362186 1.3817749427426970765 -0.27303086838653523039 0.63383712071106668162 -0.51848011668108329175 -0.83793981409961804108 -1.2994024389126908048 0.0065963322409373810473 0.29655151715012711966 -1.5595159569157481805 -1.9363927459110452656 -0.28383923968184282538 -1.1417407022392924709 -0.82725345987467924225 1.1316056694547182992 0.47809995120124004764 -1.924318632384774963 1.2619483286453743176;-0.48470128455142258428 -0.84405880362272356354 0.28941484123289168418 -0.86418495098049175063 0.25768049932786607492 0.29647290431547868028 0.38055371030982304559 0.57408358548695914703 1.3352271415324763471 1.3082294400150580316 0.82312216695966555768 1.3603550717716195173 -0.79372460068734784766 0.25340470465886899554 2.3760046927475215739 0.12859950518707705114 0.50491533899166152199 0.33641699541147179753 0.65574614792293772769 0.059603998015169502855;0.81048997942904354996 -1.7471349032321643602 1.1894381754301921461 0.36609042688035370317 0.67524821057266848356 -1.1901676899791295838 -1.0849408469592110027 0.92073652094159363912 -1.1012274200741414276 1.1360404823161531773 -1.1250490701879587441 1.462846445388068739 0.53006076901330090312 1.1092653708382971267 -0.15669948096100919099 0.41781197223833582699 0.40761258193202432043 0.11249021693565064428 0.48897720169439429228 1.0735707090229644756;0.84334074322577623484 -0.9838214433520821034 0.2329656616784821499 1.7084503764209837406 1.3122680522839325068 0.30277289377788335623 0.029055268472003140112 0.248041101058547514 0.58270190687021095055 -0.4948247912483829114 1.0316754696753556164 0.3521113311992651318 0.52649234029843938742 0.49637279562814684564 -0.052555807157098129168 -1.3613751409713417129 -1.0620662725975564822 1.4845993353792055203 0.12761793624599565566 0.08279749189121350661;-0.87076537524825381453 -0.94254253541260601956 -1.7095017517942741048 -0.56664730306754029776 0.16551096158291392357 -0.62802076037813248099 -0.24744412830797002378 0.33565255953452477478 -0.34080878443678136458 -1.0881369820798794112 -0.17705157926205297714 -0.57299656041420832242 0.045594451688217317586 -0.36246626829391381808 -0.77938881463749554168 0.35068875907093244315 0.10313793388252226468 0.28642681438808670347 0.1269056634355671398 0.11742781525483043936;-0.42338278912671067911 -0.72886681277052389749 -2.7190722826069104734 0.65762956112711501433 -0.53228126156226429622 -0.24746489667984775118 1.243406714089963172 0.17259001868476733788 -0.69564620374354435572 -2.2258736195208221886 1.4417215715363380646 -0.8169128083529910711 0.30708074692158671137 -0.89258947836135027476 0.93094238960581932041 1.4088929282045450364 0.82643679592427410352 0.37855106162079771304 0.15246478534362586932 -0.079770717126071449821;-2.3253613257929703906 1.138875273210355088 -0.89137776837978255351 2.2434438920568142706 -1.8642120869841114494 1.1848119778122625512 0.13531241318474537816 0.4346255468864568261 0.30122003601908231563 0.6847122284411587545 0.97124229168391384981 -1.6791523377480312984 -0.44453509577497424266 -0.32244453581245002827 -0.1665203073739535411 0.3485038064530366908 0.68348521019988195402 -0.60388196919436087917 -0.10078054090614324556 0.44962481835984363654;1.2671975967992719081 1.555538499869325797 0.24234340156057748716 -0.48590615060034547668 -1.9568181947019489542 0.99976405960436565135 0.18453182550797006534 -0.039669316471548851655 -0.75128384479534460194 -0.45904786469228797685 0.68613334235174949782 0.2529071937426327632 -0.23951818229774607394 -0.13625493729240778507 0.63576172246167361735 -0.12260683592863615143 -1.7667540436340902765 1.0151094108786500314 -0.27769764681071845702 -0.45627073792700684196;-0.76485787890132050926 -0.4984170120484620603 -1.9833508232427492501 -0.47606975866978396006 -0.31676343246089500028 -0.60397661719916817535 0.52877583309656450705 0.13568754793908266443 -0.61270723085444356304 -1.5572971084614348758 0.47830442046576948645 -0.29209049287397620409 0.32911948904731319621 -0.66431788284687898205 0.163107240076879767 0.44844847885110417085 -0.38813134672133492442 1.0057419288430637927 0.20119354360636179657 0.050320239380870906976;0.11916209149143476564 -0.28288810769873640183 -0.16100899708584670567 0.063366171056881123724 -0.41650395715098015303 -0.16070711048138935917 0.65601236056317313583 -0.10043649315505837061 0.044717563603808074824 -0.35918939555770662553 0.38771611884171275353 -1.0559945796065055568 -1.2036270806249376175 0.85447021639439280083 -0.45789387528016756157 -0.12593066921732998242 0.67300112757442454026 0.55979827411791993619 -0.066400507013271339862 -0.33409661464955059396;-0.76184495684041064756 -1.1677303210160618896 1.1445292499667247821 -0.87759730814446212932 1.2729560169591942476 0.19057541795305432686 0.045702946385435989918 0.53103034474435917289 1.5560222293083738609 0.65820903084809356809 0.29564595995555342789 1.0201236866548610838 1.2842988116815070576 0.35101449342754875715 0.014715215398560570204 -1.1611424318728482685 1.3547840786970462013 0.36281806553217671452 0.73831380663540979725 -0.43570059294960594709];

% Layer 3
b3 = 0.23502482467563903801;
LW3_2 = [0.50597462891472577695 -0.34252017050997074499 1.7229977826588747103 1.1699545484396847161 0.25357122384349201072 1.6423535582985864245 -0.11048296908302987496 -0.15463558318777151368 -0.34957441681824935609 -0.074697628636699445193 -0.35600070061810901167 0.22264636518385483299 -0.3951971838922139213 -0.9949292780811930248 -1.0598644234232212913 0.38643320957711002617 0.59624169184744757466 2.8203766544402806282 0.90332294851943484293 -0.40377394959030216137];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
