function [Y,Xf,Af] = ESPER_nitrate_8_Other_3(X,~,~)
%ESPER_NITRATE_8_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_8_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3459821098079602919;4.1651270473638311032;-5.1654290511082141535;-8.8096897922378030188;1.3638825531046823158;-1.2408628601124136459;1.2014619090211418051;0.47998251510841272172;-1.4141042718852565585;-0.20900633375575281003;0.2265060216179489716;0.6089084000792467366;1.5203566576043641145;-0.4465356593900719484;2.1949304091951398199;-0.59505634167988163963;-1.5140250844939719954;-0.60665356184352947633;-2.0896697798579748628;-0.38292454204835446596;3.1408265386811304865;-2.3201407724864155924;-1.6579456671982009119;-1.0514226668248252139;-2.3537197468358561636];
IW1_1 = [0.3538485693781012742 -0.21207710070395699442 -0.049290386446328535164 0.15256497420914702512 0.52649844401302947627 -1.9059735075079216049;-2.2142299125869544518 -0.15746213849884430069 -1.3074538553035164323 3.614039782283835045 1.9097970609236873951 0.084176360532883798271;0.086270748395672655628 0.3006874395101289954 -4.0376563447163720255 -0.58152828896989705587 -5.1275836006688564339 -2.8720539318299764808;1.3223406102190078393 1.5274954963636055982 2.9033348074252471882 -5.6463355012571421199 4.4796796253045130243 -3.0322960021801668162;0.11130788227188015416 -0.061770292687085927297 -0.22203089537664710829 1.8323787756980889352 3.7806640270400113657 -1.4963807414340066781;1.6321475373823017829 0.32067786936082093296 0.064411613549617385832 0.080456416800558858138 -1.827881702352453841 -0.011820195642701515626;-0.89671778414650449296 -0.20360136819727195356 -0.91693417841606295049 0.23082637996896762655 2.0079783817168705973 1.2751093692135462287;-0.99982048044865889924 -0.32240594436001768219 0.78274806533281215959 -0.10767538088895128867 2.8723957891349840565 1.4902158887385379415;0.21757915283307671661 -0.31414335899529688412 0.48475401935039647006 0.46879566003553263531 3.8007168455859283718 -4.0811364472782640789;-1.1589845898056139184 -0.12920928695833266975 1.2591144458564711428 -0.11998497099966654034 -4.1955350116083254264 0.42620944078709616099;0.96573056032010884397 0.10172799265747292652 -1.9838592874405402977 0.59682982328560396645 0.57327902019813969936 -0.20565950736766819285;-0.54461714774083014312 -1.320031834760030387 -1.905377467545575465 0.95635705399881631994 3.6435037225140782802 -1.9851038465875294747;-0.31309218526364163138 1.3274011097020737004 -0.18113783454146772933 -0.43515891357768854419 -5.0925404433231058476 1.9646330937690241747;-0.40124371699224298249 0.38748637239534866605 2.5919334539776897053 -0.22848562371643588165 0.2731102449119230946 -1.3329755515011401101;-0.13543787580443708563 0.50730669259395710924 -1.5297208356549298891 1.7243052801749030323 2.3949176465498749344 -1.762966247281369192;0.14393889582100138913 -0.42391146433165627361 0.99425055054297628576 0.20102678113105995616 1.3203392253945402945 -2.381134262795745915;0.95565363266923131214 0.31670697835007677323 1.1689606614862357858 -0.35271280928850617942 -3.0782610212524237348 -1.5788480690128716688;-0.91722398433381435723 0.31875395023609032208 1.0504021452482954491 -0.40315153452444235649 1.6128634679434634691 0.67602488905352986492;-1.8134065816876916433 -0.7205342770248633899 1.1851416042266831319 0.11731929919078358526 -0.93495360966780383105 -0.50351707675329682168;0.63362153409267274462 0.20851989263928963347 0.82193093895183710895 -0.24908483652812096754 8.5229723341444554308 -0.70745703754633293414;0.8170666895431086818 0.15712141825954389907 1.4453441455785964731 -1.0257729084268354391 0.26843199309902382454 3.3446608313942247648;-0.43194672902795316904 -0.233756671045197012 -0.33798409971913845329 -3.1199198731058257472 -3.2913274232908049655 2.0657247965445906246;-0.83714650168196391711 0.46297103424695063012 1.1693981550832706073 0.10573599410591025261 -0.72502723675463376374 -2.2866052596855168666;0.041447321557065375242 -0.62889268950259424873 -0.35006215248371413962 -2.7124506555352723147 -6.3193109137752871973 3.9070314684086304702;-0.61767901295600879941 0.17303239503803724553 0.19777584858970775894 -2.2478470062302235988 0.28020544475461445222 1.0462973647165256796];

% Layer 2
b2 = [-0.74347331032473928936;-3.2976551746905067297;3.8504733553594250317;1.0552441705149122608;2.2252795841649497532;2.1611596993701462921;0.5629040720953677468;2.1958688136899549015;-2.6108917918695047078;-1.7314145403945881974;1.6157096161549220348;8.743506137347862861;3.105840859229836326;4.0216552260723723577;1.3982620493660584682];
LW2_1 = [0.53117065683376951668 -0.93058442249656325718 -0.46248266398295317936 0.13663213998958778639 -0.52800324506688534054 -0.97305477197953416102 -0.082394361368188437367 0.26774733330320804603 1.7384694679361989422 1.206079987204002002 0.99724745293687722114 -0.80406789547553536579 -0.58941972445792434332 -0.29338246497506698107 -0.92727133310171672154 -1.7638172512837344552 -0.30721914668731187259 0.52697596881732289287 0.16311662707855115184 0.16283187900517948066 -0.03929748441440537865 -1.4865905580002898301 -0.31244885459973970043 0.72697872456569567756 -1.5491620427418941741;2.3726291724407961858 1.3398452714170681066 -0.81314722191825172803 3.4508705976471452104 2.7020773925841967689 -1.2866974768778849381 5.8262187669611202878 -1.3546610024175904652 -1.8436897136806182917 0.025345544957063703695 -1.8627304781726354843 0.43070628372811636808 2.5500625175989255489 0.056646914561316902281 -0.86734513997878459612 1.7062527681870029994 3.6070116047024223249 -3.8123065320958429147 -0.41718831660297261976 -0.80870337158369576258 -0.2628808732331793796 0.30838395001792123784 -1.6003183229726778425 -0.35133257310028104259 3.3378854494029464028;7.7255341916972337657 1.2449832487303358342 -0.31972638363035016384 4.2105492893821772071 2.8021124005143538405 2.8703051795750020858 11.510178743777693455 0.16795686924143449215 -4.7785265202572482224 0.42233085250954133238 2.0079129398859802969 -1.4226506582366573728 3.0120019685103320839 0.22074960992149267325 -2.4586291251800855839 4.8519900458214770822 5.1551142298998202662 -2.1063996737258863234 -0.81147366881445426312 0.39023218238945417413 1.5663967415899202607 1.7866954974289492863 0.19574398823594715835 -1.5431387112784105131 1.3413509473242470893;3.1966220951572532627 -0.63569242265281122872 -0.4198704703725764098 1.4000031343860721567 1.5787074281748767479 -0.40010669032656737132 2.4708816340536761125 -1.822049848292352614 -0.50780578601162063013 0.43112738353139340441 -0.6057442770540248933 0.12795337551291394163 -0.14428015850732892056 -0.53649780240999811465 -0.38819126239827728142 -1.8162833871873442781 1.3264239283340895081 0.84405019511107837182 0.2503677868281056762 -0.42277931830842807592 0.92294054565420280412 1.6528947116105288107 1.6069539710846505454 0.55638216946555807407 -0.82454373877643649671;1.6709087413218677298 -0.84453270823183324012 -0.47311509453335293118 2.6072202097972581036 1.1664648951183591574 0.5283865714293077831 3.2064588632089305875 -2.593559271373800712 -1.1794306876034739151 0.55794048670014551039 1.3464485865114073082 0.027378805740463446616 0.51437585883970082801 1.2806112556896320775 -0.91537245740182460185 0.044259198932813825778 0.019623096168306038839 2.1384185623773626084 -0.093682678719299083969 0.58574790999319037432 0.65358477005033766005 3.0147077234635450971 0.099585370678980031367 -0.61644406344002877773 -1.9277545871744665718;2.2795946089766490061 -1.227806884509905494 0.37151849959451521688 -1.0911015175942821998 0.89511278571057950604 -0.68004760634248828666 -2.8120396818000008565 0.64074719349589415174 -0.033902948884475855862 0.02489770523942531899 -0.34725325207444113218 -0.47492822753123009605 0.11471314847622537947 -0.024036288750122754981 1.1333693849104262696 -1.6973201345052479905 -0.22207079617537173188 -0.42562181178421842898 1.0723988811371392149 -0.52869256514473195185 0.3507648662515592819 -0.11627966576381702779 0.60212526900697738164 0.13778015075862318217 0.28870131671740995039;4.8144768660389978265 -1.5659970549939505879 -0.053573236463234905069 1.3149306032792580368 -0.2785330188425951814 0.10490346679404301267 11.117499779985744013 -0.87500961746641603423 1.2294867827660687087 -0.87728062493980896175 -0.68510507557510857968 0.10782343573116183466 1.364923461004475147 1.3306836627949754082 2.333811178113814222 0.89475907404764043473 6.1759998260118278424 -1.3288243126725449716 -0.57278181630106195232 0.15545884097532802759 1.7038051205648390152 1.4447176724849286611 -0.27323491505959845993 -0.59094697059333178846 2.5779716847788334277;2.0790848306918512378 -0.63420621431462564921 -0.50412378414584713138 0.42396234526422499345 4.844491069878668732 -2.6394972692777312062 -9.1917835539407946044 0.30709391966019528031 -0.051472443851929769454 3.9732953128241108587 2.1442097195358411632 -0.90887540149227996622 0.53246123058689709406 -1.2736619851614903176 -1.3618867797491902571 -1.4848934826125532727 -6.6915744019826499667 -1.9329460176635164803 0.97740956038255799587 0.24683240772694181597 0.055798270281478878907 1.0572532415955506746 0.084155418289360253703 -0.049730565379320336439 2.7203522907846617862;-0.60573373524965790082 -1.2823181731099457803 0.043360822388183450915 -1.2873888744523631633 -2.5392116674339790805 -0.41566551789927486116 4.477327550709952142 0.33772598213853999294 -0.41149268641821051817 -2.2134670690036628571 -2.4177451213378522432 0.54073294578802577615 -0.2669198410820019518 0.99882659662586636973 1.6073144599220108297 0.57118741738426825894 3.1206211056855726049 -0.80423606378514034265 -0.57374813656625767155 -0.097231326420805633259 -0.47959557206889436021 -1.2070445166555312522 0.016122934673763186092 -0.35631393342516293199 0.440570560977948944;-4.0018787679735625673 0.69596030003954179044 -0.061919725378005184557 -1.359998291955971883 -2.4889477561839519204 0.39403940020284766721 -0.60298056083915618775 0.49128201823797951198 0.67764271965612266069 1.6277192724619631292 2.5450184869952194866 0.9553403640423299148 -1.6055541396000001519 -0.27988221097422455452 -0.052505527266568652323 1.1798538485536387288 -0.27248755757406040168 0.5558968537768019802 -0.54119655710978420426 0.08348446816868558551 -0.14758179496010737086 -0.35266716510760559578 1.5643944183243072565 0.21193453021121042013 -0.4583191474318967229;2.1683702242889690837 -0.07349351249424460053 -0.011152780436538979603 1.2375418246853777671 -0.58917496439491390259 0.981665489063496155 -2.2291257804977742119 -1.213358004160528747 1.6117943302658146454 2.1998907701690382233 4.1554467120101259425 -1.5118467747207884333 0.37262412043145276552 1.7635887647010346502 -2.3631722313101204413 -1.7018886387028091534 -4.2736264506243930583 4.3186242336795794827 0.038078608307022289436 0.79390235462654090703 0.75293683625533402992 -1.4259356498360660215 0.25302960391978351895 1.8353623819707973741 -3.960660909400719909;-1.3184881066898788138 0.92816413165184474821 0.97166050825391547807 6.9145434673143943982 -2.2233784135878851274 2.7759873582503864498 6.6005969800535355674 -0.80657246573321972338 1.4072119957214286323 0.69302241929021179967 0.044779552557126761636 0.91473488704939498461 -1.7208899853654855416 0.72300241466840609039 -0.53723356191480564625 -0.3152667340899723003 4.4133179245344829056 4.4517704580463517416 -2.0469562590093461907 1.4056056617951890875 0.56683691702450067496 -0.92537904056890796234 0.20075567471723326785 0.1755269451457634744 -2.8593144972922917013;-7.226929729225768817 -1.0083247338077194755 -0.018613490845235856896 0.6647600840915806053 -5.2200420591628473588 2.5895840164336676459 9.821072174641752639 -8.4442102694150911191 0.55900671107827915041 1.0296813527536163857 -3.6884086245472982313 1.7542562916270685314 -2.4061599907982738067 -1.6145021376169534921 0.29452261146210551024 5.3518162622893026281 5.0012115638572325338 2.9709881975215277627 0.78893334243835755437 2.2533635940387664043 -1.1779771559926695002 0.68013139589160176435 0.13721695416956197766 -1.2858731686578037667 -0.081073663671830081823;-0.0019995798683896115477 -0.51997377861733240501 -0.8674197368143842235 -0.11620693223619385503 -2.3041839896286608891 0.15229697269021666428 5.2598358135430887117 -2.3563266373209166282 1.0183905097366539039 6.4102634785234915427 6.0001716133907674333 0.90154036046441521357 -1.3448596516436812642 0.083333830442325659837 0.65012564792352856013 -2.1187068641418389525 2.9076721931713405134 1.6714224826284873604 0.71695776164952473852 2.9632769612297260586 0.066260006333756338304 -2.118244728045381553 0.46563047330591811335 1.1472993110572813347 3.0083575992155418;0.27356275330582779937 -0.36642345453074520734 0.95916612789295330188 1.0392499845050813256 -3.4406999575891368259 -0.21356783293157985404 6.80455767367836728 1.0659016995283046025 1.7657893423028347968 1.4166803933988041386 2.0116580513817732268 0.88650630384161044351 0.458219845058586428 -0.56770691384708138472 0.70373910961982955037 0.27721314098969640494 5.5438220363651327105 -4.002715842424051651 -0.87295168877715023648 0.88459056100931776623 0.76900636856872994773 -4.5227403283329223882 0.64746442366144418834 1.0874945858598468185 5.8778380033726902454];

% Layer 3
b3 = -0.29067857195927454539;
LW3_2 = [0.62221427749371482907 0.54860540214438213713 -0.235385540455621739 -0.83213877305103667315 0.41167844323761410008 0.51546395440761816342 0.30546391808960193792 -0.28807892486445779712 -0.65992617197262137818 0.40202990218588413596 -0.34191952289366389639 0.30084666468194687372 0.098653121889036715642 -0.28574050952616003585 -0.21818639348056181881];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
