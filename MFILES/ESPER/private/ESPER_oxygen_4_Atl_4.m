function [Y,Xf,Af] = ESPER_oxygen_4_Atl_4(X,~,~)
%ESPER_OXYGEN_4_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_4_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [12.83737010849965543;6.4572031754164358475;-23.449636736812564664;-14.855669574950679745;37.987250137275609063;1.0825609035626597709;-22.505373036096511186;-28.459331722430579958;31.312869826877300028;5.0487349768788813975;-6.1521595590537012654;-1.1646866948844127876;3.901873456956663766;-7.6059133804220291353;-3.2329090315285538004;2.106799379661128846;10.495652268900180104;4.4812468514980823286;11.804015913419988237;-11.193707916963687055;-1.3135782749322295615;29.135039869891588893;-8.1096122055358250691;14.589242351698860745;17.276104492891793285;-12.247874384604168441;45.139255738975847976;-2.7067267809217079311;-34.89852273437545449;-12.858227219318914436];
IW1_1 = [-8.4735596665371399894 -7.6496325450880835461 1.0750758975392769035 -0.28285362792414209254 -14.346626403899520596 -1.950641095535506464 -1.4357688475005891959;-0.98500518563204331191 0.11715894246196285888 -0.53221873066993197199 2.5625342496603789044 -1.4931109564288234104 6.2713155600294721026 -2.7695202920128916269;59.565718965562872711 -68.290965583051914223 28.806233939181069559 -0.66917384575753502407 -32.061923163413098337 5.3892420042132522795 12.582893983323097942;-0.21005137411126773017 0.34808449781150602176 4.1158674486302997408 -3.9741690123633590659 10.20659979358081948 -0.37804871552728447348 -3.3594817860987586933;-3.7542712318831394924 5.9703115586830692862 8.6946545500914069748 7.2623690447778868062 -25.551661774909113944 2.3230303682241597585 4.2087362456967198909;-1.8238855268695930434 1.5236420361643010501 -1.0219611804878778738 -0.46990816050201700271 -6.2915358055197012632 -3.679810955072656764 -3.9156989728110240812;12.790637378975159066 -4.1753739314968294494 10.496018591342275883 1.2250758872936782229 14.028451902383316963 3.6044395272258391572 -1.361054261180533631;1.7747206649014679591 -2.5034511106745034326 11.381130742618562834 -3.7502237874445292221 2.2268307694462476931 -0.56303786375457909319 -1.6960318728555339174;-4.2000211129651594533 1.6015502944961035325 -2.0566690175560951026 -1.4939140098727974326 -38.764536408582067395 6.040846513738156176 -2.1148314017390097419;-2.5652696173787741252 -2.5798928908303624397 -0.99925184894694230042 -2.3545402504793795373 -4.5229469507134973938 4.4281168865298230486 0.044608971829226830297;0.20498260400160095429 -0.11581748651974632658 0.092008349692337385028 -1.5491157018006276314 -0.4930123600980221843 -0.36261836296718685801 -3.7665844240113952601;0.10482647700535664692 -0.26238692886129955095 0.91729601118564418893 0.6368003461889645278 6.2565779361225279942 1.9877804265247949189 0.27171789305065013886;-0.041102002121076619545 -1.1308520243357378376 1.1930532057546985314 0.68119290733745263555 -4.9403833297093875387 -0.7098193218987155495 0.73448738021026471756;-1.869361321516491925 1.2587241537816729053 0.8594878756852004642 -3.8549155340483438614 5.6500617116236417914 -10.920784041082976401 5.6452779532293408948;-3.1579260294658593189 1.7124770608108481618 0.23141503097258395161 0.18775076798507575604 3.0471401932387855993 -6.6011331495100700195 4.0307521227517915108;-0.80147495057219142467 -0.067868673460243722495 -0.57942187860605587346 0.38607702099619906067 -6.9759918789104888859 -2.3356452611025164678 -1.7304400868767810806;13.355726026170236409 9.4971915971430824754 7.3154610162862949707 8.3152085446837222804 -9.2526540040134808152 13.98056232837340751 14.702663144854160038;-1.8253516512645149295 0.54463418431041188406 -1.1818666967818978186 0.83231119355738225618 -8.4910284908965074635 -1.7637706286880678874 -1.3137835811407592157;4.1129986680494665663 3.5732383929595874505 -5.785462378865559252 -0.83891737641987895735 17.771935917760220747 23.080454010532207576 -1.8123153695489748749;-6.888379396705141211 -16.968309216972560449 -8.9708969190625200696 12.496547597697116316 -21.40508299495251876 -4.7838792319058374147 -31.424856914784125905;0.081229715122214746215 -0.048439019311084727248 -1.2997221221722989881 1.5862753356746546185 -2.5947488909126570356 2.3856969277233304183 -3.9904854928180659712;-2.3959295664445288132 39.325197619417167516 -8.6198003684863415685 11.279419911633951301 -0.98101626933598840008 -7.6096968223688969957 -0.58475867120998503701;-1.1334923213490912808 -0.11251443136530506206 -0.85541225099793738451 0.90854324732854008229 2.8972670121499182194 -6.4539143530611573496 -2.7232280513830167124;-3.3244718061203761827 -4.0186794871482742764 -1.1341539818041332932 -0.33993994829414847514 -10.330340919163532476 4.8493834355661284974 -3.8314190050717309433;-5.8073670140872009071 4.3690488023635820625 -1.9736476228568895497 3.9110119716014781766 -9.9931996729264298551 6.6844929401971562299 -4.5573958499115807541;0.20880064385856436648 0.080111770206730659183 -0.99629440744591146739 4.0224840893095112904 11.611162393384686808 -1.180586771185908157 -8.4039257155874977911;-8.036528078568812461 48.39275718270430815 -20.913694815918905334 0.45444470573939071967 -7.0882514135077032691 6.7185998676455866985 8.1176170889534891018;0.81373064101865766329 -1.5660108704770887567 -1.1854619101684675808 5.0455592214076459001 1.8222197932842922885 -0.69386325585722197218 -3.9830435363646037317;-2.9366281209805129571 -6.9542332184621935554 -1.4961559693916168801 2.3168699046163641064 52.910670330977630726 -4.7219969741720051459 3.6600218985154366891;16.437628952887944678 -17.671488351706134523 -25.590391537338298633 34.749175585380484677 -22.868674775938441002 50.974905366604673418 2.0289522688201837575];

% Layer 2
b2 = [18.693892985214365154;31.295895587337167143;-67.484171079645022928;-95.789945190199190961;9.7178799430804492232;112.88191696923910001;-6.6200605659717277618;-3.9929726549185273754;-24.331309474742461418;-0.57168117998646184041];
LW2_1 = [8.1117042780152139869 16.445937889567858292 0.90723493863641557766 -6.443725958735053716 -5.1104051192462147668 4.9983983087107173304 0.8392530923795874509 0.7578743895563009314 2.1826637093632732523 -7.8787611439235503141 -5.0036735360609956302 -10.984351978475151768 -0.64091355091620094697 -3.9602913743742220731 0.79037764397306242703 -24.557808995568993993 16.66098853995283946 -1.0427644757748868454 -3.7405649392320032831 0.041408426298327985493 -7.3387664460982371395 10.015388875251890255 5.4477269979085738427 -15.397205170748174297 -7.3121828418548204809 1.9338795901133196686 0.36839559468028532097 -4.2284681365201386427 0.91607896630359453294 5.0599860774695377685;-54.741484620340180811 84.462414903500061314 -36.450065160098681361 17.072747804994563126 106.03618150681673171 -162.00078628271810999 -174.58464107764766027 -33.048703441565628225 -26.531641839849893216 161.41347607049712565 -19.690943707849942967 -142.56483342257675417 -22.063443330808411247 95.921472138248148553 87.063085748632360605 -131.70287125642113324 78.605099761176774109 107.04774589992155143 67.84201848110267008 -59.920703223630411571 100.1531275854588614 -32.56574868820777624 11.287309713476869177 -24.056013021824494302 55.457169350773860117 -30.616905289787474942 -103.29250127182798735 64.780295022361812585 -98.393964045533863327 75.690389750962253856;-11.626617981080633157 3.5216944920156958432 -0.38783083127671436063 -5.5611354129040622141 15.879777277926454104 7.0754088643688977101 -0.93836033205013591463 -3.2836396874585678241 -10.776259346763810143 13.998707792503196856 -23.082307523522786141 10.370158447932636747 -18.162410903650101801 -5.2492199792363081201 18.921292442130312139 -55.338312719456730804 14.652215749830768132 79.01591307587361257 23.134885638340087155 -26.287891245419906738 -10.99724957792760982 -15.013148261045081711 -3.6317718532660339115 7.2802215296895642638 -15.206676624103298678 45.98648361627630976 18.971512421234880463 -33.275556937792615031 -6.296358954082497128 7.2768378785111798024;18.381474448303631419 -10.651732318679467681 -11.949208886076185365 5.7160762784516094825 30.791484634556383071 90.206020666058918778 13.801685354076631995 -3.783887510215973915 20.460624819914130512 3.6005923496687106677 -14.845337431651348226 -7.8680504114255613857 -1.0872120837082432931 8.1459737164462477921 -2.469199427051946838 44.993161578049992499 -67.807444402491213964 21.86545733926332602 5.868991672768197887 -54.103273484676165594 -10.427308911658107249 -10.676655405302893698 -11.816849656323864082 27.446346028113154603 -4.6845992667986680047 3.1503866419294519474 42.892936208947006094 -10.210967764490284537 28.778405647512986576 -23.566764809069304931;0.011061931620983383312 0.1233505523871007703 -0.013121145026198330688 0.068213183460042348116 0.026186673420322308797 0.039799360280969885151 0.0040812614488776400093 5.7272288562625055519 -0.0047199400994349062152 -0.042624763329248346877 1.3032992672454535299 -0.49345597207091046466 0.10500952396577628578 0.03979393582188053835 0.13140242951421340911 0.15793650771968242852 0.010046452458007563285 -0.19517639069601733226 0.030422877023206378738 0.0085475866438588146007 0.19268300831557030883 0.019156120191159777683 0.040642134989440165116 0.0035406270937598364502 -0.05227522229953086158 0.059747616889337294699 0.0034407424361838621386 0.073880529793967072982 -0.00086187915581846497558 -0.047769267881730990977;1.6399035435477622435 -19.02105330622908852 -14.021764007120502527 -19.513502975876434675 -41.185089434675766995 -2.139078396907486912 48.234652502061948098 -15.921812758827112333 -9.794602801034397288 -43.342753918688259773 0.36727031136005949818 34.085721221086032529 -33.696728422877463061 -24.922277426512291498 46.069981707539376714 15.617953196246050496 48.471206766070544347 30.2927225352265026 -6.4428480281611530955 36.754959387653514113 36.618838039358287517 -4.1413298062403027799 -4.1370519096921514191 -18.695619158430286433 2.0405088351633291488 -34.602300136333106195 -14.301455068892707345 -9.3764633855738903634 45.629998944423959983 -63.551014522460128831;-0.010435976628605618532 2.8883513435644427858 -0.22441476255009940033 1.5735890816215944987 2.3168856611110060228 -3.1784848850007558774 -3.5186622392535977788 1.474533660016615233 1.427562921870556556 0.081153621190588803858 -25.387013887237401377 2.8038735840849700054 -3.6575268901584916392 -0.42248689556124896516 3.1671364706445110926 11.968473843283575775 -0.10279544465111943585 -2.7769721999700953674 0.43583720115853730181 0.12479381867124710037 4.6402966909595821932 0.32667940950908463948 -5.4461199367854966624 -21.723293546472678628 -2.3831392273745084509 0.62335039833761152206 -0.12028155121071743006 0.26533035099415080982 -0.50775940926131624131 -6.2559152982853669656;-2.7452668262958224155 -7.1737223689176614627 9.6884438307262676915 0.61945389398436834227 -0.53888661341537702487 -1.3605625627903035202 -10.42854006134700029 21.775577565617616926 -11.387921410633563113 16.808582291037353684 -17.97356327282715327 -19.342066688587927104 2.8031298523025500735 -12.648261219239090636 2.80109116592771068 10.386296889653152675 2.6340664657020682604 -22.638128107720344673 -21.709912405504464772 -2.7812251664337117596 4.4686025409777148099 -13.615543680064899235 7.4888056434490231084 -4.6543704846948390497 5.9200737817671091889 -11.061358579446018524 -32.433960932113038211 17.035830366646134593 3.8920416217129738534 -4.6422788796543041911;21.971645473297581219 6.5324995630210738184 -3.303610965633016594 40.549322845420277872 -18.381710950278215222 -8.414333770046187766 -31.270508019504447361 -3.513433009395849016 13.458477262567598132 23.81644974650023272 -15.551142675573917273 11.971775461379577266 14.231172238826001575 29.379639215153382281 -22.940981411847271687 -0.12902873509802759155 7.47168437811351005 51.231099574347730652 -0.51300018157718907386 -11.751461443927794903 5.0474296227495667466 11.252186577222687447 -19.784581766592420848 -102.95711639011757654 -3.0010418378883230162 30.857641560517926393 6.9923591401538249812 -20.937039214957035682 -35.499663067305952779 -27.143208390624696591;-5.7650825549449438157 0.32842375819159791428 2.0787017443756865553 -3.5826251736863876651 1.3158099739035407083 6.7058884422698481487 0.11417555011859242819 -44.5879321978270724 -3.7013455158614276819 -0.49584730973451418556 45.234105819141966265 4.5743245107063978949 1.2245498834443830916 3.2254288899498089194 -2.6869665959976631875 2.6035946976694757105 -5.6862611555438205002 -6.0959540847942808028 2.5014171224680104011 2.6728414114770226995 -3.2106518506055023998 -0.18381702638358493607 4.7018492440337711358 -0.58707730937889446299 2.0488669703731305916 0.41847852783792416353 1.9262853371774197875 -4.5191170429477871551 0.13483628235087696812 6.9253128977630398211];

% Layer 3
b3 = -21.519573997212628313;
LW3_2 = [-0.013288835389558745215 -0.0046045999544640330015 0.0068882327615632761922 0.003669160516831756081 21.861657794852430214 -0.0084839300703346311183 -0.052502567093035273915 0.014153872027497592379 0.022867611247747339498 0.029311630662357115312];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
