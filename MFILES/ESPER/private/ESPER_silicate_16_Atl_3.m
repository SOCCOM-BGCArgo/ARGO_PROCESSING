function [Y,Xf,Af] = ESPER_silicate_16_Atl_3(X,~,~)
%ESPER_SILICATE_16_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_16_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.2593618296492584685;1.4732179840278916139;7.4553077971605548058;-12.065016362694679586;5.1426303605068479641;4.4687853981765819356;-3.1885589941034715444;5.8513234251201415859;3.3839004201278171102;0.48415522811313799201;-1.4348362194379189472;2.5980509655204322428;-1.9016664670733920417;0.40047593485226068433;-2.9726593861977557154;0.30134698228764889016;1.8659146182918222578;4.1018374673758062343;7.3634074831189320065;-5.5249736673173579504;-1.0097676533555905998;-1.5469953075478888316;1.1939769202112708868;5.6726526378350365931;5.2838707017599864102];
IW1_1 = [1.3891373919145104665 2.1956194062510583365 -0.769445048951747812 -0.46473966147470158194 1.308830519948291693;0.17819642543504105037 -0.44308004457384225772 -1.2910052116701997704 -0.58875998166303100678 -0.97210869985632752943;-0.19244967663616369125 0.28948765256356279174 -0.70760791759287300362 1.81684448474953264 -7.9158786691790474777;-8.9151352880484378005 -0.039791230386958059695 8.448231585950333411 3.8351925278755452098 -1.4945815883965682946;0.030903294833354921084 -0.03166286448637350287 -0.44084789767866033872 0.031028464992635406555 -7.4761651795829289213;1.3624490108296385404 -0.66117822462642061865 -1.0572833966777450687 4.0974902902150756034 -6.0784504076108385462;-2.4649191022716463451 -2.8046250264846470657 1.7672816067445333843 -0.82732806019189208957 0.65237814266118110407;-0.57573408470991038755 -5.0082884525070330284 1.6373729776598719976 6.6659762304054863691 2.627958754759075255;-0.82726461166604792208 -1.6482958415631490112 -3.7327399460803443176 2.2652140065387804668 0.85222710824154179754;-0.75326114086200368636 -3.1636398727338246317 -3.1397569696411098406 -0.26392332700019921488 1.0576750002789494509;0.19782150135816295444 -0.13875134217709525486 1.3909484354318122357 -1.2641613623575342906 -1.9595710978132734326;0.5550642956584924681 0.62576501252659111341 -2.3457336255005363235 0.29287721337726690951 -0.64205340567288371467;0.70770208833006864602 -0.27256031006238856662 -2.8912167366225922649 0.32448491506373333682 -2.057605303249908868;-0.29578768240238173526 0.077373404360038991467 -0.77748504445229071891 -2.8151504612859463705 -4.1900390610790418933;-1.227102193608684555 -0.97783927274903970073 0.76129771431131021409 -0.51175761023225396773 3.1338909956146925317;1.3616194827238339293 -2.9640977753933994698 -4.0490043001339799389 -0.71598066514992553255 -1.8188635377732729204;-0.23472726766123075404 0.33027340612983330237 1.9426555831258531803 -0.65870924230396321608 -1.9023205439333989997;0.46033283939023794673 -0.17774550254884718958 0.60971627200437672478 3.3522547104617363978 -2.9136323205877214804;0.85227071681623145505 1.3527672025811694478 -0.99931026442191872583 -1.4850092330725466194 -7.0579283688744274272;-0.98745963031826389233 0.3901848066256324854 -2.7882670154588735656 -6.5803010701144399874 -0.14371829331175833833;1.1611920955519479115 -2.1666686933853509522 3.4587602826787069432 -3.7417661665188539644 -6.8470677261790182655;-3.5203746565989528783 0.16812161522422836013 -4.6952927187335182779 1.2738996371233510807 2.896784499797457002;-0.22916065093390580731 2.4476924624313340928 -1.5517899661128347066 -0.35181965921431274102 1.6128405844146791459;-0.24121538789477711684 -0.79676604400129868999 -2.5083991775280334302 -0.85945966971411114077 -6.2451545991372361399;3.7745998207861930496 -8.1834562831986978892 1.8465492751169712005 1.1564830247601076696 2.5885159038893643668];

% Layer 2
b2 = [3.1127619156637162945;-5.0609478322629746216;8.8510765000137698877;2.7449741575765984614;-19.318768739287104808;-4.2145850572388070532;3.8499102442420367609;5.4165219848260584001;7.8426575000866298737;-1.399531103981587199;-2.4752177764896363676;3.5978908348293430208;10.372692304625328319;4.3454134976264224832;23.00836436669072782];
LW2_1 = [0.25994449216215753662 -0.21091832392399426088 1.22472990247820257 0.65766779828006927122 0.32929218289145073539 0.91003632327045647088 -0.70283984907116647811 0.50560406809233993108 -1.820156261067252812 0.98855933107427540474 0.73436885851201483266 3.0312745699793319787 1.8516669824959808288 -0.90901579006572807984 1.8864856830511516073 -0.37212283095503845276 1.8884524229783321569 -0.63079098802567268311 -2.2198999966304633347 0.3788818573070698581 0.85727370299610172744 0.27286629834042669396 -0.27126656913111957259 0.026802859263522924027 -0.3217473560570842106;-1.306586471702628538 1.3139520209785677807 -5.8348773519741303772 4.0543137138723972512 5.2749191800446153522 4.9475795217325773123 0.17430000429237635373 -0.37481253661450192327 -3.565261916476754056 15.030347865847970112 -4.8142639823916093533 1.8241553245502479808 -1.1681182720750504789 2.0061733949851712211 -2.2388763981108699141 -2.4130515991246603846 0.99573464651007081994 -1.0032005006635076327 -1.8803007513626430747 0.85207232585198156016 1.058867564355934654 0.22051304953714737089 -0.77120325903885555974 0.72728084643803858622 -3.493731823100946432;0.66309652428880849762 0.3874763078834114749 2.8786075740080145913 -3.4673735256761162304 -6.0376567029606942327 -0.41459011012403895746 -0.3215310098768631164 0.83345564418435180709 1.9245837113090231707 -5.5545438594831972878 4.9391143165467443765 -2.633026808569703725 -0.092948334010521688198 2.7026181622119276327 1.5165052428282723707 3.4641831833619924907 0.60848209662815155863 0.22235732414342687657 -2.9851032806958235355 0.26528758143027386662 0.13704811575880376795 0.064221941612851912717 1.7692970459068675382 -4.2165399208178424573 2.1477975980626458075;-1.7840416177233038297 -1.507187957670973022 -1.0286632859260118611 0.59232036052780157043 3.5558296266397291241 1.4416235042986123016 -1.1313762311598705157 -9.1246754343223788197 2.4380665155253673504 -4.5961963130344303252 -0.038535497580717656407 5.0221594119629280328 11.343665791789113939 0.66002629083078945271 -0.3594968160211804431 -2.5830899226178676287 -1.1482063330220846353 -3.2335148910317426107 -4.3620655547258113671 -0.76021304964086999778 -1.3050517094143594399 0.03041512360591550751 -3.2428132016970314666 15.935367725920482229 9.7228577512914480252;5.3220140016167487573 9.2506985322704728958 5.0726587223829460171 1.9587962665480784796 -3.1743764187082970096 1.4658261076059100336 12.462968203776245701 12.002653898073541328 -4.7203996022826490986 2.0690111342316659382 -11.338100994786248776 -7.3900742409165633973 -0.84522518339048779978 -0.53116608567487977322 -6.158888306388292655 -0.10224788003716193951 -2.2526286288548518222 -1.7632306677162918884 3.2548703206385019016 0.35489724255502563821 0.25201784925922299241 0.40248140260376658039 -1.7447856484269854693 3.588155848582881724 -11.571184741696686871;4.2030727505514464681 -2.66391173617767274 5.8634480553099370681 1.9394226174821738162 -6.6098498216817604956 -1.652007645257637769 0.23301806139995387412 0.75785297425385289571 -0.65680334327119394011 -1.0564177133617191906 7.0771494414067204204 2.1854567277769954003 4.3651228316633581272 -2.0282514400503113272 0.333637920353170081 1.8832938826029119728 9.3967656450513423749 -3.8704214244173140713 -4.859070668022646089 -0.50820814963869553882 1.233852229536329892 -0.045906344335983832738 -1.6692906182234543699 3.1182977926969086546 -0.67187290371303554082;2.6229559662883485949 -2.7856676871846270949 -2.9335670969494778149 2.6108201710389646877 6.2386085874783940852 2.3663959844340980432 2.4377629205133550805 3.3032907118329344343 3.1342077986600287431 0.64225254298996703461 1.2793672866901537599 1.5518361356163170583 -1.7354014289480566013 -8.4345253789083081131 -1.7233874849466321866 -1.1686942262873971643 4.5325158178613262905 -2.3101291494484916811 3.7458201404974187376 1.7604211190047658331 -0.35064062272560786448 1.7447606035995584239 -1.7731578720221068401 -4.59271173697173829 -4.6236969390987097128;-0.68387737088396804985 0.27560725029659027818 -1.4700610383784153967 -0.65182325854083544847 -0.46040077237956072986 -0.76893301756219667453 0.54293319684505780831 -0.5928881696887137176 1.6365209096455108906 -0.72238667131064326909 -1.4774162840667626195 -2.8096673704219803369 7.1393112101507556488 1.4835948035866095562 -1.7479841982638086861 0.20199406429672800423 -2.0768558320247647586 1.0280975564184413606 2.6062751320936752286 -0.44042382881256014748 -0.78540284712517760557 -0.36003728511455429517 0.44024554941256494045 -0.25504767072251094406 0.36518126938733680431;-0.3204582003369928489 4.6828808774046910557 1.1902867659448861382 -2.8846570209816584374 -6.7027928861909575886 -1.162280434694136888 0.25628593082165035399 1.109642959679798313 -6.9833140041122163666 -3.4388371664838319752 -7.4756811182871913957 -5.4310910166547579081 0.92933199888040252112 5.7049657949879994945 -0.4663490452396508168 4.5428297951307952118 0.43299199580721536851 3.6157514036885296527 -1.4953285138047247571 -0.39290864781528700433 2.3120732614452346176 0.13727228258788637394 1.47105973903065812 -7.3297261522984777926 2.1984452651213270968;-1.0495218003910447013 15.64933928674170005 5.1668720291852237025 0.61154872656311010104 -3.2791850552350334524 -3.8371091615075103576 3.7820508236198575602 -1.236699038465957301 -3.7915674267829770905 -0.39691423620383520232 6.0914712606959691144 1.2626790481470964167 2.4571754282995703633 -0.6304471622295290123 -1.5711920335899689505 1.8591330193003161586 -1.2580145026366849059 -1.4685025502719888379 7.4264605876666482942 -0.040437039460930822299 -1.5294911230620553688 1.3102042817308097167 -7.0438745064573948795 -2.1923952309703640395 0.39017845047297045058;-5.3097893837449090526 1.4038950142686270617 3.1160093845437226712 -0.75733968464987566627 -7.3269212415796678428 -1.862815005458141826 -2.1706720203474203501 -0.043635451816484566168 -0.12475024563999739802 3.9549927601693193324 -1.4982457015511381204 -4.030581328088525872 4.4883147387595707656 0.24743390858145525302 -1.5310273319207872156 -3.08705709468379208 1.2909408620256710432 -1.2288781383411582215 2.7676040245889992342 0.55309949537914693263 0.56970729832722333263 2.1154718668596208531 2.9527990414182392342 2.6235630932400937354 -1.7176959624876846355;-2.3056464441949060529 3.6180641471450365465 -4.9996604554987440494 -0.89862071058024972636 8.9814978271378738128 0.70427224227181539629 -0.29479059672826046778 -0.54535003397508563516 0.68343632497091755251 -2.5273566457775071825 -4.6279881425218567514 -5.0444605118894481066 4.8648225320632798585 -0.82586319345679004567 -1.4239433687922622429 3.2769643412327957854 5.50479792992846928 3.3521611638711927839 -3.6055815896961287415 -0.15033647513209916213 -0.68060308601563623832 0.073746993398983690104 1.4981706973168167352 -0.49373191335862093299 -0.40729421215683908608;0.041587278020898593711 12.257449048444284401 3.5618693411035460272 -2.1184826515212571429 -6.9444995383598389083 -0.45665094238971010165 -0.20956568910101586178 1.0316525143697687916 -20.387888841092038916 -6.0099622026710566303 -5.6166879184173019723 -17.127386681785225164 -6.0359596911688413456 0.46866343833308882205 -1.9885178380463808256 9.5445038724951931641 5.6266827556497647222 -2.2399163356899287614 -4.3640062899361602433 -0.11384487710647581138 -1.895740436194480294 1.2918008951193749034 -2.0522988001448734252 -10.078713068169445677 6.5136077178348150696;-1.0942021884599606452 0.98971230360668960291 -0.075273017701101938015 -0.24923268752176352958 -2.153284366773751124 0.69140219229585830885 1.163883899961229984 -0.3475806076716292381 0.66899644399992919119 -1.2682734497227059478 -2.605040276806640076 -4.893790945135724435 0.59069009433804320341 2.2381568840890162519 -1.8493513215545855921 1.4851874397300557362 5.5203583987620872264 1.7201859064475251149 -2.3306308123979460056 0.82681853413696382304 -1.0100812026053569426 0.62790346187861190153 2.725117479621675276 2.2552944712091709256 1.0579476123366848839;-2.0733930341752988546 0.20483488617450540392 -2.4788847071010353673 -0.33131911475646041998 3.0339870671397473068 1.1173726752733335044 -0.82562015820230327812 -0.06087837864490978218 -0.54069925029807885952 -0.10877608156283855023 -2.7780168868131949189 0.16786370324319291325 21.863586299173149996 0.22361126214177315386 0.24026475274043418429 0.46202819184130528019 2.7351333422674484197 1.1251408790250705394 -1.8559999253266061814 1.4136394673428116509 -0.54464528965549063866 -0.94677449242642053306 0.89024723936531457991 -0.71496271602260663691 0.40346911577766036983];

% Layer 3
b3 = -4.6928316412948136715;
LW3_2 = [0.5358843215336914767 -0.20841692242436951621 0.99113014925562947788 0.057523081631538817982 0.89213628291941793336 -0.2391747973778871883 0.082286342057571584818 0.54089832124945336211 -2.5455285119504926783 -0.035890200342562322833 -0.039842373669724456819 0.070093574029688118787 -0.073629701322228319205 6.1755959883927493692 -0.32168599953720716789];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
