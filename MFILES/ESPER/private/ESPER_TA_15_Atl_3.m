function [Y,Xf,Af] = ESPER_TA_15_Atl_3(X,~,~)
%ESPER_TA_15_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_15_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2461627143519637961;-5.2184952179817383211;1.0726152040968692791;-0.39619739125104752597;-3.9181814623928490349;2.7283274827782664218;0.0075078290180326029066;0.63321115095131041972;-1.4821653198015776187;-0.11379726471836625057;0.29965173454338678294;-2.5928491786820897502;0.35148527282329167232;1.106139130818987848;5.2389026561328231324;-0.39534753603800099064;1.5595403664970959312;1.484423556042380854;0.14926645343028793755;-0.91020729579814907417;-3.7649205740717834878;-2.803670186543206988;4.9248642070729884423;-6.2096793462654629181;3.2753873734417404684];
IW1_1 = [-0.27606702173910313558 5.5531448742431201993 -2.4520120126545497108 -2.0022053427947947846 -2.6199342872555262396 -0.27874827877258456788;-1.571258418850874472 4.0773112957343471408 1.7135853139210102114 0.98613006627130583848 -3.5339279760611486125 -2.4398307292206267149;-0.41311445841464372597 -6.9229334144155432185 -9.1604288679938346007 2.4765364511923775304 4.1145188878856284731 0.59757056416664033893;0.20231341407456412962 0.60571894778307988627 -0.51909713631599863071 -0.72096844797158854412 1.2200622855560057101 -0.18437964758093153272;0.55789338485562789405 -0.62043273602837245573 -0.54199371045763733434 0.52990475761028887902 6.8962783622379726367 0.68717517106641823332;0.039461642645729572143 -0.62527138291568029604 -0.66187998149707860662 -0.12513413878928214551 -2.815928870947805418 0.16961852909975561055;-0.61030029477007996519 0.0049947889912968891982 -0.17636660693551908796 -1.0469924849072937967 1.1238223060920007335 3.1347458513011714487;-3.7691713916049303101 -0.12756627834180711556 1.9791920221483205733 1.2370544957559712618 3.7715039322800110178 1.2364957662092743718;-0.43463246520760401292 -1.5895010802681923678 0.74898026172976128745 0.4995312807712556924 2.2422670778830871008 0.46713364928145911792;0.083591256690080911751 0.15525385710367672898 0.6222013492431132109 -2.2440311221604414271 -1.0974581743755460472 -2.4740266408491549122;0.11456859015384913969 -1.028432613418888808 0.39732944454454266481 0.23163389445751536577 -1.3874064258794622795 0.20973265107058247647;-1.5334803159934469186 0.81491496590643319742 -0.54478023889929994006 -0.82648809585745330875 6.9261351597539846381 -0.91649254645896927052;0.49136275497265730072 0.47611262037188295526 0.25131982838401523139 0.75551470788746200036 -0.9239486337841398278 0.81297043406576952052;-0.62193276279010967222 0.62229273566513532145 0.11025305859288117571 0.0814728860884604833 -1.5658428587290245115 -0.11452901842138814292;-1.5628398580347913072 -1.0959228265255394064 -4.506794628655779178 0.65087903145653103198 -1.7636940842876702717 -1.3046332404321279164;-0.25127538539963401032 -1.3180803082596150855 0.31846495415205217094 0.44457510640802794244 -0.5390728130809495644 0.26469448631739761479;-0.74773274486428908947 -2.2694059740984999785 2.2340874035986675317 0.90331597409046726632 -2.4403580764224179767 0.2170970505380844795;-1.8670021768312599075 1.8263555551435231017 0.53710270208919819179 -0.82871262254441802053 -2.166828841725652488 1.6843038144479458573;-0.19807900365102790174 -1.6824149189062531651 -1.3481877922453429086 0.045520856143590332499 1.5345671506784925864 -0.34635400673864258358;-1.3307701279314252396 0.15168672556143927843 -2.4797314868448259162 0.55433420120270626708 2.3540814346845517768 -0.73985679400081871826;-2.3179158424760100132 -0.34566755687044564693 -0.87556993960917461894 0.66058853387255223044 2.8275718056331613504 0.21090857837949431031;-5.38998723922523304 -1.4262529430183834567 -1.0238775277518501472 -0.30856573165161704786 -1.1882710930600299815 0.2707456024714754439;1.4739676574340563331 -1.7819266338026689134 -6.9301076092542581719 0.2720564218593291006 -0.33240691707415925826 -0.65055986148807676273;-0.047374576110806511375 1.6385490550210042304 0.091598164864767364635 -1.4031376736841165709 5.0699272770256991194 -0.31817252413286245538;3.0926180973484829195 -1.053099527296990523 -3.1753740828154062292 0.13788934053905405053 0.31696678127502320166 -0.37448485449196011743];

% Layer 2
b2 = [1.4269348533816812452;-3.3842681981336855124;-0.16404501909814350746;3.6443537233051581659;-3.246853784276666488;-0.83933519175895521247;-1.8053408974819040722;4.1069941148128279451;1.6599243175509621473;1.512381288700230586;0.15635241070797950558;0.75813629976290952683;-0.066221995389872265192;-0.6279688916249714925;-3.2893871793487776678];
LW2_1 = [0.16019891637193023337 0.4654997234541068396 1.3849185758784137157 -1.3914037321672529934 0.5765401525084258294 7.0019935968375532909 0.053198748769351697496 -0.074468584554629124739 -0.85528860935701123136 0.71360241920623901368 3.2625313611879618314 -3.3983384800485607613 -1.370328163329951332 -1.1497414946974049421 -1.9817955495975885238 -2.7780501761682412365 0.46117881863717602453 2.0704744821975595848 0.34465583435630231524 -0.26724616970729248022 2.9439140189562245098 3.2499859561305735056 -0.83598034440955537594 -3.002101040008584576 -0.19913958224652525408;1.7882877770473251111 -2.4277117681884532452 -0.29433325354707901012 2.9046110078718179182 -0.240810311662163129 -2.9349077167828467871 -0.051110720871669228227 -0.54584278724182655473 3.8240974542958574567 -0.19917429351490872902 1.8345217608120008013 -1.7403491236134656095 -0.62282326666029852458 -1.2995285141040722188 0.063704082060272532173 -1.0896205742759759172 -0.61696770928529853784 -0.26592410337405752996 -1.0975817809768559918 0.73908191154913294163 0.94954579983175990687 -3.3603945076715651119 1.6659903499453618814 1.0273229402378540875 -0.29715543660893045663;-0.12096188713711455986 -3.9286836374519027437 -2.1252886143654432516 5.0052373857167831162 2.6303433865430201344 -2.0800662647654202253 -1.2144831919542340426 -1.6260409678229397201 2.6554467820689642288 0.32124540567988052464 -3.3415759191146214846 -2.0050768741036879561 3.9728985108002259352 0.95982666274325134648 1.2018756023708132563 0.89415133492966081263 2.7874155413195675912 3.7265312787716391441 3.9753927889266802431 0.12870472387678205672 -1.3818381553668219741 1.9576111346414064585 1.3045876045974922341 4.7208274427986136601 3.3713874843953668403;-0.56926860643899157566 -0.54108620301107579476 3.363438239651819206 1.5173791376254395225 -4.5619264025884715963 -3.2129251483103584697 2.219769853972121787 -2.4393263255215180685 0.38378508910734748794 0.77888768512789385845 -3.4372130673623702002 1.6114793879958766443 3.326827708266473671 2.4304984619610574548 -1.1926149306237174841 3.4320686277904943751 3.3294287123723913524 -1.5444749001482567241 3.2039689869807506106 1.8534769879948973514 1.5962457140135719591 -0.25643374922687395268 -0.11963351048546876088 2.62555126525259519 1.1372896427785050832;0.35760923128977439855 -2.1450698782088943872 -1.0304459077683154611 -3.1925200993374387437 -0.79248807373454832614 0.35698653848150108114 -0.091100839004760320039 0.65208844033874724389 0.93376136654561547878 0.33356405027570007471 -1.535659214642030701 0.16576361269266862153 -0.92795490387979007174 -2.8262721890629953769 0.8355203058545390693 -0.90130412475595156341 -1.1929372586858391081 1.2004708836906030633 -0.080906847019263913867 0.038022307750392239645 1.6558735692295443176 -1.4542334087804509313 1.5507756734466111581 -0.9012978990112117117 -3.092593963727293449;1.4370536377736291556 0.24680098285706394967 -5.1640438774779067188 6.0764964247365282901 1.7301230719331983643 6.6025300593757654255 -3.5264275483087241803 -0.63191891226538843274 2.7810249348725024632 1.4706110218453136707 0.64431036483698211903 0.84456532996101929545 -0.89082575931419338833 1.391707725055768341 -0.88943665459417087238 -3.3252513378314296766 -0.03492029295553505247 4.2446344381226168707 2.7943301117607703965 0.34526599674639740778 1.9020826443647678161 -3.5932944866213500923 2.9322340305915228775 2.5797398560873521234 -2.3139206492145745209;-1.3402838777022061389 0.028324969883640582768 1.9544577576403161512 0.95114777982577647375 0.47046336988921916289 -0.52134863398006148216 -0.3703034804064566643 0.71206382722636862859 -2.662112503864559887 -0.35809045961837693284 -1.4507183421570886139 1.5333927904239148532 1.4487006729844342789 -0.99998440818973999278 -1.0813142040285064205 2.2808261243839238475 0.59286052839153402516 0.1947578963866267443 3.6110788657423618098 -0.24807123161102032083 0.99564459057096066363 2.6398283452329627252 1.4968621105208623767 3.3238738680425710115 1.7911713411631025039;-0.68893105208155114294 -2.6306134886499581427 3.239297962873578296 7.2979481309801821354 -3.4150806588222684113 -3.5651841689971131011 -5.430653418298293289 2.5884506487535432484 2.5377213249116956639 -2.8737519332163583563 -2.6261177796887640312 2.3850262518518197119 7.0313864389503892838 -1.742547053848413352 -0.71822896333486740961 -3.6921173945192791166 -4.2744479653953666443 -4.4052019137148601402 3.961999036073681868 -3.5937578111078098964 -0.77245757501627565489 2.5519902843015254135 0.1633152749711648255 -2.0494204409679612766 -3.2310895873917502286;0.41178241435552220828 0.39348886464087384773 -0.061843334757006152014 -0.83320127837317814468 0.14858745625964861481 -0.066340673649262230094 -0.18781211497242494834 0.18173201449249923312 -0.97185018894990815586 -0.29895831133283889969 -3.4973427511355792419 0.11571746053559286982 -0.37292368171176853986 -2.3793864889866331858 -0.76955041889059727644 3.0875648548043246322 0.0024766395659324936737 -0.52726017646833622798 -0.7371701435237133504 -0.74125215456298221284 -0.97125614964158457632 1.695846663752043737 0.31478604890055533749 -0.031958629599977923796 2.4108822038481458883;-5.5562647712376431741 1.7751080871450286569 -1.853413405923617141 4.9851977076104061481 -2.7201290592274065538 -5.8875225711689340713 2.0659023318437101935 -4.7238457094855021978 2.909867691870869244 -1.7780759009519493397 0.17508152039247168452 1.3652180906014177442 1.1705354781848613666 -0.63152638482928014074 -0.15314132255905962832 3.5723373192274321397 -1.7892079433256911081 -0.31824824256500255926 -0.38240337832985604738 1.477761993331094148 -2.1773394377089934082 -2.0035075257949732652 0.78285107700848699519 1.2161179481122696977 -0.12238670000585261111;-0.61164613947901635971 -1.9757414027213620056 0.024513813503349989043 -3.2237785524109150437 1.564785264924765773 -3.7430933388296354636 -2.1016592227501895707 -0.73443844747133657513 -3.7424259793559340181 -2.3098805172737040259 1.2648852902721978708 3.202783965940564137 -2.4583835023779334605 -0.04609063119529885344 -1.3155579416308578189 -0.24649478888390591313 1.9054081081364215855 0.15348709413259115086 1.8850632960022315476 1.7242615145883495309 -3.3756251088166022711 -0.87170357700814571356 2.4067076492695766987 5.5379544515814433936 -2.7439522842651826728;1.0537496741023970603 1.0806271733549628333 -1.0212839455100950481 -0.38178989898916643186 0.12604825055542828727 3.5907659980848629644 -0.49275713962688050263 0.36711764821818781979 0.83105613103288700216 -0.50773872068544878555 1.6774652207484070932 0.0906449481189964823 -1.1815772322729714006 -0.76226394638923256064 0.26049009410658308106 -0.6859521073264939206 -0.9028077883860060604 0.42594890246514410803 -1.9085642364790444958 0.082646003146977092824 1.6202265863242144572 -0.48086071327663498787 1.5902460269215021871 0.87739957277074531738 -0.067109246731869270919;-1.3957826875065506567 -0.72400685412191512214 0.17850785611915931383 6.1338189941941951844 2.9576227531734562426 5.1147052818980380806 -2.8599737755237151227 0.19449527575875924512 -2.5965234549675715314 0.55825754348231870772 5.5692911250777079601 -1.8181268813675230955 -1.0331202976432962704 -2.6925356098882931022 -1.2129460512355432211 -0.33482393495340234679 -0.30416789611077621469 -0.5755764082956041916 -7.7449162195035228251 1.4699053716842762629 0.60282193093861735633 -1.3761120916735207764 -0.82801757724272551098 0.0998168369039952319 -0.29468930927020331456;-0.18584597803815575134 -0.040813434910025092606 1.4071013617077798852 0.94347364061891836329 -0.10461921218180554594 4.0973286511564710466 -2.7541973842088132152 -1.15294212482920444 1.3521211319936705664 0.90037939372135622484 -1.0994786233333861958 3.3425147658432368125 1.7159362989879054506 -1.746870227595286984 -0.85309392344477896764 -0.86631273263543240315 1.3465043565809360349 3.3394152678909532206 -2.396792358165899639 -0.32480359069802983152 -0.60430895448476162901 -0.67739171808779274908 -2.4598603122393760678 -1.9816232026074604988 0.72310240096756928097;-5.1511891566850804836 6.4744620542010471453 -1.6458031103647279281 -2.3137852747068530235 -0.60026710700646246366 3.0206488455500615231 -2.1763288765928514579 0.79589674770146368044 -3.4246088206781837293 -2.7547775456635310576 -0.52179985138505213804 2.7364087359308308933 2.5491970308657010413 -3.1551307145083500316 -2.9602037432898216096 4.3584182288743615885 3.0127665371186793664 -3.7111330722187063635 0.96907698329711644547 1.7684418025973944744 1.4643857394526946791 -1.0202079598356130763 0.66381119823414280745 -2.5478890145505981302 -0.9074672352915218454];

% Layer 3
b3 = 0.46512536931231435178;
LW3_2 = [-0.014629244927092393755 0.06146166399157591137 0.013273251947915615592 0.0074700049937501990238 0.64912994941265167448 0.0052773692922172925346 0.058981733846695513779 0.015854080402002628664 0.652144847360703106 0.0024941075877050211153 0.0060400977595958743951 -0.073332186005956451202 -0.011995593362277488098 -0.021909704036590229442 0.0020664864500944206925];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
