function [Y,Xf,Af] = ESPER_pH_9_Atl_1(X,~,~)
%ESPER_PH_9_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.8056410628906611748;1.8169317597205461023;2.5457733238287123534;4.6437267174281862125;-1.7836209297600249535;2.8158431585953116461;1.0555162061520000361;0.47881731400530863629;2.1191572687711777156;2.1283339529932407963;1.2291940465875650368;1.960439059201239731;-0.60645921869706920226;-1.2224902977532239312;0.52919675618185124666;0.85452683337441703859;-0.31788141000393249636;-1.3674827083993852384;-0.6065397360856266129;-0.37577841012509238805;-1.6647918025796202279;3.7627794441133568526;0.076768504730684097859;0.50427597364234300059;0.18923754004295087472;-0.8573019432933496331;0.99983219938723977283;1.9975282996712138139;2.5468850678401078191;-2.4198804261124067239;1.2605813165971784251;0.8072619315737230572;-3.0715854526336183739;2.8823506874471682693;-0.84779426030827398364;4.6321953990406958823;-1.3035470905655683893;3.526397538225618522;2.0133376942634453322;-2.4115428504338729532];
IW1_1 = [-1.1289503761363068879 -1.0485229915719960214 -1.6692400162500975469 0.9530191778548260384 -0.28319162229201289005 1.3239087911088467386 -0.11775298413089600735 0.85825849118831143425;-0.82076371448439777723 1.0721784987555034174 -0.57803520768994343104 0.49235833468435896698 0.70997099181946365931 -0.44608949715908324807 0.82590802660557671722 0.077909037538455502836;-1.7324936169324074431 -0.20541020833076609198 -0.27444568649070544275 0.53650012519827283697 -0.043738394720971268681 -0.51582363926568486345 -0.54186794781839442425 0.29027303185920039219;-2.3638163041757676019 -1.170808296129970616 1.9527126431558976538 0.26935288833803766595 -1.1161295081597930601 1.3380295326379338938 0.14782775602349076949 -0.4220632964506146334;1.1093258941986765542 -1.4385218357611349038 -0.16679647189799493012 0.51416076202947091911 -0.58303420149857632104 0.32334889370784353213 -0.067478948045966866132 -0.13174899641778525794;0.96378817549600837022 -2.5640842315801037898 2.4961389359149950273 -1.042477660190107791 -3.6069773361640882214 1.9842216844655580221 -0.61280745274932557631 0.13516552616282775934;1.0676560665942256279 0.71001077345668894836 -0.75298744894160540841 0.57230374645457104954 -4.1187413544788276099 -2.5499937282143094741 -1.0067865785529048761 1.6846153682596387569;3.1502097950744003541 -0.93051143080330289692 -1.8030070749065616464 -0.69958462477506910826 0.5374044532513866379 -2.9557341677959980686 2.305663372844028558 0.49214234962703179432;-0.47772151533335299733 -1.0719453654758075434 -0.32235819550949434964 1.3183718677540163799 -1.280008004608238048 -0.58127438195079095262 -0.48225086419002261007 0.029739875423892878081;-0.020947770652479633796 0.51880488960438464474 -2.357267939342573726 -0.33034061663379793439 -1.287062221092017289 0.20170007607199180732 -0.31762706640155868865 0.35788924244554437548;-1.519090160264178202 -1.785111257492549619 0.40534364491420088461 -0.94271217222959857729 0.729331286570802928 1.7113968453075456555 0.077791711493200729755 -0.38570368970537188824;-0.57525006615759266548 1.1709502607818871311 1.0331749393650559998 1.0751292274356152312 -1.9449429012836547681 -1.1032547313161225055 1.0108259340746896804 -0.085728378917053982278;-0.5317565145718722297 0.30717456595072989423 0.056564592549051342929 0.4293462527733616918 2.9444031980577283214 -0.55856461383959044031 -0.13991362920440353346 0.38489422299973607977;0.11691485492039287164 -0.163551185728677273 0.82434165879690080025 -0.8275841007972144503 -0.21860240272736441991 0.58081757986969162477 -1.4294968899008058116 0.0090704337781894097542;0.24510982412673346098 -0.1534106252526983849 -0.23486330542518987774 -1.4939318141215522928 -2.3299685877691089786 -0.40693049824997212793 -2.4823729074993048371 0.94985142612468997925;0.034915127574038952452 0.13963521863728090011 -1.2239588156411820297 -0.13239229838347107981 1.8354967931606338549 -0.48731283812175840708 -1.1838882779639527953 0.49124819695239241302;-0.29852530729919185548 -0.50293916302310837096 1.0500178771105537212 0.53990234105448020596 -0.74464345321573421899 0.33617564799400229125 2.2227838601448555167 0.14369665885570054309;-0.58728685212194720044 0.68676599483109013189 1.3527498676719482695 0.15159028616104230913 0.83048108316433000287 -0.0234273415331623866 0.12436568299270187032 -0.73723559013877681956;-0.65754954894458483849 -0.99465673490712691596 0.47978306299045930805 -0.82710242169127790035 1.2433934295606896558 2.2947086910998608644 -1.0182483673218543085 -0.38818666918980865299;0.53194437587567056092 0.1420421563324185954 -0.45695746630242461972 1.782956782687135977 2.9446725644724023319 2.604107061634177267 -1.5684217048325517219 -2.2930600323161614007;0.21437217864378302346 -0.74248653863428792921 2.3991493737516531581 0.34597293477169910325 0.31121131125823092711 -0.3861917599316026517 0.4559842654539801865 -0.2259143141100868335;-0.50519729366471799459 0.35572362309308147577 -6.0759710779287718907 0.87088271442242437548 1.7175414933006214468 1.07646645861492396 -0.86430212368856740301 -3.1311836327720499185;-0.79473346611185402555 -0.48793172563971337619 0.41977763984775845474 -0.52036429000995598759 0.27166702668674763688 -0.26500514771654948287 -0.046420619421181016917 0.27610568461053403011;-1.2995685096730671404 0.091373014257091961232 -0.61477791522461266993 -1.6805674822429073068 -2.8498317752489898957 -0.82106365648554424652 0.40693583335290001157 0.10214466877272068701;0.26922838384138614298 -1.2187448246716023892 0.23185092042339744411 -0.54349168725128282897 -2.6582502030478529775 -0.010451944183560643586 0.38118444732345468928 0.039661936494243960061;0.076098672681725654243 -1.2975915193717890705 -0.23769986869575987498 -1.52201933727567984 -2.4391132135712543239 -0.42670210582193490723 0.32680406167477599189 0.24247710655115606304;1.0281097550836419963 -0.67911671520054517348 -1.9827303283769337483 -0.78120765052515439564 1.7020924364810483542 -1.2537345601781941795 0.4126563514592056503 2.418159492641311914;0.15970651127842844241 0.3971839912124806582 -1.709389359885680193 -0.44944983056602305638 1.2802740773648977335 -0.96379811477420285204 -1.8611180559119984146 0.5964446310346307456;3.1977428786879156242 2.3953563450967498838 1.0657374913189143761 0.78773067738750368605 -0.35892356551880516546 -0.56781790960255296152 0.32389116562066194716 -0.75964569854771069046;-3.1962567505085139885 -2.5492828194032659539 -1.1804287027791826592 -0.61928165580763383513 -0.053671810063922333056 0.40706069251189264113 -0.10548093859569122877 0.61294178646133368193;1.1858535770121694242 -1.6357383133013649879 -1.613113392247000677 0.15884469101676707004 -1.4989061034775916781 -0.44319377160151440798 -0.39621805016342143135 0.75610423944666771412;0.46851556555866924469 0.68584177370057275436 0.57539770416489843807 -0.98494264143171372794 0.10357008740455340978 -1.2363249702177416811 0.077480030679325878618 0.75905867824314299241;1.2015821748624235799 -2.8604468887297729296 -2.2754234562617750015 -0.21334391142284739318 5.0168928873659064394 0.46490614964178000879 0.60783645332317781662 1.813522146192017015;2.2811652512731233067 -2.2132458919317214985 -2.6573618066451762942 -0.91752037903738936642 0.9818298458342397117 -0.14202865800689989939 1.030000226164622168 -1.438146870319698678;-0.82542907378057783774 0.13855875200519546242 0.46339049751530564381 0.27313048782578197571 -1.4779193793564087134 0.61472685802658888488 0.2081059289498614906 -0.81469759275276254495;1.319607519728982048 -0.33514225407613923435 0.1128403657092685447 2.8477504052808497725 2.1941168764387142254 0.019243205128125780157 0.78694178867512221132 1.0248737631252571312;-0.52863063880921323801 0.64677639180936097318 0.94183338960707752019 0.030807961816295192925 0.89557573064984219435 -0.75318369298169052239 0.14894864975539198748 -0.13759555792663771823;1.5881950316989039695 -0.062241402306202106565 -1.9221195195076212769 -0.7243316657749595544 -0.87028412109945574304 -0.37226979756129163768 -0.63551257163854890653 0.2078883596954627655;0.34487447176822921824 -1.0635578153306051163 0.22392401495157923663 -0.12744175039367322544 -1.9373046584447126683 0.054512982233339724036 -0.20632798046529646219 -0.16625975656501112976;0.50954487938637282873 -1.3598385561621930684 0.73050021450116242594 0.93020288153926811159 0.28475355314363148818 0.48987766112965092091 1.6507132795249606083 0.07941505615816907282];

% Layer 2
b2 = -1.9294226402122296449;
LW2_1 = [-1.1738138498270000998 -1.9929933602904119638 1.1860008908226371549 0.4321436535681535962 -2.5284304365230396705 -0.37675925847111363387 0.42447746565145400011 -0.11865187173611084492 -0.61139064186444835869 -2.5508910482213620341 0.76702907145297816172 0.34112006582283926903 1.3084142892208321385 -1.291519228308783962 0.27827484088902015857 -3.4673837939624920779 -0.70680454813807402914 -4.1976276418294746762 0.28817306656098595763 0.5276352842147705724 -2.2358861676604528945 0.52298286758878231861 -1.7659674538226370899 0.45080650016236967215 1.9588343162680468268 -0.99172259422735620227 -0.69693045628220362531 2.747813301260241925 -1.0635446135430237646 -1.0923470388606928427 -1.0796643087407631345 -0.46170482223261299914 -0.20155209810108806745 -0.42123459201286794773 -3.0220799711876908944 -1.5340379296042498947 2.2905624027976059232 -1.4828503651367410665 2.7986322333260957862 0.69949905224416797367];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
