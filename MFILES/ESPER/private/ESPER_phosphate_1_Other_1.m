function [Y,Xf,Af] = ESPER_phosphate_1_Other_1(X,~,~)
%ESPER_PHOSPHATE_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4288095836169740771;-2.4846476310904610507;2.6952630081955319952;0.91928847577052286155;-2.1104800429546375362;0.76160088375147649842;0.9236739868183241331;-2.0205385956093953048;3.7711364459623712975;0.53826615933360921762;2.9316955012061032271;2.6673801864874211454;-1.8904383471488481749;-1.288023118839263903;0.9138155318159282281;-1.3047279608724127176;0.06518880358362041938;-0.10662550507983187265;1.0821713857257591052;1.4898064351899418245;0.91835400481911644288;-0.12229014355669622083;0.31871318572560691784;-0.51124357315569801674;1.2333091765934511841;-0.29587074481877678744;0.13835178292276015255;0.3639179952893288883;-0.96504514218100545531;-0.64718652070022220091;1.3137631691706954662;0.55917782852612829547;0.48008004500241180379;-3.5657964212343435939;-0.78989522716988669337;-5.2262160148086600486;1.6522618271125000255;-3.7119982542077356591;0.059845404725088029163;-3.4235180739782666848];
IW1_1 = [0.079044528297589081167 0.058716520808914894614 -0.75436240737731741213 -0.58065599057888128698 1.381363866112163219 -2.1752914504459641698 -0.98428679433507693108 -0.53156762240876509473 0.87126575033494879641;-0.027644549488871364429 -1.0686788168918941455 1.8871204952636582153 0.29725185279462601473 2.4156750309648691299 1.7500177558243674714 2.1901221826589751807 0.037049677195368030391 -0.87552708999080586239;-0.017870192560207182747 1.110010041479041476 -1.811315224511032218 -0.091497137325462524204 -3.1269158036532229694 -1.3481726243457949899 -1.9638191036701806436 -0.051733952606339526914 0.96016369796140021986;0.0069711458097111511992 -0.23847032871830106671 -0.62812015246851971018 0.54195226808862562162 1.5231986288929497686 -0.10746018258075590301 1.2585765675225337734 -0.11217365589305225426 -1.2676839519589255811;0.066911937390782105783 0.34714992569133090727 3.8520115711497240341 -0.085471598024604772403 -3.5890099631689889037 1.8438768323071415001 -2.2464784015833187958 0.28239636327481604239 2.4444045061751151771;-0.42043808843005497922 0.86232844558271148916 -0.91547045823566053357 0.23966300173568685916 -0.83103296391852721214 -0.40898738407026385966 0.64008033493019544924 -0.33164358698174306594 -1.3898339756595934347;-0.24102875763602915615 -0.3139012858728811306 -0.37574582756427810093 0.60202568389323851683 -0.3164351352394704775 -0.6552233849278180644 0.46100718274938601304 -0.66252205457727153526 -0.12735658143297348688;0.11302642491459650997 0.03878815967886766608 -1.4242417529284210342 -0.24268974199665585556 2.6595924104466241999 -0.93269842485987763947 0.40345440255100284421 0.11206351233345013263 -0.62131275461373691726;0.10474444129751318833 -0.072662410780564845592 0.65109663897406888644 -1.5641448243072426649 1.1407528991570463628 0.86662275768033203427 -0.60530606006977971667 -4.2199008708260805633 0.75761852320934763849;-0.041315533899192249945 0.25018919961540292407 -0.59419359925936043876 -0.065837365695228758367 -0.39299796647952728312 0.34252416535181023916 -0.34439975240841036452 0.14740963517405272776 -0.49188100206883283994;0.0023726564531319016896 0.091274563819912390983 0.58018928215572207474 0.57377775611555836832 -0.86852437946187155404 1.8670153585072852831 1.5697061663059541647 -2.3069180981299606259 1.6513344768083615399;6.4974274074821432023 -0.013956938717672662947 0.05638700138246730692 0.13082898164276415831 0.67256501583798411481 0.21185842364673512783 2.1272867359180835933 -1.8994385080978393177 -0.34994587045357233857;0.56165527422434613491 -0.14865146473802187677 0.27265440219574371694 -0.081129614752261769439 0.99776609030168916803 -2.2608325905810704448 -1.7079235932207927906 0.96843790721732214699 -0.64541123787069554218;0.43355495741899202633 0.23264864980336236178 0.11077675953032205258 -0.2312988393336751769 -1.2561276512585539678 -0.010557311406034847884 0.95778822619798853477 0.012693204697620731614 -0.54449858828413766343;-0.23954081345861510943 -0.13818132111835165765 0.1945161948664790863 0.19512137403745968833 0.23571342767830516518 -0.32368117714776162286 0.3417231694996079594 -0.24109573320832497489 0.17812211897473465005;-0.15238686278489516068 0.21807315476661631726 2.0278192646907671204 -0.52509700596213382262 1.979547604735834021 -0.46118553258139799444 -0.35431781148504210011 -0.22587124481351042449 -0.22231196716618509268;-0.04218290060034617095 -0.037036429895283329294 0.068479358660894926181 0.22366581597051404806 -0.28612065376125700444 0.50204261304077313355 -0.12543259016345864598 0.59967777432521096603 -0.069771446414578067174;0.04475377507650540182 0.004328381461830415125 0.624779549445849125 -0.94469670630493263186 3.256463870621316925 -0.80998582825565379473 0.20821293803713644688 -2.4193869372708483034 -0.61963448409669463768;-0.098502680317043150859 2.1829393934474685679 -1.0035994602730866632 -0.10432403000355550127 -4.4180355925889500668 1.1006660363074662889 -0.61548103176106039314 0.31449672686176816105 1.2097297016730086394;0.15271546964816171132 -0.28649473633287331209 -2.1995168779907547929 0.58580156928198745536 -1.7115902356337431289 0.58637562218053618235 0.5395441549862449726 0.18230472070003067575 0.074335188704046650798;0.067876079033919609063 -0.077947439965603965151 -1.5156498848742769869 0.31089813383809816738 -2.1650484433702761322 0.29904906617257231982 0.23656600635045005321 0.18155371600712633118 0.22109736882644681621;0.14565014880922771967 -0.21453780505396877198 -0.1093968519051482513 -0.12781459776127590544 1.1699677269360380105 -1.066399914633860968 0.037306009765101462439 0.34955591895605025998 0.26151583542773404467;-0.24707473716553760013 0.15658943829954594107 0.91772554963669350503 -0.055089788112159886191 -2.1795743192767598195 1.5692648703388965004 0.16886106368189940374 -0.3929461798431230779 0.22462233613650503528;0.061876323832160136373 -0.061423344053605236081 -0.70124317422945736666 -0.14461144934254041572 -0.30634502576639321969 0.1527551098474908553 -0.3527611307059057566 0.14111945421740013096 0.17844387366469099954;3.0560318677296152146 -0.19101984983245834382 0.27830647678798464684 -0.36142573305062908329 1.0744199729199392923 -0.50440934614312549211 0.35007332127597723392 -1.24263311982108271 -0.0030504571374123656824;0.092923962210291644048 0.089602324092360366437 -0.44079392694123348262 -0.61717821629217728407 0.49574408850668821858 -0.98149641894527384078 -0.65470059932738400299 -0.85632968563659950245 0.60306843681176192096;-0.3199366219918388099 0.28285870072975338729 1.1501730111608348128 -0.090811146666114866965 -2.4876620358449343939 1.5860024417434692712 0.13287676305435183743 -0.25301154356539740098 0.079125137025993969031;0.073474598402460858382 0.0096819895728853123257 -0.13054902461587050699 0.079713317382960932611 0.66166135904586020899 -1.0025874007211212913 0.92572043857745056616 0.41520043562950731397 -0.85133929904168348379;0.17501403860739084273 0.17922919789632782428 0.12938346646831166975 -0.42932801711755919083 0.38719562545391800201 0.42424794012755989714 -0.41024662164683983745 0.36015916291617078304 0.035848907656988261705;-0.52801639964994007137 0.12670973835239221494 -0.28226950104617548609 -0.73091791521248095087 -2.977235404568773891 -0.75120698103269301082 -2.821079464169585993 0.56777007241207977373 0.49784071463186113649;0.99468472416033626438 -2.3265498965421920197 3.3659812463184768383 0.14622193590598855928 -2.3354920762539994605 -3.9952895247184319061 -2.0809117284743141596 -3.437338964192638624 -1.6965468451638610059;-0.086859907519947959775 0.10058370907375295544 -0.29132130532726929761 -0.2942446486924227278 0.48369775831556899304 0.091481304168549743006 -0.48497929977575970906 0.11255814136823270866 -0.28122768707907658259;-0.028013027742476288157 -0.17502274558788410985 0.56668992708887422349 -0.49003350181945648512 -1.4012344213463261422 1.0628323676078168525 -0.24016925588180268458 -0.63500162726532249913 0.60621816933434891084;0.1427615811423451897 -0.021444458992768096472 -0.70374537584492458109 0.0683719975171408062 0.71877392716989974009 -3.1783377438570714624 0.42801774536261927295 -0.53581320714700597652 -0.025972556210120532894;-0.33461897794307510212 -0.26166501422707083568 0.51640571193891660062 0.66987248616312367044 -0.33082646658390396643 1.2620492909946576798 1.6938367264362592657 0.45413263797430436508 -0.41015177002374952897;0.11714552592246756102 0.022915362090601361367 -1.1815834218570098191 -0.92948656535881757357 -1.6081421170885001892 -2.9496053722414568021 0.30541547641518118628 -0.27187561222356287916 -0.52972134504099976926;2.024317046446253876 3.0590114795265499481 -1.6414289948097955385 -0.38519370443117584291 2.5272091052531866495 -1.0497617642430254747 0.19631781344194321193 -0.89995541683727953153 0.44589819604504099537;0.027003671445255665595 -0.19151576268662298674 -0.029164312344095430496 -1.5056914016262010758 -0.62119911900202151589 1.5336085323276951176 -2.4433123101178884085 -2.0120510840016097021 2.1385864037371309365;0.026446264993150926659 0.01445502785133945256 0.18430542861501666985 0.27220073751436008047 -0.41172173323359800845 0.66194107259753753869 -0.2685598939714609612 0.427431962001383281 0.027116968418626187509;-0.56838245275937138157 -0.509792852914630501 -1.1886526095098104427 0.47398316405927898298 2.9187776430482972323 -3.2511757728394417022 -2.9601936202758922789 1.7203443454508071664 -1.4046955738947224379];

% Layer 2
b2 = -1.1663708269636805515;
LW2_1 = [-1.3611745121325822261 2.7189868011365780909 2.7843626244979100548 -0.92090877787513536479 -0.084957431784023554333 -0.48563226977672002693 2.3761119138089688008 -0.94246429349683447096 -0.32480706305415157908 -2.655044664913975172 -0.44787621979721092824 0.030911994139298897 -0.28164235524510239372 1.0033296391597741337 5.5857829553833706626 3.0225343745518173932 -11.517125767783353396 -0.39935501476353579831 0.068405052704150884346 1.8665365400457523126 1.8190470594420291572 1.5581104470914546312 2.9114914505570959058 3.5422790137802921961 -0.085027619167489118523 -2.0719673136370970745 -1.845696915309351871 1.3835733616143317537 6.6320635293194847293 0.17860667831049195642 -0.013570882674261321513 5.7572989073047429187 -1.5326723446924093164 1.0870339987344248556 0.59219777541288765033 -0.76821820255713602066 -0.04425462497775383558 -0.44188529563241440989 8.3088148622914026475 -0.13582053429250759424];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
