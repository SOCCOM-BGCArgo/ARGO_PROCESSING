function [Y,Xf,Af] = ESPER_silicate_11_Atl_4(X,~,~)
%ESPER_SILICATE_11_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_11_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.3804806613670224102;-24.711388925183772614;-8.8206760379085373813;-1.4096521925650733476;5.8587615545549436291;23.182943979644225152;-0.7179482663103422535;-0.48773113563607956022;-1.91326391550602537;-6.2698681334669164045;3.8936442993178359551;-1.503200541204909646;-6.8444614675984620789;-0.84733713111770925241;-2.0803840966252273859;2.2523586346730568586;-10.248949466565576927;0.85174487299477863456;0.56300928039604136721;-5.0799436853903410238;-0.66750184138660706434;19.435474449553495901;30.085677934003431488;0.98762688535155163105;-1.0552533499335956524;-1.5696876492307696438;21.584708400738740863;13.472177629461368653;-3.3811770848194337979;-0.98902016565489736521];
IW1_1 = [-0.16411875955964430607 0.83075956949214246894 -0.16963097210696381767 4.1231854272969084008 6.2599218615508371855 -1.2377234028938477461 -4.3903584695972739382;-0.6034197675486570045 0.65119603995118968687 -1.4339292751712173768 2.1672289513349300982 37.977963588786813887 1.7282625290160147369 0.015463357240474030069;0.27230641554839635221 -0.19367523780580417347 1.6465060541672336125 -2.4498432028981658171 -0.079676880144850539822 0.55025056267811323085 -5.1883384644273871089;2.6437261967351228797 1.4458071382974617691 -1.1615269846400120279 4.8469472634405654787 18.456502566936073606 -10.546021766070420966 4.2414265094554934876;-1.181614463686170291 0.58684546203934340181 -1.6595964817264405866 -2.7466697667279200701 -8.2031049251147525325 -6.0470564663529957627 3.9298626947841777124;-1.4082260166879501107 3.0882215084327775401 -0.46236584398412883257 4.0748037959097658245 -28.646167525678826848 1.4402925985720542723 3.0629638089257986699;-0.02315761906122404401 -0.18335708735745626097 -0.21676491600592698306 0.26491542133304524231 -1.2445070728401839144 -2.0142493771908536182 0.12645067946607688181;2.3709144993119406486 -2.7434187296757475139 3.5251172151600456139 -2.1280485256137078309 -11.025735023503933974 11.305216437948748975 -9.4263902429200374655;0.28327693453714225535 0.10644239978561677307 -0.6923876794675443147 3.6645061480030696188 -0.37875294172208989751 -0.38033014801425013562 -4.592834443245632059;0.47220881457440916362 -0.59670365464127694821 1.6238617981500389487 0.16707135884921706093 8.4376903155750184737 3.9471187204838882323 -2.2806763556904972035;-0.34481154907991257152 1.3217628869587534357 -0.31300652416585766913 1.7033270034746208488 -4.0635688388687896122 0.33818106346520188099 0.37259895986773339249;1.1986851221958494396 -0.15808655985901787222 1.4709022644965896731 -1.9454858532838876783 -0.8010244777078427969 1.9399493220310088937 0.11361463167911037275;-0.70248650093937192729 -0.040462563897876752117 -0.070257530761301575928 -2.5777185369373678547 6.9625196178649710887 1.921630853855281762 -3.1781313577710901264;2.2839872727616450376 -1.3729936268660938303 1.3337902378752990451 -3.5001051682847790225 -0.45652802463462144322 7.9359290733173217802 4.2574766613009860095;0.27672373211627743217 -1.390488240152576882 1.5488335703712485802 -0.71031015829120891514 3.9450345101913750767 -2.7044875614007106712 2.6210630839396298342;-6.8888769416959823033 1.0582684436215272772 0.96333603116070065653 0.43285259571868500705 5.1388585509325128697 2.8621636033063664328 0.65254352401873660927;-0.19831357834439106158 -1.0125917228120511204 2.145529269876809586 -1.466649485269194475 12.354744970454518693 2.4318978560736588257 -1.2356861887826608992;-0.4991781111302101559 0.2470702312695158831 -1.4663773699865989553 5.9802889022624636794 3.9708244070946498994 -2.0401863872329828453 2.5882911846744334206;0.096712360647101328071 0.14905772531411914938 -0.2275883213799720084 -0.16567562625067522308 -1.2697168272327923333 -0.035480468467256748299 -1.4594966246416913869;0.15489630590714567604 1.0894270178604139598 0.14997125763441124247 3.4757804270089138754 12.664130154255619942 -2.9589301466265998108 -0.32357739978023669636;0.88293865610867616756 0.54264451333030427893 0.20113357605598625177 0.36190087019788680367 0.43715700062484313948 2.778143991015320502 -1.4246611114988991798;0.40435731525911572382 2.9857763465394620006 -0.84233995951604800911 -0.45552095154353361428 -23.613757837788742933 1.3661494856565625788 -2.8249780723499466895;-3.35370446121501109 0.74676759689175520318 -0.40549767541600778564 -4.4199732414986749873 -37.025938780638263381 0.12586312895271675738 -4.4676646438130100947;0.094148865268664075345 0.26599500290460459384 0.11336327775967786069 -0.40186979769862996026 1.0607946811167876522 1.6521077049620789268 -0.20734466228507508756;0.89432108201030491301 -0.26411772296149998995 1.3082670623693830603 -1.7647834201647569774 -1.1437862144240349416 1.5482053329615146353 -0.12033462741531932017;-0.082053109616408409499 0.033908329410403871551 -0.18738419832109387553 -1.3943950518721730525 0.14217267413810943943 -0.26212764396428411828 0.3836236792194777645;0.44338088470289138687 -0.41676184388697801175 0.83481031299097607778 -0.16469147563902847287 -32.024042542380151133 0.99453833095090238281 -1.7058403507305726077;6.3026407920915836769 1.5811724291023432354 3.6655869109665406569 -6.1600647456932167145 -19.3409707706116194 10.072664765350102911 -2.8662717679340787846;-6.0078281250956022674 -10.537251995914648006 -1.7273786816303009495 2.7867360150764746152 -12.529358531650981234 10.152653387931355411 -4.2329362612028598178;-0.048431530382777969457 0.39289764069195842744 -1.1056756323468630576 0.45749501144862875224 3.0040953605156839323 -1.3321218752309151867 1.0864512183693020297];

% Layer 2
b2 = [45.043552469245732084;34.916523910582590418;-179.36353195625750345;2.780249300797243972;4.3226276470453113276;113.02151168812666526;56.12420522344020668;-4.6966348244264342071;-25.859518889435733513;13.402550865362369947];
LW2_1 = [-1.8887842311175506715 29.997439994003961772 -59.679919710756131224 -9.7468407649148254279 51.483293007863764501 -10.344204250860402183 -32.566834778258410665 -19.177373654329528563 95.466033840612411154 -63.321450889722548538 209.75749976175720235 -17.040713066972489997 5.4499149011127148157 4.2666120411036496662 113.55025342708523794 -0.29844911827488973532 15.486217507666259152 36.995937476675351263 82.039991966168713589 -17.28271405344695566 78.973811686232522788 -15.870459027031337484 -10.565731402818446583 3.1033697876985542052 13.190791915966054049 9.6219130885008876675 -3.5225319133358685697 -86.444652686723387092 4.247748209598475988 -17.249505408270145779;-0.065119481885311178426 -0.63333089739725190181 9.8117370109952410928 -17.252053576216674458 -0.12224468052449825872 0.014355439322640673946 14.146645896508788454 -0.014592663877903795308 0.0093347974689174072205 0.40037041723650396152 0.046649626157081007516 1.4779996708726284016 -0.23211535640846492345 0.0046245895016802521585 0.19988495188083688081 0.052342932707441273965 -0.33168048839177682874 -0.073352617201840789041 0.76890964559210306373 -0.21769635403939371909 0.32377676596594962 -0.10767961906821091334 -0.019022932497570196192 10.068462562975103225 -2.5859238239305391005 1.9584189326339787041 -1.1628505661768393509 -0.011516476224946682258 0.025560882091169301322 -1.8177695862284746209;170.45760273394157025 61.713440818634893503 -58.616405554572061476 9.5657173470263074933 -8.548129933333186159 -96.98601393160552675 -255.71064974386843005 21.73040163104678868 138.796701689864733 -96.450529419214873883 92.697192154665899011 -10.708512982937190117 -144.4801923792290097 71.043265618790300664 80.416427957022946771 -130.47364660488119625 -0.46142605536740466388 -176.06209530460969859 -2.9585193596748644573 -66.807430608750436818 -227.98475105992284284 -67.570224540287824766 10.859378202199073016 -37.924193622471342735 72.372902616727031955 -67.934081296359252633 39.521466344136392479 65.501339453212580111 42.8548146380463848 -32.987748229047618054;15.50545264927954392 15.605085550976975028 12.288137011218532635 -25.084940232040011665 0.51974667146203124002 1.383601859657660027 3.719672035067159932 9.1674265109219348346 1.6909151289588872924 4.5349188433201801374 -25.983258885245064107 27.451672212072093515 2.2052907366135019451 3.6046620163112823576 -3.8776180127750272675 -10.019692106799681142 9.9320364498354809513 -3.5242166743260017192 -27.413418080154748679 4.2282869740047015483 -46.99263046816056999 -8.5797493881858084563 27.445952671004054224 12.51992770092164875 6.04789531123498314 -22.924644335611937151 -8.1368551729180005339 -10.585593168296297151 39.498973281532386181 -39.316424004496411726;15.0725136875993595 9.8612410521785118789 7.868930760724023088 28.90137688624086465 2.2462935553302596503 -11.635426381226224635 2.037246961884671137 2.1569812365445231173 -8.0126916684778937139 13.93448529601028163 53.530402657425341317 5.122078875807261511 -23.34524109091412214 -13.792093511491852809 -13.060416396744296108 14.396736843064314115 3.3201669525615251644 20.064050189825778148 21.728342351612511152 -0.33289314653158796897 -2.2741747034245407555 2.8322241045158706996 37.151238187167777483 2.2821978482341256367 11.616140694372749209 -10.892500537771063307 2.4352090666326446922 1.7946195980646009183 -4.6988101098612418127 18.641905404801388357;0.091085150664201669501 -13.650401030357928178 1.4823389839015828073 -25.5253196120136856 1.6202325375479433855 -32.704112670156767706 16.488412864474636166 -21.848674662377703726 24.572585630515302313 -10.011234738819684509 41.428287087252805065 -10.036547068263871552 25.663106622040839255 -16.491640136725038701 49.673060015830515113 0.76003166844971448146 -3.0711048949075654413 12.005392580342112652 60.622621371182361827 2.920280441774122604 50.009844347979729662 -9.709350781951005871 3.2410172069559139985 32.424670790537220455 -18.740872761942618752 29.848380077338543259 -28.024560539440621199 -23.938481225302822963 77.258318833472458209 -7.2820667660166105151;0.36437290001493832792 0.26261292801489788395 -1.4479876486568621363 0.09384794657696653164 -0.2491537605422039503 -0.091036031370481981795 -16.217180900037753588 0.13976247155301421699 41.345194176055287016 0.76784885836908567391 0.71078720270053807884 -2.5239048940119639397 0.3280094088178672207 0.041118286574713364123 0.48626365442030655695 -0.066158985942128850644 -0.51314542265808538168 -0.21872352643349393664 0.87719945652814268477 0.34915304367420135767 -0.32062218914816537074 -0.41392002455527676652 0.62259675214355680861 -31.72708258102612433 4.0618526986989156313 -0.068214226518931816989 0.70331296679719668141 0.091496743982060410594 0.0098062531744258097516 2.8036354258283635588;-41.142248492450683273 -9.7425470424779057055 25.840918254512569519 118.40251942483052972 -43.015071800835748661 4.2122545134270161782 15.777239373885302953 27.539342602293949369 -43.324571521037896105 -47.319823294051353457 48.281550795670092668 57.738632343926937551 -81.695967580041312317 -136.679676050871592 66.641315388899499794 -7.3449736498409290419 -76.023715588728791204 77.784338968488768273 10.182669162970013232 76.126447893950000889 -31.172899047451416266 -39.90659855552359403 27.355409438119504983 52.048112174826997034 -40.02049806176003699 -26.686462121839834793 -28.881399827764766997 2.551778545085188199 -7.6983302818643579712 19.100082063271958788;-73.263553288683866072 -7.5657144325290728304 -18.156307087993717175 -36.555475497603808321 -29.979783257350778314 5.3274268397797444052 17.565178923794238841 -40.965777461510782587 -27.677898444958479729 -43.160404922460912758 90.006285226095286589 0.45818023989412509644 -60.67570875053796442 44.118732402274581261 65.178425432748099411 -63.520762700316232952 -42.046185220349883593 54.658915968283857012 -72.277353107749519268 -7.7784026170569946501 1.3658405006354221722 76.168436885332695852 -32.911979182895429119 -1.1803198178217528813 28.696294296774002675 33.661480770874625534 -48.829551058867288305 48.954056745361469893 -14.669323250319358465 79.873521849596471611;-50.460303297790581212 -51.457204631685073082 64.239406706547327985 36.486759388590478181 56.917657491750262011 19.216632249031111002 -29.19406176997073743 48.181566318895114875 -17.018539485045597104 60.045749794629898588 44.2681124050702266 -64.68125864573698891 -47.517049822260517544 98.317506712216967912 87.119129205225519286 -15.432650397742488479 -41.601222625069425476 -66.651148802953500194 47.592098761837846155 -36.043203600515745677 -36.102635175430094705 56.425241771134260205 -125.08488369526199335 -9.6633491377583489168 16.733229832565392314 -126.35005449242426323 -125.50395152989715086 -148.48522127986106511 38.64256649767623486 -78.181178921934659343];

% Layer 3
b3 = 9.5216820057837399105;
LW3_2 = [0.001896606041339173954 -9.3977730066032876266 -0.0019014822454060309118 -0.0014286898986971708486 -0.0037835312993131191284 -0.0053580928675266087727 -1.0862772628373935646 -0.0027453026207207866481 -0.0054909576056012127099 0.0043935909851629687331];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
