function [Y,Xf,Af] = ESPER_TA_15_Other_3(X,~,~)
%ESPER_TA_15_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.66372009144218113708;1.2367529589910877252;1.8492595416859269886;-2.370316572820147627;0.32052023417966990504;-1.0534851663837423441;-0.74816161165616834605;-0.2350645278070624955;0.58363234407002817505;0.87216857134006064989;-0.99719194745249373213;-0.18028954456180823485;-0.060191804610175023149;1.4340766986991342336;2.3062099032895888584;1.1622976147452426243;-1.4190964560800318761;0.45651444855308609405;-0.57338962212732957902;-2.6001445869557233692;-1.3209376299391060172;-0.63865706430303892382;0.13246089050326814718;0.53766732265139915992;0.73696900928834840894];
IW1_1 = [0.25121929052947405969 -0.30435538077450979833 0.47899978091158634808 -0.63236515987031260977 1.5232689548299516158 -0.062791414678650764314;-0.089744937849563180543 -0.028178996051376976884 -0.78692168117100158575 0.49490804789179143608 -0.16034425359044501835 -0.0056353070269112223722;1.0748800406517098338 0.01168664334142154558 3.1405814713569504271 2.3144708249149057444 0.49641241844759143031 2.5075557726848329843;0.56671992991017283714 0.6444817408146442661 1.6057917508654215855 -1.6130127339974724698 -0.66017282124760601203 0.60335948724533905452;0.76277848108930113025 -2.3962480572206761309 1.0578242921670113486 0.096231450885398403527 3.1074268692350468513 1.0825250945450910489;-0.027253876097511182952 0.31831034399763163956 -0.83712391045412437585 0.18480990858082474437 0.43888674917802328324 0.14647806157985837627;0.074369180967379891478 -0.11961302431942101576 -0.89859889322965347258 1.1656396227308778446 2.6791640805481700127 -0.44429707475339547118;-1.6013825959550438416 -1.1072693639380082331 0.49953070167873103724 -0.0512854029688741761 -0.23792232100187402088 0.29580727942717771617;-0.87318879064718979421 1.5382916989865862423 -0.88072790582841331553 0.85250352195559120361 -0.68618154908673156811 0.05398482272468914378;-0.32843075334894661355 0.55649705527836457186 -0.24701392886866527232 0.64973784384547406123 -1.5121900698214267855 -0.11016948862606722181;-1.0222744160444092731 0.5864254378514214272 -3.9635669388881891173 -0.21760722864878592753 -2.8615963205113703616 2.2646448968053309869;-0.03646495214821164621 -0.18537437560409966708 -0.45966975681768407203 0.53216080486712280528 -1.004708645705186143 0.5080312062157316122;-0.47449147478890751906 0.63070556974946789808 -0.29397246334260390688 -0.18413478823925999439 1.7267946070401860581 0.88849423460314114198;-0.22917350941643621631 0.00926788659266355834 1.4474712867258638926 0.8673851623196086047 -2.4484179836182837775 -0.32009654888943095408;-0.30242958418348053762 -0.082054118219259578049 1.7105501243195870842 0.54791427747797216696 -0.79968662568663773094 -0.22775570390230104323;0.098093631162340128027 -0.14897332387449360724 1.1388514000082767819 0.28064473173326570654 0.031935850215520270035 0.070781926416949164649;0.17486051226629065192 0.1297523390923289166 0.93488063499669704637 -0.92350532554043540667 -0.48259139531469547046 0.12490901129783403556;-0.090706474540168960385 0.054290918959333626936 0.71555029564408301201 0.51871880037611384218 1.0940620664689806318 0.023104347545696388155;0.12436967754858492541 -0.15954213397499450444 -0.029760252500749210386 -0.38344481509949907005 -0.78246406310005089946 -0.54322761502206540207;0.18740987962022248592 -0.084837428995471295123 2.2869640996952402823 -0.76706778320802249116 0.15599051311374756423 -0.40209561786714287379;0.20934829494343146217 -0.064217319611982515148 -0.71508286983830326999 -0.3999448385261517025 1.0193418515298331428 -0.28737031061161455447;-0.090748458716395002943 -0.19636318690103710116 1.8624485854305281585 -1.2132416505741683288 -2.1199368497308657133 -0.12483418219484354594;0.12232797410994498966 0.18591448762905640746 0.55869269893971829077 -0.59025639732995494047 1.6594636558464743725 -0.45164608117440724344;-0.007377999862462363348 0.037770904330311112773 -0.14971902259490699194 0.87856044716666925609 -0.45851734628787810255 -1.216540007155942682;-0.28737990533924084868 0.38064711695799846591 -1.0168792992951076748 0.0587527084409161654 -2.6135783235115299661 1.8631102882804240206];

% Layer 2
b2 = [0.077503945881626762349;4.4528275764691640504;-1.0637349468100634198;9.0299856046737794202;-6.7565343772114720977;-3.6404554729220679476;-10.834150930415102465;-1.6137145146763778314;7.5780063137538036244;1.8417401335803602613;7.6907120248947329344;5.6838869514626182422;1.1356501808160113232;-10.964520591015014972;-10.385833426958841486];
LW2_1 = [2.4050448062448612774 9.3491319181279042283 1.7232058797224620861 -8.2622263677410536786 1.1820684851588902919 12.02518797045027199 2.8236800031717477211 4.8757912761643726895 4.3007955486565379033 -12.948544147909219149 -0.29063887747673061712 -11.395802578123086946 -1.6548996640620512455 5.678977448628740099 -0.62849502798136758219 -3.3737801549808814627 3.0262139781697818819 -15.154093895735504915 -10.197104241280907644 9.2925518448275443717 -23.71275138946334593 2.7986104430860296866 -1.433852610106141956 -1.3912306557395008877 -7.60943397488387685;6.1711811183042826201 -3.0676035534015348993 3.0892159415947282319 0.00082511371835506481728 -9.8895735677541658504 -10.111594225929904312 -4.9721471116446922522 5.9429873254233145374 7.674681709116255135 0.98853745495651568209 -3.5196646697328950459 4.9827912500751789793 0.313787195192994528 -5.7125264257635839371 -9.4970328344201604409 4.1409697800074836138 4.4495998687684226169 -5.9667631317908691457 -6.6078667791578382662 12.23084577246133442 -8.1219315561367135814 -0.40824094019728396354 -0.14663206953534738131 5.1509131017241784889 2.8160670405878294176;-13.190863240926470112 2.2966672244521002533 -0.95718468768734266128 0.31073700859067526769 0.16063383760830296509 -4.6346447442409415274 0.34950020214701099652 -3.6955336496209687525 0.41048730534893629329 -11.975051595712384866 -0.86059830393177261243 1.8696374903666357348 -0.30833219837969155774 -0.27392302876961438507 3.0531452840831900808 -5.885014136995641465 -6.2335158192310489156 3.986824282846381351 2.3205058392609489992 5.067817485821060508 0.16485061298880349101 4.192034441176445192 5.7649108424880317614 0.79465043484084785241 0.75466006167225219148;-11.318313402450170813 0.5242824147175554339 -0.7452869871287434167 2.2157212431848272161 -0.15852471632401901602 0.32126168681191991094 -3.4184487169419126573 -0.64709940785013508879 -0.77817626932409256213 -2.2758573223697147192 -0.47600135056999565153 15.176837489934642988 5.3720857763817013719 -3.428600284478863891 1.5052054186920840184 5.0207338428132581853 -3.1538147578774800017 19.223613501642940804 25.302370034232058771 0.85108559516739545892 12.002890196966816916 0.84029677500092370135 6.8821670145382940476 -4.3428415360309893245 0.95116798189795770391;-8.3413691480196465733 1.9536527558013370154 -0.35457946442050952696 -0.37779464160314363275 -0.88634346171338829201 -16.346501912873737439 -1.8327888870951993816 -1.4388903720751320403 -0.62442352872062234503 -3.0185548869497118574 1.674672353572747685 4.4765443351957552309 0.30796249821076865372 -3.8921268176295673591 0.086971163489545949554 -10.926454979829848924 -5.029259958572028566 18.632805609389702539 4.7688666050762176241 -0.51828697945474533348 2.3788960482453944678 5.4319131388278103501 0.039749938602013673572 -1.1248862540535733423 -0.58475436090571120129;0.34465460132036390695 9.5646884613004345965 -0.09301880506982163066 0.69282560379259494621 0.39839038068057391895 9.567464653940463748 -2.8408971394781334929 1.7054075522801372955 0.42296197086373910068 -2.1021707162950598047 -0.98774429590235335308 -0.60077749297146687546 -0.17199181548616473969 1.5490126111786739482 5.408597620555723573 9.622472667786528433 1.9717816522691002934 -12.900286842722296754 -14.188755186007520948 5.0364490998253739207 8.6987105707002410071 1.8861354802248686546 1.0041868202844779212 4.8806284632246939026 0.28156081816657413386;6.6284358302168193688 17.993529445719531168 -0.17301573734665337545 -0.77787457392228931408 -0.26072617146930709975 -6.3976107193542759433 -0.55628231212801904082 -0.73212145533705441647 -0.26351861063024351051 3.5561614826580045801 0.72352116473871885827 -6.8887839242724577815 -0.22234016147035323696 -2.0474738123556095459 -1.2026710618700631183 -2.3260732435389890327 7.02261651169427914 4.6870626922808629189 -1.0374927847344199705 2.3118437419276305356 -2.3190337674202212703 1.2714264570814892696 -7.3201409408817816882 1.3073798187739986698 0.99986108116262095713;-10.46519826376622575 8.4576803846110806262 -0.1476619659765783521 -4.7796399225210501882 -0.053534577608368327795 -8.4553733018270236244 4.5432245228280070393 -3.494962395209665118 3.9311204400821839755 -10.725081125600437915 0.27050010704760246716 8.1672894091743533096 0.16397439181240860973 0.24560297489321497588 -1.2255339745021087694 0.22087229552704890079 4.7891576335254013586 2.6183058671297754216 8.3170710843340422969 3.3417246424442828001 -2.0689129701504502812 2.3778946782484435829 7.9629120566868625275 -4.6078650452736367171 -1.8288815333573427147;19.144316172095393824 -18.348115107290393411 0.51229865724209389111 2.5093739693644705469 -0.072858976666612493278 -1.3775171797306384747 3.5521984879028627446 0.45775685315533770625 -1.3643680308878098906 13.686301534856498918 -0.75311951195542103932 11.033377660629110295 -2.0787638152832812466 2.2999128378915858484 -5.9832158929773653355 -12.429751405826829469 -8.8611814480269046612 -0.35287352496992641093 4.6673530405045511316 -7.0596970825383538184 -14.182107512737582411 -5.534981771014884977 6.3443656047863790093 -2.2399605525388199823 1.0497984632040906483;-8.4830716192922821506 -13.508239702571568586 -0.65459367283677616367 -9.5103095005045812371 -1.3292080568643411809 -4.127910468784498299 3.1517749401786279151 -0.39811855960765574203 -4.2292792295662717805 1.9915550452054113784 -1.3061262419782631028 -7.4544762612116572953 -0.58491123669193356704 -1.3331657299036954178 -4.2726212918585648737 -4.3160886078900189133 22.78582111947815747 -3.2961295532094876393 -5.6122088766286344352 -12.014120690295630567 -7.5101119687199284769 -5.377600248907354441 -4.5564489046676897033 -0.52207817447286042345 -1.7739292661081649261;8.5193773978104996303 4.4668278673660255507 0.78747730339488952733 5.1418218209201196345 -1.6850742458598055862 0.18275861280309135815 -1.0635442398842149814 3.2598043002298009441 1.4627987459554305794 -6.7548697224049050192 -0.19466489108338833058 8.5919608524880537459 -3.1441645202151571326 2.2134223816097615689 -4.6826840360969006483 -18.33198636741637344 -6.5296290093830462453 17.431790220546023562 12.208737881285323112 8.7978131008941886648 -17.383379954379268639 -2.1289339806005318501 7.7372793036959865987 2.1763105831461184714 6.6556450154891200199;-7.7794596052586335588 -0.59586429587486677839 0.15863372406449846586 0.07747007892225568626 -0.06617997488562613051 1.6309653946469315766 -0.29343065037275622986 -0.1881671583608524323 0.36031699698120567277 -4.6786016694424210627 -0.51556672420977778248 -1.0499982086680599291 0.54920283063949115743 -0.81483219608421519897 -1.937975219678312877 2.0557926234423749001 1.5612774507396751655 2.9558275572023258171 6.255020788450438296 0.42559633437135341305 -0.31134621452952493392 -0.0084371164638662368013 -1.3955940651278642139 -1.881078074065748007 -0.86190770792874948913;-12.54627954335075124 -12.448104582090850911 2.6545171506100788683 -0.77293438154551774577 1.3634215853654569894 2.8614595507176612266 -3.8336837928921529972 0.72731567004424280132 -1.7602676602875215739 1.7406349388084683127 -1.932071885380309384 2.7440848097851793241 3.2926322504514424772 3.9087806999214493864 -1.8892575844687646835 3.0369744591720531091 -0.1355265502577890635 -14.330146689828858086 -4.0931954950039228791 -8.6650429806385265152 1.6454684065945386351 -6.3064994840069772408 0.05666176106991306638 -5.0568918398569842054 -12.504178544023520914;3.5755166958922734999 -15.604690199360346625 -3.5516035011337945271 -2.5155422336478832079 -1.2920826701457996943 -21.586341244480983903 6.5025419908989787743 -1.1859448243836967496 -5.5526036333026747016 10.36513361748679074 -1.3828015526532957402 -10.103565361093290065 4.6861743247635683218 -0.011462892039745514738 3.7696640821652209752 -10.515237302356840843 2.9043426112165313668 -10.548888510688550824 -2.0041765772180846206 -7.204885884016389852 -7.620093355227768761 -1.6448028816324851142 -13.452000121391362697 -6.2695022311832628858 -1.3994691568533605963;1.0600362189211107733 -2.7552607979732091081 -0.55961232897893098404 4.9607954447358668659 -0.30386415165514923942 -3.9866194714521689946 -2.1787944241582910543 -0.44247254819191034203 0.53497510139425441533 4.8088605457980202473 1.2009265854749857638 -1.7791708057224990824 -3.3500971525639116066 -0.14667443826270507024 6.1455881190160210892 7.3349215026743035395 -18.71798480292814304 -8.940855028265726645 -12.919085031156402721 9.5220704884674951529 7.4432083056343056882 1.2738429270269082672 -1.5401037005322020246 -1.6196062270506363934 -3.7497794659724270616];

% Layer 3
b3 = 0.13325422852175705657;
LW3_2 = [-0.028790675170599307198 -0.012651759842276750351 -0.040095940282219008632 0.12885083093113827712 0.062686282972171700201 -0.13617609477026135223 -0.36663184868811621309 0.063076922404396620903 0.067878128023692307913 -0.033314978606805739636 0.021523622710189715262 -0.31490543788586317087 -0.020159037841659257356 -0.023851839989849570045 0.070336351070870398172];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
