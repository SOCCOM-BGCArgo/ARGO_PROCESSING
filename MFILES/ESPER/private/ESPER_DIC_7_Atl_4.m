function [Y,Xf,Af] = ESPER_DIC_7_Atl_4(X,~,~)
%ESPER_DIC_7_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:12.
% 
% [Y] = ESPER_DIC_7_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.0838037411780971908;-3.8079286168517425537;-0.72212406833456355137;-2.2814383291355633254;2.3655202007941626974;2.89359881400870389;-0.13391578343861940126;-7.5254108722204673398;0.65180809891401203515;2.1780957264034075394;4.3306724740727826628;-0.48936425955241491526;-1.7258817770566341476;-3.4107377513339800501;-0.025438104303223539604;0.39714504099403613591;-0.55563752069336025396;-0.075576540666138253277;-0.88940405603986538718;-3.1962913999882989202;2.5222328802092994771;0.401601110165689279;2.5162852061951501703;-0.95200943477865995757;0.42028510141660724297;-0.56463482820573829279;-1.6738110541863457925;3.1601613101235526138;1.0771862997409975549;-1.2969812041655006674];
IW1_1 = [-0.008893013247965493584 -0.48596329072288751982 0.61048456355042146626 -0.4615374807620189479 -1.7985752056495960538 0.85148839034082013377 -1.2227992515819310348;0.37819962653685018639 -0.76637569502788605025 -0.32699248898119465112 0.70218721340233158923 -0.57156049680856291229 2.8233047569683771272 -0.32858641129468046937;-0.14470511715970760247 -0.0023867685452390640169 -1.1120557189688549116 -0.91325843901796333046 2.6676063075953093673 -0.34266315252316997819 -0.3474755276780640556;0.2839254725244778621 0.33243350344010019759 -1.9434506845904584438 1.2565045957155518419 1.5853184702191096545 2.4003921055113903726 -0.75594089235599382093;-1.2368342424695497606 1.0336354778928733555 1.1558697182867201381 -1.1670454675295511837 -0.24654857613509220671 -2.2443894566674673641 2.0202796944197478624;-1.6434339011346703607 1.4239389705590439483 -0.75926724399055722792 1.848172975283062458 1.5096540642598028636 0.1743716445082287847 0.48827812036545453767;0.56319227242622160734 0.91792590624627679041 2.2228173332916036919 -0.4594762322439052693 -1.5846005200646209321 -0.8784132573340154293 -0.99399774672887120097;0.41390627706982724421 -0.67995865153152712512 -0.98718202190529980022 0.56190077038653640784 6.4109140933690680342 0.18917387808032473662 0.92662130889714655613;0.75552338407857866365 -1.2173886352683185308 -2.5322777915434095952 2.0744379763414473317 -3.1210476717066555352 2.4033729461876522926 -2.3352938035676169548;0.368935635714406851 -0.90941149010568711475 2.249030996275406924 -1.7068612056796765852 1.3503994546474786809 0.16937559699084492326 0.74348606931018379473;-1.0103093376661986813 -1.8034942857232474367 -0.5027080518443831636 -0.70912742864563282907 -2.9235521074127719388 -0.73634104842323067075 0.44777559960474366818;0.68508724926062580796 0.088093027224321204804 -0.23255824601446836719 0.14830162449520931101 -0.053136578441674048312 -0.46411499258564287151 0.63851073415164349978;-2.0504407808587514772 1.6074548995424609021 1.2541001100496425025 1.0484981303986675716 -0.58013707931693780928 -1.5945790979725400494 1.536746573804946614;0.48046162925725260928 -0.83259528508159363902 0.71990238687252150473 -0.23926190970509464417 2.1459559691120717595 -1.4089229971180070589 0.52923858498504361414;1.8415889774348723762 -3.9004415222202628577 -0.9118167682069734381 1.0783534921457029743 -1.7492976971750351378 1.0365660391121787054 -1.5438044556398520246;-1.1384881666829347324 0.42612738837666469527 -0.50831650960064589384 -1.4126863259557429497 -1.9228723114207721956 -0.064672538388122466357 1.6344627863426923753;0.95531642156382634568 -0.22835121711278177914 -0.17543714581016689458 0.5876185776826102769 -0.11316923042017182355 -0.2927496778035920677 0.38546783714513821462;-0.51651668851938625782 0.48381815236621578125 -0.78799693210012788924 -0.057711871533975174497 1.9023800839801952023 0.99208376957199306823 -0.54878673255997911795;0.75204054258369013031 -1.0100788237652738033 1.0544198956311674475 -1.377976542405505489 -1.6413450693530611257 -0.64726993290296497285 -1.1986643615128276252;-1.5598985620019467646 -0.064421256692440018177 0.66232902484623801254 1.1394813826876240004 2.4210929000662457788 -0.90127688851640597179 0.40406593974744153819;0.71497559269617239064 -0.6565020486060749727 -0.32622851460912455357 -0.93064656602325623869 -1.9686601794733347148 0.93570325974391399537 -0.7855564713942907451;-0.95879703825710693721 0.39574028069087052728 1.0637134057952442046 0.043947822509625963927 -1.6201037594531757513 -1.7058715703678666298 0.092661620642942851833;-0.30122420039185182628 0.42688901442705823319 0.31715853847731972914 0.48852317358566382799 -4.3756798260231715147 -0.43949628683789571104 0.28269048221999926174;-0.73471746537286997114 0.92596204248452862462 -1.0285758065782402149 -1.6095437916423216418 -1.942048041123130675 0.83698797230467192332 -0.65428905230797018699;1.5409088526727190427 0.40959812812856216668 -0.7057223595799424487 -1.6359195273559981043 -0.16339558208889759516 -1.2714311389670469588 0.71271489305141000337;-0.34603474722118693352 0.48599419187533704489 0.35490018758477975824 1.9149224678327403382 -3.0839432188344644281 -0.86268672091830134185 2.1162907942014324014;-1.3092389447650067957 1.0538740499248218097 1.5476964101669399287 -3.8074700580057228017 -3.0036803468748254353 -0.11235566439000367611 0.054921368093748423878;-0.36424751569497088033 -0.29390256900459632572 0.93562717830094299654 -1.1866425336497150589 1.2611541441524529716 -0.22866019189486141983 1.0864858568796655902;-0.24422847790315710403 0.88411307870325550606 -0.14336044414677162617 0.77995865842220890585 1.144635319445737931 0.5426633482458457225 -0.80980009594560176112;-0.53206166058043680156 -0.314574897770805606 0.38069834791418566411 -0.71285907911683010774 1.3299954058534477763 -0.4546946762391483321 -0.20038959084860341608];

% Layer 2
b2 = [1.3753091587620920322;1.2225576092030194797;0.67276259195700816029;3.1272912182059200425;-0.24149463892019676359;-0.67482692782466047188;1.3423381393348472468;2.1797544714372958374;1.1574531393209561703;-3.723227193914797617];
LW2_1 = [-0.55869512862715409174 -0.6384341977890665154 -0.84516763599338795565 1.7882271524532011853 0.28654893682495335971 -0.11042692489834923797 -0.45647551809807135337 0.53478615776658300351 0.59584992869779807023 0.80525691817117439619 -1.5451370252328848753 1.245439240257635749 -0.71033230656054702212 1.2858484394365201631 0.37436780794866725275 0.68341342818466177533 1.4994025715764183193 1.4120802283849636094 -0.047110834486138897237 1.4375874062950357857 1.1619790169953003733 -0.18871016232237081134 -0.068242544186995837685 -0.74809203282575809091 -0.24425929462858880781 0.60798295620569287045 0.9933265584929035219 1.9317944493349219481 0.84638027415856453839 2.9344625702758282415;0.37501613451778276209 -0.30850363245322687256 2.0659632107308474325 -0.42721613234472149978 0.69835887543667896082 1.5536965750134361652 0.9799315001793211799 -0.74993485988332597714 -0.24602726077036812802 1.4223530050830162086 0.24244784086731935302 -0.27547445201355375 1.9057591157730617848 -1.6884311135988734343 -1.1714269913051216232 1.2557081612298770512 -3.4813295775906252238 -3.1692088313703168367 -0.42634350709212442965 -0.90939187192726966824 0.28665844620028513301 0.85419111590269103385 0.43222968621215163143 -1.4758546911964054438 1.6029420797231399565 1.4198128828061014062 0.49427386965310510236 -0.39584671423264689016 -0.68784282243707361992 -2.0354623457205871517;-1.1546598036057125203 0.89331311670666957436 -0.6221763405618602194 1.2159696189885986772 1.1610708279419543754 0.097149068020621287545 -0.55179399985842525478 -0.50943950878840471574 0.70617324442804219053 1.6107638771971877212 -0.62234443205612133276 -1.5539726589697229198 0.17119077428396198282 -0.77646840662912974818 0.28974586640540639371 -0.28785873329924904773 1.860108666789392462 0.20372168230893578089 0.46827796458166770499 -0.77417748890402804385 2.4922449381703453142 0.74010907682153459497 -0.21130300074558625023 1.1531594167442467125 -0.58091666422829446592 1.3574052742427422658 0.29948155668187076417 0.095464656824648677635 -0.95019019838841711767 0.68371403662032104176;0.75911959942044848759 -2.039347844430242418 -1.3904536978902322097 1.0565211039936193149 0.65922652010918969534 0.0083639181672767789338 0.014377518526333414942 -0.60767611063577331443 -0.87799358302310159807 0.13011183799836364972 -1.1519449955567686583 1.1825691211241007306 -0.93839645935875815042 0.67429821073610485271 0.059190304247132313753 0.31243314836830821113 0.9438752490659412242 3.6108012376615343797 -0.7485296447609279813 -1.0334102275208683075 -1.5413982412312265957 -0.66380276942881399904 1.5017080354699454681 -0.55450115978455249977 -1.6028443572555115537 2.1646192992952073553 -0.25069547846221545973 2.4742740747230493881 0.91975915398149310498 3.5055562403187114917;1.4399880041767780803 0.32432669052198709325 1.0016541781554089141 2.0768391212687102865 -1.1080847089639056513 -0.045423115723594517656 -2.5352472972371833393 0.63543267592379748532 -1.0977312045090021897 -0.23409505692390053522 1.1403717895568104002 0.22703707213830309763 0.071302694633693958215 2.4915260976664921344 1.6032166914232057753 1.9738016608608008884 2.1609678987295177777 3.5747639734533165345 1.0240936420764115145 -0.28401679411460650782 -2.4796742982821511347 0.97399992788714739866 -3.3542982968207009087 0.22783251669555851238 -0.36421472235573937315 -0.67870598391504655122 1.1793506900336419019 -1.247076962991869431 0.46953397893211368253 0.0068981627373625384325;-1.8452592591458134574 1.4607186568721794995 -1.3314152147334599174 0.011908372199394896829 -0.55781750133532326252 -1.3904953779779811729 -0.35037978091482951948 -1.9310379487318780622 0.080395667046306906744 -0.99474402370737902146 1.3043587265500771188 -0.39997791002674487615 -0.61291015879474353145 -0.10783808737487843299 0.39511515165090999036 1.2816564534040784107 0.050293901235209444167 -1.2383391225105135902 1.039947163786823614 1.5661362717969147251 0.71543232739644091467 -0.35061536165913920193 -2.6863865530397879056 -0.9365146517369694612 -0.24681705162201500459 -0.032802266438672351978 0.75889745258855012544 -0.56635026392169107723 3.2989959495336056428 1.0616118580793447723;0.91600143971802228116 0.56077703867539430149 -3.6421952464969740149 0.49135106639073145018 -1.1543917903582792128 3.1672761940465874453 0.056177689498230133636 -0.34351255821316639683 0.076640377746346313725 -1.3401471566837315219 -0.86636204154632123764 -0.27609193677789312105 -2.4424897377449710234 0.80545600208143086629 -0.7155103452435841449 1.2746437958245149247 1.1245352360966747174 -0.84674612019256845219 -2.0652628708199292085 -3.3160947406208518551 -1.8438494586595648439 -1.5087921480388573059 1.0531009210821875577 -4.2303846564130500596 0.54419612935543471011 -0.021779921787185706206 -1.8545501403303459309 0.275217605089070394 -0.44588063881355555207 3.0710437014515710175;-0.84159260686118575467 0.15699005402040897006 -0.83400199294359544933 0.015003745572230109406 1.7219284428546142163 -1.7966030053941663969 -0.095380894792101295065 -3.0348449898296792071 0.95166942186501057854 1.1671668180555350158 1.2267016215374135779 -0.11197361123202120847 2.4999395900430072537 -5.2442662874468712886 3.1513833729630493785 0.067954116611855908126 -0.059755068423076013184 -3.8706646268663891242 4.2812688533103404609 0.10273077679879712154 0.84848465409415552152 2.3016470140917801857 -3.2277482252140172747 7.9520488335257279999 2.8265204551588243298 1.8791201438729205897 4.8578724861354682929 0.54132577728120556682 5.139999950671042761 -0.92055301153926560875;1.6941032235243869142 0.32387031616358652464 1.060285992419244927 -0.20049416721079252324 1.4056486306033315614 0.04179303193625211188 0.4908498858974495449 1.2692137185007152933 -0.32463372091897785277 1.7288342963570617616 -2.8604137779288998367 1.1434586986140196085 -2.0753891325048154926 1.8044144355712212757 0.09554190754063618396 1.2109449571849024707 -1.2543896310176758657 -0.39644722490515960089 -0.42053741230001107088 -1.7265114414933648845 -1.0166559007978854812 -3.0336365169775985073 -0.90625241620515784025 -1.677831491274599518 -3.0163471297022335094 0.74774168858742207089 -0.34387863961537584734 -0.71378538172754790736 0.4256284431919798994 0.19168666909010800836;0.62347493474501092248 1.9749700086229009521 -0.22820687194917374518 1.17688625233436861 -0.44713311858594739778 1.8013527482220992315 -1.4555463574074294364 -5.8977839101688447343 0.32937482670353990244 -0.50844553812062487363 -0.65132305539847412668 0.32551321733947924386 1.2291019010747052942 -0.0087724421051013426465 -0.80354801822170962566 -0.44548653760882445107 1.1988908752655436096 0.033533781939130674621 -0.92355395155639086191 1.5520816690264820359 0.31559765195311040298 -0.47763262173961490431 -3.6038876047426762206 -1.064230020370958929 0.84138867232929492879 -0.11498970992250230616 -0.55649661747247525234 -2.5100618704495354372 -0.82738091647765443781 1.7923363177836104665];

% Layer 3
b3 = 0.10967710363501172177;
LW3_2 = [0.16581715049030204545 -0.73839205984080669154 -0.17450555652907467907 1.1516529749164874374 -0.023496555192548295582 -0.12277779588825658841 0.047186009666542926 0.0048676199842065462353 0.088361644325208862916 -0.071007783361057660865];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
