function [Y,Xf,Af] = ESPER_TA_14_Other_4(X,~,~)
%ESPER_TA_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3824571662618658774;-3.2704064555290108807;6.3744264525942622157;2.0370469532030854865;0.69905359013881085417;-0.96893587258700808462;-5.0691046966448034539;3.3687305737634827274;0.40802730615624027699;0.85942344634968059758;0.95276499796802782694;0.29353093497924165334;1.5938266622761072533;0.43418081305755173993;1.9450026756093925506;-1.1017203198666207786;-0.74340865175887294036;-0.076509800071105082964;0.43406839230572447086;-0.87139311530457885802;0.86298889734819717034;0.1142153484710777267;1.7476446193732417811;-1.2515040988046355341;2.4092905456365518724;-0.11431124511748955164;2.1409608092329910356;3.588688071537172064;-0.22791659335445238477;-3.567190942354730776];
IW1_1 = [-0.65977741980525750343 -0.95542360046329311007 -0.06883292532284800147 -0.40820769705590165266 0.86053665272161194988 -0.081683811210412862747;1.5568584289697844358 2.8907237441772712927 -4.4749240277044881609 -0.76888538769711423093 1.8127504439884991605 -0.23567633284203060029;-0.36184377251979110701 -0.45929306314612766693 5.3762312349124243838 3.1218598263323351638 2.8158476491505584072 0.468435360270061385;-0.032433081281063258494 -0.38549939835628366236 -0.8762632900194232688 -0.57937504281061458222 -2.3081076626618930447 -1.9868167939745344786;-0.59549013462883981784 -0.20755365556070445865 0.41955182973230548127 1.3056829054652483446 0.59581166763140624987 -1.3188339679112721647;-0.91881911092348100834 -1.2528342601929811639 0.10669843729963476853 0.23542143648651928101 -0.74463783813453998661 0.19567884165699014898;-1.3988865991418724111 0.71032504797285644926 2.0557931233537933835 3.0602171097662997923 -0.49228417427292264774 5.0194069785729711342;0.015875807199452623281 0.07642709155978710811 -1.0622589745103396819 3.0551193031267942501 1.4683223601400301472 0.91785097822522909716;0.3517933171264330805 -0.71854411810171525676 0.16905666707647545866 -1.4380752450089084871 3.4416828283436422531 -0.91624153981266742708;-0.35005181165053839143 0.49517908655464742962 2.7455543157693398371 0.75762843350466013703 1.316057138352657363 0.26227247463498160052;-0.24283900755223317147 0.55853919707202048794 -0.11856179148279655244 2.0889775082946053786 1.576722051770112154 -0.038167222533907745052;0.30462323648026806699 0.23730637597016704388 0.5075326519199874209 -0.17783954857892561585 1.9553180289479377141 0.00062144960649310188039;-0.80384623267837118643 -1.1684527191246643074 -2.1247739700733450086 -0.48834529945083232638 -2.8136511336383378534 -1.0894798248064789803;0.78221653175407657166 0.4320774790063552917 1.9503677887661639012 0.24991136375233316547 -0.076388043323657908723 -0.80046752067884963111;-0.59086062749857859444 0.59179717509309426315 -0.51488447909992030027 1.9043337478747259794 1.1836601217959681343 1.1057198317646734775;0.15300218001812737612 0.019549768409831577015 0.11933945946327750853 -2.2841195994596343866 0.92469964903530155187 1.332950930501952902;-1.7444774314253872483 -0.35622621865023973431 -0.48814897217851094258 -0.48360314944677129656 3.0319868382889949565 -1.0815753734968229782;-1.3855278881173618277 0.25649066617000509938 -0.50099047980908451017 -0.5764763687649558932 0.95134006556959060941 -0.76071880828182603107;-0.34456374388050248214 -0.53579013955888310505 1.6945562469357970947 -0.82187901891859771464 -1.4333044318029668496 1.3141607309063407794;-0.026901208181879888992 0.16349098205216028301 -1.2335790900531311554 -1.3912468276338842976 1.0502951298744234165 -0.52386528723923719841;-0.32847228616024026771 -0.84026282696483933776 1.2303493480385303549 -1.7079737989103525031 -3.5460134497114443874 0.20802734229505048802;-0.19921681910200875198 0.11392355791144155586 0.9593562446176751024 -0.57877719737848609682 -1.7865545053609128701 0.34226644101149922284;1.0486298562987861338 0.79073634528432312774 0.098447361385041801118 -1.1050022735828652909 -1.5389982603643266312 0.028045525670591237022;-0.14573382820079397448 0.028488607069568502861 1.8562427482672638757 -0.096023467679655541418 1.8304372436174876082 -0.18045080989130776739;2.8852604411405620155 -0.70787494236595949193 -1.5246400419745267385 1.7179179022547732547 -0.9928168447020999654 1.5041240850238462023;1.2803829972551326044 -0.99308140340003303592 1.0968265122054234872 -0.8989808962595011721 0.63458270114062476086 -0.037672283214052026956;-0.18509152598450662186 -0.010833705850526341094 0.95721536144234908861 -0.071456223360615578333 -4.0964306767380840313 -2.0585354021002433278;-1.2236781907749054721 -1.1908127834322315142 -0.11748030825258276577 0.71355379115725769967 -0.90921702187942310402 0.53573400128526871278;0.029034994379495925737 0.16436710997430378778 0.94138643487837936341 0.11808230425291293963 0.62422935066440976559 0.039696482888364574559;-0.50309179654439450946 0.0090583560605715721104 -2.9956527808469752827 -0.87458152551829171362 -3.3393727593139641563 -0.80619429066193504241];

% Layer 2
b2 = [2.2978679478611496734;-0.59356812530788738425;0.37230189352450937523;-0.41555886065967378995;-2.2002672507728662232;0.39390966843960095733;0.79888816058832479161;-0.29539000240108137518;-0.2034842111147768251;-4.1136212001150926909];
LW2_1 = [2.6539621550449110643 -0.38725489408175350903 1.0065327337389937679 0.26518299845924414582 0.98430627094525258158 -1.7788574504333585224 1.5322240458576195099 1.2411928520860431302 0.17449172074754179529 0.31725506266680286727 -0.87011592075953503311 -0.96901817417635371932 -0.21719883885361704334 0.82040770393527684412 0.77345321723176108097 0.65843879434030783138 -0.96810632760135684194 1.5420600214994510946 -1.6175623592955143959 -0.79079468658309970408 -0.98509959305301608712 1.1038084091705917533 -2.3665200735329605664 1.5207492857630844352 0.077737150637363208738 0.85767775038776339347 -0.40460727721834288673 1.0995183913148049992 -4.1748811951358764105 2.0857357214307534754;2.2947557474763855545 0.2514199769414887653 0.51384907126874335148 -0.639253492458808803 -1.2932695162502421127 0.63145935113815265805 -0.10287136532715601689 -1.2756555403814042737 -2.3312386526046435797 0.37471453253692682539 0.26874380695075567038 0.27743848772022389193 0.46790987931596284 0.90664404682839883076 0.24285986847808693767 -0.71299261655975654239 0.42565878760085734678 -1.6798906594064255682 -0.12086035622272356393 0.18763049772680071015 0.27506533507719410636 0.76796238389290572002 0.8102740450887029322 0.71674063550870759087 -0.60242163082963207099 0.23838582017505965949 -0.28904708538589241051 -0.18298397982547429108 -3.2332189615773518909 0.34964395573349144053;-0.50511285135150063574 -0.7239918337191512121 -0.91857488522560937216 1.491246093837275577 -1.8843038369651086139 0.40144226038593050498 -0.50688145700203302013 -1.4500773054669902073 -1.1776263704778371366 -0.90489206472578764817 1.7353656721357066939 1.0322813606218914639 0.0392217448028313459 0.078654278831842866504 -1.0159752212026440521 0.09595770044195101045 0.69133038151662773441 -0.28678194760410596897 1.0152962741980158246 -0.35395368440560437406 0.23348038603635223875 -3.0260002052482208867 -0.27498565272218766786 -1.0404339065487453464 -0.39822252502381882966 -0.54586675645276427904 0.69600270328652191765 0.006061981212377900996 3.8083705922614905504 0.58798310557095079254;0.12223619211691226505 0.073865269455077472993 0.1373040957577730814 -0.53214418624118375867 0.20229057436009409421 0.59986435479111355207 -0.19693538143859898315 0.25362082921014184045 -0.21282625486364578626 0.34620590194507855353 0.65697264753104689383 1.8918150458756346488 0.12698036639816062676 0.23751860756561232746 -0.29101094678440042607 0.084847034287679007347 0.092541036537514817506 -0.28168978004390277103 -0.014326194760926360544 0.19419004274442766556 0.046924658828816488698 0.46254105489688668307 0.28862762146068576818 0.70705488497542789972 0.04399770651306315894 -0.0074780985110570394325 -0.48569174645774748633 0.11809840421134208677 -2.143498249247604015 0.88496337748417697178;2.2315552462164811587 0.1456857254451410788 0.25860945205526342239 -0.62504574584351846323 0.22286913130403149252 1.0352629496637051343 -0.51969909999378138821 -0.34368620396227589353 -0.30749110815729574497 -1.6874383706781375114 -0.29845195767025634037 2.009925998358951027 0.68735272517330170405 -1.2320894486495956865 0.39464042287050055124 -0.19663949568744426566 0.20131120823077303106 0.52007099907284881635 -0.46381395751403892147 -0.90423889064759566114 0.14245656652675026121 0.37897064992315010468 0.50976543470525015334 -0.97813033291237971856 0.080800013578747040266 0.20396537347344961821 1.0972079859709340521 0.014174255084392205217 4.7187339124355922593 0.64013823847653195109;0.029092956464177394116 -0.10725477122622026349 -0.48105895222676625655 0.72152515030731356749 0.10410070146950475833 1.6124266928417771982 0.02175385073216861212 0.10399326633697250633 -0.42128794201814750986 1.1173075598091715133 1.3593442758070379828 1.3301525500344311137 -0.2647478666681402637 0.90538729872171597179 -0.62552005935369425771 0.28761495572390682884 -0.35395394844987509986 -0.50634498294540519758 -0.66732222131584562064 0.67645376194072781573 0.17974746599961022309 1.5591440585184523915 0.99755636961327842638 1.0088845673529960312 -0.068191657663654453581 -0.23926707394513110905 -0.97519477783938735005 -0.034121164095746100986 -3.9824253200777688377 0.26486663877574478931;2.5473277765816235707 -0.084947883060935286403 0.33787241071284290772 -0.2159371340336283529 0.55432749714283180431 -0.71138978928773355381 0.80528416926983914514 -0.89613203801916196944 0.18970010464299874586 0.6726262924513782826 -0.072526984381213549513 1.1526415695807945561 -0.11528886234938001687 1.1254964702145084932 1.5182029062098743033 0.36143011266388874736 -0.87690197004175052253 0.91269611735835887156 -0.39362722220345669477 -2.0095263987841534004 0.86007235448691132795 -1.3509935140710451762 0.31488726364156044424 1.7659395371507784489 0.081089099994436489305 -0.10645547639545022145 0.89200282439301348258 -3.3818732589932274379 -7.4412006617270982645 0.5847480373129368969;-3.7900360264364088003 0.27122828580594277037 1.2345598322281463588 2.9430061705055616805 0.65998894058155233022 -1.3187853552676134239 -0.60335126489598578381 -0.61514706176339828403 0.67074342729183067391 -1.7217518006162433331 -0.5624443336922471115 -1.4290577001477133834 -0.80486533096518941832 -2.5530358775377730574 -0.1288718895511268836 -0.52468380045832430092 0.015363272249908806188 0.12386582220341287031 0.42484347250152987296 -0.25768625215836299391 -0.9745593852831968551 0.23986586746898139189 -1.4171087008424345655 -0.83144445012488032987 -0.16686475574835368807 0.38894329224353108021 0.89519974440742622335 1.5910046090146559017 4.2496492711575104551 -0.51027791568635694208;-0.054456783729229220337 0.13679948350101145405 1.1763036479865680572 0.64979582824650627959 1.2055391359616514091 -0.80495777062649231937 0.17226870085802295507 -1.1587947586167646197 1.6277053469931792584 -1.8259996897862746934 -1.1222451756980402759 0.85254160608914031361 -1.7887685035807858736 -2.7174129538195299638 1.0736623771583884146 0.23751342699732180819 -0.11526450898383874821 0.73075771849772508393 -1.3198798450861863873 -2.2841151223106073154 -0.88717922174802543722 2.2507464964912005101 -1.6659431992021935809 0.26744539031707614818 -0.27327703607453746049 0.38490610540859704347 0.88617225191195558853 -0.050015681186084660903 0.029029691947256790197 -0.49499806875320417898;1.7088467718815893992 -0.28570432899973552399 -0.13652703535811910873 0.40638267167569452898 1.1526114121406056956 0.67607712756862881065 0.31939273849729060695 -0.99726563590592198771 2.2069699200109860193 -0.80293834026483790201 -1.5280587935981819747 0.010335773390483598069 0.40362313090199497534 -3.1582079922990882181 -0.49916442259777749069 0.50915731801119390454 -1.001987135216664937 0.92414125565047211541 -2.0669187710982841466 -1.4462920109823056425 -0.43477988088355595808 1.9570889892318146241 0.33966989659665453027 0.87466067377523559756 0.26354961561298323458 -0.42316641311623814925 -0.4919142585155290015 -1.3729532633814303111 -0.22610273578116119042 -2.521825042402987993];

% Layer 3
b3 = 2.7118605742045365226;
LW3_2 = [-2.5378222811179069751 -0.1909681371604781408 0.2615487530244794967 0.73023640129926870035 -0.21766786931112039327 -0.29878444954508792675 0.40816817918021763845 -0.17994762923178841962 0.14680246602722321625 0.07339609079360422117];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
