function [Y,Xf,Af] = ESPER_talk_12_Atl_3(X,~,~)
%ESPER_TALK_12_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_12_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.36362330131811743;-1.2996485233087984;0.96755970902504229;-7.0060458378864556;2.1131880613826284;2.0044538938257146;1.7561292959975303;-0.46419444046195868;-8.8540637348365827;5.0331609884245117;-2.166612501150825;1.6762600415890272;6.8127600208050083;-0.50083629272174934;-0.065203683222370343;-3.391538351120206;0.32498824072373;3.7226509193939341;-2.0929232895197569;4.3419795236783525;4.0720575167782638;-3.7598499391566031;-2.6184953944148042;0.86481402941488217;6.7322980792570766];
IW1_1 = [0.69435716109833268 -1.1028007601112566 -1.4555219193222442 0.10270301557428747 -1.0470440860325401 0.47187308761960389;1.5403907586107319 -1.2865416276877937 0.75388301871417074 0.39710815483060968 -3.8999614817452959 0.77305458343518851;0.1642893699165536 -0.89639798431502882 -1.9037919279903384 0.016785574588266541 -0.30448830661848164 -1.2304665830965085;3.5041842690264668 -2.6242643325088011 2.4544932626153546 0.063217909935130087 3.2289493759119714 0.87977012526543796;0.3355921887505407 -0.12902062067913517 2.8989553127109335 -0.34379669210112285 -3.5378726613519542 0.60789885792966381;-0.060302401197142759 0.30309801738932557 1.055324766661619 -0.33979989903216939 -2.235777256995048 -0.12040569829624975;-0.29117747568086105 0.097622841685450365 -0.94509761580368901 0.015197959132299547 -2.6048559035930534 -0.99632110830736509;0.20205476373276837 -0.34471450152423955 -1.1154826258663353 0.55575288626600861 -0.52564662819370545 0.53625425356584433;1.5374360136304965 -0.7256657588511306 -0.071625791244344289 0.528701159503707 8.3255175126397383 0.81542647536072754;-1.7029515204883359 0.81992873937230415 -1.2086357248427129 -0.044445965141816222 -4.2906244826851623 -1.0948875859349019;0.57073646843873338 -1.528017181697032 2.5289160691693287 -0.34535307215822891 0.35754537947998621 -0.033415934954706052;1.3546642650380987 1.199536907481773 -0.58372623524331324 -0.38213153363032293 0.38261890000291593 -0.11236379136167179;-2.477140733609509 2.4025888692455357 -3.9652218360603224 -0.25916582173558028 -6.049123797661129 -1.3990840029486897;-0.18256717251452162 0.34589646776700544 -1.3990283451510157 -0.20660094893122513 2.7334273545077479 -1.486380283441737;3.9912133310818554 -1.677785901002085 -1.8421262221466177 -1.6726476568025663 0.4348452857204132 0.3054559765543739;1.6264307962735083 -3.0371596471619555 -2.1168163547311361 0.2410854107498685 3.3475768609040353 1.1256783649947386;1.8115900747453066 -0.84676737412654501 -0.50384034444546344 -0.16570424054785782 -1.9829725656410231 -0.53017208265113536;-0.9212279063467953 2.2946809230553242 2.4257142463400303 -0.15264483717239599 -3.3384216112789709 -0.3415546695819473;-0.43947964820864299 -0.85903921252323878 2.3300801832909119 1.2559987948444729 -3.6316636846992898 -0.96680818206862806;0.66911250694018898 -0.068687538576104504 -0.94211158636445691 -0.58403293180061722 -5.807844380223913 -0.76086008462753141;1.8326543319103905 -1.1986093207503679 -4.6246874337289281 -0.48112213704088153 -1.1875230862992752 -1.1635831679351505;-0.41601424382839158 -0.0097109984020061907 3.1087538857348962 -0.076216227937753275 3.354988677813763 1.1666271478646408;-3.1359320483753423 1.7313115954103226 1.8583568978357856 2.3421328791077736 0.40726943188906589 0.5782088207069126;1.5849615392854661 0.60999943925897915 -0.58635852059604288 -0.26486362095078786 -0.15208715227979414 -0.27576319654947595;3.6280278748153041 -1.0028320849190251 -1.0607693367969016 6.59307596613389 2.85578050329124 1.1695397602413842];

% Layer 2
b2 = [-7.2725097174902009;13.180146932714347;2.204299638816547;2.0007947284684602;-4.7780596613596282;-7.8988012729830999;-16.92063053563508;-8.0978427636185639;3.068556387689104;1.4076794543741529;3.3131500996187624;1.9195282987875462;2.2964347022151195;-0.55349698573998019;2.8911679648155277];
LW2_1 = [-6.5580622285370929 -9.1645550643496829 4.9833888059837692 -1.8524019014514923 13.415628010015933 -0.26656520100021325 -1.3238790718696085 -3.0562354917307264 10.805904192750882 -0.56058961845452004 2.0054086793713743 -2.7490460185925145 1.9091868768134432 -4.332641964996923 1.7065014577306659 -1.0973085872677526 -0.32132549738169836 -4.7035808504174801 6.5438274063876074 -0.61595585531543251 0.23095104950995593 -1.6440138256474297 4.9368742991290508 8.6195521202014884 -3.6633292220296485;0.99279903906335432 0.59156156072556176 -3.704517335532119 -1.2027171544157667 -3.0817430139698327 -2.2694162858325289 -2.6621629826262097 -1.2399539106563848 4.5615810034591533 -2.0954869698128267 0.94092556174477626 -5.5221423503036631 -0.44205801543171519 -0.59279430561477642 -0.47823048340217383 0.71617904082942807 -3.6803428177112409 2.2127057251420541 9.9670577574798394 3.5112770479266286 5.2694379113308107 -1.8603738763388653 3.3397595674046405 6.027799767680075 3.2612418051659269;3.4657533650115795 -1.6040730909336023 -4.8714694343339255 -2.2220250637182093 2.1734133587978115 2.5808991410711224 -3.931787459022821 4.1155959704417686 -2.8625239211454421 0.0086572435164456972 -1.0651257757770078 0.95135766473142724 -0.94104926687836554 -2.1193048019817242 -3.5078310993899784 2.2650318186673659 -1.18074666142405 3.0794625285965727 -1.5952710116060538 -2.8291503930083342 -1.3003871542510876 -1.9539308963863162 -3.1068994862472072 -1.2197895570096904 6.5810423209579021;-6.135835890185561 4.3052983379036194 0.045968838812342726 1.1412132272803253 1.309890427996534 -1.9835833656276132 1.8561699701587175 1.5961361671900056 -0.88908106748075022 -1.7365682828822413 -2.5736461435620632 -5.1968368194814669 -4.356064133770559 1.6999578653839527 2.7315583466105373 -0.64686977985677796 -6.2039626806185373 -7.2123764843387539 -5.6046422812319809 2.2184814294555069 -0.54161068680759983 -3.1809496931150392 -1.0958632371447259 -0.33847337723939941 2.2257515192019111;-1.9916982220008772 -5.6107519494229177 6.1034833547887821 0.96047509425112232 -3.1324485204643979 3.4651597424481655 -3.2673572033664349 -0.11102738106480964 0.53422600362909844 1.3699027363395726 -0.034127642090308954 3.325117838602822 -2.3306909687278958 -11.413297419269961 -2.7031695538524025 -0.090902216932628649 -4.6649395672770169 -1.1472120235721053 -1.7236022731823255 2.9755907728791109 0.62104098041399092 -7.4258230723095107 -1.1209899594671866 -3.287142369770006 2.8411030050539323;-0.52781616465574444 2.0741793524204382 19.178677545414789 0.25547184159218328 -0.13785208824017184 -0.34700726426066314 3.4538120968528312 -3.2666050480761144 1.2887480695482758 0.6967470184008282 -2.7746235629264548 -0.13121778136170603 -0.98540548787767435 -5.8523868189329198 1.0395103364774938 -1.0726167511680986 -7.9193778208260843 -0.61511224007782994 0.63152561057466949 1.7865011659581223 -3.8280006471388361 1.2817052842181067 2.937549019494281 10.174019267934568 -1.0840632044856835;4.280384878046867 -39.889227809546867 4.7277157023955274 -0.29891654290159231 0.68252221345237885 -2.2925564192728833 0.59647791168911957 -0.41543868816791768 13.272236492518436 -4.1671378119367359 2.7865042862775899 -6.9672496180735912 -0.090555295335374056 2.0268684784514726 1.0419205847777961 -0.70650544375965363 -6.5425454055486032 0.56731756244324583 -1.5858403901893496 -2.6557019630803604 -4.9815956696632915 0.45574911604847967 2.1625521581964535 8.3311100396348774 -1.7749630087298831;-5.1708266155269813 -10.859722619007696 4.6159810936717189 -1.4999420334851641 4.1048454204795037 -1.5581864602436029 1.3215173382150178 -1.3975120239420904 -2.8872079108827799 -2.6797286995043605 -1.7460887620076819 -8.3754800031602077 0.54961511489671433 -1.4713758267932608 1.1139148845709539 -0.22920397897109496 0.49611083476240248 -4.050968680719353 -2.2892201370144885 -2.4236674112869241 -1.4382275529928674 0.90340523819931196 4.9371414399638818 5.0522708944140051 -0.30328834214126388;6.5481223813992431 4.8199170840427872 -4.8204926504247663 2.0977816706585148 -6.3790910662496563 4.1795666479218978 -1.8624515488193281 3.9449961406343776 5.9640356781122579 3.3071599258921642 1.5815202032503122 7.7520070260977585 -0.6471580286420836 2.4236963961937428 -1.3433059683341895 0.50335965444594366 0.14214601481629863 6.2653345376585392 -1.1716587876219944 2.8152855299932606 1.376415502260711 -0.90655671793552639 -5.0024132177760547 -5.1022740308305359 0.28899883206339178;-7.4688669547260025 -1.1008728111071655 -0.73222854722801933 -0.23623652784007898 1.2545537212314166 4.27315199486456 18.12853685118548 22.319446091682096 -3.6109358973557772 15.410354932175602 0.62255902807351415 -2.846254677091137 -1.5208486215044545 -2.6049782604558556 1.3141832763250432 15.518452099713016 0.93792624454709295 11.982737881181237 4.5864981258434234 -1.2195567752858576 -0.2372163954625193 10.548762510404934 1.8794741588573693 -0.89720490290022159 7.4368601584462253;5.307234040880668 9.8711199616379304 -2.4947052384615906 -0.12438405515241117 -1.9420214154857505 3.032924912078141 0.95213349443665818 2.3733392899644601 -5.8771660556840972 1.6920973663857608 1.5483620494936903 3.3836989661013144 0.11316116257330305 -5.3895482547405651 -4.4326123061324498 1.7161282545063818 2.4195261308392544 3.4795083568206495 -1.4410819155844949 2.3660810005427222 0.32002486755476423 -0.88921394871398673 -1.6349221998794592 -1.7654918369883248 -1.433715371803139;-0.11600025529089927 4.8878256295471507 1.7832067279120065 -2.1041636326971762 3.0201802149013366 1.6709184361388716 9.3937642223119759 -0.39213851966580904 -0.26606363502678626 0.70658926106337572 -2.1608879676430859 -5.3584643068143007 -1.4223550632005735 -4.0629181670639127 -0.17452698669431235 1.5781614022163897 -3.7064823226945043 0.16939991404521279 -7.3855035463319201 -0.87244834654719738 -0.77463773843400729 8.8383473683892539 1.8593404318140232 4.7513219116787502 4.2057257521770923;1.0932017759129136 -6.0830319107510116 1.8481592412192707 2.6983517498194325 -4.8122315569086735 -1.515824804489019 -8.099137717963373 -0.89225125332215394 4.1258923453820397 10.774199097751563 0.59510764931695692 -0.16996783113597802 1.8891167909729973 -4.9668686623877818 -0.63363144913061609 3.6969500783151177 1.9522431734054368 7.8784963169520941 -4.4142014195001051 -0.85471491044349435 -4.0640403262890494 3.2030543698449851 -1.4051963974833719 -0.16101522425405385 -2.0711213942774562;-3.0611387255968001 2.5837750911318853 -3.4429143300743217 -1.7737507436275077 -1.8772314187797612 2.5704217954734658 -0.73083801674658722 -3.6764557148807384 7.7282061253971541 8.4707626651339112 -4.5320051826386987 -4.4375077804632737 4.9903757581861443 -7.3139617597463831 3.2590766250649481 5.5787686484389098 -6.1369651580157223 -1.4860546489798079 -10.697290819055807 3.7215280015437666 -3.9040036780920109 0.81815126630299884 -0.49411260744106994 -4.5770122855774762 3.9795337084124651;12.784706502639628 -1.172374954502116 -3.8876313310023281 4.0221329719280119 1.7088500508260203 1.1808066876002148 -8.6486143423332251 2.2382603102264 0.33405342824930928 -5.8786016211576797 0.2615766313542629 1.0751167500072716 0.14711464429166154 3.674478666370717 -0.1936178381364376 -3.8382704087991018 3.1102631406178909 18.169999656755181 -5.0548009089184234 4.0896520413606936 8.7770871893414117 -7.16278234744704 0.2646391618007044 -3.6462435590638345 -5.0511836982392175];

% Layer 3
b3 = 0.12434899046861632;
LW3_2 = [-0.028067432317363236 0.030245727674664609 -0.02406660684689714 0.0074173161916080265 -0.0027895416340041781 0.02299538377513425 0.031920292385488803 0.4115240333127359 0.40316946334933512 -0.0028070916837665875 -0.011820986907316127 -0.01808604579779349 0.30863073715951816 0.0022709742374778124 2.2254247373737435e-05];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
