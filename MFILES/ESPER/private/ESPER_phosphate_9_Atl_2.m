function [Y,Xf,Af] = ESPER_phosphate_9_Atl_2(X,~,~)
%ESPER_PHOSPHATE_9_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_9_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.8903245059018887186;-2.4923195130844635337;-1.6134465192901135122;2.0908943482559521065;1.1993431670952638957;0.73648424149211444423;0.99088439550782803078;0.60353466761127905205;-1.3830718090728737479;0.18238936402855038255;1.4472809309068024319;0.72515144293841782286;2.1122192909383619153;-0.58960052246668837039;1.3234846034279965643;-1.1114032479449340585;2.1784498282637900779;2.4483776708844056103;2.1869410770158164148;2.6364492325761892388];
IW1_1 = [0.73901646493264894211 -1.0215933680754281099 1.7294572401337935386 0.69364551786428008118 -1.6347443888711807869 0.31074947671245195524 0.40587299757230699271 -0.88601520919433329748;0.94443100537729418598 -0.86607981137615530631 -0.38579231767043847823 -1.2918234663102277082 -1.6845747115927296456 -0.64081442772643815164 -0.8535620077621040025 -0.49795719439018021335;1.7980523038817561865 0.54561428885901175345 -1.0696300406626342294 0.094838124348735758362 0.49407242898143133303 -0.75113420357850235742 1.6174375213868488199 1.1352760679582576397;-0.26961480504749379961 -1.2498261407827149228 -0.17780797670441950142 -0.084749001669202253528 -0.22140569105145443962 -0.47797337725407329501 -0.11131926264521532777 -1.0660749062576744262;-0.79540854447890274592 0.72113692093152648166 -0.37096195027823292145 -0.37932807702559889762 -0.55647154544905641504 0.78879919569599810103 0.32685514734060461262 -0.7921286381964905976;-0.097397214341106319591 0.31157861886015741915 -1.005400542919796969 0.45841977446619797121 0.39883129722566174058 0.53622625007346391701 -2.1762818100579091052 0.36546313993681123211;-0.44718798116004171428 0.4000500498898233448 -0.75069307677569363513 -0.25502627790674409214 1.0856581770108895135 0.35846200062236410755 0.29467551527065033445 1.7542720964873115275;-0.63395741829878127227 1.4332447849949800922 1.4502752949904733626 -0.38724494517385343872 -0.96855975676723682355 -1.5414571999799353552 1.4186042953092239394 -0.17029393401902090388;0.087823795760461315085 -0.44152621480694070888 -0.069624092481011742861 -0.014930101824867770752 2.3199537670633576525 -0.30712171643807939514 0.069897273729084580252 0.15755622555550163888;0.44955472865857820652 0.37946793920507149167 -0.26175729722749235817 -1.1991323621103235908 0.29519912926755631499 -0.32466539332098887094 -1.0657665314196045347 -1.4973279624044355529;-1.3020341145059046717 -0.43846462080461640065 -2.3221730861267304569 -0.84186913264976903637 -4.6891131679147548539 -1.5524925276521650552 0.54572031245692209644 0.9109342838285545696;1.4883144843220221798 -1.3523528194264409219 0.029794174855325334522 0.10218784459139389209 -1.959242465565525837 -0.62795660191577595821 0.51894175159245525819 0.76836719280621978978;0.20830861272228426428 -0.46725087484751987033 1.3440170351929709991 0.64454484760768404605 -2.7861900041865870215 0.55695378179819610143 -0.30581872961523659527 0.70843251802912932114;-0.99797686677143093714 0.65224988082292367775 -1.0982466136167898796 -0.7911658737708539002 -0.90993266193238131478 0.56196383047686349066 0.12628228678840835997 -1.5352712218001156597;0.098778713472567045151 -0.1521557864607786803 -1.9520746151584467132 -0.37169970632599430571 0.82609628097819343129 -0.50488741796670077999 0.63140162907362351596 0.0058025525826165304244;-2.1721225587777506227 1.2296902893193861761 -2.1569951360907908544 -0.7691570244950133306 0.90203468555828847375 -0.71989261984715025022 0.33898149180655817725 -0.29463194512905610534;0.38808460348675116736 -1.0223563814290148599 0.089957112185591381337 -0.033839203813797721909 0.872569065725144144 3.2305062177143306634 0.31569977444551178269 -0.54670954427182749669;0.39264547540363220479 -0.62171398001336175554 -1.036325055953061236 0.24303700097146477277 -0.91156404348296093954 1.720089174575828439 -0.1565024934558451597 0.91677916975754625284;0.30148607233164520514 1.073004119112842325 -0.079101262366241126278 2.683659456876403393 1.6905480256557274821 0.61148936428770983564 2.5742963214449319231 -1.030846398713405776;0.708356880263225408 -1.1430708351751659446 0.45052442293866357126 0.58582184708944762264 -1.6866351135484016766 0.25680914581008168485 0.65338823057243688996 0.57653476105849099653];

% Layer 2
b2 = [-2.3298454089529823108;1.1174209161627708387;1.4674068021542547857;1.4294764737619203299;1.3549949543002532959;-0.81622752082055283207;-0.61371803599665564199;-0.15277263166752014234;0.10919307952943113627;-0.40699890566005109127;-0.07046743887849271637;-0.37199534096828051899;-0.92774959661194222882;0.10660666626509970878;1.0827516934234275858;-1.5812973674743071584;-0.026200282651947071066;1.5330922734987695311;-1.9858316999123075686;1.556357962470440226];
LW2_1 = [-0.46217152083211116009 0.2611796228083394511 0.31527244170905893705 -0.89861467216593271523 -0.22616439081720793314 -0.066479129378006263096 0.54125235212222522208 1.1943049307073485554 -0.31684395900690254244 0.18711553766526997644 -1.3024030157442874067 0.27132145303893046018 1.2534479752497986738 1.2057989654126120005 0.11086569630852986801 -0.2312604345896992486 0.87616035687607218829 0.24781901623217883479 -0.61954177203101434834 0.028909761828674912509;0.29179662891390217849 0.10570374404466444107 0.3924887754278673091 -0.36101800727458943641 -0.35843579163871791549 0.33669967399884315196 -0.57077944221520127144 0.52680609668528644018 -0.58074173095326986349 0.43940368082240260916 0.87501390383734167777 -0.21284863296581199577 0.046499771801134764937 -0.6451483209551570619 0.81956188894385817445 0.32293157638460978642 1.0328723288050338791 -0.049406053481037243147 0.64901938504809586483 -0.3857835184523104588;-1.1180738056070178565 -0.78862448475509883128 0.21982726945980901601 -0.31197649303267510623 -0.9174888820261785094 0.09592014071644955342 -0.3552382770392343847 0.75883121514790818907 -0.62050236942609460211 -0.46444210117387552117 0.0086540848548574324933 0.65013395318698363745 0.66573022706737516874 0.41259554892949817928 -0.25601769931651752188 -0.010327682591507264531 0.94587507740864507078 0.67927968742639421862 -0.15906220528995712593 -0.59390219253037213054;-0.52798385711832862555 -0.5608210072309361971 0.10347637400692343002 -0.2209293388973692096 -1.0184709201071888707 -0.15583702699642576484 0.82618107658261896731 0.93507417086782884663 0.59074743903190929384 0.46103884032369735202 -0.0050029374117788617121 0.97718478760211568979 -0.17471723088432003501 -0.43471217955530044863 -0.83168460337690652828 0.26225064389458735414 -1.0465496643864076187 0.71702063532613358188 0.088420846996290061726 -0.08930827378236075309;-0.078409891835637388069 0.24698432391080052395 -0.27446953560812431538 0.40535919518417384833 0.5746757889593537838 0.0010999133131926845663 0.20854435176371180494 -0.58692865776401692557 -0.56252884093875143989 0.028678989345755391549 1.0423301848278694326 0.34895084914493751382 0.6155604641091881879 -0.90377750294382941387 -0.58158696621229355461 0.63881477761227645207 -0.076076169931801954083 0.20323824748182495181 0.33142532500565469178 -0.88885392590261813606;0.67113119173611901491 0.54290065854982938465 -0.51414125731867998947 0.35030129443050078697 0.61344170121877061863 0.17896578115334674242 -0.68981529972579891385 0.61919925449244639371 -1.0651216727015064833 -0.80953064213944858629 -0.32760390170661246589 -0.27699100478102761658 0.10703675209492570508 1.1085885206605414766 0.23076795640147532152 -0.34869840638778476505 1.0737026513888254797 -0.14066712572479067589 -0.42252967778734945581 -0.25262499695179796433;0.25238150683982130129 -0.58829935713031500377 -0.39966232675528712281 -0.44999737682905638358 -0.10942563802876636991 0.64033648253647101889 0.83266908400346439922 0.36830290371540341798 0.46985207592386446507 -0.31788226824653942337 0.0065070557819445866421 0.58328000501798193955 -0.85213964342893822046 1.101273438540348204 0.35581524457183649757 -0.25439326449470123226 -0.26563819038655128724 0.22995173072718883001 0.52451326176146506608 0.21324691666089207187;0.53666547176302836775 0.13990084638205876888 -0.21154687267750718616 0.82685310695522662439 0.10064571419048072565 0.28381911357551420361 0.31032190975866819072 -0.63614923824009217412 -0.30621812828979355636 -0.41959743002234001219 -0.19451409381959833267 -0.05881540608532648956 -1.0537992736793317938 -0.52592146005128026509 0.47776070944711951372 -0.1129363048488833815 -0.87540190271846762826 -0.45229431099309314046 0.13547794791762135524 0.069171369910668217829;-0.17268455578021771335 0.12964442706793344318 -0.28292191186582255069 -0.32635431076255294602 -0.62790541676772637647 -0.01676932633955328586 0.44122138520163589614 0.18190377610471247793 0.62291585370386826082 0.18226033539311189968 -1.6029018982521847647 -0.38635099700520086907 -1.1630530715973401712 -0.33710590771663162535 0.28531879464777670785 -0.01015848934448871331 -0.29731538412297597862 0.23652835475544761734 0.53564438260807012426 0.75510818003088053807;0.067843296282558279708 -0.44365016346240049305 -0.36520459342378241985 -0.68920156182228275998 0.0076887625936091340967 0.8357441858130784107 0.84770425730751808313 0.53387393952133543884 0.15523156745152744129 -0.38045929414743073771 -0.091837722860051734797 0.56874390005427322148 -0.87707300912797181436 1.1088925953498203203 0.181983801410671997 -0.2546671179672463925 0.10525154297240657542 0.37717918507150527407 0.21042248695773918543 0.46711441825689192786;0.47225913138890152076 -0.54355210555581501275 -0.37244974986399437267 0.18222132437574090069 0.85130110344168696823 1.4107362276126762524 0.58634563856271859628 0.54186099563009548774 0.46162541324311473501 -0.48071378411314430457 1.7618467281486220877 0.73991876097509057253 -0.94240384563738621715 0.8947576763126421362 0.87143474660234032658 -0.49549514840413089178 0.097294808860764817049 -0.72391788257515676808 0.24841256579832166063 1.0008288043592039607;-1.0192009039292446726 -0.44355694653346611211 0.40924257878508207842 -0.38767713031241696209 0.30670022141306618746 0.306009257339352303 0.64127396893630395081 0.53513310808930592 0.36055120022619818743 -0.28364295764606828332 -0.076426271958947883389 0.8184999994150680136 0.23257967810200136372 0.28692875172685872176 -0.43878794172912177762 -0.19899751126244114019 -0.13425949964053568442 -0.41536973510818747668 0.085311184803025283396 -0.70927783490767093433;-0.88958309536490265401 0.65257748918568625474 0.6832060913530286772 -0.4209795994229162952 -0.092019887347620246687 -0.56797774821073443441 0.83060103388359540766 0.47093487023812152792 -0.47273141690565223527 -0.48671116041635792415 0.18266751308251572006 0.095955632745657340466 -0.1250224149673665186 -0.9025334212234847886 0.057572137612580898125 -0.31007133157578736782 -0.69422583038311747039 0.29457551714358054529 -0.7405598622665312547 0.45717480554509337676;-0.13441361539780824486 0.074926350668776564579 0.25917102650651652196 0.25210883882918599941 -0.13447781433145880592 -0.24715622440009202276 0.41497877720626985543 0.21866234371616002918 0.12840854107269614182 -0.13621958557708949145 -1.0288327408022830411 -0.50440749785913685521 -0.31668780578673560999 0.22888942626618372089 -0.22157794681189182939 -0.52444674961886106335 0.1043146241368877597 -0.082683968129590362794 -0.62789895503452375358 -0.47267160547789494052;0.49275455237321769131 0.34145860054638982328 -0.12394683068666313697 0.87570676117766510504 0.1734280944541654601 -0.3322363331423193733 -0.37176576438881192566 0.52389552561562258148 0.21964428391823470621 0.05403265136193385193 -0.38235869112933562608 -0.50664503133582672323 -0.22682502823638919787 -0.41537477090836016913 -0.045427486072380951487 -0.18277232373022817002 0.18380695860190590651 0.30179858932204184363 -0.18607042745654248095 -0.44028662937619117423;0.13058396150614909326 0.57270918877201149044 0.29137923394367643004 0.085765184291510754289 1.0631675099231316928 -0.057401780715219244411 -0.85291552329551689748 -1.413512516333427893 -1.0699084417985056383 -0.21562698153421011593 -0.49827160762370065195 -0.66603041174608013097 0.65721986526114617444 0.097100249369500762908 0.84577568174585349148 0.32439190228264458415 0.80763167816367176233 -0.87232395546451968471 -0.19671730223075725719 0.23373622432311913499;0.038060509254142643742 0.55554091239513958556 0.068803321703228129125 1.0223118819190077922 0.52448076252225939164 0.39300857337793021484 0.29594465263690084011 -0.48163649864566021597 -0.61235120568994327872 -0.23182051877197182299 -0.59926275933423522879 0.028651678306886609743 -0.52579515522971731478 -1.3433982283719216877 -0.23879183732785316807 0.6647023158582936464 -0.83223737698011568398 0.1720168540943308455 -0.022851076891414284081 -0.17825337609532690419;-0.15782426761041587482 -0.026858217598519844999 -0.16086382297890275406 0.91201968092874685645 0.64818802548754739234 -0.72160537091243937002 0.022366533537656344 -0.40656293088076717046 -0.18289608049568223391 0.41544772259344925347 -0.5144181173269053442 0.059613009430917296427 0.85506517014200134064 -0.12666055664210720821 0.2244266409164070164 -0.44318735359704530818 -1.1699791759776796418 -0.75611888372268565295 -0.51366044411417632887 -0.30281866418537023433;-0.53762527307143370692 -0.19170125987638622633 -0.48422269132605388897 -0.36048668360079783035 0.0019658331191648552305 0.18875095316340573248 0.50049276902099426589 0.21604466283515899594 -0.2300262341843204994 0.12896628375119231769 -0.49327252800970244895 -0.35518937603766848055 0.43978147977241394129 -0.61325462518610462936 0.038705134645445039843 -0.07126583903037631007 0.29648998603577220168 0.41086695127230882241 -0.47060513656055946718 0.26373210700524901684;0.45033545907272815034 0.080615426231788342437 -0.35930375189866164964 -0.22158946330821582826 0.18004240231200840938 0.40975965848474343867 -0.68094537933610455038 -0.46199214528505205823 1.4525130682913212077 0.50017436372012158419 -0.41689377192594456734 -0.06667392739937735846 0.54540022546361177636 0.45496530306077653805 -0.4030671623259262093 0.47022254670475266414 0.15759659042581536381 -0.13366895657037156098 -0.076130585194204111743 0.42370495762063092871];

% Layer 3
b3 = -0.7430199310191601958;
LW3_2 = [1.1339500785155554041 -0.57621882484448427864 1.8618446725708905909 -0.98234385745808661117 0.61043579563421479506 -0.71839278728993172241 1.2363986134048430277 -1.0595959844094757774 0.20756640610506615907 -1.4227535937145341371 0.45262467511844833856 -0.86616214279584091695 -0.87330588722828572656 0.72970019513728734406 -1.7703081112694376564 -0.92463381771034924839 0.80722503192902905766 0.96383620589550866864 -0.7325474203909575488 -1.6422767875033412732];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
