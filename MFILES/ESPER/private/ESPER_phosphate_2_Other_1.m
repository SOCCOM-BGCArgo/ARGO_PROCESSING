function [Y,Xf,Af] = ESPER_phosphate_2_Other_1(X,~,~)
%ESPER_PHOSPHATE_2_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_2_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.0232926480684256809;-2.4627639387881119504;4.5758338360391777044;2.5670729039128445947;-1.8886587837965254089;-4.4036450868016343563;1.1987358905936151832;-2.2457955206829649519;0.48006849844341303868;0.50004122537203399279;0.28139209320031910444;1.313646888204153873;1.6863751414707075504;0.73446706223877900044;0.50443149761149796984;1.9962248903405337419;0.59465640696179700164;1.4981553533130449463;0.91406425036120420025;-0.15625657693088135236;0.47666385889209728077;0.98420616858439413654;0.24919835813171176131;2.0619199584161189698;-0.79002084799409233451;-0.63487853774766944692;0.29667102652397470131;-1.4990749841704176237;0.48204703354459488285;1.1744699251877086521;-0.99900367683513779937;-0.066849979743360807283;-2.33946717295168094;2.0337488152127174423;-2.598337100464026328;2.4442307737376833821;3.6262717927922731853;-2.4169472573112646963;-5.783967288012196839;-3.2818038893125813793];
IW1_1 = [-0.027877877187740318643 0.07588363019276690713 0.59692692671586011777 -0.72785236989916701766 -2.1578655524635625973 0.23618783568316478738 -0.38166982301656743326 -0.32205415798632253122;0.23183551113882719386 -0.30440390721055027301 0.87352901309762365223 -0.040752764101581920309 -0.96558674339033334633 1.3136886106229757054 -3.0416495593451058355 2.5479786556573902345;-2.2893085209502852528 -3.8955891311944439437 -1.7914961773750701646 0.90901771277357934498 -1.661417509064619491 0.77728437250256843249 0.97017166846451996509 -0.16033398527444228665;-0.55635135837388871582 0.01095287724053287462 -1.3743626837279410147 0.77063995628425563389 0.308483050942893966 0.20071551728076095222 0.65170984301028511698 -0.34653983543958477576;1.0163518580548207559 -0.35155995065957623691 -0.51319565219492968566 0.14862396829665439069 -1.2640321429443848178 -0.71466358052423661906 0.021320397016108379867 -0.92950590154523626829;0.81364821322364633271 -0.023418109629726856918 1.82828574263020327 -1.236414431278774817 -0.66789106839857181885 -0.39618742617835378539 -0.92681584358421009728 -0.60707941705709578262;-0.84432005348037342252 1.5585993572693512821 -0.16041380179463496369 -0.85016007312895847114 -2.3462617472763085402 -1.9696092573225580935 -1.2187637229506411707 2.0059208856699601853;-0.054490676485929277761 0.22288151664293101573 0.96080350178618989521 0.43370593050605626972 -3.7321370230134913726 -0.033780705611134241584 0.83358649515795868457 1.5623126541684020374;-0.36349850420804530327 -0.11572089383664149742 0.19197955236823180392 -0.25570064440201650813 0.39567879705145697633 -0.065871967287838797955 -0.99121443662213515324 0.75140767450219869694;1.8750873692811864668 0.40575762953459065807 0.41866070262391630319 0.098615121297882399332 -0.017581319492213406952 1.5215647825811087213 1.9332290865436934091 -1.2004964134131217435;0.0090243734518353317664 -0.36737516330001451781 7.3094892002608062853 -0.1828488178718008228 -1.7165284428340590317 -0.16073713924164606537 -0.18279776414999571177 0.056741315218989618607;-0.071494798973256626362 0.032643540415719339565 -0.72610131653025955512 0.027581240406841331381 0.39264679549875591835 0.027200377641610744978 -0.30046578798284390155 -0.066821760996557261203;-0.71394166287643556768 0.13709156886555298738 0.60618964319799428786 0.15141442313523581498 0.71734916730098807758 -0.15600760170195418497 0.20031200662624135123 1.3677812625248679801;-0.030870518847948467955 0.35218409357036145613 6.2180679949189494593 0.8350551371587474625 -1.3217079682307757427 0.25767854546008472916 -0.53500604688370234641 1.7322611509534868723;-0.092201429614482063868 0.12055678897149041395 0.8485148316454735884 -0.78575839784637546703 4.1256216499298199452 0.31542410265959597293 -0.9921466795158760954 -0.84010762907562164248;0.36568146681724439384 0.19447544415301926124 -1.315285349911994528 0.14989222735059576364 -4.1452839188274879234 2.4680091550000109457 -1.0976588412584165066 0.83936957286458513394;0.54535882334731577981 -1.1878209990043739896 -0.103710978794199285 -0.10867489796958314241 -0.23850167674461944523 0.39083237538186865745 -0.39433927131764823226 0.26943604551901423338;1.5221992419475338654 -0.97178591265245128916 0.15587121080674531948 0.071593248944752649332 -0.76203151172440586336 0.70513311330962735735 1.2406514696141728304 -1.0264321552423905093;-0.31426820309150410582 2.8714973150897535881 -0.80143942664702538803 -0.87777305901968416535 -4.5064576998270418073 -2.2312946930628911879 -0.66671317626454440486 -0.039883395382256769945;-0.39226517868805932387 1.1015420345322903817 -0.46923589984637392725 -0.14241673824258666015 0.63331372559689103063 -0.69173721632714235685 -0.098587883600919634652 -0.72706115418547978546;-0.01642123516084548554 0.62917787187318197084 1.1508717056366861708 -0.16527717451873866206 0.36297125148358300173 0.65859582191067356227 0.45367468481653955292 -0.84256226473108619679;-0.080183665545004403907 0.60399634117974321246 0.91377498418001801284 -0.15571334635118744272 -0.53143393789373183367 1.3521495324812273786 0.3944296674295047489 -0.67221261677594124073;0.16344388712800189678 -0.15181103336575421658 -0.25390239751744692054 0.49991556826765354282 0.22575486163051053379 -0.71741666777577561831 0.72855122987029863335 0.059698256672003624512;0.35056073270972865075 0.18664733212889872416 -0.44555876823756196403 -0.03295898822068145384 1.1985810361763717946 0.3895489195048084663 -0.75794410830441538707 0.95724761415766068673;0.017978620382022674623 -0.37383952377117307675 -6.2347753957583060824 -0.90536341121109764618 1.4874895105724728062 -0.34134880042580451054 0.48554072211988819063 -1.8369878604219611606;-0.13083477440813870429 0.37401971287514917952 0.015607400775264809387 -0.36358479310122254757 -0.7059682084044480721 0.70727508957714946281 -0.48431625397850952552 -0.56368664288583647526;0.0027046292314319014816 -0.30947329907376436298 7.0434280429198885543 -0.10448084561884626864 -1.8175310007011447055 -0.062187611276763893331 -0.10674239676615600303 0.11020364016921752048;-0.21673138008008843713 -0.5595995690169178749 -2.7212111014839046597 -0.4007504303172337301 -2.0425470012630708716 -0.062002140752663179035 -1.3271817458406816037 -0.4987792916096178697;0.043580364066480851981 0.13984634378794796872 -0.061234989190700132855 -0.36752150724888194011 0.30852179968866516591 0.60942611446839489719 -0.41649609762598632789 -0.91456593135573915898;0.51273141832559476772 -1.4476469057923417871 0.27119313620814633481 0.53413174478043901061 4.7684876198051915352 1.7089472547213935272 1.2083871543941375748 0.95608119725006168732;-0.26266886820300178185 0.97113313907217035936 0.33983730052747479489 -0.33610277266254862116 -0.091975159552931992635 0.73730075817280982253 -0.10315973489490352921 -0.72282255308263143601;0.25961116702318759453 -0.73751624260383052967 0.47221791337142055012 0.1936401144650028161 -0.50600367009303881538 0.73447248925898922511 0.13878422988928135196 0.56106129043582375626;-0.65088100533356585409 -0.30678984742198378566 0.43385797272252102363 0.18523008630723916679 -1.3445124795390634986 -0.48289967917590737034 0.97351684587854236952 -1.2056704526703074798;0.58006226508162372912 0.0249416738243530417 0.6387704292433467046 -0.61082181789179268439 -1.0758637134435669047 1.45990671531543037 0.72436049367045118874 -0.077058359388450195504;-1.6296324290273502822 -0.10797187925800455499 -0.041325997934118410826 0.39215354780275579749 -1.997618199896185498 -1.3360664926162710842 -1.6317678726163862279 -1.1999103241463022762;0.97262288961845522195 1.9046218348305448131 3.2678037406659461439 -1.4243533688052876229 -0.15534100352337926187 0.2014831285512162784 -3.3035178301113470312 -0.45411132573061940843;-0.25684483585925693694 2.2757804475467202643 -0.80994474841214214589 -0.73538819128153387616 -4.4798926385510933201 -1.7717012543690031645 -0.65806669088023916903 3.0346302023464652997;-0.82148858484371223287 -0.16898406053657999415 -4.3131229981479224378 0.72897770488854041204 -5.5660057080101372762 0.62935583041165865659 -1.284528886113970314 -1.2578982023334694951;-0.28574816133165636955 -0.94136264110674849892 -3.1600610964732602781 -0.69082250631754038572 0.93535302514107787619 -2.347643088063156469 -0.3322825387143204523 -1.08817622390945834;0.66077090486095513278 -3.3457229429749086869 1.1292131034024357472 0.49288831374985908607 -0.41553337226035286234 -0.59723058289159514089 -0.066139844821871296432 0.64125025781432731797];

% Layer 2
b2 = -0.56976651357306495882;
LW2_1 = [1.6799802159954231318 -0.58956731490770519777 0.052116593542690783925 -4.0502037829506285505 0.5334683284545201909 -2.0943264225803819301 0.25887664705390894815 0.53558241449197507844 -1.2300327116010909556 -0.14321966859150056517 1.2747447784258945092 5.292787374067382089 0.39512581638358251768 1.4317382652629242479 0.48560969148217025815 0.20187958407754255652 -0.41614127120737964827 0.30986846503222903459 -0.37880323052463599209 1.5257903158129286769 -1.5483853961222528994 1.7693020601884801302 -2.3607450983951521195 -4.270739725675923637 1.3187371318900551476 -3.1203329004778384004 -1.4085089925837570579 0.18784686638292497074 -1.5496893236107673886 0.23622739173532791845 0.76499738288386520679 2.8877104479881099408 -2.2046264781559914425 -0.97410090688967965189 -0.11602530317773147861 0.030780383457540451408 0.49900473669710720959 -0.056810782064763754029 0.17728842901809582777 -0.44992532877253893497];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
