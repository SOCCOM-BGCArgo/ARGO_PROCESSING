function [Y,Xf,Af] = ESPER_nitrate_14_Atl_3(X,~,~)
%ESPER_NITRATE_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9816136238003025927;-5.2355772725609046603;-7.2061719166829938388;0.92393578376343599157;-1.690053729295634577;2.0329167934240608417;0.19209164680672519143;1.3958469993777875562;2.9141557301552678538;-3.908685313422024965;-5.2387769145497911083;1.060742089696664614;0.75415157425453560602;-0.15201328874336952901;1.3504947943624527884;0.62152849539138199653;-1.5497444992517241946;-7.5855940264909920145;0.52270520036147538612;0.35797989814130559694;-1.5213556346675771724;6.3718552749608958763;-4.0827639052741808712;-1.6709181900170635426;-0.079888190469750236522];
IW1_1 = [1.2417126882165125945 0.41942955098752054965 -0.44495121129215176037 0.66535088762011163066 0.41717526359876150321 -0.83636685106318953142;0.086198411472619432261 -0.40224015173481153518 -0.17865378349295746307 0.74363109380599656806 7.4482304713932911966 1.7753755051969071221;1.6487705356868276318 -2.2225027567027106912 -1.8997615592151360087 0.50743953429402621769 5.2922777166163914586 1.0293695271904768074;-1.3993486186137475968 2.3097068648627634424 -0.95914872384747817957 -0.37530801544774849976 0.15405196939678278412 0.31832034874064663033;0.88382875826449813772 -1.2299589543619020571 -0.54590576931851986231 -0.046898459581421692022 0.87176088667003426291 -0.35200367671086169041;-0.72236002615083350076 0.76563778811041216521 0.85468417993915035691 -1.3593423304409586461 -1.7241764400450410033 -0.39494261296336397038;0.3944511054660666538 -0.39297720608646280471 -3.0152840511217049446 0.66730164337498310001 -2.2470638628644286072 -0.80294842154504664222;0.7372618953334889591 -0.7334532922350011086 -0.56749111958803410971 1.9484386977288463694 -1.8664735049288969648 0.57360042137788247452;-0.24876007882929140891 0.69072400227295938091 1.4337564342943991402 0.40778391363568816663 -4.547012218931984151 0.38379639927305164715;0.40653126220795759993 0.0019883954144381365929 -0.19431009530753334813 0.28593298841672804 2.5893271898010059573 -1.4215585153682377406;-0.33836258195453772224 0.10023573023042618713 1.0012273482858580209 0.43502350673258111113 6.8061686454715797367 1.2753252350123946979;0.49106723532967722079 -0.26932347530256728341 -0.28586211707770331492 -0.1182243261933491052 -2.1308905705405662978 -0.89564499926609020264;-0.65505809382413771047 0.4352066354805453896 1.8015345875273405252 -1.1770938761833558139 -1.3702713478189729734 -1.2399782459766623965;0.1051465197639899346 0.19124109351196727502 1.8741484767976153147 -0.017958489099444131104 0.90691188014070633905 -0.36589483504681402648;-0.82212488456468402198 2.1022856930361784045 -2.6877373690099379822 0.96869468656453006083 0.30857943852233804538 -1.1768738734763108944;0.48369226299928813617 -1.0717599581954206922 -0.54906106321546155336 0.87186003023232216957 -0.60343268349489986857 0.63466502188189910516;0.68713243959977954312 0.10680410351690991511 0.9921281492932665369 -0.033042655458499207988 5.0922429238977473531 -1.7568542388307240021;3.6206132907388259845 -4.0595026019250237681 -1.2947585931344063326 0.014637353088773679896 4.9176934486521375334 -0.25936500465599560128;1.4578070594261631765 -0.64121663974654186102 -1.9155040707586978854 -0.63648901664229984299 0.42370764451680537066 -0.71297275487880762412;0.27251074853711421131 -0.77134201619574527253 -0.52011990324854184831 0.40008759198404547641 -1.7124084155196455104 1.9539546040160455931;1.3662952931231033826 -1.5680781174368729758 -0.064021668012864851871 0.93718229848329326348 0.52062500323808436065 -0.74729721598446119391;-0.43692475390290030912 1.3757578322199952581 -0.13332183073331574374 4.0860893740359518489 -1.5061598654550172327 1.1615677355438118745;-0.076999397610511041701 1.1751101486184272193 -2.3348149283202261906 -5.8009268171101480149 -0.56041053326056766704 -0.26923702261422083337;0.10840851049303347475 1.3906280648726665472 -1.3842275539054620381 0.71740048567262237889 3.2351668385622760482 0.81399482031088865597;0.78974933334489694214 0.072806518468892814089 0.087010469710565557788 1.5574397930660939249 2.5372771226308596937 0.17224815372003859926];

% Layer 2
b2 = [-0.44437155129117511532;-0.55937513837785846071;-1.2517928888673042209;-8.3877912644582099944;-0.32603426338967211873;-3.1109808836709578195;2.2459882785016080931;1.4241077556515715496;-4.4893522830608194596;-6.6745579979888560729;0.34619761658410935778;-0.89197940388760721397;-0.79075125528796097463;-4.4736905164346891794;-2.6930879227396413711];
LW2_1 = [-0.34091662404583794599 -3.2379319579005625407 2.7113081356440580372 -0.51151424690255875571 1.7846745071042950936 1.7961195871391997247 3.795529603273303465 -2.4234040049918172954 -0.8578310263354022025 -1.1039551938949772047 6.4684816275911130035 0.10777518898828800098 -3.2197035758423737661 7.5152809472626431742 0.20368316653220008838 5.3637636404586830352 -0.22183759257019053379 1.7125014763968768872 1.2843256295549616564 1.0644662872507026918 -5.2408337196845957706 0.98995485482407574729 -0.92482622562056682192 1.4171722674982372148 -3.5742208580317949007;2.6260090097768000739 1.7571566953746979856 -6.4550616058442331635 -2.5387696202450995564 12.412769422127801988 5.473421792602541025 -0.6597718250247575078 -5.744344241451053712 4.6982232259851937073 2.3997648213563462782 -7.0393642948108521296 -4.5050337044908497219 -1.7567571753075557073 0.55557951211129075197 -0.79988992157500882207 4.4034547919941386951 3.2165600539314027628 -3.6803907936847761739 -5.5199509420486760902 7.5329622970535066173 2.8565193301007001381 -1.6443951928685154318 -3.1993458608386213804 5.1333458335464854372 -0.99676203434415211468;-0.30301248734632996173 3.2560040458843975131 0.026598123801579033609 -0.12716389080106163534 2.5233096477420171588 -0.640621055611063972 -0.68583894214253815491 -0.469176772195891989 1.4663018161600067657 -2.8589764503874501855 0.51160132667223234826 0.67768796700330447003 0.71342616928004576327 -0.37244122393990319875 0.96828504983430108144 -1.4711240682084769649 0.32947212727707869684 -0.066569728613930789773 0.88642030411791150613 -1.4706635377050600866 -0.59156155378401731326 0.25893863212607398649 -1.2412213999180214952 0.75919968926861014502 -0.04301169362537934221;2.7687951547144118436 -1.0874951861157979849 -0.28247470355408926812 -1.6509247824920421088 -1.0155137768094708584 0.25521606886517611557 -1.5886966883284943108 0.89046259027203811254 1.4666086510744749116 -8.3294144817229067712 4.3367256937816343054 3.1066663406177159601 1.9757489094667877172 -4.5160899565224514873 0.64325728323093889216 1.9665427851715482355 -4.4132316388184298361 0.42987493886086164396 5.0549365569525379627 0.29395354275146895473 -2.1480924145943398607 -1.4944832477188101372 0.21164999329240438697 -1.2014658948726613108 6.6436077601943823723;-4.7064774971374401247 2.4474017063976609698 -1.3523735772294060986 -0.85433819766496221781 -10.39973765901757119 2.7942156175966297305 1.3130842043001382802 1.3482968399963062289 -2.3358957421015769107 5.8507863711260457151 -3.9137505524054576611 -0.0043142040833208383788 -2.7048179533819833864 -2.7825936755432665315 -1.8201348892711870509 -5.4315410792944112117 -1.697319465981982578 0.20496512377124487259 4.2817108690790650627 -0.68594818655475764402 7.9875725328264985947 1.8136659941465693713 2.3824940411794930384 1.0274300107750617972 -5.4279042759652416095;-1.1231870007037949577 -1.1592036582254729993 -3.1180940908338450335 -7.1642373611524430288 2.9604636461877267273 -4.7709843861748826299 -2.8176832931627555645 -2.2556730503975441771 1.7950581875614044502 1.8902587127063463779 -1.0740788997440240404 2.696338796220269618 -0.90460275537053513872 -10.173113049735405866 -2.0693519258095198765 -6.9762356143104788941 -4.9750765009802693228 1.1358953782069967087 5.2615593918180980637 -1.3098276981390746254 -3.2769013015792580745 -0.23809783722539387685 -1.0546234989088483225 3.6405148973394636513 -2.8443358382463359568;-1.6233751022482589832 1.2843396238784685615 -2.0958129026460845523 -0.13132291685711997009 -1.9339743267413496142 -0.42604618063844001963 0.67032269638760522135 2.3266944921385239731 -3.2003265588101887928 1.8898573609270712392 2.2197726875058125806 3.8253705855686548354 -1.7394371106437276353 1.8668462921061275139 -0.034089917879301510906 -1.7849097108660958444 1.7129974855158758285 -0.70722604084215612286 -2.3722236691568707734 0.79616869203256157572 0.80791286752429503082 0.65938389755970561179 0.41503138088505037162 -0.15797172712335971756 -0.2219209590710535529;1.2393835566364694856 0.52344724536337317033 1.1414436205936060453 0.22265858347142056251 0.7628944224291300813 1.0339143842680988961 0.015621240535588710313 0.9272103528757342783 0.67257636561015732291 -1.3463756624536389328 1.15746883197671524 0.16387926220439646974 0.17582352424083441678 0.71658674092780849652 0.36570790394348540175 0.79525242516987204588 -0.0093792706377195320111 0.1928129505145792788 -0.21250377710170573198 -1.291045113057566196 -1.1565629945207742679 -0.65398782984127323825 -0.38662642880915909505 -0.16174816870415389958 0.43009906152020016545;0.35595296100129325545 -5.7865542866835326663 2.3336304828443843462 -0.21927957482128493383 -1.2468819868982281562 -5.1439590064413973636 2.0232039636650025471 -8.1044231186257924548 -3.4853887979027362576 -2.4026829949754056059 -2.1129800733036656624 -6.1319825054231049677 -5.0332993247588984076 4.9800233288563688916 2.4094479257141450113 -3.5308695791464557168 -3.7027438333042494989 -0.47060963510985132086 0.80538649390159755548 4.0606412247489123146 2.4954564364601186099 2.9722657008476778273 0.38125423828709303908 -0.31448751942326413911 0.64215529141714111638;-3.5615769778513874932 5.9567815755551256629 -0.50391265653068084696 -4.6406750381020369645 -1.6049354193833904603 4.7760801639447141298 1.1446969828914084211 -0.72210415218809553828 2.5845741142987219696 1.084115707184199362 -5.3773488412529237834 0.55062762271493170818 -2.6725343261657421579 6.0872460224384337124 0.29038223741730223582 1.5098652008774890998 2.4548969084055194401 -0.78992039114082490681 -4.5864319984524373197 -3.7640084702032123865 2.5196347486799317572 0.06142781992307030231 1.3444328054549024021 5.5859393038782059193 -2.7701384829411863642;-0.70701141604148332043 -5.8145596335450546732 -0.92795257151164001197 0.61699824566739636111 -3.6010561357412829153 -0.73914358725547268936 -1.3185075772057253118 -0.79738599878593618975 0.27123442438403522203 -0.84217116516392165337 -1.3806130402728420403 -4.0343238386001676332 -1.5458629322412500429 0.18591594544246423104 -1.1129178052431238921 3.0528110622423469955 -1.5312480411682858339 0.042651920004933431552 -2.3542574411218151198 2.951603985123750995 4.4075874297893991027 -1.9013347357048389075 0.28691787557889197879 2.9352426607567490002 1.7482638185072596482;-3.2865195441841104085 -1.0307265390487427847 -2.090925587856318657 0.15277682123562805194 1.07731212780797736 -1.4343872697149175899 -1.2539526534448244277 -1.3332247216062156348 1.5068456504003613361 3.320259691726789697 -0.083574460445688281141 1.3645124339770893229 -0.25075614222584469148 -1.1096474004318648277 0.48664256987125575904 -0.47756932659401396535 0.98046779509017256693 -0.28835568236926667485 0.66554634064673057203 2.5346429642927281733 0.86976787576102931876 0.53265228098596861805 -0.290872348774808831 0.52951436971113685637 -1.14490973115966721;1.7439706330771749254 1.1210030251750855435 -1.1241888863779483376 -1.7284739970606912696 -4.3967478229550653879 -5.410569667893628143 1.0278533755594265742 -4.1504014602545646895 -2.8803320619640206957 3.9832329045515977306 1.4989864674596291572 3.0427214098988151214 1.2895369760383874613 1.4275588981241678077 -0.36926489916632981858 6.0725187002862091035 -1.7153415217829237616 0.40841886979132563384 -0.33660955527907482354 0.16204811393420487375 -2.3034865019157679811 0.55383244844380197236 0.17338666167639704696 -0.44925083738135257461 6.3491455692095746244;2.1399748878097679672 0.45560723448376017064 1.632458716675688315 1.1228746154040059047 0.11173096302254102719 0.093638155598438257976 -2.4237567301243712059 -0.78182512548309168743 -0.33517659156990869951 -8.6217774260354786975 4.1675045637019598743 3.2308166724053521968 -1.6297919636676740929 -0.407238033979109737 1.051520610696024649 0.79475165544323589373 0.53527914894688732872 0.52126177431369591364 -0.89291164082816232295 -0.21321302053671981058 -2.2339255956433059502 -0.67336771142664941792 -0.80513367812196068307 -1.8087409334860224952 0.45043694089911212597;2.6485912185641189431 -5.63885580134737463 4.3802329537445823249 2.6490214405807286369 -1.401286692367958997 1.4840210389975927452 4.1003951185725417972 -2.2645409945479073599 -2.7721329660928151206 -5.3085842734057910874 3.5698489132536210811 -1.3967184506733485438 -3.5607502967909292479 10.639043489477227666 0.39390461265248993827 6.4979749281926357796 -0.25000338673958094615 0.05772783650854933224 2.3714846323660587757 2.154859484013434745 -0.77683892962707123964 0.734288117379433114 0.33652255682764853351 -0.70390375005347816106 -1.4088311470300574069];

% Layer 3
b3 = 0.3924488218778418025;
LW3_2 = [0.076400213824030255294 0.023291911938595567799 0.24936080824611309148 0.19309643512342056226 -0.1121707532050042061 -0.069658763400921766551 -0.2117391817601973758 -0.99358034699091823949 0.042139954436470720978 0.058088515832979713271 0.099887872477235697954 -0.29924002645521297072 0.12942325962794379302 0.19421679914680389789 0.089897906528449714192];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
