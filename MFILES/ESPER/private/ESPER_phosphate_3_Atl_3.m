function [Y,Xf,Af] = ESPER_phosphate_3_Atl_3(X,~,~)
%ESPER_PHOSPHATE_3_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_3_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.2527427234942540846;-4.7341528626294957505;-3.3106316667699795531;-2.3264021712153626353;-2.8855892558378584134;-1.5144491033479923203;-0.58459053207292666077;0.81282828742269908062;-3.3438393495617608764;-1.6831437659152288511;-1.5486944966354556641;-0.74903306748198228426;0.10465375884601214873;0.56394451758993979773;0.78708306594967780701;0.87720597882819562052;1.2041586476528705063;3.367114036027979207;-0.22124123526216080138;3.760449981153265675;3.7160845777980600069;-1.1499972015332668995;1.7384447025558666944;-6.5046202136925375115;-6.4769242886235307566];
IW1_1 = [-0.86702738758979192024 0.431861010342072138 -1.2376070155681924145 0.59524974600874280828 5.5433681149870057681 1.1199499381661721653 0.35979166043292754029 -0.091920522943848753661;1.6251096379785099355 0.77631180065509131083 1.2436149198593442478 -0.16201764887357680833 0.56515713925246280347 -0.0069057811907332214765 -0.41995116575164564976 -2.1145415167505574594;0.26405985893353922656 1.609814872875459324 2.0771007142336586071 -0.66063848639184596934 -0.26053315719352526658 -1.9045231575183905193 -1.5044607266221874387 0.41738330225722802824;0.39150431023318910118 0.39511797445262436534 0.2188501892726470166 -0.67210616412184487345 1.3715934523552097968 -1.7724009532106459464 0.25340412682683272072 -0.93494062834066360423;1.2216066933425102636 0.53330240768468495371 0.031142166895635096241 -0.07553944057283161484 3.0392958299819525791 1.08854635252534937 0.031265954412582064315 0.29834232025984264158;0.77977833407551688794 0.48226092960221000894 0.074260116583896015885 -0.04780983416897713334 1.5333215730711460267 0.727324484471728816 0.12416936485759734465 0.22167339017704931758;-0.41583570405691266947 -0.34012991968705535983 -0.18540903838761543798 -0.17517448288217982166 2.7065795982040676826 -1.1320607501508821446 0.58205199220471348642 1.7261570160683925579;-1.1564168060406578853 0.41984056730267910185 -0.36267299749495129912 0.38743243402436572387 0.9792494991757342282 0.50864089674901324933 -0.76284445800169442542 0.67200166746593614775;1.7274239226550407444 0.064212787096070672588 1.0027253547367978026 -0.93414953259615596259 3.7433408980045981274 0.94382088683915388305 0.39710471467532831857 0.64611797263208303743;0.10712921946166781284 1.0747794454305219514 1.0298241737431150788 -0.20656666133456766388 0.37702506638729132993 -1.2950969071021567469 -1.0430848123057974153 0.52860543687450101125;1.0825364245152147014 -1.9454347558976223809 0.69279062152208803482 0.47080640348613661539 0.2427215405704450657 -1.4078801634839803736 0.42401793222249317683 0.46642884153104752221;-1.5688256310886321554 0.63207614378015331003 0.67433254997012204157 -0.79413127726285670516 1.9885105383018673031 0.40134794228563641649 -3.2293435599269848524 1.2359837620917690781;-0.83366412748844465064 -1.4923474396114286833 -1.0085551044425418166 -0.32126743154561004934 0.21586375079544459221 -0.69874926108485113652 0.22255661570535581473 0.71206262624656591065;-0.32223995764265778163 0.02212420655479169565 0.91870842146014219942 -0.30523875490329954729 -0.99472951682743848689 1.4781992641742889294 0.5649536510939755507 -0.79421333400043625517;0.027913358519023472731 -1.5803613221327008631 1.1983101091993038079 0.64397919913745493847 0.20790010092413047094 0.57132414769112305208 -0.2290715099561161372 0.57898597932084339135;0.56353603978487587511 -1.7020511065523620253 1.0363473132947420563 0.22506340657585571785 -0.53976013027172209391 0.55219099702455121115 0.37069386458561226494 0.98286894222747378524;-1.1241086112957008325 0.22116134880179377786 1.3479164858002721239 0.63778610654820466763 -1.3915927600434767619 -0.17603667358951510802 1.5186391464944262175 -0.28452595143427533708;0.80633055695951982855 0.0085724360679666558593 0.14226406956202106158 -0.22881255004541126152 -3.5103226639325848524 1.5637914954498812747 -0.083805889717157897034 0.0075322750197121084159;-0.54931024578318898843 -0.23802001195550290258 0.90345893681110811535 -0.26186836771147026237 -1.0607735241050764152 1.4817686757886439075 1.1777997613404735944 -1.3201377622209391482;0.49490854894190672297 0.083002449808829967259 0.091368386826184769256 -0.33316455608969797186 -4.2228005075938845891 1.2610334020708333647 0.0097771261991860120011 -0.013346330160421034094;0.63199519010689142462 0.83808625990863039323 -0.66512298573007655467 1.5109527814563468162 0.84048129373827606958 0.97927655334225083283 -0.6663777929589623783 2.1215198219182052064;0.58865174283412491363 0.45555682206032194204 1.923241029246784084 -0.85058360272214039721 -1.0668969000988004492 0.099373609425784062421 -0.40331260665426282852 1.3558212429631146811;1.6548628725923713034 0.43232168678744453683 -0.57165578306343856063 0.43597375765947671278 -1.3957704678390130404 0.98478591029657414069 0.36341539247730281215 1.3766216167352731681;-1.5846400246837697434 0.47268929745567744849 1.9138531270917378269 0.27982247741168098099 -2.7039724294565221641 1.6942972159406175514 -6.3303887656697668262 -6.2464600863786499119;-3.7611769909191088423 -1.2163785960136064279 2.8523748188761053335 -0.10509873771623827465 -0.60829787890530073735 -1.6832221339022612749 -1.7715560714330562675 2.2273262983856132458];

% Layer 2
b2 = [8.5363532582325092335;1.4117322359645696483;-1.2866388521826395142;-0.46928935449733294449;-1.5529590779977766601;-1.529879562971135476;1.1857309801000477378;0.31015882156565699468;-0.90552183029651589496;-3.3241846822385552329;-2.9532999180839012432;-2.2594118934523987896;5.3959772559221645949;-1.6991377597617356443;-0.062910801545221106679];
LW2_1 = [-1.4523938781918808161 -0.77872491070114124856 3.8279291488308833102 -1.0718678664825125324 -1.0762577504611483548 1.1459311527154965038 -0.20739374714545211198 -1.3109343228357788202 0.0098111336544343518556 0.68954125816914513258 1.0989309412296419666 0.79248017257678937675 -0.69326495174198976557 -0.82772331396891263289 1.2854580646694813151 -2.03090633105516849 -0.49631229491667833154 -0.33969600563263119275 1.5400479562917224197 -0.25085062653004081001 0.46371710878586192006 -2.7336035925572805816 -0.56153699158235304001 -0.12461032785573022963 3.769269692558746776;0.15362788811111677267 0.063287107110922974362 -0.71204219638570542816 -0.54566132103222608762 0.45034138428656012021 0.73171121970159380687 -0.59051136425203942792 0.84054692902591743309 -0.14497869849120209595 0.67498360736417029049 1.3885745837308667294 0.43993858798668483701 0.94113854475377078934 -0.85292952809113720125 -0.43724125023235849152 -0.97840675569276036594 0.34336605810860965082 0.041237664701591444927 0.2875204924871186396 2.9922354333023561956 -0.022687937668664632379 -0.0023269768247103556937 -0.56290942853626402265 -0.035440573929145159637 0.13633138899053959259;-0.40086216234582466855 -0.72054762386726223244 1.3221031583986375679 -0.12055038888235618255 -0.8725832586512424216 0.55709195351273721464 -0.29117861449027049314 0.10707787401304245944 0.87645783525394349578 -1.9309018049751465185 0.22501593804350028538 -0.27893446820079614845 -0.054598640728258658605 -0.5605596062796922574 -0.087970416518802524442 -1.1272074487352918837 0.61088858889384789475 -0.44220838827658542902 -0.39555229385455026314 -0.34224396993851741167 -0.45807066244388272569 -1.4041921683732023762 0.49743745865390398553 -0.25621371380077612168 -0.095719158163826201235;-0.014915030176432553591 -0.043679505474430925516 -1.6174216110982264638 2.0003197571839139712 -1.0231600336596828882 -0.26537994615773452534 -0.48693792792740442366 2.2251516137254938599 0.39740078817330898309 2.3689990291266007638 -1.4876834023153180375 -1.056784807970478024 -0.20785839070990302924 -2.1201276004479221449 -1.3343996365367789547 2.5790380354500843652 0.19004921377858391418 1.1142513922785524105 1.2250419798685554529 -1.3325239023736905608 0.44266641739236939346 0.80688706792222442132 -0.011576878221702814609 -0.09126579474772049394 0.37762381896719848795;0.71542135019403751972 0.68817306299787306401 0.58405504348466386055 0.31581863323000930466 1.3599583275671585092 -1.7833620281842521571 0.28625170618668693834 -0.25648091987330073893 -0.032257796381366242444 -0.13556892813824894528 -0.69792759222092293214 -0.30000852421411944304 0.51681414808355519153 0.34638280811660421277 -0.88471293382685933793 1.2403669120164373396 0.10161509205242079401 -0.88015695030327822934 -0.29230367738199342087 0.84601272152903295165 0.042716550450697818309 -0.61437804206489232683 0.12205174810266118668 0.10456842315832644286 0.22842406045534643932;0.83574627437950821385 -0.40207501017352226258 0.6960411172039305816 0.55363033430486707775 1.6099120304885496946 -2.2632252817755129648 0.62612922266807069516 0.38402925717864355715 0.58399381331579092169 -1.3342209601742707203 -1.4741641581605817723 -0.61431595060677801623 -0.31951587098038336521 0.27676094428434450112 -0.49308006306899132554 0.8990128225784771443 0.81956977777517103778 0.33302410056982523212 -1.4016982881041997189 -0.42784107094510032132 -0.35280878945538346469 -0.065311573774624029354 0.19032525985042572647 0.19525556158861337441 -0.25863465705756832902;0.20502032686674265261 -0.26140549070937113552 0.2084377905638385986 -1.3137402365377877089 -1.3499966336660673694 3.4578791426778807683 -0.15564409799554029812 -0.55894057736911051393 -0.45241085819187032424 -0.39338026632663630755 1.4274320483493152523 0.63238458696481703036 0.53915252779886269074 1.1885139298530118523 0.3880626299789952105 -1.392562580382933568 -0.029372083364758223845 -0.53570795405903892661 -0.80911495959934387479 1.7973138846982081862 -0.23301239933509643176 -0.02610538157011140642 -0.36560171394565527114 0.30612838906738537581 -0.3922086850671518965;-0.65394971752982533619 -0.018755718345250863704 0.75373374588940134089 1.3657003558314644298 2.1018378120984282376 -2.785947169649998667 -0.82554644182462444402 -0.55234920510773832802 -0.37743636099517358096 -0.59509897604500361368 -0.67821861924261961363 0.54609946145403220896 0.58481529095110718064 -1.6045196073788463575 -1.3760373669307439659 1.4693760510937183827 -0.60914726198268187574 0.95464439459572059121 2.6338127735800833662 -1.6692929940342611239 0.82588162538127629642 0.010019357228958525319 -0.080692503347154068138 0.14817437542474309886 0.34627920344842882949;-0.75283868766135209061 -0.19972296603982053753 2.1231011307074747485 -0.4703540604146566606 -1.3825383033605125327 2.7049612180117117433 -0.1852088353666883902 1.248585745344513942 0.19731742542538216467 -2.7564576325552003766 1.034057927702694224 -0.32625561605862996029 0.56692663420033762023 -0.54533811390428577059 0.69672087298079554696 -0.88890608164067752561 0.21312422523586929679 -0.3209218266335351899 0.34706370513743506345 1.0712968290688265061 0.97237083509718402752 0.63112067336792310179 -0.11523391005157491984 0.13364398998726095824 -1.288774434589258;1.1310081368458249074 1.2505606393531698561 0.16413378646051141052 0.68183713044053062546 -0.3863014032693210531 -0.56446309608205413877 1.8242742340408275581 -0.29996106641830927453 -0.079674915859674649843 0.57447219272822502845 1.3041512598809548162 -0.21156043506718688607 -0.15997893152819064877 -0.58978180677956326683 -1.3458736958738442002 -0.19606737184338299262 1.3410864561297923814 0.32587293775666370532 -0.40344852079214926777 -0.39089883144716108809 -0.886440419184759687 -1.3689351936868192627 -0.21166122806799336775 0.40682705325818341313 0.76022508343560057931;-0.21209189106349085607 0.42784198528018080321 -0.6086132017206286049 0.17490381757065892598 -1.8834143852880125269 4.8203684777899988845 -0.078560860978783300657 0.62018743044835455969 -0.57075712432129921403 0.063760854089950372292 0.76970688508810614081 -0.3535239016150506508 0.48661821176483871509 2.0034059314938281737 -0.02905728222719527673 -0.66619958717219052158 0.34709243076374957093 -2.3950851532997434745 -2.303331824637403713 3.3313544565733232972 -0.29512881063740387111 -0.19289646418337028089 -1.6731506307806469636 -0.3177025462594902927 -0.021156391665669106728;-0.94623169052321198791 -0.43930760243667982268 2.2531821737529296179 -0.92845076535019055441 0.12487287519563819438 0.6717068900083515981 -0.32256967165301420053 0.17607098976381310718 0.11709596159672427951 -2.6901110382755746286 0.83228150747262530373 0.14032189817441390045 0.74077555698945785068 -1.123152334292768062 0.6034061903003432592 -0.42328210376864244813 0.63341374683004958435 -1.9983397929683388572 0.22179600845535951681 3.4609371933025911972 1.0892489762023829236 0.13809116981871330521 -0.41325703519605394565 0.13347599832095580208 -1.3898986982298426884;0.2866216700649589777 0.24288619757008614308 -1.1800950899661619697 -0.33989328335299640038 0.77845059887518253117 -1.3308873053843326417 2.7345221501395902131 0.4513977412964033098 0.83103291494031350517 2.2818836991769546607 -0.61964753299474528703 -0.44471825585485996735 -0.64365460608424907019 -1.8252346873243403547 -0.33852453516484726226 0.81908686754276061048 -0.83365173164585437693 0.51550643112202576557 2.0330866894495427388 -4.4730564950340419017 1.1217975007393403697 0.081639549844320744021 0.51562366724238573035 1.1648962897977868103 0.83989427010089001691;-0.54604445658419187293 0.22978557172725505575 -0.66301215265964308365 0.48683791337146153921 -0.59102186604190865005 1.1882980088695929144 -0.076199726946852203158 0.67624309039189567372 -0.33395688821518959566 0.21787955989016966063 -0.35816564709435300129 -0.16957384538593048284 0.33294865324291311737 0.36205441724213183186 -0.81490768998164753167 0.63204737883856609848 0.7728259274041352489 -2.0211941372897999081 -0.8515098558974883991 1.9600404549358816375 0.21323815842733898074 0.12339273340707877791 0.7828386508980779146 -0.64080506192305231039 0.038496993051730800384;0.45764900340563130499 -1.5938843241904936399 0.044317852312953709415 2.8406350901560579736 1.8730643973274523351 -2.8108475743630818577 0.78215961965978186843 1.8401722310687202988 0.25087781081628490742 -2.8264373772943036656 -0.86599327735916076243 -0.089523797732747795175 -1.5011008454232166454 -0.18278213271226534387 0.48058562468188809058 0.095142506429503656551 -0.56100057233260003375 1.974169174317963682 0.89765642180750371271 -2.688976987508609362 -0.58805954548532357595 2.2354473205688116799 1.0417153663502822791 -0.012160644431059450254 1.7972707552996123326];

% Layer 3
b3 = -1.0427990993542852749;
LW3_2 = [1.4261941127541675201 -0.91773163444803074196 0.49362027545162284747 0.71257200295731182305 2.2723893437931752537 -0.64074407927884524661 1.6584427185027206253 -0.5989759302836159538 -0.63347711313712551373 -0.63996159997193291513 -1.4668461920455038161 0.78078558695810951207 0.15498576898365978849 0.96273366200015841887 0.3354235680154379895];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
