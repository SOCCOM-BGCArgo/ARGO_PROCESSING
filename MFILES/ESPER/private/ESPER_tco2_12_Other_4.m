function [Y,Xf,Af] = ESPER_tco2_12_Other_4(X,~,~)
%ESPER_TCO2_12_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_12_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.73816093921350578;0.91651570330412824;-0.6079371898886482;0.68998124778735415;-2.6601215995467067;-10.426271697120944;1.2777291376339655;2.2898033875792758;2.5297274517481001;-4.5343967363002537;-1.8614133384500109;-2.4924159300142827;-3.4865266688812198;-0.13000982045526777;-0.10145608445896796;1.702858721619922;-1.6015272556719398;6.2195050105388425;0.63369113020772339;-3.6250201197402903;1.6501864685241745;-9.1924735133728834;1.4138872116264436;13.569645894034014;-5.0928434760776442;1.5026928122991841;-8.0966287307850102;1.2273384110687908;-0.15019563422380106;-5.0427221772109032];
IW1_1 = [-0.021978488085846942 0.014457821754524768 -0.085376186535043627 0.017968272591556089 -0.11392490492842849 -0.0071966720728429533;2.3448183402795233 2.5767006899308269 -0.94026215389294454 0.29015980171729916 2.4424868269563387 -0.28874800668571171;0.66647817620213923 -0.47323652432077523 0.27282954416288768 0.60098600432812799 2.0366513427843427 -0.65594086383577632;-0.26202184104971249 0.15611441345414184 0.42317817233006194 -0.35763016471119136 -0.39699648430760059 -0.036965037871622385;0.24738949397170432 -0.54805177984186104 2.1552427895788071 -2.5400443238591031 -1.4419184121413928 -1.7484085215977525;-0.13601914939018231 -0.12181926359296859 5.1405224225257626 -10.981085170066423 -2.9597218311702265 -3.9473465007267139;-0.77022878338891609 0.81282707933690912 1.9884363189910399 0.12556879522958841 -0.49620745695946794 -0.33454393132704985;0.2857552609035503 -1.0036852207391396 1.3060604848106083 -0.098638247880885363 -1.2461001415772677 1.9662339508466684;-1.6796551837151104 -2.3465110521810129 7.0238905876074149 -4.8421427374654824 1.2304908856811247 3.1981064016802021;0.19700555178244578 -3.5937981435760089 -2.1054218009761327 -0.58671490500872059 -5.7115226400783499 -1.6050470105367582;-0.82651715459209851 0.38981382239442608 -0.063321173154958915 -0.87905369546431611 -2.4206653181558297 2.9626317452109441;-1.8057669386834005 0.88569784470180235 -5.5502573277396774 -0.7222655373156448 -2.371614349472543 1.1734669460791314;-2.9470772848839637 0.77797963175867757 -1.8236497644262148 -6.7477250743268771 0.083296285252162483 20.901216946859027;0.083082172518611358 -0.04251929241682173 0.48361641279281681 0.12921747568724751 0.12054754772128071 -0.8258033091275544;-1.6888906497734324 0.61441680188340286 -0.43845210743517304 2.7132973562866307 8.406102450299203 -3.9954733411530574;-0.17436317081151378 -0.045417706561022265 -0.37027207349166347 -0.17256027332743865 -4.4074249969270749 2.059199809419499;0.14614344678265428 0.041663160856192698 0.42706528432701113 0.50554939219454664 4.5278877409903107 -2.2752672927366611;2.3707251667929277 6.323983053524989 8.4864344853309799 -1.8287869780845869 -0.21684813503589703 1.0876738204888803;0.041546142458703354 -0.043717900305749888 0.16566932111715982 -0.21930331834453826 0.35884407148607972 0.31484992295599928;0.22373097305093528 0.095558863099411043 1.4071723485573264 1.1506299447692088 0.062461237617094094 -3.4036510493480607;-0.16626836964220928 -0.53260401750231312 0.061932357667678024 0.19190525970744121 -2.7207814941199593 1.3982421221440156;-2.9298697546983039 2.9664892305017698 -11.280452236282732 -11.608011179872676 10.181639060399046 2.7058850166047042;0.46784659925956579 -0.2063253834713718 -1.9024850749870721 2.73746684951485 -11.543569300411608 5.2636853918643673;3.0911208257917395 -0.2781571196030993 1.3927184057774122 -1.6775158617062569 -36.181031579966117 -4.6517669566691602;-0.60976464175423739 -1.6110468753976015 3.5653859483688519 -1.2379695822113326 23.256338061976699 0.4054321128915595;-1.5803498392960942 -6.6561355805683791 -5.4540866577028799 4.8095386407769087 -2.5994137518477181 -1.7430504079289302;0.034519570234056274 -0.17545378557930658 0.29893069168400421 -1.7955591542296676 0.43825538000336861 -4.0073145132299954;-1.1808449207679512 -3.2977502137881851 -0.47741250700972587 1.1356988737537532 2.4393217148383028 0.83158851504273446;-0.66366611070303705 -1.7459541033640971 1.9266905416170037 0.08808363272677075 0.906607184784329 -1.4617326165004108;-1.540704525679085 -0.1154611643898393 -1.2001156074100676 2.0100275863919426 11.984540442753021 4.3439820336870056];

% Layer 2
b2 = [63.357432747976844;-13.907873889674537;-28.974607950831871;-39.505726407960502;-49.069419246840155;-0.2607146529174999;11.430642283261387;54.56032268669982;14.483262778192264;-22.143425193170089];
LW2_1 = [22.636536378704008 -2.1046362550125308 -11.94842518655571 -8.3960597647915005 5.208527228846866 -0.21360537979924327 -6.2152671672825575 -7.4370663445728624 -1.6145001051772863 1.1706703195099377 -7.2970076681676819 -2.3441312544575639 -0.50622412309530918 1.0623707488267033 2.4483443183299967 -7.0723455989162956 7.4833345217241547 0.37314834255233653 24.451592585889905 -5.4093185124345906 22.536912209508809 0.43583187253594929 -0.071737765483940466 -17.872224546398527 2.6735512477698347 -1.7035396955956434 53.39205138990075 0.32675952379875001 -4.5027830294633402 -2.4996554559098376;15.539369175181843 3.6689864820129587 -10.594111577971379 35.904892686151072 9.4000070422498183 -1.1195261022253586 6.9767376789706486 -28.572559014251503 -1.0422441360105372 3.531927750277541 16.095335455439436 13.882402908443208 -11.01425754552996 -2.6289970955424562 6.2538128535570605 8.9399794413809204 -8.9925503227402057 3.0447920111956597 14.917235333171497 -0.58549435494388458 37.078039246600689 87.942307534681916 13.520625391259497 61.146886260115679 -22.335915254399556 0.0028019127037096519 5.9083798160790328 8.3532884002005243 4.4845646094503939 -0.76522035684449652;56.574343021898763 14.918820568555397 1.193857876303356 -13.948487030393677 -11.259467937167233 -6.9300266835449849 3.5622669299916119 -10.869852085864474 -48.928637025460347 -53.081286773155611 -6.5830607535289802 -15.155960317895746 -13.530511722745205 34.374032067500387 -36.441601055807624 14.723738241078939 42.418731114349612 -27.722719323706812 -2.4252931221620186 1.9153634688858294 1.0635761399597803 -24.472018684146821 5.568967238794591 -33.762084890116377 -2.5280075933632018 -6.8790408965554768 -30.442267669828794 4.8948072136308118 9.8378936540604336 -0.75417144229303246;-60.243600877025962 0.032695602042392725 -0.13501880591583895 1.2164031187404674 -0.17202634206505657 0.10746806607494162 -0.23494412976804654 0.28463142728164204 -0.12474113141119442 -0.043135504709479765 1.1650378471791853 0.14070820784229601 0.038198607313211459 -3.2163407278630922 0.05246665383298766 -1.5075871708000412 -1.5030537785552855 -0.031786182317087464 -11.736981883733909 -0.29098062592845458 -0.022051528190288206 0.028809302761868105 -0.055304175018263554 0.00031187504179532884 -0.016447749911639935 0.033841254822082292 -10.478313113369762 0.03868646806925613 0.062558289220893903 -0.076236876994780475;-2.4844614223580863 -1.7504839208474339 -5.7564453587646511 -11.525287923239258 -2.2131424248540124 0.97744025327936412 1.1154164615822428 -3.7127915842722206 -0.044133375279369315 1.3396888072434465 -1.25607077711268 -1.2219925881552121 0.54135263421749436 -2.151788780139229 0.85714859598004933 -8.1995916132019406 0.31631504722524323 -0.067363671498540265 28.202274034414948 9.2066777134496309 9.8153455294313545 1.2167041001130268 9.9718509351132365 15.940639459090251 -0.33493463006469676 -0.40875558318655658 -39.811398435056233 -1.8853287618343113 -1.9449004450232514 1.1297275082518301;-103.77285611630406 6.416585104879597 7.0260346236112357 7.9058878823578782 -5.8740237480180948 64.738526025569513 23.983609892781768 28.535895336767727 56.524950264187382 -18.1759563444039 32.477022931591215 -76.615066614494268 3.3533882319243835 -38.784986340002853 64.050363072393083 41.947834552350891 -34.82853316519531 13.215094890085679 -42.080799351948322 52.253513480873984 -24.925679307920653 -67.812332657729186 -12.705487759083358 94.620083066017273 -18.266692732222609 5.9573349303343157 42.814090568755297 60.450402986566843 14.338014311295963 -6.7736287422615229;62.548777265147606 -4.0313584260112076 17.338604236535211 6.1404928008537913 -35.861971377294886 -6.2319578289249771 18.697808209412138 -28.558436582972792 -32.17531903636845 4.0957149751395239 -10.62135074130188 -3.0461827013293146 6.6872697170274966 10.185948568971106 -19.231947888416538 38.504760995965661 11.178606398892795 -2.3620199573376484 -13.86382609300558 52.355997255514367 -4.7224624210332129 -0.28300542756820807 -5.0472588055917775 24.921340752880148 -10.765387935509459 6.8068483953399017 -48.828077019743525 -11.665322820369454 26.894571794275478 9.2059554142573958;22.37382124296829 -33.010686110762883 -2.9969515547700776 -14.813614405587236 16.720037725717333 6.4831105500927046 9.7265393736310379 -7.5323834248936112 7.7783132339930132 -14.694377455897579 -35.321768592741861 -50.717605641311643 2.2741052890364304 4.8948144489145538 -37.871507398017791 -31.123366576755544 23.729661784337708 22.62887991463846 -79.693267473166799 -30.973371727271573 19.492351719567452 9.2049529472818516 39.104370368117195 64.068040766591338 -21.891599779186482 10.496549106598279 45.846574562344223 -117.83645335453107 38.376930519844848 -18.567565434503731;1.2388067640433955 0.074681996415985941 -1.5341487523785833 -4.3499105325988348 -0.66101093684677836 0.2365780560092067 0.10397020239984811 1.6566636351270227 -0.26895799080330196 -0.022850248750903541 0.051005126501064951 0.65349681529122738 0.089759410547169433 2.4873712005944202 0.061787614476391119 2.2906114791232857 1.549873405499858 -0.041064930060221889 4.135557239149982 6.6049836680933227 -1.2073831928374001 0.035538333186578001 -0.27373576936631799 0.072866994877109487 -0.16713452779251231 0.08526807760870192 7.3353106772192609 0.075887097881586249 -0.033388878699280339 0.27131539888200207;132.94973694114452 -52.294828161346445 -31.453011814111754 10.540941062143366 -42.850909992981308 -37.664040948367621 -14.767641954107546 -44.481684190452818 -60.519441807209923 9.0923103442888564 -18.401154859834598 45.173592716181481 -10.361708026601834 -46.85521751124633 -56.930231331820607 -33.692335237224839 43.9133194961599 33.103459859075734 15.036151032031379 12.440564875268734 -58.681874318154726 -6.6530836910848059 83.765271586421193 5.9920851858669559 41.794244034289811 -14.505954625801447 -101.34742565213885 0.074142895594106792 -8.1678068682866236 -36.480107214771515];

% Layer 3
b3 = -12.508620006394862;
LW3_2 = [-0.026719974523372207 0.0037763602117935648 0.0070652155868382756 13.508678278097653 0.030661406413485411 -0.0017749201553773708 -0.011083412608421609 0.0034451001862380618 -0.32833493206442915 -0.00037341878184402039];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
