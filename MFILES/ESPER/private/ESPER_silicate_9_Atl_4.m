function [Y,Xf,Af] = ESPER_silicate_9_Atl_4(X,~,~)
%ESPER_SILICATE_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.8232283144782349682;2.9210836584358115253;1.8385514886758436148;0.47557898487170829904;-3.3508138185515559115;-2.2964852059550766583;4.2365096810765976443;2.092363770842097459;-0.48969282399352825896;-2.3701759167605973566;3.9820930317502014617;3.4328665189906271138;3.0877698555810031422;-5.0726683099051035342;-1.1490632196880414817;2.816410101503262986;-1.0013437704881109624;2.470916310010625061;-0.83946269707739151755;-0.71044813210935897629;-2.8896878058504888998;-0.56479385130268522364;-0.87335678681366646359;0.069203594176371910351;-1.2025183062834410297;-0.98979958271236645473;2.7675427654233049068;-2.2208575683269069501;4.7881639776418722931;3.2363714062117248105];
IW1_1 = [0.79762781357311718367 -0.45573368385221163512 1.9661600564813446201 -1.6453306222441619333 -0.98881259844867186448 -0.85100600165720674539 0.59919100292289428911 1.5467485353058705311;-0.58375663329677263125 0.53180108442242357558 1.11966662861087074 -0.75247717444218409355 1.5150486287209428138 2.9138849865287808072 -0.56548489513248190175 0.39996503831598090306;-0.78683904775808966026 0.07318445984278033889 0.57198492765814124006 -0.24017977969337492294 -2.8677603666551374495 -1.4672330708012555345 0.0029557737359213569206 -1.0081547513237598679;-0.5343538377660624894 0.046601193272499501219 -0.47220363458290792735 -0.84433662311954427171 -0.20159531799845081812 0.29068119333825725992 -0.48337205915173842019 0.30130920811095895928;-0.21203424843979801206 0.36368051870883999488 -0.27000729147245772221 0.84976115030365628744 4.9583682807210287535 0.88575740726858387397 -1.3304123198488437829 0.075509943325891074051;1.5219714251944720385 -0.90653630519917471897 -1.0456921250014614699 0.13943917757579510353 0.4730712944385262464 0.35514859783326846454 -0.59348177168262983283 0.036388292804466600139;-1.0401984121385035031 0.8049851802421738034 -2.3591269059737811631 0.33801589654568231502 -4.3545235692241677228 2.1985423406319846151 0.28146714781571030572 -1.1326057152224395796;-0.58671057588100627989 0.51018306465063001376 -2.9246078615280421964 0.37416244941475224062 -1.4340398834993006716 2.7874188206825474268 -0.55446384540118642814 -2.0943194272273251144;-0.5660332818877755745 -0.68880557088046068248 -0.82701084276740843837 -0.71891470585615335764 1.0347034016340299623 -0.62131709345128438571 -1.3127847484722678928 -0.79201196675185969731;-0.97671348165673776975 0.43111520073764092453 2.3953444817428595215 -1.0605265680651787541 -0.81320786199194117216 -0.79936279115484065727 1.4580605298935460645 -0.24764726133669662245;0.84076345065952939883 0.93000548415657069423 1.5934159187618228692 -0.15562043409749970468 -1.0388468612321131168 -2.4907494631799815821 0.026893950285622178487 -0.23654225848925722331;-3.2644604732601401054 3.0944536556123423132 1.4320017699537719302 -1.4226493466845313574 1.6920343956392425167 0.31140067847700464432 -0.36234831661173128037 3.3963923901637049774;-0.51403540618059118117 0.042662973499096014385 -0.68987548794421149623 -1.3307069365159394092 -7.1297405803049391793 1.0149765453936019366 -0.010201779520864808978 -0.17858994558912630324;0.54237026965965795533 -0.096200102321310126952 0.62545909405193800268 -0.32871268056499575172 7.2893017534412098968 -0.97038097572687420644 0.48788167388680964143 -0.38040199918458633688;-0.30915707278090187593 -0.41306428774095149681 0.086776659744453490952 -0.15487248675197617942 -0.21325687808661727973 0.09725590873836674477 3.8154618083416314001 0.074683437984815623234;-0.51914410072455974277 0.40932013151723217748 0.23997319392815183448 2.2196722671794342219 -1.8180069719810214579 2.2545388250611320125 -2.5470947267769248334 0.18223649488668219876;0.57237845960405375756 -0.073916639079904339349 0.44780587468513155525 3.4089788501564695089 3.0274226234371943711 -2.1555927042988720643 3.4942736520197041905 -0.60778671776788684156;-1.8110701886811817474 1.0313030145745096799 2.94509581161664169 3.0047997537399728785 4.2580971697727152403 -1.3670048860133094948 3.899012633989007437 -0.060181390877144740059;0.38301155023645327979 0.636760819074284945 -1.2212364459106437309 1.8584916000086626475 3.6507300289075046429 -0.68940258010917376819 2.3945784724206853333 -1.1764837058641595124;1.0348414169417285979 0.16708669597847111699 2.9914384802224627258 -1.3459436376988276329 -0.73831424819196289633 -1.0689227380733596906 1.4001524323320171384 1.5063780677383515894;-0.79616272897911433137 1.1638379503914433322 0.98140959801161420373 -1.0574343997152046981 0.19696520449713994516 -0.49124104254750977638 0.041252348092329554907 -2.2280737576642284381;-0.32441922951561663613 -0.0081099981499238513183 -0.15718015569563567602 -1.7735788871457160987 -1.5278439192636990018 0.7784181451687071096 -0.1921703360494342594 -0.48959301712190328448;0.13890664006442673961 -0.36467724710666515886 -0.7755603939168524974 0.39501692297245638574 0.7803594397327271448 1.026216831262862339 0.32782431251902321989 0.75578320773631024743;0.47151765089746328075 0.64470613728823167321 0.35320137734779677441 -0.77018869093237773971 -0.28069429001379975208 -0.31484360826569890435 -1.5697150705206195376 -0.60809855434985882194;-0.087919208743016744045 -0.18020018170819562808 -1.399261735959604902 -0.39807513217429751906 -1.838960575088682381 -0.87599140028575850359 -0.31627578326168048761 -1.1730677593587977015;0.53919932945225090837 0.57256524905727979036 -0.31841724710613922289 -0.4280444079728998874 -0.55693814769858607239 0.66400149141594555502 0.073705549714605814171 0.53944841210563398981;0.03387759724098791253 -0.030918012025726793884 -0.55519172028992491708 -1.1530742729871990004 -3.7389628432998733842 0.20037490314276007464 -2.3229212792296314305 -0.37690638854343538888;-1.5707501498446061472 0.38672546748999975241 0.5131822904273846131 1.3712962975040023927 1.2385376346423999649 0.27209052482792595029 -0.55219691893064681842 -3.471514472254629613;0.64729548082304477763 2.5803865317583114525 -0.77087451713069132797 0.67669983429539759534 -0.7328910987135028865 1.5608449831969382071 -0.86997286716275779028 -0.98085561791094799666;2.700898218221165159 -2.061985974239419761 4.2775227018173920257 2.9459551287699152766 -0.48720570098807358672 -2.6320424790391512282 0.5642863087137676148 2.1791321016097429109];

% Layer 2
b2 = [-2.181160194466575053;-0.45249343309778500277;0.10674006172655742253;0.34228508411493513419;-0.13580938960538554983;-1.0034389081068351146;-1.1589061554567965384;-0.25232450657630484114;4.3750793149024911344;0.031882662137113486345];
LW2_1 = [2.4747440533546569696 -0.55218514001925389501 -1.9549566115099723529 0.21708722504658012342 -2.4951171212049638726 3.2031531546363680718 1.5785038594937956802 0.16717921193540463687 0.0024665765783981608017 -2.1469516709559632872 0.47260798344409082894 0.99458925703846490229 1.1257229821784200396 1.3550965184747114645 -1.8083647641365130365 0.14915516852892080069 1.3639664767667682987 1.3231789025668303506 -1.3432075740412483533 -1.1567731619671590693 2.4586448245039314031 2.3527144789528180446 -3.3303967993374410383 -1.803280963520940583 -1.5031346701231216301 1.4002419403433998824 -2.5818840533567684048 -2.2576390699481714286 -1.2905811795287291943 -0.43659062209760873818;1.8159794080474065403 2.3138201067598678229 -0.30246711737941395226 -0.15919327554103818168 0.72632111766429141575 -2.4094882004811282172 0.94732093792705995838 0.21351978900128210093 2.1661271483451147724 1.1673590767299577564 1.0375414542204919321 0.52623153381524767624 3.7379350598442426801 4.3024078694150063029 -0.46235656002039604573 1.1109188232891424875 -1.0315606903240681635 0.067768553225872454893 1.2301112676486223307 -0.33685373925728900879 -0.63809569925411491198 -2.7606785361956833746 2.0377030227145978003 0.49769755121001574283 3.4562884186105353734 0.97146074994792275259 -0.78859832701350429662 0.33878464967831051213 0.79863706107827669989 -0.11478277208066015036;-0.76611480014591737397 -0.79612678624279620276 -1.1307543976362168792 -2.0103768534425929815 -0.87189918964120227685 -0.38316542997469732468 0.8858340705663575454 -1.6531638205663161667 1.81487276612386772 1.2703013837839576272 0.27406744586822967547 0.34994594407171775163 1.6892543449454919813 1.0232522740974505648 -0.049227664937759665897 0.75465761214637483434 0.19860802768899832316 0.66485664264873556295 0.20841931421576226358 -0.7339364971112728453 -0.89478741542869733028 1.5981368416192394122 -1.1041785998996802576 -0.16264648530758077372 -1.0747878753705613075 2.4941185106952992179 -0.61605267947781305882 -0.10749766714245471977 1.7043057661568541405 1.1056849106426727136;-0.41948285139836988256 0.29710943601505002132 0.87348882860824250685 0.37857789506564881732 0.22630631101629386515 1.3366658986745911797 -0.51311255321499360527 0.54472752166169946531 0.5123352341935182297 -1.0369667504900319521 -0.087099633351944039106 -0.34111705443130607707 -0.81987118414646265041 -0.042938235707779624784 -0.51070998073685225371 -0.039672497307796705801 0.20055279871973419326 0.0079707074630661865766 -0.62145442996998323526 0.29777369961828903389 0.6145553946981726634 0.82563202334548468908 -0.23647282078055445464 -0.79122827817738672351 0.094747414624259382321 -0.49216959255212699986 -0.55045987524408057645 0.069593433735430809683 -0.96155834204807555388 -0.67754942699137787887;-1.9029926762795679185 0.9781310540893746186 -2.0866938961695260524 -0.79810596166081793079 0.71496756722560517172 -2.6736311961692567074 -0.045614399719495719865 -0.063597842285258734951 1.3108346525170861963 2.2580861928311173337 0.9822056271355201762 0.12519373154143639826 2.5150544949167055186 2.1859172972826659276 -3.0641419882864142643 1.3086386606328352933 0.21095801000329905683 -1.2890557170947503085 1.1746855378316125584 1.9346287801357235914 0.11448011412827550914 1.8128448509955794599 -2.8439897382410634918 -2.1056325956159493984 0.58414128748513483025 2.4493037617995283561 -0.67143051909983808567 -0.40044452176641975871 2.2599020597270809141 0.11938416035378683622;-1.5199058425229110547 0.50545276364432667471 0.12373635996493174971 1.1596052532825942283 1.7228012018438625397 -0.39876378195351841471 0.23294180440315068181 1.0315485165099436138 -0.1153040100709693816 -0.97000611135573133748 -1.6590379702169513187 0.91444144934560689375 0.45109746304496717295 -1.0718590512191088493 2.0631459001247329788 0.3371653007776103661 0.27983408966790479511 -0.36536586486535055363 0.1314207637511066451 1.682288096893999052 0.69736728898016020484 -0.21458700839220065659 -0.71664380594294374571 -1.3810503565675131821 0.11236465207385648579 -1.5009796365371081972 1.325529359930776252 -0.21984922555880714867 0.39600707535042978247 0.99851553007575133414;1.4764916108217018831 -2.027847229783731553 -2.0712079860772383277 -2.667334900864682723 -3.5009462838488945025 -0.44811326670216089507 1.1511082403368162463 -0.66875653246085164927 -0.098569296411046627981 -0.30351568514165550017 -1.1186040146234905723 -0.049704217594703642424 -5.0856868862389008612 -4.1245449476063917871 -1.0166097413133896588 -0.0055656859533883698901 0.99753293899406458856 0.48378428359981051621 0.62882080848845012255 -1.1965183466758588793 -0.34066643503954618932 4.613307459036106728 -3.114554188367110843 -2.0765808187568692844 -1.1863022275396180039 1.4825730409036956825 0.8009886335168308058 0.55172003134922464884 -1.0712221155133025974 -1.04605316221499689;-0.33737096471583488677 -0.75694201084494927567 -1.6109669470745955344 -0.47730177426577874433 -0.31566357507006193028 -0.60724708517809511399 -0.61639431352432705324 -0.65701569905768641977 0.64544264949945118204 0.75696037711090280453 -0.0018959642758272152174 -0.056197486742430816098 0.013900954452721991927 -1.1281601723124017322 0.64346563043849114294 0.32052012955912884129 0.3245286500034388899 -1.1414980026959313797 0.84781401430403946495 0.26039236565025208892 0.19845026108342486704 1.0300702846293980919 -2.1185588466077991399 -0.04377881612731868155 -1.3773828155329634892 1.6332537396857942369 2.1713702542815997987 -0.31516279723071638497 -0.14605247992250447453 0.56715340171609607278;-1.8894172389199106465 -1.3319475871159702773 -2.147209250774047451 -0.46797945999136875139 0.41071741676694589751 0.21121925551117592956 -0.015071005827552413914 -1.5232653745491744335 1.4611756568068756668 0.26046144566547962951 1.5031440313185311375 0.63271721470840447399 2.8719926183591537594 3.0113491143731665467 2.0363292452578551917 0.29683859924565714206 0.564497402383624447 -0.20836918904171497502 0.61893752675019664267 -0.18966411931927232293 0.32970081558091501872 1.0117151468939158399 3.0831827831923259708 -0.2901748758657455296 0.83447918269179588435 0.18146488148701023224 2.8737152075015250929 0.20134274566818724517 0.15941162622017782113 1.9450556667337142169;0.84436243632466667641 1.5076817417616217298 -1.2752951163706021109 0.92860407637703379358 0.11360351280568249666 3.6596712312663770561 1.415513408567169451 -0.52077737627174069956 -0.67439432367023299797 0.11779032795258308208 -2.2689199598377420841 1.0399498747934066145 0.8459085813605872195 1.7252320816023076766 -1.0574197788419079647 0.13252197061067344519 0.61619212083200081143 0.77503758708455627868 -0.29130014345658916675 0.27459396474396208232 0.49240397542359976013 1.5570812398142461763 -2.8091181443285537789 -2.1683210128349772461 -1.9449770469115867932 1.1841684599968751446 -0.9871357781252821928 -0.27935164954343583155 -0.53349199881212827634 0.43907835569642539308];

% Layer 3
b3 = 1.3237434469792084268;
LW3_2 = [-0.17971527893312810864 -0.18282553253295902307 -0.09762366505790819049 -0.20716770401815590152 0.040759661838637904763 -0.039153766790221519734 2.2792915955296737529 -0.13508798073118813421 0.071096650008878770066 0.1618667759906029513];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
