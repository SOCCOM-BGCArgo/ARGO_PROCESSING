function [Y,Xf,Af] = ESPER_oxygen_1_Atl_1(X,~,~)
%ESPER_OXYGEN_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.8249680656525955058;-6.1231032696644156488;-12.388280313179123482;-6.101056422263680723;1.3082199606870077435;-2.5604194360466427938;9.3268461873094974379;7.596586073603951661;-1.8763748597377463145;-2.1715504765503941265;-1.7667718643613936624;-6.6210705961179696644;-0.093670222196393024272;1.730606722650960938;-0.35568375523288553453;-0.89746851005301997439;-11.787013629626937217;-5.7648756538655625548;0.14757234312286474087;5.3970126762897328021;1.8063754762152617328;-1.4060641101036461809;11.152150302171657259;0.10840027627470551208;0.14685717794537117564;2.228583018335022814;5.829222962207783354;2.047151730393073521;-6.7107097745967081437;1.5653480830355952502;-18.664403501814241793;12.097700486741672421;0.51230842101283313728;2.2054113347539803236;-3.113368668273708284;-0.35147663093660347355;-0.43421084397819431633;-0.15415468681241875637;19.336244764747810621;-3.3178928247103334215];
IW1_1 = [-1.2596001033963635241 0.53140929296506034252 0.41599297027277232219 -0.38818080921556413765 3.8636518425608445959 -0.53883307371481670156 1.2452340604554490433 2.2264326401440190928 -2.9895673832965767858;6.7862316885991287307 -3.6910633022484256038 -0.30359838781619058468 -3.2856985788934709447 -3.8902737586368525413 -3.7660432549030282701 8.0223875429091435763 -6.4625570422125528935 0.56508783882213420302;-0.16254615112453180137 0.48251233375337015952 -0.58878292800605058765 8.6570548597191798734 23.616576135052248731 -1.8385878738246854702 1.4736114130146971135 1.7838270420911357395 -5.7408596643224969469;1.1147937322739018828 -0.85837468919440040871 0.041763317687923566524 -7.644144812837734726 -2.2727001844990466495 0.69714063886246491197 0.13681794488375562113 0.020641624774679682292 0.95553476951395999173;-5.9631160516820571615 -0.17963466687902387986 -7.5969099487283262562 2.0939423109615549201 -7.0169133444828153401 -10.220723182640174542 -0.92662870698882693343 1.7349958456156173714 -5.9084209791038828641;0.61867228929113282643 1.1016628698438344358 0.63179487559561020582 0.11821517226621187924 -1.7441110826612493678 3.3248667576023245296 0.60913819406369273946 -0.81161949961346269156 -3.3613466038175450201;-0.51520816491718879337 0.53857433560734957467 -4.0680167275356344803 1.8488116688100646456 -2.3879107273335811179 -1.2817122035202062058 0.32559387527930400141 0.0036804695185036376097 4.3321342573668299991;0.91033988648197561311 -3.3216504695345352438 7.6016569280326908853 -1.0272146584594579188 -4.423542245062462186 9.1413124445235709459 3.3003123766512292292 15.544245579046499728 -2.7117923182972583085;-2.7872894084457549013 8.5038600478542303307 -7.0415370775444721119 4.5105345760942601174 3.2501631765778657979 0.16952022499459096228 -3.1775022348824490948 -0.9800559437169492627 0.99494902049563727076;0.10073017877530769659 -0.80728119038675116848 1.5219960757479611413 0.14393209030647685642 1.5941121778377573825 -1.1845045560054550116 -1.085824236716885105 -0.96466698138104101101 1.781869591849854606;0.41173708185332846821 0.1092310107072226727 0.13387568457480408801 -0.2230771187777843001 3.9276110247129465414 2.3284588021962893123 1.998280457096185625 -4.7829077891317259841 0.11413126543982105021;6.5766283132199259143 -10.556120197553346074 1.1224340741732721227 1.4001136945598156025 2.5993066754238638438 7.5576882997779657458 -6.6537503241714981428 5.1287942364964305142 6.2193295363950769072;-1.4445592424677120569 0.48143049034122892271 1.2593633038065192853 1.9780664245659818068 3.0241557772397782422 0.59176159292474206364 -2.5189987832728313322 1.6206759708026090561 -0.85728323592037336542;-0.73763667966749468796 0.5913509987035897586 0.54677476085770282399 0.54169279313839202583 0.3669940462469112874 0.91229174529508039182 0.69590450716278295928 1.7978886928264656841 -2.0005270664644547729;-5.9342885270967835609 5.1718454495365557833 -7.8669328245570984137 -0.83063574337965773164 -3.107926054812939487 4.6831469204766795755 -10.358439179958148557 -0.77217896255329898647 -0.12426372323408801934;-1.5692542158549220854 0.74566348161488549273 -0.27777624799627009811 -0.5400211221858638444 3.6212347943900566882 -1.2251104595596484792 1.5073221124026658924 -2.1915238132245482561 1.312385508954634572;-0.034923343564521945603 -0.40861736517902053079 -1.2226728564689903767 2.1831675765109830323 14.209441362019639143 -1.2228507506886268086 -1.7840229622278678256 2.6638666929447709641 -2.4770358492139012974;1.2192469940003485274 0.67468889710478618937 -0.050734416404791975175 -0.11618209027106450593 5.4800605822992860539 -1.5821189029191666808 1.5594127261176844446 0.27390524765758089698 -1.7295152586285014173;-1.2042782376038358993 1.1279337388304624401 -1.1746803383835808798 0.13489509419590581252 -0.70961310803508681477 -0.79052450345207925242 0.8711539994957016031 -0.19116812335377789123 -1.4360350593850994549;3.7105020981950356251 -1.6109136070571741239 1.0896962171364852345 0.17378729533491177328 -11.245869338094008683 -5.7850452150670150786 3.1223225951146651447 -5.7115747645587120473 6.9742379967340975;0.41271182971709263754 -1.6475770668399711827 1.151999738752233382 0.65235421298351337072 -2.2783095112507605329 -1.7920205086206173473 1.383394055687453772 0.79908876549881779905 -2.4961518737155472536;-0.7908426960640529968 0.24031705786800958147 -0.44173714190526264245 1.9662303914866048338 -0.44650997132868747164 -1.5670965993661152282 -0.9930324994129586802 4.6655289387444245364 -3.6952632734871335707;1.7285178475424312072 1.0009034081472112376 0.062724822966783597145 3.1445694874874972058 -7.594584746826704702 1.5028575078934931497 0.61102974750471150678 5.3367809301820559043 -4.8783281218114931121;-0.40702260948896717974 0.16292692697279748115 -0.14027193716288449687 0.097249102198591147461 -1.1199584819608523478 -0.67729401170934477872 0.10431467735981421463 0.68699383340772013362 -1.2202293024166581681;-0.014432480307741758427 -0.34373137675467035912 -0.75772548399200578828 -0.70925086951395022172 -0.45311656136421651908 0.266187019783403922 -0.12349669500164392466 1.3079924632010142549 -0.73618662956990776891;-1.1287052341066183825 0.58240459385859044694 -0.12613286539150342369 -0.27694225412340717218 -1.0715786971111305181 -0.83463152306666688052 0.67382405687955981843 -0.64765818885398285243 0.30415125572413337363;-3.0538583245464594462 0.8594709779107864156 -1.695067572450783322 0.81481017017418444492 -2.120738474072300761 4.5171202557400551569 -0.36879818710542638938 1.6964007779966066014 -2.3205943136989368725;-2.8217815245582045236 2.2678139880514458504 -0.27668579170276780266 0.50550075631400404053 0.36156586687862052321 1.2139770159002523098 5.0298567275208840854 -4.2925034965783464003 -2.6467093994643744459;1.5405838182663311731 -0.92039837957450643113 -0.10469087420989661719 -2.5090762452329506971 1.3184330712783063344 1.234763474531573868 -1.0650448507057548309 1.8927709389354483438 -1.7577035785054211381;-1.5984154616190455744 -11.739493136781698368 4.8603570849981174717 -0.14792590010542375212 -10.298508601410768293 7.0616491301990800267 -3.0563670861341201146 -0.038715576321887844313 1.9367578896700901048;-0.64577563594193088115 1.2121392001606283717 0.1854784172561084743 0.6376244305399747514 25.590919121190204066 -0.97734942100868460457 1.1075944877176238101 2.1965636971197000094 -2.7929200143250647592;-6.8158482274019522862 -1.0257657871247958248 4.096285309897515603 -6.2200849406496026006 -3.7010325991457087014 1.346225803691537326 -7.591436602866298955 -1.5028858205796993275 12.495262675149241716;-1.5783992508531143883 0.2183610497099323644 1.6766982259018650137 -0.74587721020624864199 0.34444064161520471234 1.7429818977272530933 2.0346769598657039602 2.2935915873518024632 -1.1620863193345780662;-1.6078878899173825179 -1.3438366702161494981 -2.4994603466477340881 -1.8707278007319594337 -0.21779059898905628323 2.2688944143321543301 0.37786918486439979858 1.5801180484029062612 -1.8079475408514784629;-11.397871131973076331 8.45832564446816626 3.376000628494819189 -6.2513869938905530788 -3.2073081864110815076 -5.2433181200368093045 -2.0416477636167256193 0.37851795025558948593 -3.4905033590414715761;0.10694431411041405156 -0.51388197770128807296 -0.63593594358931826438 -0.67653127267030055414 -0.31013635760824398435 0.063589880397577069893 -0.65192164724291268296 1.2887051034464671595 -0.65067303035912449349;-0.22920469374689450559 -0.55138498987763295833 0.9071480941883843796 2.4897558023454897658 -2.6191303622564068299 -2.1779701440811973789 -1.7325301595977105062 2.3454513336280942148 -2.7447945139507310408;0.43005863303625535554 -0.15160807744031792876 0.073253469109026483896 -0.12282534602984229721 1.3580252566126176372 0.78798087652346504584 -0.17306514920992177586 -0.94763654329347013494 1.5283635943213591535;-3.2193779024272752842 13.271417020285715793 -4.9864588309466002514 7.0784766740808526819 2.557730612843517104 26.745076958671862855 -1.175703000378531593 7.0442690578866358209 -1.477150381662228007;1.1697664781969103753 -0.6324488579642132402 0.62709684907877560889 0.20289290842278426275 -3.2188569621599958381 -3.9151133710663610366 2.2501773066274006752 -4.316206737924830783 -0.92207034849559321721];

% Layer 2
b2 = 0.62432104504292773584;
LW2_1 = [-0.31973726150964121295 0.02097658288712482208 0.1103962675575811403 0.23088332991839916053 -0.011012670557638774144 0.16565352421613474543 -0.1088156180484868979 -0.012269733911704541404 -0.015267743058156497266 0.28666152536756345226 0.14917061856471336423 0.017303191368861652044 0.15404992419676680204 -0.39595042113274114826 0.013560026114669452083 0.19476225589575316133 -0.10231038612850780478 0.10279207418723812495 -0.33815622267835959702 0.027237615332280262076 -0.16781878470872016451 0.16387885101782603825 -0.18137871743036454442 6.0585809646221147062 1.3310111321894630976 -0.81953571184744655742 -0.065652316326056156526 -0.059893196214045305026 -0.40458269726811885159 0.01337904580034907781 -0.08486371875815226784 0.0098744759209514997023 -0.085338967951233093978 -0.061017535535092370935 -0.025037705945220183751 -1.2319712089272287781 -0.10700852111746569917 3.97324637359755517 0.0076588450588958301157 -0.122979366564652845];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
