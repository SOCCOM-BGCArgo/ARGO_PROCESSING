function [Y,Xf,Af] = ESPER_phosphate_14_Atl_1(X,~,~)
%ESPER_PHOSPHATE_14_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9883840707706474937;-1.792446616387646241;-4.2643237014600536838;-0.22458148937263766598;-1.3241124588934529704;-2.4816014087450750658;-3.0230794856527722914;1.4985342411783235672;-1.6903844692639953262;0.54378091463094035962;-2.3924643468708692851;0.2194632092533153056;-0.5125719731734352802;-1.2029072254476860238;-1.8395470774596085484;-2.2239404095064561062;-2.7607156120038216507;-4.1730305559574576435;1.1895950558982923972;-1.0256995518568061687;0.017120634054643028843;-2.2255571190125045256;-1.7552156285216693465;-1.8513454362460877167;-0.5128814310403660981;1.1066222221800725567;0.96615653854604921502;-2.1878401604566781735;-0.9320200920253312038;3.3619964198188685423;0.47834407448155841225;-2.3069263433406828057;-1.3943726900505075683;-0.00055055904030588097287;-2.0891729478187945901;2.4046839208562897916;-2.2171681601161226105;-5.0294664280999494821;0.54392253603762996672;1.697931614068963091];
IW1_1 = [-0.16529437442864192143 -0.51236737353596828459 -3.473503080964194023 0.18107910356511397465 1.9582924855279275622 -0.51129478889110258066;-0.76515950592504633487 -0.059817566913906522474 2.7609929406168221 -0.00081624254525416485313 -0.14045294335051355938 2.019598149345330107;0.15721513560538236121 1.6732475550267729147 1.7691539580051109937 -0.74269250886329685191 3.5080993825025474919 -0.078824977759281766865;0.61551719435671858882 0.031513560121713045381 -0.15779254314868440545 0.22008132457245815905 1.4786723468211144805 0.1241441622288076696;0.98870032576207811381 -2.2230843033552134536 0.055835684094645648967 0.4050428448209397736 0.61586981097813442432 2.1385698553679355349;-0.28822590359145067174 1.2234528688245451811 -0.19604713550994282145 -0.0051256513057306909292 3.5487752211054992557 -0.62905352138479164736;3.6859148149963623098 -0.83230244830825583779 1.9703167575568556469 -0.16770882458769725831 -0.63012205502725870954 -1.9553125474038819398;-0.55669845465473588586 -2.2153000363637591619 1.065316924705543622 -0.18116571438097753277 -1.1605521743102891197 -0.59812256267043073521;0.86162931355583693982 0.94164205636548892198 -0.950221443080843442 0.28746925140456375258 1.1029658074088084518 0.68892382185893041857;-0.05114878145388444125 0.78588659621954315426 1.5542944394839366407 -0.33250599865258995136 -0.70991458994943201777 0.055864002895796162351;0.68579160769330160807 1.2223909704369106954 0.44199979803043237814 -0.32365067303707240054 2.2327578982066373925 -1.4648558308478270007;1.3182731357427670549 -0.45978779871404934498 3.2369813867778773897 -0.99205516259373238697 -4.2576626126337577816 -2.321588150890058877;1.6229706088760056382 -0.074801846488408554881 1.3026999431527199746 -0.14699849612661725073 -1.67473716833343933 -0.090236915008828605389;1.545137831136168538 -0.051262498175849491311 1.9772291746070451701 -0.028226013104640578638 -1.0120378459339076649 1.2944307775715171438;-0.32445021566259013568 0.7570215438208831582 3.5182941753309182609 -0.80989219611633200824 3.1491982383159444758 0.70532624162166501769;1.0416527004720106397 0.6024680289934160049 -3.5827496391464461745 -0.030675921035331617931 8.9300612549819486929 -1.0117171178219130923;2.0789565637238509588 -1.4455373484158364761 -0.29201296686569999661 -1.1571649876446767902 2.1673791480327246894 -3.4650173775442363322;-1.1777281156435606135 0.929514429531469899 -0.023424762111687744137 0.24762226389331437604 5.6989795526669499992 -1.6068723249209819759;-0.32035610773161676823 -1.2996269483772464604 0.85938173602036382892 -0.22644122257478913052 -1.1427593202107868553 -0.58486487202093695448;1.5761676779454341091 -0.094916437011417886804 1.7108453723630181464 -0.089340322995249965565 -1.4575670468183097306 1.1140558330819392285;-0.74009970967717053636 -1.1057573946647449858 0.68243210985042912498 0.029837919037051841703 1.6939410608808092018 1.4160217165958803864;1.1234874386128852475 0.52771850807558173813 -3.2699593539051332591 -0.1603463723488073589 8.6688939039971053546 -0.83009197248298782768;1.1948795958756475155 0.47286310531995018325 1.6573827005922843192 1.4625584907478099694 6.5620017770724166084 0.60591874829541592096;0.12175388236770307016 0.70950977541633564183 2.8740419717845799852 -0.61477693206790806624 -1.0755844588608118872 0.66998043670503826252;0.47502457024903543825 -1.4206243635540443115 0.34075782304428275937 0.091521778772410147806 2.8610918040664068407 3.4099384680814011084;-0.3749514559599836927 0.22585734218499248227 -0.2291266724330499327 -0.10002571838338909782 -1.9227797455176720565 0.4329798135764618694;-1.4818813283114973256 -1.8614119180715458235 -5.3667598230931590209 0.10542710810543581834 -1.0554487644362553489 -1.0992199602386032442;0.16942021489974565251 0.45984266277831303826 3.0959031926071554075 -0.069602486800889457053 -1.6784033075381141753 0.34531952962935591467;-0.98494009905304846786 -1.8389767883135330617 -0.73875016611917176945 -1.7358525823135309007 -2.5189973399517362473 -0.90505569981621147857;2.4392601965739260095 -1.5170287158702175923 1.8592574263040451132 1.2347222026877071599 -5.290649379850877132 0.15125069971217805498;-2.744064830039135483 0.31112616495550565743 -0.11504838027007215084 -0.47472337743977804925 -5.3805480984182638693 1.8503951915221878988;-0.85996531037489309934 -1.1299266228498605624 -0.60930483862698103792 -1.5033484338519931267 0.19141564154556944821 -0.60233359875365610758;-0.34942618251579643518 -0.44476496036520379862 -0.51903278756011272943 -2.2202589918961415094 -0.86979536465939011336 2.0115925378721564165;0.6641170459611153154 -0.82719356164172996859 0.53398890100172879958 0.59796264596480264153 0.55991773477465733855 -0.64208156098698931924;1.0588277118874314109 0.38748748504110380741 1.7390087392927000565 1.3027637336040700511 6.8244920414650511731 0.59731687660767407433;1.2772371403747742047 3.1017434077332239895 0.40625799005447016388 -0.14797773274148173783 -1.4747625859537085713 -0.28472811685816218352;-0.58324061559470918858 0.0032966802484276926631 3.6231388722407613656 0.10434747662698388992 -0.037919547956132761135 2.5701537283882678331;-0.20629476343829436513 -0.10576967969234638001 2.8968159735755434347 0.67814090618891664786 -0.17128182258192400922 -1.8355127533596016232;-2.8663920620889191682 0.24293190929286589963 -0.25098539107072892484 0.080582701679805024408 -5.1367712305513757443 1.4254245374114216105;2.4617826174721200161 0.48133507580424106376 -2.7638366894544450503 0.54702750492469476296 1.1805824376308866608 -2.7465923818802124856];

% Layer 2
b2 = -1.1799603018177824421;
LW2_1 = [-1.6947097563440238766 -2.0310122450254719517 -0.40416947025092569978 2.6986644114027322772 -0.26838365187875312667 0.49490101706724221042 0.083717559773049676775 -0.94205890429719507662 2.1088907078197522971 1.3271424204739268315 -0.36270796831523299808 -0.08783368756584333803 -0.8895157497722097073 1.3599394214661597591 -0.12676186799901884017 -1.7013427443244513171 -0.058593218622672763041 -0.26441172972129756147 3.5819379323824485084 -1.6583240606724451993 0.37488193509278650017 1.7318746920977918791 -1.3815019077923180735 0.80864785647007875191 -0.12219033808245637063 2.5470216845279263218 0.047678848227342522648 -1.4844078393744393196 0.2342840869987601049 -0.1968836150314648703 2.4585513430904404331 -0.44348300524535905209 0.12374724302666829934 0.8984959197328985514 1.3803332691214380556 0.14237818688334094586 1.1919543559421854617 1.6595602425312179218 -3.0346739200701113859 -0.18484496371868333608];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
