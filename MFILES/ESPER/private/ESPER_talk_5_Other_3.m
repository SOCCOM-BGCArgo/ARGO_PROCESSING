function [Y,Xf,Af] = ESPER_talk_5_Other_3(X,~,~)
%ESPER_TALK_5_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_5_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.60331502356586797;-2.788648371178684;-0.80992289160045583;2.17615131073148;-2.0611254535426897;-1.0478286785638289;0.93494239581291305;-2.4864800923435797;1.0871246335802143;4.995012963024414;-0.0087393245301734569;0.32136692397680172;-0.92590775386667545;-2.2572530720812578;0.41577843292330369;-1.110777921728237;-4.1055399526424221;-2.8572515558936948;0.28957193891380295;1.2895035188620818;-0.051134315345334809;1.5918972745810251;-0.26536904785558119;3.0199725077865507;-0.55024121589926767];
IW1_1 = [-0.0079692248562014782 0.13447057862672004 -0.60332325829569411 -0.47723960079488537 -0.29030176985423356 1.1455518034852987 0.52234229991791314 -0.36400318711777901;1.0944832705542724 0.057265675097556146 -2.4772654930598681 0.18989552428952741 1.3065039231603741 -0.62768117368190735 -1.3975854017562841 -0.69766868609233568;-0.60009879960284418 -1.0406451226240385 3.1994638416399122 -0.57685971251323165 1.7534583014940062 -2.8663090528629813 0.77980252673680484 -0.9486903635622137;-0.14317433246935907 -0.34672492166277563 1.8847031024053083 0.17614648488793033 -1.4777392569713024 0.64958992931480475 -0.22887991637257943 1.1893885063197471;0.32556124626369348 -0.0099338145459921812 0.10028080177542419 -0.22302388057664516 2.6116647210326045 -1.2122359707273571 1.0160364307482905 -0.4683410695805974;-0.23177339104438385 -0.022044867000346385 -0.086264003447523566 0.23691211558750755 -0.53737604766582026 -2.9362512439632109 -1.0773211718062137 0.44199665816426303;0.7340007636596253 0.31273063579390842 0.97916774145085406 0.08799806777447465 -2.7433426364251883 1.4401687071242704 -0.45002775069536866 0.21168860129981393;1.4649926962793014 -0.15737566263272165 -2.0859014976013777 0.24399044157706967 0.42759849945486977 -1.5092561919477578 -0.054009081207221095 -0.30418791656536653;-1.5233378696785165 -0.36709569869830938 2.6934333735510965 -1.389572677346431 0.080986175407011446 0.78133075959814213 -0.562850998881544 0.23987164517596671;0.034022315575544936 -0.12543653008875777 0.13705161051188372 -0.85449711040677323 -5.3949452775318472 3.9072641244412676 1.3946488233112384 -1.9723762126869537;-0.050470769456600034 0.1702963374338721 -0.0011368295149648668 -0.46935427086060078 -0.14934156780288005 -0.012330271385184071 0.68813813212797192 0.25126336412765504;-0.46061663566118605 0.54807036572949697 0.42267753404851754 -0.54190865955114076 -2.2899998354546733 -0.38889077195170429 1.3582081338036573 -2.6982880778982654;0.50178743448918262 0.86785867737563982 -0.53376647799054544 0.49352640935002018 1.7876105174702239 0.048579175552722023 0.36950743829039795 -0.17786304259046765;-0.07866980179654362 1.0980604419412114 0.52697466197359555 1.6052808458943224 0.44631764751229058 -3.7615887921541664 -2.411431665625321 2.9362885648222785;0.15511159628509524 0.43137432937012832 0.082181127464284159 -0.17485022745423182 -0.18211594157859509 0.14076639993623227 0.38977226121800451 0.60095405105830335;-0.15031324839706942 0.050332269731436681 -0.42445115148166429 -0.4867996686226122 0.050276932403599206 0.079319816713066385 -0.34753332197723669 -0.19915678452316019;-0.35669404075329586 0.88631811203987854 0.99081595047755522 0.92778063264208688 1.8859583825639146 -2.791792278403836 -1.923120976501119 3.4941253224493871;-0.42819564178739322 -0.02582252158556347 0.12014227651323724 0.31190849344669042 -4.6595524558356702 -2.9625355245614249 0.01114257973247808 0.94028847051896358;-0.27710298322492971 -0.070037991466883512 -2.5417727469431428 -0.56928680390295194 -1.4539962521319589 1.3928808205104388 0.0007314378306018535 0.028367170452374003;0.10287646768442188 0.64443821941665713 0.25927448827132132 0.5223331991986907 -0.93243999500466879 1.2418554186906621 0.5570101017352157 -0.45564012079329691;-0.015258848123692275 -0.46109481588881035 0.15178089257193253 0.61103271239689727 0.3863991904992789 0.023797547962340709 -0.41139918592505764 -0.06609899811532513;0.66986895942449154 0.6272596459034292 -0.30012639146225017 0.72513694626763359 2.760128443567436 1.050319477996716 0.91244680478497042 -0.83474687727636754;0.0073130097342290045 0.2113865723507512 -0.24203249887788619 -0.38975025669626479 1.2478530828832022 -0.68795471627466109 -0.033393746309130133 -1.0264761515294378;-0.52302201409967464 -0.60248152244963593 -1.2637504629048721 1.0996773722062485 1.0151553933292821 1.1747205095766775 1.3893753901465493 -0.21663500414181544;-0.11780663959414606 -0.072936672553741463 -0.17879526252611799 -0.2352766643672356 -0.36239659763709581 -0.28875422223969882 -0.37624028621965655 -0.15400520366869733];

% Layer 2
b2 = [-0.15560908568259058;4.6337449687508121;-0.38675973704754235;1.5232785264175208;-2.0425777808755932;-3.143693126012979;6.0482488208300209;-3.3670861749564249;4.5684510729428309;-3.393145103866285;0.58572868344689955;2.8476095315833119;-0.56437358229479706;1.195462727834528;-6.0663557600869638];
LW2_1 = [5.3805628336925935 0.74641352880237344 -1.5020508736735596 7.7301382472247289 -5.5003612429729918 1.6598498172053573 -2.0431429200327553 3.1840415066020635 1.9927510011747782 -10.499731132936951 4.9865732630579132 -0.35687107884274766 1.8817782274400006 -2.9954158879937101 -4.501463579942226 4.7016377449652555 -2.9596307765853584 0.42514021816984565 -6.0791445554790604 -2.8303040814579234 -4.923168547195699 4.4855007360456671 -0.52144922133960137 0.93834196444353024 6.3470079370021333;4.7281953344924164 0.69249269209537367 2.1611884292724133 5.1246632064004354 -0.64419996172121419 7.1370446983017466 5.169318599882013 3.0269418090701006 2.4780984970450057 1.7424387302462259 -3.2592792490369655 -3.8307261905203625 5.3976328589516838 -2.063256000826291 -3.2057038668329829 4.8065652827906202 2.5601172162097572 -0.4466416757216457 -0.0062585605178196177 1.2038344123596807 -7.3665668020982578 -5.0591014658647726 -2.776081628873412 12.08310165529598 9.291900142552814;-3.5971658810123288 0.32522686047016358 1.537177815528509 -1.2745766901034947 -0.92357089417511595 1.0240203369133583 1.906731913568886 1.0623946478658626 -0.091755019877334226 2.7832471404145389 0.7385228961283582 0.28081310827561612 1.4829801312888942 0.071529132277268523 0.7744906390353935 2.9947015542542523 -0.20322516922504694 1.2334245974423095 2.5408956475423663 1.4816678712074312 2.152144492750141 -0.26271769005313667 -2.7414110296138663 1.818162871037917 -0.32388836150438216;-1.3291122909955337 -2.8089809716605236 -0.60844945509950343 -1.9066542026814455 -2.7361378622444326 -1.2743112376440429 -0.15969581291478829 1.7873710137021437 0.21839085104522762 1.9794761864671417 1.3258472944461803 1.5588452008653833 0.9089167134331636 0.70564006322364559 4.4309901913323468 3.3529746629465502 1.1214578603347918 -1.0357507211600763 1.7879010221791423 -1.0097818283660005 6.6221667581830443 0.60713054964357216 -2.090723562452891 -2.8465389007882762 -3.644032468302107;-6.133158101537167 1.1923184215145275 0.14370335139414653 -0.091827647321328407 1.7829867876373824 0.67017882286645192 0.94014176675882433 0.38636246807470931 -0.30451322761106447 -2.1353589751215902 5.8526515447779355 -0.24514886107543726 -1.8195437589932846 -0.032131701754099407 -4.1228654809919609 12.116663028799978 -1.447396769779882 -2.5021600757097384 1.062786955937846 2.7790803918680105 -0.33741342148775505 -1.4989888492207706 0.63883169031041276 0.80820835917530953 -11.712975981019547;1.6670152891967895 0.7902884954936179 -0.11247537643187451 -0.50579627326577603 0.4651446788484917 -0.70793919496520363 0.72917161431606747 -1.9266819948079266 -2.2445175064825182 2.9742457290072939 -4.9896171882122582 0.53960034148150338 -1.0015244555845919 1.8236437154467129 5.281757057040247 -8.1559338572015143 -0.38228789493659887 -0.12739783287250195 1.1011845872439991 -1.2102626788411985 0.078373660978330012 0.46446204231333627 1.8200945408045155 -1.3230805690503755 5.717050321994547;-12.338851430277021 -1.9989644342420259 -1.4401018277387725 0.12195298534988355 4.9414223228495278 -1.2810928352962958 3.1300495230868886 -0.29784425804373255 -0.91597423542970091 5.4734741801552715 10.451422166910783 3.9468135432009106 0.97870849536447546 -0.51071583122954278 -12.435485400018539 -6.0787881959267329 9.4850276510150131 6.6766582176628182 2.2886600797492695 11.603128663178904 -12.694433636180717 -10.031979319491173 -2.3963411317769459 -2.788358971707114 7.1297988156068781;-2.3201646872415655 -0.28913620971217918 -0.77275296344568822 1.0705170365436047 -4.1846626230360222 0.81240597935449665 0.95406012395046258 0.27957272803566913 0.27922449683439382 3.6852261572914671 2.9581789262033831 0.81961939373103532 3.4252356767630459 -1.0012441645926069 -0.89211937860758794 6.2055606988246179 2.0949000701010392 -2.3380915434284586 -0.34812926934273125 -3.7392277479734406 2.1388202859867316 0.098077618115155044 -0.20020069580048813 -1.1885647337872369 -9.9411681787336317;1.0429372921370357 -0.52173271598388871 0.87332606231954357 -2.0247090611844296 0.33244944982628927 -1.9305495662086745 -0.05719654046836517 -0.27580207863565431 -0.079284774262522714 1.042520721653057 -5.0450657784579924 -0.31702147806806102 -0.12159556515705641 0.25662998959298833 2.6272237753034715 -1.5019963372716925 -0.36094090605737456 0.69212252896217141 0.14502862037089526 0.37335000873687291 -0.096922441411087301 -0.88603389042238334 1.2588851411004414 -1.5097456890257497 1.6297949078531693;0.61783039614731017 0.53720394729580534 -0.070780648383001896 -2.605404574460612 4.1352551263953305 -0.036616016192396995 -3.7472501243315306 -3.9148340554715055 -0.5622306990371817 -0.53279225001751074 -12.764940283613292 -0.10633022762916006 -4.0949421358083997 -0.54439861385877619 5.4260705933771849 -7.4151736001326292 -2.2085291339396473 -0.09303331261789867 0.75858521805529255 4.3217958598372972 -8.2138188980598343 -0.23740753573894241 -2.7191477269202693 0.6187653136165373 5.9551469273966156;2.6394124902635405 1.0699740278902989 -1.4283537326834561 1.0283690294408585 -1.2945114685789723 0.5844918782934494 -0.54032185333697524 0.152221518491064 0.83343707507717923 -2.0856677810046933 2.9044400192257682 -0.8012721557708582 1.9776485558132026 -0.082591784478653105 -12.157991909251864 -8.1057559533825341 -1.1668833350193681 1.3218140865470125 -2.3951604558159256 -0.12430565987946821 -9.4629237731315641 5.2073194512685106 -6.0609452284424137 2.113008662905099 10.827272969132459;5.5241049011824126 -2.6644896480612754 0.51503771262781417 -3.0382720404347641 -1.6950288505377538 0.82563668395750278 -0.7743048022469281 -4.129683410288898 -1.5952968478930791 -1.8006597835633402 -8.1394436187774541 -1.2743582085456098 1.8631847358264411 -1.532783046774397 3.0888915604241269 -3.3365140806210554 3.9806591491206431 0.57796978504995256 -1.6928506226241267 -0.74027890522838102 -4.626804374444788 -0.39983681225981388 3.6201207993699867 1.8036600658529749 -0.84590610659942889;-0.75491847377892829 0.93916147129414884 0.43548263651506441 2.1351194840421521 -0.30530417572500246 -0.30506201724650445 0.16215022461530887 1.5016481403069666 2.3388054645592731 1.0107095165544027 -0.15109870053326135 0.80228505180190934 -0.0027784127903626617 -0.22507120805054309 -1.8354773609831216 2.5172001237900079 0.63178748929123019 -0.11064622363661131 0.42784198488003083 -1.427296029040666 -1.5131868523937348 0.5953155885284499 -1.205228188893581 -3.6484517827781744 -6.5402331577029651;-0.84358089498331335 0.069898045211241516 0.01085637654702511 -0.41452056155951067 -0.48475324768701811 -0.0022666774743772848 0.12477655303838445 -0.34333771655194023 -0.29369481065873665 0.43428555487082687 0.2949242775318881 -0.031946617780192345 0.10903950431537256 0.14001158183952672 -1.3133751555624884 1.462047571655148 0.089871990381590022 -0.040275762504796246 0.12782226371211569 -0.33582554791200037 -0.55992488117294392 0.0030389751033902154 -0.264494465729329 -0.46377399733088531 -3.3234879299756215;-1.5418209280595692 -0.10825476427093476 0.25538043264620536 -0.34577271689470962 0.29226081052992775 -0.2837240417082757 -0.094382239930099171 1.1110201520593304 1.4692301703681339 1.4763475312055327 1.2870529203819203 0.64436544515984862 0.11613575585510549 0.35985882285313942 1.2958994897238814 4.6835012409831966 -0.13640622014134635 -5.7580847069240688 0.66274421243878456 0.023115073539509545 3.8838431922491385 -0.15679796814561986 0.054578608417066847 -1.0985284362490253 -6.3251169668514642];

% Layer 3
b3 = -0.29547854412101432;
LW3_2 = [0.039371874878479422 0.0171442274047135 -0.058553299724902884 -0.04228537049534669 0.1224912069964109 0.070883193559476365 -0.0080729677408183358 -0.052299577204008268 -0.41080265456647991 -0.098818265896243748 -0.043141020003954804 0.047942638288724325 -0.14105714117689166 1.2892073090626783 0.26367532537229232];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
