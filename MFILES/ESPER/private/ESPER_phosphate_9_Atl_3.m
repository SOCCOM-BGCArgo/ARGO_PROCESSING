function [Y,Xf,Af] = ESPER_phosphate_9_Atl_3(X,~,~)
%ESPER_PHOSPHATE_9_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_9_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3823533101590155248;-2.164152332394628786;-2.139687304631808562;1.8907853637859100004;1.4265110681400816617;0.82854846343229027195;-2.5734231457848357749;1.7686280452342730829;0.017530417137254505899;-1.4881295648111898533;1.1531117445523078047;-0.29014324800177976327;1.3522080829504288246;-0.3294942152705926941;-0.42676193309901466755;-1.5309680993676488825;1.0857535351508038612;0.026777568647357335996;-2.1587200360212888128;-1.1402830476244745217;-1.8471617865337492947;1.8759068357537624916;-1.8294510785174875611;1.8703593473825150806;1.1961241563043345515];
IW1_1 = [-1.7501051241660461333 0.29192494418382175514 -1.4053890943430282778 -0.38865787086838909925 0.059559588331028930075 0.19387306277229135465 0.072423847941792046656 0.013440068101255751506;0.081007514194270047181 1.1441120996844589275 0.25098427090208230705 -0.56775802453941282 0.32651931469714112755 -1.8623401416280616072 1.232472558341289659 0.69515868444312656216;0.77740801272529547195 1.8109337087023216206 0.47118491533302181429 -0.20070978953696741454 1.0383691522630127402 -1.3938135040906425299 -0.56789187598141543933 1.0468878406089368038;-0.62083402368512907721 -1.5471900388704584728 -0.0083245118286362877746 -0.58557793914935230006 -0.56142698084611997178 0.39941623059112646432 2.539949702436083534 -0.20550622636855048198;-1.6500979643359978688 0.18169576769349540801 -1.8114590759944884102 -0.29034342627635123524 1.1049803802860229673 0.70419653658770553495 0.16818840539830517966 -0.546765040889148346;-0.67739509393374641721 -0.8669421017967424703 -2.2672593829080791572 -0.080739491666962287519 0.40837345928645074622 1.3249786454072722819 0.32529726989287977013 -0.29995256327062275181;0.35772120995858630588 1.2417334473735670564 -2.2662034059447342393 -0.51561699224857715507 4.7409675933104207246 -1.6341089491944746914 1.8530358945667864123 -0.19178572330851650918;-0.41576780548486058642 0.034555221886800428777 0.65142159170837043991 -0.051584351356025265334 -2.6593267658818744437 1.8223978698868874559 -0.50152205937120564183 -0.31617011704267261596;0.36088776909475445143 -0.76239735042047196423 -0.34166616857825016229 -0.24387685766238278995 -3.0076023324347915811 -1.4548796669933967696 0.90496455589542845743 -1.0454477791174541235;0.511505589829022278 -2.8033694610701740402 -2.095951699401426005 -0.2691005297798842455 -1.3708908061458058292 -1.60096065600544879 1.7267579272236448507 0.97608224967505197167;-0.25367528680091849802 -0.70311639675989312526 0.60623472940709188794 0.50123025408166177463 -0.19828911618795860838 1.6941094610558087297 -1.7284980246711474372 0.60921969922900043315;0.81721196287727282392 -0.69689232284820679109 -0.019102304437124038861 -0.1783698853153029007 0.027222387381755603492 0.45952646008651293341 -0.51976157223508212546 1.0693456525093714138;-0.66793647736456929209 -0.23589708448518267869 -1.3097582374879326306 -0.043345491586384128635 -3.0542277980308658591 -0.55146409882266023139 0.58674484781666880195 0.0019535507765774625701;0.081393405705317140031 0.18803196946333791684 -1.0941210484109280543 0.12543263192574488629 0.56923524446618434247 -0.8252996537073872263 0.67274799846507671308 0.084266867863144648276;1.4674863423187047839 -0.26765459901015209443 -0.89239883541636366715 -0.52259761052943298765 1.6009581775384849056 0.72686820530556361941 -1.5443727121508505906 -1.7914074638573280751;0.073643517296404434336 0.36896146041351080003 -0.44819414534147306028 -1.3931927566649036088 -1.4538431425391882268 -0.97693527395124601931 -0.43776337365705747517 -0.010158648044588103332;1.6281005192032098616 0.46838785818926192972 1.9132504578178675114 -0.05264661837046160503 0.94530030612703819237 -0.083153833317465467023 -0.0091218661733433493988 0.92206845671190651448;-1.030297554278225558 0.43931747120186659394 0.90524063332222670653 -0.60269045671316012758 -0.30258196053697922201 0.16124161004516190943 -0.079288504715207208662 -0.92282896929240609829;0.04522509367843790401 -0.41062139831093802389 -1.5688551539361439424 -0.44174466583839128164 1.4865670389711140853 -0.89517787708370177846 0.13757519009975288649 -0.37869816217867818819;0.017777306270897300783 -0.86149397233160562859 1.6247434206043716021 0.07135491512699479455 -2.0561958761283922748 -1.6241210262721019753 0.96834840991541792921 -0.62043108328502760695;-1.0726780357812120137 0.14061546555953757798 0.24695171770921398036 0.40375244374812613302 -0.95403211528090714477 -1.4861848162977568943 0.35075705896577563658 0.89655389834506005187;0.55606919670685661661 1.2557293095226618185 -1.7312460564930374218 0.67830076925855342651 3.0414287139008537864 0.27898536495992626305 -0.7301143385991781809 1.0971665241790777845;-0.84561497346148484233 -0.20209081150364247015 -0.61042600393140078463 0.15235497899396624466 1.837072744452917572 0.73404110080930862203 -0.40394395557310930345 -0.039813067744419214367;-0.028984169640970405823 -2.1737790483252554807 2.9350720428199057466 0.18459894805050808264 0.71826288855547515411 -1.2285663892240954453 0.40112211514912543553 0.81519381825627934557;1.0029359574196565763 0.36115148642264527368 1.1819871491074889214 0.78539646332852008914 1.0929133585057497768 -0.91357594116498208603 0.26982137681170326182 0.98952168143896135355];

% Layer 2
b2 = [-1.7827989496385971968;0.91863270704514210507;1.9502008130345265258;-0.60997364289505473511;1.3141815275860748713;-0.40804191325518829325;0.69399041185246268526;-0.44369427424394031201;-0.89470644982280556068;1.0297413332795355423;0.61151843985239895396;1.3088029768290034838;-1.4939661254309208882;1.4435695407710262828;1.5522233345945890548];
LW2_1 = [-0.72766322713318987159 -1.4055994350243556923 0.38112147300075371881 -0.80291518725108335097 0.688991687245564699 -0.064248448702311611314 -1.8556179489127220261 0.44296914263680009505 0.65222437605048710907 -0.79052291740056401803 -1.5347685830473540847 0.026343329457248137321 -0.83334316563543542333 -0.89891733818356767127 -0.33688011272954265785 -1.8307841887259745928 0.27896385097561460231 0.56242644136428054935 2.1783217779178838391 1.4708955954830749135 0.50153267444105509298 1.3107071511039678491 0.69951690624653251049 -0.25159584272229562618 -2.5451033844571164799;0.59893751969833419757 0.87078463800833527664 -0.25384138305135151015 -0.098754992790291484805 -0.5613752228896516927 -0.45612202345069446929 0.28270261908936494821 0.5111812785795480929 0.75961421029488052081 0.11216924103234306165 0.3599065721699928333 0.56322874225157903982 1.4106925833379999613 0.028626580126722169645 0.52900186128746573555 -0.48494914219787743637 -0.84467744467408922837 -0.68230317206225821192 -0.82108022780363176807 -0.44458978501999552035 0.091249821904349770474 0.48184586706537002598 0.056617983686672944399 -0.32199913947049468854 1.823483050779000969;-1.2638077816425012934 -0.23612192801060946645 -0.25280051800387537408 -0.30343733999691419045 1.4457984423306056154 0.068634325493909728588 -0.57270277631342847435 -1.1774331523500236596 0.71057394880079582933 -0.16812551672991224438 -0.6304943207903019875 0.92869441512313655185 1.6921736288346036492 0.8469553304714958486 -0.3151528297734796924 0.36002416776498902262 0.086911370006728980164 0.89297812556704991849 -0.25436776083630568968 -1.3838675799686048773 -0.42224064667261934636 0.32189492413280629268 -0.821495028439029773 -0.96926517788180099888 0.51720699681932780223;0.3827726129166603708 0.37326094453876290657 -0.48083967805862387612 -0.6171863089757275711 0.03605780266887264468 -0.13401828436804552602 0.37956574538415360776 0.13754796237715224971 1.1982187428716706279 0.082546784663446698405 -0.23280599942050461681 0.0068646330476939843718 0.28656259554915386456 -1.0364006333084447853 0.38108391249461903705 -0.65149320745224614804 -0.25065817593486133807 -0.97724337498744295871 -1.3224940489305816449 0.010254263113144342426 0.28938491662317600284 1.1299896154435793427 0.34880048865975210592 -0.19802656492041004199 -0.074910038074948281928;0.72938926746308874183 0.15060767610919881254 0.28570046295367568234 0.010982948196016244224 -0.32215465927054509621 0.7059210092546326365 -0.42757208312546030049 -0.39516700984622443737 -0.8095019028259007321 -0.37556519465736010188 -0.95142457136788616268 0.66503158720664634629 0.16092956475254951987 0.3474539127907131375 0.27938364063484677491 -1.4887621229330048056 0.5176317076596691491 0.36795914289621478588 0.16827679505839818197 0.004968782294275340787 -0.25939483495160897686 0.87705960689373252404 -0.15141320605350994111 0.16618592292520570353 -2.1519664442657324699;0.33127369279885615638 0.37645598088443466001 -0.234003650986720102 -0.13538602325147786054 -0.30455790701175827762 0.84125379153524026954 -0.070256232133690282859 0.33176334998910028684 -0.44638616650535478669 0.11991081336911482702 -0.72711851105845271004 -0.84948549096461622998 -1.7987864091827705515 -0.96627635177685067269 -0.048918839081745352226 0.63069752485359076299 0.20515964937985384231 0.21973508768471741726 0.94774738230274369055 0.61904905875376725621 -0.14597516473016697303 0.17083476194343172327 -0.11869647305962829908 -0.14085255155388376469 -1.4023518317143304213;0.39576189999832711575 1.8799778798793935763 -1.0793126747887862305 -0.23461512472147819097 -0.74185120210771060556 -0.41669123106312094817 0.28248094263429118778 0.026278707042617876349 -0.15362306870504874312 0.13559745103342421557 -0.13263173650823334437 -0.42697311028261364374 -1.5615377512450254738 -0.30783920452382085298 0.23443109260429642604 -0.86176271951146921069 0.24283968346093481872 0.36102081080985015671 -0.15443031025968528835 0.11281123611720840494 0.15848200757236577396 -0.17664980238015279279 0.71250777921133767734 -0.26229245092424630093 -1.1277618970557161671;-1.3764249767491829601 -1.1324202862847336792 0.45215170964201156778 -0.42679129500995505175 0.42496597965878574188 1.0776721114273861701 -0.31571320599850488664 -0.43261327492605711198 0.11017347744555612554 -0.32424863906488388121 -0.24103876600075666015 -0.38387793007210074814 0.65201799497427503916 -0.26339074138811346959 -0.46631854401228628459 0.7623563512705809897 0.37391251593708896284 -0.36452089509068585915 0.97541103873377976718 0.3049379895701133103 -0.10016318042643343467 0.091275281241188041537 -0.061173729111105377976 0.39928915182367147318 -0.16164285726548832667;-0.50691585900869484682 -1.280979392506546688 0.44456793786240028643 -0.44307007459998237753 0.40788964160096680134 0.53243510736873511657 -0.26219810260120479661 -0.64190194954875345879 0.041365793499129895061 -0.2223420611384273049 -0.65285054092894134747 -0.5377410747127652213 0.40688347251205869703 -1.2299473487018419693 -0.093043705621045857956 0.79189671059264821196 0.18854444487671434549 -0.81813686285822107003 1.1247292821346044356 0.3243738182279845006 -0.2791016998692026907 -0.078278574567888864477 0.57609000190146220088 0.45257558459294316977 0.010095481510764095848;-0.22858962647248995403 0.37141665178961369431 0.098683969423161502221 0.61464947461891783487 -0.00036529547349216693426 -0.10596682867161258401 -0.42246555171912508753 -0.30368237115214824495 -1.5567651204724777259 0.4854598652574759754 0.17977569251114536297 -0.11909550798069455657 -1.0562280729220550057 1.4198101485574659009 -0.69017863122525480168 0.36920700697191738415 0.036394302266328275308 1.4034059617007970111 0.96714938423090168751 -0.32203019996942516823 -1.1276825892652757588 -1.8959081390142920043 0.46542424778270297114 0.1066256358162463308 0.31862500439514035433;0.09255452170888807395 0.30740924153863080637 0.66714720290254592161 0.94193585600756435383 0.99604237282506946638 -1.2838774267689934128 0.096642382896502329603 -0.70482242259794258832 0.18934787790409349229 0.31610429065357686929 -0.017939260392633771257 -0.48864334867832287523 -0.61060120151888375162 -1.6154292344176846008 0.05340341913804773355 -0.46255047834737078594 -0.3500211626744214044 -0.64441539438158301767 -0.5010933613511839857 -0.63802971815725206817 -0.14179974253717303467 -0.60847979815635711009 0.97847450847753780767 -0.30575101886339162149 0.10897560760585045525;0.029534366606993062848 -0.87852387963782296865 0.38025480656638283028 -0.34159394818854810216 -0.17713473794326728417 -0.40764773810688520461 0.029378896437477246967 0.41625554023978528217 0.43052392333982608674 -0.084679292024472455069 0.42820622850040979124 1.2955304655092059196 0.94549652212241774851 1.2066865551373728849 0.34864313948716424418 -0.68100482196261191703 -0.8666210176929322051 1.3507394537487715791 -0.03119785554228542146 0.76615181070139848352 -0.88269828513128589798 0.45905069230995221297 1.3970885623827453692 0.22413364576588412636 1.5293804042997807269;-0.6354387801293189808 -0.60592134355585458572 0.34673830956998152875 0.001548302931106020075 0.48233882513841991324 -1.0562473536445224909 -0.61404405168415554517 0.27340251722506714316 0.70429461113349978163 0.39376679602029956984 0.88037053281114718839 0.62553184181481202852 -0.032323965246152427944 2.1195616410633069115 -0.080362756286715145149 1.1144213163284166779 0.95679402797180734819 1.9925636876035102141 -1.2412959417481979063 0.79971584216781377297 1.191675529971996772 -0.38276067035600774835 1.0445529241773843232 -0.091486565515621509626 -0.20873920752229591091;0.22799215069657530197 0.34819521745442366667 0.21707238244371707125 0.28671501364748563923 -0.49271454075659887328 0.84103201323689547042 -0.23798982009854649511 0.023741526438588886339 0.43690839280282461887 0.1608751828862857447 -0.065872559387007145748 -0.037924400466978702706 0.90800076482592451121 -1.4616653888498627456 -0.2950751817363395646 0.95745525350036353451 -0.97552451265165796013 -0.73244976106823567186 0.062935036622017007102 -0.7491320971677366547 -0.24668925369266828107 -0.18566803659202868459 -0.87884786847104889862 -0.19024302896845446398 0.9343676862263933236;0.17095326477005196031 0.67010360118776557403 -0.46451336338008791804 -0.035539229277693019926 0.23432937510101642387 -0.38800160471637085147 0.31114905993700781028 0.47024303023950447811 -0.64583482710230966095 0.69099662165977526751 -0.5590977993202052021 -0.054866139862872351229 -0.36246280226326133 -1.284506931513904382 0.77204565858837026493 -0.12141649422183430074 -0.94433841391925865683 -0.33445413716858779507 -0.25433026732795488423 -0.27397148195241760593 0.7495376551500688711 -0.13660835333105331157 -0.082195001965323893911 -0.16517019598860768759 1.0823670636174658188];

% Layer 3
b3 = 0.6951226127970183688;
LW3_2 = [-1.2078210199130952063 -0.97280588073907725555 -0.43704017304240400099 1.1703251241870653576 2.9501039662568322441 -1.2127434418405227401 0.94051119077420541892 -2.7546982152964987201 1.5971242242732441863 0.68917841095705378862 -1.3471847198933719625 -0.97294226125002969408 2.9766435248130433955 0.94535664970346844349 -1.5845358420410895484];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
