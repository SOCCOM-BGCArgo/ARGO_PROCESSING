function [Y,Xf,Af] = ESPER_pH_13_Atl_1(X,~,~)
%ESPER_PH_13_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_13_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6373674155405621988;-3.2256812889037940195;-2.5171605903419158601;0.64214238197018569387;-0.6018144446135931247;-0.96107355191177956666;-1.979581266499323311;2.8946669031503731162;1.1946133036048167675;0.8007289563975985569;2.1286610186566443659;1.2554692715533732894;-0.70975553928697776573;-1.201452121767527359;-0.94381720581702632789;1.4841060873073497195;-0.71325077769429501284;-0.31520555687151696755;-1.1422639255409676728;0.2798232317226505006;0.83635371028889060607;0.41092745565726224166;0.58782621748995433908;-1.7966636082953006959;-0.93436022537159701962;0.45126141591369506312;0.59343496878334711653;0.9325824148357743093;-0.63944865998875144442;0.70609023249031099834;1.159572710484009006;-2.2901050340827771024;1.8245344223981829757;-1.348643238838706182;2.316841596342833931;1.1404986766965601319;-2.5274345097276298411;-3.9823933416049710488;1.6503089004132520667;-3.0229469319315653841];
IW1_1 = [-2.4822471776195262905 -1.2644244869323770786 -1.0307015540830979372 -0.59480891615238795644 1.1936542444776534477 -1.3245396657898191872 1.3220263754186789562;0.78023379877325327314 -0.66678225743958663418 -1.457910963917629088 0.28396479524441747833 2.4115287753425285189 0.56975222428245075879 -0.5663008677920892131;1.6965045906080071791 -0.17190524538974069624 -0.75081461851972508548 -0.16551852231992100761 -1.0499198382792980233 -0.43329017864236374358 0.054448280721565898987;-0.93547941691778935258 0.13451870809035637588 1.9440130748812871619 0.21615692805121303199 -2.337682407766127568 -1.2142436591001923851 1.7562356772815783668;0.762498598081346457 0.14310368697316394604 -2.9392170432937541058 -0.21661926974463324713 2.8678039141335083251 0.66533820859378012269 -2.1288304998759564057;-0.4584305495248380824 -0.62947948082829086047 3.8191361294521852798 -1.3545949573389521881 -1.1254408811276412905 1.0438227494610026191 -1.6034288189502281519;1.5650845038142797705 -0.69399769984625281349 0.79767797144142327248 0.10437216918905280194 0.27277246147878259075 -0.10531594962069724952 -0.43384078569920364599;-0.29170251805677233081 -0.62882406585498340501 -0.52075111101016180459 -0.71837657342160765594 -1.6293212206961833477 0.60532678173358278606 -1.1601156127624707715;-0.18338329469962982854 -0.71828932072193352187 -1.0291903762273393319 0.068400340637098294705 0.93331801604943875894 2.1115500845910775141 -0.38247039725635517682;1.4126582220053855998 -0.48285373139951748289 0.12151046170284707237 -1.0397450325122894466 0.042083786579523795035 -1.8519442275801270004 -0.22000858792080568715;-0.12780556500707695999 1.2734606578094072038 0.097241063462331481237 0.3915117863153587674 -1.23400156634806768 0.051041508663186754835 -0.22217355215282491576;-0.3261520305005334297 -0.98488373364588699399 -0.75302489663424621025 -0.35116952585067695569 -1.8686257519949354133 -0.8448926406908171538 -0.69110327913301683456;-0.36911566723838024062 0.63819979388028258427 0.76407088012684765133 -0.71110546095996707283 1.3363893199358611863 -1.7673443497396290613 1.072853824780181764;1.028297552335842413 1.36421352705298915 0.9953622737275423793 0.52609113053185363462 1.9693208859206186023 1.0610764271523751567 0.56840433740230034143;0.1833090934982296305 0.46205362041634756576 0.77674908008666143644 1.0728601947761700064 -1.3648169916579107053 -0.83310937240121607505 -0.43345168703870429194;1.6647801104546258166 -0.80790292208094960369 -2.8087837352136610924 -0.037296067732664167638 2.789421851297923638 0.63329148415546598905 0.82366946609054580986;0.6559191679049755086 -0.62951432764871362302 0.02606110678562087446 1.8573177615513416505 -0.23281794451998363837 -0.84211596424510726244 0.56899619301061066245;0.73797599489204723788 1.7855006362844574319 -1.4898236388657353224 0.16905259482676507354 -0.89295323279243610237 -0.59669623009742156494 1.1361009301362390289;-0.39405596918208374291 -0.20338013120057885086 0.95966830711150774569 -0.2356093309776985667 1.9912954337790946813 1.1428144969478502002 -0.55836981152675346785;1.3298877697291617839 1.6285399094263917075 0.74533534511182775173 0.58020635257570307708 -0.14013208453120826191 0.65037710251642621984 0.6350219779562149558;-0.30586605769189334492 -0.078786455576093372688 -2.5266778704810528566 0.66614286602168615303 -1.2388311472529727197 0.83860380927869471179 -0.012196246493782704826;-0.67330334046487472222 0.6915123292010906253 0.27146115088457600795 0.34443426781297870054 1.2572054528519003291 1.2413710464603329164 -0.90282615082196848721;0.37053018837397627694 1.2894478284961941039 -1.1852065434216045858 0.48845255979375318267 3.1079240913508581201 -0.41256799167687330243 -1.6223318944724640644;-1.2212299903347991759 0.85302445217912437059 -0.20994216696558956614 -0.86007277743822851956 2.5845687798459180406 -0.29195394385813810967 -0.97324716466562655182;-0.97761878382695532874 0.21126111467922861764 -0.90256583962269887333 0.51860386852916773304 -0.7487345346605623897 -1.9178374666445159313 1.5184622124063127391;-0.36826568876671472719 -0.45604038943702795983 0.53618874725598009157 -0.74312196390182994055 -3.1083068434816230052 0.74319315444899436418 0.58300740677111306809;0.55745722942280251377 0.51014788442701497484 -0.64676767848276384143 0.52620761694031181754 1.5952811834628286558 -0.88616396538305253205 -0.47434564837619558331;1.6341774969127236261 -1.8377809612448345877 0.15338366074025036601 -0.17579583413497118505 0.80618789400384283095 0.55053031777921568324 1.8236463529954798357;-0.35711172358964782259 0.14579463156268260282 -1.430938408160538744 0.27223878439240356553 1.2969583613336601591 1.2996315644700568992 -0.83554736548531371998;-0.19277207516215108529 -0.2649606143008804704 -1.2883672406394055532 -0.24429395740592491082 1.9213156893584431018 2.6053894443601990361 -0.80751527151443835972;0.64853761944813081985 1.026533773951897377 1.5831050328546611983 -0.17724246322238379481 0.80057813830365254226 1.8399116853920221004 1.5422724754039336403;-0.69624283451439283876 -0.70989348723009826347 3.1799857883244802004 0.58578498570502546272 1.058652381329564518 -0.19974063903855981961 1.0854225808811488463;0.68851145760782161975 -0.063168457675222666747 -0.27133912502466994709 1.6977182657701745949 4.3310067149931583685 1.1502142969416162543 0.0044698219264454573663;-1.9329261881445376492 -1.9424525820056874892 0.32221805129533143131 -0.79866544986115106664 0.1553464402656512533 -1.9530570349179359191 -0.056844110624126059639;0.34342501261403413082 -0.3731061163019489535 0.2355433180290245343 0.51682072363803377435 0.45793370954272233364 -0.886212447179322238 2.752296963684136788;0.94410264859221537659 -0.33396713356707269371 0.62632881764491299403 -0.69565694963757818137 -0.22770356236528277449 2.0116106586915125654 -2.0063651135247893009;-0.45511776933084435726 -1.3117368006694125615 -0.2098255835991665319 -0.62977630254391525622 -1.8799340275937750366 -0.98904127555324583554 -0.15244405279550268806;0.40236086889074629269 -0.60468695852785347977 1.0603168105271294497 -0.23142072235150823456 -2.930844125032286307 -3.650146035540339895 0.24880278142823256116;1.7602536303147156005 0.060887445797580291851 -0.033764067201934748474 -0.14044743140106150103 0.37007177737877688939 -0.4607769721349057046 0.49900382519085972888;-1.179953009522239471 0.29403618105147338868 -0.26464665923560393157 0.64712032590957646594 2.9089029956508611896 -0.05961351171125389703 0.12649374073366673188];

% Layer 2
b2 = 0.61952359248508992451;
LW2_1 = [-0.86943308596560009427 0.74063461445948297612 -1.7012618629582707541 -0.77838736195169777599 -0.74420615026648551105 -0.11688569928237031725 -0.48568017787505252114 -2.5318865300722404044 1.7574938564103526062 0.32346571153836323198 1.6953203661517117773 0.9006081766573974523 -0.45278797589747110663 0.77087015605943376428 -1.6288131109271457575 0.3087318734097823647 -0.17330689890355077676 0.060605200605645587197 0.93458807841602875577 -0.53943067959908896913 0.31971201183962727477 -1.1490452541222979654 0.81776556900142494122 0.51627888172044611448 1.7783216306908875559 -1.3082759223335886922 -2.8073664158967837068 -0.49458969093782578774 -1.1327439914152410694 -1.5638846272134028226 0.042324338684153466061 -0.3051550828177476693 -0.57537910284710658271 0.078448374937215861746 -1.4407122440889188475 1.6148542142996138438 -1.9902854410877837132 1.1505186481608247195 3.1738139461260930219 2.5233617868150770569];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
