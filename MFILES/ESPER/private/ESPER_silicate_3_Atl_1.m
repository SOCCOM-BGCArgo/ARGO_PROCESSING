function [Y,Xf,Af] = ESPER_silicate_3_Atl_1(X,~,~)
%ESPER_SILICATE_3_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:38.
% 
% [Y] = ESPER_silicate_3_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4737118107598807804;-3.3388116020373663773;-2.9306393745035923537;1.9378107281490242197;2.1203420503689103249;2.5770698066147481597;1.8848306551920093188;2.8447351668926770252;-0.95204290329511076507;-1.7682980784387443141;2.9658480971728602427;-2.2592205384578627481;-0.7851233571025608704;1.8357911668046960063;0.6696022831931249808;-0.12261831443113434259;-1.5303579108911260498;-1.4039550813936054752;-1.0199853198725774561;-2.1895139838489585671;1.2343828960906793046;1.3266809321566954694;-0.19748094189322773495;-0.092632712197163152856;1.3434449854643890632;0.94831298731872182284;5.6768160536333311939;-0.56807517355394465675;-1.2515996105458884191;-1.8215998095873418006;2.0050083359229291524;-1.3759793853097457283;3.998811499298624561;1.8504608547477807701;-0.21689664734462543727;3.0441382756504720142;2.4581854446226665267;-0.81287838742980333961;0.97711516610877491296;-3.3087045530909713342];
IW1_1 = [-1.1266862340921304231 0.53153222673900635264 -1.1354515592461820184 1.081541822855158097 -0.37719547814039916522 -1.0600225993264840163 -0.38238067507562922831 1.627709909088298712;0.45018240197850178941 -0.94049851573623510781 0.70450146185815243349 -0.41135291084865011069 -0.5740529451532737637 -2.8169131289241762239 1.2816200918802613806 1.2741615968947748172;0.79539309812751790574 4.2225013762145273688 -1.587008324371023571 -0.26772390944318102957 -1.4640842188578857552 0.65324517579148055901 0.85917946442307957522 0.70678199841083122479;-0.37029051132025259108 0.20071898007526023378 0.73121320212528562177 -0.08242496885734790224 -0.040280818559256720279 0.67417567460889493702 -0.6269832587381727329 -0.7991990909190851422;-0.27878808935979326744 -1.1763882409074248869 -0.90678307685287085071 0.59276913639191397554 -2.1896704409771552413 -1.3729134283909785186 -1.7534091452078222062 -0.76614046002644653477;-0.094660458746851292022 -0.32730335130018600731 0.34970752626394596696 0.0010810184371953350524 -1.7117461138435077217 1.1228279730712107387 -0.77674267208323932721 -0.87475296560465842788;-0.16442187319205242568 0.23179552552218449235 0.84196523800540645777 -0.54567079001625296009 -1.690599951553889202 0.53795119375362099312 -1.0461545973948924715 -1.366356395179229688;-1.0081319168868063674 -0.35647009897584458482 -0.91303393997840975871 1.7994389818697396066 -0.73917089828271298479 -0.060705039473622032786 -2.0016235418346757235 1.9009623060025195862;-0.19521703775459284258 0.014212569563693842889 0.014272714653849183711 0.057969105864932091166 0.72205851441308088745 -0.7723089777472892381 0.51561803014270068957 0.62944643974219538496;0.40032128540056238775 -0.37526507080191806587 -1.0222312635993409113 0.33024826362050235806 -1.2489049365206719155 -1.815024903546760271 0.45139032031752901464 1.0519419903949718265;-2.0825409939081565014 0.95680979422086021025 -0.073569919673620226552 -0.45074831464361564404 3.0073238933748203117 2.6131664195158212927 -1.0714189691945306127 -0.40105702997685688249;0.2485382142662603544 -0.10961080065200032307 -0.9729167689967045396 0.31927740192876802316 -0.92196876101493263622 -3.2271610906983014821 0.75744320587987801208 0.47660033335113055619;2.4567242346130053754 0.10716461444280349358 -1.2264037179990519011 0.50046991188319678301 0.52483181821003777046 -0.08874800230594379058 -1.1384238218932984932 -0.7986373398199169138;-0.64051583095515429722 0.68360810877668909402 0.44076055032613870033 -1.9191538525539511006 -1.3555969825792595351 0.99932609378358261409 -0.12711775855981166661 1.6281445266689082985;0.65571023440283460193 -0.48783599262649463002 0.12427732808767828765 -0.029499650650979855615 0.32283124590549172606 -0.36225862900088878771 1.157741414285665682 0.51408476346974107951;0.2162342084934407993 -0.060984693153887721551 0.26677852027800741386 -1.3788906575122781284 1.4063135687234944449 1.5570058885779198832 0.23407671234934113169 -1.4632518674985666163;-0.41955813519438411863 1.3357766553263337173 -0.70317951572548653694 0.81004920019035031586 0.71682318774861208954 1.2666837587398074305 -1.4478780632131265094 -1.7890558846654616154;0.10325169719878801722 1.0352863433110188751 -1.0579817342173214456 1.8038558600717038427 1.418055656148553112 -1.9553563431689955365 2.559873882627687891 -0.80030078968292295283;-0.23447255311830195179 -0.14864403153210120623 0.62593913220655728047 0.055400782129150408228 0.72533468705407411203 -0.94043483879646150303 1.0924915902628664632 0.37683158859601006974;0.71728872585840308673 -0.72612674442910052353 1.1874851940362651792 1.1228916282587217967 1.5115657748494464307 -0.74233301405844887011 -0.34707482728707117481 -2.0776703075404259202;-0.0047969768721779215692 -0.058774650256842968232 -0.20214085524454006304 -1.1810884481463614915 1.4865419755975013416 3.0585266976046954213 -1.11080292177237272 -0.68766563726475760099;-0.45972681018058392244 -0.69632722236664301718 0.34580896395186777603 3.5610082867461119172 -0.049726927984330093757 -0.27317565495962320421 4.0530242099700215519 -0.52324195393393169162;-0.21535341139823552248 -0.079384792341348237033 -0.094494342696076955024 -0.31811292257396572847 -0.57584312267119808215 -0.32565695099461772211 0.73615125210573428838 0.57591249103299568812;-0.64830178114078507168 0.43490175327074875877 -0.91779186769179876837 0.31121207243979676083 2.0254045575223371678 -1.0566203183990334757 -0.58485954381177784889 1.8464797094150007251;-0.036872161464772873485 0.1079978578332713296 0.85325570397617345186 -0.28556545790582371636 -1.084544754737777339 0.051224460587088072039 -1.04610323575321984 -1.3977418874598452891;0.23595966949166083393 0.19230763018703553313 -0.5850893708575913843 0.53991886830172364231 0.049405377705311157022 0.59356969630168721075 -1.2678867394215296294 -0.34911674189576469285;1.392603693086583716 -0.19148904774993605327 1.7759089188212466848 0.14490282396776837937 -0.49758762572722586848 6.2653631866904557768 1.3492778953601824998 -1.0179942699251534055;-0.31971954194520452175 -0.96759055579908148648 0.46614851359264714015 -0.96329190487374927176 -0.6806657579304966621 -0.97270773265065302304 -0.44522033157648160939 -0.63341540672878493545;-0.39153310837421484436 -0.53465798137395570411 0.90751619509141068232 -0.53400581765183807725 0.90269744718743061274 -0.074615678568535223625 0.9748080026540215659 0.29794873285425221843;-0.77314466279458970988 0.044124186357598099706 4.0229408434148998808 0.054009932238610544597 -0.38760784538281717326 2.2803241709355965838 2.5245441594188791079 0.56266215213362480441;1.0039486446427261512 0.17877396187743005429 0.86049339301669836022 -0.80829948517307037559 1.3581087171515207057 2.2121735466071696941 -2.1469741635444679062 0.79141079449012430302;-0.3643069724715951585 0.37818585669705495622 -0.013323138669418477242 3.1353405540278864727 1.2474415172632431492 -1.2526183459051822844 1.0274207539607465023 -3.28345399592764009;0.87884249687876825341 -0.012430191148770324341 1.3729132613555126152 -0.20615585210138556715 -0.43429652038860744323 4.0862572085403243705 0.48280168008931440005 -0.47135728296233264656;0.16129508022606564577 0.71533404410495937675 0.40680695459990023899 -0.96353152441601019884 0.9288322753023674494 -1.8016717451700998698 -1.6528794184299757664 -0.41917478057634477429;-1.9636354398480850847 0.92138234450718847768 1.3228547156750505298 0.9347404551568631037 2.2167103276258699474 1.8643653057010169949 0.67581376168409912353 2.2968343521692764497;0.5974384336060094558 0.43149416405036522537 -1.411033361418264187 1.3759239822164359701 0.94253482351509176862 -1.0329577102741642758 0.44224003976912512615 -0.75078250896760267974;0.3598022038551481061 0.085761266472417815865 0.62944112431947862873 -0.78761481574254743609 1.0620720521417672533 1.9130718713435723721 -2.3568144943517053136 0.20918850270978883721;-0.45213402904026239737 -0.82447143215708895703 0.87870565784819254507 0.1835526066514204524 1.0269819706961096362 -0.16563892435418756111 0.97669347959632923928 0.16306101853261323331;0.88378544604500175463 -0.30179902349295861796 1.0568946294855012802 -1.3400909810198857741 1.0155212053812643358 0.040300071533624172437 3.3820443387476331054 1.7355605436724188539;-0.97500820337535099025 -0.12487599838910494465 -2.1521509045197162457 0.67271878757186109876 0.22500603634378871232 -3.2351034669379203912 -1.4461631705969062445 0.43071554385434346335];

% Layer 2
b2 = 0.99298857684596897322;
LW2_1 = [-0.25953474821994987343 0.10265250235875554574 1.0338555152765513956 2.3620056164424036993 0.1258599675243876892 -0.80472747227125684955 -1.3275055744376003108 0.10873905685445967029 -2.4440511888498752668 1.8027972300582846277 -0.18651123605845693065 -0.96870323938152025356 0.06884687502952657745 -0.14924618742003703531 -0.40377414757683094404 0.44817597763567879054 -0.05580517089561232158 0.0971224350069654907 1.4937102317345329894 0.14397543616736979688 -0.41450822173929763315 -0.035865644309829809722 2.7538750246598207028 0.31155994013695975653 1.3422560630660604897 1.7237767316933267914 0.74752959263819773739 -0.23546618184966636167 1.0285169000325840027 0.2222707163869817315 0.60257308134581555326 -0.073459633805828358777 -2.3983328212765107068 -0.87180554390386089114 -0.038347541918426542029 1.4532536439096896963 -0.96995877023068932665 -0.72384856027076860396 0.057028998519021080471 -0.67259809760469413398];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
