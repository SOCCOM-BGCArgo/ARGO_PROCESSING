function [Y,Xf,Af] = ESPER_TA_7_Atl_2(X,~,~)
%ESPER_TA_7_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_7_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4676593434699265472;2.7599952027304839319;-0.79332006687988854132;-0.62682832970597324174;0.81351239427988975006;-1.0930590064761256386;-0.92038209552932626067;-2.3316136564621205984;0.18300239081998478929;-1.3399695214457734149;0.34192078783262591646;-0.045782950653071655123;1.1815361870946234912;-0.47557035564992605758;-1.115210453863670903;-1.2902560515593577417;-0.57053667779477557076;-1.7919285570469545288;1.3158831775423467381;-2.7100435897134933505];
IW1_1 = [0.63025987456597309944 0.13596300149904297361 0.45825292309577247973 -0.10253203361594301346 1.0892141955440861611 -1.1414903230503983256 0.55628442476492967472;-2.7596500414657372247 -0.82534895602242408508 0.20593532565987143768 0.31220257109270416196 1.6713824938400683173 -0.18806444864951271656 -0.028973737577212041461;1.0234249160847237459 1.2211554408815821215 0.30866112161833125782 1.3319904002259732589 -1.4016915655765689319 2.0505119808930709624 0.29747137780640603433;1.0718562033483540752 -0.72122207906468704941 1.6689512862067950039 0.0039999526833205435727 -2.3392499159194457548 0.34483491224944579079 -0.2144505325022952047;-0.062716422740982061268 -1.3619969653316894576 0.73424286878651379151 -0.0042762037716831853562 2.2719989863567109367 0.90702860475243229921 -0.23228973841970521064;1.6652954563303505875 -0.87947319648341371057 -0.13008010060387140139 0.57600017846447248981 -3.4529514389980078271 -0.3089471948420054459 -0.62396490584235730914;0.61407526245359267403 0.72087647684903799483 -0.089134426993252746652 0.09148435030795230849 3.1540548028967227978 -0.73333197279735173879 -0.059407037139091747879;0.49317166761209108028 -0.11978156159711485229 -0.52371419068678559672 0.31870171336211067237 2.2867272406285650277 -0.33726526016095736971 0.21930387112090851676;-2.1786149970217865146 0.8990860040417447685 1.3720432235208002147 -0.053316111760220746829 0.77845224852351557754 -1.2770160372839485241 0.6547564297591750293;0.21054104300639642222 -1.1964423621524757912 -2.1396785345431266201 0.22443544574472648612 1.2734559711536785898 0.60954713186102538192 -0.95500679216322703624;-0.34304555033282946308 1.2639006905590908225 -0.17415170510603825149 -0.62172408103368848042 -0.054032181231862999593 0.69386742878068397022 -0.32151660422766642489;-0.65993015982056923985 1.6129544910275539493 1.478117739197512881 -0.48308804575025282579 0.58333783987862763976 0.73717785793907419922 0.18943604471620992258;1.9861478915393482314 -0.028623530089436841073 -2.3401458300046895644 -1.0427711227332054911 0.88259387488100038421 -2.3358987879092598661 -0.85213249230789145372;0.26676376343542568259 1.8023689849349713299 -1.1079581124270549974 -0.7665912948311423003 -1.2002553179476764811 -2.3622611845875929326 -0.32232754078355202454;-0.018194530507462804841 -1.3511916448702032678 -0.20307893599604684431 -0.53420936167714572207 1.2852975502695596077 0.40435030118310744118 -0.45909251026419262143;-1.08596623303552553 -1.6643793546396827843 0.012753697865958632529 0.3305106242230286262 -0.86937372329132822646 -0.28918605950183151609 0.32489301555807542643;-0.80503664758708426419 0.015183304457756221714 -1.242139899514201451 -0.90248374598446179373 0.54742410981581135498 -0.51794894444051808868 -0.10190383421548154796;0.16386360715019501755 -1.0832633938517155503 0.54446561225247080973 0.29352001129022864401 1.9971628450038414471 -0.48657747565421172187 -0.083210035388631975461;0.47665649866790904543 -0.1970996554303915127 1.0499200211380936842 -0.11968975168275472476 -0.4936793582883201581 0.5623672792762433037 0.053988687694922467275;-1.1771896741047320756 1.2595928900724422395 -0.12330143340384150386 -1.0866693606153956519 -0.95862212617460518249 0.64392173477328706888 -0.82954740806459303926];

% Layer 2
b2 = [-1.8449097558125187035;1.9393048136734925002;1.6622151241138416466;-1.7363436434647445683;1.3368012836532463528;0.51031141180116579292;-0.69184324927667328886;0.43599829497788794574;-0.07275587562566618316;0.44461897003792449912;-0.25674400746186032407;0.21188088535879329166;1.0512155887869032433;-0.81704394347274156285;-1.3634820929391924249;-0.68955582022649974938;0.30020941283634072771;1.0757503495789209058;1.4663333860190952418;-1.8184456624187030904];
LW2_1 = [-0.46906050131079884968 -0.72775494697319709214 1.2910737121159931995 -1.9050190182516886228 -0.19896574659090782156 0.64799331697093087712 0.31276605955379394031 -1.5056118604235981806 -1.282671677965610213 -1.6899912178584457489 0.52469842998841542681 -0.067963095002396570199 -0.41393161277574608281 1.0840441388267183509 1.1708696349151419547 1.3085600449691150438 -0.84370803901128077484 -0.43666719046171403873 -0.12839058828545796276 -0.36348366829806200151;-1.0769763177359819029 0.21671080709132373165 1.7842462843224087266 -0.65399337064062068592 -0.21539162101542011496 -0.51797962267427732908 0.58997353145109965311 1.7949004629623892537 -1.3375522004692770306 -2.5813752606702258241 0.54198389998337914708 -0.093950305417021651166 0.75194693741133655784 0.11164792769220785451 0.71532828817114368913 -0.57641258887277513345 0.48110214817934215947 -2.2748521980962044253 -0.078138258689933945411 -0.74818749383441285339;-0.53929451098165859246 0.65256481205630767484 -0.040193272789751932628 0.060184025290866978442 0.40091599532699284669 0.30670225149976904078 0.72917785721582439873 0.62551321828402017822 -1.0063337633842068808 -0.024256059697191585667 0.043729188994921189271 -0.38312952023467067297 0.46697239737996615316 -0.36299071451385189757 -0.46698096192967980533 0.69942171151244836302 -0.76416875995102717667 -0.14925624621255659252 -0.40830671485687586308 -0.42315613585035266597;1.7360371561899561321 -0.47502523770003646231 -1.6300621017437761928 1.0995445911432388808 -0.70881864529500060446 -0.4870592708529896675 -0.69814740795983809551 0.046558719148768752671 1.3719690468955294538 -0.11063138362507994594 0.9779194284217979094 -1.9858668246583977002 0.32852791066171949108 1.0469266629082947251 0.48886758732849483478 0.30896800356295467394 0.39509422531930532552 -0.57487854051939346611 -1.0086951333650902018 -0.49895499580895841252;-0.011692551082795456935 -0.54843900895626229719 1.6458287121295953614 0.60944772623302712056 1.1094762536311368883 -1.314172503802279568 0.044607228526483300168 -1.0381351625975006048 -2.1783508368559556523 0.0060593296485737489776 -1.1243297439599309051 1.3481298407482125157 -0.034577339632095284438 -0.46122807253743702827 0.37479700498615309279 2.0836080343603127218 0.63707628173453689779 -0.95318980605969638731 0.3996501648679415819 -2.3314599096325001604;-0.85711770018861310749 0.48941454193419686725 0.72271930944720141898 -0.49317591889890805001 0.13930083730969633482 0.93383788394490652163 -1.1556145009833633797 1.0100185378841191053 -0.51435908027385135455 -0.24541281733345021721 0.4483453054433508278 1.6193768158552708236 1.067598054611929248 -0.6868962850421039823 0.18926543301965079169 -0.56510127968361323347 -0.56650513939532298746 0.037079261696460794062 -0.18923972314349077339 0.41261706051959301522;-0.18984472933096502301 -0.1209271209759170268 0.40432835072654954578 -0.37965023203717701561 -0.74418696620578594914 -0.45650836026520430488 0.80256441369994047097 -1.107104591003291949 -0.8214428972325620304 0.69919188735937176649 -0.0048179316910142468144 -0.16453767968806648492 -0.65608185424054310531 0.14319153699334885577 0.34565342708077745337 0.33865166482490560718 0.39364081546004836554 0.92814551679540568951 -0.52939217525124315777 0.62496886934916584533;0.13375264465032912775 -0.89926117337806998897 -0.3331511637556647254 -0.93287950966689514587 0.31415495362234524546 -0.31972157051558541818 -0.59213556305295111937 0.33711372380937287829 0.60374646799673525877 -0.38274511087097351503 0.68120273027680078304 -0.24698036686731078548 -1.2787146622701091037 0.2297774945568236693 0.68438291365057091209 -1.2732652169707288081 -0.28545496788927016141 -0.20064317639241183167 0.21890998724628241145 -0.27615090413767418021;-0.46867710799943262945 -0.40392130086258809518 1.6808374714796983085 -0.93820708662822660528 0.60231380144686874623 -0.69711726261155304574 -0.95476403875828186329 -1.8085242572713333686 -0.33397910211325843033 -1.4093081395092856845 0.41161480678787137899 0.061408490962983203199 -0.53608972840882507249 0.34965902619673150387 -0.03276084444785978822 0.6875821199490760316 0.86844222286275596367 -0.35976925200538378835 0.0753833680249003657 -0.66616719913513078311;-0.21931546809266155851 -1.9486228486179779651 -0.50018535509947459339 0.25495821402812746115 -0.65329291694991131756 2.2702207766720645665 0.060098539788699500974 -0.74954157507504404201 -0.53329116598525350135 -0.061708967029566949569 -0.96930289312939243995 -0.079612591413998096135 0.80426318592632850546 -0.14405082164145088797 -0.20229450913578891913 -0.34918462550819395762 0.40485106448524232903 -0.12621566261622210736 0.86187717402246910581 -1.8507956825256346445;0.47448046743924432445 -0.761970817954763735 1.1667528108065527981 0.17486157746793745682 -0.54193954150376022483 -1.7814026393571222862 0.62951908666229483558 -0.47451751031132766157 0.49085000842978809832 -0.17529680788876800257 0.027277480652655873572 -0.7969747433893481503 -0.71201240135559629163 0.96894628266681270823 -0.09483870293737886592 -1.0989096246238592158 0.24658194302707589496 0.43599298565665212113 0.53846373585251494642 -0.36708295620154385297;0.25604019695540591872 0.68266191341487481026 -0.34546510633360894005 -0.17168298546801025184 0.49083932033489841018 2.1204509488182066157 -0.16812611955234235683 -0.61694290878158541958 -0.12257378834290211245 0.19583041308665474767 0.078691871019317335967 0.91848599307020617477 0.43344880932818274921 -0.60727419409730942768 0.053254859578748599269 0.36155269309285903434 -0.70466031110262150605 -0.53098531926340775122 -0.27006487266617773546 -0.58098075410228411375;1.4552350490778964698 -2.1888836243102827162 0.65713279654837941646 -0.26797025843177901816 -0.30954041611514548915 -1.2113070030183996639 1.2597375302676885322 0.35866343428396152415 -0.22197156753710009514 -0.14304725288827493945 -0.47967386696161529169 -1.3170232850793393009 -0.16508562191912518058 0.69419427152781987278 0.83612650619059558643 1.1752816829898073969 0.11042394345670145106 0.21195242806238120958 0.21107850647298082025 0.25951709446000964521;-0.88371307782347852111 -0.11615182410034131932 0.87241582166678643961 -1.1222525638247304869 0.23534657217005974794 0.6389734302049628889 -1.1859929338313877079 -1.1320276927059576 0.84876664725604722417 0.15098663177919544043 -0.28912257195670720833 0.19656635647651662935 -0.18388919947853299419 0.04863830689420392539 0.22543185015066977139 -1.5809661604180302863 -0.83051092457233444133 0.36753154155076123155 -0.20995391342468591733 0.13303734247602480578;-1.5377913835709364765 -1.0895579106191635166 -1.2996534131235921716 0.32096397159138062571 0.45264376148220192286 -0.36636635644948623014 -1.1224876381671831105 0.088178148878922793519 0.40282032081650076538 0.3262780033449279582 0.13851340034196271689 0.44548789584793019314 0.0083134176250959611332 -0.81091860857975217591 0.19913831464254092007 -0.42810594584738531632 -0.48758772970720976048 -0.082132432179300746133 0.21748842866287312892 1.0582096127916380546;-0.01918176949621641994 0.97766511540174783068 2.2148948658068521311 2.2147710265461255652 -0.35149641472421561117 -0.27016766777833417512 -0.55374343453153118677 2.5299408695219551824 0.66091736308396453747 -0.23980643956043715126 0.71617707994626023105 -1.0053940120797248969 0.28177163143359790221 -2.7301601348310993167 -0.37761511048392887302 -0.061240567972146872644 0.6030285484745809832 2.8236655711843035022 -0.5080522057546459358 0.14513679732988477022;0.83027432792599786815 0.16659997652894781295 -1.81901175694511541 2.0162073779511722194 0.053776215810889073377 0.4465867340143988562 1.735121502941859184 1.2635750758364052704 0.55573396997436685929 0.76152288140096735525 -0.39037968489585311849 -0.53424250855956101347 -0.10221664605026448136 -0.84269461989297045346 -0.42473494536729833326 -0.91804263004393504843 -0.45820273241163617106 -1.604523978856303934 -0.30675662700650185855 0.19338479739611533215;2.9641624740772094526 -1.459783701558862834 0.26061097949039557786 -2.2787043559376862767 0.60393275183389805161 -0.90618061664257210097 0.45742959796941373707 -1.1953001677938770442 -0.1964553485648840303 0.25062301265302006081 -0.221002898959466898 0.19653262937065410498 -1.2286323470491338217 -0.020087605444051088999 0.46865884433543852916 -0.55801113656269185626 -0.67646217862857516145 0.70692517537834065333 -0.22173296117127783145 -0.19663238771378444003;1.2375697468699962123 -0.20478107554273666802 -0.30552917650332511723 -0.68462199441345183981 0.12583712604534955104 -0.70532056214767557822 1.4715133787466923021 0.67872596730574941137 -0.011861049051837609103 -0.47389425074945928928 1.2728102969231285257 0.039918972316207092244 0.16544733063201663703 -0.78947957317245598396 0.011922413481162137672 0.00012200801713288869643 -0.64217267466665794995 0.057631655436487891353 0.54373061539988509772 -0.61495069882858077737;0.52059614298250245223 -0.018316028314195750837 -0.22012763022907844146 -1.6082229737720017404 -0.82558373253628247745 -0.057095315881955197024 -1.3741746471031237586 1.0151660911400133269 0.60586277359483087235 -0.22493168807723729063 0.87204414460820023347 0.09844789909402423822 1.6721372516642936112 -0.25689911169620521791 0.75712249946228760145 -1.2586162155213111991 -0.87581048293413998884 1.6239725048368744975 -0.087687946580407266639 0.73616446641681865248];

% Layer 3
b3 = 0.28483506997199947719;
LW3_2 = [0.76683990505036481178 0.058778514989549536518 0.50665820164385255708 0.094324110592970286659 0.08113401464420041953 0.058422946597154884474 -0.025675137411585675917 -0.089169535309102723741 -0.041317926509864946749 -0.20817597135978740952 0.080996784970209428911 -0.18418475584536114775 -0.12872482714348942867 -0.17209536113115628253 0.16293327653760703022 0.0017773562520209263815 -0.042549076254663587005 0.080271977787143372618 0.51685594089218844793 0.13215661943066051021];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
