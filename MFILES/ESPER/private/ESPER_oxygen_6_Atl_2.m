function [Y,Xf,Af] = ESPER_oxygen_6_Atl_2(X,~,~)
%ESPER_OXYGEN_6_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:46.
% 
% [Y] = ESPER_oxygen_6_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-30.073885786860969915;1.4042312689787845859;0.21625911991108776045;0.57241427786701493119;-2.0239719775739244412;-0.32041480015916234958;3.3461342787585612868;-2.6509925088486667732;-4.9966744664538742526;-1.9590672223897909188;4.0505334879544534488;2.3775803823122214631;-1.2186327339887590426;0.35140463978876140816;4.6413042541195066448;0.80442432599958391126;1.7197937545358144007;-3.8796467106061136576;-8.9695853677837096285;-0.86679221655218818832];
IW1_1 = [0.41588878802561857206 0.016237794976454628798 2.3463274325471785708 1.4296338077681287615 30.802212675918383411 -4.4015541072612096585 -1.0882227723693527199;-0.087387003126936882436 0.0031423740148676512426 -0.1668203043775290384 0.10798369207813213189 -0.84635663630885848985 0.11452855926129018593 0.30833338199624527043;0.12661199936832248647 -0.021526559038558004677 1.2345047550050205487 -0.33146923058059191147 -0.79328410206119293058 0.034936493515954292199 -0.041318196380672835011;0.18331324966006304344 -0.12536155821305544622 0.086093715775999377082 -0.39990962372318622498 0.88918274720596113259 1.597106525579589098 -0.20882840935475047162;-0.16163062534668118375 0.0049608725533649197098 -0.054728638957444640523 0.27802064069808635205 2.0206697073594441783 -1.0797066723037174185 0.54007098363505834371;-0.0123235215135875497 0.15337047628428132628 0.10975211244564749002 0.23715202629417556079 0.23560632842607545645 0.56811391186267501396 0.77275711583176420749;-0.37180788669147507575 -0.13296568609286299467 -0.15139295212959813508 -1.8842446854954741919 -4.9385603692911876905 1.2612840093822590415 2.3985583176456990451;-0.83430338030746920008 0.30370411369696542758 1.2795048845907661672 -0.076482693008841876048 0.84373034623735942983 -2.2359884414893080873 0.18015625297193157972;-0.076927726664173190496 0.238155168349424462 -0.76072718010250006682 -0.056535313103561940506 6.8885343291788796449 -1.5318165424998990698 1.2623043801335642744;0.37647265952259678645 0.54329718975283303184 0.75240872959659443886 -0.9540944083363542827 2.6624910425410699411 -0.46864941859133796287 0.84315122183250501564;-0.51350454686347757338 -0.33082144402462471122 -1.0596121595090006728 0.72930678417147776216 -2.8447604616664925459 1.8273368970136563139 0.75577920121800934439;-0.17725307033100326515 0.023093473057992242731 -0.55212963911248058579 0.19375102001062974311 -1.5661307399595207901 0.19337620460700649661 1.0285603893593264768;-0.27768960864584346648 1.020309271125358519 -1.3353058629159266779 0.05604422147559628975 0.7171072083853732293 -2.6676566403493096047 -1.5009706561079059206;-0.16493938311749939407 0.093945222869665556686 -1.4423530068082983657 0.35781469155241407698 0.094374706824681367512 0.0053048521618361890728 0.35374654512279546381;0.62048797836844427067 0.0042912971807439852234 -1.6471278959094419747 0.21539820631205700008 -4.4572253499466842896 1.0909897507961865415 -0.11715282801341968255;-0.26524161744083812886 -0.066188234830773420847 1.3111795822882366114 -0.15698791970676148622 -2.3197093394439725067 0.18058890050767295588 -0.35972730426705545881;-0.099414623265122153972 -0.46539700156053653846 -0.095243103256374153642 0.33030643705679146871 -1.1821399729519652677 -1.1490163426923634127 0.44463112885104777439;-0.35080651914347593667 0.25655769444072368257 0.01132730047883455729 -4.2134501273888558259 -1.6102243543568648398 -0.39312838556845264293 -0.3019333674582347915;-2.3412199791435721608 0.067585221246026075392 4.9322500690826283076 0.84614955002733094336 10.359451042942689369 0.14939552889521445778 0.79076108958650048741;0.042295849309607044808 -0.010237899320255592836 0.29515174761324503017 -0.04537737576842065107 -0.096092378728109634212 0.19942631140871824869 -0.42075610012082392819];

% Layer 2
b2 = [0.57114973006043545656;-16.989031967757711072;-8.0500462855838268439;-7.9207071696487600931;10.369606659094937839;-28.709125943925297264;9.1639473768075685456;-34.474557835778753656;31.258080397751538015;14.037961378028469994;-31.782206454653959327;-2.6644448238593705369;-2.2277679914053982735;4.5681820604692768839;0.48102702629127636058;-12.177906804192632606;8.3103609750309015425;17.882123605392607146;15.972153982292709884;-4.7427404519958713536];
LW2_1 = [0.66803610932576773518 18.713917713742787896 7.9651311191241784826 7.4109860339295181575 5.6175308909442343008 1.6572024446801341124 -0.94044505223258123561 5.3255572193617979337 -3.6749283803283705474 -1.8097163310351436216 -1.6836228035882319087 -0.83211794978726227878 1.1136963810146280895 5.1100971118245821501 -1.0817670478010734669 -7.6414466975231949419 -3.2537732173181703743 0.3701175889011030784 -2.2658206240135148057 8.3452055812750458585;1.6678410472870976999 0.16486201308402845256 5.1225598214184735468 5.0966284606175253913 5.6504835651813483111 -5.1888233531226521933 -0.29080992953736523043 -17.649283745252155597 -2.4970213651073036587 5.3323199828535168265 0.30218387186354345175 1.3132269975681196694 0.97094115804875824605 6.2856311970225036134 -5.9455477750923018121 13.838674744803299177 -0.9479063874487507757 -1.0661033054813771059 1.1836990652415158021 -21.556283096847504765;-1.4465102856981018054 53.800286591213044574 -7.6799759453319653701 -13.749108460129699338 -17.684951454802277482 0.66413840337396279345 -1.4934506287349815778 -10.110726269063704308 6.0284317743735762463 2.333580483275328632 2.9420181902244046945 -9.57945376505862356 -0.0074067346791550740803 -7.8920939027926806375 -16.370121137908125064 -7.5446075054964429896 6.0958028795649683573 1.9076783054319037536 -3.828360860372592267 35.420926054244411318;-2.4106075207651271874 -3.0140660543764092871 9.8310916821865692583 1.8266191533122602131 1.1094625746992692328 -4.4846229706806974846 -0.087873461445156397787 1.9104115307411739799 0.079003681166342487607 0.43032070677382638912 1.7304714207524405367 -4.842624450748853171 -0.14820159906672553118 9.5842357459791287511 2.0915692504375296146 2.5875290930443100024 -4.2832387500351387644 -0.072597283176272564553 0.29735236617988497487 -14.422040543346280828;-4.7565434977631744218 -10.803803255091322555 -4.2977084697408090008 2.9378277918652964118 6.1981553510280136265 8.3072455429010396699 1.7241123867934100566 0.49711239959979952596 0.32998480896838533472 -1.2147184788218514662 -1.429966391950557858 -8.444588127604989225 -2.2686812560344429279 0.41091481707900234799 2.8132285811769115469 -0.78202579069950794999 -3.657479060949285099 4.3842633532124422047 0.68139158945901134867 -22.226777180605274964;2.367082998362063595 39.215202656369939405 -23.252994979506272699 -2.3474688388758822022 -3.5156977939102844744 -10.433424197122331378 -0.88132621671249689044 6.1981566565076455788 4.6205866482840294296 4.9163191503226135737 6.3857366001084026053 -15.634044412788401957 0.47241707578238206766 -27.033425220810094913 2.9155389546074528262 -2.6643941091864435933 2.1548160324887026817 4.749673905357065351 -3.590905424424812864 -9.0260367352096562144;-5.4258424850953312912 -17.654982588635437679 3.9538618113151113853 0.63501712838245771842 27.00545039642274503 -10.219182702699127319 1.8265391119102465378 -0.99280683259432200849 1.3397644264368577804 6.5289613886247206409 6.5960909413243093979 -5.5831490871653608465 1.0486297734045280095 -5.5258055171653239768 6.6474930245456080868 4.7332108483440915592 -12.198783755821773767 1.3151727942450470721 -4.5628218380049032632 3.6211609827026363106;2.031796328581827904 17.562777426609226694 -3.3816589171546622694 -26.164589018812897336 -27.343147858528073613 -10.792169810118481976 -3.9298053047514334146 -7.4959549543031780416 0.9741005678475658236 5.7150393137267307964 3.3042905595191065515 -24.689941207644636734 -5.5099767841231717114 5.6892629894921453726 -11.026847789924717702 2.132352080893565649 3.1268568943780712388 6.5528886185464800818 -0.28365215878091176727 -60.789776798639728383;-1.2379098038542504234 -21.901732680228846561 -13.441459028923016916 -3.7802002778598060573 -0.074564462320536040174 13.097503130643348257 1.5073805630196730476 -2.5875710287915114627 1.8606671837242758638 3.7489050209163941041 6.1581645804358728924 -3.2511827973905780276 -1.2387427585400090368 1.7939809758205427226 0.30533492190513233933 9.3989571574601065151 0.29049107848416394484 -1.7284364589702836401 -0.66440551573643180649 -1.8673191159282929164;-1.3610478060823663071 -16.193783846654373093 -19.468691296727563156 -11.563425870119067085 -14.590001387614263351 4.2528852404664769793 0.13239009775935139945 -5.995120445163191647 -1.3087777375766305177 3.1551943958107582233 1.4659229415861039225 4.2568728230938281953 -1.5603046840417325036 -6.1139775928169299846 -0.92732804958398939998 17.194079275096441961 -2.0371394910422444546 -1.4494189133831603122 0.18709135567389365007 -2.9446292475538160538;5.7454833959436504287 15.744794659679474336 -11.596364652876072654 -11.934029326853396569 -3.781733151144435201 -20.298751950809315048 -1.3320353443636365753 -4.8242802483001412384 0.52104146677066942583 8.5233957135491653645 6.4528372621112630725 -3.283087767403654933 -1.622544049164962976 -17.71562424575418504 -0.22607203521744506647 5.8374066850908787885 4.1320435070701417857 -4.8917275850780521651 0.1022330045749596239 -2.1379310475760693322;4.808862697864074498 -4.8818604146956401379 9.216369365474069042 -38.135387378675375203 3.6856098018403389283 -3.5613471252734769656 7.4907177793408132871 -4.8298979430468644836 -8.5441337209874692604 -5.5071591688371057671 -5.5153231155115056694 -5.6711069206756459238 -0.90416182056418925583 -8.3570825092789533528 2.0024969140318877869 -18.983028960145556852 -7.9529899271031938568 19.583699518327527755 15.493907464947826114 32.466432676422627424;-1.5399465589328795723 -8.0706496879494462604 -7.3157867204565434349 6.8040109985876036092 2.361828494845737314 3.9318420582959050513 1.326333656650319659 3.7781551498009480206 0.23776442690112145617 -0.41837235962748497986 -0.8224150268875907166 3.1674234522359849819 1.5700088194200105818 -14.263057148801449259 1.3952175288222170568 -2.6007421747171215465 5.0905817420986547717 2.4880425365575322694 1.4410428426897075038 7.1118028558642496506;-0.62260084831421247387 -3.2035582939471649588 -2.2002425213589185127 -4.7793156703632106996 -1.7141584122986608385 1.0586461023822337779 -0.49630737292875404254 -3.0956256669991266683 0.19796322920142206403 -0.31236386600985821538 -0.56357914847188239627 4.5542008868254280074 -0.04621828663274420157 -2.1018048714637167507 -1.89741618533709544 -0.90642789186491246056 2.2510974408639503608 -0.13378037315116036998 -0.4969210025140664011 8.7870463006866597055;-5.0944876105231458041 -13.748273341490055088 -0.66529732870219304708 3.0119895375411545047 7.4609864137081434166 10.843967886799521949 -2.2081783367283907005 1.6689611655253249189 0.87116622682622513185 -1.8437042711272786377 1.0375307227866277238 -0.95011173639396695467 -0.30833328102111606794 0.1760319577572131422 4.8374153716310166473 4.6426118251864387787 0.26051677435379033687 3.6325038469585990697 0.46109782230144763515 -26.338282379263354471;3.2030298041346374482 -13.571719397834264953 9.9065258340018704786 8.5732677670538848247 3.8113135824313810751 -15.263444556823063891 1.993854544402225315 1.4403678796257290973 -0.51747674892186190654 1.4072037841728828322 3.6304880699197465965 -6.9107805655838223657 -0.78020176764020376936 10.311686995802107347 2.1518035079978572455 3.298240060652833705 -2.7670979941101219168 7.0592861831274733575 -0.11609118588205154243 -23.511142475884444281;2.5372987703170530871 -28.675568938225772797 -5.9539454020696993553 -0.81576970221414168982 5.093109530338202795 -5.5305879049468895658 -0.96763551882016562988 1.4783136796975169247 -1.3603325777399741803 1.0706120727256502878 0.23622406346398533428 15.170444022016889463 1.0031757049123375403 -4.9464684327735728431 3.9943559931986083456 7.2068379424258708355 -5.9534844242735411868 -1.7800127021782670145 -1.8413177417126445068 -1.7167092291527172865;-1.7390074608181562699 -32.357330797439573189 -2.3462692131786604399 0.16892136989294126437 5.2520299132195065184 6.2459645493868602983 -0.80378817639189115152 2.7251786625056952929 -1.2791534601087137801 -0.8199956335645615102 -1.1107367119490785257 10.63447772099844002 -0.76052700695029673561 1.0864450699538918954 6.337428183539231874 5.712975140014402875 -0.96694960278016062194 0.18006634854599243289 -0.93248768238683354959 -0.33952943185058420683;-13.020740196565638414 -10.545015317441922775 20.586421981703363571 7.3997690854515498771 -2.9065092144525883633 16.247204511187607778 -6.4506253689126324957 -4.2470266761541708433 5.3457044525817858371 -0.23465872479983518328 -1.4731089939850423587 -6.3423622263679755306 -1.5044031348760373845 18.157360569192842803 -6.5181992713881111712 -13.161604208634669178 1.4051988599292242199 2.8799778818857779683 2.7958816058733848564 24.048618786290667515;-0.44664041454958258726 11.797091463897590558 4.496025633633546903 -0.92587523805364224661 0.427548915387517936 -0.91364868522006958962 -0.45856214827962865632 -0.97425113243395600193 2.2726150687706616615 3.4870418710348594082 3.1068746012350394459 -6.0209579138257094399 1.238412364134084509 8.04008690947696536 0.61438108887727727048 4.8960626593510268023 -2.4072368353603454949 -3.441214958285761405 -0.08031514251282238781 -7.5221845532509723498];

% Layer 3
b3 = 0.23221668397863087785;
LW3_2 = [0.11318497051991306679 -0.015175798305709775962 -0.072392855522859497763 0.28243088816778877392 0.14663833851029389743 0.032061184597828938647 0.024339296629781730086 0.033244675975206465501 0.21202065004523132363 0.054745134022047441114 0.10862998126268229304 0.15439292545561175696 0.21384267129076514613 0.57756667838585129537 -0.096613178742156996526 0.095026355109032942248 0.10374773852904815852 -0.21041071944203093569 -0.013062948048562795719 -0.22375548905648870446];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
