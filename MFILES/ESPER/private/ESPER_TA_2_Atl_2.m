function [Y,Xf,Af] = ESPER_TA_2_Atl_2(X,~,~)
%ESPER_TA_2_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_2_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.4873685914826948462;-1.7470695661801949328;-4.2148581261775470708;4.0324572987813116498;-9.7304796566332250052;7.4205663518299012082;0.32169405762703195961;1.234145678315591077;-0.71597531984611395561;-1.2753509631732000695;0.23274597606244512571;-2.8034111076462311374;2.9874525506297948674;-5.6818666609195620509;6.8321935196723302397;-2.3642765127618217136;1.0035768899877159921;8.2724195854814031037;18.406048673934698456;-2.4110587271187711167];
IW1_1 = [5.652302220643013797 -5.3675058575891316792 2.0997889438366650339 -0.1691835885177674359 -6.2320416280864474601 2.1162371032822608896 1.3613954188833059522 0.50777047077714843049;0.43082424274439196088 0.75987741931444641175 0.082772097732871141584 -0.83018005894630653163 -1.0588417591847338883 -0.74281942545233170527 -1.3437723334285742727 -0.25632861610907631267;0.39972825677461720772 -1.1753239914238386987 7.0154587164368882313 2.5909930675935095579 5.7581555744679322473 31.101968233605155945 12.105930875644988376 22.103548202621787766;-0.59340735098242114454 0.62623440753832304573 0.18673288721593331307 -0.095037928563940790583 -5.0948681162567677205 0.093253661805059867573 -0.064955769275241659333 -0.49651620976862803625;-0.16628754440480128518 0.37520645869753732615 -0.1212983265644443226 0.28015797562577948732 12.339620030605768619 -3.0320592881036989574 0.30690160909825808799 1.2071833381234962079;0.20835288870905352421 -1.5096354918025627345 -2.1019297864315396041 -0.5510287050501445627 -4.4543717110316425334 -1.4328589108186400303 0.33660525960317089211 5.3189003053172489999;0.16713011357351031938 -0.36167491072376428685 -0.30533579870540189516 0.22628881372474637934 1.2998377731978334459 0.55329219750677649525 -0.084324062819677580993 0.71815618884770782149;-0.34798205688626027143 0.39082962918511116035 -0.14201049118020783735 -0.21040224231971266233 -1.5069680780391330188 0.010168245624743074348 -0.034544562268232457958 0.078159738544849782782;-0.21628684295735017828 0.48144181458795010098 0.26081704034194957975 -0.12812560689844201822 -0.51206990426413134809 -0.42968884028841525247 0.022743037927006590215 -0.53789228685464074431;0.78261058987379961138 -0.95814979795981347621 -0.10422512388938913463 -0.2628472092519058001 -0.72259740114651238585 0.19568156486063559285 0.053406976302052579231 -0.42341458834922401921;-0.082008391591970819512 0.15804993498302588595 -0.15675131929593591473 -0.16076186228236286069 -0.68313814120717408773 -0.027226084399293366822 -0.045916470674168957666 0.14237462599439179578;0.030750740425270612494 -0.39440599149982308314 0.25503645070583036425 -0.33309958460247740542 0.73063762754111505338 -1.0140742560910942505 0.30916009226810114985 -0.68822523421515469089;0.78689320700749332271 -0.15711522157480284356 1.368000339549275246 -1.0776851741425363951 1.06103566084983858 -1.0775619963713554128 -1.2259807992630962215 1.7892200190181353214;3.1155654750797796559 6.5857908633670563248 1.880353962885485064 0.23626463211097756267 3.1708028181426572978 3.1719715981518494807 -0.97059535792586426606 3.9333292655363729651;0.84994552606823015051 -1.498502752081973588 -0.3100004447573810884 -0.12200719180483843296 -8.5074723406091639077 1.9509589556357158635 0.2069033002608591798 1.0594292484213609917;-0.41900099833866022436 0.763487552665655822 0.49652280976596741002 -0.37189447455851720736 -0.73499300130559686028 -0.76234931653250914696 0.34414067144133286824 -1.1158746657940346036;-0.11814124700365168097 0.16204282794109534094 -0.32308369869875269709 -0.30823899418478695189 -2.5289369096166978146 -0.33022735718074280875 0.36017741671616609889 -0.32097928774439321575;-0.8149622737328434674 1.344068753714509068 1.1188758562320726409 0.57897083190193154856 -9.034609633882524804 -1.2690037982701805053 -0.43840605935774495938 0.3725546585740852068;21.928374656011378363 19.248934816076513243 8.8115670578043339134 0.15841404251668292358 1.6175474644294638438 8.3321993419053264063 11.90568586462533851 -7.7267824214891680512;0.90571998449830370959 -1.1003334865935963105 -0.088941220437740720062 -0.41232056618019569116 1.6145533698276508527 1.2316066264499354599 -0.059912362636236685121 -0.18598735352192524717];

% Layer 2
b2 = [-1.459657085599818549;-19.185084731092743482;22.885501427912778638;-1.5661297867262211625;-47.783975448757018967;35.537762265856024158;4.3267252932735997817;-8.4307506670953973327;43.886993456804340497;-14.95299480168772277;7.4902654677491726787;1.6503939834488874361;18.525704295227832574;-18.222590213197904063;8.9299964923228856151;-11.811002269258306541;-19.635394698323271001;-17.643914166579978797;0.69103269698364222506;-17.810393279868332428];
LW2_1 = [-21.838173218841465228 3.8991678100941369323 0.96804709887265227852 4.3812016124343342582 2.1207348284097933266 9.7294221494345922707 11.184606502111650528 2.4021799443903542048 16.354778514666861611 0.70201934307444824324 -12.355787104558729084 7.4932815302761097698 -10.908330288814658715 -0.45570436855977147772 -0.98926780833822014483 -2.2869698457474978426 -1.7505145384701290556 4.5922553324245418693 16.936580731635054065 1.8559013024212296372;10.131934072544066083 -12.22321373402639999 17.58580447853429618 38.185866078955335468 4.7417638719521768564 -37.941559506711698191 -39.7249964676747922 25.057333099579320645 -16.760220603459227817 -28.065550761885219799 -67.64934222345186754 -31.80573732890985994 9.1544247515797643189 -7.5345674978860799342 6.6172795078829658166 -20.955748289846159338 6.5941454736269324854 7.2872696154628675558 5.1712219579748692766 17.260442898279155344;-13.733615033901159563 -4.5456050380800618882 -20.073473306667434457 5.3258382427056405461 -6.249587860355825697 -3.8355576147012069299 8.2477915404105797137 -10.480521639780688403 14.811601647327389486 3.5940304293892504361 7.1064103120605164321 -0.42885646914099234683 -17.478494368906936529 -12.004227965937902312 -1.7455963856403244883 0.96397155721201777112 9.6670244151298998503 2.9543163690329774518 51.739329993851946199 -0.80271176600864446726;-4.6206749270059104262 -1.40669755382592232 2.9650243260890749575 3.6922896502687576614 1.6179921694656509423 -1.6508028629031425982 -3.0079947863828291332 -2.8604415607974083002 21.211279294092978631 -3.8128495026244979549 5.3767373988069300239 7.2930014630903201578 -31.219756906161219234 -6.3563765640850160565 2.9870980785916105837 -22.985779823787371612 -11.937837510243427985 2.7955192545601663667 -13.040241219892523716 9.7606247919348039233;9.3535366831978308255 3.7526916873959810239 49.194292090276825036 -14.977016584987621783 -5.4364679570967258115 5.8392357319787393521 15.316095487643041295 3.5509180827581685591 -17.047823386113503119 11.168202566210407412 -29.974876313542448969 20.869443509610480447 61.486588731562406451 -46.317941155416228582 -20.966760367227138318 -9.4679206275011473792 -5.0218964582749272552 -16.40187400458858491 15.29118617618013154 -21.245261966894911865;13.423100790712334529 0.83718726458385339662 -12.986637257209435958 3.3052283056167421904 0.90432211107463067457 0.028789939824582590211 -8.7362848261650487558 1.5381191025560949637 -20.189844776787381875 -2.6264642327010041534 1.4340416121977348496 -2.6225115129105747158 9.3536738608590344057 26.191867030930009008 -0.50546761025253150734 8.7750486285272568665 -5.8779003612812745772 -0.043477635250135981959 20.701076076832951145 -0.20556983223537134142;-3.8584130342503950573 -8.2093661917484741508 -3.2668483351986385976 -10.258634453835885125 -6.4889374212415100729 -4.4370186287160509053 9.4958431219280470259 -18.899433040273194706 9.1837492108838265636 -26.548443485808398634 -0.14454254589736312275 -40.478714073995142542 9.5096910266002883105 37.599165755003731704 -21.222167338294795513 3.8415778943129446077 10.181557525857281021 17.688493300597489366 -1.8857128882904996559 43.256255363965308902;-9.530493741632390936 -2.929572754344451635 1.4649699781433953572 -7.5697698929889885022 -4.1461036117979483961 -1.0446400807169160529 -17.081553811249548858 -19.017059051067917608 -37.538901163409654771 -12.209132515191045698 9.280308172206428452 -4.1895355690655851078 -37.358313086502697331 -28.137640113372597739 2.6400176007879281315 46.896668459126793493 19.38182582049478242 -0.2956986099369240395 -26.318380222184512007 6.607544115702757459;28.948034311830838305 0.5919973034156502667 -3.5873749044247564832 3.7725157537664224527 0.84522830866198372934 0.090161818518251973797 4.4730687909953283921 -4.2515022143180853931 2.4052605542100180536 -2.0281726160523119162 -8.0728846137085508161 -3.0384670914521612062 7.870273322599975252 0.36927483286454731992 -0.39942136327953425834 0.7370340327973233796 3.5558828090302414537 -2.4696953614110817021 22.156647941664846968 3.3456513822836027039;-13.82330210377172186 -9.8888011516646585619 -27.59214110174039547 26.162545861669638469 9.3860938113528487037 -18.022907480862944141 3.709256169129120817 21.397464676767821601 -51.015173794339133906 -8.8435447026976543583 5.4701836941253647595 6.9290225460989116613 2.8612497887007601882 -2.9244829121538056249 -2.6807566830859825835 10.495195432883935638 -24.608177624443090536 -7.8146245442750021937 46.5649670826541211 6.8570018407946200512;-26.232697615491584742 -2.0386251940318409481 -8.3004647520175431907 -5.5164215683112676203 -2.8476612368873936987 0.84421342960830103586 10.43664705031882356 4.7400361078188124608 11.135964660788513214 14.109475999972477922 -24.518394348023708318 6.3136690658803900078 41.45429273800508696 25.986747778539282194 -14.725850617028383382 7.0070643384426816169 -0.73377993748256020723 -0.46227611029695142575 49.454956859867756691 -5.7720918114573311897;1.5533723225906748144 43.626872970780318894 1.4274792573410564067 -4.475031990538689719 -8.7372814716706059812 -10.997584457523990054 27.985332350913122212 32.394830694881768807 -0.40120468505294049066 -9.720745011638292965 -5.2478767678871953706 27.473577185228467812 4.7572724991952197726 -7.3428694240011775918 -0.40924407573333237975 -47.614848127078062134 -24.291093106364840537 5.0929735501563833111 0.2920606940112315808 17.649880881264440546;5.9928685949884270556 0.13875414496274018905 24.514881864512624077 1.7013112886067940366 -0.5535627939244018858 -0.00059534922053271904785 -12.517590389325164324 -5.4973852907029954196 -17.951072388708080751 -1.0999532619390064436 5.635393659232516228 -2.6741432518870991153 1.6026254902228296295 -8.7461046064911585063 -0.17915152738519035669 4.1651077662348088282 0.50504461159220914723 -0.39376354882253761236 -0.020341728239723657484 -0.33524154227949970464;25.368587551588063889 7.4262853298432061067 20.074525781896991106 9.8183065184601421294 29.087133901897125554 56.530979725347712872 -27.59518106936331705 -14.253453442038791721 29.754616282540471417 53.404013880615408993 39.561819218104794516 -30.138975020033615948 116.47356008931045324 -22.105762662295614263 -0.054916904857197683387 53.037693408737453638 -37.887552814580665483 -27.576894699140886758 28.984614986798554526 35.268451176542271241;33.949851492423789523 -0.22608621976282336496 -9.512923176297794825 -4.0545627705330478108 -6.6410571930461390622 0.98765547288877031384 0.3909673817054742373 5.9264496191224731447 2.8360967152838760796 0.30502956061558722523 18.065858289985829543 -7.3253264993190443377 12.400553364417596924 20.489085388231075058 -2.6462470967113032039 -4.775759553380826361 -10.166268191800329035 -2.7538342976071668033 -22.81130639786793779 -6.966026112447289087;13.512275261557689987 -14.796033845654562811 2.2216619387645404338 34.215156463772267159 11.393049377013294787 36.19395499467294286 -22.960013764307387163 -9.4935016705371815249 5.272439763701454396 44.228310199492312904 24.83932189433127391 19.595719288235496691 -4.8717943843540894022 -16.857776396358865156 28.45764680570889027 -1.8454865162629219277 -2.1647079756806961726 35.784792988002394054 12.972447825538811372 10.411817679675268167;-9.8822882914981935443 -0.77371464018366620241 -40.537311991025340774 9.1467671034237802985 2.9987584336409502939 7.7964555065141007972 -20.960110212224613235 6.8415406784653471917 -19.6753514065429016 1.7099235366209664111 0.6268214461459551412 -16.112434423656313953 -9.766014452670162882 4.5183050031102878208 5.1701157593003097546 -3.3723133722987213012 -1.902033945674509674 4.4221060252127646351 40.130786285077832076 6.9530683482145256846;-46.40419800550832008 -2.8905571393812712344 -5.5205440715946068053 8.9669230379175157708 4.0611059565215956724 -2.4017571163008022417 -29.515429858615910064 3.2268566642746261408 -0.8454006793747697035 -0.20884188919369414683 7.5600297064913428713 -27.985477041623010308 2.2409554771093551651 4.0302717414803934659 -2.5773926598784178132 -8.6902527573525354398 -3.3483871833106633176 -8.7473273675860241383 34.272452805695230893 -11.1671882793240691;25.022627155383748487 1.442106531331863728 -5.7674193521372671967 4.1473239855131893705 -1.3017073434933701392 -2.9039005555378647472 0.82755142601748488129 -1.7482264964529119489 6.9486658592508341314 -5.117266047832737641 -3.1872473664080818168 3.574539927591107169 2.2231831186823147739 -1.2889411729584914212 7.8042978191680454358 -1.0525715299152318405 -0.33431840230831444405 5.4724742488102693372 -10.785376305659687191 1.545856777657960146;-28.195162961818379443 0.59399297706320108858 1.4075620929140961746 -0.80547373293145163586 -1.5574082701549234464 0.32917688627178831595 -5.0581499847334701059 -6.3219714389577781333 -6.3211975395251354115 -5.2973005218006221639 4.1302908596491230142 0.019043491678413432266 -13.256751712840038948 -2.5860553822492420295 -0.045786311341037402856 -1.5757133557803921775 1.9250323136665132839 -0.0014391423906820735232 -0.088453224440615207946 2.7950172931680281607];

% Layer 3
b3 = 0.16376738790880213115;
LW3_2 = [7.4522187596368116066e-05 -0.0013603341837266948178 -0.0011550596644904372306 0.0020923459811273666456 0.0012826516792958880895 -0.053411676414659853274 0.0012812012754276863417 0.0016341864310948897489 0.30063683733980822721 0.0023021472561130600608 0.0040995413254671219522 -0.0038516401990941724967 -0.19078284606838299964 -0.001078607640179343654 0.002055804763826978715 0.00073606759771516617856 0.0012578230620286425662 -0.0062004409729055675118 0.001272475389751186528 0.18812817068484452565];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
