function [Y,Xf,Af] = ESPER_phosphate_14_Other_4(X,~,~)
%ESPER_PHOSPHATE_14_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.2841780024671420879;2.1070811922890224643;-1.0879815444091687215;-1.6603252531344496745;-1.2034894007991010501;2.6559815007493545735;-0.64291994875812408239;1.8263661150820429402;-0.48667777445257626168;0.89659661944069657391;0.42511203824018956032;-1.8509418276234685941;0.290155910883914403;0.94132582450722002143;0.34350820259179282168;-1.1749376561641631245;0.78567526845398005797;0.49993824447355666996;-3.7917220123304971047;0.69460120285104243187;-0.43993899094438360109;-0.021360451487156539851;-0.44779004175387254749;0.15038891708173199313;-1.5886921303436631892;3.0082675307645705409;1.9237959227673320228;-0.47004057511720331863;-2.5400765427059366353;2.0273869856065673822];
IW1_1 = [0.57828779923054129952 -0.20040364211412906026 -0.0788030056101384907 0.35899144130505217243 -1.3605317157140091044 2.0527034625096689524;-0.28482744809617982495 0.7402254407541261072 -0.72239877499958027318 1.5675780531636920312 -2.9410735304490049913 -0.75128544574297229097;0.2800620330610265607 -0.10760202662950071884 -0.34272049545672261806 0.80809588071566307299 -0.81676370475589266107 0.62326598219274231827;1.2411579383514665942 -0.23933058673574966746 -0.13750826348795971987 0.31768355609647563886 2.0204287245731951117 0.30699233964129318819;1.7447517908314136292 -0.73392320067948313422 -0.92634179657759307958 0.67080113301790944558 2.4438777202409056599 0.57362179902537768772;-0.52771675269180606804 0.50191298569745090852 -0.43510933675371998852 0.98644016175824889014 -0.43731973792296546799 1.6473727161896849491;0.48002377477284546847 0.25685201592613310373 0.022123044398490811224 -0.60211807257591742903 -1.7956414771870030656 -0.62131173622263224932;-0.17940463242675627753 0.36916364771934229161 -0.66196194483355319527 1.3571987059151982002 -1.2005022087982748502 -0.75695033880389672731;0.17984632762859320554 -0.51413884055301073417 -2.9317728116543775307 1.1180076073105347234 2.3510568362754784566 1.7773408637901242368;-0.16566204481933222148 -0.92722673178195302857 -2.2190288949860410561 0.92954070850551162586 1.0746771916256250279 0.81795074575381576665;-0.21994700285191909339 -0.18969693665716599873 -0.64695028583290714597 -0.60807210033004732708 -1.6048376288154828639 -1.2423908589175443051;-0.92750523150550501228 -2.2718945416482614341 2.9757637543197565932 -0.84164671860654305391 -1.2568939057063890363 0.71730688115981044994;0.67956372478886117872 2.4504721372071482932 -1.4301556751437216608 0.30894631319265830616 3.599889782414224193 -0.80787022513522499523;0.9926288870378843221 -0.53382685006540131489 -0.97564064222553181782 -0.72609328302405662381 -2.9345163036850516747 -1.8926382196598847685;-2.1235522954421996999 0.59386165639863675025 -6.6961993286427539118 0.21812949653967231289 2.4636476097538628771 0.77106628741063454324;-0.084192892477242570193 0.33672455645885746023 -0.083675245620958696446 -1.4764481463983905041 0.26186214793729867267 2.1284665555192678887;0.22315392580808207645 -2.7658291323470445278 -1.6260526738738854124 -2.0549741286204650237 -0.50068739246810267662 -0.094670429127197502917;0.67031294627008852771 1.0876019596300130488 -0.29916223625561649824 -0.067054445024793962737 0.57072256506817042876 -0.20167780557610015535;-1.314448781983613479 -0.309662015678601521 0.89016583149687589227 -3.3156017263474537593 1.8657009525780021697 -0.35780596900761429957;0.92712377532699463689 0.40214162006226816803 3.2815006211981763151 -1.5804466505345946548 -0.79331445785196896825 0.88041575274240191362;-0.19124022851943739409 -0.43252842972381316811 0.41293240106942730172 0.66500584044409927209 -1.1063051404705241954 0.64042839130437989592;-0.14377978844967412297 0.61292398602024178444 -0.71082937999113193772 -0.26164461533328309262 -2.1690261735202884807 0.52408657858643270533;0.053869151256776381942 0.12784942998515400059 0.4886913756586229729 1.0446485988375584508 -0.53998869597096110784 0.14959682018570003015;0.58839944622324724666 0.19074864584413211976 0.0030279984586046799003 0.17641415924029835161 -0.58868778771893681689 -0.79080251978591808992;-0.047519975884907750263 -0.21127591908881848681 1.7512443604252092566 0.062027142233215003253 2.7808866760186878864 -1.3993739235914186558;3.0690194419228027378 1.5694006164900922151 4.5536554106910456241 -0.99254524745178829281 -1.3391095037369267207 0.51900364166303969427;1.2778357599189742455 -0.54090294388628956668 -0.51772824700201114378 -0.37939400482994417585 -1.3579633130205039926 -1.4091029009816411488;0.26169425374234001058 0.44196566668287956547 0.032651305256574295055 0.29629795437827405324 0.015983526217413300541 0.71042908920325820166;-1.8863450896396838363 -1.2519574008895995032 1.6710773055339844806 0.37177735560281821581 -1.6300985582297602416 0.20278088224857437893;0.66744942590816880301 -0.76337156552366214335 -0.32834427027285328915 0.1803360150249339322 -0.60908795597415410494 -0.31721912859277029417];

% Layer 2
b2 = [2.4517785823982287674;-0.32709312235540399794;3.050724686337048297;0.28233428008324384928;-1.9256156998193720842;0.18992645557651366417;0.74221083888832672937;-2.8215797995416407318;1.8737551959787155376;3.057601628445076436];
LW2_1 = [-0.224330584470236849 -0.43162381747671146881 -0.90473868938199974998 -0.5406392739493310895 0.34273985393064204663 -0.47526005339618465628 0.59142892088890930413 1.4504175103751306697 0.51556169225888304197 0.51422181355440266248 -1.3227094149124347666 0.28511375720032894332 0.003856017903687069398 -0.61962391460845500646 0.15684960203631104214 0.16103462051791300746 0.049369622491942079245 1.0496715951101585063 0.032293643005668018486 0.19087577562863944358 1.1138598569514064351 -0.61249947076650268496 -0.090534026374812878735 -0.18577363318737766251 0.29213252187878463451 0.073159127145965271999 1.9874718303184171209 -0.94886702219057095231 0.60819225349984418205 -2.3096904958291575305;0.46375595406180747382 -1.6658898218393067836 1.128879791231755414 -2.0170404396279337789 0.17247825552631679269 -0.024796247999447844357 0.81924616800966520991 1.7893553068138035034 0.46696176793400306915 0.040841615731104202736 0.20186033703341860202 0.051123515770440476624 0.019988931252644066838 -0.29086229978526267903 0.28517491011256057565 -0.052117641374057652182 -0.075971377988082039456 -0.082107819827899344856 0.15824437499862195611 -0.29017013374477323984 0.40672686397611529374 -1.3610384075447783392 -0.57526804384021079652 0.36515360041876254726 -1.5302252494279575679 0.15587396952174556453 -0.79143345315808555362 0.56168480986955005019 -0.25552880989887882812 0.85039752149024994132;-0.13826100034920107973 0.081185311743920560157 0.53532683228443789236 -2.4159028985505797138 1.9636384396524768636 -0.40712580659234209879 3.2850990405028221986 2.3251363994865816842 0.41251754625618308747 -1.4487780490640898012 0.94509959699392098731 0.86520865374111011192 -1.0572566229311350927 -1.7760285284448775744 0.43609881746673551106 -0.72030547581558290737 0.54607448634162358836 4.1209825412834435454 0.8614588048996492109 -2.454265018980622326 5.5534562616324185669 0.15589300052557025777 -2.0180952920877111012 -4.5198887699524812334 0.69083677659836295604 0.069535242664945776103 2.2921286896174870584 3.1322560774375114434 -0.89528701026205714797 1.89606354979896774;0.23601930314113805931 0.77402711935616785865 -1.3391137853753320996 0.79269578016361186279 0.25721729033791213004 -0.095973151439743067947 -1.0614850601252066031 -1.1804512227621071219 -0.44431021499671885522 -0.47427173806919259436 1.1312029398747329711 -0.063050355780241429393 0.013551785684414462824 0.2750297655114142259 -0.12935361861192343214 -0.028795551799219894218 0.21976228614398693462 -0.49843718982201612455 -0.12171440609167076541 0.16526465537266110672 -0.34660021585964284618 1.3964874531073796504 0.90242652380933596756 -0.04973588550797105462 1.2062354524210718854 -0.1233418373156704162 0.48688884484676858699 0.67403594566760083318 -0.039726050806030796525 -1.090191582839373563;1.2401583968276803649 1.0153044640991275571 -2.5534502766259770112 1.7962851343582133534 -0.82496239110420799268 -1.5155119539186849842 -0.3537866318029074808 0.53483954231679797786 -0.099612117212321729665 0.36147353245836849611 -1.0386586759506171163 0.19294179098710101394 -0.91419851179080513504 -0.34305124440417816833 -0.11565191910142040566 0.35241036512176304729 -0.22889946228612242929 2.6548474177624252768 0.69650579592313888178 -0.45166752869608906007 0.30354693936659221665 1.1616370765558190481 1.888909596269896074 -0.0086849160335414066214 -0.13941088915603080944 -0.38053069174877957037 0.57647170591759300251 -3.0933480450977373089 -0.59751689643206917779 0.74585361659706228554;0.38838783902333123832 -0.94936424375761807593 -2.1500078022989117521 1.0110056509489837584 -0.098632407439790167891 0.49268734476890824192 0.46138107975332104393 0.77978207461399884348 0.1139478614089571018 -0.17225237301195805983 0.70604448218041770957 0.1528111246128029399 -0.096018802592796548279 -0.12986869033571663001 0.11033121450514429829 0.056157728931123834792 0.055474484715956527692 -0.11662106935126322071 0.23524021077738666019 -0.084013913879933815876 0.12778269916556864172 0.16456664663460329745 1.7276444975098079748 -0.7761796714172556344 0.82448638553930853057 0.074518129515741340918 -0.010742053182763618147 1.143395068348883159 -0.46607331525865997035 0.77994460821246358595;0.35508269242976375768 3.1499059364388446447 0.45090813979615568252 -4.3913715060786930877 0.89548321532468988515 -2.5213651059305228763 -3.6796564371639415292 -3.2701158694974541419 0.017640073793635521054 -1.2685041221908859299 -0.35169519702853763166 -0.16421586961631670643 -0.15768560897724615 1.1996700200309247109 -1.0919558932159216802 0.13609043704769235861 -0.19051593232162275515 1.4340300157802312597 -0.56804921308793054902 0.22313414270009193641 1.7421638906381757828 1.2368909870662421202 -1.3808383057339110866 3.7204022131130725093 0.003056485228864735601 -0.49196969710668070341 -1.2892362544655484591 -2.3251268751776037469 1.484112738403011722 0.083521856446856279632;-0.47410822995722073925 -1.7577208998884523705 -0.27237819255818024322 2.0680124694136838848 -1.5092452346862264001 1.0484460377139521725 -0.63838331383325286339 0.98492858625670043349 -0.24236611768099008968 1.1908270662121871464 -1.550490892780084895 0.55839534287534098311 0.35413054326187221044 1.5759914389340128338 -0.43799319276649945065 0.75594802622422396787 -0.51188261323262485014 -0.57389032788470384361 -0.0032789510576717579952 0.25532666487870359084 -2.181406236006207422 -0.41283102240338703792 -0.13259060434592162547 2.3900295971548124463 -0.56206574189952662746 0.49928138124681753496 -1.9917258874169174732 -2.311029671182636136 0.16349008275274859447 -1.1069912761572691107;0.65768328727685931856 0.018647905669026198366 0.52916126433586030409 -1.1930431986175278336 0.018741539262825311629 0.31105493082576246566 0.11356992958801528926 -0.31619469508615993814 0.10877941273171057301 0.84083478840410497135 0.85260055318330096874 -0.049663461936868012747 -0.10953631204428058987 0.0058230412156864020529 -0.17793829057195725829 0.4260259398081355231 -0.16978922285238490231 0.04720683135149521259 0.059243145074860455168 0.019575749326150349711 0.45456828477082045215 -0.41848797979148982806 -0.71339838092628149457 0.87813686075768226935 -0.57300854944105339417 0.20446242050209575969 0.25512354959152777623 0.15688186123412189987 0.284255794402445916 -2.7747595708690209193;-0.90838468109650372107 -2.1003680971893623486 1.7734034574458261702 -0.98611687403286418796 -0.50491253568146721165 1.261698880627435182 1.0622881422618306591 1.4913341119627159248 -0.031081243878408260778 1.6076792094562719626 -1.7381102266736851991 0.13499805385081856124 -0.12251870125470909478 0.39542444681010008312 -0.42101340351707999821 0.46529874745709004502 -0.42698599320831032156 -0.63162361268377564816 0.26021827225478599832 0.10662773421865182066 0.0068689592439721558481 -0.83587600800126726774 -2.1751739858958423213 1.8045748041491060931 0.38613967158418111003 0.31103612447724870993 -0.42563612426267705136 -0.41102913137020674617 0.056305870614286337994 -3.0471918483670137334];

% Layer 3
b3 = -0.15457752802460844599;
LW3_2 = [-0.850098238610094592 -1.184505157940007658 -5.5365453194567955109 -1.6981808848129866796 -0.25881484305793706069 1.0070007711006676576 0.19569421671796258244 -5.9152352482356205243 0.84355417264626020302 -0.36222728817359728382];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
