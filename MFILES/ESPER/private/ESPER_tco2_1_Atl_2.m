function [Y,Xf,Af] = ESPER_tco2_1_Atl_2(X,~,~)
%ESPER_TCO2_1_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:52.
% 
% [Y] = ESPER_tco2_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [24.983536351912036;-0.077811330527298064;1.4835317066729949;-0.60677402177959194;5.1512458172843063;0.15068300673922225;0.53591438652969836;0.55587205174246435;0.3870644651641445;0.35826677842030774;-4.1153802953525016;-1.0569699179703378;1.5985306252887073;3.6525977130714118;-1.6000578117657995;-6.7462377157953677;1.3417439327644125;-7.2159956401420322;0.60231893995698282;2.9151559693405269];
IW1_1 = [-0.77465963263109772 0.55643533111455123 -0.22785147426352628 0.069424174718662676 -29.504013771697917 5.6422338448534584 -0.059997965783161314 -1.0116104114452025 2.2937707095329163;-0.29922916080333423 0.13218172982153378 -1.0814421048301046 0.11279749596517506 -0.93483684808062317 -1.0198437607793762 0.27120091523271345 1.9005266612701353 -1.3855675182942888;-0.17319794875871347 0.38046058948146955 0.34812879045488593 0.45444988281561405 0.08911520231994631 1.0428142061130914 0.43806765395721092 0.26688010318090472 -0.22156712709956508;-0.61390203898801832 -1.2806762396612759 -1.119463179867733 -0.12070882100304409 0.029218602743041652 -1.2423515901208808 1.6120398653051797 -0.61386739877210406 -3.5227121392228486;0.0033771692729804054 0.0014275767576272455 -0.66004441104047262 -0.2758761320903832 -5.2725130610665891 3.3691549305750419 -1.3637291328242829 3.7519457800530991 -0.43708383821919272;0.10285513111560608 0.2467835136409065 -0.1154844487921491 -0.28581723813995241 -0.76683394923712211 0.72705657533517376 0.15119552091871494 0.38251874466382796 -0.41358062691661368;-0.081637962844872902 -0.54521557744723204 0.37318504675400799 -0.016808186669766606 -0.99397144416623628 -0.91957744261750241 -0.32569503758622403 -0.19136260828782606 0.31779486826841191;0.13378856016749865 0.044045138334790193 -0.2151332955769085 -0.0076646491668347742 -0.8849830488067556 0.17783852939974801 0.19651933975688177 -0.66632722382608345 0.05592086431651315;-0.26861451177344209 0.37737381347257226 0.52519759207446082 -0.5473698464000315 -2.5870005830585918 -0.081444472435388382 -1.1182711257523592 1.6778456410776352 -0.041044519470674584;-0.11208484551662512 0.45687417666685254 0.07424893903203672 -0.39240755181906345 0.48971122077209456 0.59239619057266435 -0.22721432959953652 -1.4113956014382045 1.1180526805692781;-0.032873623400226544 -0.14728103837453591 0.4515597052816121 -0.72227892256286441 1.8483256361256171 -2.7564048057296873 -0.93045501265577069 0.1614804320848531 -0.46723009852593961;0.17587464112451537 0.010099582885876089 -0.072493961799126552 -0.3895791621356256 0.11156806367162352 0.10734658322570265 0.17718800072484311 0.28559974151749667 -0.37397325246774132;0.48508651735728114 0.28946226178606282 0.16666298783549879 0.12951379354259546 -0.65324193036071743 1.1902375492719566 0.93620895471337695 -1.452225365216729 -0.52960257491698393;-0.4117817514193422 0.48073456640410644 0.046702040187655794 0.34093043497811409 -1.0189550449216724 3.3246703729075007 0.080079773107928437 -0.13108515815543492 1.4741396795533952;0.55259029538288562 -1.2059413353080202 0.21573357306825491 0.19638027579611605 0.51178352667805782 -0.91064477073193306 -0.69898948869149535 -0.70619902160390047 0.85252310617219296;-2.7299797827844712 2.3706169097206446 2.4633109868716674 1.2180787977025909 -18.539684116333138 -2.5320243943702354 4.998089626516764 9.2742122233642323 -15.160036684122812;-0.52240770370309375 1.0541137255150128 -0.37526400454222131 -0.079349542346726476 1.4449204341366171 -0.54538632355179417 0.91235400925879229 1.1404034425989176 -0.68272353156791465;0.29587712716667064 -2.537345286918224 4.8748505203826564 0.65495864502236423 0.36448194879220325 -0.53135566912387078 -0.16141618640288286 0.84834539472102111 -2.8378270560196617;3.3120992917020851 -2.1457715500482348 2.4898108848258635 -0.33822205903214092 3.9828730577323892 -0.37030202891005737 0.73869963195979116 3.5783068370079705 2.6057640006649501;-0.43081434112158684 0.27931451282307856 0.52529754520522753 0.22633596591936986 -0.28390655969750639 0.38441449488941903 -0.20406100284364745 0.35886499250110604 0.028299551094878736];

% Layer 2
b2 = [-16.119036601009395;208.7849465655089;23.407866096496942;67.97858451705315;-79.389995595399867;36.84743573104759;-11.604865910898598;-140.7027507173257;122.5872593431871;10.502803263824525;0.15864831068108895;-31.784077542049278;-73.051995912787959;-12.702585582381285;16.749848065819563;-17.236325899554362;4.537124944467295;165.9548325980133;-87.375173671341912;-56.653820313333433];
LW2_1 = [-13.705537198219821 16.711000539680182 1.6961480938160167 41.790767289491455 63.058064847966484 29.109637722380501 -9.6470503748149188 -27.498391259416902 10.670546008343027 19.380220374593563 -1.3755383592908941 12.357765756462305 7.4092685394746667 -50.877341810545282 -1.9285500187074158 2.1118989525619836 -88.940267275290509 -5.519344562067924 -3.7666522173624783 112.81458454667745;7.5150828180278699 24.012323087452749 39.766715037052997 -1.5706931702521263 -11.383225166428625 30.544078264281598 -5.6055426967477873 26.183841460363617 -44.932094629634399 -0.30223867067065396 4.0510546403692897 -7.2260356821904637 -20.80788136639433 10.241339778636727 -13.204400661583351 -6.2640208004119229 -5.2696385604670075 13.668362198767785 -4.5031411034840856 -226.38833081402694;-37.517102850124651 66.038253377491557 20.739576408091633 1.8382700289197667 -46.433845176243054 22.370473781035315 33.879482011330687 23.971324803504089 67.84844819283353 -18.865384502405352 -48.661829650743677 -9.739284623045549 20.043701997669963 -38.715424885563593 -66.626024328584876 82.306740849815768 -41.21592605048901 -6.2852441199241014 66.272192274427582 -68.876886527481048;-36.772911363239089 37.797510516719875 40.885710172317665 -65.670858569918295 94.255398298834464 13.892768840584269 -33.532710956331087 61.077606300216864 -34.480541371053341 28.845206740641018 27.784746387010959 -37.82244226272914 -21.404327609153938 -87.306924600446109 20.238142038416669 48.146582904375954 -38.235509183718918 19.027258105763682 -39.451609082871151 37.569968694213685;9.9237145641498952 -14.329645710582195 -19.705055894377733 25.351770010013535 7.2795499054936066 -31.438069508047061 10.573345240568269 -7.1183567349713881 15.887962605352049 -20.043422308609017 13.254440247563567 -6.9467693044460486 -1.2813574126018383 17.35080576321511 3.9118799487291125 38.113829078855275 18.012511634826552 -20.822920196497648 36.30563785731627 49.608384966495841;-3.5732377110110325 5.4622300945741653 1.442876672357045 -33.051286035226937 40.633994203464574 10.01486482653706 19.433123884206601 26.989986690643221 -9.6603655067366283 -17.556830371478529 20.592477151574911 6.7883463109361353 1.3792484345046081 1.506134674151649 -4.0331642630169799 -12.164209157980789 -2.1357328049009943 5.1481117015585136 -21.4823940687392 2.9209654937465594;-5.7362477016999982 -2.3837443626362664 -7.4027933398283778 -4.7381641013007298 -0.52102393399212521 6.838517743118369 6.1234831852801284 5.6968971564488617 0.85246697676746497 3.113011231239839 1.4076162916880939 -6.1347828455006317 -3.4225249483886029 -2.4349068419628264 -3.7940806681358321 -8.2144207702862353 11.908979327780099 1.2902657811559002 8.8215870449726008 -12.918223559390308;-31.550821636009516 14.821088672664073 196.13266624198462 -6.2536204952324494 33.424679898389158 -136.39326634228732 -31.919425327235423 126.49527994689321 134.55720061940283 -21.019336119871621 18.782808520080021 73.307183476564433 -20.515995512249781 44.574020393666757 99.704403175308428 66.795901442094546 15.856499052768164 -32.157006680402709 158.48638254582565 103.38071027754606;-1.993389581546485 -5.6810769374180792 -3.6424164593096249 -2.7482707906875974 1.8464940843202844 -8.8812650872403847 -8.6812209092465462 9.9360527275560599 -5.8799942094291024 0.29271546016170163 8.3578814723824379 5.4780666228235217 -0.4220423667227905 0.35928642327186161 -13.495607270070559 15.911458254871212 -10.942870840973956 1.6999482318392167 -89.391731410917956 -5.8726712845433777;-0.4195176899691605 -1.2718576792265006 -2.04353382891999 -2.005501232018883 -0.69586024522025414 4.6700000809199196 0.84840831201608802 4.0458038364294824 1.7912742220226689 -2.4639559553368002 -0.56045382392116028 -3.509713789804179 -1.4180582269399169 0.89327176806244046 -0.75477612595512411 0.019112062239762969 -5.1217378493446013 -0.21294135793068841 -0.021337780040737209 -0.88689519481330648;0.021534802083303672 -0.87217198279927621 -0.7262616288044289 -0.8857001330191312 -0.1685192165829825 -3.8376720494821419 -1.99073108493273 -0.0011317432030741453 1.5248964768108273 -0.67809569859994268 -0.93020228332097032 3.7077431661565687 -0.74708614682871688 0.34562092149358831 0.19493471643264956 0.064621252411391772 1.701378208828328 -0.34489790023592404 0.10341622091820706 0.9907953439079441;-1.0401501182009325 7.9240672711624045 9.3376786004246402 4.2174881496863819 2.0833129127752987 -8.6726801692292632 -0.14375391063996293 15.385437338264454 3.5695373911333341 8.1633528330407881 0.51286486085748539 6.8033322574649935 3.7427996750568835 0.30784374159980599 9.4158321431373544 13.659764709296157 -3.5487457845449262 1.9455330146149754 4.0537496879681409 49.057498776364561;0.065471190126380474 0.7850712158731149 -9.0451091220019535 1.4360210451933528 0.48232898877656655 6.4361961656767894 5.2097009882120879 -1.0997064055632526 -1.9051950922933942 4.2498943279453352 2.9039753329485647 9.0507288619332442 -0.93084765517469803 2.7494844241856016 -3.6632665492776386 -0.097119344295248752 -0.73788549638551681 0.90287784718228126 0.65928490420010755 76.402748806114573;-0.92373718383990899 -2.730363989436583 -11.406440786888529 5.8177742777121511 1.1188307661828278 -4.3103558368022608 -0.18706197835966204 5.5467994924748769 8.1204322486515519 -3.9271312334277213 -1.1943756514007595 -5.3562909396717409 5.7268025420610966 3.9802280744256868 -9.0333929247675453 -2.0664050795690763 -2.6830324880106882 -0.46647852430259545 0.16537837449238457 4.7213869134051469;1.8721978440784903 7.8087146010395543 -10.962132801930643 -10.396866967710016 -2.1560403722137664 18.496183533174634 13.946255383874565 -8.7414500253794092 -6.0355320644506953 13.95331648350095 -7.8976755321567174 -11.006465734191977 -10.000140675997665 -9.568629503256183 -10.729322887010321 -1.5082120518755515 5.6235085293569327 3.9196690119018367 -21.158881963459365 -18.617438227577239;8.4806213321264519 -4.5043486286745464 -5.1885330684240474 -11.644967976337748 -0.42638129639247674 -2.9994789384348244 2.9912805262621465 -2.3085740534810428 4.4975938445924442 -14.180607582400333 -0.029331956016428878 1.2614955611037513 9.8730472895745365 2.8283778283019942 1.7408798120793527 -7.0093611425605378 16.669114691397247 2.2256056837445333 7.7203977929552012 -5.4029291732928479;12.15339203209021 24.503757386661537 0.94493621885744494 -16.46066186575052 -6.5847195839549597 0.15427153049128028 1.6883461324615823 5.8761690399963156 0.13520795908111161 -15.098488544108614 11.873702599532729 -6.1364396297182173 10.143934325314662 -11.173876701083922 -3.9137414546982487 11.739466002228879 -13.427030870947029 -1.5612317962910656 22.828394142612417 -13.531332233543054;0.93723313112412354 23.751039749787761 -10.859026483983346 13.411350581779816 -28.346059027802987 2.8617028657521759 -6.9734005960644598 -80.687798418429651 -2.6550290187408323 34.247490122456668 -10.998147037970323 34.447124279063296 10.033812727753658 -13.73915525295206 7.9314384188986642 44.633778547380196 -79.641324544930711 -5.0131382763723904 15.200630482173676 -73.125038409117522;-9.2174201403442417 -18.782055245888163 14.302656261219543 -8.0305126583157929 9.2223975978195352 -0.04899406460126482 -21.759011276809265 -12.208919932647802 -5.3436358207057122 9.026720556031643 -16.132786080367719 6.1051897210116319 -29.076354582851824 -9.0461346367688389 9.2213920842742088 2.1132115411179675 86.74263546437686 3.4483170825873719 -5.9009886110153245 49.316659568007381;-62.140439520087284 -12.884041144003948 10.763938108521407 -16.727541618499988 -7.3590413794624681 6.894434524644276 5.5016477608960628 3.2146189473636779 -8.0052974528762935 8.7494667370790484 -14.028389000468035 17.652312046823234 -39.631777967115866 8.2463266156825945 4.7074905539603087 -26.657657977094715 23.149888897017714 12.704085134605856 -0.73446589954401698 14.354124640426965];

% Layer 3
b3 = -0.24221260116053159;
LW3_2 = [0.00061365246304429357 0.00077526730529827673 -4.1153781913629002e-05 0.00071048449154474398 -0.00056833628437244032 -0.0011224203768549323 0.0023937944099082032 -0.00086854480915046317 0.0010167013030679814 -0.062877705786501148 0.1261539380295193 -0.0064464144320002361 -0.99880427402438476 -0.027067036472418791 0.0015178030362099871 -0.0026679382308737788 -0.0018752833443667169 -0.00060651512073358314 -0.0021973117533914972 0.00057507736178917621];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
