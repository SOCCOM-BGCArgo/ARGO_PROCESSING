function [Y,Xf,Af] = ESPER_pH_2_Other_4(X,~,~)
%ESPER_PH_2_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_2_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.0422119037568594;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.6441405127649519891;0.88422423706704944557;-1.4083758571939923865;0.046701584432761802934;-0.27582825592670368042;1.6664591404790485285;4.1007840295638855466;-0.091318257453938941892;-2.1302658697221401596;2.3522985038936123914;-1.4772044391192733492;0.33096107476610509002;-0.012755559953826196493;-0.74540601668387729273;-2.0339899643618104541;1.6843014952294166342;0.70122341741233940038;-1.519436946496406815;-0.20196705678726858957;0.98006404758658960397;-1.4356549890751639786;0.40558022989496800292;0.98214760540453671656;2.2481657874375375883;-1.4101077844256801885;-1.1394703625465871788;0.48560798342081679113;3.5455148029307053115;3.5909368613329912812;-4.6010426345588362196];
IW1_1 = [-0.9623990739261717442 0.72850798666704841278 0.40010556027161037207 0.57291043587111778468 2.6875009824925699675 0.97371041823101089907 0.50518607113750524373 0.66310257986427423305;-0.38691166399656345964 0.23121173675098069533 0.44224599960226068651 0.28845061115302284005 0.72478643172492751567 -0.7306774628872799715 0.070570640897725508967 -0.1555909706955769245;-0.15951608233371125656 1.0701094524021488308 0.68891741329244915448 0.14912996080066998061 -2.6362505375310942846 -0.43406929750481193508 0.1586857196640655554 -0.098838739484518725598;0.74840254924163407413 -0.78293681250020596973 -1.3803022318367350607 0.94955700584812630094 -1.3955886787877520572 1.30279787884932019 0.55483675059455894729 0.62273462345304442245;1.3625583178516316174 0.061074369626228967867 -1.4495741407858533378 0.49801751266698462972 -0.34997651949153296691 -0.76166277875886800874 -0.41552359983611208971 -1.1568716091240618393;0.32376540552056265465 0.36442494457397123231 -0.46537342648522334043 0.91209229092838250974 -0.66803567397554219909 -0.8292380578182835249 -0.89432378372206300376 0.51467276805897177461;-2.54246011132296168 -2.6225330927390286817 -1.755506221367523878 0.49910790303714563931 1.6078133752712906457 2.4331024989120981772 1.2298613292589322121 -0.80160213746060615669;0.33721646562495738442 0.39016116942537931722 1.9507683738155614517 -0.22409379137335788679 -0.90502771170017404234 -3.4785808588588493784 -1.6904624546503999039 0.93503905424906452737;0.70093481984838834631 -1.8840976117720922289 -0.06878707018567933873 -1.7451930382866416291 -1.8756076834657449126 2.8652623840019892931 0.77443088806427151649 -0.55108173427469420158;-1.044606649392172848 -0.36181910492373270394 -0.89775239993636157809 -0.044142960278452166023 -3.1870372484976980942 2.5468097099036044462 -0.050056628903065128466 -0.47892442110322380744;0.66296406738170288175 0.83751621179684720975 -2.1280852420570810501 -0.27184324344458066225 0.75798835439460798824 -2.7965933002029652599 -1.8855342798263925452 -1.2636011351933353897;-0.93857094673391827655 -0.073062385828529460841 -0.42141912589013985624 0.072102913841934693218 -0.25127685967564250547 1.5820766236044425668 0.84690450001422978854 0.042622709631607462455;-0.93030919960071456476 1.2843341550556433006 -1.9979053562963255963 -0.13058950173917080462 0.63001068696910533795 -1.4489392695060374638 0.030310058817188748059 1.5417177206055954208;-0.085875719153637480874 -1.1917058820418184872 -1.0052338159188933808 0.28436663588342736553 -0.37027701219329395288 -1.7850012888725592664 -0.47026928994796196593 0.73212266339934461978;0.88580655387396622924 -0.27168964493261027471 0.32129292182618235385 -1.0212687068547043889 0.7502775929154655854 -1.9576346868193916784 -1.4148795197539816293 -0.80241096897996910808;0.32152247698007330179 0.1695251548162478028 -2.3949995895791378331 0.2489546343836404052 -0.15820857640104202257 -1.7960663899450817205 0.7373394072808397981 0.22002929885019195666;0.70122492034418892892 0.15846915127302529935 -0.38607100949293404746 -0.12254689033151430766 0.49658452668142749609 -0.28331529815880229783 0.16344344463272006407 0.096670629896455126384;1.0899699479332813912 0.16072976717856565787 2.813671127688092799 -1.1983917380483959381 0.76197284739500104056 -0.56633743145260928564 -0.45558536646263264602 0.49861153825864290567;1.5962614455220525134 0.19709326015407488408 1.0471842040956178543 -0.48762240802002448925 1.9893395867519854114 0.28374591589220027332 -0.72271050841883621718 0.69449179188309684285;0.93662780575552440077 -1.2819175008357621692 -0.3196136092214624802 0.70648854005067363016 -0.8550146135576124351 1.7477575855218328016 1.2061537704786908787 -0.36558502891710586979;-0.65296272792463627699 -0.0022247892307056356051 1.0026480597383298221 -0.04412137326186085784 0.73065163991723558468 -0.082991741211932104627 0.15263753506856098108 -1.0791896320990979063;0.85677301862753785233 -0.47045079065878875335 -0.59163928873932780661 0.86335515230353920835 0.95218227078314499057 -1.5836317095940442012 0.29651995416052878696 0.59260682857604973783;0.10930871060852964671 0.48512683592753846895 2.6446831601451314953 -0.62409675245323570358 2.8878034692480469836 0.81043315501328216932 -0.40797014877681070377 1.314050752627826002;1.0504557024048015723 0.51308936746612709978 0.7037928954425262118 -1.0983963769559110801 0.046755003982369904014 2.6827509783086762596 0.56986527917474161242 -0.76875038392877681481;-0.097871742294055680267 0.66120525431228260871 1.1071123446483490671 -1.409313770220316453 -2.0843549965373755484 1.3358438496353166602 0.57892046860405099729 -0.37363714823236821028;-0.83815394458045322512 -0.50274592783616978142 -0.30872641282898155568 -0.20753859630742801934 -0.37857282159295108093 -1.1623063912488338367 -0.97587771645474452598 -0.32337750296204320621;-0.3037917950267494116 -0.49386906229917731936 -0.06819529937300609912 0.16965285120870832181 0.25135625573739284189 -2.2453021589639323707 -0.81951464755557190678 1.0199991858217147822;0.52839570118384093789 0.38378457536071619582 -0.49507874977060933874 1.5635806238551133163 0.047849449244510754153 -0.20626895270288841955 0.6431639335901658816 1.2713093912587243306;0.67980116010895530465 1.919570725119600807 -0.9807313683867229237 0.34861718598897589727 -1.6264730651930927596 -0.49863847171601882735 -0.50589280361374489026 1.7424755813238475;-0.25032567188947429937 -0.20890380839827257797 -1.696157718502047107 -3.9056014990109875207 -1.2668974877931948875 1.2870724066593641766 -0.74216161762182575323 1.0218776528810773474];

% Layer 2
b2 = [-2.5560736535727177632;1.2636722889256810642;-0.28411346678612048322;-1.80251011061169919;-0.30888070352306173927;1.7063212492844364032;4.9605707590877967661;-2.067852767811659831;-2.1737099305377807212;-4.3590028507114091383];
LW2_1 = [2.3895773369232595762 3.7788703219108636944 0.78637102740020936587 0.079950658074710426182 2.0933425189798122723 -0.97538464663477097982 0.97767357368014473629 -0.080789501645753533654 0.61984830030181881089 0.46917967461478476965 -0.18802933228508433849 -1.2818691051808481784 0.14975804991741548111 0.24911095343493086518 -0.58429356289586864559 0.62415871228471520027 -2.0820438054011010109 1.4810728952578098294 1.2870842244203266613 -1.0022735681772814154 -1.1407101638453782666 1.0101859582479235655 -0.69859862590608123867 1.0772467378557437634 1.1759784017352619134 1.0865790785035298605 0.2035751956561961673 -0.302203076039822216 1.8840766146216003651 2.0718749305140806705;-2.2172272982818959086 -0.39235110924124000364 1.2475099681454957512 -1.3264745176819749961 0.54041889323623226726 1.812485090421659395 0.14448876004875244039 0.38857090797365589907 0.14619213783442247534 0.24260782564810534634 0.27608294709191738558 1.6495480590918751851 0.028794302588476629323 0.36495383881865534059 -0.26902504923172354534 -0.51650531141661004675 -2.2102083467110875681 0.09971501495338619403 0.55119389318345679563 0.85156841579684749988 -0.43554819417417900418 -1.135749238946125228 -0.54833399261233728428 -0.47953452065514129421 0.08063174766716468822 -1.0971651610752728434 0.1627667647598930456 -0.38065061745342843036 0.36275268522894371648 0.33448489325089386659;1.4527562165577920794 -0.1817753106053247858 -1.692754917028959305 -0.037349518405036835622 -0.596085872564333763 0.050836033602090449635 -0.081552902882114600147 -0.70773619897542294765 0.041214220353832299593 -0.15155723312525137825 -0.33930987092906667035 -1.2522011082782520397 0.54767896286307837794 0.11533907259877344831 -0.3791001354057350059 -0.20157112592502263171 1.3214457445861687024 -0.03929883058702731552 -0.98123394493992022181 -0.30339868895577454255 -0.6161564536009946913 -0.49487861612888667251 0.4104701718015866807 -0.67491720383866071753 0.53486109722652130927 -0.67827171409190800677 0.36723352839341399934 -0.39780264407213367095 -0.42874248891535093886 -0.95357951700257781447;-0.57369721113258509426 1.283001406417239032 -0.2114897077840449946 0.30356549231561835711 -0.23812674281943052579 0.36129238980426975347 0.16965407971466753279 -0.057008658415642982087 0.17057096214657122002 -0.32419706475873849572 -0.13199065500516685145 0.4363422743231206713 0.15631718996589119564 -0.3817577368878455335 0.22892235684127246187 -0.0584115714446870396 -0.32071276849392765795 0.2905620690476900525 -0.10639756742235499665 -0.13859423782732938069 -0.14638145729060961231 0.33993331873058196813 -0.039055060709448974343 0.24004322685777382262 0.13074163946615849352 0.10664864505691029617 -0.5269888777055807827 1.0268858606504751574 -0.52892990779084136932 0.64134624734016032477;-1.4354519168191284262 2.9500469420017485511 -0.30437015984632981302 2.2591746985228411404 2.1843015969540795496 -0.8038166930183204828 -1.1510640377116505562 -0.60805113374375707735 0.84600341222778430161 0.45616624746186029693 -1.594674522063053379 1.2729738466581204115 0.0019726951493799910198 0.61244406632424186476 0.39061473972968452362 -0.60903390305090088219 -0.074442285206199082515 1.2211721349840267692 1.2845066428527791569 -2.9012345069731257929 0.16491997255612236839 0.84411283001985015773 -0.50904380604435206514 0.064518273463924205591 1.6339865777879492015 0.81773567703292726616 0.54779022915342234779 1.4451477654685711549 -0.26521352355931127054 2.345971900366408569;0.28388430968009364941 -0.8550810980982622711 0.37151703798069551921 0.040557543346512875404 0.33973272272092158719 -0.037944595825424934366 -0.20390167513075982408 -0.011355016724403838024 0.039761985758103732258 0.133917550764591331 0.16906988992859955934 -0.013641194620224943168 -0.44932209277335305453 0.1370744173801521637 -0.096040213754011755087 0.39557988109235481256 0.059656528404110176211 -0.22656088976666211021 0.39081266743893972038 0.089777617874706547307 0.62944887792341164268 0.13081054898768634809 -0.075246115172720090536 -0.0084290648028572893319 0.025518678789998010953 0.099480365753858046585 0.45863481499878500092 -0.80350611859937359771 0.43269364131927690043 -0.5605101313537340646;-0.73097791930184730091 -1.7172866124876027261 0.60934111670284796247 -1.0435036898918266246 0.29112441195541205463 2.0058278089689056678 -0.50535088071290945599 0.79001175057939887481 -0.67664039036796597149 1.8097865546080478261 0.47818880150754028424 0.30997455891776876102 0.27100042721800371437 -0.070762641696604108854 -0.91347440922807388031 -0.22284527192947461982 -1.8823408953528026899 5.140456003829267928 0.22171644355005090676 0.13982694365697131977 1.6289356758504203171 1.1201130045471145991 -0.26387574314471834436 1.0118066660482571972 -0.96097943626042381382 -1.6177868827294927812 -0.46721430952746501042 -0.26811650543489640164 0.19226281451684387735 0.424278775874548153;0.47487035765482782379 0.74097105822478759318 0.072223060901947272461 0.24311993224196362662 -0.71515021760864316835 -1.4880627284611767092 0.70932929264977062633 -0.077883116602758484248 -0.50825129640856481217 0.77595824268290591874 -0.14280407686323903782 -1.4377350994127346961 0.28530148160249990674 0.1256140061012492315 -0.61563127060340239183 0.91708551607262733807 -0.83324848514780458508 -0.1100534394556067358 -0.23042767658876509018 -0.18469012652515295891 -1.4225741868229635489 -0.47803400372770016302 0.14354321609543013727 -0.37592252563856798364 -0.55957397342279846519 -0.71799346906848182659 -0.31757356489139160205 -0.39889564670840832461 0.14506089152292650502 0.93530270269472060019;-0.84260863587813306097 1.3427719138104485808 2.6042556274555486162 1.1737116464318084752 -0.28412915205950184383 -4.0303266482995878661 1.0645158301775339282 -0.053889432193151932948 -0.34010195125007691708 -0.46123850830485768615 0.25098624997540336379 -0.91902124452282096811 -0.56164724887020844868 -1.2692795316488385549 0.56966913469711610851 -0.30249663483163735656 -3.5345144383286934975 0.073767230487901042091 0.17941706242553431827 -0.086336633750560901057 -4.8323959124855742076 -0.59290040304966284967 -0.1835818910740384946 0.14360384982870813553 -2.092748466237034588 1.2353799096761912679 1.4733496186812409245 1.439438067498774787 -0.36041530068919924723 0.10658666191217680552;0.55526047252914290109 -2.0431490766071260801 -1.3730715175987167065 -2.3715249900796693261 -0.68100843046076353637 1.0569085336185155555 0.94948242960347939423 -0.80287398292662903732 0.45643958812492191335 0.38836536150826417302 -0.32452646372382532025 -1.1684704850911438179 0.26412403306334231168 -0.32455896882631291023 -0.56478477526594339508 0.7677403721498349265 0.6009455416127217342 0.4416143331515439141 0.065909730652824072283 -0.92390108776709922722 0.53289920455971051538 0.43849081868199962786 -0.036366705252771913681 0.29162996279822583912 0.41240379063023852035 0.049214842975943307035 -0.04024771591331259557 -0.76938001193080862716 -0.53380715313884885553 -0.43374843309168764627];

% Layer 3
b3 = 1.2963124613128760299;
LW3_2 = [2.6591296552156364896 -0.71053494253726001695 -0.50178051256369182731 -2.0887493648383665956 -0.33333607709651125184 -1.7792897187098655198 -0.24285891857153757423 -0.98740051384724680794 -1.5511860942516777495 0.86417711872522395833];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
