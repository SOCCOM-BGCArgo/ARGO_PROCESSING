function [Y,Xf,Af] = ESPER_tco2_13_Other_3(X,~,~)
%ESPER_TCO2_13_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_13_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7936158811476375;-2.4641825676033919;4.1336372294241945;-1.4274767243341755;-0.18292917837290099;3.4969125067857396;-2.3217501619671177;2.422840341381697;-2.5404212633324716;-0.79740825251741687;-0.14006014752533619;1.5102320240578873;0.79206498914018786;-0.68835283956616133;-0.73075227402245058;-1.6840293844959744;-0.091405596150083396;-1.9734252929976681;2.5889801132769512;-0.85918324265488732;-2.1020401646488476;-3.1370327870456745;2.3363516791649648;-2.617583982639343;-2.8769234888247084];
IW1_1 = [0.11447528391661085 -0.75846038492167489 -0.62536583080784691 -2.4681379753480464 -0.22791322073075762 -0.065800897230947161 -0.57444792312726078;0.25840854702312233 0.51224899873191598 -1.9790565895650374 -0.96811190808261316 -0.48728755107533978 -1.1372499280932573 0.50258518972219735;0.045752207908036052 -1.5067550725849557 2.93776595037715 1.0755886935499739 -0.75562890582041531 0.17368330851695996 -0.84215583016006335;0.5772464710136358 -0.35403225439656466 0.24599703945902446 -0.11907570723075012 1.0235858225419361 -1.3022346900698432 2.0724937146384041;0.7150017710512061 0.29221589728685105 -0.64164340235453998 0.19386166053218251 1.4569896742338944 -0.031954789962837571 -0.43311585543271491;-1.7427827280904282 2.0688098054610591 -0.81643421458104237 1.023237481877419 0.35493691473644551 1.5714326497461006 0.12826597033793666;-0.62283114932484474 0.061650679674132104 -0.024269234396383281 -2.3003088839585453 0.64930548285930834 -0.661464172728222 -0.30119761847648618;-0.17697011309399341 0.5017502855760001 3.4773418633163056 -0.012820893358484887 -0.4332118425594057 0.40641583203493298 0.070162338225813775;0.7842118049472061 0.12221312105325671 3.148517832276529 0.92088282232544483 0.56572418683192671 -1.7010778687274288 0.70859988368735127;0.11905034918494785 -0.19055159242897132 1.44947983711526 -2.8575622973916297 -3.5232605951268385 -0.17028936276372261 -1.4050394933344283;-0.91015376208598164 -1.4620842713772579 2.8826363549242338 -0.13015545188046049 1.0674796518139584 -0.34494409306300589 -1.508778135475513;-0.16894338510429674 0.22048433130563683 -0.55378663912646253 2.2225835497155635 2.7193369168804407 -0.7151759996856103 1.2760712793363835;0.51033362859324427 -1.5492855619213248 -1.1625304857157102 -0.70881064595035725 4.2498604061716252 2.3494450243797442 -0.34087342655088737;-0.77106150611952118 -0.26570287277297283 0.23144156382245851 -0.35902050138908054 1.3820780812647442 0.53454514229485584 0.059579669552381184;0.68952081673303645 -0.24082175837261019 1.5939969531428393 0.44660581187031706 -0.1679234757997532 -0.54479159270390631 -0.85224610423542557;0.09470052134264681 0.39590718253934581 0.055627922471747103 0.11842116376980105 1.9038948661589272 -0.69381848922522971 -0.22235575332418442;0.052221418477258932 -0.17048027835730947 -1.418586545514398 -0.31645853762001158 0.25548585254986778 0.46800830243443076 -2.5557250323380898;-0.25811032094797215 0.60289530078842268 -1.8813216942241744 -0.42529773486006417 -0.61098727016959642 -1.3520291335085921 0.30712614601230143;0.72528458757354464 0.20939732203043826 1.0180883680978685 2.6227234093881528 1.6506250831743887 1.2374366939035892 -1.4680657498190897;-0.36333551424544031 0.20724960570753573 -0.33657006992766936 -0.15844270361056439 0.23183570935338293 0.046935510305009975 -1.331369317736977;0.44799800604870083 -0.32323024860853417 0.61604952653335732 -0.36050156915563969 0.82219529497310639 -1.1724477664874691 0.3634522823073314;-0.91926278946375573 0.96083814496340159 -2.238952561053777 -1.4325294528857651 0.71648395208029036 0.060979936171203647 1.3135260643053084;0.028842879777901936 -1.0079092090077231 -4.0583837192288073 2.0530524667014936 2.8542448787940939 1.5489483892868621 0.63923522454737158;0.509097314737047 0.01455495782883599 2.662315055017392 -1.9583345143888999 -0.31389430759326387 -0.94804886103869823 0.35170383314943843;-0.72725912089114086 0.14955130487885698 0.97027561720821454 -2.0594083274470885 1.1629038075420277 -0.15047997768597765 -0.26858935110445309];

% Layer 2
b2 = [6.4757756992454159;1.0838156809919608;1.5405747521688116;0.20779058998157152;1.84588472152892;1.4734634004483003;-1.17740088696767;-1.0361224555275717;-0.22156346460395704;-4.2450661905364342;0.6238762562495197;1.3402237871934022;-8.2441954338776817;-1.766429001430015;-2.6670661481579634];
LW2_1 = [-4.4328607058527645 0.34041847822415477 -2.7129566218329684 3.9519125348146376 5.1721040165384897 -3.0394156776733658 -1.3085797890480437 2.5587753981412282 -1.9892327303466451 1.8429149685589938 -0.57918658974096981 -0.7449910657137605 -1.600012987281269 6.0572415910639474 -2.7352998196146494 -3.6044785253489136 2.961163388254664 -4.084989865081214 -7.9803583555720845 4.6856811903576743 4.373114374089333 -3.3099222820281038 -0.0013298552087617523 -5.2357374695282273 1.0262503806941057;-0.012750772829700533 -0.94946790557473837 -0.051873486945547616 -0.40209066960431672 0.51640403500374288 0.34251508810219 -0.56211829311625183 0.011372870385401867 0.46372198349850435 -0.03427839304475138 0.14039197025676811 -0.20399459489278834 -0.075257754350126743 -0.098503327871992924 -0.46331103340257518 0.31108110531031968 0.12319437934853332 1.3179879748847931 -0.11390855978918248 -0.40866716554803295 -0.29951026464363095 0.05334518082677274 0.76914572277994075 1.0013209636660143 1.1744312613455479;-1.1612695362626486 2.8303234280059741 0.76839749808605196 0.26818655320604012 0.33934892474211525 1.2422893764436116 0.41557381444874936 -1.0221021737842184 2.0446117884444259 -0.032714729465470924 -0.33563183881009029 -0.86952043447231941 -0.49295167494654885 1.5562578507054983 1.9723536055009234 1.3850781854577989 0.4124972985618181 -2.1194502491147613 0.059405546677051821 -1.401730235670678 -2.3377337625756094 -0.9972942707221405 0.62470274006777304 0.44546397703242768 1.5190452658621165;-1.4828422878167513 -0.50186288501967946 0.68321516978450902 2.2801157358101105 -0.80699787924797961 1.208743222504721 -0.095995954422363264 1.2412425525712334 -1.2703533074674145 -1.0011858637033708 -0.92311208846054182 -2.6849045332173338 -0.40144862293710765 0.56325013768928034 0.11685635844257755 1.1757629110715651 2.1666233296465975 2.4486046861602553 0.13776742271834511 -1.2583023762321393 1.2183568855754965 -0.17101003873219733 -0.3555636615701383 0.59641944721566553 -0.90650044407255825;0.29003825348802681 -1.5238519947215434 0.0387414769812299 -0.5311917975476047 1.3322398315545967 0.16796900446358864 -0.98003326148815195 0.68809687155377641 0.25339136345388313 -0.24457957300599398 0.35078502555019753 -0.24111955810504551 -0.11655727302361123 0.076381944542030067 -1.9859057764381376 0.04325121873965334 -0.62907745589956321 1.413235950620062 -0.20291938448517369 0.90927072305050138 1.6149447238262029 0.89810274964310532 0.78693450622551031 1.511175061298323 0.63938147097258924;-0.18954794791003768 -0.80776741846605382 -0.93190973875350225 0.91194813538981012 -0.23486307527120595 -0.001147377686478256 1.2937446172743348 -0.58967536833201861 -0.35977599759516854 0.28528350048295059 -0.27170589444210685 -0.68453164984204895 -0.11669394206876971 0.31876735833265252 1.0625486955245496 0.50528221434364362 0.78459447627209933 -0.10755725673730326 0.45886313871651391 -1.394695102557483 -1.2049944204572729 -0.34603949026629238 0.13444904315609132 -0.87833006136860825 -0.31870385500033055;0.2503646556870377 0.78181289495035577 0.048710298976658205 -0.33707295320494773 0.18715710046804701 0.15693221897726961 0.33281406765928012 0.63770445215101879 1.1465723384394049 -0.6614171694605524 -0.0037854565643470383 0.083438856764280173 0.15818505134441424 0.24475718137859204 -0.78373876083597094 -1.8987708708172977 0.38756194634053687 0.038149639655331455 0.35371192088345077 -0.51465583925651881 0.38123870465811627 0.20626307559697499 0.14019744709918658 1.1916370040511082 -0.36815225960986975;0.38924554031072733 1.049041770587082 0.74638225914973344 -0.70442856324482794 -0.034903849553487992 -0.43471061176579973 -1.0252816896934771 0.52369390275796601 0.020455280170687606 -0.38013178948374271 0.21179515508458441 0.50783645326676485 0.18725749898498639 -0.35995397530679735 -0.61359612326834845 -0.22782880660083246 -0.61338032459980207 -0.28021401474526891 -0.28657145238264181 1.3857485756855057 0.43187989763700257 0.26887594612061627 -0.14052731393683845 0.89371182442826713 0.26580917100566109;-0.022090367779316472 -1.488465938777807 0.097737924352742464 -0.14268169157108454 0.6230153433775879 -1.2996802799262563 -1.2003818341876187 -0.42494224253700819 -1.6095199635002584 0.22844353761059399 0.6433246462378136 0.66317443648129204 -0.46546143332780637 0.76252652363881068 -1.5415920718487548 2.1734164883629488 0.89687409399254892 1.48102863737705 -0.1513182687210031 -0.88691435197781865 -0.093532085346081428 -0.3982317847401734 -1.0223907368949656 -0.98426451584843633 0.82022310869256332;-0.75336596436319536 -1.3294152223013389 0.40859532413501537 0.46534605622829511 0.14418750499048597 0.13891047370845314 0.5112613616205719 -0.36714032741526154 -0.62352866662812667 0.82504007032366944 -0.20365038048700024 -0.15126421371139903 0.41571808737932098 -0.027530141159853319 2.5828389250465418 1.0039218234960086 0.067509188335571457 1.9679223023987371 0.12865640888139698 -1.5698992488286012 -4.2590438279314728 -0.23247328608632592 0.8752541989415028 -0.93492510762242842 0.15278441560091838;1.1287307372918218 -0.63166023345603661 -1.8182605908614609 0.018565771427919556 -0.38445782440620441 0.86642351460961997 -0.9589276095698207 -0.5913257335077452 -0.35533790611661964 -0.68057640704273958 -0.20589797242069649 -0.22482557239372999 0.45943440252961865 -0.32088163220153709 -2.4021623317032996 -0.048384162818657303 -0.71049614705622899 -1.2975367811658118 -0.29519337934367379 0.7780602254711132 2.5502035789446098 -0.11021402928688656 -0.45151424224328984 -0.95504927124993277 1.3420647975240494;-0.089596829812995632 -0.10205067802468509 0.30535953285150069 -0.39451083250100427 1.4430203135322663 0.2007461958640131 1.0882083132790328 0.46122927272244768 2.1839254495214884 0.38241805238256082 0.11881769716683979 0.23496894101750007 -0.21043924557891194 1.0109554878236737 -1.1607443500078247 -1.0339737327571783 0.51113587307257735 2.1586612863340902 -0.21631119913280669 -0.72252539810936911 -0.31480111076135392 0.1637042962484809 -0.18704311925440908 -0.3936567577218012 -1.4711841164034465;2.209476140256097 5.9181611136706618 1.8862720052348358 0.34926516751824704 1.9707402112712327 2.8290349790313316 -2.0210528392066887 10.002354494441864 -2.6206502330285928 0.58867027729059684 -0.39385584113988792 -0.18556644597512151 -1.1419136723642556 1.6659709783580421 2.8650569500051595 -3.0600231569832732 -1.7867598160412144 -1.2408064756124482 0.42046131380390545 1.8323429540381664 1.9323283190178742 0.10594881396590798 1.3820933448714872 -1.0169904565327239 4.070571350798379;0.5759964104473202 0.2300086504351023 -0.62829043705569332 0.59706989899302954 -0.74155809511290216 -0.85226525770941908 0.33735084537186133 0.5315665124870258 -1.6080688817469437 0.44600008526557661 -0.99444916742502543 -0.47689029670591587 -0.95495222951890635 0.10671441863575529 -0.43517765538241626 0.6457585576703031 0.89851560495744487 -1.5509356572050703 -0.3329986423300389 1.2354621962879357 -1.645979244543184 -1.045074690101168 0.51633679564839774 1.3240837420776537 -1.1623694794508646;0.42919702708767382 2.2711585982331881 0.54302497489187362 0.78492992699184383 0.081318686587190186 -1.7631461353613194 -3.2606372406321062 -0.32113733907316117 2.6694492049213929 -1.18066582991656 -2.9515469171873536 -0.82158861073569267 1.1099716973299314 0.050618227213180753 -5.3939970232860599 2.302341702759521 0.40164725451346306 -2.2123426433439577 -1.5367856673000537 5.3625650647913226 -6.1186590532437162 -0.59528903906345421 -3.3769007509207403 -2.0843666553334934 3.4832082727702023];

% Layer 3
b3 = -0.18608787427595197;
LW3_2 = [-0.090027774878055675 -0.72087631908544691 0.21033021472563887 -0.10716261619634773 0.42897017764460954 -4.6150592855165939 0.47382757161113692 -6.2945197189177744 0.12646708188654757 0.34340853213036993 0.17549259045196539 -0.63276100354081788 -0.1001948903298087 0.10205676706205051 0.061051196026820083];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
