function [Y,Xf,Af] = ESPER_tco2_9_Other_4(X,~,~)
%ESPER_TCO2_9_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_9_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0419287211740042;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.66674842474960061;-2.6825558571626051;-0.5362387643570844;1.4727452478397929;-1.3238382596592622;2.7627674275915504;13.182499130761212;1.5602710226135099;-0.82209415191634994;1.2978458442962952;-1.6374340690023901;-0.096994211084717646;-0.0094961517082694322;-1.9685746387794301;-0.23282313382037606;0.24503652340213397;0.56167880220043243;-2.3371391991917871;-0.98161300381242866;-1.8275612413475275;-0.77442843669037409;-1.8233451167284751;1.1736007607683288;-1.3707693838751049;-1.4574485040636875;-0.31104540052210727;5.3336296608348572;-2.165191434556287;-1.4108728513845983;1.1179365914131276];
IW1_1 = [1.1808617090801963 0.042184885751471515 -1.205992909580474 -0.6632608358798493 5.9078072446966354 -1.8212319339042842 0.74497572158998948 0.18586308792146924;-1.6224970200740676 -0.38131354536113976 -0.81444835355220802 -0.065830882954950057 4.5698134879988368 1.1787065449196363 -1.5290156877592034 -1.2391003091709765;-0.092359711915999218 0.19170231557640999 -0.45528021630158289 0.39297442486702278 -0.78887199038285793 -0.34632848647558456 0.40700533100246272 0.097789984450914802;0.015589485728498494 0.077292987195953622 -0.083066808783354373 0.25230658927575328 -0.10223066395982294 -0.12235211445162555 0.31831738021777756 0.15961155304791505;-0.047196304654053993 -0.039348125467970813 -0.34480821481790008 0.25925203385471129 0.60302706408347595 -0.737956687988086 1.2543634553878198 -0.21801183391257584;-2.200882871058409 -2.1743668136753724 0.30769340536947115 0.89690072056471637 1.0594867852948118 1.6411866339402188 0.31397270137311567 0.78084097866747038;-1.8750408630988762 -1.8392960548728896 1.6044392585423084 0.77802085803254006 -13.972036730522506 -11.839908476342762 10.364005709922449 13.902920943782627;0.063758553112596705 0.32405248481440441 -0.50472277352347805 0.83419411009821176 -0.81412349292930508 -0.74725908585744871 1.1997794624306328 0.13224641030317916;0.090713125376130049 -0.040771271497232017 -0.54593174139943079 -0.11516553076408124 0.55910613211771898 0.40749957813499726 -0.35609785232549901 -0.71327455318609245;0.027114536672080972 -0.23058862289982102 0.34389082791067549 -0.095820366974431234 -0.029377537579346483 -0.11643238255689881 -0.00095303684828832325 0.61290203343297833;-0.016115061457242352 -0.052031032439214392 -0.068357839230192716 -0.49927346667199501 0.38796777862824072 -0.54247510288667966 0.14640657819447317 -0.69608600307576474;0.26607868595248785 0.021070066906633281 3.3299439845972838 0.64027315246054928 1.3864019135341938 2.3437208501616293 -0.39872011626758386 -2.3537028581542532;0.32310586774580918 0.52991434006468474 0.23495218664880999 0.33014488518910928 0.95971618616032905 0.29839099782677458 -0.77111616043634534 -0.86573488114747099;0.15347029680548133 0.41875237501844381 -0.22747642906932877 0.23249428043970538 0.96555234370005683 0.22133138561952609 -0.39474856683332488 -1.3618728912215818;-0.0052873687242388995 -0.083306069575031907 0.19249021052972753 -1.073766317086976 1.5469189586403467 -2.2258789527738894 -0.073945569892357815 -0.30864157857666857;0.061828176261550315 0.16535851543803001 1.6137352583355247 0.34332534748933291 0.81175799256824022 0.47549587760903261 -0.44009777157447083 -1.2315354970868548;0.013848850056061179 -0.055352061866020916 0.57701824125742784 0.22037657236849717 -0.22745940593627428 0.33016969617057906 -0.36959690813864599 0.34800160155753951;-1.0535122762476883 0.32310178251262794 1.1042133564647896 -1.0707199417624886 3.1235275064685748 -1.2623311915620046 -1.3266283356190378 1.8472906249736856;-0.030940337753974815 0.066092672046498158 -1.0313652510916 0.91107754287932552 1.09846398679265 -1.1793081619750077 2.4963007159570498 -0.25282918962518242;0.096887409050168655 -0.50876368000467331 0.11703954703274194 -0.79981984613039714 1.428648048903002 0.14367351966558123 -0.16447355473286854 -0.61922971795560722;-0.20924711729209405 -0.19799497778721983 0.1353350510162307 -0.30947480041077702 -0.82508513834760489 -0.020591573360686871 -0.49438771321509706 -0.24933443511510084;0.034214260999923259 0.53249856744753499 -0.74955328322735848 -0.7646093955155161 -2.04770430435752 1.3175774117689789 0.42491923117472791 0.32220281539821838;1.2076698665257517 -0.27186959870296862 0.30870406247606186 0.85746498509905589 -2.6943995505460765 0.41281878675164357 -1.5476517655927897 -0.74728412414463186;-0.16048342123951995 -0.18470828977530074 -0.02044654058142532 0.11415018637334681 0.92795166146254981 0.12077382637153915 0.39504108701222068 -0.12555378490609725;-0.27636969726620514 -0.18230805454013055 -0.35296908663616239 0.2414719823410475 1.2663858357339883 -0.13096808392166423 1.4230564550498048 -0.0045093096447694127;-0.011204770001288838 -0.11852784981253607 0.31743132985564537 -0.18248055234459318 0.74515717538147253 0.38398740605539228 0.091559155341613963 0.49737401201249098;-0.3864502525261459 1.8642064616315286 -5.7613204011099155 -5.0279405899104743 2.1219829036770235 5.0382211190181803 4.5912340755547296 -2.8438293065579501;-0.071297117059651666 0.021215954410559089 -0.32449866588374954 -0.28395872066539701 -0.004927224382011354 -0.6702941391540217 0.82315574491082621 -0.69410679562198208;0.084062912074105337 -0.024418716735755991 -0.64889318852149058 0.17779654745717796 1.1376302072246376 0.19979098324886252 0.67555132299975584 -0.20225220928898993;0.20768072936673734 -0.42664764878858735 0.84275651896704895 -0.49270921434283588 0.84303453308625531 -0.12764413404040831 -0.29384733628910192 0.70358321354374576];

% Layer 2
b2 = [25.416421927815687;-2.1259514872646692;4.0784951978070367;12.02827866911988;16.187064122036411;10.1864034628244;6.827589728933936;-0.69302653426822614;9.4338844412547029;5.4631152783752501];
LW2_1 = [0.099537976668107722 -0.29246630378944388 7.4717676176570249 -9.7383519254775592 11.907513290435595 0.26630362131051455 0.043230200553366536 -1.0601582765613349 3.8062302587600647 6.3114435477787438 0.36917240844553412 0.37326288381107464 0.13770927243965816 1.2828071637410683 -0.14285209689819914 0.16822772957173915 0.3689592193558705 -0.11091501290533284 -2.2134173878805172 -3.1860142009577119 1.2028447773187232 0.042281212250829425 -0.17855894792736335 3.8149435565187528 -2.4180641804777605 1.7462877024297478 -2.2178397129899929 2.4502478146654441 0.13059093034560409 0.74581760303101419;2.3116341932262032 -0.6056623844251886 2.620646129085531 -6.1333057063428189 2.589261142751536 1.5230971428674891 0.085355605304180432 -2.0716503175988175 1.9687176806303943 3.0041414391290822 4.8500386187160238 0.37049659149731512 -4.3803564396972297 -3.6802413294116056 -2.5587603803792742 0.98340202084141537 -3.1201587318703004 -0.99024329234440822 2.3298359789532403 -4.7431810905309684 5.9249049569913508 -2.8859883672048476 -0.70590387591400861 -3.1381145783019746 -5.9943012203617654 1.848766175366011 4.1609073958702645 -0.70485562000907054 0.66598813780446764 0.46030901626779303;7.4887601631813334 -2.9882920701727254 1.4289185716652584 0.68898798431589003 7.4271513681968431 -1.3741248149796403 -20.996332299130202 -4.7309294538405133 6.4650773728224609 -0.63632974143175269 7.3065087810380955 -5.5850592183372614 -2.3920579644542226 -3.0479727685889313 -11.963601814662191 -16.938648654661758 1.7612292320680818 1.332903904683189 -2.1698400642463977 -5.7908539821371976 -6.8593012190947045 0.027017584019571342 -4.269912081091265 -5.5514651204918044 0.44180108854135886 6.6177981436566879 -2.2620781749306258 -11.644114517334673 0.82107481472752641 22.318880533650496;-0.39617133994658832 -1.1829489252770158 7.80341982504161 -17.39789753999159 7.263933508815593 0.81394928975333936 0.23909735914552507 11.185974261933559 17.89358120342494 13.367002401041685 -2.9475433028881213 2.4258366470272024 6.2401366042982573 9.5868816271042938 -0.41758390542045765 -3.8457908161724697 -9.0689433282224634 0.35319441099374199 7.8296599260765047 -3.2018156002787972 20.96191422310627 0.45005979074828734 0.52473749694724559 12.298349622611335 -4.1759748170357618 24.474039196950333 -2.7229666747871111 -19.781895067623921 -27.080778542516729 -1.342386400931092;-30.664463513520676 29.068619771559845 46.638008034975194 -31.152276826942423 -19.655205844661609 -1.0528052950343656 27.673674197330705 47.87386490910589 24.135318674822265 -4.2713004970870898 -4.2098378990840351 35.683050217033873 19.625644044872178 -40.151162973555266 -42.287117746081812 -37.105497121737521 33.314094293418933 -55.562860428377924 34.670284198838267 -3.1436651795381922 1.5203482091700566 38.558536339485883 27.005669050906654 -0.80995836193831017 59.344884656766382 -51.976708403915417 3.9930572391049171 4.9359704234632895 -29.654537919706662 -3.0191694241134801;0.018920189979887349 0.06145110149788377 -2.1176709879126494 -18.266148667381476 -8.0475811512618716 -0.019322167932907617 -0.0029370190402533843 1.9439798006756521 -1.9123410561149039 8.2277808761906623 -3.6426096247979722 -0.024540233717532667 0.86765364968603809 1.9916607810231981 -0.18386586736018279 -0.024336452631158672 -3.1730434416181086 0.025182113110178157 1.889019765791121 0.36788685994645454 0.022812078789168043 0.11473556884712102 0.10303436426087695 7.1359909364759195 -1.9947018096064875 -0.68520216759039376 -0.071538972322928815 7.2628668297671473 -0.85225511105413732 -1.8366288430318758;-5.6340785620283587 1.0020007271004772 0.99047161044543064 16.073395790175582 1.9982893952475054 4.5733684951756901 -2.578345591496805 10.911009036585776 -8.4862668421411911 -3.0760070209060384 -10.529407456941968 3.6968715889399393 1.3109019412632643 3.1171514422290936 6.5179286714921281 -6.8846890496996442 -1.288335244344389 4.5583584260685024 10.309359110488018 0.89650165077453559 7.3688834602035342 -0.021426404220326767 -2.930209651352695 1.0291025847634094 -10.696565638449536 4.8845105244004596 -5.9316489300375101 9.4648607870400436 7.1317566645005463 -0.41085292986763094;-0.027086554296058534 -6.7801836631696597 -11.299737088823605 -6.3204524316988335 9.4945017131317258 -8.1222855484016918 6.6960879104022695 -4.4739268972252946 -4.2713865125007917 6.9954562410498804 -13.908474561614149 -18.138469665245179 -4.8856335879164163 5.9195420613517085 11.005105996481774 20.685863071589793 -14.174251107279755 -6.2982423458149244 5.8214844902732708 10.770024899735722 20.048381184184837 -14.323398181290397 4.0568000199696961 -6.7121490796023631 0.94857130946275892 0.064012688343776852 0.27868720947552184 7.2849086308963003 3.5110492601818435 6.3301270337949447;-0.35748110981859305 4.8165536529350099 9.8357027951764859 17.391328935699818 7.6861282582008261 -3.3714683452549852 1.6106516610943478 3.9083718604605338 4.2308482508454643 -3.1267181376160025 8.6774941658962863 0.31669571148131936 -2.1004155557504443 -14.755318758493518 -1.8104906677286834 -7.2593764817244644 -4.8782530637360182 -5.7991730093127796 -3.0427057268474718 1.8670355118419213 1.2593412614074881 -1.1265181816249261 -0.034626762961938833 15.401064065515282 -3.9126593223673796 1.0389055628554376 -5.0111900246990189 -1.2561341628674187 -5.7345456951255125 2.1681819635145945;-2.8486560408775476 3.8813823906255109 0.3876330383148397 -15.775699877594738 -8.2476446599661646 -0.53777615999447925 0.077088586409940804 0.52097631408647493 5.6717763333025424 -6.6450859069425583 29.454166255798132 5.8732527313171525 -4.4642319189882196 -5.3105193887463571 0.98827781657963776 -7.505706866312333 5.7731585201936761 -3.0364945970103778 11.625514459694003 -8.0548442113146059 -10.30930796166918 1.6055987337811111 -0.2126866658200815 3.1570793118726441 -8.5690458457968042 6.5095055524846428 3.8964268692882174 -19.494149800206714 -2.7865659828264451 -1.6306071448184147];

% Layer 3
b3 = -3.191888531765668;
LW3_2 = [-1.96909529307314 0.022434321851866258 0.0036346969645486009 0.074597203000571502 -0.001879927248683049 -5.7383148816785665 0.0064815397236239617 -0.0001852474571012377 0.014889753904774842 0.041146902647528467];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
