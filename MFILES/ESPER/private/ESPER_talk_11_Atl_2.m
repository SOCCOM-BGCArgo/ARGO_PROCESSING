function [Y,Xf,Af] = ESPER_talk_11_Atl_2(X,~,~)
%ESPER_TALK_11_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-36.755394894482507;2.4603221829666211;-1.9049180385455629;-1.0400767914114415;-14.37962879941275;1.0101715394313919;-0.5287247846673494;-4.8441302740845948;0.30791622567388577;-5.28746802400845;0.42860086317508428;2.1935404129185114;-3.2994871784608391;3.2600949899234952;-1.5088962133805144;1.4955864598678863;-0.91830010120455474;-9.0851093631262838;0.25115750801286868;-4.2973692013285696];
IW1_1 = [-0.72317028287289076 -3.752648745748103 -4.4452147779686966 -2.91978627586442 68.954832323270324 1.0270201176768639 1.6728544769386062;-0.16880369296129022 0.84797357553573538 -0.29773060405302187 -0.13373740650663768 -3.127448218815887 -0.014468663864132741 0.085330258917233892;0.48911358157656026 0.48019406804692599 0.82563368125473957 -0.018787447893447485 1.995190556584459 0.65117914225864237 0.029613106863232111;-0.077023495261133001 0.14988289330463211 0.12646414395218333 0.14778269975328054 2.065089928360758 0.34621050254661101 -0.088416621400706774;0.26736765984468308 1.8012804801953375 -2.4927998656753307 2.0460156806391097 16.433456704717628 2.9838128339211885 -0.72252081361116283;2.1157743116114509 0.0089742293636838021 1.5128593717887293 0.31428264293565672 -4.7631054068243106 3.3258107637789802 -0.73904432704434297;-0.3703547516045696 -0.32090542310399711 -0.96565265254561605 0.14502258718294991 1.35665819775369 -0.67286093384428547 -0.071639889751563254;-1.6486413306400289 1.4401698215569803 -1.6620874752775721 0.55024941635948466 12.422724982995961 -0.16926901237212819 0.11507520330692705;0.081331701404011622 0.17214019820719303 -0.11890607239139855 -0.1279048676460407 -0.25238325512890036 -0.053112290507097731 0.1726160138878613;-0.74531453030999451 -0.24958310278327397 1.0991713219239585 0.35461850269784179 10.165297365905458 1.6367986103472645 -0.79271918075700398;0.23719182951259046 -1.0308838578837585 0.8849388407693265 -0.31780549441642086 1.6206737275100032 0.86210799061345567 -0.084456800953081224;-0.61692927661583785 1.3868180604854421 1.001646006380789 -0.2863721308951197 -0.12525960384311099 -0.17444165161480232 0.47432659501836955;-0.65737371837930592 0.34682772156424385 -0.68357756921128765 0.42054460178430053 4.0755434686532208 0.86942445374733868 -0.94177707748920625;0.46073252866258924 1.4244750029700988 -0.52895277766348792 -0.29291790018572961 -3.3666397082972517 -0.74692266482333258 0.43397093842986473;-0.30308388943335773 0.55090653391630573 0.26435882945601774 0.17989452134321293 2.3126883962715818 0.23047791290904232 -0.14540700222128436;-0.61588507713966734 0.55093008563416035 0.32871803591340887 -0.075944521120043865 -0.24934178343685701 -0.065712456307717867 0.50200589365360293;-10.558567842711078 0.64940814554455584 -4.9003929704104632 0.80887851586711668 -1.4711625597398132 -1.5557000649713228 -0.5545525794264019;-3.2404857311911344 -1.1847826801909997 1.1524182973902197 0.51938542616364558 6.1123222220136864 0.36139760656457609 -0.6588338103872291;0.15140302345507375 -0.17159082624270022 0.12642861402913536 0.10662125938796725 0.3600279147092002 -0.073315825222439845 -0.13452454798217986;0.24922099758821439 1.3105308180049693 2.5545230741045595 -0.41418875373179476 2.6679624975291976 -0.36635883051561313 0.36187002473049412];

% Layer 2
b2 = [-2.2138722882244122;-7.2970962278860565;19.27591777077987;-16.325519640522305;-12.077460043060041;10.089502256389888;-0.94583592563362606;-4.2437073898653006;-4.5532889090849915;-7.3580856735419955;-41.135904077934448;52.182192484266892;0.85435816435027245;54.399533270489542;9.0422095206318875;2.5722226782625666;-5.3943907838303264;24.656439077093065;-33.106074768429153;48.469607164247613];
LW2_1 = [3.6989660663118631 0.20713670862928005 -0.91072445061993923 -3.0886086458317648 -2.0351546252746586 0.26662711507453141 -0.38262930879563767 0.70861312819267719 0.61700593193148712 -1.1175237806200418 -1.3130457244339713 0.71723445136296926 3.3367737830497926 -1.0131654691810152 -3.3604539723488798 3.3792436837562887 5.1641919359400434 -2.9550120412382022 2.7948320759078804 1.5256196520598408;10.959836214114087 -6.3084317163812633 -0.63073318205528595 -9.5869348042200233 44.212461012100903 1.0291263515120663 -7.3165623305293863 20.56693751172201 -12.131202220583697 18.90333269874359 -7.054940372188514 2.1016150332882546 -7.0076327758229207 2.9545167037343991 3.3385805256442898 -7.6829735627402123 -18.847686138469999 5.4065989444313587 1.1648260931187673 -3.8005458070652574;1.7826321651072921 3.2798638462715264 -3.5842207874886012 -21.432669887880252 9.1613930212502304 -1.0462648225239259 0.17239269779684002 -2.3422091406672974 -21.199091574214794 4.0223091995797304 -5.6241869848573858 2.1570253695380965 -2.2921304365031352 -0.91312471291793273 9.3606382572926048 -11.235806184773267 0.94908848194765705 5.5807556615694738 -7.8694918606904478 1.7802796699892578;-0.036263096250126053 0.018632133431867447 -1.208792117281678 -3.3842631131123322 0.23617817486792395 -0.014612071906251845 -1.1114334427311758 0.63555284503639597 12.047097716463842 0.06428022001753772 3.3210498037359399 -1.453215883650316 0.49755049904043958 -1.4409407749259904 4.6403509438856272 2.19155078657792 -0.039068023684527373 -5.7616704537307886 11.660225817979214 -2.0323450298132819;-10.414278968129524 1.8301237315592132 0.28044523017714795 7.6980212569497315 0.44480102473834315 1.495451110293686 -2.6979195617605529 0.98290475566486357 1.0391055099297966 -2.2721824619639648 4.7125688648053563 0.12489639182237415 -0.16697357311473571 -1.196021033245267 21.126631063860124 0.6514626904628682 1.8194845826304444 -1.7895899841638954 25.961639125995134 -25.425787203396197;-2.985830393078766 5.6388102181853004 -5.6404406119719068 4.872330234924231 5.5578088716618455 1.1351313016497655 -3.5005434622144147 0.49319875499416271 -6.7862467502476003 -0.42603023272456769 -0.091380294608531282 -1.1548330432218701 0.4862959055084185 -1.3376454071089106 -0.60632886495821203 -2.2158019624464469 -0.70630014569807542 1.5390178130897982 5.9119512174061217 2.4914098594916321;-0.19098890039178196 -3.4378686930032458 6.9632377853764371 -9.8756883672682658 0.30893696120707348 -0.75453361579764278 1.8388947251293291 0.75751304965486121 0.30746041450937223 0.14453935054778821 3.3350468562490265 0.20404152457118885 -2.3386750805597383 -0.3744861534265313 1.5977740850706101 0.84856673292667351 1.3121278031201284 -0.42979714874678931 -6.5252729371707057 -0.12328338018615831;2.7113845073306746 -9.2908385750840878 -1.1825796886870517 -11.588109257618161 -7.4391366821739089 3.6566648984991534 -0.18239022124299073 7.7444190848790573 -7.5641457948464943 -0.55797709271114637 -4.1566077843172797 0.83417220107395595 3.0531070689964754 7.4290525381264594 -3.6755195403670422 2.5663832164730231 -0.924629370964416 4.1511540819184765 -4.2927713916615655 0.02099545280768244;34.816475431499846 -11.111070398870542 3.7245608315989682 34.874735654876162 11.58477968143352 1.1993150925096738 8.2280699261656629 5.7503705554652003 8.0476050790976306 -12.674629351180043 19.43164957008808 2.7309003626229043 -5.5851053240794171 1.0318328152671945 -10.554578321782005 16.437736193867767 9.2932474383581454 20.631382137735095 32.246399517970282 13.62261593879683;32.472629870942932 -5.0530021419030673 -11.253348936255993 43.313685577055381 13.95486740560729 0.72052926008175477 -13.784038281519472 32.757058455040863 -16.176369595739477 22.292307862687935 -14.732248060103105 -19.126859778311367 -7.4798242973785527 -48.923773368123889 15.282416687506105 -23.932779774382787 -33.252486185973034 24.805948614096941 -3.000949673249925 -2.8214528684754479;2.5524764307876517 23.715532193788537 11.000414470686536 7.4796129511468976 -55.545529189821259 26.737193607400258 65.858647155561329 -45.016106582860246 25.575364952820909 1.8095050108058166 -21.844076125926176 13.426861225710853 11.324201504193255 -2.0511701205905766 47.161531412009985 10.408478713832277 22.364466800873629 -24.89471920805499 6.9948881583163578 -17.212873684498724;6.58592979166274 38.273512759775187 73.559672598072424 55.69929676357858 54.284955094054496 -7.4642060649447224 92.19324100686589 -36.138902880621416 14.651291514291177 -2.2725516202885188 -4.2736973679052674 36.644635221201057 -14.034720390204999 -25.819601806442972 -18.887774135309776 -4.384943194990595 -30.030385480675697 -34.835360686175392 -47.215285516066579 31.518744284320341;0.16708681980982776 -2.2733555154777125 -5.1609845540094428 10.912565942269753 -0.80213602888403923 2.1440529836901256 -3.8117589987399296 0.053095206785170948 7.6854204450816441 -5.358828237845441 -1.3366023381460885 -2.1443638348403238 -2.0286757319721569 2.1766186104228087 -0.79602522705635792 -0.70911797008382016 -0.026057988653619565 -1.1104720179483814 4.9052385533906824 -1.6334831202634821;-56.910364851808723 -4.0810312162952034 -2.5509161833355805 -9.4419954575266942 0.74701094859780903 1.921535105677318 -6.2403767717947396 1.5119948293582517 4.7425995890159944 -2.9253695332939946 3.3005101921043338 -1.8018827842215799 0.54831980656788726 0.1924330291526003 4.6917325057229124 -1.6559993851008608 5.3811312704937881 -5.505046674760731 -4.4215472544169856 -1.6687103351559158;19.862823036660629 17.127524070151356 -42.529799899364342 87.777052858621019 29.618266808424558 37.873793033293168 19.419987060627591 -2.773359397830816 20.828089220489893 17.725505142678866 19.495409124264253 -4.3754570591257558 4.1145646092834083 -11.894955836549448 22.928243911130455 55.542358411945713 15.700925710230969 -18.790405724455706 2.7546502950399741 -13.217951635210401;0.24748763384394823 7.6348885265395809 -3.6437000054426387 -5.4291388237330453 9.1399821194708935 -0.41523244271047299 -6.621419635298226 3.3349892845198807 -9.2040854434954458 1.215395655389083 2.5653041704018547 -1.2402847211328474 -5.3303863895344081 1.2521175518496348 -1.0362438433255641 -5.5671021113332975 -2.704060876339712 1.6323887627022926 -7.4292435793360747 0.66782985422232199;-5.3175396328384004 -9.7796961841497296 -0.10681935133652046 -38.570081116216826 -6.4736275238873846 1.14007966612508 -7.9370804603805372 4.8066884782065289 -5.5477287822545795 1.5932092571618435 -10.818687069307066 1.4217445494179961 -2.1445173414426448 5.6082630960645972 6.7428073143542955 -17.787856280421842 3.5001778541582191 -5.1085500843933254 -21.709746763817432 -13.95165723706484;-39.948851885088757 9.1527252379622279 -2.5237295086021581 -5.4016848439828085 -8.5866720106837793 -2.8329674198033237 -7.8098126560706271 0.80539514865038175 -13.065589829877398 1.3714492010817085 1.1149541983902749 0.71181386793578105 -0.80286699361327174 -0.44156310760570733 6.3659381805714199 -8.360683838563947 -6.428115570432575 1.5946734708616053 4.9182859622866157 -4.2368835730857954;3.3317017497315149 23.833169060548197 6.7750586501020855 19.087683911657223 -25.916271999193413 -2.6468936173421169 -1.4578256599770179 -0.5477169878942193 -20.104883175078019 -5.7411599607280497 12.145067469422973 3.608698005795548 -7.2495655619199626 -3.5371612168902593 -1.7495597850775693 -17.291282575915872 0.77602249729680772 2.0859546025536391 26.32915920869646 5.2618220221970304;-3.1582957914862577 7.3656649087377195 24.482644105490586 24.100152167776852 10.925824728850468 -1.4496882412111496 12.5792304934568 -5.8573075092820588 -6.9146178013636179 3.8412645558531837 -10.2743677256283 3.4690843972084653 -5.1959389517113941 2.9091209343316384 -11.556988699766084 -20.771317350495739 2.1430480780764745 -6.0535145184886252 -10.477454492180859 -8.5390765956793722];

% Layer 3
b3 = 0.042991068574291469;
LW3_2 = [-0.02789918929759377 0.0020579242389715839 -0.2737738575020971 0.17524608422684673 0.0034120023171468807 -0.0036130374211184859 0.55066240939969502 -0.0070999336725230495 0.011684695668798374 0.00088411111917185872 -0.0028094331638880963 -0.00027020864505433853 -0.03875245975453568 -0.0096371407515513478 0.028577244830974652 -0.025357961655463172 -0.053542203420363477 -0.0072787839275662162 0.00096307551079840648 0.67728749417516798];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
