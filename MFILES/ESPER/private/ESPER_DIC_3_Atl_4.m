function [Y,Xf,Af] = ESPER_DIC_3_Atl_4(X,~,~)
%ESPER_DIC_3_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:11.
% 
% [Y] = ESPER_DIC_3_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4922301732367087013;5.1465962912821776598;2.3277777743211753858;-4.705511187707584142;-3.206691206255954274;-3.1780412002297611096;-1.4500787972533311088;-1.7191466444698872973;1.2444523053528846468;2.9595523852294287614;-0.94690430184398044489;0.30507433275000944706;-2.0980006199309992887;1.395428120555341156;-1.537902841183898861;3.1131110423570644841;-2.1043216184899007359;-0.68786991173783063047;2.233586511983692624;0.40558732361186417004;0.6969095445822077739;-0.10814806632080198323;0.29535905707488202543;-5.6968879862536052627;-3.7281613802219197851;2.1305830912916219333;-3.3377622868161926917;1.7126776674821404534;0.30649907335315568213;-7.2241338479140013717];
IW1_1 = [-1.7540665160005692869 0.46175133753134689485 -1.6644964124075554146 -0.16257799722954033306 -0.84976425927437582164 -0.063677344422609624686 0.25757223755898067674 0.13293748629259727334;-0.57003418879036737987 -1.8558461363033600389 1.2526951313076670758 0.29861717420965627756 -1.4539394976297959072 1.208224143506259729 -0.85742231713602534704 2.5219429005984324021;-0.1614608510558463994 1.4528693317558389886 -0.56811015125589203745 0.8942321932514166738 -2.2948641676514629495 1.3126945937064640191 0.48609309411379320043 0.060063743506778656533;1.4244854436999534464 -1.434706863212554806 -0.10354015839012421785 -0.81655978009922269845 3.1428930793488216722 0.13126098892473220259 0.58256588011437304697 -0.59256506268705622098;1.8660607962303921159 -0.70788148089194713464 1.6281742530468352737 0.011129330415983015173 0.93340897326840888137 -0.10257712194825051311 -0.27155703149921817108 -0.41724245425677086718;0.11567341282321751128 1.249200111672629232 0.10798918985176919616 -0.137118866681731566 3.4392466643038708263 -0.98328689512805922401 -0.47563000735447236167 0.068040805167229018169;0.33345729925952621864 -2.5754177809464398052 -0.64441020305967100512 1.2173717638955769971 -0.27022114981414363521 1.6148769747453251 -1.6415695770327973779 2.0962174271321103447;1.1538953388926562749 -1.1683435521662255407 -0.91370777078395770676 -1.2561959989320263809 -2.7856809849068695506 -1.9522469592362763358 0.45902271809901667998 -2.1251302889214400693;-1.2105845716985221827 0.11218115845581480561 0.35709340700979003147 -0.23521929377104527914 -2.3667787755853222365 -0.14046606592202998121 -0.25006307688882117857 -0.082705047585713481473;-0.85942544582583746404 -0.16824623970014351837 -0.84359738521951355139 -0.065959821537124235791 -0.68762156282407760344 -0.66927217822764295541 4.9779127876593509683 2.1185422499057038337;-0.17321520322688646609 1.2276152272002989196 1.4082565142211336262 -0.14579783411193922293 -0.9116445794209842024 -1.4583272005341760824 -0.42964361637404302474 0.93140564810677695107;0.32759394547466241798 -1.169551564759829132 1.135863690660666947 0.82063539324969980715 0.3599469186353916883 0.69203883464592608199 0.14510638095474565068 2.0846210521188095477;1.606033257942495629 -0.54453076539695599578 2.5728757765245218181 0.3855097445416461599 -0.7300294633627679719 -1.1683854974586092013 -1.8015547637500246569 -1.11730003188817828;-2.2965186753494770677 0.39423252453867013712 1.6242507784898934098 -1.1010884173471924274 0.8126841140438251232 -0.056778346077777056 -0.031297153627500129414 -0.16237107821650084705;-1.7095694912373964325 -1.2461311141595883267 1.5045660783224774626 1.3795955965438240209 0.41199118698193754051 0.44415242041869518186 -0.33396057170138732095 2.1975485314744407361;1.0500077655792341425 -0.10060898305352328208 0.73639559243775842834 -1.0441146834514027919 -2.3993183300401152991 0.56481053832971483963 -2.502082515727773071 -1.084098106604557854;0.68102714654034057773 -1.2445565958788256111 0.23445531012316020436 -0.3927510328823007324 1.9783445158868244729 -0.84051167725527253793 -0.22065062333447921228 0.9132022154945814707;0.927413629958100727 -0.46857468968355769912 -0.040594962200387676998 0.61920008662462300286 1.124194633043240632 0.65253359511891562139 -0.30317996361728394294 0.1409290290705421389;0.26198543288443448818 0.23467175281001448339 0.45364396606645962517 -0.43083940303201145872 -2.8386989504653148408 -0.16129088472479691241 -0.13123009944234620416 0.18176358826107560929;0.95808684273394828512 -1.5134741879309980828 -0.86055431290396255939 -0.82135036258499494188 -0.16541287853879352299 2.9860925331513645808 0.31572169810988065519 -1.4977527574213778117;-2.2989927545277164533 3.3126206552465347066 -0.76854787429076854011 -0.65847360157944256898 2.3984016617300909502 1.1648198968435996559 -1.7869521970254078624 1.2905518828917221796;-1.2696715359701613579 0.83467987358822892663 0.11420583267001216399 0.46233535177700130214 1.2369668513722964498 -1.2054049623455969087 -0.31434375942053299768 0.4403663906519388882;0.4965784594564698895 -0.55678068933976321286 0.087027527452704867006 -0.39790251063967585488 -0.51857883511047997427 -0.63733955285488474996 -0.37516976772474958102 0.72205302387824599197;-2.0170508198940084732 -0.21022268128895216233 3.7544065495641523178 0.39691946378627795955 3.0894947511964940823 -0.12154271000829110216 0.42401273373979087022 0.21168117361803095999;-2.4954397621694526244 -0.28341053829324519553 -0.35781822761075965378 2.0414491789325017734 1.6404591517845177329 0.74877498699249034342 1.258689750990574785 0.66852803216715128709;0.29610433326541496513 -1.7239240560595723295 -1.5466606365940862577 -0.27038873144464081744 -1.1204584002846245117 1.262781772735996233 0.013020838797337438986 -1.1655421032902759659;-0.28203669184106916479 0.44991920874959251408 0.61025400682972708033 0.074612643310395299068 4.6828186516444283427 -1.2913101685747188085 -0.046907854756989039724 1.0108621015133270049;0.62873452872314439244 -1.2311239003930540825 -1.2139769154437671794 3.2106116451191613059 -12.692897375241120272 2.5371849033605640145 1.7929043364830581364 2.1757423840785734548;1.2603129180860097591 1.3242742542035208508 -1.3311005679931180445 -0.78634251802924937103 1.225723861022455452 -0.76996072156847872314 0.29933727184150465961 -1.7139550400395269225;-4.2303737704149684262 -0.66265962940949196813 3.6473114444277210389 3.4660666031956344213 2.3916488827262130101 2.4204273217703597965 1.7398396309899144541 -3.8005783570449636066];

% Layer 2
b2 = [1.2398072279708245436;3.0850516058737942338;3.763050414817767475;-1.0290171158989611655;-1.3550741840761384438;-0.14914181342430360422;1.4165297307183293274;1.5579617405248071815;-0.88506272173095523748;-0.39864100516190725809];
LW2_1 = [-0.12867158749052573508 -0.89148860412954034071 -2.252824465991612346 -0.68340418706444028274 -0.68181956379699371062 -0.24728148399307672833 -0.22414693417388448227 0.93867057380636642616 0.67036813572092035507 -0.17637603666874096531 0.73300721750888631068 0.77087846711683172263 -0.016050663412141414482 -0.30273346023549474459 -0.063130883457313630158 0.94022955521948181623 -0.8006234955647562046 0.42121071508653351589 1.3389640589699693951 -0.40282486121570598714 0.65928437100356485079 -0.13005748525754057265 -1.1562897810989312131 0.1725634605404524069 0.3992257823913158421 2.857522480536667242 -0.16401777751934251692 -1.3272335949755060813 -2.5760058434747397094 2.5497422506964135813;-1.4008057953501955595 0.98766297931277113875 -0.95841908951706977771 -0.10499012190460778327 -2.001727919633532693 1.0609294789810346238 0.86077344262291655141 0.5065909382653153159 -1.5409949189856215757 -0.14410603867332319461 2.6241482649123044624 -0.030618770814765737531 0.80246735094464338722 -0.38855942527711662127 0.27424460756613694423 -0.32071951168595430604 0.29080735078640418401 -1.4447459206444839275 -0.51419563330450224203 -1.1378570834150698587 -0.62441105788270556687 -1.0403580046379103941 -1.2220117624112558641 0.74291707021898067964 -0.23980022007471052392 0.13806061908939304406 1.4490250032297515848 0.38347855749810949577 0.2691799941110607497 -1.6643528481689162657;0.11824790801558665576 1.6186259283249648799 1.8399183070011759789 0.93744545997407935367 -0.85520286241425025331 5.9720080641745418859 2.8466376071374455137 2.0922727123473547906 1.9960661801578032382 -0.63575192666907054395 -5.3155600780819582951 2.5412205784418535615 0.013527361016320394588 -0.21116256289743592922 -1.4727193308862780441 1.3869460430587496891 -0.7031466411065026012 -0.83440416288696217517 -0.36195333032300169851 -0.75997841901826190814 0.17110392890343689709 0.37004587602962296655 -0.49346298427631540839 3.4767813543674677135 0.059726907578220689299 -0.67126382308575138769 -1.149107999500099675 -3.1961318997599321712 -3.4541034053576527008 -2.5328404488476525813;0.017377078059732164322 -0.66144298373948395842 -0.30779478541084354104 -0.91203012656644300016 -0.67612010618169882115 1.3695619638692193565 -0.16637598759697111439 -1.4610486708717869142 -0.87894570521757020565 0.27963525313132908678 -0.12017487972393069151 -0.87252055391560701114 -0.082823034204207862663 0.53901062781072273111 0.43969340841884013704 -1.3756943928545990463 -0.59147251074367368506 0.43466079458888873255 0.063877764408423437503 0.96460090083742999756 -0.66864235117194670277 -2.3236264604149856616 1.3686785192934025623 -1.2845921787537457615 -0.015141145199321963399 0.87993081842806142312 0.38725750559055871491 0.36383847210960285068 -0.18849482053473232135 2.3170875028844233334;-2.2952796015550624986 0.018430446040846978212 -0.49018813848850789627 -0.60332149551578617697 -2.4779123855234730378 -0.53260689762406854264 0.24637580711176307324 0.29274887250197012545 -1.2353899796468368333 0.027952362191337010167 -0.52477252675954721983 -0.39703494083589774277 0.31638394236158146056 -0.24900062155412394649 -1.0776891153169678716 -0.57029130715377152061 1.0577691500679802239 -0.7870842183485121657 0.55966762393363422845 -1.0367046968879287672 0.058713310666870702215 -0.48158522964308386749 -1.9865445257817997415 -0.44713101062676641195 0.45782835903647561837 -0.42242565633705314587 0.97334354903070152698 -2.9676761565270237675 -1.3837997735996183657 -0.2892757216365506312;-1.7478970611098758603 5.0822094384125806599 1.1360247132876997167 1.461016891294528719 1.2424299735331076899 2.9012487552111387856 -1.3064063160164756106 1.2925884990948832698 4.349296762151519502 0.72433317167206501264 1.841591347698496639 0.14178986532247284114 1.1137798913078904572 -1.4992444445280115328 1.4266215163054658532 1.7130647800731275687 0.46714086746596433786 -2.817228489821800963 -5.5499953481858108617 -2.9382360002841108049 -0.32637641700465980232 -2.8120986538718422132 -0.22324558180334794222 -4.0846018935254422288 -0.61351208023580228179 4.2809387760764554542 1.2871437040681275032 2.097201779783294473 0.89769712098690079838 -0.33942120978926620944;-1.9573628212444269536 -1.7855899292632790853 2.0235178592424141186 -2.6580347661197194498 -4.3052276640870861257 -0.19675907366468001203 2.4394661510347939171 -0.30853370946316682755 -1.6185035195926031903 -1.6250109796508551696 2.4039337541412417742 -0.84468661606378359075 -0.42055942089929881922 1.1165313965482079883 -0.6097843830365003992 2.1897299479830034663 1.4010871549186600937 -0.88962572220329172445 0.28420605506131890738 -3.0411336740153682712 -1.2426937178533994377 -2.5167990286888071161 -2.4820874674645003743 2.2647653888341019446 0.28259378370950716253 2.8011223623279919437 -1.7877712330625421533 2.1042615519981779926 1.9845751309433041776 2.8394957889723895228;0.92154762445961602157 1.4834781230131179885 1.0334515872709348905 -2.353291547873890277 0.68900189556272339875 1.1600062859831938855 3.5488624751269797208 -0.6935002769941522871 1.9707994479449073566 0.41755619774365504426 0.46729540304298960995 -0.10674045715469863971 0.38036908190919738182 0.71329532474229140337 0.17229043054690351688 0.94847932621888131344 0.0051565837920005547224 -0.86649117015305565648 -0.111203827123271759 -0.3224388416813629421 1.0145019759528792758 -2.5948514766515757834 1.7849847190431329391 1.9325128254457253352 -1.4571617355029331531 1.7020880313051345301 -2.3012392397424523693 -0.82918246192893552138 0.3885791978639995814 -0.033649800469981519524;-0.14171894588178524099 0.11151901630390499698 -1.6316489621359639983 -2.1063241890345101304 -0.54724412000251643207 -1.6933607249900550773 -0.35650953519694222882 0.10028063624196711934 0.63725664085282807125 -0.077028197422270711092 0.33739527724957468768 -0.12985498525662464431 0.32946810101439188978 0.030770736168108880904 0.7959114613784687986 0.56021989697190954782 1.1713678236886633233 -0.90055427770646778729 -1.6599747529958919223 -0.84773658413499075603 0.95357193927692429636 -4.4451482127883581441 -1.5994399018191689521 0.065663327943808649789 0.84178272015333788225 0.24213528169238635046 0.70579301675890337986 -2.4769107964493999319 -0.010037659528928547653 1.3110852629748244169;-1.4564804854522928057 0.59817065638026289953 0.23600524874175549117 2.1746960166994515617 0.97698009140113728499 -2.5135991066870979616 1.4564548364039862083 0.12781924190688337406 0.71377473305099237155 -1.0335823820790097649 0.39379371439012073042 1.7358235877774017553 -1.3276391744263094097 0.63496400605444314191 -1.0236057288626301265 1.1394468519204161705 -1.4098958908365666343 0.22071984007394193639 2.8812467365370997285 -1.4423501146234556369 2.3413358630432612451 0.51360851559435449776 1.6550295232357654651 0.3794916448703464229 -0.29107749442853025901 -1.673670386960488754 -0.33013494058617492977 -5.9193361237150341481 0.46372654138133811985 3.3697863611013438856];

% Layer 3
b3 = 0.32682757585881083706;
LW3_2 = [-0.086798044160551854342 -0.12385229778669204492 0.056864810167798540697 0.071610799323992571641 0.59106810745815785424 -0.016922342055991825699 -0.043886164919440875942 -0.031149321189328064291 0.11705988952920969026 0.010022458325428879738];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
