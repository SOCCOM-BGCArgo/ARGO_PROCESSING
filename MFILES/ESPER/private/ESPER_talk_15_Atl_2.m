function [Y,Xf,Af] = ESPER_talk_15_Atl_2(X,~,~)
%ESPER_TALK_15_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:51.
% 
% [Y] = ESPER_talk_15_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.456438445650881;1.4827103411899305;-2.2380629691412444;-0.89471937731348627;2.5081154277961053;0.38720470287877967;0.024945414083940649;0.31738017115015349;-0.39164416845737676;0.11043889124256853;-3.5457302371798907;-0.94852845881495662;-2.9234089642540013;1.5630250013700697;-0.075053229272056779;-0.92238342556692854;-1.4875100390294611;1.9037402012274505;-3.4536450890594197;-4.7712055547424974];
IW1_1 = [-5.6448577931138297 -2.9019659693568829 -3.0889741965000588 1.8309269477341938 1.515341154806024 0.62657099662931437;-0.060791399986279977 0.10709751758212342 0.12878320021611112 -0.25023633077995161 -1.4976317308400033 -0.34365949448977556;1.4493099615696252 1.6339993155943715 -3.6219862789112365 -2.9774378395509715 -1.6832157311039451 -0.85271336650999552;0.73348315118634266 -0.23340980543734599 -0.28927917988633634 1.5162109710759968 0.050721873962631503 -0.13996672423772738;-1.2985622378068189 0.51807737368206352 -0.92215881249705123 -0.94144999838263288 -3.2354778042585735 -0.58988570820196506;-0.76670978837086234 0.92835488807096367 -0.35395697629248407 -0.38786753130086071 -1.7674399249227417 -0.25375586366078989;-0.1848827781198053 0.17232322127282346 0.018446886824285559 -0.211360491768115 -2.1462199013196583 -0.25696911344382023;-0.10546338703012209 -0.36547787853423258 0.94037538208976124 0.90720067381942993 2.2522374957590192 0.38307966765663259;3.3635560760632552 -0.78162807159574077 -0.8049003089635175 0.66575950065901612 3.2228797488026468 1.2557419382284332;0.45524442066222498 -0.17695222981938305 -0.24138297371481626 1.2044242348525531 -1.1562758806013371 0.41634181279596089;0.24370311024104191 -0.11899140397242752 -0.063900947152715673 0.17957570595284242 4.2616121547086498 0.25828109202659039;-1.1294005620696974 -1.7535522483317385 -0.051127812618215321 0.11379540235713792 -2.2080299936314405 -0.12836909011691219;-4.4180163587875363 2.7937560379794264 3.1844811004918991 2.4343827991150748 -0.71485127377406465 0.26848484022271668;0.17931936669187942 -1.0728787115449319 -1.5423625025453258 0.097032648246429307 -0.88270823871843174 0.10639466382768362;-0.54417181403147052 1.0994308726808013 -1.293864985158419 -1.0700345513913689 0.02162196914117508 -0.34101272141793798;-2.9773025133776581 1.0674961648265668 0.67369999954776871 2.0806788291638658 1.2904336204279914 0.26885409210699684;-1.1855156990862317 1.1841911497898241 0.78359429196904373 1.4583469711823052 1.6332746827336835 -0.29581820301120726;-0.40223341629100817 1.2629716066401613 0.62599301972248689 0.90241343073852986 2.0539447539401934 0.33213188392706117;-1.0572384684830236 0.53659606104863677 1.7366268407962793 1.3840957097961348 2.7813922598200356 -1.1545826723730408;-1.9516502510879707 2.0429714578244966 1.2598214035204496 0.42949473258311871 -0.8722000474923024 -0.93839171190973647];

% Layer 2
b2 = [1.7320689424553415;-2.2773968176492465;-3.7391105915978606;2.7371067983279795;0.059297768661727798;-1.0549077283386603;-0.067407022211302348;0.8743050265116834;-0.86187963845873339;0.2591566260064162;0.84115205030276663;1.3513356467901463;1.7072181501597519;-0.74928087999245552;-1.225152303220991;1.098409421664744;1.6962811623426468;2.5517828448790891;2.9228064606501869;0.66114508455192722];
LW2_1 = [-2.3399048809019516 0.44308265641616734 -0.7378110673670959 -0.40183717349004433 1.7597684248330336 -3.7311606087326634 -1.0677959401173331 1.8745800870939098 -1.8584921879424297 0.27808522309020178 -0.54438844167142131 -0.8334013822049644 2.9331847982857515 -0.32651811184262713 -1.6516854836914465 -0.10440844557551152 -0.58971052408413227 -2.6487544106173799 -1.4422581874002187 1.390374142672784;0.75097556415338207 -1.3448186771681618 -0.07663375005106414 1.1216838213915332 -2.3482371541729612 2.0952950739689591 -0.74576876378188595 -0.66528916327053789 1.646471729059769 -1.5989434280813857 0.82444523478443221 0.14178477159293756 1.0359334967608167 1.2469132406799688 1.4830024831447515 -1.3584631199703441 -0.42444675667890297 -0.69870093523080001 0.89228402508542881 0.14972978096924011;1.2054223590464153 0.87310389428138768 -0.56673597081738147 1.5724280124138177 -0.46768755442789867 -0.26436085053817693 -1.0632173600445367 1.2604697087019217 -0.43191171267820289 1.7296319202107191 0.49833477995168657 -0.69148218641678305 0.88792231255244303 0.94679226118578574 1.8400678913106843 -0.073091074675944667 -0.22679329391978448 -0.21423779263144985 0.75063541290838343 -0.25481111585094723;0.357846359456511 -2.8615071655092521 -2.5142557055172654 -1.3025516009455347 -0.00971454081949788 -0.39268054996854906 -0.47412423063258918 -1.3781820864680241 -1.2933126418566903 2.0469105305438635 1.4235871160558529 1.4210469222488065 0.79517716293612861 0.70507818863108662 -1.7813041889646797 0.21363525891217489 -0.40190696373881168 -0.17828333754387984 1.9353479067304336 0.035487676126055627;0.35581401827530673 -0.46270153157593102 2.3447629163885662 0.080034899002807747 -1.3931195546080857 -0.16956838552202691 0.21345139807711136 0.43707797470651949 -1.8857173851153821 1.3375641004467875 2.16568183063506 -0.59116231683885256 -0.15203884923860447 -1.0770582006689688 2.6457828440413849 0.57434716060988722 1.2105978405467537 0.55928681031180594 -3.9087314001776483 2.572822733000347;-1.8365042172400392 0.83068788845716801 -2.0292554256058848 -0.0052268482996460173 -0.34794284444540258 -0.89386901634955207 1.3282079616097371 2.0587830353767531 0.62985368514640117 0.191483738017178 -1.7890533513519522 0.99080809508351453 0.15745294463910278 -0.67722447777184824 -0.4032860516346054 0.9269831595670226 0.29353250236895417 0.30883605138071868 -1.2110615448845106 1.679712381439957;-1.7375469816614482 -1.7071972327911973 -0.16676986599615959 1.021533344693289 0.28504351228651126 -0.69107805405277567 3.6072422229186154 2.8583577287996009 0.41971509653068162 -1.5141245885333134 -1.3551319442626673 -1.3926827467922809 0.55677725237473963 -0.17542257814560142 -0.81729936796213543 -0.16642174380694094 0.52909714835679911 -0.83727053357286718 -0.75363110538836442 -0.76281730246656709;-1.0487143064822635 2.3437715791521017 1.6662781178245554 0.60366898504425437 -2.8595327545422284 3.0726377719088349 1.6658390550474993 -0.75795606232343593 0.35513209107007576 0.13654933291843818 1.5671311090630415 -1.7226845388103462 1.3991483131749711 1.4599247280731755 0.55355251720426191 -0.65153565317805029 0.30817876019549817 -0.63575544836194764 -0.76796053281290966 -0.38996936806176857;-0.029039691925997417 -0.1057729251199149 -0.041741910997966154 0.91550045789545398 0.47046295662427384 0.992875408702803 0.077036183294438579 0.81330780395592561 0.12560806096511365 -0.84165344745228332 -0.19050879988749436 -0.36057819102166183 0.56158076236140575 0.48973229187495082 -0.63603174985962518 -0.35698440617447941 -0.84141951050436536 -1.1337704532914619 0.25751004508553299 0.70471954256304203;-0.941592171251731 -0.18956554325478703 0.67969521865222715 0.46282824700744823 -0.18668234510549139 -3.5133453588281998 -1.1072769982145427 0.068782885341146405 -2.244005103647535 0.34192879135007437 1.4625657501116536 -0.32418401505506772 0.24621440173551046 1.191645282855075 1.7876933166102007 -0.31572869794159031 2.6415404817237365 2.0399553784997027 -0.79511729557477873 0.37420273957609718;1.5009998533345923 -1.6153213974127778 0.47293026754844025 -0.10074772845418328 -1.0362200064499967 0.28223031032670087 0.75935097142677388 -0.89753626701395128 -0.48688194483433062 0.13161870521547497 2.0192507550588861 0.15688287184363531 0.65663747784328452 -0.47324982713319375 1.3323214198293785 0.52928246723641093 -1.4804209638211063 0.80040475846367942 -0.16461730471477437 -0.67674817423120737;2.0448021182953933 2.6485209217432697 -0.46514779232705161 0.18261188898600147 -0.15775324450147865 2.3663296537780774 1.3753226273611823 0.94367889710700936 0.18902838133932534 -0.72557863976958792 -0.30529259506255685 -0.36465942795822059 -0.13282026863372196 -1.2891414060384256 -2.570748235146096 0.52151618395928978 -0.5345604523255183 -1.9583716366542907 0.62280432901226268 -0.7793248703639224;-0.87694030016927649 -0.2180955346642216 2.6160485391706216 0.94276313252890187 0.99965651769203745 0.57784407419182027 -2.5137775252326713 -4.5193293349392238 0.98420610562960564 -0.81348455448682022 1.8925493295040352 -2.4319407678805622 -0.10055239252947036 1.5737623923453996 0.11480840826259038 0.58584580149019549 -0.26468808257809173 0.92664255886584623 1.9606663582043096 -2.5780546563108722;0.061772362180487927 -2.8230896173072333 -0.30402284898352461 0.69121903940726936 -0.21801180450989888 -1.2035002198850109 1.5480114775614913 -0.45576463434430792 -0.44983247903117429 -1.448478691763746 -1.2545565712359628 -1.0143478323602027 0.30732570688337651 -0.46426519530593718 0.23907702460526103 -0.43458699484440311 0.63871284965078323 0.69564826254263967 -0.46938916638512013 -0.43469029167166262;-0.6103192605656873 -0.019744381695512812 0.48254165843758678 0.54120029481619614 -0.5105216801823893 0.14604859002201731 -0.21654887753895435 -0.65065416669941156 -0.39956681463108745 0.35337504515112678 0.06298594362656719 0.64017821110273798 0.90688777725311931 -0.3661757647620727 -0.088490836743262316 0.20262412453251863 -0.1272512909504222 -1.0377419388015428 0.41966017783853393 -0.012628120820560803;0.43290226694111594 -0.01494789986475561 1.5113861714568759 0.57658418198680217 0.86126520786304461 -0.14586181692703037 -1.1826424673425058 0.62952378354979577 -0.4535970343864893 -0.52040919039301614 -2.1393397787463129 -0.15244783744814602 0.30947383836697645 1.1048227264621893 -0.40725576428126092 -0.019839223114933417 0.11335492516179319 -0.63051042493708898 -0.20423204051629806 -1.4016000638624477;-0.77032706900456116 1.0841355809787696 0.53740491548429647 -1.144289729446728 1.3444142474156886 0.27347424700114142 0.63690598698441669 -1.5448170699962243 0.32779688018541697 1.5414642691604357 -1.3032803508209709 -1.2032082567726072 0.44296112961172412 0.086797453956678261 -0.06402626256796437 2.0315599109924718 -2.736717128647804 0.11532933331507123 -0.10368573877446963 -0.70660135419165082;-1.7264781789443733 -0.22125432543580484 2.1618738829446231 0.061792587021823282 -1.1621327453388377 2.5097840146111041 1.7581957553507845 1.183066175097889 1.3178579595294668 0.27685340147771459 -0.88734957275625015 -1.1372270899667596 -0.19804141123191171 -0.49908635546587582 -0.51838355474824893 -1.2882820932963508 0.75179292912238282 4.0117926419548748 0.61702980248335015 0.90003617586061457;-1.0597359284309971 0.77695079096530961 -0.54699210486654815 -0.066001530640791714 0.9891692448180579 -1.4076943341051023 -2.6036608926085276 0.75218002458857114 -1.0138525814685586 -0.24355560930735579 0.30501768882463726 -0.90106282592290421 -1.18087864268325 0.59462163532714507 -2.918322440659666 -1.2517450954097442 -2.233436420612402 0.62304991058544867 -0.77376973330126164 -1.3033466664743574;1.4304928433871109 1.6939150162011316 -0.84071939978896815 -0.2150417689961254 -2.986176709538074 -0.27058502222381703 -0.44774927398030578 -1.5675824326349292 -0.99919662608184667 -0.069092014798638968 0.74097294578882555 1.0698773793245333 -1.3218481123504733 -0.96314772236482171 1.3135079055045629 0.2264235951641366 1.8452563329059781 -1.148697461230489 -0.047865068872108466 0.17505159776601018];

% Layer 3
b3 = -0.60353637798430326;
LW3_2 = [0.075744328353739385 0.23922564363116877 0.0016727481653401523 0.01132623967793151 0.018462378447297811 -0.24730829624740805 0.39769930835091866 -0.07602109232396069 -1.6229781736987325 0.070280031289474493 0.09091814785475856 -0.018558001764161725 -0.084840346288557661 -0.46170534226260646 0.80242952596244432 -0.41041860563949428 0.084749151464717468 -0.059754928627107816 0.83504769295362602 0.096010851853880086];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
