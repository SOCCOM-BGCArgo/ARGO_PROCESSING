function [Y,Xf,Af] = ESPER_TA_13_Atl_3(X,~,~)
%ESPER_TA_13_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_13_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7788273426219607387;2.4389285397546283107;2.2491487033432613352;3.290601109042561756;-0.78736695440602155749;-0.16159888817523831994;-1.6472111382883780628;1.8252014965058687146;4.1171297712247909573;0.78128708566043503225;-1.7237323814903444674;-2.8919423509470276734;1.3486173024386096664;-3.1300759137805336252;-0.70606059356682737693;-2.4648642870175754283;0.047711512522657664737;1.3700572077007857619;-2.4119457039635312512;-1.1052624265552801752;2.057138016973529826;-1.1607581669393411961;-0.11860161980155076167;-2.464025926359767027;-3.9775526578862678839];
IW1_1 = [-0.89084040144703946495 0.719212886492940906 -1.0337310960359893386 0.070403304409860034685 -0.19422473460798525546 0.13310604141086088137 0.026831793083408831541;0.42220217926648478945 -0.82790924796565557031 2.4771709829220003307 0.12443615783538723718 -3.5979988865292460432 -0.0035409610423467264076 -0.35629872869170137184;-0.82733077766839524525 2.13672697021046476 -0.21805380897224335701 -0.26010666830169737462 3.1120849264974985715 0.009604952755246542323 0.14949350866863797549;0.066593396165065266157 -0.65231669092877830884 -1.8337874318352545 -0.13904819133852655555 -2.3243124918014164138 -0.37057993142754841465 -0.35831901521554598844;1.0266240822764005625 -3.0460495586556266545 -0.51656157519734535732 -0.20482491887645762341 1.1395826155257675616 0.0080400069453545452286 0.61420927837746730482;0.71689788067789350645 -2.6503378624132398755 0.77587557509164040148 -0.42653745789511393616 -1.3031126565920441163 0.16089699397209292209 -1.0504687316963228216;0.81112162207126614621 0.98547093468517121817 0.85572755440397341165 -0.61735488226942869527 2.1487579560003351453 -0.17801528956102385948 0.27427348872792151058;-1.1685476411700896904 1.3276129963154297275 1.8942086743000867699 0.12961689404486670396 -2.0433797272192628647 0.04949047449016728828 0.030763640318621988251;-1.965835358080399109 -0.3297182814220659397 -3.8023222330321471141 0.042139464248877760155 -0.69555316898480123999 0.11199078318441889335 -0.23753062506145802835;-1.3944917344922356239 -1.0475749610095301811 -0.98556298542097131588 0.68596130535237065384 -0.36576692778972019759 0.31261833553635326455 -0.43118323724956991727;-0.058062505884824089364 0.51604626395977315489 0.55840755709861977785 -0.20924433122147126363 3.998007640499706028 0.28433780289134436003 0.61747955126061326858;-0.49869656516950139347 2.8136816314828725361 4.0657239689999737919 0.15265540350546843995 -0.056936071351919512185 -0.16762919484184998775 0.22333577803546145191;0.75787492062843953011 0.72834049774348919026 -0.05583014421079485895 -0.52654044126586618813 -1.4192638027990867045 -0.3165841371924824621 -0.024803560172083211066;0.03462238361100511419 -1.5405898440204885969 0.79267249714388399173 0.41916813080446591044 4.0796542122164849431 0.69053408774925473246 0.26873574501484354116;1.8942730092081050408 -1.1523133191458416746 0.13167035530839041324 0.13610086785269265297 -3.2435888959145251498 0.11231275574070806456 -0.15672710628567573798;-1.5830135667617490913 0.0077098011023331147057 0.75690085190600620013 -0.43538551173858203169 1.5192382735980571873 0.15799451130441349855 0.23941099257611800355;1.2426521487204000849 -1.8155517236200369169 0.51328245101235903114 -0.11427604025348390981 -0.3304953789805158415 0.42714040682849152564 0.5200103590834218581;-0.30978560033203228485 2.3479366416114517691 -1.1226267297897094544 0.021544183242152903368 -0.21068213470559918332 -0.22021546386735449397 -0.27365434637938940154;-0.69695009281025133152 -2.2345259353217601372 0.60950532169609283883 0.18419929794012351865 2.3876672239616834048 0.15717133195067475859 1.0480900011040095166;1.033194605401738464 -1.518037137649215218 -2.4827338248427870404 -0.024119684557641324352 1.0350558094528816699 -0.059068875492616468303 0.025953313494029635333;0.018291168848020719628 1.7022484190961555406 1.4843516682815680596 0.71053449388821976473 2.7192758854500929111 1.5192219793894838897 1.4120438725505719546;-1.8124610824206808246 -0.28423882274151290872 -0.82979288332910816628 0.70819629485996826723 1.288818585594169841 0.36848986572606945433 0.29120319866217336813;1.2392301523863642476 0.90379505722081832086 -0.34989004279985830292 0.62320490893384217213 1.1707017734724913804 -0.11040283654842636407 -0.58218715649528607337;-1.0262567015244903335 0.10978712721419167653 1.3506627013170708906 -0.32151203141562423315 -0.20369156487096309882 -1.6268804030366155189 -0.23188834767148550076;-0.68638794552243920233 1.1876774073578428847 5.4519280219082402184 0.36479129292714523869 0.17116599480471161865 -0.0047844202224761444436 -0.24816107809759463398];

% Layer 2
b2 = [-2.1271095013537002494;-5.8939205618945216258;-1.3322356179213847849;1.5308481630188435219;4.5531465922612497366;0.61885866413374368555;5.8069173068385957492;2.2121718202111444462;-0.10236455363674092089;-2.3413948898109042673;4.5311209636558382741;-2.1026099851635655646;13.766928500200680929;-1.7700007382538032186;-3.416228200024312045];
LW2_1 = [0.81344407570831900323 1.7404653020600804325 -0.2922982058380196313 0.14140652568937225886 1.2359498306626710562 -1.3628116683460043124 -0.42422172857665152446 2.1768270772495856846 0.53992069647483453831 1.4984718697446384184 -0.12290592468111298519 1.4800623892531590275 2.0744086258684775181 0.60100783241724531347 -0.48767910067251035722 0.57823125006349118671 -1.3039766019814371667 -1.2201313141635623527 1.533839557062088188 2.6188551663823851356 -1.0224451186848237949 0.15983523445831232523 -1.5936778844835164382 -0.43933748395290339595 2.7298125007173745793;2.765353654308257525 1.9284758580897645164 1.2139179697784763245 -1.0725483500628492095 -3.2498637980530995506 0.75697497054197226962 0.9224033191426458389 -0.42659375502579865991 0.48895879084574667139 -0.51282128640878010817 -1.0222796697183804682 0.27293953887244509771 -0.1070084930892298003 -1.1332344899807158534 1.2797479965001312685 -1.97172398083727618 0.27131575151793624334 0.55019923315666363628 1.4995812405581130378 -0.37745830828787280131 0.812433457306698803 -0.80201922998864982883 0.91467249955128537842 0.25650542427267264411 -4.0928844413031422178;-3.1472497317629679614 -0.52369761643657963823 -0.36924508596405886118 1.0680718800632389431 -1.2061004143093547736 -0.54007724806095858128 -2.8168854997769328108 0.10420887866677025491 1.0770656802850964162 -1.5031830509984986932 0.41652731160299028002 1.3113399612074934097 -1.2235989167434282443 -0.2159933142081577051 -2.7672810352753094421 1.8456407158686882752 1.574288717143379035 -0.64460659430007194448 -1.0100234523785247553 0.40396775251162037046 -0.62376166723230497269 -1.929790611139914791 0.00029436171076203769548 -1.0250066542099860456 -1.0295540253541002329;-0.35334407668900014166 0.3594364142009033869 -4.4962651025997582011 -1.3492991670544667304 -0.3133952756313296284 0.25725591060063163207 1.9436370967207803329 -0.90906491499690489366 0.98143968459848673902 2.718356047432737288 -0.10447384445640794937 -0.29699682726971060598 3.3008057737628062611 1.2215442941165348678 -2.0220323884109232537 -0.098663453896325692405 -0.33669786156331893423 0.13515020170132324706 -0.18098959989427876316 -2.0679152329080099371 0.69528809779694411564 1.9031575468047583488 1.4110289013445105333 0.084772533427274449069 -0.048303371585264383292;1.9436997677711371768 2.9793833767901172216 6.3435439323605864459 0.75236265791285106275 -0.65437859480959359448 -3.8671744402405732188 -0.72330465598896231949 0.88273029586354523346 1.2117279097571980184 -0.34753588029029741646 -2.5591523506098305951 3.0539073763614106305 3.4167198019021958189 1.9704243958929117397 -0.82524952771194337586 -3.0123335510464683829 -8.4073381095350967485 -1.0610964174094998924 0.37261268779965017739 2.1840318095001056697 2.5197265750814188401 4.7258957383415092224 3.2519733170981117709 0.063415301096708884265 0.56789830849753830666;1.2830098816114787752 -0.76547605120759132369 0.50907166877237919334 -0.83074663265906001364 0.39307997296676805421 -0.4875002712394245763 -1.4458121924964999483 -1.60625457422064577 -2.5589462401421929627 -1.5846742677193372817 2.1124238059256041922 1.5743245919058079796 -1.7755450458774189038 -1.02421805356180462 0.89991564881195973413 0.92147331413444555359 3.6170485725696286394 -1.234370867380636394 -1.435692284893263615 0.55647299084405210667 -1.3398652428509230106 -0.51102321612873846668 -2.1109777355602492577 0.80827551654555918059 1.0908914747928111222;0.72952212784658876377 -1.1605851306507330989 -0.40002812567049211845 -1.7809707793349116578 -2.1557181743033284604 0.6763016493632989512 -0.22974759973770986221 -2.3956980469088504648 0.95696375700701064027 -4.5980087093844819179 -2.7887163498293872088 -1.3149215593583030159 -3.4650785492580844505 1.0933663767940291489 -1.6712098663781997931 2.7526682467865128956 2.2092012117774317836 2.1956164769319683749 0.24235129754565273852 -0.58838331457118953072 0.61605757534044303103 -0.98732077921711469681 0.98062558574338321016 0.90291880741522179132 -0.16932580102271843625;-3.4142807177769309845 0.52995961382109435522 0.7879882786356616764 0.4887364617879930706 -3.212402677676042817 2.6749092552593678462 0.88259658910757810002 -4.4454991994144741341 1.1443025869609093625 2.2471883005817767653 2.1952911044852183586 -0.72042266101706642356 -0.47585608506208426638 2.0587159690416743096 -2.9608562827758508895 4.2042970614935128992 -4.1932216953159464623 0.93160252297659151832 -1.82267158594184564 3.0312517368781715099 -4.3882585008943264526 0.50921844914700786777 0.45470370006190674594 -3.0572817604228030852 0.33603484946951656109;3.0691903450587409985 0.7518367817381473861 -0.11874679062132692531 -0.063974025947026225136 0.033101357682477995648 0.52874307795749098116 1.9313741786720952653 -1.8615636077557800032 -0.7942621926860296 0.80304129439298066462 -0.32141372458590838912 -1.8884915586863546544 0.59917014666629409003 -0.036726376368068157363 1.9083256421593495222 -1.6380912787548191911 -1.3451019146003397875 1.6114129938131274145 1.405578312102736982 -2.4571435341096607985 0.61194793778202649648 1.5287643888518065438 -0.081286141805725298237 0.35518154224930503782 0.60095954491879510773;-0.45936173469027119509 -0.92674449441758055546 0.68285520300706881169 -0.52553508050818698027 0.99162053690296425579 0.74512026260262997912 -0.72315356304654931918 -2.783686103300373027 -2.7234163411464082927 -0.81508552694057068155 3.4022882522587334364 2.8395112431766826866 -2.4203707807828140908 -0.49364110381399395333 0.44361650253323320348 0.72872809715344522008 -1.0810629310638177891 4.0989117262890237825 2.0339839992995933926 -1.3387640726884841857 -0.48567933766435394949 -0.86803949161967386416 -0.88736700892517295092 -1.2389184192033919629 -3.5854538522877845708;-2.1074499627272458291 -0.80758324897923128294 -0.22657775839326271816 0.26515644284572087441 0.5469919455821927734 -0.56890253966447046352 2.0763862718426797649 3.8006348084110181951 0.57661694562795318131 1.9516501432738677657 0.14693896306606443747 -0.41530217029425076092 0.5275433458626647143 -0.12544333000684895763 0.29145364887470576187 1.0981589423982989207 -2.4189492275967223733 -0.74338154733149974795 -0.48938046780990263063 4.0520842676430710583 0.12373222951027160188 1.1193504220874108679 -0.07968691322897915319 -0.39343083816482177228 -0.1375257610121136953;1.7552875220479300378 0.47905908357521898022 -1.5927147305789799425 -0.20233545534040150993 -0.2495703780453390197 0.50743791694182460716 -1.6587077431705028463 -2.6838883283133734281 -0.62344170823558442418 -1.6026407534363371621 -0.2853587208594156599 0.61707897673427158924 -0.51362818925636677392 0.31136026440304070961 -0.54393266380492677481 -0.78454125621265047297 1.9311488801072791421 0.38994714609524033788 0.15984951939028671508 -2.9353540220206597589 -0.11457974749861546404 -1.2593454354021405006 0.031381798182818332332 0.34573146380671587741 0.0064640655063359711563;-2.044848657023981886 -1.2182055192448060232 3.6564614613170629553 8.5600173517264366296 10.522310591659630674 -1.5138651934909277408 3.0728788860778690761 4.7690445490258213113 -0.35511007806591710079 3.1468088671382576926 0.2291456468875246455 13.830177074920031899 0.67335729798110754984 -0.088717790144211272629 3.6265031325489611724 -4.353676616879238459 -0.92440548229053431939 -2.679427246923034911 -1.7068172772555871841 2.6964007168791375157 -0.67336623534787054535 2.3166952997115251023 -0.87590154173378065305 -0.67430304230309878744 16.000245972458632338;-1.7075170548091962441 -0.46166780084988534583 -0.28247059138590518979 1.7939256616036483027 -2.0416291937059649619 1.5096200406185036336 0.7869749996632646738 -0.73496349191033205628 1.1385461888720265211 -0.45529582685308550571 -1.007318805827282171 -2.611192926771366718 1.3518186446436608605 -2.9815240925322581411 -4.4465287473459920164 3.2974296452436737681 -6.3079880499088547552 -1.8927715061887673276 1.7016267993341360754 0.48431231217873399464 3.3473312379905313385 -0.33031365714223037688 -0.58683437948058314593 -3.4604100109488475923 3.7094978247511285474;3.4403337922399646054 0.87054710577418992212 2.0898226485847994915 -2.8967488452112415409 -2.3959585629293433939 -1.4682066617762086214 -0.89752152868421020138 0.14264684422153006693 0.073029876186341005639 -0.94722606652027718788 1.0402365816359606665 -3.5545982152748893945 -3.0126751188050144847 -0.53435070479161828061 0.016331352032778537198 -0.80170663129054553497 3.8160358384269312815 -0.87618191656826593938 -0.59838149312559540949 -0.69643880178533612568 -3.0354145627803967855 1.3686299661675793704 2.5632734578027509542 1.0551543971170165293 -3.2343267724424631382];

% Layer 3
b3 = 0.56985499932701744186;
LW3_2 = [-0.10845247477915732903 -0.072651834322159325463 -0.20438689163873408061 0.099238763138451993595 -0.021487385280499635143 -0.1335883143130647821 -0.1130316008203459538 0.010090623017521629934 -0.29805770031969214262 0.071010980574660986786 -1.2883389751279570312 -1.3836113404195000687 -0.1589054484690378688 0.011111226182450400363 0.016873641634797455907];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
