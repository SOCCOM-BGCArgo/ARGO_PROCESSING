function [Y,Xf,Af] = ESPER_oxygen_13_Atl_2(X,~,~)
%ESPER_OXYGEN_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [10.147356889181295969;-2.4243441181941149942;3.0367502325026358712;1.9602105365832094286;1.4387933156708017091;-2.4000421336007815576;1.0517896111448026275;0.92201791642645603009;1.1554938463350437061;-0.38957765594793458686;0.034901687726994853889;-1.6680077398999926253;1.0850847365032345593;0.67218923094013838249;1.6395530659973249765;-2.2401419539043225804;2.5374688773673539366;2.1820220240098557873;-2.6006126826524482709;-1.6964977305412398678];
IW1_1 = [-2.664430430389897797 -2.2273730798655897445 -4.3484681916120289102 0.22292874865945422336 -1.8015928592131629227 2.4422310793850168231 1.0220013975569430809;0.57535702798186783014 -0.32516578268896567661 -1.0475224085627452553 0.37901992510640120093 3.8294686572848091188 -0.41885386576826011407 -0.25960916123973287739;-1.27745330571967175 -1.4320514103639381265 0.86305897369198869562 0.017353144267685544772 -0.84367435972836912761 0.62366086008120491524 2.6440635832094532276;-0.42128284591511588886 0.075375870553821902598 1.8289671400643905397 0.17777347294216336304 -0.68193601299013317796 0.1779582544105701436 -1.0751967866021359121;-0.76199715388571598318 -0.5702151820865664078 2.7459850420995586262 -0.17566730352963302875 -4.5450692530721648055 -0.3348686242629692611 -0.35153037294890621123;-0.54982474072260467679 -1.3896225111483231363 2.8821941079346378167 -3.0766164466724577053 -3.9762888059466847679 1.1194464366583354309 -0.097466443451076717475;-1.9127746746525555732 -0.4376716208145167708 0.0047041025862265654911 -2.0969299644307888286 -2.1669758637607223761 -0.82743843165773589554 0.2189715965380192586;1.1022189461702087687 -0.30482143608237682875 0.94114667326150103221 0.71071654134579875794 -0.69882627220633364296 1.1303827288053636124 -0.21539054556837031185;2.2164814957544467511 -0.5090774392233324841 -2.4675964112066064438 -0.70062383118269433435 -3.8371609295993347466 -1.3443426784897520854 -1.4311960473601050836;-0.076014093186578410299 -0.48755659237249560078 2.6213994501392052783 2.2651280574992451733 0.78264033708315372539 -1.9501056128607716644 0.35373960050205999206;0.89933078934513133174 -0.93663780043743594117 1.341670058454318859 0.092524666506930614007 0.33504112103090094577 0.24420627780556047881 -0.45892859950215497689;0.11747566531908072707 -0.8051987717321972271 -1.1879587419031314433 1.5503724134992165062 2.613517019748313075 0.2163572772826350965 0.96838252225699505971;-0.43988575297965631927 -0.22931696833584727657 -0.1883256897471791147 -0.58300930911769421883 -0.905695435162265583 1.0984902212684488632 1.0449500331500989336;1.3077667672396247056 0.086459210439049555275 1.4030067406691149046 2.3966373743609024061 1.5095043884319061522 0.84269719594872016799 0.76567860030024659235;0.57170200438878071569 -0.21402196526249767095 0.41969222240790321488 -0.83787174927922003498 -2.4117738716830290358 0.84001204560784492603 0.089142909298599859458;-0.14386584641605626445 -0.53821250822143718029 0.89519181833707106577 0.64133401266359912896 0.3272129736669580069 0.74374308281964729428 1.272685980986324461;0.65749113047095542051 -0.48268850987932787611 -1.0008316845166667086 0.19445653839856819056 -4.2187527623806913013 -0.93101725401915147451 -0.35825019104557509486;0.29966583723705331188 -0.45861980345144875981 -0.1737335503925401814 -0.32246193426155689288 -3.0547318990124519011 0.49976382998078183739 0.6570255526503880894;-0.65703279343933196355 -0.11766301923924589456 0.34958804246691160822 -1.5254083263030837614 0.89782731831247630794 1.4118677071776057907 -0.74270194177520310053;-0.30371320698694542761 -0.22972183659269473921 -0.048909659677518965704 1.2852602614147432547 1.9186927281090342401 -0.55455649895496894608 -0.023513871519765520979];

% Layer 2
b2 = [1.2295312748163644834;-4.3728492475141109708;-1.1698698907575120209;-4.1979090971775390173;-5.2440160759313636518;0.041033004066485023742;-1.4821093474021793668;0.76693741188837338818;0.4055829106604650347;-0.41713810867353068312;-1.1587079335869914232;-4.7066322127790272134;3.9193249857384224732;2.2489974218614472434;0.64258314192616183824;-0.16042622137519355063;-1.8533739929200474528;-2.860101073276199557;3.6095085191654767698;-1.6780485576782673274];
LW2_1 = [0.11463292411070916121 0.75791112505497704177 -0.57023594692011059237 1.5771286872205225738 1.0352488476873880074 0.57516124834556336953 -0.16187372732485946769 1.339917208416271599 0.34205760419459763089 0.36937945589347220832 -1.0388433906026901532 1.2472185454381115033 0.52055679979532831769 -0.31222217719057060448 -0.6173145800298645014 0.31912752394649873677 0.19231168050087407706 -0.6658118034781966843 -0.68669549042986754994 -0.61632540806763624897;-0.444971999513068317 3.5919045261991056073 -1.5739172211724556938 -0.29001609666493644024 -0.62101779970392045893 -0.32551555723783009988 0.76306879382223680164 -1.1824363102358181887 0.14399672797938897761 0.64561948772886312842 0.88577174889790022405 0.28172072416727378386 -3.5968192594777863569 -0.32413279204782208254 -1.5853663220019269531 -2.8369684297148300978 -4.2662566588430443915 6.8481401551688669826 -1.5698979497003773265 -0.9064337163497053762;0.09777501568197161097 -0.21780778244533213761 0.45327128461406346327 -0.65482464791924877012 -0.74665944009881479726 0.62681040758810691038 -0.05986487661089798934 0.23608189386185771119 -0.026993509169981836499 0.38483206181810897251 0.3190376681752485899 -0.25012017529441443742 0.20141060521463519106 -0.65703364393102892116 -0.061140089104459574565 -0.66507967586494731727 -0.72325782255587645064 -0.56521670298310444647 -1.1238316745981149491 -0.30053433274477475701;1.1772658518143210848 -1.5248333372282008025 1.5039975786187123052 1.1676120643140266431 0.093378352635595185394 0.073531816534550265008 -0.099242212933451409707 -2.1755784531042818841 0.56399110051609313565 -1.648698513658965803 0.82160656252447961112 -0.84637066500669777547 -0.87645316586446608831 3.1159685675671258132 -0.45714247935245694299 1.8710258761554650064 0.41895168139917571271 4.2961998204395630552 -2.1317713815143517486 0.95087794284027238323;5.4517494024458805768 2.0369608162327601519 0.61254741358947795149 -0.73810479267981299323 0.40001478314196003971 -0.26347307404416331345 0.25031755073488437535 1.0800094299265943221 -0.57501840909239410049 0.74781987076766220923 -0.69127961233828105758 -0.62286421329885632847 1.3918891695889903382 0.34546794649575740532 0.24410467165284904789 1.5707831814884041233 2.1985918265596016141 -2.1866749886913545708 2.5717221405137165036 -0.79966024899886967159;0.24201560513880199244 -2.2338164482785320963 1.3108755820223159105 -0.96980018105038445775 -0.32574406844432313157 0.57838795364834916235 -0.8880201287079325656 -1.223329510635147388 -0.30640157407151574764 -0.16865060438830040135 2.4598413423563174618 -1.0124159857506020987 0.57802572066192581257 0.52552600333121368692 0.40331616757643545812 0.84770504584089312328 0.80183652875906530344 -2.1911141030517669037 2.0401207419246247809 -0.24321215596552489546;-0.058449079624343140693 0.010180616211087291714 0.70985018025355295368 -1.5314657151584913919 -1.5525081721805791268 -1.03155860376320474 -0.65815697299160813571 -0.26774245865615936557 -0.64478454806328855398 -0.30052704252032291787 0.38632051175162718248 0.29020364757435662684 0.86500611605804900162 -0.38197530336325918876 0.30691475860657385644 -1.0535579678033832884 -1.2564048905950377932 -2.7666664357912864602 0.63109760641245282731 -0.040128880393243297753;1.6602911476115826961 2.1354180032895730967 -2.7513395373650491038 0.45108887579565737358 6.5145824706852515362 2.7743935837252577947 -3.0421575738761070795 -0.10966432510267512535 0.42163785473002107773 -0.43504374974733273085 -2.1804009127328680684 -0.36658314035933398101 3.0015625161258485676 2.0909035804607554176 -0.1433638154699057865 -1.1742437346776450902 0.65012911455638489056 -0.36232589477770787978 2.0859377012493278691 -1.831773085962157932;-0.053505056346922721944 -1.3364513311198347179 0.93123512228738103413 -1.909503464899050984 -0.26336500104765253605 1.8276288648165093242 0.37267314471462098524 0.98618700822474925083 0.804870057627318225 0.29608549066498074387 1.2188587980070082484 -0.93846231002048885461 0.84983744835060115452 -0.90483125739406444765 2.5888925673802316574 -2.1418983527128983013 -1.2233612483050571029 -3.0507787306822162776 0.89841114168362856685 2.40214142256590657;0.61328002875126308435 0.80693188005228699833 -0.70691614038428673972 -0.70408466796971491686 0.16329155274879297854 -0.5255510377025474078 0.68512204651696262392 1.2180175023363399855 0.24874757697878377427 1.2500321976445847305 1.3196273723486855456 0.8942748598328265075 -1.1691615294756563248 -0.33431510995878888082 -2.3355643840372781739 1.8414915278025230094 -1.1927503966623698162 2.4060464158951972991 1.2178660940868897278 -2.3104528514931814698;-0.12798496070375187106 -0.94265546794199039926 0.59747672992074341014 -1.5497363473696439407 -1.0607908756160353558 -0.86435123473020125662 0.089432684876770432436 -1.5752967853516437469 -0.41378882997092758522 -0.47414929723583204568 1.1080898277143240716 -1.2174179244750853446 -0.60181502930943397978 0.4655630154085221295 0.67089087921568812956 -0.29815593232358433839 -0.012673776706937034398 0.70623199040982198582 1.0427135969113703329 0.68752469578026864649;0.080849350443406423072 2.5260485465458137888 -0.23436798537551423172 -2.4079864912218740258 3.8177749185518567998 0.56947464274966230757 0.63058800281624272088 -0.068151932852964836052 1.9388288092617604885 0.74078320324493718285 1.4339954678249200448 -0.30639922831857585583 4.4666881074755151459 0.30649196862062305646 7.8535793779454392549 2.9527169068295400223 -2.657169937956586292 -4.1936856876934971439 -2.3305967511031311368 1.8380927457600413355;1.5164300872291041067 -3.7347032499245216286 -2.2870995065620505216 0.47063190541555965929 2.9945313472070420602 -2.4900541465170507038 -0.57305260080356912322 3.5801485083584547731 0.58088921632158818653 -0.50529998475271642455 -0.73063866062294280379 1.5143581520846385313 2.0387309297435640687 -2.9505471180098390427 -3.5191346475127849303 -0.077794653154448598076 1.6294400143855378715 -5.2073881957674865717 -0.11124940852131698366 -2.3842291085874181;0.20639463598638152497 2.0139472387475296777 0.24057185637267988754 0.93000331626854493283 -2.6040895082199408961 0.600561339913394443 3.4214133162141080469 -1.3276021603225529599 0.14750831390838287094 -0.20449479895516767258 0.28465151472301825075 1.2538552151906854348 1.1365705473362823774 2.543552583187407734 1.1100127700429989197 -0.8123406626777509576 -1.7725568819649746288 -0.60729177499939479556 -2.495756490887726109 1.4712191976686688211;0.33833799257554059148 2.8062960898125877129 -0.56625153937285555017 0.98378430590192356142 1.3641119433851198739 0.94537554914960175712 0.23839895971684524345 -1.267386895404503333 -0.26813702586081250567 -0.92156000107807667376 -0.39607470852571746711 -0.058540507528711031859 -0.8699146478156254414 1.2988251652943858527 0.81043290905604259411 -0.16454459194526910304 0.70439297838861913981 1.7454689111013095282 2.526859806091517946 1.063697056138627195;-0.39881969722684790236 -0.66754132523116882503 0.72358056130751413626 0.60328168568414430872 -0.14502640209617922995 0.43296031559426373381 -0.60855940979336531349 -0.73750544103464588108 -0.2432135442373744294 -1.0928939499690157877 -1.0278057766537596063 -0.91882909090004827313 0.98288895106957518966 0.0011973296880367495509 1.4723519203051955717 -1.5085027742094510028 0.83218217913443703893 -1.8210112643521831899 -1.4570438460424635085 1.6277961789732728892;-2.0351059183249415874 5.6250113962075065643 -0.72593276620853164349 -1.0268059299633471859 1.7207654262909484189 -0.28364463161067343666 -0.52310234111562714521 1.5478467798648700704 1.0765868729378043067 -0.47452918335087584945 1.5427604150301619246 -1.3261928288641053886 -4.801885253396195985 -1.2111801431308593102 -4.7384775928541653656 1.1049775384332007899 -0.89504319948578148214 2.9640994111411838041 7.1977710231345080061 -2.4619900240554457582;-0.14414457999900903706 0.4046765874219764858 0.30420764970327873744 -0.219039118094178753 1.9093895680264647563 0.53293385437055407206 0.66381739191049315973 0.082859175207052507273 -0.065949952676154499631 -2.1614976756537620517 1.3470952579580990349 -1.1861693290451091887 0.32532542733564601134 1.0164906090771750335 -1.2391514682218411902 -0.68639505158865243839 2.8733048828824543364 0.36531542899068081276 1.9519985486338469194 -1.3936074408030665328;-1.2076452966425570423 0.08613509574818527248 -0.18660867039606815476 0.10507078989927090551 -0.01677233107715940183 1.246064827804897801 -0.28254623684127749828 -0.84471348843046845101 0.32909204738422032088 -0.30169972412176859766 0.55335019832736376255 0.34854085843034976477 -0.1862534568553795844 0.13435895705491734953 0.39171575767928240586 -1.3163294296314085319 -1.5573284395783568712 -0.28132601212729796414 -0.16876722149401232609 0.75599690297157029484;-0.1184307233134861137 -1.7530836713236317426 0.26593476859059489437 -2.8674489835681038485 -2.3562598053593251102 -1.9817064713291083766 -0.024757961485693969622 -0.45332614370515811331 -0.7509275421194298028 2.0404181610930005597 4.2113220735173735321 0.44158714025438355888 -1.9861629530316760039 -1.7953464478545027028 -2.5117316538926570679 0.85181214770484492416 -1.1961616033521771385 2.83296530592545448 2.7228213086164299028 -1.1760404279851883746];

% Layer 3
b3 = 4.3777233516390534618;
LW3_2 = [4.0821610240614560894 -0.32463755305006952723 1.045827663398919416 0.090350733298338106736 -1.1968357978340491421 -0.39833778707544215125 -0.21967061896345102534 0.056144224292983255231 0.22458091800044582831 -2.2609861552233616599 3.7358192394519993407 -0.39558205357690462423 0.11119038895898941677 -0.22788781018789575072 0.54190032568294332904 -2.530233102629854347 0.22566997344403333381 -0.29188308218854597254 -5.8489452978968445862 0.15594849297234150698];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
