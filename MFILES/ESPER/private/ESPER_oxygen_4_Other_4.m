function [Y,Xf,Af] = ESPER_oxygen_4_Other_4(X,~,~)
%ESPER_OXYGEN_4_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_4_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0241369204904207102;15.733132193021143408;1.1511678941069982685;-1.5634538646868414435;0.1804957590506556242;0.2856892212288648647;-0.62117607911077710181;0.72880348865147970283;6.9588113993305942273;-0.86490027168496197429;1.2495849200263158263;-13.136759316993668278;0.051898382834678229159;2.0937205762529011999;0.23141706693390995397;-34.979626767527548736;-0.70645710778221404436;0.039016177658396912487;-0.11813087694926223403;-5.3775147893253887332;-6.5936866771294075917;-0.71116863784957617955;3.9282529312556442314;0.20668964513443968678;-0.37582254337851800363;-0.36858664748271241507;-1.3817276375104901032;-9.6495829320279327135;-0.49672357942603911907;-2.0057653394140224634];
IW1_1 = [1.5912737249518766891 -0.67564659098350310362 2.7876560042645448512 -0.66641637442218404352 -1.4390183557683906557 0.39763390681151344896 -0.78030898414137717101;0.067350673651466311243 -0.27977129538418704646 0.79119785772438966376 15.767814638574808583 3.0239991713101925797 0.34750073275198256617 -1.7125099579670137739;-0.47215260203982917231 -0.23262462558075372443 2.4697038178107288964 -0.69341289459889099422 0.28346081549961721358 -0.99209517005870062611 1.0499161133623304831;0.55307051699753440044 0.48594913109137571894 0.16293364075511759803 -0.31701896724589145871 0.60863373009907639766 -0.88160436022520738408 -1.1396248226130158976;1.2411028405642305916 1.8721321432601323309 3.6830214478136138467 -1.8917060996917522964 -0.38823159611379842726 1.3596888662146235927 2.2092128280147789177;-1.0746446197723804605 0.55117484118971848961 -1.7439027885322813116 -0.20515526057278868355 1.9017482869373054655 2.3028240209771375646 -1.2770807458673019141;0.26927060921213091804 -0.085590429240036000613 1.7180442718888242482 -0.57064008547753897194 -3.0769799668758071043 -0.40498394912055685202 -0.99986854925849111275;0.22034762080869690903 -0.61906294848659348951 2.383173526315773838 -1.1264650733001464467 -5.8809246927797396154 0.54922023444586853813 -2.0152115183896674999;1.2925302813648802402 -0.61483102833656433361 -3.259309122901973943 -6.8332412472776065115 -0.50404797685482904956 0.12972441697708606001 12.386815774291635606;0.20566584109540833603 -0.042194159400361239132 1.525978214660552279 -0.47247811307175485718 -3.3890682213189218253 -0.70331940312274909832 -1.3766824584980859036;0.65344990518613388364 0.4465684889167449434 -1.0064535576009481233 -1.5335403353939061066 1.6007984611610892589 -0.98843039935575527366 2.6049235988698455913;-0.016264898893803055729 0.34092383846113344381 -1.0251940207980800857 -11.298825950081353042 -4.6516764503326717417 -0.29849963672611617982 0.84032601129573336607;1.68505154026405779 0.18990483849497130642 -1.4025311910624023159 -0.075535840478548957333 4.1923869648031582003 0.624199543242184407 -0.37323129541912691831;2.1979320984639367786 1.0197218305660993298 -5.3285408185011586824 -0.20573627303850622328 -7.8612941494490620187 4.097239759158950001 1.5187900298972112356;-0.2782839816506668118 0.028552337009323011663 0.087514239382333741668 -0.24118588595950021802 -0.087103272220180924523 -0.074095674400420724615 -0.75035286289111846614;0.041718515163496533438 -0.041361273035582686586 0.41353589786864780597 -32.741125267928730125 0.20935818100211447956 -0.020281815109476453857 -1.3524453090535453192;-0.70430692692204510674 0.28733621721584157171 1.2431217373924650094 0.3861793151729642215 -0.2135087067136509642 -0.48451092792103578333 -1.2333631717344599732;-0.65039350430533759972 0.36336838225684109371 -0.011835925021904974974 0.064025793276680911803 -2.3391185736154160857 1.8659311117623507137 -0.097643863616087345214;-0.31788031498284236021 0.17079427670451752252 -1.5103627309328966355 -0.046914756662249118557 1.8121498796462245373 1.3291379930321782776 -0.9420730095356346645;0.29705154136679701171 -0.13579462615960274929 0.64847707047184410811 -0.77479693683668060533 2.9504124474005704037 -1.7201899397340725262 -4.8873543879067939955;0.54625801819613517551 -0.42223488087757271581 0.97857080490399284134 -3.9099454605428345388 -0.91647817133787201627 -0.065451565027580482781 -1.5657130233271832065;-1.2380705520882546722 -0.20444959552758543153 2.0683972630583875585 -1.3612293264781765156 4.2174251751364213447 0.40808692778263128131 1.9667544013845477124;0.34029053543182474773 -0.051907041549160114202 0.098556554392425971267 0.22802162561840799704 -4.0010188192821027897 4.031208986767516933 0.80296349988559356792;-0.81598715133108790099 0.64504987152759463154 -0.28008981107557062717 -0.27847884267263467439 -1.2138789308130626399 1.7557689253476287394 -0.93887044231952143658;-1.4501684554932530169 -0.40517080419921130963 -0.53218788305758124579 0.73816733473166562529 -1.084887215792654569 0.38372490844357959316 -0.59598844519445959289;0.71745650667858162919 -0.42470590359674115222 0.29900699309710682128 0.1307919571342132381 5.5724084167964935688 -2.1550820201715059632 0.11040954680044631764;-0.83702434319025398324 1.9346192588615533925 3.8010392099539451749 0.68907730515339216115 0.7843794286851740738 1.3076184306935059176 1.6367689481628262538;0.25558843175596251962 -0.58724928843847601367 0.17966310719795744455 -2.3884733552716648219 -0.56878169835533609611 1.2022772370968934919 -6.8903904577029244649;1.5467670130697752651 1.0237792216006034174 1.8334461639848469439 -1.5893376397582246184 -6.3751820547364657088 -2.0714667717072563491 -1.103952805675344484;-0.12516073441584865678 -0.40506753889001162472 0.33880449817499230791 -0.22831047278442631598 -1.7129805946590688226 -0.65868313482975326956 -0.54899034148967484903];

% Layer 2
b2 = [-12.948244525246964898;11.00768516414370346;-2.5719325326341841986;-3.8416880030974915883;22.498138832106363338;-3.2320608898066471859;2.5299739472232851689;6.7407198980895479679;-9.060610453694536659;15.668323499941251953];
LW2_1 = [-1.2612034221032009107 -1.3870063240948866667 3.5393109213509359456 1.0623095863490268354 -0.10828494798092166973 4.9126613840995148053 -14.149095677501497548 2.0675309554336549489 -0.50358981654210088763 8.3901511591517099475 -3.210717718557953404 -7.8974586413304654897 -1.3901941260918064813 -0.14363629159600893592 -2.5389567830782171498 -11.582027298410887184 7.0375996854111368961 -12.516241049780713723 -0.87317494260434491693 -3.0901629112235151631 4.2614413116443401464 0.058980798398183729991 3.7075421038923850325 -8.8006745770935932427 -1.8103230794549920457 -11.311775842174583318 -0.25766334800862350507 4.0785245927168345403 -1.1043822779386553989 6.8054650652949311151;3.6861013503354738141 1.0981931723797107026 -0.60248364626714379089 -0.19598722997367198917 1.0225091237412731182 0.75096977129965603037 3.6678087815298709984 0.47419115112038534576 0.25610414802209907625 -2.8620879915719332764 -0.71898651396220769616 0.76593711617681703441 1.4287975236192325124 -1.4689106290694051715 -10.24946676784438182 1.3181525666280571318 -1.5041438383690628466 -1.2266140285550559685 -0.46348306701245473027 0.77616706674363977747 -6.5204375618806427184 -2.3777916718460141432 -3.5125287490892245224 -0.55106624993279218483 4.00360675411417688 -2.062948466287982896 0.84486560248427577946 -2.3153620333142348464 -0.86648925615644001308 3.3196185928902206541;0.52032222531759997342 -2.960424536723086586 5.3462223519462623855 6.8883927842563030808 -1.4950774592899986892 1.0182015599420419782 -5.3524366819740523127 1.7498208355215940646 -0.63012112838135514448 8.6917165368473572329 3.9228878781395737363 -7.5194075586908715181 -0.56593724914614140786 0.79110337532628272061 -7.9799644380558643064 -4.9450215129921888391 -7.0883355348107786043 3.7707804243718068271 -2.63691320343879676 0.96164203683939630807 1.3475947468329940726 1.2053886634797652544 1.407520932875367059 1.2215236813182108744 2.912571013402302178 -1.7579032665440066374 2.2747110353150641338 3.2760238340942753332 -1.5310263851620480313 2.8875252598976253182;-0.67213135685998792734 0.17535298296432821896 1.1603708545535755814 -0.09175055209305671422 0.28775017068819985777 -0.73257051541795759064 3.0013745823648103617 0.59242909334100957164 1.0447550435752896991 -3.1961206180775239005 -0.29088483258001335274 -0.022966463031078448304 0.65352586255429367945 -0.019165426733039902379 -1.7921300621035145539 -7.8557212951710866378 1.0235619228239380973 -2.5867432117255035884 3.0771560941379512144 -1.1531953066847882017 13.678504862905267458 0.24392424030401510526 0.84915976964922534886 -0.95147867333999069928 1.0341622456509282912 -1.5108368591962353378 -0.40162417486116597232 -2.8208584977224973045 0.63771136154785790229 -3.7835183905756499811;-0.87707921608240835276 2.1836530482872635872 -1.0992543082316055258 1.4240792894715577077 0.08945812789512835872 -0.65996942338085406998 -1.4184459501958044392 0.79446073182460275053 -0.097240210217619318933 0.86840083460552353056 -0.43099318935608776915 13.862647157755610294 -0.86228075942348825222 0.34420344137930392048 -2.7499112709108723962 2.6101656616319677262 0.064515228719486908404 0.83076756289584785531 0.31534700357215889044 0.49699686138059395724 -1.7523623464499435975 0.06170616243781262833 -5.2443836350202506225 0.70996940582559930899 0.21385516137682600291 0.50083840433224202648 -0.26817980295146792713 1.6022340965195571716 0.20179504602246112199 1.2280033441228477287;-8.3210474368491951225 0.63697085933855934758 0.67071853505179712673 1.7011648507980781098 0.1301192920644113904 1.5568147130838556613 -4.5261498640392447967 1.0134817832844980057 0.92085371290801165678 3.6089236348993916081 -0.14400990584637876624 0.98943253494211536037 -0.50854822751391293156 0.60576530949410278826 -5.4684958594852588476 -0.19353742020059228057 0.40506896262726921343 2.0374181665276842601 -0.77348371458898923514 0.71283825911790976715 -3.1907728972869837669 0.5480746489745655925 -1.4927311671879595067 -1.4527468135710657204 -0.046705145410834342234 -0.84572444466623153403 0.49682479451368577461 -0.26477453134139650182 -0.16546327693141790749 4.4354951283544314933;-4.9068288926334471256 -0.51068136743922254439 -0.47150828343275225096 0.91237713583550894558 -0.79340457154960131181 0.68373370521159715363 -0.43721702953427638016 -0.7215297523106742883 0.24478363525607738094 1.4883509987400789232 0.20376203503538464767 -3.3674959449408921053 -1.380494855106406682 0.7658068264426779459 1.4984890924162883596 12.332071716210204926 -1.8473911145068069306 3.8924795910093092921 -2.2324557002306852915 -2.08684839803078237 -3.8659388490758246348 0.60916126271439874351 3.1582979250377540836 3.6587817536471720636 -0.97595520161873960951 3.8032725620428582403 0.63806433130891715422 0.78828151630760467938 -0.79381387980447859487 3.217855776870321538;-3.3127851993204493475 -2.3968337488153141912 -2.5486676330125876966 3.5355336831057884162 -2.1422531626638710023 -0.82522418346746140294 16.677075966757385572 -1.3086397047528397497 -1.0174620075111668882 -13.184178623716684697 0.96475476663967518753 -7.3423847294834505561 -2.2250871197589132677 -0.27591817100030996412 1.6778996772114727065 -1.3303956918701251855 4.5465714943100303813 -1.6463569014133583313 5.1134725317852325333 -5.7425964498078876375 12.708976613562187552 2.4047158729398723231 -0.33868435388529333219 -3.9523229266973154417 -0.22703266760360327203 3.0606124521619091361 -3.4947204413074559604 0.44829623242283056506 -3.878443644782770594 -1.8457515093408998208;-2.2235129724888191838 -2.0344991171180533129 0.093556142156162550028 0.18831023048892892024 0.28043675449044447312 -0.068585047727954054353 -1.2793294961026255852 4.8113696507495937738 -0.091730144706746716277 0.74629224630192403378 -1.5086353516124804131 -2.162510176620473068 -0.034148376846602060408 -0.21232054396396835005 4.1214354525462972845 -1.5091337434260974071 0.51664475293678946421 -2.1548443611657890351 0.92640739843421149313 -0.77221155164844046404 6.8118698903810566136 0.32191201237746741581 1.8691051715045903237 -0.35353570800821970677 -0.88443973896364291853 0.029665606495619566835 -0.4106028947278169694 -0.46925300634159833324 0.37269987682774985416 -0.59471730947934575706;1.3583016339833973163 -0.63102365621827505304 -1.3216079379599754429 0.84449567874520803379 1.0526977964491932571 3.9745582349817749623 -5.1217731406430635488 2.1037583629623473058 -0.31529528154684083319 1.2971610831382089923 -2.7452384272305336843 -2.9423974203996738908 -1.1371622019350993149 0.51591335636513357965 5.500775870681552604 4.4509569470240588629 -1.1056446649351765465 1.8582294894711850475 -8.7072967697604735093 1.5300763915976085539 12.892491066093816343 -0.63547776107417464075 -1.5143928241342563545 -3.4312703890720945843 0.29704351661904765391 -2.3052288936823672749 0.4414891471925208033 -1.8273271483055872899 0.20201030566761080109 0.55699595163587234392];

% Layer 3
b3 = -0.041900238334790444739;
LW3_2 = [-0.040989554439710230993 0.08164245935624792061 0.092527767852670056437 -0.23299243385184448263 0.48989201795623893432 0.17554003046410784905 -0.1075370033395209729 -0.067852229508118838686 0.36049843085161364931 -0.082727619356121689931];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
