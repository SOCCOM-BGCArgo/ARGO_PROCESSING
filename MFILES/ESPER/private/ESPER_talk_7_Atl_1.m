function [Y,Xf,Af] = ESPER_talk_7_Atl_1(X,~,~)
%ESPER_TALK_7_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_7_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.56645696422104763;-9.1526881731561502;-3.0235096115927651;0.25890787093777906;1.8117833428943471;2.9320151031291632;0.98918568589300537;2.1684681222029676;0.10637376346197432;-0.57282043791357806;2.7748145693030684;-1.7774859704894443;2.954205388468091;1.7040662551269277;-1.6676684166230944;8.5414040666957103;-3.0663343332912234;4.5358688063737578;0.19617566496016539;3.0840896549293375;2.0974689290084685;-2.8928668547150918;-5.1965923084106294;-1.3818540139482209;-0.09255202573603738;0.5627567494026452;2.401328473435854;-4.277284022714392;-3.47685781482636;5.0902184044092937;-6.1112811217483554;2.7025699338171552;-1.0895842739121018;1.7760591812502036;1.5415322133630036;-2.9414243384748238;4.0448880105137466;0.7407175613352619;-0.98762125590568139;5.8905497319306095];
IW1_1 = [0.24730454908015498 1.8454851159074801 1.3902665844087463 -0.40922967375505953 2.5408982816082273 0.3654241541517011 -3.9425232557789078;5.5046741201237648 -2.5117115244021022 -0.87771672343197138 -0.47076507309948878 7.0724421676441018 0.0035231104560588915 0.44923900114258847;-6.6383454228228329 0.02376207242373091 -1.2685095556717501 -1.1696267138268246 -1.594210794740522 0.97502945063383661 2.1948255359720212;0.60109082866422536 -1.1033070573916379 2.1473992551434606 3.2603023164289304 3.0664943320797535 1.4588305413179299 -1.938624301475071;1.0098854142499711 -0.31143595720265921 3.6814555271739469 -0.41513588347378605 -0.66561237981137578 2.3141911293143056 -1.8697064489979205;2.9242933145002339 1.2995273333183115 -1.1093235153259213 2.612282327645516 -3.4727558873418496 1.732810686064715 -2.7870992291680023;1.7619962721070004 2.0570376026913415 0.24801926798227628 -4.2604899019823792 -2.7907339478748616 3.7342415936197799 -2.4903749843483918;-1.716622527729426 1.8846308647111483 -0.044401196956931857 0.6226213903651725 1.2216734324418606 -0.72052079230697652 -0.9212361261294576;-1.3672694285346538 -1.60599403227991 -2.0108458944099916 -0.49484032176033538 1.3913694749803369 1.014569974390426 -0.51831749619940903;0.87739019038451049 -0.63193830909301374 -0.34015681643539547 0.16650432300414689 -0.38540286514196331 1.5554086102500499 0.26178188887426296;1.228466821393196 1.0899621509303699 -1.1672015161276108 0.28601626230531441 -3.3826205298379337 -0.27565940567059 -0.20579148433424024;1.1752679208290167 -1.4377094355780697 -0.51091828001776163 0.23181941961969788 0.34435940361033723 1.1962142665771107 0.1568163903445719;-1.4349032467713756 2.0675439923155001 0.59413125298802649 -0.16748644510280494 -1.0470157608680877 -0.86327061187931065 -0.17163651506877145;0.54690674819147389 0.76043334665365736 0.046165590715945552 0.23829907837519065 -1.8001055204785732 2.36193948493161 0.63499722075721976;-0.68064005117207194 1.4105478203881023 0.42747730268827128 -1.5309796015319967 4.8642130447295173 0.076468761900407828 -1.2586210821473907;-2.3380650581751876 10.061735910547435 -12.83320585584122 -5.8962670260884904 -0.38996434090221854 4.3603755632019041 0.24024806977516591;0.97247209496193288 -2.0889214806646201 0.53192398689581877 -4.3845574534026559 3.988401468666904 -6.309058792100819 4.8100894754972732;-0.64691250221460961 0.32102436744273866 0.33285365071621748 0.23349603288723617 -4.5187122862290625 1.3091206892529745 0.68145520225933143;5.4277808338355022 -7.5966932754725534 23.800839699629272 4.6774600021725865 -10.798526700635193 4.6894870467805641 5.3574641328256325;1.0528801237656777 5.1950368608594149 -1.1963481460711167 -0.36739769657619431 0.33896221572600066 -0.27190254256834856 -0.29856554532216184;1.2828693598836118 0.87475758876420007 -1.4584103722353381 1.4861597861317259 -1.291702471931486 1.5017399889885612 3.8429374673856516;-2.0226919354771531 -1.176474956327626 0.089777394683784525 0.12441511416126644 -1.1855679665626346 0.5611830561713812 0.40721284278263381;1.4233372985247412 3.2518291167850832 -0.048502085153435882 0.15700577395298018 4.4383206567744224 0.57533638839142009 -1.6133142279976618;2.4871056354300705 4.6572307639268695 -1.4472612341647235 -0.85187904778223378 3.7513058340168466 -3.3008442035760468 -2.2281696874170374;-1.228848263849956 0.091393856409783994 3.9386936794581047 0.19249128448225603 0.95395640994782149 -1.3333902853485331 -2.3304688971954763;4.1846692325626558 2.752922591929535 -3.835212882099877 3.3274048817988207 1.9180752114441115 2.93413369694141 -3.9340189361306268;-0.52739695459094238 -0.027666594422754712 -0.5076766528934562 0.61756594388898289 -2.906822352969189 1.6103153018582825 0.5045681744210373;0.60581262193830332 -0.46693727516964934 -0.26625444670840648 -0.22805509725360604 3.92181355387094 -1.3675646164749122 -0.5508743938300994;-0.12182386777588113 -0.089499333486500382 0.5816223134542835 -0.64319414719986701 -5.2132338317603075 -5.3845270427254563 1.1222239713147408;-0.22625414702613372 1.0423703734995369 0.74867296673968697 -1.407347760668419 -4.6889004828782328 -0.90524878527765806 -0.57232658527871483;-4.2380061627125256 0.99787993622527826 -4.7306225351717934 1.2946191298424312 11.221520807176811 -5.7139981228284018 -0.18873529268220443;1.1181076910338625 -1.777145530052586 1.4972496189930746 2.2212879364741998 1.813737344088505 -1.7058427451711973 -1.420611023872137;5.7489153148778991 -8.4148644379953819 -2.9818881073009793 1.9897555417215689 1.2765127258425455 5.6914682487447745 0.99594625780486579;1.465206932886711 1.2425308720576422 2.6175543984026723 0.69044448801695946 -4.7046635197496682 -0.82447224973999766 0.87187089880716773;0.041782978034354677 0.13132911366254599 -0.16168503079341415 0.050455050256815334 0.87438347383272985 0.45746897606844944 -0.023411454197421869;5.7130920111036358 -2.0756731671908235 3.2248599620713598 -5.2679266869832801 -4.1160326073912374 -3.9358262543947733 0.43336888106696353;1.4863103790080789 2.0699700060256645 0.77658097375336343 1.9801289390797985 2.8643941838647065 1.4027275498995067 0.62627709304620471;0.89332124393359813 1.3545121555285471 1.3984618997092608 -3.442360649325765 -3.5403323337359187 -1.4678097916247719 0.88052054252065004;-1.1512289832516647 -3.0158760753030003 0.45806810210444782 -1.6498025262111073 -3.2514238234831012 0.035271099434284373 -1.49223162120741;-1.2254734014008 -1.0948499016126232 0.51385735634197072 0.072678961155809046 -6.7378255882145419 -0.1010139085479457 0.36403742620797819];

% Layer 2
b2 = -0.69966067973057611;
LW2_1 = [-0.0064103102260049385 0.010275388482612013 -0.015657147072399184 0.0085968650856490317 9.9120503648442219e-05 -0.0098933182954784853 0.0028763090067258266 0.15310939652118929 -0.10299648101234844 1.3045404103807119 -0.051604089686483702 -1.844550705171784 -0.96000815744815537 -0.22931321834527824 -0.02868212422449699 0.0022749607464726601 0.011275025087709006 0.78217008196701188 -0.0016688402880078838 0.020703661565549078 0.020861898111199321 1.5189509132456271 0.057993950482622666 0.0069633391560090111 0.015790843057347875 0.0045012329825152332 -0.11213205711407948 0.81000100271282793 0.064658959704843214 -0.12613130533743991 -0.0070070068080194574 0.45116274400510281 -0.0082125310137498089 -0.074861227270425212 2.7456527619731776 -0.0053343211535870289 -0.062721510943264724 -0.0088711128060771829 0.010808463469091601 -0.10940185958588436];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
