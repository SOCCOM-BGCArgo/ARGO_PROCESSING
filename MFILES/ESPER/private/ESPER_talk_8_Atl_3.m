function [Y,Xf,Af] = ESPER_talk_8_Atl_3(X,~,~)
%ESPER_TALK_8_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:47.
% 
% [Y] = ESPER_talk_8_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1039158086542378;4.0252326467863764;-0.94866568098873449;1.728635778285601;1.5660025817470522;-1.1264356437944651;-1.9219819167127257;1.9856213641655365;-0.53985705519367155;2.4653217509324623;-0.34329703504408371;-1.0165185737303357;-0.40187288664459997;1.4370231408368972;1.4474395352993763;-0.054802353024833654;0.17388079106473861;-0.13790794633971132;-0.76247839103079706;0.55456887015433343;-0.72707201538300614;2.2830588778162224;-2.034402002984371;2.090782593755419;1.3749243058351168];
IW1_1 = [-1.625370823430764 -1.7452372525329392 -1.0248625748918843 -0.08934065387646456 1.6218632219330678 -0.63622406077297811;-1.7784178638278121 -0.79658332597575121 -3.7977737606323281 0.067810267694463799 -0.41900928173995478 0.61156488278785881;-0.77274731647687744 -0.98903482480014726 1.2371151279782757 0.21224864612840269 -0.38006201410515078 1.8474648170383043;-1.1668005090730404 2.0382404143144757 -0.91902308943670163 0.24375780715484019 0.31614000900502931 0.13121912665198626;-0.71753070147244846 0.35599252620798294 1.1439483259676866 1.5751116313970255 4.8642326764823336 0.073249290823445279;0.62939543111072138 0.37706934765408912 0.71813208284075791 -0.97971669805090578 1.4384405323123399 -0.073312670422251106;-0.010942329223531555 -1.3906367539108031 0.42087062492106297 -0.37791463046356411 1.1353535000337835 0.6977688981164043;-0.11899759124490601 -0.77514611835762759 1.073197973447227 -0.1966790039984537 -2.338523275526057 0.63051740384957444;-1.1884034039332252 2.1794973698192108 0.75321762309051943 -0.09459648674680371 2.2666136198687932 0.77493870706987711;-0.59300074142103687 -0.63955581322575561 -0.32709779293368202 -0.65262171320668594 -0.98994626370409289 -2.2179398638449133;1.0052061921800035 1.9076853249807109 1.112795641074287 0.24823493768113794 -0.27064757543680573 -0.020928662726182629;-0.11617898324912748 1.3112451895755646 0.99114796406567551 0.26042032672723825 1.4608525092124187 -0.36339541912997086;0.23370365009195565 -0.55942130708931492 -1.522036822528025 0.97425473442347077 1.8442523368687658 0.34758920512701424;-0.4259249765624622 -0.4645674087045617 0.77491698026760836 0.30264453219922244 -3.6264679045856836 -0.55575113137343446;0.49074453694532122 0.58456013087194614 -1.1570031284429441 -1.0359693568821022 1.9182517217585402 -2.262720698130146;-1.65199682347249 -0.13943851777115812 0.018348925303692476 -1.3468887540007235 0.70285910685333441 2.1765966339816254;-2.4073677379456044 1.1075281301014541 -1.4915160302618375 0.4704056489507043 -0.22815464152256137 0.73365766040374125;1.0477541979212626 0.64276576294630416 -1.0379554874723287 0.17857951162150978 1.3054811021483386 -0.31428627993690894;-2.3440650395729232 0.66861765384255789 -1.5120907686651219 0.55386490542648248 -1.6397186958510312 0.75336451841941654;0.82514184357809717 1.3972178876465033 0.49244033488559857 -0.39037364618872794 -0.40129343484415803 -0.3026119897199574;-0.4521580979688356 -0.68409069407923673 2.0178041747979614 0.37325886880452852 -1.845277265435286 -0.67021161023147047;0.70653646088525301 0.74218693371474109 -0.42585819783445544 -0.8818602460202587 1.613861618722098 2.6410875964294571;-1.1055266895250238 0.93821002504542117 -1.4168283317990442 0.37593386559290481 1.8395904772437992 -1.7232389190345425;0.73615737835696271 -0.12447664856522624 -0.39328956030687068 -1.965812108971243 0.8438871671280046 -0.43951859058693787;0.2840386500612011 1.307066601965603 0.74248536720773761 0.099986785125247682 1.0099150506178793 -0.83843477477668094];

% Layer 2
b2 = [-0.85139180542036219;-0.54199686062575725;-1.0353565314042243;-0.94356489040528857;-0.93944232898906599;-0.21890285870888182;0.090901770474175164;0.11428204742337629;0.26143377677212581;-0.39431553573154859;0.3051323600085159;1.3091953048120895;-0.92121687592114276;1.9449119183898897;1.5500181372167239];
LW2_1 = [-0.21714546517764666 -0.88751317953003384 -0.12986935019581852 0.61302029906631739 0.43316364175154692 -1.1219929318060762 0.30150810948199569 0.30999406180446049 -0.59934178535288196 0.81521419072823997 -0.43840528412961544 1.1391890860944442 -0.53393190830032256 0.075253722279183394 0.31982262328489741 0.03697261285073597 0.40930813118534631 0.61318537693347719 -0.30906776539495567 -0.096352076740473427 0.60028827730053769 -0.22747762624963677 -0.24117022743631555 0.81972180415190443 0.42721329511775319;0.64903493333052298 0.31883196867634883 0.15852455242359381 0.72269489379227825 -0.1045624820049945 -0.10419321953159646 1.3345154795301275 -1.9527829090491471 0.07405412279249958 0.61882145842337155 0.63026343029980425 -1.1594960801254957 0.84056583011315333 1.3446361283196846 -0.23924160693787455 -0.09785131948620894 -0.40331287990275266 0.29223623291879514 1.0798911184478546 1.5134073274280457 -0.59680617138599734 -0.33672718120554124 -0.63288564931930902 1.0956126261687451 0.36257909252783793;0.24647120151361579 0.36436626565149277 -0.017740905048936464 -1.0838346031073041 -1.9951389328124225 -0.87676412046571683 -0.16435177967658951 0.24957325834114885 0.57503891204440039 0.34936741747734867 0.67929725525779783 -0.053096275032709708 -0.084751515609480813 -0.87261892242077321 -0.16890638587327622 -0.055364310048978495 0.10081667974359193 0.11709031427303761 -0.92493612774735112 0.20911785330582544 0.016556984341923594 -0.057443060175055259 -1.7847025258509086 0.54930609837207611 -0.67098896450357259;0.078791097391434722 0.4941644983038907 0.18692818824146587 1.1215048930306268 1.0237286428662435 0.73844514930380267 0.17972785524930537 -0.19289619652168657 -0.29843751354818898 -0.032177902368035777 -0.18940816005735187 0.19606898986408139 -0.34114668318890368 0.34328569948628262 -0.30590577464518859 -0.13104709391404973 0.086191062803240265 -0.1194955480178225 -1.4990400033426317 -0.53709937822572273 0.31211280631315041 -0.17953743517955822 1.5804475691737065 0.35244866011100062 0.65513353432972665;0.010460693575569965 0.35374136142528234 0.9428355621694321 0.078127312895411055 1.0341259558879672 -0.46465977826395921 0.67601548974034043 0.019371066208861146 -0.17524282248922163 0.36578223699439094 0.53202458892794224 0.95690966491425888 0.47084136169018415 0.59899211712854694 -0.70599515720917716 0.30670184043783488 0.32140773319746974 -0.14047182561753085 0.65455492388588588 -0.12973975121912629 0.79843032169312189 0.4642916033326438 0.3809475696583447 0.13502988660349502 -0.81557495986077755;0.010453275828443985 -0.64716110157400486 -0.96242665064302435 1.4949326307075577 0.60510539054346568 0.37161558277097118 1.7231727795317868 -1.216036447546289 -0.11727981445146461 -1.3179439146892968 0.023427579073358205 -2.1492749550741999 0.29824217078873083 0.24013887434911138 1.2665979790515556 -0.20556981787281933 0.71013180633510975 -0.16940028015647302 -0.87563945159905487 0.62815797501555604 -0.8267768456839466 -1.4117743250797605 -0.13473032918947903 0.66973703151873232 -0.31245905564685056;0.6164947981726896 -2.6803627713801381 -0.42742581533927282 -1.3726863571878343 -0.76901618005510597 -0.8336691376007116 -1.0166116820421196 1.2336145089155131 0.11456752563532932 0.035155224787570501 -0.10903996311106913 -1.7951850220423682 -0.26211581697417358 0.18021926570404642 0.30271883601501981 0.79661802747642796 -0.38538289107911677 0.6707525191979502 0.39312910939663182 -0.7004852321309708 0.18267466392917006 0.46314981042985759 0.65909380751754443 0.55193446287430692 0.016671992781187989;0.12459624445532695 -0.15618099914575409 -1.2179375150029499 -0.51556559749378028 0.69506711621770234 1.3231158028878094 1.550934679173017 -0.3743037498753245 -0.2012895800483801 0.91262828102474436 0.77485667703295258 0.47238685211565701 -0.24610220926250895 0.37569935992423098 -1.743479970938276 0.25675957174158975 -0.029188123206761195 -0.015297388998823576 -1.060466950241177 0.61078514406751172 -0.6323499445148637 1.321622076951777 -0.70076735358400621 0.017232915260363947 -0.19623890255987539;0.96612039771509695 0.53810081692211942 -0.13517175990804303 0.73659416424902979 -0.74109604161277831 -0.92981895193363562 -0.37252502805256393 -0.10753950081246591 -0.26002539982164535 0.54474101151972032 0.20554353500821368 0.38641223783018913 -1.2093102410637289 -2.0275084822603247 -1.1491391288817332 -0.54574389562602188 0.28763839785477452 -0.79853457033311182 0.0059422516301702614 -0.43801253881465946 0.84477904488474698 -0.0033301186258269961 -1.1289596549720584 0.17146447537798673 0.27232090825566185;-0.07887054489154241 0.1640553771565979 0.36194806515382333 -0.85395131684421255 0.50853906862293086 0.37865409905565228 -0.39501094949727872 0.33260955573469514 -0.47620650479098886 -1.0814020426700273 -0.38117920055702054 0.044591914199999368 0.053778978529011923 -0.62201918982370563 -0.15515232284012515 -0.3559228922150765 0.61281294076858428 0.67285807652704033 -0.26554537757515073 -0.19228921529549095 0.32180324840298624 -0.04877562217311323 0.66038395327566268 -0.44847960566627398 0.60913325722859513;0.019214520608377351 0.16756570482135436 -0.023074694312843372 -0.17077972339022496 -0.83042104394696459 -0.018016251059977818 -0.83125287166840467 1.5174736424371609 -0.57285540394230705 -1.0611477185911868 0.13571395944897927 1.2053129016254949 -1.1693514672138461 -1.7424553286804334 0.16686228327319855 0.079061792816346912 0.13079538157394832 -0.043009615696447429 -0.87426666204989012 -1.6276533647608749 0.96609916812645458 -0.23878933349202672 0.043797256978266953 -0.26895915696666617 0.27993944117501035;-0.25489840710482015 0.061769567972043658 -0.31676051150708351 0.70570043334966603 -0.96687269614138838 -0.93588572233067935 0.5819836043268215 -0.51689240277127879 0.37060439367926457 0.83845825124851348 0.058620592036188975 0.19846159044587941 -0.51868591935648767 -0.27888880919947034 -0.5124047715388772 0.28654383068318184 -1.2964687762132405 -0.59537005345672245 -0.87736582409913733 0.46276032046442517 0.43415773985282874 -0.84230999724033329 -0.48136169384253291 0.68928868526679088 -0.71379308654079077;0.87312101762518757 -1.0146075492898037 0.035722983822000925 0.016913303332598547 -0.23783293814293249 0.4026205591671837 0.43009787643114888 -1.5029985278462672 0.092850818231968613 -0.4029262042370696 -0.51750673575649175 -0.58737869450420188 0.61719309219582064 0.56504798115116728 0.23722224963642471 -0.00074242443912391561 0.36126832191670494 0.72792703626825195 -0.03815971728864636 0.64760212439101361 0.14497352532376021 0.70831934500088833 -0.3503608055771425 -0.31500517560503866 0.50818347065211389;0.47734642514703934 -0.63811977522882934 0.42827036011315717 -0.26434399877679537 0.72353656442357783 0.19964860653060346 -0.46687626850875691 -0.17344588829537744 -0.45761686686249975 0.17211391874288151 -0.89700873745848109 1.7284704819305476 -0.4204213966162445 -1.0876555445911698 -0.071571253501542947 -0.26562278471465384 0.5508432998029138 -0.63643144017992281 0.11849271673298425 -0.91108903366938254 -1.5941665019177156 0.39108476849200458 -0.39233186375102813 0.34364451949094788 -0.27939034128776202;-1.3832992016593315 0.43202705246308215 -0.28123116586173225 0.11118983727863989 1.043228634336814 -0.13841217481987356 -0.42130639833770311 1.6603059753526686 0.1381894932319899 0.40800754109924037 -1.1577929525260207 1.5629651358298309 -0.72921261470896548 -0.28553898008150513 -0.67306114944862661 -0.13169967244232689 -0.55677914990030508 -0.74632798959515456 -0.15485500539559535 -0.6500271388316794 0.03053255932838609 -0.49392082728815268 0.81982533688090398 -0.28219942216172028 -0.55385151984384651];

% Layer 3
b3 = -0.45471984132076421;
LW3_2 = [0.30112436044904461 0.69108828246500653 0.76824283569927299 0.7212826438084301 0.19693551265372514 0.18283700247666898 -0.053250203006932388 0.0039140806427374998 -0.27219436377944517 -0.41288183143900886 0.70800509857867444 -0.43848484919155795 0.53756773411271563 1.2465217238054433 0.50748047175545918];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
