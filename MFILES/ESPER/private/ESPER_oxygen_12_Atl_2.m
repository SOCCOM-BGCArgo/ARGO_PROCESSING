function [Y,Xf,Af] = ESPER_oxygen_12_Atl_2(X,~,~)
%ESPER_OXYGEN_12_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:48.
% 
% [Y] = ESPER_oxygen_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8628149114317045232;-8.623117437671833585;-4.514898303651065703;1.4743109335653556968;-0.30925102436205098577;2.5681950915807072455;2.9001098047693667503;-0.33819845266018300212;-0.92716584103150201379;2.694810557496201131;-6.6893870788860381182;3.2152490909862718738;-1.9451216318858755017;-7.3176301486789752104;-0.17239126685647701565;0.91185681948240382422;0.081449031346182199087;-4.8124895877129292288;7.6381280043171404515;-3.3377718879135325203];
IW1_1 = [-0.32078204522709063973 0.58931813495386731194 0.2087155806037415684 0.078230224035879605826 0.26917951901670994497 -2.9701764365082885533;2.497035167414538126 -0.71642151837210621412 1.8197490728521248382 -2.3843790100828070599 -0.73236173148255490073 -4.5978427480555534856;0.64475843076470740201 1.9153551492871208062 0.74789564438978939354 0.036150047713287107587 8.0379507351326999753 0.26874795283930474898;4.5275060363914825246 -3.4634241408868513545 2.2887202088915894471 -2.319169900735979617 -7.821134228297225377 2.6073527212052955981;-0.35582863819535071048 -0.31061580287415341273 -0.22302171426872574589 -0.19443209709625461357 -0.12957512470668636206 -0.13251338533600789948;0.63319960124319563111 0.24674751230459476825 2.32113189455816471 -0.62979884097049709801 -3.0599182921593652829 0.47147735064724966003;-0.31913121349799533633 0.47194941796838724146 -0.43190744027206662281 0.26729789304471895939 0.20332120599139566486 2.0858011890794188048;0.40357127847671442344 0.40477096471331203142 0.10170452521793718614 0.45918213474643082561 0.40243261931423163213 0.0073945923606047563037;-0.7581367404753790451 -1.7454375443984677663 0.47255970309223388481 -2.6764263951372737615 0.35686399679648661554 0.29325775487931393659;-0.23174181605473972989 0.13300947720035821709 -1.7304164117789913035 -0.25381839312935550179 0.64321111334772895773 1.6530720536293346257;0.13802216448579660013 -0.0035699704512714069624 0.59723826805587165722 -2.3669463561984565025 5.8648528975537157493 -1.3970492288186937557;1.2796774183554202597 -4.6705656362705454399 -3.3818351987277646131 -0.13780969915254084879 2.6782825773530474223 7.6461699612740972043;0.047152353618250444911 0.1811271684430881268 -0.15585726861223683781 0.45695587721260100267 2.6660457682701963478 -0.22508047090415264635;0.26132975061542607076 -0.0075136155245184733237 -0.13111219272713850459 -0.42952672494762794697 5.6472989380893174882 -2.2100175832271879983;0.94842674886627653663 0.64428861831311123876 0.27657515457624143318 0.62375236885808349463 -0.31782363927908696688 0.16892524341858819459;-1.0294150536684463226 0.13830044821190007331 -0.48856418804162893288 -1.2113620115945142874 6.606016087954929894 5.4064730748692424456;-1.0314750095704463551 -0.48693615562203140801 -2.0809755779252676611 0.19885941097152279311 -0.44290045711191644573 -0.098574911613323393245;-1.9968576132565218906 4.6921444902556368461 0.73219985317402325187 13.929001887200938015 6.0964810759481800062 -18.791655657593011597;-0.20324282681612748647 -0.99529806138203102961 -1.0027759593586935694 -0.047504114843295454362 -2.429861479871382457 5.6235715955635781071;0.15838087893243180115 0.13307097236508988458 0.0021429814734126423868 0.37434367082178815478 4.6762744561225675355 0.0073213424323138103986];

% Layer 2
b2 = [-7.5439739340773170895;-18.336582768431114232;8.5005647160607349377;-34.420840387983830055;-65.214431438377843619;-16.770632387327950141;30.149518620077053299;4.6745466567102376132;-3.1465095710762982506;-20.18278880613029358;45.775862884493946581;3.7576662915462066827;7.3595295243319256429;3.2841060101676946559;-44.608309549047362452;3.988094698131604332;1.5730069630089709154;-23.931093837902384536;-15.078004756425428923;-24.998934394628573585];
LW2_1 = [25.033928875608232545 45.574370597270068117 -20.277635885686354555 -35.133730641551544238 40.749374626297388602 -17.183498742707556062 13.739404305109387039 52.540509724607495912 29.282705400216006097 -0.45790919997509493822 -45.718495563950334315 0.10447333442869652376 -92.379069092767835514 -29.456942699026228638 -96.222920127431251558 12.473825846316250576 -43.267074520163305351 70.983571527100991716 36.134913917997209865 64.127146909921123097;2.7810196374783422435 2.8127914499292487882 -1.1100787255787019081 -2.3228178403562642629 -6.3967278508027014539 -2.4335409469936228888 -0.40490383643764626953 -10.838504153980840883 1.649829264635186421 -2.9864885536035004066 -0.31839890031600448506 -1.1474012762620948713 6.1848742630153310529 5.1414909309583336494 5.155742820165023943 -0.87029440551887393696 0.36571784006832364078 -24.928960718708633948 -10.125089839775547773 0.60977878723472500599;4.0079649510645518617 5.0472712555305099258 -14.959302992545795874 -33.394273277658378163 -9.9666374593562245821 8.5379463533867507863 27.531254963725420026 -16.732658011821541777 -5.3535839621609557781 7.4185351430645045667 -35.978613495297288694 -44.616691093010949487 -53.063349215420906546 17.056230392301809928 -40.861804764244496369 -13.050662387006106258 14.73150835052345009 -25.169976803975444568 -18.782741889457316375 30.641792585346625089;-43.743779048958039368 18.856741687218733006 11.424833529391115405 -16.823337380812116493 5.6844878820152890952 -29.090912224573933997 19.735029408769324988 -74.481066921105011147 -29.219264954936662093 18.252438377361254851 -8.8931816945449462253 27.692230502165376294 37.278629079262557866 -4.5229340067162828731 -52.016078661375104275 7.1782455136878553503 -44.136449448685688424 12.45767656210381169 -50.713295729456390859 0.48659257264713873248;-23.509124754061019758 -12.205764845989165224 13.023020445739557971 1.3649146055632541685 -5.8232552073274712612 9.0116590342516733614 -4.1115584596634713321 6.8361378230061822237 9.3779327845231765792 19.742693898826633614 -2.5467503315341164516 8.224103115650526874 16.278097402766697144 13.227558197492276904 -20.862806582421928425 -2.5500890601289811777 8.6978997351488587242 -57.695937127914426412 -62.515730297431986173 -31.87111398605119561;-29.781962147768069826 -14.214455099176028341 9.4764052933851452565 -3.5196139662656529268 -18.270370239626945619 23.90787889709268299 -34.063063609838920343 -39.73436060167768602 -24.944785748371899103 10.402151895068524112 -6.0441333226212892171 7.5428080384775801903 3.0271598993013033585 6.5158516696086818953 -10.595188091226800609 -0.57915161759753286397 23.076977865820015978 2.379297498608242023 -23.607897293734350086 -5.0041179285055186199;33.95569860895688663 13.82156537809889052 -10.357188788969867943 -6.9045547251328205363 18.67891287517944221 10.669051675950267821 -31.710218405417307963 44.325919487730104152 9.9765852930018734668 28.055915900563185517 -18.061906328293858337 -9.6428751990707404218 8.0973278244892004096 -19.300951419714010626 12.450040875826703157 3.3574527196705772347 -1.1150523608634252959 -2.4330278738476538436 -10.060304479675096445 -3.4595307071567149571;9.6735214763781200986 1.3106469863453229507 -1.0511703344505678448 -0.6418280523046232533 -1.4848043438513562897 -2.2772611988276096895 -1.6565205001855223266 -15.981974728913121098 0.37181209606147375135 5.3331086374912795023 -2.5043112558715301397 -0.73585107099048285839 2.4146717573441609517 -6.5410681744552157113 7.1647434409451413728 -1.6266686197215598497 -5.3764073920456700861 -0.10328682940818301184 -0.089229309765823508482 7.9249262861774987243;-40.354721051713404734 -11.594518073530897695 8.504558242026188708 36.74614261993701092 -42.162472039316895689 27.412149554943372465 -25.409854086412121177 -4.9663687878857896152 17.247227688819616986 4.5524899726858221172 31.128458659842923595 -6.5470448754166321592 6.833422837749442813 48.635907702385161144 81.200122850886174319 -12.40913716984131554 58.906714010521170621 -14.06501776792196523 7.9283644584634016539 -23.668201853398805667;-21.01987002672086291 2.2866963829028739141 -9.7616571219108365653 -1.023838677142108633 -3.0694786496825789968 -4.6008897648157347504 7.2177660527412568214 0.95286189975617052728 -3.2886300997253039569 1.2113863934835553682 6.8635292839697221723 -17.460033416097175518 26.147462739143055188 16.397785318590031522 17.170882386177105161 13.557536496466159548 -11.521943453969337057 1.4529348355905069567 13.287469321564255864 -55.542608613975964715;30.875906690960267298 1.6838918783865797213 -3.1060156449382230193 8.4725507274013338588 27.258066908010881946 -21.184461138525438884 16.521843466039374704 17.195294180084545133 -4.2021562491275412654 -5.4946611320299014736 0.85948783679007700886 -0.92200674994238329685 -15.702911305320286672 6.1490320518360981339 -7.5683910091078558935 -4.3794650576092646332 -13.432612633240077926 0.32994420722235412446 -7.8949830364979547426 6.8770813267294341742;-1.4314462982872524499 0.82410091816379016372 -0.18097137743057012393 0.32533039482540948573 6.142634521123855329 -7.0186532242917154534 15.272849262636318812 6.1791957083319362098 1.5857433882900033861 -4.2487343667930179691 1.4542525953534415351 1.3995718335290867618 -2.4631206612775051745 8.5706068381466984363 0.71737778324991963164 -2.9621534413424308596 -6.9886682877229340249 0.013340514785497704572 -0.0024056936888719386396 -9.1530517027098952099;10.902034079567927805 1.199524354951117644 -2.0578620027879095389 0.034927299809835915534 -22.982044520347617578 0.78896588741938011857 -3.4545091212339209541 -30.03165741591901039 -1.5792989200554128359 -0.24722583458549632351 -1.1124400590208594064 -0.088299367870912789935 20.340595191890706417 4.2827261580418038989 9.0999937418410148382 -0.0020967970268246393685 1.9563654696119414655 0.054518272968190277517 4.3061734549967258801 -13.362552000532659235;-2.7852817384613879348 9.1718750188487998543 -4.1535996357736930662 34.769653135182593928 4.7891805824436524119 -29.750755275354585194 29.145653425300441342 9.7658901284405406074 2.8971305393769504199 14.237203473530561482 -1.7671731879934700071 13.671478213532328283 13.641789364385441985 9.4226708338207902926 8.9502243027450187896 -7.0080501699681230221 -6.7890939714162579222 -10.29335576771513594 0.8680526926416574085 25.223951525677914987;-27.396799590128772195 -7.7031294721595120478 8.1709769957505962168 -0.0011368129399273556313 16.152802846201598896 6.7286829914227901384 -43.913742882955354219 30.62755437722671914 -1.4966056085458043778 6.2624991617834169233 -4.2638785620565018419 -0.76156018754355636613 -12.144259979706557573 -51.41018438862209905 -3.6416217194868636398 9.4463617409725824103 11.548133821625276241 -0.80986621518235579753 -12.56427396748675207 -12.961673570383860365;-18.860456063608648236 7.1108012627482954926 -14.049101506287879459 25.162631303538759653 46.860568122386801804 -33.303742891692195371 11.131278774835575263 -55.156340657630934743 -5.1565454112876265569 -18.305716669659126694 12.029943235355922582 -19.153155233583856187 10.203361456626257819 12.765548058451139823 -11.408685406674559104 37.476625005903770216 -10.405159725579999019 -25.790038769152470621 -91.964827057765020868 9.6282554747507731463;9.4832639010463370965 6.2590333784096534586 -9.066925028854003088 -11.840413012476847854 18.656219712616145756 -13.858418289929353762 -3.4501737759082184986 64.757052602958708576 8.5725077418968833598 -20.721550244725115419 -34.405774148571694582 -3.7447353846903586039 -49.432700002475201018 -71.697103732010290855 -31.449804458476627644 29.044326358718173253 16.864165655212570272 13.530530646722962018 -69.616442162462988108 28.12188655674536264;7.9241728648669669255 28.478623065105381329 -0.99679043319951010638 6.3150433821769738074 -20.35084239620622526 3.6847199496716620537 19.857601454075563652 23.930369254855531125 -2.3122261504151202516 12.453916118249603429 9.5774355542932063656 4.9868187060654731724 -1.8242155331590683698 -5.4757174617442307962 6.5483063322409140739 -20.009584352044129218 0.53530189284273288486 -9.0389861657170911258 3.5163229258294519397 37.882704780683731371;15.130526732499513187 -15.612224122906196655 -56.616178291611291229 -17.404020648093727175 -17.390521828661153592 30.369197719590758311 -21.534738605688094282 58.54659186690162187 9.0737525994773644555 54.440097796925599027 26.39769494094790403 -18.80292962849981464 28.276740120540946322 -36.572263878474991827 -30.979083273473410287 -42.871163275075559795 11.512463895277473824 -4.671934659469770601 -23.758456245986057098 13.041866886480555365;-5.5291896471259196488 0.85331186359903543615 -0.72189653808849907346 -0.13128117420279594718 -32.618521550530360287 -2.7739035179350191029 1.9236952452916837863 -61.233942568311839239 -0.5170792694347600138 10.721297764310403267 1.2373284350545734611 -0.0516401776963698253 22.950117420427027071 -8.3295450814705276343 17.840314363438594114 -3.6466540973195225028 -1.9651360321308415369 -0.26132732775306383166 -4.0391831689242820858 -0.55943283526013942719];

% Layer 3
b3 = -0.48930235184864484532;
LW3_2 = [0.0071625205882681714994 -0.12574233443592089388 0.0084676096125489864336 -0.024410297588413957387 -0.054885013150123819481 -0.014764400519974206494 0.016487814896698975431 0.16577589878797988066 -0.016528027912966411495 0.027076323323357180672 0.022250381570586071078 0.1097431053624603331 0.13775049948342915629 -0.0061172334881921140368 0.025679813971403973871 0.012646170223372393479 0.01238730749683699707 0.029733218669679782609 0.0095471077469898822654 -0.18161308890379643244];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
