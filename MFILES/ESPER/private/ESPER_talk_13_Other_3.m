function [Y,Xf,Af] = ESPER_talk_13_Other_3(X,~,~)
%ESPER_TALK_13_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_13_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.3815149951420862;0.64071084021190738;1.1499497967423431;3.2695466655274346;1.4313887739949538;1.0916304965162649;-1.8369911936431087;-0.085667381048385199;0.79780283924572992;-0.80467742181768842;1.2503018584433514;1.6585539494555337;-0.53300565264623345;0.1456072956994503;-0.3388947860479517;1.5559928835203818;-0.13114687412406045;-3.6364038093728714;0.089737136013208277;-2.7981086851753743;-0.72372332286247321;-4.172078352676114;-4.6886289708485984;-1.5312384915616091;2.9410224489114407];
IW1_1 = [1.1752646881432831 -0.1619083050255479 1.1924368316182776 1.5600892081133868 2.6996630110483912 4.1221444508132246 -0.46402289480348896;0.41713746515356986 -0.18947829070487093 -0.84077733199697813 -1.2308682001625362 3.2521050954290884 -1.0684657485942728 0.043545522108637713;-0.089474864205252455 0.19676185479630565 -0.058095827121311484 1.2867300260958843 0.21209903580945705 0.25749349265293642 -1.9537928240429983;-0.39688548829244641 -0.15550791551567766 3.8530641719260794 0.35361745175826509 0.32353554761691555 -0.42627335331757571 0.12541941720088867;-0.10357526175746758 0.021498638632003863 1.6806965923735617 0.46308429269681745 -0.17749806280091049 -0.20810207523999494 0.86173020932498456;0.30798130580731614 -0.056737406524985108 -0.49914664785198642 -1.0712901042980003 -1.234762206447374 -0.68617711250483082 0.86293934160003405;-0.67219020172808419 -0.1010219976185332 0.22992575933224804 -1.2727386788580066 2.0714231079307361 0.65429795356794307 -2.0250368833682577;0.02449225275517216 -0.1079030705370639 0.72163405036042649 -0.56180708493585052 0.19553198436142041 0.25561965873132908 0.50178197402796965;0.30934769227235992 -0.13183927219630376 -0.72958463720329458 -0.88610951527748594 1.1574860073041426 -0.77195229318842384 -0.15731864126779302;0.96116431730830965 0.15474097089459726 -0.6532347283721317 -0.35762862508319732 -0.22893696526192242 -0.23770693240588964 0.41541672687478298;0.57361888489500779 -0.28022226612374651 -1.3145287123279701 -1.4994284666308131 0.90066206261848447 -0.63365763420651666 -0.95450106043694916;0.73719966312243168 -0.58783078311692794 -1.9485345503483538 0.25129571654819544 -1.9657574897536871 -1.0249974775950592 -0.19048841792726598;0.11591678457736271 0.079121573421895949 -0.28713589143642876 -0.17562246703170079 -0.62506617324411318 -0.15227632441391178 -0.71454803076755646;-0.62575299387179562 -0.53056770390156105 -1.3993588983738956 0.64163800807727878 -0.39964468514398566 0.20507607622786506 -0.53919212689412477;0.31975365440928688 0.23934496992132417 -1.0434467462507999 0.32676357201846817 -0.18775227875573677 0.51108955578667481 0.11094267026572832;0.31764684573336449 0.7336685992529054 -0.99322962327603503 2.0618373614597507 0.65440526562184465 -0.4989989248733146 -0.99206223753069955;0.71062195471053891 0.61482245828416049 1.5466311537336102 -0.71955127042525802 0.53376581791150135 -0.20173042885981701 0.74415048946282769;-3.6823868765509071 3.3345847300806293 -3.2869852042297865 -0.061637103710489208 -0.62923872286899984 -2.4303522861131279 2.0988955529149309;0.086277931529782761 0.039904963698731456 0.19820713886083799 -0.3159728685068075 -0.68093780058440734 0.037196037971792564 -0.034449408074178338;-0.48330638335408216 -0.30312322381814277 0.24699792787083433 -1.8213446711334076 0.85412686083407174 0.39173665168942978 1.1540748456399266;0.09451846204407198 -0.016248691307475686 -0.87325402937243601 0.08015294212499062 -0.19537758364023686 0.39030584348649133 -0.092246518567907734;-1.5332591980506234 -0.17581928721296186 -1.6951080126166431 -1.4177069655219166 -2.2541765547640691 3.0867647897383748 -0.72349269742037292;-1.885767394175597 -2.468099416145904 1.5558350677241886 -1.0674877865212342 0.83281982153312162 0.5158959806004535 -1.1672486628945955;-0.5065192741650788 -0.36588819997937927 0.64030987462676658 -1.7655484767532272 -1.638784578429241 0.26871390367890968 0.17376203147855421;-0.22396506225447665 0.77362661291800339 0.53644359719900214 1.7044621402718685 -0.97408683032830867 0.46926617685811528 0.26860137898670827];

% Layer 2
b2 = [0.55195758314654331;4.3846927551619466;1.7810717053050642;0.21944432959198848;-1.9409758837555946;9.7076001892638804;0.060554419852135777;-3.74878008710954;0.29712230103941717;-2.4318026220285991;0.48393656425712184;3.2612041601471602;-11.004523329614067;9.4699691804838491;-3.4639914338096398];
LW2_1 = [-0.34871687777508287 3.3693913199027405 1.1151259645617864 -1.0562940748669851 0.36531239709202057 0.53297654265411476 -0.32213583099328524 -0.17362147569878841 -3.837856826179542 0.80855730176251506 -0.51554407562925209 0.42573234329316184 -1.0310025161459828 -0.94178446096256119 -0.17428686387089962 -0.56515094045905778 -1.1662840345461243 0.079227041883837626 -0.83767021631192717 0.1190294810568677 -1.5479212749592219 0.48776620633743534 0.16917212712557922 -0.67421465072100517 -0.33303683106996051;-7.1890983695063948 12.691282832263333 -1.5142919299698998 1.5046879577077985 -2.7477274907146785 -5.0503155092204146 1.4570439614458122 -1.5556991565864462 -5.3780732288568132 4.6382565114100194 -2.6998053252157388 0.52855011813677832 -3.8426395000559093 -2.3772540392541215 1.4098187269866809 0.7496858282697435 -4.0366968120045801 -0.24449082460703847 -1.7134650415998902 0.19144258539397407 -11.442939435166359 0.49385160023435548 1.2504062909080678 -1.1359611586026273 1.7182191205100052;-6.317085350176824 5.0725430250930188 7.0714742449980843 -2.2765908769810141 5.4689917113094682 5.2399134622420878 0.506841484172743 -1.4838346915076057 -5.1940786231153 7.229413630686393 0.56413775214019168 -2.9991554318832989 -5.6427530036847928 11.60023897633439 -7.6651270996695784 -0.66054533427352902 -2.0602797523076068 -4.3912196022366796 14.34711122877399 -1.3264838722324173 -2.5383899249743034 1.4906587452951188 0.57001426277351142 -1.3609290225340149 -4.8081079041434762;-4.228787764902048 -0.22569460143594769 5.7288025060353744 -3.7730219577403985 -4.524842879196493 -0.7018760972890683 -3.0667713853260263 5.1619132533066843 -1.3931933585733132 -2.4667158319116158 3.6456808475014437 4.0878083194806818 -0.12320968022846417 -2.2900298870076021 3.5383216814576031 -1.9172776152399762 0.88952435354803649 0.044735086500310627 -7.6636266991195443 3.3153843244580874 -11.652246894019292 0.39616344199192105 -1.2076374215388044 0.22773309348730564 0.8921119583838425;3.6021644916004409 2.8296511595016063 0.058948763506603954 -2.2428077546645309 2.6750743198444531 1.1533610416497639 0.53931987121948155 3.3896272221274319 -6.5386834859691367 -0.91784232510736674 1.3579475875097418 1.55917650461293 3.420102620975181 0.95599247616481708 2.0118271401423478 0.89827905939555508 1.673036838676619 0.0060642318726168952 -5.5705587779811223 0.0019432584124148486 -0.043401214144389584 -0.45311192900912856 -1.7722785832199985 2.6606514525576532 -0.51138797856595053;9.3360089819747074 11.740582600256252 6.7595154339853458 -6.6193697655073898 0.27564893548858027 -15.006836774740954 -5.7484062371804026 1.1865630956516173 -1.8656589178403065 10.351596830535824 2.3513004883826971 -2.4108313892349491 0.88878030258928109 1.3630951013089911 -7.4779716802807314 -3.9183359584109767 4.9928869599479846 0.7037603738770235 -8.2991686488261163 9.1830322947424659 -0.90488895848320849 -1.8599387299760801 5.2970037753529438 -5.1302034263918337 -3.2421922149052986;-1.6077179027601514 5.4554997693729028 4.819097405488991 -7.5958187470486163 12.449694287083112 -0.44936981517381375 -2.9323720203112509 16.663820648162442 -1.797165124436459 0.96746649220690273 -2.6955194527975896 -2.195628276886306 3.2047447084036462 9.1772269571560887 4.1318611931404998 5.292963508209211 1.3047558116999114 -0.51758418967142616 3.2731977443413975 -1.4898403750119587 -2.8380419705070636 -1.5356102194625054 -1.1904992329585335 3.1903553130829314 -8.6548558316477795;-0.56980394554692371 3.2016128510258679 -0.23925033694911793 -2.2412921836052222 -1.0846933713131848 1.7076540762965178 0.3569210790710749 -2.3373338710237404 -11.611154498151027 -2.2999202036608151 5.5869891604500781 -0.36752349831025677 -4.8539478009736943 -0.85846322282617438 1.4970378253257575 0.53659385679693039 0.06235116209964528 -0.21795049761273302 5.8018856569576789 -0.60863257780647706 -1.3508148540532479 -1.0110273442786557 -1.9049126099900306 1.3954086618811683 1.4524432744708997;1.3418970663923739 -1.5223397451334713 4.7899502080122653 0.61661409448511006 -4.568128014636283 -2.1233905781279252 -3.5585368264123356 6.7285141602041802 0.64897355791381439 -4.2226358992673401 2.8687488882665422 0.91278745042927967 2.8508247688460262 -3.4785354895640883 2.3511591432211167 -1.851241936206379 -0.399588016612208 0.39101960401976982 -6.86237635599272 0.71596356839263819 -0.043800724162879723 0.2057625040877647 0.88982503125819767 1.0901881413567043 -2.3326501545136007;3.1078200595135672 -2.5576540175893294 -1.083863310264533 1.4570573973391088 -2.0454459899292496 -0.80411440148165725 0.15373500951150337 2.7169858794390125 1.9995225448053182 -1.8127316491198255 1.8442067917871381 -0.65050755055356035 2.2838054971735455 0.10589331021196886 0.2080263723745662 0.95894355667854336 1.0249131296276879 -0.038694648359012047 -1.8084636133472674 -0.054707796846677148 2.8057684778213043 -0.97154242616277486 -1.0178485935267803 1.3919576237463491 -0.90874541971936051;-0.12938361240573071 0.90033188602027081 -0.91698054696386699 0.58140923855686311 -1.7971534177569528 0.6167903477196558 -0.31913373026056202 2.2992714508539094 -1.8167136091416494 -0.97747912934945924 0.38071281573241467 -0.48721071202014643 3.3944368766996336 -2.0332348801723419 2.0946540108313045 0.081547034189269813 -1.438473278361516 -0.12908944904895503 -5.6387403810351415 -0.84314656563566948 -3.100386149486039 0.11446508118438009 0.26659836406015092 0.40893071484159549 1.0867998690805216;-3.1775840935381052 -1.2279079536804776 3.7190559379655168 -0.90747993591616283 -0.87370287619382592 -1.0284830398064309 -3.4787412171899899 5.0947177240275439 3.6204842178875398 -3.1715462223444728 0.43203543868419941 -0.6168926308560192 2.9568641555074051 -1.0217170115178851 3.5565411418131059 -1.1940738492835934 -0.52689449309831371 0.17928787570650201 -6.449802406553748 -0.17107390301356221 -3.9074288879138641 1.1132924336386865 1.0516224146579136 1.7771325758489591 -2.4079125422334879;1.4632731595545878 -1.4283548959489405 3.1328367652405698 -0.5094327044337843 -4.9356354811924881 -8.889036526017092 -1.6252326518174383 5.1234410807529951 7.8817865175643895 -0.93632925433644643 3.0391831855982465 0.63260282759634889 -1.7421242809152304 4.4940287207473331 4.9957288369835338 -1.5619250150816306 4.2380092321999783 0.031303474445660881 0.201901542153024 -4.2675453554436995 -11.970308903434095 1.0648380526300589 -0.30404959472766235 -0.034182080638706591 -1.1331222629909117;-9.4622596943210073 0.4764848852811634 1.9002469645348055 -0.11065780927752805 1.8571942092039695 1.7787695580789553 0.74362409763112391 -1.4483778649079107 -6.6572237197630448 2.4678952391848825 3.0457828311397259 0.69391902344944978 -5.0662808656072214 3.033702066834127 -3.5089675181538253 -0.75160464322504195 1.8495992099484106 0.20762414379791547 4.7288751296783245 1.2127138491435967 3.6018886142365076 0.25054879914236133 2.0691860547399368 -3.648353224065116 0.8550944047415231;13.728458073126365 -2.4942566718603523 -8.6833287519571627 8.3053728193818994 -8.4647805597886947 -16.252960362656516 -2.1858735705282735 -19.9232914918076 12.270986493341395 -10.859586870997633 8.1783820209315952 -0.14642617239950723 -0.10096988914743556 -1.8801472043661911 19.51583640088208 3.9183847092770798 4.0617322573749162 0.046134059069135397 9.0932076708412506 3.3684210422619802 -9.3587767913041215 5.2197260347761398 1.0219049878477384 12.238804807620918 1.9573997767023747];

% Layer 3
b3 = -0.059533607690351133;
LW3_2 = [0.51545935568364076 0.070123961217011005 -0.0097548564740828469 -0.072296380800907611 0.17130429893959132 0.014473645593983986 0.040371837140095991 -0.056164847804058914 0.11551886361545063 0.23601911316547886 0.3910280875951086 -0.13693081028145998 -0.18785791596672791 0.1101524246575807 0.0076602444317377619];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
