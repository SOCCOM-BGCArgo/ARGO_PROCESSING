function [Y,Xf,Af] = ESPER_pH_12_Atl_1(X,~,~)
%ESPER_PH_12_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_12_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5836645966340805458;2.8648024751354137507;-3.1084312684748751643;2.6488766084271895274;-3.0725775131976633681;1.4987522677586506692;-0.4022491375787587975;-0.88064798416926293179;2.3052416496836554138;-2.0967495638066702135;-1.8715353845615769757;0.24189269161764961891;0.70776695520792698435;-0.12860823315593181149;1.0219310435814934479;-1.6344710510653166491;0.59737348305190240971;-1.626114172121872814;0.071402164004383983364;0.27411715024991761824;0.41218014260504715063;-0.3316746719852978198;0.53569844560637724928;0.38965095101012153789;-0.66741384239896917041;-0.52827002686169688417;-0.10099991757887605281;0.59966537181178736216;-3.356462304772826144;0.97354725673160524835;1.3190492682321253159;-2.2383156413602569579;-2.9142616939313392699;-2.252407496381446883;1.7811547258118476389;1.4437933468299104511;3.0968213670039075325;-2.1001910339866567412;1.9349622266535231319;-3.2062747460490879092];
IW1_1 = [-0.85363843870285616156 -1.6230960757605203959 1.0196563007300705195 0.13109331480376815171 1.5379924271197296104 -0.12396090191900788202;-1.1649689731227119704 -0.52101383746343787884 -1.7840464511386304736 0.12040183260515865959 -0.013188401024116690186 -0.77690484369172796431;0.47362865670747467117 0.92384435268910358729 -0.74019318579369874911 -1.5090126438351401106 -1.7421166110932890803 -1.814773050668222476;-0.68865284583275077068 1.7703687731915116466 3.1009811460956777651 1.0943566486492437573 -2.2840191583424092059 -0.53018178399684046109;0.80922515752323653793 0.25879675434059590255 1.2148044177774384167 0.61797581742929486026 1.8300883507100711434 -0.81717605151719308054;0.01086450921769060475 -0.53115469835838347024 1.4301701908147217424 -1.2500585077695700598 -0.90208973606243225696 -0.8568620110897952058;-0.62956604535460536365 0.98035698384228719959 0.15390354536686448594 -2.4205813090579360036 -0.63518452538626490878 -0.59869211744253847396;1.3605302583690579432 -1.2671753841037320942 0.7725864605466866708 2.5322348820859938989 1.9278851026325274365 -0.012736994353892951148;1.1132401688929509653 -0.0039147818320476070186 1.5155561475879946176 -0.08780477852175951059 -0.8874196444071741352 3.1319283732348583982;-0.0036705863853772864938 0.70491869018247221845 -2.4116762233204571686 0.89095516276642383602 0.81618899646300180351 -0.40109272454320460399;1.2429626003694265179 -0.33447347309579139596 1.1537386209414761673 0.096706287727940237753 -0.35299752302344772348 -0.11075501526540056096;1.0984715378742526681 0.18871690860373838139 -2.9093678507126607968 1.6143584603458724924 0.720876333772364708 -2.1785538154654799925;-0.57373309701550323503 -1.5240261713462615045 0.30047554599923714802 0.47080020556283036504 1.0395124095419918664 -1.7013113076129278145;0.10112968432067483138 -1.297304072236168615 -2.5132220969565772783 -0.7257909864372400488 -2.4764781278789511632 1.6350445457990694376;1.1139251322097558639 0.23478796454496653201 1.5346437433531774364 -0.93862181011750212001 1.1766769878821923268 2.0599835046625458723;-0.55696767514616285499 1.1735380841176772382 1.1729762453189853666 -3.3357796910194519313 0.47168638124773909492 -0.23017339491309707356;-1.3408790483152963624 -2.8471167143194677784 0.70563506353878113764 -0.89366028578131284643 -1.2740949474732339297 -0.14682934266768496445;0.63836125489498285468 0.41397122066750302594 1.7268204753008733476 -2.0774092692596561882 -0.27499362896439494275 -1.6226268627078632711;-0.025354114816461513493 -0.79087220520106149557 -1.6823054027652484255 -1.5711478401094713941 -0.39389863633935412457 -0.53441975057206103639;1.8371355442122299095 -0.14641177382202352764 0.16781056707887953561 0.38921027807223451678 -0.75443652604811239915 -0.86524679046700669893;-0.98949056730194928644 -0.045511370046589720573 -0.80877891171674176629 0.13859644980092092337 0.0017040261156885927983 0.88812483672445119431;-0.13452632928407853852 0.40258993274167126364 -1.524245152694559069 0.32025783033968840963 2.5681705088046777874 -1.2684910964201996375;0.089281350838953180138 -0.48666442297522854998 -0.16167348431076736248 -1.0055366538250642972 -4.469507538632552901 -1.6377427572744003292;2.4953742615674991967 0.55349819607077688222 -0.65674733356569559017 2.4196728933670672568 -0.20120209786126663776 -1.3468548838310794302;-1.4918042214914335464 -1.5450816962112647879 -0.21330970569063964493 -1.8818688120147168963 -2.2432115119986550944 0.47150431109665913443;-0.92154221989417306471 -1.8172412514689078034 0.20715549299098096059 -0.12800614217111802584 0.28835987977812854721 -0.81460602563105832807;-1.0216046878036544321 0.43613925924450397398 -0.90883855572304961257 -0.22308357154357730256 1.4515340196199677525 1.1024947204596402539;1.8404776335118560038 -1.2240619855113430425 -0.69217260999152518952 -0.14676970687485013656 -0.9506678749538155504 -0.52807893908882896916;-0.13093255913641665966 0.71124153359202346714 -0.32387083288562262817 0.079592154254415223291 3.0810086764773219059 -1.3827631756980669486;1.945718992410639947 0.76640013215856050977 0.86175031602491314331 -0.53114593170436530389 2.040372263606264891 0.69763395825420904117;1.2736900296593980375 1.1383627714964130728 0.49553992843280153524 1.4469696255571884436 0.77589882925271047576 -0.74910008528725580135;-1.9396671226968920099 0.8478923178299874186 2.9542675594645282366 -3.0693705211474888728 -2.1236798938796219716 -1.1476571084856930227;-0.55623602414165485008 0.98114920063263744154 -1.676320389993053217 0.49299024382474099237 -1.372790315552398166 -2.8973545721648208406;-0.46761679378153464537 -1.3204703242358051263 -1.0934404332306852936 0.33564819139545670756 -0.62306656053486764169 -2.5022915784919685933;1.2467972941831990674 -1.2975951327638532984 -0.59469579678194717243 1.5317850451387966526 1.0128641839506138389 -1.0976732038061587371;0.12373279983861434905 0.48446560256328380367 -0.03627102605310941752 1.5293177317008335159 1.8910715004358058522 1.9389284598723648401;1.4987427410842693032 -1.7675883445326732168 -0.24287583073961724334 2.1376468438195486144 0.11929375265259893613 2.5330847448833231361;-0.60274250759930547705 -0.51971504045962424456 0.31483087999090786369 -0.90630251519966420481 0.085370761217966689705 -1.1790627097473573848;0.39813988696745322704 -1.3352868575874519141 1.2368395773707456797 -0.99663020906298438462 -0.523277329991632012 -1.3333463236418576781;-1.6592836857749413415 -1.0054238490708422571 -0.21034705845757489806 0.27045801141456415895 -0.40358290059433132857 -1.4088571386828681042];

% Layer 2
b2 = -0.50436356498134771176;
LW2_1 = [-0.62160302488073571059 1.1602751925910690378 1.0654820837764602537 -0.23309167368168898227 -1.5588772941539188466 0.40678713278691663868 0.67939604134975184468 0.6041355942441429816 0.45256112500977191404 0.39787126653967547218 2.3963872768372684874 -0.59187405291912686955 -0.43001971424158008661 0.31787220069547300616 0.68582073653393227364 -0.42470875395999502233 0.29373617330548856819 -0.1782261335661544932 -0.20007297009752667005 -0.50145684967661741105 1.2341842643421383485 1.1442265272744953641 0.83118025590648236811 0.30419417456655817311 0.67044619850817532836 -0.62754610187719828129 -1.5161428662139231349 -0.18477202327543051918 1.7338179953450278958 -1.0010570978315582735 0.34611036647039766789 -0.41319145610719365536 -2.2002825648458457231 0.69621748776344449805 0.11534284130217192788 1.1956356902558942235 -0.52743187475871922132 1.1684757292193286293 0.64663377046262404679 -1.8096536452469234035];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
