function [Y,Xf,Af] = ESPER_pH_3_Other_2(X,~,~)
%ESPER_PH_3_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_3_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7296778152161245146;-1.5119306187893197801;-2.4684739780577280577;0.65714163611984099944;-0.43564286382849642942;0.89546038143693851286;1.2975970091337689638;1.4541751247806264935;-0.25994805361565392898;0.17752451621716000552;-0.55737023208332925339;0.79564025907908453306;-0.093897032762055770982;0.035410323373795987711;0.92195040001862882395;-0.97473144755477636458;1.5335752821200250295;-2.8961576943505074055;-0.89244688556467022256;-2.1995949368033795857];
IW1_1 = [0.40170535050715194814 0.069556239253606433337 -0.6334498221571019938 -0.46690774021440789587 0.70684593202005085999 1.4111863868208889272 0.12361548107195090285 -0.78817872938539401684;0.1853474386817891284 -0.35544680146785478936 -0.64230205570681175864 -0.43265044364841753755 2.2300947543207336743 0.40029510667179735162 0.1114712048192527255 0.24622111849453845456;0.12375421586388724027 0.1435439389105088448 -0.73844768763556423163 -1.5118559185886033536 -0.45104394629670468975 1.0002832940217014634 0.76672584495839002372 -1.1958060633266007766;-0.7297432283164541067 1.1773349473611327554 0.060390718627053988077 1.1493611774809628923 0.9128035461608038359 0.23102763982717222646 -0.83775508643997187441 -1.2917660397583936582;0.28927435816087126996 -0.47249276337052231733 0.049423772776452171152 0.82375209192861076346 -0.17626894538681381341 1.3666750466470729553 -0.37468245561941221355 -0.60704745785500902056;0.7763095896684024666 0.41050002608022834183 0.47168494611241768011 -0.45069561775946292981 0.24547584715586237558 -1.5508495325081990135 -0.15105287466724096057 -0.2784455641578236218;-0.38164908969418970264 0.60848879439493708254 0.53254973674684769058 -0.96023412601569280156 -0.72807558428061303069 -1.6512628571115688381 -0.070177983891048498211 1.2474744089940863478;-1.759423344542733858 0.46812100115905513897 0.73842976165693108292 -0.76742454879238608534 -1.8683691189433704327 0.46050274709406774365 1.4515620248709810713 -2.5090309081611588127;-1.1482189941639813213 2.1115697702215574516 0.91962302238037763047 -0.11915257986737616547 0.46316506306111548952 0.75785610707426931398 -0.26875254994187058877 0.30094530670232011449;0.11406874408246955865 -0.085516151979253454685 -0.63054131815914138404 -0.44552607747742156707 0.84626734966001337934 0.25430378524280439212 0.42304280607789779278 0.79210821999408687066;0.15010492080284579264 -0.16272217207962988428 -0.79698479434160862667 -0.43812480501300754554 -0.49664724382483077525 0.078137261658441592438 -1.3570899284378963312 1.1590829680652414702;0.25011991030771524303 -0.6138348319832946931 -1.2828401298832670108 -0.3993153096903666599 -0.43056353215612486185 -0.35634918263601461641 -0.15906817723078983673 0.52781777932283291399;-0.20719739090534095016 0.22905395566781977523 0.90529333085009322524 -0.052561986585491875246 -1.1646309926262534695 -0.38546220794641594676 -2.5059226107557415197 0.46357321111040356021;0.4001140449464027915 -0.44111870851540080363 0.42285771786025005969 -0.62414409922319358248 -1.3359796118157865052 0.75281864872215698004 -0.89735691817718366003 0.5546009149880143374;0.14365896026397229068 -0.11720517108128075678 0.41815620381747609091 0.032029450907571824225 -1.16657680199084135 1.3117729510724995823 0.49058951273339596044 0.57305370116128362401;-0.078385857439237538458 0.23623048075447125593 1.3382153189291785544 0.14470996113079484524 -0.39962623670350622129 0.6322115391646834226 0.61948854939202402381 -0.58596818784205528807;1.032590903935275195 0.6381587575091338671 -0.8068216859859187462 0.056078551844043734997 -0.38520644615648025333 -1.066140610356546059 -0.52969871159888848311 -0.61632595729767469805;0.15431392537464949655 -1.0428903623915264376 1.2536132988126522658 -1.9564643215430663759 1.0553212309460235918 0.39578785349218997824 0.95873920709635584991 -0.25097897912436450962;-0.0099240089649710976072 -0.059226634528933584656 -0.36327161620129572173 0.057232881564081843073 -0.78410744101036833342 -0.43781858904991810544 -0.044551227890412992139 -0.42188444885434028819;-0.10120913863287074597 0.59064983335674470233 1.2101592872427808789 0.67261078708615662514 0.29213837431051897786 -1.4570863433855532065 0.51508952807829555542 -0.22358760325414908654];

% Layer 2
b2 = [-1.7354592301553548594;-1.1366786059216040794;-1.0678021674799853535;-1.13805261749294373;1.2141312103616999085;1.6358546421871253962;-0.43155009443752112563;0.24561193002027517651;1.1378585301859429624;1.0414427028392383434;-1.3757374646844240385;1.0528718643486789652;-0.23331207706559869974;-0.5677846102205580392;0.57311609430233922957;-1.0149914690814052509;-1.8407673921434157815;-1.5362333855339382893;0.020604304025286318547;1.527581538048939036];
LW2_1 = [-0.12947014783789767556 -0.17030738245359855476 0.35076736481131781664 -0.16690510211703749044 1.4278233822768431338 0.3218251530161928553 -0.33097043950371496379 0.097414942727628031638 -0.039607314589942016481 -2.5507715750269457367 -0.35931265613348051247 -0.6726463072230383089 0.21426095785348339695 -0.16066314755132246606 -0.74137169386564127915 -0.8959912581192062131 1.2465458775795690283 1.4100089867163876356 0.074333489983970782444 -0.14955059143900964469;-0.51191369958018284603 -0.056770755445154946761 0.29923123509143406684 -0.034880590448654651137 -0.37292726268884346386 0.5466664097088012042 -0.76824207326435034471 0.20315713877735860904 0.30824607110616208949 -1.0767504848123645722 0.62460516674498833822 1.2546442395790116109 -0.096961907164986815832 -0.39138121046577090123 0.17303367685288903455 0.72556527492311762018 -0.2235246261179106575 -0.49822184020504572954 -1.031076633512240992 -0.36040713272527946653;1.4553534551274980302 -0.44717722125571163216 0.1979144720915987643 0.311316130243170619 -0.16866556355843109749 -1.5850657041821385462 1.1635520093656492868 -0.085177706164623626095 -0.39453864777374786366 1.1714625826855007418 -0.70703410083479267811 0.11762119263281814452 0.13931692064065551162 -0.48891980707812804363 -1.6170648068804447384 1.2977815429956331972 -0.13472169153518023799 -0.3340092417198435859 -1.2377541439010057989 0.26809393890048627274;0.042452008353159188803 -0.90411193451116922404 0.075441578802462577746 0.098951752799912251479 -0.099907968989783310643 0.84175174639172667401 -0.62844637451958063057 0.46970169575744297186 -0.12628564693818516984 0.49211334263232797692 1.6233719925070213552 1.6684512510192073265 0.37135773929266646665 -1.1929617809040724552 0.29206406684432439924 1.5907608336088268075 -0.42364491758093258955 -0.094325197211456726643 -0.20589363828426310299 -0.12808105539724864985;-1.0662185754704549545 0.11754895705252559057 0.51068788027776057525 -0.94022526819277973953 -0.42210615096660636381 0.76202152449917204269 -0.58071154037671279813 0.13233989854762284732 -0.53878344458093774261 0.18224046979752495101 0.79023346924452786411 -1.8677774175665537992 0.99110497884578574457 -0.13034057079718269767 -0.71008761757966409878 -1.4120029517086507553 -0.14336430244477701978 0.16378307958714963255 -2.1082923604533130302 -0.24642173943954159832;-0.59753210398896738909 0.2535881552820492546 0.075115333754882149253 0.18846897776048945894 0.071063454393486685801 0.76251698194446471124 -0.074372925862382463502 0.2296515130561936624 -0.036227773346192426729 -0.63880447445760257796 -0.67493959457181695871 -0.77127467695486406907 -0.80413907781574667233 -0.0959496515886048007 0.81469995293134989112 0.89044244924685433951 -1.4210046236291582478 -0.18029662586368738753 0.038270460577815502978 0.53269841091315617287;-1.4229161279469142443 0.11313582118646869912 0.56101374656676017416 0.10870782788403937635 -1.6772412180941389526 0.080426462855604119451 -1.2972513297029486523 -0.2568177535693502711 0.10439600580814964448 0.90347179805993216295 -2.2343861259568127409 0.67143293066581977158 -0.70898092878381713255 0.37396221752974651009 0.94607649173691443778 0.023171357626985827904 -0.97635726193640304249 -0.97193075599617206883 1.1421295534836093388 0.21560776143537085936;0.2839954675061548417 -0.72004062670658985912 -0.55993979052691267295 0.23608912351870489643 0.33402308815620140869 -0.14800057853863729518 0.57273609244039846988 1.2550353897881794119 0.20159581508545612594 0.40317736506491952397 2.0952321356623371251 0.95634818129206322634 0.10378262867998080954 -1.0267550152752580317 0.078507374860061207578 -0.22654384314571421322 0.69409847003946589794 -0.076474907182478346623 0.2943450102367489718 -0.56728607261865637845;-0.15626749913134513337 -0.12621947116934895128 0.068767085331032110074 -0.048284608448594765195 -0.37973846702480601456 1.0086618628256456276 -0.85286768921180799996 0.29431203124794508286 0.34999476123190953469 -0.15273683658877323932 -0.47936405355169386944 1.2923699890496109788 0.46781771211462230831 0.40120508775282032188 -0.20400390014220057266 1.5615796818606748619 -0.3808073246569649295 -0.22920327827294287304 1.4683229375607478318 -0.40319606046700784407;0.031737233912135905112 0.0092974239788618309732 0.17939898513273011549 -0.068589544774914232295 -0.68509525307524987703 -1.4572749792228416599 -0.3517186606601937493 -0.68052709042163128661 -0.067143554552432871407 0.52620766563194165677 -0.39249015911156270864 -0.50957685742288982844 0.023364481684653388982 0.46126561346368516459 -0.33790432857625857244 -0.38977679980140472749 0.80685251203688568289 0.075022537282861123664 -0.14202116043446083582 -0.081081026049283494439;1.1583824494705250441 0.28939958138692079004 -0.52060037599316499879 0.015957292317279731658 -0.57328647796733267494 -2.3222417160651898094 -0.32905608530197966166 -0.27038164282248416947 -0.15538095142822419548 1.6258336013875038795 -2.0308651384646463356 -0.21518658033537518826 0.8408961733725729415 0.41620780056067396835 -0.41539966781178117028 -0.78358800744912449066 2.0731729146017521259 -0.017603393220812502129 1.8665432523209182225 -1.1134796025383160156;0.56100563911490763935 -0.3145659280083090148 -0.49720494875521098477 0.061203422415359552688 -0.1478398528382110777 0.1770853106838314317 0.090990574436502547062 -0.034600722250650695067 -0.08297717573081263287 0.023108103498690676925 1.6660515363918835252 0.6856411419935657392 0.033684233486738303365 -0.34402323957130614973 0.0484355853908622902 0.42051747569581010566 0.018293260690854015044 0.17990589594407202512 0.35159464122548250709 -0.1142300159210932059;0.27296595457425659736 0.38429938610547093036 -0.50845278062929677443 0.15927584731047050859 -0.55663043367570819164 -0.48385998049409800759 0.50909151599510649167 1.2428299554009893946 0.39871557423694836686 0.25990982792283701119 0.79730825783061731737 1.3995811691726325332 0.040300536279712743937 -0.5676215749857577153 0.11970298991031028124 -0.33550169369792531837 1.0530137203168661308 -0.14961980809126212977 0.20610292856506975956 -0.57901162469598965732;-1.4383541166057067784 0.46135222756107735487 0.14985215318478106727 -0.42538464708109591239 0.88008910903749759669 0.91000443620760251839 -0.18221023528238716738 0.73467359635073425927 0.21448694608290996833 0.31441063048432088545 -2.4384462960928834363 -1.1862355290352657455 0.64762352735302397555 1.8739971534031014677 0.32404478451278057038 -0.32896540387046097065 -0.13905580563037631125 0.31969155210995997551 0.49868854523401212608 0.65042401488821277589;-1.2750487405015162867 0.085622338464758862564 0.61865875195960895461 0.83174132977733872263 1.3796150908074495955 -1.4769990707837898913 2.0213120615003101754 0.93992368048408514447 -0.32200574506249352025 0.86473661866834483636 1.2135746101241153827 -2.0634427888647413063 -0.65899266156848501641 0.74544291638185089521 0.71941018619862728833 -1.0686757397206629872 -0.24042443511495245612 -0.47335338118111580652 0.057403638813284085796 0.58297859978583865814;-0.53979757610891287989 0.85338043742077474008 0.51109072990623705124 -0.23210318407289573517 -1.613894299281436906 -0.47385421480079292778 -0.94819953184097149901 -0.067548585913124237212 0.34658875532135369202 -1.7446627889732204686 -0.49401467746460359098 1.1715905023279560293 -0.68491729376032606247 -0.088071231797962667986 1.2362680867719157973 -0.66379507195164788591 0.71597089460232243852 -0.23583953263489368379 -0.81177636403239161744 -0.079365334535398915361;0.13629809589654645618 0.56339550849730490878 -0.0028224089678954896593 -0.37352092119518648383 1.2101736595779168937 1.3994523973005348338 1.0212727781927917192 0.42030555818687176384 0.11459577592205132113 -0.34887055161830254901 0.014367701084648751633 0.92233466024792110094 0.32926337177050518656 -1.1318101186142748293 -0.62664459164880803588 0.0038988080856128953799 -0.4707218342019012236 0.48980287579347014937 0.06382606690128905802 -0.40037162539686771412;-1.1948312724461347401 1.6673224960036228115 1.2169753459756786906 0.65421979500080729153 1.4585621534001866895 1.4957375668692314274 0.092503897010584174021 -0.25104267800281382383 0.15533691034336732928 -0.20968273805474371696 0.77742283923140464985 0.73537943792063509285 1.6584490947669203731 -1.5079245248123003265 0.35091189827300461879 -0.0071956455404967104017 0.67503482661245484131 -0.1638001949341168495 -0.15533125019658128307 0.77974418619565644128;-0.2819500575561982858 0.7528415416581343278 -0.27596523218035062808 0.0067726297408531865862 1.02650608043872138 -0.9106104222296362849 0.33257446573367954734 -0.18575132295438770424 -0.094762885210012387516 0.085340937773223241036 0.39659645179745162125 -0.47818978016176783008 0.15602974021470217281 -1.1289821214186397391 1.2446381677807802912 -1.4378672866534571995 0.73978092754673752118 0.016740505339087902864 0.77010303218991194019 0.17415915893882280563;0.10514034031074692699 -0.9166839231278766098 0.63770854204885396577 0.24687213194798376947 -1.6398162126594011401 -0.48422720551676173839 -0.088369219942513205224 -0.093811883687281216737 0.42271787001741895073 -1.4334795999052256654 -0.79712883283134150503 -0.2359159102717949541 -1.3455564988037160834 0.66849119108011834101 -1.0192803090291611134 -0.042005612127376204534 -0.84571356307241507544 0.074419412852943470083 -2.5301493344252716788 0.95112390369643362575];

% Layer 3
b3 = -0.8365970042343887636;
LW3_2 = [0.59064592918282055045 1.9771140961381741263 -1.0568320988919814862 -0.7162296557704241895 1.0513946861970258073 0.92969124803443203842 0.81360110883903957735 -1.5014967169051458562 -1.4729835226639553802 1.270014632279572675 0.8175970583707996564 1.4574085424979492664 1.5653636295240382914 0.29606465589136621297 0.44179906193281565097 -1.4186357491648706741 0.74364563959991214492 0.35020875693456265942 -1.2466983377205198558 -0.75093766557814622953];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
