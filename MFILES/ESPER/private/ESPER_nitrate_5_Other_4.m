function [Y,Xf,Af] = ESPER_nitrate_5_Other_4(X,~,~)
%ESPER_NITRATE_5_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_5_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.5712284869187591596;-0.53144405407000783192;3.6144265557105161868;-1.8165837792825574315;-2.3132908765339719181;1.7217290669427818273;-7.2452917855792913215;-1.8065506236977983967;-0.66864756791436252836;-1.1746052337489576445;-0.077209649061553489724;1.5604259497245813737;-0.64802797744820228587;0.61560936348846284627;0.33658310664903950959;-0.10297382019170303602;0.25763318087319775351;-0.76638817648161272622;5.358931380265174127;1.3619819273079636357;2.0539071723491608701;-2.0176796915022094936;1.119928232660587275;3.4819943646921367453;-6.0231655721540695581;-0.37435053455977135295;-0.11148421017314263937;-1.8176559771089564332;4.4853570297459297578;1.9782693511181097534];
IW1_1 = [1.9960687289641441122 -4.8542063522216771787 -1.0487011862156092601 0.17622499802220720211 -0.68132637371515003544 0.8090053130423103811 0.37007427549832438984 -1.5600878331614811412;-0.083484168632258562437 0.1130820184758306729 -0.24278816289708496368 -0.1323624568909782806 -0.23425344733039712986 0.085346307349972505563 -1.105113939802330858 -0.15941670053007414576;-0.59759016734776126967 2.9245507158089707467 0.55788587054333727 -0.053469483323129209096 2.0581809808355493452 -0.11031844108978208774 2.2432537022659699844 -1.7540828110747215263;-0.088115772168892561589 1.3678958604187452242 0.94985748560953886521 -0.4682247077557152859 0.64768905719530434073 -2.1622590523523399497 -1.0492353732305408354 0.17686340503141298464;0.19878732032690304976 0.074368699720776670903 -0.85092771657910104555 0.73303272035313926658 1.8653481752146399142 -1.6859887678680751666 0.50623854762458597722 1.9219470723794089828;-0.036928846725983115185 0.026955952456660568772 0.97263293029578645754 -0.76152574472507916781 -1.1969475264364628497 1.1269907614436338594 0.016453575616951408161 -2.184810846768378223;0.081568832845358374417 -0.33426870488063165077 -0.14908750160437361787 1.482269037548277435 -1.2977168555993412458 0.37667496482857193429 -8.4400667400328419632 -2.1557977909174881326;0.75442089359381281355 0.18922843272762371325 1.1592759449109757419 -0.2426043108157195094 -0.56998071532234084735 0.074956951997014992228 -0.48820395153259826815 0.3757470432245016978;0.36935884570746624345 0.055215046930666644709 1.5090293169909070325 -0.45070567140937001227 -0.85360908556750081377 -1.2356154209032899072 0.53180477204223497445 -1.4093680955242360309;0.030959533584258392552 -0.044564002747765202317 -0.58669557530355198605 0.63694770401237066348 2.2300467496205356177 -0.86495939872070659593 0.05809635218570210341 1.8081450952766380258;0.37844697083634326606 0.7089885962231916583 0.33316018790060553112 -0.051369984424401368694 0.64086716815386113311 0.66973111520157813104 0.22412968455924853206 0.87282704362155472122;-1.121809812980463672 -0.85741441366006065916 -0.99183269436006549213 -0.014919093755560402029 0.9401557997735123795 -1.721735144225635894 -0.17533563763353376963 -1.1740349347253540291;2.0010752171993648751 -1.0419118211155000697 -0.95138818344815878625 -0.018789217617327731019 0.72233144212669786466 1.0117877832450736797 1.2601922680139190369 -1.150857863659666469;-0.46248055617832034558 0.23507590292685279221 1.7006292712241539711 -0.21009653934513122797 2.5090542514582612199 -0.19594248855102902596 -1.0131139715063095519 1.080656950631515123;0.58250633768089754572 0.65773911369885706968 0.48932432829380090311 -0.072992355204925529755 0.40959195041564278039 1.1223088607089743984 0.5143238499928229901 1.0298969776967543677;0.037918538876793382586 -0.056261460883394114052 -1.2076388565221931604 0.23471711528660288426 2.0513605629618183457 0.56957706197993507313 -0.12274720940356574628 -0.024816315338670916213;0.18376864381103028001 -0.0067212695692369876094 0.79504530657549077333 -0.1236739299799389652 -1.5121578977325311754 0.72651533710159355017 0.72288149064889128947 -0.70249051932765338435;0.077453134729006986592 0.071050138686968730695 -0.41621471289561745577 0.30247978438897799025 2.7142177049415114887 -2.97049167260542335 -0.099542309335745746135 0.23329681847197550337;0.46300868203862921568 0.89284308792076705341 0.78806196750796086992 4.6404999393611401359 -0.27924495427547063597 0.020567551408654561468 0.2594062653568293686 0.7986011758372777436;-0.44630654353049670213 0.16747721951230201687 -0.73102266589753295278 0.18453843133031880286 0.074996374517996552966 0.72243580335854262753 -1.0700583169466135747 0.31785727622314668972;0.11501491513567720093 -0.047515019383920102658 -0.51482496790128695618 0.71556182736027751368 4.4461695464848993709 0.22629263147247535848 2.3072123601655030178 -0.81813156503504225192;-3.8626159656681466892 0.99075929503735327142 2.8381205406445069173 2.1116946907141649348 -1.9258179158793782282 1.4242479106285632628 2.2228847447064192799 2.1175327882440102556;-0.025792027549742455039 -0.081209783539781713047 0.33913742589920670145 -0.064339858431769494929 -2.3693337157878011645 2.8685110239332196613 0.44209024983129807662 0.038610950485484699102;-0.043540794260778635516 0.048287452435118505267 -0.43154441727455505884 0.39913886838354289965 0.6994345159709869364 3.4910680380707748149 1.222827099061573497 -1.2204896883298848032;-3.1484190866509140783 1.4876358115767656098 0.4688886842669799937 -0.38586808335333211417 -2.2119465463634742086 -0.45413873306485291748 0.33160064193531857413 -1.4527597162478280701;0.19363602385551134666 0.025700992757241629405 1.5702251313861019799 -0.3541979259848151429 -0.72818338058589993089 -1.383200389746487291 0.059488785344064362692 -0.73049842327680492016;-0.21859446783500993683 0.097188489690711463154 1.0053676738616985631 -0.35700754354289143677 2.5830296097774811948 -0.64598730309058427501 -2.0725067119923759051 0.70565251718707744377;-0.5201411029720337531 0.33808327325392595331 -0.27026605450327456648 -0.066589442807854629103 -1.5070607623339811187 0.88140268818573408449 -0.10085337688425216607 1.3150504810164513891;0.28356674711507989795 2.3072966055295731636 -2.753380043146295808 0.75624866164917470268 1.845580308796125335 0.46703483330915335214 0.38811314026948373623 1.8954753530779022697;-0.024288967144365333772 0.29235547512964876748 -0.26851614707441506802 -0.0098405560531915348133 -2.121628262919929675 1.278296272629567909 2.4048041478758657163 -3.4648372220500300855];

% Layer 2
b2 = [2.9346129880501425902;-0.7338992351772445355;1.0590927682667725662;1.2550615062006038603;-1.720983057927915727;-1.3796166436563694901;1.7508168432262425362;-3.3759422192573707022;-0.82293240691966251799;0.16568233698362111461];
LW2_1 = [0.90822774723211763259 0.6158784774539810547 0.70975246801280778008 0.39021358776606257512 -0.55250264004193538891 -0.36757527986659127572 1.7809285737801885396 0.67942482639298251712 -0.89139227836486645273 0.25739238890763371792 -1.2058206113810485682 -0.75271239169973824801 0.48960438383479337743 -0.61188908987296175557 1.4403967825192596219 -0.26429601899583010649 -0.41384316295903617045 -0.29855356396473203828 0.11161207520213918543 1.0116794447444321658 0.10494710617941613306 -0.1912440456484427731 -0.031650603710568332716 0.53760841233282363749 0.92830007148862248023 1.1759955749818833404 0.12978526056409009359 -0.44842875040216062521 0.22173315933357817809 0.54600011123550529213;-0.075729704813575549061 -1.523034091851985572 -0.64255591496813879715 -0.18057214985708097688 1.8827210448528557407 -1.4817104601862212121 -1.0359626059532007769 0.21418685009785320972 0.10025236556740141358 -4.1529415476993820633 -1.7489020475600662863 -0.42291913414132598081 -0.11832688669896430922 0.67191333993269042324 1.3206484856701101727 0.69057574675839683565 -1.4903715717992571665 2.5413958122358595304 0.52212185921086728957 0.7761457837693089834 -0.7114474831408287292 -0.28757493222275032352 1.9111360537737291931 0.50466139479609994911 0.23029865228121623733 0.75557827197845817135 0.74165194288413771595 1.587715349282582844 0.39752681416446250529 -0.049610917135947951717;-1.7022772160442261047 1.2976283913993422736 -1.3163190813206346874 -0.038209657630832498387 1.0395555078967619878 -0.68154855756019572244 0.94432054076874394344 -1.94354545768017406 -0.48132418671608495631 -2.1289910813310224391 0.68288846612618903098 -0.13990922693997401294 0.32498626512159550783 0.99148470667561738878 -0.71850077009588964039 -0.52806936733884146662 2.5696417287376283056 0.9230399589947773098 0.21595408946070412948 0.49862166989808420769 0.61255628537941286815 0.00014390574090362528818 -0.61730062658483297877 0.64148436705968392424 -0.65880972886941657762 -0.26352638566013258936 0.010357408368833573298 2.6369387987509882443 -0.34932117586008853971 -1.1814140780348143522;0.1241759696603321611 -0.1822084642433710322 0.38492783567339333706 -0.12795480818207158324 0.19173099965350659524 -1.1215285685392888393 1.6643137099006002355 -1.7297693432247887024 0.10791725855589298644 -1.4702523541770713411 0.83650615214906653971 -0.24391569694828946213 0.055641498714685690141 -0.86588519554168941195 -0.36273016962374649008 0.014327422369234768876 0.93964120415319352109 0.2349291331696798657 -0.084942961390763779828 0.27987744088633792483 0.37609967209595301929 0.043118180838760733486 0.21231033700519660878 -0.84244326326158314178 0.3145110584710584245 0.23607595716066367975 0.58356246038988712765 -0.28527358109871303604 0.18274219544436409723 0.24702665096298664915;-0.42580898890097118592 -0.23637247544772430063 -0.36455321267809082109 -0.078930287821560113359 0.48592207915375701388 -1.1685841707244375431 -1.5977115277171785035 0.15100041127164925969 2.6819125201915756662 -1.7645193233322609139 1.2467750941683033439 0.12060693772337006957 0.36583229906664904707 1.0035361469182930705 -1.4349569591397468571 -1.4957702334278322187 -1.9217861533676094954 0.58836664048559561557 0.17317061190980481689 0.54942883759980021274 0.38862528389435230247 -0.1213795967688097166 1.1491930926875215668 -0.74291627380176539219 -0.79010407185874942382 -3.0705556901794408553 -0.44455263939906008996 0.020643091236686211126 -0.43884110969100315058 -0.17117595943184038543;-0.18892133079220108094 -0.17604318853419154145 -0.31305010076466627256 -0.04126374249428158697 0.33676147661861371985 -1.409695296720646418 -1.5613599009870948731 0.13100269875114334273 2.3720808300771962784 -1.7689528999823160849 0.62476425144673053413 -0.079474219205578719438 0.3011279967298881588 0.92437561400804146849 -0.96754378137799457171 -1.1763297908278291803 -2.1307563378268601362 0.77232040905983945223 0.22861104178959040789 0.43440987538148434499 0.3524400170874130156 -0.1377140871308724368 1.2964473785564778474 -0.73182987797673182406 -0.82838658806868803453 -2.4633499338479603047 -0.28130558110805248262 0.34512878185945733422 -0.49637420343511068355 0.14707685913844936731;-0.61612569981720510803 1.7173747743262148813 0.23632835697679419051 0.06784815508299087139 -0.51556204839636354809 -1.3747361945847551556 0.15395522500095024099 -2.046219335793828531 0.17005973715648295408 -0.83575969307670971986 0.76890082696733397238 -0.74589885029565961005 0.22285089777706573733 -0.40691808421623582026 -0.70101928985469508238 -0.078003195899468677488 1.5217794047947634795 -1.0787007008899265337 -0.033447105656703453314 -0.59559480694493249775 0.11636378068738995051 0.16515370402783036141 -1.1774355549321118275 -0.62447262771144740334 -2.5267733196736870127 -0.62288949073466659545 -0.26353594389702578171 0.59087929231681235454 -1.3284905506420110477 -0.32561511740595783237;-1.2568835768190362856 -1.5613242932994912948 -0.17319894534079083304 -1.2519639165723099872 -0.52879449815439050209 -1.5190444012381729699 -2.275518761289480274 2.0581755527278864371 0.53360098328312988158 -2.3340472863352617061 1.1900201251724802365 1.6468489716831486991 -0.94900726202902629947 0.079884654034430221947 0.62398510324979961084 0.82699777554030895477 -2.8962832955629527198 0.39214508583716511936 1.3067553419326249919 -0.8336900978086249081 -3.7236360745432182107 0.2119330148911540701 -1.0811518768881762664 -0.83996421536330556634 -1.4310049988379629493 1.6502830564198207597 -0.22442227632589448194 0.51616857122019754733 -1.2216007744714962868 -0.10544983350844960857;-0.1451745233052745554 -1.4325643819330609041 -0.6782937380731087762 -0.18335584339453830927 1.9019042390359686134 -1.9713934313323431269 -1.0624679211256435885 0.16044603927402392718 0.1054068654913105918 -4.7835094088371699073 -1.7591862911942146575 -0.45784161718739940783 -0.11022853175040196738 0.68314123475581800538 1.3016728566313344739 0.71905378608861636458 -1.5223544814818257276 2.7586584615095968154 0.54325273208862545626 0.85455025392095496084 -0.70590807483868012184 -0.29026740569405645731 2.1177522476950074726 0.37920796780422549865 0.20548765562102042082 0.80838888696855171201 0.76165210319291754004 1.6651790760519478152 0.44394855610028188808 -0.068362464427502517283;0.61806893014004504749 0.11731906852274674724 0.35513107687182809968 0.2874627407634495202 -1.2279943455626058935 -2.7845793276708246111 -1.1579055069864980787 -0.14848647186350347194 0.32981427562948750776 -1.4473448351987530103 -1.2612155118250325536 -0.79999760593192359437 -0.0039622121833073932484 -0.21644280370242369171 0.77201214874076118377 -0.19487722623248648901 -2.3655516586132119272 0.5180436819053974018 0.048836680344540972509 -0.90743426926265824406 0.061338946440169399288 -0.024375726443340024752 1.1438874506212344251 -0.10941707397014301117 -0.40807893081202584185 0.27898092294790416412 -0.0096319212808829764855 0.93835307161528502817 -0.27582267852730324442 0.60915883470658194199];

% Layer 3
b3 = 0.68173419924268408021;
LW3_2 = [-0.24364558146661272064 2.480432248099138981 0.26668242734444780329 0.69743461745951906838 2.4558881477037401986 -2.7137108905377362866 -1.1512279663872320157 0.057066960549241430023 -2.1997365420288041982 1.1396842146040164767];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
