function [Y,Xf,Af] = ESPER_oxygen_4_Atl_3(X,~,~)
%ESPER_OXYGEN_4_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_4_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.6858918352915104322;-4.3716919106526228589;1.3409428987897542562;0.46480123070636003568;2.9696772549681753617;2.6640993527832939058;-2.4311559665258526408;-2.7987784351133169203;1.7184593876151013081;-0.41370175062592323689;0.31883623233586289025;-0.84409087055807230371;0.20508712619275709654;-0.70599557368836018956;3.0121429310066827334;-4.4081040745921606927;0.99092133891014722025;0.71326744510883011152;0.15319213133336953558;-1.0769135172001049749;2.0602410834085200797;-2.1096268554804669115;-5.0071462520963159193;-0.86005800665955378648;-3.7601822341037212105];
IW1_1 = [-1.3785404937212062393 -0.4024053639654712744 -1.3723360038060112842 0.18511417222630657808 -1.6632294019418731867 -2.9310556816669586233 2.3596716173461622645;0.21020983785702485047 -3.9727197128886655442 2.7126473081012010269 -1.2051228449343720506 -0.8186985436745463085 1.8285766187308443165 0.60369972471709498762;-0.35789590655198821878 0.15096924523086005521 -0.014462290454843432924 0.07244104103651369253 0.50082181384008350733 0.90473819864318905104 0.00077409859974296620078;1.7288437135400860356 -0.97848684807393082608 1.864868210651484226 -0.64542787827479164431 -1.6686144410289613926 0.72671075751162583778 2.9476882160696553647;-0.30828364932005297705 -0.69937491579963739774 0.61674493371762706406 -1.1507266348260254407 -4.204655846117483442 2.0865416098833513558 -0.24434362762935971092;0.096296344838908420893 -0.14218986764610178075 -0.17893943764509975813 0.20939787868352027767 -2.2177236761005412191 1.7801229450417221933 0.0088311989801664429744;0.46685551463777730241 0.50162129774228525481 0.32063574411080020266 -1.2946496299867673585 1.6387189731300295659 0.51434863813661013676 0.015169005019387463151;0.041059171585729761778 0.56597475551975218178 2.0976164048590177913 0.83120512923402689598 3.2230513288472146805 0.23063095745660808222 -1.1470212218312028085;1.1032806841839319922 -0.65056104993393426561 -3.3352379679916785982 0.51172199921940475509 2.5619886115554191264 0.51351157188405938125 1.1637326881477221274;-0.27712360869791718976 -0.67595470611087704604 0.21618054699231983862 -1.9515915184974037544 1.6371917003696121462 1.3663763431974917939 1.0565775520550269029;0.66282057967128182874 0.083652278162427928798 -1.6120957897026944039 -1.0141295079061813933 0.55475752545941825478 2.2449256410350022506 -0.047444761427139804655;-0.37471934350160424065 0.23113708683786399201 2.1026281969146185524 3.268994600458652755 4.6645909549009934025 -0.77948529382979669933 -1.7453616021856326324;0.49582553043441218721 0.6268318120000366811 0.35708586397680935898 -1.3569408835230940547 -2.0003232802892081388 0.64540869132880929193 -0.98665337003289710349;0.19092464382597540418 0.48948236511151832495 0.72118135784423287316 -1.2411439460648463484 -1.5578445656562573962 0.98126549274124730271 -1.7871306834968450072;-0.18501817660613251171 0.22294511301452268892 4.4689539624722840472 0.49485672534681612866 0.77555851213994475568 -0.32888728531616800987 -0.9689448328389629328;-0.6159588722935667171 -0.56941462065871972786 2.2084628037060896055 -5.3750051400789375933 -1.8596685454215395872 -0.59219523180514366256 1.9804603253227830439;-0.81359905930377962591 -0.41971529586828754121 1.9517159727401893754 1.0560164186625435878 -2.1895797947152417784 -0.9479333507688292304 0.56938151410238391215;-0.39236767657111099039 -0.047954850751476325865 -0.23652764654654731546 -1.0453166740023718262 -3.8131623205084239636 0.66363706644251474476 0.20099272029069706336;0.44474515428256444771 0.068689983224631573355 -0.51650081392564362037 -0.10679850275620748901 1.2180083395547007807 -0.39983043033987558657 0.054114927991142591779;-1.6028977971113769208 -0.11578399067455638627 -0.12908615854719796001 -0.90363883114553689158 -0.28940605626099341618 0.79631968197519586994 2.2366031930909451297;0.43514877875770102689 -1.2537547345351418571 -1.10958590159899817 -0.56594284516452475486 -0.24702874126009696787 0.61448559432204552522 1.0269557233802271146;-0.61409540839041087956 -0.65146666737347280751 0.35810458887723067845 -0.99786488284389240899 3.1634110405180235759 2.0142797480268734844 -0.40040990316083729939;-0.044199843423910811779 1.072997532248226138 -2.0995130390112941576 -0.48676052288477339447 -0.67567900010271908506 -0.17577014534227880516 -4.4511870580036392298;0.1698287062774977707 -0.75591606812640876889 -1.5485374311838515649 0.16804242150662265787 -0.89831840270742391308 0.74715159599076019781 -0.097302829162210641156;-0.14654759682756784978 -0.21556621875719936265 0.96856949223407617922 -4.3706294131577543283 -1.4582046344280692463 1.5402548705658252182 -0.34150321169663355736];

% Layer 2
b2 = [0.60272626113122296232;0.90720204028765749626;3.4479193981855744688;-1.607989400159171467;-2.6685135850799213131;-2.0561802719885764468;-0.51815737985765286666;-0.79599545573227381556;-0.77605465243295468358;0.59859516341856611188;0.40265994804655708128;-3.70531108080615601;-1.9179444524723794352;1.6541262183923230999;1.5170066921849942876];
LW2_1 = [-0.21077020315201305811 0.0047362818904658774213 0.13948937212428372256 0.29672696961603373111 -0.024014401511030358111 0.29679185943703384476 0.84565327178672289321 -1.0095252729782739909 -0.18447305738517658091 0.51412810907272266103 -0.2871527589579452866 0.58872710998842658903 -0.25738181659410253044 0.024246286199567715358 -0.13998643219908138424 -0.36831793022759740097 -0.28702505783881993029 -1.0670315725584929023 -0.037181691274073294662 -0.26748210076426193194 -0.06000074453009916764 -0.14540830748106395309 -0.72136053076651751592 0.90288671661141839397 1.4506375175931010002;-0.035426339857490198038 -0.35482318278732483119 0.79257893038780236061 -0.39508488247165146623 0.18946929237900680953 -0.7511884944915111495 -0.02753115723098132836 1.0460637652183863988 0.4506110600129393795 0.52464794085124000222 0.055709945395661202017 -0.63432767071807483195 1.2975255818499806804 -1.2971731241767971987 0.56239824212084665866 0.12826790810557298084 0.49278311815677844354 0.8875390355710776058 1.2004724173510965546 0.91593299045431475491 0.3315366072215358284 0.064991238590135280706 0.72672728137794917469 1.2123095448851626266 1.6043573226423919476;0.27071918600563832369 -0.1166581962411335216 -0.77556139416161717914 -0.41141867370330831299 0.46293719400199190295 -2.0983854444587528576 1.4567757263547840285 0.66102130487727084329 -0.20088049701586352391 -0.39433289591429143695 0.27164490522042156195 -0.42560997564622782274 0.32613298249716093924 -0.34355950257197531705 0.65659542199940734708 -1.1659984736913333592 0.69509392537650982469 1.55930906774554634 2.0631042461330757476 0.84010287655092141801 -0.83511150142541445973 0.17076157328719215878 -0.16784377869205907574 1.2689482184418081623 1.2101738094437664017;0.54379114189710409111 0.33961558367433181127 -1.3135476844375659766 -0.10406881602148146393 0.56614274606317416261 1.0119786201089251421 -0.89330694633579255104 -0.13127148500295940381 0.39886578731731631153 0.44727890355028476765 0.050135059316585808831 0.81646972401109041417 -0.56120732627417235783 0.1238914277913347739 -0.26639924592222641309 0.48662282456481387172 -0.27906627499345493248 -0.34045375080425771541 1.2817852947659982288 1.0073883982401128367 -0.070619362016502706947 -0.85087027753726574009 0.46473173654573396441 -0.47887411992066014621 -1.1806623728417768859;-0.10944599192145708366 0.058124230348771420418 0.21028016353222969692 -0.02862396897975798965 0.25907740541240270593 -0.84337341835208512464 -0.83459042083506596033 -0.35301847128283736499 0.23032610780518730786 -0.56853185994373001133 0.24017159779673799558 0.21130797917132509989 0.86850646761011007779 -0.19273815705435071166 -0.069504954667675811208 0.24585417954156466025 0.57912653222849785895 0.41690052733009036467 -0.44747229823442791208 -2.4869243978615576118 -0.38938006613919157184 0.56690074627735331791 1.0852451524201534028 -1.1641116926323031855 -0.28257213568398331649;1.50914332044477284 0.15261784801060498951 0.47200989898382356147 0.17556819418831409729 0.51015049989127769781 1.1371732173495932017 1.0551970121741163222 -0.20478243145841235062 -0.47524697062252213575 0.2736599933651728267 0.09976918725483258088 0.096362397472095948081 -0.13679720355429808576 0.30607412620747781462 0.051964138274460898448 -0.48868955371245959007 -0.33964828580096734223 -0.63431260972900627149 -1.160924084191804484 1.0287147233169990912 -0.20565477452664321367 -0.88576077123994312323 -1.7094453510722338319 1.2353477154875178723 -2.0372396134346524299;-0.49725324204095300296 -0.092131636826349741498 2.0713232911723307161 -0.24065626465059886119 1.0199854005217989794 -0.89813275552742577457 -0.24102695063389073526 0.35862843120523224538 -0.085686490130253784026 -0.39551610174894485938 0.3236803024156842401 -0.90395978079007810457 0.95316401539883333083 -0.38259361109541223378 0.25695322451300461886 0.83610145321735063195 -0.40114878494223260574 0.30518134000345870094 0.77670916091131292358 0.18906972358494009145 0.39699533866881031585 -0.39526370237498376081 0.53755204259032318692 0.70255457071568405691 0.91170913185681934365;-0.43086607431945400659 0.18475743900879154635 0.4759882635329769629 -0.14907747751699609862 0.5996767429883609335 -0.22366510953228302405 -0.64247099939832796878 0.89711277416012769059 -0.13789866017169671863 -0.86011228005699891241 0.1530423119409936028 -0.76450926404035102202 0.21201519108399488611 -0.054421104548500520703 0.11294421040287336289 -0.020396636437356376048 0.030731447028387759435 0.032752947205037061251 -0.67013246423770278515 1.7142556549644984987 0.21867496071814723768 -0.14079842554227348095 -0.85709145497689165349 -1.5908106329242335253 -1.0390168344017451929;-0.67317519108182777288 0.4871261449981074132 1.3264054673036014265 -0.25986845861314261663 1.1568457345671669945 -0.35754827171052927515 1.0056144619668934137 0.37600627990878676687 0.09820386254819792049 -0.22465279596181864097 -0.72281752305213520238 0.4680795485114444543 0.1966815425746801238 0.41050145229903789446 0.57092178065421250732 0.63262239734440950389 0.8251216821638790444 2.1756001718752639995 0.36060488268394419453 0.85990488115475727238 0.7424412501594326308 -0.47644620942324200641 1.1605029763412446631 -0.7449866613243835145 -0.37356531811713211688;-1.4592691895301221905 -0.22450253550260113045 0.46204842142251073556 0.40511293631598238596 0.47159001183762044862 -1.5056429350863880234 -1.1206795500362090046 -2.1559162785253329631 -0.44485907160930682203 -0.79569721652742042561 -0.2427789619970449897 0.71018730175165944996 0.42010907651445433819 1.1244142588274306238 -0.81945214194618509751 -0.2160396152379248369 -0.046076622420256334312 -0.025384922139008374992 0.72890652421278734341 0.059218387129917816891 -0.57793094824253821162 1.1697252008122829281 1.1944655075104451125 -1.9194858366412415052 2.2612731510589134665;-0.86538539109300627317 -0.84447932776078060702 1.254726244936847479 0.17918018629016738141 0.12658199558349048086 -1.8706525276570971084 -2.5062229255101198255 1.2105569130566646852 0.87359147803056613757 -0.15578965095309180167 0.42593005972559888628 0.0016773713537637825743 -0.46115164596978508449 0.72507506221611184305 -0.56276821676882038403 -0.92340695745209844247 -0.38501196501235007696 0.36859928346051246129 1.7432534671090409439 -0.61186566507331241471 -0.30654432994986646754 -0.38001556248046602926 1.506284993862274213 1.3844480492645785397 2.0824911807443551304;1.296550176891890116 -0.13217188921392647449 -0.79079551447471296832 -0.061095462284246483675 -0.70763893345562378645 0.069246259518429262303 0.98300544836628500622 0.17487331307598585894 -0.10253139318502382804 -0.029176673766513443187 -0.21272714061850184208 1.0625200641399497048 0.25575770146436455077 0.048787178381137642769 3.2902303650624524778 0.27641400976832491976 0.028789380431817772343 1.0650089612160746899 0.45308412418075050265 0.46439836227399833302 0.32917004035192420908 0.95663311984680399203 0.61786115387781304076 -0.26862071182383995271 0.19709068083263439619;-0.54191311424143784325 0.43077057682779834602 0.34783959272387698913 -1.7536302674009394131 -0.21017301320358780514 0.74728502750601344395 -1.4110701014501016992 2.2275655909252427556 -0.48692178240893690955 1.0423327130182036271 -0.043378871330891417835 -0.68434863071356932807 -0.43762307514979481571 -0.25566772638483858948 -0.38030543924963960967 0.51017176716889589549 0.58961799433005024351 1.385971260944774075 -0.57006719889301393778 0.44699635630644662943 0.65069149596445940986 -1.3248011736329656785 1.3556182503735325628 -0.051926496424210710767 -0.37128077349401383822;-1.459731053873782658 0.62431970164270411683 0.23338470284111106912 0.82795963311433051768 0.32053070535475031155 2.1195440063181152368 0.4384193490406892435 -2.1117813145072874548 -0.16803998437666065047 -2.3152262865267205783 -1.7662664894450565978 -0.21119961358727973311 -2.3645449485784042487 2.4768605227358433396 -0.31075039364452350377 0.71900382409486607305 -0.77450080727502323974 -1.273038150445566119 0.62203689825295771509 -2.2691229626323390356 -1.1729155453109854079 1.1805643331524569017 -0.60307833131244070746 0.2547987142999012522 -1.5763198471871495698;1.1029219758664881024 0.17796460549591822109 -1.1499403381837307592 -0.082364217190312630223 0.3364133599768485694 -0.66953745183384161255 1.2391509851339124193 0.57488927750775364878 0.087289109348305832237 -0.94816282689954345386 0.017006634058226277606 -0.12007587260662117012 -0.52145297898400655434 0.47645407039644255276 -0.10479443123220689993 -0.22756822329604498023 -0.064895127421382314825 0.80394772397422353816 -1.1819436076515501544 1.0730110203971865435 0.015545038891992176908 0.37669011620725995071 0.22959104764299223533 -1.9666564440356386623 -0.5789312296232166366];

% Layer 3
b3 = 2.4828386924629386456;
LW3_2 = [1.9498526857788089917 -2.1043892021961574379 0.68560275920006163997 0.88618675056302831372 1.1054224977054796231 -0.40631048949189635389 2.2672914193468929334 2.5854487260624039457 -1.2207787606561586458 -0.41558895081442448483 0.53300227231107388803 2.3703407658074162612 1.4532763681016354074 -0.48239215384351546989 -1.5431330325166110473];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
