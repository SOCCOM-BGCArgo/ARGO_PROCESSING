function [Y,Xf,Af] = ESPER_tco2_2_Other_4(X,~,~)
%ESPER_TCO2_2_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:53.
% 
% [Y] = ESPER_tco2_2_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-9.5798777381296158;-2.1316433970577067;8.8957846985216342;1.2106658691894574;-0.89193952722289194;-1.1285605426755227;-1.3382815087592164;1.1470108946242608;0.49654651174681602;-0.54456613118148722;0.90681820193045082;2.4203946625428197;0.35591148269392597;0.49315969661560305;-1.9310067111537832;-1.1005309983277893;-1.2863994544472188;1.0980250289509255;0.77164237951126524;1.6465758879123857;-0.89774352890866971;0.56125836086399494;-2.2475334148373629;2.4319793781105141;2.8275355995045519;-0.64583267706812053;-0.29729215887601529;-2.5394200637499513;2.6450559652249241;-7.5835312822336469];
IW1_1 = [1.656724234133409 2.1137936393871977 -2.8599392276820481 0.35919198106453226 2.0192455906419786 -1.2976740230480586 0.71752053614487599 -6.5371465825778001;-0.14410683917123776 -0.02677252211063539 -0.01579323154526165 -0.23540282910724061 -0.1492813237829877 0.024035977678523751 -1.077848937261918 -0.082399220623054256;-0.037195133899022584 0.06317621554987779 0.63168642481781578 -0.2380265604250644 -8.9098597242510884 7.178128423143403 1.2529271931364732 -0.83384517528953161;-0.57272838406671378 0.48291829534307557 -2.1772843020980903 0.91633156010863936 3.3977286643826075 0.99033428777950849 -0.10579192089188481 0.36393542164225001;0.27389207939391885 -0.20829974209515165 -1.5489961192760193 0.46696108714480355 -0.44354689591927943 1.547626607676456 -0.56019458554433543 -0.4380926722714395;-0.20334163602444738 -0.2665265714343813 0.90169400506979347 -0.17666061340945943 0.77239827028837627 0.3871301126276262 1.3894887251570509 -1.8608988411910501;0.078663693351989306 -1.0974077839017922 0.68064118453955613 -0.66970697927207312 2.2157239596280021 1.78908368477756 0.29033915874021771 0.026617749868558555;0.066218623969332521 0.29659430493175554 -1.2399113518966054 0.25732524067079815 1.2001728061310533 1.4412012288789708 0.31695475780630411 0.63895756178101815;-0.084165462840356309 0.099065355722846624 -3.5544405690616947 -0.57653372153895932 -0.049199329093566099 -0.045962707099328967 -0.080408954860731338 -0.010093088190735483;0.21823896889933234 0.32391437789067085 -2.297349322678079 -0.29595598219050229 -0.11221113915627712 -0.79787994313685695 0.25827109304983814 -0.83738769051085915;0.086774175427596204 0.50126638964254455 0.412498989863543 -0.17573675229975014 -2.338604512746715 0.55326875373581053 -0.46956563927624784 -0.10391990331031785;0.074247123510850235 -0.057971564309960574 0.060547868082037423 -0.010545298076434952 0.30979916112583056 1.2636155541003224 -0.57695048018735051 -0.58921799865850466;0.061501301465980797 0.50086739337816832 -0.081219287999406295 -0.10107190853549598 -1.5664414492347229 0.2422786728195174 -0.44414573172267413 -0.025579560579186887;-0.046059454970905349 0.3274550420768414 -0.31625800213054361 -0.044504929053322713 -1.2066631876853089 0.13477299951611654 -0.72366252106512929 0.82693722062239872;0.81167880238219114 0.22798916996500151 1.1377715733339966 0.11423799679415249 0.72554658854535514 -0.55688363770402272 -0.15278496807683231 -0.68435130491677743;-0.075295578342983699 0.42129386761707593 0.062758013285866124 -0.60518511321902413 -0.98714945256801279 -0.95770075768815577 0.29653741445414561 -0.54158294761322123;-1.7095322712496024 -1.7033529389579152 1.1623285173819191 0.62589121954756377 0.5789408437767628 -0.25175007311796049 0.28557896492602258 -1.5117961674701219;-0.012849259286403923 -0.35107296899701995 -2.394131072401577 -0.061854572180806047 1.8419333268911087 4.4979206341261717 3.1457830260253239 -0.026889994369264071;-0.39888835234391723 0.018113798317044776 -2.7412456301358663 -0.4998309146676132 0.52826913503598016 0.7756528182434439 0.051493212254615332 0.17709143956590234;0.3009020819281456 0.62130680564260266 0.16769720210677752 0.86446948171033722 2.6317777498939869 0.085653253374962518 -0.084103128545647637 -0.30451952386530112;-0.12310782095994706 -0.40490818395031797 1.5976053315646386 -0.45837049526924728 -2.7156107138967385 -0.87679955912279084 -0.091346094420629589 -0.56931137173587054;0.0060558641142446712 0.16939863949805856 -0.10458774886229183 -0.039850554506218071 0.58435279824379138 -0.10265073122393867 0.27206200421650667 -0.14650044230588008;-0.84030736325722277 -0.0036806878686923734 -0.48160671543370059 -0.1888279766298458 -0.22919263637890069 0.40604303993753643 -0.943123477991475 0.015280339023554929;-0.73995969570787057 1.717789606309313 -1.8410086361692 -0.45722669306614255 -0.67133761006849413 1.3143048682220553 4.1002101413410479 -1.5020891706729025;-0.21579723992506814 -0.094169011876680947 -1.0982541897843603 0.21433451756918812 0.42372399933620314 -0.32057360409950314 0.70762742313772131 1.2148734497817892;1.5506402076088288 -1.1355589621082871 -1.2464606171053141 -1.0919238110011475 4.4916083455772879 -5.987106233662062 -1.4136669256749963 2.4268790605790667;0.081749484518501253 -0.25371752627455318 -1.5384419779527216 0.47018568684005524 4.2601353170664051 -0.76142832743741484 -0.55992290553512103 1.2816836068361743;0.099707069138773599 -0.32489165589608077 1.4073424780987014 0.23563968896352272 0.47320855032175163 0.32760264439765524 -0.0074274305085632354 -2.1913994485981987;0.27641291066794049 -1.6138348508069638 -0.71164418992646594 0.50899439556572512 -0.50909007609889645 0.7869143958862258 -0.012656922989082824 0.70102602448771267;-2.7440623148846952 -3.6272591845368991 0.65100422337204367 0.71389721140368612 -2.5259780901154198 -2.8377446825015076 -0.5841310064055425 -0.27299409544734465];

% Layer 2
b2 = [6.4483201303352375;-3.2861494337061838;-12.651326086147217;-7.6083930977555347;4.0358044083745277;-1.9541346313198211;4.2158485761065752;0.55239705932550176;0.56189708244792447;-3.626408024067254];
LW2_1 = [1.0374556371734127 -1.0613574529639109 -3.9362999153318494 2.7187955941026627 2.5059459606942251 -0.2418839066939788 1.2866191959589031 -9.541523495007203 2.8308337952064875 -3.6825099967351118 -0.23888310665555554 0.060812793872631721 3.0528285998978979 -0.11746620327195256 1.8930532353943719 -2.0670002301960539 3.1683626810946155 1.7266531909559544 -0.18858089749134954 -6.3848599936269101 -6.1937785471170246 13.315332049336577 1.5418957235428021 2.9049777127512462 -0.52653760039702302 1.5309389652887377 1.6345727784729627 -6.6557369016542234 -4.9444727555545889 6.9587475221676316;0.45131753345394693 -15.582619560816264 -4.4704619330874271 11.162942361599038 5.8092311981042899 0.47075476381911846 -2.9046268865047233 -7.1523704307360969 6.787391809505479 -2.8355264930742448 -1.6305708788142097 -5.1165596154051443 7.1141854435612721 1.8581083995630221 5.6408105446950865 -5.2219725048056196 5.4374788939861496 -0.83414990628054986 -3.7035833022119276 -3.2589646084237995 1.3713729939096795 7.3794270446805443 -1.6268643262613922 1.1930096233692848 0.35576323052339942 -2.1875426510949705 1.3465524803829643 -4.5890316401658415 -4.4633808832969564 5.9521040843100446;-0.22635242403857692 -1.1918221830154254 0.5433840167016466 0.36234134923187244 -0.59967354284005403 -0.13148610305879369 0.22666177080039279 2.8728629468193829 3.5435699017828552 -2.3444087930809259 -0.95124001467373953 4.9961571070307809 0.039200076463527772 1.2128387862386081 -1.3353281831452692 -0.047077096665889114 -0.0070642545525008132 0.10081771991368535 -2.2540661996913016 -0.019699390847026106 2.3305225347527667 4.8854179867948488 -2.0655184896784209 -0.69505048687402549 1.6014949796371236 -0.050723057310377136 -0.54707849633443917 1.1662603539668224 0.34647635906488172 0.4533985579921887;0.2992240410459866 4.1136458455730756 0.35673175411676122 0.58762443947839793 -4.509743910919334 -1.9500398619746282 0.92187648799316702 6.0198660923595018 0.51468769936290737 -2.8226372553998775 4.4592956085945099 4.7363966216718341 -2.399401498400485 -0.99278875244499643 -0.83571251053566709 4.0673555205338143 -0.054846534361559944 0.096999295939393188 -1.2236228080364948 -0.32831454546865296 4.0780257494646639 -4.1237497802155891 2.3458172694434491 -0.12193714997446765 6.161093326381228 -0.17507118649929604 2.5518507767048835 2.6524100944234847 1.6604638848842648 -1.0339999412943865;-1.1586147415364687 12.711904364153007 -0.092859611410634257 -1.5047356120524948 0.60493830278732974 -1.4101402034642989 -0.59004083089551018 3.0955810550894864 1.9153390354588189 -1.7521482983859404 4.9060528636983323 -0.86998116353538679 -6.8677927649883728 0.096176185413193657 -0.456876046158323 3.1504510213095469 1.1174200268265562 -0.85008272062289536 0.20652144508866349 -0.53896381297386475 -2.0959086186494331 0.52028570886495418 -9.7902722795012078 3.824363254930685 4.446587548488389 -0.49493606793235556 -0.48130574573114598 5.0709745481715629 -1.2556183718311267 5.1285420942795463;0.1760551094669249 1.2065387202420894 -0.89042408370361437 -0.34358149571914098 0.657421244720368 -0.33719437937118779 -0.70714044358721673 -2.4459518975910686 0.22312614145244009 -0.53251192235593758 -0.56670361004646785 0.62348447544913244 2.1156811682085848 0.34737034434991743 -1.6683607740416688 -1.8962151617753429 -0.10203162748814792 0.22428831894301976 0.31229048872184967 -0.046514841905892598 -0.81007484149428399 9.0550035400160684 -0.89366831712841288 -0.096935083188500942 -1.562872633266315 -0.025722087867924515 0.15274179457034684 0.53995118348029436 0.39047089095888532 2.0554682590470255;-0.26661027314570973 15.454545384793663 0.88539658295369217 -1.0605983975455968 0.35205595427323039 0.19761697717874979 -0.67931716792133212 1.4570759519510741 1.5444950005768343 -0.66616129390295575 -2.6077695820056301 0.65847648382488078 2.6062119090038549 -0.56579285394809253 -0.84266913555084499 0.47745048685884101 0.35645057793932805 -0.5350802005111065 -1.4811980915617198 -1.8590566171318406 -1.7262708328739225 0.18624675085165684 -5.9518608314110422 0.83114545621946367 6.999249676813899 -0.3351405758450508 -1.1461754083263755 3.0686332488130548 0.15669191238540581 0.72697355039411415;-0.25266596981192979 3.266662563366749 6.3553031535949609 -0.25761087627063101 -1.3919248682161318 1.0394335475538945 -0.10084289810396561 3.40082123686688 -2.5316421281914248 1.9560701119689685 4.576682459828902 -1.3763507730069482 -6.5957613026852302 3.6825041444512383 -1.1759639809773146 -1.3120044739895753 0.017750404566172735 -0.32340319340720225 0.90914023356449714 2.4084715102133418 1.8543128291203206 -0.76248057227545896 -2.1894610721813401 0.08036806406375073 -5.6714396358465864 -0.3380818086503008 -0.12529992819093391 -2.1565351638189991 -0.022625805102989737 4.9190313509889503;-2.7390104450145536 -2.48658689867244 3.8682681433870707 4.3793869709488815 -1.7510756301079324 -0.65551220080988981 0.69563815407822982 9.2064526820746035 3.1887723645971726 4.1483342021190417 0.57661513848951262 -9.0101096948851875 2.8066792623574557 -5.7376995370671242 -3.996089832870056 5.4500492953979398 1.2891943480239811 -0.76186483914126291 -4.6609068404185052 2.4559661392633645 6.6224552957911849 -6.2968846884849565 -3.8920580274922676 0.56759095155648043 -4.8801503492645883 0.63300196548246801 1.1021955140399264 1.6075723490478446 -1.0900091758110575 0.55845065277000783;-0.096051050129512539 1.3680035540532265 0.99940762007296924 0.15040124155906417 -0.02411166677294637 0.52614284840958081 0.10626852700664188 0.30884719697010732 0.17475337323050141 -0.019384838286373093 0.51588213775214786 1.9554873318629671 -1.2877680559697182 1.4447884293130264 0.26533158300984849 0.16219346356583256 -0.078409392804952835 0.061639996962064771 -0.15717548147724403 -0.095389071177890417 0.36740236387040021 0.22480495212487239 -0.61858921606690165 0.072766506496893341 0.24144973078061843 0.0018149724922040052 -0.064483859458793105 0.1082523834126064 0.12413996744880434 0.10787109153077558];

% Layer 3
b3 = -3.6768565475058295;
LW3_2 = [-0.015610184492970053 -0.0060825908320972675 0.20440152825519561 0.062028204641624847 0.039446608553522125 -0.34995500317868011 -0.2125590346719185 0.11408404985804932 -0.02305193274038286 -4.7129909808761576];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
