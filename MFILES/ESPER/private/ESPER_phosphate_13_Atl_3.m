function [Y,Xf,Af] = ESPER_phosphate_13_Atl_3(X,~,~)
%ESPER_PHOSPHATE_13_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_13_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.5912077022495290102;3.1337314779552891686;-2.2105154783147780151;2.6127764617884388088;3.0440312018953461504;0.1189476784035747442;-0.69027489214429282871;-2.165007579279308203;0.049212845921613429523;-0.29314548638138182568;-1.7722016332462626753;0.38902791894971766595;-0.31905688596924597356;-2.4024365447222431058;1.2190235912058233758;-0.95379936847156954194;1.3129889299513388679;-0.014174380675956579217;1.7771089596075047012;-1.4921448205428058387;-2.6328792811205534719;3.7342180768444674932;-2.1235643870245688447;-1.3256480179225198501;-1.0072153240044390277];
IW1_1 = [3.0777019954370246069 -0.43021368253648939461 -0.37783441523225635983 0.25813023705831883436 0.18599889997269369868 -0.91219375190456830627 -0.8006582249781585281;-1.4612487594010841185 -1.7508183468260676285 -0.68702787311616242416 -0.29847872369848621465 -0.66285329360929878817 1.045491170218430188 -1.6433009603573003332;-0.69814107066091701803 0.43042137330860280597 2.2983314162633714517 0.51074202044322736249 2.0209205303544819365 0.8500568873518029589 -0.23918706287860047599;0.10606224676243256044 -0.063719761827375653862 -1.4203613100679657322 1.3130128355477201918 -1.787418599756327886 0.57703004521797951476 -0.89135807066655758923;-0.35288882151483813576 -0.085095960049818245019 -0.75030372512279008834 0.072255423379965683095 -5.105806256969655621 0.33990982075891873482 0.74496372505931895969;0.45369743392288475192 -0.086880146957595577595 3.0830034188339143775 -1.3185389594167147287 -2.2698936399555993404 2.4377734680514264731 -1.3299146281389306878;0.61599538454990543368 0.4296345317019842347 1.4740769673874372092 0.38431743621152919532 -2.8469141569412790282 -1.274664764212028345 -0.20128599877686298436;0.88627533566873717419 -0.5722313925708187865 -1.5091698773452131288 1.482465342003065123 5.1267203438330817278 1.6033999504245577405 -2.8370913179150858419;-0.56113974546942257948 0.80872105843752284393 0.38167795296527651239 -1.5336989225289314742 0.18642646542508545249 -0.21785544042718230084 -1.7421695133629182539;-0.82390061200600728242 -0.81532246238135686056 0.20882629968819951816 -0.86625054198208650824 2.3752732035377817077 -0.42507989940719764776 0.20973594103331158478;-0.74565989370458263252 -1.9317351050072797403 0.6715015844874365758 0.075377559797064855318 -1.0981993158806786504 4.9201826099602650189 -4.9184292446311292935;0.13639089488531355721 0.45257820151971583922 0.91339110130636336216 -0.29461436600492668658 0.51947091918203114336 -0.93945111766837918754 0.13258597341432534766;0.14836304342317135907 0.033376065611605804095 -1.0272177034310190358 -0.6931986443391742192 1.5448978494503091685 1.3952373914497808727 1.0681187999900578767;0.38006704496836646312 0.53865708326028483022 -0.6761364804669890427 -1.2212134316072229545 -1.4861225525169190487 -1.8680721105141713245 0.19278337712450613339;0.80660699326472728998 -0.42015924915394492478 1.2757352497358387389 -0.26254181715596930369 -1.8419468290780958153 -0.2335714218889366478 -0.52956591488194959538;-3.4105987609032530905 -3.9435801166934658646 -0.44988749021455581856 -1.0570059322431601956 -1.5568431226170775794 0.81776870461634232345 -0.46843072339176533569;1.5937624507955385766 -2.3384707709597001291 0.11752909230052088763 0.6921827394114613563 0.42998963493605796282 -2.0109417915019371925 0.85113310093080685181;-0.43103304910513662307 0.40631322107823480971 -2.3375606989149577686 -2.0612620134211105949 -1.6719124996965528673 0.01521936170560101928 0.20452763907329352122;1.6646191533964336262 1.6168349160218760119 -0.90895840138999317581 0.33560390046233112837 2.3124996310789245335 1.1474174968301271704 -3.2871535570428194184;-0.53781493731205121112 0.92786980002233532261 -0.66609760693372821461 0.12429894280291156616 1.0721046460190817307 -1.7361118742918932867 0.52678202165010579172;1.0186450550365775403 -1.2496117319878412566 0.24652862625057836432 -1.8985451452792705407 0.3428330075492009299 -0.12616356023678829135 -0.39493012659562665156;0.99853690992288690609 -0.51107988132281678695 1.1533346402888930982 1.0567671504534688065 -4.5514774898652801127 -1.3315489169202872066 -0.69800737290844216965;-1.0698628484165662034 -0.49766553922244721742 0.043601790741824832109 0.47527253615536968478 1.5891721503673776894 -0.35508873176302069297 -0.33796345352337220369;-0.11747809609559499433 0.19258105255942947753 0.95304273975735409596 0.18818313055077762197 -3.1723422129855838314 -2.2275941573287534325 -0.027880055873780180964;1.1066744331221596287 1.2343797641377718399 -2.1268664038527398397 0.514198404530691211 5.7352560691793561531 -1.2519399272208326934 0.28019632509528613618];

% Layer 2
b2 = [1.1722942108397553795;3.2063522032574378606;1.5005142072041366408;-1.7928107130337982422;0.66776035901498798086;0.89676170234351915145;-0.98660538009816101113;0.87280718561459857963;-1.0214128753858184862;1.9858238716581881889;2.0049059508106514826;1.6844920022219094236;-3.2991416603279311026;2.6915447131725964702;1.4293704786693082198];
LW2_1 = [-0.081261823177038589039 -0.25560038863770412343 0.27387576613917546942 -0.34330188238045977744 -0.77356864768177791003 -0.14801355181464645461 0.14362818540459035277 0.19151008314801845622 0.3414220664607801603 -0.87746460229379130702 -0.58383399620911602401 -1.4715251541719347461 0.1690275276706234564 -0.0064977910057485380874 0.26541498359704918109 -0.029219820154720896332 0.46119386174635879083 -0.16219196127458757051 0.038557709037346579728 0.22708263387639210373 -0.37248836206801233528 -0.34977357247364943005 -0.19204062111568126481 -0.064361119351909648612 0.53855383545038859605;0.37300638111010592235 -0.034183415004959250005 -0.91530976356893922752 -1.6978425031243589149 -2.0291427965073860484 -0.8161156140720100538 -0.79324128296427531826 -0.19593739054843126168 0.25211308303972418399 -0.70202607937250971482 0.40273323219285939167 -3.023295375179965383 -0.81197217983751857062 0.1282775492559736219 1.1894467766957241839 -0.035773687700670270262 -1.1245522981630722281 0.45159446920452644969 0.31637562887838421855 -0.82067738763537501079 -1.3072801136728355864 0.37136722658732901348 0.27604015310073964917 0.12009963888948814448 -1.8122898690043518499;-0.17669890628729531534 0.67826721210019602637 1.5877458274095634927 0.0025120442929260477366 -0.44690121084334305523 -0.79160598972576712296 -0.43359835163867532781 -0.39792542452756679561 0.1906252140530623751 0.13772448055923899868 -1.0130708888324759798 -0.05125121517597270443 0.58896577796333826615 1.5825047991973695272 -0.4605755321177074646 -0.0038838043348230445392 0.97142424011009165241 0.42022594273652214003 -0.27038751090433199575 -0.85629937879136985845 -0.12204188082907202473 -0.62216336680251960178 0.73615048008021954917 1.424861041199500411 0.86682006938302536003;-0.024503579235173131995 0.16976000594338666594 -0.14649113507774130793 0.28975798177582451354 -0.40331251632210024516 -0.086929051694326062161 1.3409872765874653044 -0.87997159002292246743 0.68917261251785433274 -0.48984817176720291121 -0.3699807425349077028 0.90198592094255491958 0.30995182159626649687 -0.42420164766155782354 0.79904807724362980625 0.05439924472332605121 0.14624417989864127443 0.010615225719448544844 0.36975394532862110308 -0.90583058425114670875 -0.34306743634734432336 -0.23103624768942976342 0.21236440756230273719 -0.70695193659685329202 -1.455784575163268757;-0.26836963349488351938 0.18155121214973107824 -2.1861331704785249563 0.80470449493513040995 -0.091481318345061332642 -0.29749247049768051676 1.6181522280815863191 0.23034527292444306745 -0.30589736322877447705 0.29633314290666273871 -0.22510523866945339466 1.1677931144931594787 -0.33234031286018284046 1.749314933047068088 0.81941615713358484374 -0.16139635968173099423 0.11880114700093197255 0.73298371148659458019 -0.84196739991324320851 -0.55832528917840185123 0.14700877352763305761 -0.2213688708051567422 1.8484736978750915259 -2.1631618859864971682 -0.90139963743222151216;-0.0837753905392939896 0.79687299481502826826 0.32862725821413923954 0.36279695629273323032 -1.1482926309047420954 -0.56221008783458947811 1.239127780876645879 -0.21585163702869444857 0.090861107406260924191 -0.4222512225606657732 -0.19507923768951637711 -1.7215270687525927595 0.94570390179946661746 0.15008049242427035086 1.5246501188799501669 -0.041661298883829314676 0.075157673648006781408 0.36284673233871944653 0.016690225469931225383 -0.079721680715607021184 -0.094726149167197307155 -0.22129628418348146202 0.98226547105697437079 -0.47189254201859703874 0.097405931391580061196;1.2032827383465531934 -0.31130009646312417626 -0.90311877795037720507 0.30796077951976152942 -0.12577114994439003715 0.15003915758674249425 -1.0420577559546118085 -0.27312331267712730565 0.17878306054049852847 -0.2681786932891576658 0.48336545347102743975 1.6330320995344371759 -1.2477402851512615634 -0.062428068334479114299 -2.645959467366602702 0.52924023699251832031 1.0452627984461488886 0.10563768626673925022 -0.6679712936316103411 -0.92557407868831986786 -0.89846317715498613676 -0.50863297969227638795 0.21567019171129492294 2.8310822683948955181 1.895040608773098656;0.72744824655752005071 -0.31595352328067199954 0.53604774075525685184 0.57479921528624211557 -0.1138249207539500929 0.84497883413858176915 0.27477866824612590113 -0.079928505760288343085 -0.25604404881823200624 0.35443593540046358648 0.30186689388884324625 0.39419496588003566373 0.44966967393768647598 0.79027007263638737733 0.81509376611912209842 0.13143572947412887619 -0.2149349040417783685 -0.39327138039054321261 0.36306560689530942287 -1.1400187016174128107 0.25521349260478659593 -0.670788181518940263 0.088374545385602354397 -0.29031469395049780413 0.1490017872383574693;0.23075431335590892989 -0.24741347659850373986 0.71947849756020021417 -0.52619456012391563338 -0.50572395801129865767 0.27679203835025845137 -0.83318463800728770341 -0.11947170705271761837 0.027962106722865337494 0.31714914157965462538 -0.70434793302344822497 -0.69402412296888027488 -0.29159669329926635184 0.047876289401748095553 -0.5519579827507825609 0.028067946920901781782 0.50625169532548885964 -0.060186725583251020344 0.11050647829913916309 0.2509724692679870528 -0.16315320250916495737 0.11289777540999169914 -0.52162381763324527917 0.97324380613795491435 0.84253370941346339418;0.049146119462322529481 -0.17125131591873821169 -0.46520182570570545177 1.2938923625645271098 -0.88921380142067429908 1.1781652827322532939 -0.143025191455071643 0.13231935243441184102 0.42516675436711659497 -0.27274818251760019061 0.85837608432685297277 0.80748257711237458878 -0.22411357264414641377 0.11664995941675962432 0.45857392014891090737 0.1972682686705787003 0.55377784527207551957 -0.25482921777635375582 0.24328141762040633722 -0.87677734114281147271 0.0097532264767656931537 -0.83050915981763961948 0.71305760897487824312 0.94332317655461017658 -0.40843113829320659702;-0.48351749482974470951 0.030299250997173093891 0.098514689582777426047 -0.34176639745997344777 1.1641277786602082234 -0.17119905447878036586 -0.30544516919168351876 0.3256864154052176441 -0.2329455388686643702 -0.53707333501078446947 0.23978693282455040836 0.59732146168500710459 0.84223536417770838991 2.4666607976533780899 1.2117687470543136996 0.058167464783562675135 -0.18102482304687739223 0.12570165170141059385 0.42532201357672078101 0.69506716704490068004 0.678151445042037615 0.6994333318318874948 -1.0572064205253766112 -2.0819672750007818252 -0.9507158470917999038;0.052885027664617098586 0.61727960495390410411 1.3555231475488371817 0.41716345620754141654 0.56233403628692457676 -0.069365545806490958025 1.5481386422597374075 0.13587344644002344318 0.74931386187471171745 -0.55200035729551699681 -1.3521941961113201902 -0.14456681915699842733 1.52888765229902579 2.0972687632148772074 -0.59832067197467742048 -0.13867402919773536007 0.86417379092671764429 -1.1561298414470837503 1.2460866416922082855 0.068101136065588180335 0.63821785318358137395 -0.7160550471530879868 -0.30433046839857341714 -0.6480368659475973514 -1.839280931045888412;0.16149920857713725986 1.6296535063904840079 -3.2804757935466208885 -1.0399127846579914181 1.1696033286363458625 -0.5971211823726517709 -2.2429862960039677056 -0.36249992621027254946 0.76911609994700680382 -1.7999593261323671989 -0.85879159277070871159 -1.9030895315377027721 -0.61531271418177546639 0.096791704520301710679 2.7552469549266702664 0.18024658319106506843 -1.0199871540034199935 0.8103127855131750934 0.55572444631823658678 0.24849083693685838914 -1.9214606555215025807 -0.42009168312813988111 0.55270387230570339199 -0.16151384758449377488 -1.4345686571003566367;-1.1785600144471182205 0.19661235625452205822 -0.68029370602505156995 1.5647732091791430875 -1.7830980812067140917 -0.17625662867764380071 1.7630221450550822571 -0.45315341360524968861 0.80924889700787772107 -0.80838900302014238264 1.314708209890798063 1.6773291054057530847 -0.2313944008997439461 0.35081808594845215188 -2.0842688420805703942 0.12060530323157268862 0.040780277086563648803 0.018585232149543426394 -0.18125682576802557011 1.7516080421470314743 0.036984300217164159386 -0.88216240214688190768 -1.1531677293823916486 -1.2164326669120515412 -0.28074584067727170744;-0.39707556616362837953 -0.85262910709351868999 1.005028281864634554 0.093615826470092408651 1.0085614117383694399 -0.22772415540536944389 -0.94492009236156360164 0.27789868026600461626 0.28398018209637243547 1.6142779352607634635 -0.96364121649833300864 1.2094109368107366365 0.13194532648648860107 1.2482563522448053561 -1.558914419170033705 0.24179685717625926111 -0.099621238164324374398 -0.56203374244400416959 -0.6431915581734536369 -1.5568647672840214558 -0.016424278966618566927 0.18312481664364077538 2.6958967591379927597 1.1688702225558367243 2.8606490785950331457];

% Layer 3
b3 = -0.0172246281319004442;
LW3_2 = [1.8754585618061365704 -0.3006495918285251312 0.46434546259377679212 0.37268940619305274131 -0.2581878608178699297 -0.95645298093989450372 -0.31966456578560326074 0.31467779740914192388 -1.5008287116272849282 -0.35850399646779446128 -0.94459938225533279788 -0.23504825059366041273 0.26165599482058254921 -0.33456338076436265005 -0.53897004239002854753];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
