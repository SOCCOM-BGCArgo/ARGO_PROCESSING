function [Y,Xf,Af] = ESPER_talk_1_Other_4(X,~,~)
%ESPER_TALK_1_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.047339774664977262;4.7224130376199698;3.1432085332314226;-1.9971219671778764;-0.83624176096755887;-0.60009724442351198;0.036163476761449098;-2.141859886848152;-0.38847568524631326;-0.79329683187221189;-0.70976782579157949;2.9762542637258456;0.36213721923073211;-1.9432706513209981;-0.25038915102995901;0.64128269966307028;-0.42843845162770017;-1.4377500302260973;0.86229103537334117;1.665225486188991;-1.8236289093493052;3.204332603178254;3.0312423952303384;0.83490840863281623;3.376017993460485;-2.1190647828289082;-1.4163559032177129;-0.63037684404798855;-1.6117176299527642;-1.8615354507583908];
IW1_1 = [0.10637610792679532 -0.43073129143811423 1.4484583134193985 0.21030260015961993 0.059691088211598679 0.10075588408989175 -0.46703587307332856 0.83664067997339653 1.1353922464633011;0.037184431829643413 0.47710534532173177 -0.72370900611408329 -0.82173949950607261 -3.9468832149137989 3.2531728563517532 -0.54561561777033052 -1.327894668523357 0.40688724809276494;-0.88843671871053831 0.50541973080792646 -1.7483782464970596 0.30579782342390988 -1.7962530958988903 3.1102795367684322 2.6632955525954651 -3.5890884182439211 -0.83190642561766759;-0.78570690325335246 0.4047164058479652 0.79248436682433532 0.15714265781823217 1.1528866889409837 -1.0419589783509118 -0.89923930328090651 1.1114046091752583 -1.5815004965691721;0.038029102658514898 -0.16903637108548458 -0.75632782992758008 0.37611073951108231 -0.10374666693195166 -0.94118511065703736 0.058847385287338731 -0.35694650430806957 0.24736946733633583;-0.55038279998953488 0.11688859251104984 1.2592636352104354 0.38819382937683894 1.0462532166960758 1.2006933381678651 0.22159527630575718 0.67043019315835162 1.3548623977999719;-0.35735752908649732 -0.28060550460307454 -0.36343418051759963 0.11048343356659115 1.2838905009013326 0.21811890905858389 -0.33412660563751223 0.90568326267365395 0.51861867280352036;0.046752513087052791 0.085768172298329115 -0.028904042500754783 0.38715600253096022 3.2226414240744097 -1.5368949640329246 0.33219205930453233 -0.68729252821147546 -0.75973703762749256;-0.033781207150423494 0.23110240851865993 0.40575965557869947 -0.17583957646728962 -0.28729069227585613 0.9149327306873869 0.34923066249278562 0.53967854053201159 0.14256636169326603;0.9338837518249683 -2.2039233652623995 5.153993035565164 -0.93090551174577119 -1.9563079196025743 -2.3217578996767205 -1.2662196862156434 -0.1148371918972497 -0.58227355481914467;2.4356856477608062 -1.3153023682546583 4.4682486016537633 2.4870463347353682 -2.7719924653086681 2.3474493901658167 -1.0685436395693177 1.2637026391790351 1.5422154161532349;-1.7075128065104823 1.9219992484831836 -2.0605898504264104 0.7493264069802813 -3.4177743870047923 3.2879219069312451 2.4782060927115253 -0.94838777051132617 -1.1240041989580629;-0.23736826101331171 -0.19271550221290298 1.9952939735563562 -0.89027716449146499 1.4477646607145138 2.4236621184810723 2.9732613845222433 0.10343220283438755 -0.40029603216937637;-0.037887689236647981 0.25808963008887936 -0.12985907964129451 -0.01205276939266599 3.5500823096479777 -0.96405486932632312 -0.085675049998637259 0.75022068448618873 0.1598865434743349;0.15965597155158698 -0.25780504965104745 -0.82681633995026682 0.14157334126836565 -1.4023474128020255 0.40580622738490474 0.0035228515311636292 0.026190810847510598 0.52708667770687001;0.2258662469180345 -0.81665770325685294 0.8489005250228514 0.31743143877108115 -0.15840538989974401 0.88258823678896925 0.8855933189123919 -1.4634690074082231 -0.12999037978234693;-0.87488958853454191 0.22346204083711474 0.75989295078798191 -0.65762776877698448 -0.12765478418555426 -0.033323939517029694 -0.56663451661791209 1.0275869822652219 0.554852124925309;-0.3878045108915758 0.3390154939087745 0.58573500613145169 -0.16947578211735864 1.4464301879805184 -0.89698471857388062 -0.30301782446854253 0.57226003932926672 -0.40779612572031848;0.33980530827077521 0.1624544315451607 -1.3150747977311039 -0.023195572147307306 0.5605527288957235 0.07605911631994744 0.65385387876645951 -0.64766401098707693 -0.49782243116267894;1.513246456519403 0.14935710907529923 -0.28465032291050418 -0.12975730893914605 -2.6140779587440997 -0.58859568328416356 0.18769749316018089 -0.45758276674655357 1.8743867710580813;-0.12004801715205979 0.55172223228675021 0.14241710296063451 0.51355529457155435 -2.0928832545954292 -1.3145449552074446 0.72547070496540755 -1.1626299070931212 0.57566566111502637;0.15584787280183415 -0.34747587365012772 -1.5181906615988345 0.547691153793889 -3.4876965333243013 1.3139652369910886 -0.7624968292364126 1.4949693278952323 1.008044801327689;-0.49645997766429906 -0.71895534426429741 -1.4123837340894592 0.26123127756241865 1.4385726609648422 0.32136870617955388 -0.095941153246710792 1.099882656876974 2.1482600650213999;0.9706111458694151 0.11095218923128425 -1.0694346555314436 -0.37584479943909671 0.75226362383679712 -0.022165048088080574 0.45026176377600269 -0.47787985152912266 -0.5147523932519249;3.0374189031786645 3.0867146384792776 0.49555623301708884 -0.17519917354343095 0.85207948815218992 1.4597183152288089 -2.3583543822381716 1.8118879487905508 0.096793241135950989;-2.5735549563327589 1.2443805055638864 1.1624082626937986 -0.30070802129826046 -0.44919019968704765 0.40409937744081015 -0.77615877339719663 -0.93717192227580992 0.78278120648999039;0.173702059138611 -0.063866362691620493 -0.81474354179110242 -0.14158629857413496 1.0917527185449705 -1.6736034652234548 -0.27207655717589518 -0.94070491923001021 -1.7218661994628666;0.25225590982998702 -0.41820220930509977 -1.2514335036286257 0.27794806311771092 -1.313420578199374 0.76238689715904151 0.19229209933264568 -0.43374185842042084 0.44728691312364433;-0.23742436185861923 -0.47568549891822987 -0.74273834169750796 -1.6330959286517717 -4.7819497227095562 0.84649028641544855 0.10492895111991135 0.64597260354427255 -1.4351878105504647;-1.1916651690716411 -1.4674883958362921 -0.26587829933629581 0.75340551466764993 -1.1558564621464411 0.05459083508624922 -0.15701027150077457 0.18691056684160659 -0.97122889096999643];

% Layer 2
b2 = [2.633104196549982;-7.8155648478051587;-5.6307891530924454;-1.7450652538270679;-1.8916110692824777;0.61430165923791025;-3.2023120761132033;5.8244665150517294;-10.561323834343112;0.72704431371490319];
LW2_1 = [1.3445077698952341 -0.41936103434637068 -0.29143683115199914 -2.489585725027526 5.1646601246434889 -3.2995799243622415 -0.68278391676252537 -2.8546239942922562 1.7871576195897032 -0.43310032552947303 2.2580119487433437 -0.42553841790208846 -0.18789118805632604 0.31078069826653626 -9.8166655643640706 -0.70516253875500134 -0.84576275486953068 2.5634613700530244 1.7395166889988083 -0.70651502374451136 -1.5052874397446876 0.4151812946079097 -1.4029006007484184 -3.1195661684949942 0.18009795707114898 0.26774258173153748 -0.35002847367694984 8.9321204797948983 -0.26634128394514306 -0.80671099630644816;7.065278539442704 4.3528387431890305 3.1444657898453503 -4.4081887900597376 -3.2653252804777675 -2.4159342491287057 3.8217352337966854 7.4004495865282838 -4.037697684665023 2.2021035788901955 0.59567151683711794 2.2801720395647802 1.3823727585140615 3.9873733659610253 -5.8285186209707405 -1.1037275738092913 -4.6738684143437892 0.89505718743380602 4.3996538696468175 0.14813342163864032 -10.96632458706112 7.6536816250893311 -7.1582529361451117 -8.1003018700323377 3.6731484410847499 2.815591666854115 4.1483003994213936 9.6770292287884594 2.2247728009201913 -0.54288107627051541;-7.2575300108628094 -3.1574545957938147 -1.5014144536586937 0.33502943251717276 -1.5610965726050319 3.9638083539985915 0.43819202581265998 -0.64169619935811784 -6.1919916955083343 0.11694616750213303 -2.4755402306705188 0.53062667158849808 0.16901003554259389 -1.9073177495079661 3.8426288599516205 0.35167532840654725 -1.778609614060833 2.187682309882919 -7.4687515385757939 0.16684182242463588 -3.8341848213012706 -1.947785030838687 0.70113833807329629 4.3608785776155674 0.17552136861350753 -0.70250516703932708 -3.740069342444035 -5.7206832728347132 0.35204098076565632 0.22027892922899606;-1.9205787215226608 0.37316696732296489 -0.27433381579004906 0.41672757454140208 -1.913007169569156 1.1958512281940021 -0.65311839268154925 -0.48604308182742195 -2.5712652809512107 -0.030796236206946721 -0.49763705856876644 -0.0014508318651499401 -0.057625572110000578 -0.033383163941054984 0.10422823058084696 -0.40320458517946567 -0.68429330438654012 -0.33227177338258335 -1.5831309926475798 -0.38451370520572353 -0.35028934884683827 -0.88879214667716355 0.046004992870635183 0.49126484527453657 0.19627058491924737 -0.48341358316623279 -1.0838996698566929 0.79119325385408168 0.33448147928541244 0.207502183710148;0.60723122117484218 0.057358623232282135 -0.10135613222755661 -1.1553263721962819 -0.70277439354853011 2.2571481862203928 -1.8239442451853789 0.43658330385795174 -1.5606230876492782 0.13705639771573938 -2.6785307898679189 0.46990249317382277 0.048515965928389589 0.19724991040874279 6.998550520995626 1.3280504865201979 -0.42494581588260283 4.4163135016449671 -1.2926178636801047 -1.2684674121020834 1.3434622155244611 1.9761581633160226 -0.49273204657194403 4.9480979487321521 -0.11267605252602159 0.12503204062259735 -0.04175295668994454 -5.262273430045477 0.17472019893193821 0.77580317469977012;-0.036627976494200007 0.064994199512132075 -0.075019729609634281 0.087619035588966915 -0.090023329042829919 -0.26827075778684001 -0.034706925960206921 0.22071409559613461 0.42099644147845977 0.010857505224360839 0.041006477753017891 -0.00045991373580196759 -0.042914151515472482 -0.20241443070454998 0.84209983034483804 0.12826369086883829 0.099258872208598192 0.15411724539355412 0.29471221989388446 0.15284759475556187 -0.059154566259522083 0.094844166043018902 -0.015400347564664423 -0.49489843155367119 -0.011844217395913809 -0.032023135150561405 0.0881982675453159 -0.56661579296161624 0.020343695542003947 -0.011910228264264673;0.88758903223949337 0.26555090761862893 0.11802123522324905 2.8393551766948737 0.38047212814057113 -1.1921745253035541 -0.59069083589632954 0.0068592581794634511 1.138670876191114 -0.00021175751578625154 -0.92536358586643397 -0.16849023764486587 -0.22354036249213563 0.32834770219294807 2.428217984516265 2.054340701962063 1.9417387351598869 -1.1774230421158105 -0.037612182910677673 2.0410890866200351 -1.4367283331319756 -0.45811092842735762 0.80101934176400813 -1.4556592045932517 -0.068407584459555179 -1.5361308059654046 1.4714606228592699 -3.4744977540263009 0.030197370409498478 -0.89955375615956812;1.0974830109802876 -0.11439557500578658 0.59636867235678548 1.6579161253008534 1.3380801441557852 3.077177371650416 0.74207560404425488 0.3746893671967213 -3.1951713394303733 -0.47226456810113565 7.4389445971893178 -0.47342884657143985 -0.22750811676654401 0.1558139703898701 -7.0834378513622367 1.3002866136125586 -1.0638678232504555 1.4206276229814065 -5.1783440970557244 0.87782440729807742 -0.40970226763028106 1.7228238067977115 -1.3473400171701346 7.1139038380442292 -0.56106842064864548 0.15955657558805011 -0.61597837578097181 2.8577882057492938 0.24997878758465242 -0.25287967989918869;-3.8064787803401203 -0.78538280228405477 -3.0522570702162044 -0.54741126931035811 3.877271071988746 -3.2602668949995812 0.8631728030408613 -4.5746107992104417 -6.7174395472602937 1.6889655321836303 -0.74731123156768553 2.4315067810662181 -0.18120698238315808 0.96188857766435132 -1.5191709122932919 -0.27234693505613344 0.35357928557186447 0.22367793434338254 0.43572254063985488 -0.41852529644855513 0.23999831356791337 -4.8179264290651957 3.0345168128869258 -5.1094261511725758 1.4625762077308293 -4.234693435316176 -1.6093641680272179 -1.5829650745225878 -0.51653815597360353 -2.2745888015367299;-0.39811032391595452 0.720231986414405 2.4450826420937641 5.4821816182389149 0.037847355320676762 -1.3117909087007955 3.0769713220245141 -0.61418945666930003 1.6997972354753315 0.90961316396494318 5.3378454753176916 -0.94254032021651291 0.99022323797785994 2.7372858388917849 -2.1159149849507339 3.0967023616291534 -3.4836911366129306 -3.8667544304117412 -5.939982359993861 3.1872964469271818 -0.13588314867235385 1.3049817652189009 0.43092340728572154 2.5100055181629366 -1.8485230826548855 -0.31021671878949281 1.6521890217002906 -1.8505488731260114 0.60097442558210112 -3.1531058688574354];

% Layer 3
b3 = 0.87466744542483932;
LW3_2 = [0.099860113846719348 -0.010878433548242732 0.12354152377681936 -0.17590317572551337 -0.11133015591581433 -1.8862591634011574 0.077508382897089514 0.037909957288591631 0.026573301614743399 0.019669627569305501];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
