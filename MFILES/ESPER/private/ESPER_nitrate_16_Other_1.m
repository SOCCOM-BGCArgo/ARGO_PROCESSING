function [Y,Xf,Af] = ESPER_nitrate_16_Other_1(X,~,~)
%ESPER_NITRATE_16_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_16_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1866990331394402514;14.280620311925531496;12.412004960057926084;-8.2366453740537988182;-19.66200388721059511;13.936914711439477799;1.1802583624762079673;6.1607356632333099;3.0561480258603919147;5.1867079179324822036;-5.3270040764408745915;-2.0138658685359236422;2.4325491260758766998;-0.78515421464982981803;-7.8491290196294309922;9.8945708574967312643;41.550382490750898512;-0.25333770949012335283;2.1210247213596131743;22.694914763030769933;-3.5028063042111856618;-1.4994308253681989385;-2.1317578308316300628;2.9890135052445101493;3.1635154104397495978;-2.3864465364943603376;1.0482275838253789502;-3.212645551978671854;-8.1771879065620431959;1.4835442106332743517;-1.5883198634850068665;1.0579194964274978297;-7.614502560640334039;-4.7588534336570402772;-0.27063296355868732279;2.4077001925321082076;-0.78804864480683056716;4.466124278242624257;-14.557154519722002917;5.1937568493041492701];
IW1_1 = [-2.6658855728901844628 1.306806359138707796 -0.27479207732790006391 0.25441566369750190368 1.6307624066686097208;-1.1636847540608423746 0.33572709638053860326 -11.385759534360246903 12.538615301839900695 -5.5817797295959508119;-24.807183108583668485 -1.3247227951802180712 -29.490744837081610541 -0.40406108920210165314 -0.15853382478478725282;0.84403351360317135921 0.5397832935111541719 -8.6210525562043542891 0.30474248663271519266 -7.6163285399274158749;2.6889553042826697116 3.8047067050202914018 0.5564890113688695239 -16.675396292907510798 15.310815883707205032;-1.1103775809591154289 0.29804992284132009184 -11.082716486620714846 12.242111045764298538 -5.2627174815564696786;1.1870278127613680397 1.0203271809113330093 -4.2078330655790407988 -1.5221707377166886488 -1.5209164343858823099;-0.51108364146151796792 -0.16376959811606689454 9.5385947281240390794 -1.0474938384425915849 -9.8700294730850224312;-0.68077321596081730171 -0.24868424404204639289 -1.340205817346042716 3.8647535431872102052 -14.003468278578861117;3.0369282916127446903 -0.5085321684413384169 -1.2080088222780915874 4.0524434192317118075 16.317713829894671562;-0.13320559371058360298 -0.3698204970283290316 1.476348824620531186 -5.8457049561325034048 4.9843323061346094249;0.053045672044945195445 1.2478259350783031945 6.5670965653711723675 3.9010588408514128567 -3.8010887904587957742;-0.028472119868313262164 -0.12544654550365272327 2.8247158180097056146 2.1854563723473834358 -4.7733596215550413433;-0.02481631527544628929 0.78999072307319095909 4.5580778992739947597 2.8032079492779233831 11.132102097620384384;21.210566744118768412 -2.3274394946946710405 30.009051856509913137 -0.35941841374808541909 -6.0746872158584164225;-3.0761278802755747108 -17.074719054293673537 -6.952746399575352676 -13.622641734972313898 16.378843656018737818;-0.38568087317341759324 -1.8853113860910615251 -11.946705553246419029 40.665318385048479399 5.7912921829448498201;-3.0492842320210327145 -0.36959593643903759785 1.6798268904506155064 -1.0795524956402899885 4.406772480433522432;0.24133100686173883376 1.061148199726467789 0.2428744860334591249 0.35312114315064535575 -1.9678596600537505701;0.30356585521661894056 -1.3693991350506127258 13.133318954153599734 24.534486939761634972 -4.096287996312205415;-0.016311800957035074017 0.14911974733586605413 -2.2747286215981055157 -4.4802855367495295624 -10.267779655506076963;6.6146923500067655866 0.94233606206001963024 0.73166620516907254768 -5.1582055937699911041 6.7600366236995341751;-0.101596102139866723 -0.31457813238081705487 1.1394416906503652687 -2.2583735244893121674 4.2651591036450122729;25.26214189542744748 -8.8399374245950355089 14.376517704048270119 -12.399084956721750927 11.425407597359278355;-0.39306820241893175583 -3.7778798633947179297 0.054029285123722438355 0.092889352848279607699 -2.083023248093072155;-0.091340828068498122749 -0.43098346426626177319 1.1522601763812494458 -2.6844290597524738118 -4.1706651877392033612;-0.53597453186984000961 1.4114916757401287928 1.0054942732128178129 0.42800434565816974919 4.0097884285330263054;1.2494467147130221552 3.821831053536942413 -3.9314676985321517222 3.1956710775427961124 8.2278821817821583551;0.12048059482636191975 -0.70819151390368184629 1.1252788657142187567 -7.2670150263782788969 0.22033296443243163831;-6.6042099684197479448 -0.93678147669300182443 -0.76380446885869746065 5.1416717349677263371 -6.474638376299903797;-4.1412446705410772552 -1.0536820140986560279 -0.20316131455793012828 0.21140396656039944778 -1.1850569880382950672;0.64170906972821328829 1.4297885651555435338 -4.8487242495451354785 -1.9594763005868049976 7.8485170054786888016;-0.36410965782752002795 0.41896472904206150112 -5.2257651003205554119 -13.059178280255387961 10.928710004094348562;0.37636057595001914944 0.70081691460001371841 2.539524976492601116 -3.4796449692323641045 2.0548675210808009517;-2.9162461637827519212 -0.33135554000570904831 1.510368404044641677 -0.96565702161677036131 4.2821706475732010944;-0.039011162219876834023 -0.091575399909874649618 2.8418218269692823164 0.40676018471731628656 1.4851153776607557422;0.4727286385099820909 0.025151861141986496528 -1.9442798171260311513 0.061861513194274735106 -1.8881285220156975857;0.27355465728222783106 -11.552123391061130064 -3.409517419402483096 12.307573458841309488 0.9138633775751049404;-2.6948700568762462559 0.86561632844951952315 7.2635500671034307629 -14.099232900624274478 16.979450048724419986;-0.053964366756423201577 0.63144367609982110512 -0.72116742792458732314 3.5710020538446731742 -0.34271393766589214325];

% Layer 2
b2 = 17.747728018371066838;
LW2_1 = [0.64082621165898800975 -6.0831896457502008246 -0.23500678190330312467 -0.36570533980552155651 0.17234862685282997807 6.4558535667107843636 -0.4192718036819468308 0.24797480055643303376 0.30995768883630170354 0.12153987212168154697 -1.8830709537794190211 0.47271138280399987996 0.83287475547281275556 -0.62304756371060787679 -0.22629936518979978932 0.019686960918983229668 0.18892429359497125985 3.9332213392158217324 1.9350679556615939525 0.095807442542599902113 0.57905777414839276762 3.5207759266441023271 2.4278904077848033616 -0.034009918737223865381 0.7606841599961061684 -1.0714228131917040709 -0.3593381006139645395 0.097281597017845847231 -5.6973073726815819384 3.5210740103854605287 -0.37067674396400568382 0.32579935101066920256 -0.18427241174653738454 1.1146297520562538086 -4.2951208368405513482 -1.6446923215622399894 -0.76901827042234593979 -0.022791164681813379234 0.19662693492530261552 -25.356520415218483322];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
