function [Y,Xf,Af] = ESPER_nitrate_7_Other_3(X,~,~)
%ESPER_NITRATE_7_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_7_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.6398932015255238692;0.80532276066682506599;2.7036480047776652036;-6.1732172591913441195;2.1810572339855078816;-2.6888571661585238814;1.2001726342754039933;-0.31435047138349142548;0.20089269276498489258;-0.14692669495272908664;-0.65111975255085652314;0.89448755528138435;0.068384590543122403261;-1.6039138166025972421;-0.19676926193423191491;-0.67884237590538321072;-0.58222906809776497905;1.8961448155416900097;-1.0660896447237868667;10.504873154552182513;0.31388854059061122026;0.21821515127585947025;-2.7111900174154066612;2.0544481661245685977;1.8782134449057228398];
IW1_1 = [-0.054347853645683112667 0.23244383215624955796 1.1786130740109896919 -0.45961930535431599898 1.2384819932337469695 0.46841585069695912402 -1.6361850092989072003;-0.63014221508130419114 -0.041372624100240902589 0.85782395167285641069 -0.076251283540676215167 2.0759796372191052782 2.7029332356911957014 0.085132791018508971459;-0.7854555198943272698 -0.075736002135608715413 -1.2745458688983135609 0.78644201961383886079 1.7996291460362099368 0.72244292392594722241 0.55565632038493772971;1.6947302632307899017 -0.37121915806488892109 -0.24998918084143595397 -2.5363451430760974858 -3.0674259299938313461 -2.03840372187439689 -2.3113065929338558746;0.22605326895414271093 0.5197152860352611814 -0.098940032514298753563 0.3543410982709720991 3.1859819925177141897 1.385331129367246783 0.42515727210312792561;-0.074773916310517107853 -0.56177246936807001543 2.7802365158994204464 -1.0997267753272232937 0.90912067813264618721 -0.82431851212480578006 0.310148289543499045;-0.24862619006251387987 -0.28043243217606733664 0.20355130662289172561 0.09872932335044440344 -0.52859601150349877496 0.76082216164770455347 -0.026893750679104936468;-0.34768034339276293609 0.64041621120468583683 -1.3631838720577122981 0.70731878003264714305 -1.2101720527461279353 -0.39516186853509116528 0.55421928738360604072;0.43762453403534273821 -0.14258613323729704692 -1.9150333141478781407 -0.18056948720596519009 1.9930143604662253765 0.5759985922169487127 -0.08641262899117668761;0.074053274326337764633 0.062726637720115899222 0.79394472794026660356 -0.38413998928397768973 -0.4173477631133405974 -0.6903081321670411219 0.86915430977297847281;0.15978485582526061326 0.35957059541203745257 0.59803935573045641227 -0.4047418804653933333 -0.45881623414117000959 -0.16971966633709356653 -0.60622080276780687669;-0.12001983058038498409 0.2801377384499540435 1.4387717569957778618 -0.5390366393507598497 -2.0959429272599177096 0.28247891754158616084 -1.1042049732868557399;0.33680568245185171783 0.45934658673067629842 -0.18276156576911517515 -0.051580782368369493263 -0.12735180503637830163 -0.16442743357662306658 0.083511092394780855885;0.13967121305351551386 -0.0082347664357453730782 0.7805500414739549031 -0.63995697592687061928 -1.6043267752523340253 -0.22714679925522901494 -0.75746019044096013495;0.51634889970570307938 -0.075472964631197334007 -2.3807621649439223432 0.0035449213849918603629 1.3167712215298070788 0.43608663678072212555 0.17946484282828137347;0.10784698422200560131 -0.32110640600388051791 0.69767971340662382485 -0.28833638509281916962 -1.8044989979329995045 -0.66026449355539751362 -1.6179977440673938283;0.16180004843404854897 -0.073638800274759191877 1.1721092328073039468 -0.45682511545268711384 -1.2717778786494324805 -1.4762555308769651496 -0.6882982345830244153;-0.019227088808966365935 0.62766977357414610594 -1.5813626368180584425 0.67412849341757263844 -0.39144242106354937283 0.97541850565779886217 -0.67647282954964715884;0.024521695413181082701 -0.5374160149299846978 0.38007713687494942834 -0.39673267655884614236 -1.6069576006459065365 -0.070128242635482618272 -0.45417480489326811366;1.1761303050326679109 1.834343641068518771 -0.36024990692146635629 6.9037036633182600198 -0.027952100378470338959 -0.28069083957689938691 1.1938873712737623212;0.28474985699270038975 0.42293437772195890956 0.20746027522331891846 -0.11032609872578502674 0.16420618091156885532 0.053983384203880074859 0.46593698153743018375;0.55904038684522594505 -0.14393818277605963107 -1.4223107047861840435 0.26519123843089575931 -3.2087719085497572458 -0.76687478320116031494 -0.077203275134888810216;-0.28287542709727425683 -0.93074358864437078953 -0.18453686293961762965 -0.33362806937218358883 -5.1167497482800019526 -1.0386665833006829551 0.27417832812471132353;0.25053698859271189558 -1.4172539399623220735 -0.026413282436421731819 -0.082528628598583592124 1.4526259544836770399 -0.47758619583918554552 -0.79838585313428533929;0.17077183505333770608 0.24858757350812188403 -0.42662048664461849068 0.46164752138148645866 0.12651065069459355161 -0.73040993714408375403 1.2129877111271563095];

% Layer 2
b2 = [9.1345493061074236607;0.94645494071057711949;-2.4720647975108236416;-6.7445900265955280872;1.0311521420998737142;3.392097966276698795;-1.8713252988337065741;0.48195130056012569497;-0.19059213508368064161;0.63604443874488292288;0.49788197264608213821;-1.8030670784566091847;-1.4364121332670054532;0.40692160193416399006;9.4221609327728792493];
LW2_1 = [-6.5385287462300336614 -0.44603865926159175226 -8.6842657585886762206 -1.5637000664468920785 -4.1932009558181100317 1.0155248973874246854 -1.8667227473666694326 -2.4496762437187169503 -3.9281762765635654944 -0.19020068687939414853 0.10352224220658272358 3.2496753337565329467 -5.3821539745218558437 -4.771336181289748346 2.5497463188677924606 2.675574471491303008 -1.6185607071659049438 2.5927533027085263306 -5.6873538173458157985 7.2142677954927387773 4.0961064341039739034 1.4583609055010822164 -3.3353747594543836641 -6.1156776747441261577 -5.6627372097748942537;-0.19357202012231045085 -0.6958288619165874378 -2.2542211518071488818 -0.94944302942999114769 2.2725571016717416306 -0.25553657598859630395 -1.3696714895697637004 -0.3669466297730503701 1.2846458457891678506 -0.56397364138930616839 -1.0259919372908599122 0.96413374767089410344 2.817927220912707309 1.0823931998974942736 -1.6836235583274958838 -0.25831674980386687412 -0.27229099056459282746 0.18043373309376223301 0.43553131299197306303 -2.0910416771443376405 -3.4224213815429838093 -0.75399839024595183279 1.0093435714017335858 0.49691004930289273123 2.4810666260525917615;-0.9510930115440856536 0.96767799153714162408 0.50882490025702376002 0.49905682610537449584 0.26371599987961508171 0.60771014523891864201 -0.21795501804867650764 1.403344099373076137 -3.1940224848717564399 0.8054819473371478411 3.860561613677240711 -0.98804035274080181939 1.8768059380035229111 -3.3322768810757530389 2.6877519783552958899 -0.72553604058272425092 1.6805050027560453074 0.092528188933890323509 3.5275944949539157491 -1.9774132801491361988 -3.5346933078663838046 1.2343553298085774284 -0.75046145534734287619 0.92630349690240443294 3.7953021770788732958;-0.68430576261656250736 -2.7127770676847737796 1.0395660409586502393 0.67699621022249034663 -0.46226801015228313751 1.5233300796612876393 1.1380630800011621862 1.7210689110389822964 -2.9920768629438425634 0.57267308692529639291 4.7914648130473160847 -1.5427792464265834838 1.5977928095498128425 -5.4176134925592425162 2.5587309842614081035 -0.88019340293095349459 1.7765913782103814889 0.25607810333050151641 4.8203673702586389282 -1.9351380145649992315 -2.0990145652478866545 0.74186773147359152958 -1.2223475853272047775 1.1428837866298613424 3.5959360042946331149;1.0219480262051601205 0.2116712415836919936 -3.3378808722920711993 -0.33765026922525459563 -0.00024087821453784184419 -1.3159426143104040463 -1.1949064718538517926 0.085199508933545053946 4.2907102928604841097 -0.40452042269899535221 -5.5283013463298615875 -0.60581817501196522091 -0.025158592649610411057 3.372176090579211305 -3.7410173294735664662 0.47229247123746503911 1.1904214537712549671 0.10172985835440707947 -1.8650823693946805282 -2.0726135503588398734 2.612175407036616992 -0.3529977797411621987 0.11488388468752307181 -0.78030699694556038271 2.6141630045629109524;-1.1287164940645382227 0.64687854846822079313 -0.3449136007831401507 0.20058264522985369549 -0.24201521645805806893 -1.2776772455175513521 -2.5234802158115514636 0.047817576918620069426 1.6125197369551165227 -1.7531114785901942277 -2.5516885645373528213 1.9274269859943782279 0.68923337019833830208 4.5444761858504563179 -1.4413152270855651427 -2.1785397983443903769 1.885654548401901387 -0.51304677334969661651 -0.092718825626320749977 -1.1017760922642512167 -1.7359177879944920342 -0.18498231995950467632 -0.1969443486349619632 -0.69048455380741113885 2.7106144002550518479;-2.6501883373231049923 1.5669813870910156428 0.96276090790358193061 -1.1654896457943781929 -0.71476578169799087625 0.62241202383407889798 1.18726604113563039 -1.4774157011864530453 -3.4791683710890448644 1.6105095909559683509 1.1679490292771197435 3.0624176972046552869 2.0048257423559983081 0.91333615710023108303 4.139241603452554763 -0.19687618751980062726 -0.64494512706892648257 0.96064271474238727144 -4.5508374695210047634 0.89209869536420105529 -4.2067607310062138382 1.6951932313093478477 -0.15428053173898706452 -0.23698249182038971794 -1.9263260610691383956;-3.1990359888386148413 -0.6515746462458630317 1.1460276002638636328 -0.60681501218104616502 -1.0653563799537484336 -0.4248758126968645854 2.3361917639853784223 0.43234057004128229051 0.52510678344520478333 1.1842992473797451236 -2.1444891859920378607 1.5017161473982716391 5.8615968570408396587 0.99706425001233189853 -0.35057078227388333014 0.13680568773260054494 0.83534715010381277445 -1.4230188168159119133 -0.54258354984727441561 -1.7329162823316315301 -3.4197337400187048928 -1.7800601329986933674 -0.88432228826313730163 1.5652570252420501262 -1.0118287045496052734;-0.72192233935271288292 -1.2772274033619486211 -11.82354869824190402 -0.7968363165906383605 -1.1225084566074048364 -0.44689291135450393 3.6646057020899243106 1.5641950631789645065 -1.2165821231893656496 -1.2555382284658187508 3.0064059439324841705 -2.22410888632314796 -9.8278879476312148711 -8.3320388354625656291 0.4450578815253795617 1.6346433719980419941 1.4656973984652925669 3.3248788308493186783 1.1763036894262408616 5.5032054964569390165 11.221343475832380676 -0.2901928700641610015 -1.5756409460086544527 -0.23022253205493142802 -1.8878141906846099829;-2.4798425669128025817 -0.74273384709381717883 7.8770861865951253833 0.3331509265959209376 -2.8060559045751678475 1.3979948266302391069 -4.547072301530266536 -1.7015142820168365212 -2.0063707345367665091 -2.3971525916748666063 -1.3642537493712771912 1.1662240548953504149 -3.8763236283409594485 7.1923261981558068712 1.3448106730563833544 -2.7673655003522528162 1.1500172271376876143 2.7690461934041983305 -1.0857901080211500577 -4.0172116865551448228 1.2403758689360249168 0.21092272778382387122 -1.9271560250636670109 -1.2788097491545971085 5.5195217513290319999;-0.42258401132047057613 -0.88979613012551872497 6.675888950355566287 1.011947387202660753 -0.43914427224739754907 -0.4552842095337508721 -2.8500309201446625273 -0.36919261578343837149 -1.3429356757357631125 0.50223391696577746046 -1.6176711213087828778 0.34212137518930108016 0.5216253372377126496 6.1332305625268723759 0.73274669908729783696 -0.61061989432872443295 0.047986640948626944903 0.155672908229373963 -0.76073789675703151758 -3.528950443409219595 -2.5790591856989952824 -0.39152954583497245888 -0.54415501849626235487 -0.71238033663667310602 3.3863816749313064847;-0.19588486433223331606 -0.78346525457751403643 0.062891095897095683487 -0.09490782924788279673 1.3168648878740012442 -0.42225271854636281521 0.63879118507030885343 0.093445088466156650542 -1.7511651702971413602 1.6937122940484374833 1.6492677088144849229 0.50708054571533178745 1.1514774815558099785 -3.1169573522036713165 1.4402252940052053809 1.6089438730959924051 -1.9847696199058466604 -0.54098361807526273992 -0.0068679879429616912459 1.4262330501888151879 -1.400180767513109048 -0.2037193826121292406 1.1325697194898409759 0.72520542154866218798 -2.321396275314297597;0.15718052474834354193 -0.78256956694450874323 2.4378898074695651843 0.1671159898215414108 0.1825647177225253881 0.90236575375204319815 -2.1861699757900634467 -1.1743124430077001019 1.6548555448003192669 0.37178713979641425658 0.39630646797954754978 1.3341181713640426487 0.49206415193162300614 0.95537140057798286552 -1.6693122321900002447 0.94885383444937609898 -1.6539230749482254357 -0.36115466927602579705 -1.921002652682093137 -2.3211932968116935072 -2.7743741332396809618 -0.055644277047169399264 -0.66624971982486491662 -0.97173442126261333485 3.9456138476927584691;-0.17356862247386536935 0.57975814358597188569 -2.11687549728937352 -0.78204052019194081335 -2.7885488026427762698 -0.041974067770859629922 3.2290173896725331559 -0.18743239844548736928 0.84976218163290884178 -0.054345085699900881615 -2.0186185281148936177 0.10885766775394029038 2.0095583668938248323 1.5666693814371135396 -0.6067716171805060954 -0.65072368940378144675 1.5740942888309252812 0.97972925781801611933 0.70530641696856055667 -3.372519799904006188 2.9720561886370280291 0.06769189376929568569 -1.1974077225453065854 0.74774091899540895412 -0.17291568114665301081;1.3418114099721583088 -1.4151124749196650754 -5.2021058140962841421 -0.14715990463806261079 -0.55959113779204172623 5.5240588314884462307 1.7190719047097828831 0.78476469166605566929 1.5076271530706963908 0.43809961789492424256 1.6252119520031091948 -0.85587948555656279126 -3.6449733097040954988 1.4434851560250765434 -0.94416367536937961802 1.240292657770302176 -0.92454909716403887998 -0.97953347739267171423 -1.4410068384544569842 4.4030517116195415639 4.1903712524408609497 -0.40796020872872973406 0.61706757315374749506 -0.78533975300560832089 -1.4502184894069907184];

% Layer 3
b3 = -0.33745938285559406999;
LW3_2 = [-0.27803733478815823021 -0.73890852596190259582 2.2699658551631252124 -2.4764433272848154211 0.32810872316329153797 0.62402044404385115239 -0.31647029586197183981 0.38919216077450546898 0.33845928551205972656 0.70042871465482603455 -0.97130092654938648966 1.0011876979695384371 0.39394819491504112774 0.37844467828480110594 -0.43150097672704768037];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
