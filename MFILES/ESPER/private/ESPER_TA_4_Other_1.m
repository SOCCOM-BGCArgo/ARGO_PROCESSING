function [Y,Xf,Af] = ESPER_TA_4_Other_1(X,~,~)
%ESPER_TA_4_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_4_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8886783747654742882;2.8347895952240271811;4.2055488392823239252;0.36268274959441509919;6.7830872786715339373;-4.6436147249167261108;-8.0147398112973871065;-2.8881065127196401399;-2.5859154773278665296;-3.0001394876431861647;-3.1453447895465469486;0.32390977757284017402;-2.9862030604746268025;1.2309164843637263598;7.5467997172374827741;1.2252543018590655866;0.59233442311595441154;0.70299748065934952734;0.28823736229078766868;0.67550226950347758148;-1.7866723236078698722;-2.1262889335684747039;4.7723047791934867234;1.759485878969535122;-2.8085583260842108544;-7.1854391678174831526;1.2739297135722129628;6.199588330389224744;-1.5825853673026073487;-1.3350422379396065242;0.28399774568231722638;-14.01674842330365145;-0.95403079984947292136;5.260124883544820662;0.59011802323320183827;-2.3683828821732819669;9.5562876561103138329;1.182818646269462759;4.5753433775429623864;-2.8374480944947575445];
IW1_1 = [0.12562359101098208303 -0.38110402013145372457 -0.14547783401988645391 3.6608764177550852104 3.1558550211813685138 -0.97514197290720150413 -0.87493781475424725613;2.1906925220728026282 0.45544700957186146084 1.7966773983950465876 0.25985105530044938504 -1.5789613964996884743 0.67327089595884381801 1.444901858717090537;-2.1373598020660851127 -5.9928446120743350534 7.8401231540020104305 2.2504105326566823386 0.032540018312911200837 -5.7309884231152583567 1.0724129706731380107;0.3315623115202779303 -1.0717822178455171933 -0.62572511495456872854 -0.56421946261152722268 3.4738143654166440122 2.4223664284447852246 -1.3452161671887339356;0.116391531376488222 -0.0078231479660558662925 -5.1868140983817134781 0.46990849314623400756 -5.1679001563071436109 4.2600215233527380931 2.1957148596026963006;5.788534300673829236 -3.9891393598734579129 3.3886237615055279093 -5.4485341599307961502 3.2695329944408872969 3.2011772886720986087 7.848758799845370504;-1.4458465107290958684 1.9719048996625989645 4.0440463988520845007 -4.4579561755813266188 -0.89417339496087966388 -0.56540721485364409116 -0.49267895853587900801;-2.3518907363932815002 -0.68024731086894596466 -1.9158021231382960092 0.18684574890859761975 1.2438770092410653678 -0.79689716625125628369 -2.4689382974556375316;0.0020076914447286616991 0.016531086059582891096 -1.0242396359952947726 0.19512021020850120467 2.6422298522430409662 -1.2356020308759301241 -0.27833664272073721513;0.22212087924102660863 -0.29919555766782968131 -1.9421459992122132032 4.8164544447036563568 6.2157462283968722971 2.6345179222812227238 -6.3366796665982638714;0.053142581605099339925 -0.0019846051065849669437 -1.4918200912711483408 0.13814665304111037325 2.5576026067968702371 -1.2309553882982633422 -0.55061940690931299169;0.38354040170849973412 0.09974818762225953761 -1.8009045253222222271 -0.11286537411583789925 -1.1517167084501898078 -0.3095244419178753148 -1.1112640503356421284;0.40746370211039129039 -1.5284823444736816977 1.2560095625575762313 0.10988288348945851602 4.7533791220626131491 -4.0678323014391581935 -2.5497104741254568161;0.1435458735756002524 3.1470377267687510425 8.0131987759618485967 -2.7887604637995528911 1.8388177611790366139 1.1953522662360274165 4.2453024663845431164;0.058961954844435573997 -0.2487052341546431844 -2.595667888291143921 -0.57261139421259743543 -10.279548933713668291 5.3464877490408637684 1.7699048161461989892;0.039116346874826644908 -0.20184477898472943935 0.1944134218485691068 2.520440604285968611 -0.93607808995827401777 -2.4840482569267399171 -2.588037398981627657;-0.30711135666827654722 -0.10657566213479058304 -0.34752910149282695285 0.70515877863820530802 -0.51904526532046957321 -0.38609565818109209401 0.29078939254620056465;-0.44258800082402754983 -0.30075777833533451355 1.01741844514906421 0.59874503763304609549 1.0723486111558535594 1.0860768083760461433 1.3596508421608397565;0.29543600587160279147 0.24199368857374808917 0.72238380161200543839 -0.46075159043583879814 -1.0049871621761454765 -0.038818797578345352883 0.20973788688999561725;-0.47461432660719987675 0.065239215448330306613 -0.33255287345826989309 1.2839530802767089579 -3.0182295781646368837 -0.42234281860659156349 -0.63396165225403477983;-2.4142426385496666974 3.8877209616793590996 -3.0055113851420731663 2.2453035272381507426 -1.2907404615667485981 4.2717030108002891353 0.007252577053890874037;1.86177633029510603 0.76592162777448613564 -1.3753136666696963442 0.27375597114579830471 -2.0329280739984110227 -2.2622594988841000507 0.11381615818891414882;-4.9846813013955753036 1.8234825671886181198 3.9604485412631778019 -4.1969531003172848571 -0.37733629790385414537 1.3159855653482861459 13.307459456175591228;0.74697536726209046165 -0.087240462326822337813 -1.9642477836386844636 -0.11252265879402781334 -2.054376854788230844 1.7851562635772810772 -0.93368799594067075631;-0.21596136045383393376 0.10637588859153887522 -2.0593854311743857721 0.5927469869195582941 -3.5501177909877270622 -2.0804866121713887495 1.2094165849946165725;0.78642890588788028072 -0.70752174079357288417 1.6962103011736868741 -3.6341356975772800553 -1.7067095783875512183 0.98968163297081546137 -2.9125048934446726712;-0.19393440259836369766 0.57455441797270523363 -0.058073551656739275106 -0.16627517319431464604 -1.2377435477848355294 -0.6916703509501263003 1.7329249073557708716;-1.2006164440616768907 1.7218855905796712769 0.27688258799839937652 -0.33215702882844955202 -6.8679660901098804615 2.9783511542474867539 1.8162094289483798892;-0.53980660225127707896 0.030037461391238293174 1.9513162443096356835 0.13671499922394694804 1.688335145405320814 -1.626913864186208869 0.76928756664097341922;2.5683644266857723615 -1.7594764467799008933 -0.40491240561861308045 2.3858927123746589416 0.84675155973842419765 -2.036232032999045316 -0.49749133997693156806;0.37019394185190740432 0.093538066448947937426 -1.6421996727278020956 -0.10061319429862786157 -1.0763687724559478642 -0.30795237330517816199 -1.0652461804580739546;-1.2778627089088305802 1.8249119844804249091 2.4575033652445510413 0.74094709990200469107 -1.786250289049428952 -16.966565089859329873 0.64024977875556232654;0.28930576925586504178 -0.72617876107993373225 -0.63296165641906054766 0.64212912442543046421 1.9243803537264316805 -1.3896847246335277681 -3.1770320303647454629;-7.779755552703209176 1.4698922066629551697 2.9486336515820514848 0.98381912105840818583 -9.8918947837601862716 1.6394782412498927204 -1.8061692978873236104;-0.26395472908024902869 -0.07040992199727352796 -0.38775072108112207392 0.63196439649363711499 -0.64904343188359403527 -0.25777413330162546323 0.25280746786113261759;-0.88775987410184775683 -0.35678002130937769287 0.99893190171007573142 -0.25774888254129008081 0.68292622346437503733 -3.1856930736423083594 -4.1444531611508663715;-1.0078384386975094422 0.86964279340653460881 -2.0718574703135592685 5.195091783068074065 1.3493602448007793182 -0.64895575520228854227 3.7681879602817756059;0.052490903677570616148 -0.020369834820196650038 0.25656872522627022226 -0.33953966973635413273 -2.4044970672078105345 0.9329689756437056225 -0.46682941917848280733;0.31086710817264590068 -2.3392878805932770803 0.30394382317722073994 0.087964784683581445646 -11.892015206462406951 1.4526093770970895935 3.2844239032836450853;-0.07010157155117031913 0.091257421576313849099 -0.90861656481496366755 -5.9156106002718038539 -4.1152971771651607469 2.5731245794132404647 0.48551228241696114951];

% Layer 2
b2 = -0.2425112579504657695;
LW2_1 = [-0.13671895884650317465 0.13020316430824327436 0.0074129408726461313781 -0.061432274132696106095 -0.079383146722064368284 -0.019033907853913702851 -0.033915557988077001117 0.088143897698255951889 -3.5198086549861851147 0.027818165128753499782 2.4077651498811118991 -4.5896321974206069072 -0.049129144989909077912 0.013689108159386041003 0.12290321232933126838 0.11667371404752098496 4.152588196381079122 0.39251491831296125845 -0.71352265620360644238 0.17507277964625106437 0.01772800096704748446 0.061233600920513400756 0.0099108010414754883072 -0.92962454031347574457 -0.15041414774815442534 -0.60764294331659240989 0.25982861454340361318 0.10871606881867751371 -1.2632879421163027978 0.026521575095653490695 5.219731798715725013 0.014780826728172902565 -0.13443632264545357646 -0.011712341028803665427 -5.5629408698330475858 0.033037563869660897808 -0.52976444021299495812 -1.4402180930945447379 0.016858753056575546958 -0.066481709223777066264];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
