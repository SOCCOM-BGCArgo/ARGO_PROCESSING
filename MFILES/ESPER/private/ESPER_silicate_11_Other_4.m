function [Y,Xf,Af] = ESPER_silicate_11_Other_4(X,~,~)
%ESPER_SILICATE_11_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_11_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1282260911627202127;2.1547714581465893247;2.2465059212021123436;-2.3858467815245800736;-0.45864344716643384858;-9.1178513130892362426;-2.4292260348652319202;3.0811966282826666053;-3.4515335711320913603;-0.087507124447742529183;-0.49473065598054555281;1.0096716721650664805;-0.8009933742579767868;0.55396244283756734816;-0.062491135332558317428;1.2103099418740841386;1.3721030010068480109;0.0086383067090555279433;-0.73520262597447227915;0.29464204183447545438;1.0330595842328331724;1.2418628102358399978;1.6294413888131826784;0.40860812745066221741;-1.6092770422904756344;0.1025584252000248664;0.34264745071102881147;6.9603710627030110913;-4.1291920763010079298;-1.0320978804939580087];
IW1_1 = [-0.029061888733587743633 0.29403844421452962621 1.621670297113390502 1.4341133492653519443 -2.4952183577903626066 0.21291627834714749179 -1.4123228255829125555;-0.92626458755696372549 -1.2031272805089825439 -1.9510034511530032209 -1.088123712822690381 -0.75531864769705248097 -3.9720723591768378746 2.5906960913874685914;0.26618157452864099621 0.2468765471092389252 1.4107193118843059931 0.79801250834104808796 1.362955638133961811 0.29213664531959104842 -0.042167086607645912211;-3.7836582303916830305 0.37975396293459168229 -0.62153879262880684653 1.5090898629160847122 3.1926106828095011103 -6.2170610367086505121 -0.054278421209887982302;-0.50945418390618668614 -0.25120945198810018528 0.87489174065113661793 -0.62847642068862563658 -0.62472469513109507577 -0.58757338521030821887 0.76053803660778451778;0.65010620822254050477 -1.0978944362274112301 -0.17335347959326213862 -6.3715222217608209476 -11.719984381824909647 2.2055263150888149148 0.19046003156961280323;0.39952291446786764029 1.6268038334024630398 -1.3710947029892643911 0.49103915682076376692 -0.30616174251714400878 -0.72266288833111225198 1.0140732818544400118;-1.8552601083499073997 2.5367453050487154265 3.2782357111961579754 2.5717870185657889515 -12.45791463871338145 3.8980653093495458705 -3.2139815933263036207;-0.23335388676805912667 -0.4271180597071784768 -2.3716280163655287794 -1.1173004597964675266 -8.2801269236056196377 0.54997918853355109992 -0.6018198474210308957;0.91318150526087038532 1.6098831707840126626 -3.0564044884657635137 -0.64100262620401271541 4.124236016848183084 -0.63000511976766737643 -1.2789047359952756544;1.9340594753891613422 -2.2873599267827811055 -2.4178814229638856403 -0.82625978727772053656 -2.1454768729975541852 0.62725440067380144882 -1.1562542699938711532;-0.73478357458008891623 -0.22376150541468883826 0.85804761163754172948 -0.59587839576543166764 1.1962261673901557479 0.30239764523195300505 0.24109064764668453051;0.43579313649155954069 0.2523109898293200426 -1.2191109678827907192 1.0956074957255423907 7.6784089901798058264 2.5347749612192198576 -1.888300406562187117;-0.31144297987795288574 0.59449491732878356753 -1.8299389378491228708 1.031270424416437681 1.6068248414639523247 0.28712729960077598701 0.061691932455748305086;0.66935696212299378161 0.48041004460063524428 -1.7605944080901494431 -0.73996450631460630731 0.40224796111828375889 0.35583414619963976699 -0.77301944389789367662;3.7545266320089139001 -1.6033801962674187891 -2.02376415048068381 -0.44741057207366563553 -0.57587944962979642494 1.3787019742661472677 -0.93124310293224488166;0.72657839292191794822 0.74345424729398335018 -1.7053263342403390812 2.0849667464283738738 3.8737638149843518498 -0.19447519906928745215 -0.94913358988021012674;-0.78789431994919667535 -0.62129057619889027642 -1.7322155131589747068 0.21866930586904056999 -1.29706726931004801 1.9430950484417324198 -1.8824328928764417768;0.14280337187563427181 -0.41860021940527403217 1.9683067536274212461 -1.1896599261495006683 -1.2913304999293577779 -0.04518988076320671482 -0.12952818121686818231;0.045552321853220202608 -0.2578021720955173679 0.2034680204095763445 0.58809070204066060672 -0.5197923202301154566 -1.5506571575203176305 -0.30045752952867821328;-0.44288562073680637354 3.2710501740297792672 2.9067745724143452257 -0.88179444404708196004 0.85954813781024874686 -0.27673690515741583562 0.098311797870548098266;0.05284433290837978886 0.29987998324386327953 1.8352319252377933267 1.6951747656510327555 -3.1170917775999358312 0.66663133176172439942 -1.7078106197294715685;0.64235800393887598769 -0.37496253174012361686 -0.24957984864249299628 -1.3863360529633321772 15.676970008338159346 1.5304082901748339296 -2.5907939663395618268;-0.21901929074689679977 -0.042277266610810979031 0.43398497090317200708 -0.32690548068996833075 -0.059496460260505985851 -0.31520415741793605946 0.38325251508573165982;7.3304740722180330437 1.6909078031806368259 -2.1976851986389731586 -0.96316024212661577319 -1.4955172648503332056 1.1485078204371925725 -1.0490787352030006563;-0.33826448763857036584 0.65921556009538662124 0.81509312147630597067 0.36852555065097603038 -0.057526924530097500732 -0.32164641268392735185 0.31855327041094372298;0.27989009475388415549 0.82558846730248414136 -0.464139873342440612 -0.68352384703416857459 -1.3307119000979972245 0.12061470027298194785 -0.17250495189094744442;3.2499703363343468432 0.30901968823687442356 -2.3291101383876320341 1.5115184974600557322 -6.6989159397950253094 0.64967893172489121767 -6.3253530652589464722;0.71846962231867417259 0.046187962108287079765 -8.0466495522017567055 1.7186423339676057953 10.022154030711648787 -5.1146163030220437307 2.8897291696378806236;-1.2599607223452062854 0.99567796030075161884 2.2098367693202107809 1.2089547019244824 3.2641610877986240169 1.1429718876284657991 -0.0028213654543967009794];

% Layer 2
b2 = [14.330054796886562585;-4.6621713787382752514;-3.2422493971939734259;-12.050716795949163895;8.9386014795374002517;23.959450810046789115;3.1479794971096186629;1.388448331116301393;-4.9464624610528762361;2.076292719492263128];
LW2_1 = [1.2287178711177841883 -4.730727361495848271 -0.90855500117430465501 -0.039234164229725872197 29.195451807673197919 -3.0637313655142324187 -0.039764624517584473695 0.51365759109662123549 -1.1760254268857508464 1.6615577862605011017 -3.0247129179345200178 4.970782682827306509 -1.0206351758133840324 -18.392533389893824136 -1.5094087949034342699 3.5761139495421208068 9.3668329086616548551 0.84639584242857235363 -14.829476040787993085 -7.5314971644477477497 -1.030798594721645145 -2.2833036261222665608 -1.1853692642774573685 -35.657001852468638958 3.9015602909137605536 -1.3182777117242652221 2.8170621360432672731 1.6703094828342515132 -4.4591272368997474373 -1.3140652360797377973;10.011196023609967298 -4.2840097120845204159 19.725766750800723059 -0.11613494430077350716 9.2553471084677827463 -2.1225849122830573457 4.4063235860041318759 -0.76774985976385434761 5.3723267545697597214 -1.4624901456859797921 -1.6396960439199399495 -0.76789411273699714755 -1.1698881600509098977 -4.9123489228471779455 6.7787402265049028216 1.7398981491223597384 -0.10398142154511935686 0.57829845260018442055 -10.850335272090090299 4.8321742586485134652 -1.376663820387745929 -6.253274112720867528 -0.10242417597375537419 -4.5156121336983012782 -2.127251098955438291 -8.3792404274557625854 2.8972919063607598389 -2.7596222081068018106 -2.265942962154906315 2.2118047382970100756;8.6854036092195077146 -1.5101255363366383744 9.2394681500828461651 -0.025844021647790225982 9.9764625142404881331 0.52177175047453172585 2.3911827941347132409 0.70119301044379822585 1.341413107136985472 0.784858909212564404 -1.2916981867944627993 3.6381157161808559408 -1.3690241813934984627 3.1440759319481093037 3.6641995470233941212 1.0585743474029147837 1.0761367941412862681 -0.53350950734779911677 2.3602976307048928462 2.6082840326279210785 0.33226034515058427976 -7.0803794538574313933 -0.36441655650499604757 -8.5611454613208284314 -0.74033339358376160089 -9.7014258490747522501 3.2990212414190129842 -0.20509116437495200636 -0.59591199482141532506 2.6505961980056960137;11.947894784454721417 1.7616186702718834578 -10.853750730751849929 -2.1542283007443443488 -9.6145888171633195896 -7.956224774136676281 -14.059136581354712447 -0.4798600672403315337 -2.5675029582861794708 -0.56741097979765753312 -1.5321881427302797007 -4.2020463010221718037 -1.6832510428833984406 -6.566634905877103634 8.7443139334854400602 0.92847734737555176476 -0.40013197896775432039 -1.7343548232221306371 -6.342506811568460634 -2.8215329655713317081 3.3471168490461211675 -12.826308682703238873 -2.8086106008338309614 6.9092056510720798457 1.7579477111088765984 -2.7160337010949859859 -2.3680842266990076439 -1.5853121987518523639 5.0118061957809114659 9.9799189493057536282;18.157632214033206708 13.266463739120325727 10.134896614282304483 2.6533094375575112522 23.676057838154566326 -3.8447005098643538545 3.5017753549686947423 4.1552467344994514775 6.7245902366447918297 2.0021216413497611164 -1.6346952986502796268 7.8248293155189294623 5.4331372588582533822 -3.7639979676340518111 14.151963291151806956 2.588570137838177132 4.9998772222900846884 -4.2033290172958075459 -1.6289182587648836087 -3.6605325563853678972 0.39584127802635571403 -14.118963923992055243 -0.12790146448505290699 -17.89708739380775171 -1.3670137514557387792 -8.8568721831032224401 -5.1375703957034284386 -6.6777320139077618322 -4.1903006697047722184 12.891230395399315256;3.4229481793178866411 4.2984536350372657409 -2.4379169116815626595 1.3415509968339953684 -1.2091620550884509822 0.53277651606406695173 13.812345931582166614 -0.46622957305861723043 3.0086970058561606223 -10.337858512804311673 -7.3655311228613387087 -0.76563276485552711481 -3.4932179615653722315 6.2956266958978979176 2.6260579091514824057 -7.9113472733427814276 1.4210318027846355893 2.8188017553006448068 8.9380110714273115491 2.1574425056804193979 6.4055950174693645494 -5.8623172330378698902 2.2753132852191053637 -17.038903505853074449 4.0310353446796405308 0.9772254222490646125 0.22239306916388065782 -1.6226551188697979633 1.7911407380034440884 -16.091232032275396335;-4.101733272012379139 1.8989472387778933982 -3.4441002302683165759 0.62434642297759812557 -7.8757311779725851508 -0.053988124820937351267 3.3989554728436819353 1.0793150193223257638 -4.7098179186772357596 -3.1086491073081563563 -3.3392287064382650819 1.165079486640844264 -0.76765695833746394605 -5.6366988663130799253 -1.6287305810530350314 1.3422825628309256185 -1.9546150490119000853 -2.9257301091117109415 -3.7162313022313746558 2.0988804641082743352 -0.89095713034796142349 0.51998938129355198878 -1.8985270984339599476 -5.958059677762958195 0.43418079606663273484 -7.3124551458269868576 1.4260554028492213874 0.20673026720747039731 -1.2069560423458365328 5.1116875225270721472;-6.288605698350923312 -2.0158011823398918061 4.4797742101065711751 -0.22881305610080537871 2.261866108635667505 0.6964576841525990103 1.3550429631851887979 0.12476967178031683758 0.49526825155119730271 1.6575795315123627027 -0.74173402012327849242 2.2165714227450332707 0.18523360535514118985 -4.9752390625574234306 -3.3765741590324820365 0.20447675812590240807 -1.4905456554779266121 -1.189030355738529332 -9.7703302391383441972 0.46350895940955960661 -0.43024367537654734095 6.5419267288470992483 -0.1466455015915711646 -5.0796063464093528239 -0.39355249599944075456 -2.702766390452343348 0.58943332215466259782 -0.057688539463670231167 0.10732952991528921238 0.86218387313111310988;-3.391582868428190789 0.34764682228426929678 7.4267560856362671018 1.3712982503579767002 4.4323984079335030373 2.2418151295454293859 -3.4632761314764644034 -1.8069223299212304745 -2.2625243983594587327 4.0702134802170082395 -2.4783657723400338568 -14.577165416581429724 -1.2168822729203552235 7.1279455084809626442 5.9200659105700399465 -2.1469430533019373541 1.8852324003982399159 2.6625813714552770683 12.47225294315616928 3.0358672332363769719 -6.350445104600257018 0.94314345226364448838 -0.11834502864949028589 17.124759701385929844 -2.6065409956790714929 -6.3185404386783039499 2.3680898950310891315 -0.26977562380973363343 -1.1164983631939420228 3.7327479831629006846;-1.1744185494152978855 -0.31045683496300302551 -2.7497081687979432196 -0.27105540029045482875 3.6168354822352601907 -0.058599580733265009547 -0.29257449470577079342 0.033037806284163633019 -1.9324486648105785314 0.25093331158441622986 0.14740923732495128662 2.557189065492190938 -2.3377690356237925684 -1.578016681512512065 -0.27065349657922171955 -0.13556839916024604475 -0.10470788774442441049 -0.48551318320999747868 -1.7064782617287708177 -1.4605273771098659097 -0.053792648882937270371 0.9653209814864625038 0.3176644698757793428 -16.323289603624054678 0.011527993577651570942 1.6629787724189790676 -0.48813274680735702082 -0.1441377046151503527 0.33204200889293677967 -0.011624727058965127549];

% Layer 3
b3 = 11.636839357533766304;
LW3_2 = [0.016968402331054812521 -0.041427114745169683896 -0.24113010908328985638 -0.037819692772434826411 0.031414598313569436216 0.019772278502576613041 0.043816766777361210172 0.12885556661430161429 -0.02531319412609752198 12.203756367635184787];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
