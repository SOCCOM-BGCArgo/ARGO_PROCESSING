function [Y,Xf,Af] = ESPER_oxygen_2_Other_3(X,~,~)
%ESPER_OXYGEN_2_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:44.
% 
% [Y] = ESPER_oxygen_2_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-8.7080379481987844059;-3.4792016523245750115;1.580313046352030959;1.619910164075975656;-3.3265824059161084314;1.1549724869730597643;-2.5458761605827331387;-2.6786837947499826385;-1.6856983033505947844;2.1971100656141611118;-1.0013457346247818247;0.63381706241549395919;-0.3388978954680395006;1.1115834027472499823;-2.9361464586612435745;-0.80769445357703240074;0.73682724366498908442;0.011139517895070007517;1.330068086008495909;1.9184197064124581811;-1.1718447744233373431;-0.055669653617119584099;-4.7823100595963543569;-28.203287908097497194;2.4756805827320835789];
IW1_1 = [0.072102109838735134462 -0.39856708310432070741 -1.428044242379429285 -4.0492674164716619956 -0.38981381022150418669 0.98534099534675534393 -0.49494343092273102025 -2.3435162376474050205;-1.2467009485633204768 0.91489484081027294682 0.16170766911656972442 -1.5366848977716640601 1.8676699028010195214 2.9896612717396879866 2.213737989216645996 1.8443814747484095218;-1.648697867131018846 1.6983874602366613171 -0.31819478805614126449 0.034340808120731515507 2.386882386400643874 1.3042802972039160281 1.1506831418678491463 0.42475338227133779823;0.50309814871956359816 1.2459794913915598347 1.1682682859992645774 0.29995293253765659136 7.3856700262570340598 1.7595982123843851852 0.71101808373325625645 -0.37594789415593271587;0.61195717970680907349 -0.19641612068817418391 1.0887154774577356697 -1.928501353188332379 1.0991114966703023903 0.10696534149795998425 0.99372100345910341357 -1.3164794243306814359;0.23834893020931172125 0.6283090320364429493 1.5516237816642555192 -0.042932497355330105637 4.3473813284748956676 0.69782803551208938408 0.42657037642107931141 0.015478380656607171328;-0.27787333896220300922 -0.42038326187293567626 -0.95871904728940793294 -0.48935024510995855929 -2.3410378674262606324 -3.6068204554739291545 -0.79381334481827481309 -0.26195121495885126395;-0.064027696171250314539 0.013047863428387717483 -0.75291956900248091511 0.91972453036478940547 1.0596329388222940349 0.97672131620344049274 -0.21303138544756825001 -3.1501262378257575136;0.29664526937821789065 0.14625073884774378308 1.1127818410331968835 -1.2595763110456472678 0.14909209893859917684 0.14948895594617458982 -0.28011004175723269727 -1.0288985985479033314;-0.52089292393476815946 0.43244114366087615942 1.0977499241549570907 -0.3850933672755372239 -11.980508299437886421 5.3724932952863717617 -1.2145947874767344388 1.8714439181806379331;-0.35965143712521852049 -0.24870771978125572055 0.1614228966233012541 -0.61025876666448308772 0.59376725243649597363 -1.6348406449038177524 2.2439679949942696879 -3.3335365260841030022;-0.61371441153937644764 -0.18861056653260149796 0.66266768213186133529 -0.1804372510747120073 2.5340763471468505941 0.90796868825929111235 1.9720494126552110536 -1.9913135090750218037;-0.085123420573263136601 0.074601750058208210481 0.022450449294646089571 -0.34367338434263960956 3.4282692030994081911 0.2890723745111349885 0.32177843058667354725 0.34767814510114797288;0.080247549713093432877 0.013581346863931965246 0.62798492586323828579 -0.020035267011059738895 1.1449132760779665574 1.2004432772093769355 -0.14038395292963060101 0.33385590428383954409;-1.8252178605780691178 0.9510811237173650845 3.3074508309189871724 -2.0765388321033952934 -3.0478421847536587563 -3.0628111804223876469 -0.01298704621379307908 -1.4802124341647944217;0.060987175201578411321 0.043007482162326332586 0.19764611364484122036 -0.13028059934019486921 0.4426184476481709873 -0.74108043798052924966 -0.23609788393430056197 0.094428602992091534296;-0.095882363673991985453 -0.095457336440047974024 -0.37864132059345523285 1.1840837734529905401 -0.029823424108068947308 -0.74027677368540678593 0.50917943021825873284 0.0018750591101751189118;-0.20551587507519963882 -0.012940960098048525512 0.37048944824620805294 0.33833007922092533937 -3.8577154974969345425 -0.17123588009587653591 -1.2738070664976439694 0.33007952055966988114;-0.00018248271172722693723 -0.088651179011274783281 -0.16255684985620547089 0.98889568338333400099 -2.4604195907540913346 0.049171295680898841063 -0.06883236605292852861 -0.29596417673777580815;0.33195348308126149117 -0.24807389258101564256 0.7950280940701150989 0.51763077449410532793 -1.4150229010426942367 2.3458260002437913982 2.3564622342066354754 0.30405010973152174492;0.4862565889390105256 0.13282186448241622978 0.1353578267717311101 0.11780208784891668672 -1.3673955007682920826 -1.4838637569823844853 -1.168050929018209505 0.46258629339521978308;0.023399867089727504482 -0.086186155153433474663 0.33280274335818765818 0.52429965434233338772 -3.5342025757480488579 -0.32131353916240101842 -0.82282656718366187221 -0.40065489122594943883;-4.3938564247897042847 2.2093812576181468543 3.5122616920813283237 2.4787171077863985325 -3.8299511156021730507 1.9564198688106748669 -1.8212209580819942456 -0.4409201581263659242;0.051516508081744502578 -0.44259655435327621698 0.18983070776722671402 -28.795079707281868053 0.23588640642369856915 0.74452687378970672238 -1.2295983848059739429 0.97706139835111183167;0.046398762897342897549 -0.48343427853800530203 -1.467830198119370877 0.62569523909752522428 -3.7974060074509643492 2.2653611798703150448 0.016857712724430731072 -0.13214278548649860401];

% Layer 2
b2 = [-5.2057184218468037784;-26.828819192704994379;-1.0865776758636727095;3.0467901769748610974;8.1654900284167126756;-3.3555541509144264367;-10.548471519066445978;-0.91206095951864984972;4.1393243506153423183;-3.8784884216747914643;9.1536822284583934106;-8.4742512337640167885;-6.5842108811556974146;5.345241793324682078;-12.88701737803731362];
LW2_1 = [10.461502379390601902 4.6299300687970665891 -3.3824463347643831668 17.72243349752081798 -23.028070889535268151 -26.011331203315069871 4.8779310920123197803 -8.69554266064226411 15.985380886061717476 -12.976408434277328041 -5.1620382391147652257 14.219602725422559431 10.537465594970466753 25.728608885811446783 0.60345101664627609495 6.4376767148821496534 14.603682521116823523 12.709199639427980699 5.4636384348552082812 -1.5535168113746793406 13.731425026504465947 -11.895395223232039683 -1.608195839676606731 5.9833770179121561483 4.4591245100453633654;-2.6811307935125201496 -9.3327604418153722321 -0.40914939829427093843 -3.7186871410500033086 -15.439917330467922696 6.2757176214978898088 5.1434617164433173997 3.6661018299642473828 -9.5656958520563115655 1.3260736705837592453 0.15424986537176094137 -5.2861185654167890391 -1.7859943449220119227 13.189448699819520172 -0.51715324712591592693 -8.7438653253742195659 -9.0287200348989991028 -16.049342663450463675 4.7175838463389272448 -5.1768681618095353514 -4.461587446248760358 12.823850349686383154 2.2267266227909567888 0.93616967099344594594 -2.8701866694820670212;-25.682837256225859335 -26.706222037594283591 35.906502741979529958 5.645339377928139335 14.848067610581903608 -53.553194658877522727 -13.042257128483168316 -16.299210664239740964 6.9690438197193946834 29.861003645625629588 -49.470488960935320222 -16.631163716700029909 54.493545907660418948 18.811983392345538846 33.540457437612104741 1.3286404854964342093 9.4191020571861923116 -2.8801058799797334409 6.424286828491240442 -18.290971571112660143 2.3904608069454820196 -25.130024814144480416 -5.4153843805344248352 -22.248855160608599135 -1.1068452767981575846;-0.80132121964310909501 3.1534330838357527149 -0.13271178453853557655 -2.3056982576168003618 0.060473979686747746098 0.91382322148146954977 1.8229523916780061565 -1.166411328517152235 1.4911513285813777774 -0.71780868240433381988 -2.5962646766007320132 -0.84502349620059802326 3.6886091477763800484 6.9029950019956078933 0.34018157124745396214 1.142407230071644797 3.2028666330885200431 -4.2386917160441637265 -2.5355057947077508373 -0.42976388278310195812 -3.0975874491764043839 5.4839861956641389185 -0.50188137089194051477 0.44910774789253954387 1.0637229281718234564;12.115520997619354304 -1.9221864557826067177 -0.22309210939287427156 0.33567192395396477922 -0.34644275298590859746 0.58989965448047421148 -0.64816065779410192427 -2.4216610004181591265 4.3779077497800127361 1.6055988673923269339 -1.2756351956324676333 -1.6052099159637585046 -5.8669108224820778474 3.2283509866949278155 -0.44660862416664509622 2.1221749491430017542 3.9560849725687368128 -2.1968308235358291469 -3.2129380265635858471 -1.1048873044682385736 -2.7113484618025318618 -2.5829420338730986195 -3.4325726108307694773 1.5391547767161384286 3.3438125055460821144;0.80162278305796985656 -5.4735815419173112772 -0.058783186380428079088 -3.108534586387537324 -8.7486767605877382437 1.4595063433597812441 -2.1049593533077874952 4.3360250714590673482 0.77669560347904442743 -0.85752689727071318426 1.1313826844705676677 -15.668157529879348289 -2.9792649234876074082 6.2090822929137168273 -0.87249479249170591721 13.160821647495355435 3.8463740862135669119 -12.388236033648512446 -5.0740858464819247331 -3.4695088484197520451 -23.685405136497049483 14.814307738897905864 1.0292744909076612103 0.21042970553861745087 -2.617571271685050327;-5.3893506141404490251 -5.0401877386453310947 -1.301496640667914706 -0.38662905574340422632 -1.8131769592424045179 -6.0127612420853084885 2.1017917129001877363 11.820160195485113874 4.0103030558039352016 -0.73122086040525346995 5.4226777556743783748 -3.4838892290700660404 9.1549426813355037069 -11.547946437127736274 -1.5576020213775294554 -2.9261039662778589587 -9.4053350021583437268 -10.998540764039528739 8.6379708415421738721 9.4951981653276327222 4.2437956600396384843 11.033710094473303087 -6.6818270508707673372 -14.428169207587121292 -11.431187293123883819;1.5565540910648929529 0.61693301646298759344 -0.13637082546455245313 0.047390450024841775101 -0.14797599272334924225 0.48632966942635502683 0.58504031342729689857 -1.1335715499758356462 0.37711706704597097728 0.0066217754187068269059 -0.11117436117917994798 0.15420023856868519951 -2.7056531318232184269 1.5084094918292674237 0.023543177268406226266 -6.7647780489004771809 1.5329514483326904806 0.90433661681849142333 -2.8371908250117696682 -0.40532784898649321104 0.84988324906416012894 -2.21049966561337774 -0.072124862484030854981 -0.43954082368690577942 -0.69124198981161943944;3.4333681483879905372 -1.7047105867990752781 2.514260712339851267 4.7939148576837018467 -2.14686782683817734 -3.9509374060054667233 -4.4072362254575860874 -10.230242592707909921 0.36377386083197510436 5.0460194206112545245 -2.3352278084523505619 -0.34821021161866799742 0.46425176836829279425 -7.3262583690014793092 -5.2868295855307296804 1.362622648432133543 5.1984861139571050259 8.4416519061785333378 2.1906958993379590517 -0.46947699916932261743 -6.8903978726428176671 -5.9735359049658542929 4.0596496906129662108 1.8049032278638756921 -5.183320043176094849;6.1412160663364270263 -4.5674060446430306826 -0.13783886396131575514 -2.2783982943229021956 -4.0811089023110298513 2.8098631767466963893 -4.2242994947509631132 1.0062301347670581375 3.608098172655343383 -0.27833723038122687443 1.8079996103874862445 -0.09940219833539001848 1.815144411925583956 -6.4212743519709487572 -0.18172896795999923802 0.033981036393641375626 2.0302163808596920269 2.6067244754761036418 5.4543187592573083577 0.19175941909274599184 0.76821752593564884837 -1.8420288520509955354 0.80980532123379300735 -1.2645903120037902401 -0.6652132415420283218;-5.1195872557716564089 -4.9177259526746901486 0.3929570849396092358 -23.252368186013395501 -0.85938424192902840293 -7.4010823515923132021 -41.894185864674078346 26.239192411351968559 -19.144922157666808715 14.337456112015091847 7.3018499537792589393 5.2163100643226165687 5.185468844888299067 -17.121961626927454603 0.012531015902908494014 -5.3052632744065135739 1.1670759558286711854 -0.66041215557834653804 16.041679493772210918 6.408178755183170594 21.298653410122167173 -8.3970828654639095845 2.3321311182416470942 -18.076395332854783504 -16.413274993925519141;0.20155742140897642267 -4.0142048020434666356 2.3566021032456712092 -6.8298768585086202521 4.8202740270295532099 4.355725751308969329 -4.1125355537703063291 -7.3948636452662697138 -10.412301322471799736 -2.8491034300494195719 -1.5134843655316618793 -9.9478587601331298629 -17.495132181405431027 8.667049443808403808 0.21111176116773433531 -15.757372737935275708 -8.8457537258038723138 2.2945736825859439634 -23.905683763433998479 -6.9340883175905219105 -16.031624441234381351 -6.8218044444621979139 -1.1292125625694118263 4.9995895664358256383 -5.3137013496269700497;-2.8885059410038746996 2.8975750398924451368 -0.20992919996404790783 -1.8589835604551712134 -1.2781992831492920981 2.7544854386756876252 0.40363553695066101135 -3.5894483265004284434 -3.77749101198623638 -0.058109680842302523229 -2.1177558137293845952 -1.0541174129112975688 10.742774314949745218 -4.8116581137075709051 0.46539152537260641829 5.0749629521439931779 -11.66343601246249051 -3.8676049889017365402 18.480597696077889935 -1.1631527087336321902 -2.803665088825882723 3.5961099839020440605 0.0091069387097278235721 -0.3645426873269106971 -1.5301755620927082191;-6.4084443900041820896 7.8115102579323938414 0.86261438534719969695 0.33965851373093791654 4.0433992820646267319 -2.8654711973955366844 -1.2089179560042593309 2.2031017580770764219 -2.3153413801227529234 0.73161747456526959876 -0.15242225065415815344 0.54278608325235855325 2.8221487194651944108 2.1965798902479085619 0.32805144594857360563 14.495387762641556151 -1.683161664407676561 -2.4874699366632766484 8.3375730712464086736 0.9206060333176058208 -1.3732914778928186905 1.2931573494838608518 0.53269700370640471476 0.73292659429506568092 2.6296724529747912413;1.4881379701079358036 6.3115393786262368181 1.3538227137474778683 0.98081545426568050861 -6.2617234101135492708 4.1524815370106935575 0.63762750128261969085 3.8585274642864955119 -9.5853464273348443214 -2.575047115746046611 0.41029276576355877548 1.2836314223123101996 -1.5856346697196104234 -7.1572060877683281177 4.9637363666638032456 -4.2541579286376540736 -14.902210075987829541 -7.0283487560230497593 -8.5237374809171626566 -1.9681593947402327149 -5.7647231238393725761 12.233886737401295619 -0.95722444134113060521 4.8598948547019347188 7.4647787091834434392];

% Layer 3
b3 = -0.23214071886563644731;
LW3_2 = [-0.012204542336253300025 -0.01439215680634441108 -0.0067360397821618778896 -0.042390035502727657635 -0.051167440609403300189 0.019928413546523887634 0.007877506035029546369 -0.66941331307429574604 0.016383685622591015463 -0.05678565136475034747 -0.0085999535716684612913 -0.014650412088993156404 0.11183520610909761239 -0.10754027671002183708 -0.019445213680082229502];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
