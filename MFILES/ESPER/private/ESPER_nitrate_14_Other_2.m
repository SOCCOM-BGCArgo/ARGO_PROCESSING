function [Y,Xf,Af] = ESPER_nitrate_14_Other_2(X,~,~)
%ESPER_NITRATE_14_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_14_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9997360843843969835;2.7577708242951630702;2.8409253383287285111;0.15816616339896769072;4.4815405267719983229;1.2065365516072943386;2.9622818970972741859;1.0164425523742037782;0.62829640576679601782;-0.081453114175334587199;1.4235782202390276918;-0.032477410979440152206;-0.20436043944247767046;0.16207341088066107293;0.59600521646557014233;1.3230895479588973274;-5.7794370368674901073;-0.43733273448762388647;-7.0768314556291267436;-0.86320055991553656938];
IW1_1 = [1.92736352886266471 1.3103297634078530098 3.5804777522891417796 1.3780941094470291475 -1.5421052689942869041 -1.8253473239399473638;-2.2896534773546939334 -0.31377441529356298044 -0.62045927823369084742 -0.63150753179720486852 0.19857006172427238422 -0.36587805321337690811;0.020067830092252957053 -0.6877654939735320383 3.5854544073321745756 -1.4953221337218658427 1.6687726560451441316 -0.53259572559081014287;0.35255723118714643594 -0.74027949671488391115 -0.15867018237747232412 -0.14984965460332499987 2.0581717370792254052 0.62631883226063977954;0.049862283336767163067 0.3276792946702282161 -0.24903587106166971687 5.0646002827416758407 -5.6243666417947606462 1.1345499716880393937;-0.87308403890930752489 -0.028029297095262896422 -0.37260192845324269229 1.5249212625498962392 -2.0442206181034228152 0.4319448363648592526;-1.1975242218670130168 1.174739793340559002 0.72417086433723865113 0.58249928973251219322 2.0565646139222351074 0.64638439202190400845;-0.21568486703347478084 0.060285204427225361212 -1.2713194516887473817 -0.19226597721989524548 -1.9702998909946651818 -0.43242593647497556963;-1.9025246568290832272 1.191041900404819831 1.6443267174172930822 -0.017845660605920049546 1.3137862106884035107 -0.64028232022655207079;-0.02913947132644447921 0.28336668718973401226 1.2139290468245560461 -0.45478652211565040453 -2.4966690683354317848 -0.89404044050039377378;-0.26130620955180577925 0.6699403725492144579 -1.0145171089502618145 1.5192592675683314063 0.29370717180359035003 0.63877520196242254524;-0.39820077808534054542 -1.3811018107049080061 2.6965455643535793939 0.10376931134503060428 3.1342429711825410266 0.3106139864011197016;-0.24772963552828144995 -0.13021861494560205141 -0.26739294963960530405 -0.0045264664708146232219 -2.0590260921722234322 0.55346037164279371368;0.51844811489288467055 1.0186861140728760144 -2.452674301864351758 -0.53802124526393935167 -2.8392587781517937273 -0.11867152123794455498;-0.26027328483215433907 -0.65671766995317037985 -0.95878801532303625788 -0.16730901141209822414 -2.063960452729087347 -0.4313668387121205039;0.26592344993312477808 -0.025506484071263952479 0.24853172880500620789 0.064719207609265388959 -0.71169083891642292983 1.298785867338760891;0.32120400743608290561 -0.24769675943265773155 0.48284635360601579901 -4.5078888415362472486 -2.5455829955482620619 -2.0213042080959939817;0.46312741726168238365 -0.65566964872778887852 -0.22991306762401025887 0.018206776790047854431 2.6677404311560022343 0.64066497032961755576;-0.40952912741243946426 -0.67064173824452022465 0.065857892813945106969 -4.5902453588032718912 4.5299399713728680794 2.7238846692402773897;-0.59392352484598109896 -1.0974308934521321834 0.069752210407793655 0.66227439908233654009 2.959529812673736604 0.061550467909197117966];

% Layer 2
b2 = [-1.8562795805551477457;-2.0502923751467894142;-0.46712606333258538394;0.24578403802578821513;0.62219136572160349541;1.3070447974210082087;-0.45696054911980260593;-0.91645448542627683253;-0.65244489891578549834;-0.41711758347747762699;1.6075536492982742676;0.89869334315484961095;1.7554035063870607747;-1.7890804652703526934;1.0554836457201712818;2.387195784766301454;-0.035202512135101129975;1.7210901861721497053;0.66393805634662139692;0.094150113414482622387];
LW2_1 = [0.51262586816793909161 0.62702904252151747677 0.39561931193730776046 1.7030279676591058013 -0.23987815141141960451 1.5556145309229112428 -0.43013920394004562242 -0.74318831384107397753 -0.092115464407587999141 0.94703373740620988563 -0.6647201853012093542 -0.32774387760987283569 -2.1938279830362708012 -0.26735245844088273426 -0.60200168747692517357 0.68849912282469671876 0.70467680653201036911 -0.24124999890452997198 -2.8121460004159377633 0.39790585946224332758;-0.20173015437824698415 -1.4428785657237224171 -0.23347932119635286807 1.4005478812750533635 -0.2616697550972075792 0.023686505566652943378 -0.011259725524150041021 -0.9416754874495799621 0.10474524605114075848 -0.68833217438555538426 0.064231955163673803977 0.59734758789818509506 -1.529561363215687475 1.0674505073173039538 0.3672746233095584012 0.82741670394471944494 -0.027304815602485394549 -1.5476031623758224054 -0.28133383047197890736 -0.8672712895534673283;0.39381614872395581672 0.28226962557559226452 0.26156799708726291565 -0.46160719069630540279 -0.27293054106684050408 0.32996549493084681437 -0.51174165384095327003 1.3241772065339287856 0.2494228835681877865 -0.60987572997183792101 0.81185020977263400166 1.2147428214350344255 -0.14161456701419164461 0.873592989082157656 -0.46371883038556699352 -0.51225921145282393709 0.051879423384946755926 0.33901282661854348355 1.001738497928954974 -0.11475339876489494551;-0.82485206408399192046 -0.63395766746726534002 0.74196253681953849846 0.14105063479644702751 -1.0130229464577475973 -0.71942933205121306628 0.45754760720134957097 0.34999536723562851837 0.31105513559796754697 -1.7693656060939217944 -0.056848864180306789284 1.9311640833685019825 0.95692166363000907836 1.9698339947558940466 -0.001350428284563557485 0.076007669079198272866 1.6471844654851126588 -0.54259282084483939634 1.4586460626902348903 -0.019015605221442102163;-0.1272209083292402676 -0.062794019358830804878 -0.08446932492041304974 -0.84578249390786530704 -0.39579192167369769972 -0.17530652567400673014 -1.1774251206358623545 -1.512646115447936479 -0.12970065881963488419 -0.84057802030210682087 0.43573869866445125165 -0.69918906159400351363 0.57613257337629597554 -1.0504078215986643041 0.5655834498602214655 1.5914222897752878794 -0.1325440648129140031 -0.42845733360440646509 -1.707259112293793013 0.97271018770120842856;-0.27381259633719950974 0.8887958115318184138 0.21107299593637252055 -0.68092968834085065843 1.3944721502415871051 -0.49561742334538033683 -1.162212922879925614 0.29447686399057848572 0.17486683883829218233 -0.65932481055989755614 -0.51302171415302855184 0.81345813566103997161 -2.1500812461664562392 1.633395040228072137 -1.3788340828111385061 -0.58875031644875497339 -0.43567161729471948206 -0.066980780090744859723 1.1500267600594991091 -0.27188845204345957196;0.56584443553493213308 -0.64928821721364493591 0.31553222724562368651 -0.32813011559345733881 -0.19836455785381945649 -0.3700493112372942317 -0.091327129904775455893 0.93453710265059442008 -0.11744230926718168817 0.6506381720891698528 -0.40501687708614309003 0.44657536571818301496 1.0174014383017413454 0.91815780545842162752 0.097971995201216993676 -2.3770103290755018044 -0.43001208462736451033 -0.0083009476445333185701 -2.8264301544743517525 0.71367752889477009681;0.16036565666042074119 -0.42139731899848426044 -0.050834984300244898114 0.78889565012165963065 0.43802199498504135189 0.25691978339531051923 1.2579061625973311234 1.3487416670138892005 0.12437931115386188785 0.64935662466002685989 -0.75040020043901112246 0.64998106645983244611 -0.90586767069025164734 1.1360351088951923249 -0.46932159539338991205 -1.5526317362650563503 0.0041977482007120635668 0.17231784138610550805 1.0758806155780866742 -1.0182638505967516185;0.84236461288183517304 -0.26473337854586476148 0.19993582653218563983 -0.75370459948962631458 -0.87088221995054759805 -0.019483801680692039437 -0.82796944680136663752 0.042914078175357389666 -0.72804182624079816222 -0.045939453124385111471 1.1408708202815782684 -0.025476818195953175594 -0.82208362130995804584 0.68086093859620544499 -0.89682473505548299109 1.0926865969794734568 -0.3433933822078473197 -0.7804884177212656482 -1.7585023012859242186 1.607473802347356262;-0.39262228795702808215 -0.049296216698907033282 -1.5329432205721393867 -0.277815874096712212 -1.8289343020237025517 0.22089762127016396298 -0.85552297329823467908 2.9417718672338284414 -0.54918227152931375912 0.16154115165701085632 2.3256956644705817361 2.5205291313664597297 1.0867251844486771617 2.7722585214679655863 -1.2025509260828433078 1.738576259438979088 0.53741192975710860846 2.418817046698356954 -2.4950158396615593759 2.0304134458305744815;-0.029177980086798439158 -0.1001335693286630607 -0.4929254425978008558 -1.4035556036451493078 0.070062986414835964899 -0.3771234601777687101 -1.0508145341768586611 0.18533053913824376613 0.1807016645771497565 -0.38518468024866203692 -0.34823451296271146216 -0.59007952528014928628 -0.61641439214679039083 -0.70925172176914108579 1.0961206225783970414 -0.85885415439279422234 -0.45712897433564309013 1.274647609489244271 -0.38766460269412034156 0.081348503874935862434;-0.55997197197705705918 1.1448335556936477531 -0.23706932931416963006 0.78935825218330490927 -1.3707836125540036054 -1.831139703638905214 0.84307298273923636511 -2.8532691206323566036 0.49294757907334518787 -0.32544212668354099982 0.1745650308730312128 1.5863172414919470832 3.158270340839988588 1.9832555985216682171 1.0584195985028128639 -0.95400517424832964597 1.5724044583239988881 -0.33610243522399652072 0.64534569792348328576 0.15238966105598791834;0.24689116850341827347 0.56807866905662418588 1.6116840181902583051 -1.5608444545482971222 0.36661919096510875438 -0.67485287007754668487 0.4486554915616413064 -3.1388665429701303466 0.30384174247348882947 -0.47900234905486083203 -1.7237607814648234772 -0.52259505327681377018 0.063898592945426158085 -0.57400430981565464528 1.0585973648767807997 0.29298484234004074089 -0.17198750062093801083 -0.64707267841623017368 2.7281414623579904877 -1.2491682157290524557;-0.17122637469608550931 -0.31451554797017233778 0.96249228543813369896 -0.1256198548458842823 -0.31215406383314570071 -0.066365059509081752998 -0.38150156322322398283 -1.4313016105603908468 -0.096884198882362548844 0.17846056488062050915 0.2856585902041842151 -0.47243010741255742069 -0.45964543299652893538 -0.30118003729075143449 0.65242652131424483386 0.25025933651562259907 -0.21400194705050193389 -0.77170014428159616759 -0.40597399145140888876 -0.13748341070567698941;0.6026380942364492066 1.2088115288742480313 0.041462454900813669467 2.2359487642614928049 -1.1359729705085124252 -1.2411928752550509536 2.2580428357659108052 0.43955376131538770323 1.2613983064393454736 -1.9744101390036055133 -2.0492911137424734136 0.70370532900701565637 2.3397600115651644437 1.5036238491909255099 -2.57467580776622329 -2.3912027562860722618 -1.2993477995838607075 -1.101515383534181769 -0.30273002548971561509 0.63591282599254228547;1.3559661128477658032 0.70677725024498672113 0.73074897402707550409 -0.56557996130357279796 -1.5392517681168205179 0.29673478773712858025 0.078856673801374746469 -0.83701627002977119218 -0.28489354786942644449 -0.58641632825688339015 0.86363525388044237729 -1.6333708767599601774 -1.1954120852845351308 -2.1908725816020915289 0.7525353325316527231 -0.064419821222038625708 1.6161713717540364676 -0.13831817421387801459 -3.0832878508266481354 0.065665413390627952461;-0.39056936742709852384 0.68199714709424863468 0.094551802888588443174 0.057361902248697194118 -0.29502505243584487005 -0.78373107081263659879 1.3291953083833534244 -0.72603523098336442132 -0.83875202233802848006 -1.9023420680123588333 -2.1311106033536546533 0.44335593494188441088 0.40165622421667984687 0.277495197434272034 -0.55460228784257337153 1.6690258030737763484 0.24633235258158758807 -1.0510823140616112337 -0.27675906347183992784 -0.13326002115868273989;0.44845207294377098517 1.2998809043236754235 -0.24712259912467304801 2.2879847304031635247 -0.25521288344867493203 0.83568052332964815054 -1.0686657841934206203 -0.28028718554211484726 0.69939268456861414247 0.18263017390224967063 -0.86574267259157766663 1.2226377633353879837 0.47229106719709396112 1.675516086600984389 0.29779595470277875346 -1.5781901710819206119 -0.49150455927423208902 -0.071220798122947889808 -0.054531584623465037542 0.28150288137377055264;0.095920074536516908292 -0.20723440702916290368 -0.5691810067138765028 -1.5895252908229873245 -0.14072085728440292263 -0.62462367054958201074 -1.2380046810378395605 0.69866487517606234992 0.22764794834574916815 -0.23001163967894608375 0.08582747450624438057 -0.6665873262324623072 -0.17397737680142005834 -1.0649676514328461074 1.2470172715256204743 -0.97260546226617827781 -0.67451101783071831797 1.7450181912768398806 -1.4444517226362871831 -0.0010444346122559858281;0.70142896074075700152 0.59331161464833970243 -0.36552042760613101535 -1.3772263215508135925 -0.26121337696865226663 0.065188145032758243458 -0.4136086136101095323 -0.596168849140969348 -0.014334467705881943217 -1.472741194562934508 0.11301173009068089803 -0.79650280440729803733 -0.33541709088510257564 -0.9630031935876633975 0.43744886876547550703 1.6214129015224270081 -0.65103060863087536259 -0.51134793846425097286 0.36203354279499105894 0.68072251580583320596];

% Layer 3
b3 = -0.66957305998995830798;
LW3_2 = [-0.15368163150213223767 -0.77802287539701986407 -0.56395697074810036131 0.41098490005322030338 3.3181310830859631622 0.15425605844979334291 -0.55052534488215676411 3.0002295932665172806 0.13327319993308822665 0.18469659170402624726 -1.2101413547238064616 -0.34810953392105303816 0.31108297315729738219 -0.76595922885802159019 0.043179287939377093697 -0.98034943470063473647 -0.19824314281828425699 0.13584895400074642469 0.88568998729286241289 -0.29752056801239468165];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
