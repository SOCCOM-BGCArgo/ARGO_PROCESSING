function [Y,Xf,Af] = ESPER_nitrate_14_Atl_2(X,~,~)
%ESPER_NITRATE_14_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:37.
% 
% [Y] = ESPER_nitrate_14_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4660073393502632833;-1.7859890977791674782;-2.9992435405424981987;-5.2530871822667277726;5.6593128480545704662;-0.53403919912250430446;-1.3601812241498214551;-1.0670206034666824824;-2.9590944510312970905;-0.37339818616018138897;-1.4063373526604967534;-0.40186972269991699802;0.25628796850204055291;0.53577747411947307388;-4.3167470706313748607;-1.1302902043700320256;1.1912173009072375418;2.603731271880768805;3.3203041637663059937;-3.7987298979128372167];
IW1_1 = [-1.2836635134252349921 0.71427513111128027035 0.75177900634734473595 -0.63351601817055025467 -1.5924655256195583419 -1.1127605139865244244;0.68379971948207107779 1.2346017079515481107 -0.080062059009537681065 0.5585601392509302876 0.94334102048110002325 1.0451180799999204574;1.3525924451979076668 1.9067277780139826326 -0.36566724123793908907 0.31094830558437003276 1.4459758468259320541 1.4061775615070544188;0.46849363845210112434 -0.69892281536508304995 -0.1458586914878935159 0.011704561222727342257 5.6316559954117551001 1.5051204697360531792;0.075625694889812605792 -0.26149750587939923907 0.48575882632887296131 5.4595289033758733765 1.2345807876398273706 2.1236788967900133152;1.3239417235135602091 -1.3759401551884491433 -0.054023656235406967985 -0.036026480386259412958 -2.7878423121142219543 1.6862867445914346831;-0.21994538176979050448 0.20658678689457940503 -2.7065047617471185148 1.0285274425510786411 2.6767862956856522949 -0.43348305839837358855;-0.43508965144878963827 -0.1317806770153675533 0.73348702203410998113 3.1809455837750850726 6.3700892669254427503 2.4244428459530444897;0.14161788764726918055 -0.012392385262182363179 -0.27161006208973165199 -0.036165491575418727555 4.4808336344683734609 -0.92533212079602422673;0.015239652262483941933 0.35760929820033421356 -2.6073830424721116117 0.17094358745056187354 -0.38492393566660815241 -2.0075640094285680526;-0.10024738713686501268 0.14318832554567259563 -1.018486557992630992 -2.2909407617122687917 -0.32326798035296550049 0.59926826024952306593;1.5581169276125288459 -0.60594903990971293872 -0.56600894973239668229 -1.4585309890734630134 0.55349757315760572673 0.37179606479037147215;0.3916784947484393542 0.35024440107943943801 -0.87472801530774013656 0.25726103758275714606 -1.6317381810438422729 -1.3029508274184622429;-0.97015056395699650338 2.7651939660638378271 3.1716373422528558734 0.32806463053193241075 0.6610932257313667515 -0.28140419439242436717;-0.49897371376435156742 -0.26786343713446691961 -0.45975822029203100572 -0.62159742184723576486 4.186878685768123276 -0.87372926101874714977;-0.10721073200867384245 0.84270363491659849853 -1.9019116192143716848 -1.420248232971796476 2.1691825762805940769 2.271055919423690117;0.7653940430138329587 0.65918890378010397413 2.2215528334998895232 0.36227566155885482235 0.13570503218035726012 -1.0076655381988737226;0.65660847110770859114 -0.18544728788944664366 1.3380360490350162728 3.6120730367968669761 0.84914688554926931463 -1.2957136200070686893;0.1987981517455376379 -0.14867124266254921894 2.0089049660083961868 0.5504323028934405837 0.57087276560012800708 3.6840449165659960862;-1.1614718986859191574 -0.92204085670686608545 0.32172646804095955675 0.71992362038248303158 4.1301325293227826307 0.73547621768070181592];

% Layer 2
b2 = [-1.4743724050123132585;-1.3191701862231124398;-0.87377821924515175489;0.23829777642462521281;-0.91329284632682694589;0.55250987244480453953;0.59372554317282455472;-0.46269248144880797957;-1.1168018990099708443;-1.1906052236871798033;-1.5602545418403210853;-0.04290557099521168094;-0.91861980639211715527;0.057769214873770305396;-0.99305464824453748562;1.539003363608058006;0.3001966507453422417;1.9662647785044748971;-0.65633356633346573439;-0.61319931237319125206];
LW2_1 = [-1.0372349037120769388 1.2072909534765143835 -0.82132547828580704241 0.83630736831748975213 1.1731899972512966901 -4.1274176961185862211 1.6179495318859797859 0.44553367887167222294 1.4602045778003496235 -1.2845348749533445076 -1.5714828823887718734 -0.87476308421077164645 0.36651573508516621658 -0.86298165746231947359 -0.19390722035435006831 0.34970114762632387162 -0.69792900804584123708 0.36995091325943751936 1.1477649486743901619 -0.28912640300505693114;-0.30323406852460660366 -0.036412908512148213502 0.38038937525771771009 0.040643364296367293087 0.11241657747702515913 0.072289682108365352353 -0.3618095978731949991 0.28773832509963898074 1.4620747174444068683 0.61339017051577005013 -0.33104670686224663134 0.22142276133934762905 -0.28050759069931596734 -0.20694556610862854806 0.22099597728514305817 -0.033470805541547243855 0.18848545051118861804 -0.55512242268614264695 0.097399054753018535213 0.61709168448719442512;0.53316326324308715989 1.3536831280926937549 -0.88688945106831340581 -0.45454553692512461582 0.12303425259209646581 -0.35843415287466945385 0.65671077854863901813 0.043968089014249166213 0.44911983434247731983 0.2926695380003054292 -0.021103704146789543233 -0.10048746115001055967 -1.0204780448853896235 0.12547157802856845343 -1.0323524962552137474 -0.037430963210242841621 -0.67821970067999193255 0.24158569085378950314 -0.201269766779214071 -0.147061171996475476;-0.27637057354063382375 0.33998371746000011218 0.11679999801521656622 -0.96786383039765944147 -0.70483167635316101851 0.95948920033984852473 0.63601997202539628518 -0.12429055546621489703 0.20027519979628599645 -0.20445031917930342469 -0.6336663410092888693 0.22014832175727702679 -0.40645659915011572716 0.51510256544505050869 -0.1457924640329055499 0.24306028182170327789 0.27378765242443275918 -0.60945360559979178117 0.34937258168186385854 -0.15028391600031654196;-0.00035501112805076846801 -0.69715887098002105038 0.13786945094521640964 0.88241463359591720828 0.071306431062453476399 -1.6647175106771141539 -0.21094615360333993093 -0.77348261250480032647 -0.066981634817145987992 -0.52976168084584474016 0.74282525896314854919 -0.16273738974546617109 0.29444889319670058958 1.0399509199703431683 0.48492383656101401002 -0.47588890241639031364 -0.18976752653360978718 0.40361121079784573196 -0.46354170826324164745 -0.35541843809979878355;-0.5317975812295817617 -0.47478417723604776635 0.07469305191282120393 1.3312097890323724148 -0.35760410667400205353 -0.65877608981687507672 0.22120451863569881579 -0.41308879358989797348 0.64753105747365824474 0.24554745633681329675 -0.55865994498845972238 -0.073826558445612144865 -0.2354921440406297084 0.35550568688945405338 -0.74071683238276553318 0.68613917302379268115 0.46686751703519774326 0.42453436607748296083 -0.57902533245057608013 0.091362349425115133017;-0.65245622274438119792 -0.43666691634307153169 0.12736029927917646987 1.5959209029648300238 0.44920766958938329605 -2.425236881057710292 0.59685138033021434278 -0.055499626408123226007 0.82141708725146578285 -1.5939511670288575296 -0.035066331023505897813 -0.70762705650818136238 0.65112216494566765856 -0.53887124710691669538 0.749386218163690776 -0.32813134177490560495 -0.11791281694058616814 -1.7052485108073607289 0.67745176184476829651 -0.71362418171528385624;-0.39312166211040966424 -0.6726505653037524457 -1.5768916108928578979 0.11972991975528982089 -0.054429600472078211448 0.66270961201944589281 0.23373691097554097351 0.43558700545996625886 -1.0268103348032906474 1.3787959929531308223 1.2163882288100587026 0.58723213650284566967 -0.67900361085564553409 -1.323223356023985664 -1.2207010982203512217 0.38439065034777814001 -3.9956907119744968782 5.3694568494504091305 -0.19520292439284137043 0.97151149975009054582;-0.13647611307260371083 -0.052598703035574116693 0.32752753810429352521 2.3415780115947497642 -0.66268391241745683296 0.13672396051024277019 0.50460966252361472151 -0.90389627094121649531 3.2911611924512969019 -1.3694823211828446308 -0.082557190522862977655 -0.48990464393786176123 0.79882194565960285004 -0.77685294222168410627 -0.10446490413045253498 0.41763615565814471431 -0.56138521779641548104 1.7732809453334077432 0.97032962770869357616 -0.17838149720733242898;-0.43895979044393307333 -0.05702581156865053208 0.11237935530167618425 -0.52717809408676052918 0.16334300406969859409 0.10481705409232913717 0.68325895865423147413 0.06908786563604202291 -0.33382866093231078342 0.33894576068141601954 -0.76828001217373731446 0.18887827646331301068 -0.82804519369886941949 0.8013600958545075148 -0.25898408026523761505 -0.30132266801428020386 0.16074882249165531323 0.040258707270738311457 -0.13755445188162709891 -0.39954642341597962352;-1.3260194365472097733 -0.28388278311789771902 0.13330153172629086167 -0.16357026916035366515 2.0838108732648450427 -0.65793763691126516679 -0.38272754126225594362 -0.54302673718173033457 -0.47810252544382159101 -0.27944218446116142474 -0.032390114752847934398 -0.64644626457835818734 0.20074310915535134581 0.23367903010917126516 -0.27513420255208059784 0.99596238837458250792 -0.71575051129781330772 0.03860235075642536734 -1.5227273553993174726 0.075376957138354974686;-0.92159833637612409429 1.0051260950199678579 -0.66680093365987491705 0.35997277674148930871 -0.83073168003486108635 -0.37055355421600921773 0.88796479084746871013 0.23922492044808424394 1.6247362418709179188 -0.86012726647646930989 0.7756963430358658762 -0.10238629000939314384 -0.33181382101013551233 0.69071006226788789206 -0.094421331987083106929 -0.23975156690045018593 -0.89582525435560300675 0.030961959043597653968 -0.23265777143578850183 -0.058959973317857169994;1.0450950616928693648 -0.84921372014445828391 0.55357260108059924697 -1.8813958025223791459 -0.22477515137862347228 3.093332846483890286 0.95496722101966013962 -0.097777805777264192866 1.8090545105927124947 -0.75845487466863703574 -1.1050849191834160035 -0.53992720184346565393 0.025925956750647207588 0.82096112416771616083 -0.55017373936432611981 -0.2958286833959962725 -0.74722120940209479922 -0.42842305545803965883 0.77677956364624223262 -0.42459064718433858765;-0.56739993670974187001 0.59983818652491927015 -0.21835607207691612452 -0.51770873206476919481 -0.13866900784376212652 0.38948595722565504396 0.70200513890952065399 0.070411250822184870413 -0.27067205974170538418 0.41616344890767309472 -0.99055645023679528283 0.36054638049236192865 -0.89730637322942186085 0.96571391213735080505 0.20577586653423388108 -0.32306335086133952661 0.25971637565006072679 -0.82582192965114420424 0.52249744713056467393 -0.086073810846511403239;-0.90491599458291149816 0.44103655713106060254 -0.51289134481513498631 -0.059494486770830842803 1.6797410684825897498 -0.0887967029885741721 0.12835097064986639159 -0.21047432591168493965 0.3060678287497118899 -0.26335530278231655821 0.17269625993803380815 -0.36338507541413428426 0.17062692478955002184 0.96808663886263746079 -0.58862966735460975354 0.76990579132796954642 -0.64302917871792908411 -0.13023192100896963108 -1.2758640120156763409 0.30413695061159640165;0.61375378948937653334 0.47576430814492387533 0.028953724399561269615 2.4179186741626033097 -0.46584646555403697032 -1.0973406639867744339 -0.17718430538181520473 0.0034443691819295760813 1.0426105586729970121 0.55703611713393696991 0.58564227146507108479 -0.17363820874883095779 -0.41946191321359027615 -0.18928954952039453441 0.02839483430039720091 -0.65577481087247835312 0.3729032346522310748 0.52535916731198617491 -0.12496263126914118613 0.025469131907941190002;-0.63672338192444954963 0.57299905842982290505 -0.063570113438413830553 -0.45813467400929908102 -0.13909507067096477106 0.7763339817454767422 -0.30908714219314359362 0.32149112879486030359 0.52989756569781576445 -0.011302306456253262412 -0.13384351299911895206 0.66480139250266756523 0.3041937753872673289 -0.52955313005881843313 0.64719200156073142249 0.051850542599714881387 0.62739254437258074049 -0.52746914010065981682 0.12609547282419691916 0.60705739670051772627;2.1307094378082749309 1.6293424815027981456 -0.64037992277002331321 -0.0033748258344614987317 0.45813905754000000536 1.5808455992100292065 1.245443177493009701 -0.28459120095784568027 0.56347772301840681752 1.4292383392656515806 -1.6169982121847465972 -0.13245674606122948003 -0.35705070176236208823 0.012884055196388653763 -0.23076175893562383967 0.90351730192706591893 0.99337427170059600101 -0.34110510795523490968 0.8033596246289003151 0.57260499712476475853;2.2706447981422095417 0.26029997255108905385 -0.35207753951033404771 1.0861193490810292506 1.9295569276203190512 0.13833705959006170616 -1.0576686062733842153 1.4149318497708520681 -1.1020242632117440706 0.54277988503055607517 4.5162042251537481974 1.1012926282674944112 0.80192526343854830806 -0.62739193849560204175 0.58919231919865966418 -2.5717094180225754663 0.53556072568173962445 -0.32043125039126962861 -1.8728155808485977829 0.26025597295128982678;-0.050031584093816153236 -0.22980822908455253439 0.3413093284929039628 0.14755024861246554546 -0.025235483596053084887 -0.78251929193994851364 0.045558932392997582295 -0.64995605726693062021 0.0037462431237915106916 -0.79570355902491585187 0.05052877955695463108 -0.19457067564939389825 0.41318888443701612401 0.98273738299644664007 0.83528186119261105258 -0.21752142203120644615 0.60856083665492077817 -0.66092120759148731413 0.33522493700174865738 -0.55070676964836007272];

% Layer 3
b3 = -1.3077314692295212151;
LW3_2 = [0.2230498277948408381 -2.641844776981290277 1.2745796707023022698 -1.7993131401673281289 -1.384711104697150974 0.97838143981666836346 -0.53384196975592301815 0.53425413612958960741 -0.20929273490159097659 -1.9222826394031542474 1.9791365974261425631 0.57767034515967541353 0.50147746900743150889 1.7481866599015900565 -2.7726125965861649902 -0.65569378111826259747 1.788870475981353847 -1.2308839454117255219 0.17653559127623844049 2.2400891750381717316];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
