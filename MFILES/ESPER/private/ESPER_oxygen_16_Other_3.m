function [Y,Xf,Af] = ESPER_oxygen_16_Other_3(X,~,~)
%ESPER_OXYGEN_16_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_16_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.0049355620122000232;4.033305021094352405;1.8196987190980522531;-1.7265645095080379701;4.6915950310972531767;9.0080972264124632432;-12.213689117150783758;3.9533221801102249593;0.71200518727767803107;2.9018699741855131791;-0.19084570842193074314;2.9774237367717559799;1.3537380986382252512;1.6046954037475458232;0.3833491009450753495;0.21184881489546508737;3.1620277788271131669;2.2873146222330715815;-0.62304404478369979081;-3.4394474608812131144;1.507704000770513808;1.8555968816182177861;1.0093359279521740834;2.6855588841829205471;-11.501269702562028741];
IW1_1 = [0.68136085933248824453 -1.4526305411737301387 -0.66426808932819481068 -2.3133661597699983759 -0.42827215441064186985;-0.89232535535006662908 1.5968011813111351316 -0.07165953540914098141 2.6085191191111496423 0.66280246283955124298;-0.77136959964024354175 -0.7856541042355226212 -0.95758031964262824154 1.2435626397009345023 2.3814481515915568721;0.43366865625182215993 1.2428826110917148284 -0.77396922266149581482 -0.31085579341866426129 -0.66132692588336772221;-1.8431547775507830522 -1.0382679407954067408 5.3260010809676510135 2.1022804304221573979 3.6074945403940317235;-8.1228967383351768916 -0.75432830215806934149 -3.256961954120336955 0.508279199781464186 -1.7402026281550768694;0.25165631861833970273 0.30560555816594975331 0.45652931435092841683 -12.856637284099683427 2.8697980395986868452;-0.57951380074633640493 -0.50151774319105280053 1.1350588021524143922 3.9128324288535520914 1.1879511217239733245;-1.0753639676652870794 -2.1785224593878500521 1.7785145158786324071 2.7314511617753618467 -9.0527747573164845107;-1.548785709274337119 1.7713466270583757556 -1.4671048196426141885 1.8442052040096386101 0.57151284464208651492;0.26391456729039769469 0.54753701009921773579 1.2812639261250595712 -1.3623797261103816059 1.6693057899864245375;-1.1007060258534677732 0.21624822696348899864 -4.440948987113867652 1.1998086410980020045 2.7725215062318948611;-0.19605992911850897431 -0.015618175730804210316 -0.52603187478011781408 1.8357344352305355883 -0.08762815468299112176;-0.89435978190134657329 -1.4053695532421750514 -0.24994398190500580204 0.63456606550303373826 -1.1676368924927864601;1.2156665147128637994 1.1450474577267168996 -4.7758621624654686855 1.9369852815952584013 3.7868902083819255822;-1.1391021166946977417 1.1721404762386591347 -0.54719060070495217918 0.11129617200177234493 0.85010794603687778181;-0.68183135481677403789 -0.034751806060807015342 -4.1341369997491526078 1.7990663044589356723 1.5009989283067350918;1.4344362831344812381 -0.80901629754298642894 0.647239067797976797 1.0830831735938313276 -2.2360256388277202078;-2.2894840433956278325 0.029568726294812604921 1.1044301126211963915 0.59686357874150630654 5.8860025731189979936;0.019284520833526382771 -0.088602220187858557465 -5.4603942982642719173 1.1250277583342986887 -0.89084580994770334872;0.89744783123429938687 -0.052870971388643689393 0.67423662190350053258 1.7415096755300598641 -2.4125110670804645885;0.11240252177762123653 0.028198140949015640389 0.16286924740893524155 1.1638390214261951083 2.4592092974228627611;0.37196386210266624284 0.047574825065478748565 -0.017015176624237762087 -0.63296480483619643742 5.4360915795991511246;0.3934088788742663434 1.0370334014420761193 2.6799587232268211601 -1.3788730780101889906 2.2418678399075777641;-0.25282722572713739462 6.6398014466850661108 7.2066286920705397989 -0.63861890113554997672 0.18066089305625115946];

% Layer 2
b2 = [-1.3621638595805005689;-5.9322699194868881989;4.0081986378889205014;1.4724070248056435606;-0.1412219945756665318;-6.0502907489870665358;-2.379810861796722854;-8.546921899621814589;0.80268496181879933626;9.7428351302535780576;-11.743076318241138623;7.2971645646770317839;7.1239015337088913427;-3.4220118728668005303;13.256616327827712709];
LW2_1 = [-3.564563783928583085 -7.6806936136872119292 -5.8541180187487427133 3.9433856578409129945 -0.14979757302509710826 3.3509009792678186024 1.5577834368401248799 -4.5688369491430362856 0.74067038222801506731 2.7190673243006813209 2.5110064139974146435 2.8192967081735700319 6.7941746975097609962 5.7439460690704811086 -0.13502973106160773287 -3.1654127317863784974 -4.8361258969222973292 2.7893404272313637726 2.9233898246357101769 -4.1566032389721705442 -5.6817851490754662791 3.063188957708465221 -1.5863507370592668799 -2.3212039252496983188 -3.5883549561907570613;1.0012657774930220356 0.29636759093675507648 -3.893824448625822221 -1.8819777322546045184 0.37600362078916726993 -0.50967884481862779644 -1.6722093110599154375 -2.0278971794733586798 1.5381160724179718802 -1.2285739104697930291 -0.5142419014547511269 2.0731771059672317037 -0.8813181518424438865 0.98370885633953497607 0.87752085238877974849 0.64712418087394363297 -2.1826794688232755703 -0.88768631833109834517 0.45956960149834252816 -0.48503300619186756615 -1.7026051651873201909 6.5544945588337721887 0.71971665607592427705 -0.5095329054097235133 -4.576073855432819748;-4.3024690298272254552 -3.9384658621858941174 1.2996293998529910851 1.6696923823321723201 0.22982869813809622683 0.61827616972311372212 0.49677987589850292061 1.6825202897124291734 -0.58564040623664814778 -0.7906468236381858361 -1.2119531168884556394 -3.8459545983984151363 -2.2658410475665102801 0.0098227198333155647109 -0.0038780880920444064063 -0.015421931130844127034 3.1359337499398542981 0.39553674253723469789 -0.13369512543552108941 2.7147146973445184237 1.1555213806425768119 0.34116098577783060541 -2.4730161532787935386 1.4497657731700195338 -0.14384385041307201636;-3.5567315315473302384 -4.4624820683110373309 1.6520569334777215342 0.26386335669211191668 0.20180216229449032816 0.074327417544348267642 0.51416504059047718478 0.44732675214502520822 -0.74881513557840573281 1.5807220234544856474 -0.58687465464614740895 0.869923990776122813 -0.29485178179815424437 -0.54186504272311919461 -0.20127736860787986961 -0.27377412603672157676 -1.2243375501972730834 1.4391043722033380892 0.14836810053581547808 1.598000204991854023 -0.0039767243248402771305 0.25395384882440152907 -2.8261280386935805353 1.474488113165720593 0.30235122588405649591;10.509040910217919418 10.652128762513106253 -3.0282525260718125004 1.5136007076888717826 0.31594125502109504655 1.983146989695628637 -0.39498272731077826991 -0.90340126831621980763 0.67186049960803406744 -2.9080396937589529927 1.0018754920556474097 2.9752763371801860259 1.2466211516150755845 1.3851559684898151481 0.28185004116169015687 -0.42094788456271997612 -2.7836654750792231283 -2.111314893818794669 -0.03899458601806194552 -1.4202540075980145673 -0.71736832360998581404 1.5996447793571120233 1.6588972416225835627 -3.2872822437046025357 -2.2691209958992915041;0.46903718946384986843 0.36155576015647516996 -6.4806288327699297369 -2.8299502340113491528 0.13273540708542483357 1.4320522123020151817 -0.99771572860789337067 0.66443617445569735924 1.8225345908948424878 -2.6981813632050895002 -1.7293533589018006413 5.6814012920342591428 -1.9100800557808252922 2.227859761064751698 -0.54444655383749807065 0.54233802646932904867 -3.8757012773348531454 -1.5521826156504798799 1.312761836284630057 1.5870685885679649552 2.7132333557649523925 0.69567412309392950842 5.1875825807516129373 0.91435577303099713209 -0.8560250853495532386;-9.6799949892675360985 -8.0824864416242157006 6.5272909698685621649 -4.3001907832695591694 0.19478117692798246896 -2.9718590524040178202 1.1545469159276768867 -0.54077664604576469731 -1.0559810537540741393 5.3649764585257750937 1.0485576777817176009 -1.8732872999090541821 0.74382809537920624443 -2.2216071483497290551 -0.1710161594466443058 1.8603390862044031362 1.0040609272935079321 -1.6835212235942311754 0.13444207268300290004 -0.5463706489318765902 4.1083495078848919491 -11.66894127463041464 5.1754891499386266318 -1.1260209701812031735 -1.1021191255974593926;2.6790104964930074871 16.474194938680703615 -2.0287565621390615256 -6.4968621423810679616 -2.1782307114594421371 -0.72181375413129356122 -2.6087344761287010186 -7.2112235230421255494 1.0287192630053654252 -10.118671237398004337 -5.0316378966336028355 -12.428587686648048916 -8.2138189730749378015 1.2461211353395647006 1.6381254275048549029 2.7046660634724295491 15.65091433002555199 0.77843995230262763574 3.0213885000313331908 -1.5092559148239774736 9.1407906189597394331 11.949732606183205874 0.79045126321733572006 0.81449858789330942255 -1.6987924376027734308;0.69921855027288948303 3.1405242424481740748 0.71490375273131112621 0.10783704912732415548 -0.42452375046765278288 0.78246226091105086642 0.15086296827622031058 0.541765429827395395 -0.068757792429541761403 -3.2694006877205898931 -0.8437452795798976446 -3.6959170380970327585 -1.3752805833659591528 -0.53743505867660279485 0.068134688063513901279 0.05310847298705941022 3.2883702080855696792 0.27748972282849071469 2.5419165567097678788e-05 0.12063239365572167583 0.45435851936645460514 0.29111687738527314284 -0.83347924032417541884 0.98086836071048211227 -0.84456402226807469891;-2.0919888404660977876 -5.067675841800579839 4.3181245481469012759 0.49563916009072234159 -0.98823158876680605722 -1.4846444442401214303 1.6355442443876047065 4.2364531029642105153 -0.9692644447805639496 3.5186131871939325677 -0.54172295097466149905 -4.1420287198778096283 -1.6524175726406773457 -3.4963228417450746832 -0.99960559632146583908 0.20973051245139087695 4.9787639023144878436 -0.90015016512905177137 -0.79699240297209517081 0.91846773028936157246 4.1992667669317134127 -10.429643818942505362 2.6154785288294926104 0.65557652241741037891 3.765493102864415409;-6.9148952543857538089 -3.7348713744533657 -4.5645379455142327529 -1.1315940305655156628 0.28644085916695039007 -0.78408541193535241653 -1.055287609113499725 -2.1084405441653348845 0.5247101956074441409 -1.4244112427243422747 -1.7035176237873808081 -0.11425777033546002937 -1.3631038765704610594 2.9692177412829141581 -0.22656106869851724839 0.99047963502469149599 2.1859473281800094746 -0.91554999259029656855 -0.73208354071009484887 -0.94636564895268759923 -0.81649695933132693249 9.3342874307305745418 4.2853955618817636264 -0.21019466340470174814 0.98402454500341363097;-0.63185883514949425788 4.1776682273350997932 0.71858467946780890667 1.9413298271807084561 -2.8400758867461810553 2.3922421394548640805 0.7078493613306076071 3.9653406956114127802 0.0068971841809740740484 -4.3219563072223774469 -0.30958975593864046516 -4.9469461126810214679 2.9504321732190490479 -1.345542853229690472 -0.16238311305449121269 -0.69508759412081388973 3.9020696297481807235 -1.8796670741308805219 -1.1255647489751721135 0.050061130140574464087 -1.3192206915501945019 2.4722798580760434461 0.6439761748004266817 -4.119992032421326833 2.131839703049141832;-13.86196451017596587 -17.300803210818369138 3.4226592459696481008 -3.3909683368539469406 -0.084781744577838089039 -5.4342758206625063622 0.52239664379271888439 -0.30978489643557943767 -1.7883031042226638085 5.3892967213130020809 0.67683673022194190683 1.705959461205140304 2.8829493228293929796 -2.1406598447157025866 0.2307386709786315715 0.87354712537987699861 -2.274429520794516435 0.051389796590381016383 -0.047860155620086497485 -0.62772371832917706058 1.6617835901764412831 -9.1569871309397914416 -0.088477528641813782406 -0.99174930794047644333 -0.1660637179783410744;5.8995486318599441589 4.1150508336031821344 2.0578650172823147457 -1.0183961628916022857 -0.8202270714445236699 -1.6894084808633580419 -0.10772964455369049563 0.62332877088305405078 -0.19571713105284138656 1.5181431034300711946 -0.026284923962615877602 -1.827287670427326205 -1.5160889388070861727 -1.5600502646954259589 0.43628884171381826507 0.98194478039362997901 2.3314583605953136392 -0.39124485565593708492 -0.27795970856352897327 -1.2953518743888643439 0.9967380416180061653 3.8655545266587703068 -0.46179098693724940361 -0.33899115877473823266 -1.7026185681053958021;-3.5980865095353120608 -5.7027623789290515788 -1.2627091839610182777 -2.6382024777194605925 -6.3897888444745669645 -2.4457074424480942376 -0.12557023443841644483 -0.17285380953851187114 0.31535480722375408558 2.4087097852111303276 0.56263746902670919159 -1.8493269609291951294 4.7463265523591315898 -1.9841831021466751483 1.254236569697225967 0.058592867967507171467 1.1494327048665176072 -2.8120263367682403199 0.91575950917843595978 1.2448658288054155197 -0.90405899578902371161 -5.8532419667367046046 2.2132988460465079505 1.8850255128538437877 -1.4895041977562852864];

% Layer 3
b3 = -1.3231120646866474377;
LW3_2 = [-0.14768874183820582258 -0.42632761760513593341 -1.019044005615894033 0.92695759626477625126 0.44936339837925592944 0.19285532186503975827 -0.27503999217883379202 -0.30266590685071287359 1.6479323004991608403 -0.31687547763384965593 0.33598814178899610861 0.36448466314574734515 0.38826927056743898437 -0.37176362900436921155 0.67365284584264339962];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
