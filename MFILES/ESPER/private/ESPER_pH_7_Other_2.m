function [Y,Xf,Af] = ESPER_pH_7_Other_2(X,~,~)
%ESPER_PH_7_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:22.
% 
% [Y] = ESPER_pH_7_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4693492794133757862;3.4597365026167832269;-3.1631859600126501775;0.96761335469100606677;1.5733459181046816067;0.74245733182737572164;-1.8516448638748284061;-0.50033346229929476223;-0.017586731303351511857;0.55824385840299506345;-0.1144142294899870016;0.35471776308322178206;2.2802193142479030286;0.18394817607451285912;0.16023355197029345853;-3.8292852025164232366;0.83864415681168347216;-0.1785397887941704842;0.59320752071305893338;-2.866815891459665977];
IW1_1 = [-0.033643998930715818263 -2.2371599714378045398 -0.019073711719361279016 0.17242745926812977353 0.85115415275086281355 0.75393762957567489469 -0.1179951003720345476;-4.4339132721318250674 -3.6679034741840648159 0.94107156175629680384 0.61899709714969697316 1.6159352228518644168 1.3540525402777952024 2.0235107527327325094;-0.36851625979334978744 2.116111546773962182 -0.21186996708835323378 0.41733846700883187042 -1.583274020477369648 -0.15310960186958458285 -0.96339733391281878738;-0.42468553360030236732 0.18218086210585890394 -0.10593843132571502397 1.1593368126794789674 -0.16404611994413650922 -0.752995610413448202 0.81677341270631165226;-1.0479151217668827289 -0.62015823246631174293 -0.77993631304632282664 -0.099614238666113047449 1.8282634682687024519 0.10286267059220217945 2.0482917854204281127;-0.47854165692753614092 -0.52516332931708453735 -0.54141840564043308692 -0.14626098707737628102 0.21882532223024289686 0.19298090124778960464 -0.97254598370899281168;0.70829959516727536428 0.65592509223954176267 0.66108952870515635958 -0.4691657030416357399 0.42823860192308094152 0.61452781676594980809 0.68800350395218357047;0.23984354008767921895 0.36082857395272410761 -0.6123225051773432126 -0.017601088007181825423 -0.75785888564567749359 -1.8678712973515443352 -0.023571025054604403254;-0.9702381819094921811 -0.40761782267246582379 -1.6351163481709283243 0.35623535101443432049 0.53564697883401690692 -1.2586080675543416252 0.33942857429008393977;0.60626281780577973013 0.027702600086088678688 -1.6113070321434916909 -0.18820786972016886884 -3.2493157995050716558 0.83455706449271760405 0.29453458638940060998;-0.78177371525663486018 -0.10673104934242681752 -0.98179647629542754483 0.089027124350382777496 0.23609449012658773048 0.79968065816654632094 0.01130510855001647455;0.19173733980005658317 -0.21770128939208768792 -0.33684935597793713713 0.35850927131183696339 1.0662345632748349011 -0.52684018673259080945 1.0589775410255235499;-0.21515207357950649758 2.800571555481244701 -0.70124889941145984729 -0.22439197233297980549 -0.017948325774226898954 -0.87166990640962493941 0.0057478104906795663212;-0.04494128018001488506 -0.25054422329414294257 -0.099076207197460394727 0.058776851001757099424 -0.82579700562051894241 -0.58996349645420997909 0.011097725168997339684;0.0048068925597400521607 -0.083548939196990246181 0.29447496371027248596 0.084285784895145751672 -1.1380783636352589383 0.69419602366092303392 0.39112914069732457323;-1.2144394747532250012 -2.2543834019564816806 0.5122368882394227052 -0.26286313388373877542 0.32701967758073402504 -1.0040906468166386212 -1.4586761528414760036;0.55858265068358459171 -0.57734581577440302613 -0.20368130692277175431 0.70874077122089951253 -0.33275142552946473939 -0.28447872182180050649 1.3550144424047814162;-0.69223172359529527853 -0.031124765546488918772 -1.0619989023081277679 0.067145621991215972968 0.33776589399772105615 0.91560202786272792963 0.38430064590023677029;0.41038779614115095118 -0.17466496766897104953 1.2416253463424016257 -0.093843056674004193818 0.1362840532811396832 -0.45741924817632495515 -0.11840909570398530648;-0.65198868156188161116 -0.24619523354442648944 -1.7626699042106979132 -0.50455444639760149705 -0.51027568272032997054 -0.32144828349597776018 -1.1101081594301420719];

% Layer 2
b2 = [-2.3147949843477317877;3.935404325028213357;12.19608108645327782;4.9709378012315035278;-2.8979444192838514915;-0.52888627126420006963;-1.7142542959977669081;3.6747644028243278136;-2.5310622712630017617;1.7696481552183658259;1.372259484470419677;-12.490996282064042333;-3.2341303127745679724;-1.9223967906674925832;-3.6288117485384399075;0.33669294800155036285;0.37979458977917190943;-10.328191891142630254;-1.8000037814449101337;-1.7639607549919380514];
LW2_1 = [-2.8867020752436216569 0.11267606491254815448 -2.3371947738252738525 -2.4282421120102313239 1.5459760463780476414 -2.7125891937958650502 -1.3008776028394435365 0.082114536272283641938 -0.97846052690446194688 -0.15234317764586016719 -2.506302507521509515 0.50852993163682547184 -3.1734137048099340106 -0.12750886023423574356 -0.80600461670024470262 0.90115096789630766416 -0.41852650642947697435 1.2044202624362825294 -0.58149349204422506876 2.3255856648784618557;15.248313928219145552 0.10932245642687428433 -3.0300830443715538465 3.95605934474642984 2.0230731301035751457 2.5141344864871859599 -2.9502940034567242122 -2.4320906438863012511 -0.83268114939181525624 0.59301837140216806521 -8.0737183758553836554 -2.5219818485011264997 10.872656003538175185 -2.9106686522361711056 -1.2361405587517124705 1.3355103135696106964 1.7245510199100368975 -0.24296236173606691744 -9.3686414274423857051 3.2581759884521930282;-4.0363281412101592593 0.275010906528214083 9.781468083697722804 -0.81339841093036335806 4.2242423362128187492 -0.29737539463176398957 -1.071335163675611879 3.2356218065753274971 0.84004573175805774543 0.023087357896323962292 6.5948825626786344856 -5.9141993082590698094 -3.9322760835163457216 -7.7204883368253716114 0.6844282341124621194 3.0360073771421629552 4.7795712642086511934 -4.1343952291672847466 2.7494005247516355439 0.74847010494406673864;0.97808768717648930657 -0.359585091826502945 6.0731981946572863862 -0.85690620227483793592 1.3637540534562015981 0.32440422646332950363 -0.28969689142408544535 -0.19716955185319476329 -1.1716453962441135683 -0.15466895848793640877 -2.4324689874207323648 2.6069620546719329823 -0.2623360394555431796 2.7325706245357674895 0.56392734889310636159 1.7085761063049711428 -1.082089273770672877 1.4651373212915252964 -0.74600238001848029334 -1.225294788110733446;0.9063702351167055582 0.015944672058359355554 -1.0886902391921700062 0.41930009270741852578 -0.52705870753915273763 3.7054511955937607937 0.61465644156842191848 0.53338681945965848996 0.31453645982808536852 -0.93608220847734624481 -3.2473696601168371423 -0.027156514628930067401 1.0884025459042578898 -1.5337096305923689776 2.3893572139965506551 1.008449550538409456 -0.17692315029347152611 1.2404317201290022687 -2.6469978154179356622 -1.7791393002578530513;-0.05977126707781000442 0.029980882486465555703 -1.0982129389147230469 0.11423722832422238127 -0.42032896472453712411 1.0709457338721521946 0.36231190240301025529 0.33872772137786910651 0.53152589286582907491 -0.59015665769124858731 -1.302910401069827806 -0.17190202897708325991 0.69280012244956779011 -0.5933194323018126104 1.1324690984758631895 0.29910051034397222569 0.51756228600515719052 0.66377756996127912359 -0.3963287154152189129 0.72914587341117831354;1.8999761073414072055 0.0050734713830651511843 -3.2731096322318276037 -0.39860204730269382933 0.37944965068151337295 1.1932090821547163273 1.0814155213891964991 -0.053710825142720131087 0.7940577711950116413 -0.72312281940695999349 0.52710833242439270041 -2.5588738128675281303 0.88667791353944069854 -1.4495113083664032949 1.1323660959779031643 -1.1655219087440287229 2.3729268773115759217 -3.1983829420278038214 -2.8612066727102103414 -0.17593696035645869924;-5.4325578699271179772 -0.48963906985573601993 1.7005998650856584131 0.20937597631459586855 -1.1344465130368623917 -0.98146804916611474212 1.72697359495398306 1.4254525178451527001 1.7253306145363989099 -0.52973434880405867453 2.0059119095479598371 -2.3466339321176818977 -3.8866399767306099022 -3.6597718271288952607 1.3647584193541104636 -1.2321236965964255106 1.6398580894993326496 -0.24311371007856938387 2.5019656234395344363 1.3275353512536294254;0.81472120003172432412 0.076224451309561139234 -2.0571349257478499517 -0.2348849451617598949 -0.10229023639814280311 0.73390144172003968226 -0.64341863333473336972 0.10554032564640414282 0.12343782785375197186 -0.16608751019862438847 -0.15526929505274092436 0.80270569800360214163 -0.028287179394304081542 -0.23468220310897303094 0.197080170327902926 -0.40083448577825087078 0.016399281907350331949 -1.1726225587559504504 -1.4710418391723838472 0.35663207534814089783;-0.86268607947118614021 0.11857496151523916339 0.72167825502815419192 0.42669266611355588514 -0.75953753523352107724 -1.1633888167713057893 2.0156550173293359407 -2.0126124289625457742 2.541501550354280603 -0.27042830913878723731 2.8482863055485698744 -2.5316520152812835853 0.60783854571176554327 -1.5545505638375169966 -1.0515739620022084289 -2.148814264076313485 0.9370279869360500502 -4.8366810847197703183 -2.1486202699897560819 -0.20584832515198164815;0.92818761624097956275 0.12984556255513121648 0.1331700295494754327 0.75313038874224524921 -0.15701419780592601461 -0.46883838907871877577 0.43716142186508394341 -0.41102887100121415775 -0.44431479585624966688 0.3476256843708245281 -2.6213825537747510452 -0.88662381789576727442 0.3593594536274657969 1.2151311066945309491 -1.1931308067000101492 0.3775978759758079617 0.22991530239445059913 3.5421947197220857717 0.74836187910946205815 -0.46292811434452274533;3.347713471946434538 0.13463727296580652038 -15.717818266030233687 -1.8014863452237481756 0.73834205628233540164 -4.3961549242951347694 -1.7592462849725156726 -1.3353805383520152006 0.48826411228560595568 -0.64284605899050195621 -6.2535529607004161079 -2.9493296618986026836 1.399707083164067889 -0.8737798316611343763 -1.669306969560661269 1.1555635497421694602 -0.083646021953123386727 0.78770469088614236686 -5.788825999000067668 0.72711697428369381768;0.052995629667340428404 0.78132955910641443964 2.8754179496721015141 -1.4530101550339717953 -0.8612003456123122902 -3.5742477206903946474 -4.7992873587658548828 -2.0194408880629257652 -1.1578354897565725778 0.50539968019437109259 -1.796812159221239602 2.1347658209923014994 1.2027161027742709898 7.4405555055937195874 -4.2360786711993423381 0.12586073735374153637 -2.3535804816237955173 2.31699136484892243 0.41532227098189000714 0.41046260635179737664;0.49345238240636418725 0.21574621732183249523 -6.0479039229317823612 -1.6302240071220628348 -0.19073574924039968237 -1.74021144133145933 0.41029268029250076655 0.67246854061695082727 1.3638926665290000972 0.3986229385439575279 5.4708797530015091937 -1.2657113215589386179 -0.85749813098730154337 -1.7202836731596300446 -0.064126934799655144204 0.5659310465778731869 1.7182654430332942042 -3.8159163403153533167 2.3372707957217513375 1.0393485158623285702;-1.4792550756377125243 -0.36853606406810196505 -3.1054837722237058628 0.061807741815054210999 -2.3270003792295619327 -0.43617583931065750935 -1.6596131792127259974 0.21985584592315862706 0.30838242457030290433 0.42454878014401614683 1.4606015931549856113 3.6408114925182730737 -3.0983914537549295254 0.47818119320134855332 0.87964806826458497024 -0.09282609192525771713 -0.85365237179121888911 -1.3350645271447698637 -1.2317323004841242984 -0.080274440445723502235;-0.13061046003599696697 -0.12040282390583748051 1.2482577186528527324 -0.48152439554279019562 0.37659374048190219497 0.38218041274014336039 -0.38632620245114196456 -0.087403850514311098863 0.25897608112771947075 -0.40785972918969726209 0.20720731581053569714 -0.29931076433859227226 0.55098685037199113257 -0.27831089048166646194 0.45549853311024823821 -0.039200882568800145267 0.26355776163109878585 -1.2894011115192192118 -0.62166834332124609741 0.56734243881259260878;-1.8964252371006709019 -0.055240963214934254988 2.3589318415798388173 -0.44244981752833933975 0.66675081655481460707 -0.8567760262143013783 -0.10623523171818266553 0.68942105579426549156 -0.25776006228268238951 0.1470477422471994644 0.23486839822554619883 -0.94932303019542463307 -1.5675955663377352245 0.97938825463713219399 -0.30174516541935303415 -1.0094034755107326173 -0.30139684973079133856 2.5653032614619633023 4.3204409894014377258 1.4147508146450635813;-3.4271899361327968769 -0.59486462126946171303 -2.9605650992297460888 0.025807901343320841653 2.22626597831704931 2.79741900419768319 -4.6424229728799177863 -0.35612760938933429866 -2.1907207383188351812 -0.57155295988804799556 -6.4125239430062039858 4.5056104983007205789 -1.1911858362950726864 -0.51952865277049198323 3.1683180965854607081 -0.57543132811075192734 -1.2498838024851539608 0.81668317835297643548 -5.7998517120922796764 2.4014552886486510985;-2.7363844282276961195 -0.016564858631041717157 0.33041587290851742731 -0.72669170772554769755 0.27586570556872341831 -1.1889248939247352155 0.27050787317324376247 0.79307911193929159221 -0.0094718932688756269506 0.28049067083828949087 2.6971924660950388208 0.11388502618809970279 -2.1265936724311655937 0.84208165888413133437 0.087049557670851776536 -1.184417023952492265 -0.72686436419945765763 0.30550573204524428261 4.2960457469143591425 0.88016106610222466511;3.0709558978057329703 0.24523874588932143004 -1.6842894627972435639 -0.75072059622663001033 -0.66571070339918336778 -0.54019466239228963733 -1.0018274447667825378 0.075954658644073483331 -0.0049430354374716215654 0.46223547676924525707 1.8386437756088045425 2.3836444351870063052 1.9966739982988932489 -0.036147446152280500453 0.76227673417641572673 -0.88218710288485890914 -0.33549470845533280183 -2.9669642080709213161 -0.60161809366031515633 0.63267302611770370735];

% Layer 3
b3 = 0.37151053811969481089;
LW3_2 = [0.46739906113804657872 0.090499892461480130335 -0.25753721705229432049 -0.56288614832823324896 0.65306215485947827215 -1.1543909419680433714 -0.49650692776948412988 0.28835747422764951287 2.1912619162741324708 -0.23201762912871906619 2.0439348268782127072 -0.51000373125798248441 -0.2176497159327155928 0.29148618533782760798 -0.5657023083006965658 2.5202793850744762416 -1.2352818852271265637 0.14431694769857700278 1.2714618940859863105 -0.72140008344276251862];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
