function [Y,Xf,Af] = ESPER_phosphate_3_Other_3(X,~,~)
%ESPER_PHOSPHATE_3_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_3_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.76385616299947745045;-0.92340267337885395538;3.2201198023857657837;-0.95220382350834753549;1.3846871812147745207;3.1724662761869568683;-2.0337872289162080008;-1.4557685846969603549;0.9241321262357127253;0.80214286799889233937;-0.43291226300388824244;0.35007501637588617216;-0.16786691630708486245;-0.41664797967483258034;-1.1502544730801553818;1.8736621766957248791;1.1525719631511002206;-3.0947997964397377935;-0.3177784746704087615;0.073938993742778916229;1.0399389473596596378;2.4249554193365958632;-1.113246646770368331;1.8852904968534598407;-0.13175600792193176147];
IW1_1 = [1.3062397447647848825 0.4008261425773468889 1.4277677127856001071 0.035289897047501767036 -0.014620361203902020389 1.6499663197714604657 -1.5759525713218069942 1.8230070669105180592;-0.45149676534366700587 0.059814485637760671233 1.2983847790111284759 0.00052328234860145393225 1.0092840642400524587 0.31379100157061468046 0.50471036366116017735 -0.49144861315713661565;0.56185507033284920464 -1.3175159904887776552 0.078320801178436885714 0.057100116687467540599 0.9264946292076705614 -0.93893246535676455622 1.4447144575698240843 1.3682296542077296841;-0.18355322923862474327 -0.69231130662709805534 -1.5995691726234555485 0.15634617149002338898 0.13059653175858240703 -0.61721845567414579392 0.31723418775970768646 -0.34674151493296428983;-0.26554589715479798295 0.15452631800438529353 -1.459703426625339695 0.023748925159339018265 0.10078702222174029668 -0.39596217023750074349 0.49218632996484085185 0.64474534821149709352;0.069720873990163703682 -0.70509768794644211987 0.10422422283915766528 -0.085061341479955768219 -5.0371097320431861277 3.7676448987028186011 -0.50474094320183326978 1.0173884183826464866;0.1473035805398915099 0.23492791995124634452 1.0602346419979280512 0.12080694069204579721 -0.15297892486852179839 -1.5512484515981097566 -0.04093517334278966302 -0.047688297151591542422;0.23780704074282132954 -0.38314404986555072874 -0.084567944097846889373 -0.41715238761060952077 -4.6843023667890468786 -0.44064588938386550776 0.0075586701530720012271 0.65496669337610669004;-0.14061251536302288301 -0.22227060975438192592 -0.91603610890642483966 0.22847475888754512074 0.70880424767424987653 -0.68443524600545790904 1.49482136161877599 -0.19132487918272397809;-0.4417078462656292559 -0.33897989155582186616 0.63744845576248354568 -0.15576967407512024022 0.58700600515972800597 0.29577149682658709917 -0.24670396310904171844 -0.52963015997652240774;0.22746107802980497503 -0.10568844134422007708 -0.78284163327464340032 0.083084329131633272159 1.2220147645451115981 0.13482082643673534705 -0.21490829494159355284 0.23318031416475562545;-0.1339167135287015753 -0.47873311159867848463 -1.4112031553310673271 0.21232912466449077593 1.0471676548750203928 1.0526717443301907284 0.093013949304633844473 0.51488078113210844489;0.24299574460437359247 0.23580198225379483956 0.42103762181585452362 0.073038734793340817641 -0.3501878089156018059 -0.98977387395950722215 0.16260782959495312383 -0.29835215859157476759;-0.25020423066695035574 -0.22420907087896649323 1.63253426004119917 -0.040119895036220577789 1.872855195554942398 0.75380523780750752216 0.14181789623560789315 0.13652309847747504112;0.079955761294223229307 0.12996935736854769994 1.1277382235788788734 0.040259615928855123357 0.94782295318435338949 -0.83274976968859915072 -0.12480268630159295495 -0.25636151276675694932;2.0272825970204575441 -1.4055869571130230611 -0.11287636184523271166 -0.3380609463704419837 -1.9713329514186728186 0.7975473173578319086 1.6957168100647870279 -0.60459978581408191367;0.20209676793394343308 0.075369533011602235506 1.4975918116753250686 -0.2184656141293306042 -1.7739947698464200165 -0.60685278701150824343 1.0503952036640884504 0.50134907768939129813;0.27449285553746122224 -0.55664701205837519016 0.34413636565702637737 0.41045543314952964709 0.18233688561967464903 -0.073419891278419482927 0.18290990423900141404 -2.2775491301997501381;-0.25102367646251533273 0.12261555559158697493 -0.61216473409162686092 0.29920557453173712847 0.56607922906621854775 1.0368013107552851437 1.3914968128461733254 0.52910712144395188883;0.43607088994858012043 0.21211501394216816796 -0.98442981922435246478 0.11545524317287725324 0.48846440096632709471 0.092236424027311705864 0.060961936749314368789 0.67607721008298393706;-0.135389322371477272 0.9394461615046352243 1.1058155970620844322 -0.20580298096162796817 -0.47664087188708453846 -1.5260962760165734942 0.13264991529460598563 0.76648032052370906886;-0.27172018173395201535 0.72967701017406350061 2.1779842761413132912 -0.082518119488151450702 2.4927904692904214734 1.0992379169148853713 -0.2829436904814931486 -0.27600781524370593401;-0.65317301781769876445 0.0097303044714712200874 1.2270797313580161791 0.054507942565813323477 -0.36157862020298109362 -0.48321488051740635328 0.34715909397843297546 -1.4014039025002085204;1.1084606072813918409 1.1160001525513523202 0.23883180599862194327 0.74335864264630546749 1.6801988176979352207 0.18306759118795340457 1.6117406883897902325 0.023277711054696233195;-0.68144162784436246305 -0.25981657047073630773 -0.94580963560421082992 0.013895900573426822611 0.79045193244079692274 0.85033280830070212541 1.0974636093826988237 0.92497874379482736273];

% Layer 2
b2 = [-1.3461915966962325619;9.1639263167505671248;-8.7653490333276273816;7.0298091209307775884;5.4183684445850861522;-1.9127237684901607917;-3.1002944591376579986;-5.7204601275158930562;-2.3047246966620522635;1.4759311005391717586;-1.7921561945034119034;-1.2503395455886394672;5.2593707315144904157;-12.374479398992034973;3.0897855751259539758];
LW2_1 = [-1.8158080479721954159 -4.6703580706335126038 -0.77649070796613295364 0.13695814757815261142 -2.0114366972855921567 0.57985411032200517845 2.8590287823085103192 0.15190371775877864469 1.9904208026068124227 2.4835574011134062822 0.69976971574149926525 -3.2146461016224474605 -2.1739420735248522476 2.7455934070427305826 -0.528823539010428334 0.52826188229425152798 -0.62045902145246412118 -2.2663108598600660848 0.71380449464850026509 1.6959436573086419386 -1.3825547566250568909 -0.60296399720007587408 1.3229261306842854395 0.14023737504859268288 -0.21180205751253933233;-0.21406445282552929998 -0.58269227749456653509 0.45677507120879534686 0.24924059824741789937 0.77429584618419211584 0.066284380190314629022 1.0786412222058150423 -0.019446637099615474847 -1.8747125139535802951 0.76387517685122574562 -4.1212543813141468974 -0.23160730004174404084 0.37004420556386624641 1.5275515865464028842 -1.2319183848373049806 -0.0019828710121211792598 -1.0646466027572214497 9.2288641481843054493 -1.777001253532769276 4.1098525790560458404 1.2069499704334776258 -1.0724273163242188378 1.439940239743813466 -0.047756115423603591463 1.175125498075693109;-0.10129185863138499835 -2.8318991347381707868 -0.67777169267608949887 -0.83971395144947180711 -2.5438582730944547805 -0.19132284895717163731 3.7927298853282236379 -0.42214861318495167097 2.4838737974344886617 0.74397648954230566343 4.8279855675665936943 -0.49236988706091355805 0.76527839592069080155 1.2240723421528889592 -3.4315728275537664693 0.14312740901175885488 1.3944431961367249606 -9.7198208294324093259 1.0813479735922824077 -3.2403975024290385676 -1.1100670266157082189 0.4646763291633103643 -0.2475900961743997819 0.22267143893653129627 -0.027101431745154620778;2.6415793160449427823 -0.072857737886627971235 -11.542495860439764499 1.9531003710917651528 -3.2467507516090434727 -0.27871534670309616732 -4.5755791572033412962 0.15873701408037013683 2.6045009897735833526 -4.5348078478890032628 1.4441673874715001968 -1.5454807418725664547 -6.4580677897374814123 -4.7270833367058653351 8.5123900982405213966 0.68064244915338989461 2.0367811396885442399 -12.000864957800859045 1.0223092531572721686 -10.099551739791554184 -2.4604177319571913785 -0.18895706898251302119 -2.9073679645314900455 2.5076135742344911606 -0.61390228253503109634;0.89562435103804383107 2.7886410453427590284 -0.32909205817920100801 0.077223035942770273943 2.0881300450347728415 -0.0775159064922905372 -2.6515371749261777978 -0.37160856229179212162 -0.72766204088161945407 -0.48408528299845898779 0.12638118984446478077 1.3170527255963733193 0.58867689660704924925 -2.1457939270339889681 2.2597403478280457811 0.0067572785740970279719 0.17529926156590869279 5.8531223201947364387 -0.81746608264589792903 0.3522106414487704007 0.67363548167317566229 -0.077533435593506547234 -0.093687133474050596216 -0.364621457798367965 0.46754818719728513665;-0.33165273466199168828 -0.53761371042429983991 -1.9984749731051418831 2.287930322602832689 -0.81626084430604606279 -1.1686199099057603679 -2.1281019267868077627 1.8876030507996957031 0.86407477942924049152 -0.83094036988781028175 -1.542758195072446048 0.15273666185604825585 0.71162168090304089851 0.54463385148337406516 4.7003820472562614086 0.81308812097498084359 -1.689100341586254217 -6.2275855661743149128 -1.1887063034210594292 1.4476155947154891734 -2.1468230330119784099 1.2248876061800610948 1.2572248919192088312 0.43328714406371970913 0.070913584887834196779;-0.32630062049439295668 -1.769236106719387136 1.1958631446027332412 -2.4549396212254555039 -3.2812989610635949767 0.44848204782834166782 1.3206898718881219246 -2.0069499786405757824 2.1121048660987993273 -0.67098175858493547263 3.1187217423549387085 1.1535367150501405487 -0.42802548257333561388 -0.21029855217026635628 -3.821773926683767364 -0.75405078569294325952 2.1365464531068285581 -0.092279920049581160013 2.6967862747112087973 -7.2727268130186217832 1.3433917058124971167 -0.83200490321873687982 -2.6425259129182152584 0.5711625394920167853 -1.1879437740569245285;-0.2402624774805439678 -2.7516311927113448199 -0.43640455625424656727 0.9419883081077677911 -2.8549726956421310753 1.3874316641186166255 5.0796485221867326842 -1.9542551152313629714 2.0619273223198346656 3.1508931929509578218 6.2246391052458820425 -1.7988982916719253868 2.4170718493301870389 -0.28601491913755000551 -3.8347549319066254192 -0.11772338869907551795 -1.188751425880071988 -11.17052033067037442 3.4769388337626558894 -0.89340918919698508738 1.2556380101453348264 1.5124566334123206168 0.49995080596860697053 -1.1132593689027940886 1.6248853610137063974;0.91844753788392441418 -1.2805093326715049074 0.22964079217762725649 0.33591339765831085273 3.2415235218583182686 -0.23233948781170962739 -5.6937755480867107138 -1.2213433280372454348 0.40422920227537695315 -2.1786846620238944361 2.3983734960857625573 -0.066732918313861730453 -4.3016240118936019954 -0.089902100072782348272 6.2803053189899546993 0.019410251872779272359 1.22789571307581169 0.72458219215900743215 0.35220360826020730149 -1.3713448494846733894 -0.1136826137042805801 0.25148379259161190991 0.86269672696859411865 0.72545100799266915015 -0.67428058424251380298;0.46731585369618700021 -0.75090051553524472805 0.010004254165086878814 0.15523077707265067748 1.69039378464187795 -0.39215980236140562942 -0.68824866177680465995 0.5006313400427216953 -0.23087668755930731979 0.30990961375691072899 -0.75150342798325397986 2.8617686081829174505 2.2565013570080001415 1.8610522646511191702 0.068384909001349650226 0.0039868654106860797887 0.93406621721036775519 4.0709881131897365236 -1.4642529949184126536 0.2959394348313227896 1.2877617324789207842 0.81595583998541554305 0.22426808196671410567 0.18550016382454101449 0.56624527620820497287;-1.46245024172209237 0.35814171707246311716 -0.016499429905077987735 -0.57649743820344256928 -3.0578080851570725862 0.11581038214619081284 0.30335229565745780445 -1.6595290277129342016 2.1862520719485547538 -2.7244432697636438157 3.5657245293667094721 0.8187386640646313607 -3.4058626864730578987 -2.0368649464468853161 -0.40044971725895173176 -0.49387809249262681899 1.7460393646957705904 -2.4678295777374610331 3.6528148631021770676 -10.043608380718483275 0.98259374059577297977 0.29383576858635312989 -4.2889185918223171612 0.8411223362327483466 -2.2310037515359031346;0.91031265984716225326 -1.8953745666613046605 -0.019316377547063282721 0.01343737710539536466 -2.79238487583277184 -0.27572748575690608774 1.6802753887378778508 0.30940582193645010944 2.9081823092128793462 -1.0470187970905082686 1.5712125746923690794 -0.87817431856094119169 0.8900731824127274816 0.56006397839491728341 -1.1883777024602346639 0.37244630695607283677 -0.061929905730545388443 -4.1504855403961498084 0.55785285781536508853 -1.878288086649339661 -1.6618931995832784132 -0.50119606928683446689 0.79671066179498684079 0.47532705715974937766 0.5773092678916847964;2.0953515209644981709 2.7937213389209705205 -0.13732760704220622894 -1.5686924459088054107 -1.9736480464912367072 -1.8069819339671968628 1.0207283255132830746 1.5441503659018995798 3.8100394031197746258 -1.6910298614552146113 -5.0378520899357024376 3.3285841373919855535 -0.14849130069797206177 0.2174087433196927599 -3.2343934827641303009 -0.41457882830382108974 -2.1890347569941281947 7.1984581877149143025 0.063506693546481265966 -0.066773885193358056833 2.355938362865780622 0.94154023821765631119 -2.8648806391307513053 -1.5543255840107366161 -1.0159024332051873607;-0.087955747887476648517 -0.014502754286670867245 -1.0207891940004534259 -2.1913464752355991116 -0.13584459781589822147 -1.4034317838367305065 1.4838851515705746564 -1.8550841906530401992 3.1542915068822940938 -0.69019778719130187028 9.4361671398739286332 -3.7088009909110017936 0.20472254599628081362 -0.82365827170169492177 -6.3913106903502363565 0.45392010746555816469 -0.34554455377792314685 -10.4376858600030058 3.1722257798546440455 -10.240628197886321615 -1.7434057356924903548 -0.27279667252889516771 -2.9965445969574124874 -0.82173283963762722149 -1.1701328453926655992;2.2332395058666585363 2.5119729111508215524 2.2347749606900126906 -1.6105663824092262271 -3.7449751595387352765 -0.63749731632966477601 7.0888886551456558038 1.751076771341433691 -2.4041704316024121724 3.2190883201834559202 1.6186205890610843028 1.6883912357528239045 4.6579842529657113914 -0.82359323243976922946 -8.3960955855955408111 0.16953785894568035308 -1.8711974384232932245 -5.8867648226174829063 -0.54687463680016767942 1.270411404084092144 -0.6631161231873204942 -0.17139375340109469503 0.53567915895824580463 -0.55537836237148530127 -0.31522932610484066807];

% Layer 3
b3 = -0.044826447452738359123;
LW3_2 = [-0.23508451766927807025 -0.80805810708504322015 -0.666471792956788045 -0.35358610262564282856 -0.56667006193469859898 -0.3932942553704155686 -0.59217831959632161176 0.19255333025557297422 -0.39401935027914586351 0.65488354165410866958 0.5045626024534716203 0.54822668667881591098 -0.38303482596747118194 0.14280526633960585747 -0.20157479353089330365];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
