function [Y,Xf,Af] = ESPER_pH_13_Atl_2(X,~,~)
%ESPER_PH_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0030026938023133276;2.2956573665380348714;1.7354547729253524402;1.2044442732897966408;1.7420654984455017367;-0.59266180590661798888;-0.89337917827064994292;-0.77424040537669847062;0.13293719680161614205;0.58532824746494849233;0.58499567515182371302;-0.8221313573922525153;0.080098099025153760011;-0.36978957759858832599;1.3789139508310446214;-0.81091681384910341279;2.2903133684021703687;1.5394658528249534069;1.8094054251380151666;-2.5626565867133028753];
IW1_1 = [1.2944837884808642059 -0.61680735666022035169 -1.5766847975198257092 -0.4484539476183248552 1.5008215380292888597 0.9810940599064058576 -0.92314543782530111837;-0.14262439966656681456 -0.65145672473063342967 -1.0883766986089415951 1.7093820938903623308 0.98031628028566530908 -0.33246418995063259372 1.4071207021152252192;-0.023479802136967650034 0.80067280733585832753 0.47038408933562647629 0.83203582844586865264 -0.14216460985305151565 -0.086258856338813402753 1.2450098160264067015;-0.61189447275235075985 0.038690702227013158698 -0.96247189832237978191 -0.50479946059095659461 -0.29894609007586053773 -1.2391604224822911906 0.11830314596491994794;-0.97385832366559266227 0.27110159832809971325 -1.5470525321304799959 -1.0601922505891030468 0.38504930471507942125 -0.17206767250834598126 -0.11863996901758752656;0.28758150595664722093 0.24298249639656771537 -0.34786860107154687904 -0.30721373361091497411 2.3788389305393868867 1.4564005766229843886 0.2592485155837092603;0.28751437300550897191 -0.89588520449796049672 1.142600792612281202 -0.43984231854976790776 -1.7630460874128559556 -1.0436967133482497605 -0.80835114275347008661;0.0026138829741591327986 -0.41585715194283223717 0.77399179959695885156 1.1028610424248761479 1.7689051552084591457 1.2202575157631843084 -0.27656651598678366755;1.5871722963172143483 -0.56596320802633504066 0.75554505564552665309 0.36501080867120933027 1.1999938630034592268 0.066197650708822705634 -0.76282162997036007113;-0.12174586881370628999 -1.0301785968477632505 -0.72851360896148154023 0.82598503798656874864 0.84022336673264930162 -0.42005901572708781444 2.4171107081231153479;0.4766076921899530805 -0.53650167671052495511 0.67589902256968048544 0.37584232910132781003 -2.0419764903305432924 0.89301934897612955666 -1.2068048905681185712;-1.1731210153011579767 -0.47960391539775359959 0.37780134940833132173 -1.1314095622213278247 -1.0703936393289854578 0.10778359344679733223 -0.49903337534022490507;0.63431132044718696594 -0.25894369952063261975 0.36179832613021095655 -1.4538205033505109398 -1.1768620900482997804 0.06031411507086471141 -0.014678214609536039889;-1.0953245949945265014 -1.1027916128085868408 0.26173965822105915713 0.92316045045723804652 -0.98656836978977568986 -0.12200770348844067192 -0.27641665978638446655;0.905388899687663673 -1.0146858600619397262 -1.2949157235216424144 0.66515880221656575877 -0.93303393129401313022 -0.45407278146359802973 0.5293559382554627879;0.18275264107431712923 -0.48439351089416682328 -0.44524074333468771636 -0.46788971424860648085 -1.6993730347754578691 -1.0852865879188822174 0.99845054608081929004;0.17676146389930780245 0.30688762139658065653 -3.0778506032844217266 0.694693308737037718 0.67956716517352722118 -0.10020402442762940676 -0.21291361668129954454;0.19376617857034106329 -1.455518899429249613 0.4096907037722286038 -1.1198606460599216383 1.1224306823377445674 -0.31666456675717602476 -0.33586854543571187381;0.11191251931335410852 1.4573003498849370629 0.58363402408793374487 -0.05185801481142315178 -1.0066717054896219263 -0.49228482359186448436 -0.68581298490692799152;-0.59875017449808287662 0.97028014752404678767 0.90129761537204555744 -0.35727417891138779638 1.0806809267306971556 -1.5597227964447197834 0.28682262948591980001];

% Layer 2
b2 = [-1.6338922489712175423;-1.4274969345292072287;1.301313671910080183;-1.4241709434941729473;-0.79538521753571622686;0.31046084803410201047;-0.88124186194084941359;-0.33029679342210488402;0.69004015833095377896;-0.32372264910497017265;-0.50554404113072215488;-0.034673034899498154926;0.72245747772331803116;0.40760455088059860396;-0.99694998233766962681;1.0602897057178177764;0.99918190892734282116;-1.3345157239394553894;1.5055227576592757899;-1.4347218372372845252];
LW2_1 = [0.67539478204024561148 0.02993349609747049736 -0.054437475758768033574 -0.63870756858899746522 0.47106460842795983002 0.21586476325915063268 -0.24373163956855031786 -0.75540702560996497716 0.63976377855860833144 0.12188493808876955937 0.37961626492004046929 1.3142207029281247621 0.75854798744019802381 0.54426590072277780674 0.057721054890757420019 -0.30882642734975263021 -0.0064049069542028470858 -0.25623445900227848071 0.46892623726405280316 0.40527440298188688317;0.18205738147348224376 -0.9258359791227880331 -0.15829106230590900273 0.39418621392013514226 -0.039426074251714612884 -0.28587332075719373847 -0.75689271239726119145 -0.84000777712211449622 0.049280419404936583183 0.87592326299973499726 0.82876937156496766068 -0.51164114889879719339 0.062779476234272255097 -0.27131137796846777066 0.14632357143859442417 0.084808198099173837115 -1.9485577446468544949 -0.21306662672901724442 -0.16407921134550060294 -0.15366697299247464303;-0.11077197555775462889 0.10515636155638447002 -0.72941356153176784005 -0.052828582260596952669 -0.11030739598470527818 0.15870649167341033259 -1.1279181434234968329 -0.424932623244471952 -0.8353266111717825293 0.70637308559992728618 0.27504904053394857444 0.3582064002407704395 0.30703385940790300923 0.50508171734787099538 0.50883489613435561871 0.9178663203806275428 -0.89636664848121627713 0.58568018698034707281 0.23212478686974058473 -0.5107326315222351365;0.84665298170257463628 -0.99079953479769822255 -0.16364624480637141035 -0.57757687137060209626 -0.31795351607060851062 -0.72949295633685062867 -0.69759956609990481091 -0.30800852171153214609 0.3804594226427867043 0.3672817350160781924 -0.68471207496936481451 -0.58196425570023280205 -0.046832699154334501979 -0.40652562740435255195 -0.47217044129118757034 0.32277531786383545365 -0.77686889671087100417 0.1828055277449102678 0.26719644918497903463 -0.62429925529130403383;0.44105038591667861114 -0.29678373129750329484 -0.46443737616560670789 0.1209308972404234267 -0.34594284184722823294 -0.12216768539510741709 -0.080376552095410155885 -0.2566948435115269378 -0.71939416373355080658 0.76025884441544344661 0.393358377475338028 -0.57056276197273747552 -0.57909992898871265332 0.42542694064669706044 -0.015385303380114954616 -0.36897070561973394076 -0.19267707225245864211 0.4529029793716495278 0.068306218823483491609 -0.77239568218429544011;-0.053500696044710700783 -0.072714881324388538908 -0.69488390316497516963 0.28897731463095310822 -0.56460285945059496271 -0.25603704909255642352 0.047586588566925512589 -0.63482739257081488571 -0.59927715495133482282 -0.19715767054960844917 0.26307129401516998746 0.13536628598696809345 0.26559035705146288864 0.16495654246728141956 -0.12400954900459376651 -0.065714955022400156626 -0.31584087958132095464 -0.45905344726223873408 -0.67786758380155043291 -0.33508853373009583887;0.14886324936028169641 -0.74033172908843303262 0.71805279724162007771 -0.26886077139418007587 -0.35463036080064530564 0.45310453064045519422 0.84364140910052509703 -0.85046577279051327469 0.64741771314958129757 0.050961827843496107504 0.32895906154478166128 0.3938749962091008805 0.0094583664647667538977 -0.093404202743715969426 -0.22679109144423761912 -0.1274815292927915511 -1.0036421061636264795 -0.37860587952410151846 -0.78050911976895087641 0.36184997157663822964;0.66184880356976094617 0.84169676445684615818 0.82234350805327161016 -0.25963346752743865498 0.012501359780413173403 -0.83837968530102102704 -0.33205879280195382819 -0.44153545202680544168 -0.45335425683648750139 -0.038786974462952254761 0.50834363239160973436 0.16207354189987560611 0.13856414529333185848 0.13964761163086852891 -0.55800269728592832852 0.080046040933133805195 -0.5619676963930241298 -0.24450782802551443429 -0.11197865015204533368 -0.66550981103792317128;-0.30441773148704753815 -0.067272289428653625487 -0.4817797958934288971 0.11627848278847641161 -1.0446268173470121265 0.11364304767660288187 -0.081802521626344854022 -0.49155912303944288011 0.046926915263708644799 -0.63789805938131227681 -0.69444919193298038085 -0.011017504315657521835 0.1883079510608736129 0.61696270971972932973 0.92626391925773643443 0.01655920978646060332 0.066060840830316699956 0.091001144126170219195 0.006349402827316109367 0.7066534450157142544;0.24517900159180164299 0.3151967645769931381 -0.63676045881974918661 0.71954591676958068458 -0.35446697727807552347 0.46049112708084516399 0.14722553607004834619 0.20563964146624799656 -0.15004324391174811426 -0.99092896211835934661 -1.4716890019596768902 0.43760377987743553918 -0.040332628067910540615 0.14875776826014625032 0.4578154412523798289 0.74479481867688623886 -0.041981581096932993336 0.089874893181840762035 0.098092244165884703855 0.27064977514243232504;-0.36855745562684333327 0.42603520527818655728 0.21292322599782673165 0.0082155280413461016092 -0.70798767959363118063 -0.41079385881242341805 0.74792863337153092651 -0.91264035223045258949 0.38022282602766183102 0.79541666875923411339 -0.18519058509754202091 -0.77296603906387129079 0.096274966975967962712 0.24242037071698216422 -0.66880118138340216571 -1.3467661057723157025 -0.0062231855341523057215 -0.8119591547571374246 -0.028379870264636782723 0.67318933314091200515;0.33319426462778628517 -0.075570911080857519626 0.6611847407226693063 0.42711850377945143054 -0.12122056338725573088 -0.86465466127272783137 -0.36717560407972910097 -0.31329605736040305741 -0.081710743610318076202 -0.013491628503981261539 0.10032874324453988635 -0.46508093501299679895 -0.3298836045010627438 -0.20044631947275648454 -0.69397143711783526587 -0.63928238886285337905 -0.25594977254236833675 0.011934317245828727008 0.12007126002240012252 -0.3343826911747827535;-0.19057900071795125241 -0.60356638800063289185 0.49471731710323568754 -0.40278360192221523972 0.30042567110251988671 0.39887992737488181527 0.087050028419321134887 -0.13140374778497676544 -0.02008473116435506578 -0.56969679073710699502 0.3513524498809756369 -0.98376669315593723297 0.69809368926775539066 -0.38614870905204956575 -0.62836914061418958077 0.097231055179657535636 0.49462247268439607506 0.47951069357725606412 -0.19524366083374891656 0.82844466251179282867;0.26115203086433969037 -0.13273856980647635861 0.25482389241901487464 -0.52374642925302095087 -0.15431922363190317404 0.18660478445992631502 -0.58869436775745376256 0.45996515590281089603 0.11855732016888193003 -0.67440215274650805455 0.87471514549411166772 0.5710963403204560862 0.3971044056403928435 -0.306813681625174417 0.10431830554469034844 0.38408338559558119485 -0.24182752774677909735 -0.49759999989267428289 -0.76261520842705554646 -0.13945607617897093355;-0.20901473503625478401 -0.13147831001281173879 -0.52482088721988784386 0.20471872818831768348 0.21397165847212351597 0.53058270959573106129 -0.72654734113409846774 0.091062633460622932624 -0.40239444263097062793 -0.18387536725882816513 0.55746436138856259035 0.24514984039261489279 0.22324247631854043927 -0.33888304305155469986 0.26913578567579560241 -0.70668203179411848147 0.46315802734067390567 0.68403300760360308264 -0.33863788471053546392 0.61232601827204580225;0.61635096067710959389 -0.54627022225246502085 0.48652719457314663742 -0.18313097986826074037 0.33217471149757682447 -1.0812313055982427645 -0.65689944219761109423 0.65592234537532156935 -0.059377782412660763678 0.43448095297982031182 -0.77278403878460266707 0.26368982837728621726 -0.15746703371952458506 -0.24375641101278130995 -0.30735752208128863661 -0.67510697041399148066 -0.18966052693464469092 -0.2297462073895111534 0.39175172404632224721 0.34804251154967524862;0.076580518678838402358 0.35657161979023965781 0.82763169094586042096 -0.38300205853116331411 0.12365728149258520263 -0.079917940111054200369 0.54399745315123915201 0.25728944754599014644 -0.24642729282863737317 0.31299811431874208223 1.2442480535032245381 -0.28038282533094605053 0.36751470950622200373 0.24484599823632199889 0.58840724698889868005 0.1214043744581450035 -0.071370998762461501652 0.51672902496111161597 -0.21912210469773676924 0.47049170895898351219;0.1839785105650980912 -0.64277414089999784785 -0.011528434364604536397 -0.40462952714267297338 -0.053908018577331524857 0.24031263937191865709 0.87413997775992569039 0.51348592944387372317 -0.8861397432525839335 -0.6056959769972122265 0.35900716435310719987 -0.63537609465417921317 0.20260727737763309375 0.14909794056684108621 -0.61364242124772150344 -0.11676224959174993923 -0.90998027069235232211 0.031500950970340849122 0.27715586639254474743 0.2718112566708019151;-0.26131325705980873453 -0.82099343590767515089 -0.36787358830876076832 -0.042620297701312197247 -0.10739935605392203488 -0.32469848757190999944 0.7278361751246615885 0.16769815070080745789 0.68651743496478656592 0.20817664378897576816 0.49736008169009554569 0.028731416591467710819 0.020247527982654368872 0.17768573479674212856 0.047187422704827758357 -0.41177426758617846625 -0.21818230527916862571 0.29910012596573121169 0.57961229366992284007 -0.73496008162650328099;-0.10526994307242143467 -0.90688517216192965353 -0.19811754691954525098 0.12459814775209995807 -0.24883839836925428224 -0.4481390094495719123 0.44613642960976723773 -0.043233210130816726591 0.033908238536905846439 0.11087621999323223065 0.72649291537803373231 -0.81180789566524558243 0.60780688413404648784 0.81219470184560682569 0.29477006114856224572 1.0927990705144954298 -0.34987837487869571929 0.68636506614180425867 -0.22479408889522403681 0.68895504751234748486];

% Layer 3
b3 = -0.4743862713922691321;
LW3_2 = [-1.1914303370267387283 -1.6703077503535266324 0.44547448341034318053 1.2444463987554821305 -0.69820708245815099602 1.3609003341203147475 1.1764443949177059157 -1.0253618694340567163 -1.0791012146573208952 1.3202100582678037988 0.81672633894061319459 1.635586655289699598 -0.58039797358328160115 0.47330888342123367263 0.94803447292221143528 -0.95848384846421452732 0.81635543010381128592 -1.1667997337358491095 0.78683157379199131221 1.1898275883074711512];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
