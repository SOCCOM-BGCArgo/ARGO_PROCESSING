function [Y,Xf,Af] = ESPER_tco2_8_Other_4(X,~,~)
%ESPER_TCO2_8_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_8_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8719273506099141;-0.30056848880146125;2.0497426831613441;-6.1098604247358077;4.0995212795960772;-0.30575754571975894;-2.2289043755536491;0.33265996334303111;-0.4372339169855925;1.9485432146796045;-0.53625018102389743;-1.1555493909944889;-0.22338983144433439;-1.1560676510462664;-0.32133926127465406;4.0554530168597571;-0.79965798315782999;0.28220429537548442;-1.1606494553954794;-3.0802316265502183;-0.12585858367249622;0.68172558082007317;2.7852674623837279;-6.9315335249699643;-2.0870339405931837;-2.0244775243122013;-0.38580603387022622;1.7445648731533061;-1.4797663815565365;4.1151715093859345];
IW1_1 = [-1.9034125003462328 -0.23378796359940179 -5.2384785706599972 0.1272911786365622 2.7163689783971776 -1.7078104114157862;-0.30773490138073983 -0.25053578885971101 -0.69823068921069531 0.42664569873294866 0.06335114760016794 -0.020955115925174676;-2.9760620487128686 0.8269472664384967 9.5965551575864829 -0.8983476747621556 -2.8404539399783504 -5.8138801512863614;10.044731944093824 4.2919810430070315 6.6372297274367931 0.87670059685643587 -2.5674852408756692 -3.941457759773022;-2.4480012897869026 2.0443548897863719 -0.43329148154604269 1.6033543595028397 2.4523355119558694 3.6085134601134938;0.8952976743105735 0.092352712439164597 -2.8709895534275343 0.69640411534446689 -1.961448916082644 1.8321972963429412;-1.8736182918491566 1.5050580557105582 1.9422302495192632 8.2800151560780311 -17.921069476971315 -6.6036434405217799;-0.0003031487514764061 0.043156394981544131 -1.4474179568233523 1.988091286755951 3.4960908567406488 1.7813635719390544;-0.51305649373807594 0.81140304629905913 -2.4696732668105605 0.61203181626491432 1.5538247455145788 0.054611214554109458;-0.54377071927747755 -0.56512078524730869 -0.71700129774251486 0.36633220176174042 -0.040681191587527872 2.0571543947999094;0.82409999021218072 0.7714187233436276 0.23723747173065185 -0.49164220285476457 -0.46747623935654981 1.4148814032972132;2.7287953583202826 1.9954898074742675 -1.7367252294726199 -1.2119882422980952 3.3259214137968938 -1.2643428356695063;-0.33047109738328745 0.79996773980442237 -1.7829154338555757 0.51916768632894361 1.6333042743323867 0.2194877568922409;-0.70813357819043554 0.57229135629502048 1.8289329875742117 -0.60557668406589893 1.032899072764341 -1.5470246028476056;-0.42976024825363962 -0.57225382640293321 0.6236499576798441 -1.4122922643001961 5.8584434213481957 0.96193305739674939;0.94302168606805714 2.1846566432497485 1.0467252074114515 0.075749237083628906 -4.1920300061200004 1.6400903020245465;-1.4722780646314813 0.32422988953519793 0.39137365852100459 -0.073394140439826228 1.507417439368208 -1.2730913570423366;0.29824869731021375 0.28471756734531106 0.19251234521563118 -0.063883760711632723 -0.021858291178435185 -1.1515681108055837;-0.69556982235567288 0.55419334124264996 1.826797609727639 -0.60825721387285259 1.0390540382524627 -1.5626409803618075;-1.4158308104845707 0.065058804533934242 1.3424892079756292 -0.72391444251949477 2.2419818626532644 -1.8279171251606368;0.19979899367546872 0.14469881464181003 0.20798327490113228 -0.16098257496532115 -0.2560616054738995 -0.092862289592396591;0.62057990721782119 0.36561144058531803 1.1281017725575142 -0.79438474343638166 -0.22123166259289589 0.20468051040704485;-2.0908481107456773 -0.94567963662662202 0.17634874249640023 2.7524667006030312 -5.6992746875601759 2.1334074737297608;3.0795025882021418 -2.6356643683882433 2.7866015942062443 -5.885979599780705 7.0111119519301024 0.24219831346066939;-3.0122792131193585 -2.3848960133678694 1.7964915369119228 -0.059258478148501985 -1.0286938844362399 2.2256653006472975;1.5017040748727921 -1.879093959817272 -1.2650887034246818 -0.30873205886935617 3.5021388680672518 -0.21333314995616601;-1.6951096456165824 0.57153596189934097 3.0043185878020533 1.5155041681934391 -4.5242881827958454 2.4914373193917907;2.0820473181800923 -2.1642108410369678 -0.82706650546882898 0.48774935776183564 -0.72163883003702523 0.53382770113440847;1.2032167934183455 0.51865872074831332 -0.41702656071385491 0.50740576114756264 1.2946380220026605 -2.2841439375496604;-0.5765986117451285 -0.13043619117331387 -1.1490835817536735 0.56076149413419996 -4.6706936605297091 5.3751512076794006];

% Layer 2
b2 = [-38.864975275866385;-38.97175883802155;-3.6873313882539747;-147.57413533852574;-28.546458055937794;2.8329784588950595;-47.373678157922257;100.10793423586438;52.66783200337084;-14.982165651026818];
LW2_1 = [19.310274786696461 -118.53492219542998 29.831209481780739 35.888078406901215 -73.786513309016755 81.817316069162047 -80.072898178716656 177.79297738290268 -76.424005351074157 -113.9276503232803 -44.575642035881181 -68.499423773448896 3.7076425501122969 -174.92274942215636 106.01340786884495 41.008737869633023 -60.534195427154032 55.724378090930678 98.664297612087168 10.704414502206527 93.569236534046695 54.671933537929149 13.741991556436602 -80.303653898104244 -11.826095325764992 -114.6482171993413 -70.732771527770481 -181.71512391597739 -59.737487641468022 132.36693862323042;39.448423325053319 -70.67771948687178 -19.246598337063539 -15.177669641939321 113.21520545112136 42.905941931575128 11.759174554547108 15.716203629746989 -1.4552685033466828 46.827122774226346 54.498920253908103 -16.400871423239991 -40.212135871715702 -59.402859494965369 -20.121394433678244 -19.89779509862263 -28.382025560385728 27.572175359988154 60.46873406596643 -0.070009162543125086 32.12820717030727 9.5928131869598126 -11.015776503321888 -32.827172064527566 -7.3420707075035372 47.120399513289215 34.054283693616533 22.811310354923773 67.668592510185789 -31.12776585168691;-0.2953883427403472 -9.4678583132745864 -0.026187145405322722 0.023169590924025495 0.12291160630986243 0.66284702515909522 -0.045378668575167418 -0.48841904456989399 -0.90259145368134031 -0.6625200620117454 -0.16928549914170657 -0.37377680378187078 0.72763647613917015 26.259941629018673 -0.2735392741839191 -0.11249434265203882 -0.34484706448528152 2.6148903743841809 -26.37575190077402 -0.6473978904319323 -13.956886344156684 -3.3492352041065625 -0.37457017762201122 0.057336690803068462 0.0037541667681324641 -0.14308583116026113 -0.080329007415641571 0.061576346454372433 0.071642201802620833 -0.30708957306641149;5.9333072340722053 -19.830172579212672 -3.8369996154979589 -6.8665501883467215 30.134284453783017 -51.016916170716044 -5.5718732408608229 13.501247687728199 -26.744704386269134 54.288012787839889 -17.597153908071952 -10.767315720714771 -20.236601386445709 13.598519682104808 -9.2489736251551786 -0.80499890643413963 -16.415639673687895 32.537771262689276 -45.691308029727821 -22.959263162832606 -1.194776346614947 -11.863513811987296 -29.806174369552398 -7.3244669667699114 5.3041223184972166 -20.646834623418432 -7.4361767692120271 -24.00922779918616 20.851510585643709 -8.9841066542258989;-2.5149696911488739 -57.651491155240535 -2.0951287770661131 -0.46752439381435995 2.7388700831129351 -2.9704239580062639 0.77989976157588192 -1.6428266750617608 -15.730039440391621 6.3957474974321471 -19.75074165560984 -1.0322430429679765 25.123704025908541 -73.326902190150946 -0.20927426250052628 -2.8211290776677744 -11.451743336385343 16.305982311170567 69.808380076720468 -7.6878169663696356 -0.9122126710799594 -25.050298991986008 0.39742964953090326 -0.91252757147486652 9.5655760096955742 0.43845420858736284 -0.48752145285539666 -3.7452481337202896 -9.5431199072940966 -5.9998761275002597;0.063199762354579109 10.082296839446734 0.36379311439762341 -0.083050063732947918 -0.52389031241317752 -0.70130085909004702 -0.017496678999284553 1.185708632739662 2.7105908172647899 -1.6831148649630805 0.63641205700105319 0.71486660384842116 -2.8633332400645819 -6.977186371425959 1.0891484136991394 0.21023245307177757 0.70230955481460899 -0.003455345350226585 6.3648766794780256 0.49116969482239253 10.606616232280802 4.7491806242822623 1.0158549085659556 -0.0973399577791349 0.012977756746698576 0.30231637489902968 -0.55295709717461317 -0.03203509525564633 -0.88913832421552053 0.96727875076688608;74.241101062122581 -25.401271089442517 -45.623388034408862 -36.720498676245285 5.7647625531312565 -3.360860699673458 17.924003627858927 -2.2715074819598424 -75.669282051486462 21.42585831057848 57.851164541227988 -58.478333368270732 27.307244209231222 43.078945427575903 -85.292307937967493 25.077317743224391 49.176397743930657 37.87350487168532 17.211301898659698 -33.120266435676385 49.478324673090327 43.922038783837586 -30.317435096892734 -68.288928173476407 5.4874299908433635 40.468492975864123 -4.5958087881961296 9.5685724662698153 9.1191311334658014 2.4354198870917911;82.754394602307727 -22.668091201751565 43.542299486771043 25.419903443314038 10.75604890018036 203.64520553889713 -4.3779653879850997 -52.627222108207739 33.503440306749887 -74.5847601833878 -50.322252079942601 32.535367521955457 18.173455946648609 -49.188278847339461 20.98521020384279 44.890817456105893 71.638833046974511 38.010087373246691 -136.95321049023636 34.190098821189153 146.15370405883863 -11.565146170147472 99.534600018395892 -83.780343455847344 194.65197068563654 29.651519190664395 -60.485623754906527 14.463225504335984 91.283878754245862 51.410254134475835;-9.966711642256735 -1.4089115029671306 28.047471255120936 12.728459610470699 -59.265071737224545 54.90189427731594 5.9298445529050046 19.072469889103754 13.067790732249366 -20.531447564174357 -53.615681635795497 -5.4469304008895731 -23.555982248161481 -27.608543011504718 12.443267954583424 12.85041240847535 -0.32086040892500234 -25.961541348606112 22.440805735775832 -11.338266481154809 0.18753593058264315 3.9480511925297082 -13.61685674806 43.746008183944554 -29.96743673440476 -87.552817919337528 5.2062829444118544 10.657714265161321 -47.590154547837734 28.377547682095681;-3.4400648100753695 75.052813460517939 -13.394448633922764 21.061225167650502 21.549429680184286 -60.095344593150806 83.691222795978206 -63.305206432331914 56.554517299470575 103.96069997106602 74.438746759925522 -33.883671809500569 55.198815842746995 -5.2833463075063785 19.660134734833612 3.9151010022434307 44.017305111674482 -25.891400115154937 18.598375596420947 10.05752461163987 4.7529268692301843 90.715376206863226 -22.897878469435426 19.954040101142173 3.6955231080084672 65.651050393004226 34.886139784243078 11.553096279088898 64.09590752873676 -6.1817823996029322];

% Layer 3
b3 = 0.21932903022911518;
LW3_2 = [-0.0093579305899367492 -0.0079811394514594496 0.90755684066715647 0.016500887708694938 0.059974129595602534 0.32385639565563773 -0.0093769902179320058 -0.00792115662994748 -0.0082312484668060678 0.0058011096054145722];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
