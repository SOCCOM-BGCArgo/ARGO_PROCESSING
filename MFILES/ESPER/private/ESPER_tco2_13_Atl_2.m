function [Y,Xf,Af] = ESPER_tco2_13_Atl_2(X,~,~)
%ESPER_TCO2_13_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.89502346183222625;1.6009700976493855;-0.45954349959221658;-0.05812063328312133;1.8191517640844606;3.1464745790412398;0.59890159172814728;-2.153866024871903;-2.8464068160699973;0.10078798721496378;-0.48818925970573157;-0.78118152975832833;-2.3888918965991928;-0.047357342160508853;-1.9408213634533809;4.0256636391478029;-1.0094951030962642;-3.2629611981127153;-0.40388273105118655;-4.9977584356197857];
IW1_1 = [-0.54567412404470561 0.89019042664412074 0.3381978752146918 0.97598273698607207 -0.20925648137314304 0.77715931948827599 0.049729656449852291;0.048644984988490444 1.0166466514205368 -1.4964624110799734 0.18862045900558602 0.20099293393558565 -0.3603756816535178 0.10012296019853634;0.53475807803990905 -0.94029084338310953 -0.52087632903132808 -0.99453132354785256 -0.18660453136328306 -0.86281632145752407 -0.15132711024148632;1.1598682400644369 -2.3020120170876841 -2.832022390409402 -0.71857083349882034 0.94767620773279737 0.62103852612625698 -1.7401356643865931;0.44823718402192669 -1.2184416404020746 0.13161062223450942 -0.64483593730173683 -3.7955288549389321 0.68253102077329497 -1.1542331494428668;0.077162763278484856 0.9609665852445709 -1.8969814791983406 0.1823076154053497 -1.1305044601674308 -0.20572798868670245 0.065911628837917235;0.022898765709060742 0.12908974810082111 -0.71741836571606366 0.93029954674644588 1.9819746446847974 1.3154461068624683 -0.48052369233188469;0.33953615837971585 0.03985405436709924 0.78964734649448742 -0.38278540673532424 0.036341941778527266 0.10390140316831012 0.14624027008115889;-0.036993627661542725 -0.026896348092166962 -1.5082719087128311 -0.18635359198329432 1.034904611302123 -1.8510479595997997 0.23011594817890113;0.26407830336904908 -0.019337391848834162 -0.18083709081572885 -0.38939756558513006 -1.8858161532230009 -0.21922860764715599 0.088306499001466587;0.22708666931039254 -0.59281573242699637 -0.4384030575050431 -0.30359619177436853 -1.0633174816191568 0.77711577184544789 0.025134089277953565;0.0025911834823020598 -0.23089679132164595 -0.73135494378400556 1.08459799722876 1.6428129984794255 1.5365287950791386 -1.5177390625409644;-0.39641521122083534 -1.9779263640891602 -0.11707189694225732 -0.11021962259231634 4.4491500097651624 1.5527878450544601 -0.80318145263693563;-0.34660352091717378 -1.0700436817752079 0.62900776399758918 -0.55074776256047164 -2.1276007806251043 0.36440007700723631 -0.66070376633565397;0.23414066243584569 -0.30672569141378775 -0.93919414392083789 -0.81109866941998421 -0.77915385770852186 -1.1936171750946025 -0.45273484818646786;-0.32127193615659627 0.49148543596550592 -2.2218096051969045 0.11247041623703513 -0.97280625974835333 0.47714424370689057 -3.4959102899213992;0.98598654562548793 1.8382699372331945 -0.10977349739535713 0.8928286709972415 -3.2704327178389665 0.58197895063512639 -0.55711154312575972;-0.81979951297069076 0.040642138041454577 1.5335846261979771 -0.45541682416465629 0.35538068235437081 -1.2560767270033535 1.6856654444943187;1.2986499917117498 -2.3846239315103448 0.19318468354815133 -0.80683209541643008 1.4325134185984134 2.476956276897873 -0.074500128086757128;-0.54581177556334892 -0.19618087293170419 0.52474469830393466 2.6686219064479366 -1.3164789808545787 0.41023418874144674 -0.0021228191462070935];

% Layer 2
b2 = [0.28664903028339223;-2.5327388213780666;-2.2358354409211225;0.23833209470573691;0.93185385435046497;0.71270790944754969;0.20463406238602838;1.3255163676465376;-1.3305520896608409;2.938645821025526;-1.1713847101827812;-0.0093295835609153496;-0.26133524080898718;-2.6517301664359181;-1.2690682230400034;1.6760467709378444;-1.7283749161182911;2.032256974638563;0.47662785449264949;0.67653265337618362];
LW2_1 = [-0.105903471748147 0.02085771216585074 -0.88102461198184057 0.93042887095528704 -2.9838066330597401 -0.78707012583792446 0.79692909378723698 0.85748338254225231 -1.084800518547139 -1.4504006886268968 0.86029651913526006 3.5337542925609982 -0.36003665746425945 -3.1117840251775561 0.36580007855870761 0.44620679170845345 -1.0445559579924135 -1.8953306361463134 -0.50090420106026301 0.7351196583329751;1.1586114841222956 -0.08248095891128579 0.47181235646141279 -2.4009879771738012 2.0329561557741425 -0.61857896976269178 1.3645878393916078 -2.8595442494789554 1.2896102817690513 1.1087723108131451 -3.5277386466652905 1.1917404073749196 -0.40198491312617923 0.48518016328002683 0.56124797782072289 0.71703037692377614 -0.39358758600991811 -1.8135430152855472 -0.98373857783999141 0.11896000428806899;2.5501231662407737 0.16520859719542524 2.7770476960664787 4.1346440123899351 2.0167787623971667 0.99812757364568672 -2.6039483231296523 1.836764199981938 -5.1335858859251626 3.9503078657818791 -1.1022523092837986 -1.2775054716074594 -3.3730497439679681 -0.21443372802764171 -0.047739415626603492 0.43811661996470608 2.9100789582381759 -2.4779986025783041 0.17196008920784467 -0.44080893349543182;3.6135964765467374 1.6392117427203901 -0.46281688516519737 -1.3888135625027733 0.88971655749477518 1.8977404404178284 -2.6391903911684511 -2.1973208577354866 1.5336809045794191 -1.4333264810803761 -0.52737054968917896 -0.34036287598120668 -0.27172318861190731 2.5709630760826712 1.8551110655791809 0.1206144232549016 1.0636533117484022 0.028361838299773689 -0.17797325281514581 -0.80047947794731455;-2.7744064874560213 -3.5481540289866058 -3.4085198889954396 -1.1890183766035118 0.21716574826226193 3.2295101263309216 -1.198230435845054 -0.22969303989499598 5.5937947673792605 -1.0305572916781103 -0.12854707617632455 0.77888922990448806 -0.65935152150404497 0.3723056809586468 -3.3218639962238004 1.2049212183665994 -1.035935101299154 3.5371750082902942 0.46115944273384102 -0.78442757435563681;-3.4061818395242756 3.4347835774239104 -1.5741832204004074 -1.6828864178632965 -1.9587764558150718 -1.0614818813665285 0.22392839130494993 4.0519466795965018 -0.7899775187134721 -0.46792079643393947 0.33963370775854795 0.76235417265619698 1.960404849710796 -0.18943068011904382 -2.5251922775302167 0.20802617573996357 1.1078261803762071 2.6019232503057856 1.0658407001633665 -0.45466389709718824;0.7675532762766345 0.47316468466415962 3.1625890394003067 -1.5554314339730009 0.6189968923695689 -1.4917285149314268 -0.49836508992696815 0.55808964169478303 0.059745404126146311 0.7409622859801448 0.13096810664246375 1.2060572354383641 2.6761617632206223 -1.7004089599152818 0.75631861780268683 -0.97360539614380948 1.7198526542026902 -4.5330494440632387 -2.137977517713058 -1.5409728280907842;0.50928543202258925 1.7918891882414152 1.0286232297293538 -1.3495297288829504 -0.049156600438868422 -0.15108536701516859 -0.9180272220673924 -2.0809660613735304 -0.93468403622076546 3.6549410992945104 -1.3031712469618695 0.87489928301797382 1.5653394955679951 1.3468488851874771 -0.037224360675536527 1.1305846521985841 0.19398914838445053 4.8050267012361259 -0.49458941277570057 -1.3312182834201598;3.4177727366332769 -3.1165444042582724 3.6351853009059818 2.6558252782217138 2.1098314591295941 -1.3138290026980097 -0.76710893776990963 -0.98455555402067219 -1.6561394734134074 1.7706813688696625 -2.7700313849400167 -1.4928537339924153 -0.20667139006933075 -2.3017947973774238 0.5265840311684824 2.1861007049045647 1.1641433928554659 -0.5898775712498715 1.9737120921132889 1.3787242481554745;-0.66016357724810515 2.403378852510893 -1.4403268744052915 1.9365839120231023 1.053472906643762 0.14595253743856429 1.1722781070618107 -0.61615217106108622 1.5654759790187474 1.4477513377314366 -1.6045837689755755 -0.33840394166271875 -0.95031974256597496 0.80168245205448341 3.6478477559106182 0.038162561793346511 2.038132279920895 1.1099954411099635 -0.11433587956010162 -2.0162559432644644;1.2037467871785115 2.4045949162348501 -1.5252613050885273 0.21735952241049183 2.5980950449666236 2.2201365155293216 -0.65584169839617124 0.82781347772016922 0.37827486944460947 -4.2036386957382046 -1.0037072115889896 -1.0484434939454543 0.55055276592478408 2.5269113850185132 -0.52980339170386626 -2.0651576331613422 0.79993536755916916 0.72005184884863094 0.62987558640123786 1.4872854357421927;0.7649867883369087 -1.1408804961917152 0.26644261183949192 -3.5808661519376859 2.7016107183293614 0.016754583259347724 -2.5985070109507005 1.8753000894252432 3.3530938421512837 -6.5080549680479685 3.5306136896669149 -0.7710820955830866 4.6893814447636899 0.3087213383528819 -1.6734127878972909 -0.90589495268991072 -2.749364001140123 4.3180725504537794 3.0585046695568407 0.16166949822848525;-0.37079682351190157 0.084870613150933832 -0.35813385481491389 -0.6575467618078169 0.69256836254087573 0.88400372830067631 1.2362691378098245 0.89403239764843723 0.64024435476716945 0.25189214177839098 -0.060417068422949749 1.3298833431558572 -1.7565037502905678 -0.96909168291513537 -1.7033019713437418 -0.19717715191924454 0.45988567310574269 0.39839255722159139 -0.82560028546714681 2.4779685805169676;-2.7254820603972916 3.022483081319479 -2.6507291841216407 1.5247183488005387 0.64160616091661871 -0.90615048356533023 -2.3116261775598499 0.15925460977068798 -0.091868059406496783 -8.5841846962676964 -2.6054389171092254 0.20802878068625286 3.26663948116801 4.1211889989269972 -0.89337506984509252 -2.7807076872724275 1.9623271758518774 -0.55651282812594249 1.1054328006030014 2.619549349003448;0.3988285793599205 -1.0573861051269164 1.1209142442790039 0.46043212125618177 -1.8724277811904866 2.4925074402397946 0.30447188137960868 -1.5761013418009393 0.98306418455399769 -0.42446540093611501 0.33807339501208061 0.41922510419857312 -0.41089177366403506 3.1752037825998141 -0.35032535662788744 -0.77247069070364727 0.99304219286082707 0.020746952393784397 0.10661730986614446 0.31446057169798702;3.5602781615362589 1.4718006661804381 0.26816691695850292 1.0880382126543877 0.43603166552838607 0.39657190109314178 -0.35305306926568131 2.145481971221705 0.29253350239517451 -2.6582364752343843 -0.57045227081329153 -1.6397343138420013 -1.6944892690685178 1.1501151691446989 0.78758486793548943 0.056229639905517347 0.69925524022307595 3.7921379334739016 2.1379527982733322 -0.80584228361998622;2.5984653214912572 3.9087025497112724 -0.75106721354118533 -1.8361178830437586 3.5773428405644423 -0.093088972032009193 -2.5448442359307668 -1.0615158325078327 1.5590597904356192 3.1390214192807009 1.30619953272999 -1.0523406014824346 -0.39528722456613685 -2.2431057644990222 -2.6171820254032765 0.41147457199887061 -2.3254466247279577 -1.512024385334803 -1.1683181648233478 0.68414126601912806;2.4321952477102253 -0.39909837386329355 0.85077920402987084 -2.6659524240026968 2.7127397215640192 -2.2984051264481375 1.5669843734287547 -0.31581789649068737 1.51175727916618 -1.5458996191384728 0.27005471067750225 -1.2206522845160894 -1.1865911740024693 -1.6463526593586131 -0.25387954155079961 0.38373054591100042 -0.7306202412253342 -0.43504648791811884 2.4690545309615062 0.68917376896168525;-1.9503166379608716 -1.8344911805559934 -1.5373263290220232 1.1451483359191692 2.5527359408994732 -0.51476420756108021 1.4408253974772147 -0.31349383646871737 -2.7754865811630935 -1.4133925036925274 2.0886102201735111 -1.3712835703355764 -1.5257618239252344 -3.2020020165482252 -2.598908113071924 -2.5814915944370109 1.0864216172450469 -1.4082776784501849 1.4228618692354302 1.0694227583674223;-2.1689756758817116 -2.6545962256906122 -1.8303693909273386 0.98029104940440059 -0.47278389432807827 0.18186887597252452 -1.6031642533188295 -3.4069651778955374 1.4911486859823986 0.28019096517703085 1.0610053533878157 -1.722355070758256 1.6690887510831454 -0.35027207409603628 -3.1115280069331583 0.62471453162474933 1.1224572199898661 -0.83117783787318622 0.64055906172858379 -0.026828526255840143];

% Layer 3
b3 = 0.37574272490980398;
LW3_2 = [0.0016180222681230062 -0.02962763289861875 -0.013146671288864134 -0.051589312470973162 0.11882283773846371 0.037471794780866305 -0.1301551893889191 -0.066824322228341379 -0.018047539855677759 -0.028887534335886988 0.082581235946830839 -0.0050933459730720596 0.64074250764329155 0.007025076143300551 -0.54010809064458409 -0.18187044409638292 0.018207942425579843 -0.12929537803596644 0.029234576025295392 0.59390630382805221];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
