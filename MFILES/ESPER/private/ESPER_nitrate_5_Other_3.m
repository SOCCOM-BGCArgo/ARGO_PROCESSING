function [Y,Xf,Af] = ESPER_nitrate_5_Other_3(X,~,~)
%ESPER_NITRATE_5_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:33.
% 
% [Y] = ESPER_nitrate_5_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.88074495101057770352;1.8461189204865973146;-1.0798729630898826759;2.0849653626683024576;-0.34943367250866930185;-2.0055785114380557665;-17.852382619662595431;0.96135585747062801687;2.8992133581537729015;-1.6497783024904013605;1.9336798748985524199;-0.25681752725260637016;0.39946788368323321583;0.22580643661347463147;0.24306390723761736594;0.47747248576001055653;-0.76340407747036687081;4.0793199003761664301;4.9126461207227603012;-1.3483442973732935322;-1.0318492448849383436;-5.8407474366754179584;-1.6875957503322451814;2.1537738955069882785;-0.80649049774950620773];
IW1_1 = [-0.14982828972248393717 0.68005390550919109227 0.81633318366406437683 0.22030563400589872614 5.1279342929912257176 -0.020667384586144650627 1.193688413091639422 -1.3899434913528807556;0.6187664481841286257 0.72744644639729860724 -1.4314827670061667231 -0.39218507176163869277 -0.96956687398689611612 -0.85501874468068161939 0.43813149946247054167 -2.0359184341596359147;0.0023621955462784613618 -0.016744886940082973764 0.38616722075370951694 -1.2584527660030864205 -0.07438355208942588892 1.7305860964737898033 1.3595172651611810988 -0.13381852127022877963;-0.22791777324359405177 -0.0079406828749986405058 -0.37770681446217724275 0.8176274107749670339 3.0176102965297402214 0.89727965786921370928 1.7537862651778977074 0.044800355910219941125;0.023067119162751795192 -0.048845717806631640256 1.9140739899285681425 -0.42690478465174647171 -2.1597948056362930025 -1.8766934912518833389 -2.7452061516141954556 0.059518510819301956305;-0.46463682895237407022 -0.70835384492704922543 -0.86678024001110609564 0.25888369997852306303 1.476019695062330106 1.0236698131334045492 -0.81024028463367925301 2.7314570949296594904;-0.95393405255966656764 -10.247044354039276826 0.23508772776046019115 -7.1198825571686672475 2.98492892639864138 1.3547744550989035961 0.52523522893931795519 -2.4083516033391978439;-0.36577332690464425813 0.12923664223869893442 0.10051071563232824579 0.40941514159731190459 1.6078509377065102193 1.319202940630835208 1.3511473347240128273 0.83911764822769041583;-0.39215323401013529869 0.043267666243727506692 1.4184608444174697794 -0.19632677988793537094 2.7696764636441648655 2.0912024934337960502 -0.73313966769645466659 -2.1848107861214867143;0.40609964094951428448 -0.102510993179022597 -1.0588499388055732098 0.59401257838723320326 8.3633257493156882845 0.49496724096573480045 4.1615116547834123395 0.02032864209892229837;0.61478419684981733262 0.63951600089048321607 -1.6613653640337464612 -0.41220236872149934593 -0.20345941305895523521 -0.94799915027230141629 0.17985304487362049897 -1.7433853197758522047;-0.15960838608570582231 -0.28260860319691399889 -0.21123961222652748448 -0.77488161317053538824 -0.78697071786848182828 1.7364258436856006007 0.39371752200420084833 -0.7772280746094366588;-0.067453523235604884167 -0.40326324458015289087 0.36051254029637647136 0.042740001074425805483 -4.7209288113763561157 0.077914963840711171095 -1.6393403168677662674 1.9471279954524134403;-0.171418181958545357 -0.13607674968965247086 -0.11242284362066704007 -0.72020973977432245494 -1.3483494567513734097 2.8341872037323572187 0.97825425786467024025 -1.1094608848871747586;0.050785980439939489017 0.14144715746604127893 0.76770308956694544023 0.66769647697577905188 0.056796994988765739376 -1.8146017275071641972 0.62712489534921644907 0.057203530101570698729;1.0552447387716155092 0.44728410545213265204 -0.046077963118432173351 0.11680951142992837544 -0.1702704981068456358 0.25351047160807044234 0.27578808622774630965 0.22483164896942123279;0.0096042022212437291179 0.27305923780200463957 0.4603022971088510662 -0.52408893452886184949 -6.7439063814898840832 -0.62815972728447855289 -0.16592561932430399674 -0.22288706205845318364;-0.16616657195082701337 -0.16309115468283791328 0.6630604035563648635 2.4517460872411844797 -2.1883063014077346331 1.3351501035636184067 0.046179044190563477146 2.1758911221232790645;-0.74191217649267249268 -0.34626670335508452636 -4.2436210005220855734 0.3417477892221633673 -0.94486446686009006868 2.9675982108298128992 3.4415893854362584747 -1.2557257579194975872;-0.66865332319164061392 0.0069284366538887812853 0.73788789318952896501 -0.16213602421854952929 -1.1274990874972352639 -0.070193437093396551796 -0.72369825713177804438 0.18915246147023478951;-0.26078628684811389071 0.17529602769698754416 0.53885477677580473355 -0.15138954451547109725 0.71432483424828474572 0.036572692355123392893 -0.96032747087147307674 0.37810178567512442438;-0.659621653204733982 0.167767488635969797 0.0077150089230952501734 -1.4080739119782188506 -0.9610686075387293581 -0.81560811470513794319 -1.7816065300002719152 -5.1366093745954977123;-0.43498948501093825936 -0.11459577178145791132 -1.0688580565200800354 0.03348052497397571714 3.2469455820432240323 -1.1574769685201362623 1.2629575478285912649 -0.080296643390759758763;0.31273335449516870277 0.090902291549652319835 0.59579062555948625324 0.064469786855152977356 -1.4755250079814519193 1.3628905906516326496 -0.28577929191259493491 -0.15682150138439057696;0.017212011250263087314 -0.00093602883631444477007 0.13853495254711642448 -0.089333649111605711868 0.64915193632420653547 -0.030382376595727070973 -0.48415196103908003655 -0.61462206313385037149];

% Layer 2
b2 = [-12.870502090035381926;-8.4499842549087063048;0.44709745278725915307;-5.5672816600168886225;0.1920920494884638674;4.1077186259135309854;-4.2467816785264238533;-3.7689686134745343793;-2.50783991783906135;-1.5564978661071389165;-0.78553502788594742334;1.9666428950913685814;2.1122241357203241918;-0.56875460675532341082;-1.5630350226444669204];
LW2_1 = [-1.8373807975424463201 2.2526688540584887122 -0.25134190980699483431 -0.32074900577039616723 0.72986333187262619759 2.0037143369809715665 0.11998951281810461833 -1.444701648124311566 0.52586081522891658935 -0.54828047161312187807 0.051885283175648208576 0.24041173989610264972 -2.5686087550882601427 0.55242351068283634952 -0.20518087763962680747 -0.16230671376730643196 -1.3936155747917045034 0.45319235273309260714 -0.34870946895840110313 -0.16811304270978888464 2.2239992555671070917 -2.2612870779810720911 1.6832813928813785687 3.7875394786456477725 -11.976517788850028268;-2.0068331962650733935 -3.3170917143348468414 0.50441666642287186217 -0.70146920267815193739 2.4089307817374390197 -4.3213863406807444534 -0.60499955395022009252 0.26693888347762267932 0.24692771333621152396 0.80079006868591595669 1.1473186642241435251 2.4207084691913602903 -4.462550480218878235 -3.5651444794306312858 -1.6410601970378178027 -0.37254162839065829704 -1.7593359924556088991 3.4483419393430532196 -1.8853818907884161149 -0.25196157386577205939 -0.76171988374984112014 0.3864155377384546064 0.66301025132409807661 2.7690815219422133531 -8.8488008180485682175;0.069561580544271237048 -3.8105298596962553503 -0.08324892555218280088 0.44184091533069796975 -0.19102697341490806893 -0.59817961385589757395 -0.044924484857555006811 -0.11206838382257416908 -0.079320171429386368556 -0.22186453931627883596 4.0421899778482988097 -1.1420197677243764112 0.22989082943515004587 0.53623603686127796486 -0.94439450535928293196 -0.046714096836673081603 0.31123906665807410388 -0.19644789795107042707 -0.34044431356006810141 0.16056226216937505291 -0.46555213100396536374 -0.19802900009412052751 -0.37898793104656502972 -1.8760261035626843995 -0.66469635759132683628;-0.10763554047193536756 -2.2525730133951347156 1.3533732905142972225 -0.22998502468472090121 0.75076885242084689942 -1.3728132797343013394 -4.6668121083383997671 -1.0931157411662328904 1.2061097725888072496 0.37778190486428331329 -0.043796851211439037643 -1.0945679786794442201 -0.68607070207833520392 0.72177310186872900566 0.12603825028026388599 0.099394422388330613827 -0.69005182968494338525 -0.072646100995818460588 0.30344875553174405214 -2.0636315309843151766 2.3522110190314280409 2.0632718350412493358 1.8002627709708449721 3.2070969141695884197 -4.8047295746915983372;-1.6542168758955992924 0.64693684596533540532 1.9387533921542698945 -4.0967542332235931113 5.8858628093608764686 -0.80732409347839084734 -1.8015399675057950368 4.4197961146239661545 -1.2815581042898822606 -0.49727752779373829428 3.3590145333909218195 0.2385185671467590085 -0.20544912456011613089 0.94179146164830029875 0.077885564986705527191 -5.7141340240166211828 -0.1601325614478588677 -1.2449614473234802414 0.53695990097998158586 -8.9724604649067156714 -6.1230316768184556153 5.3174759881145590157 -0.34935837207543662952 -5.2617107273585466132 6.126551032202938174;0.26260996639365896677 0.66160475622074799151 -0.21076944918086668035 -0.16200480232580061202 -0.61185314919602939998 0.70197269313653565259 -0.0088213113488008476626 -0.57886639090738023494 0.62533820515084781455 0.28827092812166843494 -1.4359398556113094347 -0.21954192888795204253 0.61457242144669943507 1.1150803712124794931 0.77022914245983598036 -0.05719189788121437773 0.34963185389150758242 0.14149477194267914837 0.094491485766524330181 -0.79100487797222540642 1.7267855763826525095 0.012026555389240349558 -1.9516180970638492553 -3.2160280879895482009 1.4833909386661838781;-0.39251351866904982124 2.4192494997446818417 -2.0169583909360078167 -1.2229886934652725028 0.3567780913129960374 0.23444933156074942993 -0.619716385556378202 0.5034741037929215679 -0.25570573899805731921 0.27338998280681953146 -4.2394852672334790711 2.407157788440175139 -1.4530485658954559458 -0.43380437787152492657 -0.081489580742889242138 -0.88604371509792856365 0.16903105918955657616 1.4682227913784444695 1.0834367874610690841 -3.7694699258575106171 4.3168197468855922239 0.96930296867068466149 1.2961060882338102385 5.1776677118399936361 -4.2696564159411378725;-0.80831460516810793582 -2.432469972358996646 0.15710389597195822953 0.8595500679777504649 -0.81628738010880430576 -2.9447789285120609115 -3.0739886224062309417 -1.9491600073201400534 0.9731366650170119037 -1.6590610658856603798 0.25069141093255675745 2.4548278184206520081 -1.2981524266109754073 -1.5196336965515084838 -0.62709819465741722944 0.13739403274851183512 0.26035125531425157286 -0.66960494965727812566 -0.18985597377728999358 0.21268620989561484724 1.9835814785768590696 0.49986781968756366368 -4.3188683625761399298 -7.1194507630237380269 -2.5417015598110972441;0.5069329897464772694 0.32529349783870281643 1.2458899218657957242 -0.75532067151444137743 0.49682494974487684258 -0.65924124348661239381 0.89446795236296405829 -0.48377568391524811142 -0.19159599739897387183 -0.011090096982637845033 0.59131731909358220545 -0.99922712792846457575 0.012982753938170176616 0.27828213602358492507 0.015196722147326764685 -0.64030842189806713716 -0.84632371111645299244 0.36036425702755303657 -0.63643846155498429162 -0.42621183913840154922 0.32404152882427733617 -0.06132353635061139896 0.73140143367323739998 1.8823937590783341722 -3.1910755741942882224;-0.2098228344362878528 -2.9227727825440723564 0.12486457105323665873 0.32099386333778151537 0.21752193233121819294 -0.99007034085561262948 0.090102431118521203457 0.26120769342974686777 -0.47731293268304930688 -0.41827819672695015774 3.2825801501328673027 -1.3744527558336765427 -0.10948551662087703529 0.45446839699953600622 -1.1689961849109933301 -0.17049665630904498048 0.21619289517372583531 0.10255926922261786316 -0.29415511707735825242 0.19046897684718616661 -1.0649926137763572331 -0.18636706884734130507 0.44459901833252152281 0.31620955177732179564 0.22212962749987849587;-0.1473494345736448552 -2.9774939893333245422 0.0062441359556357888677 0.37616279321884033005 0.067349812558778102134 -0.73440145846053084266 0.053348851903694420595 0.11995021037944189612 -0.3303864156458780621 -0.347044442409345677 3.2257903548433484175 -1.0996148194724870706 -0.032584783035523694206 0.39244321503937695805 -0.99152612759872182924 -0.07897593257801095723 0.24521676572101974712 -0.013997587130274618053 -0.29532566494813144997 0.23032285131561464064 -0.75397011432919702756 -0.16914059117311416869 0.18395810080273156117 -0.31425279872003247794 -0.14176230175997828198;0.043162570522594194411 1.6252160856088859742 -0.40271840932842056793 -0.30722527944216626583 -0.34727862673464526821 1.0639419342204996521 -0.71946725733526917246 0.94363301345599193137 0.3814135927545990179 0.39889933636194768729 -2.1335166607523241566 1.5776079428356040157 0.7586846703097337441 -0.28356746348496653098 1.0121971027225780126 0.13806735147379300965 0.053264174867871966201 -0.2862215968025615398 0.84386168656499105367 -0.27166181546543466396 0.81233476836155338319 0.11162494341502379736 -1.583001148366151245 -1.7069439484937987128 1.5304440502011422698;-0.49807761404862460619 0.069715973397715874649 -0.84318352112055328096 0.056741120937947114866 0.40441458230172899757 1.0167818002708093328 0.20392905191102278506 0.85466901344571366561 -0.6208026527993800725 -0.46868453982866842278 0.094046118783613338876 1.1214560003901556939 -0.47128292888638945168 -0.56419192045172217309 -0.38136268984094395806 0.67990448710378814656 -0.05678584354392338801 0.27146838387687793892 -0.28617160449857065307 0.86548274124758250991 0.31784953935534948632 0.25021161919536727414 1.6318967744586854174 0.55653903398606863195 -1.225994136035634563;-0.3291994665534007658 -2.3294518807581670039 0.21590103986245387513 -0.66974591655921789091 0.44685365565086571094 -0.69004572980883849276 0.9001145052210489661 0.63588120202191744657 0.13068113883201643022 0.24675787844783667047 0.92649934726444260757 -0.086860293743362362862 -0.67110824461306839428 -0.27984387060495624633 -0.76992639743188295842 -0.26921068527793190484 -0.56940924079958432635 0.53206750203352659589 -1.3516629629520180433 0.34533442025628402483 -0.854145619345081486 -0.11603497668268457355 -0.97081451372722094018 -0.29383815913977634482 -3.6800548797715197935;-0.25243279084286535108 2.8480016721232845889 -0.33754086271050787182 1.0712155178791968879 0.38782379337489597537 -0.31904484263600318972 -1.8276625651826332586 0.064546173308581478167 -0.55756686314648984393 0.66907927308103543051 -3.733525860517227013 -0.69170338331753566941 -0.4207279797768453955 -0.24539151293563749023 -0.19126144196454475388 -0.35290099389768297966 1.1307427749174197018 0.27105563191897275033 -1.6748800571478625887 1.3356694952885133088 -2.5832742461607747231 -0.31657466480236767792 -0.14695640419456648673 -0.18539957559933090137 1.6272978305925527298];

% Layer 3
b3 = 0.056380844168652667625;
LW3_2 = [-0.25912457849241421481 0.078096846948337947381 -3.4268675132758694701 0.13371478189845692475 -0.016028625445227939056 -0.67452617744640552822 0.16196283013348664048 -0.23374274372597891869 0.58332427141212561672 -6.9288977348723381766 11.30232411092470457 0.50844950215914808123 -0.75002097959774094438 -0.34760626009021738936 0.19297200506524442298];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
