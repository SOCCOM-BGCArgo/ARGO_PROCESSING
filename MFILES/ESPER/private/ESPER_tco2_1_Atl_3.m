function [Y,Xf,Af] = ESPER_tco2_1_Atl_3(X,~,~)
%ESPER_TCO2_1_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:52.
% 
% [Y] = ESPER_tco2_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.6594286062973389;1.9775505852811868;-1.2295512712454366;-2.196252779879897;1.7253281437955121;0.69726197558438541;0.60800548362065532;0.78627170632420706;2.8392436632401461;-0.12418567236705251;0.70330267171025962;1.1569448242256506;1.4415111288311373;-0.048440216353073939;1.4076065967428117;-0.58912967925748239;1.9260854394548057;-3.1535518302572507;0.37604947760848506;-1.5111617368709618;-3.5787436717847205;2.2360532880726893;-1.7249518280248881;-1.2030203058429516;2.012127136467035];
IW1_1 = [-1.4819770949261841 1.1802560342266804 1.5390216760580373 0.73692085883269332 1.495122922788078 0.6844641360165642 -1.4174213521962269 -0.08270664296668076 0.69255372859830777;-0.27931961427494345 0.72994216751494745 -0.088376610612428824 -0.090481851643172462 0.18193936576658665 0.75654384682101472 0.64191550614363113 -2.209427147174154 -0.31290737899306886;0.82880160658584412 2.2030272405055409 1.2365642858173926 -0.99385443938263851 -4.4007039438551239 2.5260217976566368 -1.7782512455293322 0.30954725338471378 0.19801255288771721;-0.049685322603488416 0.96270904784423428 0.50922856791914184 0.10555165531645257 2.0861415577394196 -0.104290465816537 0.21276850311678921 -0.20217012196664572 -0.059234403058459201;0.61890866452384785 -1.4370766331432747 -1.7916734952722151 -0.79377555331233762 2.4200390721019502 -0.83305932907508629 -0.074028553666371552 -1.9376719833201754 2.8747680425850524;0.0124731147137708 1.4516939050808382 0.17856086338151342 0.3798101836470586 -1.5342292061023897 1.2835699284447923 0.93804230561596025 -0.8953065070173154 -0.45057386275086758;-0.14130763952993741 0.9750857802329046 0.7358081473624849 0.3365117378029891 -3.6564332078680479 -0.38953964216332232 -0.66845074458873022 0.67359962185226507 0.22691058583006496;-0.64954016068230025 0.63297415535966606 0.58895409946881805 -0.29524922454240621 -0.062442940061077493 -1.6221791985356346 -0.52861756346224043 1.9064562967505534 -0.43136899612650564;-0.11344183667170091 -0.94488836502781737 -0.13597119332576721 0.053267638222464796 -3.4860278841385126 1.1042143424537476 1.4008354643788952 1.9219697009759462 -0.96164043632139784;-0.59718551924787755 0.2254451738813156 0.49857346939692426 -1.5004543879861698 -1.2986374608581897 -0.098495519625555653 -0.93167905079501234 0.74719168430668415 1.5379365385891282;0.21378507791882681 0.62035687790780414 0.90093372055362708 -0.92295951173504409 -1.4106117936691773 0.39130995149204939 -0.17938182375092326 0.59947344086007592 0.22146373903907887;-0.46798207928057206 0.47064043497802827 0.45778295667223368 -0.67194950332667058 0.23587387185751152 1.8992893936032444 0.23244846230401625 -0.85029226510639155 1.0086684928673539;1.1432983813540152 0.28461027499253022 0.59831902787127056 -0.4584836085579671 -3.5171556156176123 0.60665794745321711 0.029595411942807272 0.401484083911403 -0.55680249168342943;0.61966130774336603 -1.3569923206308889 -0.20056338971967394 0.24284512271187092 -2.4039274141678346 -0.51258174862087424 -0.085548191298248838 -0.078770381772956463 -1.0395171311887219;0.54607417292967964 0.6494018627182927 -0.50852993888693687 1.3667359836159803 -0.68272434730538323 -0.016167554610701927 1.6958957751459669 -0.29489059409378898 -1.9084336863152134;0.88641375820414126 0.17624747031785931 0.089741197282141777 -0.0042272674743049701 1.808839588232436 1.227093675276195 0.68930860944521533 -1.1130654595359677 0.081034650441895978;1.0746823264502965 -0.44656933801796778 0.99060677934485553 0.64345996872920497 -0.037015439140526227 1.9044583247142606 3.3179781653802261 -2.2262026404802411 1.0192572945176588;0.35359935593484454 0.62712397386567265 -0.027849024225866714 -2.2885973029703486 -0.81850775761602601 -0.41294850529165517 0.46102638128646728 -0.7850214076278007 -0.13471413469376223;0.35332628384390041 -0.35245475025088241 0.70057242670127884 -0.41671171305473581 -0.99990103798187424 -0.81472177412794622 -0.25311317780597259 -0.064086578359506596 0.071089390389185991;0.35980130590170128 0.73403306714921579 -1.0433464109952821 0.47881247630416535 2.1732841010805943 -0.48477404869948904 -0.62018664516391664 1.4134266652938661 -0.54806662332313838;-0.81593368399913635 1.0276397141771487 0.38457395139888861 -0.073887610373207457 -0.66215109406305073 -3.1248459634588333 -1.1852612376656182 0.65724929697717305 1.6082228871796145;0.49595599873550894 1.6134770099194202 0.77644917038886851 -0.81149631054653037 0.68962697013861352 0.82390886437740707 -0.62313360512099902 -1.3531976846391238 0.50408152807011875;-0.050142018141721797 -1.2218891335536353 -0.46289229738527182 0.24330194952711365 1.4969141279202778 -0.9697063604431222 0.27741601053002229 0.10736304376624897 -0.58801166958835838;-0.16959623410432548 1.2318611284470717 1.6801047987979008 2.2708654237585382 -0.20183196784428631 -1.1285827461456575 -0.40936702578259193 0.026838230637601337 -0.16370689567588392;1.8601381340648921 0.38150788943381042 -2.5799447730235023 -1.512506461418647 3.2911498504404348 -4.3598067846647979 0.13599647246800869 0.32826017751612285 -0.16236625856170017];

% Layer 2
b2 = [2.3210623538196131;-0.10378854426277163;-3.3436989623776063;0.024460074104377935;0.80764703605894494;0.86419585621496653;0.15872452358420999;-0.32817544593300435;0.7074324999950552;-1.2806718558755552;1.2375286798455019;1.8124790364221439;-0.58908177876761181;-2.7137057744720043;-1.7587814240370512];
LW2_1 = [0.025119696526349804 -0.39891591901862644 1.2260881029822963 -0.81488726383828036 -0.038838474206868784 0.72149232459310364 -0.24117253334487782 0.25822394314762587 0.59780686795346649 0.94861810480575171 0.6530932692565754 -0.6239598077999261 0.5550500077786038 0.0012669861315367601 -1.1621080500393619 -1.4830964825221995 0.11837524234190275 0.20949741064474955 -1.5755845513927647 1.0284355982649658 -0.42852664836077903 0.67087980628352528 -2.1562103063142652 -0.3524675610412874 0.96705363682612577;-0.27095215779698395 -0.51986345243062526 -0.28635923122307277 0.90957436398083003 1.1682759612030207 -0.7691971643040324 1.7020446308990362 0.77924907492340356 0.40902118083429889 0.56889905351828851 -1.0355593807146111 0.38865367129474226 0.40238713952081889 -0.090112824860051871 0.63807638631110686 -0.14436889717503801 -0.011133071188541647 -0.6628016391890037 -0.34860127409251607 -0.22869959461256584 -0.56133656141437649 0.10862986606117789 -0.88487119058820407 0.25442909976477202 -2.1757035701793925;-0.22575194704065502 2.1477099400838875 -2.9596204380287991 -1.6008287055525909 -1.7614632282624705 0.53185513752712488 -2.3994043854185936 -1.3147121104234585 0.23066595805437762 -1.3739918967962137 2.3623088186009293 0.010431710063809635 -1.1908494920025805 -0.18817421571535881 -1.0109765723827571 0.063678754991396191 0.28690628748917213 2.6478120504327292 2.1876040953853426 1.7669244432306566 1.6979825097341636 -0.45882116612435647 0.78657832645935277 -0.03001301108339284 -0.018763341570712983;-1.1906448845997915 -0.42967086411331662 1.326861663694985 1.0643305511795278 4.1459875364770626 -0.23539392734050593 0.10768460465447753 -2.1069879025179916 -1.1298702472944122 -1.6148968865717135 1.1526008288870622 2.0189469008272343 -0.45807577136832467 0.12026647581723136 -1.0415187034700391 -0.19544512045238566 0.12327427207169775 -2.6463917443695157 -1.2771141843803056 0.072223472238542183 0.34355503759266576 0.40546727510109642 1.2276142571569311 1.167960390740667 -0.0030948792489670952;-0.22422830672193 -0.11562047460345151 -1.0867701344011547 0.11681008649097915 -0.89089354321184133 -0.010659709580582134 -0.79648011206876068 -0.31336195878606193 0.66223276849287449 -1.6172844381259892 -0.44440286526956324 -0.31768742318652832 -0.16088885491032545 0.25651113495385458 -0.69170702801623496 -1.1457491331149097 0.32709883468419332 1.1686168807772408 0.11140988105542252 -0.42271774539875201 -0.81094139425193901 0.32796461083245593 -1.737271699156 0.016641577130451862 0.08171351445742378;-0.2472601387281235 1.1298995646292367 2.3638757482917403 -0.59617981571490919 1.5508238021877079 -0.20707498581844239 0.3558849022770687 -0.48144115023114614 -0.2785121949105569 -1.6373536387200143 -0.15090677699543198 0.62092497011794212 0.13184218018698832 0.47340611685919076 0.32737924497070164 0.047989408086973398 -0.13908865165187567 -0.027734808962513173 1.2919686652433873 0.072000053202157049 2.8476426486792352 -0.46721566655867708 -1.2470834828707491 -0.68779508380453858 0.51697709992628615;-0.43839359280544704 -0.66464085163208808 -1.2080477110347716 1.1515989558120154 0.43828244799768684 -0.54636553460857107 -0.25024548900067317 0.02359483829477341 1.0197931935669613 -1.1192746682979651 0.97688514181975439 -0.52780235224152772 -0.12290940353067797 0.77876055796589205 0.37630645953403713 -0.97184006544554047 0.11431800941676142 -0.051380708931215144 -0.26677013831001739 -0.25079103555809662 0.0083943609163119257 -0.041314714434114705 -1.2217021184463399 0.9667365736092316 0.44706008091373117;-1.1851756335965675 1.5105657735525033 -0.23662068513077075 -1.6235430938013298 -1.3968674752776955 -0.38986956244655352 -2.414163492015728 0.7909972981263782 0.87420351850304989 1.3169692215672977 2.2405620445626573 0.71187377198245105 -3.2797578562367944 2.2800042621185428 2.6075174551992784 2.5125214128110667 2.7309624841791389 -1.6526610318286714 1.7259832493947904 0.29726586100953395 0.10437313526661783 0.84195558993187436 0.62621826326294405 3.8511258790636038 2.37903408817873;-0.44230982490010506 0.58223072005900356 -1.8514273611007852 -2.4515189448222001 -0.097752519160118345 1.6518099696085766 0.26749298962660767 0.57748958890789226 -0.23817561214600369 1.3523652730721178 1.1637461539600282 -0.60108141276767257 -1.0299356441861669 0.2735483749405781 0.7206363038136423 0.52888767894535715 -0.54719992876124601 0.42800175986009475 0.14300054839659004 -0.72404178847877865 -2.1648907988106156 -0.54051213891867034 -0.1541241043088466 1.3699590182541639 -1.4019456834843362;0.14483040436703631 -0.49277921466389907 -1.0160326048508559 0.33612560982680095 0.58250255241356064 -2.0555851081172216 -0.70513535092849966 0.36235508719564913 -0.64563342378174848 -0.46718770263908221 1.4288358898295144 0.64802905298196256 -0.78810759574380151 0.75654605320094959 -0.69603916187262171 2.5333443287944895 -0.78369181823971867 -0.34581663918383826 -1.2150861402873043 -0.27303180950328931 -0.26105170244682896 -1.1011810805831217 1.1378112563370379 -0.28015889161756258 -1.1936420452121046;0.94122120046877966 2.9914885646308109 0.12789460044855386 1.146826552583134 -3.604075445114721 0.56612019576371142 -0.017434905356301926 0.71303516208469564 2.4251055279472977 1.2679796332748905 -0.24862235539033603 1.5930157552117059 0.093881866624265287 0.59757999805120188 -0.28496204286887827 -0.62759790047056774 0.22394650046514872 -1.1863166157778926 -1.4635773942480554 2.6740698633218596 0.78260632511787587 0.058393652637164263 0.78206973941912727 0.58961362896678082 0.9944627204351254;-0.12998537617338446 -1.2346961383666888 0.19804990813196108 0.60600086429076927 0.19070659155181488 -0.14105245776346365 0.1483678705024217 1.0283980902694814 -0.14426271935630539 0.34703916051161215 -1.2578290343295033 0.0020834510397830909 0.32723722919347753 -0.69429078690114043 0.24005614153325577 0.72329516549620099 -0.13167392099391481 -1.6797115739369655 -0.054905474954675265 -0.47571900130175032 -0.16339034073968897 -0.19151349562553158 -0.24636129812637977 -0.3135103072527255 -0.25209151381854467;1.2552618176927874 -0.74727178787325399 2.407209426378929 -1.2074353049844884 -1.4501718859405754 -1.8355993376662052 1.4883151987814331 -0.69191684626401906 -0.054086214947476133 0.25134229221482279 0.13660788773307175 -0.38039682548839537 0.19047688455655237 -0.49760387104673848 1.3198655846316474 2.2127069512629616 -0.084854582045748875 -2.0485771573617937 0.29596570745803147 1.0726097433762356 0.6154762770394705 -0.26136134158797625 1.2575756360957631 0.10213074654206999 0.71613922768689253;-1.9066246136901575 0.91047071297486748 -1.6903580445812774 0.34249369847330891 1.1925866710853581 0.39650467047324223 -0.58279264602684344 -0.96719984839203177 -1.7882951582848887 1.8155407496763303 0.86230670845979218 -2.0584368041848409 0.76133450256921986 1.0018032327027189 0.19052193136641238 -1.9432242138178613 0.70444592023534003 0.0022430556256434857 -1.170829300476196 -0.060727111527982998 -0.96696376455909172 0.021999416428379485 -0.3439889873051844 0.88582527269182521 -1.564406282234053;-0.22949113038055222 0.92227940844631584 2.3029777967241016 0.18057231816337327 0.1028011601843976 1.0455831004914642 -1.9383026471969964 -0.10038166035138528 -0.8808780898764319 0.27786594658787944 -0.55893647866367258 -0.48677363408613217 0.92307217545827847 2.9239160418799539 0.14237512606064204 3.2361418870574732 -0.91218647687595222 1.9497600012216636 0.8983283159669847 2.3929610130477386 -1.5878581780400285 -0.011528396818544832 -0.7327971321513761 0.81409717307782625 0.52944310814724371];

% Layer 3
b3 = -0.095659953308604329;
LW3_2 = [-0.021886235130571741 0.50906579137468799 0.068556091149776247 -0.021522801750516726 -0.28838290411648021 -0.077942144221419207 0.057523482121356474 0.37454271402056616 -0.15717502084489868 0.040498058693230872 -0.011613242934521827 1.5212430242760819 -0.015215052755172513 0.20562153632024474 -0.0040389093812795767];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
