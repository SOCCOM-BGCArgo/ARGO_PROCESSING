function [Y,Xf,Af] = ESPER_TA_5_Atl_4(X,~,~)
%ESPER_TA_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.159444194297623465;-8.1166470851632137595;-8.089209581089244594;2.7683248678113514529;3.0357008723920189119;-12.220976003569731461;-5.7224599217159735076;-2.4059105160932792167;22.294019858854991156;-2.1763824752728897494;-0.30597348178305483479;-3.5060083202356171483;12.509866211592882479;6.1693825905702013301;-1.2791736021891302322;5.5086824204264859262;0.74190801646748016918;-1.2881834523894661881;-1.4985627367179135128;4.3687618770938705381;2.7913023430107086753;-5.2899390134943713448;-11.360694682598349914;1.1597515211349089803;-3.2430363190690605357;-12.08107833137536069;0.1247281797411089882;-4.0154346387141908181;-1.6767463550785617343;0.1608758170832819967];
IW1_1 = [0.26702179430889794176 -0.17928769958818779884 1.0646817348570458694 0.036591862039526801276 15.83610974142247052 7.3728305607728596982 0.7885475445595451216 -3.5814064729143764154;-0.75886478262700951536 -5.6434020572258019044 3.5462609610454403075 0.0536041112700348793 1.4727736496816394851 -0.5711515458133918921 0.11591522071024938645 0.28154149666935068819;0.80778542178139967067 -1.0828425431280732649 0.22098704692564286045 1.1064064019083432733 10.640310674681325409 0.61634945228501236691 1.9265026580237583076 0.68373368457346095362;1.0577593116649364191 -1.503232053362783871 -0.74969114613513732071 0.26680912599860601153 -8.5993812902944561927 -1.5610162421720927828 0.10695538598526528606 1.2108164275905914931;-0.87144181066701187355 1.4140627497806212975 0.20906391007213273592 0.2767937794991476852 -1.7246246683797628041 0.43133415325039553556 0.045303898770046438504 0.16948701552663122949;3.2109046351013903475 -1.1461198173996314242 0.11029051977664242057 -3.6606856329265173855 4.8612699740024325479 7.6823003287704212383 2.1547827729138906427 -9.7265065874697338444;-0.19207280512130844863 -1.2717479842554961778 0.44036844326608193256 -0.80639445553664179656 4.9262378588148214575 -2.8055794916184391141 0.07731733500040721685 0.34689826997002026765;-0.52777390798943568662 0.7547037720217482093 0.88010002884641003185 -0.26849646928221193587 1.1079806258960447352 -0.95381250078001644788 0.14839785358004387028 0.3628459832922548145;-1.6215794823478464348 1.3308615666612466644 0.084717197787218104232 1.2320706648487722568 -26.638428918442048854 4.9638713269567649178 0.42893643684937921012 0.91861096514766527044;-0.038583695083108125734 0.28396434374010381951 0.055441303682119573437 -0.2192399326557827044 -1.301901452247571811 -0.45001960110919625446 0.074986396656453999099 0.081112631442033913953;0.61451646803409787356 0.68750705379375831594 -0.14969376000354756018 -0.10022114783600016841 0.70215925627956898847 0.020842258843813271652 -0.076081845409614462517 0.072907292843714374686;2.9677271850055433333 -1.3748510598386955994 -2.4756067232733873773 -1.0461762110983789942 0.72238418522293723623 -0.60389874387871445016 1.6814853353360705857 -4.1435639089560032389;-2.7971100351464865952 3.8734316318313952721 1.0227223899639636961 7.4642652911823779149 -1.4981558517203432679 3.5958445148585620466 -0.79235820203534534922 2.7331276864296145668;-1.9612395401192435074 1.6120334835626575209 0.73820537497725446929 0.34595790385006125467 -5.8583323188167879536 2.3761381776891181694 1.3908750085820329456 1.7012829061366006034;-4.5740703122187928997 -2.0177432817088498673 -5.270142934749271646 -0.89991940922581559192 -2.0033695057156233332 -1.3779967330547162607 -0.58395939258312223874 1.5368268111748062399;4.1392774732242001434 -0.47834567315649195729 1.020957591437692269 1.0151604057524079572 -9.1807119201165132694 1.2482604512716011236 0.25245297292607205009 0.34641164283096037568;-1.1842029319182800773 1.1645295573237512965 -1.3189316227447962504 0.16373123227160082949 1.6474454738858899105 0.4006927777269337354 0.074733015653139084344 -0.27937481519176982081;1.1661398492305359298 -1.6233111249527076847 0.085335605164758437935 -0.1644402989395757908 -0.89995875395213209558 -0.054451223025337544548 -0.08696193628023228539 -0.19308615257285455247;0.40682667395644911412 -2.440407510173668193 0.42538720428870696599 0.27586844956292078113 -0.74962290970068201634 -1.4698302327140777557 1.0312411144664914708 -0.45222900084337014359;-1.3924307655238334913 -1.82965894165243248 0.4403578008424754997 0.6398285941760497586 -9.5888468467312097943 1.9723882973896831317 -0.68203045187087441015 1.285911308741646053;-1.4950654254040516289 2.4230779679910385838 1.4203288877210440422 -0.18643294568002860556 -1.9408679338154959382 -0.40407960082314886563 0.03247482002327096301 0.45998732998043628806;0.17577950877388190398 0.080575934102799923187 -1.1562591298128894746 -1.0309087419729581203 5.6781059637223911807 -0.39108744578524506919 0.3142523163897597005 0.46326215928559438817;-1.7009893143949208483 0.31348757958328127282 -2.4285747994739237399 -8.9360959620499098577 -12.85129217754039388 -11.553487220406859493 1.9374509335996756842 2.8895923679475905566;2.8688997090865830941 0.28977107360949644344 -2.5479503152892739593 0.37850006674464348189 0.8470139705032955213 1.1814985166346241297 0.19036878557991354644 -0.54532629321694336966;-0.11692813364770231199 1.0884635638910022948 -0.94704848363535765188 -0.13910462915206547874 4.1041449383191874745 -0.96901855894319366413 -0.046121669281164907883 0.072684201187122418619;-0.38418945402451509796 -9.8207894831365791788 -0.38454611167262336968 -3.2713681796226690146 -1.6890891198315742816 0.4994016117824036094 0.11944943352064499309 -1.3816088036957152596;-0.48978928625120971008 -0.41934445496194316938 -1.8243542867946698216 0.28589227380234782938 2.308439791200648461 0.58831471589971917613 -0.036922636162905989043 -0.41075636520784941652;-5.0544647129845277078 4.3188779831119399333 -6.5804885007824625021 -2.3600171885661205273 -3.991054573266846095 -14.87305029832494796 -4.6029237245682779189 13.956587113755672291;-0.534879533522677586 0.93673719452341686065 0.58799989351053827402 -0.21021393747702193933 1.7642174517943853829 -0.56499168716458192385 0.13897680728312919451 0.49977162797153612539;-1.3154735284108920457 2.0389027784211966043 -0.92089604122427271005 -0.14788194725100026194 3.6465609090688659855 -0.48248600445883987886 -0.081868939166551454867 0.080069144494010952018];

% Layer 2
b2 = [-1.4128252936201122214;32.012668608811111426;-3.8000038652542187378;-55.680607412079574203;-75.938457231462265895;-9.023360456607138147;101.39552767531461086;4.0851009652840435393;93.044495635978222481;-127.15997947949257707];
LW2_1 = [0.36177024584877010005 1.3110404839554170575 1.7449709048842436676 1.09041724251184724 21.332157742888103513 -0.83646332340541906802 1.4348306167410522782 -5.5436302971810675899 2.2257619832755319855 5.8174469563324944232 -4.9439178840048079167 -0.39080330244200317535 -3.3720848166372094923 -11.918245472464436219 -2.2585822369675758736 -7.5828119031602234656 16.477170783189606595 11.966349252758574195 6.8864983826843317871 -3.362396683486713389 -17.940759865568036702 -1.1899456242178223508 -1.5115414474622321794 0.080739457543868700662 -3.0485403815366387548 0.24967336685116672812 -3.7057169521330766138 0.51364948060973303345 1.3067797695526426338 9.9728744296875539987;8.4575170395346539465 16.908860102181680674 -17.720629439159861107 -18.480082571484977905 -2.1117416844137983922 26.076794994883194079 -14.177539877476545982 3.6363603131432546967 31.811069248081757621 11.046332426808220362 -3.5053349663475841247 -3.9451594961351079682 0.23082602297247128975 -23.261315327861417757 14.677503321008821047 8.4531088701088687998 -39.329492754458492243 -16.67258099948384853 -4.8641031597129797959 -10.444733475544524026 -45.614349280775520867 -3.6118528468712995938 -15.346819848818045173 -8.0757298235393104591 4.8475119882681170225 1.1174570369212728504 -2.293307015161112794 -6.4018585721422462953 18.202071316544241597 -6.614166194359443196;-0.0068788118124385403546 0.026338000057199047882 0.013729654589299226594 0.016393673788087041038 -0.37136150787850608079 0.00050671901243025483513 0.026910322875787009295 0.23647576608981382695 0.007234545183099128085 -2.9900841040210548449 0.18162369041134354686 -0.0081213830107855072837 -0.0025657441078544042379 -0.0095291017142642344545 -0.0015810623408628562189 -0.0099058869613343238092 0.051169963712460568572 -0.3725182028225745845 -0.013586877192213036095 0.02584062673223026102 0.12927946940996856706 -0.039615280098695360156 0.009512627807881604558 0.044778367126766679962 -0.098494901893371608614 0.014372211315418891714 0.10529049091007373906 -0.0022358937647539872152 -0.17116305965534459044 -0.16123953319848186028;11.372216287058936501 -33.695571236488618183 -15.839202751418795856 -11.493882603085939564 1.7284052572320467434 32.842368600791772337 -3.4742907233133264455 4.8923037886352993553 -40.866247333068237424 16.327035043299424899 6.9973906207116431943 -17.115821900603418015 14.372705980185317642 -2.3041811242653178482 -9.4546273399383711222 13.126891329534554842 1.0743754218243246612 5.0593091546056854213 5.2554774043057648214 -30.527085712503112092 -35.777949803446105648 12.891573288369714945 17.829266306441592604 -9.945510971789040866 -55.609002491745506802 7.4850052739463004414 -3.8367466600250468289 -1.1394963200389933711 15.858807109875360908 -6.4856301162538150251;7.8823406072539343725 -29.7349033520784225 3.9921607495138564659 87.204692514382983859 -18.639269042187354586 -29.256254365842700338 -7.3149051370122997184 -13.339771722551937216 -180.50233274095614888 3.5756039018641758709 -46.580124857758036683 12.823879023215519979 -68.806191093885601617 33.155363368048043071 54.367578031764779212 -44.691492104850411238 1.7062764618909160852 12.793799190444918423 -91.07426065940568094 111.6480581455821266 64.143164830618019323 20.282637978588958561 -19.101535935298169733 31.498331571269453377 -19.865031412396707111 1.8217424140816518285 6.4341607860006417852 19.563895660733688686 -28.046547401385165443 19.066679214454214986;51.040343937772014726 -0.47384819868890992733 72.18652633400374441 -79.248385795983551816 -6.4162583390037433162 9.9210129736879366646 37.897938498805459062 17.455062066229086071 -86.563937827716102902 -27.464431302294645576 74.452130561938687947 13.454021566796177112 33.025753544957332508 -26.558687402755449369 -56.686236031844295269 14.703386797386002627 23.001439466968175651 -34.772721907282104326 -43.605353234716929478 -16.021926369686998015 41.957792283047375292 -4.7906333523959263587 -5.3800655861116544187 -35.920412932783484905 -67.549847845213733422 -2.1025242940695161309 9.7112375629143787847 21.488930953953214953 -22.253301479235048532 -38.892621531851489181;-54.373458902662605396 2.6276165848665273828 -12.486399331740559049 1.0989190223736244878 5.5650619451159180073 12.549466441795805949 73.717230724745235193 -2.9676169036240502841 -96.256541212138245101 -27.431399829586958106 38.412563413586489958 -5.549129387296415139 -62.665938869122129518 -19.832639651290826066 55.023451918738366828 -94.54869357336050939 -69.334937821091600085 -44.826530025100716159 31.239380208708883657 16.592580902071706106 77.841493617579416764 -19.938957115468944892 -31.814440905607696664 -63.150675061364829332 69.44814166113476972 19.454855812016518257 -8.9844449519853917252 -41.833928618900607432 -54.181098864382747138 -51.060271907109822109;0.47827512590751414256 -2.0734322026944660422 5.1436266803637851197 3.8925402492841052471 -6.8988280211809938081 6.9137773473270165425 -5.1780419440197151815 2.800939706921196759 1.7834332926293987587 2.938153418295684105 -5.5550382080256879291 -6.2825585894769453432 1.572750857855800044 -16.326058158061293568 5.4118236689981253917 19.473342293944092773 -32.091704364076171885 -6.5553650133771963482 -41.584688706815406078 -6.0258827927661267054 2.8450915505432798902 -2.5679990228294520271 -11.97366108696869702 -1.3084351190505352225 7.3908767701335209566 0.94405059210935138303 -11.561771404532622753 -0.46524966992741240146 -3.0799554567891891388 0.18937411550786814596;-18.621090367394945275 -4.6632669837937417157 3.1758754630933392349 35.59458919270626609 1.9064620144759896192 21.016542816956643946 27.062671599190558425 0.45751491952455997092 271.68316197820882962 -15.297282218714251201 1.077257487740797659 -7.7637604970663787185 -9.6845923787374346148 25.954682650834477897 16.16525184542832605 73.839280871463287781 87.780421346422457418 -0.76080492266792965061 116.53075825303214685 -22.404112527772564789 77.148562580787299225 -10.743036375114094483 -4.6480403746702521062 18.326924788908172559 34.181085794455505322 -12.313267453201985902 9.1096888455202957857 -2.219198106603538001 -12.636121278702685089 -11.727722154336559512;-5.0001979467433219639 17.500731966416317675 8.1103752926432139958 -10.077222468122226218 15.290904997306437707 -129.01285398630156465 4.296201761828755572 -16.823303088186392529 -15.237707851978441909 11.838436089523820982 12.141475732021977052 -9.4353975563148200223 0.1364010412879874401 0.73410274861307422967 -4.4929293203811564439 11.390436609686945602 57.461007874939483031 16.87134222918088966 32.368554552503347566 -7.4623008931217844619 -33.177837859425956424 32.048956399032370257 10.923638739553940269 -9.9347509294316154183 -41.356220936303536462 -0.060196559481668347746 3.9602772747127579223 2.1180208209819082477 -4.4946604567412205 -8.8126959076012614247];

% Layer 3
b3 = 4.8971772177158605643;
LW3_2 = [0.013045257546477657604 -0.00056272778849967869819 5.9015708185298700883 -0.0017657202121472829505 0.0016331969009066272473 -0.0010071695637438899274 -0.00034581349320946013414 -0.0011183394430890473189 -0.00070915413731267406931 0.0011578452314032880357];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
