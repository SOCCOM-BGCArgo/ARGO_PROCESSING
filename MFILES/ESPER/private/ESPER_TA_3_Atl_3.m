function [Y,Xf,Af] = ESPER_TA_3_Atl_3(X,~,~)
%ESPER_TA_3_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_3_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.361988152828812082;-1.379430464925814448;-3.267629973362480289;3.8236001753863044783;3.9012504661751323809;0.42210443976597694649;-4.5089540942849284377;1.5847847644436918735;3.920444027163436207;2.7275246554168317559;0.14497298901510891067;-6.0273195007003748103;-2.790169093146739776;-2.7544169897267831715;-3.2489734533604432976;4.7340976769059910367;6.6842520961616704867;-490.81162389510723187;7.1779672999466468397;-0.5583685783313605544;-1.9066297750261778088;-3.3369122918314477744;3.2405257388817219066;4.6164427005666901493;-0.93606512467203517591];
IW1_1 = [-0.11275611884794876916 -0.063349264413691944164 0.046653078898576623434 -0.033837234331776100404 -0.4129302775071803655 0.06688143749207159372 -0.070623254698669632456 0.12817136927607056252;0.83126621065827532853 -0.73242726081596165599 0.11002222231643277173 0.19199174485090422793 -0.10422587016949527716 1.1897377451694699513 0.49084946386084593595 -0.10106630230976215712;1.2048046474900293568 -1.0501569160013797255 -0.31232831261234994535 1.071302973865222441 -1.9334748440354154742 -4.7821909403148064044 0.54621906690460941824 -1.1372917123875092571;2.0104094777705978636 -4.8497755881290629532 -0.6354599504286921885 -0.14735791432238887211 1.4614940115482430993 -4.6144286858695586773 0.5321798321509377816 -5.0452083804326077754;-0.53929592313015939364 0.95115334217260472105 1.3326516910478809486 0.539884759603482145 -5.8064361329028901793 -1.0447460686264111729 0.23046206026928706123 -0.092986329736373871113;-0.034043768614715877452 0.0019735805110528354192 0.0015260296761974874707 0.23373737464790450558 -1.7363580112563867797 -0.3747935129240598795 -0.085146825849418308896 0.037465467707094496363;0.045933804908482180063 0.17686026987100594843 -0.098233863932005102693 -0.58634827385827215096 6.4589082314520389616 0.33098815251382829317 0.18680896816876574329 -0.36521570376402678892;0.75633943363239186652 -0.93030567412880971201 -3.8437541536680170928 0.078273887901426683622 -8.9177509430409536151 -1.826413666649447487 1.326487289331388153 -2.6730633197850681704;-1.2330236270254535391 3.1923173044019876876 -2.4957599409901631837 0.50571962490174904303 3.5322783752642763488 -0.10893992483595932308 -0.8892253528617624081 3.7692433895426624701;-0.40014205297616256551 0.45703342731215007566 0.079849337761728284013 0.10830866390361207352 -1.9235835198855042449 -0.73598067560435331824 -0.26872234241410281053 0.022006000694091292641;-0.02028941721298328435 -0.011666603348476951504 0.0089866202083964657338 -0.013482203005198131751 -0.031549121454893858107 0.023537267715914168831 -0.010562192261531931289 0.024101941728525543701;-2.2993326015710890964 -0.26600281016788224209 -0.16895889824020984826 -2.6903092530860011067 15.158783013456350375 -1.9478499434589031658 -0.21547598955445695923 3.5917695849649375894;0.60751217078172026209 -0.76606773174125153414 -0.10816561457199368179 -0.028885017285782632612 1.6015806015046520905 0.79174690961370797204 0.29244908076672770925 -0.050736685760686274504;0.047242288099593438 -0.72927314026734590957 -0.63371050339002477081 -0.21463891586214134399 2.8204984631629064218 -1.3909964341698608514 -0.70355061824048970021 -0.19540410975329616794;0.75718418763981198971 -1.3765126941919636483 1.8025787624194764547 -1.9165072553736643979 2.3361806203654111869 -1.608475946446938476 0.9019257547755961113 1.1872607825173320251;0.35896066835264267558 -1.4995592824634094153 -1.9765018555471258743 -3.5305973594308306396 1.3341698354819799821 -2.8874742453720827484 -2.761203672900399031 9.2457676442743856882;2.5630471000874917031 0.13747270057712648872 2.2233741105615303368 0.19341553519577825426 0.21084426238326278713 1.4663807075981998285 0.50990610609380715434 -0.2333095078477273876;-84.8487947346096405 -41.546763663467082495 -111.64302621170276097 -178.1723018368367093 25.839588728223240821 -221.34035822146262262 -68.24638828074336061 1.2707849648907985074;-1.5732192457060205637 2.8608436463455646503 -1.5965075658573506523 2.1978353026243375723 -11.858566257176924807 -0.21930769509525763206 1.9156446216160729623 -2.1510370314548259429;2.2873560097404710412 -4.0510428622638183782 -0.99562230970490062099 -0.14156985156814144711 -5.6652107527272077547 -4.5746229655352514953 -1.3365007286050207824 -2.9483721257164758889;0.85440844372212443325 1.3529308026734128134 1.3022754605500088676 -0.70085771872304147845 0.80706726443639498214 3.0774169385836818158 2.0625563931719832489 -0.91761840801193528261;0.26244616172520629505 0.090874766886716529246 -0.54867962919392421206 -0.32215677508142326335 4.0477016144817614673 -0.97968684275452899701 -0.13662428489992303748 -0.21253346611485138262;0.023399103219661931963 0.021994899678376512997 -0.021767358014224878759 -0.84245154100457997348 -3.9131047694150948857 1.8436135545957210713 0.077652304426664070514 0.1032486962684013021;0.038426025768483126899 4.0239570781326596816 1.4380654255793927643 1.3178072922194141725 -9.0077743200905029397 3.0784700239867275329 1.7130414568728618008 -2.5760363193104320878;0.77470803922805875352 -0.48321846316440836278 0.2073421724300003044 0.24616147514054001477 -0.29914514642712658476 1.3727846190642332136 0.60499940322969048001 -0.090427361231936315145];

% Layer 2
b2 = [-221.47458877723815363;-210.39212163466692118;-78.338096307503221283;-94.694530680516038501;-60.237132678122996765;-75.955049417019040447;-86.718009021974793882;-57.339994248615418826;244.51347133722151739;0.37133489991527396379;34.098463900288436434;147.51653953523751284;5.2532939395276887495;56.793903852835029511;134.29069304799890006];
LW2_1 = [392.32287621134980782 -27.855365838531302103 14.410805930737012659 55.905388074330858217 18.974130517931580897 -30.335642220596994889 -29.211349625484416492 -25.788449623815544953 48.862273679170833418 -77.501736476289096345 -74.4129391477213602 6.9369016733856021517 6.000042053624703442 12.571582112103488527 -52.014435675325159991 -4.0558067768177306078 30.610535524444067335 -140.20524662654710824 -56.476954002061511062 -11.566921185375836245 -1.2730686978352456773 0.073299080257240009639 -22.063246504830434702 45.420475434730128939 5.43423539304093417;9.0530190513003994113 6.1439783841534074682 0.63947870361955405638 -6.8246510783565490499 -11.444898580873370975 -3.0316771139591063289 -14.950521521437067918 -0.038946756383194447437 6.6997928323364535075 5.6029157316498272579 9.5925148932373094368 3.0866903217158760953 -2.7962797748733105863 -7.4613808492440245601 27.392238190660812336 3.4145091123793758214 127.02104536746603003 89.286454810587798647 2.4960426654402940727 0.35458558435888343219 4.904532172600279516 5.8774972232376381243 0.088217030440445376449 -7.3490291979551711776 8.4413518277334915751;-8.29066446987010508 66.427414598783542488 -7.1942465981069467773 55.144521248349626319 -59.414833275507014321 10.888458921349659647 -139.5938371448042119 30.220964011915544489 9.3117171110861072236 -2.3475172724678543545 67.357818905030200085 20.644955296413428414 -12.152983567595120107 86.095430554742705453 -117.7768465557224431 -44.528945385634244758 -190.03014537679692353 176.15606757222539613 -58.684422021016480642 -3.8463490099840651482 -4.729894951747988685 87.352000948599354047 -40.72125386608901465 -1.2588149405575708162 22.87573576439931955;-10.827015730507071112 3.5547974762636469492 -3.1765536797031486138 7.933847305927822724 -5.0183730419095073927 -10.962592061474552452 -1.8308348629441153488 1.6020159970314180597 -2.4405903777520725484 -2.422592050869428526 -3.7366807733650677648 -4.7825767512013035443 13.393105333593871009 4.5415036514463125172 -3.4434661912395476691 -0.26725630301944280909 28.125762357901582078 64.877665026725026109 0.3240142177511712851 -3.5699776350010670178 -0.48826722660340948767 5.2634203557215588631 4.2942296097103955788 1.7226991409758569684 -0.65526359629259056661;-34.711361198086990498 22.384560890076311779 -12.047364694343897895 55.571843175024383754 21.188700650359095334 38.921840382638961842 49.35206964968807597 -16.345071601833161878 -39.092227258328129835 8.966330632295273162 0.95327078408214760419 9.1278745665936327214 6.3325254831754689278 -24.077299631759576215 -32.137267162138059007 8.9598990408484784354 -0.61070892762829664946 -8.5144213916557305311 -0.67984948214885521089 17.801284997268574273 -8.0506469035984622451 -17.470409872060962186 32.178676670665772974 37.42808413867184214 10.336427172421004173;-5.1683652985244057376 -5.2264584696321696455 0.52644829246686741797 -5.7305976445023594223 -2.3655425336877184961 -10.255376770990249469 3.501102872126743204 -0.023793559304170042168 0.52858824790846847819 -0.11603560510127364225 -0.52651362470337614852 -0.059889156852553526722 -2.4203201432870016241 -4.389619310052354173 7.7670867172796960176 4.1055440866792221044 24.727456597018932172 48.997644268217072749 2.7830683044687130057 1.815687592584597887 0.1366540391599340154 0.30349559529304981353 0.88711169497928477057 -2.1065995367323626652 0.015831162066277215672;324.57008378988678032 134.90686579216912833 61.769919133963639979 173.14904465905618736 70.962018184524225717 409.23473548226337471 137.75903411328982884 13.870566618455868024 78.159384518999516445 110.73028002875417997 134.33991114146635937 1.7123711005087716153 158.35788544243681031 -18.173473508339984761 -258.54855474736143606 -240.73364331452879128 163.23320869049669568 -121.29463339090537488 64.296466133317622393 125.83624078611845221 52.827175591648703801 9.4021777619559081529 60.030308194649265374 -18.624746906481284725 -69.266894327386452801;-9.0534124246578517869 82.777283655447234878 -67.170468866993829238 -8.0452663819774006271 0.81882728051730291341 -55.920962285901516964 66.199517519798618537 19.020749318788126914 -22.53796625842004886 -40.286571519309596567 -103.88085674750722376 77.769426961439236834 -30.648743840691370366 0.4205298051282501115 -51.827575328212368788 -21.175033780757772206 -113.59643056935914274 -35.222288403424776959 -11.004261304567855007 20.594801096837695553 5.7595056238222985812 124.91689708655995616 34.78066275944298269 -71.244968215790336785 -30.463193439269986129;-3.3471570080646797507 -18.359330069404879993 6.4952060572956895612 -2.2929789114209633283 24.27922629342742411 -13.724477699459239233 4.1657293014605238923 2.0308797750057085985 -11.151238369085563207 -8.4872421241863786889 20.953209592668560646 31.635505924299124558 -10.839654644817963813 2.8899825136481380738 53.713652016322065208 11.100134525644367756 -17.668802472558741812 -236.80242650504581547 17.297350436760574155 63.980141986443882729 3.3772925951174426196 -13.72069975262471786 0.97967672281673490176 28.487744580786888093 8.598084581700037532;-36.851247631099511182 -41.308265589969039411 -10.518134295875986695 34.006304875299363744 -16.900250556562099291 36.341391762826241063 21.050202478463301503 23.927316536318681273 7.280239293003440082 -45.479237610767306421 -20.262415025265759994 1.392944598850905491 -51.062356284771738046 0.52735549809685766665 -66.20934117976715072 6.1328666583631106235 12.751064037955543995 -14.479752950641907816 -6.5780392977015385014 -10.034716340509303834 2.8621322068781580583 -66.98872472564964653 -9.3257327454849665571 31.321428407253183224 -61.904163420797637229;179.90543285949226515 -11.383802221876861083 135.38220327336262017 -22.1227776314059561 47.746595151608197227 215.61028668845918332 104.02945706682950799 0.16808005280638124712 20.632797981434059409 -42.796020347332664358 36.514332630651942679 93.775840758869250635 99.540958028396374857 45.38313627111930515 -93.948759554012482909 -15.801595707359172849 -14.906040247310077262 72.17418972848075498 -1.4665558614500311396 -30.624956921821489431 -11.082770261114728072 -39.690322759903672534 -67.027322419265544795 19.707979650289139784 -23.615533316944546272;-240.93419666456637174 -23.481647315281261257 4.6811668531479675437 116.71516592955386216 -13.085135531033655454 -37.423943192482241216 -65.551354105324193711 22.194127550091824475 134.78876860274598926 51.59637800740196667 -193.34263798810488311 117.92186249294337586 -193.18920377922054854 46.609523337065759563 276.72530124453430744 -78.155742435343782404 -202.97140883197042172 193.17375383888378337 -22.683987087555724571 91.929441184606503157 98.528512523147313118 -33.817535316042317106 34.755323894932757867 141.54008914044501921 107.95557132263388667;-8.0226628635151726598 -1.7910346341074991905 -0.008970677777286271623 31.106610822631566293 -0.020359731109702888102 0.97156967180691111707 -0.069505048286540471736 -0.0032527456341351315867 0.0057346374772510987777 2.3746653224867801946 40.402519354912030281 0.010613825474837221968 2.2253083298316558292 0.10731455294278834101 0.0033003600721321110605 0.0011362939208224087997 -19.325944992276422596 22.024195930984465264 0.0057564358487702891459 -0.0075490804733668974424 -0.018744945526960654636 -0.12030985907286266545 -0.051400598167125215177 0.010611841956238791604 1.3513890573322426825;43.122409686257881845 11.048430617589310998 46.0167323362657541 0.90421829478286108728 -46.099231581979303485 -78.060012170043137303 -11.476085009195708508 -25.829303644093506875 -69.641081792069016387 -45.214493411160304959 -39.700396308646645593 50.298864622501767485 -62.002679390970058648 -5.3277502539051608821 73.431046737270875724 23.049906323052020696 -41.679311075389755104 -41.33932861468576192 0.074450722049100734323 -2.9627257594036882082 -14.872032698211242518 45.943456766330832863 10.461917934006354614 25.886636002039118409 51.695641060029501546;60.789859046392130892 -55.843817197965677224 -9.4917413302427942057 -15.712748326363039197 7.5883680310827488213 10.393307275471387996 -95.37150942594566061 59.53427573171742182 -17.232032665162073215 38.760558859170934909 -34.952367284615000642 42.622823418406582618 -107.98255007718282172 7.3341660328481239617 -73.688700425560554663 0.5534714277859177356 -270.26056441846719736 82.62743506722202369 25.540655726532559555 -17.489133346884081277 -29.735086413562498819 -27.174247091828725331 24.198135450073056774 -24.961973639658580737 -57.215560598764291456];

% Layer 3
b3 = 0.91886933982820762079;
LW3_2 = [-0.001627306421539098354 -0.50849359998255527771 -0.42269949856276445299 -0.54923214090701788503 -0.00076745553420473763221 -0.46470971340219707768 0.00022223373464927257976 -0.00029339478776208482904 0.59943623374919308144 -0.0020014979490707452553 0.0013675738530719752217 -0.00054722475305581292932 4.631803946712873099 0.001281513286514490051 0.0014795383777496237589];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
