function [Y,Xf,Af] = ESPER_talk_3_Atl_2(X,~,~)
%ESPER_TALK_3_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_3_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.1238577754255497;-2.0211587328755485;1.8993054673654792;-1.7725320429504938;-2.6171090391260869;-1.5540929034654316;-0.048415129647609606;-2.5003278279952124;0.61705546859251914;1.519999544334427;-0.61723416504938011;1.5292845487477182;-0.30019666726082544;-1.9767008195336948;-1.2343789713521343;-0.53394714085561756;-0.26499210947144486;3.4250385331363025;0.097041756788749087;1.4760861072037061];
IW1_1 = [2.9353792211939624 1.5390671310737212 1.1670561458523225 -0.027031502061714466 1.0162677551882988 1.4915864383386466 -0.34227203160706843 0.64067830056622432;2.3627838315224894 -3.1476979018691149 0.10724662803895364 0.038770911315674166 -4.8617019932803904 -0.13930531581453223 -0.63468955601416088 -0.048111190613181601;-0.1718037819281483 0.68584904265015501 -0.13030735631454476 -0.36365703371488833 0.12394312867964173 -0.76002269937712696 -0.43774227494926216 -0.30512430972098176;1.6555036369480809 0.87064929978153904 -0.16614992170568099 -0.1936682187495814 -0.60731976275982591 -0.15128902934846628 -0.12053655789706964 0.25877648851440527;1.6178894440271094 -1.6516628918664524 1.1893496042247269 0.32595531431106572 1.944184203565583 -0.72545571385048635 -0.1041540004546052 1.6349987113698405;0.86309906105986256 0.012974242161146787 -0.12687213327595526 -0.65655674617401172 1.9940049028774363 -1.0027521329764093 0.35517438682938557 -1.7600771080726629;0.66674269734224789 0.47168198978428044 -1.4023981810515602 -1.0726371534338541 1.1136162934770084 -1.7559778361564597 -2.1351220047795674 -0.97731176584825241;-0.20234276645415658 -0.39433157374083427 1.3350442322155232 0.55005160786707052 4.36357865818138 -0.20368332580591297 0.39542859906389921 1.1105434618319034;0.5123526958614244 2.3735034168041333 -0.4560021064720905 -0.20644413144554127 -1.1029653295204631 0.23399817104461132 0.13992041303638061 -1.0667515904917073;-0.80751590260575601 0.95154347006142947 -0.53171998146506039 -0.25241298571953258 -1.5576267333115144 0.059336885348774342 -0.13371416203300948 -0.18465749227945202;-0.82897863652134673 1.2021280584689016 1.2808336289220283 -0.017975745709305282 1.4543212044226992 -0.3728711453193263 -0.45497176034881537 0.74922236165619982;-0.4684804404951467 0.81930647028702941 -1.1701253298443313 -0.5000738431177616 3.789212222424954 2.0155042706271216 0.31411249853891315 0.11257838092371618;-0.29991370036999354 0.26836137580470926 -0.11777968343991733 -0.09574707710797023 0.81565180050824682 -0.013584491929807523 -0.070275316029414475 -0.014674423397762384;-0.70328563368765062 -2.5996043988163056 -2.6979183328379133 0.44100770564435504 4.2287842014303383 0.43464369314858997 0.76589580110957689 -1.4260843012699629;1.248979392445775 -0.40862017349422924 -0.82433697406937734 -0.21343849914805071 1.8559795745116778 -0.24665048072372428 0.38466316869323819 -0.92430309859867854;-1.3048622208386664 -0.37557334323710234 1.3422963158738421 -0.15163410630410523 -1.7342794528217604 -0.094029560395449338 -0.50593303254789335 -1.1539796150371924;-1.5245773453200941 3.038523476955068 0.49080641479197074 -0.14402350184154616 0.30729908982937149 0.8363592084424214 -0.37912830765132843 -0.66167634301001133;-0.4091145092518737 -1.6935853150871976 1.5452586937620942 0.41034721108254057 -1.6416108894083508 0.46751686979065576 0.2990236037460447 1.0705001552881934;0.51747602905884327 0.95937448517244639 -0.63379850317281639 0.073224314551328995 0.40613810775166048 -0.31061564270163039 0.054847904232180354 -0.38206057566572438;-0.44292207483106766 1.3110560419444433 -0.50785346925704433 -0.56841077752453173 -1.5235634642751699 -1.4329036274736269 -0.78110826471222283 0.024782180708122062];

% Layer 2
b2 = [1.4332629926870897;1.8655920212213475;-1.4780010832394754;1.9971063863972618;0.56497195484934382;-0.7589195724193678;1.5138292956812562;-1.6348379781012006;0.34866197385295911;-0.53956391051456798;0.35045982969817729;-0.1276476815165529;-0.92291920723695564;1.8577306063058803;0.24097800582669146;-1.0912115741136004;-0.65345738419831956;-0.75547971352183274;0.96020822342454959;-2.1112455735256197];
LW2_1 = [1.565823081195731 -0.76303041905200664 -0.23685492814893297 -0.37071611471030264 0.68267343513307266 -2.2014971907848393 -1.1129959149631135 0.29269637919213143 -1.2293619712174606 3.1389175903240401 0.43690982202257267 0.92273711088403987 0.58988986448289404 0.37144007054432904 0.38183378969400972 -1.0802247159087799 -0.29095601025107309 -0.41598111894652967 0.025854036518784561 -0.14175552482928092;-0.6360860557680631 0.30935425702524877 0.91597233361621244 -0.033302345634169991 0.20265212880523867 1.0332936425067867 0.60428719585759849 1.8509473969255841 2.5064683539060781 -0.33123959890466603 -1.2376512612883013 1.9194593969370537 0.28941231518590693 -1.347073800761829 1.9324122376430937 -0.60585781452607401 -0.52965229448517903 0.98838771991797025 0.18039940700599674 -0.27270608098114724;-0.59896834839638746 0.020660142652948882 -0.61189890531308333 -0.47109929283545787 1.2707546227956559 0.21886616151602564 0.52613651976185116 -0.84471528956911779 -0.53752972930364162 -1.283958687523707 1.8912978083730616 -0.89245424757995684 -0.034280874694093438 -0.18052980498273499 -0.11929927963958946 -0.72079480481722158 0.93275437217473556 0.3933283736718694 -0.057153202944172678 0.22344838793558702;-2.3023041983274699 0.40486707244344367 0.7630577912916926 -0.65690300330503859 0.30082270221458096 -1.0042153556202287 0.72754384187991394 0.56524758273074893 -0.018003293567728028 0.37841714590239056 -0.70351893959436407 -0.026866466527525799 -0.91851118544093613 -2.567095418124417 -0.57203985295405901 0.18188775545418284 0.54309980828439997 0.25721371623759115 -0.96006882693235895 -0.31365794643003042;-1.4560695601680911 -0.14510230759414877 -0.89217036773202696 0.094146920618222205 -1.6061412103821826 -0.13284157566323224 0.39180517317908359 0.27122682865848058 -0.23459844090116569 -0.0013743464065965397 -0.4138559223573765 -0.049487485450217437 -0.6833699907245081 0.071659365915617779 -0.34354349076617563 -0.52825423947807659 -0.62049202116006319 0.70714218365741177 0.29573466594642206 -0.83454909203923633;-0.35486640842665323 0.062660376770312998 0.72078498256366574 0.36248555836438417 2.6978942682094549 -0.58094304396996554 0.94904379133119021 -1.3428747868748498 -0.92472101269525597 0.93272057448984691 0.31435946622037225 0.60955770080795846 -0.44450340202712807 -0.83384442652032087 0.45215139115295233 1.5566923061510527 -0.2781040443465212 -1.0009194167453672 -0.0055228768910983161 -0.38742319014178456;-0.55848869363630171 -0.10980941731191773 1.1658960148516104 -0.75937168198751026 0.078527070709853708 -1.9837788813558785 0.14360039830801882 0.8111148095582833 1.1494982552483357 -0.64376048894959592 -0.0079321301552542287 1.6891426648066756 -0.53359541723080661 -0.98295712562530246 2.52722600497157 0.094930504420964484 -0.3959528671773454 0.22071372298832595 1.5852260527838331 1.4399985044415131;1.8934464128809654 -1.9955868399537842 -1.2918172643831078 -0.23458791604247847 -0.42266752244212979 0.46273078386507138 -0.70348922388883917 -0.75118749059997902 0.32443258685520815 -2.1224888816676528 0.83840911935800233 -0.3910214599289209 -0.99205225970336586 -0.30485200041847549 0.34664847305419177 0.35842430423179278 -0.11564137017693747 2.8305978043424243 -0.81615808637963272 0.53537922064537569;-0.46256667214328129 -0.85356006645155447 0.41051482213738688 -0.6498180079632101 0.41289348590705716 1.1472381864200887 -1.4956150415248721 -0.47201655908812828 1.0058345516135885 1.1159143689429303 -0.017698698455042718 0.62201555761694149 -1.0131430121698268 -0.45036025570959759 -0.52072493393516395 -0.37356243107896903 0.10050675074953899 -0.77298401796777072 -0.83397646763930966 0.55439444400335058;-0.80557403000562622 0.69244191277122391 0.68548547178910657 -0.10592376029559797 -0.32140567280810289 -0.68532034503335459 -0.12184324853950811 0.24755288685688198 -0.27628045861469475 0.48775345820342658 0.35397159234799369 0.39654690672452747 -0.71302452538864158 -0.2032733834213927 0.55060486369979478 -0.48825569316444689 -0.042862182488502654 -0.28603502348902221 -0.41265165816140437 -0.19630494530555193;-1.0631246742629059 1.1850072257507476 -0.030699273335339301 0.086926813299696495 0.19713778371669005 -0.67999372704348404 -0.86172479263166968 -0.50232027805803292 0.57282093563375791 0.86722359832029272 -0.66052405195143349 -1.1227575398662606 -3.3116051630321959 -1.511687185023868 1.4322986626651637 -0.31907060930383746 -0.43375685155807497 1.7917826459964841 0.23276173875860598 1.2205355858037064;-0.41014488254940812 0.27408417959301984 -0.80900592820948825 0.69447778927147819 -0.79044893401664174 1.4081109780373313 0.10039887667588161 -0.14878888469635698 -0.082644892004871032 -0.44107302169821461 0.50598428847153487 -0.66157767616682106 -0.92349150162705318 0.17694539023130984 0.77752496926296943 -0.30553840966300727 0.38765115984538023 -0.23837617585018381 -0.32074975372330994 0.25922153847618773;-0.22601950307985844 -0.82718599655292069 -0.32795370558539294 0.7750326494382328 0.16175852015354694 0.18934032278374321 0.59293712862173376 0.50439948001550061 0.28159943803128729 1.525567113921934 0.61360142629733638 -0.59320026683063432 -0.52324044515575963 0.51767122674961041 -0.11624365012982535 2.1799132932072047 0.36487379886945992 -0.080469996318920906 0.50213897562193655 -1.0684081535947252;1.1799723427273396 -0.069990198252962668 0.48109344433813206 -0.38855547558409281 0.82179445372858784 -0.63882880722250379 -0.67431741604968654 -0.15778989725838619 0.21382737733919255 -0.56755698534649335 -0.090296980902865559 0.61021491138175343 0.74125157047576451 -0.15470468635360948 0.32680960546780602 0.4575272398653456 0.19201063333996943 -0.65463705107574421 -0.67337756597608023 -0.19359742362002585;-1.4680484149269903 -0.064673427638912095 1.2524751212136946 -0.5166268047375624 -0.022864558222561705 1.4122864362908212 -0.67399999230433216 -0.8050702305607802 1.0753701909171673 -1.791330493087558 -0.77005376618478705 -0.089809361521067999 -1.2874680510485257 -0.067566505839925448 -1.3992867846775805 0.29387316460901131 0.10129283283243996 -1.9462567370069994 -2.054648089419441 0.7820686123863928;0.029312400344532429 -0.55740299826650175 -0.54127884997670461 -0.40783959118097363 -1.5574817947087531 0.65140584860218187 0.059806744903040956 -2.0986620684932462 0.79619693827573179 -0.67486312473645604 -0.058524162113866782 -0.51857059726732579 0.46702749134775245 -0.13388734668089752 -0.45058505034960478 -1.3685567256535036 0.42083544456195915 0.18201441135043714 -1.0619825913713947 -0.5213809721276137;-0.32879220684051236 0.43499743395811236 0.65564754196709563 -0.96135179541760962 -1.4088112384308378 2.105370976918636 0.36059741101569454 0.56195407185729529 -0.32179442354137033 1.4186094984116018 -1.1029598444694251 -1.3281039649461606 0.64603096555649531 0.92066156192557247 -1.7171838369643231 -0.96500385096854968 -0.25796026701370134 -2.3752832269677038 0.85139573306402994 -0.095704210904244996;-2.2375626207709232 -0.12243437909118741 -0.040684858663750913 -1.7346567594912397 1.2673306534640842 0.095998215504572659 -0.86702939842858107 -0.54840975623596755 0.95023349465287976 -1.1931385968607138 0.77002591747333293 -0.033270872199076644 -0.19167605807815974 0.83457925348648854 1.0177040827898878 1.1250177704131588 1.1370206827814089 -0.82877299062140353 -0.70977026452245862 0.052189345495148587;-0.70952760226778322 0.0035828652442362885 -0.29249920950397218 -0.30874951280826657 0.55569120437753416 -1.8342551044285356 0.53955914913801939 0.2591510468791966 0.034613735866381848 0.12827273014933874 -0.77979461781741766 1.2376857988600796 1.1477321660488315 -0.3223230186441709 -2.0732734896434053 0.060601915930136509 -1.0433193266299556 -0.82218592619936537 0.60063468408129606 -0.20320556578922569;0.4308374682448689 -0.4111612085415271 -0.43805191698442286 1.3045821513596869 0.80616113330795247 0.19955358775043877 2.6013608559036263 -1.5557775266453318 0.6320321322420126 -0.97003714303525723 -0.44028839053267921 -0.54669717633791093 -1.9222197196551896 1.1652688490772332 -0.48491096548611407 1.7191549444268484 1.0461646938824571 -0.7028540533414287 0.56432609863449046 -0.38134097069655204];

% Layer 3
b3 = -1.2925616066608911;
LW3_2 = [0.050338792702226867 -0.27563972913767498 0.21363504830453681 0.59289052843032697 1.0196196580603183 -0.052404760908667067 0.54732346887188155 -0.1565611896021212 0.060646347162354959 -0.58360623751048146 -0.019583841122115534 0.86525677697314785 0.058956719587166098 0.78189995213152552 -0.13302405748464927 -0.010934527447106112 0.15453787754062531 -0.21318057800593551 0.37898233139908921 -0.44309820107462955];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
