function [Y,Xf,Af] = ESPER_pH_8_Atl_2(X,~,~)
%ESPER_PH_8_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_8_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7480464970292848292;1.5785768647577114177;-2.1364726267777456314;1.2992918187624138415;1.3799723957818395004;1.9800799075439527996;0.89922520117902937642;-0.26722430550583053943;1.1703580176673671343;-0.64683496596307854531;-0.26563165037907104926;0.52492312727445589182;0.42292443892875858369;1.240773152792403744;0.59810967955869664969;-3.4501211174393593417;-0.085027247684719114984;2.9252446566925023319;-3.0958644128904269088;-5.0621928089806536022];
IW1_1 = [-1.3009997445174144026 -1.2396065166999199469 0.18484305730263095313 0.261320100324492266 -0.87109786173993442038 0.21998177840408025818;-0.82093179613781441795 -2.244105706009306811 -0.52425736225160113335 0.090382790366236309687 1.4813599799772476651 -0.41023101035820308535;0.57653341014187942104 -0.43233091057645189892 0.70599323635087973816 -0.91130890890500937385 -1.1492292021864556339 -1.7612470133118829363;-1.1649535110699098528 1.4890268918735580783 -0.21621872394115029814 -1.0462320835105465289 1.9571160588408986758 1.1631590434909273579;-0.53639136423699151912 0.16136989543376037415 3.7977796470813460772 -0.69524472058582120759 -0.89328704291589655639 0.54029329901129730107;0.60342171775221664642 -1.3785065003323366817 -0.12755172461510727588 4.2742736711527697935 1.2093341904629060224 -1.0170596862785750147;0.5325588012998432319 1.0699596493277998555 -2.442543143884614576 0.28516854857483714403 2.0329738581665632857 -0.26105028433838750601;-1.2611165049577297559 -0.44753097513910022887 -0.7544010197263057993 0.11057898036013404097 1.2220259905479926577 -0.70575526027679580388;0.98815709069602952752 -2.3839822022971279836 -1.8036005156281855744 0.52393265354914719811 0.73107247360483862408 2.0710202500051728691;-1.0499559551902208909 0.76432865767101476617 -0.045165783252198297981 -1.2220254020647380866 0.1491681831683126791 -1.790686856858941578;0.71952660350407449119 2.1118338994784777718 -1.1981473705178311562 -0.031930101669893712346 3.8011624186869092945 -1.7418344392440261448;-0.094249119929417979336 0.42811310661867824079 0.074453773341629905791 0.082361298666944665614 1.5896433593493792813 1.4215907443505810814;0.66193750868421863398 -1.1689683842147069459 1.2949246633914088811 -0.78926140632829311361 -1.3073226540654798722 0.46306325084154703609;1.2034682049811735727 0.97759844437483067736 0.8698503819582276142 3.4102168640765442298 2.7028583785454003419 0.43603659912132042287;0.30926667334105129026 -0.76582988849457556135 2.7145474545654897369 1.035776586197622251 2.7726142402396343201 -1.5061136891390944914;-0.76853466475444809358 1.3294783749193654909 0.59237384709492435508 -3.3898168228210727726 1.2168854333068501727 1.0180275681754629158;-3.2554521099501676495 -1.989866241752667575 -1.3509174188988313237 -0.0631856070024646721 -5.7817480597034407452 -1.052133166097738437;2.438211214490350276 -0.39470939284321071572 3.9664787910262639947 1.6226974133935441191 -1.7237267988242530592 -0.11000556725219842735;0.19760003441679541147 1.3728751982169467016 -0.55843551978620065146 -1.3710918355748449304 0.89327321262871528518 -1.0829136893872584047;-0.81828575114699331206 -0.34135981237521267895 -0.22357550904445094853 0.49146765940252379323 6.312971386145759034 -2.1620107448820093943];

% Layer 2
b2 = [2.0949436273250015006;-1.2225999155247653238;1.7264996308323290464;-0.65670287466252719177;-0.44506992382702303956;-0.37659651770503776991;-0.59116709370524445077;0.1656829519175501142;1.0878121219546119658;0.43603289322924759785;0.98431728975843801877;-0.66168861727282601848;-0.48030857995734999033;0.96516744893575923125;0.40701645994509144666;0.88726474747320616121;-1.2779137019840400846;-0.90715427958852856705;-1.1635838286251452001;1.9438680475889369426];
LW2_1 = [-0.76358674184183428224 -0.21985165024257874444 -1.3372797223867007865 -0.26723198473947235021 0.66880977822977993874 0.43203067554948249018 -0.19865320258764229688 1.2373378518374222867 -0.67036302229539268538 0.93783203383113322715 -0.19275650662242208022 0.85841234899273322068 0.60079396915785521216 0.21995418020592982788 -1.3660227883180009467 0.60215183231843349976 -0.44568996540855576605 -0.05652530147390295856 -1.3782951361771469401 0.97026607500921768779;-0.54717321982490441101 0.14801740657605322316 -0.031620319338355046268 -0.43045577858453787368 0.058859923335822690593 0.73904805954475816243 0.38395696292135600425 -0.4230478282619616337 -0.040023550026531948265 0.5260153702794778674 0.2516499972518178585 -0.29686657811718253352 -0.45177762905855578524 0.43818422984185750879 0.091491029351908087497 0.16449841838760040358 0.065404187449399478482 0.34075872462754108749 -0.43424281452174245954 0.53024735707750880742;0.1991970533606823579 -0.14120553579562783453 0.22516243556260204239 0.018509185777508582738 -0.87506189728884609114 0.71418664198418069233 -0.61296498683586986278 -0.032496485567534851013 -0.38891350074838870743 0.3822769519107474534 -0.50263625897597496994 0.80427972274535652897 0.57269730860363809999 -0.51952170163559097116 -0.52031251883942830627 0.86694912916906452516 -0.96359608007797881157 -0.11949936992556479953 1.1552465395419888594 -0.51297287122542545301;0.18072032102831617206 1.7308196753511548849 -1.351931683822618524 2.0034289601208601361 0.1184268798019859209 -0.58071703387381301553 1.1812403238056670141 0.27250880750342854064 -0.22383220237544085296 -1.8787777640206309027 0.35434495673472143906 -2.2058469227757586673 0.61681384483834444943 0.044080232709808070402 -0.80155113024540569633 -0.2701137394315376028 -1.2149572741485972216 0.16415459574339064108 0.11998997289950116829 -1.0718978724131460467;1.15774049795950984 0.051089263796849124222 -1.1196392559569312564 -0.13685333210354316824 -0.8813963989356969897 -2.9475224459576527813 -0.38986643444385737922 -0.40385066768349098254 -0.3317808820797281677 1.3732628905808310638 -0.30800425469038350546 0.59918264718628855281 0.61788808404558415166 -0.36272310760190379364 0.99704598728042859168 -1.0545100632842527855 0.70731622369105140447 2.1760344369101245476 -0.0018513492302578322957 0.47061412995588214336;0.35685494746933116295 -0.63069552798264549853 0.48319038209172265885 0.09435910767231991958 0.19538760804835300644 0.18789443068392544522 0.077194095533980308654 0.42489629753240371057 0.89779392044524541916 -0.218057804740277833 0.56550600858650001967 1.3826913143461414535 0.63609261020484919591 -0.4252471067149005135 -0.85414665069978068512 0.63182734159347109237 0.015381666332002290679 0.39300561319901305968 1.04770316748596648 0.45432135187606942361;-1.1638757693354038203 0.22479517395155235171 -0.40284753026472164272 0.37023377415654445954 0.033356083125415242341 -0.5623927053724573355 0.09285325631913697586 0.83013447011087204697 -0.16263376407868845863 0.21892092493298587197 -0.10868118882619887122 -1.161730221428497023 0.12909938798196826659 0.76638590647019522173 0.7682168146477535986 -1.102481196595555879 0.075494783267332540855 -0.1395255751477467443 -0.81546944019843770057 -0.45328159774751264344;0.40692439108510319867 -0.35314580325210503942 -0.56176870403613232696 -0.23655174581827403957 -0.51283399158555798003 -0.20118354410150610101 -0.86344450074357348424 0.25124758125473406478 -0.0092171377104869004621 0.16031994428731030644 0.5646283375183528408 -0.40744698450401550804 -0.27272633222333353409 -0.64380065188728530234 0.67744421020406253575 -0.31111259367898214112 -0.12172464005775653073 -0.032184825236661350478 1.271810549249227984 -1.2555418151046597863;-0.31934476652234639049 -0.0036981791384524042784 0.45665982336753968562 0.16741078770927744768 0.28084191714499212589 -0.3336264801523091128 0.89153625617704856943 -0.19232731854148030215 -1.7508935302820320956 -0.34741943972820971132 -0.29553681649654733876 -0.4501098275330991938 -0.36686960925544426226 0.1323463124994180562 -0.69278873952667729963 0.031074184601213562795 -0.5707710429543507713 0.47841706639891407038 -1.0321390329197690505 -0.40748663324726558388;1.3058534748190138153 -1.268494819538377838 -0.060136857598161043426 0.58552234705923100755 -0.74697056880091083908 -0.39864928214865413825 1.771576077690196982 0.48170510854194448225 0.3263664345465579486 0.77938857528110805362 -1.3377701509584571937 0.62934614991481430124 0.81410997173115284831 0.9687135259156390843 -0.37034090191940161052 1.4203855930593820567 -0.48264107342621337393 0.1155013194221777284 -0.39919080810400237036 1.6891196225961093713;0.25142217029573249443 -0.54936167672754465663 1.8889869674294053059 1.1140311142111842813 0.26260880906336053764 1.0254744585706871973 -0.56777238425807341482 -1.449502712353158973 1.8351363455717071282 -0.25732920757960037195 0.29716137016842797403 -1.7448011861558552216 -0.32243413766129352949 -0.70981573065910164022 0.47158798302925880597 0.04966631242673685831 -1.0945766918910282417 0.10595089012984414134 0.18142013236780379914 0.77263237749271262977;0.36115531770028896918 -0.59052448493927245377 -0.016409747816469172355 -0.30160148553832727414 0.492451342425922034 0.81330839295353563045 2.024938440295072084 1.3023795218336557955 -0.045678340346542195549 0.2771360329189475058 -1.0390952981913115227 -0.66401738126958365083 -0.082827807227307231885 0.53531328207998085666 -1.0506680867280400182 0.25876114471074190826 0.5209907915635838549 0.32751927308420025753 -1.1601806151670461809 0.41423414233071897961;0.040687587430005112132 -0.780569240429021316 0.12764577947393579427 0.021960487878747544238 -0.73363704251286410152 0.7512639096460466126 -1.3806723442681168024 -0.36121216437076519856 -0.34336275112396841269 0.31031880976578990472 0.57252023274504126871 0.046117356347973460784 -0.70665638379787265588 0.61614211148682096475 0.093846497704891229663 0.50493228089138453285 0.11181027769972606833 -0.064067551517154042173 -0.8004498334271826776 -1.5663803747343933992;1.2213364572632847693 0.095681184378478834063 -1.0081865341191962315 -0.078224537253785017543 0.96445643798057800744 1.2587275722138211442 0.091303081803465913069 0.62519629589828595861 -0.33355603082590901121 0.26930914541652134497 -0.47628797241313036714 -0.50377140509697415638 -0.93522817104820155087 0.28238685889739262302 -1.4578303903379747908 1.8601334425412601181 0.10596763639147045721 -0.44995989727760565824 -0.862126542941224705 -1.3293463478007045975;0.80312185818918546687 -1.2554340991195183097 0.019227396260530917049 -0.92540701870300556831 0.058362561145291209919 -0.83279015257089739066 -0.8168578126635157588 -0.18801405716278238311 -0.090376582936942478907 0.39426326081618678909 0.41372063153016835901 0.35329187994919919458 -0.54332351354306940294 -0.60495864557082368318 0.74128177862084321248 -0.027057404139712505631 0.56018162678755278883 -0.092884486755028417004 -0.36083836267594637803 -0.68576792698038657736;0.5891691515826098513 -0.16469935469554114471 0.33341423523200419687 0.049917763145771461286 1.3834153526926187272 -0.061559423295328069559 0.22710979512597331831 0.36088640235379515486 0.18503347983129864174 -0.63306093258689422054 0.17610129148919587139 -0.88856286022320685181 -0.060157192846232776517 0.48496833154128504706 -0.96148749724340309974 -0.20726348531183275137 0.17663018727775844918 0.24924668483968900889 -0.28793004090460516675 0.38778108765032820449;-2.0936265869707231246 -0.26578099155949658217 -0.31680838057433230448 -0.17767681743698840457 -0.27005034918115533582 -1.4360281017579663576 -0.41416972015831265974 -0.7912839304181265021 0.9849877748236123276 0.56292070469265942378 -0.026558903668816288834 -1.9356354488858171781 -0.58796341553702036187 0.43471309052857143307 1.1211556179592208071 -1.5370678190288000753 -0.35793171392906741879 0.085290441905604197359 -1.1180041000234470783 0.060955836691845143027;-1.1609493454113104516 0.40112806276136869776 0.4328883777798885335 0.31512167263217266688 1.0024784248494980066 1.0125633985312121332 0.85945068739186436524 0.71715323017974663689 -0.36541717349294861039 -0.63985965817834022928 -0.31807707769634407935 -1.2661584698239762847 -0.60871525535896531256 0.10169858991990024522 -0.40639409585479546738 0.42335150620484385264 -0.33455998011729531916 0.51016200720461546414 -0.46682594445652320081 -0.20937444661118323475;-1.2857524882501023544 0.71527524000598730058 -0.040431943092523091321 1.0230854517125653746 0.28594501477308537085 0.74646332325473607749 -1.5747053835330533378 0.25411408279560743217 1.2570666381382777921 -1.0486963542678511274 0.76342519438941414123 -1.1958584517439769801 -0.33448013068513454682 -0.13566842423161751263 0.15370224652663783127 -0.14253284477631378291 -0.63555465411298861511 -1.1397926748639499728 0.14906038249576272769 0.30881055174284893772;0.19106354608362824399 -0.81705416987087986502 -0.13410497446990657378 1.1146448018870216412 0.26448971291941819617 0.57096142539579231023 -0.58995887543736469372 -0.5570459716503156633 -0.13510622196536040129 -0.81432756762679092688 -0.73523504892676716516 0.12079904941508468053 -0.057348652192107316128 0.3465709581247437554 -0.41051072856036452396 0.61586040076171499891 -0.5227872596928249127 -0.91962037325675538568 -0.87057566223942961514 0.17461643413192642904];

% Layer 3
b3 = -0.80313829398070968324;
LW3_2 = [-1.8559260696694714898 2.2890210955433403228 1.0967437010272069742 2.4180421850589937094 0.37135221882013602634 2.2383372272594024288 2.3520374591321773217 -1.9060379763905770378 2.4875094017609127306 -0.51852385112940724277 0.88463959936874259071 0.55698651499153339905 -0.8989585871191154709 1.0695232030536516721 1.7861150798762421843 -1.8187813265208401248 -1.3903285875006718975 -1.9931668441654073476 1.6054751265318361053 -1.3023057574136160941];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
