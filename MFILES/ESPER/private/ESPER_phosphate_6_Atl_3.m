function [Y,Xf,Af] = ESPER_phosphate_6_Atl_3(X,~,~)
%ESPER_PHOSPHATE_6_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_6_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5860542872817355864;-1.3624912267734441418;-3.8144383620552519965;1.4088823606791343046;-2.2753369522044710749;-2.2299866305261568655;-1.6048558463089581672;-0.40288896243274185949;-1.6534203643147655782;-1.5143820724199825722;-1.2240437701068107579;0.85748463590609780294;-0.55997846467620615574;-0.069098917330033718387;-2.4558927391735387857;0.44575170592230861644;-3.2749509222751211901;-1.2561368323734916075;1.7644211759561845287;0.2835914813075475216;-0.96670646039693564067;-2.3257780190157872902;2.9724990341423249696;0.4711181444124712403;-2.8887223199205296353];
IW1_1 = [0.13172395281352422547 -0.48007175982404048931 -0.062509047592161040563 -0.36843405172309590112 1.4670273470576438157 0.3954321548527071073 -1.3036468872942437169;0.90363074661751763283 0.69872953210832422499 0.055687578050920776007 0.42452440487206982711 -0.74837068198092493443 -1.2527852436251900592 0.70411212014012181104;0.16834594034644026483 0.051928498689613807049 0.96835533382477245734 -2.9959057244948015253 -2.1504744278893643816 0.26518631379491003353 -0.88783327838335612814;-1.5764540501945811801 1.4713156853022091308 -0.51537483346204360224 0.84667595088977409823 2.6043255303880394891 -0.38426394510657441161 -0.41200010830036198906;0.51526881778160915637 0.021830749893403736395 0.99984625855547992757 -0.57341485289978144646 3.1927133982430158099 -0.70064544840965892192 0.55088946140487582426;0.10295343555520417023 1.7715823190355379779 -2.1328992573506102559 -0.195927589116334816 1.832264180445030588 2.0982406266479491919 1.4101772583259613025;0.50190903285170695991 1.3218809213843878414 -0.71587700884982286009 -0.37197520573359377227 2.5937453189975276935 0.16132129480768728214 0.30223999092973452552;0.81242220334156645123 -0.47348933293858269655 -1.4736153295192013779 0.35801731663306246567 0.10242023523529467099 -0.3511081988169205137 -0.1614035354990783766;0.81360219270612399445 -0.73712751627456307713 -1.1199388394369658162 0.0065406372378831994369 0.64965658242709845016 -0.67882979525005249233 -0.88284252474424107504;-0.17921785050587360488 -0.12283070627054522295 1.328623584394254431 -0.51051411015952630201 0.51828414799729805029 -1.9567021409783140751 1.6997216249734248272;1.7551654409877446295 0.9435413332532857078 -0.10756812782086240532 -0.14645715978915582745 2.0205296807435781936 -1.2074169830343830512 -0.36537474291739913124;-0.44909388464516419859 -0.63470005648029259593 -0.049211198250060324277 0.75283917727775662154 -0.16184074406156337411 -0.97119063610221345595 -1.0004727394165930932;-0.083752710274996658435 0.41899670964371915627 0.70982596851033019636 0.071971201162099776583 -0.84792321472652731895 -1.7871158453991489168 1.6832630005885791391;-0.036198944256588122537 -1.3263621059138728242 1.930428791258173904 0.15486920070867815635 -1.3666412740688236305 -0.15174575601443907047 0.59488763833503033318;0.52985755162556913422 0.67425644200428935804 1.3276320317099221668 0.98416056466450019258 -0.89720903544691876785 -4.2662885490666218047 0.22492363716193564116;0.56150674444440495936 0.54692522072213400897 -1.4385722779888947542 1.8025822389590351325 1.5891599087769334719 -2.0738564194973085897 0.26647647531492274497;-1.4702598198564722498 1.4577056952549787283 -1.7564040399849645269 -4.1724619667465603357 -2.5597841016137836689 -0.2807132568646791837 -0.11872470074206559199;-0.18921577969260522378 -0.17166004854907532251 0.35314144087596810451 1.5764889484069719572 -1.5366129889349802173 -0.62088109883182884818 0.72062997371016879189;0.9910934329859543146 -0.59990924819203672591 3.1216104893186988889 0.1267469688713890319 -0.51218780694033749779 -0.60474902873355407262 -0.46809347637383486029;-1.1530726312773087461 -0.35078150649194478339 -2.5191363114310880711 -0.40327588839988953717 -0.72529299057464735601 -0.39452744367873371356 0.074175957106200562929;-0.65371887091004277082 1.2741139427145247165 -0.1156028296419904372 -0.65763653460327842204 0.63586627828325592571 1.0245419437690792552 -0.39479653116119001188;-0.49204234056196782809 0.4706574584704659725 0.5236205247147857067 0.13356337002624277255 3.5489001454969577587 -0.84407779384261916178 1.2733202157085692363;0.89126969126005906041 -1.7677741303551124386 -1.9368354225365023158 -0.73893077285077735095 0.51619029656842718712 0.47745337250259262118 -0.067800750597612063908;0.96125715803620814803 0.68406531571662720914 0.36356248303550187106 0.12781791599334613174 0.7653115505570140531 0.89138291754352938501 -0.68351584504840168233;-0.47184743008985885471 0.6706680726853456731 -3.4184574704379664389 0.4229199504859823544 1.800828240113927059 0.47083942795016592298 -0.051465495868502249277];

% Layer 2
b2 = [0.11301329060029223494;1.2793393711723657358;1.5285791362097445045;-1.1962089827579951429;1.7950504950925121328;-1.3730889452765222547;1.0354936668583643034;0.86005378328159542978;-0.21023322485124801284;0.3210488484362830075;-1.3793782638309930455;-1.3294046760921522932;-1.7980090915716748778;-3.0551473053484348164;1.8607443546007154112];
LW2_1 = [0.75900136091389935888 0.067839899176147480664 -0.58930799020388358045 -0.54383818546890805301 -0.34714662327240447537 -0.23368960080397302437 -0.19119778096334036355 0.73757105232043107534 0.98487709620528562926 -0.097954213558545957796 -1.7592335074364113812 0.5201558748022270251 -0.46468093509247149209 0.058881908348375713858 -0.41151304606446248435 0.15370018378141317439 0.05476305627566563361 -0.60553884402447177848 0.040952261022981745198 -0.62640351344362321662 0.36584239043960553595 1.5407099597532132318 0.14356576213751312543 -0.082959991164110569173 -0.21984474050027319469;-0.10571470240769369198 -0.67807793089760293181 1.7262865246485856741 1.0638467428132578618 -0.39725259993739492348 0.41652091478350083964 -0.83683671611670418233 1.1295331154181389444 1.0918944075364451773 -0.11060451177485872143 -1.9849301446882685607 0.71186472971773551155 2.0127847313758588932 -0.22642366644338474124 -0.95590503829093853572 -0.40968467730392627013 -0.13454216216046166466 -0.80506474988333753817 -0.27387716583420496086 0.45438169459826188712 -0.33249781722860421995 0.50064178542185033827 0.95150461422102650122 1.3493322682546065039 -0.28080741183364293923;-1.1026793693652157113 0.23641238778882667226 0.38701809977788925732 0.46831683229968429361 -1.4469077417126008367 0.3001072846880916134 0.41545867278260678601 -1.6440468719924814511 -0.13981894196379782147 0.28496860291459097381 -0.29340120107956346729 0.69212319995163384956 0.70547512292898173492 -0.46885243213308319676 -0.053105250014736149478 0.030577337902703137507 -0.22092039445175498669 0.028380799021887646166 1.5422429751156692124 0.22205047841071895443 -0.28560576833056589008 -1.1911433929882748739 -0.33350457357133683756 -0.17964194025182339542 0.822363177386527755;0.99425228510944285709 -0.13163112109176886011 1.2938600121333949655 1.2026033259753072802 0.48733696701073148105 -0.60412496691881523159 -1.4450914040400499871 0.40820472916856720413 -0.30208363443298313911 0.90912001555171817468 0.65293554292907740599 -0.16721787071363897192 -0.63237216183600253316 -1.1180344646639039929 0.11882174495525917035 -0.35968429676668250972 -1.1533394953682734041 0.40376883704572996692 -0.21059806046450882389 0.30197487011060925033 0.059702293702692428579 1.9758748521603648474 -0.8410144275574892303 1.5231778429438478373 0.29714932900159241047;-0.94003595441970888569 -0.34378797830924695544 -0.34739719951438691181 -0.28489053809511866167 0.3784690069085131503 -0.57461561293524610061 0.22541316135149658262 -0.10853120416378948809 0.44585240659624592041 -0.29970073926647639029 0.13203392045494630191 -1.0399134406920687024 -0.79919713013273985247 0.50867280028518824242 -0.16868438775566585441 0.17635298778271935038 -0.30972677533513320869 0.9985029262414032436 0.37394734638310145325 0.18615833743125134725 -0.17047046926077222273 0.47794014312117455434 -0.085453201217254221023 -0.028774072826151974452 0.54805938783039320761;-1.0508689716497836564 -0.2783537877029989005 0.21555996733603460802 -0.52743212712655163088 0.90391406523285477981 -0.21708090410824937289 -0.40609534874030905893 -0.16751557280936446581 0.752172516435795524 -0.56071647669622293186 -0.44779502328813269862 0.25546938331505952835 0.8172331825539876915 -0.27609770647698406165 0.37288128919074053913 -0.20644410427907464167 -0.40079789050995223709 0.80120443458429568828 -0.35502629014203285207 0.17775789968413421849 0.45187938757775697463 -0.78034071366655732849 1.4423131062300427185 0.0067389329161673169194 0.21806545263047252825;-1.2078839682154942636 0.96572022824039605027 0.52839260158052925309 -0.46365955883494824885 -1.0276986124661107169 -0.66957066173114998531 0.38628076201810385149 -1.1021809267912128227 1.2308174634761153143 0.40524625278756259972 0.59283092463698716656 0.45515691204013164484 -1.4229133726795406556 0.38275457306614929509 0.30530568902061400172 -0.22115074204177703754 -0.32903747054451731868 -0.049878390220297413871 -0.47563000964208701493 0.21813359208673230305 0.92282559984473777615 0.32458828640427478396 0.53567731026492748647 0.38569272229112405714 -0.10862145068128022107;-0.19680684717005703099 0.64588484157976810973 0.16434975277815444539 0.38967023961346408667 -0.63322203457124870418 -0.45941058428039682759 0.72304086572586923065 -0.2971463416351302067 0.061429408759913373128 -0.2728276847895057533 -0.36324722736033920878 0.62114182634995207533 -0.34930155996602041402 0.56063869286737688657 0.041078154977650070678 0.24323993567681287398 -0.0034483544545048372409 -0.14867337417095971563 -0.36931175740218274983 0.2083287644100053071 0.17725787944845056154 -0.080247787919391619371 -0.021867882656586651313 -0.034186205391894028405 -0.2534007432956866257;0.35347365580568823606 0.60610980608931397384 -0.4933423758267836412 -0.010081564468367176096 0.28558611721885485135 -1.1315456329309121486 -0.12631123334886260046 0.65664673699281261854 -1.0346827829476887839 0.33098443172535796375 0.62305344681066909818 -1.0902184602479845221 -0.31681089162042996854 -0.3539809899487493805 -0.29473129921575419443 -0.37964154158340751577 -0.58102440905959562567 0.77140231427126859653 0.29287887007114432603 0.038396762451502294833 -0.18967032022514804246 0.45194263087311647986 -0.23611325358464807511 0.14717583555362520609 0.66919660824615234684;-0.36511970819816386147 -0.78879712515165201214 0.42992821506067602222 -0.18148097755837080958 0.33139800324766655049 0.27839810837951411981 -0.30887521193386219265 -0.37666705438246295135 0.78168348734632542296 -0.23499076266752924602 0.097088417648756142331 -0.041566335804442397506 0.17863683110494080197 -0.11978056585663704459 0.2121216383339663003 -0.10847224340529627862 0.049514010723914439471 0.54082575120422637927 0.011653913427132532588 0.30348366326136605453 0.064473412329280749278 0.35030233866396021103 0.22460222190772829998 0.33006774875493993804 0.28506320738331092368;-0.39882057681159083229 1.0397891790614754992 0.35208937577862331469 0.61369970206467217011 5.1069493676007260419 -1.3163815994239427276 0.22891205764309310866 0.79272808466832611618 1.3435664415711774389 0.088475796050029045792 -0.86862464318122412088 -0.45490997391880344525 -0.83834264022158377916 1.7722031929012345142 1.6335318181595983589 -1.3142637234465728291 1.4367434383447608148 1.2620780098263912894 0.079859199174785941433 2.2819811418858364505 2.2592487732205714934 -0.84829426169589838835 1.8351503076456179286 0.52254113785174571838 1.4043199025127706125;0.087109675727556290514 -0.55395394953345766798 -0.5951302736052186404 0.74331191614030012182 0.57846883050658737258 -0.84383239273793120283 -1.4325229388059390612 -0.034216570096322201922 -0.55299155325150606277 0.71959459915289358811 0.9737595826905979246 -1.5347857804650197888 -0.76109863290888679632 -1.2180840816485321021 0.14007022054746473549 -0.51484368597332097472 -0.78777907105001732102 0.67930891899039003157 0.074279105731554467829 0.56286365137296157091 -0.22718669571182553701 1.2499862731655577708 -1.0197340670594465806 1.1389208314733756389 0.59860146498160460293;0.013601923862540308413 -0.15098079615654505514 -0.7238657880388694732 -0.24723520585420985518 0.85163380882956407625 0.3178426307103972559 -0.83343752372629742453 0.43795094265527512167 -0.19153327765933392257 0.28595409821620554336 0.6521178384726219468 -0.78774452710383358056 0.094399049292770084718 -0.30838064006111681747 0.0053512828443928036823 -0.2668363179928761042 -0.043644889095221808817 0.067766458717693087155 0.50798998468661515915 -0.18727841105094339413 0.056885892192358684938 -0.39658049222730062944 0.16746151110290477537 -0.016563392430446220033 0.40051694184738578786;-0.038853483501156874103 -1.5930073787228757887 3.2790330614710772039 1.6618848785296034265 -0.022506009202468507668 0.64585809142461658716 -0.73890555417834491436 2.7042807129106027908 -2.3780509191623000476 1.6333055457246996589 0.078021736949806325123 1.8048260130792084244 0.94666751915343694268 -0.94537196128583322885 -0.39810969788692102123 -0.95979469681269857784 -1.9501426603774669744 1.4840324649358953568 0.94767484105215971102 0.72804967466378178731 -1.5207345847225077762 -0.28800986996848093602 -0.049334204488502217401 1.9856850120467417486 1.2948795107176735986;0.052545055021236200532 0.038346466205510756908 -0.54366120280643770446 0.88585659049318232761 0.32050557521491557234 0.072784157666498733308 -0.66029825809198716691 0.0055583574040914485517 -0.32066074950722289749 0.099697127466023008346 0.30507134413584435784 0.83291652303384922096 -0.55954401656784624741 -0.11184524361755258937 0.1625036511723365884 -0.044093758878144331814 0.67186751993219218093 1.8763433945501635236 0.80488474517730079771 0.71016283273664382314 0.27225009426819118952 0.96287475377181364067 -0.58516288989447073909 1.0182414026457344836 1.1307620204435790967];

% Layer 3
b3 = 0.57595659402433940777;
LW3_2 = [-0.52993512145001853142 0.33019662157952228698 -0.6179015494246000717 -0.98193243202652080726 1.1067706534903838378 1.520308397468019157 0.6045671275076780482 -2.9530400172223587596 -0.99047406240646751474 -2.4155349183164731564 1.6701885232144542126 0.95719135482330752751 -2.5315297525158748648 0.35803904344121673109 0.74347567539955961013];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
