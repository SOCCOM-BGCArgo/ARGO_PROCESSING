function [Y,Xf,Af] = ESPER_silicate_3_Atl_4(X,~,~)
%ESPER_SILICATE_3_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_3_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.038905985968368750338;5.0381143018408813816;1.2553753371917932835;-0.68320813478114228445;1.7792754374240380422;0.34057707999636710472;0.38917237415769317943;-0.92636570461869616189;0.047704920514645546281;0.11649582483230827568;0.6882381567552181556;-3.0206749108101091927;3.4353154087341994938;0.40225380210007016801;2.2359978163403888551;-3.0871004515912603416;4.7503488757912890605;-0.60768460859735706769;-1.4265299962986530691;-0.19536817421958790897;-2.1938669543286337671;-0.47737954531839482675;0.77006359036606042423;-0.43060759458170877467;-0.62054612818902632476;0.45966895032889931727;-0.10577497573433314315;-0.33307798727504472902;2.938276221050497572;-3.8283292041599299438];
IW1_1 = [1.0741030156745121626 -0.36575921816380085883 1.2951041790239785634 1.6553631445899750219 3.5450558390192603575 0.14498517490722714895 2.1953967131249831901 -3.134181812266392253;0.090819779501627978524 -0.27887947373098270765 1.2762101473524827266 0.4767526033602463853 -0.49665416419626928768 5.3939130195834721349 0.73087957503735123677 -0.78029206950888529981;-0.14273651084172353509 0.15926252707376631346 0.37468339578804132906 0.2362325442686664112 -1.5187105712190527296 -1.790046186443315257 1.2261145906432762143 0.32271119780047474723;0.053020401932995321614 -0.53054988534158020741 -1.4026897526685677686 0.57898514732778671998 0.57080915418636901659 -0.89888125235553961723 -2.1815439074267706232 -0.37207358537529194864;-0.5849443717839852841 -0.3272507567005933371 -0.004605136022687730292 0.95028333190337910263 -8.3636490577073381303 -4.2299282829871467371 0.46959508956430484616 1.7188352398984696467;1.3200707968260165792 -0.63234835765898089743 0.13879244507853338852 -0.97199814817098295627 1.917375842110353279 -2.2283282450340298197 -0.85628542098033100238 1.9257701172211798557;0.77493146733551054872 -0.5051053503478104556 0.2667761281390061967 0.53038766755721555857 1.0638348614296329053 1.4675193163738233793 4.261215775234515668 2.1152018607207270229;-0.23139269857884334214 -0.21452013184896265297 -0.35988445339578084559 2.3391047198328211998 0.83469117398721237588 -3.9068054432198877635 1.0040350135677555965 -1.4845348691056869939;-0.22506856480300979628 -0.21134443894297358368 -0.53611036577720194707 1.1863173492231797734 -2.2641251203377059653 0.17449241595545048056 0.35798632949720649021 1.1252390232535078862;0.24382344935460620317 1.4261169095818673203 4.5982593400816842433 0.21244651703425743161 2.7383723395128458655 0.78927226921222959355 -0.72366564607691985511 -1.6134825826260661419;1.2740835142976338901 -0.05963863488495027565 -2.9225043878286527388 -4.8197461623711506107 -3.5345360087676938043 0.75707411496022802844 -3.5668797874073825405 -1.1915347618925795636;-1.8570545150071990914 1.7852059098493862077 0.16861378363645648792 0.8438206666287344504 2.0643852845747270308 -3.6525746557190865715 3.3983994489785898097 -0.92153838324525039205;-2.7582630002980645934 0.67778296777936064554 -3.6322951136118537541 -1.6383213460024692587 2.6862262820308724365 0.38155929523819964722 2.0308034273109671908 3.7111756364754504567;-3.0128843288251876409 2.3897732302540930505 -3.7579122348360916028 -1.2337965979323275434 -2.7568665934401699324 2.1747087111775988966 0.41994501101880415961 0.49872922076998982277;0.03164093544444920858 0.6069663856578596528 3.5867567131065616337 -0.61932734892801988291 5.1027361046957864232 -3.0038766377855048439 1.7394674696647440815 1.7259176162997846848;0.24514152459937632589 1.0111077577414602224 -1.215578248757666513 -1.1311778582201643673 2.58851498339066044 0.57329498207335993776 -0.42651541647507168475 0.059232696149209798642;-2.1519538662050918809 -0.36888032100626239052 0.99406572959541450452 1.2185297132674950404 -1.459989052272702148 1.1479551279852873158 0.74079370097116070681 0.42133880756721442395;1.8903839727654112579 2.3471315408579718209 3.5590364619906860177 0.58025697243293972161 -0.89578343866792942141 -0.64611945379428248337 0.40522733503487157192 -0.4929185010982220505;-0.0085859230839240834737 0.082334337741209934203 -5.0026935210096388218 -0.25000948975974390809 5.2393285842616750259 -2.6930474464886109409 -3.4771678973926527512 -1.4112021056465176017;0.19297210928208183289 -0.76930682532385075145 -0.47125741358920369972 0.8188823483450443641 2.1655923600561450826 2.8442433286871144915 -1.9971615503455908414 1.3035946628691394977;-1.3236535319931346244 0.95605321636026308063 0.65759180871936429025 -1.6062501407579654611 -2.1300056595388596747 1.0833802667140080001 3.2874824447373907077 -1.8621959507149712376;0.23592662426717311841 0.019866084645514522911 0.79287695513343281473 -2.113500598578780032 2.3356904517057248682 1.2538204765120599671 -0.29134752328097412999 1.6708958815106744744;-0.057396308301669383967 0.10687675100581926768 0.96279604466904888938 -0.93577059842836829429 -1.541267795113499206 0.15419297352234653808 -0.27304301892440807631 -1.0613111082657282758;-0.78822416683698659501 -0.36834375911187744457 0.33479064787617385246 1.1847047350309993785 -3.1081021991531980753 -2.1421368153630644393 2.2890995995950098596 2.1344764661464252775;-0.3012046763955237294 0.21312527846025397515 -0.97912695541481875594 -0.29608655232515806999 0.66044339010235697529 -0.77158445184136126294 -2.2006385376044383939 -1.0301470809448847188;-2.1474045578961407088 -1.20864164073265834 1.1704351313695915415 1.0014053639889561875 -3.7146831277675449456 -1.8016417192906712952 1.6090037480375087853 0.67833509199156760694;1.6467625450288514433 3.0976896902830581837 2.3315425908997178261 0.32362926782686612937 -0.043743029092165125471 -0.87450768276294521542 -0.95118628148902062414 0.25889903351959708822;-0.25676979540833899662 0.069822065655594844902 -2.2274634592132898092 -0.19855650879635874939 0.68711747377233223233 1.8323321802246039791 -0.47683072309672047684 2.3855943937584518366;-0.75110110483535119652 0.47433424453357342365 -1.1809944391945492725 1.701447589174987618 -1.3781902185834815633 -1.2963401148384268158 -0.85638218842510382967 2.5536808965926507398;-0.17075155882095727211 0.14242619524688979182 -0.7526508515066796523 1.2976589849198825188 5.4491457290237512723 -2.5230743854080883715 -0.042610976331597723299 0.96058580239927282562];

% Layer 2
b2 = [0.59128861937031507168;-1.1308642777630673049;0.53431030860550454697;0.9774300505285535845;1.2403642024679748523;1.9709818364973039628;1.5399892768027509948;0.29506756893388247365;-2.8115356969602878223;-0.021708820534876840935];
LW2_1 = [0.11193947573012337504 3.0728373035849751993 0.75218190649402827397 -0.83040961334668628169 2.6918673451878549763 -1.7451018857414049013 -0.049684071105255418754 0.35581158599836043566 -0.31244204109107187595 -2.1333338835434627612 0.16554791678893340801 2.1496288783271579881 0.062100953099443120808 -1.9346582985861144888 -0.41873504326658467223 3.6373114397221670835 0.18883115115461820976 -0.62109990002914550189 -0.20907915685764186242 0.01257627643596881048 0.70090837177469367258 -0.31283060534969797661 2.33992134178900546 -1.2354044998625721696 1.3412385973720788446 -2.4891861474627576811 0.85821173548835461009 -0.49678960441044689444 -0.99057117493764257343 3.6448983393481295678;0.62714363366512526632 -1.3417557878322035059 -0.97409617848436524934 -0.5267669154937481002 0.28823543891516478777 2.1430639586356350357 0.10878513557557925595 -0.17588134443958480801 1.461988568061337368 0.30175079549775102317 0.10273381833051135892 -0.0091285167000008261146 -0.066305529416468805826 2.2165005173491900692 1.1019183823517983978 -0.32415221924937248632 0.33990996353876307134 -0.41211761093449750248 -0.55968884374303751184 -1.0159808534376202349 0.07261753439861651227 0.20877853287191255882 -1.6345470340218650751 -0.4870450960167382326 0.25298138378627993417 0.23705416735025908181 0.098031565177211205109 -0.77526469550552634669 -0.14094230537201993259 0.4019650999757196641;-0.28766557074421850171 0.28832342641315988896 0.05350190306296769005 -1.1635459514797816816 -0.54588305540925297077 2.0936475100318481246 -2.5043939055825208406 0.55611709090369587649 1.0316770988155188338 0.60714895913969890717 0.08055914041566632211 0.6403252082241254195 -0.45813274810132620374 -0.47477756939483212184 1.0306449166198030643 -0.18953221606508657837 -0.10190655250718971825 -0.63432998680134000669 -0.28737718203113493676 0.47150721378767618264 -0.51945286407961632769 0.42936262107196743187 -1.7783095664732715413 -0.21373276871421900691 1.0989433037114939573 -0.017537040121607953141 0.043269201315426303323 -0.26358846842202598992 -0.087982348212178221325 -1.3995933999500405065;0.609178663697705014 -1.0781027650819940966 4.4251409448465164331 2.0530576716207460386 5.0337281991468065812 0.66757085693690221273 1.804969826905173047 -1.182626428980771971 -0.30902946479246939937 -0.35397663732434470063 -0.088759849890793371396 3.1994347088040884231 -0.10239170577812974072 1.3304630437244564511 2.769245521540650401 2.1656985376147979139 0.30273907180934378491 2.1370408517647110358 1.530564730389615713 0.75582080146495078665 -1.3416523967347775415 1.1804437943924026566 2.8715207782871212672 0.061016692887207492346 2.6051293818515417477 1.3943033708770322665 -1.3814442634785921715 -0.49212164111331102578 -1.7045009461369382553 2.055967749216947027;0.35890888698620515562 -2.204271327600848096 -1.1867468644419822965 -0.41346131248563822158 4.2543878047536516362 -0.085373877660748928586 0.32535252672620779135 0.74310817033683662647 0.8359546780569119262 0.47128270137098093873 0.23057146428626076884 -0.14434765803264540396 -0.2096709133562215388 0.71642531445809143342 0.81533809290397452063 0.12693370660363761937 1.0968601340115651244 -1.166050271422320872 -1.4007874384533356427 -1.2253624626029462341 -1.0562870568006517136 0.18129137562498923164 -1.1354067893987296323 -3.9843371991598126591 0.3603028026267846573 0.20511480072329207891 0.9786837173398148515 -0.61825362760477597934 0.89242452993076593071 -2.7994860311644900186;-2.4952263893169099873 -0.06654028823069590981 2.8139083491840772844 -0.39161182183406251234 -0.173090968968422243 -0.44962148969259935205 0.27140746780494351409 -0.42700444962252376291 0.40231762199889214981 -0.75689699790078845965 -1.2068534789909148852 0.0088931537587974267972 -0.48740882733597840071 -1.3379795968591934319 -0.083581836609465054444 1.6904799311066718293 -0.033976675851183350818 1.7110765484301109218 0.89859557125946254441 -0.046566566224798398854 1.2132819418730169669 -2.0673604456600163104 3.1042254160631665982 -0.041552935135226620744 2.8308914325740985873 -0.021854724677731855731 -2.905221891544590207 1.6103982419170614904 -1.3785142415752131839 1.2214032731806894194;-0.35915191548993180559 0.93074254937586320402 -2.0417974066433832725 -0.33737867616090871925 -3.4801592116880106786 -2.6263624298629015819 -0.64318942122069833189 0.017431093337333967985 -1.1497043922168384 -0.94475848353754310338 0.31863321327898658231 -0.095662207825641734638 -0.12675508267637786153 0.27954568026757825594 0.85869755034464856358 -0.15621998509890916429 -0.6217414511544013811 -0.078385571893576588831 0.20486594927963142077 -0.76018796246252595683 -0.74383707860141534685 0.0080651412369521901374 -2.3235172398793850768 2.7010097425859282971 -1.0612104325299025476 -0.0045556339154508469769 0.073979923926932700251 -0.41772212695458121878 -0.82656599611036585262 0.023981738914859870859;-2.1075036568957106198 -0.53999241043534118578 -0.28168319982579864691 1.3493039706990919147 1.9305071018028232555 -0.023824045868751482502 -0.90308160491633104883 0.58413958983066183173 -1.8798240350517487762 -0.50810524583570826351 -0.57203950045571450023 -0.73670293231050520966 0.13859412727134204357 -1.1207630611797900766 -4.278545552757302417 -0.54458520948729360889 -0.85480250371993204972 2.123575523722108116 2.9499230845582991023 1.1281206800327396866 -0.28219357274552531178 1.2755661596991816342 -2.3314639076040335475 -3.9348695169001874916 -0.9699116138168378809 1.3198569639611663629 -1.6698091850034482153 -0.12374016564495071702 -1.3998496531818502842 0.22596608308681434552;-0.4596853100823613536 0.14761883082878007878 3.9472462299372184091 1.1827079827566382431 0.62299818653383343126 -0.54099558941136938195 0.23275531797673476575 -0.22695408041797443532 -0.04487970903085888863 0.46100428266305060188 0.035387121110185951189 0.49555055034078915321 -0.21064078334450875296 -0.17630294945212349189 0.54913167554449004992 2.118314759279384063 -0.74009924060599696638 0.60639514343283351661 0.8286462286860704074 1.9173658816596541588 -0.41065278072739619386 -0.48459533860312492548 3.8847840330320435598 -1.8301073021350331427 -0.40415828327847969081 0.7547893991292341509 -0.55816736200605432394 -1.0514086210133295474 0.8268148475242620421 0.51242648809241408969;-0.44145379722982891479 0.27119668813660863238 3.2200937085395051618 1.1356211407888183729 0.72148843524142369787 -1.4630678787940294416 -0.083936502329080356355 0.59698142577228807681 1.6918246978518507451 0.17214884468169841525 0.77479292401581312255 0.10242079680543415832 -0.58901394729756673119 -0.9766853190942712537 -0.0076164146724171377656 2.6059287413808829292 -0.77636992001108995343 -0.77419658247953582197 -0.1084234068191754774 1.4861219822415376868 0.65014749015081585437 3.2605588805184337886 2.5906585666072436958 0.82541695349824673045 -2.0266291634102087116 0.65760477516709681112 0.48958834073714940782 -1.2986060810051807124 1.0178075635038734692 -1.6823505253217114763];

% Layer 3
b3 = 0.19258344358432688548;
LW3_2 = [-0.020769059421410433763 0.72753982044025455878 -0.3547196516085436846 0.04053308151449638852 -0.094664243558036778592 -0.029915780353139482389 -0.10949359797612581713 -0.026233550926601852116 -0.12785342709669778039 0.091026226469273857633];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
