function [Y,Xf,Af] = ESPER_tco2_5_Other_4(X,~,~)
%ESPER_TCO2_5_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_5_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9981830498567983;-1.019419468769222;-2.6182641361369798;-7.7501628016230937;1.292037194649353;-4.002562090570664;0.72839105366820678;2.3526951819717414;-5.8914001999496453;-1.4623046573110414;-1.0186654364157262;0.95879439678750022;-0.167259767358619;0.041933755597151456;-0.19595695430569804;-0.78162049698882552;-1.0279584626476785;1.4016956467274877;-0.18349820129601324;0.43213140073743733;-0.83577147881933112;-0.75107095773703447;-1.2162553656793935;0.29516663043545333;0.058558188430628003;2.132028712376322;-1.8065960665152225;-3.1881158862881578;-0.23365960555006599;3.4827386957831181];
IW1_1 = [0.21080397664445094 -0.66782458581478743 -0.86906283200542078 -0.18471156624163751 -0.66279519277889987 1.0710158040304718 0.10124751056382802 -2.4216788799228186;-0.029593464838689174 -0.10279910968626554 0.97016493349982713 0.22633208389946541 0.086921598886819162 -0.80672286821907413 0.9253879997519584 -1.104988662202109;-0.17150036087891904 -0.059185585569319951 -0.18103931379278565 0.025389547808270869 -0.3275478668933115 -2.8344701581367739 -0.20947572976931297 0.53078131045801635;-0.5748833390023208 0.22586461470579225 4.0317530032775961 -3.5620117014250692 -2.6550463727273628 2.5323382202152938 -0.34033567435843931 -1.6006067753991344;0.15738095950709011 -0.081976435273273807 -0.23236106610445595 -0.75381714182687765 0.80515158268765741 0.26518527598081154 0.11843517921432178 -2.7740515953429918;-1.3429392258878921 3.9696731147542823 0.057069047147503466 -0.65681060213939269 -4.1783175862117279 1.4112599108487829 3.4852244093692528 -0.23597853065826632;-0.26911666344286883 -0.36339578604435879 0.16971342421620469 0.038297597570331063 0.21440986276370222 1.1892282480941425 1.5287459124032288 -2.5344413408180952;-0.15234895858701508 -0.99076702645084924 1.7900882765297614 0.35788972373739969 -0.54866041381115827 0.95830815188039253 -0.0031560844324455399 0.60341863718828737;0.98081761886113628 -0.26640281552168871 0.6491102327834688 0.072794748965570533 7.871138999073688 -6.6687708486219872 -2.8461241582896357 2.4940028240001477;1.511915162283803 0.36234905815759472 0.1757890210145063 -0.52672018713289537 0.14964352503674774 1.3342725980942685 -0.53592677464525451 0.23589770744314781;0.56251512489186439 -0.68065624066478436 -2.4365307451745033 0.20387787625310383 1.571307599584348 0.95045376248364222 -0.73307632176458892 1.1874828881010624;-1.2559517693079625 0.11657605756092038 -0.23847042393718745 0.53867654154121969 1.1158244026141018 -1.8394302208926869 1.3218029136786145 -1.0437417417261168;-0.066445572985944099 0.090915218479120083 -0.61131720999826866 0.28058930645859398 0.52434045261891371 0.28266348493487164 0.83914902349006404 -0.43684757902183446;-0.28021204569861891 -0.11241133152195651 0.28436382754967632 -0.046414960116384775 -0.58377175760168643 -0.13434977369172021 0.11030264533032341 -0.71817304163653495;0.98004250856558239 0.043306416025547509 -0.68579392679982454 0.12815882775759146 -4.2386177622190049 -1.3592090375343739 -0.4265773579186391 -0.22680196824368073;0.8065229032948078 1.0413588189969856 0.63460352633045802 0.29344957274689115 -1.4010526061529529 -0.64425468111813156 -0.40318034754850879 1.8259473962168733;-0.093309106022341215 -0.11781101636142693 1.0776630748118905 0.048735765410079665 0.63033281250090922 -0.65224907349017025 1.076288528873691 -1.1425366834000088;-0.78261918870252056 0.60563984372645208 -1.2070322635635127 0.02211578394821832 0.80984230884910446 1.9428024700246445 0.65832992317657746 -0.93572702077608017;-0.69882812433920316 -0.37450847230331819 0.24965218559772331 0.096385663261372989 0.75929795660484012 0.22148145844549352 1.1978544587417095 -0.021769164453129104;0.64893655743230649 1.0690140348725872 0.67919222260015411 0.21965750455057212 0.42720608162298518 1.0647817285091357 -0.068876811603532276 0.31628079070314052;-0.36393910184700284 0.1945954055419013 0.04460546992729679 -0.4270055547951892 0.49831477188809054 -0.24760242350050932 -0.0078069816444453124 2.0124779711119252;0.21205377432224493 -1.2502267972789969 0.55308539383609656 0.34707565845066851 2.3956387346388408 1.7243746885224416 1.8723453830923915 -0.62378206243062251;-1.2338131894990709 0.44923211438667265 -3.2888735677085332 0.12136412403580144 -1.3154311126556066 3.1721988367561016 -0.29781280135331006 -0.60999797947702872;1.0859834687634309 -3.2565310244222196 0.95687343539215974 0.18570380195149871 1.2907432378970989 0.28753384332672904 -0.6090985039958402 -0.22019290712102035;-0.05368335349875366 -0.54795581731002563 0.7477482747253017 0.029001988276341498 0.28604868716234627 -0.31463277765013431 -0.023906585961778692 -0.20302604849845479;0.29310741281721642 -0.022519388817109826 -0.29161508147967324 -0.027576705587007668 0.61759166514234221 -0.39991755293690734 1.155893710263215 -0.0073522544831874526;-1.0971052851125842 1.4577112100079139 0.39370225497532962 -0.9886247473763653 -5.4662190417193619 -2.1242507016585339 -1.5651204747121241 0.41058626145864108;-0.66191910365110895 0.2755140091543597 2.6041139253885266 0.37706793422332779 1.1092548676199654 -1.0226619617377501 -3.2005659401770652 1.1966410451032206;-0.058119798055828786 -0.32166572154676809 1.2274659119785816 -0.060470968427490127 0.47676602330289591 0.31922324686380199 1.5413813809656736 -1.2555044139937062;0.51781164885996644 -0.21376983915635575 -2.5038850111874029 2.0476311490483972 -1.6935820430148374 -3.6749549120277427 -2.6000303491893186 1.542756828954251];

% Layer 2
b2 = [2.291198612351085;-2.8417412667389166;1.062064734098858;0.40934625219335796;0.76307225117563005;-0.89849043702359399;-1.6456435228347126;0.53602790606833473;-12.07583428596392;1.8879697738277617];
LW2_1 = [1.2025193347514351 1.604445255032328 -0.67326066724056632 0.51824883025733748 -0.10485293141373933 0.58061408860888752 -1.2907882070407235 1.5298307130695012 0.20556151004674308 1.7372870981838358 0.45940724234179808 2.0256582354942583 -0.17651818039221034 -2.3117794133155294 0.068254290634625167 -0.91499521345976487 -0.91562985058513691 1.3201207024536012 0.19010129705339338 -0.56625712929439975 -1.3141499712542872 -0.45782710655291486 -0.064946680540823559 -0.2403060694016062 0.084240878777435108 -1.0034216950646537 -0.014040002334009627 0.39609533811479519 1.6321511514572584 0.70948615334027254;1.587201067053613 -0.54520641803216419 -0.21403570422753812 -0.54466075531885416 -0.87128031197322109 -0.90462675098607959 0.96557808165000469 -0.25810512888420062 -0.13632978657036782 4.2126376828008825 0.725712340041059 2.8652877185884815 -4.6859280176296094 0.12491238299662219 1.147282023198209 -2.8777570236542038 1.2266772454116881 -0.62020109316914052 0.88282123027968584 -2.4336474075935315 1.2646614985701254 3.1506243934869209 -0.057638260373587269 -1.9747290364386056 -1.5960023949473956 -3.4152462263448133 0.25467331600233889 -6.0149872054274809 -1.6339072328996389 -1.4077785082527052;2.8331602016685928 0.05461262844395702 -0.35973748206797235 1.2995213020304741 0.50304482344613255 0.029704427937314495 0.045110693210883832 1.8596486148510956 -0.70307368423949446 1.3017553096090937 0.66939226184932532 1.9813206365569085 -2.2807608350435604 -1.5969512766495828 -0.41142509098185159 -0.13666402046820886 2.9814578500662332 -1.0869664344776035 2.1833142543870747 0.18739962344398159 -1.2711241483993956 1.0495927843139752 -0.9099967108315582 -0.078187431463602214 -4.577238172578908 -0.67283239010564755 -0.17285511948904742 -0.88181627980502253 -1.5455721062253578 1.0734487821806662;1.9414467866614495 -0.30983225290564459 0.017347685068074385 1.2431134397796497 0.43024611473252389 -0.17757166360550042 -0.14917358161273891 -2.9708477639158071 0.40838286567509985 -0.79480667139365846 0.018203709263415802 -0.95292538412746097 1.2999632674216346 -1.9454924640104987 0.019465765910971058 -0.89072906559114196 -1.3735697459426408 -0.95868344037385456 0.88454165776945648 2.2492539157578313 -0.048596938451122222 -0.96059888348639144 -0.45524400704606194 -0.061378127222236262 3.9024225389351375 1.859379590461274 -0.19185694958801089 -0.92997552061773192 0.65114184976379275 -0.4496949589627221;-0.6946729899686811 -0.011916379180869869 -0.71336452499954406 -0.64337413507867414 -0.017122204969968649 -0.0090686083531569556 -0.98201770789461673 0.0046981681225288976 -0.040383599439057873 0.30636003574293547 0.1756572278492145 0.095509525641661708 1.234702613739612 2.2692882058825927 -0.24692510404196641 -0.12351714962568817 -0.41580687540299638 -0.14177583072469666 -0.36343146226728512 0.26950150672422019 -0.12474093991859975 0.111639880692493 0.0098391089721981805 -0.045851576928849253 0.2404487534764671 -2.2750807624289227 -0.10035978996103824 -0.62774464438464783 0.70872449346447308 -0.040133437755299782;2.585715916005471 -1.6936367513439867 -0.59815650814545451 -3.1662752686397155 0.20890391736643865 0.26051131818064305 0.89607427219295299 -1.3936223393703382 2.7223480139933942 -1.0305276124933471 -1.5616297129769374 -2.6919373769776516 1.635706645949228 2.1364810672433081 -1.1820976843144286 -0.14037633298673244 -1.7689202624151503 -0.7750751644882915 0.67158669320886533 -1.429707280597984 -2.6374616841473704 -3.5466663888055985 -3.1014277262115173 -0.95820775854133378 -5.7829109319487308 -1.4964157031521728 -1.8311140635425278 0.61255934482609464 4.5390084516258664 -2.9809528552549307;2.140809347802251 -0.16729835072140728 -1.0403428100529857 0.7565854335311446 -0.85488409265912435 -0.031306903709077571 1.2936286532636316 0.78680387378101413 0.33776390871419582 0.5085252983080677 0.35468292950801455 0.69528569396417383 -1.4410224120590851 -2.7104695476321283 -0.48974955844099655 0.45865739631882196 1.1918366604386559 -0.49833937108634752 0.46938428821511557 -1.1400609387207505 -0.52492222187843307 -1.1408183600663602 -0.4221222209912871 -0.12740676500612899 0.094217633980883952 8.2126174750890524 0.92152170496772268 2.7862151596239326 -1.1977633872998927 -1.3878431887170084;-0.65586196221264059 -0.34135165916064653 -0.50803305671224475 -0.51326795217088805 -0.068739917060028619 -0.028874569563868531 -0.71429381071392029 -0.033533937537971577 -0.032939123940573897 0.17545520117282468 0.12679737754326573 0.013415861257623927 1.0892684837461937 1.8950474235183428 -0.20147959176555713 -0.023303747777643272 0.016113538575841847 -0.12604225661844776 -0.37801049320216668 0.17607455513531048 0.0089838456732566456 0.11844333819529214 0.01068276144062741 -0.0356450824168155 0.23360494521965181 -1.5900266115002539 -0.099149761376719894 -0.49813396650362018 0.50759446948164455 -0.04243931652442131;4.4732295238641928 0.42821757458595133 2.6401266407613875 -3.5831031447929838 3.3105868037290778 0.84245344331601024 -0.97960236099672093 7.0908375359218887 0.94883650783890694 -1.1659470791486573 -4.026789574142688 2.7524483773189292 2.9844450786182408 -2.2811161251125496 0.42033149011085497 0.20231048900036158 0.74754070337150591 4.249947404381218 -5.9013211793113802 -3.3868184909641079 -0.05889116735155879 -2.3807856837728978 1.8944260553615091 0.89739637341129352 0.56152707374877786 2.5506716363185067 0.56281588847842012 -0.40822052428793221 0.33812094050128999 -2.8936821725109425;1.6970261115733645 -2.963007133330215 0.38427238227119703 2.8952400798948861 0.065432516055152407 -0.55413766462302039 2.2906920651396523 1.0901996530149221 0.26272304800688284 0.31047262581112572 0.97258771472902339 0.95604234894506535 -1.9171343876855369 3.3550213972726195 -1.0522354662008753 1.8470716843467601 0.91050441251007708 -1.2625105571153714 0.15022889403971429 -1.1928053061391954 -0.17648703109517797 0.1879152913221758 -1.2099264335904365 0.06621254500880383 -6.2540643702923004 1.2117255853531905 -0.54842966159044126 0.61359795845192533 1.7455041551541075 0.51659809575999327];

% Layer 3
b3 = -0.20977655671242876;
LW3_2 = [0.12975431852591587 -0.039033336556641963 0.086661434602754814 0.075449354036001087 -2.6662721974308123 -0.015937869207631645 0.11902109042689747 3.3643491618477337 -0.021080444985386273 -0.10245467365449977];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
