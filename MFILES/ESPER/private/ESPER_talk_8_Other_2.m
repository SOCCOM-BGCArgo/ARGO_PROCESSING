function [Y,Xf,Af] = ESPER_talk_8_Other_2(X,~,~)
%ESPER_TALK_8_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:47.
% 
% [Y] = ESPER_talk_8_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.3138251026386265;-8.2577172528411538;-0.68626739865953046;1.3538662970000637;-0.82854053165318642;-0.84387923146907839;5.3470703603987886;-0.81899475710910941;0.88922217278754323;0.56672179504299558;2.222994700293464;-0.96595524966034074;-0.73947074417617364;-1.7470240945181386;1.6263332558304848;-2.2639600239755033;3.2090263537899428;2.1583041824441507;-0.52630547875409939;10.947994515873752];
IW1_1 = [1.039736204344923 -0.15622314036865192 1.1765216155351912 -3.7967878926938639 -2.3787339045972171 0.99094541972652272;-0.99538515420430163 -0.080524084325955259 -2.2699625892876045 1.2644939421934325 6.0547066200225519 -6.4197547280007834;1.074247601777266 -2.2881005610519027 0.63959943935164154 1.8564759195196057 -1.178983366489571 0.42391463422337872;-2.2158647658304558 -0.51292764640209176 -3.8414576754046603 -2.1321475928977076 0.74766418796885759 -1.7045922072429669;0.88164467071021757 -0.44314049051773641 0.51516092956883708 -0.12166065914558356 0.3455221026964852 -1.4895598863683854;0.09504190279733242 -0.12550172697416534 -0.28057017578634047 -0.1338954605987932 1.6900404348115785 -0.39901152437806531;-1.4665634240628536 -1.9455985048707984 0.17740774184459998 -1.0726644940534156 -1.2963477167277386 5.0733792364531212;0.66338730248377731 -0.25663123452794223 0.22323511175097752 -0.080911621166607633 0.90333915703050938 -1.6564467858330225;-2.3875308575554524 -1.6648405441722753 0.12791471139449681 -1.0142432151622951 -0.74734494132051965 1.2128968974455294;-0.12246525236714853 -0.11569251177881906 -0.21694716401132388 -0.71189862745721588 -2.7574597459218522 1.5686950295642801;-0.23474962418228212 -0.021696883768582358 0.42590621479249069 1.9252135161086528 -1.0528562799255141 0.30509826590308919;0.06308303836539346 -0.0089069396969409954 0.64377479850966368 0.96126595970911821 4.0690357317063484 -0.31966060183362405;-0.46223901616158963 1.0410473472745991 -3.0422506552824826 0.8156988698262001 -3.4894654906137679 -0.89224602031943923;0.37074480113253983 -2.6744356731691061 -0.63783435404391942 0.71455238883498506 0.21377166269175729 0.86350818237687854;-0.059883976748758901 -0.40758845102043911 0.76791794529674373 0.84091934120684753 0.63622388889837433 -2.1521129496093896;-0.89033067337993166 0.24234880918676838 1.3503341568783336 -0.46452573544776693 2.7439349603788106 -2.6780870164657631;-0.23537257430961578 -0.03387634969521202 0.99655403635781825 -2.6958558140861117 2.1125627014875894 3.4116879117291408;0.036402737661234079 -0.079705880133258231 -0.82150325938654145 -1.0734860365560923 -1.7642639419595896 2.0679119552899294;-0.11402871402410084 0.13591149100221589 0.18434503080209011 0.1170816783932541 0.14555794462325258 0.65616339653615241;-0.070964711480878601 0.028010142730611955 1.2561038924850148 -1.4552243519702166 -18.476925765740955 7.3408154050556051];

% Layer 2
b2 = [-1.4846272137367533;3.5892328191972145;-0.12883381308661013;16.442921200683958;8.1023310390844934;0.23567708954723371;28.342774515753632;1.4155671693193423;2.7280938490213757;1.1810128923912837;1.150104555306684;-5.4994787146119677;1.3492665370175057;5.3445377898468731;1.711583041191896;-1.2659795237184344;-5.967516855801807;4.3921356059409504;3.1917819055011334;7.4938350183501043];
LW2_1 = [1.314743916941042 0.38554091247921896 -0.1432373301860719 -0.36569387110730756 2.4123828824386906 -2.4644701792615136 0.57275390226338441 -3.7231106313240847 0.91995972451825714 -1.9580484098853275 0.35827079727867545 1.6979841985324147 0.71335621885256961 -0.22629314270085829 -1.3540931183647853 0.20427831081651823 -1.2066597329453708 1.0905821903083788 -3.6580002483614931 2.3817117693285592;-0.10757952426206754 0.16604223151073463 0.14194447730994508 -0.26570744634555871 0.17593374194236003 0.16511843317532762 0.056051870104727411 0.080144591144931512 0.018643510279062185 -0.64283717969854548 -1.0567664476048129 0.011638283283037431 -0.062653518473095277 -0.086630277487831003 0.33053769114337489 0.049824261048882906 0.44336263842294676 -0.34507158136532784 0.79541175397638042 0.57186697549679222;0.78323643417969158 -1.0881003203738646 -0.059617508239259188 -0.42418415371059975 -1.5482576997217126 3.0268032326326053 0.39057851309432856 2.2043294704797796 0.076109604598199404 -1.0543294410197093 0.97401623935975634 -5.2980289652187276 0.074108431378227368 0.31644141327196429 -3.3104076475894133 1.5408191490400343 -0.58367722144727185 -4.7514987629809005 -1.999766056689241 -0.18547321571720643;-1.579810137040367 -3.4402617728296718 3.6860607622950567 -5.3052346504932935 -0.88017156590774892 -15.469366116076371 0.86263651360983007 0.23794702901981643 1.4236441291534798 -0.3781530416609713 10.172296252703765 10.741969183244278 8.0626999571865312 -2.4413490406348126 -12.699763388444122 -8.5195580956060439 -14.199222063645236 11.248610628912987 -24.820870882339094 -3.7399954254159522;0.50506896212963059 0.32933005284612316 -0.07466458743192303 0.14491554324033287 0.68124508041742626 2.9360494193312272 0.061999786455217566 2.370983757601413 0.74061028564186782 2.3004075970749787 1.1723016017887231 -1.2075374151727996 0.15383383580950924 -0.95115130795039249 -1.995238558782487 -0.37806138887974167 -0.0060749197352429393 -1.8609108491782482 7.7254196426985207 1.1371789138835799;-0.38235215101667708 0.14710047197424889 0.13123144649860241 -0.18974146696034846 0.092042665441667837 -1.4234553705219648 0.018563232561293268 0.1146517635638214 -0.001817081247495107 0.022914607017468999 -0.53485045030550837 0.12793683453023738 -0.04441391143716996 -0.054604794351306954 -0.17302945982433246 -0.094221942164258637 0.71428744323163951 0.019831733621337781 -0.79529702008069381 -0.7666304703102631;0.093633654473992842 3.4261288369086773 -0.40706116967420081 0.37569300862145155 4.3545850492729015 3.4894001734327009 -0.42925708711002375 -7.6308825082040785 0.5123947450945685 3.0921318472854438 0.52814862889195946 -3.9129249858746316 0.42413815270319905 -0.52907300890390108 4.3173340104165403 0.60751434405739557 2.2803695396954256 -5.3841837733065789 29.61338556085899 1.0007394409528616;-0.28373079003016566 -0.78380819635036525 0.16420906893431672 0.16444944337525347 3.1723763698846703 2.3518185568589143 1.5338624807002617 -4.9391910058442221 -1.1954726219708063 0.78750151256759615 -3.0763689589051166 0.53593650938651893 0.1083914062540398 -1.7576458822948038 -2.120742953671745 -0.7308411903132136 0.28456602454161095 -0.38043780761282692 -5.5050786233726825 -1.5924685398313776;-0.23328149461758044 -0.34181240890687203 2.0705087002894622 0.98443154084435858 -2.0422238496164185 -3.5035250281471813 -0.75320370217139831 2.5959376967619772 -0.98890894696780329 1.4934425420963253 -0.73372035423819904 1.9496403092576144 -0.86698749846136813 0.73341841918462392 1.4889238007246552 0.91340715176657361 1.2060286388295709 -2.2631976400609712 4.8817113133239012 1.7529826539482902;0.046684966830508295 -0.07959006324226732 -1.9611744218356952 1.8109778727111403 -4.4451869550536083 1.2664283281945627 1.0778761359095501 3.5426258441139851 -0.71186333286482073 3.1052620118881156 -0.011558293203923329 -0.89365322304232431 -0.12301339395800766 0.7747129786740804 -1.7218958332549941 0.66440183720610468 0.12684676554198474 -3.0020468684389781 -1.9790143705109491 -0.0085472531099046265;-0.50514193176278843 -0.081471047897096749 -0.71882037138293453 -0.84775591373293147 -0.21568042147735739 4.1987200027018163 -0.36433118707715695 -0.42368988001047042 -0.32237003063493946 2.7008989192583783 2.0373301809735604 1.7070087187087419 -0.66950125806227667 -0.21862481630731856 -2.1359199853697679 0.51689630927909602 0.20530169815709828 0.1055745142473507 -5.3061185087039728 0.22598575647225755;0.59200967441619801 0.60421948681177007 -0.24647467937764891 -0.078123139640798991 -3.1890199173242921 -2.0263720096392772 -1.2105064029230999 4.6930948754732889 1.0025015435262297 -0.35147725037934185 3.2051519548126133 0.38801343627403045 0.062636131745267484 1.300572395225293 4.5282687064290243 0.50441112564263157 -0.22589674149427363 1.5738492285828602 3.9119968804896592 1.3799619499038651;-0.28850988125056531 -0.3096575406021671 0.3821181920777883 0.10085994663311562 -0.15321666675770057 -0.68693567550306622 0.28286606169700823 0.29101558210390543 0.26153927233462843 0.28381065825742779 -0.62137355503731928 3.4551060652812748 -0.11631560720673367 0.079815155225946219 -2.024333580981295 -0.34774430639672815 0.40417536105973523 2.3111659878820094 -1.3324637273223927 -0.60391059904297062;-0.68886836032767973 -0.85228025623050141 1.1030439476661045 -3.5759386072562722 -6.9126834301700724 -0.088072217486456328 -1.3284342099291013 10.917463417885253 0.62516420635637981 0.05083204196231237 -1.3968656958181542 -4.4932785171742964 -1.3801346407724613 -2.3119693992698931 7.3941937225214458 -0.49583806708575445 0.67006114900473746 -4.6049209170068384 13.88599504015939 -1.8225926969485395;-0.41626342874365507 0.03712252746566759 -0.15626070810889675 -0.71993884412699516 0.67410611528029385 -1.0781972993928199 0.00047078870348327541 -0.78507363686882259 -0.086593358718578498 -1.084805986976652 -0.57330192612401154 -0.15833020352364119 -0.16354028454772521 0.30564382420268787 -0.92679398349516973 0.44172443385889537 -1.1189745720717106 -0.64052496438183659 -2.0505998933737306 -0.77923621598783421;0.33737327577781145 0.26694599018967791 -0.38698721242428907 -0.2081760481676162 -0.057885059409196679 0.70499260078803871 -0.27796585393195877 -0.088556977042663243 -0.22740296191774828 -0.29433026606977503 0.60323093710149922 -3.2913126627877727 0.12024847296673091 -0.12728623432086891 1.8943564943435418 0.34804166722057489 -0.4135760708323919 -2.1425103992126115 1.266914054199201 0.60236039661421403;0.72189455947035785 -0.13906212716110988 -0.11232346177389063 0.54290529724327197 -0.73326627092088625 -1.7358081413738371 0.1644438097081439 1.0235130806032999 0.18528470772692796 -1.317736555554587 -0.9732837168786268 -1.3644773389271205 0.46798892531736963 0.65734787089183544 3.5107090070590856 -0.2768498844770757 1.2719922377284183 -1.0560131742155658 2.6000135810415523 0.20212084946812617;1.1984602199516559 -0.24047581691607101 -1.1115248167933893 -0.10307011560336554 -1.6275126912785385 3.2555822770728731 0.5625904761561541 1.5352565217657264 -0.38790476126270362 -0.26942067811324555 1.1399812411543748 -0.86751572054406356 -0.12548360709019285 0.55533955607511842 1.0747364680560125 0.34522496782726014 -1.4705732369295832 -3.0515392544143527 2.6208681109664047 0.86326725964271378;-0.05834864751408466 2.0225257071706539 -0.047314020757433919 0.1874756661211614 -1.6222751099322044 2.4485831339344686 -0.42669185346138944 2.6107235388532737 1.0112412161373565 -0.043576795413592599 0.022779413177175578 -3.2208775740492306 0.24834483502724178 -0.69187578764668456 2.6163564279104952 0.73384626709499479 2.0539266795020255 -5.6315108732875458 5.8094437612730427 0.46749859023046636;0.28486161309872376 -0.012427075592666805 0.89606254741856084 0.32980775663455747 -0.50118621720221346 4.8327508475873397 0.39964820423959285 0.12142865594635563 -0.13560021493505242 1.3476645270287335 1.4675299865003866 -1.6586369644328267 -0.06193048381653387 -1.7605916834413138 -3.1422248417984373 -0.33939957045343944 -0.42773491567277772 -0.64476213182034448 5.0751153246338756 -0.28069612045763648];

% Layer 3
b3 = 2.4383153502953769;
LW3_2 = [-0.085579818957453743 10.691611906078945 -0.53373644418507216 0.165783978721292 0.22716707283415663 -1.1193613517289704 0.15395753897718639 -0.38526930238690976 0.086606400565191644 0.083640659690737598 0.79771263314425889 -0.39128548932494994 3.7013128419385191 -0.072648279320433065 0.99290843281882846 3.7977461297224266 13.941769921631684 -0.23405900558455914 -0.19451360818258595 0.27087482228306026];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
