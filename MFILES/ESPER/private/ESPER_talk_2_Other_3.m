function [Y,Xf,Af] = ESPER_talk_2_Other_3(X,~,~)
%ESPER_TALK_2_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_2_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.72018417925208877;-0.64518316949080801;-2.5551735217573963;0.10474346708650208;-0.058085387184249743;-0.15371290978548235;-0.99535958251675738;-2.0670670830595665;-2.2565190895809293;-0.28730142870045028;0.544879253555142;0.28810786091257129;-1.2448370411179659;0.67621889428142157;-0.0062893497777060312;0.14915164447481552;-2.469904193145799;1.7169796251818039;0.48736372180134091;0.90357754320131933;1.9547315043230613;-0.37700456906910829;-1.3447681967713176;1.9697652503095566;-1.6911659316182448];
IW1_1 = [-0.12384954917213543 -0.33321168991005085 0.34840504949442341 0.049453593681784612 0.95176160005050481 0.82259674620776657 0.38108237615704443 -0.19640806242944586;-0.64347405606588759 0.31331319507520655 -0.6946708748024546 -0.10492778533755379 2.7782224361556898 -0.90374598355590563 0.24444468954288875 -1.745273523896441;1.3837262103508861 -1.1421048167621966 -0.80723795784712038 0.71547565364784038 -0.80755929185497799 -0.95760451126114776 -1.4598747767617715 -0.22631429919128035;0.30982990101711066 -0.11746565494240974 0.95932691752270483 -0.0011304823345527413 0.050207099456604995 0.61834893035557892 0.24056476764018764 -0.077268328394469232;0.050070135191033295 0.15271334641843182 -1.509287884039239 -0.21459695059967504 -0.77669970810801547 0.51945853623964788 0.5053937706924081 -0.66663310091015293;-0.015970175972350363 0.44425696606093662 -2.8087620828785314 0.34265734919082436 0.39744368472282132 1.7132655007651987 0.9816707913911652 1.0116391615732165;0.85605252314271751 -0.37214376507471469 1.0768904923544778 0.67274935969006577 -0.14118014766069487 -1.0066834576748824 -1.3873298475431333 0.92872826373318174;0.24516997932140525 0.22374358568197245 -0.52632076951674078 -0.17702526771411947 1.8010086140421178 -1.6424292111283003 -0.70288123762381183 -0.6941451571765701;-0.057712043789354253 0.91526248826806778 -0.8730943777682616 -0.72043187832960864 1.8619810333243478 -1.0492501998165704 0.66669187505631944 -1.414712523067279;0.35603746272963177 0.70978656218976632 0.50297690007883544 0.34795650617861773 -0.20132684178097654 -0.25266555244099737 0.047965570627908904 -0.47294934443476982;-0.21914874923654809 -0.14850415700533262 -0.32031839731593342 -0.25670392168012846 0.15181698759914319 1.0256924381763963 0.40957888882667481 0.19473155154594915;0.51706501417169481 1.105300106560458 0.48332137032655315 1.1639177686601636 -0.58237987279378378 -0.46066100473586052 -0.26858968235594732 -0.49763990151148557;0.16857096152116624 0.108941854931253 -0.12149083173029898 -0.25775394062663698 1.0308905739755292 -2.2072497002054834 -0.45345981839283556 -1.0101650942149656;-0.017430145692276699 -0.14351145313674449 -0.7306708123090454 -0.3670017703169402 0.32259022944054927 0.43934561955154794 0.27468410335763044 0.68682636422818122;-0.11559745633871932 -0.45488821897455722 0.10952180630944017 -0.21092755875923366 -1.8593450653135453 -0.50548198768532715 -0.36441951378725207 -0.4188070141466782;-0.22910332894878566 0.064897683891309468 0.21217470163820826 0.15434279110932297 0.033095011465927575 -0.83768780729880132 -0.69004114514114601 0.16732791502850783;0.30692596190186033 -0.06631922034976491 -0.35092653475236968 -0.44623152954725298 1.4611654178540927 -1.2350300100446938 -0.48544773408593711 -1.3213350239695176;-0.2607673459511719 -0.64378014014815765 0.38917078316885967 -0.1504916890455705 0.027526006741854639 -0.17409943756762444 0.23573343039215247 1.1715146915038746;0.8075793270460121 -0.18076523300329803 -0.012380794784783078 0.61835238176083485 1.3231498406372137 1.3703767297476603 1.1197953817488586 -0.21259908077395495;-0.033460103215050073 0.16241548124996111 0.35335576297324933 0.049755252243354413 0.20371722114957366 0.048903402976564876 -0.34288125827491872 -0.62503006017469187;1.7000251701513711 -0.43057811136753088 -0.31390006310198576 -0.51028291937544623 0.35070450645416479 1.0631353573521165 0.74222528351782846 -0.2207276154711971;-0.19295145940622976 0.064029004977986137 -0.87446752983296028 -0.044112604416047474 -0.010501569412414678 -0.20978062910169357 -0.044021316199454263 -0.29294710087665032;0.91813439917517981 -0.50939517738814133 -0.088577257547499275 0.65239299398941208 -0.49185631306500116 -1.0589315195301578 -1.4063239175479765 0.34919389344154167;1.1977668504233865 -0.56113658315702941 0.1561427954557072 -0.31071190055049447 -1.9215653226620002 0.050600719917468041 -0.56972463330515766 0.3252740279046919;-0.1620356934065775 0.2154881599724949 -0.65273641264909477 0.33388148708324211 -3.420491125116119 -1.9738493296424395 0.11675902622666059 1.0273151162274832];

% Layer 2
b2 = [-4.3546441566464553;-1.7859878286459696;-3.0451300262302441;2.8037031551991349;5.6359686536420686;1.3261703184360041;-18.3893924000824;-4.61420097624036;-3.60839109106018;-2.3672303683496838;2.941441736465769;-0.26416592206810863;2.4439447807274628;3.2962326362205663;23.681990096141078];
LW2_1 = [-8.4504544518097546 4.3674173739098672 1.5681858509684032 3.2135589542817256 4.1978306614056375 -0.43482968858552068 2.1605452968249961 -5.4687380138364867 -2.5192967493527929 3.3903455542770828 -4.6220206780535094 -3.2286732637150735 -5.5591025886800285 2.7056358876255588 0.5459290018773717 3.0987940996369412 5.0618391287026974 2.9926634391446116 -1.7024648596112844 -7.3929157819656401 4.0690112162045029 -1.0978266556563805 -2.5513365875756309 -3.4299902980802108 1.2141383199931817;0.5631531818132709 0.44589779122257672 1.6482642700104615 -3.3022222421902434 1.8769735052695224 0.67959174369680364 0.60380270253863977 -1.0335167390377407 0.14191996077116134 -0.43695755900823341 0.42136708996971978 0.22357399067164258 -0.1033540721128005 0.25743990837803976 0.8273280176874882 2.1118688625652449 1.7122806424568737 -0.37798487127087238 0.6775488097549609 0.8376940551405414 0.51275427487582803 -7.4004545769559931 -2.7785766810889774 -0.65491998898425141 0.18465221848856023;-1.7827082005506965 0.24111104114228793 -2.1313378238192038 6.8450076758894811 -0.42826785028283643 0.43752174469161365 0.28844627238379428 1.5468374870324568 -0.29674868811197519 0.31485798771978091 -0.14109206496908408 0.83808188135838402 -1.6441045620430972 0.76460173758742445 0.8453260224715079 1.0679144176083128 -0.70075014954280213 2.7949789588296565 0.071642650401925093 0.16030277448939037 0.31571875438587771 7.0805709161658719 1.7157255470738475 -0.42579972242193043 -0.62196174319840425;-11.161292954574744 -16.754304812352245 3.2851302520990946 -2.4553914590826893 8.2601007465073071 -5.7072256761128672 6.8546693701026369 -17.447207669356985 13.952053725131019 2.024307613899385 3.1945264568626728 20.009012942436293 2.0225919211029706 3.2476304648551406 23.195022755257298 8.3305269462726805 -31.691269819959995 -15.231837961038979 -8.8158038781412866 -13.55507652213805 16.267093173951515 6.5417135055123614 5.7880371459618765 13.555299507420475 9.9878548019124818;0.5304090072359513 -1.2222035784960972 -3.1798238696054755 -3.888824363266755 -2.3657983305613932 0.49242784714155874 -1.2696053626037938 11.996561693794309 -1.9807465026109301 -0.18592747628709608 -0.44015061380765841 -1.960495573350278 -3.2112717943156834 -0.33607729278110987 1.7988166165235742 -2.4262509366917762 -2.2681380053988902 -1.0189678155960236 -1.705586385660548 -0.053756994611543284 -4.2413283497036067 -3.5846446376839882 4.7523148084391096 1.9612870900373436 -0.21674592106640678;2.9039542785401027 -5.8382224403185097 -3.0180876508921148 -13.953453202090667 -2.5807057226176306 3.6656131500457416 -2.6392720663220297 2.3846590032887955 -0.2889903721726681 4.3061937893946327 11.665965848388677 2.5257699102660931 2.460204521428567 0.34451714285822876 3.0040236097118722 -0.53670790311988337 -4.1350962449684276 -0.35082200955886483 1.6348027994644689 1.4315728443807945 -0.41184881603569806 -4.2864919390823788 3.270709949390509 0.93392752298431359 -2.323258169024828;11.959282082265361 -6.3564589582982132 -20.310590180056259 4.825432834457966 5.2420326246652529 4.7303377411099836 -18.176495626953727 4.2578501645920452 -19.616915526766391 -6.276352457072738 4.2306764881460941 15.596176686977392 15.273688218225631 -5.6067280466640002 3.6376332629664212 -2.9901658028519411 5.1889191805026025 17.580230799463212 -7.8137935019711193 -11.267671255101616 19.611764998682094 3.3982945560280795 5.7108790648250674 -17.140987067853455 3.0184803039627486;0.27052250187420229 0.22750013935940536 -2.9058154476471949 3.2265751097336484 -0.25572474531636835 0.48329091728566437 -0.81454981099218493 -0.823419786844372 -0.29974014371036328 0.65758709811599603 1.9603209213024544 0.88721984405596455 1.6971780699086561 2.4796065520661998 1.2034249329303466 2.2357680769882173 0.99349488877578651 -0.095491470563573294 0.90265214406196537 3.2714391045319093 0.048097278657767521 3.7431295234269917 3.4296647599322023 -0.37558379672424824 0.38155380882380724;-10.668535169497819 0.012134250445534645 0.76578253623903547 2.7913934667703124 -4.4811069746203778 2.3610785917971606 -2.8052918533383768 -0.38794336708238214 6.1443686316446184 1.4036809356720834 -3.7174499926937541 -3.5721771572399792 -1.6591161304821571 0.98769674725774292 -1.7453590707836883 0.72451555127409384 0.22300908509156878 2.0519226012590961 -1.2281534568610737 -4.5313315244479986 4.1034581509098942 -8.5606119732451678 -0.248069917405282 1.2677477198111231 2.5101960098847571;-0.12722381738826447 0.29278420285187379 1.6096339668717747 -4.1512208243037438 2.2767821472715322 0.74159534249829484 0.21391825438447121 -0.45124481393893884 0.17984994898449008 -1.1698274411253047 0.8232990543044878 0.42622102533722195 -0.58188737024412263 -1.2426695806460175 1.1015472332248848 1.1962153064320313 1.4428947610336855 -0.061184778978325541 0.61242741479624108 1.9897108016534455 0.76224775528507382 -8.9386448924990791 -2.8598318775926348 -0.71523236655993194 0.71729500111029387;0.71326066007425681 4.7881428641116761 0.07666308411915497 3.4121938191693411 -2.6486889622156538 4.8600643644554413 -9.7299096741474465 8.2501779930355177 -5.1267721291059862 8.5015954530207072 4.0285303274285233 1.3443894539921342 6.7113248193003274 4.959114602320553 5.7263356972003683 3.1828718380582042 -4.1087966415258208 -4.751212727280107 -3.028233149609318 -7.6573378722726266 -2.6304255581191023 -17.015136809770649 -0.8383512912718778 1.0642441066410175 1.6933074390999401;-5.5163601315639008 7.5216994118259066 6.769789079180387 -1.2545741054138546 -5.9142644046661106 -1.4883730370389763 1.0901032162980988 -5.4939127858408616 0.61933157060982391 -3.2069742180430327 1.6227309180198475 0.77928657780898292 1.7465486433319837 3.7477905325840393 -0.46508877520216024 -0.12604470076682583 3.1504198479217664 0.030670364523209852 -0.2972442451962623 -4.3121927118328465 0.1794076429775574 -3.8681781715010568 0.3580838020249566 -0.17813906135011001 -2.0195841359294602;-2.901203386495363 2.9376620100209379 2.515358662880653 7.5213502873393576 -0.17705574609801655 0.49148008912385543 8.4815762443204665 2.5072416620705189 0.78702357917404564 5.1917286612534683 -0.81874796943062789 -0.8137713766453365 0.4728371950495513 9.8158891170441542 8.0280915850027164 3.9830621511599746 -1.670584381697797 -0.83697809371109966 1.8489692571056651 -1.8159854441877512 -0.33792409043361832 -1.2454776664370013 -5.1995916833895892 -2.9272638286501409 -1.6008104273144692;5.8943330735750834 0.53380830853531902 -0.64983773127013422 1.8690014708816816 1.8412662365437111 -1.7244802696995238 -1.832427899003453 4.9119812682093933 -4.3517351336746781 -6.7024396922536704 -12.197334563831333 3.3767271815465718 1.8264075414268126 2.868676088300711 2.1373577978220197 -11.392998464791235 -3.5242266835523011 -1.1076127369843745 -5.3967523988031045 -1.2160675642074052 2.1252078234693328 4.1827732671061755 -1.3065845573377686 -3.2670207425765065 1.2725731355801042;16.055644272413812 2.6200152262619381 1.2848461036424521 9.3650642648681064 -1.4626866046705584 3.0588813606432703 0.73221794798357065 -0.70583625626054047 4.3818682845692978 -3.8677828818227247 -7.0061562683882359 3.0197565851150547 -1.5311428828902465 2.6682705640409141 3.0724930064487066 2.5610991119999169 -1.6835631528286601 -0.16819055076600911 -2.9060451448941125 -4.9843839348794914 -3.2057574315566724 1.2496749825562392 1.0250733364583156 1.8333410107805497 -0.52898204681138539];

% Layer 3
b3 = 0.34055777657035186;
LW3_2 = [-0.013412084315977926 1.2418440316997554 0.19686547442342769 0.0020030697064918343 0.012337962221210141 0.031714622323396835 0.0075448064677181821 -0.13228472412456313 0.0074968409244020907 -0.9555695822980339 0.009327635179491282 0.015578798134517839 -0.032732674272462743 -0.021039638789430878 0.20653561534808698];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
