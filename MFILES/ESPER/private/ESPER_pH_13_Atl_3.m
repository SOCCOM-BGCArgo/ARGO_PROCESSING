function [Y,Xf,Af] = ESPER_pH_13_Atl_3(X,~,~)
%ESPER_PH_13_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_13_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0315473119189033646;1.6772173284492464251;1.9128592163240376589;1.8828443171073370177;-2.0267639285920764358;-1.2510959976590716458;1.8427978704799561349;0.37495664539180539876;1.5335261958424466489;-0.87054911375737120682;1.8479881593360683034;0.4210179287959393557;0.29416516031184491986;-0.33968582279585102235;-1.2319158782289076903;-0.052586519870954549771;-0.37003001627270237783;0.34344978962430777747;1.1289526348468050809;1.4663099178166605352;1.7706803893036890951;-1.6137632345556494062;-1.4629939946179115751;1.7449021245418472326;2.2757228694759401577];
IW1_1 = [0.90465910104338564945 -1.8378456074379772023 1.228678817846482918 0.086135565727148255544 1.2755489720993464786 1.1777940152945951535 -2.3682714861665199457;0.058222618229604707063 0.71817144945134314682 -0.9761819880477184963 -1.1620641407382819033 0.86718751618610878662 0.23434797488234812568 1.2183118973158588716;-0.58752321181301891961 0.56509445521565382364 1.1003467439227567759 -0.39074692272287264716 -0.3091116447363290165 0.68039738450242748247 -1.9307597509665908042;0.32252276156107123617 -0.72803349298726072192 -0.13601182175449569312 1.4257744191268622025 -0.81871990985349463177 0.77310971614671775143 1.9804911693881459556;-0.067895390840879768501 -1.076125131081062225 0.73364947959935078448 1.5881747070991634185 0.93744317883518846202 0.15533318667046805417 0.15853417139944511738;0.30617237173522726668 -0.65017297256194628297 0.65583356109471857565 0.55505120253492201687 -1.2999435856277694601 1.2884926242489309622 -0.12099846593309661336;-1.1851463276490847853 -0.35516784054901695544 -2.2151623255325989525 0.39643268480074539406 0.78481198026160814418 1.0297646735240875149 -1.3628418774275230518;-1.0989125452649706194 0.96713493336795264277 1.0279042571801284556 -0.66028659263625322229 0.065281151890892036294 -0.49195979422411612036 -1.4003889869061236784;-0.33826872153530102016 -0.56160680172974442037 1.1609130221156844787 0.94675337270389259281 -3.4782933085334430956 -1.9150062208554174958 0.66720820350530607445;0.62346343375289825506 -0.96721191187440147541 1.1715527217703642915 1.6993760747498665165 0.51091193024488190666 -0.6164884289068802703 0.13198517032864795495;-0.20323052617191686431 -0.49860708014409305111 0.47498002013239498664 1.4827344613685276009 1.3020730692903057513 0.97372946722445918866 0.80290821563328806931;0.22490632177072544806 0.81242574560448022059 -1.2874523127656392063 -0.40150979669331848809 1.8803196174401646257 0.3221020874813644852 1.6612649201735885107;0.28452792664269693779 0.023848735462525343792 -0.94604211398598692107 -1.273248352996570798 -0.60635670014072706735 0.88611906224571779234 1.1126536495598982057;-0.083925762179543172969 -0.76525706788276182113 -0.37195715465701995051 0.17587476543906782611 -0.35675323474050762984 -2.7357294967490095594 0.93606987305499766983;0.10138987760614011358 0.27640874626384842605 0.96047577700609987339 -1.6947679189247866205 -0.73065392871332157654 -0.64623276296984544231 -0.59930433251758219448;0.96257824897858612623 -0.97897959048192761955 -1.323490928319122073 -1.4182691317543509868 1.6515672758182080582 0.18233626099949776234 -0.27227879974761204362;-0.16576776147597532818 0.38808776967054658957 0.63796546654468666571 -1.762890446313283288 -1.3728847632572154236 1.7810603110130476257 -0.65264043312964681309;0.74344120401088764627 -0.53034297415307563028 1.3581271219895147961 0.57481294050000197871 -1.169905954835611217 0.73963788970385480059 -0.54489965141392504577;0.84249630486786453165 1.0815817590119785052 0.24725619465438633537 0.41090004879886143918 -0.22334439500441655158 -0.91298657965899143729 1.312716808356283682;1.0965468110200347063 -0.59951195816206936939 -0.6861887543433249359 -1.1668896144777622936 0.041827387955268691133 -0.81791860773587821143 0.97955222261700714004;1.095981974755192212 0.44172656257216807996 -2.7009153419464189128 -0.46965565168255529738 0.32865553856719564862 -0.34773797971252667915 -0.9473430367667359242;-0.22482001636257434307 -0.25516356484863922383 1.237913697784464695 0.81684270742530018516 -0.15414729389556103278 -1.2432337572723723973 0.59885422344962380148;-0.21349623708215637041 0.80139494470847116858 1.1512524378419299875 -0.26155278126458814114 1.3069167576243982953 -0.74277741533385743811 1.2126945231709758133;1.0890997891076394932 -0.84447837442466200386 -0.31747210216666016391 -0.94618927635851057811 -0.58604166510442445848 -0.72847975636599349158 -0.90792455434976060413;1.9019964237388804484 0.89568055943039104339 1.6405175590564768928 -0.22386464765885008554 0.6883903957431849463 1.0754007510637393352 1.8687542039653406434];

% Layer 2
b2 = [-1.3539046156825806921;1.3671685527746118005;1.0666881651969779554;-0.91926951298931647294;0.90362768224494283142;0.64350982724745675601;0.66166188614204823892;0.087854865086718414435;-0.77381085941741967194;0.57307056166616276993;0.77015372753859046018;-0.84560320565347379951;-1.1471668718774667983;-1.1579494454960810312;-1.3921902891923396695];
LW2_1 = [-0.13565178230612334742 -0.16338513490358036462 -0.32223539698338199422 -0.056613237169597402376 -0.13303494257133657852 -0.66916458827991920355 0.090252969817870731806 -0.88901498543426882293 1.5828218843626227219 1.0782740451414958294 0.31744944627186000297 -0.63529076308212950597 0.1804282028702393903 -1.1362354877366691586 0.77807481535554490204 -0.45508032169310141946 0.83408046868329566159 1.1473207571719148401 -0.14503278828149787638 0.10486911361677789256 0.54527012371625904752 -0.8035059197019056576 1.3002885513418811492 -0.044010801363518745055 0.21820873944475741024;-0.24741447517627931929 -0.21975480918594439417 0.065956636335050125575 1.0306350294276427348 -0.21995469610330908861 0.097837723002006354855 0.21192758025650729192 0.48705358359867134688 -0.36541179732002670999 0.288927713489544713 -1.1517719089968661006 -0.43866003321719371222 -0.94744093162317422063 0.092555682149698739747 0.72710831852240265238 0.76897871612019319532 -0.23549071469580204474 -0.55102905727431850114 -0.67199664451770591 -0.29518763865829361626 -0.8885357406275845582 -0.40058576572794352133 -0.42649798631129764992 -0.11841688274643129286 -0.32694293802979856878;0.34922604389165579075 0.28116297382603705479 0.35848158894795251195 0.38938423094277307968 0.087867616370053636121 0.2080731331102558257 -0.5189683832274413211 0.30389513428094810932 -0.26108162380052479801 0.29490902078559350086 -0.14419778599171489963 0.021231285861684660171 -0.27340309405292373413 0.29961166256034571509 -0.50423588081812209527 0.14851257227976888409 -0.031104205658431034742 -0.44262961550969764923 -0.21291558913821007071 0.3493164368414305998 0.1537737927165709062 -0.15219825908148390536 0.29671298207160312632 -0.24578314992806657435 -0.22999607783961109608;0.86148755124917164583 0.26949007453407958224 0.88447063636247291729 0.053747891710432475765 -0.63844453941118994855 -0.58775301295347581743 1.236653878561443376 0.57164746418169065656 -1.7293673801870170781 0.50126385153427077679 -0.52163748437239010336 0.053205671120938179131 -1.5791748665785305672 -0.49175610553559540028 0.38078411242991233587 -0.79981327885243924669 -0.45831833095920598842 -0.31630354415371064736 0.86573945557857734379 -0.058239390354846258535 0.26546846433786575048 0.033452964905561578812 -0.86544314533071620144 0.14420310246627149331 0.36792257171237685576;-0.58243966743780595241 0.013093282642927360146 -0.2904903278223368579 -1.0760594223663100255 0.52444169600431933542 -0.80111870210506896939 1.1450335982911039601 -0.28434738273412518694 -0.27429268453784749759 0.50639193215750855082 -0.033454983667307466866 1.4218384381464042043 -0.41219423807341620813 0.44135555290251221594 0.27076396865947066628 -0.41404973556035817861 -0.37561940609819427506 0.65070713190779116974 -0.2965236032931289345 0.43652845906476522853 1.0689325260613558033 0.35553281158778982096 -0.28979155987887189605 0.1318790529083107288 -0.18578753117147656093;-0.17070328516872343427 0.0023394474888152397285 -0.085063263777535411125 -0.32657582484370678566 0.022546487284162950587 -0.49861341796262576009 0.084886631207791052312 0.78655153507102903987 -0.95820235684084198446 -0.3784198270387738039 -1.0671300927189530938 0.58005555750400006332 0.21602355166602787984 1.0107898013155840466 -0.80428928585127579254 -0.050330774188928339985 -0.24880430560689148489 -0.82498036235206795297 0.24439417109146943652 -0.053211825381860651529 -0.77588270461674224698 -0.25763848849869808166 -1.3406625091648449732 0.19991027553742976575 0.1540678943963462999;-0.61692447462025934435 0.040485805312630365749 -0.33274245908551763895 -0.15513152791975381994 0.081264524926234260604 -0.23996723690692120523 -0.76960803207803429871 -0.67570109587549409547 -0.82359225144166814392 -0.11074412943562039757 0.40729213590689311575 -0.64127349889454088316 0.58563658426598119711 1.1056076269178707339 -0.26328857158355162271 -0.338576941986612312 -0.14716560809706313862 0.33104097924004327602 -0.51211880065034021126 0.56991467775641269089 -0.74914536788558394598 -0.53900947656225972615 0.72534455669447484016 0.1602811218976579466 0.76904565946309366709;0.6193934105698000181 0.034842421331499416615 -0.33349608898183646932 -0.26941569290060407571 -0.78834082285710216365 -0.18386541219069779673 1.1756048020804115151 -0.46517368330367214746 0.29149377101402207391 -0.51800917287650727339 0.10703751304517807041 -0.026518782578752377044 -1.4423528665460527698 -0.41837437644921832147 0.15297252858573814893 -1.2481333385750537079 -0.29304132935968318918 0.25359434978800854399 0.27036944228622372677 -0.34559320019320854955 0.75336681444709352462 -0.61964724258845538252 1.1938020555091686248 0.41318219844318693212 0.15195135353110064691;0.2507574295468560921 -0.5882752779383602082 1.3824485672770239209 -0.015275985429802149337 -0.26580789314086294972 0.074904021145810198434 0.42731206202008165107 -0.1636874858818598566 -0.34190150219526921349 0.33787326109479542957 0.42415384600708877505 0.055528479381583395469 -0.092455921328747928123 0.87651621945372104605 -0.21960569466657023363 0.95356307753268820804 1.1857849719781672349 -0.37595186805081781678 0.67172473770969554074 -0.28623768537157545655 -0.31224621040663330662 0.99983121384366158146 0.80144754693835962289 -0.043826797610254944471 -0.42361679640040506012;0.18517282713205582279 -0.3505005723023464359 -0.13096312021537234727 -0.46310416055741854269 -0.31327719410835708214 -0.39588988774284539218 0.51910309242001706487 -0.22515428949175358975 0.038815230165568190279 -0.1212616822941751521 0.49793395121453110086 0.17956214256486227598 -0.75122798046866912092 -0.30320667653773014649 0.62062248814303333511 -0.53754388399319752434 -0.38396040063088660022 0.24906366541305025031 -0.24347477883793491871 -0.44218039452631413555 0.4821505084001421193 -0.19351409674004188544 0.28517862811648525545 -0.59470722657047447868 0.26887640286326830452;0.16603961395348107444 0.54502634612126921176 0.03289633004193803778 0.88220233125703051424 -0.044280088294341782285 -0.25146033624851577004 -0.34807226930811646648 0.57795884859585200388 -0.36326600961063931772 0.13585787409064570275 -1.0223511303673655792 -0.85489859970591153271 -0.31479697104892706561 0.043178896270350486386 -0.20330662747910169252 -0.24116887400445083389 0.17765824880739169989 -0.70282628691824744482 0.18562152533395179232 -0.20232266473553814357 -0.099041819449112805662 0.10569965459767785565 0.2345630444574635376 0.12069574955865509935 0.19056282377069946876;0.060709927859681767082 0.17913130177441280444 0.24744885276773032068 0.45368590686197890482 0.25517999208915714826 0.43456692104218724859 0.36833598816372592477 -0.40207684833023710214 0.017218797210050873492 -0.061063329277052054433 0.16800410362826001531 0.50955234441255692346 0.26447332047060745364 0.64680474896047179811 -0.75849068981274991863 0.41994703192777832479 0.60399992204333385892 0.11496704632935746127 0.29770910951206885908 -0.102745255177508793 -0.70486684459601378627 0.15751957952695233578 0.41873882091752984147 0.56090608787931672818 -0.25822682535535135262;0.24071075618248946593 0.24124747561957660125 -0.39158277806288799283 -1.0359904769863781393 0.78538588662546848784 -0.16358664285708687802 0.7857730983322870344 0.086869014214310813493 -0.34241792594770542602 0.28860320550033269349 0.64325295394028214613 0.76013346473221277133 0.85132122088349437838 0.16021823642225815898 -0.41327786714376874011 0.96830435897366928799 0.30974750251306570892 -0.71244111008807431418 0.46511607067853349973 0.17808769288602765979 -0.17767534221936448491 0.43111013682357696153 -0.18742280807320246816 0.30422660889355651603 0.37546680401634074942;-0.56573803865669713975 -0.40047398241630638438 0.40488124970262889812 -0.39696823595979618959 -0.27387474641457953961 -0.46142574150734688709 0.0094885187361936542544 0.0031369114805620463594 0.43082111533107020351 0.21969229256061834077 0.26495861504401735376 -0.34395367012000349627 0.32168459448999947581 0.8290915321924280379 -0.26255454533110472726 0.30890980209500340514 1.1053160951407212664 0.5526329522973878472 0.49855743168793137388 0.0071423075849299652237 -0.19157933765881282606 -0.23624808278962550201 0.050122311675451322599 0.47534561049228246654 -0.80534957497366577162;-0.54660553964814462269 0.46544929182093114362 -0.045514868039844065539 0.28557010739707455738 -0.26614603313648654836 -0.091026298736534061451 -0.99821627755072972477 0.37817431956465813458 0.10645099107230404645 -0.56746849916108588197 -0.23888040713854757913 -0.75833085311201109402 -0.33178924689886823973 0.18780642628904323232 0.39923671252909415097 -1.109341755828862075 0.34997342657847058112 -0.16516552702194958746 0.10975147255781075861 -0.1127751131388128325 -0.26696268820943519495 -0.62921090989787420433 -0.94237521863786921639 0.63900908894884567157 0.95203058833299014641];

% Layer 3
b3 = -1.5581565602461331377;
LW3_2 = [0.98322890658051553814 0.4132091044267119373 1.7023187757648081675 0.35871370001400948446 1.3544785196697937124 1.1232691298629242649 -0.66699161799657047389 1.1440982729618145441 1.4050703416614869212 -2.4496887433318317306 -1.5937016350860679914 -0.75880141932676536953 -0.57082396814475289126 -1.0420858718522227893 1.0700743935424981146];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
