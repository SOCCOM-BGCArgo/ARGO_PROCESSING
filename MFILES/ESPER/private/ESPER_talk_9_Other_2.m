function [Y,Xf,Af] = ESPER_talk_9_Other_2(X,~,~)
%ESPER_TALK_9_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_9_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0965834311956559;1.0553015445261138;2.54907031271566;-0.83474280126284361;-0.37839291241744616;2.8193774000666578;-0.59804303990269414;-0.90163491661118789;1.253833360642457;-0.50210917195408122;0.30189280062961771;0.25583988332333124;-0.78661509508892802;-1.1117637837841783;-0.25367614652210613;1.5478759283271857;0.60976972288588038;-1.1271807778150615;0.20954008312713537;-0.59500613943899083];
IW1_1 = [0.76199905657109956 0.60393893601305781 -0.63846970731254671 -0.015337655329754068 0.39141620261274207 -0.46822713087484236 0.69974928150948279 -0.45851999334146987;0.60067546405207939 0.0055169576480667412 2.040460682501168 -0.36965899940292657 -0.078879767895587094 0.56661125030455828 -0.97825843799448209 -0.1396142951473551;0.22099701185006124 1.0560513367578575 -1.9109033451516362 0.22739237816444544 -2.0959774771119615 -0.2056072235459992 0.22260522781920616 1.0739331963484642;0.49376890639486321 -0.038666378916898281 -2.0531630188621524 0.72496373688374249 0.64845340906748272 -1.453649969914887 1.0378129794605591 -1.263406981494964;0.086141658689967551 -0.039377111584634528 0.27823765892517638 -0.040054110535563049 0.44290398068577547 -0.077061520477956683 -0.0047444561115159234 0.03654981583249655;-1.6231892490590065 -0.40973521333072604 2.7639056783881402 2.435001652183665 -3.0448358701098734 -2.4394242888721327 1.1224307494988692 -1.8586539594058804;0.055097076221360584 -0.075507459763015469 1.006890749598794 0.17845049619927125 1.1411089544372719 -0.14779142934404124 0.062123968924967521 -0.45815860479018389;-0.39053779703784641 0.28448454193626826 -0.015376313311893186 -0.23965868702512541 2.2321071961195273 -0.59981088771535751 2.9380436939555437 -1.5705332334785909;-1.0025977249556683 -0.28218213369964534 -1.5210651002240354 -0.029050598439849081 -1.2285544484028317 -1.1511707980398229 1.523162982571004 -0.28581989628119592;-0.041174319467483358 -0.013690656678950542 0.15801805170734723 -0.36692572345550273 2.7080368976780544 -0.027327385233577903 0.61911643482243206 -1.3689829216950851;-0.12829760903330148 0.011194480138823178 -0.79258425916536646 0.16300008819619793 -1.4556364487175089 0.6398331707099395 -1.8420471828803713 0.73330446580259789;0.31656414916550518 -0.50095714452279627 1.3466721194039708 -0.47104945334575893 -0.084067582478338107 0.44579418118989639 -0.99565468515205879 0.45718455421322396;-0.14995919885586456 0.11580987756020837 -0.10450741234023414 0.61384327449620624 1.2222828912305788 0.18707339461954089 0.45752454980532442 1.0937671824542894;-0.098204751356861936 0.23320466591572622 0.2610889038260521 -0.51173056000453931 -1.6149005886814107 -0.21449996898427515 0.41786859155126899 -0.27136143403493362;-0.46825061822726782 0.81575358760259653 0.19799996819165247 0.026465640563434617 -2.0327240023771753 -0.15891412794043885 0.38867448441948832 0.17296719942514219;-0.36014397991235092 0.30320092806499499 -1.6748025523194077 0.52094593681970958 -0.78551286233727702 0.37315003537757335 -0.19466368729060265 0.67272671043246812;0.1191572779351355 0.056583316516095189 -0.42308581155487113 0.50710075637500152 -1.6935814105890119 0.45570617632021071 -1.5692887947993361 0.83271699537720512;-0.63425111148263524 0.17935113933864807 -0.521262488532101 -0.95960287376332754 -2.821089420314173 0.85859723018342538 -0.47030187695609216 0.25321808627507514;-0.04605737848409535 -0.042132419294048352 -0.056793127563552044 -0.32846466691638093 -0.95306579951799786 0.32488097324110993 -0.067024815204231938 -0.57681863601056915;-0.37494630907837062 -0.57805440641652261 -0.18966679523397875 -0.13793367144810803 0.70694534603879045 0.12413957738780056 -0.3473728510034354 0.10406481844879577];

% Layer 2
b2 = [3.2006326020374902;6.4373639597350536;3.0372361743570728;-0.43541538045035044;3.4664584220310029;-0.084145267545312777;0.98144017372227033;10.153221932256548;3.5305276968145383;1.1439566858326189;-9.1239379278518609;-11.664314031763929;2.4047335409232198;-2.6179724340414539;7.8272808335470696;-0.73975833243482325;3.0739653323614231;-1.1122152249619037;0.4665416628574523;-2.8886726916613146];
LW2_1 = [-3.712299917244295 -3.2469185227545405 -2.1791258008516952 -0.4467694199149233 8.4275963793750552 -0.15603892180055096 1.9442289092803329 0.56782201609028338 -0.40857859673241931 2.1554654154617512 2.296484804326798 3.6249919749910005 6.5724468351818048 1.0713252407350442 -6.0131740098032465 0.87183827088725507 -1.4428485380456251 2.1890967210060248 9.2791438427415489 -8.5136243948349009;2.2648192381694625 3.9718710927357588 1.0857153750423023 0.99858562989974098 -5.6263034842746285 0.34275339242133629 -6.0307014015808154 -0.9510442879038481 -5.9024303001362206 0.75661331897444872 -1.8474882057540787 -3.3620333166381418 0.65137674316914784 -2.8938570886014925 4.6130665482869375 -7.5096254859925766 0.296725037477236 0.12985375731605386 -0.60367836722717383 7.3578303991499192;3.2379188102022356 0.46518653872130278 -0.14131249674805613 -0.5144326893366149 -11.302001891693282 0.9593653818499589 -2.4330254087306082 0.34026354289501498 -4.7242981369048911 -0.18961711699916139 0.071724642113410217 -1.1886939892194952 -2.1849937518154161 0.84495241850626246 0.24444007622247341 -2.7344658181442001 -2.3873944625439414 -0.93841729813186248 -5.6471701894286745 3.0220122698099918;2.5512440912153571 -0.23239116290947065 -0.2765222664394531 0.35461176615522572 -18.25633594075591 0.49696501022084011 11.624677857296087 -0.52343088713172015 -0.099090139099791835 -8.128802789417275 0.47913681942752995 -3.7010994256619001 -1.8204306665664829 -2.0181112676818862 -1.9183667816857217 5.8828256761479185 -8.6665645104266584 6.6869528399570584 -2.2285922189105927 -0.39613984642067557;0.71291194512253009 -0.10510811433580651 -0.0049158587391908166 -0.17412373642770959 19.48099706570526 0.13779417038602559 -3.2446050979758856 0.85193085018349435 0.80141811645939098 -1.3769636480481251 -3.0510907351705927 -1.2876775682711488 2.656979062313011 -2.2508731130450008 1.5232146486557079 0.23815964363449435 3.5670647088102996 0.018188136615711212 8.3768226010877367 1.715355953678865;0.21149785607830726 -0.035164240484148901 0.0073670168662938722 -0.082518218855851172 -0.38726263626889101 -0.044133111311418935 -0.009245254685822683 -0.035545856327265181 0.099929774836882923 0.18095855336399908 -0.10370349779258546 0.070049664945905754 -0.0088956123653141858 0.16159974227679791 0.05848763950193922 0.034163562499626772 0.16490741868002134 -0.078266311948632802 -0.12195391693254322 0.12660347536895555;0.89516043379683807 -0.047015985485967325 0.074225162243481885 -0.29829685851787169 -1.0172933092351708 -0.189304919550216 0.35982561787263523 -0.027402560033267194 0.18738877093581774 0.32168962498365761 -0.60820126090431426 0.21495429023747636 -0.022345318031467266 0.41945791888357625 0.32735243919473989 -0.049745821216395279 0.7627024386908543 -0.25012394649420067 -0.011504609776847093 0.64344579543047709;6.0750206242108789 -0.86343522575685117 -3.0753672492055482 -1.856206196162111 6.6636610607113154 -0.011122089945668046 0.62837339486694066 1.7701390941406587 -1.8833235240135779 -1.5712675911312324 4.5970742973501464 -0.4244132822992403 -1.1284661109540788 4.0253444438590913 3.8367094951091625 3.4331819807256796 -1.4255509979825818 -3.7368819040086949 -0.030823883409461014 3.1789544495435509;-0.14373435644919222 0.67797760608482804 0.26730429764740193 1.5505663715527571 -17.770810242277005 -0.75783845654401394 3.6559248067192436 4.4127636830671113 -4.7221722669181894 -1.8791568486282826 1.3007312662837645 -0.17623463831503505 -0.50804983416662486 9.3548317450850931 -3.2808635562639212 -0.2323334601182355 -1.4277993911411304 -0.47088610729485225 -6.86851672162528 1.4677558954317045;2.7798872618809618 14.816056102534626 4.3009813938893711 -1.9892126789488005 -21.468918134175695 1.9895328983818394 3.3953785109433419 -10.256898658122902 -7.3167841615774121 7.6951798274590519 -5.2478592253445386 -14.83738486561208 1.6362303413160564 -12.379880615902735 7.0295804159791793 -9.7816959884919985 2.2180152401128863 5.1826812470549077 -5.6848080036750304 13.863916813393905;-8.5912623388082316 2.8398294165733642 1.6213133723862245 1.5340802567715437 5.1505175197451969 0.2100056833007222 -5.1848594586187415 -2.5804524365153441 -6.4611677522854452 -3.3810572906093541 3.6028246219951647 -7.1748688778975636 -4.4563222783127685 -7.7929800658741231 5.0375029519725265 -4.9186762011785934 -6.4466849867398892 -0.69753847024146487 -5.541613377226783 5.4294771591717383;-6.2004542099635147 4.079091807178763 -0.36863237250414377 0.37399636923230523 -1.5470339745489181 0.00034208708848775535 -3.1422960390767263 -0.41036079858324587 4.0829114298076616 1.9159055464066004 -0.071345062335804496 -2.6373951957516319 2.2597183633743043 2.7498023863835352 -1.6835547325196842 -1.6184199496063576 0.073610577230442842 -1.0254549773887875 -1.6264191894195978 0.071913860983919872;-1.3610713372806333 0.23989084505968986 -0.31119361531919087 0.10680853026179721 11.544150710155121 -0.52860506540167029 -1.4859770866246613 1.7606835753817398 1.2942087954668438 4.0575379158097622 -3.6698485518507868 -0.95662082763789347 3.2154518554667302 1.5845846806674384 -0.66695299336327685 1.3151417145313147 8.2674238191805287 1.3324674171741124 3.3675321302545806 0.69834394477917361;9.9459992381026154 3.0982165348319723 0.64113441458667297 -2.7281453486951195 -31.768804132042462 -2.1115573360358275 1.2388376371473917 0.92513649292871591 0.12197290701227435 0.6644485473070989 1.0728651749788778 2.9404083078520644 -2.1309078910896133 -1.0896074139980003 4.7445422108348554 -4.5502011997638876 1.394910210419656 -5.6779906556174282 -4.5016613062296891 5.9214723310908051;1.7410525299686708 0.7665163236642859 -0.98191750124101584 1.9570218920665243 6.9180785844832 -0.63339041782916727 0.65857770671629767 0.54505482316136378 -5.4945312593014242 -1.8937169989050593 -0.51906665072022917 -2.6736953455254309 0.85079564790081297 1.6987097819124921 1.5722464522385127 3.7279260045577796 0.017177435084002168 -1.0911447183586958 4.3439959745684318 4.7159407389970758;-3.2455664679931919 0.62114365451749631 0.87503004893045788 0.25443888563051059 9.0485527247354227 -0.82777913199497244 -1.0294479606316511 0.45070694763557262 1.5807693034206878 -0.43238127620485978 -1.2008880573529053 -0.58536362060012526 0.42415708869693924 0.1028113096717975 -1.1139476564348949 -0.53979023349977562 3.1603116106531663 1.1614551544293523 2.3312202147437384 -1.7825890996647777;-1.9746423420763326 0.85513410483931862 0.038444941980777289 -0.14076746319165487 12.717656600341147 -0.81491681108641567 -0.56315621895976764 1.5642363712043639 1.0092509496057973 3.0955673251326221 -2.2768895508896021 -2.0913600688330463 2.9617773156842762 1.1783126443790077 -1.4326995089132075 0.14789468054688706 6.7211592451522293 1.7412021588674771 3.1490411571367694 -0.010923391707928198;-2.0125928131188391 0.057612710759083592 1.4168596395234441 -0.16715081047243519 -2.6403484541516953 0.16135954212738515 3.570461755181535 -0.94789908898885178 0.1721778715683534 4.5693766721030427 3.6881398019222265 -0.6221269081786367 0.23657465405026476 5.4942306026807808 -1.6750728946992151 2.1411668788512106 0.13197388379431696 0.051780236206770122 -5.0833420386951831 -1.1474056757743416;-0.12987279739757435 0.078813331235130429 0.054498655922122656 0.03691767178657418 1.8983950938118532 0.038726046889863974 0.23113836287672018 0.15410136041541836 -0.31239894709572291 -0.31460852915193616 -0.15475420534355533 -0.12542183483102562 0.046891336254638045 -0.45704092150094089 0.12399422798896047 -0.1313391582390325 0.22951509369181319 0.20193010756698335 0.42909851332673765 0.044244936506669101;-2.1005558538256563 2.9180143798781115 0.59906832602997828 2.1913197448749058 -17.255059385520681 -0.44391634731385898 -1.4731904201073351 -1.1253661260087517 -2.9169726363971105 -3.5925894389502453 2.6065869468051672 -0.43701295380224259 -2.75259190723223 -0.15640902882247126 -0.32398596421119424 -2.3202718642326885 -8.1346796289169525 -0.3929423486720281 -7.2285295073745539 1.5566982271026475];

% Layer 3
b3 = 4.1027280589771005;
LW3_2 = [0.067232103422231057 -0.068661427377255557 -0.13549051841043935 -0.013538670689092676 0.22650984153661238 15.230913974886851 -3.2980766292885701 -0.1773798349846544 0.077191451411763395 -0.010818083359824043 0.15693756814970761 0.24332322618605434 -0.29258612502413323 -0.031631865060257391 0.06451046449928996 -0.25841576294065355 0.2774852078054062 -0.058677416745623566 3.103048127653365 0.089453209143604939];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
