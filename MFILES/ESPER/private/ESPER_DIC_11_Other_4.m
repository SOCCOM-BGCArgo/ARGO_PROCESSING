function [Y,Xf,Af] = ESPER_DIC_11_Other_4(X,~,~)
%ESPER_DIC_11_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:14.
% 
% [Y] = ESPER_DIC_11_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9698737571080975339;5.599907010275995134;-0.89470257043683987241;-2.1061229161763534989;0.52490720070463592339;-2.1401096327501938354;0.49649174606468432502;-0.76277572950064831403;3.4185172929010945175;1.10568591687779616;-0.25664165180066322858;3.3684127835023773834;0.19228463699453327007;-0.7144563978571717433;0.54444426499165454736;-0.89621221613250001692;-0.38027511877142106123;0.95184604514023596344;1.7759982900433579633;0.52118805802222367696;-0.07958350101944199062;-6.4485998861476723221;-0.094077402630753231838;-3.8205857630559152405;0.8941522376138423267;0.61016268088907543721;-0.95150877301290170962;-5.8009087027118839686;-0.09613201561595598188;-0.85282491297286877607];
IW1_1 = [9.4458661625532958084 11.783055512765116646 -5.2667545837033298284 -4.8354301334484519614 12.910922606963939785 17.461173193532427916 -1.6779877695631921775;-0.98192058041434937543 6.2575692625344592201 5.1286555987694431025 4.893063415265520355 -3.5117498639066724309 1.9259303519574715313 -5.3339686543566084964;0.012010656156574020872 0.076706122696532624827 -1.1221270632163717895 0.2890134415698580872 0.83076781303965374637 0.45030859277778256811 -0.2043106220701733089;-0.24960448176771204976 2.0116904363062664274 3.0633210485748150198 2.6400766019524861683 -3.2821138074337143919 -1.5055545930887164197 0.69700816940209420203;-0.035096040355613838946 0.0057578817338176779134 1.1403368407721692357 -0.27499073826061720682 1.6189237913087244358 -0.47344474809552999917 -0.040712657097071738854;-0.19485657184989296775 -0.14886028662219286112 -0.91647877042274483728 -1.0527659773681192767 2.959476057703680496 -2.1516527020526279301 0.18464985105002193477;-0.88891835245058781201 -0.25699049061936929395 -3.1876965094040934368 -2.3366705957384352743 2.6512215146995274928 -1.6638602564990248034 3.5856363037094789448;0.15517087288462236283 -0.081651156534895338868 0.66973305348909306645 -0.27344941571314096418 0.7619966590828637365 0.20879944754245374772 -0.57470577521217347527;0.22252412585003047973 0.12331177004358148674 -0.13349146850963475308 1.0592600062387782511 0.22972085360351920946 0.73589844063568032873 2.4413466512877262105;-0.13126422390164094178 0.17531059635081638892 -1.7071753463130103778 1.6058800215944939449 0.74885796924163827715 0.29120028569508882299 0.75664843731521180814;0.17049571649906186677 2.7032587628952953196 1.6170675376941141543 0.079106660380161508694 -17.146632021480858299 -2.3646056459013218287 2.1653474720240111218;-2.8880288381684744436 0.70493503970085436006 1.6110691680232298584 -1.3395176674133504324 -5.9509906171190136703 -1.380483641436615283 2.3806510033746448585;-0.00662230752353554393 -0.041659320082966397325 0.75968309126208466431 -0.20954285008255829625 -0.8894228198520407469 -0.42073180957742312147 0.022816154686514860533;-0.078283021857658202647 -0.051642668340263798987 -0.17919283807765848393 -0.27852844232106765965 -0.94072614185854275259 -0.1238686723587683336 -0.47109344178227430255;0.061739019936102666752 0.061689951070202510286 0.12592720750334521207 0.29173199414056810719 0.87411181781182234474 0.33482620461297463166 0.81202826660252847013;-0.2490053620736008555 -0.35775504254221240918 0.89433017811579729184 -0.19443455929772443525 -0.58828154170515967181 -0.5753188481448352487 0.47260262565886829167;0.18990277337543359781 -0.12329712312430365917 0.98923004277928228145 -0.37346201967844017133 -0.36824736275299957411 -0.024868094343076994207 -0.028207435474287164551;0.12601004045997502012 0.40107448951674701254 -1.3152343352012099142 0.30656945700243742881 1.108205534215149779 0.5897940495190784338 -0.45922071840770273266;-2.4818227692679175611 -0.077985900028688215357 -5.9122803483611932052 3.8443004827165938586 -0.6707237476803000753 -1.1227702574922868717 0.96901521488831932061;-0.16534794867507013327 0.11050309191384978524 -0.77236797780616706088 0.30502335007996417282 -0.12773217129741915032 -0.13325085944834821894 0.22047724666045645514;-0.16457302052202088527 0.12388312558514999462 -1.3974002311183109093 0.46701196215732149186 1.1587151225698963941 0.32198768329120325271 -0.12986185623325591232;0.50707716151808479577 1.0384137588946169561 -3.250043341547991016 0.66935286490681566995 18.193966431831267272 1.869015733219852482 -0.75746683041794393709;0.038936238083628040008 -0.065954316919497602001 -0.86456965677447961127 0.55079737023025054921 -3.5366921033343095004 0.90158268514251527215 0.89285703252708048527;0.19732759780744971168 -0.38971510852863866514 2.1285807065873951771 -0.48786476225307007226 -0.84444880776639241748 -0.38533012137664351959 -2.7011577045952002152;0.063316357991631572188 0.20241089946557860868 -0.75767956907244882192 0.17786621472247043929 -0.17399659877059550639 0.31608700520621912933 -0.17354228332113200151;0.27232294385901933964 -0.17805346453207540613 -1.0384694337357924798 0.50637223687397847627 1.7787573999428112348 1.012584121022499728 0.58068724966491003237;0.23993840635452937105 -0.97775829223144650193 -6.2802210071951272141 3.9680071882916969628 0.90193282172619682058 2.504629756135042129 -4.3484805680320368637;-3.434257796225727688 1.7534083976616332556 -3.0480775661980099578 -0.1852938028908041046 13.195111745129441516 -2.8245053908280031152 0.10688041983023822967;0.055212683278859572833 -0.0721276387360550858 -0.70719601056130143579 0.42334865886337480489 -2.6974189106938997185 0.64462906452985690997 0.7363479159087067405;0.1102559539715296244 -0.23612259605555094288 1.4047159154258421765 -0.37942630160538043382 -0.94816970304522685264 -0.38250306219250967965 0.22641039614651481404];

% Layer 2
b2 = [5.2094236113779963659;-1.2843794131799612934;-11.99481863024147188;-9.2537033171283926691;-9.9035166640468492716;27.128856086908474055;-1.8473615104945193544;2.5205374549014951668;21.970101893525804115;3.0747530141644840995];
LW2_1 = [0.082455243643005216025 0.34042061627052988548 2.2791653827114077835 1.3197420352476101346 0.15945272870841803448 -0.62200914938250706498 -0.57374616722266991165 -5.2449444211226383672 -0.099721603110319662067 3.0269778740130455219 -7.008021014365312773 1.4776143503340135599 1.2566347608902066479 7.3222626823218623926 1.7407087546092876451 -0.02492462911380646795 3.0330960105381068459 -0.74061308632606526192 0.73134322437182719412 -7.5987297160603652912 -1.8243381173081589797 0.5357398327836472296 2.7450919158108471052 0.53882256426104124802 0.76606891944076638268 -5.4080759487941802988 0.1705463221995744405 -0.10861967355648091682 0.90111310169595448816 -0.89564806970845478595;1.7999037793539014451 -0.70972493662457980523 12.610053476993073218 4.3748647075895430447 3.6319738315246259397 -12.267052100737389608 5.4294330668216241875 9.8762091752578520243 2.5216307672704889598 -6.377528187329744469 6.4555915981123730418 -4.9566541789239835225 -3.7291860372059555395 6.0018501619367885525 11.257598198985212079 14.934509914656221241 0.48540046620225080209 0.58657744155480684434 3.6876312686225420912 20.330024567548839798 -10.961636848174290293 -5.2918669917313287954 1.0603487147055781215 -7.6646645779965147938 -6.6688934971866826729 -3.1554886094584144729 3.9952705598107458584 -0.10696558184036389361 -19.102348272707722288 -3.4235024297925349401;-3.5603884604384372636 -1.661068356819803471 5.7641287273134524938 -6.1393725372064915646 4.3451580626960737419 -3.9473156824003119425 -1.1910703178290014126 0.72242972211689771012 -12.518755680390146523 8.0706554247677857461 -1.78094668231131803 14.807872918600226697 -1.4347042924352948479 0.33190078610575690643 3.229723278869249814 -1.769473109493778118 3.7821766825988762939 8.0794131008581295816 1.7222375503898570415 -7.3972693050677689186 2.0239110652533272017 -0.1654108961396451305 5.8005066193912666606 -9.8122330346176909188 -0.043860588789617717398 11.242566400915091407 0.10280017000625615853 -3.804681101375075869 -3.5105536108345796187 5.6310177079353689322;18.902322207879066696 3.5068714156302287499 -8.9412366754730641105 -2.6736363865252776861 -9.1306817076638200348 -10.676354287896259621 27.531538091557848702 18.348011125429625423 -14.411890990168986448 -16.877839621318553753 -10.130329723392401675 -18.996712981790917496 -14.734188125963020966 -19.123950584919036544 -9.9415690641978748943 11.510147746395492874 -14.876245466803313278 -5.2267215555908599356 -2.6019312829691960687 -16.620738979588413287 22.986645680337002062 -7.7866144627020119628 -0.92867392891628519624 8.7601988488783089082 -9.258192440597689199 10.307100772109723863 -4.1003392987885227683 -1.0527106197918758568 -8.7368352682666898801 -2.0526504002701786433;-0.043390373513317467835 0.36612020704984438169 11.76404895580227894 -2.6741778060504723946 4.6223359910284651519 0.71223072838421119801 1.3566247166703044869 -1.6017914974462819089 1.6444860819502145066 -12.004737874874635395 -0.088593152686750373248 0.35986710091289242364 4.9868638865435119811 3.4084317296980195522 1.4955061919952652438 -4.5348956171387548864 -3.0274473362189735504 0.0016002229512496017605 0.94137703289848584376 0.36436437087394174528 -1.1774097694517402513 0.042237689334847915157 3.6895485815339004176 7.4918921621940430811 10.086907848039484037 1.4416318921822932619 -0.81589292057145734738 -0.10225466292467727536 0.95074921459445382865 -2.3753057108781994167;26.058642990418466212 1.8782940649726818094 11.109814345669084545 1.7350643189207635153 -8.7506758842637069051 -5.4436812489041708218 15.813331984921235929 7.4580865775318869737 12.926668413668565449 -24.168660922881233688 10.796857614584471463 -6.3825373069949673521 -2.5224495056565858775 -0.90730459139922470246 -5.2071206767845996666 1.6620524573688630898 -8.9829884813446572167 -7.0393294872699838649 -2.2640710815384466059 -10.775251364581448499 7.1520812214287099451 -1.7806529899081984247 0.27118216421070628908 -0.036404679481659436846 4.4531316736417183577 6.3800232414124407043 -1.6010359039602961584 1.5774548085121480323 -7.1944290223709774779 -1.3334943218751769134;-4.6636125379172179706 2.6441092362402334182 10.104356464470445331 17.055656546740955548 30.987274609907501599 13.576428364715617647 5.7841114497855077303 25.248804724592670112 12.004989028811928975 0.14952838281494043593 9.7591533119097810811 9.0839840190391569763 -9.0920207071402874277 2.2588592154885334118 7.2657139521957132544 -23.785682953730450606 16.751310468408117771 -3.7840346469751553471 -6.8796213660445095783 10.556360308365182021 -3.7631013774935655469 -21.779148517797185747 -8.4292114114957499282 5.4044728566873230236 0.76030692875908056916 -21.068525135179232421 12.918044656785610869 12.760726964407442807 29.576404953105932094 -6.031058393583307975;0.0037446242262157191164 0.00093585700205341387087 5.5282633365418130111 0.00072731839215143016201 2.5906767656706137792 -0.11135316324518954034 0.0062759973506472640017 6.3783920006085566001 0.42248713691665235048 0.17741897459772051904 -0.025969053144418868112 0.026934887924223410716 8.4674974419364499312 4.6257245872390599928 2.636229566705789118 -4.6894800346261034107 18.428573330757640036 -4.8645684409344882582 0.025886539515478961676 18.375662091096359063 5.2678885056222330974 -0.0308021880817915851 -3.0907942082205250856 0.18165150653073944276 -6.531396505935725294 0.38076769792265452441 -0.0054153279043515287206 -0.014036005226867110871 5.1087052357832902771 -9.3743709915794024568;34.070209745332306284 10.801928280790527026 -15.19796045066365231 -18.75192858921012018 7.4347418200835688751 -1.5234311820254020642 -3.0210518334374865113 -16.535389127435575318 4.4731420601204829879 14.584707584727444996 0.77219029312774967178 -3.0720850997536532923 7.311731267126762468 13.415679511403009627 8.5046784967084469997 -10.014431371094982381 4.6484499840508801682 9.6164911584891541452 2.3239785582837657607 -8.8407421223224744722 10.602723548236598461 0.12138691308308890981 3.1100005735064786272 8.0004757477841863533 2.8453412113261937755 1.5611282978223288698 8.4384305629587181841 0.73275106991378169408 4.4243019774865093297 0.38669619636771540572;-2.3164794973894209384 0.66104871975637991 1.2674777435409667614 18.536375784836035763 12.83705592928631134 5.7593284005009000026 -10.270094329810769196 -17.687044072942697426 -11.512681217991477922 18.996349341029812763 -7.0141605721131767837 -3.3947886042108077476 10.005278037633200228 -0.38338970330291327615 -12.32022959050395805 -19.075420774063559293 -14.430074665040034887 -3.7215000799386723784 -1.9406498537979517405 1.3505179733886993887 -17.909918609983801474 -3.5781240068584012626 5.1097175733935111808 -17.093066094313851266 3.2209055693558941158 -2.5699072113093577308 -0.42694555051547555813 1.1939495346992787805 16.856811531036601792 0.91134812335397696881];

% Layer 3
b3 = -0.22252085948506442059;
LW3_2 = [0.022280157356574518263 0.0058268899743086979837 0.0077655894879416790741 0.0016232074478128124314 -0.22382200831975321287 0.0031725579280182797381 -0.0053779688718474686834 -1.0615073670229555614 -0.01710416701640084941 0.0056812633907639877723];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
