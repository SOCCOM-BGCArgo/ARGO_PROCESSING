function [Y,Xf,Af] = ESPER_nitrate_9_Atl_4(X,~,~)
%ESPER_NITRATE_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.445704937963122827;-2.8378916013456541023;-4.1104846688922718201;-1.5842071634446839301;-0.94711680586349700217;-1.4545273208165447887;1.4400591593134199897;-1.2354349072134385157;0.73770613332537249285;0.54939862846020626197;3.4616093190380676781;-1.9076889329777884097;-2.1744324101118417403;0.38068139691081759324;-0.093303796383200812703;2.1393594284365478053;1.6637511499958947958;-0.061635178183990294021;2.2888250062999095924;-0.60332381605840801342;-0.18024577034179994905;0.77417746038027446254;1.6186092391094188958;1.8033247392187627955;2.1121983438314466675;3.2491644200756670813;2.3604624710895114603;0.49697492985387536901;-2.5961533790635300534;1.9536485995337844468];
IW1_1 = [0.37446433227174902303 1.2026973976085038043 1.093171649806472745 -0.45202814747907027471 -2.0040830049482853958 1.6459129515525430243 0.26830875789472702353 1.439998701683117277;0.032990591512409732367 0.10753359643374069132 -0.56012008929514200961 0.17821207011418088717 3.4202681261406646662 -0.052909262722874737805 -0.21377118764674227225 -0.50381021745256382438;2.1769741465367018485 -0.38126298683010756418 0.5223259850042689667 0.53583981676525971327 1.0015442757159189746 0.15245381068361429922 -0.33750859182373127432 -0.77246109929134787464;-1.628339729527110924 -0.95626375415597320018 0.762966275972567054 -0.67366831232324508871 0.73014666429450336693 0.8503821105910838174 0.0084246290528141795639 -1.245591831169496011;0.91234636415226100237 -0.18286531236622219354 -1.8138038825511357821 0.85442560718021698385 -0.31600346304339099746 0.024875162883659138191 -0.84386695256887311878 0.99324071849806094825;-0.75858275167186783872 2.0191129641987228815 -2.0523361349411080035 -0.23205195808816089786 3.0396622240647848123 -2.1765312220000532228 -0.98984162371513173539 0.34975778635843957076;-0.3592568063421827107 0.52053762731844421818 0.71529255531529944978 0.56410122829780962039 -1.8802562817402970197 -0.76750910635806024462 0.38137285225122635746 0.6893757141078604711;0.59194241114378987056 -0.67578557038781161825 1.1613132791728444371 -0.48166284093167516245 -1.8750544447433852291 0.16472292529800885985 -0.90248308696680956675 -1.6600478040640755939;-0.7984972822484289745 0.43994184010662523709 1.4327120083994171473 1.046213585634843346 1.7338121750843813462 -0.18358012351524255479 2.7949691904867202119 -0.038456043279322393857;-1.1486475999675616055 0.60804960900869964302 1.5015697467994206793 1.4623464770967369297 -3.0954621618380260273 -1.3881301322050925151 0.070941429531238775485 -0.88826344203622209506;-0.10127402166956234186 -0.1552878362430205883 0.51532667794310105247 -0.34330943850060158251 -5.2927148116430693392 -0.9512181920742461827 0.68224570118076843794 1.1806967210717331795;1.1950022655632626112 -0.82503802941673498594 2.6592231619493853501 -0.19972931809961894101 -1.0749324113732254826 -0.004828177279157970514 -1.8471879604108916162 2.2760922423790299618;-0.074478346675310461156 0.016426740818200648298 0.24437140864520637273 1.3487864651810208549 3.7767637480625451118 0.26393567043970833641 1.8951434504200757036 -1.4743673886821473396;-0.99056689831834965343 0.57789468406148858381 -1.8651760667887322676 0.25116731170091943781 -1.7193175059640029012 -0.59058884490929863809 1.4295671021044615845 0.042181662258549350308;1.6833407103811892647 -1.1261685582194860267 1.0192225756385602242 -1.9311452496449941219 -0.49156844887414774536 -0.0049375218307113680205 0.97811169962389599153 1.2940481837982920066;-0.074382810193952375588 -0.16619290085739524265 0.21425228524854797452 0.68152226915389491069 0.65898214511216557376 -0.22639306184533955491 0.51348097338920151156 3.7277533012569845638;1.0169739438130740439 -1.0518412107770767072 -0.88498718242437413029 -0.41227671228194762154 1.3726514344731377548 1.1089581695040291454 -0.47646745000420187566 3.2339092406227667453;-1.1412587489994643342 0.87553920314633448818 -1.0502086536685228957 -1.5159039721418090529 -2.7114226554758533716 -0.64957266342268227266 -0.51706632098248350715 0.44853688929801538432;0.26185605860941985057 -0.52502095368835466349 -0.38177255543251353842 -0.46710821038057009913 0.7411413617754314398 -2.0520040708407529806 0.45799536288985559507 3.1823228661102516135;0.21870566161775931158 0.050554704674483107174 0.39907988981728720335 1.2699752486435191834 1.3736716432251556697 -2.1108565157679186619 -2.8650819955684383444 -0.044633603514448380589;-1.1987926400869104437 -0.43540137637070097654 -1.6683820008090515241 -0.16317975750411678471 4.9356676105478243244 1.6887783948265786549 -3.3876662240049211228 0.31936785829463804065;-0.29526925773673573516 -0.54818055922949604497 -1.022908380181003718 -0.045738656813483394292 -0.6680904646243558398 -0.17474200286220809009 -2.5291971079309436554 1.2356278547725620953;-0.093306167809185935891 1.4176058435041689609 1.1826994995853985504 0.55928255394348935781 -1.5628721357971773198 1.5880930216745967609 -0.36594298477836179062 -1.2136868907441851206;0.68041436820588407919 -0.46208400838527396992 0.86370660130297693957 3.0233656882359518647 0.74922463429589525319 1.781250653657609595 -0.55684002140374766476 -1.6831910710298116918;1.6386644485854988673 1.2402014246658865648 -0.65364474124019644741 -1.1772368299221052101 0.76625624624695998222 0.15605237469701269126 -0.52951170071821707097 0.29063845653975423078;-0.50570404963488846395 0.11841538676984952883 -2.4909055200353971138 -1.0222123609561024615 0.79488153657249205342 -0.44173222398293715552 -0.25744979177645854751 -0.2598526688186016953;0.59754405121995546324 -0.12399876386925412497 -0.7587500557177933036 0.021466571357090236116 -3.561148648664372196 -1.2722279032700947177 -1.7090051234520962087 -0.13236635034563506985;-0.025638505060407372482 0.80502919981415399509 0.31697217880856959349 1.1229602179109150484 1.4419408983213675146 -3.0050098772855133866 0.93674580739206392277 0.7853058149627043516;1.6597726428040162627 -0.3448201103773928522 0.70274906803700998292 0.24881822346761162112 3.0337177085379645192 2.0554809881556694862 0.056121409021283506779 0.88063629766050333103;-0.53598508739340877671 0.26845330392965083277 0.34476825349678663635 -0.17660165737999608537 -0.17598668751743901106 0.058030673737764576492 -2.156553618737338418 0.75282493962131524778];

% Layer 2
b2 = [-2.401825823928913195;-0.54705373911863897085;-1.0271480243839159474;0.71965287711381797919;0.46740326846122576265;-0.45573738101122190924;-0.20700684476503772302;-0.72457758938911653868;-1.5906861630865771762;-0.46148133566137300443];
LW2_1 = [0.80304965448829312979 0.66618729491499228956 -1.3689553557922768956 -0.10984309379705230192 -0.3417129936614355934 -0.36588017603701766811 2.0080784184815900772 0.16423975701991211373 -0.87912937909486399413 -0.93794946294118952679 -1.0855888538847986435 0.14953107154665767897 -0.24947458141607015136 -0.42475919473683620975 -0.23038814486391898106 0.30589782576989699159 -1.0514817520768873216 -0.90356260830632273429 0.219350216714373214 -0.52060401309546122661 0.31840777567025696504 -0.19080797323464263049 -1.0749555253274700739 -0.20074513501275387251 0.98055326150273380836 -0.18890123254318319512 0.297066209189117858 -0.59001094431973000187 0.026798161423422475064 -0.14472764336738869195;-0.60666253392376101594 -3.9411223849424996679 1.2042720294707887074 0.076202016881527501191 0.47033525820954996677 0.30622594664702096345 -0.55455197495757979631 -0.97008114826854230373 0.67343603241225524769 0.16615788111098714341 -1.5706270419007630768 -0.15113233031163675335 -0.35630463920151989043 0.84663606617496911522 0.3071525301808523678 -0.47804612033075738475 1.0414048782898954748 -0.84650379378786910767 0.49836330718101329307 0.63583223812213041093 -0.427237049593854612 -0.21279088443472665704 0.34068259898267289065 0.74612640432980481542 -0.95887294651500942777 -1.5511591975440337521 -0.10720152020367502976 0.57094430467993817491 -0.19320841135664260091 -0.019048331999070754889;-0.47045518268819497276 -0.1471125430436081849 1.7854171949546664422 -0.5383224478019986714 0.60285257465803665511 -1.3271397943685405707 0.24785800505166863394 1.3526972778507742046 -0.21672408545081423004 1.6534164434037390556 -2.3980505345768405867 0.28059737046936611415 1.5593838512429964993 -0.21174854630889555773 -1.0210659703852396074 0.79250984663047530088 0.8999758771356742848 -0.50086925278817961971 -0.47764139546487227594 -1.0108913778008894457 1.7897877197203770905 -1.101191355004271788 -1.0066308806967063649 -0.37436373968549435665 -0.35365262585188117495 -0.085846819009476840745 -1.2944080384695475505 -0.40549208501103839453 -0.67461310627970649811 1.9886836453689313853;-1.1654753595240101571 2.7085672243736449438 -1.2190596432346170186 1.001085284946486631 -0.23200600401170637377 -1.0708126167228304571 -0.94360122150154734921 -0.80580744104325607857 -2.082477096746798928 -2.1755282773021318299 -1.3069032243446854213 1.0222893972337614432 -1.8168317449164570476 -0.31915058752506281214 -0.15878696323315796834 2.2455402765206589066 -2.0471128410477605897 0.28863378694674418634 -0.96768260661749549989 -0.21175510071940809032 -2.936466499406058972 -0.8158395838682845902 1.3487565037285187408 2.6621425039202821772 0.94604702484136438123 0.39383152970618717781 -0.68820182303611066033 1.778769510673429366 0.6213897471864988642 1.1894788183155460271;-0.47037751282675194231 -1.1002127240383847706 -1.1407541931996545426 0.025386089832431398688 -0.64722521696279600167 0.52617438218639189795 0.69040934988866653477 -0.34046483526247228735 -0.53853819714558093246 -0.5032328707756271724 0.74620827367034625599 0.29033611359402561325 0.78515627607367510787 -0.17121966622239731537 0.23769422521945748894 0.16192903582584414202 0.0052834369111098723054 -0.57342533355934266481 -1.1072284206915488092 0.87600568905386411167 -0.84608472258873890226 -0.29195284686940903285 -0.15560757261642191307 -0.3780659256917141553 -1.0009699346545706256 0.32900141013302863779 1.3663302120997338207 -0.38820800839844332719 0.65947139517483777116 0.36749082111175124243;-1.3185556914498199887 -1.2584989083598800974 0.70898294872869771499 -0.7637758212614400577 0.37929806438223617748 0.73022261536870447518 0.23252622929154309617 -0.26481860109883648136 0.95214117009013254922 0.64753167972984881917 -2.1200601144066220094 0.87282293315393666422 0.47931677170785685904 -0.3468379368125421025 -0.17620010641965550002 -0.33217626558973323281 1.2987434843952465613 1.016760857779631877 1.0523253682303823631 0.65967285600200520346 -0.32013761936597900926 0.28743056092980551197 -0.21571593102299199685 1.8711031676837177606 -0.89146088913409504695 0.69778560684360935173 0.63269654348475223848 -0.65739405948113538436 -0.60466710336223772337 0.5969356647898550472;-0.66025510074399285099 -1.1049849700481142456 1.2811823872442800187 -0.35235128522858638611 0.19060771344484850331 1.2470030286153290788 -0.069311424044255359744 0.73675338177630034231 2.3169269204176989874 1.3246546920473669662 0.27677530451736587214 -1.4201386215393485557 0.3543653343247681331 -0.088885405496846120466 -0.13848393185239191161 0.67219529199602656711 1.7276982894947883196 0.022894508980212325416 1.0394899622036515296 -0.90397061670897060903 1.6089297240282751655 1.3362335638392897064 0.69865522542622138236 -2.0630826135815816258 0.41393738770126758952 0.45995006075343547458 -1.7881505068783767332 -1.5617649713745920259 -0.28558211066668698352 1.8173336134422228838;-0.16059786735181424966 -0.62496667876616851522 -0.19231984598621479354 -1.1691944767704816055 -0.82080604592602512959 0.48894705329479926093 0.74845135712940102923 0.40642981081581186498 0.21024481314667353704 -0.19719731963056852386 -1.0528353950017905749 0.33364572629614791532 -0.27141753831499065841 -0.27130502422058438983 0.35597271321554219137 0.11694420624608813097 0.83514232966380430589 0.34350272538890941343 -0.17244306341864418242 1.6141713382296700718 -1.5577764267246354546 -0.11229115487152141473 0.085179288807614370049 0.027876542080051802674 0.19080018053822367374 -0.23031609452944656891 0.20595838823862563927 1.2644276721481526593 -1.0546564889211220706 -0.32273046881484362958;0.45527448999632108562 -0.047763438085975697123 -0.03314700594390230376 -0.050493064550638587507 -0.78108447086133092618 -0.12630375039102342827 0.34255331474598632591 0.4785164372264277266 -0.65744774210237177936 0.23861778140255626712 -0.91089878386598333027 -0.18051589255206187956 -1.0471251171216711118 0.12309406675612592774 -0.17060615977842691349 0.95894476115296745089 3.0379486072800823138 -0.4655547368348018078 -1.3124109421389842378 -0.14338027240806583418 -0.96470819236413796194 0.10871988414524269562 0.19138361608020190707 1.723776511267072431 -1.1104728112451993649 -0.40748285594280930777 0.47338076046878124759 -0.61388436844022242767 -0.275976165313229993 -0.99915301877042195233;-0.66851479609733455156 -1.2195269038005132067 0.034595226240528707817 1.3240217254742892017 0.20760809829142551353 0.23302794642314691997 2.8014123345466739323 -2.1573297746198711877 -0.41393061836700367762 -0.64044152714862789821 -1.2997117337559318528 -2.7318545483268970031 -1.0078977094731720321 2.0961623190524285576 0.2733579609074223149 -0.99402272649095757551 1.0852845654127372121 -0.21062055879225044519 1.3208378987604165733 1.091177369179086476 -0.68773214212309152771 -1.5569345946172918893 -0.19663317483709344402 3.015509124528229723 -1.9951072072324618212 -0.38543510355742516271 -0.46442507634238433534 0.84540036539871188381 2.4122406286891089344 0.87688457259211194383];

% Layer 3
b3 = 0.15159835614180017238;
LW3_2 = [0.36649033848332851493 0.4750006734445499923 -0.048618896561299536352 -0.084602414278494214583 -0.1681189154675155617 -0.11321327366328128028 0.077296195760641728256 0.031782630213964581378 0.34129863267961574325 0.18038544142567666806];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
