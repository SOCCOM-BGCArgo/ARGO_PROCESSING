function [Y,Xf,Af] = ESPER_talk_1_Other_1(X,~,~)
%ESPER_TALK_1_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:43.
% 
% [Y] = ESPER_talk_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2233067182966986;4.0401012333447666;0.32199136774130738;3.2715283327049729;-5.719931345448015;0.74076824841624023;2.4877188723849164;-1.3847994150866902;7.8702122608606153;0.87464895566039491;-3.3966025833760618;-0.25886339773949557;1.407974782145496;-0.42555845485440147;2.0366100613986222;1.2040218663229059;-1.2458305356442794;3.1471750337674553;1.2164536729057018;0.33074211864950914;-1.7418545871401816;1.9428586985993443;-1.0530751944830941;1.0965265173949617;-0.27552242514987785;1.423845749600092;-2.2500069217655105;1.748098976060011;3.5670817839272986;-0.3353952388768906;-0.83180951138750192;-1.0740887704116526;1.7557074710384315;2.5095350899456927;1.5401367580553527;-1.1242628813459514;1.3789870847223562;-7.2446558583696898;4.4405700639868853;0.81069762651344357];
IW1_1 = [-0.37037972666816038 -0.58949808121053027 -0.21128525909464649 0.61091950760811564 -2.7579434285963287 1.4862741582364383 -0.73622007789193034 1.1536522037246848 -0.11848303360706353;1.29418203409513 1.2512887424646537 0.56350143219859161 0.79492756490653016 -1.0691336583956033 0.2087906980509055 2.1501827287795048 -2.8981950399887961 3.6855873945949691;-0.26819293078690282 -0.13508523622808227 3.2450144342586911 -0.059846594218554566 9.4372372241732929 0.65262995978770411 0.028245076299564957 0.44509882887451557 -4.4775869431455497;-0.41590665775186253 -2.1133726397298696 -0.85780526003953672 1.6874128357905007 -1.3168611350283972 1.0172625528506383 -1.2845856798483524 1.1963605107860436 -2.2614839869244903;1.9835927264068602 -0.19610173646922033 2.2961154235232741 -2.4909990469855283 2.4359268307704189 -0.928632550029586 -0.94699351833395295 -0.11948294058854489 0.20193253199732694;0.065441301386484435 0.22791987861765267 0.11045734373803445 0.031953519104499381 -0.071298135887470429 -0.35235695280718682 -0.5576585294816726 -0.53441063220493568 0.72210766032054097;-0.23620051513146612 -0.06475560920791805 -1.0072449119888178 -1.5421741776884994 -1.4827088854588102 0.4857035352207002 0.52385852389375653 -2.9285780620752333 -1.7977599757060645;3.6968617069689089 1.8013819295380336 -1.1709137718254248 -1.922584485422719 1.469774363725169 0.55316409922634402 -2.8366111753796837 1.557519550551995 0.43757295549937902;-0.29077061126909426 -0.20565409106665389 0.062855422366006053 3.2265965842747431 2.5442611438314775 -2.601298622686655 -2.4234369095866728 4.601535443441823 4.7294225115890125;-0.1382008804476314 0.12757261314325968 1.6227436838728702 1.4874962384479744 -1.2270986754925712 -2.8520579411210658 -1.0607334438549545 1.237060083449337 0.56335951055771738;2.2997807492505413 4.5673959634759855 0.4797192637807759 1.4274621996529964 -1.473489884160244 2.5737990527435644 4.8504058162585313 -1.8295191564914608 2.938798122923056;-0.54346744045301554 0.0533607456568796 1.1152930862420203 0.54582549642577938 -0.12134666471590755 0.7438903050658553 -0.69464639972557296 0.38863521762324599 1.1925420329695244;1.7407689483001316 -0.10029129617195003 1.2322004523380863 -0.54446712372496286 2.3949386445893026 0.14764838326700369 0.57841865267196435 -1.3675859964726134 1.3311098023142434;0.0083418219991007493 -0.17532338266365083 -0.7110259987167199 -0.26012205929132476 2.166471958232342 0.071882131132292221 0.34144557953315202 0.12301439074398769 -0.012833196317518111;2.4343972183663256 1.0476831645218885 1.8491352042945264 -0.064949066902093913 2.4735323291683082 1.0889615012665503 2.0453866223270007 -3.1430420257917415 2.7034779030989919;-1.3600381117067906 1.5236838649828233 -1.6776345596139928 0.057728341153470586 -2.4359952385991743 2.560759059495795 -0.036740362206819165 0.86324807468135034 -0.55845843227126923;-0.34707281612057272 0.14122730486836813 -0.61928811641192305 0.76730491279973878 4.0120460627791816 -0.23150818213680624 2.1674286804215845 0.31896380342825315 -0.027239586493516176;0.62238893984407506 -0.70628995603234512 0.46444745670171123 0.95072586364016853 1.8806848629465565 1.6382668848658322 2.5132547163954269 -0.69080498283907321 -1.1830649066855339;0.39437108134115617 0.86457916321225681 1.1119042190143038 0.013132235528593324 -8.1219075144760229 -1.0386693111672596 -3.5209163800039907 3.6910138117838853 0.12540467002339009;-0.41621007071870525 0.10372787645073721 0.96433480714725872 -0.86779484866444934 -0.59018815216242804 1.4544064316911587 0.56554640907274356 -1.0730603268730281 0.3455902076385452;0.11481501330511759 0.050327841611314664 -1.7739984028009457 -0.37764296954682469 1.5480235579012791 -1.994355220567372 -1.130970380185955 -2.0181226351484471 0.65562185059894595;1.1949783049670466 -0.45755837891094259 -0.28054211092741149 0.75905529073606781 -0.66960333775014347 1.1516230307648645 0.29487927666206204 -0.75037639985680638 0.16251989098751962;1.4418996594882472 -1.6657639223617626 1.6339309265231354 -0.0069945756244019618 2.5534811490782574 -2.3399792571329723 0.045379239221341856 -0.86762774305109536 0.60462082485995194;0.65507189582129 0.042394226971565516 0.21691109981342266 -0.72828081040520809 2.3997778022196905 -0.19404281970762971 1.2243193760269959 0.0023104771045159324 -0.70486354163797738;-0.61586906049798673 0.08207621788934423 0.92851136614164365 0.61880863827350785 -0.28492439735605518 0.71533225027563418 -0.62449733130824114 0.41520696996560108 1.1202907536936713;-0.33000968721306562 0.2417569767382311 0.80292767515477403 -0.2229852369653143 -1.2993752380685437 2.3071626969369254 0.66963044196553601 2.0779458905692079 2.0567993338306456;-0.62450229821990955 -0.2455441560539427 -0.94831257912551636 -0.96463268934140278 -0.44281102372442405 -2.2068247029897612 1.6684676375713154 0.5393172701421004 5.2952210498250736;-0.13187013502058831 -0.95681745047094835 -1.1931874781169298 2.0377183868672195 1.91324187007618 1.0321376671690252 -0.11451848858394868 -0.13158308322650325 -0.35749312945309791;-0.1110412313271387 -0.084565940984698995 -0.80880764351015211 -1.34467099874392 -1.8947995622573881 1.7197747554928715 0.49894405933734276 -2.9759298126434754 -1.2223668715544864;1.7104677817139438 -0.96332174464216247 -2.705021674914434 2.1350613277630166 -0.39195899649964555 -1.4777273232843811 -0.78341145411404967 -8.6640435253742005 -3.6082258211895208;-0.23335592352665863 -0.30996992628910996 0.41690561898134154 0.336582662684068 2.201870271156523 -2.6900114082373028 -0.4797862221796414 -1.8702045522175796 -1.010541070141278;-0.15364626844846363 -0.10548723651796402 -1.0317339543833832 -0.25373831103316147 1.8865472733859894 1.752564990611819 0.54810279682573393 -0.42277229128804544 -1.2946239570113176;-0.48946690024998402 -1.0027047891812828 -0.33052823442224999 0.68668954034015539 -3.3020946296078368 1.9680021652030539 -0.75311092596326235 1.2846597709705971 0.12037358625477314;0.6920720437663308 -0.53237627205941207 0.67219145724857676 2.8377124903439737 6.7646331081907451 -0.72205134302751939 -1.086415713030958 0.17591927905319762 -2.247224141338318;-0.039327879617176417 0.32952230297356139 0.45741215778629252 -0.33484069600073108 -1.2817902172903124 0.11149407182270715 0.64639830928555764 -1.2494214847935143 0.89521802342927348;-0.55572980478250211 -0.15370734626204052 -2.5508201101529693 -2.8320704821662686 -3.2275493183796935 3.7869969980692892 -0.45995515285918931 -4.8673071076091867 2.2107547865546175;1.6481908667429566 -0.099110293462870439 1.0534786921354553 -0.51858769939826199 2.0497676162499667 0.1535338863137834 0.42342715210752369 -1.1980566791894602 1.2443065678993512;-1.0129929044575989 -1.4416136161973576 2.2488409474020949 -3.9510677662786233 3.5339618882519326 -4.5344520563898136 -0.15246300756122041 1.1183989878272338 -1.0228070896321082;2.0472571390859193 -1.0096798021575422 4.0947003706752723 -0.55223495014832991 0.27933253307855216 0.17686134023330191 2.2757561017390397 -3.7224802496015492 3.5071304853292569;-0.50742519623444493 0.33663613423817323 0.46813587444739063 0.95166844747815393 -2.5925086001459294 2.1338835427917786 0.24672992658002174 2.6912003556752269 1.8564210718832193];

% Layer 2
b2 = -0.26163827926892419;
LW2_1 = [-0.52657798374500664 -0.019137918417782278 0.057852731647553557 -0.042534286557674134 -0.10911363020080871 0.49557001395197392 0.72203841212597741 0.012277897298368545 -0.036938625323330553 -0.11580637546541425 -0.02712523212143771 1.4489252259901118 0.84135533561668308 0.4224022557324017 -0.039130181378115629 0.26473932419714524 0.065171916287598233 -0.18064553786008464 0.04307483452144386 0.20894703209631046 -0.11176041717487344 0.16522522774632048 0.24409072834731044 0.43590883955106874 -1.5816434604922305 0.11285882221071017 0.021379520435739 0.085484062164367158 -0.96265127322595345 -0.0097521631034311503 0.10373081530031325 -0.29017622586831354 0.28653771349210433 0.086003588231948147 -0.30577169448096009 -0.01323966061413214 -0.98053936049547208 -0.02921948748194186 -0.024928869565886785 0.11999459181373497];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
