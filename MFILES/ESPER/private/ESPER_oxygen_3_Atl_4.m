function [Y,Xf,Af] = ESPER_oxygen_3_Atl_4(X,~,~)
%ESPER_OXYGEN_3_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:45.
% 
% [Y] = ESPER_oxygen_3_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.8204016394627586806;-4.2256577659248293344;4.8594476434275932775;-4.5925275715469497939;-3.9073864464834113797;0.34225796999004681753;0.83839166373667917131;-7.2585037527870701624;2.1057980631898778334;-3.5256586034466437241;-1.1314738361330556327;0.68487681873541073063;1.9680316194022879905;-1.4949938437418470727;-3.0439087695371376263;-0.84647541360582567727;-2.43534383920941222;-0.85158123731176360582;0.53149373941131172749;-2.0861369267037783715;4.007609636276244558;-6.6758528883853127667;2.1034122838186966042;-1.7296017452663960956;-5.6037458948986396123;-4.6181567941389882748;-2.1514621799723880891;1.9695769363275714703;4.9907426411304971481;-1.4395773139580338995];
IW1_1 = [0.041481862434683443308 0.12053651955209261637 -0.16825194688900452222 -1.8348464347924853257 2.6343327078892295745 0.64231753586352446916 1.5927470893662667439 -1.0622219114890665281;0.062153439667974583194 0.2049899361513108087 0.19355545556037895283 0.4489523129572280391 3.9545318265688900183 -1.3585630821010721281 0.30688179404033483211 -0.52041282333098226598;-0.14246805759368710853 0.13796465198102264571 0.068301073074101520399 1.2577229126602049725 -3.8041148977324361624 -0.1006821582188108799 1.2831470474236279511 0.79178661413146422809;0.17963958634579260676 0.94934495387001982536 1.1252843454150374125 -1.6051530290220397124 1.2648988836000405467 1.2652821537972800403 1.7291985520956869582 -2.431170233330766095;0.16586381993907522991 1.0593697482388200193 1.1502048437817777859 -1.7153509442896497372 1.6003160322630800572 -1.1922207704918115212 0.26937031353438961601 1.3094002992319369039;-1.0891643652058842218 0.49701543913245815887 -0.54323041251556869469 2.0197970539539418233 1.7193605979667889727 0.46399183669556548493 1.4250166949991194265 -1.3510782657089566161;1.5154758125819181025 -0.66072533230146834882 -1.4624829722650263264 0.059282337534222295794 0.69655060751037334299 1.7180324679018201817 -0.6843725166036273011 2.9702631095867686462;1.0132683487708675774 -1.7195861998350550071 -0.71323662368496243413 -2.2318285407226703398 1.2835923881817143943 2.0811920135797938869 -0.13964258933087209114 -3.0357984049442752195;-0.13770677001832085096 0.07149099863736807503 -0.31374623538255547173 5.5582080703090275264 4.3978301690673387014 0.10011102478840835928 0.62917873647900557366 -1.9487038373445009221;-0.0074475061673509087429 0.5154075621964804288 0.59467538398134955901 0.54977716386234176671 3.328558621484769553 -2.216504678063333067 -0.67813593762932156128 -0.18982261976191186492;0.20624889473908195048 -0.22766548337138164948 -0.036340041838714830236 0.39837147407011563871 5.1275368448597964388 1.008029339837049676 -0.55732433132396907993 0.95675077795653695745;-0.29420092228370919862 0.098937022225600218528 -1.3884053524237476296 1.8902093928478280738 1.0400837516604344302 -0.82893434634776141934 0.79818337799049732251 -0.47154034859835297633;-0.061062729936463222558 -0.7687674133521484876 0.12579131555277967003 0.21207810095090448566 -2.885345317207588689 -0.82388134267840262837 -0.23363612217487877976 -0.13300395863806013796;0.18916225963279972855 -0.24121716647488944396 -0.043386091928817226149 0.11362764279416018298 1.7965914425341800165 -0.17097361611927508473 0.82787390798895266197 -0.7140163047006050645;-0.14005328768785740845 0.63938633626708207824 0.21755635777404369602 -0.094853356480106676418 3.1258068501763180969 -1.2036321063373904838 -0.65750274514589246433 0.38480688370953763933;-0.2462895814839330122 -0.89798780802033140169 0.47035831749773238109 -0.82800654982878874044 0.026995919188957162582 1.2532817923663497339 -0.68643122970128833682 -1.2762092005465390798;0.8431416046556160504 -0.65283963591693250361 -0.59692010659178762477 1.8901518473995710945 5.3559300983531343832 -3.2970983267737103972 0.79585380286399332039 1.4465520405271365956;-1.2700745059724332098 -0.94868122941997301556 0.69950287280380873955 -0.90428691644583258924 0.55063052096924236523 0.054158774501200962481 -0.78089684689405736151 -0.74782165692742996743;0.17536726650011519313 -0.80741143090753342282 -0.82618535188030850502 1.5210968930442942959 2.9686714439520955899 2.2898568134293912912 -0.62109359714458822754 1.4303209291756227017;1.0216952080994166074 -1.9689786323146780678 -0.32955043522165966552 -0.45147581510866258148 0.076974377839958058045 0.25332801207175503766 2.2472299802266211266 -1.1031988638042338202;-0.16761089599082476531 -0.48061551596180707158 -0.73561062676707367203 -1.6513508483738770227 -3.2172608549369252628 2.5660496035691671146 -1.9201644883661068697 1.9980346048554311622;0.87875840912556224538 -0.23508626834987050858 2.4166214450540000058 -1.002623087194198348 0.12130569727751498721 -2.029196931424175343 -0.76719615869530333185 -2.4892986393918152821;1.0651787787958675313 3.3056524791795069973 1.5763400810678243058 2.3185690941590988423 -1.0621065929328445954 -0.74482959971832263246 2.2999182583576449623 -2.1417170477588949318;0.13436536679065738675 -1.1950913033955030684 -0.12550601017673446158 0.85101273721149284235 -4.2318775563309127818 -3.7350245635215695295 -0.061788408015429396869 -1.2099319950630844644;0.47552708758439604653 -0.0089365379856968501365 2.3226558858677610608 -1.813552796991961813 -2.3618757921000099742 3.2178860875644348383 -2.2368789962909554347 -2.2236286112558474315;1.270986957761166769 0.34734678199620649952 -0.041329144241586977804 2.1288865672119183792 7.1093240414575529229 1.5949275085398744167 1.6850101860094934825 -0.92175132798090853026;0.23790764168437392168 0.6153537785909168889 -0.28593647434707375465 -2.0641541953515796237 -2.8861128452880593365 -1.2897427798618841255 1.5443427306949586431 -2.1592118999644500654;-0.066187182675965405831 -0.089396535587060801942 0.67572672973971059651 3.1258119807499880061 0.91046058445668143211 -1.0344860884243263222 -0.38636659227245828685 -0.22401748406617721932;0.36926525986600283735 -0.55614775888090250966 -0.15605376749192786945 -0.40426692220482868256 -3.0629306893782306531 0.4978610552723330418 3.1984524093374737674 -0.24598427625235749772;-0.44824579066083936052 -0.45150625217568279846 -0.22778086639453271056 -0.40931121583204282954 0.45409817212892272797 -0.34707840039319654002 0.22665180566448611676 -0.296426509094484536];

% Layer 2
b2 = [0.66283102156657447424;-1.7161425758590997948;-2.6806695247054612707;-2.0022823568011278716;-0.78347438079094855468;-0.64763071336415611867;1.1697772896620475258;-0.19133737351053273223;4.5197651545902912673;-0.50275924726847298629];
LW2_1 = [-0.11826092122163864295 1.7949332302225784463 0.96051832481319798784 -0.63158521336710815586 0.41849610036098083832 -0.52159292470209672743 1.1931755664240337733 -0.33348333497525883828 -0.26207670667827076549 0.084133660203622215312 1.4760151600414714856 -0.12384380818371491795 -0.43846011730827560982 -0.24888593847014200966 -0.13927673180594335456 0.92802931576822111914 -0.28711311593478527904 0.36604252367595413453 -0.21343856587727996765 -0.13058753619358570708 0.036025625597565176517 -0.079109401673558232826 0.024250550224189613979 0.26576828423397874657 0.42394392289304627663 0.29605793855470774467 0.7388617225383422582 0.36872352678449943353 -0.29247427761033423232 0.75462188903478766289;-3.315982753680824402 3.7038771484150485591 -0.84101764310254911727 -0.69471441369531683474 -0.91859591037216981046 1.4695098233044205926 -1.2733109214390689878 1.4339929969801403775 -3.3804643142140875511 0.67341409853944489416 3.5483310933882648008 -1.7822768640314274879 1.0883030644646765062 6.4053830899881756267 -1.6759936138114785997 -0.69640687643899845671 0.59371535875370373692 -0.17776545626600087635 0.74822637251323331764 -0.55441536447519512709 2.2822964355231838418 -0.21528132079399106558 -0.21627862488690069442 0.67569962627453017401 -1.073528845948865218 -1.0467496346912463778 3.3195603407675213781 0.50487077845951366939 -3.442613523976725709 -3.0769779802941252811;0.19789693495316859617 -2.5729168439774952049 0.44809251701447000427 -0.82430511759555280538 1.961997381715080202 -0.1426122406545733412 0.71756756233234320064 -0.71127225098446589246 -0.5089943216542562876 -0.69178973609714211612 0.58624253147939153763 0.6245554928032189812 -0.61140939362729773698 1.8028846876118487241 -1.5137399238747113461 0.34007273068018439854 -0.49885742141220212886 0.93998344074494488698 -0.51426405690710397245 -0.89148807097484439321 -0.68249162172890476263 -0.41856082487232409983 -0.27421438120371527392 0.33132239609694497107 0.15742557404690443734 0.56888215279292531079 -0.7372987301624223111 0.2512859839809536977 -0.96279586593463151178 -1.5822232175418950995;-1.5880529566474301806 -0.66659639178987040165 0.15427148494905468246 0.30776807001301098587 1.6009126866218648111 0.079057710358049926302 0.78667243580299850425 -0.16449753486719403961 0.91615740643967025214 -1.1483870867368504154 -0.98059335527966251522 0.71073184407631662118 1.9684930227675103698 2.680296023358659685 -0.9196991568954639984 -0.54718486849976355479 -0.39276819518651839847 0.95194938504445059113 -1.4917051856797429732 -1.5263712877967299253 0.68991999333037679065 -0.18426069892834182062 0.21572002652577995652 0.07714143558832965708 -0.58655921585389148021 0.47204666986143417606 -0.16328202559732440946 -1.6061448422811079872 -0.93010436076035551967 -0.65340307691503740628;-1.1872284069358836067 0.1219264289182632327 1.0370133743814042848 0.049934089038754105039 0.151050783323736032 -0.36345703200345280681 0.7512814003636081317 -0.069455068576580500372 0.34587788760871374105 -0.28014240334698875534 0.25402521348537787649 0.5916482705762992067 -0.099690013291209439439 0.57639274189130496051 -0.10127111905083763244 0.5815243915014042253 -0.51954471812091285177 0.66482435941515261035 -0.14610107003444833262 -0.21105002816664350518 -0.16552165535000840091 0.21281351886684135577 -0.091313950293752318976 0.18722284753404658253 0.43490840264477192978 0.47055261186466351697 0.44904525083039670275 -0.1222145836077518366 -0.58873490425353225408 -0.52963062353419221306;2.5892691259452131902 -2.2496250235919887928 0.0012390904749886022529 1.1257272494148304887 0.17745310948450637722 -0.41702028257897272301 -0.33188933020799221696 -0.45406495933007151589 0.55225988668406444937 -1.1826670608324281186 -0.46990788476280304087 -1.9672519009949127611 -3.9169931124556991442 -2.2829035548135347966 0.0035224529629244438755 -1.4302643400935821649 1.5203966454376645068 0.59429196134963047093 0.58517986173478719891 1.7107668101329693844 -2.2592936817215787393 -2.2025991710099184218 0.15927104865248331578 -0.86406135776594850118 -1.018934776145109744 -1.3624935430848139628 -1.5205795757609543717 0.24485233922100788084 -0.71205156208130471196 1.0875148735941531086;1.0895635090710427129 -0.20226724310740545887 1.6617569508975658099 -1.013178279486507849 2.0191882163520911142 0.63431350008288966968 0.04724334576248914036 0.85663469764259314587 -1.0107070997912799282 -0.12743344332944731012 1.0409047424914392721 -0.17123236553182813457 3.0289080420281742079 1.6914297375945892554 1.3177557699781918821 1.508780338915949093 -1.2294362427734684129 -1.2480735786746279814 -0.51963999248372438888 -0.91391255258796111338 1.3748502436049221398 -0.9143704103716868703 0.41605251950479377188 0.40885874360361618152 -0.16338580049664172544 0.36593261768215812335 0.041285537443986747297 0.50994205913994727908 0.25242978273791399912 -1.0834350081036523417;-0.077667131159930569151 0.4976096733098454572 -0.10814982121147598271 -0.7181667937670853652 1.2486644413542213883 -0.015834184184672115553 1.0463440226353946105 -0.54615395909165009858 -0.27642134589124556232 -0.92105299100223281261 0.26421778297974374272 -0.27423817090688146214 0.77246966038799957932 1.805508737147254017 0.238155272989037603 0.37149203771264549534 -0.070687507165733604042 0.24611081622611738484 -0.71259648199787606337 -1.0261311816924212348 0.26741926718328762336 -0.50758006823871248958 0.13751082463316249838 0.56753237252880894825 -0.37368160275794465308 -0.021921902095502210361 0.17337400974173047818 -0.06936464289356293611 -0.39309388961823893416 -0.066832494965685051991;1.7979548963573703801 3.9210843500204912715 0.2026308464650404817 -2.3729791349838422754 2.9918272011407771593 1.9469550856808979233 -0.12212796647194566757 -1.232172988231925892 -2.4126891474331273457 0.88215357505978786445 2.1405985351199832145 -2.7736620890350600632 0.1283677582499725689 -0.40028551878440260525 -1.3362324021654472528 0.67476215178546727902 -0.31356203567511514718 -0.016596985184009101222 -1.6644803520820963261 -0.067712278043163320884 0.88772241395020290433 -2.4108902564691891968 0.22886097809468153308 0.34482313143328102711 3.3763413741637382515 -0.89043046163352768119 -1.3716638580211888421 -1.5870356471067534887 1.7098592940714236743 -1.5850751050614726445;-6.5657874517866545716 4.7687786116204362585 -0.31892147906521595147 0.092027223857227377635 -0.52400544802248161247 -0.17482314515049085513 0.48593736545183369158 1.765801862257698307 -2.666393502121835013 -1.4249655434489703065 1.9287578830238127914 -0.78753893007667208348 0.17960129007168512683 2.1825639852075271463 0.59259438575287393114 0.7600321984124283059 -0.83365846184147152087 -1.475061884956327507 -2.5431588302545673486 -0.14031730447262513728 -0.35936068177295260595 -0.19273492267778702391 0.14799751799346738679 0.21374733200792736532 0.37628696669161892929 -0.8243887491506244336 0.27900851804364268371 -0.88672572344445277359 -2.1237055069949821728 2.1866826806818662199];

% Layer 3
b3 = -0.046162830404750714031;
LW3_2 = [-0.98720592008082630464 -0.072133423043727162849 -0.40403074831024526903 -0.43152553325585751853 0.97978507783963486588 -0.089106639479853630426 -0.36384655179575875472 0.73692322342205396346 0.12449811919370142033 0.25935819627023093403];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
