function [Y,Xf,Af] = ESPER_pH_12_Atl_3(X,~,~)
%ESPER_PH_12_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_12_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.782147075103294398;3.2350894137038093135;3.2384529028562463182;-1.3671148596024889077;-2.3571496322474829732;-1.1070731994517826191;-0.21882608413729287555;1.5090690540257318819;-1.3898902445816549989;0.15662354836120728763;-1.0793102883546752402;-1.360388088474344892;-0.71269065243404527976;-0.25878521540816934454;0.32299887274476468679;0.50578420017154623878;0.32170431009178340753;1.0296971132527361625;1.0797887479570902336;-2.993502510814100237;1.9477987323084140492;-1.6482185217015865586;2.0483900315294762962;2.2079199975352521435;1.9469109405308751004];
IW1_1 = [2.5499048591636745975 1.4767237666361379134 0.53907521424357940365 0.80430992887650387679 -0.97875925673375407943 -0.45069620792353332073;-0.90180532351622211262 -1.4822498917666560025 -0.40953028851211781269 0.3658702025635789945 -2.6895903607966817894 0.22165038508854115196;-0.51432333813782871168 -0.6571037775998439523 -0.26720654958813699897 1.0057608758630149914 -1.128876506327042728 1.6487844498226313927;1.5203143071821916266 -1.2594756465946674862 1.7342523098126751968 1.805356213883222205 -0.28319920539068998977 -0.61323226705474376264;0.87850520866431036637 0.95872634755755226088 -3.8421958352923937241 -1.6169602415365795789 0.81657000119089295787 1.121305068294901286;1.2400007789068387964 0.098412714002709636429 0.78681851139467928746 -0.42204901956284057718 0.79314581430483355184 -1.7366655670183068771;2.611268807420376703 -1.6392538083576762009 0.52975215703998224104 2.0410051848378261141 1.2404311982693971839 1.2033089658924720489;-0.69121204772049837928 0.6641682976061050736 -1.8308087739804017602 0.47950885624490263703 -2.6144963527103395329 -1.2222958355534676578;1.0241237970666599022 -1.7138503693761042435 0.27113395323937328207 -2.9329726419042869701 -1.4342636058923394771 1.4492611827338099939;0.38138238342353869559 0.81209578309601271329 0.62410861100932935042 1.1664654260621818427 3.5398187973454335875 2.3376969130736418023;-0.1319942961501162082 -0.19313394883367762667 3.0667803965553561696 -0.25371800752358603104 -1.5487794906997385258 0.6697754799291032457;-0.75867702656264091043 -0.31248569341335263871 -4.8544698340731491371 0.92401391355152795448 -0.18333216885412922936 0.04133219924266793438;-0.94801993105520876437 -0.52728815331331491123 -0.86203073376791317095 -1.4158485973443579731 1.0783651431392626829 0.66992942221562623573;1.3376223508573352738 -2.4514781771747569117 0.015174236158342452666 -0.44745085791916522355 1.1291114832896587128 0.39584972054626843541;0.80765010354053057284 0.17366937496482623415 -1.388936311146749647 -0.51799462904711512934 2.6562929793482839003 0.75537026961379583057;0.60112725613007023107 -0.2144528814738717315 -1.2083473764961032426 -1.7107399802462466276 -0.88097596307009395922 0.32275809506571179197;0.62259494922958669161 -1.8747631861118858598 0.92595639775186566744 -0.62631207963870716426 -0.47024400951439754293 -0.14456687836771106581;2.3040965453566570886 -1.0190486027643008704 0.03956882039414721941 -0.2134827472840738205 -0.98520314114180196352 -1.8222661408062772459;0.74914982602437718562 1.4147015345085378613 -1.3138928713355766398 -0.75924222850018507902 -0.69031433698310373792 -1.3681984328452820865;-1.5831988827728484814 1.4512206737217461239 -0.15821430819807663637 -1.4853463564805355901 1.9436314755183308201 -2.6405858680751648215;1.9658662574893466246 0.055171347816366227146 -0.25308448585788928531 -0.40725878992654029886 1.6735443922174104703 0.69412166975479305808;-1.4353249564092098733 -2.2043431824867427693 0.24987311924716543166 1.466034715152642276 0.095343236288329136219 -0.43809227523784166625;2.1927465213949433043 0.88959045283081339406 0.8254035136687614127 -0.63279113026287214794 0.67037725224503730281 -0.53829564931455042842;-0.444348688597501984 0.535693737343134746 -1.6616231613208238826 -0.72195429398575194924 -1.9791873666180257452 0.89009413608520204786;-0.060328550916844088381 2.2263556940564424025 -3.0907087822758350093 -1.2304137089525646331 0.5331079411779829913 0.52959332327148089803];

% Layer 2
b2 = [-1.500999621318232613;1.4883998128892408364;-0.85899211064214420208;-1.0925915187610653057;-0.97978892895087388304;0.51785224560413811723;0.84178955871526039978;0.38846559013630926893;-0.64438408612066022663;0.46241089095850163027;-0.57452775075628581547;-1.0060098238424162176;-1.1843333766682013763;-1.029874232636052378;0.93750805161040007274];
LW2_1 = [0.27469569240555236078 -0.093225265941879895126 1.4856358085844649786 -0.39357648956097474047 0.99177940290531574341 0.50798663240273744801 0.48741733894718036746 0.6959874711083523513 -0.56299700788034212628 -0.51743816455811830757 -0.24402753739079371953 -0.40728119687052749542 0.42135222975204705831 -0.10791857964271370229 0.5110904134426723644 -0.86027261347607542064 0.20766223736592487326 0.54681126846425232024 0.43172077854791651719 0.10827431725505817783 0.19178157793851804969 -0.28439916351105509751 -0.4806828018489182619 0.61152919913815018127 -0.10260524012444688369;-0.56240241597118345585 -0.57697633957431793128 -0.16720334701074496264 0.22123193453950651399 -0.68590648617349792016 0.022881227471528053224 0.45482771229557805714 0.022019440130724366594 0.8967363805984776004 -0.11854637822991664908 -0.27776642890606612069 -0.15874016691949599522 -0.17709259547276359759 0.17357695264726921702 0.0050499599973769194669 -0.16084231353599523495 0.85742563109257119436 0.8826213902078886564 -0.24538974276457550805 -0.27054725519607664141 -0.65282776634812877958 -0.20100587714666712236 0.31936333361668539643 0.11780655022893560258 0.29662278157519661459;0.014191129206088736597 -1.0376666344604268399 0.47010570872432860812 0.19164711004145576489 0.8122572393276844549 0.25271574161577026185 -0.28207156046777348557 0.42326880205129202572 -0.21502227475738278084 0.65827486744934582408 -0.35515297703243103866 -0.82939687517522830973 0.52659517645651154893 -0.36499330748891489762 -0.94073429659367424627 -0.12760998014291877189 -0.11963826311556950699 -0.13243480370166441085 0.65486172987305224513 0.32887079385927436848 -0.26615243800543819663 0.3014492191981634206 -0.28253992498551461221 0.21562234344881112125 -0.26058234739744096098;0.22287956570845571247 -0.48451134911462179211 -0.23047790716509128361 -1.0034987469891303302 -1.2790253729859939469 -0.39874853150626082821 -1.0699964779110151536 0.66942655608149159718 -0.33001498433827086698 -0.40202772642907075307 -0.70326829074837426958 -0.45548281084474678826 -0.12804248099599377375 1.4215256233233193317 -0.30193097252158679344 0.15331530155910624846 -0.50725884680440891383 0.41441021904319330638 -0.51462067717039605697 -1.6729064369158852532 -0.6427276876663311489 -1.0091557334098626431 -0.14122968385336498454 0.88831360864974606706 -0.88190364550508437702;0.31275504373000123648 0.045997217730197909047 0.36777059701185316198 -0.33214803324969710552 -1.3314557141027478782 0.50825160667739699427 0.027464830852903160396 0.76508741607499097803 0.09180664778641910162 -0.48421739485299536421 -0.32335341780370197018 0.1488519976051266569 -0.42452624741813632658 -0.41195701759648689633 0.33559752933396552743 0.57025459533844879978 -0.24074360918594034375 0.83928788658687270008 -1.0597484329766770905 1.0667877047113565325 -0.23650893935468803031 0.010471186818327121726 0.12204303268912553015 0.2155303282887008065 -0.16704058272499244797;-0.53999205705184027959 -0.71061177347838866414 0.079357644632025492459 0.15138377323625429316 -0.23359662184707571941 -0.55936670210011085747 0.09890132911200133492 0.52175394299105248841 -0.66500620896256024128 0.17294330980244554397 -0.26609385056181705798 0.2028876241412859438 0.13434757487187060088 0.10037549326185822574 -0.2982984531422713248 0.079332613348655378616 -0.096073403001560392367 -0.035978071923903801044 -0.14424031498686123998 -1.0180788710196657654 1.0006480458771882525 -0.20380402850371831525 0.032342361432596562765 -0.94313158630437610164 -0.062228824159486481604;0.16917490244706528957 -1.3209148230650571421 -0.27925238854676015521 0.014332633485098625337 -0.38232322156260806212 -0.46562642394943631885 0.034227661172279336133 0.71361988939348386385 -0.12212914558051418679 0.18068336819212410527 0.069021062559918244794 -0.28900341203597779138 0.41247552647382873525 0.47124767253393262667 -0.52948710309763669102 0.34277845947005392002 0.27831581097928853596 -0.00061776850426541185524 -0.060799533439542259583 0.44686654995978258853 0.41012851161505375908 -0.64718326285493610328 0.61491313389397106448 -0.024067337261854417768 -0.092820721834966243846;-0.26755440716860839911 0.27600516422535703587 0.50563040204669795763 -1.0613753133530829942 -0.40701450457661042526 -0.0069050492725249304829 0.21952338512533259296 0.63523852171464578742 -0.62774817912290759025 0.98813783778240504851 0.28984551218755172375 -0.13358820118026423773 0.83002739219528576253 -0.046891197749174454157 -0.33748077225435213489 0.26093280550713393584 0.19918739005754376725 0.13664722856925301531 0.47447685628297009419 0.27459588771534731988 -0.11640258649151763448 0.042685573270129666124 0.76888873765172227603 0.28985585395082485993 -0.24001182888136307625;-0.38132122496009962509 -0.29647768715631717118 0.28567915917941466564 -0.63992077325728025095 0.50974654995045765027 0.163762092859517705 -0.027638630499373106203 0.44273297446263093491 1.0855054745823176088 -1.1834118149917547402 0.45877511597165265833 -0.35548350702796394085 -0.60165003186596732743 -0.62207508425940483132 0.86866719204407483179 -0.45439290559026046523 0.35211101724214388664 -0.73030486275189288037 -0.66417264274910536859 1.2049737576291492669 0.17544706925096395511 0.25328357098501719236 -0.087592217008692213609 -0.48452144253876483493 0.32512457189550975079;0.64817777950235933027 -0.36372024536506858405 -1.9744107136446789053 1.2915703983716173564 0.95722285429704923043 -0.67191682740373837035 -0.41393301565686146937 0.76426724375715482385 0.4941193500691417051 -0.85687518955582520075 0.34011359220452935803 -0.98977034053262713531 0.082368506400135710344 -0.1083192332576007888 0.59398792991858351265 -0.1489062478582358906 -0.74946546486273502019 -0.44424923095836971187 -0.0539233345851548862 0.24407605964578873992 0.6236125207483654842 -0.72483521379298054832 0.27046201768297561951 0.023918938958165027187 -0.42616595238963400627;0.02481971386869600768 1.050921487694367551 -0.2390207866779462953 -0.7082354072868211059 -0.68258244427554959355 0.075822595215826488202 0.33618304233782320134 -0.3412574042681757458 0.14028830663789487732 -0.20846521685401411816 -0.63641746409553145991 0.12805410003657047291 -0.8134352144148274677 -0.34259631195081163835 0.20224220463597486486 0.064937031736962455564 -0.51828856081882612727 0.16787995346936684937 -0.42215831469074605042 0.3581090782026446484 0.32035066400502398842 0.16792300041316673975 -0.82122132582747753293 0.20473348786400211163 -0.28357761709539253125;0.060071726581686607505 0.92678621344033562668 -0.69576578636615848961 0.55574863290535503335 -0.40929448417351321776 0.22897917421737948307 0.63938395372147316387 0.28574259549336511466 -0.38538020906875686267 -0.59226485001527939822 0.15927234971048023771 1.0309974061492814812 0.345968848584467914 -1.3280486579267689606 0.0067123890323337667696 0.97526001914635573886 0.16734408386106522371 0.60627976511207537502 -0.11157937899249051328 0.50258238204337568611 0.47835851667832141043 0.34351853893653355732 -0.42447026351678240896 0.36391756590746338063 -0.24103260107471749518;0.23118033260987630451 -0.74914316562714444725 -0.52386768020926111067 0.011880773492226935281 0.4704841696053321809 -0.34674002278222632034 0.48166388981842556127 -0.35932268542800499533 -0.39991436205318930952 0.046521197217616674924 0.66324038083213798789 0.34042792843423741456 -0.0051036383215374084288 0.75145754455627689072 0.71587319294508633405 0.07557490986766675356 -0.047917430458981738473 0.38281476282668253086 -0.28588428348255090494 0.38102803290659237323 0.17577840934731625566 0.13508878716579483803 -0.27527310895147183434 -1.1901036254703307726 0.31441446886878349209;-0.19053769998397393493 -0.37838857035097922532 -0.14135713014691281275 0.14478343347306216193 0.8066469602963437513 -0.31977626746510767752 0.51846106252984325291 -0.41319212202836802517 -0.04953806932468038382 -0.2498610561299517141 0.85102383283572258232 -1.2850835495019041765 0.44802731028163761406 0.21320945715618236371 -0.83218187012089206434 -0.15593321042513907937 -0.2050628160864742533 -0.44068365660395864003 1.712535036872904648 0.82958790567499829383 0.59903523444598860692 0.34219260417458707835 0.13864545318326421119 -0.86788944690586056208 0.55939989313301852203;0.54192578795242274392 -0.12622051464263980836 -0.50312898541021844334 0.23815204340314649611 0.43284883019800574067 -0.059899498013935077723 0.11683244404467756083 -0.3912155789729006572 0.30910950208760429314 0.77353499776635292751 -1.4765534354292917385 -0.88708858034947268845 -0.044265840610916873388 0.50919580427236221798 -0.53226238115279234098 -0.30461035050671164681 0.55463401149752700192 0.056970380383215654674 0.2036104619385735448 0.34973614261537888659 -0.13626766845838617082 -0.0833464547050703497 -0.64750651028629813144 0.573264715578968298 -0.14281117090235997957];

% Layer 3
b3 = 0.74169309215279732861;
LW3_2 = [-0.39721956194650986927 -0.91028111502074282591 -0.92597972754995905298 0.74414281027001039082 0.72797176182396372557 1.4516579814297403406 -1.2939354335713075805 -0.66748384919327230502 1.1657923379814458809 -0.26733325175406574825 -1.68575875723108215 1.0079417632751117573 -0.78783461739195581597 0.9409066723030918844 1.3057308041333599569];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
