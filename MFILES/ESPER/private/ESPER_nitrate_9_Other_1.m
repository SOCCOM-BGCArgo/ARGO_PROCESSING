function [Y,Xf,Af] = ESPER_nitrate_9_Other_1(X,~,~)
%ESPER_NITRATE_9_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:35.
% 
% [Y] = ESPER_nitrate_9_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.2119639957392396301;9.0145118791241216627;5.4980032749056579888;2.2653935060328498352;2.1476363970120724289;-1.2467365376169725621;-1.7632201019223339156;-1.0723929935453622164;-1.4970328971141160235;3.6112597177397534054;-1.0739868779918633201;-3.8961472108481665089;0.13917665384492242109;-2.0911722987963448084;22.31455252037851622;1.7020480855800976805;-0.24201355888648443115;-1.8160054696423169052;1.0386209509415249563;0.98240884382586057821;-3.8895248245776206097;1.7904446921244496771;1.2068859718750282184;-1.090444457271892098;-1.0067023114284312513;-0.39450822453395623102;-0.059390649076799119366;-1.5353709574054403841;1.2198814343434514207;-8.4818858979586533309;-2.3947348961215526586;-1.2253646132462383544;8.5350780285563470073;2.318991552200928119;-8.8697848321849761533;0.51995645406417134726;-4.4437398748235334978;-1.0476533265757168589;3.592361051682520845;1.1318500997982126055];
IW1_1 = [8.6403400478422121012 2.496253553569384831 -4.742905068503075583 -0.99612307786052944891 0.80530258676389621098 2.8974208053001571095 -6.5460379747400274653 2.1726786335267442851;-0.24324396493397890118 -0.35090302232182996045 3.480638612415329014 -1.7533938620246429796 -1.2552743398667853825 -4.8634873969820509032 -2.4940243339076526574 7.6313002667501415033;-1.35439566664534361 1.6424328596240840294 3.1792959100982884912 -1.1861361679326010155 -1.2011593823773001333 -1.5068025350331870627 -0.027862384411536940398 3.8600379518324601236;-0.39527079196820669171 0.58265638083146209514 1.2884050287125010659 -0.36665472498993623152 -2.9158255468663809573 -0.93823067819978389625 -0.3848949573554565351 1.1097861157661728093;-0.31341042178367112259 0.47663273267626710128 1.1267668367711727306 -0.30134238895739456909 -2.1675524007683946159 -0.85412788990607180217 -0.25527826916615931063 0.96782508005261491668;0.17336888597285157743 -0.16175403879236510685 -0.80502516952931846284 0.27480539352739735692 -0.58705016427566181214 1.4197889006909987231 -0.37341107606439533084 0.24477924828057714968;-0.14874692010614593007 0.0051091555841365670146 -1.1982725533711886534 0.33802670283867097822 2.9091716834633021271 0.23507564965624558329 0.78641793483013566757 -1.5522570255089094271;-0.38312004394220633419 1.887279136784884459 0.018850272459713358908 -0.50969774640320608672 -4.0440391912799338314 -0.19213862680749160816 0.37441224633417341527 1.0502226706427109093;-0.060198020083040905404 0.029703152515457784122 0.54418108816566745922 0.027445647753190520468 -0.25751175174150831015 -0.65159187766799475661 0.24924899582621387606 -1.1182076355300878401;-0.28876374716277292132 -0.16502360010994687745 1.2381830363272217088 0.33989216153189633074 6.7349221087642785477 -1.1087434570733003536 -1.8225700890224227901 3.041910194393521838;0.098444060541980418777 0.15149201893028713117 -1.1276482579988909016 -0.20845704804114270625 -2.5608258209948240314 0.27792416817536352847 -0.51711724327865282724 0.14107709003320259566;0.027097974222612113138 -0.52345646625512065597 -2.097315105560290327 0.1408550858562175323 -4.6707509001661451364 -3.5081737287472809506 3.1141712611097429608 -3.4654654758949594573;0.10529083688659246487 0.082754024610720247623 -1.4753326712931102982 -0.35457156560710051396 -2.241521639423475154 0.55332358687476279613 -1.7585902013026204482 0.66958549076153961455;0.14575434539622991736 0.10705493474743099647 -1.6038103596044643862 -0.59982295876812097291 -0.72047227468402685879 1.0108311748500675709 1.8454385530047763275 -2.3519001316514658306;-0.10264011037667114534 0.15314270478080133087 0.70077563827170397115 5.6375301140139519873 -2.0825885758947930704 8.19791726955711475 4.145646334854598436 7.3161196008874558316;-2.7620027006720531126 2.647064257970702883 1.4507127545726201667 -0.18322894471881442935 -6.1299036287429276015 -0.87794559599918464698 1.1598619926645852285 2.1417458105924085388;0.14252379322986216681 -0.14698681669013832773 0.47525107623564799564 0.23309462523994806116 1.0335729314712962523 1.1787053921636956311 0.22577468407286793717 -0.048285342609056376706;-0.13172163812935042126 -0.035980059432572097933 -0.58015052359767371737 0.13622134327791424191 2.1385105290580783688 0.37794164840966304464 0.7345928545466696713 -1.532335913139507344;0.23977400744551943812 0.074161269011810457275 -0.87353753007249634877 0.75094196218627551342 -2.1593645579779061627 1.5708878876230645272 -1.4400709398534898842 1.4908310006307581297;-0.44457404335262790118 -0.67329918425449397645 -0.05175813861164865054 0.5396923793326445784 2.5702119782343690879 -0.53747534661878426654 0.43364990151032101195 -0.46144681828169958893;0.026462977009066121492 -0.52775148457440079763 -2.0379526378296586309 0.11561924515838273297 -4.551138289771012424 -3.4140256230730714471 3.0711314447629551871 -3.4760669924118041685;0.13841161660171394376 0.015265164907313661172 0.95232964669939512703 -0.2647504218556930855 -2.5956299877088255812 -0.31494365346607067213 -0.78925912512954077283 1.5872857206471910896;-0.21402150084395540897 0.91588328860974621559 -0.90817154478536754603 -0.32629620753448096426 -2.498255478784266348 -1.1334684429635135672 -2.0499650529936959131 1.3214151233041198097;0.23111225046465458388 0.1419448163875279556 0.60256171458562013399 -0.025145635523111845022 0.35979296364991347756 -0.73915953349153251661 0.85776349913651861456 1.0356101793131593514;0.22259638073212481557 -0.23455273265751355738 2.6871975280453770374 -0.40483780545484820967 -6.9669064991366775885 -2.8711031311415258216 1.9132586649216902774 0.031860469665645173298;0.08590797027822626164 0.03448182691540564726 -1.0350737569159005336 -0.1962187464027659034 -0.64072005047389590793 0.54291188304564985678 -0.81248491610106232663 -0.040376422398835348782;0.14358695170276264408 -0.10831216302839366539 0.44233949005337891425 0.25663958623489385724 0.68980044738116741421 1.1098730752662631094 0.057772917055380901274 0.21615662612299407774;-0.17402879817959876485 -0.10739487897460532617 0.53164794131375836539 -0.72278784484409341893 1.439120794699555006 -0.80098289350465723402 1.1744716240284069908 -1.3889597399354611795;-0.22273781241954332399 0.029055317549857528209 -0.32659636976468003899 -0.25939859006895693572 1.17664862821776528 -0.062506804088019313204 -0.60751978346748247706 -1.1768200252439002806;-6.7374708853052984736 4.9137912756576991313 9.3227960523315065444 -0.30956902634589872347 3.6339932000292081149 -0.33317443702034182929 5.2760663355352779291 0.33553594521654594995;-0.071722514012732177524 -0.28001860017356627885 1.0771743092628365268 -0.67029841285417612884 1.8256972483331974644 -1.3415778248651781812 1.8981623546235879552 -2.1542978181712855168;0.092135983658903658489 0.18418678023778442543 -0.97816898504455052077 -0.25349611760067408683 -2.7405468564712549551 0.25986571771234118211 -0.20742040676285239398 -0.037906532158181516223;0.062714890553751054258 -0.056288556366852038337 0.90939677909120009147 7.2966276079115006681 3.7220279045476787338 1.0574077813592137609 0.95358275361120770075 0.14419441557083922945;0.10050429783074607548 0.22792459850177071434 -0.99954006580016019345 0.76577104085710556713 -1.7478140003229152288 1.351119457552617531 -1.8141159167003144681 1.9001944101289343081;0.23045537167057603134 0.34305852565463940129 -3.335879990404075901 1.9259020245415707784 -0.64706510148085694123 4.4556203471051230025 2.819347309048092054 -7.4798639225294119015;5.6420703811191934562 -0.30716803653319030287 -2.014228437346442746 -0.62174548533440521236 4.2515179000578893209 -0.092085761834325596809 0.67838484864788262119 0.092005681543074605;-0.16286807315132156848 -0.18663909429678210428 -0.47253031930162492369 -3.0626032075443068159 0.082647743887436342369 -0.73852937107901051039 -1.3079549849339078271 -0.046632919640515399506;-0.25893733776707483774 1.2866393193370253556 -2.7075004907378321661 1.0704172866027683586 -4.568618503932121655 1.6095269247881309749 0.99966913502282972459 2.2784361109926583033;0.18192033717421896011 0.22058025405953801679 0.35854620568267780989 2.275555785166776257 -0.066167543008308293828 0.91076011707874382495 1.3429416751400968799 -0.17382894770624010561;-0.20486252906283070052 -0.054730977918480229472 -0.50013432108312527724 -0.10403906608375038112 0.33791492917158305609 0.53330460985592087475 -0.86136076988169330004 -1.0713494197605497593];

% Layer 2
b2 = -3.8610892708490109904;
LW2_1 = [0.017118165544748424611 4.9001265303360392878 -0.1284490633502204382 -5.8887199545920871913 9.5702163323230404757 2.3025786118765974031 -10.95401200951526377 0.059980384309262987919 -1.3680583568874817857 -0.12413978906587909423 5.6022154519764919556 -2.2999736024269012979 0.89931344700601700826 0.1498984774267958231 -0.10264943679314110503 -0.026642710676166202893 5.53080938974013403 -12.789537064861654869 1.4530310136015534006 -0.3828641474537965439 2.3625345259835581757 -21.858029110984265486 0.14155444954124954404 -5.936207513113490819 -0.10394007615957635837 -3.2300060140646720264 -6.0750591836900316167 3.5860087771049697913 5.850903905484068801 0.013780830213884773597 5.3591450904145077061 -5.2344021819680381924 0.28596712443592137154 7.2144218136542397346 5.252320934095982885 -0.024117146213294620577 2.3245463612034780176 -0.049089222795891708506 2.3616157604053054087 -11.559500373939354034];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
