function [Y,Xf,Af] = ESPER_silicate_1_Atl_2(X,~,~)
%ESPER_SILICATE_1_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:38.
% 
% [Y] = ESPER_silicate_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.0388114027509054438;-0.83178425685057888472;-3.8201759697908173052;-2.7740013616093111004;-0.051088089841863970619;3.3957487842011770951;2.8871857291406120005;-2.3950829050365793904;0.46318354552544843683;0.59896347134482463836;0.92221964387977573008;1.1588213340025133036;-0.58381643605731814439;-1.1355509813833040145;-1.4968206128892549422;4.4803393661919299618;-0.27900657114089710831;-1.3420321180554122265;-3.6929854187891772987;-2.2628832345433487205];
IW1_1 = [3.3461250761573477774 -0.22503213398125426759 2.8943518221452948502 0.69138016751477704425 -1.3332346367698502121 2.4205295874129544309 -0.26804116804161370879 2.0190848291948046977 0.55480996468172960601;0.034714000653494683779 -0.38846285907856076269 -2.3737769963262493889 -0.88035807155419465442 -2.9316935547964551034 -0.60633849270852291369 0.36010569056179736469 -2.8369418052175889855 0.20771822670825390578;-0.16776914396019604325 -0.20039698323838534 1.9515966331170269132 -0.16288438131432819711 -1.2496876043197349127 -2.3569744971669264189 0.014874133719249541322 -2.2921650015083181451 -0.67483285975585016736;-0.31997655934241858722 -0.69006224223354450942 0.27815693259364138168 -1.0370813879354798814 1.535038671004638644 -1.5436172664260847665 -0.20364185667421288994 -0.47302646273861942428 -0.025188655993230182895;1.3797570705018864512 -1.7573794504617010759 2.2480679073885192487 -0.53666486575246663548 -0.51830608456142412965 -1.4263713806635771597 -0.057226218464446254597 -0.22097787290161077789 1.3008600250314727997;-0.29310614604062512623 -0.031726457899763492454 -0.66347600639238180076 -0.61046151626040934257 -1.4082647138913169105 1.7595418237766875524 0.695118755506638486 -0.1951133508141446038 1.2053527791647966616;-0.4401784107265506174 0.91476700312585057517 -1.4031561692567877664 1.3616311643876128912 -0.082016134751011757209 -0.84253553641136602614 0.73398554597218257367 -2.2341279207522020123 0.24331450675757082536;1.7141140665176459734 -0.42137054049520455967 0.86474739313432169574 0.63835735816342709104 -1.4132198298512392842 -2.2273570514650091745 0.20308192565761803983 1.2266336618972946138 -0.58911173083778745063;1.1111136629374278595 0.25107298930876115195 0.30645521751029031199 0.26045245232908642574 1.9839705158522094042 3.5237659666605929409 1.6041034885237390739 -0.89393322160520838349 0.16297326217339450083;-0.16481681517866159092 -0.49295784124308134055 -0.49031653233362776367 -0.76035389144170006936 -0.82402322241673819914 -0.09059378351096927795 0.60397135542682323095 -1.9873210474477920329 -0.53559045954818373936;-0.0043554732618941620695 0.34426034992454179751 1.3426236272278904149 -1.2920319987472395074 -2.7153743582495555309 -0.17959403244115362819 -0.48487436281647738889 -2.9313543943660977931 -1.0443356329362589729;-1.9599699064051687714 0.45092378119002651804 -0.43978725141076419058 0.36621897462771230147 -1.5377972208392400866 1.7042750163678519471 -0.39464326832943369405 -0.10798149657553848813 0.20015215899196125982;1.2503522281985421927 0.64045681536990739513 -1.2242859134198289528 -0.23227603869395960223 1.4178625920425553808 -0.012668532086056030067 -0.4820664942519706786 -0.13781983021269891831 -0.098691864403931156557;-0.15516692512510066315 -0.28391764642751188275 3.1700636061961846579 0.077197204190395010692 1.1539949186784279611 2.4416310192485428665 -0.76426253825190970659 -0.74855682370314469143 -0.30683481094716347215;-0.0039123260201753646756 0.22235453630348228637 -0.34913362659686053568 -0.039423485624777640512 1.4064888369694763526 -0.11844999073379483545 -0.98011890084774244691 -1.5667216174055651479 -0.075849492552276798207;-0.23389110265914198061 0.2483050030912511974 0.35706616838652288637 0.001893667439617404899 -1.0827300141464115679 4.4756107192741447776 0.28597718204520189422 -0.25731657341431812824 0.041870793092034556959;0.71126953954529992252 -1.0429801359665089588 0.17512113796508357866 -0.082293188003017034293 0.90906213063719998324 -0.2055328056835560302 0.011538253234930771068 -1.6213160521006495518 -0.93292383309376003542;-0.77349358491140585148 -0.012169849467860056197 0.20967372925791902261 1.0323498890423130625 -2.1171267031447946749 -1.404119164704576983 -1.8099605223631405337 1.4029450063333959164 -0.96717733075160605694;0.5785336310141812044 -1.0014117487080806956 -0.56401581204282680293 -0.48443468139107914716 3.5427873067933126627 -0.94717989413176528757 0.63128733578971440998 1.1178137589718073475 0.5176798042078298856;-0.82703214507943567657 -0.16551048555333933154 -1.9000811487278403966 1.1903426499857705512 -0.74534684275337437231 -2.94483095010775342 0.94998173718577683111 0.38027715491239955092 -2.1980597353520847648];

% Layer 2
b2 = [1.7395225193676573383;-0.66531953228462314964;-1.2620690829437171132;-2.1126026053618089939;0.28272860991545378795;1.6655969575027378404;-0.91905261038561025799;0.8309005518028553805;0.89415592773796215287;0.34987405918124536708;0.49594677336155212899;-1.3427645548489770544;1.2293907787624687167;2.2252563864414729444;-0.6547078996089434888;1.4570096876323013202;-1.198748941952034075;-2.9153633001345471421;-0.98574651598079632286;-2.7219280449409430922];
LW2_1 = [0.34598682847359835124 -0.11261549337549642269 0.25876344660101924244 1.3425797277027293752 0.3691967567457141719 -0.54308225880350902148 -0.2729656338554348749 1.1238059274150051792 1.0279411660273463092 -0.064695461751307886678 1.0658591084455331099 0.53005652563704031 -0.41992694580192535536 -0.57657866493061327162 0.98713728442795478646 -0.89114162460908619146 -1.4488790420982702312 0.15517512998102059307 0.95786094451673142736 0.31553773180955879685;0.14633513939277159599 -0.70965055795648823711 0.48346357758855013076 -1.1173819800357542853 1.9201654633685636409 -1.2184776199547877606 -0.12903611146801827192 0.34417960272992331738 -0.25522709924182340746 2.5940116823790391187 0.52955707290665732234 0.21584401889622698012 0.43413348966142034646 0.21076895356592398323 0.92210865662278129751 2.3405429709092744339 -0.67798798450308972452 -0.16078498434930907357 0.06062880977070716354 0.64614983909643886051;0.78464471274133829048 1.6385569078241184471 1.8019233961676535127 -2.4556679338800937451 0.7618288960296921708 0.88105909835023588084 0.49699428109799947961 0.75753859207353224647 -0.88570215953269049169 -1.4191425891046496321 1.8429711994800925812 -0.54521064968158383657 0.11592722946552633245 -0.72889145715413328208 0.84051712366953690303 0.96078575931210097316 0.71880385777316946339 0.038249689453641481929 -0.14320640048601196437 -0.79283040588023312445;1.2012747661650602371 2.8679376887828662568 0.098404961438973037602 0.05401688121792174585 1.7801716265138178841 -0.0095932614721503071953 -0.21017474799309365796 -2.1497829242398762695 -0.93772841177707333404 0.70114160817567106054 1.6414305455859619087 0.28001486636049721657 0.61549405700375792172 1.0353897843729473749 2.2149096141927859804 2.1109512425194036922 -2.8546888472471154685 1.4804545500084673737 -1.3734128515181496244 0.78440319525358026542;-0.39552738637069984051 0.18389834387501829971 -0.11592688131350084579 -0.0179777025974550142 0.11672108830278274394 -1.0277421486290470032 0.82769483886198369493 0.50635904265675235614 0.44786059013506085424 -0.8454316612191753455 -1.1814181907628986679 0.35912974378868794956 0.23831926913235057519 0.27392426672480957306 0.96343976274723375219 0.31052832707888078367 0.54770419763766153842 -0.59587081906129857334 0.72322143746243761075 0.50762262467727059523;-0.060780187028539857386 0.97069282458659245094 -1.3033656886553797172 -0.54052702599384050419 0.37226862351622352909 -0.33848917186284399605 -1.2800582660127672874 0.65606613077597586425 -0.66430901385187501873 0.09125951418687892891 0.77098356156253511351 1.0644507957890521066 -1.8459801700291080806 -0.73499729255199430789 1.1407203016863789458 1.1999947235195782547 0.77257973801439649986 -0.044218384531055372755 -2.3122566249559763918 0.81031623463360502591;-0.61599711196745066122 -0.045374737006560778019 -0.66191638667234209414 1.4813500497296760994 1.1197120044983908116 1.2235486269608828458 -0.23518550785832101346 -0.10785533086334092578 0.51856673798554564492 -4.1889327023877234168 -0.58595207006064431443 0.48576760750775332953 1.4767350744860956446 -2.0488227113196884055 3.6638599945026912863 0.071202727952957262092 0.11071172913458536546 1.592641057933526838 -0.42439991026076651082 0.20103721326113713208;1.9657973556542311933 0.33705735104460510243 0.26316931900680279321 0.37867719412773132026 0.39347982778098750112 -1.6680379713067519099 -0.12349881468596550504 -0.68228160938776238886 0.47731572172574893154 -0.57675543566185905053 0.78198989271187735461 0.72128630191482812073 0.15667729905427907333 -0.65692307154128126712 1.0640741005332423619 0.90043773796048787172 0.56867699447074393504 -0.32045918946807949723 0.61507328308313891085 -0.0088535467493043116388;-3.1581604414923751811 -2.1664795466666793011 4.8410960247973777726 -1.3071886157019971808 0.3533438102083732435 0.23586256948723594018 0.1170742593094162981 0.27258220447312497825 -0.09378925496645566795 -0.94320382906236743814 1.1859127659079338191 -0.074422054978700372119 1.3105380380128799356 -1.4171260263882281549 -0.68677881510951055422 1.1618444265192064968 0.68152150437936176441 -1.4918476480834077513 0.88872014751673145128 -1.8318905873447968169;0.69513536153955446384 1.6821620186425172427 -0.32466020510732840343 -1.724309379996845415 1.7570951558089056288 -0.37726673932691823232 -1.2238343286145256794 -2.6864262019041063034 1.2518606539134342626 0.85238808008122668447 1.0080326990833501366 -2.272884607495061271 -3.1281477143566958077 -0.63861788856740864251 0.81537678527689483321 -3.1813927707762919006 0.3642457992029490832 -1.8002336972035368756 -1.4466605818895967861 0.19486507270371694611;3.917534645525288628 1.3211677236479466568 -0.025246525446421509697 -0.76457107266152279923 1.54822986115354988 -0.79206842026274448809 -1.1374870835576320616 -0.37577087224801059007 -0.075311379974054432074 1.739889431907769568 0.78711452347211952052 -0.18299872330585281732 0.7780592052017660798 0.33664735609539392369 -0.094940441848770054656 0.57464885117553343719 -3.3519460746273650464 3.1746980444036205782 -1.282832678730794207 0.46233403348858254089;0.76288786585059065182 -0.060561674535335230374 -0.64637794550289051632 0.94180903461171272539 -0.34364687515150671437 -1.0392251530554073025 1.4977173891970607666 2.3117352550324867799 1.0916118217917620825 -1.7437834647033780833 1.8910305869676062862 -0.91924076570470936165 -2.2125944891252400382 0.11675630920483129338 -0.8747124753240044237 0.160144673736735077 2.2687875086602322661 0.10576297052615174499 2.4534810282660588499 -0.95966555967467170873;-0.26264543094056491679 1.4504826846202028001 -0.91831105878363938899 -0.63899567038301630095 1.7505444507831942058 -0.42681844379927547095 -0.96346049359214214203 -1.3648193705058799807 1.205729447440484714 0.71511235755584923179 0.4547043320871769212 -1.8098525800702507382 -2.4760611941405317182 -0.80583015139269353888 1.09945719519847529 -1.752014794002280329 0.011689797530407334408 -1.1691580290571073064 -1.766696167779489679 0.12202766180306968968;0.62411599107199566827 0.19841124258664380453 1.5127538677380674148 0.10901434028687953526 0.39063939998799279696 -2.5794943930081966066 -0.40854148117267691243 1.5733680814872081921 0.34147718503655860589 -1.2255601431842864102 0.85996215327158687103 0.34678851178244729514 0.6351031075754827171 0.54239422141676907341 1.4458960348675655716 1.4775083171391782955 -1.7376176836570060846 -1.3530039286510975316 -0.8022401473233481406 -1.2575442290346758867;0.52948249025862847983 2.3265029844850331209 -1.4198094724077421347 -3.1088084838487684003 -0.93889899926865105773 -0.38462196017594363351 -0.10248942095525637175 -0.13080250324825895558 -1.0676949411765273013 1.9616253303602426694 0.50173940198967481585 -0.96398324848636340878 -0.98951905329668288225 0.41454738050552714101 -0.59519296828828571755 1.1046510780101101989 -1.6687657965637907598 -0.21179254845307390887 -1.3909005196923738268 -2.5231278364983680262;-0.51545741934878908097 0.80256094257358934208 -2.2238991683610689343 -1.2996080268726486473 -1.1693306755496406524 -3.2653337278170910807 -0.5370242416628077109 1.3796727769537844299 -0.75132771748991433736 2.8322824132686896803 0.49137318759080833575 -0.15569954243860784082 0.65710589017065346162 1.7250524557479147703 0.37560433461604203487 0.46431692444789690599 0.62650387595432277532 0.12956605683298316745 0.15293348032160075656 1.8611871019283696693;-0.16109590470573928456 0.8423494623321132746 0.057989625931813011672 1.960879545297098181 0.38148593681900166974 2.9508266384885790679 -0.78694018421137568176 2.2220097236466958002 1.4610976280861074361 -3.0930268554907485168 -0.15218528308709480812 0.40892934387934165574 0.8966650272964831192 -1.1109169241071148448 2.5483404062912069499 0.29149014446386745103 -0.5682972649030155754 0.99993626660980050591 0.52337244238829783161 -1.4864622542745713485;-0.084440157594412507125 -0.061821666036829689417 0.85031857418623013611 0.13442196244263926452 -1.6998310877116880047 -0.51977782607027400719 1.1105542912422881052 -0.082674391838017072254 -0.47566171798024159401 1.9769577340939419319 -0.10304883935607145329 1.2401216100639391726 2.0023956084656910903 1.5603342678142988476 -4.0784392173367258749 -0.32300950994268506911 -1.0528998361360388802 0.34680264321658932358 0.22656490933991324521 -2.279810313287353285;1.6839694383315346737 0.21357119807527985555 0.089604752169931953243 -0.26587142953826720104 0.19375075565229718522 0.96437501162748495709 -0.23281750393479402894 -0.44489999294515941708 -0.27628747638411577103 1.2267402975381691554 1.1840328695858424179 0.041019971395174666118 0.20127545137521543617 0.033141265853482301806 -1.170888193500418506 -0.56068278717411168532 -1.4646771856534173128 0.43555392327932107577 -0.50419114887368576827 -0.78038639734394077419;0.034784215574960253292 -0.82635448748142625863 0.39315058208001602003 2.8685525359881394181 -1.6672577317126822116 -0.33875095669057964098 1.328472285677696485 1.4149352038266327369 1.1348527658701395016 0.63383559317232185393 -2.8197817965755653802 -0.04902990911002474278 -1.0140366506626155019 1.6963034807130235038 -2.0026229859693476243 0.41247885165720199474 1.0113886936076412759 -0.14274394638890647302 -1.9390295047998844513 0.22235012564398898283];

% Layer 3
b3 = 0.24341436610758221404;
LW3_2 = [-0.068053810260028477219 -0.058608420346138855039 -0.019524431945638427016 0.013555652909053575103 0.11749824352186982734 0.02377834162525369055 0.07309760443145682518 -1.2587798477568572508 0.02483588698234653197 -0.26107298830769964937 -0.024711370405191571131 0.02933776348000441403 0.37343190661185893253 0.021056471348938197996 -0.049087756054624030744 -0.025083018898273762992 -0.083246718457872542762 0.12474934200495939318 0.15868342801767815198 -0.060338957287235428506];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
