function [Y,Xf,Af] = ESPER_phosphate_16_Other_2(X,~,~)
%ESPER_PHOSPHATE_16_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_16_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3999273105668519346;-7.2896348522218898935;4.6266971622641239748;-1.3591658966107129647;-3.7057600106745853807;-0.39273635398930023532;-2.2170744822371997174;-1.8403255462994652092;-8.4991665234763296155;-3.700430437079313073;0.4945156983513600002;-0.68927021242122088474;8.0550782369134275029;1.2107614697830666461;3.5783047366764333397;-3.8724037226413909885;-3.1560849910622885695;2.6322772734862556199;-4.6508170781958995121;-9.1563913015568978437];
IW1_1 = [-0.45333044477138645378 -2.8721739396166681146 -0.30769142922714315391 2.0734483206521163723 -2.8733494173406026739;0.2489168570816417958 0.34496393997839502887 7.6761949870788681594 -5.2384345041707032209 -2.0620763914880004819;-0.71535655823399302289 0.49806138461558374653 -3.8491146903617479147 3.7469020290666144035 -0.22605659253464099878;0.79110003176488896681 0.24776951295964586008 -1.9265492218018644976 0.35608918462487609835 -1.8241470234635732695;1.8285743024924314692 0.053436372892181095706 -0.4343713467183912269 -2.4872815953433180525 2.9312243107703879197;5.4274369325229958605 1.0526158289517901778 0.07011640125015192182 -2.5207612777152057504 -0.57010119504815359726;0.95304013841000800866 -0.033881485951405054813 -2.4264382920424409917 -0.12113306125510110711 -1.6149125696141273245;0.91340770185198083553 -0.070878681648480060251 1.8968868736632915617 -3.132290400495258087 -0.32510177056045352906;0.57451555908819951224 0.36037813822206826719 -19.232661797351468635 5.1012649274662020815 1.4743978725901583093;-0.079445487885322518817 -0.031379067982982615514 0.84524292941614409536 -3.2052192150867599985 0.21746426612966524017;-0.13891117817862330686 -0.034905972077019745137 -0.097381893624197538029 -0.059340176697818040885 5.2198840571346618589;0.37151280705139050342 -0.4917011542348557751 2.1031083139840411889 0.81410069712093013905 -0.16859725285485735458;0.15514975868823716043 -0.3811675863153179411 4.6018315909575058242 8.6045604780958022673 0.73124613779854508167;0.92513608893911858377 0.3839880705417924589 2.2320078969346686115 -0.57977227354141958049 -0.0021729846082285744768;0.42836779186280821152 0.13277049479109229169 0.44552075266510487994 2.2436222690137732627 7.5923760789974803487;-0.30782559470739384588 0.12823039563703816923 0.37073205931253977452 -4.0562464904305413071 4.9508518663612992583;-2.4531852488559158232 3.161278973937847514 -1.2738943688176200819 1.5226157338173458289 -2.1311629946889825149;0.35688525339224025368 2.1454594280908443338 -0.97144372675464851774 0.51018366902419942654 1.7625120630469113259;-1.378797440881988301 -1.0194062299503987568 1.7315212553481431623 -1.1506404865635155854 -0.28857462867961602981;-0.57317206621102101405 -0.025159747720225139611 2.496918874600532412 -8.0918141193114720977 1.8028398848383464514];

% Layer 2
b2 = [-4.0729105874663229514;1.1183639512875582778;3.9269093500100598071;-4.0767843757536876836;-53.027856993663945673;-5.6870461815126409633;14.13526297673188914;-2.5004746465158040891;-15.330941292781808727;5.4196498410345510521;-3.6815425444014135969;-0.86647709220445712219;1.0045508346547149525;-4.7711750892472490904;1.2476046804385005906;0.49350569503028896001;-1.6214126604543801502;-0.71301938186111202267;-0.85536643814374069272;10.796187768713453536];
LW2_1 = [0.061207378760281351548 -4.8385128255413416554 0.18617766109658109852 0.17558616233412147056 -0.24417067843244699699 -0.013683106602310514399 0.44024847328999711094 0.29781198171368344907 -0.2129645051484597984 4.5995824770683420013 0.56490205603679100044 -4.3021210044454205601 0.17596764609843054683 -0.45312052723728840631 -0.2448702316169582005 -0.027476885638931285855 0.27566685120397094177 -0.32231842299265195395 3.9034880143477366232 -1.6215787812684829827;-0.43135780388361144588 -0.10557238859629206051 0.23559434863742026445 2.8210602289855559732 -0.80012621782323123387 0.076602153130716110763 -2.782371929560356616 -1.1748753139756673569 0.69792576569462738689 -4.891275327844427423 -1.5916784808381192473 1.8611474740958628971 0.13153079284265511983 1.5244685460910645247 0.11748613799046939143 2.2788655485702418169 -0.49845405662011377235 0.042917145057307988509 -0.085077436614593826558 0.39656773821759472298;-0.046854930271769477945 5.3103568506550331563 -0.4818353314346588423 -0.068690616281321767445 0.32266187836265858291 0.034609843185219958672 -0.72589206486994251044 -0.26930889733410151576 0.2533909958391585282 -6.0366352854843876585 -0.37375873945733117942 4.5170854940443065928 -0.2306211507147952755 0.62446530797804744584 0.095927179286104335976 -0.12521434668752950969 -0.3852488256754172391 0.45037435424974592291 -3.4298182230352383115 1.9571922061338584697;1.7895078530040520182 -8.3359669098443465174 3.9470768485315783636 0.19948086988708871314 0.23550879799158139227 0.70314464533059439777 0.46733321402810917844 -1.3049368507322796074 0.33556577494813621954 2.6631077045855211516 -0.9811575840265028825 -2.5051956713964358414 -0.89108531707972415958 1.7065401645588722523 0.68468942093039319996 1.5481384376132101277 0.54438561039703259326 1.2583997584154245075 5.7583824655979860552 2.082758043747320098;0.67062088265275154875 1.2717028481366516868 -7.8248807375594768843 -3.7051556434165422438 -0.35880890710811252919 0.16742653216887118384 5.5901355653090778475 -1.7066546150319215069 -1.2582004190939604094 -24.549712539773857145 -9.0066050711636780335 -3.994852499976227822 46.44299674053723237 2.6771736870236919614 1.1393607069156714839 5.9555557686806022133 0.26897409723878162868 1.2127677686871691787 5.6069534057294392326 4.4591980215120141651;-0.67375012898731856392 -0.46914577908385196592 -2.8972707333744205371 -4.4950826735245188459 1.7870202791338674064 0.04894570709241923695 2.2172697704003510033 -2.3512160505446275671 -0.24620907635377134448 5.1958410602247164789 -4.8729934295309309533 -14.049327071431926939 -0.99022023173837203647 1.3438211336818453034 1.9834040830524870547 0.6888574123481410183 -1.2962953404285226799 -2.7489484274998940982 4.0026641713138229051 -0.95080008480536570836;0.6475234474131458251 -0.84397039172915289118 -1.1028961845557181398 -1.5065053635850471636 11.488681190030789026 1.528954164045982056 1.320592504388177435 0.3104398591711830524 0.085957944551437098779 -5.3610453097277002144 -2.1803811008359721413 -1.8610049035176687848 -0.27637689915610275104 0.33672382854211391212 1.2494972090429548039 -0.28712281164016251189 0.34829736049742043846 2.0683491125249000575 8.7103057262218896994 1.9441723444279461752;0.058710626333894261331 -0.99565549773130845868 -2.0175444306057297439 1.5541852686893780078 0.60380450210940395106 0.25898960791311198548 -0.7742735375575303669 -1.0202041067775824423 1.3751339199415359982 -0.52295077168488657282 3.5769669983801781754 7.7482884415815140855 1.0613505699733449816 0.40746698921490537293 -0.43883992099985036361 1.1972980294670327872 -0.26112214499900188169 -0.24689613454603936971 -11.775919483100819818 -1.3644257546998124209;-5.9734455639950896355 4.3085599898882076531 3.4498903380138683517 -0.41736165323145096862 0.726007539109342237 0.50056185662263452674 -0.30876041868343923058 -0.90349853577993632925 -2.360895192294401479 5.3517928850052252088 -2.2376186887114442037 -10.561472681224296721 -2.1465527688210519486 -0.99787820477192479274 2.2907624123351313372 1.0235544424188185442 0.028042582307257604701 -7.8419450845003337847 -10.537625324182370079 2.5722250187793229692;-1.3835538172039301141 1.2688495899748439832 3.3406305814438628232 -0.059214099344040670159 0.82575634099101802299 -0.83155463538116780597 0.0066730155857071685524 -0.10193244847783160256 -0.28635584481698189707 10.821669069071004898 7.0726404121191066565 1.87890648833766849 0.84629943974393728734 -1.1471827487491756958 -1.9411025638742489541 -4.2938294072704996651 0.18592411190756477635 -2.4170731306915387293 -4.1690539806235005216 2.188784424108064286;-4.2777192938526695798 1.0064742186868596008 -3.573139257289954962 -5.7484729589351495349 2.8246730873650260918 0.43568583136622512919 3.8911387264311088074 -3.7814603018352377362 -0.79188655521246797964 13.070886553775265426 -1.2390012695534606824 -27.360942453704318211 -3.447811906221672551 0.75306679656867692163 0.44899763740253467725 -1.3336994619281363761 0.07886225704049934504 -4.7160696996955433491 12.405614744745520284 -0.081286630817154759132;-1.1292862252266897549 -1.1809971035385837812 -2.3766145448726962996 -1.4085381786481183664 -1.0011414794638304748 1.4316603016220168509 0.90444181062270490035 1.0085312555361638509 -0.064105848085197411623 -9.5065869950608092864 -0.028166967042661070209 -0.61881601247209916394 0.86316497683665449614 -0.29618635500080225942 -0.62629075856345906015 0.4567651311437256334 0.14173750520470154712 4.1520280256856896273 10.090803296261194433 3.5417164878137050721;-0.69879286572388310539 1.6733021126008360557 4.448049792363292454 1.1188020785082588571 0.067224160888830250538 -0.76314242541059174041 -0.85583050439703844958 -0.93603760495399201957 -0.022550001992335103052 8.2811794978340529383 4.3041927794606635871 0.54914874392111112655 0.64347436361810639305 0.40681817324138119796 -1.7394216257480576981 -0.97150943789707033815 -0.23879041201875353395 -1.7381242982002416131 -2.5368386359171211097 -1.4034203371023239448;1.8582528717275299535 -3.0684633068755262642 -1.2089587686333020944 -10.054647209905221317 -2.8187168952680146106 2.0620772203851620574 10.893878041056447969 0.01665421720548600909 1.7753629940314621383 -7.0475765963132719349 -2.1224847073539785391 17.672241373517596941 2.3410261485213590404 3.8938891980917884617 -0.96643027880941612118 1.7300104491136609752 -1.5496861246888127273 6.7812786906584134883 -9.3598175700592971538 1.9724960397877078222;0.67491132023363142878 -0.95904815196395332144 -1.8917741381197235029 -1.2440317772348308267 0.050712755230871181533 1.1485975569457125278 1.3183727504572295697 0.68444659751561287564 0.10128992812121946632 -6.1112603529202784713 -1.0684875386763064142 -0.85495577830636770855 -0.39036477246847262057 0.22656191891117888337 0.47842371764019281377 -0.034562992862394593951 0.3358732782658878091 1.975990394965711161 5.2781713731569892545 2.0264292251929414412;0.17695290961094956028 1.9740561799467548632 -0.33705900030715935101 3.5914260450754200704 -0.22949166077036806111 -0.43572270666020740393 -1.7147165012055913813 0.99181307668331930572 -2.2910655807317894528 9.4976642574519232198 3.6686854752090547471 -9.7961797285059191154 -1.9350218071125835362 -0.050210723884955774099 -0.46752802195929021867 -1.8616609513767337081 0.9939379319209425967 -0.40153951070998106232 4.1091222734197385691 -1.0228198610364738208;-0.057052924198502129316 -0.15690458096275480826 -1.1513396314734176684 1.4535204330133890682 0.28269319242866464137 0.17303257895193618898 -1.1157297672787465093 -0.16954857492272992769 0.99332217723888105443 -6.2453340538580119912 0.79646669881225395926 0.57250876830973207454 0.56591302867751569483 -1.0595799199774633692 -0.50877776445731137667 3.0351999161422926754 0.23906246716365203708 -0.013366226896618215586 -3.1248808238883372113 0.98397880318038888348;-0.7725773969712924627 -28.071534657368690802 2.0797060236502580288 1.4148179247795913405 0.052034885156637053494 0.73662343845035660461 0.44417177616439629251 -1.1855819729622492087 -0.15395345881190106163 21.081287791312401936 0.90146656238534883521 6.5955789582618216116 -4.1985285005266312908 -0.1707433239756685206 -1.2556381162606495838 -0.28226042878130014335 -0.63438338405444549828 0.45607425861573053227 17.247195809719588766 -5.3763748986249790818;0.39960327561338132574 2.7274207503705945044 -1.1005532451338226885 2.2338024401846641176 -0.49598131338302620108 -0.47542751595528648378 -1.3273679408508292088 1.6743285175919138119 -1.8390409670094303163 0.17542338222442949158 4.1435316874539411813 -12.426390609197047965 -1.603245244230652844 0.34165746329774754342 -1.7639866598761102523 -0.67908723850107266529 0.56496407850771379611 0.85753212277004831066 10.298405389819844657 0.46496729261909169884;0.43327786943239393613 -2.0839003592956948374 -1.7449228047990201773 14.819655646738770116 -0.9868154830353360607 0.38670580161736700653 -15.806449835209026133 -1.2256946513942652555 1.1809183111995260607 -4.34887041413010067 -2.1295231448700642218 11.216566604119529771 -1.8533022546029331856 0.51098518212967947161 -0.881427149667517007 7.0398453986245499436 -0.35247208690202264103 2.4742571437312950167 0.16916103536959836706 -2.7634142720133190174];

% Layer 3
b3 = 3.7149908277609720031;
LW3_2 = [14.514294469010083688 5.3998421565804921585 5.3012144136165559871 0.43749766487566799089 -0.39892030417316487467 -0.74843328400566766501 0.78597011827802398809 0.14351167623775609727 -0.29902759763774283686 0.27581997424857218615 0.38450654567312964049 0.40223462918393393384 -0.55075398473176528924 0.0556486787446823436 -1.5466192718270910245 0.60376160032763215302 -0.27129837682924917708 -0.32013133139657451443 -0.86976770113427182007 -0.78627050610402970943];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
