function [Y,Xf,Af] = ESPER_nitrate_13_Other_2(X,~,~)
%ESPER_NITRATE_13_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_13_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.0758906940605337255;-1.5992569630538369108;-4.7813131918943279075;-2.622533751332912999;-0.8737477150624370914;-7.3085138376584204423;4.0685616225943297408;-0.39589855198819001725;-0.87297523299986312662;0.92437376419034800179;-3.7737774097043335075;0.20816838358691761024;0.16512557036197481053;0.50804755929570288853;-0.3656863217912787456;0.48195841027434543902;3.179366619139193606;-1.4953717393095895538;-0.88637004888525927626;3.2469907963251229965];
IW1_1 = [-0.030813461278416803824 -0.2281668566768682016 2.6532390516324464436 -0.18796790329763465865 -0.60580115722826100022 -0.76488450486723169597 0.86014614063045724546;-0.067971591305397816019 0.86570106069950314431 -1.074966414151397931 -0.18486026109322162281 3.2243180837797384974 1.0460500505835599316 -0.64436520292517918129;-0.83191959093298051275 -0.52009685609356492986 0.41552186894682463514 -3.057707385168314751 2.4311816360378029067 -1.232753436688878157 2.0703837108955540636;1.4690472910299288145 -1.1087934977393110181 0.1234571158704873689 -2.7263456558271608188 3.4274645948096638115 0.018150716175809475383 0.36890966377758049877;-0.10526925804806355758 0.031042878080818271658 0.6778097606995838742 -0.32015835656474533888 -1.2732536149946005466 -0.76038629509750466084 1.081104773025898691;1.0284913855986232978 -6.6015529614161767569 0.275460622539196065 0.131088146112691456 -1.0892751802939066863 -0.1245513803677180259 -0.71826994095900065229;-3.3619498305757815615 -0.38702314999232545478 3.7031083579319963306 2.312157093997651014 -4.5475884650638827011 0.37259898305389171913 1.0314842831180512928;0.04318182326519141162 -0.095198188083603599297 -0.9108672048649699704 -0.32649029346761593295 -1.6065968290895467074 -0.92264181392797439685 -0.12519993010385158105;-0.012087080140349764842 -0.1732964210600059507 -1.9058337917587189203 -0.85793894233463652288 2.3063946054556345722 -0.2443297103816644833 -0.2596396822511033986;0.088196163022416035338 0.082112438134895771036 0.57711685377714350142 0.39637766536238799864 2.3390023892471631939 -0.42742261905645040354 0.59406592151943138358;0.031957761753966362761 -0.029252534466684680658 -0.14133801015338093299 -1.7705602447071413508 -0.24014118310765866782 -1.4795047742694722448 -1.8470353385882423147;-0.03919017064340709483 -0.091761661859114343476 0.49605881656964823101 0.0055780346944143428117 0.67974362486981287912 1.4927008602979892071 -0.12583736877354206873;-0.099132003496499684903 0.44851961773126569621 0.33982790503842325025 0.20287001196743947862 1.8318684141757761719 1.3778528700093339854 -0.47196454083057226558;0.76283682946226705202 0.10448159691828366735 -0.55513038858158869626 0.47861861366136748686 1.301370533748703151 0.0056832446412828554333 0.60672972899955612824;-0.29361393419924247672 -0.13244222450386808343 1.4998224259474037812 1.0821716247215744655 2.1830878228942856012 -0.34780535624015240792 0.060779420611796364238;0.016575482809617025221 -0.007980334962438552851 -0.32916418275822778572 -0.95433660122339247778 1.4280237342655806021 0.15039758748268033939 -1.3544697735997215382;0.25965918724853009891 -0.074380783802099670332 -4.0628082997523566888 2.0911897234209848584 3.9591972243126196673 2.0178971497577298244 -0.30990909303946534425;-0.24338254221315147596 -0.090757993309245221791 2.3525492240308039094 0.50378152748108140369 3.5479382534504781965 0.83197310225653786642 -0.25237245048235928957;0.26817831468790603866 0.27878067711450799093 0.59992637042239616019 0.14634957408538701307 -1.484062827788938943 -0.1647080086538845467 -0.19661675138355463877;0.030747759598010310916 -0.070437958924878460443 -0.60298215205769212233 -0.22453422990541715976 -7.7238114105545401245 -1.9636232202639194444 -0.89424182481278802204];

% Layer 2
b2 = [-9.0027261737872699143;-3.9178722745334404465;-0.76075584903196702413;-3.1338300217681651638;1.8137655702261181734;-0.44697910604968205117;-7.3231089178764170455;-0.74386973271146716868;-1.3603410462014016158;5.5509522330076084273;5.4835151586277781632;-0.84505419793557434716;-12.503919205975345008;1.1822338023306973032;2.6171227659131708343;0.54572099510240634768;3.1718069658605698713;-0.99087254518387846147;-4.6940815513510552037;-7.7421238392176530141];
LW2_1 = [3.605416442516037101 -1.9455265527426781613 1.2373713485075394924 -0.16703443926730768276 2.1834691290591896617 -4.5312975948450580077 0.28042775133052522119 7.0310717077703053235 0.32859020283288437048 1.2512939870085930671 0.13796600957599355897 2.2300756213534449479 4.4422032627320842124 1.1865921903307730112 2.0123283755435004139 0.43583397869968276694 0.050593439914699028792 -0.28193384284471750822 -0.4310808148619305058 0.70850560863677902734;5.5244613478715498545 -0.62217783419560546143 -0.2114051554537361155 0.11850589682816112247 -1.5595229764240088333 -0.91740639323036710095 0.42373245942162757194 -3.7264673627821163215 0.37562734573458139709 -1.0834638398025397965 -1.6112009204377997218 -2.2492946040756587323 -0.38311905928830325418 -0.75082833030507012406 -0.12592437675645160033 0.10285972548506780444 -0.83814143098703142165 0.57126042300460899703 1.255665668666380963 -3.4202920923247202012;4.434935027071927216 1.2085263225117008901 0.011437713631454578256 -0.5641570581790161798 1.0002670796659263175 5.0444509346996824206 -0.91475881136120784642 1.705798312096995506 -0.014051071743271137393 -0.38443179586241499335 -0.0038887608867709533289 3.8610226070012063637 -0.37795500554151884032 -0.63653830295741864465 -2.9779402487277386591 -0.76114027453599664153 0.042586099995829296283 0.46520191714397862714 0.9148957215672767207 -1.0727137476066932464;8.9208173119209561719 -2.1700168203633301012 0.19735789253534793963 -0.16829904603044071321 1.1565178014122086125 -0.11986591977218406802 0.36520945507325219825 3.4798365252872813791 1.3051932366219107795 0.50053516655623342402 -1.1397549222417779902 -1.2960823417330313845 3.3801721535979472044 0.10877403289991330326 0.57034701526892650492 -0.81225574947800538439 0.37897014056111882896 0.6503434991160579326 1.8160731826409761691 -5.6648768501515283091;-3.3535447287630093527 -1.635496443398344768 -0.93654226239581417346 0.91356126272594795346 -2.2811928690998790614 0.8956217119809214422 1.9294419796281983004 -2.8867716229210800272 -0.0091408580683257426025 -0.91347143169659739126 0.33125719083818133681 -2.7733755678818847734 1.5720182562202036358 -2.1943962069636557821 -0.12265191719118627434 -0.24219245761653335203 0.025626256438401509574 -0.68173226991451685297 0.83283144594812230643 -1.6518565872483532697;9.7977438129747937978 0.17507337539334014154 0.035891801578715173959 -0.061163243302530909129 -0.23908599693999946223 -1.3098431173453357612 -0.32733012000249261941 0.90074418381592036287 2.0933392823424155083 -2.1741429790443280723 -1.9258143014501709622 2.1762484377869206753 1.1864602115158395801 -0.043158344525601549657 2.6539633173357390916 -4.0606705939339269307 -0.60683213470323993377 -0.70477620097615178985 0.81115722583973348669 -2.690417599092880252;3.2796527689141847794 0.28702102311285876413 -2.4444884153331742915 -0.14764202806441628635 -1.0263996796915826337 1.2584184632615433852 -0.35340752025334121189 -2.1241430800481073682 -0.30844588168155384622 -1.8359694704423783485 -1.0755328319301875606 -2.1188817087227262981 0.16808930285706794039 0.74571148489855010322 -0.011965554218546690934 1.7036402236951206923 -0.58691667034535743852 0.27524953361914772376 -2.4885895561934603393 -0.79682003500309606103;1.1335782126879323517 0.24704924406909803403 0.51637669328964619364 0.42585875203112261156 1.2667637094694774724 -0.79137296030097703525 0.34020458650844148663 1.0045332333615173415 0.49323851172908650398 1.6489608372004551651 1.6895620572644012292 1.1261283135548163514 -0.034398022106498934991 -0.89311251609783759431 -1.0406266964688000165 2.5301302609338356397 0.037151390061657352248 1.9389476954025339772 1.31301740073277462 0.62188887136468729011;0.65722599260862801795 -1.3723921330831609922 1.2841878803041744117 -0.22202880794130774866 1.55324718337845602 -0.85477366817167521607 -0.019128029137319636083 1.5594037272416332307 -1.2243203909163058452 -3.0012681071533400257 1.9145488105062538065 -0.88369106467806435301 1.8826991107027046812 1.5545225912315354666 -0.12858042208594502864 0.30206650042340427165 -0.30718058927392405399 0.5310673397690386377 -3.515404179762097403 1.6607991578423551005;-1.5906986503004461042 0.15543365473424439194 -1.2370188700182429553 0.43371411093696515815 0.21023367345941587625 0.30728218760810305232 0.14211756658135069054 2.298689405369835459 0.52646024179155537226 2.8340076092984345379 1.9332910375975413952 1.789184511212918105 -0.0024919020661151296964 -1.9771059211585810811 1.8193475824234595084 -1.6432294885214850932 0.60253607072067350003 -2.2715016563109258207 3.3871678481795948201 0.034216582235088027764;0.63213499396084493753 0.90681206183004137156 -1.868371284367948304 -0.53128451900132045438 -2.8560768622203784872 1.3544572870304301127 -0.17262675451153811079 -1.3895945509639167081 -1.343410573995532209 0.36518459062800895376 -2.8201900000586057615 -3.6331903440381854153 -1.7311880097608447482 0.85986315261862211745 1.2525959113752993535 -2.781756404030048202 0.58731128658189124536 2.5669476232455576969 0.078561930061659415725 -2.6267364478275734285;1.0506556632556007802 -0.58805253076342600682 0.77834228682387940346 -0.19962805228460886453 0.8712673383314685216 0.30655991218349942784 -0.037122638403377913874 1.7754589666692501826 -0.95862697578270517074 -1.5741035956146225416 1.4572822565146761331 -0.049278186582688163209 1.1854817441208873596 0.94560743862575113994 0.50883297199246624309 1.0755191122604590426 -0.04234447793307796748 -0.31501606975475526795 -1.5198087770333426061 0.88612508702787351478;-1.7753852030588530564 -3.2493595820983496303 0.27318429460502602346 0.82953810440220387967 2.2401541034351972748 -3.5634326379521814587 1.3449088063968925866 4.5436526377999371107 -1.4682725462999566268 -1.7571533454094492299 1.3732964912815486258 -0.68172204866618768548 4.5467344311973487692 0.35683149271445502304 -4.5339558279505567384 -0.69796869853813692242 5.2284523729539138515 -0.23506221383797890057 -2.6509719898575538899 -1.7669532779211925;0.42722372626203070078 0.137403094532918435 -0.75406819862970220214 0.21573768689908498497 -0.7498438368625484074 2.160049878062144213 -0.1232264240125021254 1.6516845185672752727 -0.3682909698679583399 0.52269359366957612867 0.53334931957357945009 0.53563957375890636214 1.0234643629853861224 -0.51522426345659466662 -0.2288775279276727137 0.61199151979745325391 -0.081186977617978411947 0.31446564920929448439 0.49423103398597173497 0.091920646355850330056;0.075531398897911466994 -0.32099609544942420136 -0.69889081641152828173 -0.37407088819629730203 0.41629759468184668325 -0.35157402981295576838 -0.40685606901377319167 -0.72653424963304769069 0.26677773186125974814 1.166167905831362317 -0.047359521336915809397 -0.43587562927474593488 0.62997273337432746487 0.77902321044707445452 -0.14417450649928553741 1.7800951361268861906 -0.98194474485023197641 0.89996066128455620703 0.16906599247689116372 -3.4971240644848746726;0.42555368331330672982 -0.74794368547805190062 0.54984319184381091894 0.1713980530952378678 0.85617393812280173648 0.75057326650138977975 0.012341211374305403881 -1.5609431717295267905 -0.20652048921900240108 -3.4467964834531348295 -2.4342333417866259815 -1.2040252371695665534 1.4919610227725563778 0.37023903016935166832 1.5285473737546322326 0.77044164067279907737 -1.085775781717767341 -0.046900469189725277341 0.24627446102178207621 -0.30905218326802263995;3.1987709744305319326 -1.4427580258853880402 -0.94573667798711369414 -1.0775929093804370584 -2.8285291315647742572 -0.85931215399961946577 -0.52429415788448063829 0.15178407828688678105 -1.0854501431226368791 -2.5748926655473733938 1.1287053731859475469 -2.6220006944316960329 1.467597942125525412 2.6410670124537736214 4.4811145671057452944 -1.7485217093601232996 -1.826602782810179848 -1.0449929703894174082 -2.8362716294831891162 -1.4415789026369845161;-2.7910823732028129385 1.6494374337408239661 0.7417813642799946372 1.1058498269747751852 3.548231361146014784 1.0797667004776803079 0.32096339003570084625 -0.94872482320366491315 1.5447108705547922813 2.0611235918253254518 -0.80558298930478045019 2.4112662293364652832 -1.6882946412143036152 -2.8119095451169107136 -4.4295791131233421822 1.9583306368011881293 1.8667580288286882428 1.1022127999989248526 2.6218066262134707145 -0.28644496127515239881;-3.7997565953706660125 -1.7891322357132002363 0.84316602887684755085 0.23267696830112710726 -2.8572179999532409944 -1.4013567135450020196 0.42241801688125119041 -0.18311921400678807248 -0.41151534858261129557 0.24332172328292472896 -1.751080971445809098 -1.8295784961503032129 1.9681131810455783082 0.57054789026620333914 -0.55316250258713373089 0.7486451684695187847 -1.4072680217660344937 1.2165182356317829626 -3.6387354487523486668 1.4953296626479735121;-3.3037215982140617498 0.93226002167698096557 1.1967741277352692553 -1.1206174529474723922 0.61151955120889822659 -5.9793001699741150645 -0.068990161467241420401 -1.1710420061533670655 -1.9242758889706519376 0.13362393766736946343 -2.2074218283808257901 -1.1747459880743549299 -0.19517586689629523589 -0.71915305413520946853 -1.194263103740143217 2.7252407042642849966 0.085632292033744339399 2.7430215845003247388 0.20433459809584669786 1.8898317274046136927];

% Layer 3
b3 = 0.33105226940566950811;
LW3_2 = [0.21474800084093281782 0.2456511597238446587 0.17711377594422253456 -0.1110322923870197126 -0.11695836552618306403 0.22495486914452833549 -0.48118256522269070574 -0.35899778095984657966 0.46808039116900085341 -0.44028871047597145649 -0.069311799071682805851 -0.85947782727901567146 0.21312326324328925709 0.44485475117149669844 -0.13990495094685725941 -0.24876474789763833306 -14.916365502323410297 -14.754233986620558738 -0.17548519490693995082 0.24216210017873593396];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
