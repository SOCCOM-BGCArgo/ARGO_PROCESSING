function [Y,Xf,Af] = ESPER_TA_11_Atl_3(X,~,~)
%ESPER_TA_11_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_11_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1778808064454686644;-1.9894688830310374161;-2.0590235503452523069;0.24807640915077469601;1.461591088328882293;1.2235098210410870756;-2.1564409282616057162;1.5281208061034334822;-0.49900554076087522137;0.64850870371042079743;1.6140787927902315868;-3.2444411446326619775;-4.1768608840990246733;-0.10291950426183428535;1.9675946306141651743;0.22188927997323731889;-0.69777455793616649515;-1.5778481597918936341;-2.0908606480193991928;-2.9135474463485619978;-0.83130240172847225111;0.68418727549578883806;-3.5514336594440063521;3.2893803999086812517;-0.56878508419757145553];
IW1_1 = [1.6292904013262994312 0.70698200753031414934 -0.13599214756784247515 0.20662224667751274976 1.4066834483443775294 -1.1251507941528160472 0.70796321108239224085;4.005534969236808962 2.247747040798214524 0.51397266097499905158 -0.28205066987886379115 -1.3138881025879347586 -2.1632725125232368235 2.2067051518464224635;1.0296531900958860728 -1.9427970109547747501 0.31748189884056815524 -0.21639747995028721372 -0.90298367790498335061 -1.2984974194623950527 0.64564827553048287356;-1.5655140042105459841 1.3271580612051263603 0.85351027232502396647 -0.38376068281939901272 2.8125997407160889807 -0.50109300640982257224 -0.20945693998694495108;0.066612946614965265479 0.39951781026299143518 -0.050994530581660618695 -0.17796354328685679014 -1.7115315141125497789 0.4441968320126944425 0.49340510611866061907;0.17901482385938621844 0.79665681170576752024 -0.79402152088188293622 0.053490578665246660273 -0.46862949712832741023 0.23122875497171471726 0.016246462313854979909;1.5814497316004481053 -2.9043570285015061216 2.0526248822107779901 0.12877564893493817499 2.3610452993150827794 -1.3135609102398830839 -0.82481512786245492208;-1.3898646221681392188 1.5511251793355547157 -0.65186599030926239973 0.3266791500306286955 -0.9205686980823173382 0.45800745903355499777 0.54755816985783734019;-0.71359845896197049431 0.67328031403315535819 -0.33574611237012297327 0.18211913569371263044 2.0553450102740944416 0.14381708726470859849 0.98364022944666851256;1.0884610145764346267 -1.5865504583063538835 0.83045526629217836234 0.60098236394100457147 -3.7570556947688147353 1.3383516001126412043 -1.7192643819302093622;-0.48803079874552218742 -0.24601063202300529897 -2.2093873574707947327 0.60366425213487662216 1.4575525678001646224 -0.03132429996006114159 0.94760478517969537471;0.22466804950302629584 -0.015552354347103317447 -0.18656795455058003408 0.33892809993344602537 2.8841895613296504308 0.17968060938208427202 -0.4930993274064187637;0.28096413689646448919 0.20555405137920024217 -0.86221619825185258357 0.54331132291605788165 4.171346097456870794 0.59273694519813624471 -0.38419980610508530638;-0.32163244432393273131 -0.079996752675074084271 0.19234419916747494406 -0.038245766502682042309 0.53707061103555298054 -0.33203204870736424681 0.85268992074070848464;-0.027578541896256754395 -0.49750627029310079408 -3.021343927651878758 0.43763788393961067236 0.91677236019342367435 -0.22268740007664808433 0.43437040745214727799;-0.34854779316596695704 0.92978765353294423601 -0.63400561427943546988 0.19209893787725867975 -0.1971227389214045278 0.69931912122501049822 -0.20360372026979511872;-0.90811109944045909081 0.95041209058610842675 -1.1206074938744212677 0.23629726207672813176 2.1207401254555651171 1.1660411726106618691 -0.14967406566219434993;-0.20866669615503186108 -0.56311276587027880858 0.72615771913679205696 -0.12363100622623772462 -0.85556295421646810784 -0.30013659875287190815 -1.183034487301810822;-0.45574012168447386451 0.045838586091579321125 0.67853408258428127287 -1.1743503517950339976 6.4347936020402567436 0.067055421994326569468 0.37238446649984929815;-0.50037707391628805098 -1.2642588730878168146 1.392079178971894482 -0.42291923662087910207 0.011770730386882137519 -0.912088473748575157 -1.177524641626136459;-0.19950690374787943826 -1.7251034061652517071 3.6643367868411096389 0.38192043335426772988 -1.4300214734662686222 -0.4153506844291303679 -1.3411396305939029538;0.79110145000101705914 -0.50985436339876166745 0.43623598732392920851 -0.014459287622457552003 -1.5914017078319453447 0.80422621050799558695 -0.90662339997775520661;-0.6857923306073636649 0.058855530074537892871 0.88295035942903865589 -0.13310826199112194002 1.4966291324658136386 -0.82849677112419495284 -1.0479852205605622029;1.2850355896918530529 0.27735917384380093242 0.32863740074942149327 0.52474635596654484182 0.66207612169766738575 0.44405121222427912375 2.1295787615559511607;-0.26226303013195967351 -2.9285035029617434432 -1.5080213232579140481 -1.7256245532208860372 1.4326128606981496372 0.19895537414976488533 -4.1202154024638266705];

% Layer 2
b2 = [-4.0904541066325652565;4.7983906000695606409;-3.6749874323039564139;-7.4779414870006197802;6.8589565899923501391;-1.259529027648661037;5.6566519674558009001;1.4361335708148099677;-10.672354269105943203;-2.0039769326197496291;4.8897650277507258565;-1.6666920136045000334;4.3047621379392584373;-0.45812582604414392451;-1.8496292443865360866];
LW2_1 = [0.90281401383934023475 2.4062127461170144116 -1.2338924236807871093 -1.0917495100959930809 5.3657316628092024402 -8.9570894500593176701 -0.39220219859288540931 2.0241901434268405602 -0.8724935371826917363 -4.3206613620324283431 -2.5132557147043397272 4.3787841710814419116 -1.4921064037225997279 -3.1187403972891578618 3.0134924381467538268 -6.8808931499034615697 -1.2886533513655373806 1.6133765270186668506 4.5793220905189624403 -3.1828881865131881668 -1.3388980635156650933 -4.1753730773664861076 -1.1820521807652151214 4.8538237208168899528 0.91006674266032816512;5.2176264743280453828 0.24771385956923236416 0.71937994222532786193 1.7702330829473162943 1.5691551262309437753 -1.0845597534811197704 -0.2785463039127365481 0.17822828866397255609 3.4468274896474793145 0.087826894297189483929 0.19106632004779083855 -1.3353243232209925928 -0.97858957969842186309 -2.2867210358723077945 0.38259150947828263201 -0.92705723094818082153 -1.6134259321348214389 1.0126261006982824053 -2.7787471789840156866 -0.8128471295177290834 -0.76788306112754545207 1.2765283094408175213 0.46653610080411678229 -1.2612623465169829906 1.1715171741238921133;-2.2837361985218835869 1.4974094656193228658 -1.0196463590829347723 -0.24781987801493257639 0.9441264019991059131 -0.61703809624821037705 0.60650795281768954403 1.4599362165058893392 -0.77095019426772293247 -0.23991709734496868833 -1.4182507201142853237 0.84143062595186612906 1.7254928116272223448 0.77449834027320130225 2.6700454598649945304 -1.0857213349513985534 -0.55521822371711093691 -2.2761222659137425595 -0.13314379222676211989 0.72723955854144273214 0.079314485262509046293 0.36942323840945279212 -1.5116486660011883014 -1.6863907003163789433 0.29224962054448883064;-1.751536657365176719 1.4751153008321398197 0.25777217700393734168 5.6026306542597339444 -3.777387383575672164 0.23131651501180461317 1.1915486793473426541 1.7615901433180234381 1.4474414747760457889 -4.1199798033478387538 -4.6686419021541638585 3.157081268220640613 -2.0218287043363409872 2.6889436317684576316 5.6389672770783194622 -1.8611478152920548634 0.589027561913153197 -3.4969818776061423193 2.4845367605280399559 -2.4924399630211326873 1.0712856735286351295 5.8631513044660215073 -0.51090390757291159751 -4.08670133304736094 -1.0079422211424320377;-3.0107643967022323928 1.9203761244542583153 1.2909033212857468076 -1.7770770581154711198 -3.3938352991325166919 3.00704407328885015 0.91834150159961658311 0.77996838579457228313 -0.70018082725859620563 0.20739199317313644633 -1.5532093350090152573 -3.8877118159501558026 1.6349263082338838515 3.6419769655007216969 -2.5777253721916175699 1.3279417899768108935 1.7450871758731270056 5.0008775295300189612 -1.955750935696211501 -3.0162336263623243937 1.0346245803216065351 -0.45818273821075528041 1.0103773423814974564 -0.24484430278549695892 1.0404948175724384463;-0.35184830424324925469 -1.266666203940371549 4.9995154653767261976 4.2919865508335055537 -5.3080713843178868316 -2.0044131177274948641 1.8889741898090910421 -5.2868790708288004865 0.75492244797845009519 -2.3997702294154659164 -2.6501123912339408228 -1.3222718309245895529 4.7319989002696543068 8.1081102189084592879 -2.5457557340640164512 3.4526286729356239213 0.15468499086413131649 -0.19602818057012541542 -0.11158442332023976729 -1.3921107675715029828 1.031349254700428375 -1.563621061289109937 0.24410765512965706958 -3.1820640216264641786 3.8071005482487274563;5.5121718501527077194 -0.16114050905159990612 3.7724788887131763815 -3.2302873080004719242 -0.29014141023813866394 -1.1514657466956690346 1.264427555816181048 1.7891654058491937018 0.73194134853172665434 1.2670951324471435573 -1.988564748807109428 -1.1335427948122367425 -3.7906920843395521814 -3.1587130021542861869 1.5528337470074529136 -1.8716638413236865723 1.3383119151488036547 -3.0651063594338667784 -1.2765789204503066312 1.3743707925497166134 -0.99125868015220575113 -1.378187831073921954 1.347485236995089819 1.4607043212244514852 4.588533517296461639;5.8379197634271546846 -3.3548430959019812647 -0.87202269221370798391 4.8721368241854055015 1.8558702593779339285 4.020414381189723052 -1.5594758590845698709 0.28343829110911433755 -0.22906395333694509753 0.9381573813746020285 2.8559332391998015765 0.52988886799668222238 1.8678274663578102732 -1.7839386828287937536 -1.4064978211128382757 -7.976221962079505623 2.1771141791321966252 4.6696871716084960013 1.03774589976379783 -2.1401264332720604244 0.15803813384914983109 -1.0865116324718642193 4.1674968841830173361 6.5863886381975138562 -0.19382939726820133663;13.426465016121133189 -2.808935615071411096 5.4450826275893184913 -3.303516430937999182 -3.6228608879882115978 1.0689526663353290381 -2.3063614276038499895 -3.539776203491050488 14.671838750070753221 0.83398888293441852948 6.0526695635467335777 11.421966827239527831 -1.9047022566468561067 -24.778005754681384332 -10.959429734261334488 -10.584814101517251217 4.9773168254014938938 -10.978069535577903437 14.049556207166906674 10.115456609675540278 5.8719844665800504657 -7.7414155294593376411 -12.132366539270643457 11.260782002305807836 -2.0568324516340905639;-0.98108860436359002222 5.6197760362484387997 0.16666237582321133393 0.96087561338968818792 2.5908724703587884264 -0.47081446714823604882 -3.855023024783542418 -2.1558066275943397194 1.2877010730603737354 -4.9859737627929670012 3.0576663891302513498 2.6539164145710234521 1.996855472749296645 0.64020846255679464409 0.66012640733537275572 0.80353139125209804838 1.8063956558453098111 -3.8518721445696351147 -1.1437703006961004171 -1.2748662913651995776 0.10277188733793606035 0.15737205714606480877 2.6192139072100824038 1.1742358995482702344 1.6635394753451107075;2.8463946481416346757 5.9555937716472531207 1.1605776905246600883 -0.020475207627937728333 7.3620500061667319969 0.63459637319484640816 4.2654896160381667869 -7.2469429447715878467 6.6705247202240469662 1.5080799636454018664 3.7434866337819459048 9.3346748384157383072 -1.9457061272844315969 -4.1261496031244782046 -7.4888473487967885944 -10.642822291907794607 1.9712371864465159099 -0.46971091476429188694 -1.7074918648961838752 -2.9378745212197867609 4.442199847898391063 0.96007862396694909624 3.6438268377282976296 7.3720325529547778842 -0.34919806690469645805;-0.42253378056534923735 0.23807179473736736486 0.40217834472647856492 0.68297686183769579227 0.55756928939946048818 0.82450022821981139298 -0.32424307555165193806 -0.98139144613059126065 1.687477032787156439 -0.24438758443741945281 0.1842345935101760146 3.854158565806208081 -1.0450329528737103413 0.45858608896455888004 -0.31906530451145376226 -0.54673654659368120523 -0.33690934614175388484 -0.059797303959504867488 3.5049269691207323163 0.54557510948332288425 -0.13296877022830194681 2.231149937286833751 0.53979162195794272439 -1.564006651750589505 0.58034825816794344266;-0.67162253064129506797 -2.0760832883355808676 -3.7681562984271805838 4.5580675488597375278 3.1719118737193845448 2.5955029898250785436 1.3616088499682053037 6.3764499202670883449 -0.91849172548442514774 -0.16229462009726117189 4.6203836108855824705 -0.8157068067205189843 1.7055952598535812914 -0.56005587375327914312 0.029009772227819211055 5.6155023192210560268 -5.3123690012120272641 2.3286936019098734008 -4.449824985631435581 1.4808436212987039493 -3.1518476886635800049 -1.6123493369004595621 3.5462719456011364549 -1.3492360079440499643 3.2145966499054847709;-3.4023393575618294804 0.12567172046799948704 -1.4604574028042800471 3.0837541398040984042 -2.0576458066896594623 2.4365725496885350942 -2.7620848983788488518 0.24463680230271014904 2.7088565931764891914 -1.1356371926128989713 2.2262933532315729579 1.7715289821065971498 5.6259350485513115459 6.0660527084128572639 1.6589704016658801677 -0.95830172665412871602 -0.61462064434392238432 3.1659643896524678475 3.9869280086189480272 0.19324429589442870814 -0.61302668476814337062 6.6020931661572532789 1.8140253593548181232 -0.41666019119551378491 -0.40399794755740642271;-2.2083739238385797776 -1.9669547058931382555 1.3435041162010108451 -0.11410469224281434564 0.28513294678381678748 4.7240598721331306109 1.3154204052796139024 -2.1047113046948968673 -0.32489724326706098667 0.85645364556579128834 -0.95004073312738435142 4.4307080229817161765 -1.8514996722869982992 4.2374085044845299919 -1.5408131387277899105 0.3930414270586288783 0.81123079492708793925 4.6175453390759235717 0.41481820647767958521 -0.73496772253702991051 1.7921859152031338613 -1.1913044067350355704 -4.0284732838028487478 -2.4808052257895840675 0.8583500437302231667];

% Layer 3
b3 = 0.8355011868875114045;
LW3_2 = [0.0077930937945823990781 -0.13332902842848781688 0.78553299674239018824 0.0085882062457330304167 0.019098182032069695863 -0.0057548647870085947384 0.011130421675925088187 0.26668314205166510078 0.0060950032298995142355 0.0021776334851771571299 0.0038831667496206593443 0.097719896743025738695 -0.010359814180409617976 0.011583921015348656869 -0.039818468252587252421];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
