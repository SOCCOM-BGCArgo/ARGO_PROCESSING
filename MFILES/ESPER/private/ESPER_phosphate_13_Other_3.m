function [Y,Xf,Af] = ESPER_phosphate_13_Other_3(X,~,~)
%ESPER_PHOSPHATE_13_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_13_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9560067178546605149;1.7063802833425276706;1.9888896750656035461;7.2573350410472325933;-2.9514633079834431406;-1.0265741589410797285;5.5003108694801960965;0.95769829903143610661;0.097588501163340654609;-0.24708843983208428341;-0.082577703958287923536;-0.11493383070689100478;0.14703070742080764921;0.28698013834723518078;2.2721281480077655246;0.15911212997986987072;-2.9851508393674328623;-0.49319475375285631857;0.43188491691550950913;1.1529939514774973919;-0.76875701347367142446;-1.564449936757392523;-0.38132652416876366974;-1.5410656840726080219;-1.4234748888344073148];
IW1_1 = [-0.39846617732104910869 -0.26846888022642684257 -0.47121508033733611187 0.41613185016457215903 -0.20120212412696888982 0.75901577379308204918 -0.99957349782710902542;-0.3575819947813279609 -0.63542148335949732996 -0.79737459893561002389 0.37116075009518789685 0.60804159643263755441 0.96322000070295787921 -0.88628353069401677455;-1.580600191567872459 -0.58198631641213660615 -2.4850799933821208221 -0.73786475028579678881 0.43873121028468220484 1.4886489815758883193 -1.2880085275201711426;-0.11549911160700331025 -0.24822399153831659069 0.12002119532626960574 5.9573684312733146129 0.3228363812556293011 0.21102132199450426842 2.9241238263884063997;0.30497749123921474856 0.21923441477810876044 -3.4299090951110837722 -0.33245604090873581704 4.7717040092729439138 2.3000354356476231388 -0.9284920017979932938;-0.042237750498229809093 0.36584514985469657189 -1.0246437989307111138 -0.60983649688487451268 1.8275913151870821771 -0.86105610893398631944 1.3844190386465842213;10.215735642213175538 6.3910214060770176303 -1.8800142555858527782 1.0239566531437767072 -1.9639639408784594909 0.85044354049259029971 -1.0818624945718084973;0.061726098161579902313 -0.38324029521429059386 1.1795273298101203174 0.64193620085691927013 -1.896028675768039351 1.2125147962283508996 -1.7493638687616872573;-0.53514702726658103238 -1.2511370901666740707 -2.5993460160129200354 0.37924652064812230945 -0.084238535355812438343 -1.6352945674936334441 2.5117307725731823353;0.0065842184703135166191 -0.23162001263034770471 -1.0396079421087012218 -0.68924996117816728081 -0.74096128093457647168 -0.19914385829325179089 -1.0132600481048943397;0.21208476218550459391 -0.069965730823119895443 -0.25774834274714319982 0.39148255371109919043 0.85992317369427950791 -0.66863589988770699701 0.22582963200477007559;-0.083274078173186230623 0.091665285768689722112 -0.11090460569960504389 -1.6051896521217809966 0.64580079148431779323 -0.83442062276837425383 -0.34338515354121434964;-0.31546945340864740448 1.2078725419772877725 1.2558156717618427223 0.61349247746212420829 1.3588101687955660424 0.87320066891083047977 -0.51268372655630645163;-0.065716937115288559523 0.0420140993264725357 -0.64089374810702204321 0.044507529225615509449 -0.44724918380651623728 -0.73004717387662920736 -0.48117846503115357937;1.7410366997045427784 1.0109665051418177395 0.91824911469552916721 0.35894395836613740558 -0.61970855055680562629 0.23459163697663207304 0.77754582087172186;-0.2463000332701685835 0.3318476037828527736 0.98635309638540213939 1.1012594426008570636 -1.7671826892623645477 0.11559818558644384401 1.0364667008552785887;-0.036594345481403632581 -0.14828623622675352056 1.5505405763170660993 0.24480024586884588378 2.2774651841188831014 -3.2353458695463950257 1.5534391848864097518;0.039142041896902284026 -0.11213209089205018743 0.66731393564998708889 -0.14043881135087310508 -0.44349260405623275316 0.82075015516270544147 0.49113952415411904484;1.4034993505578279294 0.017915692194248461488 0.97318930749488463672 -1.210860157796718406 3.9551578568425700411 -0.027530105731182200751 0.96970653570816578437;0.89367816944882649821 -0.087135868178326247868 0.17175648138975133095 0.34565712362355588416 1.0476226710590246238 0.15003875347421249953 0.81527967489440178461;-0.88337855511127727492 -0.83745746951434463234 1.873882568647324609 0.058030474118066756317 1.1110602569274607987 -1.2337965093465170785 0.85453709084173345989;0.014009488471090885547 -0.7704119308395647181 -0.51887718229403578807 -0.51432988244105370956 -1.7730460857128105268 0.26990214736456519251 1.1264599562088561946;-0.27721394597252696501 0.24482329997681445688 -0.30643357750995342537 1.0050803639317051896 -2.028323195946799995 -1.3054362567422408414 2.5116150032866157993;-0.073018701191131657469 0.13033674312789345073 1.4261033552424766668 -0.73803038015254585069 0.57125698786017176101 -0.1744512229561748784 0.0043705620929863995411;-0.055082986723784845007 0.13648029968054373184 1.167291457766873819 -0.70271359299603897153 0.45054565118938899593 0.060816101468927831475 -0.042849878382466288773];

% Layer 2
b2 = [-1.1147896319777976792;9.7615279091601383499;-0.24595125751986279816;1.940748438024563205;-6.5923792781819869901;-8.3334752345285902919;1.6936673052780473192;0.78618571625015698512;-3.2530339784773354417;1.8720411900467124333;2.6905055526122074738;0.12079985495015821417;-2.5032712546428736999;1.9838402107946291331;-1.0988051854345715075];
LW2_1 = [1.731183088509784973 0.14895909032211490652 0.2530881393585621697 -0.49137758168393025349 -0.35201788050676457997 0.41302600488395607714 0.1024936313370958807 0.8098509100297740515 0.18294035823579951616 0.023057098527576570801 0.36627146257839332533 1.0818664184988897592 0.58720717375661934945 -1.0943237218559833668 -0.36052307069591355004 0.35806990126219767623 -0.10063743003834291212 -1.2474685224976556075 -0.23833288839067334752 1.3854549619750125 0.76777545662268587012 0.33574387376624237334 0.035123196525493720344 -1.2391509529771829179 1.1022601716973783326;-9.7489842733589426871 3.9528614264634471809 -1.7684571905108201761 -0.12396463580040349706 0.91701834331597587013 -1.2775113049404951404 -0.1863022278640664442 -1.4295838797589175417 -0.94643629188688715992 0.36823027115486656191 -0.21683434913512328324 0.11393075891631343488 -1.3644121043697077234 1.2609719060205184515 0.22033295954391457494 2.2086736109738498435 0.68622004597731423026 0.84170570861916038652 0.32610666670308574577 -1.7807593640370062982 -0.96033819797327468759 0.10136490069278454584 0.038952396907536109005 4.5868298295885940874 -4.9677698191826600294;-2.0894357908492229292 0.3572918635804345211 0.35811024123911472383 0.029898205948800739978 -0.62526463441505986118 0.2024694469910660044 0.021573882633433405509 0.13254393040855105834 -0.037756299510339014214 0.80466713828441305267 0.3155680225611479095 0.039393748528504794748 -0.066495994762695256886 -0.087338623291874667443 0.31961105785498977738 0.15652300106043040562 -0.26346350237800919558 0.6850422359928362015 0.15979694975892713704 -0.31564267762473707801 -0.41348791333857704 -0.13212850537973094833 0.28441498674478604691 3.2415299665191961154 -3.5610214115882472541;-1.4994924777245572933 -0.96495103795975811778 -0.14673403250406194531 0.53270913199114167114 0.40179926996622516988 -0.59363628497806586459 -0.054762508936413940852 -1.0374034199281163549 -0.15873913637517989006 -0.20875972412605137141 -0.31748877976326456141 -1.2104611002960810051 -0.60728841189375482035 0.20328999513705819924 0.37796516444545563695 -0.19200073590355537512 -0.045799052810029022842 -0.50077939546792937797 0.22859864425998174808 -1.5302536911901329919 -0.19999253058122412607 -0.0061334931241269329688 -0.19361782776701114139 -3.6054027758266515846 4.0592852253122897466;9.2692641228500693984 -1.8446794857857264915 -2.6403877457975899468 -0.46861327354772286391 -1.103725201524835331 2.6374296619093162697 -0.050086279024808832983 1.2892336847667567046 -0.058517505183258732016 -1.0156568365855584979 -1.6996282817236183504 1.297020637348990979 -1.0573363852771213711 -3.4458002783248837808 1.0293070250439066982 -1.0527812123029687275 0.27748448280070547867 -3.637617331560944578 0.061283778725671478327 -0.47934045653890811067 0.24490491561491192773 -0.085799693650982028492 0.19456253652126043185 -4.7733767011521868184 5.7336669161857969357;10.341809096267997603 -1.2667464250278286375 -1.6247639541778837735 -0.26589987147893684449 -1.1222071363232393182 3.6821226065657772786 -0.064603775352459869019 2.3369598079402900126 0.14687689154552635573 -0.99566609833339037028 -0.34285545436960079835 0.34713757584871091089 -0.15632785899432330434 1.7267025304298191379 0.17422063285563743618 -1.3144990958604092501 -1.699234283905642684 1.3106431903411122075 -0.04776129878977928428 0.19424984688562121904 -0.26140797092714168626 0.40556041775089335388 0.048954430291517657403 -7.7600519977823756435 10.058547608149927655;-1.8779616930492619709 1.1363553241540933492 0.12309754744802736681 0.078134887928819632408 1.0603642147224947578 -2.8081574580872823432 -0.046330429254841029585 -1.5204545141319438795 0.023689242793515228463 1.1628684633394190673 1.5259806023887119153 0.49725400686438636644 0.85532152138554562448 -1.5205242767292277417 -0.9929959054067332147 0.9043936840382695852 0.081190792744698397909 -0.90477041934187285577 -0.12762047344868082677 0.55818477171398683812 -0.34156230796455933074 0.41048215024277956431 -0.072843031353276840867 6.0874641665477460251 -7.0272226240430688549;-4.6064770102411376484 0.85426419956227095387 1.7945728563721106141 0.01597065878422913518 0.23100573784466313376 -6.4265558084554079699 -0.28044748487954274108 -5.7948873197306012273 0.75664892450219412012 4.0587172901177854811 -0.87359138064358576869 -1.1884981283482765058 0.83257928764522759479 -5.5319158231419160998 -0.7774420407643356512 2.7200705345010551817 -0.19340418390632460599 -3.0387600691042346845 -0.033132373733021858175 1.0375385522850772979 1.0232284289217536966 -1.6929467586313178273 -0.85572803940837971481 1.6847427924786364528 -3.8095554990887534608;3.7103743191471201257 -0.42903158394547374899 -0.75671482064055350936 0.042766531079257083525 0.31430619653287295012 -1.8982848909090788148 0.012187024453024128054 -0.57876576524878942109 0.056939837417983342471 -3.4682334627332593868 -1.5483399066993119852 0.70763107832839744482 -0.77652647412706610197 3.2199272955465505497 1.1131584236947840161 -2.8317188075416628301 1.0145640847218369007 2.5006108541245160026 0.10753349927196129143 0.16261614522803996552 0.24366504310679371059 -0.5585860951889202175 0.9089590195517378568 -0.13491564101154571165 1.0619150760651197007;-14.707141536894528855 6.4746826776546759774 -1.3737939521204067805 -1.1594599956015754216 -0.50535725394319241932 -0.39592013407841425421 -0.16024048128896620224 1.6133681819580629746 0.7722615319294106051 2.7820535652568105789 -3.6371542451819078856 1.4327471354741330156 1.5291816288310553507 -7.0264708985274779707 -0.94969459114829324342 0.88478233835117037209 0.10656047371756660613 -6.0224158429416405625 0.78738937869307867867 3.5761880796036167318 1.3319719021773983592 -0.67013765196789054635 0.1864742136247594384 7.6371003238802455115 -12.000372932404625104;-6.0010505855768210282 3.5499366720334979419 0.63974581965016563689 -0.97667555933994676387 0.45262081180885688214 1.5262708916792229186 0.14678273026413835023 1.0963836875313976993 0.22975356900908286417 -0.40433253912673022823 -0.29697489838555374275 -0.4252708373408115583 -0.20850318905416576065 5.8299112324754833736 2.5100672771667942307 0.15821222276728671985 -0.080334986282872333785 2.8111878021474590028 0.20456623801404155705 0.63846318974065097152 -0.45941817592780753721 -1.007565021827258267 -0.99467383975776568761 -4.1272014166084112219 8.0171229500671667978;-2.9377537677699536722 0.37272005642286004656 0.49916611679844802296 0.069389954766319456025 -0.63267588543940478374 -0.432559903275462454 0.036530368604356856788 -0.27202417677768409021 0.014284998481936310444 1.0366785608305366662 0.27658756004199497314 0.034350108174302985964 0.011817519106196822457 -0.56397643150450826877 0.30400497443424961963 0.18169331290485754571 -0.2991159885220657233 0.39627883722299012126 0.16053577728501380872 -0.20359110204720221038 -0.3258060689081879735 -0.11029723465492557999 0.40350125442892476046 3.9053316426343300805 -4.4332380079766657843;-2.4920282492919931805 -0.18442640997878931297 -3.4446861960473920128 -3.6015031461936097834 0.4394983156482963893 3.286710258981611954 0.11450225802231549233 2.3334704975672209137 1.0792278987457524231 -2.3541076042799331525 -5.8373620359847091521 1.0733318149017418985 -0.18970349007551312592 -8.2151561847468599353 0.51237766852300614673 1.8272021089700301033 0.25456379983333954353 -12.290748830809347325 0.60852518494411078631 -0.50290227383943242323 3.2486153069567489382 2.8264181974608786341 -1.5179383351063873153 3.1890317839069735051 -13.701897732521212347;5.693230834141562724 0.073523529511144672388 -0.36282930661436962883 0.045779407493480972491 2.1729215153774514846 1.1571457876238298024 -0.12144048986431464632 1.2938130663047651137 -0.025125212170719786464 -1.2750947860237500375 2.4133537336963564179 -0.72011449899173962663 0.52585776161475694668 8.2727140130027621012 -0.34784206373661885614 -2.956719700157824704 -0.72309162585769137799 9.7747416988351307765 -1.3138334853842776884 1.9334587878186522136 -0.6292578866973221885 -2.0421244553713155945 1.1438840323277803535 2.0584215886485379698 1.376300414970001107;5.3014661739715656097 -0.13869100992735380884 -1.1963622586620745736 -0.0014117352990351038702 0.37387566303208091822 1.0550563294335928433 -0.16268836952804444085 0.28541680514061107399 0.028250335960552722114 -0.46005280643117663075 -0.39901950348541015412 -1.2389255327087833614 -0.16834857770648176123 0.70382987916956751828 0.37066224356676158447 -1.0242314156190441832 -0.31573366990809631494 1.2557894315668853835 -0.27950317283967107684 0.074759449520841875225 -0.40741612780090641355 -0.96740113187014720175 0.34810284322440038229 0.92416317702418271374 0.13916101156032270603];

% Layer 3
b3 = -0.44092180014438264735;
LW3_2 = [-1.398175411995674855 0.21361614304995149571 -4.6444468946262338349 -1.3500439812354187996 -0.38231405715302152482 0.30791702113083135872 -0.59569244675169308323 -0.24388469258318007382 -0.32574863252939290081 0.13929724578702895599 0.11387089800928654193 3.701832794745414823 -0.094767672543222714054 -1.0900124076715365096 1.34281256524527004];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
