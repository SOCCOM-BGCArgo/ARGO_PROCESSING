function [Y,Xf,Af] = ESPER_TA_13_Other_4(X,~,~)
%ESPER_TA_13_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_13_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.094899716929643287977;-1.690684480307850901;2.9977103895432266611;-6.6205093165435169311;-8.2534843865072211599;-1.4442721919944259135;0.30728714191690131852;-1.0806294455304876756;-0.20174961522724060847;4.4098026244594965561;-0.065383495793968099408;0.67467538034293395022;-1.3988189441293810145;1.2597944611057358966;-0.039466179288769442923;0.047924187359726727609;-0.20953120988504606026;-0.13459989475682532234;1.9409671637773293629;-4.8874403345595043291;3.9204198897685720304;-0.5345924980171878893;-1.6070600995839610103;1.9720041743792031674;1.1927787471141919617;-13.33473118982722383;-0.029724042432487080001;-1.2996451403153581605;-2.2212912880759936307;-1.2623005613921878254];
IW1_1 = [0.39304668273566956138 0.42684290516653372594 0.4403223849581933691 -0.3551973124407288851 -4.7426939967012353705 1.4536325973688726254 0.36994775633109261426;1.0846679735391364652 0.31620289303036375195 0.10986168489426244299 -0.78547251864975886626 -0.69139137788214977132 -0.51022055293831725109 -0.62031197014335182072;-4.0175730120195103368 -4.8058502409143120104 -10.419268233951600067 15.211758293264281861 -29.759980684951479191 -18.920355295208064916 2.6232697976480547908;-0.48120777287025678914 -0.14837432835719252533 -0.66861540371696226437 -5.3417783029962402352 2.8287716149015067479 0.73135896342737671816 -0.58688493948052056215;-0.34887967195117886021 -0.41890725238423248689 -0.48034845555123806271 -6.0836025111384524067 6.945584728799949481 1.9851544913630012612 -3.5822350244563043731;-0.7961409348086060378 -0.22881425782235037536 -0.85247703900436466729 -1.8539882330881676253 2.8943941325256519193 1.5535672070320099003 -0.93213790026745035888;0.19037847726976622753 0.046825460068437289862 -1.3885310759216724641 1.0058967155865585763 -0.97635880411172570881 -1.1414160815570058016 0.046013216622688618562;0.89130911861238359961 0.28013551647026213587 -0.016167677269262929751 -1.5647222500210600238 -1.3880622659342827241 -1.1050830542286020908 0.47346855995131764683;-1.1178287835048668075 0.94032133180939325712 0.75490317406345430751 -1.0450360364541937397 2.0757578688521598487 -1.1029987076232266041 0.32390039852320501312;1.6102533426322365173 -3.1821669761763744511 -0.73624571211612044319 0.7782571059713310202 -20.054300371740730213 -16.247890962266122727 19.422723904112267235;-0.28111295370925354353 -0.039475638050978978377 -0.51139040857045237054 1.622727399000396753 0.2086348668912463844 0.35599192662234163675 0.89428423643597809711;1.4757493778368773185 0.30121571923271661664 0.78983998446198711019 -0.224257324135427899 -4.0024006101688520687 1.7293174836166627095 -4.7922274967171070159;5.7076193505371559667 2.1702967244877386932 3.9087571001104830515 -0.10114153270250404726 -0.095968732962900316075 4.9146565772294010799 -6.9461522377163813502;-2.3281979841840048095 -0.054962066037090480386 3.6588879450989257869 4.825224171562007669 9.8984271964819612322 1.5876172141630218171 -2.5829655740549650744;0.050472567235222871862 -0.075111698448221075886 -0.65064414162049222234 0.53853191596200411517 -1.5870456201185734191 0.46859779773879917109 -0.20463655814650177911;-0.014720177010748642515 0.051735905330271628189 0.46399396603504206027 -0.51516139806017668956 2.1646308903506477073 -0.38299389181432047513 0.32010942716283147247;-0.04716334872687513724 -0.14249579105779630606 -0.4918899840456708028 -0.61353793958662750097 2.4792850054911945712 -0.59142222931418697573 -0.40187932989990565735;0.019972413829600760976 -0.044650149576120415351 -0.50282368901936069783 0.49643242069094289937 -2.6145421115366414 0.35351902680965252568 -0.48624455137512467839;-0.077975158339885289327 0.12123441827552697281 1.0087204681694976749 0.93341221120877448936 0.0067518233851542701351 -0.81006347421286872823 0.23803498704484710169;0.22846612553866568751 -0.084217398977201013421 -4.2401338598282141135 -1.3356083566172880506 0.82129915183945279011 2.1089990387240873382 -0.54920656722786342918;-0.44533892687235676622 3.2781048395717027333 -3.5218003434547755504 -1.1428096227041779631 -1.3226838165173939732 2.5785889253325953163 -0.73413691031487460226;-1.2687466745582931527 0.93873354328995994855 0.57771291903427557379 -1.5352544827229479552 2.269976238580059924 -0.66379054263018866244 -0.19669772244037156406;-0.84739925680945249464 -1.1348660379303636692 -0.090641780702535895697 -1.9632369634120381274 -2.2816538236442096554 -1.4035410774750600726 1.1618195256346015576;0.14312687725654102411 -0.030657014970394122488 -0.57905722840861140188 1.0896549273530375945 -2.0209372716693509986 0.32934941964970126937 -0.9439550652243126061;2.5779110544553747175 0.95407499565440090361 -0.51481600637464208781 1.0749522616450595258 -5.7897209305610122243 -1.2436908680048253117 6.8672860847649488392;-8.7249478910477780147 -1.4270432585954977434 2.1860246342691702637 -8.0017217175702732845 18.917698841886430472 4.4422845055038040485 -4.8461047468333644517;-0.56041910619173085362 -0.010930297471526699907 0.38935479738929379412 2.4549342506854565649 2.6843429474165936277 1.034313967604184592 -0.073032419135944992572;-0.11198113075460995602 0.028817126026569019753 0.26422615339765387343 0.41095446939360813499 2.5971246986982947647 -0.84333455146292612969 1.1189184410347485787;-0.53091580602981458537 -0.090522931884351315324 0.0045939765285241164483 -2.7888850856495919217 2.0055581218534386245 0.3713246782114237865 -0.34201812549076832104;-0.0016231556476592836659 -0.59427771838635001789 -0.98838251834668322537 0.80334965982954076313 -2.4692410741355654835 1.1121740806507824928 -0.48751955662925322565];

% Layer 2
b2 = [205.59576724625020461;0.34337329780729958228;-649.29811533009535651;599.70569416895602899;-6.2637360491267184415;-47.447027672323386582;151.8922036556187436;-121.13109480596814649;1.9856774435523139033;-879.52362132729115274];
LW2_1 = [-135.00940065579877114 -9.0238343797313458339 -89.300051741904994174 -141.23132893406813082 200.25529933432181906 -81.99621903414480073 -90.159859934875456133 -264.75630298279304498 -38.096224299629071197 -20.171844930553895381 -124.66334862660730209 142.48690571791360071 -41.646825534709819294 77.224111372830677169 103.55019889828253099 191.80813772978427778 -36.560526052890523374 71.327330284271027949 -176.19503020403027449 428.48881809671826204 111.22255378954156413 -33.336425311370163627 83.05602570282857755 27.814671510028354362 -40.550754762311960633 72.988786053431809364 141.38050953544072286 256.22286954377130996 89.340928599176450575 -229.35642522756489825;0.2214679431416229638 -0.24083813259038761023 -0.01990595095285254551 -0.27706101606343880306 0.080867837471959025386 -0.17038119231988235747 0.4307535418810292116 -0.11986253851401579285 -0.33844758971561178518 0.005061500035402350349 0.47117151518567024215 0.017162881371681749237 0.024701673124068634219 0.028418877139360108897 -8.4755664056425459307 -17.950221792859956338 1.31218936199889602 -9.0698341642626765235 -1.5030826177831964063 -0.19801455769036455101 0.10194261822587012689 0.25290992061362127519 -0.053851482213568779844 -1.0760809591811408836 0.018961857839462060993 -0.010212066572479710017 -0.24868553372209045715 -0.87202225538781352743 -0.28733615442210475033 -0.40480247158278948039;25.877684227801719175 21.40514984799492737 -1002.6073225709824328 -18.285912584495953581 58.593252724011620103 -115.27423757359147771 -24.843446693875055331 -1.9392271004656238542 11.163662515575275336 0.025868540169739669132 3.4007374020864822306 -37.530091789180076489 -7.7539209001753146566 10.608774878455026425 -38.99207593180792486 -5.9831578380115848503 -105.50699648641987949 -82.20123498509516935 54.947345519841185535 62.346396192735248576 -124.89303486683570554 3.3286163542291276052 -86.011804204869235946 -10.61708611045706796 58.400632150541802901 59.931285464677991115 23.957859223875736632 62.373056939278406219 -45.602357577180633541 -30.418502957605603854;225.10655459055510619 550.48166756643706776 -785.35078335637490454 749.78900171532154673 404.61505506245828201 -69.321482655681819551 103.09472427262943484 521.65847274371571984 -526.44324711252829729 361.5661011181507547 1240.2125566818456264 -1435.4019591745045545 -277.70252351911580035 -872.50482869368306638 487.50233006520221579 641.47610675974965488 -455.58429645852453405 -278.74746694326324814 1184.4552216487441001 -592.27474824121566144 451.54536625844826858 743.28063783731488456 212.66461170405139569 540.3522239735717676 -560.91514237015542221 137.21461864348393078 903.22109786677799548 -343.23042350285851398 -58.099960917981093189 1812.823573545298359;-2.2930127476543584741 -0.50137195317125726746 -44.540660805109595799 -0.79068216853776118747 0.38520602939124087838 19.814784144652993092 12.605838019533392114 24.183068364822776886 5.4018248030577673546 -4.0176309946709256593 17.027470527608450368 26.263536033341342346 4.2868349664602973803 12.606314062322617531 23.26871594586886971 5.9533580551180254048 -0.19418273419326376183 27.993527527957027701 -7.6695045639578927066 1.3112986249686495732 21.240845933953991675 -2.05053595729553928 3.7070267354426507111 1.4491616346609135224 4.6904175064032980202 -1.8377184882069355076 25.705367157586781701 -3.0521660337517571016 25.209039129487727848 -32.030694824626053219;-76.923816521887090403 -26.460562297274719867 2.3533494229930225217 33.96256537401483655 244.73281693828434413 -80.785855758087578238 77.458848072038691157 -39.73232646249671518 -65.859593670851964475 45.650427360105183539 78.780930106024385395 -208.50575038201233724 64.146640734726076971 -53.208911581777748268 -93.760028573850703992 18.859210072912695466 7.7213874470036643061 30.814458086316317775 25.997798497702397924 105.52949153362439461 20.955156605985987284 1.3248595758979111459 -71.378918162744412257 4.0923041381070186517 39.102903849502226308 7.7551294703743369752 26.89736200388715659 17.026170907141867872 -22.614625784552451648 -69.158884949444654922;153.08177542598539844 39.016567229358585678 -157.27532531634881252 127.72013558002416289 -59.06030312526314674 -8.3852843999710238165 64.74442886057536839 -62.523488913094588781 114.32871432145299195 255.43687824321821722 -2.6916585097954093264 35.952701467890697984 21.131501421538469998 10.521179281349795076 38.501983738502886467 38.203299563150295626 11.383985984315307505 60.00511909058656812 -21.9480739671535936 33.441478709181261308 -126.65401578536405225 -7.7523848991960653265 -35.93548449033967529 -34.14610726766380111 180.72798303047423474 -18.470771148411827767 92.168221041731314358 -68.734752752163032596 80.395649000763228287 23.347005391366142391;40.968664123108652575 -60.780660276304992351 -191.78170938393952838 -25.768293555969332687 18.604874078758587785 8.6668411176611872548 6.893373465257014665 2.6676226787886507807 -14.832503196851929417 -1.5507164895232903312 -29.094754674134538419 20.760818388591111727 -27.254429073908138292 -24.069829282541650883 -17.966323244851974295 -44.485331772270384931 -34.146668095100224605 4.5741355859497172531 -8.024793213196034003 -6.3956715040088827351 -72.219151855164199105 15.106542518261464991 -34.056561174404770043 17.784430187753855535 -12.6363032938634543 -7.1721528019205891269 -12.821744150272031959 -59.753576781728277467 48.625982947962341996 -15.703022664569639133;1.2821532161036244268 23.127240692326655136 -61.113230918585763618 36.331587162604748187 -5.6931787240166658037 67.485432689632801839 41.024836208111373992 60.684954976306080709 -48.544316707486437679 -128.3268382531541647 3.3497625765539233988 53.126216453561639241 -36.544221151008528636 -40.952452364735748347 -120.26649128955773449 101.16199644766939514 80.512339574399433673 54.831381085859071334 -18.719682154908863225 -51.085471436324283445 -78.323982365526390481 -56.175022499050577096 -118.41488192744670016 176.63157458423609114 -39.947919274533163048 -9.0036734379272669315 -58.802197856243090257 87.608885437718114986 31.369798142191672952 -14.569391495266000192;124.25375651757316575 -581.05324757958169357 -625.24168152744039162 57.041970436502637654 247.74421067941918295 74.898342777211183829 -30.16427952025848569 -22.337468115236767119 25.722153598298760357 102.29544151297278631 192.55901019390793749 88.162663836539593376 -9.3049237901655708072 -16.872855606616418811 -377.82532417685769133 -6.8622990901225184857 52.241881892598229342 -228.33876202149886581 -21.777072159843733345 101.15427494914135309 -18.485683510879784563 -41.325669523930706362 -165.55524785306934632 18.923276127526229118 94.352688496640752192 -7.384628020881985222 -48.637235284667013957 373.44776810466663619 76.121545263266256143 -207.36164325411485265];

% Layer 3
b3 = 0.19903267216895678682;
LW3_2 = [-0.0003890827425631632067 -0.95840391146146097778 0.0034728269158658623544 0.0032511781378825295799 0.013010708495979664626 -0.0019541611395090408704 0.0034205346294077375487 -0.0044254952157637269736 0.0040789802077916192599 0.0044036775958292114289];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
