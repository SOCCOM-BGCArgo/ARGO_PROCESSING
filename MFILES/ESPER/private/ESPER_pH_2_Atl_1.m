function [Y,Xf,Af] = ESPER_pH_2_Atl_1(X,~,~)
%ESPER_PH_2_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:20.
% 
% [Y] = ESPER_pH_2_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5753736906942079621;-2.3588220870795719719;-3.148628005280218467;1.7087092691608556372;1.7487726856088106064;-1.0851273297455394928;-1.5530014908159277542;0.039322582090038138425;1.9662129468975044766;-1.4656695597568969447;1.0520528388923342522;1.8803654697508933591;-0.8055399665983153934;-0.7091761633357120953;1.201199685153535146;-2.3810276499328688615;-0.20834350023135178587;-0.37825547050368885094;-0.52037667716437907561;-1.1681869306727261648;0.31941305705107903012;-0.06152789746008122812;0.43545970463436334263;0.24181952020642888401;1.6151974301291012193;-1.3182468130604458878;1.9057641729333409941;-1.740478020296192474;-0.81929918132265533437;1.1238446986926202698;1.633411831788769808;-1.1013602346135977772;-0.012992785913581311047;1.7758690072185281394;2.8772506565610571627;-3.2740539455277746228;2.4111859257779801879;2.1370059349815146987;-2.770951297417916237;2.5133607777313473619];
IW1_1 = [-0.55471184272202889165 2.0266131802909317372 -0.039058173767791921904 -0.26292122955226315817 0.52139627822296874537 -0.1756445428175665846 0.039344308846037366612 1.0241471821240886175;1.831064003577669741 -1.3214301331951665563 -1.0733646620766079671 0.33964632632044838845 0.9801950859287489326 0.6101362885795510449 0.61231070498626161136 -0.31213779785355871832;0.041738530884890753803 0.18315473081636490793 0.62481748433159145506 -0.47741847583098095953 0.64013350648296774015 -0.9935270782096888853 -2.0540040688954661618 -1.6999074800356590575;-0.64453470629264486558 0.24779254449092202872 0.96404035860680570291 -0.26305797511869477567 1.1520675589427624708 -0.25256791218649643493 -0.77134341437717468537 -0.58307525360911172108;-1.3966416759027302508 -0.49345819753707320654 -1.4965508500680750892 1.5466848839692244333 0.68008975581516140085 -1.8260349789690097921 -1.0105988608466316414 -0.0048991794777765544644;1.9418100271375682286 -1.8912892456645922223 -0.4243890277169916625 -0.047545373693540296522 -1.4893423863796566575 0.1862250882999828272 0.35836575166883605226 0.19436360380857814478;0.46725664375976722065 1.0013567186270833087 -0.90427710554681650645 0.95444486304006659338 -1.0706526488606615821 0.24615116468322609244 0.59235255379633400263 0.1438098196890533198;-0.071839175611285374656 -1.0621931588069593033 1.252017255294668896 0.06622559949351730646 -0.19945046849908973363 -0.36969434446595716981 -0.32346246664995759179 -0.73078178903568169478;-0.48488353906630921042 -0.29360319027120124202 0.0040256484789363720586 0.34729036835898302593 -1.239753076737594828 -1.2572124838381715239 -1.3882854038619001358 -0.14315294861983457464;1.3929717549839133461 -0.53290439381414578257 1.4052189140122053335 -0.47365093687876791417 1.1561150023945199194 -0.047879749521054587591 0.698472762062940844 -0.44647318827998427881;-0.19379101862951089719 0.072345040724196271742 -0.025111742603257661971 0.79864127084852742922 0.01783427229035459971 -0.48522243154649935537 1.0467879994560580492 -1.0094514893305774894;-0.14556877845498886193 0.20399579278480209354 0.52827546671448211146 1.5575142249614566392 -0.2098904083945934973 -1.2516704711860275889 1.5525085311862427684 -1.4946232066039577546;1.0522498622860825268 -0.20392043523036496033 -0.26973718221993420174 0.68757983581533832496 -1.1459037685468225209 -0.99036177647965228932 0.85353038459631580537 -0.29867912510727978592;-0.17361645274973913633 0.069172762060763143266 0.89592745824247543851 -1.1450270404639915078 -1.9647504433002860313 0.33792403564554596151 -2.0397101795496768162 0.90628074368002631278;0.18949479696968857256 1.7247361800528340225 -0.35632521584201648501 -1.7064005562165849295 -1.7708060264196592293 1.4999756575534852754 0.67898886751567710807 0.59479053208789034457;0.58587894945601837193 -0.25881396144938606518 0.63747347081923766421 -0.55482121875975054515 0.63272903765053833958 0.30237456287123076759 -0.3267670304376017465 -1.2344370039807788242;-0.92649486166023653499 0.58935890850630501259 -1.051723228965566248 0.085030296317640294279 -1.7262712916145646069 -0.63820436856892881483 -1.1651689402853209199 -0.7986210454610970233;-1.7266799461529487303 0.42873200138784306468 -1.5174728473161191999 -0.8617287488575996468 -0.20273677829639805137 0.048375992432331892112 0.21831570390288942973 -0.75013459798932913269;1.2467290334363514415 -0.92602492707509076464 0.20129477558798072878 -0.15753782974708013809 -1.210263567197233936 -0.13914464341205495801 0.17727083427066675503 0.18692414227459164255;-0.19338955461347767661 -0.1371141077760424376 1.3884092009594910522 -0.45325279624004827239 -2.1420581257584281332 0.43832240283410489612 -1.9132939577791217012 -0.26010550299261858687;0.24486352575587852498 -0.83594391359112818485 -0.53242228346671760519 0.85878975438702409573 -1.4257296930277922886 0.95992174374840422146 -1.6745353084042735592 -0.6065499769315962908;-1.3703772259200559525 -1.9850235709062014067 0.41670356556112109203 -0.30575831089875693536 -1.4937399763292973365 0.89109879232265520876 -0.645907983819575926 -0.082261850652265919304;0.18511673282011573138 0.49599854422414180188 1.5455410995862919332 -0.92679962910832869305 1.5311567245616344302 -1.6279930899295886881 0.65707327750317257031 -0.68221697632485667206;-0.18095495779457518304 0.43984686816306983737 -0.33934720178644717237 1.028954524045690766 -0.87814882010819905744 -0.72843248648769132192 1.2979223004912712192 -0.34987648431855866704;1.0030732893929870109 -1.496829037100183335 -0.71144072229263577434 0.19483620236136933723 -1.4937013560641403398 0.49139130486416876531 -0.52914929199552707129 0.25680747310521095939;0.035827719440358160585 -0.89363219927465087356 1.3912006090525614876 0.074269354553408009623 1.3237987146456817733 -0.79935105869312772509 -0.34564115215163959682 -1.0049079925647959044;-0.27043093792899586258 0.14171986500806599274 -0.60829010857984322502 0.41873509270314696051 -0.07197379775619092146 0.22502825806972248657 0.71436848855186130258 1.0470016790225575853;0.45124977635674046184 -1.2119824407038040093 1.3332935166927291082 0.11094110366094318831 -1.2869696388017788369 -1.0299193378749182948 0.028252251635499554816 1.3007294457489639861;-0.090212470766491081875 0.20376867048002367255 0.091254627908036428652 -1.1764622432751830061 0.73413327723684873582 -0.42801266753002170651 2.1168059265201919494 0.71627491466452741786;1.0309495586508730103 -0.62990710963024332258 0.031588595606879828204 -0.77780319974695966145 -0.40453040993798861091 0.90393475992298333299 -0.80407895394296857727 1.0898065449964500218;-0.28864392327235860458 -1.2183533666183929967 -0.051445184703818272465 0.70343631430914443925 0.64703551000829395701 1.1104897662870958364 -1.3425791971657365931 0.30961909657015396213;-0.69267812103861803319 0.12634715730153681101 2.3611691468152531392 -0.63823290577116698064 0.12637171448984932387 -1.0924401112289858773 -0.25010715019480594945 1.6604925358420625781;0.56642123254414911138 1.7807962412706102029 0.18536375312302832974 -0.26901204023764219153 2.027697979271769313 -1.5018584846298743685 0.19624267453422522545 0.5666710972967363702;0.51800560716502286329 -0.3857987434256148207 -0.3139902523436725601 -0.57036459741766964981 0.78593187901868377665 -1.334298557981606681 -1.0889598207614152869 0.57506202121673333227;-0.79344846075785768758 1.8881423757076323255 -3.4010122021986184393 0.47299114933965408225 -0.7064638412354971031 -1.3900927341228115353 0.29900554335857937316 -2.388873691800639687;-0.13290359635847526221 0.19608742629647085698 0.075639835842999145199 -1.4655095816376393358 -0.14616816073962662914 -0.16245333095468836304 -1.2133525705407988138 -0.13290155556570826256;0.38660588758698116729 1.4915218418105182785 -0.50044153027419313595 -0.27261951692425812066 -0.80615654731140695688 -0.25678687306801462054 -0.082315086446098958972 -0.052753575521869953968;-0.38044470078360476117 -1.0416547780477238838 -1.5401532895652194632 0.073741219664375551313 -0.26547048200310097155 -0.46803946193681750243 1.2856018500361034995 -1.8402764212646056663;0.10069106867660762572 -0.70914756816635837744 0.75852101580761976951 0.82793565947163583196 -1.0292018029982874516 0.038376382348416664125 0.18146032963775121649 0.66902415195666464776;0.41188213799597678255 0.45910084177077542522 -1.4506384041581512623 1.1849407449668207803 0.78999479339813150069 -1.658799710137556005 -1.8339392454566241231 -0.60543265548479419103];

% Layer 2
b2 = 0.56949841100956621887;
LW2_1 = [-0.50577543391720047872 -0.59057221164043982586 0.41827548129973413094 -1.2489276971038898445 -0.25496900433750308013 0.82041999528848486012 -0.74721088648107258923 1.3398106596566874416 1.1699745236104734936 0.36103675297755144502 -1.5327629789787458048 0.55384523326510592955 0.71840406212493312932 -1.5772293263198882141 -0.18419024696702868127 1.4304693040532725501 0.37565298243091843622 -0.12374950914984500505 -1.7012423604502628915 1.2928478574391162326 -0.34138868227658758503 0.089379978544320101697 0.67541834985702708938 -0.79018682558411579286 1.0977441904712144094 -1.3128134883653090892 2.6183574550326658148 -0.30323060759484049553 -0.30972628970251703251 -0.46858236869507619016 -0.72985715923226857083 0.50350393823294481432 0.38589333184236379592 -0.46167653850378653768 0.35151602715951407729 1.9595428583595844163 0.97668338179360092433 1.6345546183568668841 0.53618603905324846437 -1.6140970210476413005];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
