function [Y,Xf,Af] = ESPER_phosphate_10_Atl_2(X,~,~)
%ESPER_PHOSPHATE_10_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_10_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.035594459127108964147;2.3902736479222901345;-1.7490511443939893432;1.208273601302144673;-2.9861095410050659815;-0.24364139698769296527;1.6616929727454532451;1.2707120824938156201;1.4858404727895277997;0.33613698587176582544;-1.5559425940085818141;-0.28608707985925729833;1.9318636525685095595;1.2307483646232180163;-0.063504274042462574568;0.98403176916569723431;-0.6733818268858360323;-0.93460971367359113593;-5.3099192749667096791;3.0194969842596761644];
IW1_1 = [0.15972679015355537024 -0.34057594803084423329 1.8416277645999430401 -0.11796250270587867182 0.65332507470622525059 0.57820082280408502395 -0.47414876646896580992;-0.3065526922379402941 1.8282660156977370569 -1.2497412917686716582 -0.17572545672971401354 0.079977023953960071911 0.62788595629801913223 -0.49142731722206239864;0.28324389107209213545 -0.96107333682353102144 1.0710339355137934447 -0.44940170239390903051 -5.9752550550474641256 -0.006567941930319586008 -3.9288271633425551066;0.63913326443507145758 -0.41848339143345919533 -0.17591376460030896944 0.17727347347794633614 -1.630303458587974319 0.474352590073466307 0.53886116618617985186;1.5473914578645575624 -0.91259798058223939865 -0.11166877882351176898 -1.0313114039807274036 2.4857377184286892913 -1.4974290502657963131 1.2526982098937655685;0.0099921158986402101865 -0.44513519468887619013 1.7495058287256992635 0.031149972823294354296 1.373577156369032215 0.51541009149299576997 -0.66569240807150253936;-1.457135566177672148 0.86686500637107488654 2.4026687586990385093 -0.50547501424896501554 -0.53226791785874760787 0.30721952355222714726 -1.1935666910914073391;0.39283327245272459116 0.1751328218028232464 1.8332006107314666732 2.428738948624027838 1.615112788944160549 0.4838375596150477076 0.66596201418135769767;-0.7984723952933540092 -0.11631526246945217418 1.3381682116723345732 0.20211576857660951134 -4.1239114901700357763 -0.19400645418193243619 0.46503444737698168554;0.66876711212423645136 -0.44912255060279532293 -0.14685893292143273325 -0.72450834817215392647 -1.9362518094438816441 0.041925168508680096813 0.81148924754253559666;-0.99574207955862548136 0.14501490923072157813 -2.1689852216645113536 -1.8183331841349668068 1.4212032938926519865 0.61440084389168514445 0.096256505916358911512;0.33517068033721231224 0.46265408602200713828 1.7755505746215669571 -0.39575164967739767663 -1.0324155000872357046 -0.45639349453489042041 -0.36411249724674565886;-0.96646375413748175642 -0.29773647328931773792 -0.15832343523756384207 1.379041625132930049 2.3530385550099151004 3.0204322295004604193 -1.2409560639231858037;1.2575353965439086679 0.66946991591991600323 -0.21948830967862623109 -0.1391715350959984443 0.036172714807622519118 -0.62656727488627128597 1.9707415039606439588;-0.036191534011521801772 -1.2537673850103627782 0.053767207748441764315 -0.42191411713040721798 -2.4161008822562930476 -1.8260846144194184948 0.57701129123300531898;0.73181758234073834846 0.5840213048342466351 0.33304392672499305572 0.91560377835823691939 0.88669692504799613175 0.48939101948534396991 0.82382341183294161002;-0.94996045024455344485 1.3053742307809739209 -2.56305550022029216 -0.037365444982935071272 -0.080997544347626224126 0.08253007478564972077 0.13801109603659103553;-0.10371717127469595732 0.5789497343669756102 1.3445210384834245243 -0.48294602922351631547 -2.8793057054980546461 -1.9147481682442446527 -0.45438995247994073967;-0.74822203668874176508 0.10440455665577171029 0.050484296717654753017 -6.1987610238024695164 -3.0287862977075299398 -1.3415432185241538132 1.576242389865457616;0.23457234934275439375 -0.16758210031403505957 1.9903609441666076929 2.3979604577795154974 -0.69731863406246341608 0.33611651843087880787 0.82424477021668862697];

% Layer 2
b2 = [0.54004412799700141079;-2.8760073662884089174;0.97130562060336289587;-1.4723873599519501365;-0.68757094167169463539;0.40474637878403102453;-0.27517025955944501847;0.95403803904391959456;0.36149782168944311067;0.95065276523321318169;-1.4490420673395365547;0.12602539541507157272;0.45009916119040338511;1.4889858552844070783;0.72861783190375617458;0.53386408394191975368;-1.9300711801346728258;-2.1278754640884267602;-1.7896349674043519062;1.7673283893520721488];
LW2_1 = [-0.46423636040613347475 -0.47693252672057057096 0.01529925652687943137 0.78017172235817677795 0.29157578616094398383 -0.19405139601386467429 -0.29926863777234469222 0.88238114354144148166 -1.2024352008314056484 -0.5675341207088295814 0.6450722195389345659 -0.36171746123685205587 -0.20202663726362007912 0.36599809054898202465 -0.51929089843359466094 -1.514108171929670954 -0.10715752580557971751 0.69013701174614705547 0.46482328090013730337 0.047416210343480355571;-1.6970212091380234565 -0.31811308364283347183 1.9855963445542845758 -3.1783099528848084425 -1.5828607197935660178 -1.553041684780580356 0.6234480620108643345 -2.3552044092225159488 -0.82327060743742641602 -0.38638103447024768622 -2.3170442277194402969 -1.3065806301347795415 -0.27187587796326406764 0.68825618378326902658 -0.78925870036143719322 -1.192808322413223987 -1.1386217688860558184 -1.6596046673804296656 0.36982780568486722794 0.81803551133617469215;-1.2469385002448698518 0.41470965574284290867 0.32287860779004251555 0.14892898707801718872 0.13540254289436012836 1.1140216228446144786 0.49804519595643037544 0.65170649037098149492 1.318328665660267518 0.6627499882820327981 0.020895345851118594938 -0.515277806754761869 0.47326985593619502746 -0.15820286658175147787 -0.12761900892536912067 1.140955523559550322 0.13985397403134661176 -0.74058467002193650863 -1.1690910096609672397 0.00024987919598378708491;0.39206656104014664388 -0.69875002394494489799 0.29209255964839586639 0.21087146238712176083 0.16714682079084827726 0.90912556930868748672 -0.26335562130128259417 -0.054945434949426358306 -0.62402700768569230316 -0.13782155680450133839 0.20571050143599078908 -0.23072930565425281424 -0.2636329433741010364 0.3184307366674191675 -0.58569816848898215156 -0.9604113641297705728 0.9045304870306195566 0.25481695883044708228 -0.89808233348715993394 0.45801823010360409594;-0.24500061607936590713 1.6137263680256666021 0.12879150507758507782 0.11929612277566653544 0.22769785643838530431 0.85032977120094477286 -0.21094130318516451927 0.26123790117846573677 0.86778731310119194831 0.70082070302449472887 1.0682034852046689011 0.16120638458296826512 -0.78193783283798601325 -0.61969189042270034218 1.4988776746233829495 0.77318692821050771791 -0.55480544098461825886 -0.73495145247121795862 -1.3242522360995239161 -0.33310188307901800187;1.2757789379386204054 0.60300867518166467729 -0.09577413159031970824 0.41346243594384329834 0.67195886929014536637 0.75058726422297183944 -1.1130827325804666383 -2.6613478062179232175 0.82718704663873710015 0.32588213572158286624 0.75564524434394864105 0.94307408040812445993 -1.1513347719764122079 -1.3558184452314092638 0.37657042723883116242 1.8642138090881552603 1.1505509543742531431 -1.0287113368867604191 0.39308749087108318943 2.7639001656201811485;0.81120430580628766215 -0.7954574949658884675 2.0702888907159073817 -0.89907082137539484634 -1.1831649925334524198 -1.5134809237196675813 -0.36099459692689606083 -0.60552409661129946716 0.4292181905319902846 -0.77679006660758131986 -0.60508770245291942924 0.09518854713073179874 -0.25492716072854582077 0.30716959844358898701 -0.8073792055260263778 0.022247950163267256329 -0.76378028623060123525 -1.4124013964112367425 0.52403747890091312289 -1.6095106549235755899;0.73633400381409541691 -0.675273924334942377 0.44215641117045523245 -0.34048802722287208056 -0.23738318115425102728 -0.23017864205745047768 0.43716231561078061629 0.39381661875667811623 -0.79067462291905743488 -0.20248103084558866094 0.76817609245580109611 0.29274428033292054785 0.062372917432202391874 -0.12140204083919826916 0.21629707992845900733 -0.3145437983476049304 -0.49480739894630759723 -0.018501961017019778744 -0.1041590030567562386 -0.16277632359816809893;-3.053419373064673259 0.67778808265911660857 0.35731393191492083483 -1.276153959162164675 0.15101634079317688419 2.2097866594842390242 0.62137875464567693395 0.5085526833572971972 1.4575937865224453116 1.7896074917456286091 -0.36974170720917143296 -0.57503386944670920045 0.58031948219789331045 -0.12482115510183516838 -0.11646583140447262783 1.1611107946080214681 -0.18627103761422780792 -1.0067672499126287811 -1.40315673414437736 0.42811829396963957395;1.6231417324669297209 -0.013163638703233799393 -2.1154421326113701518 0.3854504779482724186 0.15571014770222801893 -2.3313731105615596029 0.18262665907405328802 0.37723095519573185408 1.3273346723187864349 0.50408582690109904334 -0.91474886602037519534 -0.26322514684943809637 -0.63686835688230358787 0.37876836019744081208 -0.51562282748531240717 -0.086230075189497101817 0.091965667675573306572 -0.50276064169784995261 1.615973231542674915 -0.63788455676841859798;0.59668136763006063283 -1.3257333569179752253 -0.011761919309213823837 -0.33902758087216755545 0.092715634471143837381 -0.16121510782690784414 -1.1542946566759186844 -0.43191886566156462157 0.040269021738262592014 0.28923142077469460309 -0.80517671834527893004 0.037562020771289603149 -0.31400462473959833698 0.52243476052183557279 -0.65123997076472650569 -1.0357230405438493381 0.69419850210173539296 -0.11258705129021383262 -2.4672690427822270287 0.073691704503711596974;-1.0620318818184544263 -0.66612309729410190684 -0.078860181299208784167 -0.21864322608696354355 -0.30001718313830672002 -1.2849070139874121388 0.25273283188942280431 0.021915735440254290045 -3.2697119306219288859 -0.26598038604027196552 0.85397940676116623759 0.096473340685305178366 -0.61134325854465643157 0.23654278225509239864 0.30338254435136513543 0.99649109854797746078 -1.0243596313175242773 -0.403408720763460793 1.6628160865379542077 -0.64064670760954123274;1.679565291791067061 -0.053622066470621537748 0.05593496235198204547 -0.056947486906242343607 0.31187158449033991481 0.33196344875706584876 -0.32868748227978261678 -1.3434085375302078358 0.15686971465096685718 -0.96989938567757383314 -0.39633273181449890643 0.2592265989792346681 -0.33385707563291455724 -0.84841554023856746714 0.1887116954887552156 0.86945676497293644669 1.461163321330825049 0.061479293308161930831 -0.1106707930243829574 1.1031629118738199846;-1.3269083182440224444 -0.21445334358818851639 0.47366174898879348509 -1.5381906860444840568 -0.29358834729407290443 2.0465253138459287285 -0.068660313168559888863 -0.47533827931576477788 0.32033399447288979367 2.0767529094270722467 -1.2075498543184643996 -0.18132186994341348285 -0.50185896906788141081 -0.23108722482610377646 0.1155298137190012564 0.79724353269824432822 0.44729001720733319036 -0.24816493416011894957 -1.3870874069194638611 0.39884085038445843407;0.51251769181747586224 -1.6222508787952856224 0.020241692899131333988 -0.033922759034631280728 -0.31201756488507320642 -1.5342060903083971635 0.30785625018196621783 -0.26780424485306258964 -1.045195939294924381 -0.87892912537284106911 -0.96390990873909332404 -0.16609237119218242529 0.79011237810071610621 0.65097782014556193619 -1.5909111282265540055 -0.90110476471131317755 0.19332512247416017148 0.80656148615304446015 1.4754216737343237575 0.39459461175699905855;0.80351938777206388664 -0.51695204538856309728 0.23091695211088827944 -0.13448158815369964936 0.29381629344779680579 1.369603624112859741 -0.21830115779018291478 -1.6601644887708235654 0.50237377336307698084 -0.60007926403571654195 -0.35459877547305579393 0.77737107603548027956 -0.24928866330428101072 -0.76895272739015974039 0.28257768517485992721 1.369019346835839368 1.5151332820917011723 -0.33679721826047948063 -0.64120857362092265053 1.1948999992528597236;1.2732151322311104913 0.53340506889239680532 -0.41269357915851395679 1.332577525047851319 0.20295955211975463817 -1.9729886187387912777 0.34078762898121311986 0.32698560289296590975 -0.37553558169874712291 -1.9813539182147128503 1.0324414312698328988 -0.14594940891610991285 0.27275105524647691446 0.33184257208663875405 -0.33243809622713144103 -0.80850779870028588459 -0.23843086124660525793 -0.083080985968244258633 1.4459247517622040302 -0.32083580954700335885;-1.4466896545825274067 1.4744983208335757929 -1.2761333155321779032 0.64607283864160536258 0.31600143286448179047 0.97180503208998247899 -0.16634271521684834694 -0.43680253556895232148 0.73932688667924839621 0.18010028538722697156 -0.90745749845286405311 -0.96310107515156651026 0.16761818158765859343 0.15185162784654160362 -0.25783058532104502492 0.38388113412640556543 0.67632936272018029378 0.29457492593294681837 1.2399624030870526337 0.21138420412988920272;-0.55210686466173597431 -0.090631287227755985558 -0.19083811370885961356 -0.11158410777294597294 0.066632094040419989622 0.34582364452036790103 -0.13803795155639078662 -0.19060025279348197236 0.50339248510243550516 -0.048322914273733273693 0.59020831424601860604 0.66268149672395137983 0.19223041051851336158 0.25171237237313359714 1.0043660034806920489 0.90203213972116191854 0.073432954405895561889 -1.1261667469443445988 -0.049370281970624770029 -0.10216667801188970832;-0.10585903902030094348 -0.11098262708292598588 0.83563750002234116199 0.42712221191780019858 0.1123687805291147257 0.31413386730854420126 0.083601011908308167642 -0.16753312218204219342 -0.44041216530543703112 -0.14094704657824189131 -0.68504809357912110901 0.79816451176984504201 -0.36924893483763959745 -0.081335399594367599474 -1.4458447509858975977 -1.2100878501118708108 0.13860701630438948539 -0.61312455518455011294 0.2637018206795388453 0.16669583065208090633];

% Layer 3
b3 = -3.5343028628142443281;
LW3_2 = [1.2481550079564946998 0.83855349616404406543 4.2047518057655848267 -2.7751910072809318208 2.3809383225345279733 0.48649103475665600449 -1.102894075745662672 4.5538702101611931994 -3.482088910654174807 0.29778473513741776646 1.1590681178897828119 -0.54632317781167427651 -2.3519016336058542471 3.135144659376001286 2.5273713120989556025 2.5116374273216170998 3.29155320444541033 3.2471807801283731898 -2.630545436287288652 -1.9981035607214159278];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
