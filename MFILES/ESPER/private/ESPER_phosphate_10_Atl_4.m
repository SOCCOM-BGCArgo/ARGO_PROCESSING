function [Y,Xf,Af] = ESPER_phosphate_10_Atl_4(X,~,~)
%ESPER_PHOSPHATE_10_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.1632569921911297683;2.2080538002956382471;2.5415136263041713249;-1.6965871333940567567;1.3126369224641312172;2.5755789831406668;1.0977504713925640978;-1.2620039847167308089;0.81895427496142514379;0.7703725266518091086;-0.77011493475766312766;1.5238926822514933246;2.7470811257025493646;-1.1262562697465992034;-0.32189084345643259599;-0.21237683075739938188;0.67034215744113645474;0.82865257193273644809;-0.84415649484199406505;-0.79957388866474876643;0.05037664757263782267;1.3249695035543491706;1.0770788342957640094;-2.0627331246331204184;1.4788085216216035889;2.8136753262909501849;-2.1585723091226283188;0.8034619058078427134;2.1847789725679325201;-2.1473185336359135178];
IW1_1 = [-1.9403092771180685538 -2.2534666284561217786 -0.28154297079400170123 0.63775768586339076638 0.53840395284490183414 0.23816929019620497465 0.51670958756525953159;-0.76520261524277921605 -0.60561166761815876658 -0.98764046146439699037 0.37303588666070675028 -0.43036129088471170023 0.60871599765910822111 0.76989320228045732275;-1.8533466895266663688 -0.22156233252447199433 -2.2400019687779466615 0.20946615273224733489 0.52720132459566781957 -0.40031044456585029856 0.45712560951223668582;0.19881689085951378959 -0.2027578919422816095 0.26196856739015994542 -0.69096734684101424051 0.51965032615007633598 1.8938847351189365131 -0.67724982259762689374;-1.568241693404182735 0.77615915647972810731 0.3571787903899122929 0.46558960870404697552 -0.2480995346873856866 0.28336780171180686594 0.3733409042016163637;-0.39394902974705475751 0.10900348671659658428 0.62635720177228315642 0.9288999913185328472 1.577189756381470076 -1.6607198531697102695 2.4722200414506660948;-1.4838250100634804429 -0.69132095644236180032 -0.12628786256101953711 0.37459059898821711609 -0.42479778830408210233 1.5473022917034249257 -0.88645922276404998108;0.77509189760084162835 -0.85262585939409318847 -0.29057744002237467784 -1.075528991633838416 0.064026936141343554487 -1.6128195674013110494 -1.2316896732523585634;-1.6579681333823339529 0.91368844234848400898 -0.76235612841308642018 0.17295904222800431715 -0.83153628136558543904 0.89765756043231259564 -0.53933757277445204537;-1.0897733380062275543 -0.7541694053609901971 -1.3638593294621583762 0.41841518688428797068 1.6727046213974561262 -0.97650882271442485116 -0.54308316701517711511;-0.25781697850539869732 0.93136291881688904049 -2.5134194745883395861 -1.7262065208253802862 -1.3323903021939260682 1.2133165410802846385 -0.21592972899111520513;-0.22194678182759394747 -0.83171799708842153454 2.3808570831951159086 0.018994376082613208256 -2.2148818695995737826 2.0621716913633596491 0.055573579585519727875;-0.55336995991604109868 -0.035118667781763396318 -0.34312002655075740654 -0.21099131183065233941 -5.0076617535920542323 -0.81088407929471228996 0.32528171611123457563;0.50735341863672467344 -0.10413039918921992988 -0.00045660155909084919335 -0.12465799178250822066 1.5079709867780528576 1.4161720252449430113 1.4734422252408330145;0.28336915837874060431 1.0170999313140351994 0.30245787520144029603 -0.24665654881187357161 0.30544076449231355452 -0.78998901355391593082 -0.43463365584896967997;-0.99876233818059478864 0.32981893851559135333 -0.31569158989372309021 -1.3910415437913716818 -0.67297646021521961845 1.3543965133434918702 1.2150851643352693632;1.1784029562290998516 1.2870991531731876822 -0.068817113407186450424 -0.22789401091216979212 0.85077666793692396929 0.20497103242193639994 1.2988956467692140961;1.1227330954005405594 -0.80697290455616710325 0.1209901481377354121 -0.78507584411112396605 -2.8053145719740357755 0.31163531009960743212 -1.0338667074021499204;-0.91839207642697562317 -0.29664724385547369678 -0.92098108018637048211 -1.0479036062524009765 0.60924063163402253362 0.35778610020178419626 -0.540165928260714856;-0.16666175620515730205 1.2228494633722162277 -0.86093830130542181589 0.3975242147415886107 -0.23028501313322377597 0.93140287953442579827 1.2991964674740807961;-1.6238642834450620622 0.22667788267433730542 1.8773280251773103444 0.4588590748353519877 -1.5910982681206096157 0.38044835004949567603 -1.2338458277735229185;1.3153653643260005968 0.41801065915945068152 1.9916820351849091608 1.3834370461739153857 1.6171674956791204369 0.3521455207849994995 0.0058042387997593817422;0.25690618304364570834 1.361753715043394708 1.3311484790272543055 1.3941940160596448806 0.28442296087898749635 2.1768838660067406643 -0.45419177572299329615;-0.53663303214015978249 1.0131846792909424693 -0.81195902384752227654 -0.90098917013178758673 1.0759941170598459337 -0.24504168981203214295 1.0125485760143755343;1.671327223355373981 0.48235595035868128466 1.2759734111685960833 -0.30973339456248244472 0.2850356687257847299 0.85010352264166777481 -0.54793566601281162853;0.045813369279727705896 -0.33552539393678693092 1.0721199426901328877 0.64566095764320097228 0.73478402287025301742 2.5363365973186731139 0.25619814742769203564;-0.29210364229708613015 0.6355243198856003195 -1.6705105808042639559 -1.370063213524127077 -0.67637743271778050236 -1.3310856498785725854 -1.8406944964571343437;1.3447059981429023701 -0.76780717814924981379 1.273473147982959075 -0.24360836208972747041 -0.48753103056864899312 -1.3309161971896263932 0.63688693843793098281;-0.0011593772195534919871 -0.73451719681759508607 -1.0093632640726206695 -1.1477534280874828188 1.0170254862687770903 0.50937504114606491079 -0.95624277214832420491;-0.53436470954863546368 -0.73333428962432556375 -0.44958168155673350341 -0.23648318382847968722 -0.55020986310780195527 1.3728824583361920464 1.5326289821338043851];

% Layer 2
b2 = [-1.6749254153760739783;1.55750388125178163;-1.3053373743041634114;0.36497315035003419226;-0.059945521636974113955;-0.13617979693269155472;-0.25185913581895524871;0.82991250259979532089;-1.255675173654407617;1.3703184922230959852];
LW2_1 = [0.15400437896560822959 -0.075205825835124195944 0.5250321040412894158 -0.42604966156857693171 -0.38485948040160528061 0.053176829505017932098 -0.18814241078346721769 0.1350182220999859295 -0.47660382158129011021 -0.58509320091853367352 -0.19835738843037872825 0.53588694875806164308 0.27727578638537547784 0.42847677909516307393 -0.30276069859061416345 -0.56410902246754912603 0.031959883668259921052 -0.81340230525311896237 -0.1340061950191857032 -0.016821060271290898258 0.70833310307132579808 -0.24916607024121203984 -0.33052706515959462408 -0.73860144610413958066 0.43107056737906152 -0.11554917382200217968 0.80792074509553168937 -0.73739706441261343439 -0.32767029081618859188 0.022316822708410840453;0.23590778623370442513 0.68488354931283990101 -1.3809074452629555019 0.32557419352906546983 -0.15218870359446004525 -1.0026839868519332732 0.70850727513526046142 0.14094714263265936682 1.5021850869250148452 0.14035116009807227511 0.83794438680982374912 -1.3482409965255957029 -0.5283789225578841009 0.6259898344058046904 -0.16428018659083459818 -0.76086631657469927514 0.17638480589688596001 -0.62022462875114681147 -0.58796094775860585635 0.17935197390128410078 0.46738728254477429624 0.59790530008332409828 -0.62360953874876523528 -0.62892278473124185734 0.51796114900497569611 0.75007375209157756135 0.0051375781381824726923 0.50528881854132023932 0.75609210101758128619 -0.58985465131324354982;0.62304066589653339658 -0.63333240796990375454 -0.27664602202683519216 0.2210428424113017043 0.20916285596960729198 0.34653876026709179436 0.26861814945720746683 -0.38449102971346471591 0.20370232484677994189 0.15894969809830392093 0.20375388508319872138 -0.22708182786827443844 0.11936142753925223225 0.39224700699907044665 0.41944570051670443389 -0.49024538126567529517 -0.055504089601419205613 1.1431681510895561615 -0.38243384032018490348 -0.28233324495295519796 -0.67653596819320382938 0.050713006079621272826 0.05132490194518151555 0.035453418469942460378 0.18944220157206009825 1.194809015397048757 -0.6122008405174721446 -0.41397131644444451481 -0.90850446570253307055 0.44134737378348620762;-0.046363067214041202291 1.3949960861778634147 0.0083189644369399580459 1.5937584723257178787 -0.75076097853860923603 0.23692854873632929191 -0.7678102125076905482 0.76341612696774552305 -0.53443351485352375008 -1.2828901943857369261 -0.463634193218793067 -0.3615416552512674131 1.9119276989845086501 0.13761179539385470783 -0.7649695671794587426 0.89103931618082665711 0.043824859799162320384 -1.0424638217118438188 -0.74589178695153168785 -0.036581584807740069598 0.40658679007537013028 0.47789919979043593568 -0.51997188632756929927 0.16667860450673419037 -0.059072853228424093697 2.5035821013421646342 0.48158816157415834658 -0.67539392161253863911 -0.17162119214399254585 -0.0090091546356739146684;-0.21806935605341809525 -0.2638365148004040428 0.62184199810799412056 -0.10842104299324115124 1.0914238808112115553 -0.6648367356781748061 -0.0016126055241257059719 -0.1263028547901217935 -0.62429767488953868959 -0.39772425400176453225 -0.34527670001409177525 0.55144401737300952071 0.3862529098065097255 -0.2415244842515930912 -0.39981586449016770501 -0.72013832662253962624 0.40414703593901707412 0.35713647855998698066 -0.090088113597637922703 0.097493714056791580536 -0.57701566050705543898 0.25323371982620490606 -0.084150010243776218744 -0.22557327699456339309 0.82227009474447110282 0.28026819004688663384 0.54004154427297457186 -0.29402330055621406224 -0.56864150750855979588 0.35753018949522868963;-0.61813366890592391645 -0.44977579136458673004 0.28920899649057130176 -0.22134672864531648728 0.64687991004261202743 -0.15834787692344837184 0.56991586963594143 -0.32321124647903470839 -0.87569053006546482276 -0.20731740059389847097 -1.019631008556464824 0.27916982373097048997 -0.039229751314149692576 -0.27119621733305748768 0.086346065890155948575 -0.83335859274438739419 -1.1153557465249848146 -0.26785501963774538403 0.6913867322083248057 -0.029896919173641237771 0.19982229863761935551 0.40857040350836887344 -0.1815778970191648245 -0.096049081184386098098 -0.66492627156173400582 -0.50910765671409052846 0.13434077173151612317 -0.20257447958896712681 -0.079478148029927336848 0.57623771192287709386;-0.3960946763537502302 -0.14471060969452609335 0.074336232536183585728 -0.064565630611086499702 -0.71109323942026192444 0.52963234638030542989 -0.41820689849960973605 -0.6501963255974829714 0.69734406211641941642 -0.062432971331147057992 0.60104093260153934608 -0.31732509631524236093 0.32783160283262191559 -0.45699791396751421324 -0.3427479265465828151 0.33283429844450901358 -0.057837597202771019733 -0.15972881283688761256 1.2466804015492942703 -0.05709236767009823188 0.25134971025518459964 -0.58569320210547459737 0.72664991478196738761 -0.33093413066629245867 -0.55601578920255412264 0.87264374872863770261 -0.73079443951835820759 0.77471988911332423378 -0.11746989526865235509 0.068866370411382660244;0.030217391692088056698 1.2001073280804956944 -0.83583613819873847639 -0.17647175772629106194 0.66000159101162569897 0.64825031428021928637 0.12125160449939709206 1.1707114652405221644 -0.41891945827524529333 0.33318665835311422896 0.78076036875229615219 0.093909168176313548293 -0.59118844197048281419 -0.19436719572952593227 -1.1837833102060102419 -0.16566854960257765272 1.1428799273611316423 0.043707239260932985447 -0.45204853611678436076 -0.13911388405348937281 -0.023045566873701451432 -1.255231456150751379 0.17744683836372676655 -0.19976127789762082587 -0.089497335781597867066 0.058013885202098332272 0.41724481221084308569 -0.67144413938755531657 -0.4144910586837834976 0.34997955989680756828;0.23415041933795299745 0.32340588705606271303 -0.35985107615933231706 -0.31009307473036346048 -0.7454752038641814238 -0.092998227543068870404 0.018290027885596728263 -0.48453806863742732158 0.44832866187484599063 -0.022517245662539906587 -0.01124915658180016334 0.58843164604761477587 -0.43777586833264064969 -0.48445531762920618357 0.40568638164842946159 0.41812466338251635944 -0.37663267654865129064 0.73877424073493558332 0.55363231596467399331 -0.40420002076196387408 0.49275752811762996153 0.87402268303484231815 0.11337967778901382465 1.4435373735426832997 -0.75676137556524036842 -0.12162344656892655481 0.090655719687198599299 0.53402699682316601137 -0.32008504779229568493 0.33811261866143144106;0.26380511492619979075 0.58676318835155349962 0.11914148745841431076 0.11544883846599074406 0.5022970849155272699 2.0448248008409906085 -0.19790155560362210352 0.26380971768395689026 0.15869111929552595641 -0.15955271719500660477 1.4224316200390421105 -0.11973819283620387721 -0.41381022657075161586 0.74710348632305234595 0.32118562648315335251 0.35159232797967193695 0.4165702928576074382 0.29459776883421651128 -0.2005904864730136683 -0.08720609052451501475 -0.63597149858346724294 0.10714103607900332671 0.051282392190081016459 -0.042380302185388483982 0.28380648772120709022 -0.33177651164777943738 -0.54504062379857931564 0.15767295473454828736 -0.086365999592219286352 0.18084826375762907968];

% Layer 3
b3 = 0.032361584616596522634;
LW3_2 = [2.0119587101707798737 1.5886961152045850909 0.28275367719534655331 0.36212988156176884047 0.48830430694487064747 0.098214101264570280447 0.41386068402737496985 0.2035356596228723447 1.6897595938690688211 1.9990135023482724641];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
