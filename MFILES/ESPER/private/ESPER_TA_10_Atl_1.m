function [Y,Xf,Af] = ESPER_TA_10_Atl_1(X,~,~)
%ESPER_TA_10_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_10_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.17551421050746440766;3.5333966647270571571;4.9080071794180648581;-3.3979236419069773767;-0.3158240833474843523;7.1226137165078080571;-5.2072512532065147184;9.3800251560684646535;-3.4751196549585259277;0.67123505301897812281;5.6885147263785311722;-0.68763112454977171062;5.8821603502780384076;6.5827136490951279058;-3.1023683959400449872;2.6087940170064056744;5.5711936266278536678;1.8183810204086721107;10.771667716498424028;-10.544929605064961464;0.9185577868245560218;-2.5604202211113400445;-1.2438121110695412597;-0.43519242833389176761;-6.2265080705538311534;0.55481052791761642506;2.8094627803284195622;9.4394683615100145602;-4.8014010767780979094;0.03222370383877166955;-0.043741591758138895218;-1.1357404837843054768;-1.3505520626310634213;-2.157143893474963825;5.1389987273623694009;0.30708669994681786486;1.4574925001398819635;-1.5734586227700209093;-6.7763584194235972902;-0.25783023998599863269];
IW1_1 = [-0.55388952183509454485 1.0986882652585836517 2.6854055195927344357 2.6247280565904285154 -6.3484937979490903004 3.1456683369092712788 4.6591053501910222323;-0.28894994995235517843 -0.90391821154176443809 -2.5638813199318053471 0.13409072304433716782 -0.57459942984094058982 0.26420490252185813151 0.6826131490586330175;-1.1409563448293418286 -1.203061770234697736 0.42763740098146207913 0.14415634550372344314 -9.0694653548279084987 0.76139645888852414135 -1.2227037479071287684;1.2437028637554481403 4.1740088882747219401 -2.4401101748485167775 0.81757497995003680646 1.1083592635766721379 0.26397835161114824309 -1.4141620357882254133;1.2358539848080039025 -3.2234015145429593119 1.3236929873189602347 -0.38855316987987703614 -2.9355204224815709679 0.3294754630797293582 0.89316567100081389885;-2.9687595602748291235 1.1607879627155850422 0.40843358385473516048 0.2333855405120438542 -5.0072152263411489059 0.4136853712199869415 -0.32250658234375639832;3.1080860039662532301 -0.67293383867121348008 -0.0076833931456434280405 -0.61907427679391380249 0.54985597284810661112 -0.77989679115015830835 -1.1293708760006484493;-5.1113351719426098896 3.810806926407342754 1.0989881106412600076 -0.18931017045561138179 -3.323947530244672155 0.10471015329520465265 0.22886209717448616208;0.62222073660945120821 -0.44738641146685093064 0.27106737862488583524 0.40569478505035516669 -2.5173991122906049789 -0.13045382930370658103 -3.3525755325858561662;0.72178098075589436355 -0.025014551710113189925 3.4102849820526843772 -1.3956559331530464796 0.48157152856279017428 -1.6951261081902349037 3.3097238768507191153;-0.84773506433551970574 0.24978738016149601431 1.0754916633045186192 0.25974017957931894163 -9.5569519020316988644 1.502006482659448583 -0.47204632907385157825;0.53030791733470827864 -2.6085534320214165405 3.9444502858002485901 -0.80972822478434491877 -2.5928575505042905647 1.466945304211673573 0.71766116531734802653;-1.4699126583088222286 -2.9297425230032398957 -6.2877811133984291558 -0.91625008158788601165 -0.16643933480725028873 4.2345530860852305111 -0.40171054148806401018;-2.0348780643531592105 3.0275036617988657639 1.5327024145168275382 -0.70522121703611717614 -6.0053458577300702359 -0.25923994025328833679 -3.304259498713393306;2.5456725479959843028 0.95865121845802581113 -0.88039564414519810853 -1.3461532839991925403 3.0664118567453382269 0.91853012207336914852 3.5305609126543777698;-0.42529388530881317987 0.36075574281789857256 3.6298942605313357923 -0.96470909815154015643 -3.5914026969087160523 1.1674639505782364868 0.59805831867297798432;-1.7987825477159715692 1.5445958086241271534 -0.16263802340942618008 -0.18177662842597361315 -6.6017635147411324326 -0.082714317527578351541 -2.2131441588523901309;-0.28751572689196636112 1.3091490359769373253 2.2363123818094137185 0.1200087638657771627 -2.1256302744280435313 1.8720310521486347444 0.40060679382676245286;-3.4319060267634040606 2.6473927926834743829 -0.3687665509062886815 -3.7460253793389428623 -15.238384142924575215 -1.0899863888154153191 -1.9580689025677593396;1.3778618426885036463 0.28214035534736137123 2.3487533642318245697 -0.64689583530862226901 13.096243377348875114 0.67335581771562125208 -3.7538960064930257943;1.4039665971624797347 1.1807066484832602349 -0.25519862581804053647 0.068276237036304990302 -1.5662851985133454669 0.3086634400803243139 -0.23209164095101159075;-2.1619272940221985202 2.339541903449410043 -0.89318793040121380322 0.17897253788086917026 6.00671505287684937 1.0568317981404133921 -2.7421952606310764367;-0.56191254559441516925 0.66515521968523405594 0.5351780867400830477 -2.0404469096840296416 -1.0391520260338680259 2.1938257313419007311 2.8808549210130620644;3.4523733225940098635 -3.2483375293756284741 -1.7696770988738117492 0.092753235074760825851 -3.1237381268387847122 -2.0016724164043320222 0.25578901439370876902;0.15538032404015275634 -1.940810374806446692 -3.8655003964556198248 1.8173453895733273633 8.6949124822796886036 1.5959459923819256932 -0.64160446596881481884;0.42095286016804878138 -0.99990732825129746697 0.15562930982100306454 1.3301917030949614862 -10.413558253965105038 -3.3579582828628335989 -4.9960848095002079461;-2.6477024913260520655 -1.6434663742910633477 -2.30214318455563971 2.3010762532416779713 3.7990611535751210859 -0.67044106236315603731 -1.3506798740926191371;9.8667381164120566694 25.937657976564764795 9.0370361063664734758 -0.82879243398290314282 8.3986772930107012058 5.7212713809053754588 -8.0567078684727988502;-0.54964903913145435332 -0.85383463466806741593 2.0622682621272248049 -0.78831555296721023129 5.7626177269471368092 0.044878580927696205827 2.0996976597143417465;-1.7344502597249535913 -0.84025838091699389665 -1.4110306048991339001 0.036699877540093996109 -0.93885398766824290639 -0.18464651169353782367 0.79740091695439574426;1.1565351976778981413 -3.1518858265970823851 3.8981817174281276905 0.85520185159576078693 -1.1245734285332527058 2.6558182140428594487 -0.62164374952251488793;1.0345646861413000384 -0.79940705934018341239 -5.0751990324630638085 -1.9958729145920874881 0.77143782298398844155 -6.1114450753563254182 -1.0515671369587946682;1.4323387229651793895 2.0658928564333409739 1.926686655132392012 -0.67238947533388571109 4.8516430672383057399 -0.41837848375442454607 -0.067282189226032920737;0.26435435538265272815 0.015270169863406353461 -3.6055219378009626396 0.92075963943986338656 3.4625473418891252742 -1.2100897424672343305 -0.56103435276460444925;-0.25485052009277231466 -1.3909054054350715735 2.9623169276658631865 -0.80782614251498696678 -4.3339606481503212265 -1.6123721041716632119 2.0521396701209404512;-1.8111985096184834987 -0.92357010346246171117 -1.4505933484980868542 0.00053962936893154483942 -1.3969891724714955661 -0.2924447141336844469 0.90007537670648707362;-0.55206956241983728972 -0.48612176619493796537 0.044634682934091174378 -0.0057623611949906899596 -1.6380336239735284742 -0.010981328619860127038 0.040711620226363619268;-1.8497636705455289263 -1.0712278196405333741 0.085862444542431831662 -1.7239961104300425276 -1.8601816119037357655 -1.5657614252841949298 -2.9274625960050713047;-3.1874441547498943983 -2.2559871291513915459 -3.8757684946314001628 1.1685116011553020599 1.7394223554132342002 0.7976150386141831472 5.8568748791566216383;-0.68612627077917986984 0.29537851832310363376 -0.17701321765015967657 0.13446897933654033963 -0.66576767850623252976 -0.4462152022121901318 -0.51905367311014172227];

% Layer 2
b2 = 0.40027923568135159726;
LW2_1 = [-0.0021484680613203452348 0.067884783767774292684 0.080208589826777185183 -0.058899190922317816443 0.11072510338785691852 0.34474797989761724049 0.062514571549280917306 -0.13910898693426099193 -0.40351201861366065016 0.023898143403820890085 0.09038196669753370549 0.068462731691608824658 -0.014452864079954021864 0.028268705412470871569 -0.0064003671494391421726 0.91830349396937904771 -0.095192071008393081 -0.047533748473439121907 -0.0039271648192945518216 -0.02278219373212292051 -0.16503657243079650208 0.045419086594314414529 -0.037630854653653726671 0.034119997729348296167 0.024479813808169999245 0.0087353573561086573368 0.019762468071737041703 -0.00051225973288626680015 0.058242844920125026731 1.3550595419121109764 -0.019226646434014841441 0.0022451141951759347529 0.083778890197619401703 1.0051338001726999316 0.026579537303620597716 -1.1696460186414778804 -0.96885355164496833602 0.0024224574783155861796 -0.0037059347592591400725 0.25423286991014021341];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
