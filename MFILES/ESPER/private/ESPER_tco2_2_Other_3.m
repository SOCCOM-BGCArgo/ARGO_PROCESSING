function [Y,Xf,Af] = ESPER_tco2_2_Other_3(X,~,~)
%ESPER_TCO2_2_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:53.
% 
% [Y] = ESPER_tco2_2_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5119639718160627;3.2677821265466678;0.79175524576714962;-1.4373146234448393;1.3691796101900586;-1.6488389118292259;-0.97280279329367159;-0.20545699660583847;-1.2144422663750154;-0.43862781874942514;-1.2596999320682372;1.1528339787371493;-0.081021482830191893;0.2611724180968259;-0.64064828347292779;1.3357828727211851;-0.28780695497462916;1.1131667553963094;-0.43447997773755886;-3.8055154040172137;0.93580472232489453;2.2153296218326712;-1.9119318578331672;5.123681022153983;-2.1267165424151067];
IW1_1 = [-0.030512387479017539 0.18797824711336703 0.45414766077529678 0.027278254098867381 0.21466818960505935 0.59191429742019797 -0.050678395523011441 0.15651360397612959;0.22087514743646103 0.51521210975828435 1.0233447175460875 0.97536238581642276 0.19035943153389248 -2.2169707894911359 0.13382691370509309 0.58402448173349863;-0.24231415813384344 -0.36002956384151358 0.84400595399709344 -0.19211382322773432 -1.7608408852531472 -1.1715084591179963 -0.40618656557716726 0.78387251580656236;0.16481581718325464 0.54036878100454189 -2.2897217580242244 0.50573107847208709 2.5267184734663015 1.8262578427829581 1.03502288265098 -0.74400576406461483;-0.2270418124078884 -0.66264862587610451 3.1773459425123303 -1.0149522263002344 -4.1828825241064918 -2.1370970329871044 -1.5656925737883456 0.1844562852287889;0.18578223534153313 -0.40151068117031302 1.5716504288882747 0.050555395082877541 0.12927186185925801 0.083991443344634403 -0.54078021363580753 -0.32576315882915907;-0.12973663033228386 -0.61802620442936262 0.2045153489530345 -0.18407637567695936 1.8061547683059687 1.2411472517251732 0.084828294906882873 0.41077653307018763;0.026097828062264725 -0.052952989351721103 0.098416631951486019 -0.063676859423615076 -0.56515055344470155 0.23120423617215222 -0.45147942685410253 0.072207300030800059;0.12148778406358915 0.35868615213589061 -1.642770670904989 0.33939202838642851 2.0908234375612498 1.584696258120613 0.84963606851619689 -0.61236173651272541;-0.077110813857007188 0.091959294313007867 -0.28727352447476745 -0.13814796785783134 0.47880148813675261 1.2633842107536912 0.47224755769271787 -0.070602491781870419;0.05880785439707592 0.28799455786075462 0.36121860340947759 -0.13069577702167845 0.69024148820676012 1.2475673693910954 0.078901927218154658 -0.39752805110806838;0.054069492162342726 0.30502087050380422 -0.55789259020127802 -0.059857672762694027 -0.22918778136757031 -0.52986721449660767 0.21812122511974408 -0.25082304709469833;0.11271076178198347 0.042398162478898452 0.075457135785417809 -0.15228676162230692 0.43413448966280482 -0.070212199576975595 -0.00034869480799887455 -0.28749549263567753;0.0089320994103080902 -0.34584704474126365 0.48154181994364537 -0.097290934701349446 0.67656733069605834 -1.3049153719611877 0.69894024756372564 0.26022429756359333;-0.11451047507055047 -0.065606976093803906 0.57853011360511153 0.0016236810248497408 0.019040318635814436 0.37119474990802442 0.089885131300820098 0.092884925056871417;0.34635478499814132 -0.10303906074214012 -0.15845677011340978 0.069070278233032398 0.034377146208984161 -1.0116578219321355 -0.96493596490613787 0.72334064561766842;0.3819363430531551 0.12675449543362374 -0.2190253447521123 0.35290501690827325 1.3555107807103706 -2.0629791623689191 -0.38657929770034116 -0.17174792860157165;0.24909392919396811 0.076320243607640975 -0.97962035602784892 -0.089600439597693815 -1.1194818242264124 -0.044560698937921028 -0.40446439482262092 0.26846966099114411;0.037421259705469126 0.19989253116937769 0.055920092187641407 -0.39391396921787675 -0.66352431827298275 -0.57432549362076946 0.44391499419610814 -1.2360677252037555;0.0027683837532497162 -0.14527384917567873 -0.29163426565306466 0.22555981493217434 2.0740382771857711 -3.2109383054224905 0.12238343393538703 0.064547170861940895;-0.29678943769786226 -0.40816247705158182 0.90011220183798091 -0.17599433666745315 -1.7392550502066442 -0.67869743436592389 -0.15327936197196135 0.62187187947122813;0.15781166256112605 -0.18895093158144835 -1.1191891955808266 0.034600535566385621 -0.18879846318091995 0.024100247499033181 -0.0029730011953269936 0.32398548145975242;-0.032774477060561857 -0.15372665145218142 1.1233919061309732 -0.17532664270569795 0.024490266301455822 0.14097527777051713 -0.18014454693074097 -0.42058938735294255;-0.022170928886865376 0.10961369107479753 0.51981429748592078 -0.21933302787644057 -1.6302724051833115 4.0415397712142971 -0.54137849580937947 0.36252884979422911;-0.099137690739464726 0.099123016733982119 2.2958039493626115 0.47554252185274315 0.063639142150448108 1.8558571356661353 0.066424717803826722 0.66467086293798594];

% Layer 2
b2 = [10.075888016265882;23.007737689032439;-1.374894214362278;-6.8751424841166004;4.9551768636558675;-9.1565402608151256;5.1627744803906515;8.0634193114968831;5.234997699762939;-13.305327525385739;-5.7135604851623949;9.5205890934842312;1.0942585341143691;16.295602224943032;-12.628600536852321];
LW2_1 = [-2.7533825318128136 -0.76664682377263105 6.7214162813139948 -4.0932895654338282 -0.32441333982687515 4.8359736892841214 -2.8439963482495765 2.6852927864615301 6.1901033776089927 3.4998056880853592 -1.4142818708504785 -0.090570821848577232 -0.69909179385271303 -0.28015927921412964 3.0767633229261446 -0.55127211574105084 0.26908946526555022 0.63811564132061227 -0.64908940585886055 -3.2063950470172693 -6.4472815494267213 -1.0431684673920358 -2.4953492056088789 -3.360559845568122 4.3895863221357763;4.2097686645114223 -2.5792377454102855 7.0017140604120316 1.9865374775791045 0.55297174798050797 5.4745345935983032 -2.2050595050418567 -0.64993497132461797 -5.5498123305340394 6.2305173721799729 -2.6099478751993903 -8.802533120959259 -5.0092750861983086 -2.4194541880750586 -8.0399789801189545 -1.9061289916723494 2.6794637323488435 -1.9206977110144334 1.2190959859246533 -2.0131005381768916 -8.5561471330616978 -5.0924206214445817 4.6538421197031372 -5.4481258439137275 -4.1615850955513967;-1.2888468480053439 -4.7612075242481842 -10.049039322536808 -2.0148422500190954 1.0781208977399608 -1.3938821401258439 -6.263743953205041 -0.77480762950303228 1.306759035923164 11.576433050246976 -2.6757892037109094 7.7896750163672959 -1.1088223577718295 2.1153646094080565 1.1239963429525903 10.832088534543367 -0.35981994722141664 -3.7057104940051695 0.46926991784039862 -2.4637203713483617 5.9814888021298556 7.2737468295022332 10.566618979880291 -10.278033585778127 -0.58181001152742839;4.8240318433778961 -1.3121420842389826 0.56698318003281567 -0.56078159182669829 0.075493550462100295 2.5845712293680694 0.45131633754122102 1.3999929224840568 1.1928143554570503 2.6631772231902904 -2.118034993934133 9.5050728796838637 1.7051443896673151 -0.43230824013228547 3.3201349065239767 0.884447436798938 0.10940412220432263 -1.0740763015780272 0.50347239273693156 6.3577903784735454 0.15045388259879808 8.5361815715488074 0.9843651016978664 7.9911006989588351 0.59152074488970741;5.5556479953987026 0.056482522719341878 0.14507554359410499 0.11349060658900507 0.00087675362391659544 -0.99783021276361761 0.30533788307899778 0.44661624379231851 -0.81826522026132165 -0.15554655645706691 -0.55614083398752279 -2.4061432122609507 -0.76773415172198312 0.16220601091776926 -1.7752076922143252 -0.61813232533317086 0.16039198799156745 0.13706962279994589 0.51489525516933954 0.70776818693859278 -0.43082945168374964 -2.5205554066041076 0.7746789617233022 0.82317669715143205 -2.3903182542634958;-7.331076791016204 11.374952869133452 -6.9654255934613296 3.4914318412710115 1.2132540778263341 12.544555681264852 1.7605662430822648 -9.0071072964836656 3.3215232309681704 -4.4863213335811629 9.6365192034595459 -26.433126395609367 -11.379928798495127 4.6907458792924777 1.1880630889284531 6.1642376051048045 -3.4171942941980036 4.9292903213033048 2.7380358159905955 -9.5517191345553965 8.363362750504967 -3.9289155511801264 -31.847565716931935 -12.364372081290636 -2.8880056860397278;15.09261224228513 -11.474085704228418 -13.861400484899804 -7.1634029662216072 -1.7357552745990292 4.9019375998785293 -10.122688101716525 4.1405926531474684 2.4208368835191831 8.6144718969527663 2.3497172769087209 -6.6498434066870891 -18.566063496602361 17.35483335824696 -0.51098237010472713 17.256236451433065 -8.2710599309157598 -18.695350853913354 2.6093344535950491 4.0233653433827259 2.140826212049932 10.437594589251972 -9.2577629464427229 8.2251580403098306 -2.2137035738812751;6.7139540784054397 -0.4582968296904828 -1.5559505801443716 4.7257587762345938 -0.53042031425259106 -1.5304478874674787 -0.043280850546631194 -0.011821940380616239 -6.8933447989361243 0.064108945230794079 -3.1378581728967947 -8.364776569756625 5.2361760857333826 -1.1367665249687795 -11.760985962037415 -1.6909259066642863 -1.7847760884777575 -5.9000107821347347 -1.4619489828439087 -3.3339185910534419 3.125434537133823 6.6290660232931211 3.4726461907349084 -1.5967694557769752 4.1691390826325723;2.061670359770253 2.5693164055894706 -2.4368248853316383 4.7221879122794155 0.18278772408876043 -6.8722568588123218 0.3511236922182826 0.056019198622725058 -7.612796111068711 1.4927454247071621 1.7464938701353379 -5.9712463891433165 -0.91672873148339096 1.129845816643269 -1.8553292713827068 -2.2286526532586457 0.97079635016543753 1.4117653410457689 -2.9309634549532144 -11.997908369600804 1.6300358666119268 2.9527234374662452 14.510852842351595 -8.6867248186130688 -2.6857764497106045;6.2171685320893424 24.983261904907916 5.4384393885728768 8.0432171499422775 6.8266958954092427 -4.7480873736438411 5.5268600021615581 6.8823073292062622 -2.0725737218048423 -15.114440021363185 5.8783468574519535 2.7137727567218319 13.768749938021946 4.9207501738835111 10.254596778919387 -14.306810004597116 -1.346162786571405 7.326846557293436 -6.6272245160347065 -2.049335768518779 -6.5271421788041204 -6.218542365117683 -2.3027544817298091 -2.9326297217867858 -4.61150586663656;-5.9047539497564623 -1.4828088130110315 -3.385711131554499 -0.063769695658276018 0.19588933893479549 -8.632530205036522 -1.1028731196059265 -8.9097393709132078 1.0261541724388159 -12.689853254695207 3.4886896295754366 -19.053056093482084 2.4928237165883309 -0.31189268546871785 -4.9424538322626272 -3.5454460972386692 -6.5314411617736736 8.3328397084635917 -1.7148000014341294 -3.0348711194311528 2.2619075270581841 1.2202245235878255 6.9841590689036206 0.56509111499482467 -2.2483667451616736;-9.1639610799718856 1.7208625913717863 2.9617731963362051 1.1699643847579793 -0.1868200588776143 -0.86639874135070727 0.34085864410271505 2.7966248982418302 -2.4679644519841109 2.0466021441602229 0.094751318819690664 -8.4219168826030995 -0.3056059549416576 0.41083780793254121 7.0545943870758769 -1.1442157875085328 0.96406033164521421 1.1703688732884709 0.90700594081059172 0.36043036449379262 -2.7783136828943777 -16.033251873200001 -11.24934972740324 0.7771105368342538 1.4347429591928709;-10.015046794391264 -0.053330336924846608 -0.071187930231150026 -0.52375467162580847 0.1655402165462109 0.28063921044262824 -1.3259633758915399 -0.97136660042767109 2.0388898081001625 -4.7689406642672365 3.3238415534565582 -7.4631345495207997 -2.5812779663722796 -0.020871182412306812 -0.044370675304553533 -0.63834819786876706 -0.42760225316157063 0.63589370055965688 0.10394817626580871 -4.379717953062765 -0.27297543763532056 -1.6419213872196681 -5.4391202556012699 -5.5198252036247251 4.7857646145265544;10.031211943509406 -1.8863878386413517 -1.1728637801753627 -2.4319660403340566 1.2842874656675591 -3.5090217844468681 -2.4949957622125813 -2.622412878810958 8.3146329202983882 -0.048082668408596936 0.45152838059481465 -15.979909414653653 2.7719292238059348 -0.41408686882905854 -15.029255145619501 6.384197501692924 -2.3983654197046516 -5.7234260588336792 2.334393595085773 10.970251334403534 3.193116000196857 4.2984621981180728 3.2564389992878873 9.3544038814875634 5.8235887530926052;19.8293654661673 -1.0638443862352778 -3.4493085786917113 -5.0071735223715796 0.15398321655018987 12.824594121896054 -1.5206137286453478 1.3963893253479625 10.916290936364355 -3.9667350763059206 -2.5729283291878189 5.8222906033219024 0.48705959451388997 2.4662077676588297 -3.7138302332409032 4.1296166511454091 -3.8396485313157838 -5.3857672211301635 -0.80511778892789021 -1.7098368026020789 3.8926640467117108 -8.2342525856963444 -31.180073168660243 0.19217230202967492 -13.242994017930895];

% Layer 3
b3 = -1.0074995939938132;
LW3_2 = [-0.20077805371233717 0.10492945843038988 -0.041793717137972204 -0.75103008550533623 -2.4475490802599329 0.013206459545162698 -0.011798507498311839 -0.32395958028297872 -0.3268193714329809 0.083154896850972895 0.0648455295388803 0.80502371009354701 -0.59982809644452451 -0.25668507363131321 0.12547981932584371];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
