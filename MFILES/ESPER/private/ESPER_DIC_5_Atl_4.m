function [Y,Xf,Af] = ESPER_DIC_5_Atl_4(X,~,~)
%ESPER_DIC_5_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:11.
% 
% [Y] = ESPER_DIC_5_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.3297621165594946113;1.7838067200874470064;-1.3446914933409399584;45.55681249377317954;2.0321024765229065423;0.48253035457536036512;-1.5828038472758216848;1.3928685232868924793;1.5597550150835981508;0.73799927811217358453;1.5571310531349109585;0.90703580159785646142;0.41366003142175244989;-0.85041579340777573304;2.5631905698951644723;1.6238144200638673365;-0.8225694465117975307;-1.8953410921828748315;-3.3879432132079667639;3.1549096187585572437;-0.31576089198978513073;0.53930383689727601215;-0.077491410447264735817;2.8241512722615480513;3.2360576979005233333;3.7088778069657037939;2.09412596037723997;-1.9198048185721450221;-1.4983667527103456951;14.771208097721144625];
IW1_1 = [-0.8882531081291598074 0.047702578530108716293 0.47276076090269869567 0.93815538539496945436 -0.21279639751688025906 1.2587987105255273867 0.80130209353599402 0.72448856804634076401;2.8236643421705025503 0.60973692178356841964 1.972127387911793317 -7.785160071453655739 9.4372287307065789719 -1.3969920905394437316 15.719495545120912183 -8.149588071653129262;0.64799251203950614109 -2.1224012725256962142 0.96002128825045440763 -0.051568539286651476905 2.2370078795187349208 2.112883418539702074 -0.63973660844984181484 1.3924892421811820853;0.67072405642383403634 2.5290940182274410652 0.58589603552008873155 1.4572004873633135347 -30.181447005673430084 26.909545650831788066 -3.561725406584616227 -8.4934702181808958699;-0.94136268144579093864 0.012728754785964328453 -0.57411483451941203171 0.60117904347029815781 -1.1176812981395718438 -0.69787209032887442817 0.71569607384212863277 0.83218836132531259775;0.20503306013580405165 -0.33155090834987799298 0.50428275470500483202 0.42236706802199763811 0.19944616576797780105 -0.041950294798549794817 -0.089939364850771197357 -0.051646039360182569022;0.20134047228777929295 0.59516286622284964025 -1.3996064732227482263 1.0126502368675678323 2.6070484272743401633 0.49947830009817639763 0.21707443045577823337 -0.51345226736414739666;-0.40782565089306971329 -2.6977020892231293736 -0.27462691595770721831 2.5393840282315975898 -0.46018219848411595629 -0.83111288770716007512 1.5074531424442483285 -7.01328247064287158;0.58632540726863924263 -1.6543378539992688037 1.8952876158213933788 -0.13433583247447325459 -3.0320609763519672519 -1.3920085053704840394 0.20741558426092504552 0.34363734647476795736;0.19665120862194915285 0.68756731759593225917 0.33669837966201493495 -0.91662298113252005383 -3.4566231588448306233 -0.46958448177352046793 -0.57829287265465134649 -0.76905409224076237695;0.39504917261759292524 0.31991027017153361722 1.0379014370975441217 0.8887114637596854605 -0.079960785726876315582 -0.021378290979879709804 -0.39019486704545269795 -0.64465364399520663774;0.17026253123859536043 -2.3889067460605066806 1.4788338529837621316 -0.59677131056497711992 -1.4932571356532338136 0.13573074493489484249 0.9702163730596482516 -1.0280283387975004405;-0.51658712399360928735 -0.40252400596433962621 -0.75858980147297228047 0.90916294347001336273 1.2149231953068651002 -1.2146830197050408895 1.2633182656052233117 -0.53937546182311890686;2.0864166576148814869 -0.72043625754228179936 2.773642520094870445 -1.6473683002485468574 1.9536852685110255301 0.30167386781410099328 2.4072125973672831023 -1.3447012034132497238;-0.91407149595842407397 0.27991609762362223979 -0.90099690284596989365 0.59557145260054478175 -2.1924954406612990887 -0.55331410187060148242 0.41003582066104865556 2.0036197465142930874;-0.0056503325328802183475 -0.85343649163267043534 1.2502539315345886362 -0.57325876005534204261 -1.2510920186210949812 1.1577912946318682508 -0.36007809874732482625 0.31630062702216177328;-0.26975457209328157493 -0.42682172419849567779 -0.55885073237526161627 0.54700930921634438597 3.3528668918703998791 0.36082174089190999222 0.54021451196159120389 0.53451803851654478006;-0.042593825960272696518 -0.13505770439568029473 0.7038922816111354841 -0.63855289484079724716 1.3687746679698871155 -1.0375030076693312342 0.14241806247169458421 1.1614333291936260739;0.36078001031458178938 -1.1840545649245053372 0.0085103006266793804202 -0.083938457270760324924 0.84246444259771524621 0.5414640598331833532 -0.54633983407180486402 1.0343395422400136763;0.41573621865509596818 -0.6047820830598038544 0.69632405950869691313 -0.63047993062385232488 -4.8040992469053458436 0.069980890160039069259 -0.8682056317920855415 1.0354934284965484625;-0.13658236514171834264 -0.094384543029617545828 -0.15093603429490415335 0.52518303066567328941 1.205463460554402122 -1.1391989771638950657 0.57281725384612258711 0.23763904590618753487;0.021355068806545779436 -0.52256875310384809374 1.0142909500088383989 -0.75129086668624034395 -1.3424025888670265694 -0.43117741972791234772 -0.22158210882984941126 0.58405174445461527366;0.55735486669482392497 -1.159417954548566998 -0.64890590783284496368 -0.072563445676116278271 2.0226231167569768132 -0.7045855372519336246 1.4914161090293156509 -0.6066673014027172961;-2.1295634436986952132 0.51496108602289081269 -0.4255649546714933007 0.30511868866310454251 -2.0794402090029957542 -0.50830723558823642794 0.12007229393060313283 -0.80942022385124390293;6.0182773732756436047 -3.4723278511325861295 -6.610255307914090217 -0.72685443790064419023 -6.1937896939411416497 -5.4066474457003126375 -11.373784942997172465 2.3860531223587941874;-1.8866412791645608138 5.7329572074988437436 -2.3010543648464114597 1.9005630294235458244 -1.0686910803955722571 7.9315286587906435045 1.3836959982320289342 -1.504854956840660174;3.4097963878928090331 -1.8707104538433716456 -1.5292316482156091961 -1.0743128630318974359 -2.6287028771549132422 -4.0028403716254805644 3.0453516187588651754 -0.64491447171604399102;-0.83594008567164945767 -1.9193788996189198315 3.5857368253844872363 1.8592298549704580068 -0.048380367249763495119 6.7519753752026616667 -1.1745788578726001905 1.0529966250771745084;1.4139004936762606945 0.10767496902791384716 3.7361138604307990718 -2.9985685575038942829 0.89615584126385483543 -1.7505271755324154359 -1.5735299554205262051 5.999001420911363347;1.1435021946009156224 -3.9324779739372681675 -0.13386932846889207371 -0.55937700625296538082 -15.007560534762951931 4.0124738316107837477 -1.7602897095102396641 3.9293165348243217494];

% Layer 2
b2 = [16.328659685797781265;-2.115594064997861512;14.533169644273973731;30.614916972136896334;-19.025595586030757289;4.521040108115117917;-38.005327586090430714;15.766303007780305023;-23.453441521154555716;-126.25243033822360417];
LW2_1 = [-3.1438718830991123632 2.1064344503031922073 3.1283958797829134468 -2.0081590449507435991 13.879786178574727629 -2.9334736521456870051 -4.5622296793994605579 -0.81933497261177845594 -2.2394350311838815415 8.7057897319557060456 -3.7679032802052803142 -10.920933987846142443 -5.416546787462272583 6.5901101341902998954 -5.2002488464354623687 4.7582561114705770322 -0.30622545982432325395 -0.98385216281873644206 5.8962465253586024971 -0.80284361460871411786 0.15165143796983260316 -19.367503272443400419 9.8754382926378081464 0.070103356355091739349 -6.6019464460074841483 0.91578608434170349906 1.6452928000196473945 -4.3614201670606043137 0.35718535452280431031 -1.0969425056879689162;0.86171609622815970031 0.011284122245754518027 -0.22027188134394334873 0.21468168645432889052 0.23863597837375280508 5.3975653659119098293 3.0329050446215681802 -0.17090306541065417023 -0.63110841466801881339 4.5095047618821793023 -3.0826117743249872305 -0.55334120805745823368 -1.8664254230001118273 0.068788448655808770438 0.073253645403607112185 1.1098451668752815635 5.3063136636418830605 -2.1622402306258345916 -2.3594466215279896737 -1.2642212539822306194 4.3035170578710895128 5.5147014354256107538 -0.35320251302871896737 -0.39192006208565660641 0.062345175889678430825 0.011591310008698155545 -0.099869858023868732233 -0.053579449346697505252 -0.39046878703788912013 0.51973866427251613764;-2.6915948528496533854 -32.014599518974627301 -2.7922054007439824908 -2.1624850144352474324 28.390808214689283062 -5.5847408382571606111 -9.3791578844949334837 4.9496933351564491588 3.7042529366910907918 0.19269686851011899598 -9.0491727747714225671 5.1841787370783087852 41.019407652859094071 0.21430557644541176066 -20.232781283968918729 -4.805571715555600143 -15.371073984423990311 3.112752791706487443 17.329720029397154946 27.739183343162590489 -16.948196195571949119 -51.018968444885402391 18.58170460401530022 -24.567880579446946143 10.630354496317771407 -8.6946381135205275115 -8.3414578983117149136 20.666483785781892379 0.6412041003893029778 2.7292602859193384468;0.63756689974149671762 8.1744618766151706524 -2.7223449743813881163 0.86823687590262776936 4.8204385446924131742 3.6601718443880257858 4.4992987407399356314 1.2135898614305904442 9.5055118788467503066 -0.95858047994457473706 -3.4776852813371621487 -8.3446488660766195977 2.6914248715232136355 4.9660627975299167502 2.5410347681588625335 -8.3705520409863698461 11.795821127091816294 6.5946041702371722693 14.000092195969886077 -4.2107283182582841974 -3.0663895178728481916 6.8962116855055333176 -6.7130215246374502769 -7.9860163201727178972 1.2232173201246345773 1.865447715504991999 4.415728482506871444 21.545544520443669967 -1.1073209171732845135 3.779052689932139053;-3.4029774301241673129 9.1994758778962300028 -1.4698692023282082797 13.007849928884352764 -0.46474518317116969568 1.0119845320704092817 -5.6422495709542701547 -2.1010172047286914676 -4.8095377925582321055 3.8622439430234276614 0.88409023109869644408 -0.23388071962136236515 -3.8879994434348845722 1.4796769778475329371 -1.9174048243381800471 1.3182129741244279497 1.9829811257606717589 -2.6230419510711859843 -1.1920050492898353056 -0.48541912003745957271 -5.4862499056149456322 -8.740494633690319759 -2.4091538032363191135 3.6311553361370076942 6.4477805998143260524 -7.7358782423393686045 -1.3401123261318281799 -9.5641140083889268908 -1.1487528710153704914 -1.1631304364921417616;0.19528087726611376151 -0.46801164378624038331 0.83012524671249043884 0.089099530944042409919 1.3688524750819506259 -3.3894251507675332569 2.938839298207116979 -0.074137896664458663443 0.56379006359330052778 -4.4592406030048064025 0.42373506000390537274 -0.53438519461873157379 -0.90475848329130448278 0.054007801095703883432 0.39008901174779503362 -1.7969227061026575853 -7.3814942770919707016 -4.2763674957209101279 0.44013504760842819818 -2.8133117398697260469 1.104593423088936488 10.719571676985573561 3.7202854241352123488 -0.19349254077312913469 -0.02705271268043282773 -1.1081171978593222782 -1.4617014253032345472 1.4947414581817430879 -0.11484401415722354789 -2.4180733430196665878;-0.7102292552967982564 -26.323385858159948469 2.5294550283265690993 -1.7855864086563320026 4.427565958295300419 -1.3548147874836269366 -1.5847884842338364475 0.96771362989088949291 -2.1832164126089654843 -9.5210772588779555292 2.2040812114996772841 -0.95682522874348818753 -1.1993515651537061117 -4.2747846146985120086 -3.1732526334850414962 -2.390717580222568639 -11.170976388728178108 1.5740527382104592125 0.69567914351277204688 10.047262904384838933 1.5040220902567571493 -13.136229634918153764 13.416362147864978382 -2.856865862838829262 9.1989401298804551743 7.9303646400446234921 -0.64003917370602392278 -22.19969392043391565 -4.1356962790120030959 0.30396467596038523329;1.6142105063728411363 2.0911364519346391511 0.42858054941505752122 -9.4862125237430721114 4.1688969561542448261 -3.9429070264123060596 1.9135228256489373866 -0.11252676485847522281 4.6424358159369765175 3.2383455453702079119 1.2481050453042847881 -3.0120820263957441831 -0.86681852029516481828 -2.1872231221940263701 -3.3073621483567472445 -0.36401317933437943308 1.1839009540687237543 -3.168396235822807494 -0.035934017146277065502 2.4125169733027829189 -0.07628693429768429457 2.4674018052417552305 1.6078002443059749016 0.070654455380930764052 -10.359435044906932788 -0.9138557026052254173 -2.5469513079811796352 -6.4926693361550480432 -0.870259616975257555 -2.3008278327200879509;-1.4697012611196826892 -0.32120814350162174566 -1.641720863340518255 10.43285366472525233 3.1701563298952262215 0.27745293014490446382 -1.3735387698498242592 -0.055905654681154180741 0.43177026810027047121 1.585237387051909197 0.13682203335470274896 0.35913680219218746537 -1.4862916756656614492 -0.10155091370302400666 -2.1241520468017887069 4.0033204266128787907 3.9412301508704969955 1.6798528351461849972 -2.1018069141628425989 3.1864976971954988016 -0.45623584468346917165 -9.0346736049555946835 -1.4432182818644057054 -0.094985130522823202348 7.253102630114534044 0.31711816291931571588 0.84120947072805207778 -0.84807758527666099457 0.056813358112530597255 1.394407561565145004;31.102330669714742584 -31.498711949353420891 26.979938700178909272 -116.2813430008216784 -17.016259154269377518 12.019926937078428963 -40.494539139918536819 1.4619016646227667167 -4.6678105047936506722 16.160846012936428195 -18.475067199347510183 -55.154374991200555201 22.007041431097867701 -9.0901953012500573692 9.4699880641313889384 22.355746075609491896 6.3635730430164603177 4.0762928917530212303 -39.819344424671804461 -12.172850104327231691 -5.2663321637102864514 -70.524152996606574106 32.351755383483556727 -23.774160316099170132 -6.8894305300943745607 7.0307579775757886864 7.3756111016010512671 -167.06402227206373823 55.777025863096056923 9.4455592193070998519];

% Layer 3
b3 = -0.9140131109015424693;
LW3_2 = [0.0076432466136342807825 1.624227372250924839 -0.0030646955872937146209 0.0050661785777836422853 -0.0022793671624714395389 -0.12585558729570173186 0.031324863085999327117 -0.0072363418525817537613 -0.15273612714158055215 0.00080547705926470954032];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
