function [Y,Xf,Af] = ESPER_phosphate_3_Other_1(X,~,~)
%ESPER_PHOSPHATE_3_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_3_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-138.904784718693;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0042772329208737;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1971707076815798487;-2.7917283207276000212;4.052399442235464555;-1.7325982987156927084;4.5714809071797635198;0.82504722614420988869;-0.6723071193732228501;0.60700789755980932849;-0.10494724260399099225;1.0568063705932513319;-0.11513625667015545129;0.0841038098459236938;-1.5327579136586093611;0.73573766088043213163;-0.89190308474958979179;-1.1553518194553191734;0.33618904065053983876;0.56634260179628903575;0.6852380369270851812;-0.12060491456826231971;1.652822994231061271;-0.49811118458260600361;-2.7315643128697870701;0.17701540152913652904;-0.31431710228934722773;3.4427499476435921011;1.8577265153187141333;-0.07075862383632522401;-0.33920069599574526054;1.4555899724978802467;0.84591074032228497082;-1.2444555459424622157;0.13620792562923550451;1.7311924825229179081;-0.9524492033925977541;3.5771756342850173915;2.4270763686686871452;3.5419398333452414285;-3.4430658776756111195;2.8385204404511625853];
IW1_1 = [-0.5196797150832080936 0.25190251822182441188 0.12552001607865415078 0.53764120377695889808 0.95443143248185136063 1.186200572611386006 1.8753223329065773495 -0.44645477970328817374;-0.15707185519803282259 0.44308662083279809485 -3.5681739029089247772 0.93074549616144441888 0.9406955859750286697 -0.27800343683965789143 -0.59644506726800361474 -2.4162266504661555899;0.048428004131830272583 0.14716147331505613494 0.20793075269580274522 -0.025775277102592076411 2.0484125669438149053 -1.4737611644759882612 1.0649095227355307447 1.3752860577766425898;-0.56947789516265823195 0.13896227021289006553 0.9552994124266487308 1.0073146362936493681 -1.1726601073484685944 0.18338356085636073334 -0.47580596459455165581 -1.8229150563671610019;-0.40704897957908214856 -0.51523290793435516655 -2.5953783351102828192 0.99606857003839710529 -1.2393307578941203939 1.5759926794277065998 -0.59929178726104359587 1.919231857776101613;-1.5835367870060306217 2.1197008720553105476 -0.60922290896218478373 2.7839058024180198814 -5.2130358841060324693 1.325590957327431596 3.5806136538909218991 -0.8723573245351677885;-0.29167223668368164047 -0.19795384283012384952 -1.8710329158720315768 0.24216503444408646328 -1.4592734197809544838 0.1017909188858979741 -0.39116062361847808715 1.1235009669626077056;-1.9563081221498652695 -0.12250969077965688514 0.79875574579494679206 0.78401045935516167074 3.0696329344433901376 1.3292756298844006224 -0.16141610707670953073 0.025029406337118361575;-0.24359305183478616175 -0.21463310630988557959 -2.041336854222242092 0.13967992546458574132 -1.5434029311044150656 0.83887712152286986189 -0.68441569879764785345 1.2521695159455210611;0.098406186341762499903 -0.18838792735432441372 0.56086406348540884803 0.078932085621836275968 1.238879152048921517 -0.061330695019484217367 0.056613642246979234418 -0.49142574516831383225;2.3474634523164121802 1.2518084775970628186 0.27561650865596248883 -1.3294820136716472003 1.95708753486309317 -0.59801147953791167211 -1.046372667046173488 0.88414006961397983986;-0.86581941229659220571 -0.71221944836626716047 -2.0754190513437276167 1.3601613442199120829 3.1317347031021030013 -1.1896352167621424556 1.742997531443513326 -1.4322714717336109125;0.17753427072715741164 -0.30177688976494598805 0.42468387680180713639 -1.1201628572879698265 0.3688746636850517846 1.0279179794424790906 -0.45996990551304178796 0.28729206977972804316;-1.0512569694288727007 -0.37800053710894476744 1.510872510622866205 0.40030231118250131361 -1.8283624070561679265 0.62822273348429646944 1.6412375865988446666 -2.5732585729207384517;-0.37239394095233713244 2.2050714704084288798 3.6188344928600151285 0.89080343970290865041 3.4244897469451198724 0.56077622989852493607 2.5051087818326145396 -0.35089795794714634392;0.36209495673698988139 0.17684328851941069627 1.0871148405300727902 -0.01409758078514122652 1.165480938072174677 -1.0657120676301146123 -0.014351813975851893807 -0.04099970288491610465;1.5918131896140781389 -0.52454016506240253026 0.067122411775622684016 -1.1050798536551238449 -2.7837338376765345949 2.1521049604272723954 -0.70259408371819853656 1.4429753649317853537;-0.59057243176069751378 -0.12940618003433410066 -1.4322356274386824904 0.60495800417620004819 1.2665223431087468953 -0.43823966619990534221 0.97312663390401177299 -1.0067151419532429646;-0.54306826444776024054 -0.16250234090429377387 -1.3796225202115450781 0.65379566209851114333 0.81219929150797731676 -0.19941071189306569522 0.73484430741548856236 -0.69234900163213330959;2.1961216966837233677 1.1643950621037528759 0.18939721421705707494 -1.2254814543491410195 1.6151744400838687898 -0.51554282129117401379 -0.91797526585607758243 0.83772587231640072147;3.2527359893652216805 -0.14095011797635048634 -0.09297274104756722557 1.366486399086108694 2.2559438720670001999 -4.0505461416650314632 2.8737514934123629118 -0.68479209038603361392;0.25413821620774529331 -0.81480675820761683248 0.032724471632645399377 0.26618315625727256846 4.5818032464607574283 -0.69717052820417380055 -0.79168299579421197443 0.62143566499579494522;-0.15462569171786333388 0.43569790102504862839 -3.6342513970826284542 0.88892539802178238695 1.2066603633217387603 -0.19393155087683014437 -0.64051765160134122024 -2.3539303792788195402;0.37042137797794560949 0.16497023197386431748 -0.96189171183140065313 -0.37288054553203164865 -0.81249904749113677216 -0.60823694854031362667 -0.77449999003701175404 0.93109319184590266794;0.34866702336869914713 0.061439515198968980281 0.76374902547536749342 0.29033207760725054936 1.4364419390555567269 -1.7523637406432042152 -0.38942647208109226753 -0.28079634610412984586;0.61129558725357879823 1.0473020572080511403 -0.10684400446171990473 0.81270963574074661651 2.9896133325058915631 -1.336584126969911912 0.71731454175214104385 2.2521911924805499972;0.99118425193157122521 0.75300183175979484851 -0.66226935817684473573 -0.33309203600643066956 3.4016596359654065473 0.34938893666559112106 -0.33018343897518209751 0.41498019357647986105;0.19565691077349389726 0.32896841228072404295 0.50107949631064585549 -0.66296272146600876418 3.9420300993146457635 1.8835845559910102676 3.0335453438368826795 -0.65122975742960287349;-0.21914606577290351996 0.57566874356389441392 0.45892051994266752635 -0.19210082085250099193 1.8763735549687710069 -0.92550207716930521507 0.20444120461163267644 -0.67993431710753704511;0.49724290810801613505 -0.60877093327752040963 0.041062064490990306254 -0.57359812015682731801 -1.6246621765087514433 0.15496472374470812716 -0.20633594838987623366 0.97466747081291660315;-0.00040816365848919059899 0.019123564006726458814 -1.4333370193459520348 1.7465865118157626323 -6.28370882693235977 -0.81141135599807190371 0.088465653848874420406 1.8489579466357644044;-0.5069152743767766367 0.42552572216109751935 0.18834469099731918074 0.70323581688697678338 0.79134602436934553538 0.22830846706047439043 0.0046174425738759478782 -1.1690049673875240188;0.2701806383315656368 0.19367288140543439945 -0.89117935226435884832 -0.43379307106404491057 -0.085674683099513870843 -0.60661629908878322848 -0.53161629065534654615 0.91787444721151767446;-0.75208343005315003715 -0.53175286656544251684 1.2052379021755996735 0.01907654508934026813 -3.2530163123909550116 -0.097975966552573165447 0.99411189628378437977 -2.3710014808084789451;-0.2494508606859980604 0.063347768710299887096 -0.039349850447047543534 0.19029439792501950945 -0.80403525640436612765 0.95140608592230457852 0.17788884362436074849 0.42090430523918864747;-0.15576804736610297408 0.25399149326671172089 -0.62167436581141077845 1.0358514090654666884 0.19831062476739927392 -0.8540004111872778747 0.35024416757382115239 1.788327516935110495;0.092042451578190104255 0.064599734818239856748 1.3886061110952441222 0.27210322910605316826 2.437231919641675848 0.39173463315804074591 0.78484890409373131437 -0.80934411904108238822;-0.37024664788561656437 -0.4574440981533900441 -2.237030419827387373 0.99414669759736296051 0.98762728827602241921 0.12074692601445377593 -0.49396267000747728915 1.4558354146252932004;-0.044402685202052281921 -0.15779243267092288305 -1.3035398974640568515 -0.20108365421770438286 0.61061857503165617445 -1.5900834651253621388 -0.75514503612222083628 0.7182383523096970146;0.15829861629388963795 -0.079987991322690202289 0.64915113374673394375 -0.21346563725854442173 -0.53150338708696953649 2.6817712517041352172 -0.62037590879660375887 -0.57889452059777879445];

% Layer 2
b2 = 1.8688538749075480627;
LW2_1 = [0.79306835437909017905 1.5709569465073895955 -2.4938886798789754451 -0.7267198148652297407 0.73579956027559356713 0.040433329157201554349 1.5496248061540844887 -0.10639895682949269962 -1.3562391561208773094 -5.6207389058545791372 0.98343968604702924896 -0.19530377947452171039 2.1120190479030873654 0.18377343273702437254 0.037551103423317605534 1.359738541439138082 0.14463195855748264829 -2.6454582001263959867 3.6619030909980332389 -1.162553655652531992 -0.03807249567910014898 -0.41566488913580362796 -1.5586431311092845409 -2.247212145512048842 0.68686439987157976717 -0.13071339974363441194 -0.40238380757822450606 0.10385103073337012547 -1.026508402675772258 2.0100540409540146314 -0.16339575577774237414 2.6140332041011062891 2.5753490344276483981 0.59325987684337766481 -5.3101527503142156306 2.3570362330180127941 3.6404348431355506577 -0.99603759789089385546 3.2468303681448809073 0.89936285310483121691];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
