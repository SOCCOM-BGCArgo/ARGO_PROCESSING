function [Y,Xf,Af] = ESPER_silicate_8_Atl_3(X,~,~)
%ESPER_SILICATE_8_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_8_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1280452509774119285;5.2785841092228649174;-6.8725726667491358057;0.37560191914319002171;0.90772115829356381234;-1.0959232802795930706;0.056513055138191138627;0.15749337007999758553;-0.86205468969572118798;3.5855431085831703797;0.85600337398068482297;-3.5173788927401248294;5.5240724698117515956;3.7800020981070052706;-1.4811967056157984146;-7.3809282911831708418;0.63608259674354461488;-0.20826463711925194411;3.1233184846362678222;0.12530365932841894261;-5.8347865608665410164;2.0447263683621383912;-2.0042101918508690162;0.99525832520219570387;2.3546853035052262015];
IW1_1 = [0.51851389047658991149 0.032605968596989227948 1.8346382743827458484 -1.2655272413481066796 -4.7135287823555636066 -0.66600265615892995097;-0.083927848160307502723 -0.56388948100057445512 -1.2330636384578341769 0.39523665106405708736 -1.7429554874007631149 2.6762763824005149083;1.3813419091262109095 1.2932245625470524253 -0.80362841465776979621 0.46900348713880007923 6.3681082716930772492 -3.6570268796726228544;0.12341133320718265798 -0.28134998388066023711 -1.6882907697589495388 -2.4872612273204208755 -4.0613174930063200563 1.9074470876082594284;-2.024705466943872878 0.59664660608157804589 0.12507657216510040254 -1.0059030756363189774 -0.058342267442581606518 2.2604993158486363924;-1.7674652207008938465 0.085971709836861198717 1.544327687938828797 0.39274246710794241677 0.21313388361878521371 -1.0636108802938553097;-0.68037299577107879234 -0.22027491596216883241 0.76357797678789185447 1.4102856220519155439 3.2956027769360489721 3.7778182688610439932;1.6076492545564402548 0.1559797802922102683 -0.21857446892628684676 -0.53920646491859769434 -2.5429264763338297328 -2.5113615592060711812;0.68368586740726899897 1.0586729152436340495 -0.3368608177562488204 -1.1779240201835177171 2.5625592041604856597 0.50393637646927413876;-0.044570330337666344556 -0.30845974180917457019 -0.77528205911060577016 1.7437303847878278251 -3.8564428359573414973 -0.42205109163241311121;0.1977848808830960925 -0.66622727419009675209 -1.4497191083059184358 2.4399286962429429515 -0.056675684529795530842 0.5599928591312030024;0.071750426037114872768 0.44354172819078546697 1.2895890818060409266 1.6479248593399811185 8.3406996035185958505 0.15314596804248883921;-1.4591235048954573905 -0.37044460280964569554 -2.2701841979748502709 1.3053758482190884749 -6.4675183724743652292 -0.16082287763806718539;-0.31838661173084042977 -0.34329742217907766033 -1.2137956279165205142 1.685717039277300433 -4.2747711855544476833 -0.051953356408190112803;2.205688109057307944 -1.8613268565476821514 -2.3975246096705120635 -1.621720281435235167 5.7922365607487629191 -1.1263433981353609958;-1.6839136973750425952 0.77361626133193395205 -3.472514484719843697 -5.4318470755370729108 0.94715732187408896436 -2.0137445119178978281;-0.092826005280943216236 -0.44846681284989298177 3.4194554525464866401 -0.26260393853493824157 -4.454055088012982111 -1.7599000199669210254;-0.41865082430569167116 -0.19366429571627241657 -1.1845834396805583477 0.31763013613534246682 -5.8236799496958315814 -4.0414984913890181772;1.1868324343519642827 -0.22905311644824477568 0.64254389178679183203 1.912536322193118643 1.7335666888647713879 3.2590471265531379963;2.0445053834114470526 0.89380345730152266359 0.6660694720518737233 -1.4705239194373875833 2.3025222519909851471 0.99942569051281782144;-1.2358758270187795159 -0.42156986302989335469 -0.67703219069463127511 1.3005899646282157445 1.845539646006834511 -5.2606052749208656039;-1.3059862097694636685 -0.0061310940189289939162 1.3356205841050252658 -0.23462415466097472083 3.1609219165214108571 4.8696880430427134101;-0.4931417034914279407 -0.43844546332018746737 -0.96964841443183813485 0.28535966491090125619 4.0666570500050180925 1.7645324018882078132;-0.0096562281321771852027 -2.491592423461651773 0.98616637434303677789 -0.69846403374685317456 0.22525617041082879322 1.2586575968699116324;1.8200185718867383233 -2.1586298523589619869 -1.0631330876699931487 -0.65083822719082817798 -2.1260156065648048163 -2.3614124743613547075];

% Layer 2
b2 = [1.2074701395302991358;-3.4051556633010897635;-0.8863014720316791939;0.21514708719890635047;-0.80019570556055275024;-6.9988724561790558454;-1.5918633101482630998;1.6540578985929068612;-2.5428116617852838388;1.3805201859695148681;-1.7662527312213209818;2.3941433937920773012;-0.036411418987826821292;-2.3338520286148765059;-3.5325507889577911769];
LW2_1 = [-2.8821924283024307201 -0.51973028273226018481 2.149514182326615952 -3.8999183036891644782 1.533652245218457999 -0.65391887992821839948 -2.3677427778719923879 0.43822665679056355126 -2.3865150624883573194 -1.0872837080823622991 0.064956794964082215094 -2.8424054965740874756 -1.5150955437706619122 -0.17296073407216294715 -2.1064047285883540361 1.6579003893828274663 0.94037349069286690906 0.34587845497037750242 -0.65753415843785412154 -1.7770073195848608005 -1.7839124935799164362 -0.0181367249316106878 -0.043038608585625207081 -0.1853595405561883902 1.3016528884868838745;2.336206948126283045 0.11121394663385798796 1.7198979253167110404 -0.57268905857611118737 -0.018202497465835847101 -2.3076632294060934747 0.25612664048303279696 0.16183489891219215995 -0.10756837491004642149 -0.58672088532897581636 -1.4460667720446140905 0.37233561527262731827 0.46116877582620896536 1.4954900738453369424 -0.57209737686547534885 -4.4769154539078312993 0.42538496601264658148 -0.54009718705851028631 -2.2025045092404491598 -3.2559051379974257578 -2.8018369728412122477 1.3988126334089818759 2.8820186312520474914 0.050447865990305582051 0.083078745243776230822;0.47913044658882791849 -1.3853695713001250578 0.95436921438772326365 1.2126380418043960496 0.70940782363281618128 -0.46379524225380069913 0.26023028979378526326 -0.10557542041888556827 1.6587219725975139717 -2.5139109283092020419 -0.90387196398558344868 -0.84372127263187246538 -2.0279089851720057958 6.1970278081237415435 2.229745318180119007 -1.7449844402639740348 -0.97967461586868409551 0.32215369981500530105 -0.06224889132367629474 -0.56862130004146793638 -1.0241775832338297914 0.036685220338810109464 0.15582678568210864278 0.11129938313925694104 0.69822174121826952042;0.91979400999986427045 2.5189087116894426366 -0.63262142107682750591 -0.35700047862004358201 -0.50210635775797352043 1.5836749651657147098 -0.58440714962006845568 -0.93129717601875194877 1.2411407396508289391 -2.1171262666078334291 -1.1550237173924424727 0.47028444839224481377 0.023802880015714233952 2.1985591895904179616 -1.4028795606363746451 -1.9746679790444741087 -0.23681000729278994799 -4.0363174996588986332 -4.1058797323574198757 1.8191689233088321753 3.4585611391868109621 -1.4486469345019445942 -0.080774722360824904865 -0.1839542901428087851 0.088777986641265071999;0.49265377419252970315 -1.2023834197105922605 -0.39096096873229196911 0.78323937561509460181 1.2914657684088302059 0.34710879478714845581 -0.17142834047959981669 0.30632208491696699681 0.23036336718324285089 0.060210067872896823327 0.52325550186490132898 -2.4041262199854065429 -0.47338776348463246224 -0.6972961260649145343 -0.53483348850156087195 -0.40292772480918892519 -2.4171622445251559341 1.4704339803456007996 2.8764811321995167326 0.93206702986453215942 0.9126288763578391805 0.40877159822867725758 -1.4588994409488167392 0.026892810569690721312 1.5937496032402473922;-0.010948843734248862869 0.98606916797893562343 -1.2365698188592380014 -0.85850223507324596728 0.70524333877623834876 2.7874063954780123886 0.40569811618076817572 2.5216989726666776406 0.89711220416481751716 0.20095235562964630649 0.82442855362787925699 0.83035760980296569045 2.1936760010224265471 -3.0063954256291642864 0.18245804709268520494 1.5686978082726112937 -0.47631246881512118163 0.82709766016458319271 3.0243914965129841121 -0.063851043138985111303 1.0998524212836591207 -1.9386848754882608503 -1.1617821071032694569 0.11353733010765465483 3.2699223752764630113;1.1598445983155820649 -1.5483940785491929759 -1.0821726786269094678 -2.9801600453313019656 0.50153767256053838342 0.43607380403377821176 2.1033264653790837428 0.694656977453029012 2.9382129741881870544 1.569239014640445129 -0.57765534307291044325 0.055396335719713078738 0.78503727045194571232 0.56632789203273137257 1.7235652943461925446 0.17611857281396606223 -0.042218802464725549428 0.9207676058272648012 0.14406709627003413954 4.6023039374811594016 1.7180192368792290836 0.52652089555249637076 5.0548233631697891965 1.0907639704457550156 0.17341812168826786777;-0.75056701162433947516 -0.00089092586068312620839 2.5627950568123312181 -4.5864753052145630363 0.57850079009975730049 0.31416004415619469547 -2.8871026809074495922 -1.016642851954748572 -0.789138529813957601 -0.99274926896471016313 -0.71231920980693486101 -3.1651219779210495453 -1.6207708915871223976 0.7935442611533575219 -2.1012232432223925116 1.7410467384621735043 -0.38285262894787142063 0.67756464865164955924 -0.80085814743255900883 -2.4310210270715972847 -1.3468420731128720735 -0.050668892272636698038 1.0191945888516378282 -0.40471356245762662995 1.6204133855386972929;-2.1097751866804044241 -2.6184747962311152314 -0.98699146687430916458 0.29871143668603844512 3.2007332052297843283 0.89069339719285145485 -0.50388177227124653079 2.3845984621098588185 -2.9167506408713728128 1.5476769490939832341 0.62691061574960849079 0.27892131065004949209 -0.75275294201506537384 -1.5536777336197555854 -0.12423998785376967613 0.97422438333537253463 -2.7013809166535303063 -1.3550442028108218295 -0.53390467466799540475 1.4693770143955038332 0.030497531912340933302 -0.12865926376240352513 -2.5195156465102961363 0.029585531154883507043 1.511871288253614054;1.8069996799837593215 -1.2131404925454545296 -0.3569547122391010241 0.94395695504344157012 0.26956812961925186167 0.41553004821794553569 0.7326521267630047296 -0.88960148418180695629 0.57613294056977493174 0.45915925018260117518 -0.83634253446734496684 -1.3985570485476381819 -0.23434538023818285435 0.094379813205289209144 -0.78939240979370284279 0.88419823838766342661 -1.404291672633228405 1.6353743354773420116 1.7559362860437639497 -0.28839112211627582205 1.0445208979092628354 0.75055757888068319605 0.036037306506684296803 0.65996037804434004581 2.684060346718678769;1.1730864666100089266 0.39565770468370003998 0.40436463114909393379 1.3430251384696307859 0.083255474095658116296 1.1978195205201678242 -0.11503533496065480868 1.5325113759211659303 1.0468611203589808234 -0.16338943013737800003 0.016318639118968063934 -1.204596872450769629 -1.1561258308482469381 3.2502732972860153282 1.3972123439425203628 -1.5307247000711377005 -1.3201136212943920256 -1.5763609190735310417 -0.3818677495017939183 0.74917595418985716282 -0.85498710404675548613 -0.55176109903234238363 2.2702216952907456893 0.47747085245524822916 -0.58329302683873185398;5.9089715740208372807 2.2307275700014579378 0.75590382154889423916 -1.1434437819374456691 -2.9178054807928748282 -3.3265494723638231456 2.6624923869131165155 -1.3752386202355664224 2.9594226104984069359 5.4362795434055355415 -3.4433387121223599792 4.0083761650433169521 3.6315023965952382135 -3.4196222704448477892 0.42045371898468197891 0.2385475933723820996 1.7149504305100538026 -0.095137662932523819892 0.34900752781454680296 -3.4163087475783036062 -2.0509150273081848681 0.17283595927462297448 5.7126016560322359084 -0.042725821865818178202 -2.3021142124495264092;1.491701855784326014 -1.5253658904595575052 -0.012490482656743667061 -0.33095071065436226787 1.4236457548604861678 -0.67110088225597153144 0.30381471411038396546 0.60102856502792711968 2.2265358701140161024 -0.12263921294042043342 2.0460057873077897028 -0.43789605759651328842 -0.65325543173863676039 0.91107435490100741049 0.60576091573099988263 0.019904726879392882488 -0.98530411491313185657 1.4737211363487219273 0.32390049228996170561 2.5965215446231950658 1.8452369530254304486 0.32179087546039614187 0.050104685739259399724 0.46889138687584641652 0.39831579035304665037;-0.63050956759421328268 -0.119113152993825272 1.5579550014105847389 -0.10438978265040788074 0.86236692158271488484 -1.2585733435527655111 0.89542909538401083136 1.740132860432742623 -1.1850959159350364924 -2.279055618859231469 -0.26332671800767215586 -0.23932752828422840241 0.0036240552961163217255 2.2065504660667087933 2.1273611641812113504 0.033225740190849555045 1.7917242827152008999 -2.3504972103931054406 -0.70733862395124158517 -0.80821811712542768191 -0.21411218489191324865 0.68622371174417429174 1.3258357777062874661 -0.13761010759516989488 1.026874481781602011;-0.10329721766357523316 -0.93396471638785338865 -1.0562148838799862993 -0.62567557032114518023 1.4158104757351948066 -3.7645306974489920471 0.85221235747300549956 1.4869717477513257897 0.42409899518183885592 -1.0696177725648938761 1.0264976452255540895 -1.2247133023420679887 -0.57954184398385399923 1.1110072885000306098 -0.84742910520825243115 2.6666314445527525834 0.41813155907575855208 -0.13177297866405265903 5.5237360167792743937 -1.5791058129292387946 -2.2567622341458588586 -1.0708594823551904618 1.0887516464223050416 -1.8112236628759876833 1.2264098502376103994];

% Layer 3
b3 = 0.01582912482702084761;
LW3_2 = [0.55320772601134238222 0.12558040654792060331 0.22945419293360472257 -0.20548762985019738969 0.16361695076895627077 0.79167394508417221477 0.21535124626621393595 -0.39656719087553721215 0.40952903569548865237 -0.17227877156369778011 -0.22815463729113197311 0.39277635398361004926 -0.31904135545242434668 -0.17231245370260964145 0.16515402969167172764];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
