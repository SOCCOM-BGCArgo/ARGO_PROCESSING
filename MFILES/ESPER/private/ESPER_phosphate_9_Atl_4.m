function [Y,Xf,Af] = ESPER_phosphate_9_Atl_4(X,~,~)
%ESPER_PHOSPHATE_9_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_9_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8245471802242618775;-2.7320458600415085115;1.226786310397408819;-2.9685894470965665803;-3.5426778796799944793;-1.9078678541348585984;1.4309642007607306091;1.9050612288844042119;0.26357241028493894053;0.98751426018859200795;-0.54555660254458471226;1.5217306889773152268;-0.18313110830968948317;-0.38458597517918863273;-0.5433678045299241699;0.78373755416373391824;1.2362317939877280892;-1.4083302270146689228;-0.19379814674711107192;1.0046573931799180901;-3.0448178927257245618;-1.4470960154067222803;1.07842641523107452;3.3642196608531045321;-1.7466304545596271769;-2.3209628791680652071;0.8690165632333135548;1.5972520964045706648;-2.4432302746506557867;-1.9834867530826403303];
IW1_1 = [-0.43609878257687390013 1.4590737656566088454 0.33982884211847808054 0.26402484000582576718 1.4489805985270840516 -0.85959938634017940551 0.11423436922311677733 -0.32481256956490101029;1.1055402908930478389 -0.85842914319032603832 -0.54426184886817741138 0.07278632668865277211 2.8048575006201166282 0.37690424595837873634 -0.21948819334417005167 -0.46888423024900777181;-0.82925227724602135204 0.85128150142361658226 -0.68558608863431858005 -1.1970449007803822816 -0.80801942321856490281 -0.74612790820377494772 -0.86687790478717063891 -0.8007171167544694379;0.35222858531311024288 0.11711969229428068062 0.50943792569149226601 -0.011906177409948762863 4.8615847295384631011 0.1900395132758915806 0.13908127774523029729 -0.25781471523641030785;-0.051285430646428598056 -0.72994637626900904515 -0.5950337372746193898 -2.606934927189018314 -1.4443057630168048 -0.74491588983595080631 1.4547004713032862799 -1.8292333488030541044;0.11802921414386975674 0.8457330009734225218 0.2047097560766408253 0.36117772842673834255 0.12035822693418432583 -1.015028484410082088 -0.16119506926281229608 -1.0735882341549576324;-0.860920961424620379 0.6328210019500921657 -0.2263235128409002983 0.089074876103262132232 -0.11811029389077293272 0.30137319467671164208 -0.80895244615613570716 0.72342230503760684979;-1.6642508203136210376 -0.55498987132670152267 -0.16204563491976875511 -0.3980334501831269689 0.62522719447711416763 0.6313786349556479438 -1.5132544800008862484 -0.27848527624252172874;-0.51350891930934294827 0.70141106971460553954 -0.47353350691791012972 -0.89311565590915609203 0.77694456248301135837 -0.39835257163385939805 0.086243429373482005662 -0.69373089330685888676;-0.65741374750142811401 0.090739559283668225209 -1.7833700927802116354 -1.8333565301791552304 -1.6438226221048803932 1.2078692953826284384 -1.0756021968544025036 0.84315696831114561594;1.4383140725231993162 0.0022258668845821054372 0.85982986587307497217 1.5175312929599074074 0.27288198634267835097 -0.68435255243918546864 1.0073276349970468058 -0.53845586563526681712;-1.0232357183562532654 -0.36869366430313854632 0.58147907047746461018 0.63504540282459531753 -0.93268275008225254297 0.10188224322979229364 -0.66867258452417255299 -1.5973805662982270004;1.6610551781218927392 0.81839230772431026395 0.71187786601702762734 0.33911222074336344612 0.9585436329385704779 -0.25274793757771185643 0.370998220818969493 0.77066949164651876725;-0.16498485149301117536 0.43978544800373925439 1.7997260867869044887 1.2203432509129754635 1.7400211374843344014 0.57663308127156709393 0.65466177351049170685 0.89812147962496235998;-2.3451798354599184826 0.74927263803507138107 -1.9871794133353992695 -1.6935803044720918464 -0.11496133127951124742 0.76835967484058120824 -1.1203120652788303158 -0.93603863218458038808;-0.45589350205551798512 0.30672262533547972607 1.189869682110626492 0.6601434658834858249 -0.59943850757038574795 1.3510506623654601199 -0.40078094498769173404 0.92509527860530738064;1.5813454186422832848 -0.58282153501282851771 1.2974944483637449455 -1.7903238078978351844 -3.049424377167210487 -0.73149804917905314472 -0.79771440579305963325 0.61111843484720962394;-0.015322601597946267082 0.3456624632489597726 1.5620518107491250248 -1.2087961612400799361 -2.415115511283211891 -1.3545938413768627839 1.312563478347410495 -0.83521139772225072573;0.62908009560187672093 1.2637233183499239075 -0.66804733408982397425 -0.25389072250079275372 -0.92447089642766611117 -2.8472161061703364915 -0.9933614285952838685 2.2811544441387092697;0.27291343287868713441 -0.29334760488228966979 0.88075725851573960501 -0.91637191672722073665 -2.5449346397456600322 0.76536765331646339217 0.73964575082213057655 -1.2086218053357808966;-3.4367312486264975924 -0.78878530940901736557 -0.6299054450355791035 -1.1138988610075168939 0.19001466259186364227 -0.59789357784985930344 -0.11358761123134582249 2.0139437102281658731;-1.8644142321144392405 -0.34344964783687925713 -0.094077280695500864471 -1.6276802522296647258 -0.37980893154557554547 0.14925509294259961535 -0.88071517814825828196 1.5840193469949122029;0.085262351660843699319 -1.0751155136954091418 0.071516871182412303232 0.63921498680163690853 -0.069622969256011968398 2.0817515729858002693 2.420866031199156776 -0.63899994956586758654;2.4245231030133815864 -1.3631732808946850355 1.7523936816298406605 0.4354005386602557981 -0.7774164367367831785 0.11784531569113684824 -0.70439457280253592319 1.2539148234868098264;-0.94080905804263237346 -1.5261364882766423889 4.0579672782302056433 -0.096688372067285172085 -2.942289233292046724 1.608978185640233205 -1.0241143315179286333 0.21944314981906876127;0.069832753924078824759 -2.2194579252166124483 1.7484666820355103667 0.6356066003412151888 0.84732128054534783246 -2.1749151292067128161 1.5270967714883030286 1.6662960411827207885;-0.25364449605602562565 -0.11397889586387875693 0.21467767448392766072 0.13473999250031126751 -2.7282008796902048609 -1.6465313895140849532 -1.1814681782707869839 -1.2901949621063060203;-0.33043629439326061004 1.1835341976473336967 1.591146665919538572 -0.7447359156045035844 0.34139120973131475978 0.28532011231078369118 1.9667741487023060465 -0.71824194992677459215;-1.1024670071429065743 0.19000514609098179131 -0.55961745957560371512 -0.75499218735868955932 -0.95266933348568261231 -1.1923961940983920371 -1.1900460261975389642 -1.1296780003632196365;-0.26130867528744206041 -0.86733203809921077809 -0.95745072546808351888 0.79231144117842777774 2.5933277779155439191 -1.8480049956391564336 1.7576682690902905026 -0.14068357798824454585];

% Layer 2
b2 = [2.9110389058089456427;-1.6194179048778665209;0.72624518101231927414;0.16278027286301410825;-0.26645538474896501846;0.16026137549130375914;-1.0701257082653610198;-0.47025185150433790326;-2.0900375118671958852;2.6423868234738909777];
LW2_1 = [0.14196085449420040026 -0.62976469093619857897 0.2891005154262240584 0.49323606073431874863 0.27013690209214236138 0.9857420099580579409 -0.96582905574045330166 1.7602591992890150863 0.42851779251830723894 0.7291082823552876846 0.66184467500374599691 -0.25941095115063939058 0.54520341284427054074 0.16059870903782100249 0.73452554582440854336 0.32931178493388757467 0.13825224961871460105 -1.2087987588359525581 0.86708729419655328208 0.2595814438010549674 -0.061114300645453277505 0.37987834396627206957 0.39369435769349836463 -0.40695988600901022991 0.20697102190970517732 -0.01707355303890974868 0.087101662645726732337 -1.0584016736809738202 0.12595942212335636823 0.67461734091954161929;0.33549949120775285349 -0.30137276647811250818 -0.12877177093579506018 -0.097623522563778764027 0.36709478352308200222 1.2289006284851680117 -0.29110718335431434722 0.16006311197226869014 -0.43368034262382976207 1.2846854793012465468 1.8513111475478523094 -0.3865648351712579478 -0.90784562787856859511 -0.40653556440053673082 0.48320481457104819123 -0.29847712735222609037 -0.22979864635476485168 -0.05265522243339348929 -0.72118035410294489829 1.1212572131549469745 0.21170568725859018056 0.65776367211179898042 -0.040228930156280214014 0.51828576911948676109 -0.2895036812899637324 0.4566459102347338872 0.88925492492012225831 0.4153049226638152458 0.15830103727552408133 -0.67275198682052061994;0.27677881370623330648 -0.33530143590062527759 0.053046740346286654078 0.64752004876354019025 0.35256668712586541892 -0.54349267063327744154 1.4642099068401135398 -0.58216666718729648267 -0.40267567336727394522 0.71995607952139228924 0.58384252145570492143 0.90401491318689108923 1.2339972949887121345 -0.67025218301522504483 0.50287877081606602303 -0.685639497094746031 0.2318371876446272406 0.1456063447357814622 0.24134164293775897669 -0.74914515468429165868 -0.054624826750467481151 -0.83573484530542996307 0.52809293902949838717 -1.510972963524819912 0.47742946750844245107 -0.014869367054014226773 0.33770081689330422314 0.18328007423992737079 0.77468556987173098349 0.63081544560820457246;-1.0509781261826449672 -0.75353213493540971424 -0.24001406333515595826 -0.029904067522427482673 -0.47177130500986308448 -0.84278285361860982849 0.64759775270105623957 -0.28063778416669782345 0.45505300477651383639 0.73008054405567979206 0.6904499990052590519 0.59679753109061350891 -0.42642127449219358049 0.64767178737220576501 -0.27820496737046201963 1.3451242837829775478 0.55990236027291395704 1.068094681434697435 -0.51023388776237610376 -0.17486475001877183066 -2.8323325323142061194 0.36151954502398686575 0.64690603632299026327 1.3167364047401277638 2.6350175809397380355 -0.43678520831560863069 0.39457013417131014954 0.14359760483285907706 -0.22890962570063941306 0.18969551541048410015;-0.64406697768581477881 -0.23938979763715872995 0.18282569710514939842 -1.3174639077737844151 0.21029167832420253559 0.32645799869771346957 -0.16369996737823250266 0.089805443265507919892 0.0018158883362828707846 0.13151224547018289246 -0.40245628787508108681 0.74361023511006196784 0.74466868174432387928 -2.3159282248279793315 0.49181044292563247389 3.2838725989182302456 0.68888967677468870843 0.47499687290535430595 0.1576400963463141236 -0.5135060010051840651 1.1274960708585508584 -1.8008918399282112244 -0.65141903029595982222 -0.95955155220105237124 0.36431164342067406947 -0.51861856581984022707 -0.76994064625843716687 0.86202162314632235773 -0.25559589174874791651 1.1015215899970522972;-0.092062873726740643288 -0.1868439127467173555 0.68794957110413812451 -0.92670841800075542949 -0.5050353019698861079 1.8156368165801541892 -0.31189882892405457193 -0.85441388516237792849 0.17414800951653999772 -0.089928621013383877592 0.34805346938385695044 -0.46530976435738302666 0.048443173251394411327 -1.2321347054310800573 0.16059033037228639951 -0.025612885299840678494 0.12084106016044983412 0.48003785134072374241 -1.2645194858829507112 -0.82789470395329989305 -0.71384035677098289785 0.8582188800356248537 -0.051287403540576266547 -0.99596584039600533078 0.1430135288436792107 1.2079183745253028182 -0.68219847427121815819 0.34381099973796547253 -1.5187213437842250752 -0.56573017316317997238;-0.22174235020065038992 -0.26094550503929736518 -1.606758977670049271 -0.32844656068792538184 -0.031486920496621925714 -0.14650601049361808292 -0.47461869616889373891 -0.10420818466209233466 1.5239989016614106099 -0.44719794194856848923 -0.49355571762364836008 0.98358293356391746087 1.1451181633129596804 -1.9427029956856090021 1.0662452089924272514 1.147406544303257947 0.47446935708128173959 0.011660084548733145107 0.14021674518607443738 0.21386704177702786644 0.46700464635125088497 0.55103695974036481786 -0.1833523196938282307 -1.1341374398389179046 0.25598959015424960217 -0.12934858092772139049 -0.24529028847678865932 0.054157278506836159515 -0.55696987167875555702 0.49642224617760843941;-0.064051330519115295958 0.75703261543594668748 -0.7419664931537085506 -2.1751693055913219332 0.25708297397353546687 0.9959949215709519299 0.21395807719633017085 -0.059236760116599132542 0.85009675813173524173 -0.78839316285923244365 -0.3444908631288368106 -0.30017256187747703988 -0.16400829623222859532 -0.22482834412144644953 -0.1290857404279627807 0.69631609820412732059 0.16755476436906638349 -0.44922156017791237126 1.0375563374475240686 0.10847395877773616246 -1.3734057237303909371 -0.6841639322328295636 0.48053618682728288514 -1.3192673691496759059 -0.34568919634432154764 -0.10263595037419102896 -0.4922804077235015674 0.14395226962882698429 -0.43266345083926543991 0.43097892228982936924;0.83678435250674065848 -0.51269897041473555532 -0.0147873443598413052 -0.37676818032465125841 -0.098176174710124866629 -0.81216766463975331725 -1.0504279881275033759 -0.49967870379853396301 -0.49345711511408429928 0.28293625985176901194 -0.40591353683966308052 -0.059614755311610125033 0.22698719456050270304 -0.37558157397218105977 -0.095184782047220597989 0.32454609903906833646 -0.31226018702046198783 0.41449934518030456809 -0.80318734633366861697 0.29505794605374763284 -0.3873939105414797579 -0.34337198842697652656 -0.24664058616399095469 -0.21553038666596691098 -0.052652802396900226511 -0.27051989021884970121 -0.27185060306905595162 0.018014709310134116582 0.75349527323483156405 -0.089874827738838203306;1.5597319277254972913 1.6115466487716827437 -1.2190503765082689736 1.2792976032991474344 -0.48230230852387667717 4.0711526182095658655 0.47288440593722869121 1.4881707137075921299 1.354985703937244379 -0.82454776787970651686 -1.0434552500357470173 -0.71423192542045055298 -1.543318321957603878 0.29273191264043152415 -0.83977231526498519187 0.95535034243765593054 0.025659207556318251731 2.1107232341096695549 0.2286989324765525966 1.2806562142636201962 0.81906905054198442251 0.84882675123784911975 0.47851038510392246428 0.045290885051870059808 -0.9180976371751043974 -0.050439792164847660483 -0.34842524033904187508 -0.87358170217481834197 0.18697456753602220703 0.030513512212440353083];

% Layer 3
b3 = 0.69812681503992413123;
LW3_2 = [0.75484032060850692059 -0.92690998155587112084 -0.25181808552922690936 0.27562767834146983947 -0.78428785153075986081 0.3597473616339030289 1.8930381408707039892 0.33853048842520638839 1.1900182286950240496 -0.21595958904685236268];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
