function [Y,Xf,Af] = ESPER_nitrate_12_Other_2(X,~,~)
%ESPER_NITRATE_12_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_12_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5748171241805195564;4.1503079714494921504;2.8558609358495425923;-1.7057709388843655951;2.7799703419490633394;-1.2944282416683541292;-0.42805084640615836955;0.54014912268789128102;6.5115332359501874038;1.4133365623160842883;0.69630015443610437931;1.2290963658009559367;-4.9877980670153068132;-2.1647869035666826854;-4.7758926483730324009;0.27868973665400764705;-0.23782245438126095594;-4.7854865541437563436;0.65896283697954316505;-4.693923884724739537];
IW1_1 = [0.12659132929133604106 -0.23677925386606171743 -2.891970402949760377 0.30261571209046145281 -4.5161137563102728976 1.4737118808285551985;-1.7820653604975746909 -0.46557128462040858752 4.0358410493924381512 -0.089582475519609239267 -3.3206771504871186451 2.0088913836940966995;-0.96307668988317929326 -0.98242786392018577324 -1.8227536734720504175 0.64148403349518690053 1.8437540954184405972 0.076674042467658687361;0.23458797469228437338 -0.059560177832883330618 -3.3657486528345206267 0.0060424953281487548545 -2.0715335356504889219 1.4593502317329540841;0.22088595038910133206 -0.058759627910964222497 -2.7937073069028004468 0.89260196148774251235 0.82799979165393011726 -0.47583789702586098969;0.79165565275301974513 0.91178713584520731938 1.4375386548640991524 -1.1344777932944913879 0.50173398493973508927 2.4650367668410879674;-0.24100699816950199583 -0.36962812843297943033 0.059726304884863794242 -0.69100895768080683457 1.6242917275412489531 0.86618728180084758606;-0.039048554057335663203 0.019565365075031006942 -0.42338548884039978182 0.25711382483354416895 2.6615987988543965415 0.58796950298426653436;0.083633609469452058205 0.15177666946445619867 -0.37743449483142738066 3.0759380504961129077 -1.6081558987535915506 3.339258335785841858;-0.17050428037128806391 -0.17416605661619599665 -2.6940299559683742459 1.0093209807244147846 -3.2674747457851136545 2.6914701634024367216;0.059345191477688088999 0.010849772821473391629 -0.21228653834296645764 0.55720932913263043762 -0.89631734351883707301 -1.0371481545528196122;0.64208272154873524684 0.7003108525406462892 -1.1622887711105012176 0.7380251908071385758 -0.088172835654959313967 0.57004142272731583851;-0.14806022406029312188 -0.34040061234239210597 0.13368010255530182739 -3.9790072069027360158 0.47563167972363457059 -1.0714649995527165682;-0.25703301749625168116 -0.39430765449474175499 2.2222607818941213509 -0.93930688439185727745 -0.0088898802418308497941 0.38548950640872753359;-0.39934081040972280174 -0.26889928071198210269 -1.3151303300981469491 -2.2648065393814365009 0.41892410643042932161 -1.9121922830031692353;0.51325893220349072532 0.45710164118907320452 -2.8064714587551624625 0.51829051206273291097 2.5940582189515937195 -0.37677392140097232254;0.36974418989037055594 0.12829873406283909265 0.31967254342423045976 0.053058971912618456412 -1.9466671216267477096 1.0081837761776688556;-0.49589875688771700712 0.65217504280814397877 -0.60062972203368247825 -0.48839741558432309132 1.0824868644890959235 -2.4364625999610054485;0.18746445697445093814 0.0031214913411768230138 0.38377457564848155291 0.95890819883125955059 3.4326434348444796463 -0.53034028645697384174;-0.40792855295106167368 -0.23443386952068534512 -1.6071980931191309772 -1.6972450911211647284 0.079759754113702202583 -2.1170590520777894383];

% Layer 2
b2 = [1.8669469169591341728;9.2198813730222148877;-4.3057486532183064654;-1.7648873343699271743;-12.863932483420537523;-0.84060428657796870677;5.6267308200852097499;1.4178475542603667936;-3.261323963578456997;-3.92451673099164422;-9.6852524764325149675;2.6851036404118575618;2.923245284478219741;-11.555864648576209319;2.2365023241098271889;3.3646191731557761884;-0.11572832405697942859;0.22085411453433376194;-10.186455762507421241;-8.2027844622043435407];
LW2_1 = [0.96671189421917991247 0.05646076397174647904 0.33763638803829815194 -0.96607611432035045418 0.85865614140436374857 0.049114231854794673793 -0.31795138418393509294 0.63606538217496422227 -1.3075997909317953471 0.22327363234495817279 0.77235946893754603426 0.30702313157191363224 -0.2599225926773158224 1.2743542800298297557 0.6350720878021822724 -0.38798427314822619971 0.20386856952679149879 0.16673788368976905083 -0.89879115973466894296 0.16042707466000849514;1.0392014298094802704 0.27863499861058721452 0.41778084913328739081 -1.4177909825459151794 -6.4859770098864224508 1.0874888654861585291 1.776817587455272518 2.6035032007134604193 -3.6491351617753049474 0.17416484314029631597 7.8223927434613163001 1.3472471202913767208 -2.2889073066618710328 5.5121485444943880694 -8.6310190107670869963 -0.34654563646236369312 1.2608719971998516574 0.5712148689029550308 -1.3438686138798157099 7.9389156000605654029;1.7000919533897156377 0.037165170019633930742 0.068638403659612740038 -1.379618597870034824 -0.093441470562620712603 0.28397570572874686334 -1.1300496265976123222 -0.3723930798520029839 -2.1486422177330108951 -0.62831464026776795428 -0.23261063042477583829 0.35578618863623501234 -0.83854687801002436576 0.60778805824421044957 1.4475283445690605433 -1.0357725714199954581 -0.71993138969218184453 -5.3485918007699178034 0.59778718842126665756 0.14179665664918886248;0.20323087251370833273 -0.27316867701963654103 -1.5543433900115244395 -0.065559128125836377277 0.011941345851859521202 -0.68378028010471425535 -0.70066476037839420243 -0.7966606060798482325 -1.4620190650164639479 1.4528235187811000539 0.9308589067237269532 -0.21246508525737836659 -0.40587598240213479395 1.0281112139730601562 4.0383043023134206351 -0.83538233616623280842 0.077147945273458015669 -3.4841200142566042253 0.29151338010987581928 -4.6235740387204469215;0.83472886502528709229 -0.19693338383060718377 -2.1748335488181815833 -1.370381416389922169 17.394292526710039226 -0.88943979645538073786 0.39054527828257196154 1.1665494108196894363 4.6121089363965070973 -1.300279176037932416 -3.0592759231045829615 1.4006226284134208893 2.5511270713719000902 3.7077286142844272376 0.66297370627650742403 2.2254459906983248274 2.0363523776056466907 1.1180592559142434883 0.51781490595028589752 -0.86291406700222650361;1.9859674906202138267 0.23279123898577841478 0.830321503904279834 -2.9740706533069722894 1.1351207162728806921 0.13179221428960713469 -1.3061403761153305148 3.5934133604679092677 -0.21098996422879273682 0.41077272492861688358 1.5393075775044482434 1.4363429146820148041 0.75472204759356487092 2.493297159482104064 -3.3553139987472810901 -1.144177723676305547 -0.72795572692851640006 -1.3200293011467658655 -1.616352576770415217 3.8815996184867604946;-1.8946045620990905611 -0.49051663059846600801 1.1551305808478842252 6.5334033969044202905 -3.1425011732074570325 8.1474108851600828274 10.076405670537184278 0.28482157984513117865 7.0387629604507333525 1.8108263129168316041 20.723227330439808469 -1.0030240248877704268 1.0007739815509724135 -3.3133150613609361201 -11.817332883259316745 -0.4316310033976007432 -2.6249782815491733423 11.01957689457830547 1.7424570206877572076 7.2769351402977706655;1.9298280556304872047 0.10855715017684558488 0.13866455465103150191 -1.7370794608786683799 1.2006631289820590691 0.0064811380796444394842 -0.57511835248664255893 0.89268761699629284312 0.33392365506790711027 -0.21891741343695578226 1.7835130409193944434 0.61352536717956129841 1.1511303335329567954 1.9394888519230855106 0.92117522609164370628 -0.53271417962386269362 1.0707125739441853973 0.40876413547661993864 -1.5657293649284897974 -1.0242404144523105103;1.9765640483248467785 -0.16305421314102971908 1.3002519684449831416 -2.7388113857641993576 -3.3784002147293779039 -0.88799940567733659513 -0.13501715598847707778 3.3877711523198348331 6.0044704061520732807 -2.2542295413582653651 -0.60583075428518362582 -1.29902087907938113 1.6943831628644734355 -4.5723666866952639154 8.9216301683640928388 1.6186694918713864233 3.5453036811629936587 1.4095757490202414086 -1.3747801786376292466 -7.4470338613660196359;0.46029361376923944027 -0.0019214950241604926776 -0.12909592055886817685 -0.18561876014054284889 -0.59075314489273256235 0.38762603393075623082 0.93517147470560402223 0.97477872102546370137 0.044182309896925377191 -0.61784411583153298064 3.0320600868736087286 0.43969367893624461407 -0.1092334649854261458 -0.26908912476425944638 -2.2651017919746592177 -0.68916411179687608879 0.047406919156354761224 -1.669510915107312421 -0.31499219697505703719 0.68031713279207728373;-1.4976553488511643586 -1.1958496506522464653 0.91550718632450556189 1.9016242402313721094 5.3265698147806137541 -0.74721705628854928616 0.73227467893461295478 -2.6285256462116497467 0.027405573365833185706 -0.076249928680838602313 -1.1995802323696669323 -1.6115784098279337666 -1.4674045508918571734 -6.6980619696213805625 7.8282383191173945391 0.94626185848043520288 1.3783734843625190525 -2.9553161622839141387 0.68432788873525751683 -4.6983614301191209961;2.5276854149224612378 -0.5863372490879229515 -0.55171995517194971637 -1.9910061369224427708 4.4057894835580988513 -1.5880381582620595182 -1.2877614715462804007 1.4543303259353532741 0.76359201472869653315 -0.50908186691539647484 -4.2459367778047552022 -0.39229800480940213436 0.74043635421787312723 2.3682363409780275987 -5.0618072626901717825 -0.78156802883111153868 1.5039877201076345958 0.2471134177152383149 0.4354673475294938978 3.5037446506573473037;3.1626245340815528628 0.42255707063669717405 0.33681770522513310162 -2.1982730757789368248 7.2562638108366108725 1.4156358653448788409 -2.3668680259340257876 -3.5943714678891205416 -4.3228815848446373593 1.7987212857764045548 -5.8001446144011241657 -0.064852981250437410909 -2.2341207550549841976 4.9688845807919479469 -3.0272922536008985972 -3.1579687156967137796 -0.47960047885784645727 -1.093069210669264546 2.7650005071895065178 0.064911463271503253014;-9.1923654452544028004 1.784714047961602601 1.294018314408423409 12.832395130882748191 -8.327892864126424044 3.289839062546823012 0.54099795326204858092 -1.4351110093200389883 6.0234271634012879204 -3.4522771416793256449 9.7952580643564566287 3.3365885139375994761 5.9978905408672034127 -6.8176197686752102456 7.7900682215459964297 -1.116086152863247305 -1.1039316390206541652 -4.7024045091945438912 3.7290759175142285109 -5.5727469354538330393;-0.34596267579617634436 -0.088912794762638705515 0.029009760906381749923 0.032952597037364132759 0.57441263175170409472 -0.24181434572667118155 -0.72247974459292119143 -0.83123455818994818056 2.2643679992163594505 0.34876675381779537188 -2.7116867849331169893 -0.2022299378224856059 1.0542669551191441446 0.11255772392604937449 1.1121472607235149965 0.54268878939000053663 -0.31349402997720721142 2.2049140768129675827 0.52267974818937112946 -0.47096499941803443567;-0.942770996828733443 0.015197650525564784449 0.18753097655809045086 1.3316964972885767526 -2.5432552173021600872 0.92486759944853691451 0.98541130673304166976 2.8372171889414152801 -2.8418272434060818377 -1.2031613950877442232 5.9877109679886197924 0.62632933697699955111 1.1156327230589253574 -1.7722131277924848547 -6.076764749131029042 -0.058733952004479526854 1.2324396964513892883 1.1136780985653680354 -0.90086040330565331224 7.0327400054869917412;-0.89470233554371969564 0.12002865951877286776 2.0516502174151995952 0.31370690444420001874 0.51215183024662092048 0.82958523753850110793 1.4792200668819655007 1.9309741329668377308 1.9566028314624928086 -1.7713314606588836941 1.492570193430888148 0.58129608928960696534 1.5033322586459232362 -0.072275666093767385045 -6.4798672692546199769 0.58893550668381222657 0.52249318696869850864 2.524356359634738034 -1.0049209307095323673 6.9300771339263320669;-0.36321579361752542869 -0.12428968441410852275 -0.18774014843847544598 0.20315217987935127453 -0.77764232585504389217 -0.45052857887737512987 -0.20274510909103923839 -0.38537826620028170499 0.9771898261818263709 -0.68873784911832203193 -0.78945209326633780655 -0.63418620341832476761 -0.69076123331010608197 -0.72468531096490784726 14.812288054169616913 0.37638341252457524488 0.87558008121134078827 -0.12086690674876905682 0.65387164115325380198 -13.575209850143028945;-0.034710799128287665727 -0.060194802552069062718 -0.82538208738550922217 -0.47299976736041238201 14.117568664178902438 -0.48651460642931371181 0.77376235911055346595 1.2222898491255784759 4.6940487985098666712 -1.2519982621477105944 -1.7368130655841118593 0.93152826226301133072 3.7501696534382213954 5.1857701270296683305 -2.7600221571746983429 2.0092940098824363382 1.8979461317209360693 1.3588943985897572464 0.39802536260960402759 0.61901341267858034367;-3.6477236234593881647 -1.2561069820465933233 -0.66112113237895286932 4.9063212335766808181 -7.9865962203088320948 1.6634833756917570824 5.98662527540099898 -7.8181736697796546665 -0.27566725904585165363 2.2654095184637825788 0.84427818634619145044 -1.1348352069712428491 3.1411713296004681872 -12.988356126088410392 -3.4820884120874349144 -0.86431962017486374528 0.15951484194443488196 -8.2902488146617141496 3.0177394625917521864 0.84351240487108303245];

% Layer 3
b3 = -0.13809462238014233448;
LW3_2 = [-4.14735720121826823 -0.43036351150798485277 -1.0225235133478431937 1.211414933221253154 0.59407189746414323928 1.684757262554663404 0.26117833472156520846 1.5891299394371822817 0.29699920223663844876 -2.2204137079015349165 -0.37056229548751473679 -0.65254481077775983167 0.14933259108706742335 -0.16786659077539314855 -2.9672415381851431349 -0.26034641503491506853 1.1887941568806761339 -0.87969596708748032388 -0.8978171592211072749 0.22270474594157432802];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
