function [Y,Xf,Af] = ESPER_oxygen_10_Atl_4(X,~,~)
%ESPER_OXYGEN_10_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:47.
% 
% [Y] = ESPER_oxygen_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.48697969977090144189;2.5879307747038846621;-0.56291605855384485579;-14.921004993892831081;3.8472578374439359017;-0.58817499010867702047;-2.8907514409656354104;-0.88838666404746946537;0.37202153952990618668;-7.4223284617518503481;19.978701112415375718;8.6992113442564580339;5.0930232681188272181;0.5846952215337093417;-1.1372483239829023205;2.2259940334608541157;-0.47152344571689080999;11.987745444827783814;3.3557764778887344548;-5.7944004147333725285;-3.0587112693987297263;-2.626284417238618385;-1.8000759519298685785;-4.7209060235714295217;-0.57112509253561383193;-1.1376406908273417606;1.2348386924164598266;0.38808738117129137901;0.52838399257254964336;-1.4806768235751788243];
IW1_1 = [0.042896464319532486009 -0.14265258533640834404 -0.61807186903729283145 -1.9395966505527038048 -3.7378392802519582183 -0.47339685894455796333 0.40624036746699382361;-0.20660465679867326405 1.6732043103942138007 -0.64276406726839063754 0.23137298627477562163 1.3596050593031723253 -1.0715770428338384779 -0.31143199364943185969;0.14375035618886125577 0.051228957963043442181 0.19522811268290085618 -0.061887548008801529509 0.72918094719658033132 -0.0616689950914147203 -0.037072992175370515777;-0.10892149222539251885 1.7270616102600429009 -0.11338329143898663587 -1.5708931681625835086 18.098794967526952604 1.512634872001363151 -1.7550648995932680574;-0.040632209204044464346 2.0249785498301404729 -1.4403639378624764067 -0.15309497430532426065 1.0514962992258163332 -0.27149856181262005395 3.6901729911418859054;2.3235503628160527612 -1.1436147677422749958 0.17865393071150695303 -0.15471444695698591265 -3.2068415554948881407 -1.6793204573215612108 0.388411063261347278;0.34189617020652957047 -0.31118991513255533921 1.2745176824350064049 -0.43036769375346933808 4.1547485210833627889 1.8350169638115825244 -0.47227798843848473043;0.34318362345780523137 -0.33158893472417211301 -0.20726591926735679627 -0.047085524931627646683 0.44092622507921552799 -0.97648965301281287488 -0.62834405777754209765;0.19435172001731138014 1.276642256113470264 -0.56260947816122031107 0.17356323899984874015 1.2393921621931234256 0.13276892204539608722 -0.497811309912897626;1.3907901464383014556 0.54993137587689977508 -3.9471214536896721548 -0.25845151553487349938 14.901245008644135481 4.9825115385051130801 -1.5120936245891931637;3.2150305351234909068 -0.45336841554158180401 1.7769845923259519616 -0.39139375461961023461 -31.728126624262017685 -1.0489097295743079474 1.3899843905652327081;7.7536927047454895501 -0.21907214531892912901 11.497135410445579851 2.4605523165940752506 -9.90309577113379369 2.2410283731011904074 8.4916838377224070911;-2.3147676909641452525 0.057277007552846252725 -1.4774279629187734297 0.52086197580482440639 -7.9029565908960917042 -3.1672767459619417529 0.35178353186579147671;-3.3974054076157327309 -0.051344815074944268052 -0.25803061630804680071 4.0720355255866671484 -0.34029226805410256462 3.3659157481183616945 -2.023936904019874472;0.30838603294008004596 -0.030205908969839462275 0.6620488431688613673 -0.37074997431996042918 -1.1529496359570881037 0.63669884225236306197 -1.2047541769020755353;-1.5489884807772127395 0.50746896258841178717 -0.91322528816267778407 0.89841080061401623613 -1.850531903051231053 1.0908088916016174252 1.3904055342545222906;0.00095804935594676348017 -0.14415216568178673695 -0.97200877262728524464 -2.6176192152491180032 -4.8026782091406241548 -0.35487634116788818739 0.43401902574652317934;-0.52727101691584188359 -0.16916477864909199025 1.3917458030102327626 -0.37803141045721572189 -16.220166284244843524 1.0663199354311483358 0.76622595959938222254;-0.92555172331380541895 1.1446050407747634381 0.27642798459229039887 -3.5384894044057646489 -12.521451423651306811 -1.7525142432502462952 -4.8154337693350557359;1.0836741523610811111 -0.8032352506042190754 -2.2969911933720679187 0.19339921634472412304 8.6777927585027949675 1.2830609923205202882 0.0027306910558496082925;1.2641007914404807089 0.55264929394763340209 -0.059449389414796015296 1.1212073163112821206 -0.49261057290032778111 -2.6237765056588826518 -2.4705598023278687592;0.12612052071614957005 0.183526427339506637 0.12848386619770116313 -0.59897016727735374886 0.3542588719305876932 0.95038389330724581949 -0.89064985696559817452;-0.16640815356599661379 -0.029745073880486791462 0.90422337847117983944 0.25393167654930404176 3.2313118547220347487 1.1139916031248302541 -1.0642668458433715006;-1.7625410799294121134 4.3589294766270585413 1.2929320177167153982 0.42561319454901880288 14.417704811784112451 0.67586583680976630717 0.67668678702697182548;0.18887707623254917921 -0.11132743664425907848 -0.43314034188493932831 0.0066148682562071634342 0.10131063051115417328 -0.98304869284256302109 -0.47651808753633095872;-2.1627004691400895098 -0.043694481878691480981 -0.85137774232436613797 0.2626746512976829151 2.2233268535304970825 1.3603413523738407953 0.11414892585607397391;0.40096182559901843989 0.8831932458908254846 0.85513335400004719666 0.024632307373092014735 -0.56673034187446458265 -0.029597496896418655499 0.094613052953387857813;2.5083097554971924836 -0.059549125261897060957 1.222492114244308592 -0.62039738750619766172 -0.98427685263143915861 -0.48111942458008249979 -0.27147700977683469903;-0.63455290159468535904 0.92273598730268246992 1.1323165630294362849 0.57064742800407575185 1.3535868882016182102 -0.12699939950599248295 -0.64475966190721945015;0.99488325262760801682 -1.104972118613424481 0.68399177650325104771 -1.4279977417231224379 -3.4759874448735583741 0.25073811508801968628 -1.3748196319805119359];

% Layer 2
b2 = [6.1905972721861930452;16.821149439736871045;-9.4804780683191900437;147.08265017088601212;-71.044754224837589618;54.033040483897721629;-8.6859109863878476432;94.182074301469853594;-7.5028318758044729719;-1.8793020089926855132];
LW2_1 = [-7.4667430174941982202 8.8901403480269980406 -49.362654162887075415 5.0827136942864274971 10.085233065163638599 -36.656134562664647092 -6.0400747400453926872 17.602963343613527769 -35.210004685981431294 -1.8505183199699350993 17.284347797623844656 1.8024732770997236031 -4.7863966836468128108 6.130564582518468697 37.413755443455173122 -3.8810533531548476738 15.808264514791270372 -7.2698112975302775496 -0.029705463536983701955 -1.3825616283634476478 1.1593971704972485526 -13.60039684183831632 12.826871924620022014 -6.9086704410052508507 6.8292934477508424607 1.1463039298100747843 18.882002746303452767 -5.2602735899023205235 -3.9619529314573531664 -3.9685195246318900608;6.7471105560085042896 -12.488452916385865521 -6.391154283086176946 0.32898640816008140053 0.2211286746448593854 -0.50489727660055971903 2.4105807919781336857 4.073087505287373844 2.4450020091312616444 -0.10750195305406076707 -0.10349355713087085573 0.014894421073342484566 0.1501938727182955402 -0.10317842714029150375 -5.478737826928288257 -0.044412860613340689186 -7.0801398188395898714 -0.14261792462911029866 -0.12355519316217336567 -0.86046276402294408214 0.61264347451056255789 9.8944733689035579971 -4.0339571030448855282 0.30265395301116093663 -4.0923624590671066059 -0.9405941701491203899 -1.6783965490957502009 -0.21883047179131523419 2.6269794095541345591 1.8425831561046079887;-7.5367473566248577299 -3.3142827569475667993 -27.626602932481116426 0.78259296184158300136 0.62848309865996687673 0.37155354896133618858 3.9639288688579985553 -10.45265440181314176 3.4308337583364463264 1.4881966537045963062 -0.47560427237719038462 0.14250044087174931762 0.79012192294026184491 -0.68008167201761626774 0.94585874616369158829 -0.64717694516971502328 2.441382732738546224 1.5711251010482485402 -0.8590377100781162456 -2.7348510503338809841 0.60488232050417989338 -9.6025957384216784618 -4.4384478382150369669 0.30317049145803803833 13.944374984084012326 -1.2912340997345290727 -0.92403519297950598155 1.5731812603357120395 5.1623156707800603726 2.5141875244257647637;51.675013192029524589 -236.63071776271939939 -239.75460744284291081 -58.350622338668230782 13.169568045470041895 5.0958634379659359936 7.2996971109006603129 91.282806135119159308 -86.811313027128662156 -12.960533716758929401 -21.80073997146186926 22.125934352994526932 22.003909656107829562 5.9051423192069618651 -30.462631538477008775 14.089623315942674253 20.312840577078880244 3.9955943812053433817 -41.500203252796893594 -21.943463605756942769 26.727195267378547783 -95.552388129870863054 -45.821574033190231034 4.0433057097236178024 -29.100594746126123624 57.413549538121372962 34.530456593157772716 68.897503848994091413 79.656868201797323081 -74.03443842944719222;-56.350341124341333909 68.918891866803008384 -17.801494416076817373 -0.087288200088554243616 2.1493341380389905382 0.36888054093854716342 -0.12372518190145680161 -11.188550387187842006 -0.12775123037508628876 0.77957534751508117399 -0.0015909227194391326564 0.45124136573472639622 -0.39824795065569751351 -1.021146182205135533 -0.69006824813704148447 -2.6591070328845067827 40.453192429144301911 -0.32398393644576378714 -1.602569302638512605 -0.0052243886061463162482 -0.16051671829935415525 10.198560851751553358 -2.016728863275784267 -1.709547538940836775 11.322912166798857925 9.0444399844678784461 -1.9631216128868869131 9.0727031782718867703 9.0291527332874039757 4.3566106525476548939;4.9712818709493298286 27.720611405372562075 22.176603616907222261 -31.976669156128611604 5.9640202766470258311 107.88606104424505361 32.578112792680229859 58.269619819859826748 -32.650023920011584266 -1.6389341393704894845 -13.701243804747276656 -4.1675925026861246891 -6.41708766896042615 -15.982150918477522339 151.54274378569766668 28.088748639851051081 -2.1194129202011904312 -117.38767407755933903 -42.204128278279100073 -120.22261978916374403 -53.569229891130845544 -46.439617165647518959 61.421419063608077238 -100.20337523545508418 -96.354420026670126731 -13.225718358188505164 65.325539388106335537 -66.770178530590115429 -74.155145923145383335 -156.97034596415676333;1.5349206741525807107 -17.625036982894961568 12.85180228053509488 10.903494494332395703 -12.405833686582250053 -2.4204802521602766241 13.697649330970461889 -21.073177644511076778 -22.89930769588923809 -9.9008600944004800937 -9.6618213721978651876 29.684504162350279444 -3.1478474848313355849 -3.4713947454150071437 -7.5459954200193566365 -28.045738359640974835 -35.589092011990757669 -32.585248555371947532 31.60214591214441171 63.100140872150447535 -1.6240309141617466082 -41.907622221878249036 9.4202850574208234491 14.879063144419538034 -27.826580154791116684 -17.689310872587846291 -62.777688267514413667 -29.363040815592047039 44.333824801799480042 19.041422828435173642;-31.126705790505358351 -141.44820381922210117 34.433464760519115089 15.485688067421975234 29.588636404416650549 45.46949156410565962 10.018778928590544197 66.422488159063476587 -12.236584886179166176 -25.610163031645576837 11.488347178085922096 8.5495622814430056735 -135.04701666078088351 85.034649074195115759 73.037543209380842768 -7.7980715198989489778 -30.786558752296485864 25.685095461454661603 -2.7632928016899946932 -12.132341333888327028 -53.516311186677896217 -22.845537402323941478 -11.975355558081245633 -29.158374598217573492 152.40587966528059383 -26.010523996986179895 32.120556924171246749 -21.209199997673650273 -56.092177523623441004 -21.231773952564768848;-10.938102676035827088 3.2624786780759795768 19.502575212285641726 4.4131114566632341223 -8.8988639831717151196 -6.8750855752069126581 16.0757148960702132 9.2108775529949387106 2.5007381747237626968 -3.1367243418299408653 -3.6058327052228253962 15.581898237408271513 -7.7094944377704317517 4.3596214369208947659 12.125481097103541828 -9.2606183616592829821 18.698714141434855662 14.408944348184499873 9.4663461673486857251 20.515709402607331668 -0.16810192117321151595 -0.7996276475492649638 -3.4470758933174656669 8.0415455211126314339 -21.8025984105959445 14.321215697208566908 -1.5919812835673825546 -5.9815097867563418177 -13.261520976872260391 -27.974861319500295309;-39.921565344856823288 18.685714893238710488 -37.423625618122436265 6.4709223651991258919 7.2459930613335989946 -3.0302799202763122111 8.6104967594164811828 46.232511266646646675 -17.897695898695147321 -0.96394252465994179069 3.0942791610376012557 -1.2163753849085907621 2.6149628460761760174 4.6159396648965955734 32.603094602844386429 13.66610714249583225 29.00022688125622139 7.6998331246944822226 6.6745830689197642727 3.469288335587457528 8.7967007216504828904 7.159235943495966481 1.3221121029599427477 -0.66624143547936087728 -19.611457789564834542 -1.5438887484482126666 2.511592613234364002 7.4413009128207647791 -9.3688441448706303305 -20.095018245063311468];

% Layer 3
b3 = -0.34622504551037885934;
LW3_2 = [0.013923818891335038028 -0.38680547411038962435 0.16244650154644757478 -0.0028980385870697603426 -0.13838067596089864697 0.0095605448730304073285 -0.0059321307894287687509 -0.00081666366123705363446 -0.0060783534841383768388 0.032443841567638090351];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
