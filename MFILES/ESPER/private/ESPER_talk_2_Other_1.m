function [Y,Xf,Af] = ESPER_talk_2_Other_1(X,~,~)
%ESPER_TALK_2_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_2_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.9;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.0422119037568594;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1800307485863448;-1.5986287805924628;6.7152357926050845;-2.2344774605497686;-5.7091085958287913;0.38139558760541525;0.86202151329507115;0.38548799486829788;4.8114607904775086;-2.3952062494730613;2.4907816528674784;-0.28595302456759708;1.9493256083403399;0.68283706056157911;-0.93725387418858674;0.72472570680743986;1.9032214844209683;-0.51541251002403521;0.16908737816354388;1.4407584865845779;-1.0440356723773048;-2.0233869618304512;-0.85556112726151379;0.84816125669411513;0.50980475654731716;0.67076833972842298;-0.41415254306533089;-0.79128361363218669;0.28321485153953618;1.3429706164606099;5.7478489092066773;-0.18095156465489834;-1.9278210319715903;-4.5742387695433848;0.44362672886289217;0.46903503336835733;-0.80127672976929443;-4.274385439000536;-0.79341350590754534;2.298140965353729];
IW1_1 = [3.6691388261208417 2.9984423493575019 1.0095404537122541 0.29256223134208431 1.4876496058530142 0.098379996024154356 -1.2812105552948228 1.4900934616586541;1.1661886354582587 -1.0981488666452617 0.6154607993770409 0.22030196327571677 -3.376738168680971 0.26980984437821726 0.18584903263009878 1.184209998770303;-3.5694066900070012 -4.2488802981646812 -1.8508865313304392 -0.73519444220554542 1.8857870669772725 0.62767391129290695 1.0893631632905518 -0.33307678260389634;-0.40613626059589664 0.37938717674659789 2.2558935140198484 -0.11946692990571134 1.6513652335920452 -1.6397697458769462 0.52702085990864744 -1.3096294267773083;3.4976518665428196 1.2064932776540185 -4.6357840647637811 -0.07778501787854035 -3.3246315738702754 -1.7181569184493568 0.48159123494061823 -0.11045848412690307;0.20956818270452648 -0.23710745755768056 0.48574351299052559 0.44702506647988716 2.6361929752040476 0.92545014897104583 1.205025744348909 -0.88506721948863998;-1.5396464865977932 -0.59441235224767297 1.4176365472228694 -0.26212695687496296 -0.68110011520210845 2.6698486018672711 2.4226025415199826 -0.62740349685715613;0.054678380026728382 -0.32198207253490829 -0.96022938275375125 0.42884670882796844 -0.15294958170480699 -1.6373019789684109 0.44538206644415634 -1.3853430418179364;0.069403455016762858 0.071495016212403895 3.0424894637175908 -0.47403349077014478 -1.5338253581344192 -1.7801037805192002 -0.40778302334629946 2.5199671396481413;-0.44452351609121538 -0.23680859780872765 0.051406684597188612 -0.040062746723255327 -1.3980190416837106 -1.4297997529008757 -0.6991276178787359 0.3538700953082064;-0.16506896750561875 -0.057527736165812228 1.3414285179886529 0.012388113890002994 0.85547155599205049 2.8686452336600157 1.9462626849480966 1.5448529362787364;0.06025074041952222 -0.14194179103638749 -0.10405456606828979 -0.066590617434972174 0.13055049313061864 1.1986932788571412 0.75720679689991377 -0.44135145849694624;0.38485789531760078 0.29327295861105757 2.3484270263260303 -0.50778455516885579 -4.7421651347734928 -1.4780732768426605 -1.3113256229937096 2.8850714046154029;0.50704275471790283 -0.37674437909796177 -0.54376257653964533 -0.55974699136467054 -1.1527600344377029 -0.94033685129366595 -0.054926343475690052 -0.63123108961154883;-1.207108618419483 0.27203457478347848 -1.0005731461989744 0.57345656707150505 0.3443997263412959 -1.485545953780224 0.20613084484967581 -0.0870540418210205;0.35241377736964236 -0.47275623624119018 1.5862255827314933 -0.22329172930161034 1.072673520994492 -1.1942361033809312 -0.84897246516336511 -0.88271704717618726;-1.7876426823314062 -0.14370797015007983 -1.411741548708217 -0.59415772926176047 -0.72814515144366165 2.851352776129473 0.11242531916738993 0.1459797844200707;-1.1613315485032976 0.48213597695566257 2.3675613446287849 -1.9092143799292434 -0.21313141454849702 -1.383724258196684 -0.45941133685717628 -2.0782071132552629;0.2058374180718095 -0.027035371114483009 0.90718810075432732 0.41033607731538724 0.42075486535671958 -0.25939096621433255 -0.12574986244231831 -0.49302937729489155;-1.2401774786796749 0.58978044542260921 -1.3336860555982226 -0.79975030451977791 -2.1398599614582046 1.6844009517910188 0.40385733288675091 2.2427623334087143;-1.6006839906218169 -1.0410734280943446 -1.0752133096600314 1.9122523211926581 0.87185630989052432 -2.8677408635436588 1.5550155372334924 1.1930513403028764;0.10720064065932644 0.059547990557732203 -1.268485503297081 0.051402909880494646 -0.857932008410762 -2.6520776645273623 -1.9109249177857146 -1.152403304863056;0.34687144695762506 0.60445748130350518 2.7937161997622013 -0.51354205007138687 0.95746607894452185 -2.006393283383952 -0.18840311231371182 1.3917184837932866;0.19927765345909404 -1.1736859043675794 0.55431344138795025 -0.1764673490700136 -0.74265984516545724 1.2952820643794358 1.4410506834848336 0.063883237003954416;-2.30813974706723 -0.51095119965342561 1.7806258624625306 0.23194036200732515 3.9638051227323561 0.5998129282295307 -1.1590948669299379 0.62422449948737768;0.93455118625808919 -0.3427295576630171 -0.47009395852758401 -0.23102794372966601 0.14996777233943628 -1.1011277700712969 -0.051270266246915115 0.51188541202435067;-0.693714792483061 -1.0583472853071794 -1.2965594901933568 -0.80171293378582442 -0.74735192556967645 0.17903463179054649 0.15491834028998716 0.66056117576757756;-0.29431310289429419 0.46965690307474983 -2.278399411817515 -0.13006048872284107 0.69908003613972614 -0.49453862012486166 -0.96969805286140753 0.074340915013541314;-0.7878574348108478 0.47496841545904145 -2.1962481211402771 -1.0481819175625762 0.59629384065471169 -0.017973977922318057 -1.8846273169686734 -1.258390315794478;1.3102439813484803 -0.74939531060594522 2.0235456022008358 0.097081646474029351 -7.9432687956608623 1.6754258730202656 2.9192604267099456 2.4354341814358857;-3.2455631706812964 -3.4073283973656685 -1.550957803817328 -0.83554648509930585 2.0143381368263662 0.9798798709951233 1.7341345646889008 -0.44406358933504764;-0.1563863862027797 0.2867234873864124 -1.0859804349697018 -0.50507408898908868 -0.028786979228854738 0.45884915992289077 0.4434289348445003 0.48226027523098358;-0.36751500939546894 -0.33465535578547745 0.1696385513062442 -0.0029732395371834522 -0.66586427556983319 -0.54552664453035737 -0.26569792934078135 0.028057336617620766;-0.073312376846234345 -0.11622662652571836 -3.2116296805273925 1.0968529247886447 1.8737770462875352 2.0565671213307608 0.57892923096296089 -2.6109397521460309;0.32738439517872353 -0.46767823635932959 -0.024049655105170775 -0.22578561471535372 -0.14152029729770471 -0.24832328818374069 -0.054931815031415414 0.22561737700270917;1.4550995088547822 0.36624579518580797 1.6245656985031489 0.59093066986290632 -0.52960265855320277 -0.53541808856693951 -0.30293964929803718 -0.23045253811093494;-0.049677318219936498 0.30041846330765526 -1.0740470081343227 0.12517469994196151 -4.5707204151282426 -0.72578089360209097 0.84456505469945486 1.7257661539336058;-1.7942756130076118 0.13473824418737981 -0.78104238216378796 1.5520762968130357 0.43786799062621529 -2.5539789617908273 -0.99369617452342185 5.4595034817692198;-0.74625127021244653 0.27729353508744137 0.47746142280661091 0.23468645793350934 0.084776128659059591 0.96209299674850446 -0.00076054067358689902 -0.64954592861247928;0.24894361030246315 0.98484475644632208 1.9671466104783419 0.78573123642831755 1.2056388123531194 0.49284895852099037 0.84339950223016347 0.9098516040663458];

% Layer 2
b2 = -1.510119800198249;
LW2_1 = [0.028056312924239036 0.82281571180067936 -3.4237746901425052 -0.098397474165694956 -0.031843297157944234 -0.22895812211020922 0.050446861558931258 0.15517159551613485 -1.5189774272018786 1.4967967225535688 -0.64155224417458834 -0.82549839049280593 -0.057951746461334261 -0.70588493369963956 0.1064727594953951 -0.57645748947682984 0.099811373939516265 -0.02655592040593896 2.3207167474928743 0.12243505857940548 0.023186419783467131 -0.79479276466281745 0.089870931195947107 0.087419383937179684 0.037989302532898395 1.3523231407975456 0.23608010302472909 0.1510024305023816 -0.0735637287382227 -0.049468422427821075 2.4326643548901483 1.3303759515498972 -5.3104747436769815 -1.3404352233218042 1.3868050933503846 -0.11652873388851928 -0.3116384920675126 -0.036768328872481035 1.792496876592149 0.063419611507375698];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
