function [Y,Xf,Af] = ESPER_TA_3_Atl_2(X,~,~)
%ESPER_TA_3_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_3_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.1238577754255496544;-2.0211587328755484805;1.8993054673654792275;-1.7725320429504938247;-2.6171090391260869445;-1.5540929034654316077;-0.048415129647609606023;-2.5003278279952123597;0.61705546859251914071;1.5199995443344269663;-0.6172341650493801124;1.529284548747718242;-0.30019666726082544495;-1.9767008195336948084;-1.2343789713521342577;-0.53394714085561756356;-0.26499210947144485884;3.4250385331363024655;0.097041756788749086726;1.4760861072037061437];
IW1_1 = [2.9353792211939624401 1.539067131073721173 1.1670561458523225351 -0.02703150206171446579 1.0162677551882988158 1.4915864383386465697 -0.34227203160706842766 0.64067830056622432355;2.3627838315224893861 -3.1476979018691149115 0.10724662803895364249 0.038770911315674165543 -4.8617019932803904325 -0.13930531581453223233 -0.63468955601416088275 -0.048111190613181600839;-0.17180378192814829696 0.68584904265015500524 -0.13030735631454476442 -0.36365703371488833362 0.12394312867964173142 -0.76002269937712696457 -0.43774227494926215565 -0.30512430972098175674;1.6555036369480808922 0.87064929978153904333 -0.16614992170568099183 -0.19366821874958140004 -0.60731976275982590963 -0.15128902934846627515 -0.1205365578970696433 0.25877648851440526734;1.6178894440271094357 -1.6516628918664524317 1.1893496042247269084 0.32595531431106572473 1.944184203565582969 -0.72545571385048635005 -0.10415400045460519729 1.6349987113698405405;0.86309906105986256009 0.0129742421611467873 -0.12687213327595525669 -0.65655674617401171833 1.9940049028774362583 -1.002752132976409305 0.35517438682938556882 -1.7600771080726629325;0.66674269734224789197 0.4716819897842804421 -1.402398181051560222 -1.0726371534338541291 1.1136162934770084121 -1.7559778361564597482 -2.1351220047795673729 -0.97731176584825241171;-0.20234276645415658069 -0.3943315737408342736 1.3350442322155231523 0.55005160786707052445 4.3635786581813800211 -0.20368332580591297365 0.39542859906389921099 1.1105434618319034445;0.5123526958614244009 2.373503416804133348 -0.45600210647209049597 -0.20644413144554127348 -1.1029653295204631114 0.23399817104461131945 0.13992041303638061422 -1.0667515904917073133;-0.80751590260575600855 0.95154347006142947496 -0.53171998146506038729 -0.25241298571953257879 -1.5576267333115143554 0.059336885348774341675 -0.13371416203300948156 -0.18465749227945202349;-0.82897863652134673451 1.2021280584689015836 1.2808336289220283444 -0.017975745709305282483 1.4543212044226991875 -0.37287114531932630257 -0.45497176034881536832 0.74922236165619982007;-0.4684804404951466994 0.81930647028702940915 -1.1701253298443312634 -0.50007384311776159613 3.7892122224249540352 2.0155042706271215636 0.31411249853891315409 0.11257838092371617866;-0.29991370036999354109 0.26836137580470925679 -0.1177796834399173348 -0.095747077107970229859 0.8156518005082468159 -0.013584491929807523264 -0.070275316029414475194 -0.014674423397762384469;-0.70328563368765062425 -2.5996043988163055616 -2.6979183328379132689 0.4410077056443550414 4.2287842014303382854 0.43464369314858997129 0.7658958011095768903 -1.426084301269962884;1.2489793924457750496 -0.40862017349422924406 -0.82433697406937733732 -0.21343849914805071433 1.855979574511677832 -0.24665048072372428023 0.38466316869323818883 -0.92430309859867854083;-1.3048622208386664312 -0.3755733432371023417 1.3422963158738421274 -0.15163410630410523172 -1.7342794528217604366 -0.094029560395449338084 -0.50593303254789334655 -1.1539796150371923744;-1.5245773453200941461 3.0385234769550679701 0.4908064147919707354 -0.1440235018415461643 0.30729908982937148565 0.83635920844242139793 -0.37912830765132843336 -0.66167634301001132524;-0.40911450925187370364 -1.6935853150871975625 1.5452586937620942376 0.41034721108254057498 -1.6416108894083507597 0.46751686979065576466 0.29902360374604469717 1.0705001552881934224;0.51747602905884326763 0.95937448517244638957 -0.63379850317281638539 0.073224314551328995027 0.40613810775166048206 -0.31061564270163039003 0.054847904232180354211 -0.38206057566572437789;-0.44292207483106765809 1.3110560419444432512 -0.50785346925704433207 -0.56841077752453172955 -1.5235634642751698653 -1.432903627473626873 -0.78110826471222283285 0.024782180708122061863];

% Layer 2
b2 = [1.4332629926870896764;1.8655920212213474851;-1.4780010832394754328;1.9971063863972617902;0.56497195484934381593;-0.75891957241936780498;1.5138292956812562373;-1.6348379781012005729;0.34866197385295910616;-0.53956391051456797925;0.35045982969817729424;-0.12764768151655289663;-0.92291920723695564099;1.8577306063058802721;0.24097800582669146041;-1.0912115741136003688;-0.65345738419831955746;-0.75547971352183274085;0.96020822342454958953;-2.1112455735256197009];
LW2_1 = [1.5658230811957309925 -0.76303041905200663653 -0.23685492814893296942 -0.37071611471030263552 0.68267343513307265912 -2.2014971907848392974 -1.112995914963113453 0.2926963791921314284 -1.2293619712174606029 3.1389175903240400523 0.4369098220225726692 0.92273711088403986835 0.58988986448289404407 0.37144007054432903736 0.38183378969400971759 -1.0802247159087798867 -0.2909560102510730939 -0.41598111894652967102 0.025854036518784560827 -0.14175552482928091558;-0.63608605576806309667 0.3093542570252487689 0.91597233361621244185 -0.033302345634169991384 0.20265212880523866823 1.0332936425067866804 0.60428719585759849142 1.8509473969255840764 2.5064683539060781392 -0.33123959890466603273 -1.2376512612883012743 1.9194593969370536968 0.28941231518590693206 -1.3470738007618290322 1.9324122376430936665 -0.60585781452607401221 -0.52965229448517903155 0.98838771991797025329 0.1803994070059967425 -0.27270608098114723639;-0.59896834839638746217 0.020660142652948881858 -0.61189890531308332999 -0.47109929283545787237 1.2707546227956558749 0.2188661615160256424 0.52613651976185116244 -0.84471528956911778874 -0.53752972930364162352 -1.2839586875237070096 1.8912978083730616063 -0.89245424757995683862 -0.034280874694093438348 -0.18052980498273499266 -0.11929927963958945891 -0.72079480481722157936 0.93275437217473555762 0.39332837367186940236 -0.057153202944172677713 0.22344838793558702283;-2.3023041983274699085 0.40486707244344366519 0.76305779129169259978 -0.65690300330503859083 0.30082270221458096149 -1.0042153556202286779 0.72754384187991394395 0.565247582730748932 -0.018003293567728027857 0.37841714590239056148 -0.70351893959436406778 -0.02686646652752579939 -0.91851118544093612872 -2.5670954181244169945 -0.57203985295405901379 0.1818877554541828423 0.54309980828439996525 0.2572137162375911501 -0.9600688269323589541 -0.31365794643003042097;-1.4560695601680910816 -0.14510230759414877166 -0.89217036773202695876 0.094146920618222204591 -1.6061412103821826047 -0.13284157566323223643 0.39180517317908358788 0.27122682865848057876 -0.23459844090116568904 -0.0013743464065965396714 -0.41385592235737650446 -0.049487485450217437444 -0.68336999072450810289 0.071659365915617778686 -0.34354349076617562986 -0.52825423947807659264 -0.62049202116006318963 0.70714218365741177141 0.29573466594642205951 -0.83454909203923632877;-0.35486640842665323481 0.062660376770312997685 0.7207849825636657437 0.36248555836438417499 2.6978942682094548822 -0.58094304396996554463 0.94904379133119021184 -1.3428747868748498462 -0.92472101269525597278 0.93272057448984690975 0.31435946622037225229 0.609557700807958458 -0.44450340202712806947 -0.8338444265203208694 0.45215139115295233108 1.556692306151052696 -0.27810404434652119532 -1.0009194167453672186 -0.0055228768910983161433 -0.38742319014178455694;-0.55848869363630171403 -0.10980941731191773414 1.1658960148516104294 -0.75937168198751026083 0.078527070709853707964 -1.9837788813558785428 0.14360039830801882288 0.81111480955828330064 1.1494982552483357097 -0.6437604889495959215 -0.0079321301552542286539 1.6891426648066756311 -0.53359541723080661235 -0.98295712562530246359 2.527226004971570017 0.09493050442096448438 -0.39595286717734540227 0.22071372298832594994 1.5852260527838331061 1.4399985044415131163;1.8934464128809653793 -1.995586839953784164 -1.2918172643831078439 -0.23458791604247847262 -0.42266752244212979495 0.46273078386507138227 -0.70348922388883916579 -0.75118749059997902418 0.32443258685520814932 -2.1224888816676528158 0.83840911935800233046 -0.39102145992892090032 -0.99205225970336585739 -0.30485200041847548835 0.3466484730541917747 0.35842430423179277854 -0.11564137017693747189 2.8305978043424242507 -0.81615808637963271899 0.53537922064537568634;-0.46256667214328128779 -0.85356006645155446666 0.4105148221373868811 -0.64981800796321009805 0.41289348590705715614 1.1472381864200886792 -1.4956150415248721242 -0.47201655908812828466 1.005834551613588479 1.1159143689429302793 -0.017698698455042717603 0.6220155576169414946 -1.0131430121698268287 -0.45036025570959759001 -0.52072493393516394722 -0.37356243107896902611 0.10050675074953899224 -0.77298401796777072015 -0.83397646763930965985 0.55439444400335058383;-0.8055740300056262182 0.69244191277122391082 0.68548547178910657074 -0.10592376029559796846 -0.32140567280810289352 -0.6853203450333545943 -0.12184324853950810608 0.2475528868568819818 -0.27628045861469474609 0.48775345820342658198 0.35397159234799369099 0.39654690672452747036 -0.71302452538864158349 -0.20327338342139270044 0.55060486369979477761 -0.48825569316444689116 -0.042862182488502653666 -0.28603502348902221097 -0.41265165816140436661 -0.19630494530555192556;-1.063124674262905911 1.1850072257507475726 -0.030699273335339300611 0.086926813299696495396 0.19713778371669005152 -0.67999372704348404195 -0.86172479263166967822 -0.50232027805803292075 0.57282093563375791057 0.8672235983202927212 -0.66052405195143348848 -1.1227575398662605899 -3.3116051630321958754 -1.5116871850238680075 1.4322986626651637021 -0.31907060930383746022 -0.43375685155807497395 1.7917826459964840691 0.23276173875860597939 1.2205355858037063577;-0.41014488254940811851 0.27408417959301983879 -0.80900592820948824535 0.69447778927147818528 -0.79044893401664173549 1.4081109780373313178 0.10039887667588161257 -0.14878888469635698222 -0.08264489200487103171 -0.4410730216982146068 0.50598428847153487098 -0.66157767616682106038 -0.92349150162705317957 0.17694539023130984035 0.77752496926296943425 -0.305538409663007271 0.38765115984538023319 -0.23837617585018380795 -0.32074975372330993828 0.25922153847618772948;-0.22601950307985843591 -0.82718599655292068817 -0.32795370558539294059 0.77503264943823280131 0.16175852015354694191 0.18934032278374321456 0.59293712862173375555 0.50439948001550061196 0.28159943803128728579 1.5255671139219340038 0.61360142629733638309 -0.59320026683063431516 -0.52324044515575962588 0.51767122674961041362 -0.11624365012982534884 2.1799132932072047275 0.36487379886945991991 -0.080469996318920905543 0.50213897562193654522 -1.0684081535947251851;1.1799723427273396403 -0.069990198252962668168 0.4810934443381320591 -0.38855547558409281317 0.82179445372858783703 -0.63882880722250379169 -0.67431741604968653547 -0.15778989725838618585 0.21382737733919254808 -0.56755698534649334785 -0.090296980902865559004 0.61021491138175343316 0.74125157047576450964 -0.15470468635360948295 0.32680960546780601916 0.45752723986534560296 0.19201063333996942761 -0.65463705107574421405 -0.67337756597608022791 -0.1935974236200258547;-1.4680484149269903416 -0.06467342763891209545 1.2524751212136946421 -0.51662680473756239508 -0.022864558222561705281 1.4122864362908211788 -0.6739999923043321628 -0.80507023056078019785 1.0753701909171673456 -1.7913304930875579846 -0.77005376618478704742 -0.089809361521067998524 -1.2874680510485256857 -0.067566505839925447563 -1.3992867846775804974 0.29387316460901130588 0.1012928328324399635 -1.9462567370069994155 -2.0546480894194409927 0.78206861238639280298;0.029312400344532429236 -0.55740299826650174797 -0.54127884997670461242 -0.40783959118097362628 -1.5574817947087531422 0.65140584860218186947 0.059806744903040956474 -2.0986620684932462133 0.79619693827573179146 -0.67486312473645604371 -0.058524162113866781687 -0.51857059726732579463 0.46702749134775245476 -0.13388734668089752322 -0.45058505034960477653 -1.368556725653503614 0.42083544456195914885 0.18201441135043713859 -1.0619825913713947241 -0.52138097212761369548;-0.32879220684051235768 0.43499743395811235613 0.65564754196709562617 -0.96135179541760962252 -1.4088112384308377756 2.1053709769186359502 0.36059741101569453559 0.56195407185729528976 -0.32179442354137033355 1.418609498411601777 -1.102959844469425077 -1.3281039649461605645 0.64603096555649530686 0.92066156192557246918 -1.7171838369643230848 -0.96500385096854968126 -0.25796026701370133871 -2.3752832269677037758 0.85139573306402993591 -0.095704210904244996216;-2.2375626207709231608 -0.12243437909118741469 -0.0406848586637509127 -1.7346567594912396526 1.2673306534640842447 0.095998215504572659285 -0.86702939842858106623 -0.54840975623596754929 0.95023349465287976212 -1.1931385968607137738 0.77002591747333293259 -0.033270872199076644005 -0.19167605807815973895 0.83457925348648853703 1.0177040827898877762 1.1250177704131587575 1.1370206827814088868 -0.82877299062140352692 -0.70977026452245861599 0.052189345495148586895;-0.7095276022677832195 0.0035828652442362884933 -0.29249920950397217956 -0.30874951280826656852 0.55569120437753416475 -1.8342551044285355655 0.53955914913801938937 0.25915104687919660043 0.03461373586638184785 0.12827273014933873729 -0.7797946178174176568 1.2376857988600795668 1.147732166048831548 -0.32232301864417089998 -2.0732734896434052985 0.060601915930136508737 -1.0433193266299556345 -0.82218592619936536892 0.60063468408129605525 -0.20320556578922568947;0.43083746824486890414 -0.41116120854152710118 -0.43805191698442286219 1.3045821513596869146 0.80616113330795247105 0.19955358775043877118 2.6013608559036263124 -1.5557775266453317542 0.6320321322420126009 -0.97003714303525723217 -0.440288390532679208 -0.54669717633791092837 -1.9222197196551895626 1.1652688490772331598 -0.48491096548611406503 1.7191549444268483526 1.0461646938824571418 -0.70285405334142869727 0.56432609863449045839 -0.3813409706965520396];

% Layer 3
b3 = -1.2925616066608911492;
LW3_2 = [0.050338792702226867193 -0.27563972913767498252 0.2136350483045368065 0.59289052843032696849 1.0196196580603182902 -0.052404760908667066821 0.5473234688718815466 -0.1565611896021212035 0.060646347162354959093 -0.58360623751048146257 -0.0195838411221155341 0.86525677697314784531 0.058956719587166098173 0.78189995213152552189 -0.13302405748464926627 -0.010934527447106111991 0.15453787754062531246 -0.21318057800593551154 0.37898233139908921174 -0.44309820107462954963];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
