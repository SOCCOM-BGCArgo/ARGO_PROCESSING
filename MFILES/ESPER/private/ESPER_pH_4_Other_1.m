function [Y,Xf,Af] = ESPER_pH_4_Other_1(X,~,~)
%ESPER_PH_4_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_4_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0588888685539285;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1397483367523322251;4.0395165591419210926;2.4879457919223773033;-8.9413782851505931859;-1.029331142167626334;-0.38530117591707441216;1.7058365371118486831;-0.95730682154253687877;0.33221689421333966408;-0.87479889782592412661;1.9897316780389582291;3.9816093135759369481;-1.7552172649857988862;-1.4367559488460928119;-0.90281656866196380307;1.7408917578657772118;-0.5795202930091150062;-0.88483349565126678815;2.8145649159638663761;0.62930937214265902924;1.0042988164458019895;-2.5333330426599953711;0.72700912340220691377;-0.4906447354623966195;-0.25000276593267561909;0.94981988421442209436;3.3689011842333935753;-1.0662380775828326218;0.17990696309089593274;-1.0399041576226264461;-0.48436112620918042593;2.1872721583542089618;-0.33756349024576864926;-5.1016088766639722252;3.1852467771504482386;6.5889327319119903592;-3.8592482306692197369;4.040384099057580336;2.8271387948600645856;2.3058502723069880247];
IW1_1 = [0.74321719752144399518 -0.27640883813346334152 1.9079292480041025737 -0.55428234760088290756 -0.91105034402856988063 -0.96050556788157803734 1.1921643383163667007;-0.31426049619266632762 -0.2055610428343222218 -4.2222414388730538093 0.23176563982947051556 1.6124600390153680518 1.1779105321191492006 -0.037656172869622132893;0.2834597160857942888 0.29739110640348931369 -0.2978490876902974982 0.42041283595328576839 -0.95384313650031082865 -0.056894297428133067118 1.5778212968270104444;-0.21796648393783202291 -0.38261315829474956685 -0.64211162885595951533 -9.3280545355007244979 -1.2997498348609548557 1.7618090032161466407 0.22513584216435580942;-0.37735717442473848404 0.36922934464360451789 -0.062822546614410640364 0.33941292429106223461 -1.4833064246083789151 -0.94293137702148610568 1.1268039405063465797;0.65684114926267700429 0.47260181548049179368 0.085729671759930389796 -0.34326954837660800246 -1.5906488746501192821 0.6617855417647209304 -0.38384060451401702529;-0.76951732323821064874 0.40034454860396279097 -0.6109535467019673316 -0.52299453586902422408 -1.2148856933249598811 0.31919026915608533779 1.3374608130320495558;0.25818434750138774536 0.5803108782336833249 -0.10597845344847885152 -0.42129655521997294576 -0.92062407373001275968 -0.68922529471619320418 -0.97231057111942786886;-0.39593954743539555574 -0.34723314962143186913 -1.2606017238226130406 -0.65504184848132063212 -0.63784911782325970364 0.5536018014792091213 0.16219123737714305489;0.56652282714433099819 -0.30984393003107818521 0.68470262376211621369 0.3197045637529061235 0.35935572078681521369 -0.047321552921182785667 -0.34523807501394032649;0.018240414562787621994 0.26838104962023251465 0.45426686639663632628 -0.59139274922619222696 -1.5080460982870893538 2.8245032250717962974 -0.25965799106217429815;-0.77324635989044387951 0.24866133132707241016 3.4799819913136236238 -0.0026755844907288156044 -0.0073677780781491912857 -1.5934667696362314615 3.5650827843492129965;1.2239814686716590231 -3.1580808141088954066 -0.44370268061567419426 -0.97341395645579575913 2.0268088639755275082 0.4590963001838704316 0.8632063149812562175;0.01561450382683168131 -0.61609465983098599118 -0.76157632386771145772 -0.2637462401877749274 2.3209299351650467536 -2.1034964897529428995 -0.12758961501583829246;0.25239922692382887881 -0.8859683789569625656 -1.4448677812893677697 0.42475466772513248426 1.1754154437284922707 -1.1185055556044036784 -0.59105350672551293378;1.6152768967488957408 -1.7207287807985747197 0.31251204395933357416 -1.4546227810889522658 -1.9110430182535069754 -0.59601399537655064265 2.504188968834291984;-0.40441579369830804591 -0.51728296705781195985 -0.27966463600712060389 0.60212445366564104621 0.87982396408989860248 0.33996082496184720778 -1.0600359323120642774;0.19962905398616004327 0.45058956842205361015 0.94918116799180063392 0.58687901365019323752 2.1463368607903148266 -0.47058899384524865983 0.46707103484503326163;0.68553188747347049148 -3.2878993693982665469 1.7178235907105812164 -1.7441317451549451789 -7.3773345092071798135 2.4553099688616555341 0.4715636621242219606;-0.20925539922221220168 0.11290073540416088738 0.41310691770067586859 -0.96306463765181471448 -3.4614230006760506875 1.0268797906982807255 -0.46540879770335247256;-0.16392711558527706117 -0.40348722835628703098 -0.57632378437436515561 -0.35371969176492973341 -2.2942515504481764133 0.42879811144831148084 -0.68497347773849415198;0.81277674323471105211 0.71604309505787033796 1.0344488501386077672 0.45751928467301250514 -2.1409957899160207972 0.88544086547700973089 -3.1212468347923265632;0.093923214136702196098 0.10432623595814358164 0.59525320532517933536 1.3152382003092524254 -1.7194093330420425758 -1.2806987680213688385 1.5141718329955458078;0.33835635104877898049 0.43644656087393912669 -0.18062955439931258073 0.62326248398250150284 -0.6705781409001942972 -0.61994088790548063095 -1.8695500863921543644;0.3610935993918195086 0.49210856006698977527 -0.26056238993336444665 0.7699871339786646951 -0.5072366321688258628 -0.13283881710962122669 -1.9791250132072488732;-2.0552013643956179578 0.24457786634916695023 -2.2969152786197462035 0.4748807676112943299 -4.0199538627905520016 3.7405825935116303604 -1.4528259679368193957;1.126286879660556739 -0.090216791774312660168 0.88752487186996376067 1.6145919012037279749 0.36034008773690373584 4.1345902239457137384 4.3375587475995391884;-0.67560122400763755746 -0.88833823413376955536 -0.71626667180223801967 0.33803549395381848885 0.68137579891529942433 -0.12477124317794288655 -0.43563232964544551518;-0.17617111227284334984 -0.75716088405658010796 -3.300707134379188723 3.5390809091924393393 2.0432404806894388649 0.16126315998681411967 -2.5061414145585203528;9.5567457142857275242e-05 0.61035349084284429289 2.2581384778051996065 -2.3611047429819360666 1.6027318120700153603 -0.081729237334668192183 2.5133076778115652772;-1.4263524701251313331 0.12809292359773441494 0.071043126986511939691 0.34205283799620922469 1.700129606355959222 -0.52980538495344486893 0.32875030909873714791;1.1918852575311105202 0.9182955800609710062 0.18304386377531287056 0.1848154296909061689 -0.97504928563142378994 0.2645625994553791327 -0.0069237346222267076232;-0.56711553737267061948 0.59072987000198762253 -0.14778750255489353505 0.57895578471038644519 -1.9251067606171745616 1.0174282788048421011 -1.5101899316376872218;0.38173166688337129004 0.63111415709986218303 -1.0143531179732283576 0.57676573418732857146 3.4804919033475694157 -5.2718663073890574822 -1.3145243517321090199;0.5971423679878055113 -0.68379670037986106657 -5.3602196308764344934 0.064333700832150689242 1.6987864281762874441 -0.90511687363224624381 1.2041026374647716413;0.50562703206678105694 -1.0001283372731331056 0.84788856337870666113 3.7799794500674166464 3.2784078918343837472 -2.8831650878295200791 2.442382276725290513;-1.4467312403039698232 -0.86296926286271846696 -0.15650456149559532903 0.30867169047442710728 2.2544346881384518255 -1.179731378813590803 0.096269821103902419868;-0.40137296552869095034 -0.17539608268981446426 -4.2025373748739793811 0.2055976798874857292 1.9893723164456689201 1.2614046821546947008 -0.063372075790886717161;0.10776934741815709373 1.7765938792027862192 -3.0843447618844486158 0.11707787475437649027 2.1472353581960401669 0.84920425902645590988 2.3015560680411542016;-0.19704290479203456776 -0.27541645150588112134 -0.62540152164353945974 1.3662443498835390443 0.7598196678121584835 0.10709037375080789067 1.6069666217946663167];

% Layer 2
b2 = 2.251607713350945783;
LW2_1 = [-0.41742430995656848447 2.4812682156670180511 -2.4430715108552933934 0.25625974566720116643 -1.4430457808929197938 2.1244423743592921738 -1.9068733950588541148 -1.4135238339356781534 -1.1334516250970374518 -2.5468969349851739992 -1.2639760457151225648 -0.18011856358801134337 0.071596540625488008791 0.72782357018797383397 -0.43204199650254143661 0.16641114367388082362 -1.796531694481443342 -2.9737572338143736239 0.052258552818091177916 0.7462175708998911583 -3.6697761863583657771 -0.54315393909913878279 -0.37193023173658495972 2.966538508004928687 -2.5170900625445784549 -0.092689457030763200418 -0.092034848555311896123 1.0917127777617994244 -0.14358518776467563138 -0.31440750532998484879 0.69518476794294614685 1.8156862907229913695 0.96421872910237549359 -0.28699156054400126736 -0.25301217053951635672 0.20488980816371363258 1.9198000626810924896 -2.4773532917949077081 -0.13873801052351308893 0.84940267927253165769];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
