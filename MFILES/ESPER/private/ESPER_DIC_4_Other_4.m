function [Y,Xf,Af] = ESPER_DIC_4_Other_4(X,~,~)
%ESPER_DIC_4_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:11.
% 
% [Y] = ESPER_DIC_4_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.6630033205045289257;0.79390191210481020345;-24.966164184186290242;-1.2812243333438322335;1.7969421098355562449;-0.63605730466368426423;1.1720860362810068267;0.009304179605477804274;-0.11381644618405882541;-2.225735489770017228;-0.73609962216942115276;0.14902287216115925328;2.1566606311151121922;-0.0056718414248585254794;-2.3212904532611249309;2.7990041419329201311;-0.077468827353625979715;1.1432759886095265056;-0.35971726093939010438;-0.31726324974804781531;-2.095837918190297966;0.65687929962541558027;-0.18486064435846136234;-4.5087629834124749451;0.93680831643253725804;-1.3829538048524243621;0.088061721582724739044;-0.96240929223991389385;-1.0949623637822771816;-1.7860453308210459955];
IW1_1 = [1.0469434341794434662 -0.064101882092884046593 1.0492369909115830673 0.22126776718142554534 -4.8970815521200332654 2.5868684822169027981 -0.26123806096947654876;-1.2048142264284449343 0.28821071373320727993 0.33472117696391040509 -0.53625824064169413941 0.86090121673532904456 -1.5482344461809784963 -0.2256087926814319411;0.1754138071757713746 -0.49878940781982000763 -0.12961463509805007388 -23.963931970530424564 -4.6565650736608850124 -1.2726359863356255797 0.032110362683546729567;0.087258990490457030709 -0.18854621599197013415 0.59967007617659640051 0.08620851356261832743 1.8811840379658530953 -0.39476087544076332581 -1.9252790500552381392;-1.0021834828942965956 0.61380394463978238395 -0.62889482206232016903 0.83266392691200130649 -1.2863176022570887991 -1.011551904683845482 -0.60310561650073313267;-0.070239793858424492967 0.1382371930180908981 -0.21917721351744759439 -0.46485816315099515172 1.7039987137116290317 -0.47551809743310780032 0.010934121657367883856;0.3933540636695461723 0.02194511072746840874 0.3268327966649636207 -0.097009649774931788757 -0.31449017192177985969 0.64725035138945141711 0.61837230205381799042;-0.090233453337780197834 0.091748823590231620706 -0.41657549182604031168 -0.0092203074332475633279 1.5531377736786962096 -0.079831509832912511682 0.44184550536769523488;-0.24168517340547301941 -0.046638332103767166092 -0.14479602502737934366 0.0031598132476537135402 1.1145715897011079232 0.24177412683252258452 0.011807343761603649596;0.0021770602399840523547 -0.047244217387642895023 -0.23541720812664207463 0.52542171752080690794 1.4436541318674143142 -1.8124029725351948894 -0.070984642914970808025;-0.28263859673147984086 0.13026006590810182417 0.18357089566074630271 0.23501286621159545032 -1.663710399870682366 -1.2138965817445388495 -0.38232605062167757115;-0.04016858176670150965 0.073512545148824798291 6.0246782731923174126 -0.95020361144201226367 -1.4695594879837183822 -0.30427140320019230302 0.31842173816550023435;-0.070307820668558951294 0.13153957757612255719 -1.7489261686955530628 0.49400317856687075979 0.38286943268973944177 -1.1950820060248510401 0.40536297128810283574;0.18824791049374600682 -0.15857420661028664988 0.15201669218634455971 0.40050633771907234726 -0.5484279327077937749 -0.31532851082459073533 -0.019678388129794003453;0.48903073547540198973 -0.090350326234256247981 2.2399458755367662732 0.24199676767750361028 -0.83119054399562308788 0.64481675878882382946 -1.1589218996421446484;0.41698599615318543421 0.84296592011164439562 -2.9871448077102025209 -1.8814638667642458181 -6.5854697245080870971 4.406961007767048244 1.4039080414770099825;-0.093754251450787917666 -0.10275381733801353112 -0.80735045305503161384 0.056148587086005785629 -0.41121383118033133508 -0.87852547845840700536 0.40935824300968121081;-0.062808180127535126469 0.44038418195488227003 1.1261345036937064901 -0.030056365353936381757 3.454987031926442409 1.3283372967904332196 0.70430681245528337087;-0.2582831274108315367 -0.22915168033402957826 0.42197710701868651473 0.016280480127240953836 -0.45036969673074139786 -0.71034274149952192356 -0.11984639974308780586;-0.0058618742536573941251 -0.091859991692899739535 -2.6331313891018872653 0.44211095622332763355 0.53389842285976885083 -0.19437241471191973874 -0.13833567391254902867;0.81838340762520744853 -0.12918282278913148509 3.7019730588031922736 -0.41507777614577656689 -0.90404479708225216061 0.38563213715216015931 0.2142662483242412097;0.40436186906480908743 0.13786108851881692661 0.61926786832656366411 0.048189000878473151057 0.47239887780835559949 -0.096465291240443160059 0.6621517720899757764;-0.18042092938098916455 0.82071083996058913357 -0.027348651745293880294 0.091590035669352184988 0.51569759583964647209 -0.88894032571851089308 0.86901089983060419986;0.17484734056964901239 -0.21567969245984819349 -0.58694628552081429262 -2.5249017834158675733 -0.85538428973024660529 2.170307756289644896 -1.3016881905436785694;0.023450405945871145852 0.058139981075637926777 0.22952501257057364437 -0.070123566325335812133 -0.84118885843891122445 1.8121514887795406867 -1.4554671915909083157;0.17134820801295905235 0.63688894794599271165 -1.5101294312931274888 0.14474563112173471913 1.8899783508309735414 -2.7739122117292405179 -0.017457705873591744528;-0.5826525707546339472 0.28837287796868049661 -1.0136798385931280464 0.71416028314867185944 -0.1378970642755788234 -1.0225468754759547974 -1.6483108907671948362;0.92057021578317821398 0.89568464639196931909 0.38638994644543883661 -1.1438249315341182388 -0.64786768203858280391 0.99092781334826562922 0.3709288792716399219;-0.14935342133322651592 0.36429874913647664059 0.1378280547539214862 0.076276104723564372434 -0.0015817728285715077982 -0.84559667212944189529 -0.31057190202175921634;0.69211711132657560697 0.36871001206687620266 0.98137096248232569273 -1.0487800953904997669 -0.25389714582943895271 -0.12911747643365714677 -0.36845476113488440095];

% Layer 2
b2 = [-9.9581741409797110975;-2.0820007690048187854;0.37929095483444674741;22.75883451511972666;2.8932960601805519651;-0.41871805729550226616;3.9904172035224796389;11.472195613268327818;-2.1950667515584201261;-5.7934591491694682475];
LW2_1 = [1.5484349006783175717 3.0322899247731833761 -0.58215997637991090397 2.4311834970672676626 2.3796687063677364193 -8.6142350095519208963 -14.409882844837005322 10.300092743495753211 -14.19075598051234266 -0.048240704433066231016 2.9818493421062819415 1.6549156509476896648 -2.560948428868795812 -13.95084068045138892 -4.1259379482134663775 -0.20476387254085454126 -4.246677615339121914 -1.5602842989582745847 -3.2065757087253703439 1.8828655229786539493 0.58069134744609895993 8.5970208525132232324 -0.13957049211345759487 -0.79954973183735711384 -2.1753842865731596312 -0.068700991885942391812 -0.93382166506758623736 -1.8247734510318800449 -9.4366484743895640008 -1.776346381613222114;-0.97319639241026034693 3.6807291584886576707 2.6188741846909793232 5.9198662984538987786 -6.5613382659643706418 -6.1273713625957393347 3.1699307335868476265 -3.2430931825452939954 1.9087953940057071911 -4.1164302209412051425 -3.0645428347415801795 1.0597066523689468998 1.3536669702581904939 -1.3149318760018053887 -4.6886260229075524819 -1.0227725518343087074 2.5227886011381435161 -1.0461557450595841967 -2.97262008635290087 0.13294192015991757039 3.1147199062150914273 -4.3323891285851798827 4.4964728947294112515 -3.2778289891646141818 -2.6034886543298627615 0.22662332085683348226 1.7286885291691811428 1.3850625528357936034 1.3941503234817755885 -0.82654300284762516338;-0.37928459476705700393 -5.2674863875928270573 0.55977810148272566515 2.7958302827431711357 -0.18878564764457816949 -0.94195148696988506565 14.575725341968420068 3.0667572255717967522 5.5093019803565796977 3.051249863211319191 0.53595985888540209618 -2.4979839935302452503 -1.5191822604586198153 1.190267812142731696 -4.8838659588551758262 0.48182975448525156015 9.5599752947079927878 1.26952716304179547 0.79624121619693988272 -6.3407363138669428082 2.2821233525433028966 -8.9592233854746599064 0.10959838478435759979 -4.0518454084143753491 0.03378005466367176024 -0.11976169375694699359 1.8411433780856862885 0.16858729289656759764 3.8787344359274387173 2.5628720450524840047;-3.4944943669472805503 8.9574436972629154496 -0.38997717764193245982 -0.16997921490121423171 1.4674777760861055231 -1.2807123052672004793 -2.7386261883386242566 -1.0150782621056009258 1.1056345733319161706 0.8884251868353064685 -0.63763948183842189543 0.68418895578631577781 -0.53876038705545215013 1.0122356750890093569 -0.43506914039930583149 -1.7844936418341679207 1.3517475747069249703 0.20656542256746085462 3.0232689265432828307 -2.5838707770102180561 -1.775714352963311482 0.48535901897388689097 0.53068766123932153977 -0.51858108307405847981 -0.80464863523166485493 -2.1600538690298831668 -10.882174534028102642 -0.28157666793783958648 6.1629545432680545858 1.6465610539014257085;-0.28826534476986087618 -0.40178349195510276726 -0.023060555215399351076 1.1728864717131530782 2.9723133136537205345 3.4998003099003724969 11.259997133727555507 -4.4052938203293061648 2.5578556759277648602 11.084170767535869828 3.302533602106133781 1.8763388192636680785 8.0035275164659545055 -6.4355914646490166575 6.2995047423520746932 -0.22117351785197772451 4.5788901348431707561 0.88637562615167608815 -2.1873080861506890571 1.476292941348323895 -0.098763080391200949726 -2.2080290398543542807 -3.0684087116585980759 -0.83380376214257623246 0.97338754228656554357 1.0643678352231569217 -4.3412230130380482507 -0.27713833618569266859 2.4334630705024329345 -2.1810047833064998279;-2.2865152988906909393 3.4953459450269930286 4.0775035873711971135 1.8828632003922882721 2.0555365400451615088 -4.2860858814311919573 6.3665226777165848659 -8.5200190302361029637 2.2457117722276334071 -4.6553344656043620375 -8.3683588113000144659 2.6641243824234956961 4.6445422617547844624 3.2061064093303581757 0.44757138403859325626 4.3641874182831061901 -0.7784454723681701882 -5.3343508512657757947 6.370101887031698773 5.2088594204507296936 -5.8966973100558837118 5.1737446905949715514 2.6351429951700491294 6.7826282215020867739 -3.6338125123775766312 1.9367564125788023777 -3.6357361454783561072 0.40998370116209326142 8.0049872824680274874 3.3987996007898169104;-0.7641280717897737107 -0.45120299990565410075 0.23050039148679268841 -2.0159875304872856283 -2.8525024688405236084 -0.48363187177888655732 6.1316317595489540082 0.35364616638909174284 2.6796255079909205854 8.0958530256651997092 -1.8005678677115335429 -3.8531557948878565334 -5.7404382064935424168 -2.5172356384250944572 -12.644599944938269331 0.14669154846681844995 0.065130414083004503634 -0.51807459747758677349 7.3084244691863249344 -4.0398608159069988588 4.4963639164066080411 -0.7959642486200984024 1.5613273744591900094 -2.483018342969232517 4.7282469262062711834 1.355409536337879528 -1.1278713650160951953 0.75878356166730709376 0.095244494567018181397 1.2111884703243680494;1.3443596894328149194 -15.925569915124809128 -5.0245562776679593142 5.8106872195278409521 4.4462271493353364704 -7.308554011823560792 -8.6438002231905866068 8.3062486684444056806 4.7131944382534749494 1.6587962656077173129 5.9944261119779937985 -1.0201943016998629155 -8.3217053814606281037 6.1058607411739478366 -1.6901566251425381715 12.598549948507166363 1.1802968723823710206 -0.81698122148518370622 5.7678436618207831188 3.5400816801449983551 -9.2076778845697866416 -0.97298292092336646775 3.0612431842899328061 3.2780502240981994611 4.3289777078237294816 -12.995747203617430188 -22.024135852831889792 2.6610615181753440872 9.4479354125175127876 -1.4714834241868479658;-0.43193855231937178241 2.5798309783660107186 -0.54016300065962274957 0.24869221859930282226 -2.6592725224496254199 -6.4960976875307441247 1.5597863851913351674 9.4308105536796702495 -3.245333856272254458 -4.8625906420045437173 -5.5055598046596321282 -0.44761849147171062224 -1.9499551448829937073 0.75130164563256307542 -2.1543263118782776111 -0.19946159775291477656 1.2694357534957632083 -0.66848066357788626934 5.2145101739677466313 -0.18767435219838116134 0.5779633646731486829 -0.95119836544066693751 0.99631874499869332862 0.35005187546729338299 1.2386987438130612205 -1.1868983625049003283 0.86632475627293270559 -0.4255752265828084413 5.3230248051131461295 2.3109015320863961485;-4.125539298321342585 2.2553148537477265556 6.8588602422123159386 -0.41223054180240314981 3.6670778191728325979 4.923686858892784457 8.6247864101749023291 -0.15494591707335694797 -0.040218842052416096944 5.2926005190647931187 -2.4344431993864898978 -5.0483038737082575054 3.921013083988170056 -2.8374356037493506655 -1.8431231485038690465 0.70856202179959804077 -9.1919746057024269703 -1.0031130542555728447 1.0386392066463379091 0.36717100870176777594 -3.2597446143130213159 -0.022953905887840828776 0.36244191273225445649 3.4204111283050342429 1.5214503678756357008 0.13133396656209053721 3.3078757477411686594 -7.1304932667072069563 -6.5580552700487428908 14.317572024288178767];

% Layer 3
b3 = -0.039480230441735181257;
LW3_2 = [0.13610045765314005006 -0.04204365991112814227 0.16391398247687508083 0.06374074488877110034 0.31562798170225248029 0.0098136281430886689731 0.11450871174673346586 0.0083975086375535756139 0.26242637747085884037 -0.02153464797292225022];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
