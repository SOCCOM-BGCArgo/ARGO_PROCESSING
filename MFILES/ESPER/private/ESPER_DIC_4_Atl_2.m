function [Y,Xf,Af] = ESPER_DIC_4_Atl_2(X,~,~)
%ESPER_DIC_4_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:11.
% 
% [Y] = ESPER_DIC_4_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.1043003360448855332;-1.6101649751517754794;-1.9690529032606083337;2.880848415124477313;-0.93882601868800275025;1.7241041653374573617;1.5181325313489826279;0.78711320068910295422;0.45336826663938190052;-1.5773804623965872462;-0.34540215848402966436;-1.6628761584127709217;1.451734073641883116;0.32601647954734536139;-1.552700964493004987;-1.8587981452766821899;2.3098932652467869531;-2.0826418824428647447;2.3201857094105422519;1.8872707178449696919];
IW1_1 = [0.10545442638308773209 0.73908764588032416221 3.8114494536751277742 -0.38689419661968904585 0.88194362142640514435 0.56507303120261520579 1.0570877322569174339;1.0200992508078903231 0.9413539449288815808 -0.086248272773489592646 -0.30165961060225865431 1.1919893002719310626 1.3563162311652063874 0.82763431965222766795;0.45508199032421037256 0.58225918426506773073 -0.70411418873058728707 -0.82268011579893773888 -1.317556638119417034 0.16369696398181599051 -1.8834158981256909904;-0.1628808352087691147 -0.85684461538890499543 -0.77915764399747089453 1.1415035665344126503 -3.0498896729033107 -0.31299384981277178497 -0.61661789882236650584;0.14574495092328207391 -0.4760884995468945835 0.50884740776586423472 0.51527555376041789259 0.11210127954045814858 -0.60280057641931161783 -0.54198165373515971854;-0.098066353110053544606 0.075715524821010918299 -2.370836987781411942 -0.31648835239620953796 -1.7913831685684029615 -0.72031100585027307837 0.75589512517683199455;-1.207050940378471493 2.1723049249775017167 1.190877491504987562 0.84593260676492243455 0.24727530407024242431 -1.0306533061172367116 0.038155496740713348847;-0.40360777871042308185 1.254436451797893648 -0.67567600459168408733 -0.0047392110103297007545 2.2635921615039378274 0.28083581775154603521 1.0812196453381150985;1.9701183812762543823 -1.0600349199364766939 0.66907966386565209671 -1.2605421184018701375 -0.069735187674544354963 0.222318174854712447 1.1164958956102293275;-0.0017177033223073816335 -0.096089777431618811354 1.3055325895729115171 -1.5017818932591402437 1.0087967814033258485 1.8307638717402874295 1.3982467064417065661;-0.65047326402292393599 1.7597180278397404063 -1.5840255284016153681 -0.67897238677906968096 1.1168273587240911127 -0.78207732211399205724 0.31622029493311298864;-0.32618160366923099058 0.24991065257512923292 -0.55726157420229760486 0.48310204542293422314 -2.3060782198837661561 -2.4774775226967946651 -0.39608585031800797038;0.77628383507366216509 -1.3442863137218505898 -0.42193553855588672441 -0.082149866776436208937 0.51031959711586283301 -1.1861932480211223595 1.6192268014266810727;0.89073354508719015943 -2.3648758739978452681 1.4836237905374296542 0.066971445429061901566 -0.71636530714559065736 -0.72007743140354418809 0.49834181713301040073;-1.0768182071249132736 1.2610894439817659229 2.662158286601483681 -1.5571556628811427103 -1.7136059838333477234 -1.0023258026658596886 -0.29716877925216128586;-1.1496416044558408487 -2.3329074808003098518 -0.91965590916204675853 -0.62604474027985423934 2.3799751813709999482 -0.86407435456898928905 -0.35478567150273065955;1.0801988667213888728 0.030905553792548112746 0.29401441965213132024 2.9705222683613619061 2.8469796538701923616 -0.54639305297402696038 0.69614895338424431781;-0.78586199379871812809 0.20944005371128202042 -0.59566542341701678165 -1.1868026585249715765 1.0280644708054480496 -0.033256185599768499361 -1.100053954452094418;0.38833235455713882578 -0.27965469195750619624 1.3346811158945697251 0.48285819982012262441 0.2732346023476630581 -1.7389176968036352822 1.4294563395793749017;-0.18668737833975737606 0.52902035431212757199 0.22633862874821430999 -0.91362252717401670754 -2.2498966248377287869 0.25949356244774907099 0.15651325035566104882];

% Layer 2
b2 = [-2.996887938240053284;-0.93654601914371515825;-2.0328727596287583523;0.8059825945206319231;-0.49676455346136727531;0.59299782147062940485;0.90843336808051133868;0.91251040712547015765;0.18812328443221190688;-0.20061277413057004848;-0.16289937766011836073;0.22067990857021252404;-0.41652261193688699947;-1.1296547440169910637;-0.54997985569952168028;1.4804415822019172388;1.500353583888326181;0.81474078247209369419;1.5744024467217341279;2.000813208109252006];
LW2_1 = [1.2889182697229673025 1.4029428979654336995 -0.36890210665880068808 -1.1461865317698485267 -1.9781075989990646313 0.97822703449941150744 -0.50085734996807418362 1.2272338735498558027 -1.6181110269824152681 -1.5251662865952679837 -0.18028100242257594221 -0.23657562859059771965 0.28309716075356899934 1.0918834899418732309 -0.25549579577607134384 -0.14427447276327803882 -2.2774982693098282382 0.14062948070707109727 -0.46477445499227010295 -0.74445226034561218231;0.17574943450679259005 -0.77397192841140793895 -0.047176133075546376749 -1.3388230428872289757 -1.2978231623598812661 -0.88044936406089391312 -0.51234136450931377915 0.58430737683565459051 0.1182279586748960637 -0.71916179047627670773 -0.12167909897553505494 -0.42108204381053215837 0.8510991109792547249 -0.046826564701422365711 -0.12998380318768590347 1.0815383428419833578 0.00089505086501120816045 0.19482810968954486497 -0.57914844291579559155 -1.2853478227174643944;0.082366310670527062565 -0.69155695773197478626 0.87805539020203360323 -1.0278617697472829384 0.37609853251521180306 -0.14366487832719521123 -0.36866142664673079432 -0.334980218562769827 0.93119775426333495361 0.9712439756880789643 0.24378156820589791387 -0.82663932876251922099 -0.34977722700959201774 1.6692890171451812975 -1.1678781256463932614 -0.044908322900820363266 -0.12412048311575335502 -1.2767540175886837872 -0.23187252398022006883 0.69469073992507368587;-0.52711487398254219805 0.96863958776426606345 -0.7689959571876107125 0.056770812265045947353 -0.11994099264443557062 0.68416839280207575325 -0.2925791000844430445 -0.15662621716784799752 0.88573342028332802123 0.32610022134178268116 0.19948068061777290971 -1.0360429939679822731 -0.1956625039006205935 0.46382979788427708412 -0.11900527303046770644 -0.71324811040328750522 0.80883778603572820121 1.1135278070847456355 -0.79492220703651927938 -0.49738105295064161115;1.7352300791725658868 1.3687932006770697768 1.287434017098228578 1.1339331613032612722 -0.74894503829807812512 1.7568285004975991992 -1.4031574750884316938 -0.13933499267120172393 -1.6824949426249047324 1.5113972508601902778 0.014447020849611285492 -1.9663578999745170428 -1.5063884687351738467 1.2101182394561291744 0.51674430574922103343 -0.96420204110885854298 -0.56374577967622319097 0.15329888131556373976 1.4485260164129893923 -0.68696081769648875692;0.39758323088848251947 0.13406458362894571601 -1.1528756946275777739 -0.073059832649398775972 0.75720461530535687622 0.78202876444921531895 -0.22385360248019928187 -0.065762616137873403099 -0.40967619385366221829 0.13896791715396555889 0.88294484872039014078 -0.79518317118502246377 -1.4650438832943841749 0.23123375428542874976 0.48709843983596190498 0.66842492101251904657 -0.50401527844680726886 0.8316788577809834937 0.31348057388536143542 -0.25133260228948128834;-1.8726800413368474008 -0.55624435218390755331 1.4923711612074102018 -0.11491106325639990904 -0.70326460885276553814 0.020518488476139896265 -0.30387984852301669347 0.98690801932697125309 0.28686198790949363202 1.02844200852358858 -0.33130714289348650592 -0.33514060428387210111 0.2074719166757519051 0.20583365911891515765 0.593808704061608017 -0.38496034748394586389 1.3524402449611780952 -0.76763662381008568314 -0.35821079678390238543 -0.86319812406260632009;-0.7021154305849227617 -0.072145127451247015316 -0.84723622576433998965 -0.31496842570589489441 0.23149952427827380497 0.99579905886836395101 0.99412137415569423737 -0.03425281670550740093 -0.2578836182960292378 0.34810507208265029089 0.24830225539783060129 -0.38155780992759041892 -0.52485212977688344704 0.46185662259043286371 -1.149041490912947161 0.28825890885258625973 0.87085766325116709119 -0.67253503418469717801 -0.31030683466828956618 0.84076592865137300681;-0.046936301308137820532 -0.24625491277659947165 -1.3258150854647816619 -1.5430600990401810435 -0.053750508658929170569 -1.1133607414599442365 1.2397837819210648647 -0.18510903760069744028 0.071085581468681616202 0.58940443291448119112 -0.16624515335789699644 -1.2993496193993043786 -1.068854987941235013 0.59921549544830321476 -1.1161574878768054653 1.1433552790139385191 -0.62770074809586673403 0.56700566917709360748 -1.32265549801928195 -1.0557659807426242882;-0.027230429035366678775 0.26108908960938548294 0.1997674163923296442 0.92989194059736524078 0.8050732020436643932 1.3175473600201170754 -0.44327940694354367457 -0.1662895492739869252 0.26541125065326748311 -0.12717330146863081719 -0.72614433611846396222 -0.22918821008648690429 -0.44191495180882278682 -0.27561791471897822969 0.046642848993323784978 -1.7868228374454204754 0.13245422872171161432 0.1711643102149313922 -0.051181555568424533242 -0.49053248928694348496;0.99118867885140871099 0.42867443609413524719 -1.2990815944573477214 -0.86797462841960393298 0.63939617106734614183 -1.471914036774543133 -1.0292421903932886806 1.5820781992919126235 -0.88937422139552824163 -0.48846489520911362536 0.82627559660877092362 -0.14152103564536616664 -0.67835712157473626593 -0.634994371156773596 0.24055686428802128263 0.94083453717782117298 -0.45321986221290355701 0.96226517007196155085 0.7898287044527618761 -0.11703976102175618623;-0.6680487860917627696 -0.151400620759073401 1.0386577712176876531 1.0563106374908399765 0.6181782340861013969 0.017117445126475384215 0.11699817239162835225 1.4649272615931221431 -0.62961627187930868654 0.67997755882234511837 -0.59541357819947549057 -0.67086071876438901906 -0.98016146865883480022 0.2695122183230795887 -0.43382686153205057833 0.29966126044299579156 1.0017474084917024069 -1.4632843545733973389 0.49019007950441351174 1.4699029917893635666;0.4598808343986788838 -0.40401898424785281927 0.24867413630668658286 -0.041349299065514474871 0.56621850794472905477 0.031241030720840078094 -0.21299482190667792803 0.022552920406458398794 -0.59431827840861572998 1.1226482446503438517 0.98446683037235616087 -0.47040931666907404018 0.40892688863863108084 0.2666317773778391631 -0.28133516441743222636 -0.3799938965673216873 0.44487446026468024929 -0.85606012196356218169 -0.56071892068168849299 0.064142262966420726666;0.87938189372849295822 0.69432266737129311185 1.3530375671566696738 0.33719049516609500561 -0.30925783693719655076 0.45817695331754371146 0.049353642835505244502 0.28025313029309967261 0.39186682175045861598 0.39774482808277444867 0.54139148640996348494 -0.77503521667025465636 0.77918329429578692125 -1.324992189367874218 -0.57818054034664978502 0.86920709935698470261 1.0907105942411710053 -0.70064312990980393003 0.19942436264816187919 -0.36011222244222024225;0.7310602239303108929 1.5929468695425670344 0.61552569134581591737 0.20929859495875649533 0.18981624840532379528 -0.86226070408330046657 -0.50042106268334196617 -0.068292289811334283556 0.32064067904656207153 1.7348065213129233442 0.10977274435415995679 -1.2508458287599821812 0.19116594562970765092 0.82639870940269399835 0.64219381983893852883 0.77730886791731934604 0.21482190096713482674 0.8377149469380053004 -0.42219610529113271724 -1.4914447000298725055;1.2433601114060830461 0.50425625469376433863 0.27507965134231643356 1.2213788316462661498 -0.031152916261023518019 0.33426077052862024352 -1.1115875742532033144 -1.082275271573025277 -2.1405638263239445962 -0.58819278003428510093 0.32622510236276713869 0.035700851940226867309 0.13875930278211112689 0.24750291499750229351 0.74419323137805459822 0.10305507059563902283 -1.5093696003590451049 2.0238802571584861845 -1.0326639730853917065 -0.20757746238053464971;-0.28628277688162456771 0.072016654437465479899 -1.3551582263819244023 0.011847251991972831617 0.79786441601306756777 1.1091183930317292106 0.17710512740465894632 -0.51775238640439669169 -0.161007367176886379 -0.35398480530226789087 0.10995643991330118772 -0.62897104967207029258 -2.2106055605033541056 -0.12675848605491249477 0.064951121153044841239 -0.13324313844261212458 -0.47064297409299277186 0.81298063434304412844 -0.23438192149190542612 0.082258111332730171616;-0.63980334018910889338 -0.54692284840753158104 -1.2256997335015933359 -1.2553282636032081498 -1.0220239879224206625 -0.63033695008762158363 1.3574408393433345932 -0.97933512453224613736 0.18508864164936583707 -0.95888653623747743815 0.24827310781558439845 -0.66894632752692950728 -0.86211110325201834037 -1.1701014774067222124 -1.0483532595136983989 0.63335977053346792509 0.73322049605346117929 -0.32094226910954443133 -0.80849635167121103319 0.078027708189784897308;0.05252014341099118383 -0.78877746789898417479 -1.9143858859738063227 0.80699154848006460217 -0.88730751188912448946 0.21189318765991982385 0.20821815123630854627 0.32921266717502239985 -1.1259337705273468888 0.23105521950581778268 -0.69422821889124608497 0.61415226039506753963 -0.94321651452610244526 -0.15130274856029005126 0.4874461692032423521 -1.7611939143565586985 -2.0725264278679103036 0.032744900578143588954 1.9203721056370746112 0.22624191724724135311;0.031732696434546743547 -0.14611411100713808664 1.7535799488838799132 1.5095492875977876146 0.24470514135934348654 1.709252309592085739 -0.50102922376486280776 -1.182058509099025434 -0.65699129711926129715 0.43984672825239151672 -1.4840505311117331289 -0.63803369086111694219 1.6308670525778856675 -0.51209629598452088839 -0.062532242867315568358 -0.61804977191219145904 -0.16567123266608782539 -0.010626133477819365084 -0.93494994989593449564 1.3319093565501098908];

% Layer 3
b3 = -0.83445789586604512955;
LW3_2 = [-1.1885234257339600816 -0.09318154909579103029 0.062707589266011401485 -0.093792424856189368643 0.16061012529551330075 0.15040915065813573182 0.079290711119508125448 0.57260575412615233315 -0.024561130659750608773 0.071222658457360824014 0.058630761914483547903 -0.26714053802574355689 -0.22105248225754886571 0.094056650936887614689 0.040045471548459672662 -0.038335544131971259485 -0.14403288618776163843 0.31222624525657088901 0.073917437362530702405 -0.043650200254154572499];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
