function [Y,Xf,Af] = ESPER_phosphate_5_Atl_2(X,~,~)
%ESPER_PHOSPHATE_5_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:27.
% 
% [Y] = ESPER_phosphate_5_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.8530004638534069983;1.7254791988044051454;-2.0242578161700994777;1.8152479740849845058;1.3903706924122163358;-1.0480600803713551183;1.8617393555475481026;1.0949602804860476546;-1.885093624853740879;-1.1355258951681255208;0.38106624053042392752;-1.3870031031735976512;0.090943451111877571247;1.7064958109973153988;-0.72999429559135364798;0.38314416184914035224;2.7385176782263900286;1.7743417959296972075;-1.1776382757853451899;-1.6534867415806848712];
IW1_1 = [2.3791345552410105846 -1.7584044447904054742 2.1590224265943631643 -0.21722783183961053011 2.0631758206006227674 -0.81313016153098738314 1.1402952794168801365 -1.6447067387801472815;0.092805941186998947012 0.4405151961439911501 -0.38358344648692671575 0.090007141698665013574 -0.48707698360377338354 0.42170393232675618123 0.6152440736559821044 0.36659134838891893615;-0.54251887824809119643 -0.091850902098945627627 3.080416977658343658 -0.025330234187253542616 -1.6408549455009004969 -0.99640246507674778975 1.2856890648397125698 -0.96523410322845071274;-0.92699900396901124822 -0.34713120298961397392 -0.32800545573570422109 0.64891434190495400625 1.8947912193103413347 0.071445132645068520905 1.7523737264454579687 -0.45667037336215371424;-0.14595938829939930637 -0.59334187469562260642 1.5429937521126282363 -0.28731587548263126664 -1.8847547768835914983 0.14493882075037395341 -7.9928732190492424517e-05 1.2565118083579316366;0.10579718024310845459 0.70180821884458466364 0.81233667233334116986 0.17530823136272102869 2.4608559834356804608 -0.67442097357381580736 0.82151769359968707107 0.58044572113630177324;-0.016790540902481828484 0.97429446288879562044 0.23418382675961083028 -0.87516065197737780146 -0.77113177521834996853 1.9500614713858799298 -0.079233360493389415335 -0.076798511601210969757;-0.43879359869402123628 0.7748555738905067436 1.5913521071975926802 -0.5258595290052408 -1.7025490166803436409 0.025874943307562139894 -0.92442766983809832038 -1.2049824705920411105;1.1590129309991750173 -0.046089027866096039798 1.0101924947779905573 -0.22030959305812600202 1.567868391902539793 -1.4070209190024161039 -1.0734100356994689118 -0.33335750006559311531;-0.062660793009274823318 -0.94992452576928565477 3.2240201941649542228 -0.041253161620464579018 4.4517014752900436747 1.6385384831672951123 1.0176473921794098043 0.54379408045353960777;-0.78566808982835845132 1.6895544179715353827 0.50810095722713399802 0.013106385236956615697 1.0577619037226884124 -0.23701767112258259607 -0.67543424451282219056 0.0086386761914703322912;-0.4417199627099798187 0.35073567237004582564 -1.1496876000508571281 0.018856365710304006517 1.8101730431557729872 0.73304180212310354747 -0.2943497500287799995 -0.70771580093408070766;-0.25897784760653308478 0.28539840364192115008 -1.1248722437427247645 0.21504488765054030619 -0.5638825245241551043 0.78262787969784386455 0.78363797185181616189 -0.082342416524187028726;0.77596546610383543285 -0.91554100526375692404 0.0034087207463363213694 -0.043491193132994689086 -1.6426372856777837761 1.034491530173922369 0.13043374294711387873 -0.13962546177512000223;-0.1628491583446254054 -0.064643948505469964183 0.94763743827712199064 0.29874443572422498816 -1.1123493163484765578 -1.4788430768166829221 0.93439104092212010855 0.44329771032457310209;0.20406352709518060795 0.76009152242701427671 -2.0740343378117511719 -0.20704474303827016812 1.8386572901978006644 -0.88411967567168037174 -1.1206668111510382779 0.6212549619941942769;0.33010434210611366845 -0.16198579753231304168 -0.56123732288044125838 -0.2006463779783067003 -2.9563654143399324958 0.93925575062269672788 -0.60756767269258171726 -0.27424321577623872459;0.4798061083129919191 0.41696830790315481119 -3.5465180333385615263 0.50544698743556004672 3.9150610303661950162 -0.40998484687586922437 -0.30397618711233465039 -5.468075006023848772;-0.65813545857174526876 -0.070431530386684579326 0.19600076606976277183 -1.6615540706695108852 -2.7154037745585415387 -0.38472820047757011475 1.2316804866128598928 -0.68309819048019781995;0.16595383581752870539 -0.70491908269288106048 -1.1525151037309862012 -0.33147315920499642594 0.63902626706250509336 0.9095362290150631468 0.61751598910606730897 -1.6651251901841508385];

% Layer 2
b2 = [-0.088613886911310849048;1.2739651812321788338;3.2507535183216491603;-1.1698039123078605162;-0.50740748350761299967;0.7417383137547256533;-0.56293604277874398356;-0.38066848772512629218;-1.4189229720017364489;-0.59899538909686611543;0.66911730218712694995;0.63300668299650275639;-1.4414410883820643061;-3.9618552742197188365;-1.2782607038722251236;-1.3106495353128297943;0.25595712744826498719;-2.4868688553351971926;0.95434483323692087531;2.3218683646936537635];
LW2_1 = [0.78303329952932143598 1.7436360298221007525 -0.9671409871723880558 1.3751922272263035207 -0.62110122080218133078 0.097899713956846448615 -0.42716547258648329688 -0.73313424730358200954 -0.71639909124844813881 0.13680418433829871772 1.1302196459600122314 -0.9173385181550095524 -1.9418916716705623138 0.70428453730493212337 -0.082250769420772695817 -0.053369244993342376815 0.61164575841580426374 0.027031427264879337447 0.77794843166053628813 1.2576748872813485747;-0.73161977257963983767 0.85029771985685187463 0.93582176380861525899 -2.2252367836061317519 0.78961020141296311969 -0.35868939184174675194 -0.091044198365296646891 1.0741886860129497006 0.90687943992922148695 0.46220684593525501738 0.27758498283167687415 -0.47999927644273793215 1.2190084477070759483 1.821008063087913964 -0.46130103138946787489 -0.19561006547788373222 0.29233364426828700733 -0.30113652973204019236 -1.5522804865857298129 0.88429583193296856791;-1.0188423971351545649 -0.41588860020039458698 1.3527554347227994658 -0.17096603075092448032 0.16728567108299355337 1.4351587481159588933 -0.55465882164610513794 0.58672343161414608481 0.2600440086311639476 0.44418169436761517632 0.69179446901718666396 0.65278018811580174052 0.42122000248580043769 -0.4773432472660489867 0.2379202042070628631 0.60540408040502979858 1.5155383640977471149 -0.53431162996774239637 0.57232466966349093695 0.08532449837293559769;0.78505514354609073902 -3.1957212584058294347 3.5701736689837328953 -3.4399235625169186648 1.4079863729468002909 4.8058737220384122324 -0.4079865644400507696 -5.8980345321524421109 -0.93881764399046263581 -1.9434414662995720402 -0.38306125891601194855 2.2787032999225673713 -0.6829338984129220691 -0.6278180681363223492 2.3458505817275692173 4.2300861049416598192 4.6554115875850374806 0.62428367833040798729 -1.9880179419404437891 2.3971083798469723369;-0.17871663591805039828 0.96773117158938737337 -2.1782611306031549603 -0.15904737554684786338 -0.3464627861633472472 -0.68075661148715505 -0.1116715638084091744 0.47210063469460494812 -0.051323182132892525287 0.51392683118792181762 -0.12300196994502117509 -0.17609452215802914865 -0.3863232306513439962 -1.5878263061554445112 1.1799257481153382354 -2.3272661546666841836 2.1837217026067241576 0.07056781834501640871 -0.36889391246943381564 -0.65066226579333830138;-1.0345872436591281307 -0.60220794505045083245 0.93069245397283306698 0.29462212357582301392 0.0044436345587703842547 0.30052651905592192572 -0.077804067998896941916 0.038708580527716293651 -0.70839203102932701839 0.65837881623683702781 0.43687546848908559438 1.7570845584898817648 0.52400281732281972502 0.77572312420014433165 0.41594377372509333535 0.77398466625881190417 0.33989628565019314177 0.21996588002098496628 1.0333919971729819132 -0.5312724536314935575;-0.63036717600174629883 -1.0109071744695237172 1.1066797298108743686 -0.61080511499496503713 -0.054760761122900840359 -0.45641411985127849915 0.020675406884538786306 0.41392413576779713003 -0.44050115061406025507 0.20362460439396246059 -0.22599236508768100196 -0.24509820927323597295 -0.78525014082964295081 1.0808981922527247654 -0.95723233745810032413 0.38868100898119650743 -0.92233934240808490568 0.24634760977935754589 -0.74371426734838597117 -0.69571473965193675326;0.35630410414452984291 -0.14766135238584471301 2.6854120512642865037 -0.44492572976649141792 1.3617735449637946576 0.90714134724121653353 -0.79319810457091577405 -0.2310177014288478381 0.66900393272480862539 -0.13682786808372371379 -0.93542168338242592807 0.97520546611628688982 0.50271634398106979091 0.19713959185908025429 -1.4208806858788056715 0.99893215282262171062 -0.6425426739722363001 -0.19157342289476991803 -0.28157245043233214421 -1.1648767547567580039;0.32803265700624056889 -0.37724157176078360054 2.3607714038916296495 -0.25594588101132581537 0.29060246877663181708 0.29996584213876698044 0.087327379943046262722 -0.40362556823678319429 0.42673004610367776257 0.12848807071120871282 0.091892102248841617262 0.44355068326101854126 -1.6469056143970079997 1.6755689797959805176 -1.0674463272734582286 2.27862886547817034 -2.4891081832777186555 0.051920303638528397805 0.96628727986332163535 0.53376719604171662947;0.24644101364771928142 0.47626859268532306668 0.19740550742157594866 -0.73050599334155452702 0.73069806943718107473 0.96658776232425924757 -0.028999894434505964214 -0.12868369123547315769 -0.2794886391361989797 0.49885374095368251179 0.41981237288050654577 0.73230721451877012207 -0.47205433285099879237 1.2730131490553600049 -2.2934505859261933303 0.49324791754061442228 -2.2726695851221601075 0.12057429329296859288 0.014102459965740965844 0.50848108378743117619;0.66870893137508868875 0.85600337758866040794 -1.431242379436222123 0.19176639382890012242 -0.7472779251914464238 -0.20452844530688737978 -0.022171669262291270053 -0.22943348583957937081 -0.22454548979115623863 -0.11342228292225568775 -0.48352761499969015846 0.29937771116560613072 -0.71610890536288462904 -1.7504131747044251455 0.48186618107525430732 -0.55768213298990154669 -0.14406763157164706457 0.035427947461775972926 1.1120246269666524963 -0.43384965191795349382;-0.1209363264884454614 -0.14083526601963647362 -0.27251450529857262906 0.55114758404493657817 -0.94043042950106681133 -0.99214820421147775775 0.012698210321435933132 0.36569681960611749583 0.021996582373497053364 -0.52332521547816390761 -0.66226919179060583787 -0.65949311273478428141 -0.10748538567483360839 -1.434016453035925398 2.3531344263393862981 -0.66321702988658204347 2.34956432082292066 -0.14556883341514528785 0.11180938039692890629 -0.72581740530507210529;-0.24423667001499241302 -0.18067769789874807418 0.092621038420538967517 -0.47602617677326869439 0.80510233805384834316 -0.71828629903549434665 -0.25218929290219954664 -0.49574794784277631532 1.397359020185619416 -0.13677586828665708185 -0.14341719629152568927 -2.4884989946032196606 2.4277994620286884597 -0.43884760134226874495 -2.1071648840723860019 -1.1436503226981038495 -2.6278271578221801263 -0.12911335588663544471 -3.6902758301806928287 1.2613309585160072945;-1.7937371203366061501 0.27873532594205663315 0.35497533558206734172 0.30422374603292723361 -2.1253673557999612775 0.9107535379596932712 0.76456391428332282079 1.1644251419635733846 -1.0977428362961736408 0.62787618161181302234 -0.05040132608015323451 -1.5077994707692654597 -0.88814855525419089677 0.57711168642321575284 1.0655885820725987667 -0.35821554090188234554 1.8987541438106791958 0.48009985771545243827 0.19692290123358455189 0.71040206212809697828;-0.84029261817717781913 -1.0554725684467851643 0.46557023797871072146 -1.6153733469748075002 -1.0008027626826712098 -0.10480796684059019708 0.63075441565944712075 -1.0738742490086057302 0.09487097602969546406 -0.96064850680729363397 -1.087844269003211517 -2.214399768085765885 -1.7002550925070294419 -1.2840430631624220048 0.52376472252348238445 -0.40729834260206654317 -0.11681458330235718057 0.55991485019702469383 -1.2444597169418636362 0.80582330454859718571;-0.015477075062872297506 0.6332466120143003252 -0.67713949585999277936 -0.75645269106186385777 -0.5806555906920424226 0.14758034564657310228 0.19806640356288379712 0.56066464245987790438 -0.74068008908430449377 0.14488705026626660932 -0.57204158320891940193 1.5511652660679726701 -1.9792105126399737181 -0.20266887516772777444 -0.44742018281848805472 -0.75647606411075996036 -1.558493975345595528 0.39915110944351495093 -1.0594932108783614577 -0.93816506142813183011;-0.0033937347434574950331 -3.4373344193239883104 1.1118013170298870484 1.2028922536724195869 0.79069347267016476533 1.8331151237732663528 0.87667569177952275883 -0.56164736113639412984 -0.32332736809453671567 -0.40522867627888059516 0.25848447358987314271 0.062345715637302741297 0.43728673004192503138 1.1707997387695143754 -1.349405963315698731 2.1287291182215470897 -2.4104743785563096381 -0.037214228925951706173 0.51417080133604142755 1.7627316367996219704;0.3625532461221678826 0.79384062852990422421 1.2684175278653790908 0.32627981302821396081 0.061221642173783910601 -1.1890789732152058367 0.30557658005946236601 -0.54963618813246772898 -0.2391768146828355257 -0.55637601998433150463 -0.66409357760116638492 0.13582430454123223251 -0.80975721702571479277 0.89175657731299595721 -0.61660587973034552967 1.3758209774595446806 -2.2433072589340858904 0.30470373992418131603 0.4167842368625215288 -0.37703808020827656033;0.5564077172260489812 0.32930649707428139017 -1.8592128724471921331 0.42699714466209531816 -0.98507715846549503969 -0.24422703266550854773 0.2797875291911743334 -0.20093366556799502343 -0.41403239913738126843 -0.83274033937543523454 -1.0838928827593072857 0.31987247362887877289 -1.4705813882554030769 -1.8507727475176871668 0.14578000071778662861 -0.84073679569408854562 -1.0233926742925121278 0.17109093486904253245 0.71326797700270694325 -0.47530516022667490539;-0.067445640418591926157 -0.73030035630650214085 1.6304237313785958641 -0.26571262078573565368 1.4944570993457930719 -0.5069381668696961718 -0.44496269776679764352 -0.57472766573875433416 0.90850177844181934095 -0.49420816628463343223 -0.046891580107736280381 1.2123291203267025917 0.25013112301073847643 0.22693372149945897909 -0.43228331177544077057 -0.512304183318772699 -0.25971352989719737048 -0.034204568849095076666 -0.19044107183358449653 -0.29591578039872823425];

% Layer 3
b3 = 0.95160672070276419721;
LW3_2 = [0.72230814948546306908 -0.76833327299018649992 2.4634770149903113534 0.094864274823013253202 2.2709621148212244535 0.7292085015113449753 -1.4105116107556880944 0.53318367967370516869 1.512001809579184064 2.7438492995381986717 -2.4430898193506296323 2.7534321972854920446 0.45878139712603055456 -0.54878646235912376117 0.52177836098125385256 -0.69049790340700256674 0.45835350952310049966 3.052984399428623874 1.0459510458159093638 -0.75445320005142224584];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
