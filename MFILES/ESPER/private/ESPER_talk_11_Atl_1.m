function [Y,Xf,Af] = ESPER_talk_11_Atl_1(X,~,~)
%ESPER_TALK_11_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_11_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.80469446338174122;-0.98993590580932667;-1.5928055919882356;13.504919450608506;-41.883879121737337;-1.8633498834519244;-0.93796350777514015;-14.529951640432618;6.5900930698693525;-10.770446926866207;15.12123094571742;5.9636808167722997;-0.96026999301297944;20.472087500215665;-12.760611224201231;-0.18563596828461107;-0.93540036006930793;5.972444214941202;-0.52228357240033441;-15.397968386499645;4.09737366707897;1.1855489009607114;3.1664492592835169;1.1967500723649094;2.3520025397090323;-7.5003735699793381;-4.6759187138949949;-7.7207723818510763;-1.1020647630931693;43.161873273251722;14.008352576548155;-0.82331722680436503;-19.107386008580612;-1.6670879897470476;-3.0458024216907811;0.45304191039217889;30.115935793444255;-8.4161968861909422;-49.892703013763025;-7.6369318793819163];
IW1_1 = [-0.13504644567576654 -0.0024260391459651029 -0.32492610437555763 -0.76552268248165845 -4.3685854735079532 -0.11216241266580797 -1.1210199285984537;0.051894146287906791 -0.27386384528469659 0.24248634520371259 -0.20163051040336 -1.09017961145614 0.44857398829916417 -0.30651354229417832;-0.0046096709070872887 -1.8121431592513511 -5.009496030798652 0.30799423296051986 3.4088497692577295 0.32775201981174518 -0.17776529763404025;-0.16620689569898911 -1.4420392547511478 3.2852663590050595 18.534495455981411 -12.482972361125592 8.5349583571769365 -6.9833731478521122;5.8236385694627382 5.0074647188307662 -15.959292269805484 -13.186889227042132 66.523435171000671 -16.292765666070967 4.5691183733767593;-0.010380907743583818 0.55666271089041519 -0.5878498988264077 -0.86575531031439545 0.34763684113589149 -0.31216067904310135 -0.4531694726387816;3.3324224069390351 -0.43384614533575933 0.41222675106289114 0.7795455182035258 -2.7006295120342108 0.12737780337085897 -0.42600109919929274;-3.9493325488800033 -0.67809551127372902 0.30669112401497278 -3.1602580231989439 13.107117221694452 9.9360934209362366 6.5967729475998969;1.5312079088681658 1.1688463456404348 0.0094225166254451563 0.22278945369927325 -10.473267673485184 -0.29807630881897107 -0.36729844532938632;3.3207576717582321 -4.7865833531720821 1.3154314433009524 -0.22824851524518597 18.867307249138193 -1.5246660957266154 5.6208367750956283;-7.8875709092589554 14.708282505611884 -0.30030563673672728 -0.01847698699689251 0.071265703284645862 0.13710778953524763 -0.2811412894913824;4.4225726846568891 -3.0707401256067248 -0.57248497494886763 0.06251256398312717 -20.213402660304631 1.7837144618244469 -1.5449779501901324;-0.61459398539723065 -0.11610239603446694 -2.2473023531277407 -0.75399887555156853 -0.98026231449879586 -0.27846031686279632 -1.8053442167369871;-11.669359057032141 6.3226542845001212 0.76331331161014215 -0.10238502727104451 -6.1862493066196196 -1.6725405105173075 -0.40614046517985453;48.462112607141115 11.180664804833397 10.207038270713246 6.7362358945388632 -55.686404502901937 3.5090822449244712 -55.536646128118903;0.48269683833226645 -1.4139959823137505 1.7909555532402814 0.40137488315108893 -1.6923553227749613 -0.31543994619175381 0.6326009386611251;0.11029798705158676 -1.299845281496065 -4.4003455388815267 0.18641083533050234 2.7537432434160669 0.2267342583951055 -0.060302014406813362;1.3056581898225021 -2.8578770504098672 -0.75663141054186489 -1.6510840860484097 -5.1769373973643358 -0.70170373446532375 3.2747902818522365;-1.3179673221550092 5.9040219394374729 -1.4075511706675912 -2.2446191484990634 3.532074990320206 -0.79108837817750011 -0.7359045462145275;1.967421093075292 -1.7909774897023827 4.4551797139221021 2.9701708213368629 24.470439408245923 5.3505202040160436 3.905145359065739;3.4710409730238765 0.7201507791074947 2.126819399662669 -0.46217171620484787 -7.6248465458240204 -0.88196191453888806 -0.359035338796097;0.049561743188956023 1.5153418811741186 4.7781029001351687 -0.25565261028496444 -3.1597581961703463 -0.27089020797217461 0.085517836876961739;-2.0879963857421173 6.6113863316560257 9.5479407513476655 0.41596311834267002 -5.9535804138178223 3.0953260290594242 -5.4374740066122955;-0.37468547024094012 1.422119266637875 4.1737276873633453 -0.15754691044150662 -2.6156439558651634 -0.23954271454788748 0.13222116808050885;-0.37424209401615366 1.6281294043232337 -2.030440471397335 -0.28171372825420637 -1.5618660516164158 -0.15784920372829142 -0.86119088729621651;1.0074211631237631 -2.2875818259671283 -0.17615590536755019 0.45220569863937676 9.3980877044454534 1.087269937639151 1.6090504154243248;4.9360875012094247 1.8888574744691333 -3.2111951116729673 1.0279804284837353 7.1998690058288579 2.8190587338096749 -3.8871283285426914;1.017413598808441 0.96483489009477585 1.5319047418560481 1.2301151638058352 13.922326110147177 1.4227097536370574 1.550379218131722;-0.65011806829399899 -0.12877225782789078 -2.2131122890086878 -0.75837670348454234 -0.71745441104883567 -0.2411510436135931 -1.773742872516352;-15.301128531177635 39.952524917703791 -10.666204446501391 0.99891014892690966 -26.871499015963991 0.37307240175444667 -6.5268382088839783;1.1328055143736206 2.3802945844054766 -9.7471084556668366 0.22248419884335591 -9.6679377317706745 -1.6360917801908688 2.3499260935269422;-5.2152446839957642 -0.79603940389653294 -5.5944316027343604 0.91822472992492865 -9.9462676565697876 -6.0956631984539884 -2.0572831840366677;-16.376089934292683 -7.6627836583652389 -8.5003297420538573 -11.730585740096304 -5.0692854594899917 -2.5926257951210507 6.5681871850181617;-0.027279959440777258 0.54037715475700154 -0.58671987626740718 -0.88289325754119663 -0.0046817663868459246 -0.3229709095591623 -0.4930635124782598;0.99494660586808337 -3.6158129890601178 4.7746775659501575 0.39425273801871485 -4.2196198503961417 -0.94113676906746746 -0.82318111801695604;-1.9994351621615833 1.8995061217765237 1.490637390990093 0.25922043563645575 3.3669745749895146 0.6454725640512895 -0.0398617124527764;-1.6811760017155173 -4.2157016920550463 4.9875740670796782 1.2477744941005002 -42.804589660915902 -1.7631855602951236 2.9492957658341497;-7.4625885846942062 -2.9494623661744805 -2.3492664078575625 -4.1385986390028897 6.5420963038007507 -3.4537080800610003 6.1197447134983625;-4.3872455015898444 -4.1574540264962687 -2.3225336054630739 6.2697676162710501 66.300781462786304 16.479363211036109 3.9972398049553939;-2.99430610608258 -8.9348720426553765 10.991858871661965 -3.140683536328372 24.9082874715454 -10.269575700542889 23.333132021278171];

% Layer 2
b2 = 0.63182292248775018;
LW2_1 = [0.24045198184716107 -0.64169455153987109 6.4224893377849348 -0.0014579353809344811 -0.0015333777638511989 3.7322187794882264 0.051213653843084517 -0.014685630187446194 -0.059283045807847518 0.016923734014273668 -0.016632941580258232 0.016494425383476469 1.2041128271737962 -0.30444609386698235 -0.00035560735968074902 -0.2892757978199621 13.085888316970935 -0.01553164468341978 -0.0086543288151283999 0.005960031338644479 0.016767964715676185 13.672592768297504 -0.012913648348260811 5.8311204507570142 -0.19756605252298551 0.041548337949560907 0.020127730500921596 -0.026359419895991221 -1.226267807610314 0.0044589195230776996 -0.024388977212792654 0.031393527489956947 0.2674682755493914 -3.782173263873136 0.043160001184591644 0.069834218032277046 0.0058983955140484573 0.011633907779876605 0.0036061443697994518 0.0026810446516129503];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
