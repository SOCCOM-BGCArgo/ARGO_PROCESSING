function [Y,Xf,Af] = ESPER_pH_1_Atl_2(X,~,~)
%ESPER_PH_1_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:20.
% 
% [Y] = ESPER_pH_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-0.2178;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9794467697394431127;0.76860809621530834512;-1.0355913902808560056;-1.8796567295656116947;-0.23984686102920063644;-1.2364758553215136061;0.3707531965662782536;-0.17930592164095959795;1.3299281376647362762;0.64204231614282569751;-1.4402270013825857475;0.7262728872909621769;2.0530807678358478086;-1.059465150570414238;-0.92338825967410353979;-2.4711217368318312282;-1.57029036813242584;-1.6999946181497913589;2.805800339053712289;1.4245034080703664614];
IW1_1 = [0.011580024672584898759 -0.45512333288221906713 -0.035176661261893039934 1.5138571177936075429 -0.496712501614037516 1.373764874399483249 0.55739466564223238976 -0.73135577960465503189 -0.24439728773297539344;0.083081014984360795905 0.0089893418867457129673 0.00024753821628185988107 -0.23913661954841511359 0.53556749048326379725 -0.24613157763580331694 -0.25981524556266599735 -0.28326184090621697731 0.088336295775306439282;0.8226755845198835404 -0.67435999338094132494 0.55344941964384264388 0.38240793707446224525 -0.19538621417439042127 0.7480147542047730358 -1.0568652877667970014 1.0435009164177846408 -0.92519218771352651487;0.60572031096891831847 0.058978613889323544539 -0.59828718088884524917 -1.1988026623936225423 -0.54359439105592499697 0.0075645297206092428077 -0.39541747563892426509 -1.2983959202404269373 -0.04797886075424340202;0.24682055142730871533 0.42025953831604057065 -1.4240223311995734434 0.510388235338128049 1.8578066366031800172 -0.56866361554825384239 0.97351670475030216423 -0.50417743290729977179 -0.036301335838620926721;0.12425534778378444223 1.8945668084941649223 2.5758018146103238699 0.28865716925000001192 0.53811956198888499792 0.99605124502383735052 -0.78821193395175248586 0.08720448637340179332 0.21624210253545161908;-0.27265491187016277497 0.19636774770231571474 -0.38265619336135137107 -0.72090368197917076287 -0.94504314710911874187 -0.094636960228069610945 -1.7440848373501709467 1.4050008776507831865 1.3527944572762202746;1.0298294198872712801 -0.55447334123093383607 0.38903466945170955826 0.60574273643510279097 -2.02800017869385929 1.0368640256059327154 0.33548236307997175709 0.21261735997504152551 -0.93811372155417460661;0.53220232500250952423 -0.78444942595111188943 -0.7233987318237177222 1.141904921294242925 1.7300875893413933948 1.9664297924286138208 0.53355491046950642708 1.1925752116866232821 -1.2911635515541335373;-0.39664793245583040981 1.1310612949339782229 -0.26401304342581405349 0.61065262766280170581 0.34284508141070413334 -0.97738741478940616147 0.22969696811453305108 -0.52960747671527741431 -1.04387697141143998;-0.25109549229150268657 0.10703497643955543761 0.26060360064575727179 -0.76027250896438036687 -0.27604892981748774261 -0.67736325213395520706 -1.2370006188321827079 1.0368698303342516187 0.81272455879678007218;1.329653877603697687 -0.51031940388475283132 -1.3243418065682459606 0.55891215779540937003 1.0749111638894270904 -1.1713669136427491413 0.0081658693774289276002 -0.5502150449146347988 0.62618169358528597002;0.13677941443492977469 0.45663529101611105565 -1.6466143091419807032 -0.6016958825243342579 1.2110963135868313412 2.082412995475228179 0.18765216293893466348 -0.65455502537751475423 -0.0054475305772059036402;-0.31997522853483384431 0.076430427596205996466 -1.2441488849084316737 -0.73467051685582318576 0.68479800696109205393 0.31090964687992672655 -0.96176852216737074297 -0.32447968855339781591 1.7296771249556488481;-0.45005369387046689766 0.48583329277410264302 -0.49926698235354544098 -0.04172002902481382336 -0.4052285691778628185 -1.6445125607747010932 0.141582544667040372 0.0010022443674128894003 0.11713781327818270639;-0.62257407166194100867 0.091879400026627533471 0.20883984978777273001 -1.0655141039445801265 0.078597772017847650217 0.34712893041133791039 0.29098225205112066005 -1.0391758075373265235 -1.0895148807299570581;-0.11191478260105264253 0.62700108973703638782 0.42734234974968660081 0.20118380412010031244 -0.3574853211993081481 -1.1165618736482556539 -0.13782062865898087045 -0.56374162249960380056 -0.77173191155061959812;-0.52609515671355655542 1.0790263448740282648 1.5698973064186727555 -1.3281956099709864016 -1.4024693063271866933 -1.2535738314504782931 1.29344427666049544 -1.3112797036145293905 1.3607884092590960545;0.17577750401202082986 0.16910177243051377483 0.046243638181274540622 -0.44854248435856142185 -0.11348361757513297787 2.4537959206873614093 1.0470697708710485774 1.1986794483922418308 -1.0043644094317298876;0.89912177218521893707 0.093234423179100384127 -1.0007985631815667915 -0.69941864240265694264 0.35899455549159658974 0.05513280589892415734 -0.33935999795576965443 -1.3507032542924723995 -1.1473265848835734193];

% Layer 2
b2 = [1.6657957487069918745;-2.1400819286501451266;-1.3054210299645656601;-1.1544087565277849627;-0.43318784500252621728;0.43095455855610409479;0.46531584412734228184;-0.29489922046547994983;-0.27440603577528854817;-0.71801727944684046179;-0.13798408030248640599;-0.35364526768308635063;-0.56108310591863375105;-1.0745234616009542439;1.3097597197168548977;1.152027727052282513;0.56541781804012247736;1.2834650714524564741;0.83730454513330221378;-2.1673012164385636602];
LW2_1 = [0.21837034082168715887 0.44947358177751600694 -1.6441882994025935893 0.10631469455141781544 -0.11439906445171954541 0.4763657248216610629 1.2838921229135373814 0.90723595016518587819 0.11031941245599692636 0.13357283021578414406 -0.34503181557451900741 0.029432242355608675272 0.70118255711951449349 1.0288796573268768064 0.39806494023130301052 -0.50603282214815825668 -1.9410787950034382732 -0.062006864522757103309 -0.76466591948167295101 0.98548542492391166814;-0.39998037573315620152 -0.47777226826043411867 0.22008587575845359186 0.24351192809762989278 -0.38507299398284500214 0.92935224262398719031 -0.26010075695891471392 0.43557854484533364836 0.017876774815117603412 0.12018559194774082466 -0.35097313396756329995 -0.61077329456529894092 -0.17770191626509404537 0.096380648281275960176 -0.015436333555896073963 -1.0965506616710944954 1.0533800579519345675 -0.90977790550134685077 -0.43895484513514188007 0.176270228650670574;0.016799435551381802778 -0.47090474488659594954 -0.74128334282326202587 0.35046268551263792812 -0.68516594415664822115 -0.16203820655335077205 -0.32198496373490642641 0.028750798604997542668 0.78702676964593609732 0.91001345396020072442 -0.21911500000330000337 -0.47613538550936879146 0.41829406536898156022 0.011378736786688502941 0.048200226573382333461 -0.84937104920266692787 -0.50172520066473136335 1.695256283495224725 -0.26087652387911686169 0.27444485544563157475;0.17741607121622232635 0.80173127254791332064 -0.09565751789331171373 -0.19596909131647774482 -0.40993988919216001188 -0.1277005591440423804 0.55612081594711981758 0.34039971155341569586 0.73639274040090818563 0.062044794343384751523 0.39113576440331665474 0.4959344990841814127 0.38056075158262581137 -1.400168738543225766 -0.060255069638272061583 -0.45442620950653406231 -0.62423601387697669196 0.86686827274369815388 -0.78687197324354174466 -0.54763677579901992587;0.42466926357363321554 0.8134831417349124294 -0.34504508645209314155 -0.33721731028884160963 -1.0799285437731851456 0.15645888040976449473 -0.34882139889661240018 -0.079579219307854900944 -0.36475450006119336521 -0.61693732084431018858 -0.2144978824857915467 0.59699551704965170273 -0.61906116297908708734 0.8472512231393984905 -0.88512542566697038904 -0.16671051660145361217 -0.64084977475743576392 1.1739424585503162035 -0.21256394642888681856 0.37213265952903373801;-0.26728173503088692442 0.12194739333415131888 0.5243908183500340936 -0.3832507807579710879 -1.3148683151394597868 -0.40491524042292276198 -0.0084071695550869650349 -0.26128892257383695696 -0.88973980046288558832 -0.37293309144017477985 -0.73853051665038704776 0.83226515155906177768 -0.53722798966339302407 0.02405629235664568516 -0.081234051741439522454 -0.88928617337597370973 -0.57382063055001253371 0.62605513685735691976 -0.62668157617512787461 -0.89363840133094007978;-0.16331101937019990022 0.091367825737253438589 -0.21525282481193458439 -0.0043024001226763929767 0.2669093044812072546 -0.22439979045566471605 0.50685657402277151107 -0.38488000821576101584 -0.2715381921310030533 -0.0092190054437455200981 -1.3479951166705759213 0.38477736497809411631 -0.57862457577975812129 -0.16015016454961403247 0.13883534246639162024 -0.36172607492290570486 0.38875730366345917499 0.19830697346135980896 -0.83573271509783564337 -0.92284168920396147939;0.064691964077066732575 -0.16613780071958070272 0.69267284846012633359 0.063250797820394652482 -0.39512831988435404007 0.12616806692941365253 -0.63694864903859949035 -0.14165054939649451837 0.064957636339460167463 0.84725220328026495942 0.090663364993046779983 0.45231430817829421098 -0.49631363169597264573 0.15376976079841683798 0.027569937392075839766 -0.075751267042341155489 0.70748432171882624786 0.76020968248413478552 -0.36377629117591270269 -0.44004265627456862209;-0.44425184921281135608 -0.63479500040489100776 0.70901289307054149447 -0.95961773177708620253 0.37992481370937847274 -1.235359207291151451 0.51594243993195532116 -0.005449175668422376155 -0.60044298452779587549 0.45696697569729854971 0.88342106861874614143 0.5017679209389941386 -0.5687333304467706574 -0.85487838892913414757 -0.56650734883594533464 -1.3547442170124608385 -1.7354033540053681595 1.1786682116981570534 0.19192045425178957951 -0.2662980702785076037;-0.073603551723139801211 -0.66408561178392278013 -0.54851808453975103852 -0.092451296914750194511 0.046091717870694631776 -0.65415692205657094416 -0.15540260220188090168 -0.32608818280762896791 -0.30133335804395217083 0.44454443733245624371 -0.80752632679540414795 0.48774899616611822051 -0.52330829039242632295 0.1360546689695406597 0.20893974492753555894 0.17266656252332265864 1.2440921156746240772 0.03798045916000461486 0.9422527625068854995 -0.53741024590231034619;-1.0721381884594689549 0.10688443499437788597 -0.19263453011588702046 0.07588369184796101008 0.18466564250555544957 -0.53852894623471658786 -0.76248833001234939122 -0.1087345214583118197 0.81499832670422767134 -0.13061868263259632239 -0.2247666153671991629 -0.62041739647809857061 0.26614534686720986434 1.6704715190045580364 -0.36010913298012331429 0.28143828751264376997 1.5225547641860184278 -0.41859015310247016384 0.76667891179400982082 0.56644363353457660715;0.36744947198793170839 0.60643961565929005442 -0.38474139639972620985 0.19344330429375788949 0.73002631791122196692 0.50403491964498703393 0.14936977646928931152 -0.58607767319576853371 -0.56603755157464985537 0.1050204019218295981 0.55929106001999862041 0.0017215448354780242025 -0.36732196252766602385 -0.2252384670341940065 -0.31823966119271035469 -0.45033206093389605007 0.19334675825295247198 -0.60404143671624954681 -0.8229285837289264105 -0.069340489066646207594;-0.49993636289580739573 -0.41510321682818351885 -0.71059790101522291028 0.45243771146878053457 0.24453622504482933064 -0.1405774499258391208 -0.27293991340774820253 1.3019646661013342115 -0.13513171323633324516 0.19728416282668864712 -0.36607118621379985957 -0.5275341685734196151 -0.80070148650148387226 -0.89559358511816111736 -0.089997374448175557204 0.87716994731247244221 1.6074172557391050997 -0.55931205199746591994 0.8823700014520483581 -1.0034597701949032889;-0.15470470902784774769 -0.5471141901679047459 -0.61418433606649325274 -0.37816813854724679045 0.17292210847646746763 -0.44185762812388251763 0.4121047135572700193 -0.6608990584384533129 0.47658210195484829175 0.64220724010920182678 -0.91188507158640208505 0.9471147727201169042 -0.23860947738098428617 -0.34059004167281820008 -1.2923099616984041749 0.25815250644764092813 1.5716655819705889208 0.9704281669426756407 -0.35562881178057870191 -0.73107060376976051863;1.9260393400643636141 0.42056996711471844597 -1.0556772578428947895 -1.4284101788018805923 -0.15377990660499624154 0.39721080438624112308 0.23304351077446619489 0.29930336566053583613 1.6672281810076603481 -0.25226807702874554096 0.16002481484292596647 1.2562395371715984194 -0.11704632934692581203 0.17346632723557547928 -0.089714850080273800259 -1.6195373904072105642 0.16916422544354325908 0.95985825719109729715 -0.087268598331089422548 0.1783403465115656894;-0.45942663042232562143 0.93206589355074476178 1.5171442268468866565 -0.46093596772094375114 -0.30239592226391559526 -0.77411820697339961406 -0.99048186602118515331 -0.79087606767863827262 -0.68256804898626677325 -0.26945128982484889413 0.24273770137130531999 -0.049801379243465337954 0.013462499142214170295 -0.0076330063570506853643 0.68388109463932567067 -0.83644032739936347021 -0.18578092639500448646 -0.37900815737823079221 -1.2336295859047183843 0.19866955564630386921;0.1865860850817082639 0.50332508703312373033 0.68931008692444628583 0.18821533321812411454 -0.4352964306261077887 -0.0099888101274112628403 0.20926540706329799235 -0.65993014545443073882 -0.70782648929755853651 0.089066536276156349494 -0.3439573882984615083 0.40580364655307288313 -0.71357409775365032711 -0.16000670463714872227 0.62328730025981882168 -0.9753275112172882233 -1.3978451202909631945 0.64668041883434823625 -0.76311654140160700699 -0.84343899554723755774;-0.18048490669030434197 0.047135046016270713831 0.095284622552565464981 0.33355486533228800861 0.65008482413281676315 -0.36943209776699703628 -0.19032073154262646453 0.1601520582738297227 0.023524130379404220581 -0.071258529863610753363 -0.0085072252515532229 -0.30711236358198079621 0.2391607903928462675 -0.61999843036435287047 0.67682770611977582931 0.86948425920429039948 -0.098347440543786218692 -0.58401739216772308172 0.24914454602804150807 -0.29413847305331286552;0.67739814480165683186 -0.016412165354053626087 0.80425111092295353821 -0.15523561101458860367 0.79714277124168375632 1.5155361525553616708 0.74498388305081486571 -0.44045799937923424405 -1.0748788862002767175 1.0939260840356828108 -0.53542435412108468906 0.9222191991664016042 0.28756852234118784883 -1.0951787070579599437 -0.46030832867933985098 0.28671681332048098989 -0.20396528468739646978 0.45737680617897980007 -1.5754715561948797742 -0.24294511556575532074;-0.88597266784423200914 -0.69523533095349365762 0.30124536216389197207 0.76024624999746270859 -0.14530486667592115713 0.47260126360498888598 -0.6559911647809328894 -0.5247394190627459043 0.3268881133808387851 0.28870091667500885624 -0.93973990630510084721 0.84431830872087876294 0.24369213775993175952 0.17278722672601734556 0.64566977450202744926 -0.55166540371126548958 -0.50305484416451995422 -0.46570875651261972594 0.96388030685346759441 -0.49239863518596183045];

% Layer 3
b3 = 0.30300081666861700125;
LW3_2 = [1.0805660525625560009 1.2462063786453774217 -0.64918975630926323284 1.8705968856062518135 0.86014654889381103597 -0.73544811229533668673 -1.8443896831547732518 2.323714879907816222 -0.16622840620124473832 1.5661035599274750751 1.8604492095895173165 1.3743665490819572117 -2.1595803466103404844 -1.0903981858213771527 -1.7827269331737938263 -1.0953480509908339879 1.4048142825972942394 2.2492431803116739175 0.43810603588939606157 -0.51256316369595755766];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
