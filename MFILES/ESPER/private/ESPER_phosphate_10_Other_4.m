function [Y,Xf,Af] = ESPER_phosphate_10_Other_4(X,~,~)
%ESPER_PHOSPHATE_10_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:29.
% 
% [Y] = ESPER_phosphate_10_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.9141115390735379265;-1.6768313821224745119;-1.9572486256085039891;-1.1358094832322629397;3.0050868287256924383;0.33482482832193605216;1.4136667578048358607;-0.77758926277489881507;-2.1833413306285032185;-1.9515882074360375587;0.13404954963521412137;-1.4542196115653560629;-3.1440660609622277377;0.64472361613534800995;-0.40210403457337678956;-0.69088718585770791947;-0.41433367179256808122;1.8533222140241409903;0.66318214009025855393;-0.25207353921587699608;-0.083535407178147461082;0.091105476046058300743;-1.0650606006975829043;3.0493862985131214849;-0.93883786107855282665;-3.9734406501768799735;4.9321365294172441196;1.4706754844109992675;3.3745756707312231093;-2.1039705918927809059];
IW1_1 = [1.8705013993344739021 -4.0744450708779345049 -0.69088161826414695721 -0.78004665746197709986 1.440564226353737487 1.5867786902005263094 0.55387774061103522971;0.22480947719746918745 -0.7557636418838976633 -0.04194791049222373891 -0.25490868113733017308 -1.8895490095247915452 1.3365884633803546411 -0.39737821521334559804;0.72707001680270821886 0.46768202656050938959 1.0642959512304466241 -1.2304533017403012085 0.95056972797884142778 -0.84260062939624447154 -0.46267143455900616722;0.88380064190352503051 0.45444869411942412363 -1.4288622202642324854 0.81743128523520680595 1.2209957917553131423 -0.75747266068640883852 0.49536902684179040524;0.12284933537219690225 -0.47073189805430759591 -0.7212525411781528506 0.47516958319726859683 1.7450874531000344358 0.3670483528920679972 2.6822523713426247305;-0.67380587552432791298 0.043667497180539346924 2.0706998748624485529 -0.81569515108714341078 -2.827745638712197529 -2.0806338164705953098 -0.89719228131367489976;0.24203011066595178646 -0.83800590545372810602 0.94254633424082978621 0.038437583590477768236 -2.1203861709543638803 -1.4963132351515404661 0.74255608196714306679;-0.17470740104471299547 0.16963440714424984912 0.56408213809501739355 -0.45361180606781514868 -2.822055594975444226 0.72338008723817115442 0.43643407034135700551;2.3180024699122179221 0.29317447662319706669 0.089091690094258962906 0.76985781844998213419 3.1067866539631245892 0.23238937106130622134 -1.1390210000461897799;1.7116790433409803107 0.014039197047888876679 0.080831824732460796912 0.95937529460780612833 -1.1205782114212115008 0.76214505132669663201 -1.1791308810404552698;-0.12449767212869383703 0.73279577447358990039 0.40438987411878540845 -0.30811571319270114611 -1.558556891230162611 0.95905536062351504079 0.58160977910635325294;-0.77724444265030723233 -0.44081672360029361402 -2.402330017567795295 -0.82115617283916053637 -5.8813018209996208441 -1.1326293223254213505 -2.5509859587538388226;0.79534559604451526837 0.59828488942304103304 6.0365932559138757441 -4.206750080504651379 4.8369128095233566711 -1.3929727868544727887 0.64435037164543496058;1.0738938061125669066 -0.27945908100129507323 -4.2574106104468079081 -0.69631520359675369569 -2.7349884413830234386 -0.7038978819147967414 -0.2216740420255533528;-0.46496104863249848593 0.55142721772846403638 2.5094233070834488508 0.30160584761296083123 -3.1925755461101847921 -1.5748177259721993781 1.8034554424845332665;-0.30400859988642880971 0.44616042690652824021 0.96082045089993695086 -1.332202851981790781 -3.3469775810232449409 -0.73104321019398810222 0.30046114329976436608;-0.023859849799093738043 0.31127053913523217155 -1.1368661681978957656 0.47853536109339300797 0.10828259670190054642 -0.76678177794589075233 -0.43116049427546138118;-2.7685781720692026475 -1.0180610712468469714 3.2715828240868720655 -0.43183973038089051855 -0.71715349944448192332 -0.1070053461396876654 0.92732254186537232954;1.5745142599086339175 0.19638153213461176372 3.3331065926200604821 -2.0460634446474434966 0.071608045447169074715 1.8321923512344790996 -0.49620533295384122718;0.45769790868836596198 -0.76434707554561565068 -0.32757440212769722843 -0.20492001039700843967 -7.6172834924827874659 1.7350529341105047632 -0.52261306044441058205;0.32402501739990158258 0.12514529312502170599 1.1487570639700299679 -0.21666868708563113977 -0.35739414089235188587 2.42641892516329305 -2.1926769210152081691;-0.074154378067391793494 -0.39773248709639874576 -2.4323741281610526954 0.50874556116241254067 -0.59618286335798764686 0.10399846978226268135 0.94907558414147286108;-0.12303139271565481649 -0.098208678138871546848 -0.094098916671674595613 -0.70738116064310985198 0.63933247844513452218 -1.2076721445810765232 0.7006268074909411947;1.7677636457301495465 1.9358861351936409445 -6.7272180920371562607 -0.88892541014154735635 1.355788626743616998 -0.22460639702479789914 -0.18580594971655392533;-0.38720251751002349172 -0.27685246485415743178 -0.52333563819156392327 -0.052855427952907957367 -0.07405288091843803544 -1.2369282885927948001 0.50470075015114490569;-0.67262595605796005049 -1.6045108739347349047 0.69900869906287721456 -1.1871644722186760479 -1.0735037705145469289 -0.30649305095324674841 -0.24307398013716668972;-0.6577160297017237145 -0.093499095942989551844 -0.024187079933497498269 1.864234919320690631 -1.325385849412341166 2.8891413097820315414 -0.62881799153691209092;-0.089666533944608758921 0.46420458750499177247 -1.2090439766999252491 -0.26528652774418209903 1.5630877398302247538 -0.79920943979197656137 -0.65128965118545167901;0.83363234032508504168 1.2906784232374357568 -0.60932986843710890135 2.0573457054677004585 -3.8937235779352676879 -0.024077863226056893386 1.4568307203772687952;-0.45621125648108989958 0.86505853311851721443 0.88169393573992993485 0.2812227693718554189 -1.6253055793445339017 0.85858524143380909877 0.60205238425791196555];

% Layer 2
b2 = [11.591762816328410324;-0.2746933943047596971;-3.1200607373831306113;-3.3699784432858712613;-0.26539893141588688508;2.0418504781899424749;0.34760392126332129159;10.036466377448745035;7.3687837301815877211;4.3927104950197577438];
LW2_1 = [-8.8659867950960045135 -0.43089380266144827747 0.046973702311058726511 1.1973254849130776645 -0.20505419485108922206 -0.13575969559669112674 0.73343414937730433412 -0.3786622459273808472 -0.047453883441610909821 -1.2892895794728029824 0.28514904129916057718 0.0032874933059921676408 -0.62591240760075850247 -0.27598453008729217917 0.051578030875076209816 -0.65377499198853128437 0.37233621324025178989 0.30973585568812739277 0.15277334946645823588 -0.19990303466692072032 0.9506451855638295978 -0.67247140020000562011 2.3376844884907512778 1.0958001248336342037 -1.0928790120331204339 1.8773510677352687193 2.1931499832455414456 -1.1505519686748229002 0.88747186846391346027 1.4664253619173641674;0.15972230284192789895 0.31977333231196175545 0.8442819618594511466 0.36710615957904219053 1.3563443171581617275 -0.56312044970324981463 0.09058002103675184824 -0.14097156886765843664 -0.48478993616969623393 1.6853346889208029591 0.84231131779280721261 -0.021988795789270734055 0.039037233809575522248 -0.015736658254890935338 0.40472403018883135184 1.7784944386735590527 2.1317242261203799281 0.35584592052020369568 0.3934898899638196168 -0.11895898801561392844 1.3143026939494182326 -2.0294299828566191302 -3.3413643740746779009 -0.13190111439163218487 5.3911014658142102363 -0.0091022950557511812797 -1.3665380579159609464 0.26177641029385867455 -0.035727692749801163996 -0.50722396183071050135;-0.033433837875848450294 0.035523765859309809623 -0.84990276970723421801 -0.37648309703339233323 -0.065574329055659422161 0.53652617138700875454 0.52391957650186482542 0.55444270706263287796 0.27974936398221439404 -0.72198514616263187449 -0.033773356117691520628 -0.02812103138264169383 0.15134933028338640182 0.26294853474254537007 -0.5676464974078860859 -0.18533977070170315482 1.3303151901540657409 -0.0029568388884150917546 0.039653820108407247802 -0.025145464790440292396 0.65257590823186739648 0.089977964093558321368 1.2455175004166514352 -0.89931902517933903773 0.53016073393838647476 -1.0571038484018262515 0.26118333562820589266 -0.15282387675593553378 0.20242590886596537048 0.056085212230981132397;2.0668266295326387372 -0.44995893247905405232 -0.18268097783413608792 0.70020839804289392028 -0.34053093065431172537 -0.31629288388536225263 -0.20796041138691201411 0.17126084709908370729 -0.38508556021225198718 0.30286209870815977707 -0.36403766735511361441 0.52466916685367104289 -0.016436587957055447812 -0.20716395371233775613 -0.49749485759585243549 -0.463174776384352338 -0.87523584810805321599 -0.19024296328764994657 -0.2723154992499209337 0.33025860558305081272 -0.36101732680243081575 -0.49574958166980254148 1.3282473859540930849 0.2915141584552043974 -2.4093991236682508195 0.81920146207626931556 0.7795452466411990633 -0.45224217277415212912 -0.085524346806390025288 -0.35834608024863562337;0.98655515879367405851 0.14388193161267320841 0.024737277769724508314 -0.52380218309969206469 0.010592277135075191252 -0.034532913770592359171 -0.18124604095686513983 0.56593729547340543284 -0.19827235573180201911 0.29704615723107663516 -0.071305345890685892241 -0.34410659118136860402 0.027864614929906331847 0.25481414484933706532 0.23437960044187097775 -0.1790420194920452901 0.58179213044207589434 0.27398531628267863702 0.37551809932756197163 -0.28413328195250958652 0.14771345903426680302 -0.17402921232785484307 -2.4084894923798536581 -0.16313832162177319129 2.489898771434280178 -1.1562572006688163206 -0.64788961552669821486 -0.36305403153773058156 -0.057126566325641933708 0.32704973842137669005;0.67157592989776471182 2.3729506327822598166 -3.5970924244440585227 -1.9032453681552279345 -0.19417271761776944139 0.29304793075486529341 1.9569467263647168931 -1.8195899261126133872 1.3678751677064591163 -0.24432997331695227583 2.8050656946207337405 0.43108503792562025136 0.43718131990629999217 -0.40113089482848607314 -0.052335851030720872967 0.71198044080510891618 3.5737205878447029228 -0.33904429989810563884 -0.50966045325563791302 -0.44532139808474247022 -1.2051129938431566213 -1.3259635037319528195 4.983892502996073226 -0.011541324267595026373 -7.6969383681401009056 2.9265679051170079283 -5.6490230975662116819 3.5908599164662362568 0.3712403763014422986 0.12324291578368701261;1.4983134415358649871 -1.3264768888815183789 -0.34745478807354218675 -0.53347948086984353644 -0.89176371992191083571 -0.24312074326056729023 -0.91151028720142890371 1.4742428276446442048 -0.83500628565696022321 1.0624876048283102836 -1.5368778521416823768 -0.14313810914282676379 -0.022822645469656122064 0.27576099475468185407 0.20460767966834950138 -1.2218610214524414648 -0.32441852027825657245 0.23690193074135659779 0.58341475972027623254 -0.46198664787585791425 -0.32690128432911635947 -0.61818008187128470343 -2.4615286840809704749 -0.1790627569685285525 1.3205673430354247788 1.1781396298620947505 -1.2684043055561535773 -0.42870595610979733703 -0.26260222343283384783 -0.97759693563489602486;-6.240716860293716195 -0.012387819035676931462 0.90419273416052614589 0.67927063287429856331 -0.011117008727695732936 -0.32161588323960882407 0.1755456842972899778 -0.19340060284525437129 -0.61722111131644408211 -0.084324616080043129918 -0.13963748010613891148 0.020499348367886704309 -0.48318947022309649553 -0.28416781393148393686 0.18743454359025163436 -0.096796995367333188431 0.49563935599007580279 0.44502639352172979059 0.15457623864024908067 -0.10484119555900325849 0.50107408500107286642 -0.58913776879470858283 -1.1213904589935106415 0.78160952122963034405 1.0735628794967333466 0.76179600416939263763 -0.23628320244430484065 -0.86200581545612708911 0.56825030651505026302 0.47387391749841228927;3.644367595510433766 -0.3483220344077344599 -2.7246926330117613446 1.3797404785139191219 -4.3637019177813050064 0.95602327047463675491 -0.55142875137789648665 5.0317288725230948643 -2.1937068874103684557 0.32111886578825593608 -1.640786098082691824 0.29993317591991142113 1.5708535313564466751 -2.3974578722185304613 -0.47602654313597947411 -4.8426798451534054379 -1.5449106560588377057 -1.9647567326138803967 -2.3117936070689704131 0.63718646518782484645 2.7009967073973606411 -1.3605404667218330417 1.5520328834018513042 2.0932989072501895222 4.5756928067225972612 1.5352105695976658861 -1.4708673472330817678 3.3036530579945742048 2.8404529117209778022 2.6558360525285080733;1.0043652687917987709 -0.19685951863408376883 -0.67459934683146827172 1.1719681993499400097 -1.2832911546662502111 0.64259854339297783898 0.17890767668368423582 1.6227664001898332025 -1.7812764804586191936 3.9430126742323405864 -2.2925543940241248642 0.082151739300692569468 -0.11202791658913718864 0.62437757953977413017 0.29736367693347631747 -0.56761696156314844774 -1.1882965771015365775 -0.27661366713479262902 -0.4823219872270833597 -0.54524916385134780672 0.28464134057112794318 1.0555673937896321579 0.42799442657187025674 0.21672178695847135743 -2.7385410936051690634 -2.6049284728941870526 -4.5451962432789656532 0.63752986155809998614 0.22839259256981436774 0.11576892009172629061];

% Layer 3
b3 = 2.2337789760715516252;
LW3_2 = [1.9059244975686195911 -0.6591034311932129075 -0.74141716391401313313 0.5879304570311201239 0.98649786899360858428 -0.075406198284911379881 -0.4051168443162558308 -4.3965130231701730068 -0.64162963631488190153 -0.21571827161594894773];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
