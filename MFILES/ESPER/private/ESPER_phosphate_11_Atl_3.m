function [Y,Xf,Af] = ESPER_phosphate_11_Atl_3(X,~,~)
%ESPER_PHOSPHATE_11_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_11_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.5339960854020837644;-1.1142603106282031877;5.6109049086185187605;4.2574838312849356825;-2.0200537725914786691;-3.2561291025296932311;2.9357710600201385454;-0.048408238872137882014;2.1648375730759372715;-4.4299707874487017634;2.7630119507434578452;1.0033951949498320921;-1.2269284729020937252;4.6397391670915739681;2.6281512847135077848;-0.20470131801364593871;-0.91880937312923127713;-1.4972369300760974831;-3.7812615904632678188;1.7441461949577723445;-0.56539532612644149978;0.78731898978832293157;-0.37646513991276009392;7.012948270265179751;1.6532415340818695793];
IW1_1 = [-1.6264458878432939137 -0.57372546623172682168 -1.0365631308095668572 0.036102802701952076136 0.7723449320010228325 0.58933164321167064159 3.6005617401124401233;1.7536625773941874051 0.58639649401341886747 0.24096286042115369619 0.13783265495244573229 -1.9574731878849189748 1.1507514985472711011 -0.50371690796418344682;-0.25691966712157393582 -0.30395540626113481952 -2.8918717156739845997 0.80999708591715346984 -3.7169531268909064003 0.023177696412606470927 -0.04519989894409032205;-0.16138710606661776925 -0.24993987754959615111 0.64735257356793551864 -0.29621133327579907135 -7.1222816053912794132 -0.3266573086833420847 -0.73938061688619471923;0.82849226079359505892 0.25381471847995029645 -2.36191415002129812 0.32182237851398842743 1.308182795324436487 0.58793391821336082881 0.78407098309311273887;1.1278417156967972534 -0.15863349312656616075 -0.61329655751572387246 -0.42908731284486900659 0.54850066084201520855 1.5869253719610474374 -1.6355419459699738205;-1.1951220137522600151 -0.62692732276247686851 0.72317253089308342062 -0.25091142225227502927 -1.0052430918167110097 1.3442195657899171923 0.57627980701619319071;0.47902194146049215107 -0.011354818642994174427 -1.2747738186352577383 0.8782362642676785347 0.32091781737708391375 1.9920439772679032764 0.18948790742519061592;0.56053045043662241831 -1.0537510868882848936 -1.7583388886404740514 0.063532135695842151257 -0.2456618653966101129 0.51418282799017700491 -0.60701950332201426441;-0.065835809910721437843 0.0030350832768446991267 2.3580056617089404369 0.068169037820575692499 4.3162973469565830698 -0.48345494947200540192 -0.29125596785863538951;0.61509507951925757041 -0.80591385584167585243 0.86507569831752362255 0.35540915853451321427 -3.5120852656773058342 0.37609553621914310062 1.0594012805313426373;2.2203871996976385361 0.24473727157725777559 -0.43435881643197987723 0.20545911089457488674 -4.1452224033182618612 -0.50233941491290046155 0.0049103711854626393499;-0.38360597723077966004 -1.19578353572065188 1.0712856428588448665 -0.43713278790223641934 0.92036980253279054853 0.2335381925816672477 -0.59355842449124018856;-0.017213198371574645051 0.25942559273337661985 0.93602515335613933889 4.999937668386722045 5.2081937472914230369 5.3541539751305320394 2.2678365274992868805;-0.27563181560683153171 -0.47417702767323777202 0.28215955108592849498 -0.65394450220502042814 -7.8200792894260056087 -0.78788848081649809352 -2.3262097952047904315;-1.5947925589303761917 -0.68381881851750692114 3.0559496731533113412 -0.72117969380634583398 -2.3272155345482374855 0.76859561858265834644 0.41254566091617789203;-0.37725540754286640555 -2.1987782733438323568 -3.174699778704153541 0.60209154871807102349 4.0546397628831014615 0.67528990803904698215 1.5196115845646633868;0.036406625644443031675 -1.9576716661897861638 -0.13878190777898702368 -0.031191468025026744537 1.0763978106114684419 -0.51091209655446578886 1.0328502368617116236;0.55024182019070722038 0.89206725025359268066 3.4087620071215036788 -0.9203998401399576812 -0.62884253131802114734 0.7236381097947182095 -1.3244675449392839806;-0.12017089694268023869 -0.33118400835721961695 -0.13036024031124293643 -0.37466696197185656025 -3.5063739633494357406 0.98174424323809272863 0.17380802303226605687;-1.0120784691992252835 -1.7502607777410466028 1.3362660985073946396 0.89211314373768491048 -3.1184465528730762607 1.1365603691602721437 -0.35119591583213438657;1.0013676317018116446 -0.30755715671869765515 -1.8851946511789008376 0.31783557334975542918 4.2120439692678051102 1.5767851538940063083 0.61618941674527860641;-1.0293913151693139252 0.95259682867683048713 0.53467004704793708036 0.46992469308353745916 0.6880413729741946538 -3.6333284293785284014 2.0821110812004777202;0.23027301519620793635 0.20113053156630478213 -3.4320472077636199337 0.65775236585738616757 -5.9764476499981453728 0.20195480685750388794 0.47864510823208039625;0.51021956909679933023 -0.094104980917535496765 0.83613328234334616251 -0.90712354910029757704 0.83551711223877589418 -0.508236256184145474 -0.95000032364893216563];

% Layer 2
b2 = [1.6904119761829747848;2.1667470046360115532;1.0491362552683249909;1.1116404476347745423;1.1277833227512696901;0.8846344969584756246;1.3555940417317606794;1.0046579692050279231;-0.88864581543941045805;-1.6579248290649977182;-0.7284792807179123475;1.943952069472329347;-1.3438613557805780818;2.0567765301557119351;1.5707168772865223172];
LW2_1 = [-0.52034432001182162608 0.74153003521677696153 0.92504143397518745484 0.17832741398144683065 1.108023280782522324 -0.30635615720512326954 -1.7960340559269214467 -0.50296124767148164825 0.53727399045740709127 -0.19595001967124275888 0.92483501541539925306 -0.32743795413268106387 0.50912261279139148229 0.55287559443489253663 -0.098006164623148095405 0.55554637012158780696 0.65653476622834938681 -0.31002653769782362314 1.1180308284010755937 -0.052113436496652135177 -0.31107530905718450143 -0.2770793543559015859 0.48910109737409790398 0.19877448873942016316 0.24529807960050417637;0.41668723291986264901 0.9351444614719195414 0.22766757454263106264 -3.9977912988472006361 0.70231496479973265501 -0.20837618876845181992 -0.10732739887062334172 -0.63222840749435327279 -3.1147457273541885314 0.75379587116827295734 1.3293712621072613089 2.2905006592077521432 2.4791522447620337744 0.46639206733273608219 2.2666061602371669892 -0.21287640917630620829 1.1710020948310275735 1.0895002202487971132 -0.11337575733512650356 -0.039049618077709333241 -1.2783724647796339546 -0.14822626776806738236 1.0478325737530536088 0.5144637458456718937 0.80699579361490669793;-0.16485248549938880114 -0.52400263074931152651 -0.9573746979425901138 -0.038776885138388776653 0.10906571291298725046 -2.1020884670879831368 -0.05466321644470903407 1.6037134646400119653 -0.37019740725416638849 -2.813190413112646393 0.25517023870855698453 0.94724240943138304782 0.87760879511072542591 0.3424947602847124295 -0.83078485925045997273 0.15485795608602931361 0.13659256359491905863 -1.1575004970011122385 -0.60297468013793598107 -1.0822420419941338743 0.057174473592255900534 0.59195119744282631569 0.85042148369293568688 -1.5704310850569853653 -0.15566806034702335149;0.31337965706226972307 0.23675095461964781873 0.33763113987506160329 0.020333296502372324999 -0.33759669271048392547 0.18421882450427276567 -0.098084830513692128351 0.11583565256182282166 -0.22490181031197811756 0.13265922434893204218 0.13408890217067767625 -0.11146995128228821825 -0.098530100355152583358 -0.15228486419047876366 0.028656222530219321865 -0.12409584661594623423 -0.2762848884957432305 -0.022604724213598534344 0.27988822155111930945 -0.14301642300003028496 0.42129879160942268479 0.49513252369005605891 0.085430430798252063318 -0.14218839382881243161 0.15725222027660942792;-0.056984700289913252369 -1.1890503533871707997 -1.0101118470776595526 -2.1026253193852162404 -1.0120576361524267206 -0.011222842619454276303 -0.75310678463611946398 -0.51382686343182093491 -0.93373634031308339054 0.85666060310354030793 -1.0083399246087261236 1.3289428993936249768 0.49305230126080595854 -0.49975722824000667899 -0.47636083753501534677 0.58982462628157661388 -0.37953389200854847907 1.4634385324147227703 -1.2526235171729007689 0.75107984494872714887 -1.3432856689587087118 -1.3991576952013839996 -2.1702885403738481074 0.81005382506464329584 -0.31915276353858512692;1.0202428230105162754 0.78730486891493423052 -0.9074402951928250971 0.36694912062466383817 0.14416400037807464152 1.2927824586961427222 -0.22485647572787981208 0.29188329811847851802 -2.8803636591795713784 1.1103611786171143638 -0.88293965012556496763 0.85602247030081790591 1.2740256189701668621 -0.52735158965800976727 1.1010969747679446584 -1.0889606143111751901 -1.1795073599957470734 -0.87640960832994196927 -0.58951706037816653527 0.7018363081349597854 0.58007939922252360621 0.73356472193302513229 -0.87813599997450064727 0.86301159007012939739 0.15843351038694264421;1.3650796121488224522 0.12554845288177129969 1.0781408462841022278 -1.2182635606615679347 -1.1952073760291224147 0.38677079995250862599 0.026434958625772012053 -1.066716654659908281 0.47476830393225116778 0.34478992424042920195 0.50779976258948156254 0.21396020061261231127 -0.337260569684585787 -0.066298162038391922346 -0.1266797927820305647 0.67477200068738107941 -0.41585152035270245285 0.31589651114344868832 1.73668842900296716 -0.36231181497512376932 -0.689517676258729173 -1.4357094907585636889 -0.49651379498686970537 0.64399062595412492893 -0.35230094152333812918;-1.4451352861880941703 0.11495851217205521611 -0.34088050391524737925 -0.16835736634184716998 1.5564423012403028057 -0.82347796912362503097 -0.18155805196907309762 -1.3401240547488384447 -1.6461113922543102461 -3.1851615344797612472 -0.74351591135937689092 -0.9593903445949968356 -0.401686712866374529 -0.84094874262444330171 -0.38761251516079092694 0.075127845536651804981 0.69874311812896894303 -0.2969652904150009709 -1.414798238569739075 0.69268195296640033831 -0.028397322261508099045 -0.70027443697328073391 -0.11498301311372652322 -2.3174683937503370856 1.1582487066762752193;-0.20562896249410539395 -0.13437323369310311127 -0.047164972648660631604 0.55860540518631884854 0.9260309078280885009 -0.2361242672380959029 -0.4099636218744436289 0.34783841238260848616 0.63499227516446832276 -0.76076626165695104831 -0.54330483915950122942 0.096660069097010706263 0.48481455260047762179 0.54779879528506780773 -0.19905444235775265893 0.12873350048630657905 0.52729807887313662196 -0.13191725580288249375 0.54981669394468069001 0.68859704332774684943 -0.52450479478653222465 -0.061056492721547624136 0.39984860188098492184 -0.38349533464371798885 -0.21952150910283180218;1.6893277291175994304 0.1656945209360327631 -1.9018122611971322033 -0.074523306306331929538 0.2211793867159207172 -0.37348447150765806679 -0.47032175215940696944 0.74474475634364389887 -0.31507567086739801665 -0.60065955589230457523 0.07683055896186812006 0.094838896849196482886 -0.34797214724796032836 -0.29260294045421109121 -0.23337655598562917492 -0.15857981861668418722 -1.0781055654475164562 0.27056373721938514754 -2.1982430993572705802 0.42478185829551362573 -0.58462491016998086035 -0.64270808362713105488 -0.44649500838164218885 -0.47677940303430144109 -0.61776890207598567084;-0.64367440359225436275 -0.097543925371038550654 1.2870735290059169831 0.68221799909824598629 1.062421130931972435 -0.28945859690129577269 -0.44691237004668754595 0.79450984758529019647 -0.31609068181471522418 -0.45951331247903709487 -0.49932527782791280568 -0.022202366020419767728 0.44354136461383697476 0.35445589263514359901 0.059107654138540383082 0.03331435170040287358 0.9025429044051513916 -0.13370989128458907191 0.7037372650628703763 0.51919363248858085846 -0.30004362962385033864 0.34718368138257971189 0.35147691288639437701 -1.1570920169851803827 -0.00061979463698230014002;-2.8038948288358502836 -2.4050581429388686594 1.3816464283563820725 2.2331735867404240992 1.5703653641756922799 2.858017472587470742 0.18460082091276386329 -2.6308577051526387258 0.65130422225038508977 -1.4651416185253325342 -4.3119836753099312077 -0.74189476331460735281 -0.077525175553974340348 -1.0609770591070728507 0.4633244948606676239 0.77715868380452779451 1.0300951230042780793 0.27602485630548256879 0.84584566510943426376 0.63435090765431467741 2.2602249778236913613 0.37844691488805354274 2.7573649298436810895 -1.638367606190189063 0.76657190615366477271;0.089011167212444730623 0.4888079106822412756 -0.20149503098277860014 -0.12246843434552577567 1.1555909347814579125 -0.81655248703532856691 -1.4489391007521492671 -0.17440263068085173903 0.656114786490834212 0.12289884746771653767 0.93636730733498640955 -0.42439549261316028561 0.46426200154454555502 0.084582067431508117794 -0.55819515235800698516 0.74044831593450632923 -0.1884012541828485876 -0.59855721704600928224 0.18243418283490028808 -0.15947710521428568042 -1.0996547806983858475 1.290185734441782861 -0.22759902448667646002 0.22659160545368908779 -0.64835495282327570976;0.91347754960357496756 1.2309501413689052374 0.14494626637655932955 -0.10098885447993946607 0.89499128783390258235 0.54464527407916585311 0.63122192682447864076 -0.40708813499740154063 -0.7209210747311277645 -0.090401518510711278975 0.030901660459335865416 -0.7407890554113375492 1.113338557630143999 2.2956404131289502857 -0.79267138161731243162 0.072216693242647234108 0.15978594948067734172 -0.39448609225206543449 0.26687902853906780853 -1.3992014140837105707 -0.5911701393505528479 -0.85114843590590694156 -1.3066560444496371218 -0.09685050363744439339 0.80329375922544976607;1.1239015208543343682 0.603500950767876021 0.89196758702628697879 1.445211123466245029 0.8731789564130648662 -0.59600778306893587022 1.717478776019758957 0.94295704708175620556 -2.2597530060186610257 -0.56966429977824128983 -0.36159226660193743985 1.0741402429291790899 1.3681962769582594053 -0.10187123145890246423 -0.29166536079910293511 1.2466116742845940735 -0.81289677534315840646 0.32621908949438216396 1.2928483911447918864 -0.081716146344288143055 -1.9438921845362480134 -0.19441537750748505431 0.4373530043562528502 0.15392605294292349694 -0.64384263996288193521];

% Layer 3
b3 = -3.1119564906517340752;
LW3_2 = [0.603305665147407022 0.23917709007058182702 0.62325000195096558198 5.1322844879354576619 0.3820196517144530679 -0.37226405181573540837 -2.738356657999743593 0.19923527310036770466 2.7888133269850450269 2.0018917390612633866 -4.4361066876359078748 -0.10955432721569412224 -0.53356444394251156815 0.36577392206757575188 0.32358131653217359069];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
