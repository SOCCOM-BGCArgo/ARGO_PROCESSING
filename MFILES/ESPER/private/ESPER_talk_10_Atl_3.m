function [Y,Xf,Af] = ESPER_talk_10_Atl_3(X,~,~)
%ESPER_TALK_10_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:48.
% 
% [Y] = ESPER_talk_10_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.9109249564169883;-2.8015880663815316;2.5222317910597956;-1.7154754380564172;1.1405481174521106;1.9720300464214;1.5864135411845492;-0.74922875562158198;1.7382408164565699;-0.43246708250819815;0.64142535390201405;1.4392846970262332;1.0216721132238029;0.22785420040660798;0.55419013351527235;0.41314380181452348;-1.1507234201951155;1.3370861639369565;-1.7056325297998371;0.96210209083359544;0.60917538930542958;-1.0348284587260312;-1.6218964816640984;-0.96957869149261566;2.3757449088139526];
IW1_1 = [-1.7197849150626647 1.602009704465748 -4.2551049628962643 -0.041074007605122226 -1.2583655043153037 -0.4234137725330781 -1.3839134008209197;1.5411371677234642 0.93983171156598011 2.3788108167437914 -0.070608541555036514 0.16696281985921493 0.94033613395769744 0.39448335404409213;-0.62803550172036482 -0.76542340182571333 -0.69127819026569759 -0.84955707605379049 1.1134815470634323 -0.028946986234148167 -0.32342364562674408;0.0054154202644165917 1.8303934586712185 -0.77373892579496539 -0.77264069473314423 -1.3679441649869979 -0.23944984631267882 -0.15599181827134584;1.1287490872285126 -0.88582747102963 0.4748038353491188 0.019131486367315344 -3.1244367020089738 -0.13963629662344582 -0.17946836358919568;0.75018633781826527 0.69375795477164992 -0.28417587684242279 -0.14786043201207352 -3.0188765827361164 -0.19889429079671547 -0.16582380411962191;0.38936719333252701 1.4136714850901457 1.4918092767464277 0.044240111722854261 0.14048921616910207 -0.098352370257855287 -0.052281360901100804;0.40155999997606778 -1.6088994524797733 0.9135712697127264 0.048043752122219757 0.52675326229126374 0.38515383809404202 -0.40856647264917423;-1.1616154479640899 -0.96870682029538102 -2.6930327571041812 0.04715914066146059 -0.12624457239221659 -0.03246824739879503 -0.75848713171978543;2.1243308874579561 -0.23781494244797308 1.1586907994967806 -0.65672991072106679 -1.4296522179522073 -0.38886777330362327 -0.74285744132213161;-1.3067254548041298 0.35686047596791154 -1.4414450080378223 -0.049220552915099906 -0.60003498637194153 -0.22476403224825284 0.30616382898779076;-1.9021635363221119 -2.6232850132048622 -1.7663365952502093 0.21787609542440758 1.172288643930637 0.13424181722969755 -0.46772659005386191;-0.81670405471435348 -1.8996047257773976 -0.7376069484350124 -0.12701306271875934 -2.3813089676963144 -0.29935145563615267 0.053126661652264283;-1.6533524468168022 0.33693060559117533 -2.19006807699009 -0.054717648456903946 -0.28754109277138251 -0.17264056632286945 0.15357640289432992;-0.57614697296342809 0.0065753192815178703 -2.2159069118553463 -0.093844420444104848 -2.0687066332652222 -1.1496672515743396 0.99573854923409544;0.063462485277231973 -0.57960940064683053 -0.78141819649483235 -0.13702308107024802 -1.766042822514815 -0.54567459240778537 0.47297172010338834;0.43647475114451234 -0.62140723978129508 1.1202555886893082 0.065146794574588496 -1.1346954828043569 -0.45368965734708294 0.22896958779853799;0.85092374152494765 -0.032103800474577754 -0.10933784330288991 -0.2104917762014141 -0.77975284806772338 0.70318559228582089 0.44047636998056772;-1.798733372883272 1.0803243894490224 2.208256358391921 0.19125821581529862 -1.4307276522995203 0.076528944265159105 1.2625792215612806;-0.72067501939821932 -0.98587023771789428 1.5006514788206544 -0.32603195784017708 1.3315431875723738 1.0709795478326865 0.54684656634943318;-0.47894182637832156 -0.67497354554217315 -2.5561752028913851 0.034845783533165468 -0.10836838602989157 0.20126178669945305 -0.62147919591502376;-2.1101471125296873 1.4507573920329719 -2.2348158567233893 -0.36082422035760869 0.076270856299710199 0.10216903320970515 0.16399272209756585;-1.5276083293614924 -1.1112133926614109 -1.7718390807210256 -0.087872362222649408 1.1074720467178159 -0.45495350052196809 0.96470941027432455;-1.1388294131228054 0.22010263403367777 -1.5180655861739125 0.58069854688089417 -2.9281987075829599 0.5564750560052375 -0.53020506962358083;2.1912433065673271 -1.3972321866521418 0.8718502817897269 -0.73824029751873455 1.9023450166918479 0.2454054466769186 2.4854175203552238];

% Layer 2
b2 = [1.5508020496753598;-0.83266459647197111;1.3167559088115302;0.53232268226685775;-0.87696564462173543;-0.058528485065562873;-0.78786741776160318;0.061489338852922328;-0.13757988145934497;-0.05589712899274725;-0.70940646794143114;0.34534877615418691;-1.2977043984141383;1.2192246960349982;0.010471414334374318];
LW2_1 = [0.54438506862295599 -0.75170620470375693 0.59210400773031624 0.49184349854412074 -1.073563818992239 0.34039406057667893 -0.42877875330384446 0.054916203620566276 -0.083175228347281707 0.75527253904543123 -0.51228633103327592 0.32745750160198173 0.91618394007762982 0.17020641307510892 0.65302113311108312 0.52379975739300755 -0.94485120465550887 -0.1043971707611413 -0.2410258518514983 -0.030941990584823817 -0.96883063054679908 -0.15498793592626992 0.61757447232597518 0.59299768037629808 0.57141087836194937;-0.081986322157245647 -0.074315060685725853 0.034384815029236696 -0.40234380151186189 0.48205989519401793 0.12402763431599778 -0.038662943338304404 -0.53977812591096741 0.47906653245051795 0.19523617584231062 0.99102040540747571 1.2731131004362597 -0.16615789251005153 -1.072172534034936 -1.989899027639392 1.0967878195217375 0.44951511748864881 0.69486687816181858 -0.58008554754179797 -1.4522941241065295 -0.4579431417823302 0.73101014209008874 1.4840465444667637 -0.23342491874367721 0.12439017338886561;0.095373888629280507 0.91117440141129813 -0.6160496293428992 0.99312942483119526 -0.51619552640523292 -0.028646725902933285 0.32841566885625006 0.65652224997481756 -1.0406738516016198 -0.024075833110545654 0.4676176951094328 -0.046705317777937204 -0.054161700908539556 0.80927474201859217 1.8025282442399437 -1.1340985706534539 2.35694928044478 -0.17281432569836494 -0.85215215214209883 1.5616545097913099 0.8518820700575499 -1.3531582739644337 -1.3098756838384487 -0.37073358575854515 -0.010964295328147626;-1.3786566011755519 0.11403338118032573 -0.062137471884610829 -0.82762826949820667 -0.46673408197912952 -0.29066308815233716 -0.78406911063585449 -1.555680552013309 2.1270548027011511 0.17209809697831815 -1.65174515119785 -0.70243242241163417 0.26576498807856991 0.73330888310737274 -0.043790542276575251 -0.48291759453076427 0.21771711335251503 -0.63213511802815792 1.0489109713302058 0.38109464886936162 0.20745080855136186 -0.5505105118170871 -0.13024472187534633 -1.0940943764009723 1.0765610252187958;0.40540383183447909 -0.82890082779068408 -0.8564802807968519 0.096748376519923587 1.0838419199723235 -0.59360292580749086 0.17050338353891187 0.18836735231962765 -0.66290664164188451 0.17879087065238572 0.66006505564633533 -1.4931953859581866 0.3195401013516313 0.25180358842274014 -0.51763939056153951 -0.67961738771891567 -1.4304847411636088 -0.27487886323636218 -1.8281662416777398 -0.9753815370817126 0.068306877894368886 -0.57612496350333331 0.44278740442684861 -0.12279336031927322 -0.31032783943273079;1.9137359590829657 -0.34532219056945684 0.21509774781171437 0.75358157701556772 1.6256386751258858 -2.6094708078606081 0.8092491263411199 -0.10991261987960124 -0.27975847415194693 0.49092228999842724 0.95589817927967102 -1.6502549186024646 -1.4775694329133446 1.3155947583355594 0.47206059090240343 1.2422071537219603 0.13267714698915237 1.7403432866605619 0.10975097729499078 1.0367590833341431 0.56374720069811535 -0.15135526654930578 -0.66824062770803017 2.0141464659357857 0.56059635820283182;0.44071286738441701 -0.45137102351902675 -0.51721536239988519 1.9342158213771119 -0.10325458533922403 -1.832634806999482 0.3386403923790447 -0.14109454024388851 -0.26816730298156843 -0.3795732359864446 0.88455057392587089 1.5934269935140215 -0.079169047294655542 0.16509585861106446 0.16549967429156467 -0.67708263086184006 0.330904673874377 -0.58060546753536446 -0.3280342931634026 1.1072522108130465 1.1752386121868208 1.1045413947442462 -0.53263638057735918 -0.0067094968490152198 0.6940711527074428;-0.72279850745279794 0.58768691460549005 -0.51889108672822815 0.92677217348452656 0.93081161948137492 -1.0025240157738675 0.6836095918553633 -0.6085867801271061 0.84132486563418185 0.24982010868349699 0.29749565667726158 1.3115620878310306 1.3012332532715052 -0.067454028734406479 -0.90448695090701636 -1.2626580386014805 1.5438608965878857 1.586613930531708 0.025361146684503792 -0.54760632896341666 0.53391025383377 -0.67482177397198129 0.28854230376878182 -0.032616935900620474 -0.11736631075010534;-0.27450276499209797 0.12682021955239051 -0.025156303721770308 0.075971913893268683 -0.1312488601469512 0.18180657393903371 -0.32421187264614276 0.54519136098998489 0.043835135553250713 0.08551304397198467 0.2256323131543341 -1.1685806520795179 0.46283136801896829 -0.51776228277520076 -0.5866595950361102 0.21849676959139547 -0.22839275099461373 -0.1507782508119202 -0.58614652559819058 0.65170344461702612 -1.5180321005081951 0.81998002680882986 -0.3111365696124998 -0.18580779877421741 -0.31056859626808309;-0.32520656504794421 0.53914848234882862 -0.42264821594920476 0.40638165885388317 -0.40453500608144111 1.2067946399100271 0.13880991818424365 -0.41635993147880507 0.4302849250140135 -0.34873984503698241 -0.8188564399553786 0.1420180673409831 0.39060233951623091 -0.33274746466432448 -0.18522804674030047 -1.4406739283582333 -2.0307173194879677 0.45171845027657076 -1.383084064519581 -0.5057179274324064 -1.2314739068230292 0.32484037796175719 1.3481214240159916 0.84002183941073738 -0.04170691610493979;0.27912216581276511 -1.1702585474757243 0.10185069645725658 -1.1736911154323237 0.29182464673631009 1.8838873997140748 -0.55628352873484965 0.51093769396516386 -0.39136886478140648 -0.55787388121946468 -0.24162111105997433 -0.0014551494281648167 0.28674614328306108 -0.51191382636949789 -0.14591197931249533 -0.1704421232239631 -0.26839055404639989 0.087073219099981419 -0.14814407609421715 -0.9519394675094448 0.19101922520767167 0.86989680314382534 -0.18754106879036422 0.48240483759000036 -0.053410054018593195;0.19258639610344788 -0.85497239553281179 -0.096168946190008764 -0.16599813820327949 -0.86349968927853948 1.2919155295952649 0.094818444797575202 0.90070188935326001 0.14987865561184885 0.29568270688694315 -0.60458880778852309 0.054753589960595248 -1.1594526513574879 0.1467717148026858 0.98401246626559724 0.65470499479865762 1.6946140488092862 0.78658842771469406 0.44409728911112911 0.37433012974306568 1.4096189895312998 -1.4441934309599023 0.23633060659415953 0.43560032109401592 0.94462275463478185;-0.48414684637542854 0.015443975158367857 0.10160628156862837 -0.13645928214363154 0.24450696311538517 -0.15885374923894649 -0.44618595546483208 -0.77518296194154757 -1.4886063568153636 1.042510618502146 -0.38837673468695255 0.12211397696924939 -0.072332337716625728 -0.41655737661285097 0.18419148901066851 -0.18059777184747564 0.10292897101940257 -0.65881794409284034 0.013421124589878555 -0.51489657853696802 -0.16995281814344607 0.062838812532593685 0.45915747514746119 0.19537228437749682 0.58469692029264331;0.19987306250921277 0.013177912164390787 0.12022881037622363 0.098029213199645276 0.029199856759069834 -0.24768181654414917 0.038552411461184488 0.72007455100891182 -1.0331484025801549 0.091058710231378071 0.39582369656274169 -0.30924454572454546 0.23483634042182558 0.22777083561999764 -0.44283968198302376 0.40768171248047852 0.69243227859805168 -0.77226109548528976 -0.42014982724192451 -0.56159848562187753 0.73150095926640535 -0.83609195804467185 -0.19419732058723935 0.32237419452727334 -0.22067212155927857;0.14094603547768492 -0.042160842841592057 -1.4474807971068406 0.19073422009557534 1.021732478266979 -0.4908985995027832 1.5670929241319196 1.0834810970645701 -0.65984202309338669 -0.034209036498637845 0.77914046525422243 -1.6670958082636591 -0.13195020984894942 0.828469087817432 -0.52410742263084475 0.66974892563592359 -0.13192436314849429 -0.093039337566086303 -2.0307588910092309 1.2902279728631478 -0.72299077430451075 -0.08731739199727373 -0.14148448140208747 0.99287892299160674 -0.53295560630699901];

% Layer 3
b3 = -1.0737383700561773;
LW3_2 = [0.20464362982847029 -0.45741434243760043 -0.58254999601364021 1.1983261512140337 -0.37478545524061474 0.21850530607519808 -0.04757468189780055 -0.066896858726804925 -0.27346632788324893 0.25317165936519387 -0.12435713483399212 0.26517474725721435 -0.22070626778397925 0.54062247488722592 0.51210896708308351];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
