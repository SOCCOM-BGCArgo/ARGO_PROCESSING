function [Y,Xf,Af] = ESPER_silicate_3_Atl_2(X,~,~)
%ESPER_SILICATE_3_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_3_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.6907559058660410756;-10.495224028182073894;1.6906350375340408743;6.8055521171907820133;-2.2052481597820920989;-4.6991232947996639524;2.9542815707105165579;5.2687570658890097164;2.9308748072308601351;-0.93613914447606605407;-2.3460333928336494225;3.5433329898106045164;0.83571018563322851946;-9.6153029058400907303;-2.7848856251390401439;2.4558584675983508028;1.0301834931731441714;-0.8813577549082839413;0.50608281151177547663;-0.8509974166778775384];
IW1_1 = [1.3261145134400971202 0.90925139004166288803 -0.28642854146614910027 -1.1809067985437453618 1.6736797822533664437 7.8880274598498667515 0.58017872313356755321 1.6314403810721440635;0.12898098410132263769 -0.091589251372886371083 -0.11560988591059463693 0.64555683763484272841 8.0324648699548895081 -5.1302836829863940338 -1.2609329685998909021 -1.6804777347399530996;2.6684192731984586189 -2.9270114416569401605 4.0071038971346011337 -1.1540007812066070958 -0.55844877945688253806 0.32238995172124224053 -2.6597881930539548634 -0.13309056997364671071;1.5237139129616392719 -0.57458075705171107739 4.0679109328388278755 0.030062937470470518092 -2.4230871267315681195 5.2258742881956203874 -0.065076124416041492005 0.092709642349247264881;0.72923770610161309236 -0.24845151326917594425 2.757119973079948938 0.43849805307439743141 3.5861277056091149795 0.80806330673613113724 0.048350354036251728951 0.29892751037421033677;-0.41602795030546174671 1.0456869239870487664 -0.072974837696813385501 -0.31252333566650897234 4.2659401352237766858 -1.5245877252558728276 0.39891875766471723841 0.87316013838031425465;0.073940466445628655334 -0.62484766070005459682 -0.63349572071796589334 -0.30693977455432946977 -3.0095594027694616557 0.60215354233081874735 -1.9429838818266087497 1.4172212073731476067;1.3627478385443758668 -0.5544487467389375146 3.7566955635221592757 0.14362399196008474034 0.4931031750493931054 5.9382773651632199119 0.0052718864459053021987 0.20963184800493414595;-0.070268412600894739062 -1.1271126944023006633 -0.20371650501770766084 0.32616890059618625086 1.377682662475932851 6.2216113426181003376 -1.1546704007679575721 -0.64150077436507635387;0.028291183330122642026 0.42570447161509983314 -0.015291151319858538316 0.28461625681421298673 1.4125456327247150057 -0.11674734044470529148 0.10898920406987702703 0.25874229563652095809;0.22329130661439552941 -0.73502830841556254793 0.13040339614494203535 0.062899554903313725784 3.0150990688277010676 0.031317527255698397737 1.0032997076903282796 -1.9918880695806027159;-0.015245641520053237333 0.027532881920881345506 0.96371678707891061944 0.59743880311113206627 -4.7490544326203538716 0.36299705846410013077 0.32015816951121400802 -0.81886424210189834305;0.16715128008869242771 0.058891623383628799449 -0.0056320825976035864685 -0.18476873911445571008 -0.9596991041884724849 -0.84983308519307376727 -0.28963930085802602754 0.63753168067905363614;-2.9198681576278375793 -0.80127318120849511107 -0.17418119512485397138 -0.48789758642233016506 7.2552004653095876208 -6.8006403648146891427 -0.1201752812060279535 0.15922754813410000541;-0.27800085550701086889 -0.55286106949851943071 0.38386082268798155104 0.21202371923220483807 3.5314418310241770804 -0.27258910878045072845 1.3007385861255789106 -0.30749153853301020023;0.095717742501391353538 -0.49014102579676105398 -1.2495241296852526158 -0.017581727489482695814 -2.1519304383096513611 -0.0053861019843191798931 -2.07251096157537118 1.047597763257101855;0.038080752207230228468 -0.22151441264792634533 -0.038386944345096450648 -0.29330027854262069598 -1.9472106723638331616 0.49664742160687980199 -0.45635821037613083506 0.11343176101835715508;-0.035998331254499506271 -0.10465077124277975817 0.40348551929100107127 -0.2666753130363047064 0.15137411027352237758 -0.59239436271361345376 -0.55609976644333469764 -0.44845055375485265436;0.71636905343970458393 -0.12814920491714010264 0.40025352490680904394 0.37197888516294019823 -3.6670299238263091013 -1.3908957367525969229 -0.62426279511837334812 0.58915233419944557092;-0.070174322063304858665 -0.28612970503538587286 0.21887880165368697738 -0.5486823708716705994 0.65977154541523019837 0.75646249532407616734 -0.82442020146481864717 -0.056926172335077261655];

% Layer 2
b2 = [10.791251576683725588;-3.621096469892406855;9.1910976686154182147;2.6772992525322156787;8.4850250435353586909;8.9449708917606276515;0.15952189217080015027;12.07816082467858898;2.5841195620999175553;8.5719035237611951317;-3.1156009038677940914;2.0843812496138025558;-0.43461521364776523058;-5.9349216892435050497;-1.5715761705733399811;1.4071689816913739435;2.1836560176543886591;0.22905338982035133855;8.3227828215338863771;-13.806290973141720713];
LW2_1 = [0.66267944388408639433 0.034376069668287469183 -10.660821454448710099 -2.9169438309410371524 -3.0097830104436695819 2.9321976718897411196 -0.18606627734683661712 3.0232004269431698162 -0.39378023061341510536 5.2184467073846070306 1.4218894403694712913 2.4521233176372452256 7.7722709214160765612 -0.024184116749444165007 2.6314863505778531838 0.76109956320552718534 -1.5559684399359348106 -3.179859758618506671 -1.0889064517521633846 6.8510681022483383984;3.4154713784121728537 -0.68638901186655476572 4.1851738399450466588 6.4245271562535002374 0.50981779072238098127 -2.8857460458873478437 -10.246652324473627615 -3.1763541965146857571 0.11938553760275663618 4.8113812116362115745 -0.39610165797357616002 -0.94894090367336425551 4.4519238666663074611 0.29377872272926719432 1.7233568034194421958 2.4428375302831253357 14.940598078243958469 -5.2716202469447228651 3.0286893768723648357 4.1456028843320176236;-2.2607231046076896597 1.2043319151449558557 -2.839514823016277667 -6.8516482579606279302 -2.3274509433492007737 2.4035431957462249919 -0.58202699424879367207 8.7569532489710812939 0.87743031845684471559 10.048305048507300441 1.5451376442428348401 0.95506125222018600773 2.3832023942210236456 -0.82402027714414216586 2.3706395768160737347 3.8340308595269987357 -2.1040599478096884134 0.91997501151785465723 2.3534733347962575323 6.7039382510934135695;-0.36378402999693293385 -1.6505551031064242817 2.5402294635921576216 0.03738308594569463017 -6.0154226368909711198 -4.5309350178048299895 12.427443457792563208 -0.30426564507913939073 6.026311772780241327 5.6202967977806679301 -9.0660361290404392065 2.5204284426464433899 -1.6418666543320870055 7.1624578146482331675 5.1285043840997559528 -12.29183450571001579 2.618851388658848478 -4.5698602667665371158 2.1268128436112112567 -0.12775929133050956121;-1.519129592271615703 -1.6697830315935358048 4.2505276997885861334 18.678630390751383317 5.407449420399750295 2.9130365687895607429 5.8036349932124524642 -20.169418208602682085 2.6858848411543831958 -10.193162111647021462 -2.5973390639859430529 -0.5960561864249740438 2.2680720929296964705 -1.4035738535368813551 -7.0727093684279598307 -3.5882815203975821916 7.3529474506563943237 11.675712966974446161 3.4910976544413805378 -2.0975179620737529618;-7.6950909318976581375 2.2413127434462212229 -2.3631984697061971801 0.31065213203556696353 0.81305757241558662685 3.2716964315241336969 1.8591019169825355739 2.3467485032144459467 0.35324637744100922943 -10.552072531300764169 -1.2975222110304232004 -0.39857853372471202524 0.65763716383451575886 -0.32820195308333821593 -2.7687650072286080771 -3.1640184076422572801 -6.0417004359366011101 -0.083574754688141211778 1.6911868034982715514 -2.0098891971336070306;0.67399120256774169846 0.87271953931226486922 1.9289103321476732678 -7.0736171066802482343 -1.981729462312525003 -3.4969040771964969849 2.8150359540426781457 6.1296007956870370847 -0.20436677399332453531 7.7218096824657900257 0.54924031047203214495 0.72468296167042978162 -3.7659567899153576498 0.67590124494095349394 0.11638763286742659364 -4.1514984801228544953 2.684360474723469725 2.7478203753462246972 -2.0105858513293002332 -1.8140589125900272727;2.7265358518940039367 7.6250003395340435475 -1.3074933167467952533 -1.6937093601425685652 -0.40586652007375806361 0.2720858710877041009 2.9336757947159792792 2.0690366338385115519 -0.54616391041532230677 -3.7389628625776816229 -1.4743303658226289965 4.7974045784394778735 -7.0966113254169789215 -1.0434119550594187498 -2.9477047379952137085 -2.7788976452058258282 12.479708445422733831 -5.1159142425001116194 -4.8577645081242790681 0.43008296318355748733;0.77784949154462679211 0.94042529177608336077 -3.7970231540067311826 -9.0069853849583090266 0.54950658478167557774 0.34911523568803110029 4.2750710175179440498 10.179211581438130096 0.48442348107310206906 -1.1813792871524151362 0.29553201361005204673 -2.1326508070459668787 -0.23945858578116269166 1.0097832660592176435 0.096419273636503724512 -2.7284699791392781343 1.0925217384198075976 1.3506996747188217967 -0.35409916117687312287 -3.7294570626798986268;0.62873134513085560116 1.065462144519913279 0.040660697805189272014 -3.3633130215131470386 0.40190983734076074496 -1.1994429118820388869 1.4503194372600938244 3.4104368921024610373 -0.010107091752380304231 9.7540445511691604707 0.05009758687148239964 -0.95490934158593232528 -4.4673681924077808247 -0.10640459810595150059 1.683044665052827904 -1.9826068690616083234 14.642319433765900172 4.9171265907349299695 -1.7233872631011737386 -5.9824751950283303614;-0.37440121826320121867 -0.28030903763568881804 -0.075648119489861734288 -4.5611366311067165213 -0.46519324539907536131 1.0703029850036251958 2.8690995735136692879 4.3710840149690817213 -0.24890319570496385881 -6.3641685339608189409 -0.7001851017995111004 1.9059575205637839801 0.85354697608893459471 0.12704576203086259678 -1.0370386141321950024 -2.7882779708565625931 -6.6428754868246429055 -3.833383876941410584 1.3514468381601929536 1.6978272256483344371;-0.79228970322824598949 -0.22449394270171196819 1.6720731007573328419 5.1483708743265186314 0.24004254772230315673 0.34971880974098862316 -3.4261569044855546551 -8.6131231301759729746 0.21378481193098650137 4.787788115878671924 1.3394447054915674666 -0.24652196635951173498 3.225580395618287799 0.14518910154506578514 2.1340803049398324731 2.1099822005324231355 6.4385455084760154776 -0.071335242975071933014 -1.3874925716391108832 -1.3421949878754027008;0.55795844416243078889 -0.39675517706850188526 -0.25835148435241539477 -5.5083045591405177532 2.3379676242260707397 -3.0561166568350630612 -0.82738682589833789649 3.7695929752734742557 0.3260303004986122577 -6.3682037495629817414 -2.1871300137035221134 -0.52900385158589180445 -4.9987978766281395693 0.71170839055298484865 -2.5271054290875691883 1.0622350261524289294 -3.1020217542523207399 0.47718354528769801881 1.5369874302735790916 -3.2937662490580477126;-1.3916248643253870121 -2.9925672566417693687 -1.2244153389815188859 7.3304334954720573592 -1.384238674333676089 -2.1334670095692431779 -5.4874311288799981767 -7.1249794221195799082 -0.67777368816206640112 -1.0570050453033610349 1.688487976949964775 0.78211681636377616833 3.2908476654161780139 -0.17636410703261767852 -0.25419095303922689677 4.7549308737193527463 -6.905709133914670339 -1.8827675038956166453 2.2332234022429022779 1.9107289406031580103;-4.9750798625780685569 -6.0717572156092023405 -2.3063569925283418094 -13.131647947027547119 1.1997405283615629745 3.1744179817413780142 -1.2144925111738154033 15.553890793767173761 1.9005427684150064671 -6.0312523671508850853 -0.94356032228281550012 -1.3730206400682569701 -6.8206285000011028785 -0.27898412005433270711 -1.5311751376124478341 3.2801454169428385654 -5.8835245531423483456 -0.16342569559315356376 0.44334598525229745869 -6.2491140824141915289;1.171916372757023872 2.2149696683542545728 -0.14325237750291816563 -1.001680630557226781 0.88027184149277071246 2.5967150850519491456 1.7495969233533148479 0.74299573597157742011 1.0607678416705155211 -7.1969634964907296393 -0.79315205229725627145 -1.0468652267764222419 1.0336095731110737095 0.5110206055239886469 -2.4351935639750323936 -3.2879169694589660544 -3.1543282685289515399 0.96856445171626259771 1.5035259713109896396 -1.8280613385549451255;2.0569129151700673575 0.48580585617785509989 -2.6133758154235198212 5.4015789791459294378 -1.0511147558735323138 1.1493119882167717183 2.6413425091862872129 -5.5702529183221507481 -2.6865914642132913137 1.2193885256417167362 0.53031009400467843395 -2.3285697143920156549 -5.1771367254609792496 -1.2247721819948580446 0.032234638000699658567 -1.5686129791434968439 -6.2668605617811659059 -0.92959705419882743271 -2.1172697702705240985 0.20747318611419257595;0.19916079784256243701 0.10461100083828021867 -0.44603303052336434886 -2.1489141750368467854 -1.4534232874051136175 -2.2907976505604845663 0.83946577258520993503 3.3293743499953092346 -0.28726830882683762614 5.5548447786804695525 0.29579634303509605431 1.0466439161992822093 -2.6903840539251677733 -0.2061512164810936909 -0.10964938658540410166 -2.4613654492341958679 2.000784620466771635 0.94131311097909220464 -1.0405683627792801094 -0.7955117365671322549;-3.8696991864639795899 0.096333048918759572876 6.231065844342420057 -0.16309443558296896071 2.7948944205614809633 3.0694448945268555384 -13.322309093024783166 3.9937495479557729716 2.065316249766373069 -6.9416475954589440533 -3.150127240235907955 -6.6272216134609553961 -10.19061351506070956 -3.7529677196488928637 3.2658556125080995258 8.229765411443928258 3.1652778363205276158 0.50209717903512618431 1.5310636616315922431 7.6782981280552027314;-0.85853293002728359173 3.1406795065273134249 0.68529389090174808175 -12.478056767398431504 -3.8604664861644031326 -2.2170008753406125201 -3.5997049750794709588 13.329737215957983665 -0.8940650486187393664 4.6165281219789608969 -3.6834302195512345079 6.2314215122718774609 11.35876619263062004 0.0834414136935406614 1.7178324292418138963 7.1235998167108816048 -14.501512373210164952 -7.4301842491046263817 -12.261532053693779076 20.276422833106536814];

% Layer 3
b3 = 0.16401228557477709469;
LW3_2 = [0.056750920489358439025 0.035400856316107051636 0.019902085599690040596 0.0099274759492045377279 0.0079193192413973493432 0.11938056862798653024 -0.064144016101896392246 -0.05545505075133373013 0.040833085119214185266 -0.81653871893943563709 0.2804328264645257196 0.078380758618189147469 0.099995440635778171101 -0.037955034158214877305 -0.033958368355034275476 -0.11859160369758499354 0.021138974665111696233 0.085177306979759920269 -0.0075785956937239780384 0.016616355072933519654];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
