function [Y,Xf,Af] = ESPER_DIC_15_Other_4(X,~,~)
%ESPER_DIC_15_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:15.
% 
% [Y] = ESPER_DIC_15_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-10.918378288523280517;3.1654953039634796674;-5.4484301712745661916;-3.6119117603562074237;-3.267692584640046416;7.8542990162681194377;0.27198410989724397524;2.870197024698324384;0.4764545279243952991;0.41012000069657367218;-3.1728395462404792582;0.011915106650933983759;-1.2244684060689157157;-1.0077340464026971478;-0.20565821370825757008;1.1942058174894385481;0.013957770257244818748;-0.28475132959507160058;1.7953784281375932963;-0.10118799929356950273;1.8289199859441052087;-1.6986316898500519734;-2.7529324591601893601;-4.5891254315404550468;-2.005605329079966026;3.6455968222413748236;1.7440332317158602216;-0.9582665740309309621;0.64104843052428173156;-1.9186956435929880538];
IW1_1 = [2.8767736973508992726 0.46480503975969750252 -6.0563821935695640875 -4.5966509565104933799 -0.40602498911145745719 -2.2256515788086077556;-0.1550481188180539982 -0.26930958289138628992 3.5910809680627471252 1.052246430597100213 2.6009055203244906274 -0.17132251846447948962;0.44869438637451708463 -3.7387608300649755044 -0.56373161938973948004 -1.1597963672327815665 0.49869205701774604877 0.37256593632525841775;2.2716208549667511463 0.15077287621128815376 1.3157731071082048313 -1.2023415608633141183 2.3847995571546269922 -1.1864066712756187183;-0.30175350092888147957 -0.72768483011011231287 -0.43845974047525543282 -1.4149606202408000488 -1.7080674176831878164 -1.3646537789402728436;-6.0039830110952721043 -7.0621843042127441237 -8.7237386943482455592 -0.5124936241548442295 6.8048643903159025115 2.0954217349347290522;-0.84839293639857460416 -1.1416670980418841541 -0.55484349027276269606 0.66330590590775562188 0.2450766665800522548 -0.91138074300248395065;0.17579034901750326125 0.61290830296814213796 -0.64288612737337913483 1.7282405922729711101 1.3659166774347193396 0.14771411153741342837;-0.62721219177469722528 0.32217171409888872846 0.24380428043896182344 -0.87938795103588052182 0.35206289277226032741 -1.2851800691489470019;0.26291780408901715971 0.38599740249761205213 0.78912714551314999678 -1.1366629796564959864 -1.1639127260436894495 -0.43628976632296312399;-2.1373241272311833683 0.79376805114597603907 1.5639051076244157024 1.3325160705232619307 -4.716526655527151668 -0.92664455343711538138;0.15358318196980061399 -0.15657038601228642771 -0.28359077013353695129 -0.19679172428088190228 -1.1739620564256356694 0.12679427572797158374;-0.17601398119522981833 0.058954896804160612789 1.6927502437256720658 -1.6723009059087652339 1.6065219541648700918 -1.0053229880435758936;-0.26162367816046760982 0.15028960206070210437 0.67551920165471490698 0.17384632465004001833 -0.50832904100147224824 -0.26928370124729950064;0.063817285676526197546 -0.10963096744289395346 -0.64153081761353236701 -1.0242860523870587208 -3.2341578645576567475 -0.65264017577271826731;0.14858812993477302222 -0.097023721824374464795 0.1515858906746560264 1.7439052330577153871 -1.1484456005068470752 1.4899043997400751582;-0.13732782993057274235 -0.24985969794627746476 -1.7766849348136535269 0.55068885054341298879 1.4728265710947958667 0.91959515081099907352;-0.66367719457874163602 -0.73577852862806991663 -0.75599339201256343657 0.66871529625412129416 1.9513840148216226034 -0.52897452763316421542;-0.15574670856531355745 -0.41499560217856457101 -0.37638762456040059101 1.9708061693513745372 -1.1330575686069681574 2.4924046404844553138;-0.20809067985507237464 0.11096990618748195367 -1.791928331807461694 1.0613496659197361183 1.248351093740383666 -0.67599251601970300474;-1.5040264653262460648 0.59467545757569573173 -1.3279662095267772415 0.88335103598456021778 -1.4841942190051358175 1.1131641003349102004;0.45846801027373507154 0.47573242663580800338 -0.70503342670116742052 -1.255399918955905747 -3.6480178171710799795 -0.24506211229127505824;-2.0780247994867915295 2.2088936554572184967 1.9523635228482398851 0.28020923741677356 1.0474290770852749954 -3.3505371096289575661;-1.2454999804475914704 1.1404570345660249853 1.926462292287256739 -2.9311070340232454612 3.2603783114876878635 -0.1324513852972943051;-0.024299799528399015913 0.60854470888700551434 -0.43795431314310256932 -0.41851830842546028366 3.9518261432251415854 1.2943921556794357741;1.21498270941287978 0.60078079577614018625 5.0784059613906329389 0.52111070935957404249 2.1353889740237872452 -0.17860665328872482593;-0.16636987781672665787 -0.42408086315037835101 0.95219465588857454819 1.8326006021271283863 -1.1447192059097137662 1.6419604859516532258;-0.53719013929712111644 0.27900616407055639501 0.67317551034732714399 0.42850676597118037003 -0.33823491172410974359 -1.096835104756243684;0.47876341140337480562 -0.50777000940390570882 3.9681645065710404729 -1.4355298921866148643 -0.75377609300131342973 -0.025025705367789540662;-0.71655552195817850958 0.052529759999803374293 2.5550939232777576393 0.53997117497044611056 0.49319299166833069359 -2.4072171630581506996];

% Layer 2
b2 = [1.2984955392963080101;3.9218507736511698525;3.5463783406887934291;-11.942097423596919725;0.062242241103983818318;0.097458923801652080909;-0.12555674528851881733;-1.3221098705552662977;-2.7058552248202265567;-1.7444554878523328423];
LW2_1 = [-0.18542370338400668284 -1.5631633051503315279 0.70616407734904085292 1.0533593941114942627 0.78793709209682938344 0.2194447633820472976 0.12467961859744060293 1.7464579844189738189 0.44381266117722195652 0.24003417942115165551 1.2328959270223895928 0.51547051085305040097 -0.92201963188465807519 1.7031469055468395624 -0.36763478272620808696 0.019094873725582901108 -0.31178308809549776237 0.66288922895387625278 0.052899370650685333117 -0.51189444193747779543 0.98712609572852638706 -0.576440726413669835 0.19536271993261872248 -0.13269340824570999282 0.088984626875866196238 0.89569910404995634057 -0.17763794061372312205 0.23516377060314533343 0.077178615282908383244 -1.1891549614117646883;-1.5016820006364073325 -0.85406256426514914892 0.67559932488448393162 0.018507554714459480139 1.8281423329827826141 0.7299551093313570993 2.3964138709053650622 4.2644699127019043416 0.88526514191841165768 -3.0928129765890188807 -1.5200930723990111471 -2.1438544999938033975 -0.38069254923471040897 11.098518091880736236 0.3867251362671281778 -1.3934715405615731854 1.735368417973132571 -4.0604316479010380547 0.80237194333943318014 3.5388576478925464208 0.34138723011288751863 0.72676626042304359743 0.42408946921997392465 -1.612164648572252057 0.76432400525208687991 0.56249607678665614063 -1.7182602644974480643 -7.0431384993434331676 2.3156425514472696037 1.2826881343013885051;0.42628551179816037697 3.0003792315122082002 0.37961102821013265052 1.4777893629758334093 2.4770889131829929575 -0.17731337159333238063 0.092457987529648663627 4.2393277890920169071 -1.9469466038346299186 -0.45350804714371351078 -1.7734251176093371871 -5.2909192324114169281 0.70265390798631310876 4.7297752901126139946 2.0746797279044808526 1.2739251036332455147 1.3281740659040994768 0.65317380992110540827 0.91318845587860331126 1.2648017266693214466 2.8730941672026051315 3.4270409888171236013 0.6023311260403684253 -0.99025925088277000352 0.061470049157176027965 -0.11343247931355640579 -2.0603907114635471309 -1.3019642595535749763 3.2287811413535969507 0.82330567200635107472;-0.59482734860236652352 -0.23422044357634008716 -0.30999546948311262895 2.5450837946522750777 -3.9594284728953681451 0.25408867800060369602 1.4032014271140940131 1.9691202983839006802 -4.1154020323959272787 2.7486100981404435473 -2.0961870938841915546 4.8714610290482651678 6.4535519661785007983 3.9863431611759341244 2.8039172660715077079 -2.0486230687153303975 0.76603110443899968818 -0.85485844447093461973 4.1206296500278645212 1.0469954222298358815 3.3191768284643026199 1.2670195074132271085 0.60223477125416224887 0.75898283572435409905 1.1103676428247706287 -0.96626375476685433252 -5.3530103033128106915 -8.968912622682838176 2.3903434772554454923 3.5619029003267157485;0.105794730351896904 -0.3028179231869028154 -0.81424722489059375707 -2.5601173249393274212 0.32781534849679455634 0.082100206431859987233 -1.7076652900530460144 -2.2961887671891694218 0.31457745933020614393 0.87290596567776967962 1.5908307160401984337 3.1310333540381192208 -0.75963372073685819785 -3.3317274768111562189 -1.1919816678161743173 0.67804446850320110318 -2.6655855751841475154 3.7574775611327919655 0.17015030926659474586 0.24766109244971015735 -1.356861190351706048 0.49500696457383580595 0.32011073812354023937 0.92866694956514406201 -0.32435770456958479269 0.14796088432826084991 -0.12973334942821909688 1.8971300095534824326 -0.26824314950105437871 -1.4595988055484969692;-1.132321392982106989 -3.0105325294209275278 -0.24640203464041260384 0.36265651167161927493 -1.928824353498920674 -0.55939137486887402506 -1.4888286880580217098 -4.6599459483381719949 1.1308942852137762181 1.2631279698181319127 -0.7688510587209235192 5.8769161520181514291 -2.2208246434473890574 -4.4335892783793813265 -2.6809450295431664912 -1.0174586293919622992 -1.4737734350835611785 1.53389478729921791 -1.7647041470201980662 -1.3599506567129129309 -0.26562933571012953271 -2.5896126716432150694 -0.45071786284146381218 1.2148129374859757412 -0.53433844217656223385 -0.035185117191927683944 1.5357898784004586634 6.2681685977585459568 -1.4872951663935525257 -2.3251232640956578379;0.58167115711131367473 0.76365670421978393279 -1.2092377201934185749 1.3465577961043273536 3.6579219711770449841 0.12515996947404969819 0.4227310184819935146 6.1990997253605684136 0.061435990093973207038 -1.7875158142528602134 -0.39216312536696557034 3.0172309672898167676 0.93851529297848890199 8.7819836743180932359 0.35075343029330235955 -1.6791923970465074678 1.9618976709789475166 -2.1507997811405750177 -1.278988411101530831 -0.16525064581388970719 1.191904427877006345 -1.7147653571020227137 -0.07301453128380283597 -0.41714136885121294585 0.41424985121958057821 -0.22064422273394795893 1.8412520836758161646 -3.3230545970371649922 -0.081193052529271933504 0.44338610600966948949;0.2313953274013289263 1.5158960059470605319 -0.71792500490610366981 -1.1413075052845049751 -0.77498621612854523555 -0.25208304526888070107 -0.1981868234050059574 -2.1420261305507368732 -0.45596094557453115126 -0.11248560413245418943 -1.0598989187797589473 -0.76636772690465460034 0.84589748159712041531 -2.3966809161379161175 0.43083696886730632469 0.22939410265123610921 0.16533882246443776243 -0.44203741502076476788 -0.055577628439231037405 0.33580273441359625997 -1.0277430022392803899 0.46110366259746682349 -0.15422193036496315011 0.21322562321530133533 -0.15730121436718658146 -0.88092861180768511353 0.00080144695125246908501 -0.24892920831156042927 -0.19698795097352098105 1.1497271548340897152;0.51200246242710789613 1.2299048983700988646 -0.34834861565685026896 -0.94576490680466529515 1.8121380826782629292 -0.3433296168024277395 -0.7113344580325303701 -1.738485501790617338 0.16850927066059592785 -0.39255036935044484991 1.209475018090795162 -1.6783999471381834123 0.88100649170446210245 -8.6813999036505133944 0.1591460695425657712 0.40023324973410884242 -0.78322334209927668702 -0.0072128108153882092637 0.55688234148018245229 -0.35198075626564018226 -0.4381182553172627836 -0.52426883915181865525 0.17790064487579076991 0.29098595681866867846 -1.0008099287328000582 -0.11504696597992723761 -1.053348011305800247 -0.44423323034881273541 -0.77023661309937585528 1.9866749398988743369;0.84431862583582373283 0.98565084396251090304 -0.93293297394461360827 0.65883796447418563336 -1.0213158755510054476 -0.39086843600904463969 0.43555360020347289041 0.88064290678828460734 0.65625842099231723736 1.5936074123901655675 0.83116419700046773045 3.2268636489187247918 0.74971284225980350246 1.081764195018045438 1.0143419505091220145 1.0827216482600825476 1.5927664293098857673 0.21298529195646345724 -0.64280345117852477621 0.25459940273185954762 0.71391826973577365845 -1.0894575822426857403 -0.16972866754257698307 0.31945987536079883951 0.44949496017943224579 -0.13363289944373124563 0.2070854292335549407 2.294038464712931269 -0.036340128418109921005 -1.2317436808194452968];

% Layer 3
b3 = 0.051071021430091831372;
LW3_2 = [3.77241349675788884 -0.38042629944913247675 -0.13833105483418139947 -0.26431624929548991343 -0.28941333146354297767 -0.22731441995126225319 0.23376577363254244513 3.8108343391775338915 -0.41368809676433709877 -0.28847819374816441318];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
