function [Y,Xf,Af] = ESPER_oxygen_16_Atl_1(X,~,~)
%ESPER_OXYGEN_16_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_16_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.2030262673633949078;-5.2498398884839350131;-13.387085053016578584;2.9501150268363494078;-5.0571528906334544118;-10.957321629224328063;4.5453882221274932718;4.2935458264202193135;-8.824613491137997201;-2.1820774887564176048;0.35502449788846490719;-3.5118038183361699467;-2.5604420061981336687;7.2806977696431687264;6.9895428531070793454;4.786047725048745427;-2.070721275760334823;-0.17343869242570014721;-0.45844765151762550959;-4.053041381564709944;-2.7891841054637156461;-0.23654897249999320974;-4.7899035735084023457;2.2278612783259785779;5.7140134368064350312;2.006806336700513782;0.4968126163043403154;-2.5058134257384607757;0.40515479567692441742;-0.20972413907467413186;-3.6903255866551347708;9.3010052428027467641;-3.7252605007214620869;-14.025377253249805776;0.44857066609096452048;6.5627647287022492506;1.6674872130154418937;-0.28784800599063425919;3.0014187830138672197;-3.8516057089512294453];
IW1_1 = [1.8818620847107765393 -0.20175417629547484633 2.6366024428372165644 -0.71582640223183602313 -0.14192718787640706823;0.1009768280067775692 -1.3792217838976885691 -1.7705733526409681566 -1.0052428789650007523 3.8511737077719834232;1.8268943912960859954 -4.5206043932341879454 4.0534961569817911098 1.4556755646176477992 11.595147638173694205;-2.0223033994112293854 -2.0754786189237375282 2.3573215231208619613 0.040133069059364159803 -9.518824493998952363;4.0707680287863121649 1.1147433042974574935 6.201481439452483535 -3.2692306640789996486 0.10225544048337872893;0.545149985404675963 -0.40406227284467871597 0.74812197395116430965 -3.2663877698273213745 11.845524738957946553;-1.0727818404033762079 -2.0469942080724665701 0.26302617543484169138 0.80485822952690977417 -3.6076322223162224923;0.55624296409195639335 -0.88635009467838221653 -0.15715509684375111865 6.5045443549244845727 0.076006960326432893016;-0.56505061307612192145 0.70117596161389383891 -0.30180835767259611702 -5.6048863917109663646 6.6412756324713297928;0.45206071657590052304 -2.5268475872937310456 1.480011516971133867 1.4665404344549652915 -0.5766368631378201437;5.4354292532617787259 -7.1496703107827856982 -2.332590403400811141 1.4890907446380050594 -4.1991109164445186153;-0.77362980677000769969 5.1810019983379431707 -6.8051843850131259472 0.56398275650536022763 9.2415910653339334857;-0.66248939345815127666 0.59236399048074639406 1.4884869727806591122 -6.3870948827463598363 -2.9295734274838576283;0.52949866824060631831 -1.000138277554209143 0.37133429883741592148 7.5430050744426182519 0.46459556140876034913;-1.7573983718710881607 -0.39703255603788289996 -3.7358312951693735116 0.63763411750419429769 -10.171274182036240674;-0.012137199025933093771 -1.3141576541451391869 -1.1047044103363290457 6.5984343413041814941 2.5574185286229571545;-2.1522110073884723747 -0.90691570256941278494 2.012873917886935704 1.4864828924907633745 4.1501245307908751769;-0.60076138363565656508 -0.65392619459209633259 -1.618260139172168488 0.39529134583157216065 -0.59612658639456350684;-2.238588676523073584 -0.32179554790780867668 -3.8000138228530460083 0.10493969465254816831 4.9117347568934315305;-0.40096917002407589381 0.73324592947327849046 0.34193251065669272304 -5.6299278648630037836 0.21326698988896206077;0.0095828403406123825042 0.34002762821598125909 0.38313302497211959574 -3.7458286666011728627 -1.0470817765890563233;-0.20262806661671159403 -0.61733903176285953585 -2.3253035185173334121 -5.717566957347532508 -7.7322192063575121423;1.6105946782076407953 1.4469661902324923997 -3.9039983996695220014 1.1472427200978998485 -0.71854943390145109561;-0.027176495488211376006 1.4714440478800168144 1.0507547284292100276 1.6392131261135645115 -1.4972236771505933461;0.57964384616050235177 -0.86214674149034575823 0.61181368748551201442 6.1939436948133845817 0.45202229350650807715;-0.11905795349950459849 1.446301484639278323 0.89007312467319033011 1.568952795576522341 -0.9150663657723790978;0.25306477573377839096 0.69270152677195218072 2.3402919861996638318 5.7540061632642531819 7.2354554349797401969;1.7877618722557886421 1.6741798103757528082 -1.708918647987226036 0.069701192913220008651 8.0720693471809799036;-1.4093429028714543616 -4.8152641691760882381 3.3808357430038249447 0.21336511334549693175 -3.3455704342968348719;7.2508612707705628608 8.0530460201537437115 1.6637483694213788255 0.85938879707938509167 6.6936344534509126802;0.44154998710884424407 -2.9194931990175896352 1.5838269607439541264 1.5913765717673815647 1.2576622402227441988;0.54480148369934611186 -0.71566409044019962948 0.19345403161364674305 5.9538143411918689196 -6.8561400345760281638;1.2544466838611518789 -0.39580826035660898743 2.0433042811400703442 0.83843534082397674911 5.9534785954357554161;0.2854350521884028713 -0.6039795025166515563 -6.3662552517232997573 0.49364677460115752305 13.700331691136383938;-4.3866658063731414074 -1.1202199736641014205 -0.45897930899983269137 0.84458312840721860848 3.2043717879015298777;1.1567433587896054359 -3.9004764775639824137 4.0241211392222480114 1.3332525440442732911 -13.220166137570181775;-0.30585819319393631188 -0.38193776124897860225 5.3142538791979063717 1.0521726188995197404 -8.1030004902796690658;3.0857281315877331807 2.1990889057635918391 -0.28151903061876487611 1.0695148544239041488 6.7623153802926756484;2.266042574505727103 -1.7719518264612887926 1.9418456407027688826 0.37882864034818608534 -2.2029611605792274176;-0.032110345174318224992 0.39064769474837512941 0.22631667379344291846 -5.4467351948224562719 -1.2954807661205278713];

% Layer 2
b2 = 0.4867430863481798653;
LW2_1 = [0.52853356234218806797 0.96426000804821121459 -0.27030002646946815759 -2.3298859692463493865 0.06671122769177945111 -0.29727565814885792417 0.31448069772848769032 -3.4013889111204851368 -4.1017131693960644512 2.6341970454391918643 -0.097206412177232873195 0.15415511481435931196 0.37571724839307091282 4.2398167150313428309 0.37234475175019415838 0.82099744421262155214 0.2763304739937126886 -1.1925142218165625252 0.33441076867288610508 -4.9914396409639332219 6.9984470970390013633 1.4539906112394700433 0.36449724569933589224 -1.2299967542018805933 -4.4694859524587258193 1.3727780272750256252 1.4292317289849878481 -2.7128900506682471772 0.14019546959151812926 -0.023056417868076738154 -2.2867809357082196087 -4.2608544023136936119 0.5742342947561891453 0.21816721718860607182 0.097569276710217131554 -0.17679320203392301369 -0.27261483273831482732 0.49741612851620331526 0.75515340151161625126 -4.005934643726482669];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
