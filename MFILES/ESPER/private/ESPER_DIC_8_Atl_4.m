function [Y,Xf,Af] = ESPER_DIC_8_Atl_4(X,~,~)
%ESPER_DIC_8_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:13.
% 
% [Y] = ESPER_DIC_8_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.1295530242803275556;9.672973015547865927;5.3450560337460490956;10.381229181341927514;6.6319994756804430125;-8.626638679072227589;-16.438088816485862509;12.533885957757295415;-3.2179384033714661939;3.3897335123255238898;-7.425548106575868168;0.018794974315448208235;5.5382002210033780543;-0.75563113455253516637;-8.3513627623018518165;-1.1472726259209538036;-4.3951724783354482184;-5.9726095627926731879;-1.4788403538318646291;-7.992470104892213989;-10.298362177821202224;20.185122213465596985;-0.40701972116686796488;-4.6495276304543313728;12.574400608518747191;-15.319608351439638838;16.286460923884870766;2.8937624894450268975;-7.8335500550746504089;-18.436337443265628622];
IW1_1 = [-0.53800939131551872574 0.17626408786519776051 -1.0418933097964608869 -0.48141580398667660479 -6.7336334445375767288 -0.24593193199483551203;-14.378301012855812857 16.42127182818195763 14.858391203555553872 1.6290028242700278494 6.5112072336476654044 -1.6734983862561141343;-1.5879100865130553188 1.3691667135554859147 0.12105472956452348332 0.86347321198566329148 -4.5424928064450140752 1.7890880640408644009;2.2820703874865979621 -3.8214518601264608755 -0.11401074014209430785 3.1563429500481698931 -13.501805001535709394 1.2607017968935037011;-0.18360398170978126098 3.1875591693436700069 -3.8260216472889418959 1.4733439579219147486 -3.3180829055251042092 1.1467752834092481695;5.7407007345755447503 -9.0836196449546200427 12.064893401182585464 2.2080437499173055649 1.1979761612793120573 2.7276802411333633813;4.930227612380694957 5.3704532857645084221 4.004728978554784824 2.7008892429937945145 22.067918987038972034 -0.65992885121998767772;-0.065059851835695806099 0.79330478526471326362 -0.68104255229700216834 15.9981386984277556 6.4538677295893034369 -0.33464916992335630441;-0.21835080951881818967 -3.4563036859562576986 4.2107256751510258042 0.15020167910993637017 1.7334195352483168229 -1.2134165871482405219;-0.83292206869560081461 0.80156568452767307242 -0.29459045019221868911 0.32119902433122698993 -3.7641923782025656919 1.2696611700982192161;-1.6225882609016946123 0.71875695024979213699 -1.3726617050061205028 0.029158961532804509448 4.8813495114628890903 -5.3960751979760335217;-1.113627710806613047 0.37780401959768911135 -0.50258245308609328372 0.38339001375453918286 2.4034308495977039222 1.3867128992979040891;0.94078543293385619162 1.9734063793689999855 1.6513701081426497286 0.34637289114346608843 -10.062469162321333371 0.50112917780322840944;0.53038167278835834928 -2.5210861214647706241 4.3041797585880976484 1.1827020843692297447 -0.80629575831209432391 0.61898317034597016839;-4.1157268777100926016 3.6215920579619020891 -1.756045653287044539 7.8374937620957796369 21.916408767651390122 7.047414962350043055;1.2153659700923156173 1.2325277981436844055 -0.73075524541994474337 0.25019895149859178174 5.4489953443346479389 -1.0500768236304789394;0.17837837140242659983 -0.2485434039350864488 1.8775369593333190998 4.9403385308240883589 11.21728780650127888 -0.38575208358323781477;-0.6601906817160370089 1.7853961022956477134 -2.7005228040899393882 5.7791203696967849979 13.032802627450291055 -4.2495665028757132475;0.80913933975802665444 -2.0088102345312037755 1.1998848860141275718 -3.6500546784721930038 -0.36857017919164908326 4.2772825003376357955;1.9827717999648439839 -3.2917820606720504806 -2.9887967621417073083 0.79013012335825727472 8.6004455153828498482 -8.3428898358342866715;0.75272816703226697044 0.71299266671616112756 0.71586672487821234601 -0.73109527070124846748 12.857611831984721462 -2.9623451278307877388;-1.4564342807906149879 5.993553907997373642 -1.0561628431563254704 2.5647805508707950395 -15.624029481888713988 3.8660351602317772901;-0.055044755774508957735 0.89856011545346392566 1.0682214161062759672 -1.5277865978393401214 8.3312200899116017894 5.9730443173152796277;0.99925494876855314175 -2.9242729363035433465 1.7259587086173413528 -1.6596544133220803019 -2.4128621902734574967 -2.6790625701267680725;-0.10632232541408120907 2.2894405096483896322 -2.6603814518416055712 5.1812890772631732261 -7.0268017141753720267 1.8415615504748024112;-2.2426825438089790232 2.1917738669773618732 1.059382198557458743 -0.46779054308290463071 21.997738522994165322 -7.072369110747793286;-18.011175340859164606 -2.4796252391963808925 7.7806174934921994435 5.8111172851827284092 7.3291330365616023101 1.3941832225270665013;-1.8779017785359166659 3.0058273187035027263 2.7887255701773043803 -1.1084269107407667132 -1.8978784899250638052 3.0825812809801869108;5.4036409058331145161 2.2065386708286545137 1.2169727249085031673 -1.0210373537443417913 16.946603308540893806 -2.7033568147383508773;-0.29385437279529469379 -0.86914323998337728039 2.0226836598629165387 -1.289966075778079091 16.077080128206993948 -4.3138227219437856874];

% Layer 2
b2 = [-22.216678380612211896;-60.717500640949523927;-24.605769653537539199;16.887315848361662773;46.143858375503093328;-21.962720212317314861;15.791962086127965037;-15.068363173511752251;-6.1517696920191600185;41.672751834064747811];
LW2_1 = [-20.739853711969740147 -7.6646565244910682679 -35.18733442321151017 -4.1552686424549625244 -66.426663552126342438 -23.825409182893277915 3.1111810361138094727 -42.482446704540656413 -27.485816854009488708 -24.092741086294516606 17.967169429731491448 30.796975881878168479 14.121293957077108772 -10.130058388526345325 28.264337593432443896 -6.3958561257386801202 21.652109141394973335 -8.4594198465966154998 -32.620011615356013124 33.635738168832041595 -12.038707033989213713 2.49026013593445672 32.857363809795955945 -5.1726130519021200627 -27.721353800643761645 11.691382647691739294 0.89881776497742504883 -27.645898589240843535 -22.416854194580217552 -36.143656917007305651;7.5926959678916299268 -4.1581374686056573609 -3.0722834536806047367 3.0646008382289986471 -7.6421253477812030042 -6.7079688477925767387 7.830066991764232931 -12.06199970911573871 19.244992974540952702 -11.02693120479547062 6.6273270700425994661 7.7808434204220047192 1.0688720815600918357 0.87885130843043957061 12.758583240619740806 4.4508450081770378759 -1.0018136445693772707 7.4176460030465802831 0.26418465701410392965 -76.332860197879256248 -0.77358853167498264902 -3.5531218623679290403 -1.1257765256703740064 -7.3056173483518938028 6.0720048848504406536 6.6882126514843012188 -3.8627223848356502245 -14.393283618955887704 -6.6053239108881971475 -3.4228176534592855695;63.649465164212116974 -0.80970542043110504959 -8.4178532058434747398 1.3013547821913762359 3.2280968056055097115 11.545287515122335975 17.517554472472813387 -14.629406185199863799 -28.172755793323776885 27.089307446904751231 32.066724263297103903 -7.7068196582294481445 11.594192331670582163 11.503672112398376726 -4.1578280766185811146 28.961200395231319504 -9.9653813955632859489 13.62117150442350777 8.0306423458146998229 -24.078707122766978443 -17.894771238183295736 43.11149794930882706 8.7714370260197629392 1.3745247787765673131 -12.301832353566529932 0.65549698180481774656 -16.386520714006582722 -4.1840805898929618323 -10.751831899095114053 31.358899249391328112;-0.14811369054374878829 0.027192223914417164993 1.8866636520989650272 0.01496224336050099718 0.037491564235006338834 -0.30328194562193405703 -0.045924592198698342693 0.4446650496166706934 -0.093381638047716833406 -2.7186617287013628008 0.57541557298548395849 -0.06666317201013816085 0.29667993154478700113 0.79464465545196727447 -0.01830986024244803112 0.42834141515703000325 -0.38379359678420749136 0.11154441894467770346 0.27615788410316072232 -0.042287535038619261663 0.48939315675172062603 -0.082077964362905000972 -0.14274649865045757613 -0.30939846448441460369 0.10651363072572210544 0.044580223542745829601 0.017172346705582069992 -0.24396930283242881932 -0.86527094769304935262 16.341016830012286221;40.771288223137261753 -8.292472427570107385 -7.5906605294413065366 4.0190803466250875076 -3.5986881078247208166 8.5694054571197639802 12.926774683075340278 -11.378943858277809298 -5.1393578213182964376 1.9763763541391907719 41.48365924043953612 -0.30606832634557934458 -9.9678599528570135391 -9.2159801832873462502 9.6668517301551926124 5.9614987483469548124 11.338167952792424842 9.4861011316212540123 7.6406947788008681144 0.14163172263466999867 -25.825780024621380448 -17.932821410271017726 6.126636452891619733 -8.7700436038039537578 -11.804802187879760211 5.8458801580870964898 -5.2318432241088563828 -7.6044644475207050505 -8.5984192033497315322 23.241087176510877299;-2.1371482152399972065 2.1469239017947536752 -0.94572689027910727955 -19.399935816646127762 16.149519144511568669 -6.1937242754530306144 -6.2552838025461534599 1.3912867334306848743 -2.4696987784167960811 36.384864678311956254 18.343485645819377794 -3.9296632597310683366 -20.298180883933575558 20.817386204535232253 -2.0355025020495363108 11.572887993954049435 -5.5826389687217830016 6.3679217107295951195 23.55848877131787944 -15.622389065759302085 12.425588857233188733 -25.865320551820190076 -6.1249879574022010331 -26.906722414120455511 11.007900220973095173 12.879975759385352774 -1.8621605821708131501 -4.4977859818304022355 20.336780405544715222 -19.513193758809428857;-0.47252708024741313375 -0.44225203250682620926 2.1009006240544958466 0.14665326611409196245 -0.23343314529895928255 -0.18700021376656963956 0.031607079162735883526 0.69811054616855594546 0.79849396752471901717 1.1633432472133931057 -1.6928925085966473052 1.359540737983085279 0.60049687579302890583 0.31322504553273877725 12.9028570786921577 2.6016934060992746858 0.050752904729752378044 0.54891541489181439051 0.31012389458773381712 0.80564367591940200253 0.24252915120962759143 0.098902553221304492781 -1.1467033749726243119 -0.24077534512600226591 -0.48934899725299962903 -0.29770793507328208172 -0.077335701196453346395 -0.53030810892257884692 0.16517125804650692467 1.340297472099474918;-13.328779979252349364 -9.1659106204752323066 0.88570971130609121857 5.099101789020555664 1.992892322011484918 -21.630187022577114675 12.736186421048593331 -55.56071785598208379 7.7869485994115370531 21.314968105556616251 -9.0935782742360196096 3.6091268321463068069 7.5793053760354371917 -2.3596153561066892657 -7.2118598415088621678 23.941929612164425833 3.2387461467131988258 0.50835372955825297581 33.112078302376957595 6.5385760245828912218 -3.0471275961564177059 -10.09405730534240675 -5.4599947666134989177 0.088281574154884079331 -16.290787459264198134 -2.4951547629478656454 -18.30272469535782065 18.180276486234273392 -1.8528268026989511696 5.2995388160654872678;1.3223952370766072217 -0.0011836440369355169001 0.9435846279283356397 0.83598346817802504649 -0.51097606549710572477 -0.31236190186521733958 -0.065782430630100890978 -0.32919428730304678421 0.60031040641928479218 -0.085478445286317969454 -1.1195970941241704111 1.2628173166483984691 1.0560067906127859061 0.44988478713774593398 -0.055281247878765267523 3.8507475312394281453 -0.074084325282947158242 0.26007363531747468288 0.12620309035977617107 -0.027387516575905178351 1.6042506390758992652 0.35174410044025855582 -0.49269980081386066662 0.6909572613386425477 0.0058903735315613938231 -0.29765657098676301384 4.7547771833653902362 0.45029660814568400751 -2.1432970512018258979 0.78986850580999390381;26.890606407809777068 44.19186160931027274 -59.187072106918655834 -23.552973954652063782 91.506035257243453884 4.320517549120034495 4.7997184729123318903 8.5333584340729355944 99.176035677600481222 -39.696766024028711684 86.323548374961646346 -7.9764570120881819193 -49.393140709158821267 -24.613683462744450736 -42.44935914768503693 -18.538227092564667942 21.641450762976649713 -5.4154489322837351395 -20.853478989927808129 18.867198570919498479 22.228387989469581498 -0.77336805208235104292 -3.0956360441783576931 16.681764314318161979 0.77539741978634713071 29.467217589710735126 22.596694823247037931 24.987365399664568599 31.312225983762829173 -13.651937405659527514];

% Layer 3
b3 = -0.67108635520918369366;
LW3_2 = [0.0026100783264410114259 0.0063083802798577287216 -0.0041495716430100934233 0.18293698967776753084 -0.0045122007566173539042 0.0035116834239295596776 1.2610796507657935361 -0.023126423573620852325 -0.10234094613224770098 0.0066445076460531111995];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
