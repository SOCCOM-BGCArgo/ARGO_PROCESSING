function [Y,Xf,Af] = ESPER_pH_14_Atl_3(X,~,~)
%ESPER_PH_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9385286662361194132;-2.236955665255536907;2.4905495222218605456;-2.1145896614496342281;-1.6661480822746139729;-1.4731743032854538455;-1.0047565637547521966;1.2063208551406179314;-0.7946616111054423115;-1.0788881533222867137;-0.49794311326056706068;0.34079917545995130901;-0.14406658799020921613;0.2362947456560846593;0.52742050727538913879;0.6944017456363664742;0.98390242068492628214;-1.4457611208129810265;1.5436584520989415914;1.6603135364492289661;1.5334748034220488933;-2.3633243700173953705;2.1312711595381341745;2.1193133689390584173;2.3227152875340784099];
IW1_1 = [0.73064051085645875805 -0.13158860608440034468 0.15454950658795613139 1.2052585400925637238 2.6957072406558020283 0.77319515315952103141;-0.11158511641972343464 0.65316945973807183368 1.5921296353920215694 0.17660951120565110406 1.5552386778289521985 1.2793928780230892084;0.19483701058384098048 -0.43359179830100108566 -1.9258266955719023361 0.98961402043923252236 -0.63024480135977178907 0.60451950770312379291;0.41877483459755066031 0.0049924639928338992306 0.17777467686252779178 -0.89622960448438904191 2.7570381352486061921 -0.35829185369687405194;0.84371689923142689782 0.20646956111964656633 -1.573258272850948547 -0.87061153199639262912 1.4946317405520044286 -0.8290782548863729895;1.181484679892933265 0.25252380877002555959 0.025632021096647108344 1.2681577132467933833 -0.29891191561617003192 0.9766453282158366056;1.3059397189311150456 -0.67871967700389967959 -1.2935013604458367453 -0.22675027657151997085 -1.4394070742396669615 -0.78012887208329573241;-1.6916546271758288178 -0.2178757960919770198 -0.92871511856002897378 -0.44782860775526583952 0.87156570887642215162 0.99752054188272420987;1.4132562462944511239 1.3813891058469109918 -0.27468866967182109518 0.31394934053100909122 0.57593378760076807676 0.69026681957950952739;-0.093649105921316061485 0.45964932212595505101 1.0233038357339454549 -1.5635232022595104695 -1.5615933942251700728 1.6964037870233679151;1.5177840246641489674 -0.33530768049670939268 1.8434396527691980783 0.39868031974523338024 1.6397689062871401156 1.2373005137145085541;0.038136657614276467387 -1.0392877421904767044 1.030475107548527447 1.7185290800044066284 0.60818284264026689634 -0.26788023842049196732;-1.17281854921040396 0.48113779020853936208 -1.1985188696456965385 -0.78015425810909044824 1.4722810647290858199 -0.60398865140285062925;-0.61946257721154363018 -0.096074836742617519825 0.50655444183141329351 0.73744257146730696206 -0.69250285753375218079 -2.0161480768021124987;0.31989406841813916582 -0.12699219056517671578 0.54243567419411653496 -1.3570402689613345615 -0.88478728263363404238 -0.91224891341450409232;1.247179979277589057 0.11561929417577981871 -1.0434630819206796026 1.2896900890071600898 -1.0225593933162095972 -0.56930104560183181217;0.40331930110498970254 -1.0309227928016924114 1.6053314715949527081 0.65305903270045118081 0.37299751908716932691 0.97950538731686365157;-1.7191796594749326754 -0.33136371210679771426 0.99180759935110907044 -0.25706551823497653109 -0.63821938283974466444 1.144976304776807563;1.3374394215283618159 1.0479247757364975602 -1.4123056882291764591 1.3468429497244382986 1.1807343871109128308 -0.67633395688301001236;0.13264201122346877537 0.39280900271613683472 -1.7660093915103565188 0.022049997946955224304 -1.4170485828937151584 0.35174021074977723789;1.3426098372529700065 1.2474182789044294672 -0.87508318216345637452 -0.868922352279730692 -0.80252571088745194849 -1.3801672097869290834;-0.35261841471272492576 0.0046508959528932117614 -0.88092522549222207484 -1.2449889664919731036 1.2968559666119352514 -0.909173954514422622;0.4995778679626248775 1.7889072262503902255 -0.45486765241456622588 -0.861184440172443888 -0.89757574805566597842 -0.025872884045272069586;0.64012505980479761369 0.67436674226636827978 1.4364068548987873886 1.8732612321776471731 0.19987638359457005066 1.1314545228160688417;1.3440506782962833299 -0.73581313041811458042 0.49178998048903604934 0.5873015335198344955 1.5306933579024606384 -0.97342237009760723687];

% Layer 2
b2 = [1.434556660401040018;1.3470017168698300569;-1.0459481690263896514;-0.98452061538465640567;-0.98894451649607773014;-0.35944844817080462418;-0.26768363501929171022;-0.0032799483265814124988;-0.049565182892284675997;0.47042306921029064526;-0.80812336161640074828;0.88838304240766474695;-0.79917277289481802871;1.3559308224370671958;1.58992316276641521];
LW2_1 = [-0.21038465510415649273 -0.67906530924049701703 0.1151753020449970133 -0.14834126580501699744 0.58192698750484772585 0.18819759259097892934 -0.11920548721741147657 0.15584682270755551015 0.6139863691780008681 0.14585412791639362773 0.40831474204789708349 0.72687863699508004078 0.32003448805338835514 -0.45378168084426595552 0.12414106060126244013 0.40337515181668887054 -0.13172148565453772884 -0.70645437241654440719 0.041101472721150097978 0.088187288987285616937 0.15734146604102328126 -0.58677936440761124803 -0.16400154353148946318 -0.40544989786204477245 0.40494817863122889445;-0.14081407850878074894 -6.5221461177303666212e-05 0.080577740277900170018 0.67234924611348578782 -0.3791279429096916509 -0.52498926472822460276 0.14293276061453666359 0.24771879470304566939 0.61600326803868998837 0.68803246646818749799 0.34112065471927338622 -0.38642968867184612769 -0.35452105143315765234 0.34495678449762462447 -0.18998932162552359393 -0.0076296758493145568764 0.35583417704808528725 -0.037322282873641414447 -0.58117693673773840324 -0.4804967728132186755 0.050277417321331001332 0.31496429663963981804 0.33240962220138337013 0.20172049100198707894 0.43889138929685428403;-0.17870029315525501334 -0.23514637299127366665 -0.32419109082749175688 0.30717110092756289008 -0.15656515091264477935 -0.21861864628347968398 0.95248165239291260331 0.013851147532460040754 -0.17787266028958262365 0.56328677857563158593 0.047809621843973033883 -0.34072771304333027143 -0.25914337174196278024 -0.068444392583931812357 0.20425990018616324573 0.084545907768895256496 0.48352363075809978721 -0.13829441767126635088 -0.037125529557760862664 0.51932581672945643536 -0.2430766639833841225 -0.60604306385759620923 0.53677238255377701659 0.079414362519808184837 -0.017445636654696658474;0.49883967676237173094 -0.50601393001054806309 -0.75544582273217641966 0.75401282625240029223 0.42820118193662881634 -0.19365346517910306257 0.32051588204894987388 0.36574763186152114969 0.12309229694379004993 0.95732708456867654512 -0.0030573845121597094041 -0.0320354673967155959 1.0923490043268959671 0.093386205039874395362 0.24985629267500800155 -0.13171713536704601766 -0.42970571613445252002 0.84338108141098855342 0.1038793181510948016 0.60286303968217047622 0.39810807893645222544 -0.017759432453298900495 -0.78120106036364533875 -0.2223160173040920895 0.34702581542367322287;-0.61835657894043816185 0.47124458415400249933 0.88656334800181246791 0.74352131756824957343 -0.22296453784505970708 0.35151213009025272793 -0.15498362252233521819 -0.6239183864647572797 -0.019442459995771328718 0.48362976409025604241 -0.6518838146024307223 -0.43280815899112623502 -0.33657768023783019018 0.79197485691007174502 -0.064629891122090735167 -0.69321180754733058293 0.088686224410172750932 -0.95415900620229232576 -0.76182174332678753714 0.050777262466540087904 -0.025650730383608245921 -0.75990622791025796978 -0.44069617306881497809 0.50262488072480682177 -0.31883599780679772184;0.2557923943828123714 -0.49088137251959751417 -0.35096194428691745992 -1.0627796225833123778 0.4952680019321863969 -0.50275204433134745852 0.49771269429019032726 0.15169247864499180167 0.027322423867375440765 -0.20209545301465703382 -0.45251970404701868933 -0.43176504879336952136 0.14272625513613823589 0.18497610121686006157 -0.028866118699904588785 0.087821603736544462393 -0.39108110517230315617 -0.26167615052936454845 0.49124119151805012429 -0.48707127030477553875 0.26400377909248667896 -0.34476251834592425149 0.62439026248267659458 -0.66070032305204484668 -0.17733450341326367772;0.4713733820197685831 0.18811798405903457088 -0.6382086953322534395 -0.25075408887581718265 -0.50039157233905173783 -0.31273127271099365743 0.26866863167846521954 0.14979336945126470182 -0.4227969819949081165 0.09935874812700212777 -0.022892850066452061913 1.0441317665424807437 -0.70220473414001194357 0.28288654753362785232 -0.21204760616997059275 -0.22539341714729929644 0.67528624771583545261 0.23631166848517315415 -0.31315037416514629465 -0.12796852847012618604 0.17059276807677492549 -0.18962495158700781728 0.11795522709507394454 -0.95401213203032952936 0.32528737939951385405;-0.052035430945654471968 -0.5389331567675000878 0.13517817344403093571 -0.63693124128691536168 -0.29725952536406408111 0.14928015236953967593 0.025810971162882914015 -0.59265987676939857476 -0.59024343325540984395 0.18901377424710830155 0.40570752077822452852 0.12168401566335698694 0.3318838902832452753 0.2861638485796738629 -0.26226684187897758571 -0.31618571875938239479 0.49053074288140274817 0.28696546907450520836 -0.25043304461166898678 0.82414954175235688449 0.55618682387891238417 -0.31473532732611103624 -0.18530229656231458901 -0.50589954062756525843 0.12878777883314240782;0.18000103326748453925 -0.041814897516246431197 0.67163749211462175914 0.12884357498330162306 -0.46332707364103670189 0.42949286609844228302 0.21613207680097207275 -0.014939123559105737735 -0.094217737873715873276 -0.1333968782324985447 0.076939570749201824373 0.93500200601436633807 0.3860660220349189653 0.38987626628929905603 0.076353469093746878515 -0.21664604317078425821 -0.68528295739802447262 0.59334023101672961342 -0.13722339938910635415 0.4690448463287517078 -0.21490719091136764596 0.13856432574622376541 0.016875126969037305968 0.022644232535168559023 -0.44485224641069109897;0.55516436362074994548 -0.46069954732474877046 -0.4881374590662377333 -0.47279289791474538029 -0.083202419306061065063 0.50458913630424995223 -0.001373622596363040238 -0.34380840980911570037 -0.1865730915321086314 -0.49884525029231335802 0.36717834079961919613 -0.14578305338860950147 -0.098786198101581776387 0.16420078658323017384 0.077786728981774605485 0.38631692492165609076 0.13022023742290725346 -0.053562371654509430274 0.22820748311205102388 0.089454367017265057349 -0.54120871048047580754 -0.34895076399856772564 -0.45793688895730405575 -0.22689372814115527088 0.48300344014071028287;-1.2212666875703346303 0.15902614544921458983 0.70407471231363372155 -0.05781818612182867273 -0.3863513999243938235 -0.040337055469509865147 -0.35623642344621203604 -0.68693299078799829882 -0.034564451469825271945 1.2263634880366849345 0.37328142369330669093 0.20548884786820934001 -0.64409413234605727983 0.54396919047107605838 0.24247030784173284612 -0.40717834490084225951 -0.59098899850514208243 -0.71987910331152160648 -0.66542807260812841808 -0.093515323135124270304 -0.21272082367596606423 0.53124409656584092865 -0.0055903706373824123624 0.44162136206654462045 0.10288982794729668868;0.74598767258615739095 -0.35631056945785549717 0.054560772100606808044 0.36619453089283959812 -0.072959914958140609231 -0.31413877309517140857 -0.098861841238643458074 -0.34129205249971528158 -0.10091918412893781387 -0.48999794898250276232 0.062341683546899673285 -0.19311453198004871479 0.95379596577811365243 0.80013929571616115854 0.1740219438486486081 0.4093846872919003621 -0.38768237307179115314 -0.47833153504158737457 0.11328749311586312765 0.65794813206955016227 0.69123754013683658126 0.4706898879359928678 -0.58572610392828583503 -0.1495558508541673659 0.31223804461042176106;0.45909882895758713506 -0.58393057190302199988 -0.1963980756040440423 0.44431488054255946496 0.43894208828561837032 0.031799117076391839043 -0.72011770372908656679 0.41670893964335092852 0.52683698162660019815 -0.63156378158106096787 -0.17409119062536884681 -0.036097628162663215889 0.173446364743086473 0.56331630384139963486 -0.41589874282113836745 -0.33455016266357839871 0.20139848250238953642 -0.17850278227201421544 -0.29599082286606404057 -0.57754287489533639999 -0.019727635996733050572 -0.11430984005197496189 0.064369797059783309678 -0.19213252784641535187 0.47535353483054554324;0.15803391901158286847 0.088375612596399380494 0.49350532000238767072 -0.06840693280596465975 -0.10994136581180886936 0.27896765724515454332 -0.66500247422483649284 -0.074788070747173640562 0.42204189047180173944 0.10711747003477561924 0.64183035107442909517 -0.55216616547495467326 0.16430758901880673784 0.33375594437766592515 0.26544179416286284301 0.19216529084967787222 -0.16832338234231686291 0.67974466495475160954 -0.06462255605807924741 0.20419587337741587629 0.34104043861513144709 0.48148438009896588063 0.12782326094124910054 0.47155899214874374969 -0.18477008811983594572;0.3852237873526271339 0.23782961676885369662 -0.41168623012011568152 -0.14176973368698370104 0.0054372248544279910831 0.065006898238105473298 -0.24276793943433144785 0.12083790056242652011 -0.15616139993134928177 -0.17485668613586960451 -0.34517066629324516525 -0.6399579607464684905 -0.54906794942071412979 1.011072618034422721 -0.21133858295185597997 -0.054275506690636930729 0.30522194775946465128 0.37962656597619731658 0.1730367545759299297 0.38166146042956128337 0.8045118590408594228 -0.48943953452061539355 0.57546820430692002812 -0.45785821379864999336 0.34037559638695696895];

% Layer 3
b3 = -0.78519257340289005942;
LW3_2 = [-1.2344262124335518838 0.93855275729778364635 -0.72611278723517391764 -0.92884923039044509085 -1.6148191972754102341 0.2486987114136197663 -0.27217915787818613982 -0.3944168658529475513 0.74252062093132598086 -0.18228101549287495375 1.4275639614887609685 0.94966652105224447222 -0.86619101532699172008 -0.56767747782660182843 0.52893890388447939443];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
