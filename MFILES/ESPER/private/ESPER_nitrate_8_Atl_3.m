function [Y,Xf,Af] = ESPER_nitrate_8_Atl_3(X,~,~)
%ESPER_NITRATE_8_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_8_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.085941670213149024;0.73595731688810883675;-1.8011905890608927994;7.1548472327133945114;-1.4860369032902391861;-9.0979892325248510332;-0.71269198479993922657;-5.4241890765517020156;-0.8410579512884048814;4.3016569073322630246;-0.77447101956933361855;3.526906741496917963;0.74884941081789346828;-2.2328009570591005328;-1.4809460722495069174;-1.7232016070781188688;2.4084271640774836953;-4.7590022558213469495;12.222193562195670324;6.0762789423247944853;5.1160977395720284022;0.22558649282296050487;-3.8321221197235715294;-0.016730887001139740922;2.9296825350589115189];
IW1_1 = [-0.41944936518279779536 0.70295248836310042506 1.0516597695081850716 0.05693961379314021326 -5.6902180014746468473 1.6876071284844904596;0.52280983619475063229 0.10043233876049234565 -3.039111870401390636 0.84225929086286832614 -0.75671025574633998811 -0.20145906313646666508;2.4940753866809841632 -2.523812249775589045 -1.343358938128463631 -0.60360219085682764728 -3.7232265457324600355 -1.8024289348069437722;0.82949140160245071751 0.23140331604006461608 0.69947885168725920657 -1.2900107830690248356 -10.282312308436310389 -0.329629604004774035;1.1016180794565499923 0.31108191055130057778 1.8596663347179571701 0.62769038501672735908 -3.0151409369077906142 -2.4326263060392707693;2.7511792765637563818 -0.028648327664183736996 1.7315338094741197228 1.3413614669274169788 10.995183139491043534 -3.9289309525743711937;-0.38440953789157855658 0.50520278555510433893 -1.457877400018638081 -2.3877433055886481128 -1.7781175685552126353 0.11289566007122242564;2.6272240792186227765 -7.5912141987602588244 -0.30076752032803838466 -2.4966525502706407025 -7.2968911443200656919 -0.36556865657752019017;1.710044951168517624 -1.1115887657365537411 -0.11039243256189848474 0.37822938265775674083 1.3229173839327057483 0.93585265877485912522;-0.23666238669985881216 -4.5221803149342321149 -1.7566297532430414918 -1.9663478925199424641 -0.77506928886484272034 4.0951667602387793465;0.10065430508612273341 -1.189659271076108471 -1.7145135273875409254 0.15135881719508753607 -1.1640667348031963346 -0.7018364838419630658;-0.31248466891383669397 0.81706546306856409068 -1.3655634246801302556 -2.0065891133249285083 -2.4595140429391868508 3.9520488954181334229;-0.5020149736030250498 0.88476186296385506136 0.3817399207095202307 -0.26860556491451725858 -1.1229371724995027559 -0.62034861452673373261;-0.42057543519390699904 1.1225886928450721225 -1.7760823567732864081 1.4917115228658450743 8.772837797082685185 -0.52956288297756726191;-0.77108754160881309847 0.31833882989399003849 1.5141218165699275033 -0.50678376379883849356 2.1245782340019547796 0.09784604099907916186;0.35373477000665165537 0.77431990980815612602 4.4257033948175301674 -2.3234850036580243504 3.0678246270106517279 -0.81905826968538797406;1.2826111259850410118 -0.79227500367696512829 -0.028610560444581430856 0.0031022717641963843196 -1.6882418666165877053 0.69332372691267296627;0.38316051563842895566 -1.0203539855928855928 -1.4050955555507791406 0.43201788857780337727 1.2329244041300422285 -2.6246083578419443505;0.16965591460022341752 -0.44914164735090933434 -1.1360932201718854095 17.779654754421756024 6.5590342849569696071 -3.0027699367006728259;0.63949657390760472619 0.12950028385250167418 -3.9537929893508572121 0.14851855253347689967 -4.7474477616996946239 0.42418933491452603946;1.9129662127010929051 0.55478960411313105183 -1.4001791555355678209 0.15484124977346627738 -4.0255362934951852694 2.3897611756549537176;-0.56824450017701644278 0.55614190785696959729 0.27775295401710120569 -0.033075372327748528423 -1.4700011957598844159 0.043229573488215003452;-0.66336377643814581351 0.95211965630322548115 -1.4675371800663727928 -1.5688855048159802141 3.2176158162250434458 -0.0018147155524474148022;-1.3296298336176723964 -0.22409218352765900018 -0.064744196212818627689 -0.14534179016970777409 -1.9719131003472090136 -0.41691614855086106539;0.91417880030567044702 0.88847596610032475439 1.3327248799681066238 -0.73139376355097751592 -3.9523213705935091866 0.7665373797697451197];

% Layer 2
b2 = [-1.4625695514748648929;5.1531585638113952541;4.0163728015201112242;-1.1801701822867756153;4.2505064355219959182;-9.3926464258898700876;0.6532100558016754599;6.3638286961340941872;-5.200248287289466198;0.7480151310146270216;-5.9810857141447710816;5.1734783753485205082;-11.6078165551676733;-1.3757320300446789219;7.123390298716271829];
LW2_1 = [-1.7953927874524500119 -0.25551881880452004259 1.3939779659381834609 -1.6368882928806742783 -1.7196476958893140985 -0.55826322099919578612 5.6551387689901320144 -1.5416316969870262898 6.1733698713454812079 0.13324597432122162188 -1.1438918797024160146 -0.90905106211200348287 7.4640165963856226483 -0.35850767903694064076 -2.2314984489171512116 2.7561481265877199043 4.3374241296152469261 2.7767514914124538095 -0.9257023978586216284 -1.1340317465699463195 -3.1728171278476726691 3.5709274453014545614 -4.7948939241887789109 -5.3907438957291278214 -0.98227322945033546109;1.8936928459264414926 -1.8022937816386082055 0.57270882535333778041 -1.63656816068961386 -2.7714192703874647172 0.1676916011962657771 -1.0388214958393866549 0.072245967011939124514 -4.9226068202866803958 0.83842486779300484656 2.3708704054177243137 -0.24985997564742995491 2.8372668536859948496 2.7810613593904980334 -0.3701429587600474358 -0.58756609319005048686 1.7369083660444040174 1.5276710841353298154 0.59989947550680755572 -4.3336294418015004482 2.6872247370810122824 15.419070388980962605 -1.8468051939599745559 -10.888439757571784838 1.2727860307220177916;-0.73390405603245256749 -3.1080834712234146622 -0.56299848085772941086 -0.89927229215955351016 0.57343103164064357369 -0.66696502101585009026 1.2062502008332054437 -0.056706245044706310443 -1.540149459177693414 0.82370136504070912142 -1.1496462659486863522 0.5852266600948163866 -0.46489242602311536823 -1.028592041758783715 -2.0152147833114191222 -1.1761686618601805421 -2.7616834100079370451 2.2620274230612640309 0.54113944727520635336 -0.52947997513139599679 -0.90401177498899931706 2.8387581017149967622 -0.72371511826113732457 -4.6429423012829209583 0.49698713030013513814;-4.8916816970955290245 -4.741375344426158378 0.20285093222790939738 -0.99397813801778023279 1.0368727751645614443 -1.9676267232410364905 3.3778486636589026837 -1.4058884620130414067 4.1822086374617990501 0.9846301305494942202 -1.9993559449092115354 0.72625810897105436137 7.3318817281705204181 -1.1234041317822760497 -3.4164232830607175195 -1.0882932665296336516 -6.715041734464490375 -3.9897193125304157846 0.3244438353160916666 -1.3871736763130724235 0.0038780354889375104332 -6.203423244799685321 -4.0735134072002097128 1.8915716026959337182 -0.64966349784401256073;-0.47762192805859893241 0.53473098689209419554 0.45909886712601238878 -0.35879035872618125769 -2.3289948212983446751 -0.50689666998483295934 1.002294139803544315 -0.24205960613322938246 -0.61364697216210795094 -0.47050737006487003411 4.5332399031560948188 -0.91296000838476021322 -0.34743878871024069799 0.26425959836920753787 -3.4190262051100082097 4.3232924671491588242 -1.3471965543193846759 0.8726893537873748885 0.061273341385291356376 -2.2331376145067114436 1.0860434415507884687 -1.2969501072304470135 -0.19778150001536459746 -0.89678377397353692402 -1.5625683386323627744;3.9236930519906105808 6.2256721380680470901 1.6385335205180253659 1.4873833458269014596 -0.8730240184968035555 1.6890746869271573427 4.4050749115055074512 0.81457077040277869884 1.9478580640522547007 -1.058843440461487706 -6.3398061111666859091 0.023655681750139177788 -2.0558614291864207857 5.1781559743748575286 7.3085089839997054995 1.986891457733699351 6.1557905676045638899 7.7313339430548104758 1.8556325832571400891 -2.0923702963680828049 3.3305589571374580871 -8.1152859096841591935 -2.5425587600847960879 11.333554283066915147 -1.921918993473694437;-3.3912065058175371313 -1.1450568391805691082 2.6369276206575653632 0.23076680054764692196 -0.24162240661544012732 0.46789924218937128941 8.0773960760068721498 0.16950612092191041924 -1.0076742789659796085 -1.1944660065236021307 -4.9512365999047576182 -7.283445391919790346 -7.0838017634298227065 1.5566772502008476842 -1.6514676269270998077 -1.0535811095153486683 0.80286628049421526754 -2.137555304405301726 -1.5571433396872580435 -1.9701495363350627343 -1.4954660983231713445 1.7535981238209292776 0.38770218464828826166 1.268363312448604896 -0.63923389621052473242;3.2731977860165790695 2.2097604229378990937 -0.16288433071638208638 -1.6968884761383573601 1.561171260554469864 0.18319182719345750154 -0.29590818430191923039 -0.22040074791457547887 7.6744217518366282249 0.62628878048106495502 4.8602859476766289148 2.2730456499247129187 8.3419300722940850079 2.0064490878125709195 3.223617833942526989 2.0570966875291381015 6.0037121283510677117 9.3979276554917348108 1.4504976151872837065 5.0955789481080566716 -6.4307986710032345457 3.716968400232761649 -1.3376390198581791235 2.7164367098399893052 2.0140887537448581845;3.3076527839806675324 0.91741595017718025051 0.17630696162883521816 0.40144607555297534551 0.8809693059230797596 -0.16602470707067196187 1.2642089834819112415 -0.39492882660086547908 0.24879467395774060301 -0.068627152997004517432 1.9628486052455555999 -0.062773432214499241821 0.87408845911398058703 1.47158610668295875 0.86666272642818908967 0.24528562795530409191 -6.6510551491214471298 1.3822821530845323945 0.29891141272647386851 0.75196302940059966957 0.31161424234143447753 -10.197154376359547356 -0.84563976760018944034 -0.65884245039873889915 -0.03601463127457860125;-2.1124599664683221256 -2.0093143874572629848 -1.922724878047186392 -0.80696839468887382463 -1.4606000886780081682 -0.48197261407442615333 2.4682617466673910656 0.41665251490277666058 -3.3781215864005851301 1.2683780320508213357 0.56727195165459431969 -0.87776197189065718884 0.25881341606692348511 0.25399743827910725713 -3.5370035333049352211 1.0436837423552633997 2.3703383241198250353 0.3440716291198582244 0.85626818152821670971 0.11598066116323055286 0.11155957282767672845 1.4604990783635021234 -1.5527064585575143241 -0.075892055766672086858 0.47139719766351639851;-5.4494617017031723449 -10.364174936246586256 0.27745043119100631923 -1.183587193925687675 -0.69568985736292932032 -0.51131296864178721329 -4.8304604573137908119 4.4201054264222285894 0.89908624158974015383 -0.87813179277511621557 -0.45121007767668869226 -0.97227473323691271379 -1.4997182981645829081 6.4547835234682571226 -7.9897741635886614375 -2.1105321103033580776 3.1970938846889773721 -6.4431371840990436795 0.051061985339593038424 -8.0251361597342718568 2.2554791159016147617 3.7976643662979534533 0.3277705186603097065 0.18217196809995148121 -3.2382979149438693156;-3.1003766760395214952 0.86231442702294458513 0.029319086452911206214 0.23544583655280512668 -1.8551198466830938205 0.084910805399006222816 -0.86727014329621820998 0.033291473483485198304 0.15725318781520786215 -1.2701135589922047942 -1.2803503910564686397 -1.0915100527957417587 0.74335420056864243143 -1.3668104050659408699 0.02823704814707729549 0.73669786003507864436 2.4132680176983223319 -1.3861847097939878903 -0.76928949129022150544 0.27462611878459014525 -0.86278687280623855838 5.8293419907382366674 0.058474385046913227026 -1.1682348309038670386 -0.57779286935231133349;-0.61899877737275454948 -0.7958404989691082454 -0.24613528425098585295 0.22975224043922876094 -1.5245799364501750883 -0.39630013593265722704 -0.42204483133427517227 0.27977901155716661252 4.1677258829235315218 0.32352533063409005809 -2.6688699056834068735 0.071971273970891078142 5.9705329846419168405 0.96792098339249832417 -2.7610635825366198759 0.16082312503824452987 5.815561224257973727 1.0828936372150845813 0.27778214356540564811 0.33703302324219175379 -1.0943183934939648694 -8.3130772857972381473 0.01106798570984611485 5.2559375680594051516 -1.458043215433225015;-0.0070072063985782903628 1.6698837457787123473 -0.39560777654710882478 0.3280815343769458714 1.3402531357673277412 -0.40961119903755444094 0.68349386291619562694 -0.00056911462110233136322 0.87222416804839186799 0.078203076221408374114 -0.64676532605839243129 0.49259859748631529275 1.7297549719544513813 -0.49426542180506632951 0.28027405661349696908 1.1747542754516995256 -4.8989368233224404037 1.8336050174986338046 -0.16515456009802462201 0.83146512637935765522 -0.75789347676772989004 -6.7611644411553104561 -0.95179510766544817013 -0.66320607417958210572 -0.78136549319480208542;-0.83251480275279599041 2.6014674823310683927 1.8016411982739009012 5.2027392673313910265 5.0651450717378079247 1.5892293348784212181 1.417171647260715428 -0.42055024735980683914 -2.6466044841741731553 1.5492624564799728493 -4.3641924810840411197 0.59785071805226719377 -6.5076401316553802445 -1.1814266660948538057 6.8508844724806099435 -0.55994633187567333099 -11.077653672297898879 -8.2768196517772860688 0.70040985580567782787 0.52685854306623292054 3.1551644831964327231 7.4155295580632749619 1.3103182134836155459 -0.21356925637953175223 -4.3647297333458237034];

% Layer 3
b3 = -1.2249499588575996079;
LW3_2 = [-0.20504781706837493793 -0.25846397922023706117 0.65467924050033021732 -0.23554136959012386687 0.25951335045781592781 0.14379699040700139046 -0.20870255290378653124 0.28433903186787490291 1.2532548510246697138 -0.43891401827556320026 0.053796941366489596514 1.216484408973039999 0.61391563178670782719 -1.1899310938353626632 0.15005000629534512302];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
