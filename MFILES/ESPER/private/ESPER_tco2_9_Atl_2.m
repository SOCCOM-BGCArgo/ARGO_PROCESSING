function [Y,Xf,Af] = ESPER_tco2_9_Atl_2(X,~,~)
%ESPER_TCO2_9_ATL_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:56.
% 
% [Y] = ESPER_tco2_9_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9355470951092237;-1.4009039729228625;-5.7644390654297046;2.9832035521166564;-3.1238072673893167;-0.35198347670837232;-0.59243071387010471;-0.22144495561486388;1.6137224381921815;-0.79016907281398985;-1.5171166214910368;1.3983320394887839;-0.29016288344966024;1.8433058841614662;0.16716373892374381;1.8145679958903627;-4.9006706352688605;0.77788589567084643;-2.9672889310731523;1.265080223868112];
IW1_1 = [-0.97118408437780002 -0.34507202625690303 -0.4276256043528181 0.35979947795239076 0.21140830940102032 2.5378479459444949 -1.4814210300153907 -1.1023134252181666;-0.13987470569707175 1.2414316429645398 -0.34107716418071732 0.58063931940484403 3.7117093928529798 0.7548531312770802 0.07486408193605007 -0.51264872787573201;0.42510748469722059 0.9326905404893705 -1.2626621615348295 0.46873920894528665 8.5817759073100639 -0.58764560854311565 -1.5838719932982033 1.1133896904564076;-1.0081148564878248 -1.086663869812893 0.6650837841522026 -0.81288214055933028 -1.6878323327488611 0.40350034548574809 1.6940992512823918 1.9917762315159468;0.97274962605781312 -0.87255513540436036 0.40400865414245724 0.11414969102738727 -2.1078113899601729 1.2266960164982263 -1.029953837334997 1.9823710449051128;-0.049293076921969402 0.0227663394684007 -0.78327179957680482 -0.15341341191989558 -0.26458292313014709 -0.28525957255534812 -0.70137887826681589 0.2984902045087629;0.77793036457352449 1.2805353579072409 0.41427735327805759 0.3490481362892488 -0.86079950569701902 -0.12863864554766871 1.9672851086481769 -0.83246448551753993;-0.84832900424007962 -1.0802350030758263 -0.6896611221861545 -0.70296683025583218 2.1926893342822997 -0.64068258713139581 -1.153801402199262 1.2322314823747444;1.2712335110804041 0.43934399912917671 -0.045446708289475335 0.73536661376655543 -3.1541661630062436 -0.5334205542799475 0.015617644883804597 0.33978034003963115;0.99575507838745181 -0.40102873822930185 -0.032422912157646852 -0.16940777840982274 0.66106994943534203 -0.19412084982497527 -0.35686524735829517 0.33519877599166248;-1.1787413196734862 0.040536935850228037 -0.15865716802093183 -1.8995154909619678 -1.6492736217158017 0.24701194143341829 0.19199501145651357 -1.1413585058783997;-0.39688110509516428 -0.63687801475384398 -1.2826649007831434 -1.1975947484759386 -3.6660932110804723 -0.16133875461087455 0.97843527443292932 1.0027565052688499;0.5112542551365965 2.045762751328426 0.37816709245498159 0.038313207754433871 4.3527816594338313 1.3335027430595618 -2.4073007468019418 0.4222617974864098;-1.0479185921807757 0.8204322335285511 -0.12294335026212813 -0.12242964197399234 0.29396629028321625 -0.69262992385069577 -1.1470282961609626 -2.4843360126829359;-0.62858918645504835 -1.2735699033007737 0.22484113693018262 -0.052445975543948073 -3.7022138252072625 -0.38069116120581509 -0.32022572120142062 -0.79604354607836314;0.76197288047705913 0.55614603882160651 2.0367472931014703 0.94667851605007203 -0.42187556464156017 -0.27417890416075819 -1.5319817985265178 -0.11096025522401987;-2.2924166400562309 -3.0501689539684191 -1.9672397708753071 -0.32700037135048349 5.8375369603739529 0.11788295896988246 -0.3051678701324218 -0.56687723322527772;0.034595406735543545 1.8398053879640699 0.65966928973875982 0.37716463882144996 1.2176093656452445 -1.3625034275853991 2.7621402190536983 0.39559655225509505;1.0545190522702235 1.8670606130510905 1.8607953113024556 0.04298819866782317 3.1224795645509213 0.48994459809991198 -0.52940892877677981 -0.46205028228174738;-0.50187794537243724 3.5317873778686319 2.0102827561111698 -1.1986097008000169 -1.9785465375748486 -2.0723766231820213 1.2026682318488622 -0.29906165547333491];

% Layer 2
b2 = [-3.6340798964676058;-1.9557489263225163;-1.7273856499168421;-0.23944695351680026;-1.5853337075551517;1.1088854325513064;0.29106402714693491;1.8058899171239027;-0.14269352874077207;0.44370226900594334;1.1779577601705973;0.32320819309968651;0.22478059552836652;-1.457024546004313;0.41420059124736802;-1.0736976960381945;-1.0645882842149184;0.42201376919644279;-1.0210133026930301;2.2924893180513068];
LW2_1 = [-0.61053654677622382 -1.322570901953982 -1.5307376709997635 -2.5437997646609576 -1.9347606402970028 0.41584241118822979 -0.31128512205076408 0.095676937800737757 -2.606208552449873 0.60726406143965372 -0.43938069371769289 -1.3129105938941912 -0.11314187839483623 0.70814028923629257 -0.075801098459465699 -0.46795314814648048 -0.37672798873661939 1.0342224434743599 0.046420350748907491 1.1173849389574908;-1.4994613327883097 1.6805593839576189 -0.02144297077012745 0.43556591736093569 -0.37423309786668929 1.7407136138756458 0.91624166460247347 0.19254691717170694 -0.58684547645002039 0.77840676640599571 -1.5694445793570135 0.36877506683603789 -0.54834918693641854 -0.28549504863530573 -0.78716980100481615 1.3883326734429693 0.52999954332143773 0.5219316942437372 1.3964853160512849 -1.7882208825093142;-1.6792068162219151 -1.4160488044002766 -0.63377236946153781 0.53852481385272133 -0.5578495305304001 2.1335125292819654 1.4344417402359129 0.63254759496869906 -0.88445136541528468 0.8535508712164851 -0.032348648734298442 1.6320794279331405 0.24487572586529233 -0.69742632946500582 -1.1207577191980804 2.7165288664382339 -2.4551066778458233 -0.10559585636926057 1.8562179424092486 0.00042127236774389468;1.0597980211121767 1.7967447868935127 1.3909005720696992 -0.84897390754838131 -0.67803036649490678 -0.23204179921169996 -1.3711738824124517 -0.67484507836825813 -2.4872869858115338 -3.363665596852099 -1.9706326984725593 1.137246152508713 -1.2815247546885149 -0.32563960946035392 -0.64143602628518948 1.0305080285402581 0.79424676994545429 -0.60700997742781748 1.1997502282190464 0.28445436267760627;0.17913196487427885 2.0080318248838789 2.2157293299449399 -0.61269375716819707 0.27140413871528363 -0.23908810037374384 1.4913667543061366 -0.50328809369594452 0.86162135627948355 -1.0497519970906739 0.58022461163322958 0.56867569189375033 4.8249667765143061 -0.94592909501503375 -1.1641623366166389 -1.2714365334685969 0.70488162356903339 -1.4153107310817563 0.67431892138010807 1.3948217717095657;0.5528489357934937 0.6505555716698832 1.9263744930810933 0.80611116645846526 -0.95181468434993 -3.414531693298493 -2.4631261560285753 0.61999386088944108 -1.9660578746168564 0.18896565841868215 1.1520916254210534 1.8316760269636392 -2.3267071351533359 -0.58168974011362429 2.1955091784341638 0.97340041022246726 -0.56389117199547389 1.2657839073206134 1.4199412852270055 2.1743755417089079;-2.0869622260595722 -0.90974309278547016 1.4440315258382423 0.82539012404351553 -2.7075043399394709 -1.8883341965777729 2.2836172979678113 1.8606914435217781 0.36319055162147285 0.052355145521179973 -0.47170230336931462 -1.8274860368239843 -0.89490879607167784 -0.54766845925525598 -0.63686672517546417 -2.0910428459059966 -0.77579198292840079 -1.0503702218772848 0.87826572933456859 0.27323129907594335;3.7350277018137796 -1.090675724586049 -3.1153398323757662 0.57746987793998195 -1.4681332641881473 5.2701646774274149 -2.1987540626393587 0.85630050965854532 4.1950903495036078 1.6212276610147189 -0.67894688276803905 2.4421678347893914 -0.54896410005148022 0.92028977167699022 1.2674097650645593 3.1067784973903461 -2.5038416117375322 -5.2689629921375714 -2.3546381651691908 5.7772607955635973;-0.32014709935398722 0.67294444324575797 -1.8789641395364545 -0.081300199924973962 -2.4722742544465044 2.3417737429059975 1.8860109870832376 0.84174488722926522 1.2179036958726239 -1.5059542132521127 -0.97599272933930614 1.4642860335048902 0.76497930625133526 0.30004271777235603 2.3661879283559868 1.8107729683266143 1.760038535587745 0.10494966571099154 0.83856541438640775 -1.2983422685197248;-2.337176477793629 0.69373131518319908 2.7609772983677168 0.65448584358677819 -0.19921250429108139 -3.8899500845763435 0.27821876167956505 -0.70495490743452449 -2.7711073515997007 1.2023271579747887 0.80899854496564516 -0.72938365461102128 -0.84644757370383794 -1.0076864886549937 -2.3808761382409553 -1.1958833420076791 -1.2915082898744761 -2.2058414511532787 -1.0219103668928453 -0.14167801212457093;0.42817686746998407 -0.86162485316095427 -1.8550929310811368 -0.83570858472267773 -0.71784382577819095 1.1991746716325795 1.3964488819172427 1.8952601515217129 3.0157808739727385 -1.0460017393488688 1.1207152685996244 0.67410587347195539 1.0743164622951753 0.59070876042973475 -0.89778270402391058 1.2858236597748371 0.32013198428331047 -0.25463593981381483 0.11997500090433501 0.27248728947397494;0.84635839684447933 -1.6951990429505299 -1.4587793683925305 0.70324669218657532 -0.19920482467335013 1.9526201101653939 1.9504399690284706 0.89795116652125662 2.460237302694571 -2.1415423428481537 0.66349210746765463 -0.81771759926624499 1.8486460459139931 -0.34583972387358908 -0.36777919022369782 -1.0171328679794622 0.76342152525341145 -0.40344025773405479 0.10187948692338035 -1.2128750322494288;2.8259576432951943 1.3524648635824232 -4.1241968577672248 -1.8244280004819977 0.058059517218699383 4.0459053495188559 -0.27648358731398087 -0.64156661585000641 0.95284515240630097 -2.8011756771428269 -1.0186159211131156 -0.1364770487159494 2.0191126778789985 0.92802997772476081 0.15503930089561155 0.21957853496527632 1.1682335441628924 0.8382042099322351 -1.2163679156635607 2.6425962023041434;0.72476292994431857 0.15729818838175513 1.0004903794952575 1.1117974247894422 -1.5549345978809126 -0.35413238546785625 1.7834159591678647 0.79414340401893213 0.13265799306358639 0.0088980209039643161 -0.58873966119575227 -2.929142146070125 -0.25402627918761672 -0.37965186388420447 0.41093779112993428 -2.4695009661413532 0.31800532217272137 -0.3393606934437241 -0.75691042634092587 0.6626952402268278;5.426096034511354 0.84886593637079144 -0.38324096847055183 -4.1053018316926551 -1.5376840303478727 2.906052943634339 2.868893214763085 0.70807535106751252 -1.9688209119218258 -1.2785372152422105 1.74642448317498 1.6888814198917255 -1.7142031242167126 0.12959284130920246 -0.40829082396119687 1.9488738600198812 0.63435798964039236 0.52537321625851208 0.12250585849091349 2.2016000953333914;-0.62443309849503592 0.1301728318296522 -0.26989990457524921 -0.17089400751455133 0.35138246142318563 0.585520672141013 -0.78555350142937819 -0.99994208155164299 -0.39754336383710748 0.83542983588672193 0.96580315126423089 0.22489344310700718 0.17032973941745463 0.023620214368255288 0.098888531867781779 0.53545357385398362 -0.18321082661138802 0.1064746608671778 -0.14819745317506694 -0.25466663554873797;1.2554571535566807 0.081434396596250749 0.43496784175311942 -0.58035353283714697 -0.28025425450545111 2.3693125070201777 -1.3110645628101401 0.72300020052187264 -1.6747490389978412 -0.09910604045951954 1.0534489052951022 0.46965778405132563 0.170688816179693 -0.10698273164323156 0.13460056444135512 0.22111871551694451 -1.3554848970658424 0.012365912750186024 0.24155002598429329 -0.32026821310707887;3.781518940214283 1.552181594889422 0.16217435855556617 -0.23348996750647219 0.67760477312912104 -2.5947646142786973 0.099042254077734398 -0.30612112966210969 -1.0558743707370652 1.4786643643620301 -2.6803898738228034 0.74538472956227697 0.43906209086615072 -2.0067424276531871 1.3848487983462552 -1.8832673921311347 0.18809332547874522 0.79433265697670519 0.74913028504322465 0.64982535895886562;-0.068324901694064202 -0.99431379600937875 1.7074512053754118 0.81361630655898909 -1.1003415530135503 0.33560162831439894 -2.6205564413906335 -0.19067142907432935 1.2050024836922177 -0.99823974525554371 0.65713151800896474 -0.0029617809477980616 -0.5021762527091046 0.97990109581041696 1.3885943350634677 3.6167909056170067 -0.13725428496107675 -0.25055702963837578 -0.16666578958170575 -0.14436871692651762;0.65356945138643419 3.1019731940822575 0.43463404491102553 -2.2665396099166681 -0.36239061538272405 1.1874612293381521 -1.7046112469717785 2.0857209975270288 -1.725743299741582 -0.23898210120357058 -0.75370256111838763 1.7356337395276056 -0.12919521805820722 0.91531184335658378 0.12147269787615124 -0.55363091310114465 -2.111343356325043 -2.2761715777665454 -0.23453690434203023 2.6161869520456724];

% Layer 3
b3 = -2.2724868489019125;
LW3_2 = [0.035272101354778124 0.066392840601559658 0.007447036556948233 -0.025213759553888139 0.010508449506515968 0.0092660517672714868 -0.062221281335166197 0.0013769771935342174 -0.038148662459198485 0.048656187774870754 -0.058656351871764482 0.046560193074031281 0.018244775509412118 -0.06490391361252601 0.0087391993240853848 -3.2117717886289676 -0.030335529148704018 -0.032496154559619496 0.0014816350966890012 -0.0090287578151160893];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
