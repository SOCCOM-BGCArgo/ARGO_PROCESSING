function [Y,Xf,Af] = ESPER_TA_2_Atl_1(X,~,~)
%ESPER_TA_2_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:00.
% 
% [Y] = ESPER_TA_2_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7876102190579019613;3.5794542091783747573;1.3577178353665020349;-1.3034999362878607609;2.3296458272713485016;-2.8430783545925901734;-0.82705161288631523497;-2.9419507450775537194;1.6928922485388311348;-2.4981497491607163042;-3.602116537571690813;2.6010096391278425543;1.2373440213751016881;0.085879839444977124074;0.46014045139120035577;0.50391942605203132732;-1.7270368913198728134;0.58505368236618737754;-0.41658556663274587395;-0.22359072166173946106;-0.70303883368045805291;-0.19010994006727754968;-0.8211412128393702492;-1.3908247745005553053;0.22648656523699825516;0.73876616499245284508;-0.27633859698616336509;-1.4176652080015750279;-0.65740345749546658105;-0.00043793031616070200555;1.3228126688535477573;-0.058399855336346256918;1.4793361009984611343;2.5652157701119273625;3.8078822513440648834;2.4031097781846160188;-1.5164195950380356948;2.0411585000474237184;2.780456711777821166;-1.6188217415438868052];
IW1_1 = [0.82116976729598256668 -0.30925645249329769548 -1.8076147168410905408 0.7793188215578592537 -0.33067701054941101013 -1.852112029904515067 0.22749493112241214732 -0.88332638495392012956;-2.7841316256759380821 -3.1999122839618836522 -0.85115174426149109443 -0.44839261537083552334 2.3841642868805767996 -2.8211918222897685027 0.53334352205673329905 0.36877120008855923672;-1.2174858104887080756 0.16009794339924335316 -0.14560724025618540511 -0.41073422123826353047 1.6387763207226015982 0.10850991718549617138 -0.23630381448485537899 -0.34146143581329335692;0.49645852251402189381 -1.4987145711904852341 1.6947191859692662952 0.072142680733605982213 -0.90694680527832316486 0.35151777112648391332 1.1534452205924896617 0.090100583058261837777;-0.35274616899894506439 -1.3525910517954384815 0.59396100884195457414 -0.26049206692584586653 1.0741267113505570396 0.56139875473434863729 0.48409485488052766966 -1.3134166856001068258;-0.10654496031181399929 -0.065681525111618704882 0.046582569531069227542 0.37410031273871574564 -0.072785859749627243587 -3.0478081705609896268 0.30160679138130241927 0.42423003569698408688;0.70011388488425263521 0.44949103951841701265 -0.066641889256440364764 -0.52317105087715509715 1.4580536643690191756 -1.8989806352398024281 -1.0343322133051799927 0.80569829792359992648;-0.10316348667210600842 1.4444570457396459506 -1.0395983275579780969 0.96373632546741083704 -0.98502707453109661362 0.65784478810212965172 0.59916735053814829115 2.2114612763915983962;-2.4940772507790915924 0.55773093684938079839 3.1823711562936307651 0.63416407107430272649 -0.040262790051443064776 -1.2498069621990020028 -0.58155232818482172075 -0.93804458266347723328;-0.37489684465653172474 0.82689322720786051502 0.25907598684664784328 0.06197910229448650582 -0.34688325226136812462 -1.0354202362248063896 -1.9017948765481820228 -1.8660493876522199486;0.014816249169964929369 -0.20219152796985173648 -0.20631985977175751334 -0.26092324788834697635 2.0617445670905176769 -2.6191820745143856719 -0.19424255578084498319 -0.41953093159420545843;-3.1762534531250641301 -2.3139686219092792108 -1.1213928299903341834 -0.71396768587008851981 2.553119444399638116 -3.1190693139443905757 0.69995474166883075995 -1.192717305856056953;-0.011789890056655691342 0.38875428792395816391 -0.056696147309911973378 0.22026264840453674276 0.87619894136113374294 2.0755030564110872326 -0.22456236473132934472 0.19511521017162164471;0.50332608791916300106 0.0074384981301399092507 0.55770546755798744432 -0.45986290742114360741 -2.4714744065048930288 -0.48904259634870100859 0.37886510365662273703 -0.39442908355804590093;-2.6652149612046773797 -0.3789797332880057712 0.40826551545914907537 -0.46259776434164379122 -1.3028957646499141898 0.018915366500166397312 0.20698431381767756765 0.57098782500019285013;0.7176634228373781621 1.753656465470358361 -1.0556139247808589143 1.057112978508916834 0.4689812496761017746 1.2137679816977060554 0.808627693013120874 0.081273657362043352781;-0.15551270770234024154 -0.037514019026618133923 0.052632026282125994598 0.43849741020405652581 -1.3096150523987055703 -2.7822612807228304099 0.53312617169501319569 0.53923047162962078893;-0.093535355047907636772 2.3435755760669669812 0.32072767147654451803 0.043707775723639645526 -1.417547116312040556 -1.1661208865839092219 -0.75831681816715412747 0.49828086458982584483;-2.4189277885447051375 -0.43571363069009649838 0.36200731578570938263 -0.48205254666341490477 -0.67293611362447336433 -0.28240297147737891681 0.071865738347880445125 0.29464516856920092147;0.17211458140886329304 -1.4562488843804468619 -0.41224599093114044912 -0.30570006502474167398 1.5618900013175678332 1.3256905328096637575 0.20121103646521421027 0.12350293858633565325;0.24411532498107901823 -0.16439162015169497821 0.80787002432611398905 -1.4735398461142403814 -0.17269566069299902011 -0.22486054062794386121 -0.038760478985438773236 1.4129090218695830039;-0.60468867990606467444 0.41279360535991721504 -0.25196222917468497071 0.053658524100526017175 0.32245404574990715885 -0.074237858340079856956 0.57420160906371708887 0.77941485049158942822;-0.19355053950220602044 0.14376081647566629762 -0.087422474660640001054 0.20511011811173829322 0.89821984611709082547 0.3595366356368541183 0.34744206075708949921 0.10504202230090323167;0.062058129441011862515 -0.76490649380156672255 0.93589995174403051159 -0.068681924532641977499 1.1582510594369825885 0.66334325455190057408 0.99061002143399146114 0.97364362589069830545;0.43366671028641712304 -0.15720234687068015966 0.071010736389534964697 -0.071872054158310230698 1.0278882587188395981 0.89280281566224739542 -0.72201992549925608778 -0.66595862920784942851;0.75785603789664279795 -1.124243445701073707 -2.5292068495632227254 0.54365403717161253638 0.68626899084634107595 1.3371698032720904514 0.32244899632645462884 0.85057395886286013553;-1.2253481559736403295 -1.2629474879913700214 0.4056807471651217023 1.3609082695476142355 -1.4284021522137269056 -0.43595545601267099434 -0.59035583855269269105 0.052440694837265836026;-1.2393778774627324246 0.99095449283435121934 -0.50556510752321259794 0.59531248530800207064 2.3618401151063004306 1.6813628306185190997 0.98609416765024004992 0.039826942549853736053;-0.77654472294376875041 -0.98522143992730892847 0.11937451378747904185 -3.2715684949344296939 0.48438842781758573164 0.82120538952512311948 -0.44026135734680965639 -0.8373309231694424648;-0.4040574356677207879 0.066620994772211603041 -0.18969073572326136667 0.33436281406158685492 3.0198720351257501981 0.8448126297418785402 -0.39860478570423307776 0.7858309386481121539;-0.80053738488339787338 -0.31345729804555094722 0.21378114972719805542 -0.84071170192954969291 0.41568398069117101779 -0.68025755370591378668 -0.48035016830908605634 -1.0073936521074322581;0.72278075105077266294 0.83750099671852029637 0.69351290848775315467 0.51919320077488506637 -0.40836202198100463034 -0.16545340655347109959 -1.2267612622498009767 -0.67175803579834014734;0.35653198328075441648 -0.045767087549942409019 0.91208204363772937828 -0.58970105983870191313 0.60998611570975747043 -0.38742756344458101347 0.7976076319217616506 0.53088528753432095986;0.50027373528889840237 0.13512832084011291989 -0.02146346334325493696 0.31126378728644971128 -0.027159337406172989748 2.6556173385437809031 -0.99561118456525232734 -0.25449510242862499743;-2.3982828374969424878 -3.6545317387764360006 0.02102212557308249033 -0.22774765170951882798 -0.28979149988174290886 -2.5011545976536746494 -0.045520810975334662085 -0.78244448808400801632;0.91679402578472035668 -0.93424387499593053441 0.50478036777719925698 -1.7557329827484038365 -0.70117781079843977121 1.1579041801846485793 -0.13303313869690544524 0.9818687229736373645;0.079044147755100907515 -0.10053058163151319671 -0.6832703664998430737 1.8852147932932528107 0.47959057818307054832 0.10229171152017479951 1.0984239454637350075 -2.07087767469064854;-0.023940495353985329768 -0.41233952945272017709 0.38049970285952261495 1.1300784921428848051 0.82096088778839071409 -0.22930482792107922951 -1.4891278315088642969 -0.88373157355050713235;3.0206185772966880343 -1.8754601704480018398 1.1800723305873117575 0.62834527614615232061 1.9531261368916181809 -1.5198068886071334216 1.3615230007268852574 -1.3400859325474467898;-2.3100805994562758627 -0.56043650465554006868 0.34312531036012422492 -0.5352756457960917702 0.16084510449850569769 -0.67763647110323477207 -0.12054257827247907842 -0.060697435498289868672];

% Layer 2
b2 = 0.25885598290496653062;
LW2_1 = [-0.040775362313012777915 -2.1461568293854673684 -0.67008925135956298735 0.14569947997829521547 0.13556831302623892355 1.1485311095564700867 0.11761001060061462842 -0.12906148867619829379 0.0099181984454289225106 0.046043099676113620478 0.32937748289277690716 1.4502149927881768932 0.43249898727719210401 -0.5361200779182930809 -0.92163079579447748646 -0.054705133137513232977 -1.2442594037593752709 0.10451092605448991657 1.8126234228245514668 0.20168647242706638778 0.17849049255102580891 -1.2051550819882914656 1.9722241684083494651 -0.29742495771213378619 -1.8403024208786831206 -0.030405217623759171058 -0.031420282014159681139 -0.26659233346449928703 0.0042480053556785369803 -0.53202720738249920096 0.40128302220343770035 0.033877443996768584478 -0.080199261258092263693 0.39399795354537398007 0.97859253239873345009 0.078962285877555438152 -0.065262222539347033989 0.13687789254336937828 0.77989887221390286065 -0.81232652387354253865];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
