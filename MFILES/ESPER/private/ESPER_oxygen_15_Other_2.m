function [Y,Xf,Af] = ESPER_oxygen_15_Other_2(X,~,~)
%ESPER_OXYGEN_15_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_15_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.83304307440806346641;-20.374905775405039776;1.8708145763047177024;-1.8153811493040172831;-3.8653277582950162916;-0.083929937832701265177;1.4269371258090359778;1.1371181373667382797;1.0326091980858749242;0.45505654499979508731;2.0766026615674166855;0.60544991800248415537;0.064759319550796959342;4.3315567448853897758;0.40856176544391670236;-0.18588533849210953086;-1.0263973565982205116;5.9417383809743729017;2.5014748809852229705;1.3708904431371811139];
IW1_1 = [-0.24255365321849028937 0.24912671780047665471 0.007070505968586620997 0.064587048319984852185 -2.1226785607223419561 0.12548074770552505863;0.20736142250771391615 1.1311064159887478375 -1.3664003238514179639 -9.9190667229341809019 -1.2908381869406400089 -10.17963884468415614;-0.051261037755431532181 0.058954875736969399036 1.9372283235482083974 0.16960857026286890736 1.0680884827953607275 -0.37447219140024878836;-1.0810730739043343807 0.4306246704746755638 -0.67143612117407658335 0.70181364189303718781 -3.7116558285600698142 1.6267221494239603174;2.3052026342782019341 1.4391610505564236266 -3.259375292950128955 -2.8056284809559111082 -7.9166958581110948856 0.55275060803185149805;0.20471413825504861106 -0.17810996059682504544 -1.1468151410366849152 -0.88334364543873522546 -0.6372034293733522814 -0.91095114890885409142;0.19844808986509457349 -0.039491312033675930737 2.1171098535274084362 -0.41335059945581975605 -3.3461059650621725048 -1.3284107860873299867;-0.80135806150299238038 0.40288050638925265723 0.40458619037099524673 0.79988886902401401535 1.799971607515664429 0.24981024664426718096;-0.026022325360616428008 -0.12338952788721486986 -0.37151708900487701026 0.99398760896291682432 -0.45783037525640302157 0.039860265418688090033;-1.5338908389499981144 0.17861916006247732791 0.9344233550697410573 -0.66612685912854607828 0.12573013490697362848 1.0592933943698927823;-0.44859031242906288739 0.048146795341956948044 -1.725819240756657047 2.1314019896346323435 0.23702894232113894124 -0.13784256669652508731;0.17359165799943565567 -0.28914132596892766491 -0.015531177829824606776 0.37124682941287739935 1.2059118256940470904 1.0988754255047812336;-0.1915089463172855444 0.12701170705602402022 1.1807372292815605519 0.95797237743447660741 -1.4093774148017199632 0.83442763608303427425;0.55011028394804817321 0.10296441868132497066 1.3215361577177526797 4.5172433488450458583 -2.9781353812860236197 0.82031504168398661214;0.13941948229334572007 -0.46898823959712598874 -0.11803654963380613707 -0.40924189084139656059 -2.1881993150380880664 -1.591814095017298758;-0.38608954010509316523 0.5216388500350763735 -0.046099839143473181347 -0.75073602708596987032 1.442916658977482447 -0.71034945404623150988;-0.45549264659764215901 0.013058002061971701185 -1.1933135910575443095 0.36173016215930742234 1.7674708430383800906 0.19210140593002464349;0.61149071197169946323 -2.1709813064250926828 3.8532040683938979519 -0.10595111565996957748 -1.929031788493987154 -0.13857398860378888905;0.2296722515481843252 0.20262213251378172196 2.9329614194056556897 0.37646229738781084029 -0.4970293821234393894 1.4925819954359413888;0.88011075807454919318 0.03386837175518280646 1.6778268256186030793 2.0020809861685204822 2.5767030486370670062 1.3343412908251679472];

% Layer 2
b2 = [-3.8283069448224096298;-2.0121981626802663001;-12.415856619812961625;-14.565604668804935429;-8.6665230781709023944;-4.7779088572233670007;-9.4404364953520918391;0.36901382291373791;-1.3613167614408168138;6.0430560340506831452;-3.9153365451848527456;-10.072974996735734265;1.1848636224834714348;-1.9346604949616144076;7.2859529136570477803;-3.462894125381276389;14.610028838734267609;-1.060175000635263487;3.3644109549381764346;0.86436758230251486967];
LW2_1 = [-6.3476031509635566508 0.07049082301019241048 0.3569125242813931953 1.4420813814519917173 0.71136665558333311843 9.9422021647064813266 -1.5278065702505492229 0.14928323019148620476 -1.5418173368892769126 0.93805024065636177788 -1.7416570475809116658 1.911264135515376994 9.4193120286219986781 -0.14267753108736469514 -1.1213433330133097954 1.4366171684732929048 -0.75453477259000523159 3.4396894515815268356 -3.0451563975132120987 0.91647321585873542382;7.4003677436704391468 0.090104333664961344663 6.1076272235519670772 1.5274646317208822044 -0.19001246493448015196 6.1756608848425917913 -8.1799405200321988474 1.2293684109641338509 -4.7257589801170851729 -2.1967328117957016786 4.3915643546752383131 1.024385323611357812 0.59454217288943411734 0.69820421975778645951 1.3497793121842254216 -0.022941042760745877782 -6.645148506449760184 -4.1690208938603472433 -2.3044139976480053633 -0.41781558717704536665;0.92297404242344904812 0.55717713967562987332 1.8188048258801667867 1.8565557855499463802 0.79932521420866642359 2.3265574239307231785 -4.9707598982508569563 2.0434044833933562302 -1.1758532248746360604 1.3614355943776685898 -1.0225708951781256051 -1.7000520563027308185 3.7987149587015198726 -0.10180953138415245463 2.5695788648539803489 -0.90314313511579757954 -5.9594963250171382185 12.115096215801900215 -1.0784296426381565492 0.28095352781493210248;1.5245263054916586842 -0.26051571555854835527 4.070913517815515803 0.0086014947681008636221 0.18044959188402376338 -0.14657737243811086447 -2.4691890745274203134 -0.037002134163321806493 1.9727745841442516639 0.68201383032009610385 -1.2279150088514350081 2.0788743253882659978 -1.7042378666217534722 -1.5590916200158952964 -0.42927969245031999401 0.1538041725223885936 -3.3840422951909441274 10.189094076289794799 -0.37768698706456310665 -0.061120299225726516801;-1.7096147557020533458 -0.85372692260011451282 2.9294561358390693862 -0.6540956641262211102 -1.000702098728099898 5.0141471222091116289 -2.6720865587975564104 -2.2063718792006010716 0.92253149253378419203 3.2462243834303263768 0.40913988116530847217 -0.58711985007219491539 5.0947917347842199831 -1.3340892405601052495 -1.1780275381985987337 -0.41766030073206833473 3.2467426789392939135 4.450415319077584364 3.4556841878806805468 -1.1612062533157152533;-4.8315928289478389246 0.48696326907678383344 -1.3099777007475335022 1.0165971494777443773 0.083124091626906676522 1.6330473461238628197 -1.7230236798700360179 0.21488334300113318132 0.70550119649107922992 0.58733902727393216825 0.85384983218925358806 -1.4818273237845509538 3.3401551662649793251 0.65047483784758719505 0.81149641376414505256 1.2850068827196627907 -1.9456255432986819809 1.4215146092307431314 1.4277895747286009076 0.076781958240610417854;3.6344262915206564379 0.10379344579896614131 3.1170278061369605105 -0.14083878754980416748 0.30425492994170943994 -5.9522994501584252092 -1.0019219161423329467 -0.47046325500926888807 -0.20019715793924983127 0.57800008633108590494 -1.9333510262772390931 1.8173555480282135299 -6.6002231398889641412 -1.5202584217523764654 0.68191546753980947226 -0.30285658636949580602 -0.51787286052816772219 10.561312384806470277 0.81060398274075784464 0.45218993180002914345;10.862763235596025524 1.2839818771349134074 -7.8774931231093008321 -0.16340873959117613312 0.97502111583824457863 -4.967516159054097713 7.0400698670132024759 6.8071318306046721958 18.799691569597062113 -0.53278349150413761848 -4.7265348615369875418 -2.1873702994025743251 -10.824382329644626211 -1.740029506969928752 -0.70795487485069030775 -1.6908082642129442785 -4.9716330448835801548 -1.591748212508724114 -0.13216185769488511537 -0.68811032029953245193;11.512916059501067778 -2.2981572569303425624 2.7033228907677435693 0.21423710214826907627 -0.53708893247394384751 -18.937772744929425528 -2.5343035920292860119 12.015430000151766876 -8.0768523654995227901 -0.15823672816297065791 1.1644665813521524189 11.003729519451434626 -22.58123433253179968 1.6495589864116801948 6.1704834625474607179 -1.8902956605155181169 -16.702465398361923121 -12.909086781422045576 -11.951825675104423397 -4.5800140037337504495;15.971713945790156686 -0.92832448164859182604 12.325007409028213345 -3.2480862947618835967 0.72900333768026470693 -6.4322842360857910293 3.6286993954552588804 -2.4498109940307242205 -3.2916729926728942601 -1.5082648069127584378 2.5718604728955134497 1.2796038060530428027 -13.236680356360142952 -1.5791186404965953383 -2.8973492539178500316 -6.2258894024368425235 13.570728594337021278 0.76047902554328050684 1.1100721868251695046 -0.33176803200621762802;-14.116813249247972095 -0.085993268570711448029 -1.0324796294319482648 1.8859934372406608194 0.51687690134360597671 6.9845343420602867823 -2.9459741326715178644 -2.0437095671141563002 -6.6373873260216385006 1.1017977173135655722 1.6317753710897258124 -1.9596857622007837207 10.054369888302165492 2.6434730570957332141 -0.84254365012838283722 2.2262482023918299667 -2.3738383208184470341 -0.67863960831461234147 0.8975456766809795095 1.0925398748406982552;-6.5020106061630569272 -0.91413769966861257998 -2.9127769456917258495 5.4719483956398233815 -2.0038075960530319364 11.712981471427768909 -4.5210492049974391193 -10.105142340809376122 -12.126574966205044603 8.2956650456447356135 4.1878743496073003172 3.0741156660458393013 16.105161796571476174 -2.7103985646169439505 6.8990092496048998072 10.776283765573989371 -5.6422698735050405006 1.0661928928823090068 1.8681536792656190382 5.6846805842009686671;3.9506970664378338043 0.44576520456885765364 2.5454942252868293373 -0.93347942725800381325 0.26170581571444789803 -9.3483160225728862969 -1.7147889902153996555 1.052090444433869898 0.55953254143710418056 -0.39542505424603013875 -3.0740700588564795481 0.26165568605802874691 -7.5795844023134089085 -0.61840941637675461706 -2.1947188711346123924 -2.0908708182892059568 -0.33848620345235663764 5.3718776081775381215 0.59686481968682336685 -0.8117389794108404999;-0.83436296628626438476 2.2678338462749945137 8.9766614120241534636 2.0787918830781362267 -3.3470246973663693169 20.511072304007541334 -1.6843495283625824488 -1.0539268232899046129 -3.1945074533955661877 0.83858842530596011677 2.5940157885638917001 5.3322137294436258159 15.592740468652205976 -1.3581780378613315108 -2.1097426132680165978 1.0121555079748052464 -4.2848468096400287308 -2.4564095122184963493 -6.3170762551197929824 -0.75277070878034546553;-1.1695347864963736573 -1.3911748003024357878 9.062315596829924047 1.0484721225945456968 0.67426952611677326566 0.26136014137595015017 -0.67025181459233851289 -1.7707773871034677704 -5.2633056140803144984 -0.62526053464379516278 3.255246774906125129 -1.0876130993990000828 -1.9629095074686717659 -0.933376266823156997 -0.82276723758037384471 -3.3975625079590203725 0.94196136932740970327 -6.3240851209649440179 -5.2774091036853443271 -0.49572280311052036028;-9.3880041547475361341 0.74936368423032340136 -0.49276147584321783324 -0.043538214498690490373 0.94646941582098464973 1.3254070681423333333 1.8097451856264390457 -0.28324153020961012617 2.2633361547188228791 0.85311931807012830742 -4.2197245392650373219 1.0405213017041987644 2.2268502958443856521 -0.66578969437087742733 -2.4513842062778081754 3.1844254150974280471 2.380313145661932861 -0.70347142235628146167 3.9272689831989144871 -0.30978343054037749127;10.414920849535635128 0.09920875131418525894 7.6762137500332894291 -3.8998624249281377274 -1.1362739354864579422 -14.468963230232173345 -2.354320866596217865 -2.1377484744495802715 0.79204961958372399611 -2.5080147308494482594 -2.0286178965374968008 6.031328459522530494 -14.375616394126252473 -1.1603238968970543965 0.86283245653363160876 0.63255362443077178813 2.1378471488333405937 -11.500247398692195588 -1.4759934642733831822 -0.84598685378709648219;-0.59917072444173258283 -0.096550818189839321404 -3.5278959585990081749 0.22335899731125835599 -0.78003060277923352839 8.7740598052347014146 1.7168784496572735421 1.6212761582896828561 2.7013365992247861946 -0.45993248066731795554 -1.505878981164703978 0.11526902828994121941 5.9851852074948217464 -0.030351367089278026568 -1.9262709576468648454 0.58348619604130902427 -3.0803065849290209854 -2.2244970699362967004 -0.17628482687859431399 -0.068469818760797218626;-6.2745218060388099346 -0.11377766361640424819 -4.7924468590324300621 -0.054078549699216979518 -1.0341827417104292319 14.428641235079300742 4.643203893316540487 -3.3209288423161043013 -3.258830135814315021 -0.30988178062323817885 2.5263070183865314888 -2.7442356848495661481 14.264429641661887871 1.2250106861942666736 -3.2522205162477648699 1.3710870678113391552 6.9617988695864445603 0.81134315814013502344 2.9880180904676008069 2.0496734814491621712;0.31403682209417316251 -0.15896093366453967199 -6.2523489829375504812 -1.6303131685693705855 2.8139358042317192954 3.9100587349480986354 4.1180193492912584574 1.5853852008683095853 -5.5779693060890753742 -1.3882166494566499093 6.0305814173125824595 -6.9260319349940795419 6.9993719754047614146 2.9796543644870183698 1.1320222099162520202 -1.1627545887875316843 12.687333651372098231 7.1882467142128554372 0.92274783831799078726 1.3966256550431370709];

% Layer 3
b3 = 0.10131717897759988378;
LW3_2 = [0.14368788307769086998 -0.17800191741497109477 -0.20290062586323190374 -0.5299948136270701271 -0.0825851829267396087 0.47542510904896867485 0.33706014002220757719 0.057244631495708866997 -0.044462493620715727582 0.072593196969499562687 -0.095822922925680772965 0.29351171601814474155 -0.20543482854851541353 -0.044327478500629048652 0.10816779179272423272 -0.098978970883318626028 0.08924745131296578371 0.39445540488755104214 -0.22515116387976874535 0.043263339139153152157];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00454442172233583;
y1_step1.xoffset = 0.3;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
