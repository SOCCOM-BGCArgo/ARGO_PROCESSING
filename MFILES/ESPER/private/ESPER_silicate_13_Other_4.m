function [Y,Xf,Af] = ESPER_silicate_13_Other_4(X,~,~)
%ESPER_SILICATE_13_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:42.
% 
% [Y] = ESPER_silicate_13_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.8598630096330333039;-7.4424426526778075797;4.8633402417674274076;3.7641886466076988071;-0.088412160211060089599;0.10673508200575934635;-1.9378628578978902564;-5.7552771952737842298;-0.41788020349310672774;0.59192772396246684519;0.045893445556594789081;-0.21608891639519464678;1.6905506885506289549;-0.75078147898103742008;-0.33996654792705915948;-1.8396367338853834017;0.9371144566133107201;-1.5686003762423199603;-1.4468775084554854615;0.25744385467399438783;0.68784893606308672442;1.8518015194164645365;-2.0305235475971494807;-0.36166230823023470808;5.5504997763741892314;-2.3371346692678844903;8.8687242763625633302;-7.3127010220021935183;1.0403468482444666598;-23.776749491584929785];
IW1_1 = [-0.25800781285349350114 0.033699964356123157661 1.2301759086598094139 0.86025643569954024503 1.0672529968767454633 -0.01811541931569067912 0.71129402478823577916;-1.8098388757227479307 6.5075279277493667252 -0.50727862554812597207 0.52439429589723463021 -3.9104542018361421185 1.9675501128990307009 -0.53155092973134143719;-0.30831008587040809044 -0.071704644296961425609 8.7990624834182078473 -1.7979993910670524215 -3.664234141403921452 -1.6170761930007855334 3.3166986488744210071;0.032446449940402216638 -0.049408487216207434833 -1.6832934534969903329 5.341324196823751258 -1.2516240109871252795 1.4878220142530220738 -1.0998062094250342646;3.8556660907995503607 0.62744936663496442275 0.042287209388299072665 -0.55218254467943361785 -2.1645896165660620802 -1.1337006783647627373 0.27445813430602572502;-0.36075849625141470645 0.044836001941779182745 -0.10851091657873991603 -0.24035838012023916233 -2.3812347395962421004 -0.1435545909240379947 -0.079235796450188508699;1.9726204600574592796 1.3247124509291603456 0.50971439580553956628 0.035887719987759449103 3.2485696837088697819 -0.4835988329701421673 0.77371774721810104847;0.1965176772948027395 0.21348178688176422391 -7.6332292031473665261 -0.48257995611755943877 0.11793312043563679292 0.67169778262607904296 -0.2359594866248314049;0.92889553332843921574 -0.33569548073606014782 -0.041198275879837695235 -0.034293543581533691977 4.5071960803630410908 0.64241047442844101401 -0.31015265900884370076;-0.19678379931961029192 -1.1746148945515897388 0.95525943325114315297 0.77449583304510383197 -3.0089508440493513142 -1.3721793603007539364 0.18628517194965169002;-0.87634817282308608011 -0.30484134306353882771 0.46139997104862945365 -0.1854403929841484111 -1.2751871740048585924 -0.38235279746776151821 0.83363714764132978985;0.49617417829452831191 -2.2049810672898231267 -2.9327221422673597218 1.1601828332487753581 -0.76266135294362213948 2.1324803742185944877 -0.78417663815357918633;2.5472500713897785474 -2.2140435447452690987 -0.041782476243040232722 -1.1234125731785211677 2.2751818674218635685 -0.68670856187379369917 -0.24040436008234175591;0.25253734321303833443 0.059770847218402027579 -0.19219200581649392712 -0.1142873786775393391 0.083577935577449358195 -0.032124292765465398136 -0.30811958362130092981;0.085404066323549937545 0.47983379414520904716 -0.28502919805762838568 -0.67917152103821731846 0.66894590655671937185 0.65535859217077085948 0.5346008537505235747;-2.8126492851430850983 2.251398364810424102 -0.044313053918113125274 1.1522284773819468917 -2.1998640428631173194 0.77664436481178333871 0.12072079012813155541;1.004208844352990182 -2.3699771936456635046 -0.14151741010743407179 0.3814526925361620413 0.57856881177778229919 0.55032058411904327677 1.5672140505325471427;-0.35717306819718280808 -0.36455423790755098201 -4.0714169459997631151 0.69746755526436388095 4.3616390335333461437 1.1068603923999182914 -0.76187371475876375371;-0.28141145034345327325 -0.22445121816753405009 -0.16445380966562625491 -1.2715095346717000258 -1.456926132538797658 -0.28419593436006401754 0.29122591316582630006;0.065189538897066634515 -0.071175852175397930077 -0.7797254013886598667 -0.16585912911968306305 -1.9668648628971172609 -0.042208398528374713177 -0.66996280992037049451;0.10686826804198520935 0.26818254245097017385 1.4600625897248460383 -0.26470153392179579521 -0.6792162724856336542 -0.50662004060956700169 0.51665916195254868448;0.60180672792792511139 0.0092626116079020780897 -1.5899858048530584043 -0.13272868168338458617 0.92013637648042034822 0.77151275584035250432 -1.4364660344647868229;-0.62575669553267398992 -0.4911755755672503887 0.24544726668601224429 -2.1405456703594012424 -3.983296875214268784 -0.79868933883632542425 1.7232350550101642739;-0.051791085504490054492 -1.2708900212384444117 0.75308053666740149001 -0.10985850021193072079 0.3727654081500109684 0.33543818074383824346 0.59958715129489714712;-0.14398203170774206971 -0.23525849369057799665 7.5584596696724766218 0.027855149674764795309 0.81945588517219636326 -0.42378683690792351424 -0.14488925138454941677;-1.2990358110391246882 1.3850430444979509037 -2.2988235770637013289 -2.5150131638198418571 3.4783503858557494048 1.0201658022000990034 -0.69797233941401126689;5.5218148321745772478 0.16053383003319077194 3.1262180173271394423 0.38580396191705923492 4.1138244776103496392 0.35201063231778373375 1.2641005197104251412;2.3264107051146352134 5.7815379525598018517 0.85534233068391596344 0.5690953899820100359 4.7033452661560035679 -3.0612559538960315564 4.548093680824717211;-0.16889739051373145462 0.1242883295164012164 2.25393589018598961 1.0675000342787206442 -0.99302346348791126207 0.80068174930100999287 -0.1811198572406325924;-4.6650245159167429421 -10.811267741842542023 6.2433045760586125539 -15.829613630420107384 -5.4418554625560329185 1.9072172333694030755 -4.472501952854140761];

% Layer 2
b2 = [-1.8497687574888093121;-6.3880350363187217155;-11.173386324398176583;2.5793371208337867451;14.921397078857713936;-2.204708271665546615;0.66036185458461427178;13.338381923342463864;-5.5993047361910353032;-1.1804393279467721989];
LW2_1 = [8.1934614588827834325 0.035591831364875183008 1.3681841043157869642 -0.24421574587688640867 -0.7508313586748421864 -5.1655946896952666947 3.8972339607187831412 18.202818728743547894 -4.9944094328617953948 0.47163428116143990554 3.3052758582891077488 0.23615304552804339266 -3.4005381089538477823 13.221179554461775396 2.1484381488755093237 -3.2833991254534242721 -0.10883673896790783953 -2.0589363737186276992 -0.47318513370653464412 2.6439117919356882602 -0.37845595195027426083 -1.1128332494377508599 -0.6173028664382744779 1.4045726101227768989 10.997820028098374223 0.65818623228245076717 -2.3743199503096632519 -1.4341292290362486206 6.2563394438223003391 -0.081313741460410801642;7.8863979267247232841 -0.76507075539804758613 4.4946633377739928505 -1.504166549864422997 0.83442060319988387018 13.377998940358320823 3.7952650205262639105 15.272258638071548376 -2.9436217915522111532 -4.7380607708301294423 -4.5733845609304841773 -0.56517888310626374082 4.6329172189713556662 4.4486675807943507621 -8.5583516859966159984 8.2660058750426443908 -0.57515148928709758369 0.43227978341246015015 -8.6415390651585965998 -6.8042038173495731357 -1.4552863450483815022 0.73638267544942559439 0.65447501871638069648 6.6729103177259210256 11.826801164936675548 -1.7832139003644731368 -2.0181061715942929524 -2.0360629850186793277 -2.0244826862771327924 -2.0431475626121757827;1.1425072183289546324 -1.5943953676439754918 2.0777612544261643279 0.77760223589141841405 0.19281532254836705742 8.5138026916663314125 2.5633206233869945123 0.87454690360151021711 0.90982206811937937907 -2.061599072386501863 -10.389473224370643578 -0.39643429376521244212 0.8444760278321160607 -21.389236181053394859 -4.2409045799987703518 2.3114159178908342263 -0.18583691106444771846 0.059486781013749961966 0.19698463073867314432 -5.0046471071622002924 -2.4191593499843238035 2.8927944569692649601 0.27204552338395598943 0.62150310998298807785 1.5106611814591168752 -0.87820204651358468873 -1.8984511576892200146 -1.5361475721768693692 -0.41569029532704648844 -0.24224056063147422768;1.8158507393592473456 1.532804337501525449 -2.5302110480596033959 -0.44669186523452386606 -0.3152508427185172768 -9.5722926368638816541 -0.83636168489786211211 -0.81014231468303565808 -1.8169821980511171589 -0.75878180228204206159 5.1300824435572307536 0.69781461961773205704 -2.3991731070436324025 4.2666332684874825887 -1.34625789515926364 -3.420502321583371419 0.20892116264677337845 0.80352255788171644824 2.4071694892902661955 6.1001476962270571036 4.7992360151275432756 -3.4081074482301443318 0.69680928365775285371 -0.90636605177907392239 -1.5525536685503069645 0.35752358563675440406 1.3919281540578645195 -0.041060276445492829844 0.53221506705934296111 0.56635497860973116335;-1.945547128364307321 -0.021726506527619291603 -0.96025735356832275791 0.24897468373435813205 0.19715182617595716774 -2.4925708563883435254 0.47665828731237841476 -1.7775219192099538379 -0.18386198666347666753 0.99329893387128365134 5.8606091057710845149 0.080245481400534793281 -13.28080691574259653 16.902082416871191839 5.1947802914699785504 -11.26395143136046606 0.82169799422877953798 -1.5580394530364551908 2.7456132022947437044 2.5520843563044235403 -0.58667551355818892134 -1.3929484241726353133 -2.2615942599784126799 1.970863368501512225 -4.0508755018377868851 -0.6070566003952522216 -0.72489587749269335237 1.9410908258246524216 -0.048397566331533845019 -0.37700696385765836149;14.844602956542434669 0.53332473631205512543 0.88049405857512919038 0.10397341100759008303 -0.65727122033996576711 15.216505185124319155 1.5927019405404545527 -2.7308946170782770757 3.5086191078281894207 -0.46219973809821535138 -3.935091484321307842 0.91376816134122229585 -2.911659922704199932 9.4318377005518829748 -2.9469806986758992906 -2.7786592566007386473 -0.89690618674238276054 -1.6357325792352659377 2.7607853560322270781 -9.2454286468937763033 -3.8168982483273778961 0.42590003687207739214 -0.41423736978338271397 0.77364027563686288413 -2.5536956572619198269 0.24891600135736088872 -0.52723295817321069734 0.19917678452740170125 -1.5155345710255196945 0.74106049187241362919;-4.5590504548890793401 0.33415731940800652566 -1.0981599008101787796 -0.30553818667966503586 3.5064671566194913765 12.745829760467458414 5.3876418202392279966 -13.242878460065803381 5.4953512481557806879 -9.9555917991250879595 5.2236141203123320764 -1.145420073616471468 -9.4629865404725528322 4.8385592899730784922 -9.1860334225577560119 -5.5308517213880081798 1.3616660717921487134 -0.45215675787215064974 -1.7938966756942946734 -3.2718549749761480783 0.90838950281889541127 12.767963899140466921 -0.44921889803224224202 2.514982411048026556 -16.273271003529753642 -1.8061769885192626717 -3.703278240214192607 -2.4917586252078316456 -3.0485437675912674393 -2.9184027533944840727;2.1867711625042547396 1.0247362103397477107 1.6388279066106508086 -0.81064754406881223137 1.0841268408176829574 -9.3140515449961291949 0.84403246357348693518 -0.15059776493236298744 -2.2281293562188553281 0.88092771060464369892 7.844931923510707783 -0.49938180857722186401 5.8055896949403003049 19.688026750234133289 2.3508771757670023916 5.6188522673249323702 -0.53297596126520996318 -1.3430988965977654903 0.92926941131690632414 4.077308813399821652 -4.9489683287144972113 -2.9168933051592476069 -0.76329750898423920358 -0.41772356160393231406 -0.48517550493348637897 -0.52098170502035012763 0.28432991685928071801 -0.62557625514263714983 0.43549322570066106852 -0.1900293946210032392;-2.2759393031263166485 0.038321556157876572601 -1.5734879472583891413 1.6168641088925417293 0.24945237900503428041 -11.780418401542327445 3.4454232827348993951 6.2668513704219197535 -4.3124940035173011665 2.5846741219306976767 2.1892463011255678396 0.58542934146385594563 -2.5492696020199976381 -13.754500978070042905 3.8375009094161045553 -2.554326649240497904 0.36269666148571660935 1.0830688352754458403 -5.5421930336323406152 8.0571940169465499082 11.116860014594978523 -1.6102037313693544629 1.859416538894844706 0.32953836256517143877 2.3439023537831746857 0.60541553405856407544 -2.4022547147858066552 -1.7775842412450728602 -1.7915155768514610113 0.42503313197348802088;4.9447191638339189623 -0.68014655718113947724 -0.49982067137576979832 -0.093284597401807278771 -0.45669675143989202359 3.7041100300506504261 -0.43895989374152644125 -4.1824851701786904812 0.15731841501176807574 -0.51167676707920084489 -2.6184462687987255514 -0.063128770656242019776 -2.0344656876381668198 3.3515224174825180015 -2.3574858421631201821 -1.8639291117247089868 0.30683315128628718682 0.7483646373492146564 3.3050305780771305209 -3.0615589399477070032 2.1406643715679960494 2.3240962044761719341 -0.80270422946688191335 0.062434755776603421962 -4.1875467408567006444 0.29494061080831557309 -0.66757982524500369959 0.91227514057174219353 0.14286239924979762805 0.17992187629801145721];

% Layer 3
b3 = 8.5681459909416979315;
LW3_2 = [8.8588635936661539461 -0.038642320103716397417 0.14244898539247813352 0.14910726022622833309 -0.073205198837738974516 -0.2999769486959851239 0.051862482952576213768 -0.13003150142374203524 0.0544675846018147225 -0.27516181813030021752];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
