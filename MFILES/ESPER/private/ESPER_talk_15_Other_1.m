function [Y,Xf,Af] = ESPER_talk_15_Other_1(X,~,~)
%ESPER_TALK_15_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:51.
% 
% [Y] = ESPER_talk_15_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-31.089289124212886;1.7577668563916991;22.353449599104344;1.8354881573321014;-36.131750961908558;-23.069362618653351;-20.91515192340896;1.1982453507287008;-3.4185088108171837;9.4476053456993867;-2.7439970959560576;-1.0426811734859849;-6.925413255986153;-13.455812247344356;1.3852431663799822;-0.2909956898347994;43.872655640666615;-38.448770991461878;4.8461914421369077;5.9992607058355016;-0.35087088195566363;5.6241430960502878;2.1135456244062207;-1.3015631648226356;0.14749586587125216;-31.733649004454527;2.6824297631415286;-3.3435300178608123;5.280345956137463;5.1528922259075909;-37.474546778713673;-1.8234859420787721;1.2782397201084172;-16.741299800379814;1.2759548339380802;2.9483471360359639;16.106741575192284;28.10909182695605;-32.364468717708732;29.842492226174279];
IW1_1 = [-43.188373133413137 -25.225790215279513 11.719756998771066 9.7791114299186113 4.2635348259454391 -1.8697058469720178;-0.64376779227206338 -0.84685673206203926 0.32404053531870847 1.5545446304705939 -1.1682150413401795 -1.4290904746890389;-16.219515095293456 44.700909084831963 -63.668001910206904 -7.9977860847636517 -59.807522633188064 31.355326559910932;-0.41840834892940609 -0.035164419209454664 1.9562119628505312 1.6321870364325961 -1.5921673256388729 -0.79514678262509142;204.93698630632719 -18.590365352430819 42.071933652177094 44.814700521250835 -527.98862284451445 474.3261207543672;1.4371141786688444 11.367589444011982 -14.489625442317596 -2.602793791233986 9.9257534715507525 13.786360374562909;-72.988554934700403 88.777567822885317 32.826188735054089 -71.887519881590023 163.69229187973548 -55.362245975522129;0.078937968613627785 -0.15862139621177643 0.2591642029742664 0.68607719453499083 -0.77030837278676867 -0.79471010088087057;-0.11484557548491396 -0.16632784138077311 2.5868399739544357 -3.0948975306567275 -1.4330097726067812 0.45814438222653275;33.698865108511448 17.295255608509517 -0.81821682986820221 -6.4739000437874843 -7.8969608827361544 1.8781723683119529;-0.052196501914754175 -0.14916907172872473 2.3388017721698184 -2.9882495214898994 -2.4964900583078538 0.24314484790929691;-0.73208872425948268 -0.47831082543690995 4.6926291958961484 -1.5494686471001935 2.735652722801833 -1.6427707962437088;2.3640700292146746 -0.99944399763030245 -5.2045783899639186 -4.3522943502533611 0.13798267551733071 2.1188413731327134;34.135928939810391 7.0373481631375343 -12.278142941330808 9.141461479725276 97.230911100806011 5.119106908806466;1.4479728652593358 -1.2345991108971526 -0.52141135266379435 1.3723019851353806 2.1663134601692717 -1.6373092350914864;-0.71351780715441382 -0.9428403459069028 6.7725186194841065 -1.2877035766313554 16.511800162578002 -5.9767813997975416;-12.252063419140297 25.706603812716462 14.295488403180984 -7.1716297629331889 -109.01102254955424 -12.4264723325979;-8.3859407776198829 -5.1662660665023052 44.361383241842546 4.0385004532211406 193.38163958039939 -4.9918434610960301;1.2812721104503995 -2.9219749000910147 1.2327812854158027 2.505564157220709 -7.554325259053881 -2.0029725991809069;0.24151721667289891 -0.65107251753362294 2.1848561347470343 -1.4860957880875234 -12.031381120792314 -4.3064983289949019;-0.033312780446671832 0.6565718497276567 1.024710368457685 -1.5730912535242834 0.63834546556464133 -1.235530488159498;4.2501365289445836 -18.376777878284713 -23.79601420742901 24.533571642059957 -14.115928841097087 -0.41593160487822545;0.18780402354245709 -0.068808178947170118 -0.19182590955775156 -0.69591097528813928 -4.2859505425515598 -2.5460195432383088;-0.3147379629997627 0.040575983243725314 0.42858640961940575 -1.7746607598309396 3.6742716269010334 -0.32076522060687529;1.2541987742933425 -1.0488273947449251 0.78670888381581838 1.1295513726900324 2.2976319257498705 -0.38410907996182447;31.458751906151061 34.70564768486333 26.386040061077285 10.401933646987391 -9.7712899017294106 -12.67163122453649;0.058405410072143463 0.075677283835565462 0.32649658858175734 1.6380018908528851 -1.529734036456649 0.39427049930787028;-0.036362376185402015 0.0045059251276961289 -0.0435443402894772 -0.82309842361814889 3.4544312333896783 3.0932583786962793;-0.5807944607087917 -0.11597080914342778 6.8893318606932645 0.67912763641367024 0.88958732910609495 -1.3639350900658667;-3.5141231430698676 -0.78967208300894387 2.0494359306376477 9.6619445063749865 13.895936340755172 -6.3379704007156485;29.232647029835817 46.440875429906981 -15.656799701275991 -20.02072456268121 43.464911957319096 136.40400698222814;-0.011446393640487763 -0.094244619466412216 2.8576617701379736 -1.8176130708493481 5.0709342423937862 2.9251581257511869;-4.7224959859184423 -0.69194379787462135 0.3075931783742652 1.0416177083814218 -6.0280143866633704 -0.94003860307670395;-9.9412862217487241 -3.8105786619989779 9.4892686843451237 1.8035900503600002 23.792202507012984 3.7166495843146383;0.29539229506292713 -0.049030849811443067 -0.4624446951779097 1.7346383977261177 -3.6750641830953925 0.39797222965249279;0.15990314413476917 0.019611816206863347 0.38491882711335695 2.2462890410341694 -1.8546199954017073 -0.65776714544300185;86.410423008477352 64.261210166333527 81.812276832796769 41.603893912045635 173.80757731591004 -49.137756647350933;-13.639620526568123 -42.314405567431528 82.769873636119627 -74.704716726358527 -39.343160563645995 -16.521851655875782;-8.9576697727076979 46.024296808998265 -9.9852828277573025 -6.109605993946575 8.8328748849391854 -0.20649345892215928;51.086854764107883 -18.652434322912317 72.13284333696518 0.18557731735177838 -117.75467682524966 30.078063127462784];

% Layer 2
b2 = 1.0841486016582607;
LW2_1 = [-0.0056549247594837515 0.15893976935051185 0.0084471455979447524 0.22063419841444745 0.0034021211916580095 0.01210589432859469 0.0041250104484352257 -1.5927617873260838 0.38884109794525623 0.010229643264421601 -0.42668330101336832 -0.053784750845654608 -0.042924653803581889 -0.0038425588302691709 0.070905975603427526 -0.051471492264577819 -0.0059704465404202441 -0.007384915872072041 0.023915033996253218 0.10278339850240863 -0.18161558921808421 -0.0050089627496823609 -0.41771478119923261 -5.3545343474241944 0.096367081577542132 -0.011075943662566414 -1.048407685981255 -0.37423476251922994 -0.11061707579814066 0.010700256759256449 0.0034726497498759005 0.053683613962236289 -0.035000292312248209 0.0060449269915234015 -5.5161589596915404 0.88141161611227348 0.0039546725224530472 0.0055483945422974386 0.0051578226393507957 0.0034425516934872848];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
