function [Y,Xf,Af] = ESPER_silicate_5_Atl_3(X,~,~)
%ESPER_SILICATE_5_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:39.
% 
% [Y] = ESPER_silicate_5_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.6943135565964519973;0.86666163300898835242;0.84451839187503574546;-1.0474017881219477299;3.392956475010534767;1.0422737533397876675;0.84860436470329270175;-7.5652825225241819851;0.91853318089516755585;-0.25595086109672576802;0.22194895272754519566;-1.9183407948863535619;0.62236442328811569791;-1.5638214210639107549;1.4136295951392776615;-2.718066416362638904;-1.5624236545304990287;-3.6541940427103178912;1.4891293458567622654;-1.5753654364914386754;-2.8668936393017383502;-0.71705272068278047559;-0.63168753594610926871;-6.9965985945882716024;-6.7179623750053067965];
IW1_1 = [-0.11264286637988538131 0.099080208699497782088 0.75565030217922801725 -0.6055178051154830321 -1.3621536521641768314 1.0962935312774602092 1.1731922484090762104 0.3812529596231646889;0.25479710072773498197 -0.25669711360485886198 0.12927482664148501335 -0.27878096687374581686 0.85650682761972596335 0.74407440511744760148 -0.52737836765746315404 -0.31001351207996968862;-0.078658951751202813019 0.25784839360906847139 0.18493560607277217955 0.11292051423714856428 -1.4686439883876274415 -0.22307187487010660121 -0.35065062276296982136 0.84971406565956641987;-0.1573629762646036323 0.18753181899839663216 0.55402210155684039616 -0.2099582594459005469 1.4157475282668459116 -0.89140034737901285844 -1.3791467080475237061 1.0630489102518831945;0.30743584919024363744 -0.43965291723863170192 1.5274554639244224408 0.18999498636904260662 -5.9112689423746971329 0.14923535185973935135 -1.2393491581885687225 0.73306444037742968245;0.42869197157794047826 -0.457344144964938637 -0.15218273377510493916 0.56365679210580132974 -0.32961382358769136802 0.22635472124193589671 1.4728344537986737262 -0.93433010276424433016;-0.30548872199313353848 0.19399935291389738823 0.062050288237692756421 -0.59466868727943300588 0.19246854795039342045 1.1696032810222989351 0.66422908754535858744 0.55569591036050702826;0.74726139782698719483 -1.1789498308749457589 2.4616704788108894064 -1.1503333017143011485 5.8478752387462273887 -1.4128608871650085721 -1.3283764950142775696 2.8821065649108077444;0.28849243503062493854 -0.25753936833837237641 1.3207018985494554109 0.20225742494646828384 -1.3563159175360084419 0.44069025448616733209 -0.2552912871875120393 0.9398309684008929743;-0.51388843176701948234 0.12094350308872085786 0.022135909267779387694 0.42122342705009258035 -0.71929783606234432014 -1.0693746951084037722 -1.3523081250166948397 -0.68316802402152099205;1.356270998439455866 -1.0305268007455168355 1.7709806970392791836 -0.19730736388087755095 -2.2031622568995765654 1.2515316793630955061 -0.23343528589223869196 -1.3969712264995564066;-0.78791511665306745993 0.38734038123597697156 0.76323095641102012276 -1.2617887176045508024 1.7481667885329061907 -1.057295692229000883 -1.2195531395841943123 0.069178847780528879285;1.0364736768982532045 -0.5770971036000995813 -0.69592888577515077397 -1.0074275317876966174 -0.71683943126060734041 0.95796280203358530336 1.2293913202766160175 1.2081370206582615623;0.22180591416480904821 0.046238120422981462965 -1.3003666106388207524 0.8878712621662381288 3.5543461626576702272 -0.99405954813858010688 0.8790019439361118625 -0.47322554150616674695;-0.28188856552413960044 0.35203527449311927677 -0.038783884465521022145 0.28003566027956605655 -0.92939351349936583091 1.3231166894357719865 0.96599881851535784882 0.2434186698265886073;-0.058028051175030688491 -0.34392747502866677367 0.54406714924420507273 -0.47605128062071982997 1.6903288903883741945 -0.37017902522879669869 -1.934749746946094362 0.027700513904587175523;-0.2278772900113473221 0.081159563094980027853 0.92040845658431835741 0.19488021370727826032 0.14953701379624378953 -0.48868696759448437827 -0.54675995678581379433 -0.3313500339430543451;0.036184843398950193583 -0.058070780100382912714 2.7448724844834750947 0.72838703859785125516 1.1828714527181489746 -0.20009832117862277889 -1.2112937848223048753 -0.86355677252174201097;0.36262403730989511974 -0.20130789108625535277 0.72320899996233478646 0.22112995654264172574 -2.7250230832478452569 1.2610556514570561149 -0.16314834719471341118 1.809612724854835708;-0.067006002008500945011 0.078466669029751662245 -0.17207604955675734337 -0.13981194373948099829 1.5097159261630466176 -0.049085054912827684459 1.1736963057480085393 0.382014533007213275;-0.18751865707188167254 0.11933957335831735236 0.9764426425224705941 0.17371264471807768004 -0.65525405965301153355 -2.4643343823047310082 -1.4011571727683658217 -0.1610532003196003259;-1.1722900092958910001 1.1764767264138564773 -0.037679963967024332483 -0.69282906676452749029 0.46531417322980744844 0.35564841825313864287 -0.55883172384428259072 0.94204239834110858887;-0.15531294468380524298 0.13248728709637805356 -0.75175313441743707443 -0.15745747448462435458 1.1701819874720753578 -0.60222407368959141039 -0.041800013488468575062 -0.65821348991065320444;-7.2056244265514122205 1.2951624772839576138 -0.13650388443147878914 -0.86802245759796203828 2.3866131585335152998 -5.8461919989744863813 4.7924015100201433626 -8.1446492072728133849;0.17471455812007299913 -0.48018559632989049613 -1.6718595795014872252 -0.031504266822593510189 3.9354022606622272029 -4.111326797212836226 -0.92056721467504432077 -0.92067643690600908801];

% Layer 2
b2 = [8.8392009916861251639;9.1836710955480480578;2.2232204884844932735;-8.393162652288012282;-0.84981845904218644705;-10.986745979225805314;-3.569277345781153965;4.41672232335027104;2.0420804589875669599;-1.8186225860700564461;1.5306434154245460721;-1.957085099971999087;-5.56605258549921178;-2.0310724946691589565;-8.8296692958441820309];
LW2_1 = [-6.1675917574368481766 -6.6611892701187693788 2.604453396789357722 2.0347657749830587726 0.31083238086516357113 9.2691713952476089133 11.67263439789103785 3.1324598331153716835 -0.94384594137039790063 4.0155946933538100296 0.89551030701422196234 1.6511280879984437941 0.82682010417755613663 -1.9496024825566078409 1.9739916161120973914 -2.1450549866742569805 9.5633668684531496496 -3.1305555212634375017 5.3337296455290097441 3.1824162548299210762 1.7737287061023632173 0.70736717196939236096 11.344104895894107088 -1.2751576934700399324 -2.6364891282715574583;2.2037670532674584756 -24.878269410047373356 -0.39912619655281511566 1.5488086519916206552 2.5124078803752096789 1.8619916131551756955 -1.2433511770700549359 0.30565987904210634163 -8.2728679446045081392 -0.5375467288218731543 -1.2156341338173384248 -1.7924077103977169578 0.036956409980624105316 0.99424057908560425911 -13.02037579589735472 2.243515663194587173 6.2936791098104345465 -3.9477229392618289339 -1.5946562629682743406 0.47287347901431320274 -4.8154533959211143213 1.4938739477969391611 -5.7766984144518724875 -0.96500530219297642187 -1.163020443430518247;-0.15786470574325700555 -5.3377163316637394885 8.058233231003029573 -4.7737762396917613472 -2.1834138289898632479 7.6915420945749248816 0.33031639076838148483 0.96544203032248998575 1.4396109115777402376 0.16857138065357990531 0.64975622958391610062 6.5619178490279317373 -1.5728796460040714855 3.7075693759150887274 0.40578531361552272472 2.508206884269802206 -4.2557461449669187203 2.8510859739988876349 2.2975757023545297919 -2.5997959480992904879 -0.50585491552142181071 0.69321827055851692467 3.7117887250264751664 0.0012371338597424411544 -2.1148250762754154941;2.4251789275913369082 8.3487820634714271506 -2.9213326145404994172 -0.59682148553286895609 -0.5914395046921123722 -7.266715601126674251 -10.323369041619345765 0.2093209708897405541 -2.8791385746077020613 -4.1369204390329015197 0.62478548061143057701 -3.0266969670821501914 0.33510979443771277131 -1.5172624223509529884 -3.3506327247313896223 -1.5268392802406303144 -1.7228832199721966223 -2.6983711344596255088 -1.7130420559463801489 -2.3078554322731648085 -0.090958314707377682651 2.9147271965756647027 -5.5454593023548621744 1.9956540087334064815 -2.7448270930173075399;-2.5449319816186446452 3.0710922763022603377 -11.928474278266760322 -1.8375511108847237818 1.8917770580006638692 -1.6501472258551717065 5.1449520177235097407 -0.093068919274032532729 8.9408988552491699409 6.9045817840030290213 -2.0200483725867890428 -1.5043434109914581853 2.0298908171805019052 -4.8945891268985670663 -3.0821125202369015206 -4.2060879726286684033 10.074104561606034736 0.37326440359789836432 -0.19136324691135700449 1.5303620112865894409 -3.5454947012736095502 -3.0679993191874794789 9.5059203570604875466 1.2414039450173803836 1.0281814180168722395;3.2482174154840683933 -3.6006805372798447173 -8.3937208259820597078 9.3919109440323698124 -3.2248565634652233136 3.6654554653273199172 6.1635288243107186901 -0.49188502843621273453 -4.4259687517930021983 13.531954217241265681 -0.30134949445511383104 -2.557434348504404209 3.7724841618120641407 0.13849857631116993528 -3.0013275826179599548 -2.9208621289500222851 -2.1831697985940357043 -0.054642181114680117571 9.4794723737624870807 -5.4098111396201788992 -1.7704458154560860361 -4.6843572243584379322 3.3272222246940841295 3.6684404668421026763 -7.76571352201813081;2.4821682850452679858 3.3999954782725638758 -3.430256712107016881 2.9338219844579604967 2.0798757182594815873 -3.5981912807759726114 6.3307835163856029936 0.67150882271401934887 -1.9536822276330598758 6.0318363213826193814 1.7943861813183468179 -3.3339380301781806892 -0.47535660800399781589 2.5599264883678549687 -2.7690273357494601392 -2.8048581748116894197 -10.422693551814248281 6.5671198530124801351 -3.5924754885518503933 -1.2187190433686339031 4.8677533168217115289 1.2268641264607647035 -7.6537233088264988723 -3.0219800442221096404 3.4517009069180666359;-1.659571942800192268 3.1819731991718533948 -2.7279348499622702029 2.6737378500191875119 -4.7286156474178744347 -5.1325904234547685689 -9.7787818627729947707 0.39169419991036552586 -2.2481242389723790076 0.46698885351905750074 -3.42215886485895604 0.66437409094791721742 4.4058430063475588767 -4.7827333207106725865 3.5536833265917104896 -0.19833228510566880409 -0.4030152095237823362 3.5387237803649704837 0.39595676792262546329 0.02107073863740461378 -1.0671528637571119358 1.0029625214092183771 -1.9768679702104992035 0.35811479481256924817 1.4238101394586628601;-5.4837337877773810746 11.767434090382707268 -3.0560691230194918511 3.0790838760196224122 -1.0543275859784460025 1.6050841238458060101 -3.8457619124497863794 0.96777483981829137694 -3.9303495084052282316 1.502204454150349866 0.28363425500341210572 3.0568706018000009195 -0.20386739819600543933 -6.0219581514117628274 0.93862317251260529716 -3.6273739864860652382 -3.9765511778816096111 2.4030601501620467708 0.980639098498224282 10.403221260554220251 1.2279771838145112639 2.6684693436231672337 -8.3617998288948900409 -0.53098714378288691673 -2.3082346342796635774;0.38190245204685374647 4.0035255488760528308 -0.48199339118780826219 -0.11431692312175879833 -1.1052334828382077703 -0.36709322136281341553 -2.4090427796677484906 0.16623951190008939838 -1.9694463087215507979 -1.8357644126079426528 -1.130765590389938291 0.1970456029725882463 0.6485310634313182776 0.010973060734782994624 2.0042073233651227504 0.20244969370066850933 4.2447053715287594855 -3.1860521955504710334 0.14964193354932145419 -1.5900288519829313127 1.525899166695433351 -0.55259564186768528327 -2.9784357245227823796 0.23027993784197967053 -0.1643365609309374864;0.74923130193752962569 1.97239519997881807 -1.0075273608905779277 0.93889908859372372962 -0.72756644380016111118 -1.2461115097256834083 -3.1904286834696695685 0.25244538922520876056 -3.8602555729150176411 -1.6369024009782411344 -1.1607374984305576238 -0.87958705774551304568 0.95405162789824360381 -0.24111888914877505075 2.085490539393368703 0.035053522958839448964 3.3620958516102419367 -2.9635446940711682728 -1.3819110454598342308 -0.77918782995844104722 1.4426725508510882534 -0.47685348525339427139 -7.0562834365132580672 0.33548071103739374177 0.28782490688255396583;0.34783264032115601694 -3.0244055269108200967 11.254146227495258614 -4.5806106469957912353 -4.0090789287556400922 0.41326790040482075383 -0.31723496814917734321 -0.062003645151495832832 -4.3128476259803409931 4.1432628892295246814 0.15561404478407109275 -0.61305610247369080046 2.4899579468852843789 2.1472117592357204963 -11.111896065252336641 2.0921884056880357683 7.8247530029220841996 -2.8654866482650338533 -7.6928344606395526739 2.582945306558206866 -7.641177133468336713 0.83788473951127473427 -18.443863678633896086 -0.6186906959718804222 -1.4832410617466909031;0.023133296741696666998 12.79260778925538844 5.5445017947068588882 6.9189439065816937813 -1.4533724681687889557 -4.9413085465828929799 6.1371082017355202964 0.46100563833093449739 6.8141823333102022886 -2.5284163663609300343 -4.1047647769000423779 -8.3316079720731810454 0.50064194972142317397 -0.89569679778297683903 -3.9041411160031054273 4.596256276505364724 -6.3009390670840215165 4.7478436486368549296 -3.1946241976166049881 9.3875185566868779574 1.2743851905141796443 -0.19508637196253045265 -4.8561637775337942458 2.593106241734321582 1.4836126470727686311;5.1157340569404077257 -12.055075559505654681 3.3275930358146781352 -3.5319054666052460689 0.9856229210117830597 -1.2620564478188827096 4.3009775208325464746 -1.0196546694742012473 4.6695065260612018676 -1.70702669000129581 -0.27549246702655588726 -2.9064348090745046882 0.1781178816651611263 6.0654068366311655325 -1.10336162022433526 3.6958226521382955276 4.3498423099520620028 -2.6014305830182871127 -0.7523311771082203947 -10.550613626962899616 -0.99112507053606047069 -2.2461071597482997753 9.331989782533677058 0.046991656403659501362 2.3213317371454413873;2.1032290318249775574 4.5951736423110798313 -3.2722026352941187 -0.58656323833325652028 1.5699335677761732111 1.4794131010226558853 -1.4387184408167448257 -0.98343273215117643637 5.0551401296174356403 7.5459329564513062394 0.70853204015765802737 -2.9787488005471507435 2.9843984819521960361 -1.0574587818111305104 -6.8434256559092521144 -4.0906666439091745602 -3.6454327151993060063 0.31994477060690884596 0.92684023868192177975 -1.9871846159910244722 1.230769722143907563 0.097289559846075540639 -2.3274091913998589121 1.2942451158557335411 -3.835316980733349812];

% Layer 3
b3 = -0.30183407377228405055;
LW3_2 = [0.018333099057030306095 0.24864710661725911156 0.01926638902777913151 -0.014848719101275607499 -0.022021040456822980891 -0.014396128586116371806 -0.057179949426580882477 -0.014962579387507694492 3.7196921556158724087 -0.38723119252326931861 0.32058716108870344286 0.36750122111317773399 0.0063730978062712575344 3.7111243388785295494 -0.016935404208016674454];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
