function [Y,Xf,Af] = ESPER_pH_11_Atl_2(X,~,~)
%ESPER_PH_11_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:24.
% 
% [Y] = ESPER_pH_11_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1889981290161744099;-1.8217042536180283463;1.7358275524488882002;-1.7371904952391148402;1.0536134721542032011;-1.2066004053693386577;1.0284023445457957102;1.2433072385964796247;0.35593324548194094081;0.53972395158635033674;0.90515115284186820066;-0.68686996847244097264;-0.55438651965032093027;-1.0340077851067990267;1.3703402559916784131;-0.65765297671471945051;-2.3266245229514916915;1.8840904220776815148;-1.7394414719853334983;1.8206367309344970717];
IW1_1 = [0.75372065157384460221 0.94425831879107735567 -1.0198617929200659571 -0.47869174708590989109 -0.67246377177402938408 0.59232378463668466928 1.2245181781089962136;0.77319035069859121112 -1.0868458614683000896 -1.3912050221818477169 -0.44999800952972290879 1.5687441310949932216 1.3095903256634289225 0.19279151885643630582;-0.57991387230066782088 0.013883147939906914647 -0.076287809526373748237 0.33254534900657745089 1.7531070196430122987 -0.26395489432896701576 -1.0064062527246946388;0.55846939595435585169 0.091069702466306773347 0.52049752041897445753 1.248201104987833876 -0.14776702892365756181 0.30418439798845664512 0.91917451778237468929;0.42020172484406859148 -0.45698938778389386339 -1.5797614268636750445 0.50606920143101752352 -1.1697557543991754514 -0.33987139233120011728 -1.8240752159350472894;0.86975724881379612441 -0.34418714783472020846 0.25226434445281276098 -1.3623926595857245303 -0.70523852875472770041 -1.0782485869905242826 1.3328827100465556743;-0.36662963473272019987 0.52381734212985853194 -0.46461267739335693205 -0.57299534122216377874 0.45982245584362757551 2.5366858988460267987 -0.31259265126855129147;-1.1470116978936915064 0.0090816048328182432531 0.26226500068469887905 0.096376797846147013726 0.42224141055357145014 0.61691367139147379461 0.29234182626604660049;-1.437824615712042009 -0.32049234216872857228 0.16421844123232651191 -0.56837395261150658321 -0.41867375068589290921 -0.34803702872309755234 -0.96468535004148203704;0.89914724082551256146 -1.0300993908562172674 0.86698526359861538548 1.3297730031292775976 0.20562292500765913528 -0.20768829978506819778 0.6644577354224808774;0.13921385781405257176 -0.091159711660533132571 -1.2410209962171332432 1.6084337180055734429 2.7834734573537094349 -0.31919081177853902975 0.16971001712713476572;-0.57608112475421613397 -0.22959118988583976373 1.2738792403180168034 -0.99484318094654933251 -0.8140947407087055776 -0.54172614183355727313 -0.57012950767133574459;-1.2990578744961280844 -0.31907683372352818596 0.63974448785464821388 1.0672695919279426846 -0.19323867692489291037 0.56388932997609098052 -0.44656011968895065189;0.58641033441653223068 -0.85259352840496438475 2.1851523679780466836 0.28909617248965285841 0.072076286948842632762 -0.36786743363279555963 0.87111551094191541633;0.40665297052962606772 0.29901731453226260138 -0.037779329412172539537 0.38961070974709766102 -2.1171494902219079037 1.0155124763411846889 -0.72816642844280199398;0.19526572811382914008 -0.0020886948485853117086 0.8744860321001239889 1.0238432654131479627 -1.5829414058775501672 -1.0216982523985507214 -0.62123151159479650385;-0.081165809670248154073 -0.27172285102929810696 1.3403633783945763103 -0.50684988764638549963 1.4818777398257676481 -1.2573163047040893936 0.26653577393621996627;0.17706006063995829991 -0.50121067414302578058 0.32194825232939061621 0.83225422970984208604 -0.54884030525108962184 -0.971816336295404537 -0.51646716294401318059;-0.49713059839570356013 -0.078117840328370061198 -0.56890470433938611361 -1.305101709823959899 -1.0702975011670172734 -0.96389797297701118595 0.99551340054471504359;0.14797740998903977094 0.71098846120303171858 1.5225856685138821067 -0.12093548823748906385 1.1179985671316294837 -0.48383455862885055287 -0.58815074122414745528];

% Layer 2
b2 = [-1.6052893322826078393;1.4624597409798234526;1.3495732291620476939;-1.1120111596841653068;1.1007620071479713442;-0.61972870167943672204;0.40233844898504123044;-0.53511645894007331403;0.38918074351288417523;-0.17507152158304176148;0.040923811850833387294;0.17262581168126300835;0.43141880518682107493;0.51328651841901273833;-1.007862916810081888;0.93785418013154508987;-1.0987172977565411447;-1.1751270973635541406;-1.6313335776727095894;-1.4515641581932257065];
LW2_1 = [0.49183867098147332486 0.23242308505434092214 -0.45026440879428875075 0.086104910765530978667 0.23955612682284091464 -0.54542204613928180201 0.23706299169639774571 -0.46785472162852709266 -0.40462281775306901954 -0.43629144682394621624 0.096689577100601289961 -0.0004790372823519684943 0.22068364322482336704 0.44859477451355878053 -0.5911535487940680067 0.42215444437034355118 0.39823005895876928406 -0.35081309629042933818 0.17779986788564175471 -0.03676023610596325375;-0.14591661125189006598 0.078861350917866890331 0.22277570955812314724 -0.3104998061918123331 -0.37955630736610446174 -0.38870869308584671264 1.1401896780310629698 0.75160756877965095857 -0.49852010276035740866 0.86893424281981435087 -0.18775555027602724989 -0.48549714282400585619 0.38693339047046027002 0.27151696576718803433 0.55788993386608243252 1.0372218746827266411 -0.081974280140879249301 -0.10996170688071633947 0.31321629497928171748 -0.5272251917958955536;-0.61850076947986920572 -0.15361553723430854124 0.49618077380296971013 -0.18593746439022940109 0.42959242097321659326 -0.32898985945995029567 0.40703555188686230126 0.4400914487668559083 0.23195167954059869864 0.17431204708644479351 -0.34043895874242396937 0.21250908858072259378 -0.59270635590385289948 0.2453718970764382501 0.20629544779233605079 -0.27463752657121592859 -0.11942039842758686574 0.51394246018824396582 0.31704172383652479139 -0.49123225045540963585;0.14328583654682996995 -0.33669484089786205772 -0.24501090452531226749 -0.0016165922303298086403 0.025511931735575192615 0.16924893995055348417 -0.87717291164798272263 0.35900937596378906802 -0.28416677732261352851 0.25699331432213051718 0.54142662607339220315 -0.18228554245531239375 -0.048515773481390279953 -0.02386239713908148985 -0.081922594478980856336 -0.34452233550039218501 -0.67400062403512595033 0.54165167324478447064 -0.43513109853449394304 -0.28511871144799749711;-0.67704835641332872243 0.77084963700105957329 0.38657563606196609918 0.047619743328687645645 0.31873972060904437464 0.023514445403547988567 0.34596174505174953628 -0.70205605405036053401 -0.43871640718715798624 0.24500869869135391554 -0.020445976766193082325 -0.19621151114541390825 -0.44290470967899980836 0.1021159922225634703 0.22973576109475976614 -0.04698475975273676275 -0.17150603403184003226 0.24263506668760445595 0.16667779993194928312 -0.38051097484860235687;0.51935952188811451702 0.39027275212565837315 0.035149473407107112433 0.015210635885566514344 0.34875341782401636515 0.65344948115311307646 -0.48506729340332094269 0.36077102068808680757 -0.14322550135486411538 -0.34107746252741022452 0.27834703318342801648 -0.91948108608594192326 -0.2462878510957226541 -0.027198579322829853633 -0.30780303435519912325 -0.40945329778233990892 -0.46587328926647991745 0.086918757027682175265 0.3767753033011172481 0.36600936449371807013;-0.25141455887217883935 1.5080301596634557715 0.14289763650720871402 0.80330478044586228759 -0.19111172531852010925 0.018829894755539727802 -0.1091002772977424512 -0.0049450686880397861159 -0.021385854670414344847 0.77957246809632951834 1.4335778699050516494 -0.31883980579262360955 0.21139146205868714068 0.14797044214040599996 0.234940321647595457 -0.115751925989150517 1.2307475090287018915 -0.39608891018498687542 -0.17768320969323744829 -0.93217790975318126634;0.23488871777329872748 -0.63553923982116078406 0.33654152937506742749 0.52364512200269786035 0.51814779874128880088 0.70354665934525129067 -0.55416642506139002222 0.47364874622070279875 -0.0512477833970626101 1.0005655596030815779 0.47414786790537338801 -0.38231165803203798204 -0.32310723806503621747 -0.66644273543761733958 -0.21980313876549123497 0.16848881090908079949 0.6723005391051299906 0.30638121927826900137 -0.068350338313423214531 -0.45098442473209982007;-0.60505654715606371763 0.83961752899426189689 0.32433236636812412534 -0.7052270503268536217 -0.099795394030469164459 0.44545446439917629755 -0.21443455963412505483 -0.29490481907630172742 -1.0150612943710362046 0.010826487397792081482 0.93509718884536907613 -0.13229681856873670709 0.80174084073374951576 -1.2386677335392988208 -0.54869679870649268327 -0.064525806331154220152 -0.20558200364128709214 0.064967880109340334083 -0.79101734579571125749 -0.17871844842548303967;0.22019731678150639143 0.22784750960909466722 -0.52237824512819575062 0.26971899806834331859 -0.51632800259998845593 -0.58376532424244931274 -0.20879178538321296887 0.18656185130987396059 0.051753901165165566711 -0.13805078624113911734 -0.67929719430811708047 0.74912039167360977565 -0.79076874250912687625 0.92953908276747077011 -0.5177739159157875859 -0.16236798522676168521 0.024247762021026648266 -0.54554273423677157595 0.23957799243322686067 0.33467118502027348725;-0.48230562885671474094 0.073132145210581173123 -0.48657143713264100482 -0.21236436791927032486 -0.082035076792437156001 1.2766794224693422954 -0.35245288526212498192 -0.20737721092150052105 0.092028756685385043612 0.050991650450775527492 -0.74759213050407580248 0.56079650431012140199 0.10637986366206031441 -1.4009384321412183816 -0.43313350797186495056 0.52820280322293167163 0.078775774258124903193 -0.063145637107659191578 -0.53392436435834134123 0.42718879564329309551;0.40150613998509260272 -0.032435931729975303606 0.33260272062440465746 0.4376179710621138641 0.5033368684976772256 0.084144043711984528588 -0.35854568596513780587 -0.15536343083990136749 0.28523220336545646036 0.63867932304987662384 0.32268027717686065259 -0.31389546965882608731 -0.12664049553596171127 0.20011193013787886841 -0.40687629286071269608 0.40712810558076151235 0.65306859229835900749 0.23067860495162864631 -0.40042007406466145758 -0.55006743095303600732;0.28826854185558481447 0.18514854014513171254 0.38993893811366636681 -0.42175255316666959704 -0.24253978599267636551 0.018973513389876860841 -0.23911602141473359273 0.02375594236997240899 0.62669896592266360891 -0.43728011070933936466 0.27034655631074600013 -0.048964809218360695608 -0.1786186089410787825 -0.27989442393716884583 0.71470028942798613514 0.49486680906695240667 -0.59984697928120067623 -0.3357455964825193373 -0.036471146948663386855 0.57758830129665628128;0.15281110919491411315 1.2125747577229475382 -0.43047851148513449626 0.048164327525034966726 -0.883216649987651925 -0.33626139248585101837 -0.42289019358044083186 0.41220448920694929829 -0.30633324956348340073 0.21702626243744163603 0.20609680112298223165 -0.75487868868785257259 0.052642583809187147581 -0.26229006632960089052 -0.088937781004779878358 0.20650055446232232215 1.0383111673889853233 0.2576275790213042316 -0.017296281309589805336 0.46836741226686784412;-0.52574258283358388244 0.093399782014032484145 0.028467165837012600726 -0.15417596691278978582 0.14560394968855358555 0.43213616967766915744 0.29229363464446878051 0.77750702823619233239 -0.15306211994288757006 -0.20992593127754299864 0.39078064600023726394 0.064663981481590263045 0.15686636622163249721 -0.17160629487648909608 0.91050113320013259521 -0.99422161062845471058 -0.20210670708507097459 -0.63584935616823168303 0.67363163044551122027 0.20055687354319495785;0.45933669839179058769 0.028284836243432559533 -0.61510610469468196548 0.48761353799325984903 0.26037874065951871483 -0.32659159968725692824 -0.37707305373060495679 0.83730577081998602829 -0.33549102984117490367 -0.72559382449480469557 0.80795057629408995048 -0.12553228034656446765 0.080963070416566279563 0.18961455510273125813 -0.2178960866178160094 0.31696236052909465553 -0.36416350509957995385 -0.17512317882064629138 -0.063196398210244475457 0.067064060718056039967;-0.19974963923212332717 -0.023841829423566312379 -0.52491942240574196443 0.0598240778816200372 0.10352344632824211912 -0.20724439629944602093 -0.44637326679118272121 0.15905896441209754766 -0.71847083894605501264 0.30151360096075130457 0.54303540964366181498 -0.42660831983936092771 -0.52840126522574493162 -0.13908923544365156544 -0.10679808678669645838 0.53778801069876591701 0.61576148784407058745 -0.347305376214575523 0.27603736478638313256 -0.093811615450334881472;-0.35680334055065604515 -0.54450270797165079006 0.45349396198643271427 0.28757973178341716958 -0.25987308495254646257 -0.020896189994082697144 0.43661924794144940654 0.8001506705474368264 0.0012377645869074520302 0.83630842792715098799 -0.24956035000124354717 0.0068776787452367958015 -0.2359272404555656788 0.94090311990031938461 0.99377000755087030459 1.2560080866885574569 -0.75225845100677124488 0.47634437213886238194 -0.52074867818450953916 0.3443828951358260948;-0.25347230779468665762 -0.56218194571151214323 0.28099544388523728378 0.25119383984815163435 0.49987712366244085871 0.55706199021361835211 0.81866692026380427638 -0.37291879256558940758 0.015784204109744490868 -0.3330367584811403936 -1.1457674874037899748 0.61083660757628988058 -0.5962348431296251583 0.083492723107853980546 -0.53134801237918172223 0.51806266078007157105 0.79000371313651918115 -0.76330525102580693009 -0.10194302346404220116 -0.13223138196674810718;-0.46868060334200001282 0.20022666517847539924 -0.028688495094727640283 -0.45558761111223777807 -0.36172023768286670764 -0.41222362534484452423 -0.10745448272254914945 -0.47868877921328994995 0.063711533786171462013 0.55948159838495981067 -0.1415258075084846745 -0.026836167819220036607 0.45731534542338986293 0.19454851917002469186 0.65967212233740712968 -0.78849597434176665889 -0.051830023564359110899 -0.614053978268655265 -0.69320553820240582432 -0.46771738385579308961];

% Layer 3
b3 = 0.5858098437638259437;
LW3_2 = [-0.62256306143410777842 -0.74354777947653294401 -0.70922833863191436787 1.0394279435212847584 -0.66534429621453961001 -0.69376081299819725157 -0.72037524940180908128 -0.69628176298609623096 -0.64981660809657515454 -0.99161875623799144996 -0.82672669125868536444 0.74703658810036033255 0.2864783875602626706 1.0880124033611138223 0.83245014732982181016 -0.94732817653939849212 0.21433190843818208937 -0.30898346855669533984 0.78565860594808922812 -0.93234173767748584893];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
