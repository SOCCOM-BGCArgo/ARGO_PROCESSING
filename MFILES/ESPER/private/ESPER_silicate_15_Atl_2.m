function [Y,Xf,Af] = ESPER_silicate_15_Atl_2(X,~,~)
%ESPER_SILICATE_15_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_15_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.49495149272925792472;-0.94894594494138373442;2.5303765062994334478;-0.11413756057774199215;-5.0212561672067455021;-0.27959229872490914959;6.3122036242334624845;1.1501636563520469814;-1.9952493804792201804;0.8009653369013740587;-0.82869666619438997479;-6.1621653234941149435;1.1757340986493183266;-0.23550439973246756198;-4.3277842713377925321;0.91128719620701381654;-1.878059341980618413;-0.72695785903331167077;6.6958342268234121164;-28.519432949410081335];
IW1_1 = [-0.8736724388095855609 0.08949331524365135293 -0.21146992721375454383 -0.46984716206138316119 1.9915157129980380901 0.8783228524290092043;0.58005385507086570929 0.00032182157239272151219 0.0043428930846614241523 0.06031182817548063485 0.75282041796825449609 0.42813793959807705525;0.34754866381220483884 -0.18299483520843828899 -0.017854894301455256217 -1.1642227966194993449 -4.1310667425349913984 0.4684236280438086597;-0.92859146443711682029 -0.42687777408650723343 0.22476381159082831074 -0.89072806821798533594 0.94134166649922113024 0.87068485537159034937;0.863968871779820069 0.63391485737325847793 3.3864574963298563759 -7.6288178950817195911 0.28873788478564382798 1.3471081402335209898;-0.49897661023224471055 -0.24386806658118487245 0.68504258875639956194 -0.33221105538831113835 0.2724556366478300129 -0.016765811398516242831;-0.30109577979369883671 1.173950488631715583 -0.42565116497114213745 1.3020802093269092659 -4.3835148217216231004 1.8433169802926909764;-1.2306180988773927076 0.19935050643318669161 -1.5999109285859547391 0.53011467248212806869 1.0420417546124609576 0.70663071615928596536;-1.0227831992260789651 0.37218175427293481716 1.1452621615044877856 -0.56874809510794965828 5.3835713642906144472 -1.2220459704248993749;-0.7489887352142694521 0.065899686564633283559 -1.1992030238161615063 0.5305379822869576989 0.81971655397193687875 0.77613075864218883382;0.37794755659092399425 0.043078197150699479301 -0.19318023940009448891 -0.03669906445224616065 0.88550931230210605527 -0.11387110098170249994;1.3619136693438638197 -0.64882517700699915419 1.8857919506521940711 -1.0095747715985130544 8.1032360186920815437 1.8874161586456221773;0.13853284225848708222 -0.75323454258129518557 0.043952890310912762217 1.3862931720191589147 -0.43030672457902424677 -3.1111057771576335895;0.10279947884502003974 -0.51942973702923700419 1.5581504467129225766 -0.77592761115343777956 -3.3781387267720885959 -1.1768224489108285447;-0.13592200647944926994 -0.55509414184081884436 1.3473120224804202572 -0.73292596389160569181 4.3962895411536129231 -1.3053715810993562485;0.12196505066850349408 -0.35955389290412625991 0.1483269363263149121 -0.66084432266104020659 -1.5290675961784869763 0.38690394846334713597;-0.77130306964365324962 0.1647307665406408661 0.32501148756807479723 0.99194517172262808291 1.1248166367420608935 3.8957330223084878362;0.15593649610012194628 -0.33255972242627540592 1.4104286525435585364 -0.4813248815122873614 -1.1303873333194649486 -1.4834731770974955989;0.27322511109487296332 -0.3453245882338678574 -0.02168811768340618909 -0.43991790695830923497 -8.6049326499023131021 0.17238464531034311533;1.3396873700219464887 1.1556116014746633525 2.7780406739087064594 -13.526321730576119862 2.0892627530763738797 16.742862945712033707];

% Layer 2
b2 = [70.93002059104850332;168.84899638075475536;-36.462353715321569325;3.7303275780627567215;76.404643560807656399;-27.023398533664380494;-63.497339174168189402;-90.457328362934418919;-122.5510383061488966;59.513265778991048194;-113.55698820847604225;14.371261346880734422;2.7707385644463311536;-115.42405637325379075;6.3560668224745437982;-6.2952603829119508916;114.41172300763685143;-52.049744234681348587;-33.434790133707203097;-75.618368550774832215];
LW2_1 = [-70.499282645185772367 -23.781038974111119444 49.673590831561369896 -78.445711218098352902 15.778282401584343475 110.26973450242117281 -117.08851161625860016 47.866281079630013551 48.714928844154677279 55.486842086466424462 -38.274169525891764465 148.836363525986485 -88.432775713470562096 40.009553659405625581 -32.042587453193426938 25.849246323286287463 46.417916482115309407 -42.068818877045622173 76.150785135677878657 -58.920805403636265396;25.707809928483808193 -41.964809995406554322 8.9609940339255427233 -24.081714961304204081 -2.3605470365575307312 6.9398556496044543351 -15.158549229082874277 -19.928950779425676387 -73.119414602850469009 -15.296275565105807104 39.432205099007184401 -1.4119755018546966685 8.7670514029515320686 -26.077693330991561282 -10.150942861118844363 49.257631170853507285 84.165974294408286482 12.923823559246795156 28.684175743991158214 91.375858392345250536;5.4487477815190263897 18.905515927151448352 -2.7854947935544145388 3.8926061268347758038 -0.54668802448663089688 -12.503852942717763597 17.791563246532820841 23.064779994395713913 8.5332054127527374732 5.2682791124939889471 -4.8813171855196539894 5.7859695734091944885 1.5079718476927548299 4.1176481935504218868 -2.2576528145002003889 2.7049435211130310464 1.2863238995074040005 22.597692764910771501 17.166901020288776181 13.863629832685198551;8.4871516048460975412 20.813058319853990241 -11.334322136665852199 1.4180585683496140792 -40.853435036097060618 31.880166730156176413 2.5061200243857877368 1.8038572383870938864 51.766869615151925643 -20.977620516820795871 10.786260745408759121 3.5881761834721972448 48.651786307174802459 1.3283372841342520054 -20.271542576861190099 67.827123131941675638 -6.860659922649124276 -5.6305176213066578939 -3.7045052608515658399 5.2622387104584777973;-49.648839677032277962 -115.46352859006505298 -11.9985272386281423 -25.205433294823155421 -19.457682819117987805 107.384095255096085 28.792158604917723608 6.9377207254887292009 -72.374393143719274235 -31.868614842944602117 115.31060757503314562 138.68412502350923887 12.249103948738572001 -25.600341388274369336 -52.781352052354648663 2.0781609775858687073 -68.348632118254585066 -16.638326363984653256 -30.451223308990087446 67.20116402164674696;-257.18313465978138765 161.41439557011767647 36.663928886746383284 50.74133553185433243 18.206587495245347696 70.02927748875399061 -158.60490294622775309 77.31507747312190304 55.394504965487350034 88.371658512252409423 6.4967666833867330212 -48.316044246924427341 -51.718507561116666693 -45.507014744882319235 -6.1606513663538216008 -79.221523545606245875 -43.682607414953906755 15.576602715246185227 40.791969393023393309 -181.31545848067798943;-87.798111974106404887 46.586821026989461814 61.077464397843918675 32.825542197101306385 3.7515213266621838528 62.027708949394373406 -174.15198479030448198 -36.820737808276049918 13.699482447789087303 148.99503224598436191 74.908568252533839882 -193.45996665783755475 28.955877034912873569 6.5838704936504370835 -38.932786918097015416 -145.59448425137543381 -51.99057590618872382 7.6241077791115294815 -20.63812049442459795 -22.353418279959921477;3.5245096510280480295 126.2508503179210777 42.897995219615467022 64.20793329618061307 -83.794712078030840985 15.97565550410454982 28.080872819788851302 27.478405199128747682 25.904390903366039112 48.429060128125890117 -22.368107566883395521 -1.9109090903054000155 60.608686033097697532 2.9642185819853374973 12.34274993178473423 -91.09066145006481463 -45.594869703342126854 -36.825301526577554512 -52.174190440501654109 -95.584572746326173842;2.5663564774505398525 -36.791696861095672944 -12.3852599316534846 25.936857592986228838 14.396099906616022679 -65.375917418779678769 -7.2838798721338937625 33.887429374788105463 -26.335575074599162804 -4.78368088149011772 -19.854504836631964082 17.788159420539525257 -7.8645163146424579281 -101.19961481498795308 21.347958048150246668 -26.32677591913980919 17.160925037034004959 -2.8325736701787542771 16.599740877888891077 5.2977836879099653444;39.888392727705280549 -355.9094830132424363 -50.646184940303129451 -22.690400818200465949 10.498835227302668827 -203.50732898007271388 52.72222454078314513 29.723677601735847276 40.019900833554139297 -18.182772071323679342 20.728849882758204615 -13.779481687774376653 32.500414927143964405 17.461075032487581637 -40.23336545760363947 73.687902295476163772 -24.937950128764114766 121.26795916581534129 -288.09484191986575752 20.553457101315270705;-19.005821344599066691 29.730143767329167304 -30.67468042554914831 20.996524491452696282 4.6869278801300184867 56.703020294760676734 18.896987448283528721 -8.8226212266795585037 -14.558084873208468224 4.9144315060876024859 50.157191354938966299 -3.9549334686072263878 3.8235927321928189215 -27.430373658417650518 1.6625407529717879385 -2.4263981158621894529 -8.7210682061673807652 -8.4142365319345859831 153.14721486976159781 38.148607589203479051;1.5847987678075314832 -2.6128425731304334434 -2.3612111538400166744 -2.310251412306105312 0.16732545627328226923 -0.60182333446743918604 -4.5029789327349805106 3.5151203074024555129 0.18649295942873189702 -4.1867214507742804841 3.7977365502103292982 -0.054009891728745450246 -0.0065279875436158206134 -4.1682720755178577221 -2.1595758405110094813 8.625366532017610055 0.24004335956765035509 5.5532629900469752116 -12.957774494019457023 -0.21055212061106956534;6.2033528776101656277 9.6648491900371134022 4.9700553853302196217 -2.4281682945845832755 0.088364925324293353004 3.7130829589592919682 1.069512347750918746 -3.5202881568693999981 -0.0022532406879302341492 6.2349271517403330733 -5.4066281124888320164 0.9294633388277153685 2.0591949605714128246 -0.83647844536320314912 -2.2036725157452621282 -3.4072716242260518982 4.0310874142187484992 3.7067289948508888031 -2.4272419670758127452 1.1425478645639099984;13.203255316935157637 36.893802246271881984 18.905409294607263604 2.9544999315118993799 0.58985667424347165699 -101.27241333377149601 -8.7682695261707799261 -4.2498390876455429677 27.598767185921044387 10.436818517360917369 -146.08617252084371785 -3.4332833311468258231 1.0236341208953749771 -4.7349521915741235034 30.213059854482811062 -14.809927401740004882 3.5790843691460607623 4.2339489124795974817 4.4791578800480404965 -103.85406949483127903;-12.646234564886491114 36.339807960506284701 -39.852611719201661344 -3.1256637759270358146 8.8640459388202508251 -26.341572496868156605 -39.801814720979585616 8.4927063066637895616 4.7131601200591450862 -20.45860573988574771 -93.769718188646592694 -63.154181885909416394 -5.9581290062602878521 17.301531599476600576 20.941064993990412546 33.391910767319657793 -53.587895597920649493 -19.470952564849500988 36.878439007396352167 44.685871663523812458;-62.391542935681030713 45.344062321603622934 -14.231543679778297928 62.009405278640045367 7.99590659878697263 10.511910378712581604 -19.388488806156921385 13.82603204963004373 -2.907752096541406317 -14.499044220775079594 -16.156630317769401728 -8.1031261953510771434 -0.82579270863627929344 95.395931968583212779 -1.2245496202523369345 -11.067828887589016063 -17.12222727105475073 -46.269587075217415872 5.1734003792807969901 -89.232491791168087047;133.39675437308551409 43.748404764393896471 -47.252839055391099521 -35.579925679197650368 4.0470076183279486415 80.070826608558249404 29.867464544612921884 7.9449653662052410752 -105.47688954886892532 -90.162246990098410038 -50.228088590175374861 97.828639323415970352 -57.450239507054376986 5.6749216994181157503 10.175022778333392637 30.078571614153354119 17.815818513809819734 -65.352329854176133495 29.35938799809439459 63.22918879715544449;-8.2955495355000543611 19.042184900018092719 -9.7617185231907210863 4.5139361863972355948 0.74469897565139220319 13.894003292545571426 2.6492296695339461188 -1.6135438338375387435 11.206942722298682824 8.6874722608852330552 -19.999327037575429955 13.948223052516633302 0.71437114639513876746 -1.7757810472002273361 -16.576133704541522462 -0.37277210135039584582 -5.2667026142272588274 19.413435240282929328 -9.4151183382577681158 -40.962641712769467972;-117.69804091732896723 89.573375293111752171 30.729680673220773457 49.583379712283829122 0.74929416969692252959 100.48216153517144278 -42.831806745083056853 -8.8687831818929634409 8.9572591149168321323 40.747874975853513035 14.782042153736687951 12.418425888217550224 -14.217896337503013626 0.47423381302630185363 -15.97290780545253952 -85.746988965247240344 -60.533537818476240489 -64.020404812545592677 15.255594221521036502 -67.897291773165520112;10.494360696494849705 33.347733026352408103 1.6554532097033438642 -15.500066333383989203 -1.4529851298109632829 -14.608362696813715687 -45.929099372377308441 0.43589244102019519822 -6.4979173613521963304 -52.38955627905130541 -87.382190433047412625 9.5444821013933633935 -5.2910656658576886713 -5.3521079236642847832 1.1316336061021605719 29.701656412734212864 17.305893017202709672 -35.755294404649085038 3.1364664923285521247 -137.85267888912093781];

% Layer 3
b3 = 1.8517381022700509785;
LW3_2 = [-5.4276455180903216595e-05 0.003904968579678122758 -0.04250275552834128362 -0.0088546258012029595286 -0.0091757872248700560885 0.0066216640258314456852 -0.00046476631066191440803 0.00056359013127493568125 0.01128501122673658888 0.0042514811828223602122 0.0089109659391762713332 -2.7776716190759112024 0.053090822416684578522 0.013759350008401279725 0.0049280621601382780528 -0.013755501958429157058 -0.00070078542333739388733 0.017295011166967341754 0.0062941111032119596153 0.010664585393376412037];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
