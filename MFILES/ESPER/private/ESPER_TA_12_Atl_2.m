function [Y,Xf,Af] = ESPER_TA_12_Atl_2(X,~,~)
%ESPER_TA_12_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:03.
% 
% [Y] = ESPER_TA_12_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.8404439741776235095;9.162912248461342557;-0.92046146155454344751;4.5574732390313705821;-0.26437066636342732018;-3.9170587918642234548;0.76934022597784068598;-3.1882544961340020251;2.7594726118810131155;-3.3125363281269200044;0.77129929326239365928;0.30993406375642074124;-2.5379069360185804172;-0.48798588543595272649;1.0991750219474487604;2.1787882363811981179;-0.56945156336299207478;-0.79291361459771503295;0.36871083717384989242;-6.328480589771741549];
IW1_1 = [-22.110308595744932347 16.520149522635428241 0.51710700993939473502 -3.4307636468129878438 37.068960044673502807 8.4690693595545916139;-1.9945487207892040882 3.7306094727768033259 2.7242283515555207885 1.3297990138918049929 -8.2650429716772855215 -3.5880707865785472777;0.79745660823972497333 -1.0528648989798581326 0.79693990688097959829 0.71354321432299916417 -0.46549429091539307191 0.184826502751457733;0.27627438909829549196 0.76397268467372680956 1.259679595706373112 2.2288554512777576377 -8.779159103855695534 -0.4641108223298698876;0.40365527596770528485 -0.21494501024425857749 -1.0310098168686092635 -0.88330556275554261703 -0.99256309840045653381 -0.84179019874623517428;2.2970732368680262248 -2.4660725287792040206 -0.048964675098575327628 -1.2407018578112458673 1.5343516898136040361 -0.30080073793900630186;1.2774162540190645565 0.1479172070855800103 -0.10303594541869315337 0.25786276636833105336 -1.7430243922761132769 -1.1236327719903547173;0.23425908798606481787 -0.63176496140062710083 0.2774996236102407754 0.35074336937114680701 3.3168018725013341808 -0.48735891192051483678;0.93971849603510204663 -2.8102993158962754627 0.38658998122982596302 2.1692992071755141659 -3.3701253166343905221 -1.0267955621088666884;0.51069485110291235053 0.78639273800213271848 -0.13254541140674649946 0.59661698662253370706 4.8998632268901385345 1.1859688404470449807;-0.41007456458698487989 -0.31026344493287522086 0.15568548041763885514 1.0684862745785996818 0.50619209530828745969 0.53397079998830576653;-1.8402868950374062784 3.8199377371847522689 -2.5804831354534316645 2.0911663109724627496 1.663941349213318599 1.7056770779009120531;-0.3498690649027596522 -0.62353291029819446489 1.3000885302591009829 -0.8576703935269682777 2.4718273177946308294 -0.14653434949794263975;-0.63526258713727157268 1.3237248478553691466 -0.66032350326843636257 0.1279144972666661495 2.1276195544062352916 0.90179434662375501652;0.38104268698097271129 0.59733217285465023405 -1.361535427191435943 0.74589859741674424676 0.40157847936252621945 0.71658823559477546894;1.7339853268186822266 -0.011451802120611507402 -1.5009510237480134798 0.14139430057912796834 1.9968851535139005016 -2.3107488392840522806;-0.39049109448057006677 -0.67668809734611812257 -0.69070028418294404648 0.31810936863674948993 1.6554703482128301228 -0.36473186092946191517;0.69759772523669894007 -0.10242902285594922274 0.13089389346765728517 0.53153727973059106127 2.0479110081205389449 -0.38052186718298669499;0.28374047776325894699 -1.098015392402110324 0.7273227207126643501 0.085627832496107086913 -1.7471510230888489534 -0.83860756885534304406;-5.6379791190850818694 1.6776675984000493091 1.3326464618886735281 -0.36404598583376163168 -2.5235904884727258235 2.6224911412088287577];

% Layer 2
b2 = [-231.50792390100349394;-179.93231953196942641;364.34152894185740479;423.37975614592460261;-1203.7180201306682648;57.880501595510388313;183.3085213752445668;431.09506901271498691;-1217.3519011242074157;1129.6575661440417662;1.8908493411718927391;-960.83956045600132256;-20.855494138607866716;1617.1824827195598573;-400.03961777250611931;1996.0996933372584863;826.21897830259217699;274.41799505744660337;-108.91401816939890068;-9.08316190827877179];
LW2_1 = [-79.87421021539947219 1579.5767883724793137 -799.15282181744805712 956.68543656678320986 -2051.5328791836909659 540.20745142172143005 718.3693621636990656 2473.8674730586853912 414.60182822476974707 677.11808284015978643 1734.0070850473359769 1428.7996523618096489 1818.7457066266026686 -162.61311851911528947 -666.01732864942550805 -145.21563156304054587 820.84883590994525093 947.36354865819384941 -765.11081227480622147 -1426.0581236731313766;14.97176706389181966 42.817554482444123209 -52.499693812390326286 54.496947337651803878 95.430863006330781673 98.651779209558384309 -26.237327868326644875 -72.954085874921247523 -26.839241863848339875 98.293115146031098561 116.1909850137238891 9.5241004578316381668 8.8910235645230883961 119.82211584214545042 70.853784054391056202 102.72379021749127048 -91.778499130099362446 -50.464943759662027389 307.3795370275508958 -55.996366531184733617;-9.0961413056085937967 -27.416639736217543799 28.82724276769378946 78.347903960298665993 220.96091311656144285 -222.62464464828556743 -21.156012882432790434 -226.79832904992250064 214.3615313197002763 12.876661476281478613 216.48986881610028377 318.96006243946442282 -917.9493738009163053 -147.83848785247789692 -957.43375199799481834 -230.95990977713034908 -236.42406787172544114 -68.608205899496525149 269.90935704820145702 -124.74534214412001631;-7.6793970184367559284 -16.292753391400246699 5.6115622458199192479 53.106211992255929033 -40.045997984760610677 37.108001245487663766 -34.201111177776617467 26.3550049554265442 73.467750522785848943 41.551932589377166494 -76.353599641617989846 22.29051750954478095 -94.903845806198660284 -245.35904014674289897 -87.240388489385622961 -256.09340800833490448 14.749359867052453055 16.153242852129011453 -296.42342354744414479 89.115222031036466888;79.252637795809107502 11.451926378986186705 71.801966973630115376 -47.478574636034430512 -507.69691540977061095 487.85692698486815289 -367.19109131392565359 107.51591177272126743 -53.902665400761833325 121.45711936432388711 -1385.9906520168008228 281.07704369858612381 -4.9504280893577208289 -1341.5050620931056073 129.48820801889050358 1054.4270004369375329 -446.6932244072114031 -83.45640845388099649 -1416.105969960757875 2.8893563887252766698;-40.118636643352097337 -2.6452289519074239088 -6.5680323062595524775 2.7821384987353616758 -5.2678182536258821855 -1.7675830730670494262 -3.5091160596218289314 5.0445992193091644396 -0.10234422242702856387 11.945541947205162714 -4.2063987366103052778 1.3105380726328881291 -7.4532805296120505645 -3.6509797547968889653 -4.2524389203062922249 1.8429766248581105348 -4.6904736501748462985 -3.5856309994566863963 1.2646985804303363388 -1.9059390202878427889;132.03407231131285471 99.681397440171934932 31.297947486347098334 -57.94676675039217173 99.42737183882674401 -83.027705344260851916 27.171844007682267375 -67.588425059381421534 107.86182442479780264 180.68052286585279376 27.20593485208543072 9.3616577713586721643 622.568080193229207 627.33712737623307021 528.17654830235267127 85.581208603133404722 -83.751948133280478714 20.633751497657012663 593.1921330921554727 482.73252870667226944;-957.17865648059159867 1052.8499994767241787 26.674138587835749092 -84.310215536584479423 22.604615484563037597 -206.28996878732300502 -57.505866278391700064 -295.929590070081872 177.72635716631128844 -109.45706847157788388 -104.95093754035869438 697.80077034145494963 810.80369899715378779 -529.40297988748034186 849.54470166546616383 195.4989468893181197 84.732065343435991167 86.282903828909709887 -365.84561770414143211 508.28839039633885477;-219.53853482344976555 -21.612062971540794365 -163.13796532187518551 -5.7284787262693193099 -425.31032067341379843 145.76187107910402574 118.96410178580109118 110.48017716732694282 -100.86379342612869436 -27.088072985512013702 -88.508389972954347513 50.087369889350583207 468.55644870206197083 654.44960804103573082 614.9077551408358886 210.90599470626600009 -89.101926521443516549 -167.35929506779856979 580.74541053684095004 -1317.4346768570974291;-317.43283107204894122 -140.28811720094424231 27.683805972744927715 -0.42171581750979986181 18.367534927024472324 0.048591484344672281059 51.142376516982643864 -299.30186683319408303 74.873699854112672369 -88.118798818092741953 234.58016307218395013 151.09610926928593244 -132.63109127428006673 -100.29114191322609884 -216.35186665121193528 165.78352530507387996 -35.705881900164087028 -104.54373422864838972 -32.405740489255023817 840.43042353551106771;-0.08648025386622459898 0.15823246639649601875 0.27188355987080803366 -0.10174498639452413118 0.99756243153478707519 0.23945424326021169659 -0.096237849712218756504 0.41317245570358901441 0.0075124777309507860534 0.6349864967804993432 -0.14749370372457493161 0.080406333298594145909 0.59652022470606380633 0.278192446423425499 1.268301022670263567 1.3417910750774511008 -1.2965253676192236565 -0.52571857693257684208 1.0075049012616310584 2.7640614673568744131;-582.1019876668796087 1498.6539224304663094 31.638093162550759985 -32.54271486553408721 92.802221975473997873 -79.321863667206557125 2.1618774830315539148 6.5010127091532101673 57.805123845474078337 -188.1215765343569899 16.073897433708516758 33.969941293037543062 -65.908300819881219468 -174.33580108853757906 -56.622322648475908125 72.156680645532233598 -89.416755270670023492 29.501593061589279188 -263.02564049966099446 170.42428411357744267;212.50972642460493489 28.475948652110190551 55.064025467245805601 -0.27507012203809683148 13.592569757760099236 -15.062857871117364184 22.562456655942632722 7.9050747134642058711 44.092283479308363781 -23.972696452320310101 -15.650399733352436726 1.6305612075488145063 28.499218655334352945 -25.599356065904583346 6.6485808970204480772 7.7950153679921374561 7.8969512431172068645 -23.139865116967769154 -120.11593784312780997 193.78063769951324957;-302.88487415941585823 61.512690852999554636 -123.21176926833928178 83.380761780303927821 114.05689504103499132 -19.464786788440044063 -20.19277510916710483 153.62907508355908703 32.875814466363891597 74.298454802150814658 52.044074208618511079 25.039064329873610859 -160.05451600118496458 -355.52927471307651786 -153.39538640659236535 62.21394481305436841 -40.90771470209796945 -239.40633878363180997 -227.8174759018409361 1265.8167946535636474;411.56017538060706329 41.745803147270834188 57.599035616838413887 11.361940138349760687 76.954932540314544553 33.200904945704031945 -18.769172886529020161 121.32453978033153419 -1.1814093552567934697 -7.6659906735944867151 -20.507268812101170141 13.833334954924774607 107.59755146031486106 64.339584153577916936 -33.533826376156810056 -204.4394440926147638 -290.26505292622925936 303.5071003249062187 -53.526419431172612917 -423.27352373958751741;705.21538667784216159 858.13067204535468591 -153.04625567224394445 454.90477278937811434 -836.76121663486287616 882.45634760358404947 82.584918284738620287 1981.4947459453726424 -1934.2136180712041096 -138.70172448517587327 -965.06461472826515546 3.7648337489073444573 1421.7579437916306233 3361.7407900543585129 1380.0185222233251352 -500.89499858209268268 391.89302136184880965 2057.6504219196604026 1530.6917520008819338 1539.9179524817109268;-615.45308066544771464 366.66064911642916968 400.70817750266962776 -208.30104339973976835 637.56607877069495771 185.70709943923881724 -649.1456172500595585 77.586090551962357154 -93.493592644313935125 -18.435243311925002985 -193.73093775406283612 -85.065748383634641527 4529.9863214809429337 302.01588952533501242 4565.1735056836187141 325.15575060133409124 161.65745627892357561 299.36604131329391976 -531.05583514151771851 253.2317893312203978;-680.46425827344319259 87.617993848417185632 -311.32087964245749845 108.44271471168761423 83.710589622085464612 -146.25062077852288667 -642.20833836872964184 250.81868742685679763 288.37171395693883369 -192.43930308816760544 157.50519435553684389 -394.05175850721747111 -142.76552628784898502 238.13428288943163125 -309.14466542331319943 146.43943055621315352 -137.21553398641154331 331.26082961311038844 -604.77997583987348662 -384.87970778474556255;-26.190240028608528178 -2.7377680946386528937 -6.1453965023937708878 -22.118375243081633386 -4.4766122870449658322 -8.4382904598475416691 11.887158904771329304 1.2650995477253639265 19.78058794707400736 -23.110905026768318038 2.7235164346416049774 -0.99739792775367608346 9.4711211167442144188 59.926200137227858988 15.751932176921268791 54.366897152033246243 -1.6634447235146117006 -22.962601960619728914 43.871262424448048023 -54.70075591510033064;0.069204129095764552182 -0.12919775376344178053 -0.32506700686973044601 0.13403085687457078068 -0.9796281003112639052 -0.17313522363514152747 0.32430558570736700563 -0.53594669331702005088 0.054579812899378708779 -0.76301087495281183504 0.19588091236585428168 -0.073902791013356020078 -0.54521048718997666693 -0.030961254029620386558 -1.1671145699118352645 -51.033437576577760808 1.1740331977787525908 0.24840608232614788675 -0.76294876148521395542 -59.65319280271499025];

% Layer 3
b3 = 0.55392566291253597655;
LW3_2 = [0.00094252572380373455131 0.0019491008956156001802 -0.0026378834904151157899 0.0040902195123250478098 -0.00064110036875915203669 0.0056468411050334624962 0.0043553987814566041958 0.0017168633873640936054 0.0020552765127840530446 2.2881674217125414015e-05 -0.79475754917760121909 -0.001937223794954351765 0.0027813558112230072836 -0.0017687037645659508568 -0.00048239037747567281101 0.00075694083346936925916 -0.0012935356387962987975 0.0014837522913266518957 0.0022063810975414123276 -0.93935856111300641835];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
