function [Y,Xf,Af] = ESPER_silicate_6_Atl_4(X,~,~)
%ESPER_SILICATE_6_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:40.
% 
% [Y] = ESPER_silicate_6_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.11256697246394706258;-0.28995773756455645032;3.3243861385351722859;23.145525890172624628;10.956140247879059046;-6.0528815280466652382;8.0899031078897483127;0.076254942251035212619;2.0063944394209927147;7.8907872726295851251;1.645221991627974889;21.004344170968817451;-4.2028394210731816472;7.8038721473914582916;-13.622719436821414618;3.120399964404696469;-0.41914668632765178513;-7.4768013419616119464;1.5999072952063075892;2.7616444279649408067;1.4244879962230299064;-3.5790940022083774785;-9.1633193239193975188;-1.4137144772753740263;-0.76053064903184952605;0.43098008350404876099;-2.7726012063038862898;2.648739490837920485;-7.646516515548437809;-3.5468690910151794426];
IW1_1 = [-0.038913924712061412348 0.7434326896876664037 -2.3413351151158194874 -0.79680032980683679344 -1.6672342730588194382 -3.2234000403735008078 -0.33201846813843166606;-1.7415057779860407816 1.7638736524466449573 -1.1208369571026104428 0.47322201134346142393 3.0287988897279594092 0.60760838140609296776 -1.3425638747101298343;-3.9701330189493311273 -2.7778110569551301978 2.7462392924637666347 2.7141128936492417978 -4.1038630361624370835 0.065867286233259214612 -0.8139081723772289001;8.4288814853727469512 -1.8506669139083331554 6.9952163951874570813 0.17814662320885452096 -38.603290721473300096 4.3420847193461176161 -5.2208216781082015245;-8.2375485726454922286 2.8328242826936760324 -2.5667539646674324416 -0.05574002545756034932 -6.8939635230032942914 -4.1765853291974393002 -1.0410632928851326628;1.5201129973587061972 0.031604113808059206003 3.0347911721485636427 2.6226252218361731927 12.702205593586485932 0.7627111358954830056 0.6123170867344384094;-0.7186502234475018458 1.9707143884231301811 1.1472217306159431249 -1.0232851543738512579 -7.2366625745481174548 1.3572960826128825929 4.2403952436897176526;0.3475363766028731205 -0.77000572007172718436 0.31743414684770082657 -0.1740922170693172677 -1.2386000143868682866 0.075981809555480894769 -0.018709184545591072552;-1.0551083187088146076 -1.1967616158656544378 -2.7677983124378964241 4.3512372473063631872 -2.2318004167667808701 -4.8285714695958672493 -2.5387728623920167159;-2.423697286284712149 -2.7962435772071319029 0.086770001487363287995 3.0304828864681887524 -9.1655681821845558233 2.3312529006651794283 -0.92705743680680596785;2.4250812051183086027 -0.50457158550545011533 -0.55988560821305910498 1.7804704484066316006 0.53121502872328218992 4.6082502462822985123 0.72863724929674522635;-4.311068621295403247 -0.028645307631495572909 -3.8345187743193669405 5.6321373280011028939 -16.969141774948248269 6.8163606264144815938 2.4590711167303771489;3.1441193973395717975 -3.3299762529344083539 -1.5762792426849316918 3.3875843087129866582 6.4712248889023236131 -2.7326855059240897639 1.3016303000477580376;4.2490718779671645677 -2.6802732438545420202 2.008577830054133706 3.8015908329781002983 -10.940698680546597998 6.4171832214169546305 -2.4818679711341187222;0.578564789545595759 0.12458152284472381877 2.8532942177443882947 -4.3243168210793143658 9.359827447139128509 -4.7121362352034550369 -5.7089361026249587638;0.094141824642002505663 -0.24172994527236194018 -0.10878164706214203672 -0.066523192996559912804 -3.2121240252857647945 1.075872471693437582 0.28471712820743111383;0.6001241850276122225 1.0589654085748294587 0.16862515857865104096 -0.20692192518890956121 0.73364068501062940086 -0.96129325049825187222 0.10773814676699780546;-5.2487053773923610933 -3.9529823809397566237 1.0876444235826403517 -1.4963740691468530031 7.4412250262918169241 -1.1199215899812871022 1.601959837467807013;-1.3591821409162310186 1.6242468753118124436 1.4536546441719808698 -1.1235273870477380243 1.6577005038120160574 -1.1060960338283400972 5.8852454306400900919;0.13129933583345607118 -0.11405779399053547762 -0.30392460733760490177 -0.059166626674822822562 -2.4816179644903639812 0.65028815078937751704 0.60445004725184081629;-0.006855996673565028024 0.16215864367468374452 0.5843163153065353832 0.54599703103781405122 0.45803898954077598704 0.69063792306469906634 1.1272703940225661245;1.5230141216723964703 1.7244576052489524187 -1.9302401921195229129 2.1617375719100619946 5.6969527431692181807 -1.5484855849319409948 -0.45020151929748219999;0.18386468386455645518 -2.2010603255352880758 1.5286871897055283043 0.12855679697468155864 4.5655091001347969382 -2.5748303318341640988 -5.3673759306321651152;0.7375128122202634362 0.061661535123399738301 -2.3660132460707350432 3.4085609258523974496 3.3972085252927328725 -0.22845967421629670424 1.4277291894178487652;-0.17908957569955252787 -2.7138846704663155407 2.7480253054228906961 -0.94633860877043840532 0.1037323141988252817 1.8516379979582966442 2.8150339363766621048;-0.11651332493154664682 0.49091198200039870558 -0.028830575379823600302 0.16133276076963762313 0.74516721058425439139 0.1256114400928570185 0.21865836887262637966;-0.42261218475473355527 0.3634202668078374554 -1.2455382746378107495 -0.87353565943908439984 1.664385064174859874 -1.2648067068494581733 -2.4277997787012557396;1.2814445585618168266 -0.1774503133453952386 0.14359110038544745103 0.29918843592066918236 -1.1236268549578953824 3.3443891795523619237 -1.9610810169428782856;-0.85705357992393593758 0.64439409627782529011 -3.1172263008474874191 -1.4802452766853810839 6.870134339526270395 -3.8893053137672866093 -0.76332198201201684196;-5.3166380139918230086 4.4875983016792622138 0.93028780686994561044 -1.6068747874352922178 -11.34075137304246006 3.2853906980975273733 -6.1747078160870261243];

% Layer 2
b2 = [-4.2661228750822894895;29.293752854688353437;-0.72360623557382541815;26.980448587608229616;-47.31043964875593133;19.746486220595610206;46.399117332730710928;7.9370966108995029131;-0.58312055563966014304;1.7154956697102601293];
LW2_1 = [-9.5470602225244576289 -51.601089848065612387 19.623516464858077768 -6.0875424412879217684 14.468475469554189061 45.252054212472138772 60.972376322411285798 23.2983437168022256 -12.301676338429350821 3.7314230667292713761 -3.7737452629766017331 -27.572037756009507348 -28.100699770494451002 -43.072224196431101007 4.1860581280555777539 11.804301610013746782 91.31723811255422163 -13.222447754731627256 70.27550611370537581 7.8681203588811312599 -51.762392291895011454 8.7416163387336034418 20.082612570024679144 52.815179994987438761 -4.0862232893618797291 -25.245394330182307385 -53.955069442662015433 -10.225272165986158512 -27.071767127011352017 -4.0946416262164202493;-0.17246783088113271099 17.34600792754848797 -1.0845505334584966128 -26.561894905141350876 -15.676089204530649468 -31.477386594789926733 -5.5417388018225137714 27.382201905760535254 2.8312149659936531876 38.941134959194918963 -1.2988803171460234775 -7.9665173852481672157 0.77333007230272954313 -13.717164160298825237 41.673439666917424518 24.297103626923497899 -12.330818606984664143 -16.8184586809253247 5.341811382028611277 -41.571905313607125265 5.7170487014791095959 13.159322173559226954 -20.3349442019578035 28.503126475642627469 43.840122610638516676 -9.103182903634566614 47.259521459078449368 -24.17356565773220467 -2.2095128206332907972 19.846245163983518012;19.659488334394168874 17.252692168279278206 14.091994156305172936 -7.4281841181446282008 5.6528736622909852017 -22.522797130369362151 7.4382436110469463131 -46.577004731611644672 -5.4512167121664409919 -39.94095733394716774 25.300858221098696532 4.7413960227728884078 7.7817599194078326263 -3.0978730409645396371 24.865021820630243354 25.3567858413103977 5.9307724887701125382 -12.441849464466786301 10.417184451279560164 39.290500763538851459 17.130217164945154451 1.2834015504478675229 -11.758213603916079393 -25.149646494657627471 -35.339816673621008647 25.818649102455758282 -35.084198401119408572 2.2532966599446133671 -5.6784557476782495655 2.3710494674663862291;11.665091528807950638 106.28905028796123133 -0.35942831837976757514 11.976239099169843527 8.7863835270803090083 -33.016064270940084668 7.9420234092902832757 90.799814215213828561 1.6346327223750594104 23.859271962931842381 -3.6659010199297954458 0.35620102110725304634 -29.779014568785406425 19.406569796719580268 -35.872592362045125469 49.049913219804473385 -5.8793078153314182188 -15.594060861878601187 27.389983960896387316 -19.03354908299290571 11.812891132942823447 19.688880619466317512 41.079402766425253901 55.903890702864167395 -23.206522061720686878 -29.517942571078116032 17.614628048656776116 24.454810434755582804 3.5497146296981609837 38.655384931863608244;1.7245630745116258264 25.883241819378003612 -21.149100051865548977 -1.6853365994140663275 13.708237727766560354 22.033632159984581023 26.105215287922057144 -2.0890408579287349511 -7.2172897010204533075 34.061020796837212288 -3.8733626186823966187 1.3631405489164039047 12.108595495967808375 -19.74317386700943544 10.531976592440981833 -16.764651341824883701 25.299671091474454698 14.553331537869878431 14.995623660244755015 -16.368426827556472603 -31.155250621532960764 5.7654858933804806753 20.900933946698692978 -31.976572998657772473 50.308735766242804743 -11.789069134296957131 -45.401152611067224996 9.8556422804788024195 -22.411682087509824157 14.740387291037146511;27.233090548690366717 0.058094767329632618358 -20.127159359865096633 -7.9518031330636738119 -39.476937726347244961 -38.929988334391431692 41.225234081401453068 35.648416158213883875 36.155468260010394488 -30.672392653410909702 -12.378007690574152733 -1.315091022080988159 -27.966526140815908263 5.7629358732497193429 43.089120278718461066 35.671089110223185514 -7.6094555594062578407 -44.086666242831007878 -0.62015247244921067882 -26.968684736159616477 -0.3127011042027546539 -12.30729642014703451 10.115949987465793214 30.602840209410381078 -15.472756832215887712 -2.1489789086073454172 26.305566183093500143 -5.7367876633406869047 -1.043389448494307814 10.527952811160865565;47.113495840582267249 40.866058905500928233 -0.64177716202702550508 -35.227280964989709844 -47.951096263753726134 26.819626804084013116 53.228843891836390867 30.997376548418305475 21.966849438664372229 63.188628785129203891 2.9042898089939783723 -20.778079730178905749 -34.725525196884518664 54.234513810265625011 -7.5369800515073492875 41.756973981917248295 -53.349746905503089067 -17.829556911282857357 -10.993469154057471826 4.4490591385369340216 17.096691018528471062 0.72514129515882508326 36.508056581776699545 4.6298330509685117207 31.225356305325380646 8.2167078933719572831 52.672565812991813061 -23.644633661105462608 30.567901989470406932 -21.680905530966168016;-39.021355384912062902 8.4336486173496503227 38.686088620116372283 15.255249883240166398 8.3249040953296358225 -47.073555886771195844 23.890691011298439861 -0.59710009181938739076 -17.577352882799448963 6.7715394918290723325 -4.0470329660590493859 59.386379308516239917 -4.5929477052976315221 -6.0017268500901739259 -4.0317590068297768369 -76.458163149435776518 -18.091916847668958468 -25.081583614994723774 -12.286537984598764339 -9.3619807346201611153 20.509805889189134831 -34.249722315749885126 -12.613535341660279343 59.765570448501335932 -2.7013180608694864482 74.799191417338164456 -3.6904390205629291621 26.038632562933795356 30.769737314646132376 -1.549882555781487703;-7.8310376619146762067 -4.8232911634814614743 0.82425096343859372006 0.83705119015841022989 3.8143313315261115903 4.2329370226070563987 0.96049004003083593428 -13.388554268330899788 -0.15169724486678512476 -0.65939478852593735869 -2.1580804696321833624 -0.6325501037551903849 -0.23807522015080292976 -0.18048321448291818059 0.49041900347900019286 12.348201731021809735 -2.1059104453003811841 -2.1128199269603098465 1.032323547223864102 0.11501364620850548781 -15.382668410814634541 -0.90640955099328179845 0.7591279880223658072 -1.533648422227721575 -2.5757821704007595187 -1.224814122520942572 -1.6110070906830482595 -2.2597588743242544851 0.77765883115425282757 -3.2741749126329944275;0.38252726405793324727 0.13619365359631593893 -0.02071992828216247251 0.0042882163002049226291 0.025712674880060185784 0.10539155598657723445 0.010515555201117372103 3.3853829423647749941 0.030511454688323433326 -0.0065785036981203682399 -0.12811244273826474793 0.023569467337042571131 -0.11637269363553690016 0.033604681213186722577 0.10686137570377299277 3.3651445390480860809 -0.59432791803171070022 0.00073280779351839382164 -0.017595885910597516139 -3.8596011570584725092 -2.9031084809849985184 -0.067866836839372099432 0.17884959174201342513 0.049564247705475406036 -0.0095159695204662005097 8.2511568108438542168 -0.36998648208113066316 0.32284853231866600387 0.13435525818099045003 0.026134929179366002405];

% Layer 3
b3 = 1.8734661532662273409;
LW3_2 = [0.005727162449817129776 0.00088610574444508618391 0.0031008659593868797937 -0.0058185935909320692788 0.0031878454926170182726 -0.0043268415903403648071 -0.0044954964411992402035 0.0033299490834817441036 -0.024072515586508590885 -2.816242997313851415];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
