function [Y,Xf,Af] = ESPER_nitrate_6_Other_1(X,~,~)
%ESPER_NITRATE_6_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_6_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.04979];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.568038194888224];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.6446556113932369048;-0.37223815069023880042;-3.4751833688291293711;2.2985153394698580875;2.2964048643255861037;1.8344575734212769103;2.0978746554640248512;-1.6395881373195666519;0.65638194461190924045;1.9889337065971930407;-0.59021627891807526556;-0.23374444314486989005;1.5893958251076167887;1.8553702881001401526;2.0073986651847253171;-1.7751799645576440412;5.947404394835482222;2.1764669095072104454;-0.61125519562651442484;0.47157431778034158976;0.86377365300390707148;0.51793306828713714385;-0.54059298636777564084;-1.7410504344125572462;0.13399772177175930943;-4.9861602570237284482;-1.1477838490728942134;-1.2623313814117333997;-6.3040452653692256035;2.6086191199141470776;1.5960583821901788149;3.2659087893415836845;-5.7580814000359064053;3.404607479551029936;2.5150337444364354589;3.329557787680569092;8.7800255186991158496;-1.8620922241632285044;6.9419912204682061585;-2.0570326244489818279];
IW1_1 = [0.15920545093864227337 0.0067127897809639135857 2.0896330465931609588 -0.71165374267388681329 1.2974949530403614428 -0.6392656049887192049 1.7782957621843817897;0.080753568124200286737 -0.058853070863221841613 1.951061764681501165 -0.34080664054650916528 -7.5906509921559583987 -2.7951482814287049727 -1.7024717606164501138;0.31790763683288392194 0.11917729833022272512 -0.82443263781798059586 -2.5794908582787425821 -2.1645917505447802576 -0.43018013364207013938 -2.4521672594971883896;0.031177815281701003886 -0.041141116059994396748 1.0578209868837518126 -0.076880923787611604725 0.12595909252530337885 1.8898842576860557241 -1.9553227406734288163;-1.6698202891290334637 -0.38529426310839992587 1.2830949426632762833 0.20169923848297824365 1.1346079148066974263 -0.17490109049076493775 -0.49135562083846134884;0.076192019541768005175 0.31437767329189536536 -1.4790679299531357405 0.54372536274242122545 -3.0433770090740641656 -2.0586129835847839509 -2.4768878911263798592;-0.086484450551206487612 -0.21736194555847709875 -1.7266001313907717307 0.38774029564134082637 -13.826292501467367657 3.8290688942506241332 -0.43631915685295630247;-0.039198539485990446796 -0.01203959062728098342 -1.0127270927963736291 -0.00073204044257150265723 -0.55037862127404213464 -0.72258546469214635088 2.0835549377980209229;-0.39584727554415549688 1.2822621182460935962 4.1289215505084158053 -0.90384740620489822938 -5.622960763696403852 -0.61969188101443128946 -1.6528908493480527486;0.033123742717395661395 -0.016771609703587941204 1.0619950606862000875 -0.028705878617126305563 0.36035721097824030545 1.3059720215704269108 -2.0328568077635691402;-0.16851667092895736277 -0.32828767584340501351 -0.53087419574172156622 -0.25761901764415912064 -0.22975243486975513441 0.73875184760216228153 1.3936662017762648791;-0.19797765435675807044 -0.097056711913994675456 0.17757064830057012195 -1.5938898219356112396 0.60508122806262798488 3.4098179963772259349 0.13341220754046889674;-0.13826234853161550875 0.017206971934944914615 -2.05751151211786798 0.73067719208328252289 -1.4646621465224247682 0.58631822435063463139 -1.8229410101311109837;0.0067345614320995185118 0.33125987028456860273 -1.6864322919161445213 0.48523247227791571623 -2.7514496126138179299 -2.1935458063789017302 -2.4823134848648362727;6.8570871022075676748 3.1671066974940997873 -1.3562674260489036016 -0.19172519963480294525 -3.4322071029253513608 -0.74162911432750011631 -0.93238002030435218614;0.0088031447034713737609 -0.12285293329894948766 0.08116513969739003187 0.51351810688968380081 0.81406810881675562008 -1.0426198550279075494 1.0198146168782276089;1.0876413921817291719 0.78940736041520331856 -5.0225151932379947795 2.4017390866776997527 7.2154590998695118387 -1.7471863485483367651 -2.7045191945662687694;5.5118760832393620674 1.9754450151253324375 -0.0036552605863917585205 -0.46201632616924048769 0.63160580913290897964 -0.83947639643012761379 -0.21918311571386298042;1.100235276408557894 -1.8064861420977378348 -0.11460196406806021086 -1.8952665101275461002 0.59215934548466231391 -0.52220219789193322857 -0.37956283928370943004;-0.070554422532559848968 0.056774600487578950891 -1.9703736586895870264 0.49984114437608528903 7.6686174728621052665 2.7789927509335736744 1.6088028122256103902;-0.55039331552536607806 -0.59160153080400168513 -3.7464742745972019478 -0.35863175979545175442 3.2888832462373929211 2.8058027562977967406 -0.63585379895605032008;0.17023787710500890014 -0.75437244035946426912 -0.12238479567832728778 0.63561821632595860709 2.8807517224990291105 0.84917098095448417805 2.1677627770882392788;-0.28278411120032459491 -0.39595017059031489826 -0.65812171933990004646 -0.15125760744603122809 -0.5544985773022444997 0.76010588346220153699 1.1993201953401300131;-0.024595542867605606902 -0.27138801050768052159 -0.28421805803568472859 0.53512914438531100636 2.6070654572265214988 0.059828467272543178757 2.6635386322268193027;0.20857705813728391608 0.13136422736175798476 -0.19671837304687339598 1.6018507689931971161 -0.64808178121579806952 -3.5917759233253425677 -0.26367375655022134984;-0.42756510981942830174 -0.31622025626301891732 -0.36110034748944275229 -5.0271078165626779111 -1.8919002935917894614 -1.8373295270287020031 -2.3420855729274814294;-0.81440077483647210776 -0.70987770914457204441 -1.6978808993573892838 0.47523985860406442461 8.0702750659661504073 -4.4909206553693090669 -0.2036986969265688896;-1.0709251606730638695 -0.10471579435464273278 0.0099731010805288282384 -1.7714487826067728538 0.9632038427183028384 1.9872702060974078986 0.28393705860315338052;-0.054266878715787891796 0.0087164348941663489373 -0.40743443418108959975 -4.7276780762907755218 -1.5591175629857934037 0.28348585861605984926 -1.9350287671509132092;-0.0069215208407533007628 0.11573716992817370541 -0.22818589763907690116 -0.6204192952087961288 -1.0573257174160857197 2.109970844981746918 -0.87460830513048348767;0.51285300739050587726 0.11301148560085354233 -0.28633977328368337423 -0.36519824011354462545 -1.1178641544956913201 -1.1429063353267003844 -0.32177579564721503491;7.8677808237663091617 2.6471781104876259683 -0.053883913757029326674 -0.70911506115974842768 1.6614572705449175416 -1.4307846435509836702 -0.39559103569199455253;-0.12515653051404446172 0.037535269549601318895 -0.43217285272937877583 -4.4650608967625311507 -1.6097468172323812219 0.39735146250258335243 -1.53199497550519248;2.9456334870099536438 0.90351747144240324161 0.58877844068570028835 -0.45708969966747237113 -9.440868146467311206 0.81866201860562592962 -2.2516729833911655057;0.17422018188030935493 -0.92181358784141353979 -1.8478745542479189101 1.0275255686075022155 3.593450405967603789 2.3549607549583457811 0.21577851029684083639;0.78712592518157908916 0.68816961571286749955 0.21309047071423062314 1.0871342129963397216 0.71411421795363105858 -1.3149768477630481289 0.68313414868896771281;0.11908611646465930289 0.34913079854318912476 -0.46673311412051582403 1.5292580299553339973 -1.8348769266753863771 -1.7187309212278358839 5.9936534965943408793;-0.69510807836271049087 -0.53555049326479686744 -2.1705390441948080316 1.0122622598251360682 -2.3699250680138614911 -0.23978354518187891542 -0.27563531628348875158;-0.39266045573421942683 2.6622131675634599368 2.8978221024297021735 0.66520343152700078804 -4.3714100845538927942 2.6525145092564863525 3.9044402884899565009;-0.71893246310784086894 -0.57464189513606833692 -2.3005623149222595991 1.0824878383454712427 -2.4413240695635969324 -0.44451360964825065158 -0.45723480901955926292];

% Layer 2
b2 = 0.54442953408192718001;
LW2_1 = [-2.9000880590912312407 -2.0822509637195487642 -0.21757938432166751275 4.4862165899058430441 -0.10178748571795304123 -3.3334207941371265527 0.086728992774428706469 -5.7401874937508337027 0.047928125848224645278 -9.5760844400737905602 2.3430672092476401147 -2.1212773067149139905 -2.9002218597564470848 3.1133469609048076698 -0.025376488900227006651 8.6555099573649574296 0.033099083146084576357 0.1471616526588465923 -0.034179546082720148326 -2.0544151867459099492 0.054242084854817011752 -0.28063193730617852495 -1.7367685732615560923 -1.6209943003939670803 -2.0312062752772468421 0.040452014735620607511 0.054199315412362628064 -0.13983763851985844817 -1.4696677565056612824 5.0695498459803722824 1.6310687083994834801 -0.099123698429411405408 1.4208378984545426693 -0.044616540379538105476 -0.085882864533678035524 -0.29938752085881858989 -0.19905694458178191386 2.3446244115291134946 -0.072075822470317282842 -2.0343977916270548079];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
