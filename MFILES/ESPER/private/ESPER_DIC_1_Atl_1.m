function [Y,Xf,Af] = ESPER_DIC_1_Atl_1(X,~,~)
%ESPER_DIC_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:10.
% 
% [Y] = ESPER_DIC_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389;-0.12];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.5188884519329817202;-0.28623718047062385317;22.623248056212599266;-8.4876071341927197267;16.864719672406710771;-4.0260942758081110782;1.4661490481271979291;-8.0589614160978015889;2.8497875388775613104;-0.5848327402199906544;0.98406173904680782627;4.8899527402668407916;-6.8852774594789183382;-3.0678679765384213596;5.4371603550126099691;12.882457426666816147;18.534345391967928407;6.751445085521811329;1.28216900054024463;5.1204111763542838887;5.0174604026780791344;15.284862523431772985;-10.493331220597115205;1.4650977060060388357;-1.316284608561727909;0.94346078897605223368;2.5887229548643979626;9.914567230151151378;15.748439809532531086;-16.489336104457585463;-2.0840091029167120418;0.28109058024976130152;-1.9395338152499164153;8.4418189074341931644;-1.0399155598332776584;-2.5134079473853412345;-13.457413033489354248;4.8903873614882380494;-12.505725543165649327;0.21748064971266381495];
IW1_1 = [16.697966979591427616 6.9920392404409481557 -5.5560663702992387769 3.8013711211050877914 0.71404845074095535384 -8.7002801175471979889 6.162521639464081602 2.4571531145657932171 2.4855420220016890553;-0.31496619935457353945 0.65066899735017746931 0.18402341462690452456 0.034226388951443337261 -0.37198170331664121013 -0.48719104953194086738 0.28114900438033441077 -0.054411086239899639216 -0.61127971891166876794;-1.7938089659420723976 5.3655109204192594774 -1.9504535999893550802 2.2652253637624655269 -18.611427759985158303 13.409680083782740567 0.60163416499346822341 0.24360505183130434781 0.45940600660169467195;0.72179941655792256849 0.22040994292182858327 9.6654661491262601203 -1.3910991783421855494 0.5050317906715273697 -5.9660896438284369836 -2.7790260789539620312 -1.493773503413985182 11.546846237578531458;-4.4869174978052575042 -1.3483738331200696425 1.2294518444920916611 5.1354011553142875357 -3.2995179090569264346 10.78947715074988345 11.005477779149424933 -15.966526699503070574 -0.29862535652389499141;-0.31497376117422720698 -0.30158238781193047462 -0.33639666777349602755 -0.10224833102441142907 4.8546518760679182591 -1.6142956144452091927 -0.91564112327392754853 -0.14913655198148534353 -0.55824657451159032107;0.91012313304053560348 -3.2687308788198334852 -0.83551367271127319203 -0.36155029548398842643 -6.4419180061461940312 -0.36668421159707720314 -0.55586381151079455876 0.54299031078624915292 -0.62833835684931815813;0.14795478539534237528 0.18396119160078247545 0.057705242579555802995 -5.7834140997093941294 -1.3458593345928939744 -0.33359711628359423052 -1.1867905087985219925 -0.83440638899283903207 0.30102932729072945373;0.91831588944019049148 1.0613657591683027803 0.85909051521437373999 -0.10678476292345465137 -5.6096880465749681122 -0.073380060313913864078 0.73138589346911009326 -2.2357246732796811628 -0.19166003247561569367;0.46039286986332556006 -1.1124375638882777473 -0.2253472529154092463 -0.050087202386779668128 0.50742921707570765033 0.019843684223142196016 0.28694282609453275468 -0.26301199699928390352 -0.021233246573455058503;0.047499661923298151789 1.4340576133799418646 0.20535096834887858752 0.03760003214244864167 -0.5079052738269718148 0.93283650760908420896 1.2693650940410878825 -0.52843170819583784592 -0.17998430668189632775;2.5463811682633883393 6.2792373417062936625 -0.7648675809365486078 1.1057795579992155677 14.953083115120382018 5.3888882315200783424 -2.152475628710610156 0.89962259513432563107 7.5780308858142531037;8.1148508813829760555 -5.5329584124872726036 10.972786841266159996 -0.41622400078654286926 5.539983104775457079 -3.052482965432635531 -1.7498639185682496322 10.60819356450771167 -0.43217213147538785512;0.31436474276215464752 1.2099717633208202372 0.70439812149250524698 0.31839395049902119439 4.9763306652122398788 0.40806724893119100672 0.35514286354656365852 -0.40506887585848344591 0.21250959461397500583;-0.086461569451484657223 2.09999595619922097 0.2618829369852400113 1.7724232166949462908 -0.86747475080447689066 3.4396895451820648226 1.9025003743305615167 -1.9442327198994844295 2.4670045403702727249;-7.1935183160426685589 11.445227881547864968 3.1416855632783975416 0.31567760318541243647 -18.208766879011793804 -0.64432448557357147045 -10.468609607402790118 16.305563653232489685 -7.4892874690744983823;-1.1766571301731785226 -0.80237735928540399044 1.3104590955046167 2.7175906693331084441 -34.175755371899377622 4.5878432035142129308 -2.4996330623585505393 3.0837737003225718091 -8.1859338810670934095;-0.17339571650152407756 1.1952154314103717869 0.067373645114368663211 -0.57981483055835603135 -5.7256258378741229365 0.39976727351610658046 -0.55075961196055944757 -0.74529951832036323012 2.0236210160386192136;2.3290325912218849957 0.43853403107390342974 3.0119593738791938797 0.78434240125526333287 2.8843518793462536998 0.61911715600131222992 1.2959589743028860909 -3.5806209493897203089 2.7738668393141492352;-0.10202682898544537804 2.4349657494186822682 0.83147086434743611161 0.60523283679304606952 -6.1412444660508453964 1.7203340219178873127 -1.3659413029608802326 1.2557284671654740382 -0.29523618748970548165;4.3767194382250700357 -8.7962013166231169947 -2.2799002050770718064 -2.6053788514552507216 -10.448233622937367571 -5.3996646173072724295 -0.81125925249069774647 -4.2026325516113178793 6.3470163569962751993;3.4185455077215971542 -2.3952730928641789987 -1.5098907114510133898 2.4896527104466845692 -27.663135257368882236 -2.0113410097790125342 -6.4565475372400165099 13.000490025468193878 -3.8407998132191116802;0.12933457661138947348 0.87775314752520994244 -0.42762571127626353151 0.059002948271962965543 11.261491664732549367 -3.186781776053446702 1.6538282838202436054 -1.4432005241899299453 -1.9584278228949345557;0.42882649047961668431 -1.2208389876057221812 -0.10999082599076610844 0.20494004802749460348 -1.3746505130413373408 0.86645178926989996349 0.52467851357033634674 -0.59605400032869571003 -0.11311985624368174619;-1.0988773654968464477 -0.52495901291975566316 -0.94205017564578497069 -5.4696831641502665633 -4.8923478751190563329 2.8001465715668314438 -14.341021455537154239 5.5724016599886718737 -1.8885186299386849118;-0.59875048743083736369 -1.3306201411725604444 1.3747518346322844529 0.1148277569200444187 0.017951631857738271913 1.5732923438791783788 3.9875346718711464078 -4.7943073807799923003 -1.2326512215430929231;0.84909888458823123969 0.94320126014884730914 0.75933731775375046258 -0.079398932989314788267 -4.6270394521948485789 -0.20625913533435791258 0.60910127569358607502 -2.0149832641245666309 0.25036780485514759098;10.626368624568010901 -15.078606428040700393 14.901404339193957682 0.092016999260892171075 -1.8691381096815751217 12.119328168430541837 -2.6432251023970780857 5.2677942653865734712 1.8775957505565910033;-9.3459916487813021746 -6.9185311489316596578 5.0292549488179121298 4.4936374103270839697 -10.011730784337656175 4.6231519552151425501 -9.2893052879476130101 -1.1767364556687682775 -10.774324787575810802;3.3181581390665950693 1.7777636917022769936 -0.55459539839651394999 1.1421114321863889973 26.20046058867129446 3.5239443825285463596 3.4081483319762511108 -2.2382022935220189375 -0.73623614008010673793;0.28764462205277768758 0.31339372030733703145 0.90627764725821935432 -0.46774620824204704572 1.6008791295130329058 -0.42919429229002725723 0.21399094987626143816 -0.67905526425825835091 -0.47660260586546110417;1.9068368526512537997 -0.26856008279550602769 0.87217751950664579308 0.72069093737672329514 0.077844657262430727585 2.5001271944780496526 6.2537220510111533045 -8.5719917062121968598 -1.1798487814115938832;-0.16459889682068878924 0.61000330161992544209 0.034173389835125328462 -0.13604248783752573293 1.4093938083053394461 -1.1247408955545945553 0.41514782335472910635 -0.29272902311628434813 -0.57168910914041448645;2.6956774650414772054 -1.6125949469778979584 2.6327080752584386403 0.48495975899681387222 -6.9996385232104723073 3.9356991528762459431 2.1877969569845778786 0.52412869265680461783 2.8352645676130707741;-3.0024760862859167787 4.2463544817770406681 0.22021552498455282398 -2.2851548195795445828 5.8501304655859067694 7.0942514097348485791 2.9543478831997149747 0.99965409734265131547 0.1365226447343605154;0.33720670783461109687 -1.441280953755488925 -0.49782667432435839805 -0.33624920913790562471 2.5080366078786218154 -0.90180543003204638453 0.5312467280812738224 -0.37086084523636780874 -0.013290442038677071496;4.0728954887919046612 -3.1517190117267270821 -0.26422641092392029627 -2.1250900050818066767 3.8580485272765518978 -1.3255695003818783739 -1.0359106724611524264 0.57514471319595128485 0.37489444849349218281;-0.17025808920372470512 -0.21239246837037470406 -0.72960238752597950107 0.46943313405349984535 -4.6110221942322588973 0.85389506331343989487 -0.23114600569097304428 0.39098076239320755931 0.98855358904791268415;-0.11046036631048779253 4.6970724509278918291 2.6511813549233371745 -0.55470117884586467305 11.735262007833982878 1.4555498898241745476 -1.0336402753594635673 -4.442500675242305519 0.5006917757782686218;-0.47062284232834417086 -2.2342003578609235248 -0.6711806201082191059 -0.64912705114376278992 0.40672743868311311832 0.34080528152421485366 -0.81531190294481181713 -0.42077025617597713092 1.5856083463969565805];

% Layer 2
b2 = 2.6856850225500759066;
LW2_1 = [-0.0011550050624775448031 -1.2435333673821140632 -0.006951911084840780089 0.0246853533785000058 0.0047829730120337839508 -0.15711271926159420254 0.07102503846324863257 -1.2180652449754234556 0.408260743592728792 -1.8977263725740129985 -0.17366444580615103543 -0.0057806622283049433064 -0.0073477814947670444523 0.22080360108586216672 0.017088009383973260663 -0.0035858366366010589917 0.011424497501522993745 -0.14577316595886696815 -0.016620114388146721429 0.12357096178031068412 -0.014126346454068553285 0.00629422967923334159 -0.079224079229530966484 0.68974649767492157704 0.0025783144060611304198 -0.018618568361989881049 -0.52449022264994382692 0.0050955690685891650432 -0.0009270074347472457817 -0.0075230575840620744071 0.32864023322196944665 0.01375955838549326217 0.96516611138686869698 0.02677327800713883918 0.0090682637495756168722 0.82884672975870865574 3.0081266432422464341 0.32507718907707727762 0.019061340080553695192 -0.065512272064995810683];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
