function [Y,Xf,Af] = ESPER_TA_5_Atl_1(X,~,~)
%ESPER_TA_5_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_5_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-0.2178;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0479365703301392;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.022410241276492826;-3.7959924710676915538;-1.1740033870496635604;-3.9960264679624417639;2.3051741600669344301;-0.69799118188598829882;-3.1942584542982581652;-0.049292636930522028271;-2.2018447511820786744;3.4750117287765660556;0.90820366084834336373;1.9278263557714023779;3.1859479212467345377;-1.3310067280944191115;-0.16730287959126760589;2.6693331379440135009;2.3297806404809686676;1.5647778891137513746;1.6160834253406335392;1.5407816173293122919;1.6346469281831255138;3.9179989312415335334;1.1461425286027107084;-1.7284075225039148282;2.36938534446974991;1.0870549645615363854;3.773314920043554288;1.3024557534026475203;-1.634041005843042349;-2.4037770429421394525;-0.59458501422690079874;0.93974620757837989959;1.8163855130089949785;1.6818448312571119274;-3.1531380167835560968;7.8821134208421401723;-3.3199599576546980906;3.6919045279206041954;-2.7609462070269721323;-2.1040730496958786055];
IW1_1 = [-0.89742978852592270034 0.78841935649511718509 -0.81623382944378575221 -2.3364060545261398083 0.42433083377997038443 0.78158743704098787575 2.0917234286837458335 0.95603078468868873951;0.15939504990163005926 -0.25339605133958842398 -0.67964380970161031303 -0.95828631881151127292 2.2311671784553497311 -2.4122651854009187211 0.13484647182340842031 -1.0199550923611910846;0.065422966606575150283 -0.63614252523158199004 0.067696119753686653797 -0.17040096419824507512 -1.1351563240602935423 -0.01148311845312822467 0.23693288751505742207 -0.10320411503175824786;-0.13381423352035762275 -0.84165337901539516441 -1.2151709494228835062 -1.8899699499198925334 7.1145576761393911625 1.2731558865843486394 -0.54728594688183562766 1.3921474382770366862;-0.47318176965173991411 -2.8297235931928335084 -1.5363046239792430558 0.75007324970784683416 3.0453297041101445863 -2.4347304426004634514 2.7546574334261966222 -2.5377081603019830958;0.34179600061593023996 -0.53268230941879557427 -1.7164641345628255387 1.6134849852654844504 -1.5436571149258357938 0.38486016526044919406 -3.6773231896231153293 -0.42471329092371828962;-1.3179758685104319138 0.006806469053213378903 -0.085564738606714582647 -0.057947904607323567905 0.98539471793348454298 -2.8663378909284986662 2.4495496113328742993 -1.0084199953174854958;-0.099549314471073305222 -0.26448258131425944617 0.22710151690431132354 -0.10314865221450243704 0.52563840296361052928 0.061310990559189482152 0.12288859040787954158 0.070686118230357850023;0.97653603441236136451 -0.54705196249764798111 -1.7809118196160242942 1.7765334409725488385 0.29862644373306768131 0.16662511007176927791 1.2738983920069426592 -1.6451151518136262197;-0.98324803969807106352 -2.0382781879208407005 -1.1033452388239719522 0.4514171307373806008 -2.1759076675408901558 0.15628260362177004428 0.07323363644060293387 1.4082101885566427057;1.5417647030630470262 -0.063612106879698704365 0.25154952882076425658 -1.1050894343726436198 -3.6323818461335357632 5.4138232434762700862 0.21750625079228566583 -3.3157075538206894905;-1.0626959344211119873 -1.4022467096230695205 3.4373966810950093986 1.6651341977021705265 -3.1814103451679973666 -1.0644397641338729787 2.6837693979305945469 1.7174162540569815061;-0.90539685581503714928 2.2260706520678943399 0.33598874373793968795 -0.85926683675752923985 -2.5164239222053517153 2.1539434247647908371 0.71851235983905126226 -2.1012620639230426001;-0.73901487765290208021 0.33499781799563371765 0.089305488533725774225 -0.32565181180321428611 1.0758278866929558149 -0.29631327893687503527 -0.30508139621502727845 -0.044255211426662971474;0.63146783526864214142 -0.84780774916461609791 -0.15096108578951922263 -0.25881608288572127696 0.52371470503935024787 1.1561480149832654707 -3.4927202041524134657 -1.447784389774738667;0.2511341292073366871 3.0511606263678601181 2.0505205199946239247 0.13358750927305157452 -2.47641577948525482 -0.43603443221447935052 -1.9742420512467926397 0.90855676142130836759;1.6505254540447786837 -0.31862009122042778131 1.2272181184465229542 0.4359679077537340075 -1.3732159444832872097 -0.73883287871595038077 0.48606578464288846542 1.8452457673966884411;0.63001808051021568335 -0.12804871513512827708 1.526799747120030748 -0.29814483256714563453 -4.6380016408376443238 0.41708712320390434192 0.2090878681282771212 0.8159273125959070061;-0.46489168921242129962 -2.4221046347302856994 0.75792839153472224556 0.54386521213152450027 -2.0090922390801848607 0.62795204352908973178 -2.3883649006441456386 -2.3415256605551011404;3.2294614324718744491 -0.84024397918481741332 0.94903661346734369264 -0.36097331136639154714 -4.7319702003706121118 3.106751971744718066 0.96489640612296101452 -1.435765552419342006;-0.29154047528462079253 -0.61682248630042380011 0.35725530220421491956 -0.26019157193939373984 -2.2767818999622533305 -0.37176395432713260636 0.045766001896042206309 -0.053871578827066071704;0.46572605570552910725 1.8417122857986945039 -0.18258682186877356335 -0.98411511479395652469 -3.0632381613895387495 1.4469553706834508144 -3.05838319914090917 0.46859375824528948229;-1.3335391069236797179 1.349728274447359988 -1.0167633050434714548 -0.090418778852120185174 1.3882452224752237502 2.131148344847194398 0.60079060696588226786 -2.719856039425618377;-0.32931549076512595109 -0.23050618117023180531 1.1821661252227317895 -1.4585463044655473386 5.1234567815689313619 0.9664174159260394692 1.2319916008121540862 -0.10548696357192427486;0.11041056968069468125 0.51062923867068887862 -0.92082097552064368085 -0.18966087261616310089 -0.84537912512547108701 3.4333969522367224769 -0.55718610076063435077 0.17625386621361238682;2.712091186161894818 2.730198199448501839 -0.44746469503611957519 0.86004065623510239647 -0.14434093100065623072 1.9957812283463185477 -0.43505286814428689723 0.28946347991765059016;-2.9926483692033767348 -0.51402406358672958486 0.26239422040060855768 1.6686059186862831627 -4.066619257910193852 -0.066089379194044228782 1.9607361772472025052 0.6130269015117496556;0.021491606276338715703 0.51919986883370705666 -0.38911609376545297501 0.29031741323060727966 -2.4840820465670603312 -0.25278514159895582036 -0.89620070384401018249 0.55738476862350183616;-0.85940598380236410403 4.1619842360029712935 -0.56222424734614051545 -0.97029553924451272806 4.3317590377208405883 -0.63513306601061603196 -1.511529324614871328 1.6366499500894382546;-0.65411866690626396803 0.67452836196038734595 1.4169120281780576143 -2.0778192122273235753 1.8022246647408737275 0.43200341780579548656 0.65819865551528877745 -1.1911555495792103265;0.46820257838875684042 3.0645752326443918001 -1.0592186499462310501 0.1107804151406929366 1.4406025950241796441 -0.86612584258239166957 0.54514759214275654298 -1.4389942580020289586;-2.1776302372909444038 2.7815470581493113578 -0.82866199629158365791 -1.8872363023463381015 0.77686393993003721725 -1.3112684066487305667 -2.4804894163121153916 -0.28360193217068874194;-0.16736126928644237677 0.08810499180385977791 1.1198085077420683042 0.50827980128964767026 -3.2458437523282301918 -2.6917496664002840134 -0.36182711787101262679 -2.8536433129093055072;0.58783762141842121896 -0.56418836959099882833 0.47639975225324460162 -0.47907490900688309843 -2.780294321866164875 -2.5523522853045021996 -1.5467946626096082952 -0.86640656387662462468;0.37890254861352967719 0.81429317125764555385 -0.027563258361466030921 -1.2597878609403390104 -0.29712546201141226687 -0.47534157784123076684 -1.7651971298858994963 4.4788104820678702467;2.1668810380101932722 0.35460707486918652265 -2.3115174923702350718 0.66673452496738583317 -4.1634822324937417193 6.2467431078469424222 -1.93510031164530516 1.8732928290169448271;-1.520483259049345115 1.9690903022250227927 0.086710062374102406246 0.44458148428817645392 0.74402225291880930147 1.6741487658260902904 -0.60762781573459345719 2.4506515303231650726;2.4473185084209383433 3.0702522533687548467 -2.3089030172722568857 0.60607482407110890854 1.7588122805403543225 1.7670973182100571108 1.8789432686556311047 2.2195902078008926672;-2.8773963191773237469 0.38916497077922956871 -1.4385830451524321827 0.59922147723991836532 -1.9805407137136412654 3.4922543477643470666 3.0610381474516192846 -5.9795354780808560591;0.43659457176969640457 0.20868134346402497648 0.45511712147888744306 -0.24414742824432861257 0.77210842193723561167 2.0086296813013038154 1.223001398443339216 -0.45598173350656934222];

% Layer 2
b2 = 0.58212104665894559563;
LW2_1 = [0.018522405654705028505 0.094875773647925223941 -0.89278282308318235305 -0.013556233972230113255 -0.12605918532708990099 -0.0094138048696519958242 0.042724745631945768021 1.1728323726168139451 0.010589974782766894967 -0.033999614194065816419 -0.013833793271325681151 0.0070496121957619502923 -0.021731305228557332154 -0.15630377134669057315 -0.013114716933194410856 0.00055173337913213020209 -0.042076372773349628165 -0.041693680572227484471 0.010403239173565682549 -0.0033201906097816628709 -0.36866270663778449856 -0.010463254131241963435 0.03040315214416125858 0.018437720210058461401 0.041978856578879314432 -0.0024432900014424246103 0.0033082459143718764144 0.22183062601627026589 -0.019908064827909820182 0.0254566610560497536 0.0031066083758222698581 -0.017601499303928902496 0.02730121818380985485 0.029231857381502579507 -0.024030212064447345477 0.022121746502672821194 0.32924989282686817349 -0.0092726539116743753738 0.91508885795066308155 -0.1998115444773930216];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
