function [Y,Xf,Af] = ESPER_phosphate_14_Other_2(X,~,~)
%ESPER_PHOSPHATE_14_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_14_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.19717771242464585124;5.0004861784424612381;-1.5272907091183325345;1.7767641616240965607;-1.152689645119699291;1.7302800968203984056;0.47299442856269913182;-1.4914288130847224156;1.1034550836602627921;-1.4047040005486877146;-0.43319403857927779589;-0.33738739705856585216;-0.51391843155702687795;2.7202540864480591054;-1.0392450800624986051;0.94999973138104198966;1.3198340280311566808;-0.5731616467392691705;-9.1404679104881942919;1.0452089809531011078];
IW1_1 = [-0.92217648524970352586 -0.047007153905990445297 0.98491959240779303197 -0.52489544233293572439 -2.3347693162996483451 -1.225599270117862627;-0.74474895371455718251 1.0729310784342542817 -0.11651905015479653571 4.2336764490815328443 -3.6330953569377619772 -0.12254682133452435289;1.4793242076539272478 -0.43166906933431109517 -1.3884104844087887809 0.46279762918357503221 1.0751148487106507723 -0.045661342058538896549;-0.0090744209945631641723 0.93318160731717170187 1.9553343477914468806 0.09076262323145459221 -1.0737970475500620005 -0.169657773655617794;0.55070817104204972114 0.058418129639607394021 0.77544821614741021865 -0.20318425008606808002 0.15565507917059251408 0.87023243756951795813;-0.39616196774274375914 -0.7240050287420581876 -1.4822442545160512406 0.11380008131252569714 -0.34447490946943720713 -0.077024705485383218595;-0.55071591689327092922 0.76165681782919558707 -0.46997781102931457387 0.15505436482409262755 0.95931727724894055864 -0.85460590742243702778;1.512843653368377117 0.27214242178507930259 0.3811972684373585718 -0.36049280205004458066 -0.60206241423879103269 -0.82065961816400045947;-0.083196048883932657847 0.094838314171813389852 -0.82226297714814289286 1.7688006491392069819 4.3609034622905058498 1.8674498971066040287;0.50467911709450796742 -0.45181803908364703837 0.58888161153439366746 -0.57750561757710361377 -0.11474863895343880016 -1.2305598198824672096;-0.15893535196145744393 -0.015989446901705704068 1.4520601790773026707 0.34273128540144764953 1.8632097672238197017 -0.10001730609071295131;-0.30957631217535802604 -0.13133455524006912296 0.76084201142973217902 -0.51869697107199219666 0.78254818194182829139 1.2499940106151874453;0.23451359190450621339 -0.66564126846091975498 0.52173077365124043148 -0.018226421166756559544 2.6165685601403088079 0.82744752377298091961;-0.13112883626323199038 -0.01711939045831515141 -4.4321047971478746419 1.9295577749058632211 3.2362429847156608531 1.2829053216868131493;-0.54328046295106358077 -0.090165019525874176565 2.2929896895060242201 -0.91930626943164939213 -0.83060860033214578557 -0.45642652437660480302;0.28005453306789002133 -0.11567164099664686838 1.7329650996918932737 -0.18171599201502486309 -1.4057769842716467679 0.66382151247594634036;0.62523028824220217015 -0.36818664043320692425 -2.5126292911124457063 -0.068386929189169082255 0.97222887200819108067 -1.373658144944387427;0.54194544538478983675 -0.41517123006917322492 1.1998001555925770223 0.11399896828962698125 -0.58229650570273505661 0.80088470782048859498;-1.7432488187025845239 -3.1072877901166315873 0.48691364599285991144 -5.1218080507767513865 2.0880865291506918169 -0.19506329490217191869;-0.23952697852792870226 0.86546196959471732857 0.25632804172968737255 -0.016886640483038267008 2.0049849464032831747 -1.0813910850900572136];

% Layer 2
b2 = [0.554206967617169588;7.9399292219741948173;4.1876197712736047407;-0.97650692215855128264;-2.7441975367559794385;0.95346027583276904416;-2.8903810408775925112;2.5839335221363661788;-1.0932229786634009017;-0.62639528113636044893;2.1126175842945622563;-1.7424772397737398055;-0.16925296298161648934;1.8055698060209568467;-1.5768281657142846353;0.19266179001748234834;-3.7292209451576709967;-3.2702850635666118606;0.067888711136582804984;-5.1373594691620727559];
LW2_1 = [0.36902565448689789163 -0.31093373934099904909 -0.24508150749942894664 -0.26047444612564496502 0.15084165549249031746 -1.4712375544505282843 -0.39997003634543393247 0.25185696362422754779 -0.26204625935629505262 -0.53266625594332073224 -0.31151592512114406608 -0.75230094831369687114 1.1901266068878066928 0.36791416504168850121 0.76073502281434601802 0.045037020425195410656 -0.3610952509986755099 -0.94219317369220034752 0.4808675714636344023 0.63577785454296265044;-2.1792399762558809506 -0.00052038384981262751638 -1.4280589723994572271 0.70123097587652172269 -1.1290629750321150571 -0.26053746533404420482 2.9053326946358417615 3.7874757044139983897 1.2774638190283560402 -3.7731373850897318434 1.2104761553814662456 -1.2850842141290448328 -6.3421493319582822323 2.2420635957108649983 3.2050259428414213936 -4.4460754205491133106 0.672875421597684098 5.1997892005113737213 1.8261099605856463413 -1.8384353976739362668;-0.63807244775820093352 0.070599044222680901184 -0.27432090240493467448 0.20158681877010434236 1.4128269987663077956 -2.194406425249840531 2.6355819290152275869 -0.81887637946141600409 0.15048664959295451893 1.4138173787726189268 1.0492391625424069002 -0.1511942850750261913 -0.86344305322202696829 1.7543798698828008131 1.3196486642913238807 2.246403979291701436 -0.22581060067799244018 0.1533216645269029621 0.50377411584062203875 -1.4262763607936026489;-0.38721753673133085805 -0.79730502340632680713 -1.6345795563550156171 0.7143905723117213169 -1.4295160190720972437 -2.3251975029757758762 0.87781576136393690835 -1.1223253322114312702 -0.20191855083948281879 0.76482507712231284636 -1.4649408060771589302 -0.70922849533608567363 1.8153116745828246081 0.39490285474339770211 0.52223307260953255593 -0.11102971585366648577 -0.20338702403328751123 0.80861459088678999674 -0.70302974583757282812 -0.43601402309217041076;0.8160741355241843964 -0.47755394412565421725 -1.1642588275859080404 -0.038604648708940571267 0.1930298969969537759 -0.34147160884411426052 0.24705393809187434218 0.083570116227549548493 0.8283350052735347635 -0.91113470637865245916 -0.63763568670450720965 -0.60664977731846003728 1.2732869151470636027 0.6393044870820211445 0.80231707487792380817 -0.025817538463803586801 0.27989621496987754368 -1.2111273377827245223 -0.018735634038550975922 0.57748829990639949372;-0.43954602517000362916 -1.7934814998346975123 -2.05523796415022586 1.0005621144321332761 0.16330258771893793601 -2.388728614489386004 -0.69728165629765914701 0.86138602699050115241 0.21190076938816210239 -1.0974030871528221986 0.095626407703345822631 -0.45916114130354895861 -0.049089802495547632533 0.43690872659801860411 1.2157770963613911963 0.83925708525202613597 -0.11753163545511682853 -1.6570786909522015051 0.91199907287648984688 -0.23930775950626906323;-0.8461703271331438847 -0.21022889472896710839 -0.66619437962626970595 1.4549507962006389405 -0.97214950186865589643 -1.7423615145524071757 -0.53625694484850283672 -1.1713821841256517597 -0.74913356249180762525 1.1766914616941537286 0.0057359506451279667488 -0.65497643515815662241 1.7830557156702859789 0.37602795381223447224 -0.39086428850020288328 0.37846714618061177982 -0.66348022544064888528 -0.38200103733912238457 -2.2093320334630761614 1.5291864794381313519;-0.24921367959181195406 0.70867274571595106902 -0.66999634939169605552 0.91876067532656180425 -1.3522161857135992502 -0.85033480768216029855 1.4979359075007936397 -0.24134770906207850261 -0.57642142962448428278 -0.2532241951051560358 -1.1104468418158421894 0.82990155531018694468 0.6502419805741026515 -0.49649365482090079826 0.15105980474378272183 -0.88201076736745565032 0.21194575946587546067 1.5679481836339790313 3.7723332368278490456 -0.85250965427223668325;0.54574315463765654677 2.0197102075941377741 2.2829812158123381494 -1.0088853100375756444 -0.67036192424201046514 2.0097453528189310745 0.24071975743239412693 -0.99294007222786917488 -0.24246051696334824932 1.1472846831672944834 -0.10889748768005513835 0.64987684349615970625 0.2158325222575419311 -0.52158773940384928203 -1.345146258754651436 -0.97455156027565192911 0.1463657493461776038 1.5742737557645298807 -1.0653335936927939009 0.68121066552384257342;-0.24253409642957429737 0.17102512016114893023 0.28860846942198914444 0.14135314124753706189 -0.094147954277410281221 1.3502838473489815474 -0.04802529949710020174 -0.42793347677734527856 0.29033561832044324502 0.18124593595082474917 0.55147901355467954243 0.7264188461810995312 -0.92382863496679579196 0.004073831625038097648 -0.21673079317977439473 0.28197131385404827775 0.3038920155853493954 0.758651262398735593 -0.49555778923571214278 -0.05674595601389781363;-1.9752911792987419837 1.3149221151065406676 2.2681586336418666505 1.0677710371037272274 -3.1240692590389818051 -2.6327959532093672124 -0.10527540013064530522 0.93427314147272155775 -1.4304370796591938664 1.8385294633990683089 -1.653872198831544349 1.0503606806624450343 -2.502683789769717837 1.8631503195388816607 0.084458596389223788981 -0.53994516874048825716 0.31929865551232378129 2.537673392921541371 0.23194596352486107627 -1.9365877267993316657;-0.56344724273766488842 -0.97699976638102037363 -0.04849587053672398812 0.68480084148239717123 -0.13524996388824056526 0.78942484347986485727 0.24016597857930710447 -0.14150935177419965427 -0.41653205798399689508 -0.514859158333254463 0.60852078574883006201 -0.031917578965061824126 -1.6126160765526684759 -0.013442552206174050028 0.38760285290132978631 1.539835802222676131 -0.15401953739858992298 1.5899025530665620298 0.412700152436880352 0.3613211241165629195;0.13621657010472698612 0.016456953950736336739 -1.2798637239082018002 -1.0537171385609047647 -1.0272392826439322722 0.13808375870310127254 0.18825954052173854425 1.1982377597846656236 0.5447572129831040888 0.21964363953302876165 0.26681571608240561844 1.2661605253535581639 -2.7931647879333847406 -0.068531929682938835802 -1.2784961959987464208 -0.15048280791304460835 -0.017628592838290622902 0.37844135292678465765 -1.5635660183240904786 -2.0519119483141530225;-0.44846013657021233101 0.06557029956138069049 -0.28996473342934730999 0.22922854006792328652 1.6345716181187726068 1.2569398020124913362 2.4207001192463097894 -0.80118098098341228308 -0.011367225347341499211 1.3227649006671853282 1.3306260240740666045 -0.077803725551828281648 -0.51127211095706581734 -0.98814023650286497702 0.72431449160965011291 1.7361172303064542621 1.3283931270306277295 0.63373629374641493595 -0.38840740319355410159 -1.2227432276032415004;-0.1454909504937539344 -0.055936486319624327546 -1.1804795493440654042 0.025372995826375737555 -0.93029927928001443505 -0.93229375474950981761 1.1659094737442703416 -0.36119557901540233491 0.06447394225666096268 0.6918022755524155798 -0.89466460177561768496 -0.038854859940468507162 0.73727990888946326464 -0.25028185064857183528 -0.0029616457918873683418 -0.20059286385558408594 0.27156534809788629437 1.3663983473883460906 -0.96570349126813992413 -0.29734796128908985713;0.60022585129824035377 0.52153446972619865729 -0.026278243473430447363 0.84477705690387638882 -2.3246667544799732852 -1.2992013061276448393 -0.77571708533909233818 0.72381137954913388199 0.13619531599632733743 0.56053308897455256243 0.37792759344847326464 1.4641541676409162154 0.16684397023495894929 -0.52414193649159179778 -1.1587852827914146836 -0.5889784017973987984 0.64163121655011334799 0.23851254351536602116 0.092944470727976263857 -0.027283607101475919332;-0.11080425318468084539 -1.3801527860944862169 0.10188454560074024224 -0.71443500814432214785 -1.9406528915003711244 -0.99683127347030475729 -2.47522270876207795 -0.11292928815184806457 1.1356489023164879626 -0.30866312836062315128 -0.10450595016899472123 -1.5778486703245280243 -0.1459234475471519743 0.37653472700774842652 0.88839389758933406949 -0.011765111166720541858 0.71539271864420628244 0.41608528197263217052 -4.6123486271828513239 1.9038880903134860478;-0.12516006389235873053 0.26488098699509765588 -1.2423233954372379095 -0.47813173697519423255 0.5987465437672534474 0.87903302369901714641 0.90230397776477333505 -0.054662226047062091594 0.13922353367654025091 1.389527955073999399 -0.048652509977169855482 0.12584674921601093911 0.30338479171829840775 -0.095002875997063515601 0.044993893656128547409 -0.51165211815583977462 -0.23412954475836639245 0.31306411456011279393 -2.0303908987983074752 -0.34190081847949821414;0.25039107537216159782 0.35688928891665899767 -0.019471438284302769461 0.64284759046966266638 0.17089660217686367116 1.7553739780106834001 1.2477132200947393947 -0.0075368054667800544327 -0.064224694736359347336 0.98488438524386456852 0.34800609368978713265 1.0762553199556363914 -0.17226270811708416231 -0.16592014090771925461 -1.5494026351384846407 0.026399192585025096219 0.15432461624508564402 1.3883936392210936006 0.51392205340457031149 -0.92925885701001420536;-0.2663925217646653798 -0.1422227774142836576 -0.35878835686611049161 1.2152243736383336881 0.50901791534406748418 2.8166314016787197261 -0.078011655601092869117 -0.49231833556735499213 -0.44608068785874249729 0.8868912391526930783 0.14727726976906085898 -0.67574701512402357562 0.29068928040425828785 0.14174624320785028653 -0.40922441483777655113 -0.57929845563727977442 -0.40238831379650902287 1.1341596492514294248 -2.1568679356356681431 0.63136503202532656687];

% Layer 3
b3 = -0.39038161752206579358;
LW3_2 = [3.7457009989153271512 -0.21608587635224715817 0.95657864775701373361 -0.99998891695399816371 -0.68964773640174659164 3.1429340101606868529 -0.56317193611550031562 -0.69031513895071217046 2.6945451845506358524 3.0021450621457330676 -0.14719868177844069868 -0.56394715062594991117 0.53536297433297808102 -1.7234346300894913817 2.8123225131779379105 -0.73822229973049269258 -0.34224855992744651623 -2.2617542686191227652 1.3313970174318747741 1.115987238229379841];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
