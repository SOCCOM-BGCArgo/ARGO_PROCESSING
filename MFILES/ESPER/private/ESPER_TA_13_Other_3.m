function [Y,Xf,Af] = ESPER_TA_13_Other_3(X,~,~)
%ESPER_TA_13_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_13_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [7.3815149951420861996;0.64071084021190738422;1.1499497967423431;3.2695466655274345591;1.4313887739949537892;1.0916304965162648699;-1.8369911936431086996;-0.085667381048385199405;0.79780283924572992227;-0.8046774218176884208;1.2503018584433513993;1.6585539494555336937;-0.53300565264623345207;0.14560729569945030093;-0.33889478604795170158;1.5559928835203817865;-0.13114687412406045297;-3.6364038093728714429;0.089737136013208276819;-2.798108685175374255;-0.72372332286247320621;-4.1720783526761140436;-4.6886289708485984207;-1.5312384915616090719;2.941022448911440712];
IW1_1 = [1.1752646881432831094 -0.16190830502554789949 1.1924368316182776262 1.560089208113386805 2.6996630110483912368 4.1221444508132245588 -0.46402289480348896111;0.41713746515356986411 -0.18947829070487093306 -0.84077733199697812783 -1.2308682001625361746 3.2521050954290884327 -1.0684657485942727906 0.04354552210863771311;-0.089474864205252455096 0.19676185479630564634 -0.058095827121311484353 1.2867300260958842717 0.21209903580945704826 0.25749349265293641764 -1.9537928240429982552;-0.39688548829244640892 -0.1555079155156776638 3.8530641719260794176 0.35361745175826508891 0.32353554761691555308 -0.42627335331757570946 0.12541941720088867207;-0.10357526175746757657 0.021498638632003862908 1.6806965923735617263 0.46308429269681744556 -0.17749806280091048882 -0.20810207523999493806 0.86173020932498456403;0.30798130580731614137 -0.056737406524985108114 -0.49914664785198642472 -1.0712901042980003119 -1.234762206447374 -0.68617711250483082175 0.86293934160003404887;-0.67219020172808419122 -0.10102199761853319915 0.22992575933224804197 -1.2727386788580066224 2.0714231079307361405 0.65429795356794306915 -2.0250368833682577119;0.024492252755172159995 -0.10790307053706389706 0.72163405036042649332 -0.56180708493585052032 0.19553198436142041339 0.25561965873132908023 0.5017819740279696461;0.30934769227235991984 -0.13183927219630375838 -0.72958463720329458368 -0.88610951527748593737 1.1574860073041426389 -0.7719522931884238437 -0.15731864126779301905;0.96116431730830964586 0.15474097089459726284 -0.65323472837213170106 -0.35762862508319731569 -0.22893696526192242047 -0.23770693240588963713 0.4154167268747829822;0.57361888489500778565 -0.28022226612374651067 -1.3145287123279700836 -1.4994284666308130838 0.90066206261848447134 -0.63365763420651666227 -0.95450106043694915581;0.73719966312243168094 -0.58783078311692793516 -1.9485345503483537666 0.2512957165481954358 -1.9657574897536871372 -1.0249974775950592143 -0.19048841792726597943;0.11591678457736270813 0.07912157342189594933 -0.28713589143642875845 -0.17562246703170078521 -0.62506617324411317682 -0.15227632441391178442 -0.71454803076755646352;-0.62575299387179561528 -0.53056770390156104966 -1.3993588983738955989 0.6416380080772787764 -0.39964468514398565624 0.20507607622786505619 -0.53919212689412476802;0.31975365440928688043 0.23934496992132417437 -1.0434467462507999169 0.32676357201846817357 -0.18775227875573677339 0.51108955578667480957 0.11094267026572832147;0.31764684573336449125 0.73366859925290539568 -0.99322962327603503407 2.0618373614597507171 0.6544052656218446451 -0.49899892487331459767 -0.99206223753069955329;0.71062195471053890561 0.61482245828416048905 1.5466311537336101534 -0.71955127042525801606 0.53376581791150135015 -0.20173042885981701255 0.74415048946282769116;-3.6823868765509071288 3.3345847300806292779 -3.2869852042297864614 -0.061637103710489207775 -0.62923872286899984463 -2.4303522861131279242 2.0988955529149309065;0.086277931529782761477 0.039904963698731456267 0.19820713886083798916 -0.3159728685068075027 -0.68093780058440733782 0.037196037971792564325 -0.034449408074178337891;-0.48330638335408215855 -0.30312322381814277295 0.24699792787083432732 -1.8213446711334075889 0.85412686083407174387 0.39173665168942978232 1.154074845639926572;0.094518462044071979711 -0.016248691307475686407 -0.87325402937243601365 0.080152942124990619877 -0.19537758364023685709 0.39030584348649133286 -0.092246518567907734298;-1.5332591980506233842 -0.17581928721296186113 -1.6951080126166431228 -1.4177069655219165512 -2.2541765547640690848 3.0867647897383747591 -0.72349269742037292108;-1.8857673941755970226 -2.4680994161459040015 1.5558350677241885585 -1.0674877865212342165 0.8328198215331216181 0.51589598060045349648 -1.1672486628945955012;-0.50651927416507880331 -0.36588819997937926942 0.64030987462676658417 -1.7655484767532272361 -1.6387845784292409679 0.26871390367890968243 0.1737620314785542075;-0.2239650622544766545 0.77362661291800338681 0.53644359719900214234 1.7044621402718684866 -0.97408683032830867266 0.46926617685811528036 0.26860137898670827239];

% Layer 2
b2 = [0.5519575831465433069;4.3846927551619465646;1.7810717053050642011;0.21944432959198847954;-1.9409758837555945998;9.7076001892638803525;0.060554419852135776825;-3.7487800871095400268;0.2971223010394171693;-2.4318026220285990924;0.48393656425712183733;3.2612041601471601915;-11.00452332961406654;9.4699691804838490583;-3.4639914338096398083];
LW2_1 = [-0.34871687777508286743 3.3693913199027405447 1.1151259645617863647 -1.0562940748669851221 0.36531239709202056876 0.53297654265411475993 -0.32213583099328524373 -0.17362147569878841336 -3.8378568261795420469 0.80855730176251505714 -0.51554407562925208541 0.42573234329316184121 -1.0310025161459828169 -0.94178446096256118736 -0.17428686387089961651 -0.56515094045905778231 -1.1662840345461242819 0.079227041883837626135 -0.83767021631192717379 0.11902948105686769753 -1.5479212749592219378 0.48776620633743533739 0.16917212712557921916 -0.67421465072100517091 -0.33303683106996051499;-7.1890983695063948034 12.691282832263333091 -1.5142919299698998081 1.5046879577077985068 -2.7477274907146784777 -5.0503155092204146115 1.4570439614458121635 -1.5556991565864461968 -5.3780732288568131594 4.6382565114100193782 -2.6998053252157387938 0.52855011813677832411 -3.842639500055909263 -2.3772540392541214871 1.4098187269866808702 0.74968582826974350386 -4.0366968120045800816 -0.24449082460703847053 -1.7134650415998902151 0.19144258539397407404 -11.442939435166358919 0.49385160023435548116 1.2504062909080677635 -1.1359611586026272523 1.7182191205100052489;-6.3170853501768240434 5.0725430250930187981 7.071474244998084302 -2.2765908769810141443 5.4689917113094681511 5.2399134622420877605 0.50684148417274299536 -1.4838346915076057186 -5.1940786231152999974 7.2294136306863929775 0.56413775214019168391 -2.9991554318832989168 -5.642753003684792823 11.600238976334390273 -7.6651270996695783921 -0.66054533427352901676 -2.0602797523076068487 -4.39121960223667962 14.347111228773989922 -1.3264838722324172604 -2.5383899249743033799 1.49065874529511877 0.57001426277351141536 -1.3609290225340149316 -4.8081079041434762189;-4.2287877649020479964 -0.22569460143594768931 5.7288025060353744422 -3.7730219577403985021 -4.5248428791964929729 -0.70187609728906830142 -3.0667713853260263335 5.1619132533066842683 -1.3931933585733131675 -2.4667158319116158083 3.6456808475014437221 4.0878083194806817957 -0.12320968022846416623 -2.2900298870076021274 3.5383216814576030629 -1.9172776152399761962 0.88952435354803649492 0.044735086500310626556 -7.6636266991195443055 3.315384324458087395 -11.652246894019292256 0.39616344199192105036 -1.2076374215388043787 0.22773309348730563784 0.89211195838384249601;3.6021644916004409431 2.8296511595016062834 0.058948763506603954476 -2.2428077546645308615 2.6750743198444530968 1.1533610416497639406 0.53931987121948155028 3.3896272221274319492 -6.5386834859691367328 -0.91784232510736674104 1.3579475875097417603 1.5591765046129300032 3.4201026209751810292 0.95599247616481708434 2.0118271401423477585 0.89827905939555507953 1.6730368386766190092 0.006064231872616895197 -5.5705587779811223115 0.0019432584124148485905 -0.043401214144389584082 -0.45311192900912855563 -1.7722785832199985379 2.6606514525576532293 -0.51138797856595052949;9.3360089819747074102 11.740582600256251666 6.7595154339853458225 -6.6193697655073897579 0.27564893548858027117 -15.006836774740953899 -5.748406237180402556 1.1865630956516173278 -1.8656589178403064633 10.351596830535823912 2.3513004883826971181 -2.410831389234949107 0.88878030258928109042 1.3630951013089911417 -7.477971680280731448 -3.9183359584109767049 4.9928869599479845931 0.70376037387702350401 -8.299168648826116268 9.1830322947424658508 -0.90488895848320849424 -1.8599387299760801184 5.2970037753529437552 -5.1302034263918336876 -3.2421922149052986306;-1.6077179027601513628 5.4554997693729028185 4.819097405488991015 -7.5958187470486162596 12.449694287083111988 -0.44936981517381374696 -2.932372020311250882 16.663820648162442239 -1.7971651244364590383 0.96746649220690272841 -2.6955194527975896435 -2.1956282768863060184 3.204744708403646225 9.1772269571560887158 4.1318611931404998217 5.292963508209211021 1.3047558116999113942 -0.51758418967142616474 3.2731977443413975415 -1.4898403750119586508 -2.8380419705070636383 -1.5356102194625054214 -1.1904992329585335487 3.19035531308293141 -8.6548558316477794961;-0.5698039455469237069 3.2016128510258679007 -0.23925033694911793103 -2.2412921836052221991 -1.0846933713131847732 1.7076540762965177755 0.35692107907107489817 -2.3373338710237403504 -11.61115449815102707 -2.2999202036608150657 5.5869891604500780957 -0.36752349831025676874 -4.853947800973694271 -0.85846322282617437693 1.4970378253257574652 0.53659385679693039073 0.062351162099645279779 -0.21795049761273302402 5.8018856569576788829 -0.60863257780647705975 -1.3508148540532478599 -1.0110273442786557041 -1.9049126099900306475 1.3954086618811682996 1.4524432744708997145;1.3418970663923739384 -1.522339745133471256 4.7899502080122653425 0.6166140944851100647 -4.5681280146362830408 -2.123390578127925199 -3.5585368264123355964 6.72851416020418025 0.64897355791381439172 -4.222635899267340065 2.8687488882665421741 0.91278745042927966757 2.8508247688460262026 -3.4785354895640883122 2.351159143221116743 -1.8512419362063790018 -0.39958801661220799684 0.39101960401976981752 -6.8623763559927200006 0.71596356839263819438 -0.043800724162879722812 0.20576250408776469714 0.88982503125819767398 1.0901881413567042767 -2.3326501545136006932;3.1078200595135672124 -2.5576540175893294204 -1.0838633102645329753 1.457057397339108773 -2.0454459899292496416 -0.80411440148165724828 0.15373500951150337324 2.7169858794390124856 1.9995225448053182138 -1.8127316491198255388 1.8442067917871380889 -0.65050755055356035417 2.283805497173545529 0.10589331021196886351 0.20802637237456619856 0.95894355667854336289 1.02491312962768788 -0.038694648359012047412 -1.8084636133472673514 -0.054707796846677148039 2.8057684778213043408 -0.97154242616277486366 -1.0178485935267802542 1.3919576237463491264 -0.90874541971936051432;-0.12938361240573070798 0.90033188602027081071 -0.91698054696386699369 0.58140923855686310606 -1.797153417756952809 0.61679034771965579598 -0.31913373026056202075 2.2992714508539093821 -1.816713609141649366 -0.97747912934945924146 0.38071281573241466667 -0.48721071202014643031 3.3944368766996335651 -2.0332348801723418852 2.0946540108313045359 0.08154703418926981251 -1.4384732783615159502 -0.12908944904895502948 -5.6387403810351415245 -0.843146565635669476 -3.1003861494860389669 0.11446508118438009083 0.26659836406015091637 0.40893071484159548845 1.0867998690805216189;-3.1775840935381052255 -1.2279079536804775596 3.7190559379655168115 -0.9074799359161628276 -0.87370287619382591693 -1.0284830398064308543 -3.4787412171899898539 5.0947177240275438592 3.620484217887539824 -3.1715462223444728096 0.43203543868419941321 -0.61689263085601919734 2.9568641555074051119 -1.0217170115178850764 3.5565411418131058774 -1.1940738492835933915 -0.52689449309831370982 0.179287875706502009 -6.4498024065537480354 -0.1710739030135622063 -3.9074288879138641128 1.1132924336386864628 1.0516224146579136178 1.7771325758489591173 -2.4079125422334879403;1.46327315955458781 -1.428354895948940495 3.1328367652405697541 -0.50943270443378430024 -4.9356354811924880721 -8.8890365260170920436 -1.6252326518174382564 5.1234410807529950915 7.881786517564389527 -0.93632925433644642599 3.0391831855982465171 0.63260282759634889338 -1.7421242809152304165 4.4940287207473330611 4.9957288369835337605 -1.5619250150816306189 4.2380092321999782712 0.031303474445660880998 0.20190154215302399954 -4.2675453554436995063 -11.970308903434094816 1.0648380526300589288 -0.3040495947276623534 -0.034182080638706591191 -1.1331222629909116772;-9.4622596943210073306 0.47648488528116339502 1.9002469645348054605 -0.11065780927752805196 1.8571942092039694927 1.7787695580789553151 0.74362409763112391481 -1.4483778649079106504 -6.6572237197630448335 2.4678952391848825165 3.0457828311397259213 0.69391902344944977887 -5.0662808656072213509 3.0337020668341270202 -3.508967518153825349 -0.75160464322504194623 1.8495992099484106497 0.20762414379791546692 4.7288751296783244626 1.2127138491435967005 3.6018886142365076353 0.25054879914236133365 2.0691860547399367753 -3.6483532240651159739 0.8550944047415230953;13.728458073126365235 -2.4942566718603522702 -8.6833287519571626945 8.3053728193818994185 -8.4647805597886947027 -16.252960362656516224 -2.1858735705282734685 -19.92329149180759984 12.270986493341395018 -10.859586870997633312 8.1783820209315951644 -0.14642617239950722619 -0.10096988914743555699 -1.8801472043661910938 19.515836400882079715 3.9183847092770798248 4.0617322573749161663 0.046134059069135396891 9.0932076708412505894 3.3684210422619802472 -9.3587767913041215451 5.2197260347761398336 1.0219049878477384219 12.238804807620917714 1.9573997767023747496];

% Layer 3
b3 = -0.059533607690351132702;
LW3_2 = [0.51545935568364076307 0.070123961217011004932 -0.0097548564740828468816 -0.07229638080090761143 0.17130429893959131515 0.014473645593983985522 0.040371837140095991059 -0.056164847804058913583 0.11551886361545063431 0.23601911316547885544 0.39102808759510859771 -0.13693081028145998035 -0.18785791596672790638 0.11015242465758069701 0.0076602444317377619415];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
