function [Y,Xf,Af] = ESPER_tco2_11_Other_3(X,~,~)
%ESPER_TCO2_11_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:57.
% 
% [Y] = ESPER_tco2_11_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9664739343890756;8.4132754931130975;15.844526499019148;0.39632115683289565;1.738812113533232;-3.8122741890961169;-0.40112634977503236;0.15151973583218478;-0.36881002212770791;-0.94628288032527463;-11.550787701816459;-0.69556328796731948;1.0037850707592952;0.60286609417823511;0.076846675076687632;1.5460459822002317;0.5357696938170865;-0.0096670929355071478;-1.0152980509677405;1.9256262248723497;-8.170466605216669;-4.0283615805245336;1.4266491709327469;6.5936581820950293;2.5027723905850916];
IW1_1 = [0.41205170676254838 0.58558312024063697 1.0968869271017527 0.33392967805419094 0.87669520166043724 0.64180347147380645 -0.41044095560114857;3.1590142201349543 -1.2100688026723829 -1.0731365803066362 4.8178587945427234 -1.4949557090241776 0.47483934977716369 -1.1158357961090988;-0.18000747170235062 0.16511802725284971 -0.83745278574239346 5.4333233682379811 -1.1380107326483531 -1.0361494615225375 10.015497449612429;-0.18231527996622288 -0.24515080422625032 -0.75756413783495635 0.13139874331009779 -0.84545236104919086 0.81663401409767267 0.39790185973716286;0.70219634072944603 -1.0235438401878787 0.76082837148875382 -0.22247481311807782 -6.0028235231748219 -0.13510284267595463 0.44129006681270694;3.2211257522567838 -0.89944744950818023 -3.8138600183100313 0.26719776196639378 -1.4833037250701477 0.83345559007160508 -0.90457827518307254;-0.53251366546797074 -0.015360337704884586 1.031164273094558 -0.12485819196197723 2.3907206529285929 -0.23785398127268897 -0.57676375714597572;-0.1980235770813169 -0.11686462650622256 1.4333096484278225 -0.011713441361343658 3.2940594491448123 -0.5816654221881884 -0.90716534729752873;-0.42754605749258234 0.09258900898714964 0.416689938946467 -0.21621902315423494 1.4470371090744489 -0.0046727947790587455 0.91353635218379436;0.32643096331085375 0.084186670205406031 0.77549081138402642 0.49918042606862734 0.6407138407894174 1.4874910651578184 -0.52522247806495193;0.31407351529636579 -0.15876087765167016 6.3937398640766876 -14.779758335671371 -0.34936649134243336 -2.5165650934916548 1.3069491523840906;0.6515447804568143 0.012368126019657276 4.4660333588047889 -0.17083607795366404 1.1354348346011547 -1.7887845427900331 -0.70653416580722694;-0.29679658557954752 0.57653232210144778 -0.42622962283762683 -0.12467834295993775 -0.62510255141587845 -0.0025503736665139979 -0.068504802809567056;-0.48932557839909252 0.15539209523150746 -0.7742023794451649 -0.088997024878563744 -1.9351590423965397 0.65471847874816758 0.86913762030559016;0.31543132847290778 -0.45454522993556362 0.33014734516258265 0.43378970179409126 -3.6298640108408793 -0.62231750514682493 0.21753639813106637;1.6200544695685748 0.28780263353878704 -6.995732809509601 -0.17310189424652456 0.38047881048827692 0.01773728505480094 -2.5508460030916935;-0.01569644812669654 -0.42866791791767744 -0.97278894431303453 0.41747095432658482 -0.75130298997417877 1.1553368940026039 0.30894171496924344;1.3244075071090231 -1.9463044454980061 -2.9861479094527197 0.91079292970902315 0.1294475858584449 0.21047329136679682 -1.8649504768588507;-0.57105294237943316 0.092631491873066102 0.42460645090628396 0.13473254242261282 1.545518274028352 0.95504568162538706 -0.41492062141292319;0.70193280307878647 0.60826179448440787 0.77244435784178433 -0.018680527257509936 1.0122891442277058 0.42350568059966293 0.60859677050691319;6.2598328828095298 5.4888726634585172 16.149944090220917 3.4278813707560465 3.78859984800616 2.3144976149013874 0.71779936280975409;1.50770290270857 1.4722690110110963 2.5687171437837684 0.11158107277434276 -0.82558611956180195 -0.41710413434701382 -0.63758641994216392;1.0156243352130951 1.1750550768525467 0.62249273553055184 0.56062766479398907 0.17924352654240563 0.96071461653489265 -0.44042216750734714;-0.046311055040550698 -0.7128937381719147 -4.6107477509067998 5.9578684337548351 -0.54837460945626149 1.6137850567188083 0.73312143412947606;0.9465052623945982 0.066706415020805571 0.24161909471943557 -0.39649932982166874 -3.261753043400585 0.42559786899783075 1.3430433898819425];

% Layer 2
b2 = [-1.7613236281953624;8.3136857424806028;-1.242486086427548;-3.8582929113640945;1.0787989034467365;6.7295619294525402;-5.7580623287746278;1.0747029267335062;1.8326277731387421;2.1135084414573013;-0.72282508603665163;6.5522314366621757;1.2841375368139636;-5.7656589927358306;3.8278733073198694];
LW2_1 = [-0.63102880079114343 -1.1027062260244538 -0.70758934483294023 -6.2405714371294376 -0.055893491573196272 0.067108135454819445 -0.91017593802956331 0.53369111598427976 -4.2433358454072687 -0.9892037717804425 0.43113462489017496 -0.33905584803180472 1.9940407076907005 1.1819513249642717 -0.24609327249288174 0.091812922927122981 3.6183552082434223 0.021300877546597593 2.2902741696557078 0.75635014650006627 -0.088842020702216085 0.83720387652607153 -1.3179023878528997 -0.71825085225421104 -0.17313296454045468;4.4751589613534701 2.8707658960913189 1.2740699964578639 -3.6501988446751508 3.6259642987042886 -0.26271185603397457 -7.349920218204173 6.2494004329773567 0.24540958973319471 -0.15278674203659004 -2.9356922778816892 5.1067425060556566 4.8384235991129181 5.1756152233393502 -8.4579088412707417 -14.513046874210533 -1.5354680000209113 1.6434244501673656 7.3963350232488292 -0.37166521754304416 0.70361272875141201 7.9363559155685666 0.44695659140106814 2.7355250044134869 -3.6739393027888214;0.4225934016291491 0.58832306459151595 -0.28405438929802185 1.4046265732465952 0.013130841475048166 -0.10734214643663208 0.1866132183900524 -0.23818483728718134 0.19160694115375865 0.38216837610339882 -0.19854787519251438 -0.11954844726355963 0.1352051691074142 -0.60856167393743965 -0.14878074004044836 0.059285962497528155 -1.0245165074409934 -0.087046962921016283 -0.2145154047170951 0.22292999125294008 -0.13576591099045701 -0.81219118314627203 -0.22004867641387513 -0.57657818450855314 -0.4332366846172937;-8.064964301807489 5.797066043001406 3.4157553614826091 -8.7697044541842537 0.012399629519137981 -0.82511008268239283 2.2985886435476988 -0.17545382194221351 -1.414959424799012 2.6087428029055717 -0.45692880377313472 -2.185048584966788 -3.1086524329582925 -0.054071108178927983 -0.023143425760706177 -1.9484756080051797 6.0049931978909097 1.5576365710901581 -4.0112200907457289 3.8256210974173204 0.99523871561494104 -0.3795141351687662 -0.98404726303566625 -3.0848113977956002 0.0097083282697975684;-0.115977621054108 0.069576392297559825 0.20028422642877963 -1.2646395344645855 0.055040818053834567 -0.01882412806745903 0.16244485037263645 -0.10669394629595838 -0.099337205674584289 -0.10352923260869891 0.05416878697259888 -0.036298564349939118 -0.061947828359260194 0.4099440729245899 0.0064591099994086741 -0.064568470852742227 0.6668407835384389 0.03168383831699903 0.15608187240851387 -0.42364222576155153 0.026283835578516501 0.57986802445229169 0.10284104857203244 0.10383922160059951 0.037018353143447376;0.4366613142798712 -1.211125415576493 -2.0261857148765707 -0.39511621359601246 -2.0610487053780657 0.46264572997494524 -7.8851768636254427 6.7915503680678606 1.1775662627927808 -4.998081464893386 0.76338325348390801 1.6307110931035098 -0.1197405969083508 -0.2898217416853987 1.0366981715569838 0.82297130427912857 4.3543021929553651 -0.33909628962092775 1.0682763797978838 3.5850078197167168 0.68235143607476079 10.565999301907693 -1.4842233966477778 -2.2417279312142311 1.4295692166789078;1.7386444346775987 -4.0341672191127431 -10.905277909722651 -15.606947967657485 2.3659331278359992 -1.903974227629722 -0.62757068958088913 12.041169521992959 8.6712968865155595 3.9921420972211878 -0.4809089895422653 -1.9838064558540593 11.898581846628629 7.6150688516915537 4.6474923172741658 -0.045285053309198159 7.4836017429647068 6.1136726991613006 -6.4271724396483974 -3.6181162198002039 0.32022099057443765 0.78386120140519266 4.7464271728040863 2.7278995477140606 -2.5032675003377323;-0.46526403513255116 -0.20844121964029957 0.15735749912915387 -1.7947566283560654 0.051757349024708688 -0.04345850573654577 0.12630589492692598 0.011216896720554755 -0.11431679701594748 -0.27432230872607127 0.19261929128456157 -0.012787411599767873 0.10254111691169228 0.62840262694676674 0.15317162473577753 -0.13918366720974706 1.1621214708912722 0.069474313092066059 0.16706978289750754 -0.26138651597907564 0.12948780444872313 0.9054086425219432 0.17613901914428062 0.46924126302243613 0.21932712059027498;4.2000895579331301 -2.3119386676372766 -0.936201567037376 -4.7365142871296788 -0.42381975345349926 -0.90314433345235334 2.0962206598999185 -6.0129433059714517 -0.61318245946645278 -3.1424826316334391 0.034248059485212833 -3.7461719251767454 -9.2517951701469823 -0.12229231267082674 0.20777278837216578 2.6255106449391006 -0.2240244684262678 -1.2959140832255898 0.75525924467296524 -4.3244252963354368 -0.42436720721898846 -3.6363229988990926 -0.86521236736930873 -2.3340582378217047 0.78880428478537445;7.2426004456001154 -1.0756056963831502 2.3513203323906304 9.9683654510944919 -1.4954580365193806 1.7997589767223523 -4.4884105131436964 1.0499097019936612 0.67298983587251449 -0.58737162323324066 0.26592411842517438 0.2109992532472113 -0.11728757443594494 -4.639395867463219 1.0795934795024698 -0.4180202251455149 -5.9272615019185126 -0.95733377352845705 2.9784433900114404 -1.3213703202408897 0.24374960429738338 4.5913686559613494 -2.3994057124226451 0.71809921140707844 2.1099632970934268;-2.4202304968766422 -2.3211621620585432 -3.8037598619595014 0.98892202432934817 0.052394420468936616 -1.1144855919675192 1.9539007437966347 -1.1999369376789233 -1.8026186003913294 1.0085062299039338 0.0059310196320386671 0.41876115262004804 0.73495173424815108 1.3897245368270406 1.8634095727143059 -0.25005263589995519 -0.34847046069094445 -0.67373873400848105 -2.9060934342987039 6.0996665936344243 0.12009001096543596 -6.3148230800450156 -0.7959415631787391 0.26637717225705454 -2.5286248916302179;7.4213511720278706 -0.46698470851320867 -0.32974700029166271 -5.6700924943298903 -0.27198262286367481 0.50035165129137749 -4.6157885925607625 -0.17022928242800497 -2.3071787722444834 -2.549746832880623 0.046633585210196497 -0.063133164372927236 -6.2929345206813085 1.7082090714219309 -3.0586302689874265 1.4842001032540724 1.1579692958772432 -1.0384858767679026 4.484171922767155 -5.3114660882101958 0.13272924374130773 4.5735395444112585 0.76695777396323539 0.96157368085350747 2.6647733970767287;-2.8944675792562045 5.4516569876310701 7.3242261455542366 3.8798612176415905 -3.1448202870224602 0.98186758729385271 -9.4358452625267564 5.6171056107662363 -1.7294895577922496 -9.3110168426929842 -0.50492581010737203 3.0828986935457667 -13.975502465317645 1.2871346920517639 4.6413852866490908 -1.5144141950311554 -3.5539791829033707 -1.3446659040652942 15.558244971377485 4.2202623706665356 -0.63568419566414547 2.0731987698309284 -1.5593289199741711 -2.2188057641549754 2.882404326581455;-2.6139152968326216 -3.0934337584289699 -0.87989121444470308 -12.082462912464436 0.042574873524490395 -2.3313105820490239 1.9185453625045965 -0.17850058098049174 -5.2114868982400724 -0.99949041155792651 -7.5436614686622132 -11.586924800862818 1.0299198046241933 7.8275862604363713 2.5660202787650244 -0.13086833904675726 4.9472457680773809 0.48007706336402589 -0.59732833459984647 2.0160259320865621 -4.2068414101420943 4.4153690957681677 -1.776294705407627 -14.94113201085178 2.0403462204669487;2.1996352065118439 -0.13564492988441165 1.3283865351133974 -0.83484392821549258 -0.14159236657819979 0.5439127605260603 -1.3386992795627897 0.075119062370219536 -0.38085318259999762 0.17595353655647186 -0.30899438182957889 0.25315390089987477 -2.4918089881027594 0.8385039332483829 -1.0292595133683466 0.25171275940136056 -0.41121149553547998 -0.15217942786967731 1.1446298861369177 -2.5360208515251141 -0.26124132933607325 2.9144967406408768 -0.16141458027463745 -0.5019892894114506 0.41401226763233206];

% Layer 3
b3 = 2.030793508457664;
LW3_2 = [-0.40091138029705636 0.020114639693256657 1.8375414648768003 0.052052147320452061 -5.1892346650104049 -0.06043088742192039 -0.061657928467833738 3.9874864441335682 -0.11204345934451415 -0.093395372472484778 -0.089618300562680248 -0.074298616379622512 0.02980090807547783 -0.044022469492732523 0.51103565180053012];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
