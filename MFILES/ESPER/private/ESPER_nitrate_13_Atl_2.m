function [Y,Xf,Af] = ESPER_nitrate_13_Atl_2(X,~,~)
%ESPER_NITRATE_13_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_13_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.49581229468376797342;-3.1466326426130080129;-2.3229895252652594806;-3.3236663119661224997;1.3470931100111960266;-0.35049258232926455703;-2.2654165496254510259;-1.7691977219406689326;0.15391478658563637061;0.77177374515571417479;1.35029246457718477;0.2128094941789315242;0.39165012317535735642;-0.86065968213025112465;-1.512167760499117275;0.88571158261026428082;2.5815572005177056525;-2.737042008587120101;2.2379517707460041542;2.251518924708806324];
IW1_1 = [0.22901674601572458156 0.2524249979915700326 -0.7530392694357069816 -0.1574269129482767926 -0.1965127896083319059 -0.17371793131599405635 0.25736426139379875444;0.37198961024097171313 0.60637000319436817897 -1.8082525727861735731 -0.640819384738593123 4.5452891908254331454 -1.8484854044767906611 1.3078599553654799426;-0.14329795555623239811 -0.11009895235362276988 0.38656252187773298967 -0.58030053696743233438 2.2546565803755846957 0.63587477387714252952 -0.48361470901919573206;0.11474658344534999221 -0.097118163086364894809 -0.27748394580018981292 -0.064358376242196965733 3.8521749344436040374 0.01163916646037472212 -0.31118337867251189;-0.7359742087883898165 0.68361314747770418609 -0.12935069060072179603 1.5038413763867446438 2.3433662138649271611 0.80977583554388177234 -0.4980448557881831384;1.1411585702600404169 2.2073827007692496949 -1.4710429493296219849 -0.09033212922788340371 -0.67033152271110929554 -0.33420806695511690032 0.66074255607319498651;3.3379903106410964142 -0.60021993171734477901 1.4145967125866483194 -0.9895113194106132104 -3.4229619618127653524 -1.0121643853164585813 -1.1671280015502778493;0.26602569339426124229 0.035773030511914272189 -0.68342007011626393354 0.46782247179148428451 3.3449504099991433925 0.71231582491165323923 0.7312043130183244477;-0.4325763696844903694 -0.23058184417994873061 -1.6537038431030839369 -0.52781355255673978455 1.5589778818028492413 3.8206039494313910332 -2.5226037294244632037;-0.63146281239411239383 -0.68412728044820436679 -0.96488657585046466725 0.68612026449120833149 -1.7853508081951157127 -1.3782136937918483266 1.1469426865489529277;-0.063887012181169960945 -0.98935084136762196927 2.0048287868104597287 2.1265507953222262394 -0.25999076164783008203 0.92853779383354584365 -1.2327837312518985513;-0.35695621044556835599 0.042905160598975200514 -0.39064104323555348675 -1.093141453411821562 1.0461650054723705683 1.624787130870177787 -2.2007401168511786516;-0.058681873044337064249 -0.85007425609106368469 -0.56265345239777120323 -0.24644865089086065435 0.66578239350693990684 3.9048376714998180859 -2.7772487573674022876;-0.092801195653921073059 0.010744777749120961938 -0.54404093079165183333 -0.98849915732412407809 -0.25830236663927347296 -0.96471238132558978506 -0.090094030023045695854;-0.13242035746236910376 0.27334732355565327655 0.037596062616247483135 -0.55521065008899184168 -2.7453333889209208252 -2.806717491867099401 -1.9571928473196424925;0.25413991359053400565 0.056921509796094185707 -1.4299017065305532626 0.69673183000432603595 -0.93460313543236317457 -0.39955249853641927604 2.8021719099392998764;-0.11604928033702570367 -0.019846307736283406303 1.4772868760016262257 -0.98547715216829889773 -6.7983753858046753749 -1.1355067761105432922 1.0725628453721294253;-0.17290136506625816692 0.18044228670940390402 -2.2326469893223097607 -2.7789868500086316594 -2.4805184606923940116 -2.4941146280106689659 1.5738268135349988697;0.48617418780050947191 -1.1029245986417952619 -0.72391001063946713856 1.1908279285015532789 0.26395221231858972954 0.68373926088871983531 -1.2135452600916682986;0.73194621464877529515 -0.62487582559578347396 -0.54709328840969473351 0.41817133286105012679 -0.73032188889905391704 0.30512215144134419154 -0.44483292119566109069];

% Layer 2
b2 = [1.5966860015394923611;2.1188044492309159317;0.7351936178302841407;0.78792360555084306473;-5.6196120101288666859;-2.5596230392383554353;-4.9957712327486438753;-5.6228855642147284044;-2.4152929442748809485;-0.025097632044937086965;-6.0000801423876577445;0.25991837422393571089;-3.7090977078627678232;1.2301426169742775141;0.12972746361071713084;4.0468286550663217227;0.16305094035806128039;-2.3796489217774623448;-2.9342472314446830239;-2.1700832654234631924];
LW2_1 = [-1.5538836230459456278 0.5501010559866849059 1.662912108361191077 1.4791452653982417598 -0.8748888993634779121 -0.27890741643724464849 -0.17489920835908553953 -1.7158534038279877887 0.97457070400728462722 -0.50721886238071678399 -0.70360580733257616082 -0.8683757214497832555 -1.0269920176784146371 -0.13037081895352867211 0.3062835894141265336 -0.10785984709703760887 -1.5123502283615968267 -0.68407907507675724812 -0.33044983049191356539 1.7589937176736230029;3.0964742013911799035 0.93740041290607023505 1.9532060140468932019 0.22576309881530012835 0.99338487264846708769 0.29244880502953640722 0.10658561752516049204 -1.4425056729222938134 -1.220320812676061184 0.77509984773480078424 -0.29686543903310230741 1.3705409419311349595 0.99293034560802684307 -3.9747036216914772844 0.74322830794855809788 -1.562645544675720588 -0.61571784810631524643 -0.14642312266382923047 0.37520672695949330855 0.060440378789435499074;-1.833163584079307018 -0.017357158894268920335 -2.7108355842073121877 1.8083668475704943734 0.92656758996081745039 0.0072133834356937582763 0.09588066296026717672 3.2706109377356775703 -0.031161422526575482256 -0.0043055819065290854702 -0.31179618393150709821 0.12828065990006964903 0.20657966425805657229 -0.62592142829726105102 0.79133383577298688216 -1.9090574337588475107 1.2175824773228289821 1.5373944330612472342 1.0712085965440161228 -0.55383631652066656059;-1.5561131634510785293 -0.021726640805879358226 -2.4698560041251989006 1.576283128459087246 0.75031767303067298247 -0.047602333771591301415 0.13488348682292911063 2.8174132610267781374 -0.037731689426917597308 0.02707111773553475681 -0.2853355429506583274 -0.038573375958723510326 0.16819952683086097922 -0.68870773101045856812 0.72797812219126789568 -1.7057723816014094265 1.0237391295737499064 1.3679656174350562914 0.92578862807309292293 -0.44287212741458997778;2.7815175179086670809 0.034199963215352534307 1.4114032745533839908 -3.1452894760274663355 0.30376485934154867641 -2.1253889142321176209 0.26032579273146211341 -1.5660717469297034121 0.28815542616438460932 -0.58849192412623119175 0.49219001714286458871 0.31011514277100077353 0.22449810543673620611 2.4559662813657441305 0.38408793016134257226 1.0217003941917013332 0.14389588713223375183 -1.4279698807383387482 -2.547909983944825818 5.0051847108992211233;-0.69631288869744434322 0.21189787380242144921 1.3497283367002974597 0.01689809842918803609 1.2197727792515988821 0.53693606017097805783 0.31510875964568674235 0.96248940609524302747 -1.6015438278898579405 -0.028431417132547941867 0.73723092783098376213 -0.15529145956648046645 1.1188709543804060687 2.2809258381357087053 -1.8954192581682656193 0.59496808889683339139 -0.37437478369000098954 -0.74827790281075612366 -0.29370321017808909136 -1.3215019849672255958;-0.6340643195866370041 -0.14810734139645059804 0.86838795842301896855 -2.4726952083058084675 -0.38879493218538152544 0.47031240828030945744 0.26336680759577774102 -0.48418622215955392507 -0.81158065832429582276 0.12991309970584563604 0.89832654928356026058 0.055884375455360318918 0.44472963246800301107 3.6861470913052198917 -1.5032027853249774196 1.4731913368460298752 -2.3372218441586900539 -1.6680657300447934155 -2.0303130847653885205 3.1252846907222959771;3.1251273859928008214 3.7826288557271370294 6.2408330168065164756 -5.8014041350942422426 -5.4623999740206947706 -0.32884721979089676092 5.0900286851577138947 2.8009711374784242999 -1.8929534643201868516 3.4733893407715759061 -3.0866007370040691171 6.6454372421212104527 -1.493033722537133734 -1.8860224956641185035 -7.4582074131057760624 2.4153951141615390696 1.230964289340888973 0.78599433860210443648 -2.1095881073297699793 -4.8035935608904356542;-0.8866829483907409104 0.25309311932723521643 1.1441664127531137041 -0.3739531042937861427 0.87541166084386701218 0.54556821952361900241 0.27026600787386628744 1.2745252401239870466 -1.523455187212556794 0.095918726870101597703 0.59907688528322122767 -0.20226962654196325997 1.2765253610632667503 2.1923086352384109077 -1.6845951442494504491 0.16858673572388035988 -0.45993104749918001239 -0.77348565019707371526 -0.32231527502801821106 -1.2775155101620039311;-1.2914983722242654451 -0.27719652912699499492 -0.29581593447438492284 -0.33342069036508270585 -0.10092942812612212822 0.049323728635393158937 0.22497021607505254814 0.87401313194189922395 0.4941358251438147664 0.0063546997975346122475 -0.17894318883799131825 0.60421260644102225967 -0.55587192350958569698 -0.37815998441760656501 0.41392050945358116465 -1.2713574542568195636 -0.66791016125331759135 0.4877024141353381026 -0.38339211423043595417 -0.04477094816380240011;-2.3908137888363309997 2.0497223991010131705 -2.9972720998210951038 -2.2446834536349751232 -2.6479807143087459309 -0.8487037505503892687 0.29514170146807544581 0.69447025232775771997 1.3040124262341306061 0.34804502383778113117 -1.6334211728122494112 0.87223191462880622637 0.10558818980946153843 -1.5814740971224710009 -0.29175997795581165573 -3.2395486409078775303 -1.8344494145409435681 1.2257481469588176193 5.7388364358876060578 -2.6646035366747038431;-3.1827341966060100908 1.4099790245728920368 -2.0649631297573924904 -0.60945092027640823673 -0.7190396572623798388 0.032196045042938208069 -0.71119588166054292788 -0.31186253657167500863 0.91858777571271776896 -0.49293992619183790715 -1.0435688264969240624 0.55271730350946890464 0.059079178206387625294 0.12403735188574556425 0.011791379947354381844 -2.2719577974067397541 -1.7758539087601608042 2.9734924716418267288 1.4744800623109610704 -1.4443339048786398848;0.094074721912599357232 -0.56786067737202983174 1.0102583401471423308 0.036122719636216604755 0.32076428047866389903 8.6885307221907339681 2.2347349581923077189 -7.9054548081607194376 2.791417952082550169 -6.2054601933807731484 0.6694614251793062909 -3.75337025950861225 -2.9593610471174915943 -0.26019959812262211107 -2.9471454592269319406 -1.0991367635989934826 -1.4173220917371618377 -3.8805314714031373668 -1.2164321595023999123 1.0810315958876290932;-2.3281963842078625682 0.73302504101642573797 -3.7068474980395946794 5.6717058137481952684 -1.753123789541669364 0.57721923641525474391 0.038111161690385440826 0.90507786748588736625 1.4059397240828110931 0.48145420860135362817 -0.62683975168272465517 0.80746214251908254855 -0.92447120935362547822 0.41347278889873112506 -0.093644135727890973064 -1.0117948010260857661 -1.4048667084372963298 -0.094920170883984592014 1.0469687299412009374 0.27827978851587475972;-1.0214322913348532484 -0.17326952799186784437 0.30818179805143530725 -1.041762235174052309 0.095774532424076658232 -0.011731846255338154034 0.1639235187456044851 1.5122923435060366959 0.48157231630514024667 0.091444277967180881417 -0.36530006522044122796 0.43060905509900149202 -0.48724962830013857085 -0.47936136358050507322 0.47209741289432644029 -1.508569052712488423 -0.4983852677827423916 0.74482985705113480268 0.07276888575881015897 -0.12982062602217914193;2.179359059380606034 -1.0789012109482472024 0.74729832070049828641 -0.011592870484717160418 -0.0018076606689893153293 -0.15478338856119397415 -0.17088616511233842288 -0.078162965672540135609 0.10331256753977928475 -0.15881000194676156423 -0.021656213280215236977 -0.31558010965497962363 -0.25343574101562016399 -1.2168591942182702681 1.0323185843212978607 -0.26282700198747055431 1.0366932039224712181 -0.6491685855842275199 1.7419357279010150297 -3.23044804003669217;0.1698875868817772139 -0.35306139622172916237 -2.2067727922404545282 1.8548495555545918556 0.55078234476484155824 0.19198433933168237986 0.26934298894406999425 -1.1954793128787142287 -1.3403154087563988739 0.67828102499487830102 0.086733375375586799216 1.8380324631812150482 1.1581961819303934202 -0.77732934877068959878 -0.27293920042051728059 0.040261714659610044198 -0.7801925354638700183 1.1733278260976338636 0.24188348016443064759 -1.5379301083352692192;0.86411158839041224411 0.79134874113858733047 1.0126014776814273866 -2.1741792798029209166 0.67673806002853276187 0.56119255727837402681 0.26087889450923712475 1.7680769087379315518 -2.1798088814025491367 0.60384729237619516606 0.71698309787188929665 -0.66957152946565490215 2.4657169046190183792 2.4391457409912771226 -1.5871162723718690302 -1.2813613995554686831 -1.2551552334040640968 -1.5748164572940286376 -1.3902492582507859353 -0.49802399669290958739;-0.53107742030050020254 -1.1214323510188708433 -1.9665814090176094719 1.1509941120038762463 0.50329785619351052883 -0.11300310840659275047 0.043289257034105646516 -3.1411467878901428996 0.37876872367899605543 -1.3330477710432804273 0.073699946679039174402 0.88614018051389531472 -1.4252855241835247213 -0.4962880833503965361 -0.98565159505503596726 1.1389062016448736614 1.0488099792083018791 -1.0763824610756889122 0.5339754402647833853 0.38086910023463366182;0.66486933407938986207 0.033276545776921968856 -1.8425408641695433243 -1.3112123868567231444 2.435570062141183989 0.51851821238520334756 0.031046080683136564882 1.0384110978707226103 -1.0872469222960801094 0.71334056022657210683 -0.12700705219596927775 -0.083422524477470824666 1.3362613386436261731 -0.76503634083496530049 0.72814483209629654592 -1.0789461079834399282 1.096773256733905022 1.7452222639301906426 1.1859412135361171448 -0.99258923579291225003];

% Layer 3
b3 = -1.0995333152990562908;
LW3_2 = [-0.61646243395395072806 0.13230320377376603158 -2.8779042963960796975 2.9714083062041729555 -0.26016966620901194052 3.0915882831300005584 0.39806055038283666425 -0.1101408445463234187 -3.8747148675276599228 -1.3748979901174018803 0.078910668481077417269 0.16365943823542331015 -0.025615466474912924888 -0.18011447680969852603 1.6479654010921598317 0.51239394026980700225 -0.19983611933545464279 0.51765239173968369268 -0.22928836533941232556 -0.33527949337829676679];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
