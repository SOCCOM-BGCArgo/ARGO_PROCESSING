function [Y,Xf,Af] = ESPER_silicate_15_Atl_1(X,~,~)
%ESPER_SILICATE_15_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_15_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.9756156204978925217;-1.7741761108735769614;11.321986955577074241;-0.72431954036243462181;-2.0388468179101684186;-1.0678373529635956096;-2.2178835353388040019;4.8834566137319947998;-0.39380664396869308197;-1.9099510010602913646;3.9297479259026903975;0.054993038023824665494;2.4357555948292799464;1.9302309933891315108;-3.1539891460211624263;8.1510271238236988722;-1.3849510436527148194;-1.4129469517107984267;9.0677595565360658014;2.0389714363373991901;2.4729895419797363054;0.96528383901036562964;8.9083556479073671142;-0.54543880974081948576;-2.5293546174687988604;2.4379676617641319325;-1.6508402731780302819;3.4434089131767979808;-0.060378353111890881166;-1.8828451517830273598;1.2267671650636937652;5.0287291430034715134;1.2954313828434016465;6.4346416958743022363;-12.302845120567234005;1.7977403467111368052;0.14614312728844111589;-0.070918345650932260171;-0.18981467024762346818;4.4263680930488353837];
IW1_1 = [0.48771233383119738658 -0.53726722303501595057 -0.5744238256859768299 2.1179672776075002538 7.9883895809959719614 -0.48558382359923746296;-0.533005573647169828 -0.3176749895888166253 -0.16742750657570587558 -0.043965143625092351076 -0.32218407619529015884 -0.4522352146063424172;-0.82814735050617915846 -0.65430809711971082976 -5.4603972145333559141 -0.072543375517537964092 -12.16175784534133264 -0.081433879909884043791;-0.081058929656558753596 -0.19871584556768764895 -0.068302342531989343466 0.18964532621766633236 -0.33533952677430511891 -0.69466216176795458903;-1.0480680482493460737 -0.19267863391386502725 6.0200705445552271655 0.2857456693513396595 5.4108573056799702528 -5.8003760701888884554;0.55114451871615866008 -0.91085008083349239261 -0.45699439907871919342 4.3393041516182861983 5.2974266541094312544 -2.7085641338311252646;0.26780540542104019908 -0.50670777666585586907 -0.70856139042150501073 1.3951518249741055033 3.8158318912546218549 0.48072322259536454103;-6.8861060881718492155 3.2807646628203315231 -5.8142914519743627011 2.0583484316673565928 1.4555973916321820472 -3.354820474355788118;-0.45344459724476332552 0.15725312867425403351 3.793606628595068031 -1.2910173091389050004 2.3847956341127973801 -3.0379505009512750568;0.023272543763221669594 -0.11355772880438684547 1.373302393848857772 -2.377343498777839681 2.8349013937318323642 4.9904890825201828619;0.25596001636029980242 -4.0800666366682552567e-05 -2.1345295840776401519 1.7941667948908126551 -4.8352620405692512406 2.2639576755841837041;0.5132438370553290552 -0.12699894351131973957 -2.5332080100573808323 -0.038974198135828426459 1.0531114298922386041 -0.22487469380620905834;-1.2114509092937566503 0.32560936427459929998 2.9998471527374652723 -2.5482383791341849388 -3.8853450081963805118 1.0499607379355697656;-0.097776946503930164956 0.29209478046696102371 0.68107039140999503513 -0.93257914391584151304 -2.569471694694187569 -0.30856460608707531046;1.4348050701602224066 0.60965690402655481339 -3.4273790698407959887 -1.2027905101672420329 6.1164734364961512725 -1.3978826130375747727;-4.089618347475065363 4.8911406491424838094 -9.6700972121094199707 3.2643342507576904588 -3.0590530015342185521 -0.98265680587296688753;-1.6936643014029137966 -0.11033058668001671787 -1.2901194689282435846 -0.31429303362910016029 1.8966575064105919424 0.1903633599711997415;-0.19391211484548459554 0.6906583552253181546 0.90964649656250295973 -2.2412338374876861202 4.6065519881762462262 -0.14299167020357658742;-0.24568681144854548348 0.064585849238382439519 -0.74603236816788531804 0.45553037950144797952 -14.75332733959488607 0.67175218583572382514;-0.24892844232486205369 0.72347598094518894563 0.96640021407849319157 -1.3811102637915371183 -3.8863658447153763831 -0.72806931757842463515;0.57261499703832074992 0.80207713142232517356 1.9540379079756704517 0.016683789084243939166 -3.1197029494777472891 -0.60845055949239734705;-0.93559742659577671553 0.86478219566307967803 -3.4678723439248995142 -0.83296260602433824793 4.4340454801561222098 -1.169274660445193792;-0.24127459124649161537 0.061630098985373603371 -0.75623516778074217903 0.28203438087102572496 -14.781917709483300527 0.66018624168254302909;1.6282718943059462102 -0.88743082991017208094 2.0702417381553424036 -1.5921082602929859107 1.1947144740339956659 -5.326807343349512891;6.135384441424511337 -3.8059957937434982789 1.3372637577703199163 0.23789248247465893948 -0.77905579953166170792 -5.1396139699191989436;-0.58189934753193994776 0.64420403379027413315 -0.81849639895116366173 -3.5015355945268007432 -4.912705351636109441 -4.8093628598844544442;3.2949670023887129844 1.4910108052144788182 9.220518084328482189 -7.8852035890808744867 -4.0915906046054093537 0.28712637821501607593;0.68283026132645807671 -1.3434889742006632662 1.897060801046124956 -0.3866668059112983169 -2.5963056143356402217 -1.5547353065770368463;-1.3086102686676672757 -1.4330365375624940505 0.55681054423206033377 1.082912062895678762 3.1534496081996197248 0.067784703550636385416;-1.4632334904189592262 0.0134079353605299368 -2.1792407830889128917 0.28922985557147712354 4.0714111326594757401 0.7094656855130806461;-0.080122960943264986966 0.55556385211841541327 2.588151997194885201 4.5482185491185527226 1.7945801447297269338 6.4342274286280822793;1.7463639042283389813 -1.4437214860713993847 -3.1313570899428997407 1.6921823888801308389 -4.1245191599434516405 0.050002039066728863614;0.1679289508025919031 -0.08141085211941757882 0.65753996136862347122 -0.68335424439139291763 -0.87311673266916367542 -0.31167512427292404231;0.10739462683160225231 0.23098771226279102287 -0.48741575512181517515 -1.6101761296108325627 -7.6468412026605729892 1.2618708057071119644;1.2173144127324031505 0.64315699289742467304 5.9419018329304060799 0.46180114658859156007 13.340417928772710709 0.40141877719330837371;0.33993259013191573503 -0.33374039730668741965 -0.99808738010964370702 1.7631172526330545214 -0.88763043207408620638 -1.5233609686196007971;0.091103339132911673182 0.47111546650294966465 0.20154987143815225603 -1.287186823829633342 2.4627419642652688125 -0.012800199600654621479;1.8654963983828904972 -1.474098398806308774 0.38510158063626159786 0.62156137159981328377 -2.2989762975150571656 1.2384804524085923916;-0.22370588782417519247 -0.67232694186795338709 -0.72731719176650699854 1.8952057701552835756 -3.4680661181150793659 0.27267773268899014871;3.3855393693462456639 2.2994207796509149588 -0.13782982134598176227 0.17237528999116749628 -6.4590403895028680736 0.60894115355890754415];

% Layer 2
b2 = -4.1580806443779074755;
LW2_1 = [-2.0061811094517185694 6.8245466592621744084 0.25736416274951490202 -4.474110622187439823 0.04769629723090344775 -0.10652455477009308005 -3.8581872629680757925 0.025858855842763518729 0.16830484624074756872 -0.18232273759619085918 0.31665103024950158606 -0.38758138902194583242 0.2025483431681612545 -6.5709967980870551685 0.12315847212043953829 0.024366967702917619737 -0.42890478368097112449 -2.5111591140473916717 12.021454370773819065 -1.3949246879374839203 0.71778005403433609022 -0.26747665240803719655 -11.910767539410887395 -0.096116410843963426269 -0.033950901879306355502 -0.089195852916252593712 0.019826297820313355108 -0.88305630029878146026 0.20514577651165361027 0.44741406663950100686 -0.037659273130933243467 0.10990281480501244704 8.4375512135986294737 -0.89003642589340625779 0.23263064420095566631 0.7062550376534393326 12.253973845986971369 -0.25362694200905189224 8.0085237392158834524 -0.043341574306346275502];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
