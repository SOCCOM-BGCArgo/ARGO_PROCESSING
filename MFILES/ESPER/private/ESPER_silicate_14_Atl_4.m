function [Y,Xf,Af] = ESPER_silicate_14_Atl_4(X,~,~)
%ESPER_SILICATE_14_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:43.
% 
% [Y] = ESPER_silicate_14_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.03];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.604229607250755];
x1_step1.ymin = -1;

% Layer 1
b1 = [-16.924055743345807201;-2.3625952797891582868;-2.5685310722480978463;11.448928373069794162;-1.098232917085424587;-3.2660400125421209516;2.0089161601246492417;5.50541114876166926;17.641082201430752008;1.0251185668342248647;21.256437682257761423;-3.0624513852206649567;0.33001221401248326259;1.3293395724174446038;-12.054243591973182959;1.9449114246548193652;2.1562928453262775186;6.1554126637696073843;-1.1195517447962708424;-4.5164963895602534549;4.8583359140951722921;-7.166244319663833906;2.1331766907725899785;-9.6338537362643972273;3.7885714252870390517;3.8415346239553338492;2.5145965424187681769;-23.158295833787722273;-21.707781543886785158;3.8784739837274435637];
IW1_1 = [3.8464728767494715811 -4.0647119805245743862 -19.264840948961257538 -4.1771968858446344441 -11.192307780949345641 -0.3197031382117059839;-0.30877702523255123879 -0.11478272872783815139 0.62296690052005099236 0.28825437854928764869 2.7208246829095781294 0.41283697141601760627;-0.41035783733155595243 -0.26483126143551155574 3.1783146323266948663 -0.16980757985778568986 1.9000741435267103352 0.81291372115155235978;-0.12681413902552451933 -0.12693094141645247519 0.1847316378856508623 -1.376532608063719243 -18.974833327248990855 -0.076209173553522760458;-0.44941719354864334557 -0.14575039278753479377 0.46535542317983791261 0.57044453581446052937 0.8127160388289096371 0.13179870070678906258;1.3056258843748731469 1.6155410773416805092 -2.7287072437736945574 1.8613421899794506675 6.6901919133143179508 2.7034318375307408999;-0.10950792023061389768 4.9679716041101018575 -6.3796874895256605598 -3.9336896296445305055 -3.5518756497878842815 -5.4913666757292984855;-0.036348476332007086109 0.062150747070328964117 -0.97503669479363164196 0.1787782225916395018 -7.1152848172651586012 -0.17865125751301347279;-1.6909254781037896809 0.61977717175729796217 -3.8015897574989141461 0.45143943075473957904 -24.518369556293286848 -3.2352370355631641097;-0.12438463353161344216 0.11437750443195421335 -0.4749626491317942012 0.84323123264791821629 -0.02251774144812715428 0.64947407662561351671;-9.758861981394963081 2.5986815934097244885 -7.7878788303918584646 14.048000763362040288 -13.299826409095215851 21.218700276351793121;-0.44154190129846332402 -0.34122263929431401186 3.7813281276147669985 -0.20828573745759834668 2.0926552988701736524 1.0601560873186366418;-0.58187578218816682352 -0.27271729492047475096 0.10087132192531356178 0.7496368994837290245 -1.2712674683164473244 -0.56571052393985876705;-0.075325397855478662401 0.027529555590386823455 -0.44246283521493418034 0.58602275207726162165 -0.6006801212484743635 0.46495698391037243447;0.12976949260534242914 0.16282514819092508418 -0.30503671605003401801 1.6426510300415195776 20.296837962307407111 -0.034868269971794048356;-0.22936117456645982449 -2.3556939595840185042 2.276103496808748794 0.97000492238123092736 -3.3541330959812083456 -2.9727146923845446658;-0.47003818641560468627 0.20301947200031245089 0.98356650909439413688 0.62121620291727253083 -1.5886525387212580007 -0.51110701783252332486;0.65331372137709475822 -0.58355224330992294668 0.84023429153094353339 -2.0028058786132447722 -11.840763587094428999 -2.1834670628021339844;-0.39481440747002982672 -0.45348946699827652473 4.2321018411096842371 -0.36309158988332879137 0.40729842294255735879 1.210682160716379796;2.6862580864668390568 -0.33299686083953777826 1.491303702345324389 -4.1972373502490327724 6.3022855962360146975 -3.1308434751854021805;0.80020386251120612098 -0.056782827982135908318 0.42033212663095925743 13.544699957492614573 11.569079917739578889 -5.3634666316353696303;0.035238676355675783991 0.062755143622409401138 0.14713332969182507659 0.28812656990128027168 10.705937803129527808 -0.071747912211223022205;0.40280024612094217362 -0.13133119902563858417 0.4853202319157281508 -0.46016570853902993843 -4.8108172500095749413 -0.67459858386202198322;-4.6706506513563157412 -1.5495963263408811805 6.3667442070531254927 -0.91061686856026602399 8.9732532017971990967 -2.2410636369200775952;-1.504369314164899718 -0.38232892336562573909 1.9327555260126942915 -0.973714907645337302 -5.2649283118968757123 -3.6272262592244670643;0.81822802860930454738 0.63320516004357774165 13.70551602025063076 7.497251454225170697 -11.183840003138209696 6.3504375669972485952;-1.3279927875704176099 -0.57701800366928790442 1.6398263283835583515 -1.0310413779380875887 -3.9577960939153831177 -2.6159147327834815222;2.42227482608731437 2.6650280800698782357 15.455287241804779086 -7.9934702629352507586 7.674129586644657941 -1.3222154130054526444;-5.9451033704852758177 -0.29540419769627307423 7.4113882102612063107 -3.6994544659781452012 17.316903863463263491 -7.1988433081764835464;-1.2462422681269473834 -7.6963971157609298857 4.063756477430808367 5.2539699466864080435 4.4228392465659798205 3.1529586410015162379];

% Layer 2
b2 = [8.8429509339840173254;-1.7795831986375554301;-6.6035572969688409728;7.4675360019479999352;10.464194919593991173;5.7584118132604249496;0.4965401333212284829;-48.726448860511091254;11.148111719466292868;3.4266840774163980221];
LW2_1 = [1.6801855049657379304 3.5143811487792597781 -1.4439762666622164566 -0.32801405451673504299 -8.7118245668167890727 -4.4244937739156906531 2.7402926646155805201 -8.3748302313681097786 -1.5523862304486071295 4.9639680935727996669 -3.7789972206760116258 -4.5084002742818727327 -10.786952556724637375 0.86207178916762561283 -6.9669770124897150154 0.058449408247394897542 7.1402749219246635093 0.38698390370540258765 -11.657120776578310029 -8.7316645841995512711 -0.92880980410324698315 10.46597469673570302 -7.9689383660269470511 9.3105738984096095834 -1.8572750766867953676 -4.6783253246606841813 12.48242272936775521 4.782234819951278304 -0.85223986198522239111 0.5957258379986886121;-10.577287916336008067 2.5449401307174337461 2.8833238346004694819 -13.150078998767321892 23.996979343841690735 0.76505063886336743817 -2.1644281953008945862 -8.3197166758935594544 -1.630681621397866321 2.4893544488588768004 14.66823831567454306 -15.183894342440392933 -23.835215195109906716 -17.791234489311051448 -4.0318380571170102655 -1.9795091130208557484 -2.2371424323397115508 2.6141730637908642265 2.8396720512218851518 0.15709079199300882146 10.790750852584892527 -28.92268340415243344 -5.1061260793931122492 -0.64900872841708057148 0.46472676369741117153 1.3324548306175356682 7.2441563990303361464 12.176188871789069168 -1.6350323050430308758 -0.35944456869786539643;1.7785012353318543354 5.3799487484498342837 -1.64257089502745246 5.8341668972791733694 -2.6964991845447294772 -7.5910515025582032678 8.2174248940331864333 2.2655992338488872839 15.683182638483964766 17.309098096752645546 -5.358214423145400751 5.9462629577702923456 3.0530529242338055873 -15.058171717502908393 -2.8873944519917746909 -10.631936350794440216 -2.163529553919662618 16.336452580704641235 -18.858650349983747674 12.068243152500198079 4.9499347029969582579 7.5487660455861487208 -12.843879586835431184 8.6271713344538270007 -4.2644771844872115807 0.67894048901538106566 -12.760923733893152487 -17.043613310113400416 3.8985564269955221839 0.41176684770339960773;0.047451798634542310951 19.591508431667055135 -4.1748075806015174649 0.6229130849011358384 -14.608867488094526621 10.112831888348297937 6.9811575298548342872 -8.4499792878141324337 8.3611734224511646829 10.687033613886287142 -33.665772350494123089 13.842962949675140294 -1.859749002347944602 -10.955821956999679756 24.477956611273253174 63.470268472203990484 -28.586519953716301501 -4.0951426066623968225 2.9017896924134451986 -19.018575077356878467 -17.626169051766435558 -25.718099077844435385 7.6909818879320770435 7.1874191435791674465 35.117501939655141996 18.363061473503321963 -30.605737622884966243 2.2246462046140611513 9.9263520366724620203 2.3428478441418296718;-8.247677913520563564 -16.607637613975391844 -9.3292260335726382436 35.307513668190900091 -0.23964077909504433173 20.245635011446822205 -13.259577886246232126 28.360550585682808844 -2.3150430643218662397 25.360968657273733839 -15.091298526974600946 4.7271932120924073928 -37.422132609567995587 26.083521815540777311 -14.680635437709113944 -20.653371273379622863 35.76158298592240925 -10.907677936472106595 5.6171182262590706458 39.174677941468644349 1.432822298308465081 -18.142767974348096516 -9.246007173264741752 8.74077536013043499 21.771359929770380148 -6.2745794457796799648 -14.447164190976561571 11.544905190865446087 -9.0430122712675871099 15.067070194101658487;0.058088718913813709721 10.170144793630685243 -10.027474648590406048 11.107113051395797854 -9.8435432132791387261 0.49701519195819376939 -0.029411531994866610407 3.7933693500336640447 -0.1082332422005605338 9.8695849967788262802 -0.019400676140327255403 7.6469203050310188274 3.5260421720922638933 -12.376838403890383589 8.6828741976321790474 -0.006447224383880263178 -1.6037071310099015875 0.5381464386580853132 1.4550845957485660787 0.045939049328809378192 -0.13745405960731207906 5.3231656296478959689 2.4833760106787909905 0.069793970518603101749 -1.0762104266672301023 -0.00082643143933038335468 2.0042131904568920575 -0.038617581193885294755 0.14082826648196317132 0.081570988450556741745;-8.5145359322260336654 -8.3728420765866005127 -14.688259499327212865 -24.187706312287225785 -11.878141665440388408 11.521772845486520254 6.0644885870452407417 -10.049183830327811151 27.159970447222534062 10.5735258802232579 -12.623072720198459606 7.6973535482071762104 -19.719263658715043164 -1.9774341667494701458 -0.86494760286098149038 35.65233273124480462 -26.777277289302848118 2.5552866152601594329 -9.605345695703908504 -19.671435258953902547 20.265439632029281114 10.433859863944601187 -9.8604686108396872868 9.2753257334587946303 1.4132851992280177633 -6.4365170318790223547 -4.5610435583299482332 -2.1411975619897578582 -5.0816130886648815945 7.1427891950874213833;29.286405229212331136 -1.4495604866084321749 1.7732128425471127553 1.1590537072857649559 -23.398608731063898603 -12.528079332201704332 -0.50394635993102088189 -9.1935809314941447923 1.9043527812144762645 22.045897746370908266 -39.060623595058295621 -21.973297913169719919 -2.5633323546623389966 4.7578511433234469408 -1.7004215969838925027 -2.9369776398717584165 20.711858145882292348 1.5598732303221116702 -2.9043449884996297428 11.821238626767652136 7.8277692617392107266 -23.386216461691901713 3.4074437971966355931 2.3822401487433615408 11.428542841408406261 -3.1176057604915441424 -8.7093121237110118216 -0.44136807162187863263 -0.43229643423816027648 -8.2092812941658355186;-0.85471936968427908443 9.0103031100527246622 3.8646634588291215451 3.8484599471209195443 3.3425166413682472211 13.775279443439938376 -3.5459980207994354906 -0.81786184140289086564 5.0720485077379962036 -0.64706035435275977008 -0.72523694560622964378 -4.8837383887280525485 -0.98561626199070540011 5.3366090259199285839 4.2270183653306503402 -2.5724812794947111705 -3.5071004340177558412 1.4261852859807762073 -4.3127055308113710907 0.38520572341752346013 5.8313389057581961339 14.114164993718674168 15.065162881984438314 -0.52408579507426700239 -18.358706646276949925 4.3907880612703875656 35.202824498435631995 5.4855347669370058128 3.2558114446412274035 6.6741516042959299071;-4.4475804616896263965 11.295899109248304981 1.9110166831399379994 -2.9659055347146501269 3.0927262178634586931 5.0569010733822841175 9.1942463054360175079 -3.0442258236381216641 -3.7587821914723851258 -5.3191135557562008174 -3.5778875942784860165 0.50231334957664408591 3.5541714159116417626 -2.3377225523040205957 -0.70671027587162915662 20.034109513519492651 -2.193918451875027209 5.354356557336288347 -11.036050757671862499 7.3526292117355449562 -3.6668125466354384301 -12.612336392713210387 -22.407432031380327686 -0.87921088852057760477 0.31095314164774034982 0.56138144352079688559 -1.837965256400815095 2.8565068084584668284 1.3169535703537833538 -2.2931490573479700323];

% Layer 3
b3 = 0.39486590870345023019;
LW3_2 = [0.014976426059930670817 -0.0089121685934990119149 -0.0084564311309402642042 -0.0048796529503492315494 0.0055422047307575692671 -1.376632304501517412 -0.012838802985712213095 -0.0051740423416176718752 0.013195908704480494023 -0.0091663166711989495922];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0145232735458572;
y1_step1.xoffset = -0.52;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
