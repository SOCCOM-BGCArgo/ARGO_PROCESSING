function [Y,Xf,Af] = ESPER_pH_3_Atl_2(X,~,~)
%ESPER_PH_3_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:21.
% 
% [Y] = ESPER_pH_3_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-1.99149636107278;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.156285889561239788;2.1881459546874419964;1.7986316708793417263;2.34077514399228237;-2.0427140051319345737;-1.1705046016951299315;-0.79949894097656104552;-0.7151781359550148931;-1.2326415208553178626;2.6703378589260831077;-1.6290618825075739995;1.0610327428893315815;-0.53231287080875533402;1.1823449369985783441;1.5238896986296752711;-2.0638191131949166213;0.69163575297322898994;0.81440484957521031006;1.6610304961538711055;2.6390286062168275549];
IW1_1 = [-0.41365587203926756921 0.93291753660130583015 -2.2891587791511018857 -0.15091451256997245878 1.4909825353663255232 1.4009759645114372439 -1.7155760732883102992 -0.10357534834984188921;-0.59745188579695895914 -0.3654312605668481595 -0.14004644863524357001 0.094184519117922735343 -0.2362311275850254022 -0.64274469938281519887 0.7586676386263334626 1.1853794421735179832;-1.3711373483494535552 0.044226611349082733948 0.60403502844027689989 -0.43468704618151249308 0.40008434420488264704 -1.6786842480519854615 -0.22254043497308814703 0.16957331913681369939;0.0071695295622986945916 -2.2008606946758462186 -2.0396162607119947552 -0.066304460828424088836 -2.2405890838023103662 0.998971774182695893 -0.31992353831259445762 0.031354636791253873151;0.76166955734974961523 0.76522579092398756995 -0.79231893230976813136 -0.5654785717053337768 -0.37987340630470922687 -0.23675650637868628223 -0.32015332256254169785 -1.1783468429563679347;-0.022629950586072575258 -1.0702567706495900168 0.039388565388416112156 -0.21035080626259822223 1.7385913424921566328 1.6088797169424959854 0.96931614765233709008 -0.43029041334363288263;1.3781576335825564961 0.13041110005795605864 2.8449496938450278272 0.225150505117696631 -3.2515058766694493464 0.62568358994625339342 -1.248333153509697091 0.65471865946011387205;1.4014474793580176115 -2.0930488881490294517 0.75078393378830854399 -0.74986943148775497825 2.0898416318555117499 -0.44185839375809254914 -2.1852651372406879382 0.73400017140335027666;0.47014751618022437851 -0.34104037592791741629 -0.46885241712920022739 0.66282970323149226211 1.4270316111266070358 0.060960990304697051934 -0.93402767821441357032 -1.0257810599223260439;1.1327363012658424601 0.27886138038477081835 -1.5504252502098625488 0.12936054080089956497 0.72618679231860117085 0.72001878032278554542 0.10692097832015040604 1.8699330248327554749;-0.079678110768113041829 -0.31490931475715233656 0.93037384441718551376 -0.49465848624266883782 2.1996517256388083972 -0.76012349366860498812 0.17492036850295758499 0.75487135708830954695;1.3238347342112590788 0.25638401046738262812 0.5665903615194288756 -0.56477144276755031349 -1.6186563152496220575 0.94697801704486439522 -0.81619695373667777716 0.75925936284215522765;-0.79513612974659142463 1.2653893201673225288 -1.3844936747060585525 -0.98002386054093404422 0.9212141133606048804 0.49595413901668389256 -0.2142114467380142051 -0.21837587642406650068;0.76524094693908484288 1.2268427095098197732 0.11837805055210785798 -0.99222397556554164932 -0.46232850413086168384 -1.7109573120295196169 2.0214562328226208798 -1.0911456771716385727;0.86636697326107114936 -1.7960800258265834373 -1.2810542095172252619 -0.83057652894713651648 -0.55969151927045612815 -0.33024461070330224377 1.5087575700684194846 0.64099981785089754638;-1.7850959078030097515 1.2847439220416789762 -0.85767657418297393868 -1.3155286459506028152 -1.7281364913877284017 0.75796477829398456461 -0.14224188927745665123 -1.0228327692053154063;0.58448401116030168634 1.4763881562130589664 0.072881353286314592976 0.068187413323277740185 0.59466914284631977594 -0.49826319330833257482 -1.2105932791584177455 -0.18044972435021533474;0.42411886701988904536 0.82541224477543073679 0.27044271616291176707 -0.32053340005858521611 0.53979988290439950838 0.34984820321391485454 0.47025508650692332546 -0.30427865675295140413;0.42919702778419338562 -0.62428598221393882817 0.7430923483975063748 0.08618627724334078366 -1.5269515438911469563 -0.14237913139824309727 0.40989073744623877316 0.28475499405434762101;0.37022722109478301 1.4608822494768967104 -1.7236371919909845296 -0.21366295392798809183 -0.94287404647937145263 -0.41769723695284050047 -0.39338229087836451559 -0.6287276839605676626];

% Layer 2
b2 = [-1.644266747299145015;0.38284377160910942894;-1.9106779350108440418;1.1376991938559068984;0.78650114844985774543;0.55131857147216567494;-0.29211434602153896201;0.41732180671636592839;0.4597382474686999565;1.4531959288357250148;-0.095712864129511743272;-0.66859038175018448147;-1.7117361178585879244;-2.153089947168516094;0.64030407746677397984;-0.28238364659196002471;1.7435254245244402593;-0.21859740491307916299;-1.4699180823305790788;0.81766397595209305837];
LW2_1 = [1.2022598964981241476 1.0247599287106401444 -0.11472856042850076985 0.7427297907311130043 1.2347448111232135481 0.64914394051992363455 0.57481441630042262592 0.61217934086697445295 0.039092973020683936813 -0.66892023280787404893 -0.046209858871715261963 -0.90491854687557304882 -0.78620563702168977382 -0.23880186702358913164 -0.16726178222467483203 1.42546650004525155 0.17293131284814305948 0.78230273151701668066 -0.9040760729711773136 -0.21193916355064490453;0.76206637574315805317 0.83595753055131960529 -0.10145698826104929124 0.61573289368130312837 0.25939656175200187516 -0.20185000878964778903 0.075645266292835730559 0.70292348569108131784 0.2845570137671795119 0.54900187445953585463 0.86592732782350778642 0.29144836258738965329 -0.14874271950430129063 -0.16292159382763632403 0.041129510896951472498 2.2865831063750081675 -0.11177274972080952775 0.015400712872103424628 -0.54765807515702114028 -0.58140111222855750395;0.17648232789570525436 -0.091622852916410119084 -0.44283037008723774575 -0.29464643147927538358 -0.56935679369751546197 0.073793852832699263766 0.32604043666305765337 0.1881617554271783066 -0.14873433402940081094 0.69144111283632758713 -0.7002068063763329242 0.34045094960078076118 -0.14169795655447472993 0.33047728046455748796 0.72505689555037400318 -1.4047823465510487218 0.23691116484498978001 -0.27585961551739140996 -0.26595688999877786785 -0.58950300708131730953;-1.7250061956059976609 0.59357642410879429828 -0.67596463560990183161 0.57616045231613843836 0.024819286903121611648 0.062267122487732681768 -0.23440779769256298026 0.36998060868022086822 -0.88662334080281335336 1.1945890438352395613 -0.26773109227381930442 -0.35792433027767961429 0.22905041358568181686 0.086041553334431697397 -0.31101212449972170937 -0.37889066796124531988 0.67956779523068089333 0.1805518015874758575 -1.274967166071461655 -0.48439075199283865292;-0.7020309201239050001 0.2810591553599814385 0.34864756483812903154 0.27238593789905707343 -0.019704245149920560781 0.91999877032910115648 -1.1179286067261564597 -0.51516878243916097713 -0.076475616166755591707 0.97732174005089045288 0.93145228755749287508 0.069646065994886138806 0.41502399903857939423 0.78551573702912136365 0.31735773713162512832 0.66078997442294684639 0.22607028440361015553 0.22198698267789931937 -0.35794416088047154023 0.90476277972557761498;-0.64475705296340291017 -0.055317087938276672532 -0.11210386582989162463 0.10483600828137630556 0.18862747286984682393 0.32541377546120819897 0.04305894938044281528 0.030179110529853420131 0.58102291353691815079 -0.9445215628467950042 0.10252616772081875329 0.40974070396531936389 0.49117043437971769082 -0.43069659897876955146 0.25776119270697317454 0.25678950091412178214 -0.28457836118912382961 -0.39797658285172438086 0.65629484116023850682 0.58146259350977791414;0.15302383200639607663 0.21225029031499878518 -0.32855120785018565588 -0.70825356060666566638 -0.27516979990054624139 -0.39206985853988329804 -0.0043396524679841855243 0.52714968757349189854 -0.88607611371081573814 0.70011741356963475003 -0.68072744703522758414 -0.44661482649867123573 -0.58460230838270821341 0.23251627260793095164 -0.14614899732848901648 -0.27206915796970509991 -0.018532055761421705603 -0.02034475033486822515 0.16421514928793820576 0.5291328744482312052;0.91502430028509873505 1.4753582073369060357 -1.3598296580100797115 0.36676672764912154889 0.21520391063422519839 0.32844305650491001369 -0.061383537838209170645 -0.95100923339739129592 1.155043534656326143 -1.173526569025254096 0.59993878584714388502 0.9047602379153569796 0.18680004150475043589 -0.25042199217446198256 -0.68083630070504375098 0.15431133861202583901 -0.74010534516637382918 -0.40676833241057663848 1.1347628452314690861 0.5545524451682520839;0.24003239020748112775 -0.15606605451641128446 -0.56934354251508612066 0.66649091651748804122 -0.35878556403866290747 -0.15510549440528795251 0.20816422911326787348 0.47980289566365807996 0.47461277598962708923 -0.44887997223832820648 0.41028143732104876973 0.41304982004978185728 0.22293332211436092671 0.17148351375525300311 0.078215448801538758894 0.89238765507907691354 -0.0021226022229816864095 0.097481153890454960709 0.13768871463966469992 -0.11228690490507496624;-1.1779974881168122636 0.61319740169758807369 -0.6081531476855077667 -0.060164689799641846157 -1.6044364184440753629 0.41602281517988948245 1.5646956753775487226 0.18213811205265947879 -1.1612789991003242829 0.1859660339777918503 -0.71364973624456229384 0.095348741454485783087 0.50213367116588369932 0.97645454531139475041 0.23743655719201114951 0.41307776049279365527 0.17300350414549856004 -0.54302874942493295496 -0.2502664541314689739 0.36812879199400960761;0.066691486341821634709 -0.4797915571087214559 0.50718407916202157271 -0.13794233633171373854 0.93416599581691794896 -0.29342078660302578497 -0.61858628575610974387 -0.24735940932654001956 1.1681099098952507642 -0.68594649243290739538 0.078967755492910310378 0.2824457810963424409 -0.24375768350719687061 -0.88545036118625009003 -0.03194070972290616317 -0.040674096128425089869 -0.52151118440854160596 0.33566748230062021241 0.71589025557123942001 0.60488127155132354051;-0.3651624128888614762 -0.035467604824358303639 0.78285476779231721878 0.46518146949861399753 -0.18479911971436702167 -0.093627281523066679947 0.33993096162795743975 0.34819800926738436742 -0.43242625380241273003 0.52357421020381977872 -0.71127473632095927769 0.37200668398594349817 -0.33188721705187967936 -0.21610678078870432239 -0.31485943417187739479 -0.39162179629365062583 -0.32945067661316740359 -0.37898517593229230638 -0.031367185909329728388 -0.37853580597895314375;-0.18739476375028030208 -0.30984300957365984441 1.2107477744840022815 0.84183664057117102431 0.72709241178818473372 -0.11500181049645541442 0.36801906597674660659 -0.43020688777585236462 0.26700052897581827427 -1.1351778544129349502 0.39654382553269884593 0.074729084766495187941 -1.0044829660535168347 0.67255810581353636657 -0.80349565101901010422 -1.8270704171709786223 -0.49997793041836757766 1.0643462780717485305 -1.4737815611403435323 0.5520608288287256471;0.22595872892764559681 0.13249478693347352398 0.084967179429273009816 -0.66036195177265621936 0.55935973520331749853 -0.13333963707908957907 -0.18862994472306934823 -0.7852696388668657379 0.94639888320915133146 -0.56146609435539196475 0.79286667838998192703 0.094071721967093832606 -0.67472425072911978994 0.69129893109189810563 -0.064797214343707359996 -1.6583509545486312398 -0.64008479792068651015 0.037830512226443999135 0.019356974643730887053 0.68505747490089563545;1.6008924643212176786 0.35671632039452083607 0.27470663132604927759 -0.21309463989833948849 -0.90095043461653345762 0.19471225137270720129 0.17667745447856406105 0.0989033957711090983 -0.042713890407939221483 -1.6556249994927796365 -1.7459374777553577918 0.17032591111402486939 0.68657383895967516452 -0.27441978448597809104 0.50049119209949632925 0.2132848905246414184 -0.11156457368146041609 -0.20380095785170521117 1.4558927008408850678 -0.64492051351924628566;-0.25669565320893439342 -2.0979852394616309574 0.44108158164288030489 1.4114419520833343391 -0.88195551144000827737 -0.6179672996448944966 0.76419346653041297923 -0.95965012907853408652 -0.039929781332386234116 -2.5400373645312122051 0.59247674718583398512 0.31345608773794958468 -0.61976692570765745671 0.19177537829640461942 1.3760624826618035321 -2.3763258017953701184 -0.1706566147761047203 0.66419592907668967285 0.74842818914688680199 0.81418856161730501775;1.6137701406054567599 -1.206441554073358402 0.86851394222267230827 1.2200938366389524337 0.82026660838969545075 -0.49860060679517687054 -0.60394466118591150217 -0.37323218613468367444 0.29875938605026380879 1.4279616055656172424 0.76823060552569444326 -0.60327589589571606332 0.030813931435318658858 0.16551650696378975014 -0.18019656278229820301 1.0128774018533903689 0.65333574275619177296 0.21912784952513372771 -0.50799801795743682042 -0.80228093140517853232;-0.91399678842201625972 0.0247001159235879994 -0.20576939761069662493 -0.50047194745948431205 2.1636436039154856026 -0.35687249357638628489 -0.56592405647913346378 -1.0663876833292318391 1.6281201567427128207 -1.2356968458698442959 0.48040950235593282702 -0.44865215405303704443 -1.0160516016228142711 -0.063310715603038761334 -1.0234623414063139801 -1.6639827755052214453 -1.0529578171754856442 1.1066580407776607231 0.72283333320313924997 1.5132703862705012554;-0.1931205633188632087 0.8073374196539597758 0.82351830722973562438 -0.79334236649510714301 -0.1034687308433761832 -1.4598061815014342635 1.6720520739314674863 -0.15397806167889424578 -0.014761956772713486635 -0.68256519014506977783 -1.4897444090853051435 -0.23395433404907123309 0.64923748060621855327 -0.27821871065550368707 1.0667696667690844681 -1.0255749574858454842 -1.4005232205265856216 -0.13533858048978425481 -0.78497028481913155851 0.13138425374119178102;-0.17857937708706661528 0.39709305962750984786 -0.13814434573916828386 0.2457094285794333699 -0.87315469843333071154 0.085929553455540874651 0.27519675042371316565 -0.070523280214079692163 0.31650524332657098414 -1.268587846753741033 -0.49793727153383843254 0.28782012523598632381 0.77795728603687730462 0.51929203432667547791 -0.2349113701074553584 -0.041841549588271617632 -0.34922341518907362712 -0.40486740552384864467 0.50037735162865459859 0.52088955659675673093];

% Layer 3
b3 = -1.4163678466481126605;
LW3_2 = [-2.51141315303196766 2.7301241994336793439 2.3334873191187335273 -1.4308966219519778651 -1.2230806155479323483 4.0004262093432396696 1.3885926659772069858 -1.1446812793706997446 -2.8003879898884513899 -0.88494669616332855 -1.51697953687461351 -1.8421834036989790384 1.2447864222005877721 -1.549440290827520883 -1.6023039780624730444 0.35099905186610280694 1.2800664619427926105 0.76377695648664167827 -0.61789016180943545642 2.0933819536879303413];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
