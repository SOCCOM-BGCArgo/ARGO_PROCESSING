function [Y,Xf,Af] = ESPER_phosphate_6_Other_4(X,~,~)
%ESPER_PHOSPHATE_6_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:28.
% 
% [Y] = ESPER_phosphate_6_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.8296984325503953261;-1.3149306661587214506;-1.7065084751786554484;-2.7331025879608108475;0.48952196624938165703;4.7388800194947426903;1.1508161604275424228;1.3299708058707846448;-0.69663959098002325998;0.97552924294807175087;-0.35438742430604835976;-1.4138178144647362;-0.75683971224303292491;-0.94873089453466408205;-0.76291441978018836867;-0.0056592209167421686847;-0.13548656702749650727;0.16374487450811930911;2.5393543969626932721;0.091350771914340073154;-0.67003115635667964689;0.22879263543202510434;-0.73397235321959031218;-1.3642971625819175774;0.75216376106481808161;0.48728342522753104182;-4.6362478191295597441;0.76271867566855955367;1.0140049116273417429;-3.2817057039568946486];
IW1_1 = [0.66838003042737725856 -1.2441201341962466742 0.60189676523267521269 -1.4859602497471873228 1.5295190222627537135 1.2196271408614027809 0.67899756090609109105;0.66621599416023913331 -0.3772613787235521432 -0.37062021578478299144 0.80734269624104837426 0.45269048335471617772 -0.51808166531395938303 -0.22296935634154571582;1.0042472670410700353 0.40857001714336510512 0.15829803553279322981 -0.80469344770314021886 -0.11061618421933114287 0.32272175595274632531 -0.48618477280786881467;0.6750357834203734031 -1.0747988643188524094 0.85467198644544495334 -2.6986782763540357877 1.2244301323494026779 0.9666516874355237654 0.080565994772054991269;-0.50384753867508080827 0.22184313176858949657 -0.33992606666416669281 -0.24479121448053314802 0.17489182218796681112 -0.92485077236291413083 0.53486534114169903553;0.065723242210667109919 -0.0066663596352784775662 -2.508909502873842623 0.298491256770615776 0.28430718104180041639 -1.0190773178521759235 2.8222652616775545376;-1.8213995382814081037 -1.2740457965821760933 -0.31554735603783501396 0.6069282648064262542 0.63973818234333557076 1.2396559780735698642 -0.64142475946625687744;-1.4928163263222524737 0.036838277946208822233 2.1598761238170287591 -0.35616573030714726578 -3.761394310562131249 0.7304650666101808465 0.8374347604901797304;0.62320454511356648819 -0.96052027712504950419 -0.20454197040077340408 -0.92165556524537284311 -0.0069744354473584048437 -0.43663431794429186095 0.87747548109162321062;-1.2623068843084714885 0.2441979300248135476 1.4560576994736433853 -0.10589887172956850836 -1.893577453415752565 0.55898899256899836629 0.88610936404373230602;-1.6536632355850882092 0.0080769222645039624037 1.2023836969177843503 -0.65158039133408085508 1.3293494791544497868 1.6633376613353121343 -0.8957673555842395885;0.32451309703274988649 -0.086223829152691000566 2.8914848906779253568 -0.23896652088717068585 -1.0822939132649864735 -1.7479373002586808816 -0.4364812052721591118;-0.15147309526605090557 1.3575126571908437967 -2.9853070680340381138 0.50318663136408581238 0.089585024061174939325 -3.7928991320310774249 -2.0382225096844681644;-1.146622049743799332 1.4750987128256207725 -2.8711313138974445813 -0.13818433150388334529 5.3169980728630834577 -3.0167407993175272551 -0.49701238662970242954;1.1226505630475693831 0.0029550109888472984171 2.2289603000993456483 0.062212483393345084648 -1.3956025942425498432 -2.2794906298409705059 -1.4243443798096373509;-0.12636616264626351902 0.59606158206122861198 -0.23018108808555706735 -0.0045485007133542485272 -1.1326293803992353304 0.85476555026679090776 0.75583366820903097327;-1.1513736055843120099 1.3371759534144334047 0.31747804563686438106 -1.667337422836152383 1.4223752336834665222 -0.46384870401105676718 1.716553965630552625;-0.060639518494520788794 -0.17908943751550829293 0.46716791911410365801 0.89820949071344757808 4.3058147898958569755 -1.6824716159676700311 0.58341801388398739636;1.734459741207726502 1.6390694251766579903 2.9158536859158918908 -0.077568458960186256745 -2.2280857268734739485 -0.39273644824251979779 0.82058638395477012661;-0.37127303506153652712 0.77339893758526756518 2.2365351468293890314 -0.051191148323335530779 -2.4897571900414834367 0.36240883012077590442 0.8458317440598255299;-0.18556911406016510235 0.99926268256001149481 -1.6534177316089015974 0.15903774142413698578 -2.0764578139398595091 -1.5226428723028369028 -0.93174503348055204288;1.4131591444589894913 -0.068921489534393198806 -0.74942855988040024684 0.36815698131917878877 -1.4256871570232638735 -2.4007480375018666052 -0.12046509583599640525;0.099353561833462888941 -0.57260082803077028135 0.72903120440188784457 -0.056873280758716684979 0.98055406551548596195 -0.73505192673210506538 1.4186628987231568733;0.021928707635210566845 1.2037970216385271982 0.72472291876242844744 -0.28138787138804477461 -0.44690335403771397349 -0.7825613745551662781 -0.21026299942542381327;0.28258807719917250489 -0.28088184409085498183 1.4404194786617767754 -0.31114314931955711074 -0.71141890222323378445 0.045984003007462623258 0.90194225835582353401;-0.3154267288881462683 0.21811416720791354518 -1.3544098616131594603 1.1640103303096238641 -2.5895402746692601781 -1.2815547694192201966 0.34155800336854502675;-0.7823842520140765755 -0.52247092980356135694 6.6082721325974285165 -1.6279434090521736067 -0.010996273218802105759 -1.625526157752976486 -2.6657926761905623714;1.3155780544857020864 -1.0845143713390292817 -1.2608626054449620923 -0.38332454800523230176 -1.0426391005276622881 -0.048821469512376952649 0.30664464103092631264;0.5503028017381347281 0.080762420615445515426 0.59376594013976280451 -0.31735935123289693571 -0.16309039151051099581 -1.2141198586915982194 -0.22997128663208216137;-0.54379437965335819527 0.97923865859006475887 -1.3474806209152756509 -0.34506572428981135969 -0.8875671486309708591 -2.1936995477722049941 -1.2855331614701823728];

% Layer 2
b2 = [2.6346821410041081357;3.9425091572323061051;-1.5161174069125558095;0.91267298847763178582;-1.1574076067029790416;1.472334474343216737;2.1061800428139516583;1.1544529777569332296;2.0016519916985373584;-1.5208700445542879809];
LW2_1 = [-2.3670978985281321272 -0.56956220325060213927 3.1876357187868635812 4.3671385507662785486 3.8871436867056501363 1.4771713603249454483 0.74240189733767969482 -1.5590906349268485176 0.56871916179266335245 0.33624083607188098854 0.97579323039260412731 -2.7836706003405002896 -0.45325035418949066734 0.63624449185464138079 -1.9063456928791768785 -4.0986631528597019525 -1.8316058692146395259 0.90004201896526903059 0.84213792065105952389 2.4629798504108957324 1.2357757258791104427 -0.53967589364825818699 0.83220491497475401754 2.7777014479172379424 2.6433315662752332464 -0.72806494600073679013 -0.15016261015821283364 -0.0038315800135663991011 -6.6417935616375238794 3.01121478231511297;1.5095187641017429048 -2.4522703295582966021 0.13670380855988703561 -3.1751504225496938183 -1.8020806123264809795 -1.7952479760799919806 -1.4329876246778625593 -1.6310157841831409709 -2.1910910854773053558 1.064190139687117842 -1.9650681591176042406 2.6706524709268082418 2.4035383526854996461 0.67239157843948060833 -1.5253347229797344919 0.88294791695256924502 -1.4202143929398094446 -2.7664373983531778123 0.006692117027178994329 -1.9113969683999652016 0.98217625898126925676 -2.2026110788887134362 3.6384874017153885362 -3.9474591411928918738 1.7535642372612734174 -1.6629102737653518318 0.9545931974302643841 -0.21302288293983479006 2.4258909812549802609 0.10672691439396536639;-0.10266784112431259768 -1.5461704402122204982 -1.470694160850074983 -0.36382102673105876089 0.30122832013765649117 -0.29862070097615600606 0.93262976568451216863 0.12128496215277245751 0.011877869543357868348 -1.5242625783537584461 -0.22245334295099530864 0.39239395845854507794 -0.20339741385486670433 0.80667909898582412787 0.59648526317968675325 0.88593273517869097766 0.30246888895929829877 -1.8598224705744257346 0.67053100747777094615 1.2997614927832603637 -0.13046399676143205504 1.0416592215352324935 1.192968154685336124 -1.0475806036870993765 -0.93838202282384119979 -0.34331441520631150732 0.22131446722613154487 0.75164089881323992159 -0.67037366116780927605 -0.21453974912973794442;-0.091442130004056168535 0.60349973640659937413 -3.0325727474601005262 1.3796123647369669118 -3.2802528388879572674 -0.74002171733833688183 0.63267936785378886544 -0.80314478339012673747 0.13158446670178092219 0.56166668148822873619 -1.0761130815737576238 1.0533269533281062191 0.39581475957772305208 0.17778069047954056514 0.65047975581066996842 1.175683684651088079 0.85099923959929291151 -0.93072059071572232902 0.39636569716319675072 -0.68094438127577061604 0.12997446457122299734 -1.8155748987842987852 -0.23323458640171962353 -0.35842768872186930862 -0.76141590335873765572 -1.558217789277648313 0.47015385140724602619 0.45556335997641134172 5.3465276396383893953 -0.11635748028281257815;0.026502012219666842147 1.1146241266201697417 -0.6419937941827225103 0.28701602056173336486 -1.0378627835623361886 0.75485762431214975532 0.42299223264271956779 -0.23238985334963696561 -0.23170716128829238478 0.63827262363979830884 0.46275187615934987306 -0.92417907621868311541 0.26072255454502940575 0.30499744817831375698 0.082521315103642758904 0.40131361573270818432 0.084854877813989121327 0.80008594149743317292 0.38784223052783317609 -0.1189292304825554647 -0.21498420940554041625 0.95592515516769438477 -0.2512975562248604966 0.099502346531604737856 0.66394810705708773302 -0.24317441352202359695 -0.068230569861267589826 -0.055430674695230865157 0.94083620566177283973 0.25945081848072665265;0.70961504825843990663 0.68268095440935150364 0.090483291291443945781 -0.082373228645213403265 0.3583160751917374709 -1.0182679109683432372 0.15479101980639309311 1.0181215341456688606 -0.23640062595660793487 -0.89212864539272151987 -0.16137928185351349541 0.1526334710500854841 -0.44979110020939949699 0.050519963123524774806 -0.21658033939974200011 -0.43370604015488090077 -0.1534038892698610379 0.12496765705142458269 -0.12072195961709090983 -0.23237315614792286578 1.4454140619970463622 0.12061652594927002591 0.81057027345798249307 -0.50521539687024230592 -0.42299042101337575028 -0.50533979078375068639 -0.55035519113280295667 0.27235725733743448851 0.030712303762239802352 -0.34991201748063127663;0.40880500594902319245 0.41446584986402379425 -0.90944430805245379812 0.037583439039044312657 -0.76377404047291375111 -0.14139325927225626645 0.5499100055526043862 -0.33744498140593387481 -1.0065717318612237285 -0.51253389672210913908 0.24823436120450423359 0.95457310411274842732 -0.20003183220645570639 0.21629600763532055852 -0.45659844177759167927 1.1142183453903184986 0.79414970966893827509 1.1541523900713355211 0.70034534456752051135 -0.94537628273426044245 0.80741833830334841515 0.68445931159062345372 -0.09581818123482563343 -0.8602924559402373994 -2.3844821532211857296 -1.1510727942836767035 -0.23870739632743254166 0.83605220207871366878 2.5479449559935902769 0.62908203919904182033;-1.1221475145261932127 -1.0993063330552630408 0.62849202855178754046 0.23073129743753617582 -0.62616032760484285902 0.14076612573459121314 -0.1687935362680657303 -0.068248419991824293973 -0.05654264219649488693 -0.21814057018364113594 -0.031417664314658907965 -0.40810142392699783054 0.0407696247181019919 -0.22897561321284731761 -0.17457195945304518347 -1.3850621678330812259 -0.1713442474890909395 -0.42431403306806608766 -0.064150866809575796124 0.44864299346802205548 -0.29336070583799384037 0.044986641391854223504 0.060219507315462647568 0.71819209939400086018 -0.37851351987170717139 0.43314077092181563211 -0.072887919932155237346 -0.23963069296094857696 -1.6631409001116463919 -0.21676688660406601139;1.3697619292872029728 -3.8180872849773161981 0.18152597951817345256 -3.1233059647062004771 -2.0442067589738033284 -1.1307709322905641347 -1.7027212813281820125 -2.0744981610226114199 -1.7420680228509342058 1.8714678489134739525 -2.3238435206429226554 2.2925289547504736909 2.0298534284944445005 0.63375058502206893518 -1.2816109368235364396 0.10599826040175898412 -1.6750287644775987417 -2.8170198401099715291 0.057225181762056792634 -1.7117198968246316593 1.8191346307989213482 -2.6268527726000332478 3.7355801973671027838 -3.996636036787432289 1.8257089602123521832 -1.6653359921329689008 0.83034125611270770406 -0.5245540498754495129 1.7916813680308227852 -0.51215323073184038094;-0.49239969166436137193 -1.5978010051719198081 -0.45498913146314767797 0.058989289930241418924 -0.29271766611818050841 -0.44609047376374749705 -0.054086421446337767938 -0.16947400089743727691 0.19227814935125892015 -0.27365994273953103688 -0.13377097992676456606 0.61324095712685999793 -0.0133609607203725618 0.0089027225878332803821 0.24255441778083539073 0.17210378328096651024 0.1255635635092650082 -0.80739828221025533583 -0.072199050003240880513 0.32919976157088143287 -0.16499574404984726494 -0.31969576090246776268 0.073338017517523446109 -0.1877729095820893368 -0.64035650355117679222 -0.009274207099894465553 0.15670008262051363102 0.052422442432125945788 0.20938072696968082487 0.058733373335879232591];

% Layer 3
b3 = 0.37074693955458026817;
LW3_2 = [-0.14211233050410421175 4.6080053957900961592 0.12958539957808876131 -0.28493456616882906207 -0.36755027364253267663 -0.34703325204792317971 -0.490934650879025547 -0.67467786684737429681 -4.7433184637351608615 -0.89801703189654835668];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
