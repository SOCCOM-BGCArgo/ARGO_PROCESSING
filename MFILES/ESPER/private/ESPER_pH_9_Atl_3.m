function [Y,Xf,Af] = ESPER_pH_9_Atl_3(X,~,~)
%ESPER_PH_9_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_9_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-101.945317545701;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0054210015363163;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2558573320222672365;1.9953281520027108531;-2.1844404741345235799;1.3006077906065385275;-1.9071573605852754074;1.6345427095857758548;-1.2339474061405133476;-1.1634776072633192801;-0.69013404129225242034;-0.67356212939213089275;-0.44114566181436970504;-0.064589880357910134379;-0.18499581229675482463;0.64809752197756498315;0.41110430329978697728;0.073180980203204293311;-0.48199074865009966517;0.85994672263804383672;0.97056468880475166294;-1.2482275286741180143;-2.47123045807947328;-1.8034292636371818119;2.5694122069428093624;1.7406799599051059335;1.8203636028903240618];
IW1_1 = [-0.36641493439801792187 0.90043173038034651778 -2.1513084644038542592 -0.72132317313113480939 -1.0026529067281606533 0.76877963504995361355 0.4274115512273328199 0.51118849410299638247;-1.3142757367867745621 1.339292732223161142 -0.93656883615188424308 0.45836513590486444025 0.54693650930932535825 -1.4206984181464374917 1.6263070752397730256 -0.086869501050190117697;-0.15019763976765024283 1.8044190199970384647 0.94589618473326975145 -0.34636587742872021467 -0.39297636977604544217 1.2373417761851652763 1.583408332811936603 -0.76090541612933915161;-1.3478524580816859668 0.82949809995546297525 -0.54320012571847209326 -0.45351850467291870972 -0.79958250093306659778 -0.15556674456345631619 -0.55643729967733990271 -1.1319906301657312042;0.79304590045491363259 0.95790877571420973702 -0.97458270428118409789 0.73103747851607137065 0.10615034790061694814 0.09139808312044390981 -0.8480326249334300126 -0.081674602614863506256;-0.29965518882723302108 0.52472777963075012408 1.0966796750886076417 -0.50737320998943014061 -2.4713395376453148877 0.80844094096905350089 -0.72153173306019735556 0.26947795582042810558;0.43035719820807649683 -0.99189604479689197358 -0.27233815220832141568 -0.97646175757100117654 0.20406055440559545122 0.39732993774201746939 -1.1971252443606308358 0.71841223181378399687;-0.0083989968627080462127 0.25719816982399640315 -0.68249543602926199259 -0.99688577414351076111 -0.44248497099968508994 0.53494525066151632497 0.58137402880572186525 -0.11769721084010334455;0.66996862245940691505 0.57045659343812404884 0.94170177055860293525 -0.65422280583454195391 -0.8620028675992399414 -1.1422525241876260171 1.0598130325681807129 0.019504443261719166952;0.8059621122563939144 0.039143406852055022405 -0.069392062624862624332 0.57016965190010715503 -0.65631804688343187149 -1.5834834810702125285 -0.53397516706525050001 0.86196295313717696818;-0.48140418721921557355 1.1620440764114754462 1.9111117768252106064 -0.81062012442619257868 1.4306610941719195562 0.0023025067002363647228 0.31623403838685543166 1.0583242473619816071;0.87967272452281175532 -0.52703932602782876948 0.98243983206777629746 -0.073885747492919595647 -1.9326961707968071114 -0.86322556103709557895 0.23669322859874272758 0.56443251788399839697;0.80705578374351272242 -1.1657395355608197729 -0.95492937267624555808 -0.32594402850412396155 -0.62015018956413825446 1.0736644716402687916 -0.48657558387218485807 -0.80132461475952965202;0.36314310929302057174 0.20049541973134127337 0.090663907997557580121 -0.26212961936136358609 0.6494060541176783774 1.951073941867534467 0.42153081440950701531 -0.57080286350954956287;1.4611988145239431791 -1.2268681708331459213 -0.28441146776429659937 1.474757589407108993 0.82717027710500712345 0.31757934939136439612 0.95947891568569432241 0.27604797261216890147;0.33716231869310936409 -0.94099498851832974466 -0.24616331260717469465 1.914586151996714003 0.59047235587623536635 0.41614466527503962689 1.5509762778693285679 -1.8527156975001124461;-0.087846488470925604419 0.97266897605689905948 -0.58086561061961405894 -0.073367906027388893331 -1.1108346078536024404 0.91492330656548248591 -1.6159016766533900178 -1.7085778118754755273;0.17188745274454392264 -0.38421207592098977068 -1.9393094541769149153 0.44048638004562484793 0.51871165606471636433 0.20459703872033610517 -0.40126521355497019039 -1.4116066342337145745;0.76688453422293767492 0.45996676934992897223 -2.9118616842582452087 0.13604906181271353427 0.82812088102429881609 1.426591857639444294 -0.25487424913868012011 -2.1376297601123854797;-0.75167841631503751199 1.0925391797945995798 -0.64014201204626897113 -0.44488989392917127619 1.5415004970958079422 0.65230328915045820981 0.50649013692665978414 -0.061380252154060205294;-0.60740009446875597998 -0.701610557389505618 -0.87839363034967421484 0.40080501786309941092 -1.2003887741140881751 -1.2411281605745783096 -1.5259113894386902022 -0.40534027878902628705;-0.41569151316001623497 -0.14162232873375296682 -0.93027494789419729049 -0.21549921377637468178 1.001330267263678131 0.26570135196015137735 0.68203091624682765648 0.60959420627644933521;-0.041248510824532444441 -0.59627206682398536941 -0.19576968466493685495 1.3306254989113746046 0.96542037684642756368 0.12903981037901618434 0.23448367352578516898 0.81395250948228414778;0.60390422575811697481 0.2334903189948175084 -0.15877526481863846186 -0.56995547091780340843 0.21411580463379353834 -0.78517587028140067851 -0.15018335069083102451 2.0004254917084769438;0.96299833324531647349 0.88122287923233155738 -1.2669581257505726501 -0.24358958090201007773 1.1426251076487259351 -0.10351690929963036636 -0.87416958553824808398 -0.22731779254896031239];

% Layer 2
b2 = [-1.6103139908148629278;-1.3904067156018009577;0.76041031845903084285;0.8551307562620574787;0.89098652351763973911;-0.35594161175908101136;-0.11907101207936518494;0.046875920096936848913;-0.34540002959857335485;0.33510852875352697966;-0.57116174181778611718;0.90288429695366345662;-1.1747134202261257929;-1.6163508875588490366;-1.5696207310836354232];
LW2_1 = [0.17023404554852161752 0.36359796080841694232 -0.24701272294862153256 -0.35757912694963150946 0.35160430780534013273 -0.24036039529764371969 0.47733527076182852289 0.37802420922553070515 0.16110507284789368776 -0.2616665747846482204 0.016069530277943167018 0.36370921671213563009 -0.43974887084211172761 0.028490073878691672682 -0.23191672902841073411 -0.4227886904206726304 0.036497579323470287493 0.34401337711989060653 -0.078015321785004990152 0.52373307466807106358 0.41978482040413811482 0.011424415476248877405 -0.39324515078829219705 0.1998743613892134674 -0.23343751681278349097;0.43054869728956918218 0.3800535839499790125 0.10979911245302963196 0.1774419886682633285 -0.39726441703355241941 -1.0808053936340584755 -0.069625098557177356184 0.03968727071994786193 0.15483180902694723691 -0.27797650816408769892 0.38114592636430927319 0.53241700212533593639 -0.30572177849270648631 -0.28330212250232605919 0.66711458792821587416 -1.1220987929016623674 -1.037616367010984364 -0.54906158786743342048 -1.0170761838614632566 -1.0845391844264424819 -0.63091574259807747804 -0.067693514577396682319 -0.38324936807592613341 -0.38777891601067016047 0.18215929559126847748;-0.48924941197357441069 -0.31094969372453057366 0.81609207541788220119 0.25635105192262330753 0.036859722208536241372 0.17515464230330937689 -0.58563627133287299298 0.081583227611822739522 0.34867329417103398725 0.55021065640107214012 -0.58379522587694221425 -0.89970487807988841489 -0.057236353861254279929 0.49889939510492420371 0.12127089720077842416 -0.58623097937032975224 0.18448678025122133839 0.17748913818884937132 -0.22325690829075370281 -0.47205511372867253739 -0.53481058656487245884 -0.011501737816032767125 0.13020602684880719369 0.077154642424382052779 -0.47945613313395163413;-0.18643229474436892601 0.50665553374373595297 -0.36530147110865046622 0.087813962199010678344 -0.3360979910513934299 0.28573509152044734849 -0.27859059370985228554 -0.38067125263371842658 0.31586389850648144417 0.077833310664124882861 0.45806096151939351691 -0.24458851768170672414 -0.17464553568291318886 0.47153087870054449793 -0.40588345805322600945 -0.52862458306745252479 0.048351996920887797826 0.21824177285529228199 0.30352564175871438179 -0.29791731491000361665 0.28098484411600299637 -0.17886076608700232637 0.32645431162364613176 0.36458882962639183045 -0.076271236750442478192;0.23877118513951839374 0.88236113867673904299 0.39010801574877451703 0.24973176951539224899 0.20487901308864508998 0.49034389536225125861 0.3163611683385522122 -0.25564176651184289391 0.11402726026924518699 0.43176884870966775187 -0.43049713071877004911 1.1822378883382296255 0.58131114241909231932 0.76270261696546703956 0.098503459699183698595 -0.069325839750256759708 0.6401502394067538626 0.85795819551676377746 0.81534773823870343445 0.33412206785347703386 -0.42498781925151501992 -0.63819117793019819462 0.20488999878828767498 -0.59731280881888859646 -0.06017837067656399419;0.12359653765186320862 -0.46043965235801614932 0.47103005599078406895 -0.022924119053319900324 0.079795158067495874921 0.82353112665439742734 -0.36340987987827605421 -0.053997865123385530017 -0.52888748410091146468 -0.3086527678962570076 -0.43972528001523530916 0.12279766832891456096 -0.74564262582508633592 0.59277977217209898431 -0.12512369570818188125 0.40640567781570352546 0.2916047477556673595 0.23139291217101401466 -0.076796036877304199586 -0.37236790789635382248 0.081193540632225502662 0.00015660599855273310381 -0.050306506171595537225 0.15454586919953056112 -0.21755028496273740024;-0.37771017132145523476 -0.71044159601897394207 0.093843965000961468426 0.31759250849694564689 -0.066267673527599116334 -0.67500549526658171207 -0.89923234337499269309 0.21762493394634430111 -0.46242591938587712663 0.050840376370321058164 0.31162955724954766179 -0.215851811816727579 -0.037576902325710176411 -0.16340468811077932254 0.29885606705469675015 0.067777241832729276383 -0.053926238234104952041 -0.1529683884106869951 -0.4869172355673708763 -0.18329317615015100484 0.035781840365246966873 0.59793409727962354427 0.59447060101017856759 0.36079995585973767547 -0.3240505248219021639;-0.11045310923814911919 0.29312875465887694437 0.1635948429232029766 0.2500115777163435804 0.43640155634410415786 -0.0069790209985529988099 -0.48015769696998505944 0.11962975222540203624 -0.025459914271283152348 0.83308950839983564318 0.43194627000141527784 0.22638918109381378496 0.6948497852044154266 0.50725256906543203517 0.5812736781388290197 -0.36801487483880440665 -0.032697797436530708082 1.2873799614332495089 -0.86668799535066909367 -0.13498202738330566941 -0.034279909423066377838 0.060657785496782509749 -0.8546745318126169888 0.3111066323155161073 -0.01014641250473380385;-0.39871337606336926251 0.48621171706595150974 0.19201336194989523931 0.55819693816951376775 -0.20179268503206776453 -0.81853809364881735533 0.036921285214286225784 0.58819933949530034401 0.75164521913333337544 0.17068370030800036896 0.66689756453373938427 0.42989001210267524522 0.71564866317769282311 0.25821202140921534207 -0.35485501212068759624 -0.099233125560219223593 0.10287285204828797158 -0.41221994690230767677 0.21096558652297589531 0.1404060466923421624 0.74584924766840943189 -0.11338438859709712436 0.09968335347533510693 -0.34060650167333622607 -0.027032780903288679275;1.300798075159585121 0.59486124428168196676 -0.65645934396767913199 -0.21937026706361878459 0.20132233421790493577 0.51497433894302491186 0.44760575549770970083 0.10104488164638827929 0.028957295306423085773 -0.71189596827060919182 0.046562298145468986044 0.1013664324307458342 -0.33922595401377431124 -0.88505326089473801421 -0.32526028320161393115 0.12552344609437088296 -0.28859670738494580533 0.38730180565652927438 -0.48472145841425057222 0.35016579345394771572 0.91173365047365251268 0.13547583972771373717 0.14347398300083016864 -0.087492705432442891 -0.37417018920571570861;-0.59731736998402473748 -0.35420711620409073284 0.26100177417962483473 0.30120429617203703376 -0.52357504590561176894 -0.14706127537897259461 -0.70348033823596878289 -0.38405014775501999935 -0.11499213619608560089 -0.22508231786367755012 -0.37154002935802254992 -0.1412161041828743635 -0.28344970206666153523 0.046575645351872849154 0.28321294221857618023 -0.24607160502788077983 -0.15876227523390232244 -0.5506547837297873782 0.25522249622609755049 0.15808107393209702707 0.035700752985094300063 0.27822173768214325529 -0.62876636819294162706 0.36805616407807473234 0.30115147285144266975;-0.10331887336945395905 -0.25334751810039901621 0.55026407881051420112 0.16174607942075186484 0.034561000048891524217 -0.40261568011037002224 0.22443735175356682721 0.32343118632975925708 0.4671120685860404298 -0.81596073998136620098 0.0063955212682071131344 -0.39420483165122027769 0.19644101017802545472 -0.869063250309136337 -0.246900797777812403 -0.1084540634111807178 -0.13121264034612215021 0.15925401612577200217 -0.33376213212341276915 -0.37035188236108390614 0.29226436226912311245 -0.08746632736425641319 0.60800818757704944151 -0.0035335518079181501422 0.051741208914787228945;-0.022239404501818719334 -0.013005332584451521558 0.37176536793571079986 0.33305722516939478828 0.15115233379665038438 -0.9878875989986378725 -0.11199280278344268813 -0.30173653736889083365 0.43452137900023146688 0.044537832629071870405 0.6204668188905557713 0.33441180961591260301 -0.39084096239922488936 0.49987119524171491625 -0.31404882115678101062 -0.29650102193529453976 -0.92647903291812039317 0.42515112353313599947 -0.10452358530841120154 -1.1260287771162154069 0.10691223165185925748 0.25476972001582265381 -0.80037429720366826125 0.26515447520718909979 -0.67386713117662055961;-0.16446263464242605323 0.37373730099472091126 0.2711646453763272846 -0.12508139859063477362 0.21153690852506068509 1.1050528426291872375 0.023260230633499405506 0.030531842523299601577 0.18910938197040480513 -0.40865858096571011648 -0.32340265681290369937 0.58196904783978142817 -0.18002258329749395993 0.31896647232604535827 0.43134565151895165602 0.18427294241918307227 -0.15191380293033762694 -1.0690116210309077438 0.89906176881474442197 -0.2543465797871266032 -0.60430908667701888071 -0.082155653305355513805 0.16540797199595599909 0.24085933067008655217 0.69434995474449012764;-0.18052060629520585988 -0.25003344985434139414 -0.26625419023494639736 0.23193828390069293199 -0.16327954587754103799 0.22732221372205341225 -0.59097338678653577038 -0.38959900242635214784 0.2841420430014152676 0.083725244017147967823 -0.79263735183616779167 -0.28280410507585862501 -0.33635262867846571488 -0.12436050834633602391 0.025419195715913896205 -0.33597312275132262815 1.3191373139429425354 0.020293247148456126233 -0.41001114135657840132 0.56711479908098105795 0.88953995564115762029 0.39681808109233840387 0.19389842193876755116 -1.0626403692247154975 0.18393507485114440891];

% Layer 3
b3 = -0.47907871286829734059;
LW3_2 = [-0.0099037536512547649087 -0.63599462844869047995 -1.3695167028782986307 -0.24078779001990005537 -0.88010561082458882431 0.99899458278434072334 -1.529352482557003956 1.4576202477380730826 -1.3708212722158137353 -0.37749400821844053544 1.6851138442859805444 0.68626293138896421464 1.0546774060733452583 -0.97313266999495229292 -1.3973426373093078556];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
