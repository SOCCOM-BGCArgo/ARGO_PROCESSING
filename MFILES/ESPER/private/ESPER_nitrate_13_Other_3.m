function [Y,Xf,Af] = ESPER_nitrate_13_Other_3(X,~,~)
%ESPER_NITRATE_13_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:36.
% 
% [Y] = ESPER_nitrate_13_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-0.04979;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.568038194888224;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4199895672900697541;-0.89408093902606211589;6.187312593162213048;-5.6104328113073478335;2.7659297246803813408;-9.0334321868145188716;0.60967672051177568271;-1.6645369228414599316;1.723353952086803309;-0.77461721224626678417;-0.94724207080631817046;0.68429728901550912479;0.78009308838621393978;1.6849985555696787021;0.37834812245867721625;0.02960409536324808133;1.1355941816603492001;-0.98250742626390052958;1.3429730148393348443;-2.0042485074250957489;1.9631929592512520344;1.2681500476799718591;-1.0502087450345665154;1.6628327555928783532;0.73511260827543201124];
IW1_1 = [-0.068922890654935800581 0.6145989170398150625 -0.78731429953677056766 2.5158844533952935407 -0.47088309466087779898 -1.2250273073113484568 0.16837281976428089547;-0.54085242659724064307 -0.015701509709588980235 -1.1315458608799076057 0.096926837343464036789 1.7199899626452048729 -0.59784902141432272327 1.0585531583939382649;-0.32095545701367078628 -0.35140889118722223872 -3.10984461002037893 5.5222245771103919409 -0.44715210787865733444 2.4984115799943213965 -0.88595705141501868152;0.35910345702583434946 0.58900862003085063812 -1.2501134191770777448 -2.5968570014192793316 -1.1896213199379910286 -2.3902717718100623401 -1.9556082341191385332;0.14086711491068029667 1.2297484465209276294 4.1122208991804791722 2.1078566192370131738 0.5191538217225155627 -0.37711364634392646744 0.91129753816506031683;-0.29659913320670011627 -0.58697260038427834239 1.1812317369170985959 -8.0410747579352843672 -6.5840326806542179838 -3.6052581354349686471 3.7719404583863425096;-0.17676865305763997394 -0.11868537944105976567 1.7239825291155275178 -0.19370972987955875633 0.75211640649073541187 -0.88362711603068577748 -0.1540256011332826469;-0.87609587443229142156 1.2194482281376024524 -0.9677104195489268923 -0.84843525500038452503 -1.3857740521974899472 -0.70001388237733208619 3.3557546312336707928;0.086792162146915818877 1.8526570746009995982 -2.9991988897739934039 -0.21647670957915382539 1.2667762260573156574 1.248130340736465671 -0.19248115398879905857;0.51653665421952688064 -0.23696848606265374926 0.44113062614767861724 -2.4993163650877825432 4.0930608256225733399 -0.78020118964282769713 -1.1495756869394788691;-0.007977980903964437126 -0.25459490186373956444 -0.48494772247978884527 -1.0098914095285755899 1.8378504625231513181 -0.76630664054916997063 -0.49241447445366293145;-0.5572473000704661894 -0.013682517572423754174 0.5111963652955195947 0.52627459605770998685 2.0612938965370641853 0.31960815583790469496 0.41407997336070273553;0.35390370672987542244 0.16628660938331954466 2.5807911802108756127 2.0094499468468840497 -5.0711854281978503423 -0.95389878928366034216 0.4461984441603653595;-0.13205737303675302297 0.19111465680835704184 -0.94800013357286005977 2.3220499365632290001 2.0257343271098418036 0.24009284537478184363 -0.30200471682480506397;0.34302837515228251641 0.25375995171293369568 -1.1623465981266898339 0.13090460446890514468 0.99431190591013562941 0.874721233425659217 -0.77056504153036387006;0.31875259768440861174 0.14720757562912564764 0.95363236711296572867 -0.83884720866239270709 2.2437860022557893913 -0.92425194710206570736 -0.31557660696923600652;0.17095317565146625483 -0.43008055388162197419 -3.5573488856280794934 -0.39223802731948909095 -3.0495542432159061796 -1.4166952444824409962 -1.0098939084015361445;0.24233876400738887935 0.41295932298721188536 1.6187196254402613782 -1.2451917319925664973 -2.33906306412959486 -0.66337078946189975692 0.28478004794147648848;0.05200823654814899083 -0.36756436493805311194 -0.10243955722869285685 -0.13886154552585763811 2.665371625307138892 0.68311070754126457238 -0.41836933680060300889;-2.1648793037293092567 -1.2418484892212036108 -0.51331459474205398674 -0.098820672160186875943 -0.59599055571147152577 -0.8462932386970329901 1.4603790500103708272;-0.062594743341263317515 0.51067406395263281738 0.10944500918717435523 1.6443724134964636807 1.8103984715666239236 -1.0808990898580632667 0.71888066929404870198;0.41934535635304226453 0.090965711544507457664 -2.2605356166645984572 -0.23824048147254722751 -3.9602398263320872651 -1.8180537763178665767 0.8446538400955816428;-0.46289983580608273783 0.028117983017711494637 -1.1018558149556982872 0.36826531080153140918 1.9714979570998332203 0.51988877494959617742 -0.25124410132012614527;1.6344310582345829008 0.17574442446632865256 1.6214933327298683974 -0.78157168886757566462 0.45440335170798157316 -0.73157786433483740218 2.1605266321567548893;0.21772912586707648952 -0.62927788594031863756 0.36167109252950574438 -0.45291136065664638899 2.1262618826436407993 0.45436982607484172059 -0.87635439909228185495];

% Layer 2
b2 = [-1.1943438124929823818;-1.3016736361504919195;-3.1250074165333816545;-5.2399274973184573057;-3.4459303322918568568;-2.3958942086421246564;-0.49093725887687478249;0.3550645838050091041;-1.5144174262600713643;2.9887948665343828658;0.63770607209595708831;-1.663079596706763974;-0.82755677971870889031;-8.3154117170042844975;-1.0814561156263626795];
LW2_1 = [0.55824164895000283337 0.16433638532162320178 -0.20715898057749435046 -0.58925223849764452044 0.25526355459937905001 -0.66644297114257666781 -0.79134836254506324416 -0.062600688815514740626 -0.18123543794175017707 -0.54261514731694837632 0.68990317813396895286 -0.82594751545086897426 -0.17238778413289776448 -0.11598607072171393528 -1.6870190599541723397 0.055828818723390183365 -0.18452080796296474463 -0.12216324175613571534 0.49320480145382034065 -0.22062436018583000963 -0.30756745640545313236 0.025385528398909944225 -0.92794161564783317342 -0.45651681234195606862 0.25995766751699500574;-0.063167506026316586065 -1.520884864383666546 -0.3674917210402761647 -0.10983115083312874893 0.08250945048078242583 -0.24476197760688375715 0.20534360147823971232 0.10275736300329341155 0.18207335802414578718 0.59443194382380282192 -0.0037145170173598588553 0.20288063649557377954 -0.057723344103146882744 0.025474674522215828842 -1.6614289457060815725 -0.91963442543181161959 0.072964520674790742105 -0.11393577463162359031 0.39383272935717050789 0.15321836960578008591 1.0182738593388682702 0.69506812628271608112 0.64700023746627755017 0.24246172194388965204 0.17658621247519748487;0.36700520077023068843 0.90757396463828166056 -0.037819824557451024727 -0.088798658795448653924 0.36284799874742645898 0.0086903543333063659748 1.1224529085252374916 -0.11067070092743362675 0.19938185382085821251 0.80596176960644483334 -0.71141226447601058069 0.044321963008754398927 -0.60675614252593457199 -0.25933545840251315262 0.62912403753587586852 -1.871231724804899299 0.24854140742637695349 0.85671406987553544443 0.4172269762918018321 -0.047765953126173002485 0.10960301736602598432 -0.083799868390016837849 -1.7783554447244613872 0.038898677628249042626 0.21189845176943603033;-0.043821367526084141486 0.79562452112337134214 0.76477937011443331006 0.98222990597278470037 0.45049369732019600709 0.48121454433555127528 -1.2437662113955485488 0.38484148776299220707 0.54406781698577433293 0.39916388862432872209 0.42441321728065184438 2.2038871529652621639 2.0273539750461861964 -2.6332312532122124082 -5.2282389067504625446e-05 2.7267417961082016653 -0.17144222571156839119 -3.4401609777978880977 2.1102764488766245776 0.52441443363982898074 -2.3216634831989972909 0.33549519478090872315 -5.7114805418226044509 -1.2382600415416533668 -3.5583723023784084027;-0.76498754145990710551 -2.5728538016437689784 -0.24871422382547558882 -0.12816741384946916948 -0.9801117975911682878 -0.35091029650542865381 1.2140350807937199118 0.74625116931336443749 -0.02851135650217146919 -1.0424908819446652153 1.3998568874897527881 -0.19059182462094870214 -0.49780465540750945541 0.69543420826614199548 -0.054798927033377811679 3.9225288135331890516 -0.83340114234781792479 0.90883538810312525236 0.24047490787480937935 1.42565825043488692 -0.73228284164653945076 0.40451748759912947717 0.27087568183563659474 0.77310316277098500848 -0.84076347659812711299;0.20276198635678988058 1.153037941124999799 -0.058228303080650051227 -0.020644589621235796828 0.26398674437878921761 0.0047642306274858900114 0.9061645060401750662 -0.097280868335544432024 -0.14426438711359743094 0.70685686890329157972 -0.66913141406955300994 0.17694396273117488083 -0.43166303537897926512 -0.30010578193137416037 1.04625152288862866 -1.6726308169045864815 0.28116372424224217452 0.83925739229552998033 0.26826715933053707497 -0.023137714081127330745 0.52816854094163012689 -0.38111360404750782571 -1.9841017297073157977 -0.06877169461703325215 0.17342895239684349984;-0.84880067418418403413 1.0701855913107825025 1.0020651380526668373 1.050665195316118572 0.11419213756166878004 0.0394744181851547013 -0.51414830228756558395 -0.39521660111449252728 0.32632145430189746227 0.91282136112899936453 0.30819687550018759481 -0.37436103454424640713 -0.82032502448566813058 -0.55609583430002484938 -2.0401377903716166884 -0.60920039871331488346 0.40491546287592705688 -0.10651619073607553057 -0.25367044405962280162 -0.75641504981224771953 1.2065876122493688349 0.33435850946341755252 0.46930569587053794223 -0.58278790117764101009 0.87458925957663591344;1.0656853387197471328 -0.58988743267944510063 -0.20662849637883595744 -0.31675816601665990335 0.029388310960383461079 -0.76632753676880660532 -1.0100495954417476607 0.17294484061424969523 -0.1910168765139662328 -1.3499050805491208394 0.98520476129328315995 -1.6330954292660500027 -0.074252060212910739323 -0.58092546703318836965 -2.3611205814667433067 1.0518873974775098112 0.10434126688808732786 -0.71420345158087472637 2.5289261622038305966 -0.033837005320873109193 -1.7501634136378112494 -0.53743870072839827756 1.7922732942800827516 0.22913981868780783357 -0.53439616276083379276;0.67447571647509507731 1.5933144129675993472 0.62735301547036603775 0.66780756376356642523 0.080045829475068899783 0.15238408237540590484 0.77612262454872149586 -0.33842434085033912261 0.056215101679758114339 0.33493174843188960876 0.3384886556783403555 0.26196613580755578887 0.14673807353348827798 -2.3794686009385510594 1.2012377384323091878 -1.1412605667240565133 -0.34502552471824343705 -1.1042601475880347017 -1.5947413641194594369 -0.47914301480209398054 1.0519466883616253039 1.5346016960054718048 -0.10446777898143234931 0.14360384873410647621 1.0444576551885085269;-0.50455620652870891707 -0.49098100816421913484 0.2210227444814880926 0.43037162505839299254 -0.24343446913702324053 0.37999322304889093793 0.062065319532176164985 0.10605971197803848449 -0.28729795053805939897 0.22301414832104121677 0.25457229548803911312 0.68622638017934678434 0.2895464699273196385 0.2109503430308064531 0.98460694898099698769 0.45468861332731064229 0.22764241840273294337 0.065026285322376087272 -1.2681154814326967006 0.2504531565878982402 0.54641417612212139776 -0.43480300140129518605 1.4713739477206841944 0.21972277018382685432 -0.21771723002049805928;-0.10375605235581880637 -1.6134355303019889405 0.22132850009718640916 0.23384557779529649424 -0.069042200880045784261 0.060716151330945038189 -2.0022714269192394276 -0.20687119976016829503 0.76485202930754980777 -1.2921411345151327943 0.71923553809549234384 0.94454682005586121374 0.17887481751631215121 -0.35951408745955876212 -0.46814646534802817346 1.8814064187233183745 -0.49938427768533710793 -1.3043915862781145787 -1.8560373836883834464 0.37207159988329929767 -0.11722947618397802638 0.85461828739895695506 -1.5355699841372751902 0.0057971059403714303437 -0.65429308270567043682;0.26193479487248921833 -0.13675331546267210925 0.177321066573851438 -0.7045789332881564615 0.66756303035064801232 0.21634891770587766358 2.2418162951189914978 -0.01669376030507810707 0.53640781551820482242 0.81978940937489042096 -0.088145013816141995489 -0.72120124702285071105 -1.0129843796640205511 -1.044529280843624397 0.62927762989138835703 -2.9209535528471088917 0.050007085831249589725 0.10584640700271702451 -1.7625340248278511535 -0.22376777021597149542 1.2718422153504718164 0.30272477120255081307 -0.39533999841859307489 0.061773130013733183741 1.339635297670370484;0.66003627056901581494 0.99667273012432489043 0.59352987402286105922 -0.48438496227835936558 0.14960472275891600891 -0.29175101526107510841 0.49260842685712558087 -0.05022598514780365897 0.64955729449015087162 0.38317855036563130966 0.40173790716643975607 0.36580932778046831855 0.12356164937573815843 -1.6129957413003512823 1.8507193454380943543 -1.3327185533380212501 -0.21648395217360849596 -0.21244744259513831386 -3.5107781673340756612 -0.3306755816058379871 0.6048087016105258007 0.14936299949465794978 1.0047483117188820145 0.060114427635921771631 1.4323473038853808958;-5.0834451587402202932 3.2123611386410781954 1.7808410171168913561 -0.81010438954685459745 -5.7703239904640390989 -2.1637167087038169377 10.582321143685666343 3.6884734975107487109 -3.3282695286912593602 4.3327438810138367842 0.47220285428311264964 -3.1016038590297352329 -5.5842518996196348624 0.0015271484814780300621 1.8160601905087911945 -10.118104108302082622 -4.6792102470670764447 4.6234065401492303593 -1.4018984349576986137 -2.324997505467388148 1.2088087880892557369 2.4237389269587912288 2.37711590238905357 0.2731132166682596063 0.10483460485045348332;-0.9141717655529861819 -0.5327553039832444437 -0.6277060789527163509 0.97069316747158074232 -0.080159034321628713782 0.43488557393050097932 -0.1268445039588828871 -1.0486028918258218923 0.60448900097186897273 1.4410137626814707446 3.2138677701095597072 0.2112498217418179447 -0.75431220118617958725 1.6905631659484832152 -2.4252687921243296643 -1.1248486470274263738 1.1969993845489592665 -0.6333186123398341083 -0.004271526086904613162 -0.74029034824596107178 0.013273243896458395905 -2.0670173472881443466 -1.429815728992181123 -0.45755221137218726746 -2.5599000795678308329];

% Layer 3
b3 = -0.15726573039994931613;
LW3_2 = [-0.79562607746376512452 0.42954561530663304403 -1.5326202657815579666 0.41046756740198014901 -0.17450149129886860511 1.7971388730829243041 0.2837530328981840988 0.34020823163059693561 -0.42873412274232464148 -0.98457890473607956316 0.32992579407941269309 -0.31509713593711563551 0.55354881218699092393 -0.73397440591097440343 -0.14099621409152132689];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
