function [Y,Xf,Af] = ESPER_talk_11_Other_4(X,~,~)
%ESPER_TALK_11_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_11_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.67955050623545443;-2.514529339605295;5.4393372499351598;-1.5437548339715397;-3.4846923589851189;-0.08150002267882564;1.3132657336846021;0.59879732661199703;-0.19734733608090377;-0.84718288401070019;-0.78543667312360221;-0.75411015227028222;0.067375546965412411;-1.1188569936412212;0.065467162529390138;0.63104061544000423;-0.16514338559686792;2.4476176542551094;0.82903254032329243;-0.66914758344965541;0.64540768089731659;0.99298386185458298;0.24877163433684257;-0.030232618485881581;-1.5346742243934519;0.012447603260406228;3.2758073745955474;-1.3835498654987719;1.1672619871314387;0.29124188163809223];
IW1_1 = [0.66953746707700756 -1.6492572162844277 1.0002951985488513 0.32100130138512317 0.042283655936269059 -0.87537436058206852 0.31885236438941666;0.12362807141564194 -0.91802480146537646 -0.65378629501011609 0.2447133200410401 0.30306749321519388 -0.30793898016448279 -1.7660055938222909;-2.5807031836326 1.4227213657389179 3.4598793701850448 -1.2345753034234084 -1.7435772875853786 -3.4527099055732866 1.6281550099326259;1.2100512879721994 -0.95706093397170544 0.42952833061610624 0.049338660194115321 1.6454701887781282 1.0324496920126391 0.70216751001155031;1.2440579830817931 -1.5789928676366944 0.055184115440302134 0.7086857375614064 3.8681527154573314 0.23846755671660022 1.2160886665956154;-0.1737569093686524 -0.27812871087699259 0.5584199055780199 0.59501576373252185 -2.8274956611825743 0.15957725383150143 0.57512642741813846;-0.71837619981796441 -0.23963056826663071 -0.0019277228309039036 0.36434131243120527 0.28778495395759601 0.26063609161749662 0.61682142460019063;1.5839558471068791 0.53158745863890799 1.4644853357153607 -0.064627542064609342 -4.288684488214745 -1.1044044227812992 0.86199356425454066;0.26747757397945365 0.07538677775765075 0.10338292785090421 -0.19268801720543938 0.015908925500584245 -0.58041202656510438 -0.38194590296388664;0.15604693044938303 -0.042327647194242424 -0.64832256575580738 -0.66535621463499672 -0.88302186884272271 -0.34795778660000348 -0.17264686959741973;0.13478028866246092 0.028178165917809552 0.88871049499505694 0.18684286765389571 2.2471730355669282 0.30756189864984984 -1.2610093699523719;0.65167745400246957 1.2124900186563843 -1.437818291589797 0.28185131180888978 -0.35501684024907032 0.15256237872294126 0.86601230208232682;0.50540022042827815 -0.42218333090536175 1.8553922938445127 0.56643120415804238 -1.8883733689591446 -0.017407699341702363 -0.66304617076671268;-0.19361792621743026 0.34138520440819897 -1.0599263723459109 0.53343907274386693 0.2957230540717008 -0.91076931251031013 0.47394207496822166;-0.26332496342405959 0.018441838928555734 -0.18443422912939833 -0.12540545703398268 -1.047655957799545 -0.038504995761532566 -0.64149779773583193;-1.1744644034555083 -0.61496030535666657 -0.10694819459188586 -0.034934205515465132 0.31464635512197725 -0.13402261131374227 -0.010054856937542985;-0.33933880131277394 0.44908346292530404 -1.6076528963876791 -0.49146694568442728 1.6164348012240923 -0.017795834117890402 0.18052457694451676;0.11346779407495657 -0.32320804745977966 -0.91464122465013753 -0.59606496671625331 -4.6956606214133698 -0.94824864938299691 -1.5956160475120218;0.53443044953499308 -0.085960382603073884 0.79106656117441765 0.44372745829922078 -0.23917491332482757 0.084779034686184904 -0.52658798730386969;2.6553891045067455 -0.61914663152474625 -1.3554076543361449 0.004702075996559564 -2.4796707102775875 -0.91110279543723127 1.2756245344893455;-1.8872342600061025 -0.29051738481388806 1.133299581005067 -0.29523647117653251 1.6001587666226722 0.22763184679820719 -1.9754615136641336;0.59391479515980883 -0.14531819961047107 0.64110273295866471 0.082559131868463378 -0.6560243931064349 0.22107914518097302 -0.19858152603983129;-1.802506995065362 0.24481138933970259 -2.4929390935205658 -1.0631068126188958 0.50238528186738329 0.84203342858225128 2.1618861650423602;-0.3485883292751093 -0.12629368760794979 0.10704400411231069 0.29583921388741358 -0.28030215261625019 0.43625195916176357 0.70224556153150886;-2.0639928063096566 0.8706324600630877 0.50070336699482088 -1.5006508063186239 -0.95568754262447331 -1.9046106660684963 2.7785008631631571;1.4601356503207885 -0.56099367576827719 3.8309590425238516 0.81753717110763979 1.6480306234976105 1.0288109043432183 -2.3858968810717598;0.013375073504955785 0.11289254809249054 0.55526205853565846 2.0231629731076164 -0.25880478769288345 0.38391806253356653 1.0097166644553148;-1.2708414772157326 1.5000736453466343 -0.49863016993568177 -0.39626286493125212 -2.2536604975948946 -1.2147436787049692 1.923697596722953;-1.0337999244738096 0.34016859539551386 -1.9078542646969023 -1.4922425376946657 1.6887304815733504 -0.82965420270354517 0.14613102296026276;0.54619248702287559 -0.4065636939600526 0.045114563843630898 0.026450489770058455 1.8230369095747114 1.4424070147829926 -1.6414055119826938];

% Layer 2
b2 = [8.770330182533824;-9.4673827644262154;0.45504811498008352;-2.7363008317501141;-0.41380242185241745;-1.6850251581758577;6.2457407119747623;-0.77464652774529019;4.0652755672705299;-7.6348252095443065];
LW2_1 = [1.3765631394972726 2.7511804687162558 0.7788408572680201 -1.5789741006167204 0.0016373866945813449 0.59048887177771492 -0.70919267297162703 -0.61066145896458013 -4.5734103172815539 3.1036452657923919 -0.79406822070987593 0.84450784296061487 1.2830579201533152 1.5235159894281562 -1.3460419799288812 0.48033504462128268 1.5762819463625259 -1.1678892413048401 8.1899910626238093 -0.032670526362911775 -3.6902928326148396 -8.9678866550664527 -0.33274295260525372 -1.2201920831258932 -0.15869936222693001 0.25550530237078189 1.7848417305744759 0.60985200791884397 1.7454148095694877 0.67116935748665052;0.92434347005462814 -7.5203222943169221 -2.9839515844836195 -2.7067326926239077 -0.25474760587524381 2.2904055436441193 7.5592846572771855 -1.3188038076788611 7.7310040591647846 2.6672711622662355 2.6861512547070903 -2.9696360066460783 1.3281609294727512 -1.8749532633099721 -2.2083494402842572 -5.5990909413920926 0.28271979806832781 -1.8947425913462148 -6.0271070832933491 -0.041419360655170004 -0.74758856079947078 1.819635700086595 0.10595495156228071 4.7461758700216174 -2.8831467609202779 -0.35325062205160429 -1.3180987771801265 -3.5491959607768049 5.791761031369977 -3.362318844227119;-1.1310207665443908 -0.25086396654721499 -0.32444779880074504 -0.79310703351062406 1.2211066490891072 0.98215416605940986 3.3960666006878619 0.43597800807909443 2.206780852330354 1.6819979623083401 0.32568133191075166 -1.1710286936769803 -2.4726364672253056 3.4165386144318033 -1.6292177285412148 -0.71058899337347381 -2.0495804369889865 0.63767099827028284 -4.669688989078824 0.83795746356021417 1.9822101578494324 6.2896880423902184 0.25806021326809947 -2.6907466190359872 -0.038566664902409113 0.29834826899204003 2.2706246050097101 -0.13857189693951241 -1.5073720080067996 -1.3027357623900231;2.0181668421231369 -2.5081222909291689 0.02962269019915937 -0.96715394032245838 -2.0344474717995125 2.4824723980587677 -1.8225931212592246 -0.9981459006765605 -2.7764674992573588 -0.40275380326054322 -1.9090051442201457 -1.1582906196795419 -0.34468664805384347 0.65884460607050221 -1.9852137054764578 -2.6505181761003156 1.3641839716954534 -0.37347708998152285 -1.0816102839902153 -0.16485057050503116 1.5746671461922364 0.6901425195097336 0.24718566096493078 -2.8861514932709023 1.4256073018755002 1.2898645871905923 -1.513435508601165 0.47669368949868379 -0.84586627050680108 5.4223286521515934;-5.0579526315465611 2.478739199383273 1.5035975745945003 5.2072369184935852 -5.8447743412740305 2.2721760381643956 -4.7051271089627891 -1.6903636170819112 -7.2806573000599943 -4.9142572709363037 -2.3763348605399131 0.38810841685667702 6.8861557802593882 2.4204763179680393 3.4984879118418535 -4.3722640594984759 3.3008299197430602 -1.0458297930536797 -0.51597358970274243 -1.3231355310372002 -0.023717055794806059 -2.8749258102682145 0.19753636167739594 -4.4239633268696901 -1.2826993687530028 1.0121894093478376 -3.6167919660269243 -0.19249164453332504 5.2246754727422449 -3.4894797931638912;3.2788322616749053 -3.4579544835823377 -0.73087913048114017 -1.7250252668677357 -4.8259185844618102 5.5243862021761299 6.4463665148297542 -0.68246023193242344 6.207605142292949 3.7713947247209321 2.4129083322688398 -1.1879464889839828 -2.1353617826897264 3.7156551806871119 -0.45802565289533664 -6.4323695467608353 -3.1602411176284009 1.7993505746617053 -1.4156765560480926 -0.088639333490215744 1.4063114002435815 -4.4424217941692277 -0.10832173880262318 3.9303308849006431 0.36085845552963258 0.11168356488109027 1.6804061663701579 0.10145998529960265 2.911963882040256 2.2153249755650832;0.44663333230795066 1.5933437425481993 1.2467671486532388 4.3325510438320061 -1.6341825328561805 5.6333617138077186 -1.3464059940843802 -1.098478916217011 12.529946704039899 -9.6276088491874834 -1.5696338298762826 -1.4548795510811234 8.0563452767389112 1.2842430861170806 8.5232457488524549 -2.725722059459954 11.916627347386262 -9.6707340224425771 -11.372788998000804 -1.3076258431820844 -2.6564990215938735 11.409174515813387 2.8481469807204145 5.3373567552748176 0.87108161255693073 1.1791303752192626 1.0608677622869735 3.2138673175964239 0.90563975410271658 7.5612123975764431;0.20515773315341612 -0.19331395742672078 0.10051964293854652 0.24271196767977826 0.096254931772370447 0.52961652399070014 0.52972035244849824 -0.10091250712275561 -0.12291750107295581 0.48078120288853088 0.16912404114901106 0.030797130745320901 1.2949490553581837 -0.41989065046474061 1.0932898454409681 -0.49307436359763401 1.6504390449718076 -0.27121517541013879 0.5936941098852595 -0.059253791345129037 -0.15451908750340004 -0.16073392888919691 0.024675902826187167 0.64994554962035223 -0.1340441308102146 -0.0004807277664868818 -0.19736818774224671 0.28205071881809846 0.49706883543024949 0.10510706229595258;3.0231108941083069 0.23266188532742493 -2.6253674751006835 -1.7742801895426654 -6.2718876247926056 4.4120377060675153 1.4614154541669859 -3.1581604451242158 12.393123447239239 -3.436603555768631 -1.5523891905654521 -1.4274896116991305 4.4277452878832264 3.5278033887550491 0.40949103162770845 -2.1868027719367396 7.6592345202684786 -2.0703439702215722 -6.3925016891256119 -0.1897589200266673 -0.48388772701607508 5.2753614971612901 3.3686840582775321 1.0439837286003013 0.29783804279985499 2.5827464561389619 1.884571492460805 -1.4569550377865359 -6.577120008679417 -0.86119276068448747;-1.1629712497973141 -3.9636895061332842 -1.3550809394741501 -0.8319649378056021 1.7845615054414603 -7.2196981431659983 -6.9538265231481287 -0.61111225896877319 -3.9110458345598267 -0.38456594279276501 -2.5917855358519821 0.82612370409175184 -1.1053773328418071 -0.93317601198697098 -4.0202355471075304 4.8589941658711968 -2.1356536756580362 -0.71737055553395912 2.6719899532656632 -1.6909327342679619 0.66824208171066801 2.0855486778498049 0.66274626187766883 -2.7494275728060384 -0.49910483971001618 0.19640426930204141 0.78001657781131528 -2.0752867311353218 -4.4496118345068698 -2.9940443816070648];

% Layer 3
b3 = -0.26696268957668406;
LW3_2 = [0.12456766540287539 0.029917029344260531 -0.23549800600485044 0.054241100049206278 0.033441942566686193 -0.043061782434100582 0.060063181271746646 -1.1897354493513308 -0.020275105498728619 0.11053027776541541];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
