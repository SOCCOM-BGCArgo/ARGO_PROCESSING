function [Y,Xf,Af] = ESPER_phosphate_1_Atl_3(X,~,~)
%ESPER_PHOSPHATE_1_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_1_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-0.28;-177.232103709389;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.0470499670650231;0.00425400504498441;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.3579712842290612151;-1.9190528598597151877;1.1782960868342819971;1.6582362350425798869;1.6497616584344112489;-0.43867193048214786488;1.1973057246432583511;-0.3923374890093157541;-0.14563239914421349797;-0.10836173992066445992;-0.016749278977059182949;0.53213392170122919556;0.54058514452323191968;0.64344621466920459696;0.36158484956191305759;1.0179877067589881978;-0.55581657628480429789;-0.61946601515522647929;0.57876385236319161098;1.3728738587734403698;1.5942035222987154253;1.4671372672881650701;2.0288226628476775382;-1.7578639802191433628;-2.1003243210066213642];
IW1_1 = [0.2278024529177099522 -0.45961812221876580109 0.76183233992463705864 1.1115400618228423735 -0.23696849235729125493 0.62453152619565222015 -0.22328026659108868301 0.21989936102272333862 -0.42770968853528740228;1.0146413875046262909 0.10336275781966611231 0.29361818693997387975 -0.74275768535243547053 0.88781072537011562762 0.50223875923328076265 1.077122389658008661 -0.8644884296654112843 0.80547122780742108628;-0.14018309878835494287 0.30908157902331789835 -0.89585498119880291323 0.86820412561154491904 2.1033460123007530207 0.44734877146909884926 1.2841197990921131566 0.3550461363016866323 -1.494938185431993416;-0.15089819281027397335 -0.23751239272572297057 0.03240195138782206441 0.48796328197782168345 -1.6272123244091138972 -0.67857109961968875567 -0.35805135365735840658 -0.052509353833886433793 0.72098948025219378177;-0.42835346272000668355 1.1947337545108638324 0.82295157443455257962 -0.16834662186673007844 0.1908111050423290378 -0.19939508512400505591 -0.68395109368951034767 0.95868244621913667469 0.30532630940387606167;0.24991378492606883266 -0.5507883542037576019 -0.0119997376833186533 -0.5778165821604935859 0.089095585798297849411 0.37876594411153008402 1.6022854687523571116 -0.8805815377417388623 0.25805023490300971201;-0.20191118566280003011 -0.25583383348304988836 -1.7143860234468044634 -0.18856870815819776199 -0.38124860367110602333 -0.63180381424681408831 -0.61057786305699279783 -1.4814749461045593204 1.4130969493519895952;1.1257581504770568515 0.16383064694970908559 -1.0313466311566912292 0.22983115333669582037 0.19267071168587374119 -0.33525670693123393873 -0.17970959901214306198 0.21615686699072544918 1.0089083435881618378;0.2284147237003848474 -0.10547990265109460917 -1.4699476224928649248 -1.4097356559274438759 -0.23320811263710417016 -0.32778997477811994132 0.2291841828910352874 0.59425760564233931493 1.0626375556709197756;0.31838284838068020566 0.16462904811019063445 -0.1988704099223730648 -1.1512176804637495042 -1.5167106668292631433 0.58244469302566115321 0.16472281378689485054 0.42683080117027261124 -0.7815725639025095095;-0.24641040891531112988 -0.063728568318569350781 0.0027511287139124034062 -0.4867094849862553807 -1.884553701291886485 1.3202035773267153385 -1.1197275980697858344 -0.13892292744523257464 -1.0902808291596546297;-1.1891692038968049161 -0.58704534376899086823 0.53804353220886047549 -0.93696818905822309986 -0.30415775884540785512 0.13038312463409512665 1.3060879669582972085 -0.4063922234549819934 -1.0466510461527354092;1.008845544315281284 1.0278308023335547272 -0.12033465339099153057 -0.55712868771946888469 0.26082258319250362089 0.9630423849100914202 -0.12747405018280477673 1.5642652298571471103 -0.41369492582929684454;0.25464102973043473144 -0.72314388082274327907 0.069175630098208151786 -0.1696714904901942822 0.096839033402784172044 1.0772149239193320458 0.82655726098819326531 0.31679029259911339889 -0.062162855573157704825;0.083264962410275283888 -1.3408377812275322771 -0.32776256344363402517 -0.43434513728946977373 0.49339450519668254236 0.074169442344149044688 0.065143439848813836091 -0.84561856378006206025 0.61261207073451906524;1.4497168827101174493 1.4343579390320639888 1.0111007402872891348 -0.0027609693463240651823 0.10590832094312502276 0.30893837841156218671 0.25025326285716636976 0.25859879938771790364 0.010311226582911867805;0.24923569262683270553 1.1307398594122626267 -0.55456234322592534713 -0.90955061283843430253 -1.5417984799067079305 0.6962467522117410379 -0.24830376045999147383 0.16006715737509938369 0.073850515273996539256;-0.072901470010708874225 -0.11502550913275411126 0.67765950226269544565 -0.36202117454663834684 -1.5549519605748456375 -1.3224607525909330974 0.27568809667825366905 0.12278246010327990845 0.99805657106930056877;-0.016964935157904689755 0.23042916048479580859 -1.6848970580654429874 0.90852148558250911403 0.099185150322052745286 -0.63730409824487588288 0.46876490307947321634 0.97624800440017756031 -1.37723656998714028;0.97811457148746605572 -1.0559352200928511234 -0.80870598735163157222 -0.46422516776365374547 1.0110743415877738727 0.32924882722343545849 -0.79361726197581838882 0.35633749994026453489 -0.15274399964430279697;0.20047802271631687265 0.53120719035174179812 1.5586206664370347852 -0.35359664908460841648 0.65016560409318657765 0.77051926181706564822 0.66994311264931094563 -0.020846185030419774054 -0.34356118446562211588;0.13214204708239465913 0.6458267309229205333 0.50178392344053768248 0.32091483431224493428 -0.8101779254136852737 1.38871067329697917 0.89094207812989423267 0.81458723546952516159 -0.87213909565549896374;0.44930975507954507009 -1.2693534972186153453 -0.81557585639252838661 -0.065145169075537565084 0.30639949748834416354 1.3679379765629000598 -0.46776562657763370856 -0.072712711276468625088 1.1044915063988405279;-0.58624906019645872668 -0.69210997583792810417 -0.63512244947574991727 -0.064956662013705090963 -1.1991365144230812234 0.34792154094733873659 0.89976118450993380904 -0.54467441660916116053 0.26060355525349016004;-0.91247518084890699708 -1.3449154780251972863 -0.031156053595720080429 -1.0757071945419085512 0.13456126823379421786 -0.34867451445868402615 0.082096149340512930559 -0.28481097558569234973 1.2048735882212753268];

% Layer 2
b2 = [1.7112903963599574997;1.3059811331321613537;1.1095472011419971192;1.4456848705886404804;0.72638385559571616579;0.63310087079128118948;-0.45233628470075415429;0.25706642439795102106;0.55373187517363098298;-0.29877385698822173099;-0.5985792677972111564;0.90113074452280628179;-1.2466178902481022117;1.0473214889949817863;-1.8809845482578608777];
LW2_1 = [-0.59567075996037532892 0.14060357784322483066 -0.21513499392425827761 -0.0031738015321161258675 0.20248562154920934919 0.71310315623231690374 0.0076631959117682904581 -0.69466423210594463455 -0.87441946476896348361 -0.22837417415468960757 -0.51453834985460145113 0.58663630573947889157 0.27719560725116876299 -0.70723808294970658128 -0.015234363141532019509 -0.28592471859969520454 0.17296005598082170307 -0.034758428430327510672 -0.0059943506204267436865 0.44332554684348829399 -0.2974548924836286079 0.23006881655001623632 -0.12249332431053175374 -0.16930019173322632953 -0.51146743626951640671;0.005316754966802432307 -0.22412262799343071751 -0.86556630291346114969 -0.33870305891450269709 -0.41883354950462087229 -0.51773807843758479219 0.10387950565828481253 0.15126667996110931824 0.47505097375561566864 0.070481885561866866596 -0.47104061493697574337 -0.2786946442872482721 0.079515309910680675998 -0.26948127130446725142 -0.0099059391200339713679 0.39320713026647458044 0.57543247172214595508 0.29108108909688046317 0.26324753679203549694 -0.41359956827833238568 0.32335019790072144774 -0.23081374546016128479 0.56563746037824580437 0.43221647140964164491 -0.027389721712603103815;0.11824825716721075464 0.023548418527997751204 -0.48693267229776038274 0.25804189092623891488 0.15642229945916574785 0.34434454939441838661 -1.1398699174273005941 -0.043491479500225513344 -0.37023273744250095874 0.062307975553545266734 -0.010731093651006749085 0.084038322758404671031 -0.68326009679016308507 0.59949502312070024335 -0.0085920865033036995795 -0.10045793158195107098 -0.086223838957397408445 0.17248402477759089413 0.38380413435799559663 -0.23410725106197916023 0.5082923827605171363 -0.76673828503162955172 -0.49264612810127156317 0.50258693049560199118 -0.64945015769723479782;-0.34720105318370342307 0.36879568218270558644 -0.079577549402190805861 -0.57012931345180628551 -0.2021245561228066645 0.24611076542333071293 -0.2809269138504553176 0.1026088640010466152 -0.37594506613115036275 -0.35818561808940874158 0.36381127889114450724 0.27638524245355661213 -0.19774612002513450304 -0.43057602913318454574 0.2732093001427142176 0.015584311252130720812 0.49265423401908847723 -0.13004901033560070656 -0.2480119362221388235 0.33925919383250058292 0.014154199486124173155 -0.39027390565231789843 -0.29898522332315263794 -0.91006862180960756969 0.63115258490094561239;-0.35979594517536694909 -0.17358503358264337768 0.19140000999105091783 -0.034331739029471113056 -0.15141152238984884049 0.073289910508750139018 0.40067055011598307068 0.038984101531913520344 0.072898134192705993373 -0.47416926744259724202 0.20340968542387158347 0.16287038642330087246 0.10200801678568002795 -0.72102310651183731949 0.4698029573365251621 -0.13674058465366784043 0.42263597347420006622 -0.23066246130752646182 0.61161767889428209077 -0.21560765265849779482 0.016982740489752227997 -0.27331435462940728565 0.26996503391627363344 0.18388942447546430259 -0.3055046511453970437;-0.32139954299115447434 0.059133868151330697127 0.37864743056399441379 0.022630238492053259686 0.56329755454676233573 -0.65360828846510443668 0.31014239469313698017 -0.21015375599807084583 -0.31265645516252699165 -0.3883017221848545919 -0.33727901618445865761 0.024116896482087903097 -0.6575762836986849269 0.21353609356864067248 -0.053987462205670896931 -0.72299583959986168935 -0.32123166516499923606 -0.072736840451887052605 0.14314047578490479706 -0.28671916383672518824 0.31501544935310465956 -0.89061138129009553843 0.53362621478115579432 -0.10999219845231239523 -0.82181848439897875469;0.38527032064602073635 0.10083949485059839901 -0.01472172311576249934 0.79206767593425331242 -0.88385061995852165495 -0.56902096915292832424 -0.82030220357497862782 -0.11890932326119064977 0.11909453432491927394 0.29901584099059264066 0.52046861039029179707 0.20028013170677380628 0.94010532604775298715 0.0021172106761556848398 0.22538678608023757222 -0.77954937965841386571 -0.36416172427597304218 -0.31174046502466140618 0.24065263756515323235 0.23549971206890654707 0.61672206153292108421 0.13311313073007705055 -0.66055175341677685452 0.59253655675947669579 0.28016549743305907416;-0.10409707941328973091 0.16767319417288170658 -0.31762238213219640137 0.81678657878401828007 -0.56836863493233857891 0.96643741272604954951 0.024926386822473164256 0.50803698262417984477 -0.099569905778324918622 0.45764807155646425318 1.0252250776921041364 -0.063698007694411529211 0.35165170342837087647 -0.53332749745483476467 0.042182159245315098417 -0.39482962971063312319 -0.47748767454638568752 0.014812307950489799965 0.01727165228266290542 -0.12347659313643237489 0.42624618606788228226 0.64676504690422864652 -0.32282719766495671099 -0.046218619894118961877 -0.28578930150149706169;0.25157007102571410373 0.061269087494597064547 0.43289961995891412805 0.72008362887375421124 -0.6870639172661499039 -0.44348872635578195922 -0.47701144202410794559 -0.043740861836491187753 -0.010426651387743257962 0.19391858417560603467 0.033879796482588250828 0.22994609687255859742 0.27840340503606997302 -0.13925120138218038957 0.2939231520940925324 -0.39675200892470657843 -0.60359791397024564752 -0.019466640807262833301 0.020405522704143030932 -0.28318099617291675463 0.55673470398914637336 0.43504088567268073273 -0.0099342273960175107861 0.23421085599213603556 0.50753159399720704226;-0.34348214131449550379 -0.085026302013892829379 -1.1455235487247197312 -0.20339719587192661709 0.049292900161864279529 0.18761215411016843313 -0.068944718503771720841 -0.84938905304300271748 -0.49484436114251462158 0.93930003986690657758 0.35588449193518417735 -0.30884225536191395323 -0.30172743867193807521 0.15383147695117493914 0.39076821249730775421 0.1763612702698340029 0.37872428193038776278 0.20110762437156548543 0.26464022544405602089 0.11004327340997376028 -0.1547476654903442439 -0.39010837743024123769 -0.51496249646325276128 0.050995375274363471951 -0.12226805632281448344;-0.68545428722173928904 -0.83256794315110682625 -0.98253474806629503835 -0.52772061887863541685 0.44490823375520205385 0.17375631120299186994 -0.30166649211370261119 0.12598933015298280358 0.21735078715529349003 -0.23771327478677303779 0.48139994208851505375 -0.18934612006966344833 0.32016727717028403699 -0.54761115657600323292 0.56325168472757425331 -0.51936923327806294726 -0.24282315309808338855 0.6413878356316170537 0.16015949502750145839 -0.5452944189580413159 -0.063171421447036038566 0.091800936499455226825 -0.12499286244055915485 -0.44087923129210365714 -0.29085486249512010337;0.10906823337925358741 -0.36095244377585244955 -0.027262321990382382825 -0.50666508905735252455 -0.27351576267270266696 -0.30942420442677975867 0.94434104258594275816 -0.2294588850606071595 0.77014239067323653209 -0.046193571051711658504 -0.052460529905607955481 0.21460580381335098155 0.12621209552068976545 0.17253245533631453301 0.70224909202025898036 -0.53544538195375601664 -0.24736700607898673421 -0.34333761612407098784 0.94685890016695628546 0.74809264905049766003 -0.13431966291564553795 0.58120030887575746537 -0.34497683438278442525 -0.19736311860082783598 0.22635157718442708297;-0.34261624350452785093 -0.32161040908494997748 -0.32626868077599596729 -0.71168762307530419875 -0.080302465667334996247 0.15424359842881069094 -0.16690647768151267716 -0.48576988335421111831 -0.22744638722987550739 -0.7838302503977059299 0.31868790746335029507 0.25917482257653634559 0.047323225585531078496 -0.50057754052274983092 0.20110020589759869392 -0.16173960032868833769 -0.37324114948186687402 -0.72686187006472313676 -0.25418923754230821066 -0.18404106192918248674 -0.7821573427200809725 -1.2474576526451615077 -0.7648818710441771529 -0.21297199473625380572 0.36619574951736799662;-0.063305828449228510046 0.4259823423711592838 0.38068420352952458963 0.60158348121532712049 -0.75167171239526653359 -0.58245087655494764967 -0.59832168872387148095 -0.096357124791263806807 -0.22479048950836366672 0.23412889431361968984 -0.45682862489895198488 0.40253501699780297463 -0.28252442744991257406 0.50037076999981489056 -0.1113036843050823621 0.27823202018634740629 0.48492653104486183047 0.03270691085342555815 0.12258913656740702547 0.35108018438027749353 0.35153738369198922475 -0.48605110197653733639 -0.2113917116240324745 0.17945159370726337933 0.84580458520418955182;-0.17926724948654843006 0.037650340802016082908 -1.2346395919343866598 -0.25409958075392130583 -0.04970547181213600535 -0.46981559143941009626 -0.41370597753245097472 -0.17492877194161535193 0.16181030504810764437 -0.62044216259422058091 -0.3895142674999373944 0.13099750275531760191 -0.20573349196685891682 -0.30126894185860858544 -0.76810951795974824474 0.91153050553057679561 -0.36280739697724051496 -0.26046094750838139076 -0.90844456240756343846 -0.0061370011162792219295 -0.49648941028855259061 -0.08897110580547171188 0.53872141451687560743 0.33631470837806137775 -0.40555570318369688065];

% Layer 3
b3 = 0.4417709287942168106;
LW3_2 = [0.85468526489028162629 -0.6900772401936017264 -0.28615816444693970011 -1.3796182336055613504 -0.24037176402115001395 -0.66739186690264595825 -0.56690670010782584498 0.65168634529787161647 -1.0617804121516751792 -0.81404037788284722144 1.1284814486571002057 0.91990173414967801868 -0.35009766689816979035 1.5109874122907054339 1.2760716272162793139];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
