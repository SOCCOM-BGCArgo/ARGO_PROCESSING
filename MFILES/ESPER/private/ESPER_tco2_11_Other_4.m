function [Y,Xf,Af] = ESPER_tco2_11_Other_4(X,~,~)
%ESPER_TCO2_11_OTHER_4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:58.
% 
% [Y] = ESPER_tco2_11_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9698737571080975;5.5999070102759951;-0.89470257043683987;-2.1061229161763535;0.52490720070463592;-2.1401096327501938;0.49649174606468433;-0.76277572950064831;3.4185172929010945;1.1056859168777962;-0.25664165180066323;3.3684127835023774;0.19228463699453327;-0.71445639785717174;0.54444426499165455;-0.89621221613250002;-0.38027511877142106;0.95184604514023596;1.775998290043358;0.52118805802222368;-0.079583501019441991;-6.4485998861476723;-0.094077402630753232;-3.8205857630559152;0.89415223761384233;0.61016268088907544;-0.95150877301290171;-5.800908702711884;-0.096132015615955982;-0.85282491297286878];
IW1_1 = [9.4458661625532958 11.783055512765117 -5.2667545837033298 -4.835430133448452 12.91092260696394 17.461173193532428 -1.6779877695631922;-0.98192058041434938 6.2575692625344592 5.1286555987694431 4.8930634152655204 -3.5117498639066724 1.9259303519574715 -5.3339686543566085;0.012010656156574021 0.076706122696532625 -1.1221270632163718 0.28901344156985809 0.83076781303965375 0.45030859277778257 -0.20431062207017331;-0.24960448176771205 2.0116904363062664 3.063321048574815 2.6400766019524862 -3.2821138074337144 -1.5055545930887164 0.6970081694020942;-0.035096040355613839 0.0057578817338176779 1.1403368407721692 -0.27499073826061721 1.6189237913087244 -0.47344474809553 -0.040712657097071739;-0.19485657184989297 -0.14886028662219286 -0.91647877042274484 -1.0527659773681193 2.9594760577036805 -2.1516527020526279 0.18464985105002193;-0.88891835245058781 -0.25699049061936929 -3.1876965094040934 -2.3366705957384353 2.6512215146995275 -1.6638602564990248 3.5856363037094789;0.15517087288462236 -0.081651156534895339 0.66973305348909307 -0.27344941571314096 0.76199665908286374 0.20879944754245375 -0.57470577521217348;0.22252412585003048 0.12331177004358149 -0.13349146850963475 1.0592600062387783 0.22972085360351921 0.73589844063568033 2.4413466512877262;-0.13126422390164094 0.17531059635081639 -1.7071753463130104 1.6058800215944939 0.74885796924163828 0.29120028569508882 0.75664843731521181;0.17049571649906187 2.7032587628952953 1.6170675376941142 0.079106660380161509 -17.146632021480858 -2.3646056459013218 2.1653474720240111;-2.8880288381684744 0.70493503970085436 1.6110691680232299 -1.3395176674133504 -5.9509906171190137 -1.3804836414366153 2.3806510033746449;-0.0066223075235355439 -0.041659320082966397 0.75968309126208466 -0.2095428500825583 -0.88942281985204075 -0.42073180957742312 0.022816154686514861;-0.078283021857658203 -0.051642668340263799 -0.17919283807765848 -0.27852844232106766 -0.94072614185854275 -0.12386867235876833 -0.4710934417822743;0.061739019936102667 0.06168995107020251 0.12592720750334521 0.29173199414056811 0.87411181781182234 0.33482620461297463 0.81202826660252847;-0.24900536207360086 -0.35775504254221241 0.89433017811579729 -0.19443455929772444 -0.58828154170515967 -0.57531884814483525 0.47260262565886829;0.1899027733754336 -0.12329712312430366 0.98923004277928228 -0.37346201967844017 -0.36824736275299957 -0.024868094343076994 -0.028207435474287165;0.12601004045997502 0.40107448951674701 -1.3152343352012099 0.30656945700243743 1.1082055342151498 0.58979404951907843 -0.45922071840770273;-2.4818227692679176 -0.077985900028688215 -5.9122803483611932 3.8443004827165939 -0.67072374768030008 -1.1227702574922869 0.96901521488831932;-0.16534794867507013 0.11050309191384979 -0.77236797780616706 0.30502335007996417 -0.12773217129741915 -0.13325085944834822 0.22047724666045646;-0.16457302052202089 0.12388312558514999 -1.3974002311183109 0.46701196215732149 1.1587151225698964 0.32198768329120325 -0.12986185623325591;0.5070771615180848 1.038413758894617 -3.250043341547991 0.66935286490681567 18.193966431831267 1.8690157332198525 -0.75746683041794394;0.03893623808362804 -0.065954316919497602 -0.86456965677447961 0.55079737023025055 -3.5366921033343095 0.90158268514251527 0.89285703252708049;0.19732759780744971 -0.38971510852863867 2.1285807065873952 -0.48786476225307007 -0.84444880776639242 -0.38533012137664352 -2.7011577045952002;0.063316357991631572 0.20241089946557861 -0.75767956907244882 0.17786621472247044 -0.17399659877059551 0.31608700520621913 -0.173542283321132;0.27232294385901934 -0.17805346453207541 -1.0384694337357925 0.50637223687397848 1.7787573999428112 1.0125841210224997 0.58068724966491003;0.23993840635452937 -0.9777582922314465 -6.2802210071951272 3.968007188291697 0.90193282172619682 2.5046297561350421 -4.3484805680320369;-3.4342577962257277 1.7534083976616333 -3.04807756619801 -0.1852938028908041 13.195111745129442 -2.8245053908280031 0.10688041983023823;0.055212683278859573 -0.072127638736055086 -0.70719601056130144 0.4233486588633748 -2.6974189106938997 0.64462906452985691 0.73634791590870674;0.11025595397152962 -0.23612259605555094 1.4047159154258422 -0.37942630160538043 -0.94816970304522685 -0.38250306219250968 0.22641039614651481];

% Layer 2
b2 = [5.2094236113779964;-1.2843794131799613;-11.994818630241472;-9.2537033171283927;-9.9035166640468493;27.128856086908474;-1.8473615104945194;2.5205374549014952;21.970101893525804;3.0747530141644841];
LW2_1 = [0.082455243643005216 0.34042061627052989 2.2791653827114078 1.3197420352476101 0.15945272870841803 -0.62200914938250706 -0.57374616722266991 -5.2449444211226384 -0.099721603110319662 3.0269778740130455 -7.0080210143653128 1.4776143503340136 1.2566347608902066 7.3222626823218624 1.7407087546092876 -0.024924629113806468 3.0330960105381068 -0.74061308632606526 0.73134322437182719 -7.5987297160603653 -1.824338117308159 0.53573983278364723 2.7450919158108471 0.53882256426104125 0.76606891944076638 -5.4080759487941803 0.17054632219957444 -0.10861967355648092 0.90111310169595449 -0.89564806970845479;1.7999037793539014 -0.70972493662457981 12.610053476993073 4.374864707589543 3.6319738315246259 -12.26705210073739 5.4294330668216242 9.876209175257852 2.521630767270489 -6.3775281873297445 6.455591598112373 -4.9566541789239835 -3.7291860372059555 6.0018501619367886 11.257598198985212 14.934509914656221 0.4854004662022508 0.58657744155480684 3.6876312686225421 20.33002456754884 -10.96163684817429 -5.2918669917313288 1.0603487147055781 -7.6646645779965148 -6.6688934971866827 -3.1554886094584145 3.9952705598107459 -0.10696558184036389 -19.102348272707722 -3.4235024297925349;-3.5603884604384373 -1.6610683568198035 5.7641287273134525 -6.1393725372064916 4.3451580626960737 -3.9473156824003119 -1.1910703178290014 0.72242972211689771 -12.518755680390147 8.0706554247677857 -1.780946682311318 14.807872918600227 -1.4347042924352948 0.33190078610575691 3.2297232788692498 -1.7694731094937781 3.7821766825988763 8.0794131008581296 1.722237550389857 -7.3972693050677689 2.0239110652533272 -0.16541089613964513 5.8005066193912667 -9.8122330346176909 -0.043860588789617717 11.242566400915091 0.10280017000625616 -3.8046811013750759 -3.5105536108345796 5.6310177079353689;18.902322207879067 3.5068714156302287 -8.9412366754730641 -2.6736363865252777 -9.13068170766382 -10.67635428789626 27.531538091557849 18.348011125429625 -14.411890990168986 -16.877839621318554 -10.130329723392402 -18.996712981790917 -14.734188125963021 -19.123950584919037 -9.9415690641978749 11.510147746395493 -14.876245466803313 -5.2267215555908599 -2.6019312829691961 -16.620738979588413 22.986645680337002 -7.786614462702012 -0.9286739289162852 8.7601988488783089 -9.2581924405976892 10.307100772109724 -4.1003392987885228 -1.0527106197918759 -8.7368352682666899 -2.0526504002701786;-0.043390373513317468 0.36612020704984438 11.764048955802279 -2.6741778060504724 4.6223359910284652 0.7122307283842112 1.3566247166703045 -1.6017914974462819 1.6444860819502145 -12.004737874874635 -0.088593152686750373 0.35986710091289242 4.986863886543512 3.4084317296980196 1.4955061919952652 -4.5348956171387549 -3.0274473362189736 0.0016002229512496018 0.94137703289848584 0.36436437087394175 -1.1774097694517403 0.042237689334847915 3.6895485815339004 7.4918921621940431 10.086907848039484 1.4416318921822933 -0.81589292057145735 -0.10225466292467728 0.95074921459445383 -2.3753057108781994;26.058642990418466 1.8782940649726818 11.109814345669085 1.7350643189207635 -8.7506758842637069 -5.4436812489041708 15.813331984921236 7.458086577531887 12.926668413668565 -24.168660922881234 10.796857614584471 -6.3825373069949674 -2.5224495056565859 -0.9073045913992247 -5.2071206767845997 1.6620524573688631 -8.9829884813446572 -7.0393294872699839 -2.2640710815384466 -10.775251364581448 7.1520812214287099 -1.7806529899081984 0.27118216421070629 -0.036404679481659437 4.4531316736417184 6.3800232414124407 -1.6010359039602962 1.577454808512148 -7.1944290223709775 -1.3334943218751769;-4.663612537917218 2.6441092362402334 10.104356464470445 17.055656546740956 30.987274609907502 13.576428364715618 5.7841114497855077 25.24880472459267 12.004989028811929 0.14952838281494044 9.7591533119097811 9.083984019039157 -9.0920207071402874 2.2588592154885334 7.2657139521957133 -23.785682953730451 16.751310468408118 -3.7840346469751553 -6.8796213660445096 10.556360308365182 -3.7631013774935655 -21.779148517797186 -8.4292114114957499 5.404472856687323 0.76030692875908057 -21.068525135179232 12.918044656785611 12.760726964407443 29.576404953105932 -6.031058393583308;0.0037446242262157191 0.00093585700205341387 5.528263336541813 0.00072731839215143016 2.5906767656706138 -0.11135316324518954 0.006275997350647264 6.3783920006085566 0.42248713691665235 0.17741897459772052 -0.025969053144418868 0.026934887924223411 8.4674974419364499 4.62572458723906 2.6362295667057891 -4.6894800346261034 18.42857333075764 -4.8645684409344883 0.025886539515478962 18.375662091096359 5.2678885056222331 -0.030802188081791585 -3.0907942082205251 0.18165150653073944 -6.5313965059357253 0.38076769792265452 -0.0054153279043515287 -0.014036005226867111 5.1087052357832903 -9.3743709915794025;34.070209745332306 10.801928280790527 -15.197960450663652 -18.75192858921012 7.4347418200835689 -1.5234311820254021 -3.0210518334374865 -16.535389127435575 4.473142060120483 14.584707584727445 0.77219029312774967 -3.0720850997536533 7.3117312671267625 13.41567951140301 8.504678496708447 -10.014431371094982 4.6484499840508802 9.6164911584891541 2.3239785582837658 -8.8407421223224745 10.602723548236598 0.12138691308308891 3.1100005735064786 8.0004757477841864 2.8453412113261938 1.5611282978223289 8.4384305629587182 0.73275106991378169 4.4243019774865093 0.38669619636771541;-2.3164794973894209 0.66104871975637991 1.2674777435409668 18.536375784836036 12.837055929286311 5.7593284005009 -10.270094329810769 -17.687044072942697 -11.512681217991478 18.996349341029813 -7.0141605721131768 -3.3947886042108077 10.0052780376332 -0.38338970330291328 -12.320229590503958 -19.075420774063559 -14.430074665040035 -3.7215000799386724 -1.9406498537979517 1.3505179733886994 -17.909918609983801 -3.5781240068584013 5.1097175733935112 -17.093066094313851 3.2209055693558941 -2.5699072113093577 -0.42694555051547556 1.1939495346992788 16.856811531036602 0.91134812335397697];

% Layer 3
b3 = -0.22252085948506442;
LW3_2 = [0.022280157356574518 0.005826889974308698 0.0077655894879416791 0.0016232074478128124 -0.22382200831975321 0.0031725579280182797 -0.0053779688718474687 -1.0615073670229556 -0.017104167016400849 0.0056812633907639878];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
