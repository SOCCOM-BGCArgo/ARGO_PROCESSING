function [Y,Xf,Af] = ESPER_tco2_14_Atl_1(X,~,~)
%ESPER_TCO2_14_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:59.
% 
% [Y] = ESPER_tco2_14_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-0.2178];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0461352500991908];
x1_step1.ymin = -1;

% Layer 1
b1 = [21.095199715632109;13.869177179934102;15.878552367264268;13.299784785084617;-10.872766202237949;-4.0740438407176098;-1.7789412778930584;13.815155083247026;380.87114619275275;-0.39025357296493729;5.8548739019514855;66.940113131159507;-345.71128491077525;9.7691392548919502;-29.310631181378014;-51.88818995517785;1.5867655958108957;-6.4937148105569973;-125.47823001291879;5.155805053801374;18.95977382076461;2.2417946564606437;-4.7694562784935464;-3.0501919863225826;-2.1813574682122856;9.7058063204096978;0.92411406748041869;4.9266869037795047;-11.414603294654167;-21.387867348161752;6.5399147155669564;64.228359416819259;-12.462420418666056;-4.3644162831672348;-0.055743509495249859;7.9119880963294529;17.806204312027344;-30.245390009549723;0.55830353582902958;-4.3280074693180364];
IW1_1 = [-9.9907089559860989 1.8065486561777326 3.6126178765092045 1.781564238492976 -22.754184804195926 3.4519710063897318;-0.013140724005491539 -0.07976503108000009 0.055912453052301733 10.342355677687431 1.2838055541371904 2.5109227531059162;5.2042341332682422 2.1037524826226259 1.4928579751272404 3.8721867053194159 -21.467092347995212 8.8320081616150308;-0.18401592710461337 -2.4047104393714487 1.0679844319457035 -0.94438618298011756 -14.017984688833907 1.1088927186590036;-6.2192095526464213 -1.1303281675449857 0.52452718615996652 3.0939613342505559 31.544997482896832 -1.1279161540608929;0.05862585595307173 0.90913863927422667 0.79561911012481967 1.0983091281112971 7.5840374507793431 -1.0305800829173746;2.7889258741900531 -3.2319650200436358 0.34050719699523907 -1.7422224226496128 0.15967665873531811 -2.1646227284582635;13.758282941138997 -7.1553990140066093 1.3912558224882909 -1.7790261048241716 -43.29356851047082 -0.91283598747226191;58.627139539602858 -15.9806530697605 24.516196825837209 -8.8279611184197204 -598.64941649555635 51.823005314555516;0.1007340105778937 0.47952110028514966 -1.5943619482646803 -1.2332182670164737 -0.59194829314899267 -0.29990452086803648;1.6990691905614212 4.5681213595961117 4.4797499053064103 1.5328001899814849 -20.069650726169076 1.2736587494227327;-1.1289863766904593 -2.5549547691323071 6.3319507830886268 6.098061017085838 -96.937350414218884 2.1158268019555302;117.98262868395889 -199.11932158625089 -84.507672452390821 79.987700270971743 252.66850448908144 -105.62074006195088;-1.0728994462069852 -0.4158129511380721 0.30901163585931274 0.8731761940981323 -15.225782319347919 -0.31858771801757746;0.74096757091269183 10.659180685296205 1.3605542861240425 5.928557954443928 68.671430135493139 9.1294216747497163;-3.7836833442000657 -16.010765360213554 -0.19930834919276966 -79.896127963973811 -59.854797923212871 4.6175907489645223;-2.1163358084536119 -3.0656255211556878 -8.1569639575445674 -6.8413763608581251 -8.6774616236957716 -0.87128957825331144;-1.7824763473935816 1.1457642010705948 -2.246110232446195 1.0693471633538087 11.000087743509695 1.3837948360519665;22.693127311208141 -60.90597771765551 51.379637569555371 49.638566420973838 237.18595428487109 -122.58582307872624;-4.6324845928799201 1.2645465701677534 1.0468928180590193 4.3155041562025902 -9.4038333853454201 0.4141526923271554;-1.7159797687130316 15.352689867191502 -0.41505356036877356 9.0501224448969833 -16.399234569312242 0.50390955729043119;-0.63610940479349898 -3.4372594617827041 2.0475696679508126 0.91316594290672704 -8.1643262718888217 0.32841661535237737;6.0572793357367907 21.042718131448311 -16.612354993687809 -0.02426596153231703 33.470680901712285 0.53384224011629333;2.8385881841351153 -9.3973500737752111 0.41205460404556882 17.581042055234576 11.468113340463974 -15.675992131142875;-0.17327126243275434 0.3124733413748681 -1.0403973305967835 -0.49320363848542326 2.7071979858966579 0.21985578640710174;-0.887192869492896 -0.27903047477429888 -2.038491856779403 -0.91848744659970671 -14.578424171539229 -1.7924075590566015;0.80091879291154089 -0.2642790289929855 2.3192392971689331 1.6533241187621945 0.028009086918791615 0.45197746847425729;-4.683603806513319 1.2715064384068815 1.0942092611870504 4.4023933952230134 -9.1437396601122973 0.32258129588974532;1.2593903201163175 -3.8189270834412654 7.1734123797803395 4.8868118709039337 11.035795255314083 -4.7320558138484419;1.0137102417110546 -2.6427879174558218 1.8872732335665972 0.77270821728041061 26.989520351460325 4.7915703687994622;-0.84259967192699792 1.708505161481515 2.0882463956396373 1.3335764366555045 -6.1835080157220297 -0.22900108013764542;44.079095775953682 -7.6198679205429052 -5.8288516573683182 -10.769123813205958 -21.674845802037424 37.946740906075902;1.0445142638165805 1.296593564526467 4.7196682917829333 -0.80588493112627813 17.277601084254023 -3.5877182662861133;4.596709074777638 5.5039838421306451 -19.820613169120971 -16.778872412385077 28.254316254841605 -12.278904196043703;-0.52503216002243691 0.1063742257713623 -1.690400416452861 -1.1748548437900062 -1.0114867347729724 -0.46484120140671986;1.1059523311567914 0.15322714838632998 1.8416718260106004 -1.4792711394231897 -11.58585760993074 -1.43160829392763;27.079569972114506 -175.03567020317004 15.003064874771599 -125.55676285467776 75.041649376233536 -116.68958132389275;-5.8915525996848261 9.0379287088404432 18.066650869220272 0.14333493745157649 8.2475861042363867 0.81566156719932081;0.66432072962237587 -0.2080924147575999 2.0799509940598084 1.476176475340196 0.46604784626337353 0.48482653783740975;1.0321652936110575 -1.8261988877827071 1.4901170050318882 -0.51287744904509736 0.47844203816683595 -3.9921747567208734];

% Layer 2
b2 = -0.97816623934201763;
LW2_1 = [0.0072607097421498413 1.6646499583339593 -0.0043783519734777012 0.054581970619611141 0.023500586145592708 -0.097828124747776857 0.031582456534351051 -0.012310480909132763 -0.0010781336176375227 -0.20868165572604314 0.022052918671782676 -0.008793140688721772 -0.00021470437757364609 0.041243332277690739 0.0055597193516301801 -0.0090187209932694849 -0.011669742859380555 -0.060224085960150532 -0.00080664242326316756 1.2973063547726653 -0.0031553161500003841 -0.050259873174516016 0.0026573830293531615 0.0032077412559707299 0.44305961006558492 0.053875518226517531 2.2833731926163461 -1.2647510309494008 -0.0098206806772960387 0.019882477577492976 0.094685012454294559 0.001908541036623738 0.013462381767219856 -0.0039151756008242505 -2.1362782883282803 -0.04322799551586344 0.00028019063790750762 -0.0076728616430978488 -4.2118737869459126 0.025456428178330218];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
