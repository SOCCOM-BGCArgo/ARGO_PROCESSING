function [Y,Xf,Af] = ESPER_tco2_6_Other_3(X,~,~)
%ESPER_TCO2_6_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:55.
% 
% [Y] = ESPER_tco2_6_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-0.999998793562952;-77.961;0;29.715;-2.08184650291172;-0.9];
x1_step1.gain = [1.00000000274156;1.00000063368067;0.0138606862425759;0.0002963841138115;0.248478071810163;0.0588359962254402;0.0419287211740042];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1253442241569638;-0.98910008867479693;0.11222978800585681;-0.27711901113772175;4.3876806671198585;-0.60227367893314843;-1.8025041281447185;-0.86809432071310622;-2.4068065076000265;0.97808716152478081;0.55521688913879863;0.28661627162816211;-0.8822564532067394;0.5932204064046791;-1.1291206581381308;-1.2165807050156643;0.48086966489472333;1.7928839675744099;0.67817210494831182;-0.19126336107441569;-1.192274350743779;-0.29684517662769544;-1.6219961436140233;0.30904841964601149;2.2989532215201631];
IW1_1 = [0.3950829396558731 -0.16139772697167418 0.68388025114135587 -0.77365776610854187 -1.4524339600700236 0.14731415560014727 1.267664259810664;-0.33640309145501557 0.068471779861394549 -1.4412461431335029 0.024451530797262686 1.0913622549947888 -0.56078653272231838 0.5704056855650298;-0.94458114954452443 0.053490944202152141 -1.0036418670271496 0.1332662689396755 1.5119310268999924 0.60182355819493438 1.1896686363643354;0.084079700777352037 0.10548379619346716 -0.10489094883592265 0.038334776873291967 -0.56391354453695186 -0.58377491655120406 -0.40559530856301235;-2.0747808386127269 -1.7884043756219465 -4.9757705496979145 0.17837683822574862 0.83770220259944306 0.31761403525196158 -0.075531906542488592;0.24473186411423112 -0.75537284645500402 1.4805163272102853 -0.49805956833807147 -0.085078142994299819 -0.65336697334246518 -0.76798519562611112;1.2532836802047052 1.0774243743444754 0.43765090326132505 -0.85524963639009366 2.9405918289060877 0.68234609923979794 -1.8285722004591207;0.32696824690264226 -0.44095138797318395 -1.5435480006799582 -1.3269972325363431 -0.24786064944720973 -1.6807463787369581 0.030752027252767891;-0.25126402458433467 0.049321319464181418 0.6771388003047083 0.64452075569971989 1.3508954385491452 -2.9713865966141446 0.20594693705976627;0.26319360404860853 0.11719154889141105 -0.70974228985829901 -0.039546830600543557 -0.30241810367765826 0.83499484191049012 0.080587483843761562;0.29260547441992329 -0.058930559979482482 1.1004881110978071 -0.42768280519919843 -0.81801195170879493 -0.11179024952104244 -0.696498825616371;-0.067141403901700897 0.39388704205863229 1.4561386051043186 1.0570357393614367 0.21681851334426386 0.41268501349791209 -0.038454106144463533;0.38235001579092354 0.050608206701963608 4.7800280990959489 -0.11237341776014539 1.3402286015130249 -0.45268084730988084 -0.77904231981931571;-0.049397302359656635 0.35760207599562971 -0.98875475556249814 0.35937930640751709 0.20184546704042231 0.55952589446996803 0.79171552501165821;-0.12715023173889836 -0.4367938242360685 0.58991557376929959 -0.1509483482812165 2.2107862555501296 0.58391350623493543 0.47918020498059372;-0.16596315185767546 -0.4094609558894417 0.56297138721739948 -0.16253805762435489 2.3491920126230896 0.43495467827519035 0.26340538872480251;-0.15648757030724977 0.32257122607088207 1.0383848908190307 1.2696309280983986 1.1764924404798509 1.1352043927562872 1.2355531027616493;0.054142103187847464 0.66251480289171416 -0.80683276487687439 0.9068078192415755 1.510111564061303 2.9683913674806117 0.72140046419231363;-0.26933427084212458 0.51297077475938846 -0.81426566687765345 0.28484845468686859 3.5646440527057344 1.8269472864813856 1.1787661021245355;-0.82313785476486634 0.38627676741475481 0.14173191307599528 1.2630313538482476 -1.697466576297441 1.2455259572725641 1.2410989581269909;0.037199099427370222 0.21335795831282972 -1.6245206707075437 -0.58869206066671131 -3.5526688423128037 -1.4612753198603894 0.46627575324228182;-0.077855712416292744 0.047455537902491934 1.278953030887322 -0.24486573894787897 1.2496783288201261 1.897607233455229 0.94786659264837259;0.24127262910227271 0.20877807565782572 -0.89196155511336273 0.30095616412075504 -1.1102485101029029 -2.2282389346458422 -1.7909006364039077;-0.081942331867570301 -0.11882433499926152 0.14778366369646773 -0.069766407009971193 0.67253703466035508 0.65402193047302948 0.45036365727548239;-0.28456743656475209 -0.064187385283698481 -0.22060825708219026 0.55586563906568853 0.039920666313570351 0.47256100684107855 0.91318143172577371];

% Layer 2
b2 = [1.4569711963714622;10.546726187485316;0.14791342408111505;0.36437931407555801;-7.1399322706222605;6.9104963504889403;-4.9578852446302761;1.9937020417714895;-3.9083874181333296;-1.6268262276823404;3.273638020260035;-2.9546747408652458;0.32804028136003277;7.982252096033287;3.3456650894517703];
LW2_1 = [6.6380799054136723 20.779681972291201 4.5518138433451005 9.7097216178864976 1.1678905663014523 0.9226314591986744 2.9593519538955815 0.51326474490812279 -2.2957405421878434 -7.527314342912975 -1.9949028159095146 6.0458411389346631 -4.579111803917252 1.1463134662552241 0.41531749772208265 1.8509293123031747 -5.4756807942092349 6.8885012185283587 -6.2546975654849986 1.16260367602508 -7.2964297623160039 10.585182246467729 -0.44923829258101755 -1.9494629945817168 6.9628910843616989;-0.084113198109094067 -1.4607192814560079 1.336592526713295 16.984663675084253 2.7077830383623747 -2.6159085154003643 -3.075375277905664 -6.9432207077051142 3.2329139413517924 -6.3571239159107407 -7.0944673456377023 -12.915372009658395 -1.9471109251651288 -10.113165978932519 13.275480137877455 -6.8607868084168571 10.506136323750978 8.1210921606581454 -2.7601241715017921 -8.8391974672370779 3.8002927052588298 -5.1159659685957308 -6.4054163165096556 0.97588035672890594 -10.96591434703401;-0.24986641706640461 0.021717941842437815 -0.33245278189094996 5.6501175469418632 0.12591933611557155 0.72286343907211847 0.15902995856352362 -0.17582307901265615 -0.20696722363921252 -1.1094490013171594 -0.62631029236874491 0.066937597008725452 0.00087702275352133439 1.2368414261015745 0.038772528562791272 -0.32911820205015779 -0.11378583569630417 0.16403566684456095 -0.28199303115401786 -0.14641081009795362 0.12994177199545839 -0.0081548055484657548 0.51416189332893458 6.4890028130684678 0.86975786474839478;5.571906899667276 5.2167457591897 -1.1080665411836013 -2.1355022720897159 -0.081717003299176 -1.9875212664319011 -1.4243668464346582 -10.109046978756794 2.0010388665226198 5.4848456998962876 -4.0805513785251071 -3.9877605408450734 0.62864805674116575 1.688737149023265 0.11391682982409665 6.9293542544720186 -1.5689465401642144 -2.8600507503518564 -8.3352801343914162 3.2474077440380755 7.8643980835062717 -9.7344937957182989 -10.59605055495955 10.918396579707991 2.5604654264456603;0.30606033348040673 2.0884511344636052 -1.2434193009768681 -7.7144906036812646 -0.62194228335356327 1.925920305786974 1.0626098223398726 -3.3234113428774652 -1.5785886717716717 -3.0686091760629153 2.6833123052601167 -1.4837005060312916 -0.18100049576046223 4.249617002287275 2.7337600547557037 -5.0870032064960027 1.5842680944040204 -0.29152324912203342 -1.0414812735263899 -2.2713394144900478 0.28198964401630011 -2.8043851853001467 0.28638852136035442 -3.9939861801190384 6.0480763912275037;-0.41118058246585165 -3.8011706480519996 -0.67830805713060005 -1.4938096541278403 -0.52566063198492174 3.7588441022053258 0.38745780768567006 -1.195860211012173 -2.6794722087497815 -9.9321827320460265 -0.37011162347783738 -2.6308374057411745 0.030138528363533919 8.0077334873999799 2.5069834195730727 -2.9105884441442993 1.7303821855800587 0.561047807785506 0.22730072460051201 -0.24568400601102686 0.62533398423342845 -1.3000105438529361 0.90969676075563322 -0.66908632824798475 -1.2697257519877958;5.0296846102209347 1.1707227875024158 -0.57461949687652758 -1.1565476031538486 -1.7202924378761795 -1.6169597098846478 -3.0698551440755897 7.4083437398960381 -0.76763440438262009 5.3331748001671819 5.6588521774148024 6.4412786292328628 9.3308171546525713 0.0097668599113091299 -5.8846144614242917 3.1527441688416626 0.77000839850494074 3.6005491751076493 10.269671546847142 3.4895270599170765 0.80258057261360261 -3.4011004296456426 -1.2171671825061525 -6.8294917271543154 -6.740122775478425;-6.080794462433416 4.0201220074336916 3.3090836929308449 -4.6050895017702551 -13.256787582695701 -9.1343996417606927 -3.7822349618133151 10.026496453945095 -14.057777546043308 0.79241479332554365 -8.0774612862170123 6.1040714688187192 5.9666610984195207 -20.242902179080968 8.6456454152568991 3.6250396102598281 1.5053981174730942 -8.9354790551097008 6.1371886231166917 -5.9584471518638988 6.5685058352899794 -16.764777079033067 -7.0718355018617958 -5.4174945479801524 11.346995673142056;2.7131883686709437 -0.91743727112769502 0.72844319615748432 12.96952344974027 -2.0273779121610311 7.5874570968826909 1.3138382905697685 -1.8962286832478086 11.839383644565601 4.7201575671290028 -17.635586907024223 7.1376202767606847 -13.080163126104518 -12.427889004472179 -17.101997132099342 -2.3038835082299087 -3.4950897316972749 0.80207861959210724 -2.7770857311918977 -13.403915258894525 -0.92148330789331123 13.962821888003118 -0.40715343905637869 11.020622579656012 4.6012501800614585;8.0619587039759573 -5.6638712904047637 -4.6443282758317039 -7.627595503718462 0.96787662166566124 -7.8246345562989816 2.2683637203565885 6.3869757094577286 3.3728878016571477 -2.3078819898317451 -3.5257071812065388 -1.8106321224443058 2.8876405988601439 -1.7566503387574213 8.8635046065139829 -1.6137389189684623 3.1790950696564098 -0.7670414552012107 -2.1474502116819902 5.5043597297120552 -5.0326091291497868 -8.568890478544736 -2.694977445206634 0.35633909331164915 -6.6848092884659698;3.451893408004937 2.569282138675995 -0.049397301576500241 -7.0064524383745601 -1.2394783619752869 -1.8533369472715493 0.47845723736009366 2.5899032223907219 -0.24635842181927955 1.2826853335709105 2.1437189808717436 4.6510605896543993 -0.082232528395888682 -2.0253038993564223 -3.7516381762902018 5.0198060755864731 -2.4367968803986977 1.097005717490815 -1.9116838990399148 2.1981593985890862 -0.64639902401613758 -1.2516919099244002 1.1672932450367126 3.1889111137270647 -4.6056140223031861;2.3503928506269145 13.958702689648819 3.0839450665240129 6.5120211245794497 -0.62390722422765055 -1.0933143175169466 0.68629827932043652 10.503887926340038 -0.92300941442206852 3.9109229776696441 9.7828056628443569 18.964656966582936 0.52730665170194491 -3.0506534509413661 -5.3297032966937152 5.6783196536802469 -7.7643944214253935 -0.61912452894011216 0.085668811747218201 4.1552429765312811 -6.4788208488326253 -1.443838458930996 5.1230159227405583 19.236238472200913 0.81080006042295549;-0.44694300450484176 0.10105160738785821 -0.53941610796957162 1.1516385800152047 0.23157367245067292 1.2173354910586274 0.22061717154541469 -0.29778873743676548 -0.3349328105449691 -1.7567170820577089 -0.68827605178950924 0.013945935313647673 0.0011668449098915421 2.0553687901879196 -0.81903102111172232 0.21086452940766512 -0.16357106251012543 0.25462606127066739 -0.37618890859154264 -0.30047802500332005 0.19557392090218609 0.12157523160343654 0.63570406384327982 2.8788371842682969 0.71620371065625121;0.9524892182743524 2.622857746476869 3.4069851641844284 2.8931753351004992 0.47134640492789792 3.7580904406067135 -0.24488104338310943 -3.5483064841172607 1.3399518066860605 -0.5575379705332677 -0.11166365774028461 -3.7196318765644829 3.4345072975186528 10.36547971811574 -3.1819855252757305 3.5974192627994914 1.5368108092232402 3.0466712072877362 -2.4366584798050548 -1.400260623552795 -3.811544645221693 -1.4077192187017138 0.084098218267254277 -11.236323330214786 -5.8837703443801939;3.5654831807497676 -2.29300879951382 2.3170945920338348 -0.60353361938633709 -12.392222544089014 -1.8815032606202076 -5.7127078932869599 4.2433226659119372 -8.6429237659609655 -1.4323000348780233 12.64214720812093 -6.4814201986322555 1.5064964643595449 -4.8721411899407059 9.2734874568666061 4.0261089305619375 -2.711978929429387 4.474469117095274 6.8141792630180404 2.5970124557146925 3.6154119971991419 1.120584147470767 -0.91511326359255685 -6.9368543952728645 2.4285857609923642];

% Layer 3
b3 = -1.1134475793943306;
LW3_2 = [-0.0089305873493633198 -0.01338636825765464 6.4425618117411823 0.0092483728388810804 -0.10382464685632083 0.25662083217371451 0.011243828271588204 -0.0063459467469024564 0.010367673801267879 -0.01098290412308209 -0.12909554091245967 -0.01990634568438155 -4.2268214356848226 0.042295407722739424 -0.0048074258575636899];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00314743155299998;
y1_step1.xoffset = 1774.26765577007;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
