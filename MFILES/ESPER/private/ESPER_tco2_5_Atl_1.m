function [Y,Xf,Af] = ESPER_tco2_5_Atl_1(X,~,~)
%ESPER_TCO2_5_ATL_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:54.
% 
% [Y] = ESPER_tco2_5_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;9.1619;-1.99149636107278;-0.2178;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00004398834998;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.061098595529566;0.0461352500991908;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.70205966855141588;4.2143555544163851;-1.7458694625498798;3.2823145688693174;-1.40199078612928;-3.8275957052383069;-0.64939634453197148;-0.59635644059544946;1.0991464947981509;-3.4198098817458416;-2.4263800616777313;-2.0613888437219039;0.078792272936705016;-2.9665366288889041;1.759888579798814;0.051522164513011878;0.11246507557750408;0.99672238860562823;-1.9938128039021099;-0.60474836949061495;-0.67687984920959687;-0.9140929496592104;-0.058449139726885119;3.405104354072185;2.2468896249195724;3.2075704967867309;-2.216930052174543;-0.0020599544776849932;0.79298672100634293;-0.54771494183609559;-4.3323687925084755;-1.8112055668339557;-1.1499668822411253;-0.9149561862081933;0.19611422552450281;-2.2645112617995613;1.3010212288546306;3.1050896600777591;-2.2481762968494419;2.6486433406951226];
IW1_1 = [0.13303716372659036 0.29406393197442654 0.80774614001081502 -1.4604902608685251 -3.3469414228974732 0.84028740635859123 -0.033958779398751485 -0.99677670495223281;-3.0806125599912479 -0.76136884869441146 0.028761998417386362 0.53415323819910543 -0.038598738984652901 2.5688158984889462 0.847761883334891 2.5075068172002424;-3.922333987338479 -0.72708965978938589 0.59776799486237653 0.93650143970726674 -3.3977839415905335 2.1465663122804757 0.55309885258008018 -1.6368682368154919;-1.2569170563707437 0.98559837773933301 0.4046946219508944 -0.17254398240257129 -1.8022324662370797 0.21575596457425528 1.1663131169619163 1.6918653852100971;0.52111504470620873 1.6361234986136559 1.5751516444785927 -1.1705274911876022 1.8526254001275846 0.22282966068155718 -3.7204283650579986 -2.2504053646847333;-0.10555895110975552 -0.078901163580996261 -0.4340261315125562 0.2724969220259269 -0.46732163861126053 0.31300411738773604 2.0301358345805292 -0.95196185062182803;1.596109075870298 -0.27332019316058825 -1.1446173669447404 -0.20950927991934848 0.46043556742360869 -1.3316247088444606 0.14514462733908468 1.7506515272451439;0.24126605683818053 0.70094376870231401 0.077487359829033181 -0.71382032124254335 -1.2695880125905383 -0.22186308671821062 1.4606927583439431 1.3443505911708467;-0.48659816133851569 1.8863714884058496 -0.76583936571939626 1.7860074509039254 0.19120082554516346 2.4943019798218931 -1.3968146080561727 1.7835133851251961;0.62094595004750319 -0.039652306743267252 0.44292355760913726 -0.48270396390285891 3.4948190388450184 1.7629909765442322 -1.1467555437083252 1.2929462669066092;2.3341967751923227 0.22561948632642956 0.14287929373501049 -0.45322263342348079 3.5168936681745557 2.6629996954485606 -2.1166231861474385 1.7272741698666314;2.905723477419309 0.37001470834554706 -1.002765221684357 0.66198579410020619 1.76876268519809 -0.27650046546903756 -0.83391909584512591 -0.69910220191286021;0.52911270691281498 2.808948800971558 -1.5144726077939121 0.088483999859798976 1.4542157872886829 0.53300463734469283 -0.46679820548654111 3.3628438405961432;0.45911572697413222 -2.2240083235135635 -0.80678710862915204 1.363030730211122 4.7976770409212603 1.8110843115259703 -1.0421204631859979 -0.38411909912520115;-1.8239541015708833 -0.63660087852715463 1.7024888983225552 0.13850183790389492 -1.5779526275641653 -0.96114634920492281 1.0358131155733883 0.69887610644763409;0.61600105270376715 -0.27214434594912029 -0.68425116525805529 0.021728059086158619 -0.42478804835366824 -0.5957663966617962 0.19287785035333868 0.099773255555959769;-0.95448873683705771 -0.94592671195094835 1.5258310960976413 -1.1604575017373566 1.3261701003471313 1.1398981246761333 3.6102895823693686 -2.259592145109143;-0.20380601714949137 -0.4982776830252596 0.70577638324182523 -0.47401002171865647 -0.54580467243676467 0.11676233977097264 2.1121414262664957 4.33095655583113;-0.82805159428817265 0.23084743501942279 -0.65805539053924333 -0.37303181603131819 2.9689272275172041 -1.6094850649695065 -1.8767229109625221 -0.18509068576883445;0.63335383173663051 1.7795964931617665 0.91570133105011564 -0.13256360478026069 0.48070010818395165 -0.77417505152037869 1.1209827629512981 -0.56055347204036343;-0.4984084580924823 -1.3383437570020604 -0.25397023311525335 -0.30501020170762932 -0.31963810513517582 -1.4935963904147858 -0.72328712331615963 1.3251994608888205;0.15367720009641805 0.37649487097883028 0.14593372212443517 -1.3693106196915124 -0.80534451098701809 -0.33817811596828123 -0.030155466426910613 -1.6452486053813569;0.85343893875298082 -3.1466832828102924 0.40038797037203094 -0.42696635481024187 -4.5993406852741625 -1.6715914251358717 -1.604727839163433 1.80798726621202;-0.28485793963202705 -0.84126612256637157 0.021370837971399655 -0.010962722715620713 -4.6560566639469929 -0.22917334457524027 -0.42138349859538426 1.2902613276231769;-2.0673501567193653 0.84797101233574435 1.301807267562199 -0.14371882506803374 -2.3330046999548539 -0.083641255450429844 -0.56158007578151203 0.86233346169338854;-0.18973806811564767 0.051598824631713405 0.45518729909969946 0.0081684206963191126 -4.0827576247251178 0.75696604142494484 0.29468592279902289 0.45426762359173661;-0.42068155301770538 -0.98760291845680193 -1.6467306814088691 -0.22051330835653843 2.6444866648800951 2.9326226284581662 0.97151061579410791 -1.3234678320383053;-0.38257813004858038 -1.6548336399310581 1.3346072346594997 0.67824320275994276 -0.99865082298706609 1.2312801585199484 -0.72340956756758934 -0.55606024206209614;-0.15181744765980121 3.5474296098017999 0.14958341065376107 1.0132763337588258 4.5120947751745089 -2.1116586900235057 2.375212181980956 -2.3900618410397207;-0.5720410241518431 3.4541947248335081 -0.045434815433139319 1.9249063658627712 0.19729831176889856 0.43032053993705066 0.66664550624194652 -0.89929764402168111;-1.1927244756519317 0.68424324543475723 -0.53039423537718322 -2.0370226819872261 -1.2675488687237131 0.073028225113817513 -0.088067596340182686 -0.56057983678411405;1.2320261429894617 0.58746917144386002 -0.27150406687001555 0.85556158725487685 4.9024771515785401 -0.8009518699354613 1.8326630470739254 -1.7060471946100655;0.18361445952124308 -0.42466518534894759 -0.3323370043972575 0.10956616840738678 1.2375298187380492 -0.55102110514088332 0.056831138980433467 -0.07659039491310525;0.50847672882467609 1.3658215668616054 0.28473283537372396 0.03605119845673492 2.795143979415792 2.1859022870124432 -0.37292181052969858 0.25746465515188399;-1.0677900314044999 -0.26164596508964577 0.25411700355544131 1.2975529807646164 3.427613590246867 -2.6457283229928361 -0.23339802273839622 -0.0073253885331938662;1.0724232442081434 -0.52126652607483004 -0.73318912755872756 -2.5414646200665758 -3.4162437565959074 2.6680923217810939 0.25261915718617944 -0.37425817831246855;-1.3770369400309952 -4.3432721735764011 -1.6277068106147343 -0.46094867899426045 1.3018761711016127 4.0377759211566921 -4.3777449489322509 1.2593841846378218;-0.64889913020828538 -0.44410607067670949 0.31788914699989496 -0.65911695321567021 -5.9865950572861255 0.94413744395646437 -1.3560911394797428 1.2294332291506551;-1.4227489417461647 -1.9845204308289759 -2.1751761511058016 2.6352261517419153 -0.35361206810844437 0.23979410779952076 -0.42310462439483471 0.68548760015376631;0.88206691084397781 -0.51064326848508279 0.40583387661595177 -1.27719900219439 1.5174892546489476 -0.62575873043312502 -0.7626865427073376 0.6532924838808728];

% Layer 2
b2 = -1.0374843933203592;
LW2_1 = [-0.08100944649076601 0.020240262370635486 0.25999603116646502 0.089409883253901562 0.0034788096164029472 0.0052965905350434214 0.075799766465640017 0.063051213909844347 0.011708648374215612 -0.054190002522233764 0.020725190954137721 0.02542551579893006 0.016732675178303773 0.048906033387138718 0.0037636528596135866 -0.59906406565870429 -0.017088196772838828 -0.024467744509580964 0.062621341751811749 0.10278786271183611 0.18429770084658789 0.094648934976015314 -0.018088092308769874 -0.27318940013830612 -0.071101927553862077 0.40210014245772197 -0.026017877447754956 -0.073515049338501837 0.02909391146295771 -0.0099283319810906604 -2.479983774285377 0.12747513943733929 1.1094425303489621 0.10478460585168006 -0.30144440388427651 -0.22035226142701705 0.0093932878506405183 0.24370759127888433 -0.0057235695992383512 -0.39940104175879143];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00115315130997576;
y1_step1.xoffset = 678.286531932822;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
