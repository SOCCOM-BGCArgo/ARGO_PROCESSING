function [Y,Xf,Af] = ESPER_phosphate_12_Other_2(X,~,~)
%ESPER_PHOSPHATE_12_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_12_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.0475319790109134388;-4.6295355628452856678;1.9629004261774805062;-0.18635944678412533215;0.61788952189133150572;-3.2375977775641193723;-1.3802793766025429623;0.13576943459021503791;15.867851592595469512;-0.84110920774189612548;-0.25473808513671697407;0.0076974616664634617352;-0.69578675990644833771;-3.0161602365762996136;-1.44436013457296486;0.34260817758064521232;-1.8626310802798002886;4.3916093843966876875;-2.3741135847482794929;4.1641213964242549395];
IW1_1 = [0.3173209969421964538 0.85555831908646684525 -1.0823003851028718536 0.33477296315327148557 -1.2575104892190442918 0.34072335660410574265;-0.57887145683487106762 0.18219942782076095633 1.1297683117731851521 -1.3200758104839647178 -2.8623649373915998062 -1.1188688227246128548;-0.38760105823797086355 0.37875732597884220754 -0.39246316438873052324 1.8330943268899273502 -0.80867867541363402939 -0.50232068757716219487;0.65336397859747763484 0.11575646616036834591 -1.033171237796713493 0.3422940615098541417 -0.49685300399553866679 0.44913618496669344138;-0.23026185813181040962 -0.39454379844677589517 1.5173197251298531363 -0.38640928687929054774 0.90687428781761991736 -0.94586916261546549745;-0.35374262909821319045 -0.11590879285128539988 -0.14714646118572516365 -2.5543499908780722407 -0.95963284480322674774 0.49061080454923222671;1.6140298542576183571 0.51427692322793427948 4.6210930824163467534 0.49179520650544894522 -2.2962938505379808518 1.3152286407393678491;0.66161665291946014644 -0.0031963150141763266993 -0.84117371036309751542 0.27408976293551057246 -2.132599666661214588 0.49762549402167355339;0.027405395192336094029 -0.05466150500659169853 0.30292167577751566432 10.900997820734554367 -0.66461959282347582434 5.9582962822825562554;0.13906602933436512659 0.073236205893471559292 1.8460829469569677297 -0.55471258238285403586 1.8118581707924446 -2.0281475721026884784;-0.66458720924100855854 -0.29060281114447594764 0.47082839520340247219 0.099994684393434965508 -3.1770753917074028294 0.68807163514351632472;-0.58103978946049594789 -0.29657721847109780322 0.89746810991402958813 -0.080024888939748545225 0.63777507569331093329 -0.043171455639110192792;0.33444643124985207194 -0.088644231992670421971 1.3904265682480518862 -0.29411896529191927652 -0.69089214038308166543 -1.3965195838641402126;-0.32813615585469618763 -0.66341937147651697249 -3.1498472877435745865 -1.8402402307006180404 2.6307371291353622844 -1.6003982340094311532;0.0063576070092963288261 -0.10136686322095098123 4.1367243256941685914 -0.13655431052632133193 -2.769973054165217885 -0.98089887582234236429;0.72864573905389706798 0.88377349980093766746 -3.9295010441493700704 0.52188718487849550254 2.3194801010889327664 -1.4490679931721133222;-1.6207922105342515984 0.13511788231528354398 0.77365285639502645587 -0.45813340867427976288 -3.3403434959457842801 -0.51387578853439641602;1.3376260824670698213 0.19418656192646985281 0.3777476119945850086 3.780705788949804802 1.4002125335770698733 -1.2562548068764745057;0.13877999808943675131 -1.6737647047281292156 0.44102924214058369934 -1.4401026490510955291 1.9843367245881549099 0.088112235826481449807;0.59341403675727488753 0.3409394491344031608 -0.27867791707995814843 0.94696244150132669049 -2.2358000593464359973 2.8732501050217900129];

% Layer 2
b2 = [1.671769347538116568;6.5673098870559991624;1.7660400546494328111;2.5317452584484918532;3.225854724364246362;1.5446309971559337715;-0.41777286024781035145;-15.709388389200700686;4.9990394446237562676;-5.1705400640282297431;-6.3940921657996732108;-11.296800605525918471;-2.7355616049578168614;-0.15515818946476428453;-0.47364235577612323613;-0.2413947607851361643;3.2909348463853342892;0.34461841341407972727;8.1341792689926570858;-0.21814891772007422022];
LW2_1 = [-1.4907541939435882128 1.0614506640153835715 -0.47940862759681279748 -0.10426209412483453121 -1.3864669549866317499 -2.3061970929470811953 -0.21190468958878905248 2.4160128109135059482 0.16307274926519907399 0.87307413469122663319 -1.5074205557149782386 2.6510192242185661726 -1.4714202554168389625 -0.098927929731867259022 -0.52804818489043769958 -0.015651756163564945618 0.78732053610559959989 -0.30183588908094904912 1.1393714734260615984 0.37526842144979322136;3.9635743439688120304 2.0944519841777351488 -4.3943786514842431146 2.4319442966139823703 6.1045108268223069459 1.4753151651341636086 -2.610793185004289807 -3.3191867041021754225 3.0837447935029747015 -6.0866053139999971577 -0.18401150100125671094 -0.80143268830573233252 -1.152554355661782548 2.5507010242970404867 7.6812802060743523569 3.2556466144834983467 -0.011388175229707038494 3.6026158626610644831 -1.3404971882671685712 -1.0812240149181615578;0.70272362244986630309 -1.1155188598059235794 0.35536892987441892622 2.5777128338656813966 0.99737584500130593845 3.2540753285409103057 0.47434925313902565058 -0.36545974146710435981 0.092131670803235352074 0.059104820738171921779 1.0152347648180952699 0.43137263224679306406 0.13317403372908179215 -0.25791028541191829415 -0.88946048883336981117 -0.036995200196006133853 0.46788607563426926061 1.3332036461295801999 0.34276384415093474889 -1.177525586713799699;0.03956679412098448867 2.0015248048599563191 -0.75822496654431337237 2.3982098813058283504 1.9887949993848414998 -2.3008067616935701238 0.69295880698109257878 -0.48347236614474659033 0.32997554510602949973 5.6064959289047759938 -0.02499119109702494998 -1.2543239710351838934 -8.0793081408815652367 1.9086849702253165795 1.283752255190818925 -0.41830882938639968316 -0.079631857097236802279 -0.65367594747342161465 0.73728086849108065426 1.7543119417247599046;0.73672222409511656238 -2.1218288031744902966 -2.6911028338032951801 7.3441717121580829541 6.1565908439050156531 -1.6374626619550418649 -0.31189672616321573173 -2.8578441711329714003 -0.044618394670657590684 -2.1074397891358169765 1.0140552820795865063 -4.8340606779667369963 0.92696518942243499861 -0.88341463620499594001 -0.10014149263341667884 0.31824966340381560803 0.3018759326035298507 0.10042498744139545519 -1.2006099674894565865 -2.4149923622363282938;0.39856955133576993378 -0.19609078774004964907 -0.52671189045789468253 -2.8516700538059334136 -0.37937326842565360918 -4.2475547229932821836 -0.41587038033580503438 0.79542703798123570724 -1.4899543467300253585 -1.6661475015564997104 1.2089597031381991155 -1.9174158817767106289 1.9219558548427182476 -0.063394283748148233526 -0.39206781223015829685 -0.36097041326954409923 0.21625740191823511482 -0.58356124006524390246 0.096665591553624002907 -1.7823921629098125052;-1.8185015292322843639 2.3242303710015961293 -0.3266811463275571259 -2.336442379715879536 -1.9590657873475254558 -6.7399270519627183518 -0.047546755282680576438 1.6448277859170747917 -0.17884993540828333924 -0.64052348213564724855 0.57478686753239938145 -1.9775316595113117124 0.23542372039734421607 -0.22799556164145001746 0.055417533195369822474 0.2949847412807027891 0.90988403721340571639 -1.3664057544561485358 0.13321451169752690502 -1.3673025688038022984;-0.032348267820424769781 -13.657657698306154614 -0.88232105497158108687 0.44742252688031458607 0.17633395509843324822 0.94047178654215091154 -0.034481878635706626757 -0.98800981321103453769 0.059380204187253246562 -0.32626041208451067588 1.4617461955912365301 -2.3451357954752043433 0.6178942256481769757 0.02976073017098182158 -0.38024150482576912768 0.54312060766542158419 -0.72844082302151735853 0.028059694907594190383 -0.67600679749314662725 0.59583622478652475962;-7.4350496510116439453 2.6488463216274382717 1.7213272053975707809 -5.6264774492723432786 -9.3395268041660077785 1.8220223863677293963 3.2072424090063527125 5.2849033493845212206 1.5917658931733165151 6.2995535945402210132 -3.2922828104130013038 5.4095527917330779033 2.8399929186854113716 -7.5372296066367221457 -0.84500575821400969456 8.1216623825436382589 0.95850089629054568974 1.9213745890696887209 -1.5102043129502618068 3.4773015415727721589;0.2290975082714665767 -1.5547583382827614429 -3.148969308917784371 -1.1597002455670426535 0.17074084139520626091 -5.1105113259155432459 1.5844180677182113648 -2.4657433790388707529 -0.72263534606656509851 -3.2926784462062559378 4.4175927337648168702 -7.0706022664698924274 2.5787845677216307827 0.32926050664835626591 0.69967597510064716282 2.3323671263134544418 -1.1038700602793301009 -1.5335898799131206793 -1.4961213488415410211 -0.0089138448817357319315;-3.6173084051795685312 -1.9019309467078420184 2.7666577949210342524 -4.8529887588390110409 -5.7213506359867869477 -7.3261845125289193348 -0.22712193820717535564 3.7091241932925016478 -0.55061745956677277114 -0.22168331142013936175 0.66099124524357910637 -0.79743633029375404764 2.0780973959553854513 0.61524850272871800527 -0.83445551027778552822 0.57899131254117153222 0.41416685419890608699 -2.2812040889512070763 0.80877507151905048133 -0.39188777563458515596;1.5627224793724114882 -14.649017021347507495 -0.11694316939809558387 5.1764990459875486195 3.9751121427276987497 2.7933958388860427036 -0.03885885216626449451 -3.7319135832826164645 -0.024061552269653039421 -1.1193623012817739415 3.4249861819892695181 -4.0359736996742263671 0.78762016094894604645 0.03941275862438720079 0.40689060414601341265 2.4022761551714411077 0.34026409550538128101 1.5477741034030569889 0.18737239531243590762 -3.563768408777582497;-0.68168988890725112917 -3.6553881730622177493 -1.3952545324058596155 -3.0248676582864786333 -0.3855571931730041868 0.94668732871604777124 -0.67629689403501480616 -0.49237169435985861377 -0.094688674977325346105 -1.8791563805045075064 0.52420039892449277197 -4.780112731391891856 1.267417446771735845 -1.6124952997394714771 1.5839902128297407291 -0.41849210315398094329 -0.15236768411541162793 0.46019518779155593746 -1.2853589683098589624 -2.9051028816143360523;1.3067036855582125909 0.41019495661683597065 0.6753944317878403103 1.3726412285483238218 1.945885341705333893 -0.20204587348478925124 0.035708032932790984004 -0.63627497028960011693 -0.13174682361445927414 0.12636246492711725176 -0.47922651805719346241 0.58381321230564553471 0.33786786306413896241 -0.28443996340245103482 0.32380286031332483621 -0.27723095409119191679 -0.14486310185103604131 -0.13096207293289538476 0.26051280156381606545 -0.55990142782181318015;0.060688681822297405044 0.4302319468146154624 0.40202654215645827751 -0.30946718626881219993 -0.068657233200111605909 -1.8591933493774419617 -0.03827716109125325894 0.5701493169245444026 0.081261885838213490652 -0.85303405222224437665 -0.66161821856661418018 1.4702568324481448681 0.38294229035584481657 0.42709237925264126323 -0.36656602149918510181 0.13404304908587585943 0.59085948780099706301 -0.38607513950635069522 0.23633299639227278721 0.27243716404575896162;0.13135766385785963006 -2.0763306990573009436 0.50831005066912160473 3.2170337361022016687 0.54646420091726288781 5.336540369625656588 0.10034960720441084281 -2.0652721396958866329 0.34682827820054629164 0.52860144130079600444 0.53463363390927287622 0.46634414868502510609 0.019546391919246227514 0.29010900064989392222 0.3933213259826732755 0.18482663180181946316 -0.51007380033649618589 1.2002091119013804654 -0.38999855765173485622 1.0838420562789565782;0.063510273477017584187 -2.2438823959081823922 1.638249457744384463 -0.029164478247109125453 3.5661229517009171985 3.980628625965187517 0.5862067672654426298 1.8671587233540398731 -0.85999576543525590999 1.0831446639912079011 2.2255636938045126882 -6.8471198847887997374 -3.6973960965298879877 1.9326567484267014319 3.0876874399017268935 0.09667451872315248329 1.3930579520482646583 2.3236299325043119346 0.40128468237540837471 -0.94153187798953230647;-1.3036231427917828185 -0.73997671011067789326 -1.0662638886818140982 -1.0700567246822008105 -1.8170381132003039504 0.57072954106489293125 -0.065074172838726018764 0.68634168677266171876 0.13996146651447835541 0.29327559063619706992 0.57701104478934950315 -0.59832636485693224682 -0.6754881542856810972 0.091666020440202916619 -0.19149833256361059597 0.28295097320454926093 0.066801125922145127012 0.24957726692997186935 -0.40452496397085585533 0.46668769395207343464;2.8804701168125155242 -2.067780692624512362 -1.5783695138373610156 5.5879382697739519159 4.6208477090265498433 14.262953140795913143 0.16366801931581601015 -5.482845507337119173 0.19705830405921365145 -1.863748062764808866 0.51987738079556955473 -1.2211155026375328791 1.2868575981644110318 -1.1194044725999914291 0.72935332658424356644 -0.69105771015758765685 -0.42380868056998405313 4.4948070472267662723 -0.62915862717595394393 -0.9062748841180395809;0.90423341455967842784 -1.8560971836759656561 0.27211615499007640873 -4.8130008352756803447 0.46748257583487839995 -0.64489665922081973459 0.21017039798531492178 3.1466405218027029278 -0.75399838074520431075 -1.4492877909689163562 2.18296471135441017 -3.8643160593511112211 2.5509709569431313625 0.5322741914868381885 0.29712954147209880151 0.30597922662660198556 0.40726174502631740104 -0.11143002906878574088 -0.27871666118845933591 -1.0342795748543889278];

% Layer 3
b3 = -5.7295486970294033924;
LW3_2 = [-1.2713615741661052905 0.23263333797134447267 0.86250963306142025555 0.31074402840017489869 -0.64216619511812733645 -1.4675577419956107317 -0.80896398005884084803 2.3522357610710602493 8.2113880383092769932 -0.34995302771001018938 -0.58457377240013874697 -0.36697565175131230397 0.36146759219341012548 4.7846986062032081932 2.1610090966948338753 -1.7368777369765071583 -0.1759547183999744524 5.3396272408711293878 -0.52115937640542098208 0.44918847983134629898];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
