function [Y,Xf,Af] = ESPER_oxygen_15_Atl_2(X,~,~)
%ESPER_OXYGEN_15_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:49.
% 
% [Y] = ESPER_oxygen_15_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.28];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0470499670650231];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.009037817546443172;4.0516118269239083105;-3.2915527221164744276;1.0331853986113641586;-2.0311415919351509807;3.3853368143393200995;-2.480296927870562218;-1.7944618797018898615;-3.5682061152132105164;-0.26715100846003686508;-1.1487106619747009528;-1.3140429514344760253;1.0274885926022880867;-0.65233193304751169173;-1.2801530850157731845;3.6380840992667362599;-2.1002415199528012835;2.6318237167198050841;0.60456571861362040643;3.7022095989750880562];
IW1_1 = [1.6019333075523214394 0.35765254095967990988 1.6332755001312617704 0.7409182517952183078 0.14759624864030504443 2.0019737599652795978;-5.9181499326888200585 4.373689593272347409 1.3662581934611799372 0.35591983848378522248 2.5625778364762719086 -0.39006684442835504179;-0.056196575949920335447 -0.031646169327580540853 0.17120248020799949673 0.017057054927892938145 4.2998575792836399856 1.0642296289413073485;-1.7031214766282274375 -0.66144211136055575118 -1.8253185851879845103 -0.11132179267374864295 0.12300878947171757505 2.3475047902862802296;1.2910566902281663815 0.61090020588121429768 1.4839104576649810863 0.48395778558970797834 1.924645620871787477 -1.8599755394840409295;-0.32539735948005837907 0.49924852765377114583 -0.27933456387943889077 1.9498029915052514927 -0.53829115974181795945 0.64594622496643583354;-0.098039854862456379814 -0.015496474526357245649 -1.2292177876340886211 -3.2389554790643435567 -0.45711586076028731807 -1.9831068235369120334;-1.4805521594588919587 0.58480737209263189413 -1.0861589321763118754 -1.6773338049593260468 3.3684877072741321591 -0.23842713705533472024;1.2406327720647492008 -1.2252969130477568971 -0.91336150033639140755 -0.18688195919920394528 2.27670833194311939 -1.2869047870264487266;-0.01784537207571686851 -1.6877390080733933875 -0.71184604288572606023 -0.39997413840011719621 -3.3622249849175664949 0.73489541673809732902;0.72710307062624834895 -1.4358690847463893014 -1.6658088243777908755 -0.76142482860214055762 0.83911588393111014028 1.2287844219273205137;-4.0836039279803673097 2.387780316510814238 7.9953190163285192682 -0.16848460600208978177 -1.7708901635999967361 -2.0897996217753820325;1.0649874751005699025 1.5123156576164205056 1.32036100388293276 -0.47507639770108245347 1.0570550411112409339 0.42320200226004461852;-0.34764026277263176956 1.645480179381579422 0.47944980853605978499 0.8232037074341446159 4.3086525237323254345 0.14888514857758833321;-0.68387507141244008313 -0.75280912760448015497 3.8722228813317460805 1.1427166068980187941 0.20737038727333848009 -0.039576843782820246564;-0.53672568696207145766 0.41431396049283691907 -1.1213277128113461334 3.3637000127005527439 -0.43894784592528568457 0.75031965861926630534;-1.1874245194698045403 1.6101709721575672152 -0.61196529734900495523 -1.1041437476769375703 0.56711935151961045953 1.3912075717131531238;1.0323350955648380456 -1.6824005548606277838 1.3408967934881859119 0.22389552592648692686 -1.062240469257700104 1.658863620718965981;-0.0021098375922790398723 -0.27021325356343250945 1.7006193994039073836 -0.14349343772440470435 2.1972700212409690401 -0.67761219854911824978;4.3070003967718601956 -0.040263366763974080265 1.6246363751993375679 1.1492248224884389352 0.3497041696605807104 -1.3006582751696003086];

% Layer 2
b2 = [-2.7251191187552756823;-0.94887373425047094599;0.91082591478406949026;-1.1406409855848516077;2.5935912953576423234;-0.83240475719772166752;0.35973197920331140276;1.3212830135262252362;0.0080497741898610409433;-0.096184504809291887506;-0.0082260274231792038235;1.6338530536033484264;1.2687032561788991192;0.49919106142351005184;-1.1888794140400016364;-0.89797559726325437701;1.4045995606873349359;1.9039123420665260422;-3.2848707609905622995;-0.37154035519779315955];
LW2_1 = [0.88855988606217783943 0.8720822048984397945 -0.52729297821443354977 -1.3977775196718742468 -2.1177106682938298121 -0.39561694072338410288 -0.045565259769502701459 0.048622465769172035222 -0.48499447744931051263 -2.2543398476886387094 -2.2119460120868499331 0.31282693135075162472 0.55701358439753401175 0.58115458085437032842 -2.340258603381785818 0.18284736557834144199 -0.33833985112198822209 0.58520614515870672534 -0.67822714841578490841 -1.9609744464633924732;1.0258620153278517062 -0.81678475670204786496 2.3433501141621220221 -1.3963450968435902055 -1.5297065906100080213 -3.0277778288354100233 -0.37293642524586645415 -1.3382976874393921474 0.91059205408846821683 -0.55623391861036386441 -0.90253423303182267468 -1.3789477891104220397 1.8062255131915643247 -0.83236398048479265377 -0.65053655773425322906 -1.0307864665701185203 -1.6023709460242117064 -0.7023954280069172329 0.34770897593066441011 0.3300441371382533684;-0.052076737636955944266 -0.23012524153038749208 1.260093057686993312 1.2586040891201564218 0.51472458467599335741 2.4454537189436718059 1.7171898709009121298 1.3697354813812152585 0.55037321856693721678 0.4067227860712708809 -0.97889646400077834354 -0.30466208339987410625 0.80673591543675404747 1.5459500929305014516 -0.9000003435364296589 -0.21512615761054437735 0.33715831222657183242 0.17965671381132328199 -0.1904218244939009097 0.29820882280785904195;-0.91767273363564627608 1.0967224294773567639 0.10437407254016053959 -0.39004612165193647266 0.065019839495371642424 -0.65434646673900909164 0.019244974910097155385 0.57983441310489436393 -0.20335482503980106816 -2.164565546919115846 0.64182063051543292165 0.79133430164435625276 0.10986406910423301975 -1.5929614624833834391 -0.33288648712086865711 0.56229720580780984118 -0.77475993331504711126 -0.79197772689921908107 -1.9882798188125112571 -0.0077412167325121884753;-0.79712674305805464314 -0.41130426199600422787 4.5608781108951044203 0.2166021877160557163 -0.037430750169156985774 -1.7815303409025828874 1.3024261280241233862 -1.7618130803309559607 0.63565303280663532082 -4.1068147093300613193 -1.811467323988939615 0.19707032760207227051 -0.26732313686492031879 -1.2287305997923401168 1.1445498061454033589 5.0421516750785970729 -0.23475098358296681011 -0.82421529009043703606 1.583925686856505477 2.7072034584997943796;-0.47719671242594796645 -0.246134147238174672 0.90168637235010273834 0.28862813365426620571 2.4343515402709523521 1.1560197027537677528 -0.27877109889756412908 -0.86258296966297376418 0.93021900607818019946 0.62331411311784923335 -1.6848965402196087737 0.50225055446127553349 -1.6109774832387062649 -1.1279908793620345708 -2.1650305144154748938 -0.34896651480771961884 0.60420615244249709086 0.32479490475888245227 0.60954847371829568026 -0.32310177571373027705;-0.1285120238495053302 0.65631581292705998276 0.83005003721514902804 -0.5514549869852656272 0.40193622686783903042 0.27206397639575802261 0.63810029067509788092 -0.42418828922663476266 0.059683490797415084117 -0.31779737358068388398 -0.33665464511060722019 -0.49189282771225273372 -0.35270081646319090263 -0.85521043466090995722 0.54784482298775416531 0.60869304702097160042 -0.71824848222276616028 -0.37863230173432782522 0.83639870234704072338 0.33180079217559110827;0.4262309430873257865 -0.076393664482938633542 -3.2179292469955829148 -0.84574916693801471812 -1.6867786395502306629 -1.5963613249503849634 -0.81042146212285259832 -0.2840145950098320049 -0.22282457485730683411 2.2089144876590776079 0.84603364256971602675 -0.19522376429674781484 0.59923393801628943578 1.4526349334751815778 -0.16184854960051253681 0.16535694178010809652 0.62261436744135978394 0.41297003320928277192 -0.62385191802224659874 -1.2947829140309863316;0.77510810898115345413 -0.61138303046646846894 -1.0977199902372827278 2.5211893989185765186 2.0395999012161349917 -0.59108378500889069418 -1.292955165652689864 0.42691710870129179201 -0.45737331300540090551 0.020823698637738287387 -0.042395763342248621308 1.1144330114686991084 1.348964599420501953 -1.7227155873523853913 1.4960465518243659666 -1.2831002234768240644 0.11009245359005581655 0.63082556820630075745 -0.43106758030602942977 0.64839308850373345017;0.59271618231543121702 1.0795566153496891637 1.3502619239868658418 0.75697228115994152908 1.5550703805056771412 2.6896087137532935785 -0.55089420486997331405 -0.36795299710635986923 1.8310959832519422275 -0.75580035993336602829 1.8495823831182875985 -0.91374738835542190785 -1.0741657025288737781 2.3664126785235897188 0.78004742463130005703 -0.30817640164055176699 -0.66128701564957759196 -0.5549533445081513694 -1.4660765689191441741 -1.3222186907168573811;-0.48658537822780945081 -1.7579231336828298193 3.9254860266564404192 1.5224986392380723821 3.7336213291948552317 -1.0652547178852811438 0.1625451143362934836 1.1741783463893180617 0.068626809285314671616 -1.411824144600180464 0.71179472761522810664 0.081346387995965108164 -1.2067995783653595598 0.2314619641041922582 1.4469595071048886314 0.755251859076241705 -1.4040027795750325001 1.0060559795479735445 -0.064306550784311203306 -0.26704132912097350294;-0.080427077879129282856 1.0034169502618528469 0.44048050089671209051 0.12348177780093494427 0.23339348019721820049 -0.32516686608099815148 0.18844803932360532084 -0.82807944328970140013 -0.098272495366754100687 0.51052191305784078157 -0.16066168976291125836 -1.6159055574245673181 -0.9258797821550759366 -0.016854581826396989458 0.70720089330883606493 -0.18975815365846090965 -0.35668370735582100028 -0.004890952053631937059 0.67993834755682547311 0.95319196575124964799;-0.41494176631214668705 -0.19917764429508200141 -0.086061945205002141068 0.93878064734896038424 1.5052247826955864607 0.15336015940977537619 0.62332454657669189579 -0.8028356285954760807 -0.23353985387402387275 0.56827789877074763591 0.15363309840163116848 0.065727089740237332194 -0.85720125192649343493 0.47195974285184055796 -1.2785154251981656337 0.78515862232028987844 0.12133569508669826698 0.83661578836762040545 0.68664759708814093742 -1.6578743161181395127;-0.59055178922876450098 -0.35419024469753562778 1.1915551095668688308 0.94335636481894225014 1.5696556803466630292 -0.80557049666613145256 0.22016791725552231629 -0.50667715987519712506 0.023930616675983291952 -0.9813232031788468035 -0.37527113076153051363 -0.20516673539242138991 -1.1853375814200404204 0.53732092790213781264 -1.6391395036856573064 1.1567989007244419142 -0.92999514889251544414 -0.45499695490756902894 1.3184012361134258562 -1.40002560459227543;-0.065380762311090051542 -1.8501362020409304332 -0.18839314024946618442 0.018307820031475987438 -1.6648487369737889896 -1.3818927789312913657 -0.64813185616671997735 0.15030523252958435942 -1.0193020820525033887 -2.2279502992917512572 2.1130299422834997181 2.3713503677249492263 0.62590322336464576658 0.31687321627867198748 1.8887009915129762128 -0.039947089567844824842 0.015221842414741877311 0.040745576031549567142 -0.47800505678767668538 0.23715872131116022548;-0.44464861693301416246 0.48710861609471656219 1.4064236568222625579 -0.40053594050251939418 -0.83996294280661354392 -0.12585295122256981437 0.46007551999101359286 0.77419990245795433648 0.76296883545897808965 -0.9729944585286228742 -2.160722369565620582 -0.91947657950397365667 -0.17106266681691040255 0.86761310375602884726 -0.44445014323992254601 -0.0095223972145033457942 1.0708561847932065447 -0.81511879366639294897 0.43615337937679171665 2.67414785931090071;-0.49154706336061471106 -0.0084467976049750967404 -1.5563286127303292972 1.0110941939356219432 1.3181607958699435024 -0.090001513931675242164 -0.3000621366466513229 -0.34074877063988651127 -0.92039767209072143039 -0.98262382843488871309 -0.37983479031581579566 -2.8680349184077100766 -0.24545963812610283039 0.27822084515071243693 3.5521498875298744835 0.18116740345156268077 -0.89737193684027227736 -0.064664569808044303212 0.045872330035271927096 -1.5056979377023873568;0.31983096550776024536 -0.5908854636714655495 1.18842992884560128 1.0272853128335208694 -0.37324151655127146832 0.56258003164527103923 -0.42372752884223785497 -0.33410590724076610902 1.6207491581529605007 0.43068653878032348015 -1.3178239653916912211 1.3921062284214456017 0.51645649123173853479 -0.2010654058669346933 -1.2025436723296112351 -0.7239486290251103684 1.0641268294338190881 0.59515625288379980784 -1.1216175456942576449 0.46496699737790869733;0.52055471675038311741 1.2491453192464880839 -0.46789110684980067534 0.11317581153552191964 0.03980022557284353113 0.78036415106292800203 0.38602534927970566514 -0.4053455421679093007 -1.6065826338533579776 -0.34763383689898053053 -1.9774298137302064315 0.18759015250659807905 -0.36400733775127069869 -0.10248448929588646616 -3.3144275067216795172 0.30990656654982851048 0.71427178087574727527 1.9123032457724502553 -0.051048002981394627331 -0.85626523850307223462;0.11691609014765623475 0.84648570190705652028 -1.6721817485584571372 -0.87279439692965787856 -1.9531129552131332172 -0.97142534424415993843 -0.24138397939546304971 -0.81896333369096130372 0.25454964246818106988 0.92215421796277796673 0.21523138420465834364 0.69787774577374050988 0.47353001638604913515 0.30213680752886173941 -0.90620582968911189692 0.1599864198329853382 0.0072329814719839218701 0.41434666730812752533 0.53481842328603568237 -0.40985527814865502227];

% Layer 3
b3 = -1.3649587369661926317;
LW3_2 = [0.28717499635087645471 0.062490228898250475831 -0.31868596003936400241 0.37507028851907009415 0.3898348503276168886 -0.25385152031328223066 0.7221806569238121698 0.86629819559386112005 0.1618217083175893245 -0.084712469499810080786 -0.11923408121954318095 0.73121199300922146147 0.76866245635520102919 -0.49454183531510270688 0.08858080321940015045 0.43073682602866003588 0.34767222553860938072 0.33034883902096090491 -0.1899462655266002109 -0.47883282075554128854];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00368391969055075;
y1_step1.xoffset = 13.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
