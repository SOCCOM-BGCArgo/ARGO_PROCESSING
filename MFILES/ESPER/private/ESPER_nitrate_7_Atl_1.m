function [Y,Xf,Af] = ESPER_nitrate_7_Atl_1(X,~,~)
%ESPER_NITRATE_7_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:34.
% 
% [Y] = ESPER_nitrate_7_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-1.99149636107278;-177.232103709389];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0604107502911417;0.00425400504498441];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7980319652313832002;5.2249858076442299293;-1.8438389822931049444;-4.1080881108231110943;3.3855021970746026483;4.4752041847357411086;-3.9834453748210485458;-0.7429081536671189312;-4.4394075108149051445;0.091490497208504523163;-1.6191287066531694361;0.51684124824118893304;8.6544278186922269924;-5.6590611554735321675;-0.67353887770050224759;-1.0513502830451271208;-0.98251107538343562808;5.0061861195382002521;8.8895439916982326167;1.4853030687706454405;4.8491876348446467659;0.33953103426060887715;1.2382372587101306838;2.5142435318106661768;2.020618990709455165;4.0685404765691695061;-0.1479580799780828293;-0.78555470076414590785;2.7984802790772795866;-3.6326702900539022956;-0.59206846676384194961;-1.5899255596593855344;4.7332839390142362745;6.5436665588950893024;4.154914554843038843;-3.3756869850952164747;-4.7454399242131781733;1.5242060065638600719;-0.62344081838375098314;4.2769779707581196959];
IW1_1 = [0.90204534595829144461 -3.5673701595038185275 3.3898721818642942871 0.29792984273061379197 -4.2150743690454675061 -1.8769112711180218067 2.7338537307815693467;-1.5093962241918985612 1.0774233260439363136 0.56417624876756333752 -0.088218725140572579191 -1.9128672900417995617 -0.10770246398929754494 -2.4959068787055467276;0.1340464107688482398 0.3759626027945432436 0.12573943653828734135 -2.6949425414959198299 0.037603797082598561241 3.6794477598353751979 1.2885145396928563422;0.046152919595426201982 -0.10599870222613794191 0.76535738611307768675 -0.0058683904559383593541 4.5688750730014051626 -0.4706031778839329105 -0.19301529156589455893;-0.25150846803152099307 0.053365773363331772683 0.65199130407735805814 -0.1997687105153987952 -0.90573193186880862626 2.9071768467150858051 -0.38055927572622033628;-0.3136166176722164356 0.1334966044894032311 0.53514936199450202636 -0.43351831884343855483 -2.907451147866878749 2.7655122453948615124 -0.24195873108649920691;0.78604390001086499318 -0.53236267693684924396 -0.21890385779962948098 0.21623029768431073494 3.3001150318199741207 -0.64366023346111334025 2.4772524866175213987;-0.89919638676966295865 0.21305582671523784488 -0.62311098912491358348 -1.0149115485072743859 2.8709719839565979171 1.357791430942786759 -5.0535133382217312104;-0.23618914249554368023 -0.042119125199074416988 0.44579079570127483345 -0.037295036279284696223 4.5690934556534816835 -1.3093788062920976856 0.51208090178956822136;0.6387791611125550606 1.0146513145360078756 -1.6029791179652390642 0.74116811413367567063 2.0483986733722239215 0.934869904491454351 0.57640726291887389721;-0.5052131511122338603 2.3070196950472658948 0.73113775447238815719 -0.80846757084927567405 -0.0010729956631141766149 1.6464421606297663381 0.46112810251407698736;-0.7156608959631270972 -0.81611373550588328651 1.5439136914890536634 -0.34514452893123032107 -2.4452667722354410884 -0.68267637156496829842 -0.59293179550496100116;-2.6544264108658204293 -3.3070897177197893235 -1.4875888640739474145 2.0713001333264275949 -4.1186569164928226172 4.6665812155614974088 0.52235906993226499662;0.37577842766706320843 -0.32251998982763052659 0.042217289065066450349 -0.070824400927130229388 5.388019755888084461 -0.82346071565733325315 1.8917802102473122439;0.93987594517363826085 0.063762909853724500375 -2.0757988442962957976 0.44040772035112074612 0.83064881854490735247 0.063168732847626835047 0.8868681496634621686;0.61126360091546616538 -1.551155780072982493 -1.4990174911236440192 3.3608502256361689753 2.792486999894846722 -3.5303802154894921017 -1.6916452489250843882;-0.56034836574305013635 -0.95957009789658609389 1.5291855495817221477 -0.86493961534334007357 -0.79532415000982981113 -0.97838167835352418678 -0.65029688674035190932;-0.42072379174265284174 0.083363507739656630968 -0.8103959600889738546 -0.26274731585257876665 -5.4985613319470960647 0.72280614785291852353 0.671722878670507062;-1.2324277769086844359 0.78242578046565391947 1.2113910794665831983 -2.4939680027158508402 -14.335249123154188311 1.488971811214356844 -1.3511136835723924765;2.1762941554424308777 -1.6477260652370249172 -2.4235763890218993133 0.86600567337388623113 -1.5567071653770827577 2.9046257623473015208 0.64268032640749150897;-0.85020841833293658851 0.11563448901665794588 -2.281760698303328283 -0.083490714104987526212 0.35518297041382468349 2.3645693839648118662 1.4689688673911909245;-0.7369494321066419884 1.318753483026838369 0.48732002800165258316 -0.97378646363263221541 2.9709707795335402736 0.38436582791715484531 1.7203770560783715471;-2.0924798352802795876 1.1883206538171402489 1.5684087103015007525 2.1207583481719378682 -2.5092203254594740436 4.098524568013520053 0.073296563559116054143;2.8076675505115624709 4.0209110557483676018 -2.1406044191264803622 0.16792800442720440257 -7.1560800888235185369 -5.547520430859198548 0.75455729572021446039;-1.5032372665455240313 1.939211475001792806 0.43268528588603105689 -1.0780678978176660987 4.6958732122378803453 2.5527572720438631571 1.60084213667827302;2.0174720251189639519 -3.4967217626212021564 0.64598806154920263012 -1.1239453036828970234 0.088549701453879609003 -0.068344042339436722466 2.5627055937468856683;-0.47233722926365334649 -0.48783597509508125345 1.5594611951967511931 -0.14150594722297527017 -0.42017450953473661768 -0.058351888534417341303 -0.57573170181991273342;-1.1737943780943858041 -1.4767384726107020132 1.6802500567106635199 -0.25857403943155676806 -1.505960226921174705 -0.91838647633216508037 -0.74468376552566895032;-1.5688468349054536244 -5.1576595972977807847 -2.9759564609266977442 4.9126926504532528739 -0.11661260736993121767 1.5196293077860878462 0.43074836318670683966;3.774101705833255771 5.0530348604565862303 -5.6754985985845571861 1.5037196690839578217 6.7770672321014009398 -3.9689215977275935643 -0.63087261107454628561;-0.87709857378385380766 0.79364678131392929483 2.3270989686515304307 -2.7486599025479079295 -6.753095662226878737 -1.446679422417275207 -3.7890864304773419491;-1.868622644716585679 1.7036254674686663879 -0.17031368173697192248 -3.9700256024190108128 -1.4160222635561774407 2.0174257570342595258 -9.1092894906837660329;1.0571384188778991664 0.56359727658812996953 -1.9143732203473982079 -0.044509370627353300742 0.30889178518507104387 1.979387561804331952 1.2865198378438127413;0.52393336689708069898 0.26377243933312455315 -0.40771552975140940012 1.5859995183730917212 -5.8389114318928454495 0.49125557387561624711 -0.0357919511701426038;0.092277078007780968805 0.22017580064756595015 -2.0150428172527559134 0.46577380560329162407 0.673241454628227598 1.9048206699157779198 1.2378600290058869859;-3.1545025025401445262 0.36059307022996062164 0.93087471192733151071 -0.22497116079518919562 -0.29519926619659409006 -0.71623198224911310827 -1.8766044760787536916;-0.53806066609519653809 0.30516249256649763399 -0.67132780590462304282 -1.4983027418168792799 -0.20405452950845212601 -3.2071356871928222709 1.5447950919173105699;-1.5333536160368990142 -0.084871375389719047599 -1.8797676087894608088 -1.2973579784546200866 -2.9143814938690262295 0.03138671659840980982 0.31229555810493475621;-1.43147538876437741 0.4214822699263744421 1.933240333943164968 -0.78769186875793073543 3.0301347997686449709 -2.4778983619672230176 -0.28194000664810714429;0.71234046435286957344 -0.56367213787918835077 0.84750696023483718111 1.0916479250379160781 1.0892485984504820529 3.6296974405286905885 -2.1327942416929630554];

% Layer 2
b2 = 0.94545931444028052937;
LW2_1 = [-0.062599049521198726898 -1.1636022490131421314 -0.24331721391649160924 -4.1389975002528061054 -3.8057312857176119891 4.0807133749884689777 1.1059092168750805918 0.13234609174055333991 2.2226986120741725195 -6.8877443633878598916 0.47217075863518775947 -5.6051394461086907484 0.11683265931588122932 -1.6203917596993764327 1.4123345128836308771 -0.17215193710501958124 -4.4076590481458266524 -1.96427559718078526 -0.20047145344744848883 -0.30583196312343224887 -0.87273016460879471179 -0.8004629475551804374 -0.20256023948613507968 0.033555232038108451231 0.70004273163178243333 -0.87370909632399573752 3.6361072001483916161 0.89906283600085512564 -0.036642414325441345635 0.029345183683953435932 -0.18450174381318903971 -0.069660428092600243377 -1.0779039414654900675 -0.9100597490759233521 1.3490415973921117132 -0.27804953859045028475 -2.8622725527110199906 -0.14650930627391239858 0.28094780514129324978 -1.6981894099254839503];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0470499670650231;
y1_step1.xoffset = -0.28;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
