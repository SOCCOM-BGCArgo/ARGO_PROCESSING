function [Y,Xf,Af] = ESPER_talk_11_Other_2(X,~,~)
%ESPER_TALK_11_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:49.
% 
% [Y] = ESPER_talk_11_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.7197131155151237;-1.4478824360884424;0.43278260124505497;-1.7679901724287366;-0.89962350824913573;-0.68174436851128084;0.88471478643628709;0.44925115868372162;0.24284998335099045;-1.5802771478421511;-0.42498703616698685;0.64937058343985099;1.1647884495014804;3.2547962329367981;-0.43151606191285147;-0.4961531286656532;-0.90342186499553334;-0.47639733289221309;-0.65364603584637582;1.5314597856897652];
IW1_1 = [0.17249154273534104 0.68278766731403884 0.63376831205864248 0.008550005480648654 -1.4128575555956382 -0.023186526335547387 0.63451898311827259;0.35799292235569108 0.4093959595473507 0.6574661837475988 0.55235201216822882 2.7548460624883524 -0.13958551031085759 1.7739298458487456;0.094439889263914834 0.010985178404866392 1.2813476206269054 -0.54700111413440289 0.23361360277391918 0.052921163217383861 -0.30758765621999828;1.2260049701320261 -1.2592280271795413 -1.6022927059697285 0.68593474413357369 -1.8166380847441195 0.64352489652179046 0.49207447877220445;0.36150917110865949 0.63749639162456329 0.95457514301435153 0.43417371356298567 0.47016521071298756 1.4936736860611031 -0.020221591071278317;0.14811767830879086 0.061930357538570617 -1.2784254663740631 0.084758564733615122 -0.23915562354851932 -0.16286284076013083 -0.10098630364166741;-0.29872604550214282 -0.86073092730696121 -2.5382789078150809 -0.49160371648021911 0.19875885145947364 1.4033763678343756 -1.203092876600087;0.96308074975625779 -0.017088247872616646 0.25420800508501923 0.61530166614054183 -2.0289338358151037 1.1601128337151505 0.75774176679251881;-0.028597821043888114 0.040199173320567667 -0.081829949112543529 0.041197169587828139 0.10326325321920347 0.14673431485733396 0.1139456264067336;-0.56287445962799332 0.035148052218562764 -0.87578026907546225 -0.62067837864571918 1.4387185411978685 0.54672835884146176 -1.5216187804394892;0.057646845329264486 -0.077225960873733956 0.27660607571303197 -0.35477070097020386 -0.85745423243656649 0.55568310039988533 -0.1210595467072474;0.69956134815281756 -0.11093526343784865 0.10848369533944564 -0.55042627695126867 -0.32013902652316162 -0.090172580154017148 0.51712921560518987;0.75974541032902343 -0.74261430814618334 1.7065391299290669 -0.60039278708416066 1.9112881649698601 -0.51261692107945078 1.0970208359219853;0.19296878644927609 0.16282453380220668 0.031976801067523465 0.8895357386655488 -0.77575681378089656 0.5893935696290149 1.7801879819683688;-0.45718398766826523 0.42878797309560301 -0.51512889790504346 -0.27266502341257448 0.037204364024986426 -0.30831718282209913 -0.34706499890819981;-0.87999846356342082 0.01440949312984029 0.23408942919538578 0.73958969526198726 -1.3010355106244493 0.88298800146813261 -0.26388718523167926;-0.090151409399690755 0.27423091636814106 0.43893814447809787 0.021437023256191401 4.6176458827533162 0.63127557585128069 -2.8477762454090443;-0.090679459892808623 0.064730145724437846 -1.4753625129857295 0.58245496106570926 -0.51004663183218868 0.24747271501703888 0.48187649029325291;-0.14685625750624626 0.15116152391126053 -1.2021875490073783 -0.13284471847746304 -0.30828114394696371 -0.098413629237455266 -0.5454705969551279;0.21009722321839994 0.3898786375184875 0.31804485724650389 0.094491706596729896 -1.080574033108725 0.27887452094829812 0.66681969793070761];

% Layer 2
b2 = [7.8996207335025588;-15.507258057721307;0.71379717873683746;3.296198250860233;4.5207995140532375;4.8044189722405983;-0.62661281918831024;14.16541887529093;6.1881326766695466;1.165736622003408;-0.42930153357977918;3.8852256027507197;1.2728743197347414;0.032159692168113388;-3.7248454743600368;0.25230437453540111;4.9652601545315997;0.25187112635030989;-0.32586938084263484;-4.0739023906590175];
LW2_1 = [-4.385752740082677 9.2797763984432695 -3.076336958899363 2.168572191214365 0.91171797317898617 1.3771172760169361 3.9823963041736641 -1.4733769616521342 -3.8245610321348105 -2.7413847095758896 5.2783381935403009 3.1708967561205945 0.034746365260213366 -4.1203628132242089 11.935068219183641 2.8364370389231803 1.7710977657322859 0.59449046702486708 -3.807410153605904 4.5359819414531302;4.5230226806579399 2.6083942237803717 -8.2259630714604963 3.0798268155762218 -2.3544389036678512 -3.6114143816258402 13.807249492950143 0.46983031315806678 6.7144893102577239 -2.8626990382093775 4.8296340833643958 4.5338430559988314 1.5100278021244835 0.87045020207033896 8.0308582404544033 -0.88158152412148127 1.6572289634312458 -4.9971247619587746 -1.1257805074710436 -6.5124372002784279;-0.93445878189490628 0.56268528290887088 -0.35145226807250485 -0.51549399417829478 -0.19641198836728158 0.19646205760987609 -0.1212280798841579 -0.010202413149659565 -1.3888201023312658 -0.81407764267662142 1.5468235256290541 -0.63234422977439375 0.12518259158555942 -1.1305380507603215 0.25588240880998181 -0.61214550554046598 0.20921516683950092 0.39600301690559375 -0.7856858621105155 1.6964484958441002;-4.9128001326116371 -0.59307804933235064 9.3194625219358365 0.67726008057841436 0.19763380167831782 -2.0181295607361589 -0.27085728979344365 2.3542727990528207 -11.882421312857067 0.97840818937682039 -2.128038024906882 1.0178138250442423 -1.540542936315229 -1.1858068892183535 0.51067923908127855 -1.2916640370146519 -0.00064843732047012263 9.4576182649147089 -0.53621977154993372 7.8127775349268793;-5.0926928633162953 -4.0931023392821357 8.8690180467239603 0.20248661544760085 -1.8837938015281135 21.20754112196137 -2.1076601671175568 0.90634022012222937 -8.4916510781080472 0.78271904877379206 0.39193870945013343 -6.1783757781545763 -0.60889428423191971 8.0148366723437316 6.80771254459491 -0.48735465470121986 -5.2906392669375331 -1.1829772989630047 -16.061986635250019 0.95173042620968296;1.1872681934741398 0.041426963534164404 -0.10810904206528679 -0.018280310789819711 -0.66722662644469732 2.416629543630425 0.20460041365678927 0.30934654021479602 -3.4552348323071422 0.11171424428266272 2.9226302216463806 -1.5837378838014642 1.4376779697528068 -0.62364995079080954 3.6163526785226408 -0.4937920247282972 0.29708601588241729 -0.089093678952582703 -4.2052850199674392 -3.4869232663761607;2.9536463955070422 -0.92824319753497186 2.4968457696787025 0.05903781078207436 0.96245804285146608 0.10260194376762054 -0.67761911053931312 -1.7123517919459619 2.4290806120640198 -0.74521692308052057 -0.23964767337919252 -0.055105954274389711 0.35196284806654621 -0.058156924902607009 -2.2355734578079338 0.25182917575484842 -0.33761047733126559 2.4614312209592848 1.5077649760693879 -3.7733376980393141;-2.2218756245259716 -2.7797529217282184 10.306480838072771 -2.9297633078031184 2.0226749832926973 -0.86369286213862151 -14.941826409279473 -0.77672504383840113 -6.6012963407407632 2.9102695132555447 -6.7912031128060111 -3.3808674280421003 -1.9084680412108808 0.65872646876971863 -10.558139409976267 1.3368739834927053 -2.0568970170632945 7.2479740038656431 5.1794026701053681 3.6319477211395266;-4.28172692700275 3.6948016967751593 -5.2615328553257887 4.4182122767708547 0.46714319452031711 -32.638927706620571 -2.5569745860642596 0.36054219515953345 -12.743685982384898 -0.51275629565757741 6.5177632526358416 8.3181547884776581 -4.846726443941165 0.28566288160245212 -4.3553564541883034 0.84879916781085984 5.4512399772511158 12.69641622127283 14.37310882215637 1.9380100549909538;1.5214784384930371 0.77879413674018916 -5.8419466730164826 0.0026564453930772803 -1.3743834737898406 -6.9646788919222082 0.9728350815393163 2.5589194464708247 -2.5514283979216881 1.9968897242823809 0.6826780498531726 0.81030671927845188 -0.34149977349282229 0.39183295087754544 4.3739244149836294 -0.41092542517695874 -0.083731967527808024 -1.0035836844386545 -1.2114139781728641 -3.0070129140947572;0.96144650081934346 -0.57559514406753942 0.32608904677570599 0.54362118237791934 0.23753200962777613 -0.40615262770148203 0.00074672972206447463 0.041520098715895667 1.3473132970472064 0.8502949952912936 -1.6980959431367533 0.7265218496187098 -0.093681328923202342 1.3442772950148367 -0.17254330603572976 0.79172405113073052 -0.22363207803902371 -0.35242787296871919 1.0303228525992338 -1.9664366205575858;3.1028816375426054 0.11315491183863605 -6.490437529148644 0.40392946816604014 -0.021680192533583824 3.7723107990321796 0.27447971179619451 0.96447308989878222 -6.4523852889124003 1.0938031377157138 1.6829722935931402 -0.22375591135327291 -0.36206203687911076 3.6961071659469962 1.9030200695012496 -0.17346066616676326 -0.90360081100715761 -6.9515785723418908 -3.2850434106209234 -5.0908069610303572;-4.063881863529466 1.6216175243650979 -3.9553964393418859 -0.25933784801042958 -1.1662122009632685 0.43610031576366315 1.106225808806284 2.4151097525397955 -2.2170155599365802 0.67216533184473737 0.76582194438412032 -0.67782395703115395 -0.26785564277428453 0.16852115981452986 3.21207095581028 -0.5530625201595406 0.45491181490489341 -4.478664126391803 -1.9981498337738766 4.2705823642815055;-1.9668789755835914 1.2568783479877905 7.9688216673054688 -1.3479939692173482 1.5822713428442474 6.7335874312841595 0.6753783536165987 -3.0423764971642253 -5.0842124839673488 -0.98044675352002442 -2.5116657287226385 -3.7005555890391184 -1.7887075796230758 -4.2551500094309231 -8.9927383315490861 -1.8423680088352572 1.9430004721673007 4.5563297887067273 -2.3449413664370709 7.763604087119135;10.019658188367153 -4.2820097595400659 5.3781500813382115 0.79149148990120111 -0.43733723218363296 -3.8951371623964697 -3.2545543920104167 -0.93650433301402825 8.3694847441571252 -0.77508809986287075 -0.36644262028491903 4.9960397766585984 -0.49410953982512101 4.4863298289694633 -1.6748983783261571 1.4096973955974053 -0.21192516640652595 7.1910627495794337 0.49614686495051707 -16.70127976212504;-12.066172979793006 2.2513382667366919 8.5635125701619224 0.36282355998677285 -1.1679001290402786 -0.72180803959489803 1.3204302954270153 2.7988843035728475 -6.2346853266948274 0.58005550655670746 -2.1213348241343803 1.176743037768291 1.5648684771199506 -2.6436589409226543 5.6007417145235818 3.3875492630559969 -0.74906113236667904 4.4561610964797431 1.740637408326219 16.808441604159214;-3.3754264643707637 -0.60254953455970817 7.2115777645812909 0.66149536265020792 2.2199230529181744 8.0107849929995503 -0.16690084377638054 -0.72388870831648433 -7.7857285626712169 -0.80887440084731033 -4.4815383540707261 -5.2277033935369754 -1.6925331804951549 1.5921731622681803 -2.332636147837881 -1.5595302310787496 0.60969374102235574 3.6555229910664395 -5.4457665000473989 3.0409167840490854;-0.01805423564572773 -0.82037027857660005 4.860340087061636 0.079267893774164183 1.0008729409602903 0.45444253968331955 0.45377477035484676 -0.67437236753766261 -4.8354552459398459 -0.067920383660082573 -0.86769572254024097 -0.58637602795558785 -0.33760620837328209 0.063730527976886511 -1.4477149897816004 0.071517551427808829 -0.40586959189884092 3.7671127571764247 0.99258854954414144 0.32618440149180022;5.9549658772165248 -2.7772685206405856 1.338250090362479 1.6515653393661072 0.23552567455358817 2.2354758719876653 -1.4105510406066277 -0.40345087388956502 -5.5433156548799456 2.287143583757592 5.0367863643942696 -3.9229532217002281 3.2993193173061708 2.1600125219741262 1.9351901680085672 -3.7925872474903271 -0.50636661825130957 3.5687134648343846 -6.5617077469854417 -3.4887341485019725;-0.61272591216618966 -2.8143654159804083 -1.2044963240876299 0.67702500683865263 2.4781229567777219 -7.6296381102185924 0.8952449617495114 -1.8991723670092278 7.6186822960189051 -0.42210746601048532 -2.8458781222934522 -0.49109411032085082 -1.1602440279215402 -0.19230830635086221 -1.9583607049145115 -0.4064578424978747 -1.4755078980030343 -1.9624895916876102 7.8334221592015068 3.1414271396897049];

% Layer 3
b3 = 0.8240522351800561;
LW3_2 = [0.067635471206596645 -0.28072135537952353 -3.5115336301111575 0.084519340157331285 -0.030162874510414456 -0.20780128692322167 1.3948355496703451 -0.24681061553326722 -0.01343946927126626 0.08113278144546765 -3.2185896620259333 -0.29107166163138037 0.73233376820872587 0.034838206636440376 0.078655464036015629 0.071017182406856907 0.10624143052070936 -0.56568210193222002 0.032475104412745537 0.1045539127238841];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
