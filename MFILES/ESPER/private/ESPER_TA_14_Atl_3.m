function [Y,Xf,Af] = ESPER_TA_14_Atl_3(X,~,~)
%ESPER_TA_14_ATL_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:04.
% 
% [Y] = ESPER_TA_14_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.0078365418079631155;0.4238989063242143418;3.2592429743960313893;-3.3367953276615764935;-2.8653156148454517194;1.8884592758531613121;3.9369378981999418876;4.2631951738839530819;-0.1576676852277527352;-1.5811938349830436668;1.494013073978410544;-2.5162675997237990977;1.6046288474696828175;0.068728626496701111792;-0.29373833025739021219;5.2412673028669232167;-2.8271122664146077774;-0.9905048050756263267;-2.3511426825762100634;1.7104254098017783736;1.2091857148110971565;-2.3322888237867585026;-1.2996969274972680619;-2.5498480400123009204;4.9108371026851846963];
IW1_1 = [-2.3245179424251167788 -2.8266530151189925846 -2.4616902615402764809 1.3573259906230175087 1.4236297384906004826 -0.74762761038532954405;0.80654507309940492998 1.099789036725001834 -0.16924083980581910991 -0.15133935384729468865 -1.7648794252148993777 0.050342100488949138859;2.1627000191968432929 -0.74333507236015827768 -2.7119999579780151855 0.29443460219091466268 -4.5589477328513821064 -0.34237506051273647323;1.7426738396397498665 2.0975411563613057808 -2.2215603128804821687 -0.39700211639379739958 1.9111264168893973281 0.31796488532673816696;1.3246370580944699658 -0.67141452056117756353 -0.42289680729374690138 0.6466657460838860505 0.2916848623791067352 0.9546236088550831278;-0.59099578654959483703 0.84067941239987209467 1.0401703271234832293 -0.64977137354201230934 -4.296615749728907474 -0.58854570721310295323;-0.90027954527797759976 0.96587128918925158061 -0.013957006434437119191 -0.87916284037108538563 -4.1839188425901756574 0.051791060788398332604;-2.1409658532908131257 1.1697252577354477765 0.26621457958829652934 0.031177630241356304314 -1.6955817548517766458 -0.83942803508710661653;0.25531790581656771399 0.71499525126754559512 1.0400253536059986814 0.4108312437703359743 0.92629168741615131033 0.8719775697619132071;1.4082105657423560352 -2.087812915525284474 0.075165236546491778769 0.18693990444352415192 -2.8560202385457635899 -0.45170632202334870531;2.1632440444345464314 -1.4146115005664330333 0.83954568824092212775 0.79550670284945901312 -3.8216158338160246544 -0.44625729803995556333;1.9696096614316951356 -0.89095550410247847939 1.4382561064310994681 0.9363709108872010356 -5.7513548518077177718 -0.6546655454514700434;-0.47120922509119100852 1.0053041164993976597 1.2806319910304495568 0.031871494930990090788 -4.1136663915212166032 0.26091924960825552127;2.1300864335866158683 -1.5947059427869310078 2.550792636565774707 2.4741875662281853643 4.6093658033120119555 0.0038185838339399435365;2.4482593169764057528 -0.34102657141086561987 -1.3007921487395868176 0.56130817471371419192 1.0694009768697800844 0.2114618043903622735;-2.6094810227299594096 2.5527500464729051544 -5.0601895390460622792 -1.0165776217958286676 -2.1438332147147294293 0.17883103353498536192;0.2028786336719415051 0.045004470828263379301 -1.1371259520628234085 0.40482077388230403026 4.0837700486776133957 0.42578689700976291022;-2.6593373854153425917 0.23066576429177151897 -0.95318091419667005937 0.47753065239235886752 0.030439209224498983697 -0.63924305964763272758;0.50286919176439548451 1.4315889150426930332 0.63906316612763036655 0.012252919154759418091 0.44038418371080212399 0.2729580246195923432;-0.72950982105190087523 0.95520938151388090631 -3.370410219258043405 0.19956567822159534953 4.1242339259092783976 -0.70378806268977545102;0.74039986684949177231 1.7862936265099487176 0.55832916548765509912 0.48138224567914422725 1.0132441080043643744 -0.26983397469795644685;0.23544966012473558803 0.28299142474319260998 0.25285965659677572814 2.0465571335386005813 -0.55145942880740483893 -0.55015296145590497634;1.3569839859540648863 0.012060464083056988277 -0.12204490866425467266 0.16094643862439581006 -0.38946760689645859577 0.72161315198110853597;-0.73358333117384399991 -2.2916332165875310523 -0.56413032732471923847 -0.58400614211805257359 0.07052432509820849571 0.39116941866491644619;2.9086801616548574323 -1.6988716996307047236 -5.544012764115370473 0.54557819456173006767 0.36700607062081458398 0.71054022990961329675];

% Layer 2
b2 = [-5.8146749017383205782;6.0562546878442962139;0.55497331370805702555;1.4772020270344794479;0.56512167180741346151;-0.20520491553411288055;1.6229091457497726303;0.57634643198539203812;0.94021333663286188465;-4.6670863806872882051;-11.851583517306087501;-4.5143085994081753043;-2.8977842157093403053;0.5732338834702523922;1.1668360539010385057];
LW2_1 = [6.8150371696847953373 1.7638078679865905052 -0.69295128494993363244 -1.6097901559421567974 -0.42493770670169050963 -2.5249576597336353956 1.1452032860874472586 1.5459666208559494915 -1.5592702824540725093 2.0627712973905780736 0.87429303705838856686 0.64386940319237229158 0.61808892296251627396 1.5786515378956955669 0.94872993231349500576 0.22598636589260909235 2.0209036186535875856 2.5314582094479738394 -0.24023225948441184752 3.1719289272130830604 -1.237135238092845535 -1.5390559434975292774 4.5254237817000406707 -0.14742213319011523986 -2.7170909759116268489;1.6906163395265887406 1.7393466888601731846 0.64838976679006277148 -0.1435699652851326058 0.25818474435561000746 -1.2159545798049213872 -0.33489903707338164462 0.3496157620831659707 -0.60593823599432061755 0.68819776704022761482 -0.10289895364074785888 -0.71920401952223533826 -1.4423406948135848449 -1.1175637141792729157 -3.5262286868206085266 -1.1542205789702102425 0.24714230191496108779 -0.19416812645532582904 -0.93439782702532636627 -2.1855203429741836274 -0.31153308500365789468 2.7689999119937129812 1.3928141669048290652 -0.37457508308552883713 0.34025860470997915108;0.5762895151107106928 -3.8197332347858279356 2.2822137618342868137 2.5714543709097137381 -1.4337551161078030404 0.28767393437929950073 -1.8465762844783157881 1.1942631587360597045 1.5497301872165156755 4.397517996595078138 -1.7530533192479911264 1.0367547532288368117 -1.8045065938621047685 -1.3471240368781054464 -3.4514403383303609019 0.20912348271290170931 -3.9089187763762596184 -1.2629157014363743272 -0.89334097089956465698 1.8731419566953642075 -0.52428533453559733601 -0.91345511248964617046 4.2724569905197435915 -2.3988391345874413574 -0.74314084050440520901;0.19611656479392661212 -0.4873346320238027829 1.6943343633390903769 5.7917196769846084337 -2.096375050290778308 0.46708611540842637222 1.1053873169948951194 2.3729584674087558227 0.78038202392201949653 1.12944863256328909 0.53904066090441982162 -1.1069792874488226797 1.5265113710649818035 -0.80826750454753892861 -0.4318554472046378101 1.4766215924418797378 -0.022720479840106673486 -0.16887759073039815272 -2.4971980416739087971 -0.75626576882786900047 1.2914152892552905882 -0.38153413475452369052 2.7912077420105974035 0.26229986931081744617 0.91476125620147530348;-7.4017962715678446983 0.87562867217681394916 0.3672215226283177536 -1.8925720976699509368 -0.29684704598745303983 2.5244254232818588157 0.868720880114402072 -0.049563749450261915253 -0.17944871117599864307 0.20707463302242831715 0.53923115754947459344 -2.0138814593256184615 -0.57529867992805228116 2.3011281758071913117 -1.5817997400521284224 -0.8824892203753695874 0.39662024702966097722 0.5517180982965599334 -3.4115878014984488686 -1.5928825743886239064 -0.027054920205292987134 -1.7119190398507007078 -1.9761913534173485285 0.65014651052338978676 0.014991907105945376233;0.080404104775369911184 -0.020860713834155896612 0.8984242526293101383 0.28928132644759724235 -3.0937650959723965727 -0.519996342570709702 1.5554458287183199339 -0.19351881901178261125 -0.16452969673995493372 2.7038458574757116004 0.26405143740422531984 -2.0083664313885072339 3.4093005520005852382 -1.1231808243355974053 -0.55385316765849412768 -1.0983363767433516056 1.6834834126242594898 -1.8232865912074562864 -0.99063646066355259823 -4.258796409856086207 -2.6388618535029038092 -1.9046253588871930873 -0.52390118834255794411 -2.2902495665353295173 0.056372881748134338886;-3.1045327226997927461 0.73834799095752368103 0.74434684336862955156 0.17941044339568751331 -1.2338725464202444648 -0.88049310270138314571 -0.46433985116311560226 -2.2801558727239785718 0.52153144213665147966 2.2490319044633109158 0.12426118601231966876 -1.3100971266079526334 0.30611801340050975861 -1.4749363323868633913 -2.1728221008864214703 0.7135414766243884932 -1.1388791540635123667 -3.1469741331621396974 -2.7170770826809236276 0.97073776502912656472 3.1189953939415548945 0.72364892691350735099 -0.50450797557890558753 3.244270479590873002 -1.3479461553757856596;1.9763223549781885335 -0.64136648831290432593 -0.63966994057141102203 4.9526033621236091875 -1.2478647118191810161 0.69788273030617198334 0.71473460397334942495 -0.004261902280531089382 -0.25351549300466552639 -0.24446646286394857484 0.74165027001870065249 -1.9404609686341480757 0.84061219065295367248 -0.83894428187891123549 1.2144007663032467814 0.4934027833205834046 1.0757639683490243243 0.23152447715531457306 -0.65785287702178774083 -0.56980567133054249584 3.4251870003451747593 -0.076427089917452534218 1.3684127138341326546 3.1018441360262078987 1.7652293903471409919;2.1382579450901442186 -1.0987738525861885375 -2.1195183202540475165 -1.7484622866241643635 1.0712444316907874242 2.319746025176093962 2.3651727283306764882 2.1213803632733965188 0.17902289087578907023 0.13993836493570571688 -0.66529711484804809896 2.4618242906160832106 -3.2002564761623104594 0.19611499667044801631 2.9411964258805807226 -0.501454955425618909 1.320120408780577792 -2.7453638687148895769 0.94274523250190667145 -2.4482068968715511303 2.5983283904067446812 -1.1898509017184257797 2.1941621947078058241 1.6636466656652055818 -3.19901220049300683;2.4971077318046890348 1.1082271424856393605 -0.99235110047116281695 -0.85694468859362549207 -0.24234138835064233941 0.75761041738360601627 -0.62497273886568183165 0.94573995118715381558 -0.77086849423129921721 2.492036056192463267 -0.054525004879786995171 1.3575010267085574345 1.7667630366746931436 1.9231489342243641705 3.2380224348422932401 0.32436180954435006596 -0.97397664755889989951 0.1054872277120349755 -2.8235705105414687921 2.4669502482695571111 -1.0544485934275411587 0.94749692680109109943 -0.59806564476950907494 -0.00054113497107723985968 -0.17741504122747558947;5.9031562495371785459 -0.59391217839310006532 0.54499767463279169544 1.1790156700138993973 -3.0388640036869714045 -3.7234999422352297316 2.1140720652601037166 0.058794012906623449588 2.1601061578148184061 0.53997248336686376469 0.24742209154418051686 -2.4500727231441490339 1.1827719671343577268 -4.7451274503313234376 -1.0305424534899187972 -5.3583416902303815377 -3.2027440406584397614 -3.8731822945335152575 -13.825350678198454091 1.2141094472976869945 -6.4515601014193491025 -0.10276994549446363814 1.6224756222883855994 -0.14415705915827334294 0.46793944682971089222;2.1158784450671914712 -0.93103273390688012778 2.5427006902585529424 1.618136739684187253 0.18830214455234034476 -0.10748855194482040409 -1.0704903521236444064 -1.445603648330225699 0.16223246164590077179 -1.6756807360948866581 0.10941508197520005696 0.9218365998318456267 -1.114130662979990305 -1.7240496905224373947 -3.1857207974988956956 -0.016766742967567381528 -0.013835555785117163372 0.88280498921814021251 0.87565796729888123462 3.3447699514065556414 -0.24665586259836211336 0.57270399155046247675 -2.9088594481286920157 -0.77333280275692994898 0.72548233165334208294;-1.61188158968677131 0.6676404569847369519 0.52752940477721455004 0.67748966548411859723 -0.62357893134840047811 -0.70840788987958247525 -0.78661477619980391118 -0.59374821368247088227 2.3593882562342693987 -1.8866114385212553461 2.2903248903907309497 0.22803948530195514155 0.34829458891073816762 -1.542376764730604588 -0.43586858693184149516 2.1731042872750849781 0.062868888495732772048 -3.0713800648317852726 1.0048470865883016856 -4.6048922131570311223 2.0431318105260274365 1.4622847840586159496 -3.1454283509940887953 -0.86103847147053658162 1.7355628390801765004;0.45829213714151612047 0.97043795543492838984 -1.1900653045798144092 -0.76085361354139668943 -2.4940252028293294906 5.5814303572861039271 -2.0596588816115284359 -1.0867438913434661618 -0.09436582087368085292 -3.7696335361074146952 4.3535265339328210743 -1.0220594671058147451 8.7358552003562390809 -5.1649309154432909708 3.8810370097292357094 -1.2006122825472185234 1.4745531795433735045 -4.9647764884798792906 -1.4591047705840687332 -0.93109458897496677476 0.54003028234930761098 1.5349660355625289743 -0.79985218503604649243 0.93261777074730423109 3.5046503844110974413;2.1935682944155519003 -0.04117603669839942776 -0.71101092813868027598 0.51142164677360435476 -0.28745018358330221009 0.65236441872701611544 0.60297862389088796586 0.17904042732486302736 -0.1939859394713497609 -0.15854592471802048115 0.68654697031885270064 2.8767079804625286243 0.15308472048563540047 -0.87858774400281136607 1.1513574423511934164 0.33948824880342237664 1.0932258559317005187 -0.071756666759519832643 -1.73391753667480919 -0.73589864917256020416 2.306264174283495727 -0.12938865410302444192 1.3134954689661311189 2.0947283952968915877 0.77251501559680424425];

% Layer 3
b3 = 0.43986616294878516653;
LW3_2 = [-0.066778529716170584307 -0.07090700754642419168 0.029256765949388741782 -0.034276338835257949555 -0.088441515300224288199 -0.038502389847894759323 -0.088260208986621957461 0.54532113948211291543 0.084308525114299745495 -0.036135691431038688415 0.011338455643289162278 0.079468570981286082433 0.013543180681420621467 0.0072043841319880744245 -0.53685438167597976378];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
