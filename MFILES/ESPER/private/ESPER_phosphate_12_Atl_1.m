function [Y,Xf,Af] = ESPER_phosphate_12_Atl_1(X,~,~)
%ESPER_PHOSPHATE_12_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:30.
% 
% [Y] = ESPER_phosphate_12_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999994516886;-40;0;9.1619;-0.52];
x1_step1.gain = [1.0000000017546;1.00003626070655;0.0153846153846154;0.000309885342423303;0.0656325902039552;0.0145232735458572];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.0365500813019430382;-3.2585236414829461538;-19.365769655833062757;-0.23272262800345586142;-2.983486988933801598;2.8096879764939988178;-1.5448616068429532611;1.8780716522115470379;8.1818432198039232617;-4.5817114132724059417;-2.5858662724572485381;-4.0482028627220429939;-0.33198744844917965624;-1.9433333855776848687;3.8048713140479732964;-6.1285391186026858534;3.0641056036696610043;3.331637688237807815;-4.2011547745578434743;-0.98392922996857268281;-0.29585263446186910175;-1.8154772686670503923;2.439616213763804442;7.8248398895784614382;-3.6986529058344945753;0.33520633704323959945;2.6266851843771248376;-0.45707411657739810407;-2.7617442555779954105;8.3792095846205043586;-0.81726785553275504981;3.5896549225688438867;3.1807308564195118095;-6.3272927205609210688;-1.2910326928116739875;-0.58407867176818806243;1.2956243898119714775;7.8701657110716247701;3.2866572550043842149;-6.308025987450145422];
IW1_1 = [-1.9235760697596953062 2.4219857347659083935 -0.013614494822929331871 -0.38380997914277636962 -4.3369727288866100068 -0.037488493996399009645;-0.24668003136900196193 -1.3281433507171069852 -0.26950626549308842606 1.9870995961037565269 0.07863906084810477759 1.8048969867355142416;0.79992036568173507938 0.080214038265305098729 -0.97307539935693410094 -13.702961869765626801 -5.0069689259326786157 -8.7957318802155395332;2.1135624561484727124 -0.72103728812560874406 -1.2092456373369051548 1.2646623244772943195 -1.9100949450358521986 0.0055247227971916869349;-1.7387644166280185054 2.6026724900230520099 1.7260195218513234572 -0.24052275659661159768 0.016904461504637917357 0.07019524531563818559;-1.2739503651280894569 1.6414534680478127804 -0.96193458216153415741 2.3837293773940753105 -2.7401155951959150769 0.71305285834183451676;1.1493678327240419712 -1.0022377071631991541 1.3048698524212698491 -1.4733297966897023201 -0.86713809232384064796 1.4752812317907437745;0.51467957473956471581 -1.9809851668125053603 -2.2937572307016034223 1.6803529852441347892 -2.8179612983302950724 0.94323013523717713635;-2.3325020476602733588 2.8370996336464258114 2.533984471353997403 1.4380265286842774941 -6.7806944631115140254 -2.4179194906600693926;2.6627140147941044113 -2.2867852056427189211 -0.99004365264877691732 0.25165646713269551604 0.88937444930148890077 -0.31929465568413911702;0.17779482484077008264 1.7975214631035372204 2.9069835940706139077 -1.8858176778259423401 2.694800822436124399 -0.88789683950851661098;0.33473704570616880094 0.60098647884994127466 -1.0403403816169525253 0.7098309912471972849 10.316221294286970434 1.8384434228507733344;-5.1446055790971589872 -4.0731931590551804234 -2.9509245422061729514 -1.8098112961959216261 -2.4629360094801846515 -5.8229872032256189129;-0.24350663118408502616 0.26134454145592128649 0.51989077213302503644 4.1574023278428011707 6.7659629011968167589 -1.1701233054892306029;-5.3025274484644926432 4.0767081196702381618 -8.3524432970864488368 0.39007818626510581961 -1.6814010520207867128 0.20635814028736912396;3.1648574278135694904 3.0641696525373269822 -0.18143896030440651024 -0.26011476322039989162 1.9782774458587453204 -1.5987941606539031181;-0.46889391573255162493 -0.70463226519792243607 1.9508986304804192269 -0.99795551716207342441 -7.6094998911525442153 0.35584156253183724106;1.5785228618369184783 -2.1494970539423925437 -0.016069685294372193507 1.3716986131133783733 -7.6793806138610571921 -1.3939444280130455223;-1.2726074311634874014 1.6480902329908697634 -0.061525541725308906249 -1.120047057464584217 6.529542208065407749 -0.35480874504004422665;0.68741343928915066286 -0.99423613517116449234 0.88518239867676207222 -4.1624446930932705868 -5.2951040872833425865 -1.3845713194194009255;-1.8864479034543957248 -1.4483510093340110636 2.0042437322653583465 -0.5348171409864129755 -0.58504274488131879917 4.2939386330954869564;0.44113154139187887859 -0.43555839618281955161 -1.0866273732507087946 0.58879030351166772306 0.28715351393791593848 -0.87803406442591602765;-0.43385446669695276745 -0.68769630150571359195 1.8305575912925784454 -1.0099650529027919266 -7.1688791451098889951 -0.15488527519120035003;4.2782006015032489898 -5.1186266065311212259 1.8130290235564421319 5.4210457055793703773 -1.6015104673415958558 7.2690940681144580182;1.4669531333389596028 -0.66269783133010684573 3.9919123654287389513 -0.24327324800892494161 5.6181797464646541229 -0.5474188644438215956;-2.2547623804107366219 -0.46584296507970318624 0.99224557444788430427 -0.51407327820392734186 1.0489822524186465103 0.50285464171134552913;0.82536763490835685086 0.23422752823442188896 2.044900127760135522 1.9649800911209767129 3.5859514959980840487 2.4768891467460667499;0.50651404907592112448 2.3468451724692998006 0.79145318994336899543 -0.17544872854570070508 1.0782388736427290787 -0.19346343650058692165;-1.1656138142528689183 0.37347666523642314429 -1.668794725126201195 -3.5833018642500547024 -2.9490790068706278504 -4.0619235594033584746;4.3558927669631808399 -5.2001893294639662813 1.8867709046060274769 5.4769169176055996218 -1.6012109678274710767 7.9538718613047914019;4.1866211879687966757 -3.5798569266161517355 4.7309315284108102162 -0.13960476744429559104 1.5020407068188517119 0.55587872141063965348;0.37523559192253391759 -0.15978962033965243839 0.40750583907023668617 1.7760291189600194706 2.0294156954229092271 3.4220335275107536255;1.7360887050938307308 0.37180862786597473901 2.659373289932070783 4.0796656675769780165 4.9074041329180948523 1.3983975242146269302;0.2234960621321980534 0.67789972811666487917 2.74178898948977956 -0.5430390061121884715 2.7369546808443869779 -2.096331906488079877;-1.0191327710487552149 -1.0559099626304373487 0.47046541475535336163 0.8824580432382430617 -0.50904523338608298477 2.2350466902855163909;0.38036957269984511543 -1.1042313939300445469 -1.8385805725169248603 0.51403170646042950498 1.6919443555754474229 -0.81820129874578373386;2.8964460261289182164 2.8697637574237968572 -0.47681945757224986071 0.97616848302254788372 3.6388297040300194851 -2.4858777980643806949;-0.24266116834563669635 -0.60960431696309280714 -2.7560379179426388596 0.6255384826025526257 -3.5781539722575863571 3.0825998948578918757;0.86975318041900284705 0.26115524565746806029 2.2409175408570876087 2.2715427656943258938 3.3409510855626707304 2.8190258484962948948;1.4698564675639014254 -2.1133949680642536428 -0.3143845723612272991 0.59480132073227232059 4.5353057936448673004 -0.83687636002500531696];

% Layer 2
b2 = -1.2376891295854173247;
LW2_1 = [-1.9086645157983006538 -0.71184154018501621941 -0.22083776208761365933 -0.4420573888232601778 0.42716218996581906131 -0.10014718991894186462 -0.60457401113543562943 -0.64854538484050083813 -0.21100797099105375598 -1.6613956047493008139 -0.45802752705708399406 0.71508066401373471255 0.017030761495053926835 -0.36870756343209959427 0.16040345435399613883 -0.34794924076871402985 -3.0476445689097455549 -0.59218245217276310743 -0.77031160599275938505 0.12934178974880813917 -0.28337976459138303209 2.1929362994743235582 3.7419127162023495536 -1.38307721522165461 0.46807384918534078455 -0.7378272858886967267 -5.7452186052978433395 -0.59267009087802391409 -0.099727160890518418146 1.3286721500656692996 0.23524668657800851257 0.87707938544990593499 0.96202306426484052171 -2.0159466468444762199 1.1140173116673730558 -0.88574442164560673874 0.34286338640687386015 -1.6944537644791821673 4.1592023826304478362 -1.9895760676133518174];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.604229607250755;
y1_step1.xoffset = -0.03;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
