function [Y,Xf,Af] = ESPER_nitrate_4_Other_1(X,~,~)
%ESPER_NITRATE_4_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:33.
% 
% [Y] = ESPER_nitrate_4_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.6866158203578205388;9.1962260787366449932;-2.7933340623352940213;-2.9264214094768390417;-6.0190638887270875301;-0.2347866547903450507;-5.5882332398384413352;-0.28264909065149623757;0.50640548516105210464;0.70066049248520223536;3.6670690800848078084;-0.8245481004133236036;5.7511952433083752823;1.0422689083737539661;4.1767726867642416266;3.6644364335606116612;-0.36456112647195348941;2.1869001933200875598;-1.2166072757601607002;0.77870863237545306923;2.0210189391110273682;1.1177168696012982352;-0.89877988633632766025;1.9900745325221631532;1.1810378826668341823;-4.3778066023654202965;0.89221065682641320649;-0.364472938480899733;-0.99206161008333715312;-1.3936803592664377405;2.4325586381221597776;2.2951064563414713682;-2.1884565271425238109;-0.092376112564888146483;0.74929167484080549944;24.461377609042177284;1.0343685310075854122;5.3755587509226412379;0.78178387574683727568;18.927051046491648378];
IW1_1 = [1.4821200826944342932 4.5265119905648809606 2.5158377152557385159 1.0635158688626646928 -4.1872488675422649962 0.069561453971227038551 -3.0235094611751835991;-1.0549605125271255268 -0.29941757364814830522 -2.2589233171147666823 3.4664673153924496773 -1.2379361768873078375 1.0553943232138616182 5.1345627397825062133;-0.79847383245315062261 -2.4583541249839155896 0.66946245239822366191 0.35565658023799961995 3.9403970225947890782 2.927437235241310276 -0.87989118172914493332;0.69613707487491183201 0.65555174291104567619 -2.1743772879372493811 -0.25562647184777792519 -2.1433889904636305168 -2.5606491015684635926 0.17229368276512521674;3.4965914467901382245 4.8538835413915490946 3.1910799882358054091 -0.87403786103849478994 -4.3506164675712639678 0.60360888397924061799 -0.61063586805577019234;-2.4099430989117509583 0.36711533090973086368 4.7687779912590402276 -0.11859327882480807936 0.72293402663220995841 -0.32385304204873827105 -1.7633616390562709686;-1.2593596425188371413 0.44000074320271087558 0.91388982697345422235 1.0350744942121126169 17.889481375139187236 -4.8703047524418003889 1.3012991421587118968;2.5582081077440470551 1.8996896074161984114 -6.5617959535494101431 -0.66127210111506962154 3.2006220539811782722 2.2831448516390380199 3.9179747066729886384;0.24141299293547216487 0.057220333220561823973 -0.23543464001884858994 0.37629474020422437608 0.091881806799097909266 1.5020706915050812125 -0.79717715062933747205;-0.2921400587459856979 0.57842041937590138456 -1.0653274253665769855 0.30767693057518524791 -0.95535618889372553308 0.69935381650522687735 -0.69506283733165818983;2.1760496622637273134 -0.97748830302999345498 -5.8991015594477644868 2.7259431310578450258 -17.321925917095303049 8.0797572327894933153 -2.9184079761576886547;0.14641896606925461355 -0.44279610364301130732 0.94234997830464339863 -0.18022908990125682815 -0.57429011469998714201 -0.72079956635508612983 0.419581561890931376;-0.069128515830944953224 1.8612770737555781597 2.8436515152195727119 -0.58206148476769103972 -0.4330326661717837089 4.4130328046824693899 1.2205508953126733562;1.5072226431676387648 -0.92033910459808565552 0.28752912339342068249 -0.4118838032916269376 -1.816393696445707695 1.021000119989354582 0.84328818599060240135;0.39034422043505834221 1.1829028160223351573 -0.89509299812200182611 -0.77226168578933263031 -2.7110995936547648277 -1.4527735478851657724 4.5344127561757945344;1.7958140550176218131 -0.52780131812721065021 0.68429152469242826573 -3.3738571460862596396 -2.3843528782157328294 -1.2020326261787879218 5.2168408998857058734;0.19673124851633358445 -0.046890479920952847503 -2.2462189178229015063 0.63680396762303648206 -0.0098854000732187270045 -0.75046049797480074428 -1.2162990744046178193;0.1166614083962238535 0.72661945023080132255 0.97588168258249430309 0.22366680705296704268 -2.6347153744699389755 2.5858808755684847824 -0.83678092246007862443;0.54836768865258900263 0.44750963686183475865 1.1810893095922039286 -0.39852325535080462826 0.03877268065130239777 -0.50934651538658459735 0.64037544976731053392;-0.10610174508702703566 0.02917733322752049524 -0.9023065275493072912 0.088624508497932033557 -2.0982162079698598589 0.74568440646623024293 -0.5526057849135819211;0.064598843934553840107 -0.74286088718597753644 -2.1612854464216573191 0.51322972344056905225 -0.51397954848664906269 1.4930042305635771172 -0.47315181970362435449;-4.1898286778758384585 10.566489016966373882 2.5872634591487471134 -0.025456625460037522052 -16.890923814854126306 -12.892826345461628534 -1.6292795389542182871;0.16017438920250531842 -0.012375605215729968203 -1.2143679085722438593 0.95374120915346005667 8.4964374166311351644 -0.4150473484412732228 -1.8892689319367750311;0.10273685982661691363 0.72218836523580909326 0.89648936966556902473 0.21713930730527367108 -2.3820622077097706182 2.3541750275728086095 -0.79111675706886808168;0.12481493703259867456 0.011856967589185158501 -1.2823370809005294468 1.4185636635811276207 10.343745084940589862 -0.61079195065696134659 -0.12856534229099600419;-0.36861424290826100281 -1.1048740307499191893 0.85346398342028972905 0.73152303642869520584 2.5917514205922942416 1.3520529893247683617 -4.6700449559320560411;-0.11665410576405911558 -0.18274185981689039515 -0.98121447834483643824 0.23192783525329965788 -1.5507746598441132235 0.53364060083073161511 -0.4556440204277324435;0.022683274960561838202 0.012921019052380739237 0.42733222006812149329 -0.71492385065244867803 -2.0469285623886235292 -0.81751230756312576187 1.5184030293050820859;-0.6005273823902577135 -0.39127910343103289303 1.8792671582255204843 -0.16409622106582158474 -0.79702667635669810497 -1.5977719237042009581 0.13553325400604906981;2.6748237055822881025 0.94138863923975890646 1.653506748913390112 -0.73741983584197723367 -0.25494236493428429347 -1.8425952211633618294 1.5453148175837505551;0.65275461968414605352 -0.39784641316106134079 -1.8480214219646686757 -0.74289692307967092333 2.1344454204646323703 -0.80731674469987013687 2.2463116866730841181;0.803770494193724927 2.5331852582315148581 -0.63435524185420533172 -0.31045320987323898887 -3.9840784967540296968 -3.0244056231582026051 0.27355410291239168341;-3.1167781246001706741 1.5810919038055599728 2.9233507022024887156 -0.8024051771387188392 6.2903957026439929479 -0.79785994557957806705 -0.064925442495683619026;-0.77780322909845533985 -0.87253935345154509662 -3.5227518767897976204 0.98473876056381104416 -1.0195933381063855272 1.2095055230555331605 -1.0197876788395501269;0.030020296136839819123 0.22606555671284131459 -0.91170905801278045999 0.098927172372711272286 0.86661742946211861582 0.65823772613385211905 -0.35183034680401342742;0.051240556444697007987 0.29294576475809902538 -0.6767576245544674185 25.688488199232164533 -6.9073231779609614023 2.3198908329392260441 1.3141589610510557851;0.043673173182272373438 0.12548233974217273823 1.1477462811249361518 -1.1907103133966780995 -1.2993234261846866584 2.93418416942764404 -0.20229221137990480162;-1.1250109996885726549 0.29666047644277349082 -8.9858378679350217055 2.7429343040043816515 8.3923847228835857237 -2.4343686020998052122 1.1585991735659497692;0.28210039718723478597 0.1981140298773915176 -1.0520271827232468009 0.093975422735040559097 0.82737588835442388291 0.8032028915387068313 -0.24188482458353580129;-0.18591624630262862383 0.0080117343710350286123 6.6821152010375648445 14.354367160430879125 0.32490425750375628855 -2.7767333983153412724 3.4594074506893091048];

% Layer 2
b2 = -1.0279379782031683455;
LW2_1 = [0.19411483514142796603 0.2740406480001583156 9.2184605312824778878 0.25182957430385471964 -0.10557539242785650424 -0.07412060541900220012 -0.24973005264267850167 -0.059564937463421639696 -1.8258584046579249272 -2.9544613396081609302 0.039593801113188629992 -12.476784377898793466 0.12692672702739229984 0.26234627216532568905 -7.3650453835534674951 -0.37328116391528926021 -0.4600648026206615171 5.4157153370802539882 -2.4161688546230730701 5.7420363386456862997 0.98982383898807180245 -0.034389690580844851919 -0.61978546831105096881 -6.0038241722555927282 0.43017597474969887505 -8.4377586501340697822 -6.839806852655894609 -1.6645456657028900871 1.1816501236912149153 0.071574394811751651524 0.55758639237566987035 8.6029853329102596859 -0.077189196808652507653 0.22719805586324282043 -21.477537532188627267 -0.032501647837366413885 0.52995714297150586791 0.081170653118879804166 10.07074784191918404 0.10905457835119039545];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0415843642790311;
y1_step1.xoffset = -0.9;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
