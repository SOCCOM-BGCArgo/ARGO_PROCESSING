function [Y,Xf,Af] = ESPER_phosphate_2_Other_2(X,~,~)
%ESPER_PHOSPHATE_2_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:26.
% 
% [Y] = ESPER_phosphate_2_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054;-0.9;-2.02];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987;0.0415843642790311;0.00819772922900357];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0352363686436660828;-1.5038040283952627263;1.8513359719099062861;0.94684004682000355579;-0.0095880568742553635986;0.60952576194275287502;0.50819449306932074073;-0.75548617626524117163;-0.57367334885116283427;0.094143587434549522164;0.29362507463848397382;-1.6530033723116561717;0.12910127456009939939;-1.0752551370142915399;1.7326956298956806002;1.5436574342762603429;-2.4848026681471861998;-1.5067370473188681501;3.4068220517550744653;-2.6783672557901350153];
IW1_1 = [1.4328412586300545151 1.884718681269215601 2.7519221425555322469 0.30526792346704884062 2.0368794419799414186 0.65913604180487450623 -0.30962975427161065767 -0.093197379252908885139;0.78284855127353814019 0.51580090274117507132 -0.29279251888982732455 -0.34510332006683286377 0.53579822942868093882 -0.59250808640273722183 0.13889366469608588339 -0.11904798929743674873;-0.24852136292321211353 0.56576074078891758212 1.0722386835464905452 -0.30070042267459151653 -1.7702290711360206821 1.0488562204828011382 0.7448024323232506072 0.0014150669580471574287;-0.2804149399294567635 -0.40943822762613912847 -0.01051088802048769609 0.011781453493292712992 1.1329193940292408005 1.4918457471927757396 0.97982141462486394001 -0.62903188647535501765;-0.11989126316138759565 -0.15638568637507027637 -0.4744010970903551061 0.22036397862145495896 -0.41382335940434916699 0.51222983641665109644 0.018313246240326475772 0.431638274948190237;0.10323569268038250424 0.44660507459987303092 0.64466026315447821915 0.40364103500083026166 0.61035067715120805421 -0.80609994180837019062 -0.090000564622110229562 -0.4145197786976801968;-0.52463388891546247628 -0.63201538471714302503 -0.84919320446980184336 0.31456415448245395039 1.5190956365182253229 -0.24620071714271876684 1.0444391065285396625 -0.057991793410055364477;0.16912879809055667013 -0.16829695286732621051 0.28731608301889333124 0.46574106733416548165 2.2138914401280795907 -1.7511727985865115365 0.78799876539277780019 0.1913592789981061193;-0.185952615358298462 -0.43462094362238784528 -0.53885225476235332209 0.030948877997391238681 2.579257274415510004 -0.88907820672110848825 0.98014762234272634345 -0.92842451901817768523;0.035941848399227212252 -0.155773785023685718 0.49959727092723793529 0.27480825874859404756 -1.1199930574978955722 -0.50457797043847363305 0.49651410026859721381 0.52307500187059141616;-0.68691039233263173625 -0.070754442797134858845 0.15108544118214564667 0.05995772585458265802 0.88964153710048310408 0.63879732220253404584 -0.78839486758465338045 -0.35654826400431166578;-0.12805445090458114632 -0.23535261204570970262 -0.91816915450839486912 0.11815755149464859941 -0.0019844468550698772698 -1.3616244206080065915 -0.98566295847848295342 0.031433242612860956555;-0.0062259608865059129501 -0.30250885334333399435 -0.57408994459654316689 0.11010137073175471634 0.038254279664884205392 0.67150891367953124966 1.2471029494720011765 -0.56147551232819459255;-0.64131935962580799426 0.57523526500741073431 -0.047341540824771842499 -0.35402765138213826424 -1.7258519007903445619 1.0130675203313892485 -0.28640052949446676012 -0.90441864630636903399;0.26833471290350224825 0.83213051959665451651 -2.5615643370673608636 0.83299032718023757749 -0.052350588701599219676 -0.88291260944358174179 -0.49601208053350859251 0.38381813011153748105;0.17267160166764550233 0.84577980612547420947 -0.12208302839117096683 -0.38955148930658750617 -0.19304596037480806214 -1.9064878376653153769 -0.62513628255431663572 0.73989718721193664663;0.40886713256866652477 -0.37471667441293632361 0.2036435324046324824 -0.18895717081808482973 0.39094372419185263734 -0.021124948085195677933 -0.084234111048196350091 -2.3192303455929521583;-0.77644251313380352464 -0.42688337173086754461 -0.27717948331851360866 0.38617928687203562088 1.3193835739736456958 -1.1149620220944647109 -0.45940587071482341663 0.097049613307824619812;0.69017263670899364758 0.1237465373268850366 -1.3150210893906530973 0.96623186460569476797 4.259945620105233921 0.77005043054056299123 -0.28069919500487572339 0.48895007682713675923;-0.28998105719248418177 -0.15648595694466821415 1.892386513567924089 -1.1136575251956684074 1.0296028579373348588 -0.26997803942934539556 -1.8743212917197205059 1.126011101498065603];

% Layer 2
b2 = [1.2244995370735787255;1.7240255742096848302;-1.6859652748405375977;2.9955118338194455241;-0.035591394805962330017;0.652773702961871094;1.2530830452803853881;1.8228263792664054499;2.4552926353274204807;0.49761090248596512309;-0.72879342603751362528;0.60257497979947027833;-0.77912656292421600401;0.14351715648221477495;4.0746677296925026823;-0.1900161067297716222;-0.56022758159304530956;-0.23158551263845458812;-0.52771068311595847877;-0.28441546790815758206];
LW2_1 = [-0.12438290682608699189 -0.52374576621392154863 -0.28780117886478656652 0.11921695725190710469 -1.1584590825884031329 0.48467659733070928008 -0.26418012040150867792 -0.10843902715424905137 -0.1777049034619999357 0.43569305572615191213 -0.97157097929486258003 -0.43029014024789935533 1.036702766683121224 0.22900574650368149543 -0.035293086325499149758 -1.1919880171805286029 -0.21938346450411225219 0.31899343029996002352 -0.19891561915577493647 -0.33646109528466466854;-0.2216919629893709387 0.73537382746006074719 -0.62030400182206280046 -0.20504396787772899424 -1.4465418028978789255 -1.234303730793809839 0.27917752382164096048 -0.22208533822495696297 -0.41354031592258100325 1.7634954561794906613 0.25439450618974185359 -0.15230367882889717102 -0.041994538001849983366 0.24406715276396764858 -0.6438497365451677501 0.48838259518797200176 0.52863113570507003214 0.97628555433612851377 0.79103700543818100677 -0.41003421076643936649;-0.1284929313516341709 0.59133420553806015363 0.25488977056684247735 -0.127594088909899539 0.32326043715143093493 -0.6463096325922890184 0.39576831175317633837 -0.40977543135087024506 -0.23144114741808902158 -0.13693846688362801278 0.56401281591461915887 0.38293782977996643213 -0.5164303025566345795 0.073396799141685370449 -0.090274653758106754298 0.89980100080412861452 0.24793800573795518605 -0.23474704206712648791 0.24928465710908714881 0.23704126829281776945;1.3464273690862997856 1.572112135123332477 0.34236090406874603032 -1.5730890874457916784 1.5144657741548124275 -1.0900592583783093037 -0.60728584710942268288 1.3475303853224136486 1.3442776713341342276 -0.23835918201868558364 0.8123455783480573178 -0.22141329165987552741 0.047810303597911614493 0.98451148671032473469 1.3460338398468825183 -0.46117857475269202761 1.5961817905509763094 0.1215787206729491976 -0.52241688445920064776 -2.6243568121554177175;-0.43157271429606985924 0.067937349200577062946 0.45032079301390648407 1.0798550665476907007 -2.6081034481645493095 0.49241850942669862512 -0.6861284182113144281 -1.6699203301227127927 -0.19423068194247425367 2.1113124524919961722 -0.32217753651118341551 2.8593494838711404071 0.55125116932317941298 0.06909045698469462593 0.34737400105237220549 0.079846716624959984676 -0.2016751656182511343 0.41550939008350701309 0.22915746624822214139 -0.36492833760911042029;0.0049371824516821075438 0.27768483266640320295 -0.23884622828111040649 1.408973502072702555 -2.9974201569926490762 0.65638266335685968578 0.69630109100932036093 -0.39232194060992042761 0.50632827623818543739 0.89743333045267514869 -0.64696716845279778063 0.47997740934232918653 -0.58705278907770297447 1.2581649565966774862 0.71220865934160104693 -2.4436508256722393462 0.12920993376522924012 0.05979470931627981628 -0.024794830704123364123 -0.27678748413419285157;-0.24689013607090878888 -0.079596532401185957073 -0.16482341834207692166 0.6313896242632384137 0.54850851641176234796 1.4798483104735837834 0.8235621758911955137 0.1500210907485345635 -0.88828024540308891943 0.56425207972557578362 -0.50333200504679465048 -1.4668296497222772512 0.64225374447305261238 1.3249421483506340635 0.034789029223506753863 -1.7942482099674077478 1.2830185518838594927 0.51739638226903428286 0.60870774840099117764 1.0676309380654802617;1.3402812583526175771 0.99939699519998770327 0.69761046423125716576 -1.9930438823188056929 1.4692909302133090321 -1.0067321418264996158 -0.73742692754997440918 1.4753820699943225314 1.329634644401091359 -0.88727036032732597981 1.0207172188488122799 -0.04919544048200648334 0.61596958914551214193 0.70500456517765863751 0.99539290331913121701 -0.093831300496872424577 1.1162467636502340085 0.038095872246360767965 -0.40618805188354950575 -2.7364525611820180728;-0.53468108080213339051 0.96420551391567288491 -0.42431577706083711821 0.74297753783383213566 2.1865202525031706138 1.8102168722644975674 -0.49863025462259036313 0.012733365020898092246 0.44957142726397464338 2.1973320596765044677 0.22426977061387051715 1.5727323088039013577 -0.19588657581108495642 0.7897802585090663019 0.10986070674920001 0.56911025567384376789 0.75642057582752020295 -0.0070756347316133817726 0.3779015673637715067 0.054248430618383573776;-0.57189075164456482092 -0.3280819815490930158 0.043030473399074183061 0.4375879879397389649 0.85919370630688884916 1.41393417819610967 -0.039982073540858427407 1.2161923478525487052 -0.56743666492117439404 -1.019432991813115752 -0.55873893709832944676 1.1336182617019041619 0.95768361728138273747 0.9961458499352827678 1.2341343341204444872 -1.3278593156341478299 0.81019832329971563922 -1.2856427853695648889 -0.91830857211657257455 0.072964814765056618118;0.35923924586174388329 0.29535661017584730059 -0.88228797730983909986 -0.6684475548720797411 0.518237869811684293 0.73813146816169528108 -0.21536921439322675997 0.18910244268068074347 0.53902740213557331916 0.44264761252968737315 0.7924437954258057859 -0.88528750179638293627 0.93451548254894667433 0.90990484897048784507 0.5414257398242428021 -0.82648786509676830381 -0.45949049810290043538 -0.79389984514377986979 0.31279576678094944686 -0.64866987668847342352;1.0890862233167337703 0.4261999279380431771 0.6326852577324671989 -2.5711818715250389644 1.0528490259104461568 -1.3463793768199738832 -0.81809596096018843969 1.522871090712063058 1.0839150798868395498 -1.3769825073142278882 1.2405707403438250847 -0.35712392964780831361 1.4323746323544908066 0.48394011815456733361 0.61307329341796812372 0.8025496749831055876 0.77794409926659913168 0.18492598125716167012 -0.049954671732055901112 -2.4072571807926927967;0.97965909470697110084 0.54928351069901348858 -0.085344406933784699998 -0.27579355943804723106 1.1726440243995928103 0.0033428989183443020422 1.0150202682517313058 0.17184839025274328828 0.168812213802750688 0.84056860556566259657 0.43951901204154247838 -1.3331532695079089113 0.073721970410643142269 0.34877354577315178297 -0.23345146569052152574 -0.82886490965972425826 -2.1936783884259738464 0.19147159753889494982 0.19037479859937866955 1.2089587889670578846;-0.74680064913596289067 0.14948970411030418348 -0.032602467859297649955 0.70247590416351446407 0.9727909341725985426 1.3445973823880836839 -0.10437278197113783462 1.1966083900714421517 -0.73261789863231185915 -0.28848655050954491452 0.061401147945653156146 1.2722842623414285512 1.1010533253846881419 1.1685840653791834676 1.5319815623380166336 -1.2683847823676708266 0.78144860594546261545 -1.7906205352720006019 -0.9051745158923283352 0.00018102269644533123096;0.63958980931579534346 1.6687061202911357416 -1.8331503600327099246 0.52941119808561176718 -0.44352501881189526634 -0.17358095250190025416 0.12273244639314700999 -0.20056215312437328246 0.55985389721436640276 0.86262326474370043528 -0.19550825370202029596 1.1958012387616412386 -0.901231304275656675 0.45164024810998021353 0.83959752415985278162 -0.62037841386152725587 -1.0683202595850196381 -0.22887602871228696078 -0.39570715791835220365 -0.25682865954162276134;0.13093355722594410273 0.52223802927176399269 0.27232421638914589002 0.076463341643861898467 2.0073380365949136106 0.57584430709243394908 -0.28201172683865816104 0.74535136112850852719 0.6712662091590521074 0.63070990123385795023 1.8429377644829441074 0.42773513314159261611 -0.350122537798112754 -0.37167103729542116941 0.16451834175752377831 0.87429664110934346422 0.35634171151772164876 -1.2574185673808628838 0.5714381246488007271 -0.029561861257439484701;-0.11627123863324109743 0.53008459867652657493 -0.37247008176679619051 0.55225635389160743216 -0.3234953780900968745 0.26909533240358851636 0.045579151844123082238 -0.2942032446466832929 0.22119874572251541078 0.77759614117414355139 -0.56847912786394882989 0.5329864358399232227 -0.77526468319755204028 0.28436555677624053562 0.051471543912194619996 1.0285933916991407688 -0.21444982671674589492 0.39515998561534459999 -0.074567399603334208469 -0.25957851725323055625;-0.17562586098460164497 -0.11486617607057232615 -0.33360663102242693601 0.59294710518654214493 -1.1261678296489729956 0.64135969947814286396 0.11250169693347804312 -0.83733094678745034756 -0.13481789057565041201 -0.06078749309545018048 -2.0698168623950139455 0.29942966268355081239 -0.37157659149644745034 0.65357283651878694819 -0.059227423407138775346 -0.68154254992526031032 -0.31203074372903272238 0.80586901143741285214 -0.52943165247417589558 0.055063222477571491242;0.045515008944121131129 -0.78881731619634809505 0.36209869793619653411 -0.50021342116454892146 0.034485006756580088849 -0.56579550838742009855 -0.10817229084914829762 0.2574694879257974911 -0.29917701535730178986 -0.88907962250786898295 0.51853981332449650132 -0.64287763799288522026 0.5328618339132484838 -0.55911496640881741538 -0.33208063312234087361 -0.15100994623218921831 0.15379025667356061025 0.15835161554731069788 0.066269293675491267037 0.24216520110803116395;0.54821375787995030304 -0.23894514328347582488 -0.52412362996513395252 -0.87159866796838914027 1.4150266055356344186 0.89720154007315611189 -0.58230674113979852269 -0.048522729960746004141 0.98735181444621511471 -0.23925071049798771194 0.47404795560783402619 -0.67331519721263866085 0.45831739296639723014 0.087119427157338627521 0.05952548216980210749 0.096999206425734854631 0.15977526791673049567 -0.82930522588317945321 0.22345350630825666638 -0.45719327955558808352];

% Layer 3
b3 = -1.0923096791262840721;
LW3_2 = [-1.8727396846271127107 1.186998137956201349 -3.7505655943073179515 -1.7166494720897020887 0.70061018428089183452 -0.37604059635206166234 -0.43985100855062914116 3.3083812109105714683 -1.6153825285434617598 1.026293330939107129 0.67189194599159562937 -1.7942783310740670899 0.90612190665765734998 -0.76355463694174818823 -0.71365493945873104131 1.680359859722303062 -3.3041218768726277055 1.8142911475841967395 -3.4674235492914280421 -1.4961594936960767033];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
