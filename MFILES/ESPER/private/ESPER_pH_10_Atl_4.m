function [Y,Xf,Af] = ESPER_pH_10_Atl_4(X,~,~)
%ESPER_PH_10_ATL_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:23.
% 
% [Y] = ESPER_pH_10_Atl_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999994516886;-40;0;11.29;-0.2178;-0.12];
x1_step1.gain = [1.00000048738803;1.0003169936794;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0655816826945279097;-2.2291340969663844263;-2.0421924593166638218;-3.2575567019607349906;-1.6691076656965460057;2.4783794403440189136;1.2954337715019237365;0.40382170696620628414;1.5788930694206886329;-0.045513181093771087893;-1.2787144511254462387;0.70319423355185517455;-0.47144526759104155023;0.77783365806980220292;0.045572504418554399264;0.47949367336216663915;0.5573912917483961893;0.31316006224833270455;-0.29141949376130249494;-0.42304992084276515918;0.9966421028730536591;0.40214510751110310594;1.1155946730315802196;-2.9851773662880995985;-0.96609329931554588367;1.9964728842752879068;-1.305581587944768307;-1.4806207651479654785;3.069386212866240804;-1.8246581452196768414];
IW1_1 = [-0.94513987662885390328 -0.87042482784015517971 -0.20386110927215875255 0.53046534115001275911 0.98099217578165887055 -1.0300249842928361765 -0.048326894434815706458;-0.34004250642092659351 0.10253241032550340639 4.214654272571904059 -0.057472265235521402538 -0.3372176016971945578 0.33435269551389323883 0.44376843521746317522;1.1333836279135667269 -0.25895936934911689686 2.2036836853055246088 0.68697884664019392975 -2.0537152348426408466 -0.047097168353731150292 -0.29760315195581382719;0.45132181720474051634 -1.1079452189453928845 0.59997061484331104531 0.6587213472583626217 1.1386059572722968536 -1.675029505661153717 0.20197369143040488915;0.0007518274561094332592 0.68248108673456797657 -0.96490829335480499118 0.63041181474003027407 0.96563249467328571285 -0.62865804227490806877 1.3125608043734724451;-0.72571956639195123184 0.66698405751570999378 -0.70948571016195405292 0.41672143257341526246 1.9970976174298855632 0.14988553726451486758 0.44769465233319444275;0.42022394070263607846 -0.30994972078734073229 1.542087478987768101 -0.56485449191478309672 -1.7441575178329340456 -1.0688293607412426844 -0.48209860777763102746;-0.90928474686673432803 0.42966617495945658156 2.1027172112368135437 -0.94353503707752373053 -0.068432871494567837356 -0.5355358254569901888 -0.16360489385860360612;0.013131410140513860574 0.94775106257128738374 1.1668395667622113443 1.2215642718407793144 0.41770339969496195209 0.29850227174484716963 -0.29393552908800552048;-0.62737756537880828844 0.10885186289401378723 1.0778671576869827131 -0.39456245648274940185 1.7882986596028354054 -0.85228987758218122117 -0.33684978757142253203;0.88683291220623861051 -0.81150395025268118321 -0.84740560853136948083 1.0155574420998108032 1.192004311238912484 0.62408314309286760935 -1.3745789440942035586;-0.67023198389406635211 0.094356225201693469384 0.98954553765184827263 -0.54310205316372317519 1.4166968782625815049 1.1327218109585204253 1.3510132889746193641;-0.46136700992750512285 -0.44354735483326951373 -0.014103619213469042321 0.2694374821240862472 1.6293701517945080592 0.49383468108865152812 0.68942712673201833606;0.11310739665264581133 -0.35347655367302005525 -0.27969356894554392445 -1.1902024671106758991 -1.7791855863720078545 -1.1436016845376857365 1.0218461526074271717;-0.28291130751175719293 0.46009067747682386162 0.3488343485815856293 1.6803944607001664036 -0.3979885637976738888 -0.5254999585537910578 -2.1398341938087201974;0.75612662983867440225 -0.52543886607904377595 -1.293297806156134655 1.6169734120305481184 0.055853160947431319816 0.53531143207313358623 -0.19347377030722909264;1.1258435592262434621 1.2492297770309388483 1.2721100073554389986 0.023804951995104309259 -0.26563960474130809963 0.32344851345074049354 0.070598282544083429402;-1.803409834786581456 0.023028150143369695291 0.43583744005789309961 0.27573592174668504207 -1.5164007445430414123 -1.4982146083692871041 1.4687949613614252886;-0.043955529363697468104 -1.8695374239159097129 -0.65954576290307842523 0.51510443816834972086 0.085532274912143560486 0.18684671064699998055 1.3263314031595072606;-0.27443389110673049869 -1.22592255654389648 0.7112380531554125529 -0.61423121467757058056 -2.7434007000323208381 0.22581101086385940713 -0.92195889903061523096;2.5522242166155870713 -0.86355543216861763156 0.6441331498516345011 -0.74685165635287287245 1.0233569118025371836 0.28227800773033867587 -1.1016428633848589502;1.4113874557687067224 1.2717913233322821753 0.28863835214172306465 -0.2585217554546482277 -1.3252928144762834428 -0.38631564034914439576 -0.30205133635895498045;0.90606688164403315078 -1.434863880644946077 -0.15626530953698763993 0.5387023650353492954 0.30321683303956703526 -1.7841521155807822385 -0.050227472252499884287;0.16594493672187088373 -0.7807672370807260398 -0.11210257682794759482 0.26531867707096518094 1.347051359928744807 -1.5334041040824364366 -0.81769610793266100934;-1.4043142565199209226 -0.4581508332136780548 1.1435175638139942755 0.42165196604436994132 -0.99611369019515516587 0.3377644181194274231 0.51912896549370401988;1.5082882267249964059 -0.94392921280556829622 -0.9033825896942497824 -0.12080378311235454025 -0.41501934015343500128 -0.80681746555828892653 1.8713423556182213758;-2.509135918893383721 -0.58323649019233847479 0.80706467508155310675 0.45704755142314157368 0.020873291824713268577 0.88058421005845843865 0.92804998160720253431;-0.5141084660047958721 -0.66697076951615219542 2.3245280327183621694 -0.74670322786575948903 -0.47442488754089096048 -0.68164027573831498241 1.9076067381456376371;0.13472991050222205001 -0.62644901240214978522 1.5584344067124953348 1.7569617365091327876 1.62823167292027704 0.13908191055938379233 2.4298143487326844259;-1.0145438671057569469 -1.4532165031216284223 -0.60617260924630755881 0.2458725969812390888 -0.077057275072854661269 1.0070682466890330531 -0.093211707752892031253];

% Layer 2
b2 = [1.2646457799125383481;0.68481337824926080682;1.0382579682410983946;0.041390493445945579498;0.45639822303211668997;-0.36021897580848372122;0.58079357558634070458;1.7939227740584935411;0.89279014897124842065;-1.4804025614847640124];
LW2_1 = [0.08118784139510552833 0.37660781741006921219 1.1428064418137786618 1.161306365653099526 -0.30825839622931194839 -0.068371036969140125406 0.67224573205214754879 0.063608813312760359437 0.081102989195945551781 -1.2769479233737082158 -0.23208593241025868292 0.55900987473823837703 -0.45861446240144321251 0.19993392732153886238 0.63631913580121945984 0.73497761155945717793 0.18918662093113872147 0.33413161934534574282 -0.36329264545106509932 0.55357243584301418782 1.7448194412558346578 -0.22330104202851469575 -0.4216775018925081886 -0.41283086256553341853 0.2552112185510491682 0.6374200378697453262 0.30823960064671740433 -0.81125640346613059339 -0.050100290599972688299 0.35167975128793499406;0.1046170451805715218 -0.76297331780766131093 1.2486024549642438242 0.011573212313004328441 -0.17155531596899709079 -0.28388596795930104433 -0.56181754548771178914 0.71558183476574255266 -0.090920404428456252921 0.55321251217389366683 -0.36962908257595017414 0.077776297713463865557 -0.32861784614261901893 -0.28725039235121885284 -0.11527228263328624658 0.20722566441713682894 0.31753258723008570552 -0.76825019722291343349 0.54431929352658603438 -0.79511669057921108283 -0.06800450159283456808 -0.18798523307088732537 0.25308727689014920426 0.16713782981593025556 0.034330189959886653339 0.69501269645635543881 0.23407393268329476643 1.4834465058569894502 0.23382448422042648173 -0.33694620895874155542;-0.32077724421808812005 0.95101861406989951497 0.51075258154186020665 0.37454702543406481752 -0.61972345958739993854 -0.54095593011039155851 0.001733674017655296648 0.011142687924503841615 0.12376388873602599261 -0.17885444495749733274 0.67862263048559556822 0.68367333397302287867 0.6825386555693978563 -0.031726801152531750039 0.44356384199676684998 0.22380178974480399723 0.065670631438810148084 -0.48983438307079618657 -0.041466800999253462801 0.4450021897740374377 0.88424275690909637238 0.16546301860196213629 -0.22300365565536880985 0.38245836422638002094 -1.0070294257625680423 0.30900790909127240358 0.53668920603582459528 0.65593219743433350821 0.016169668413589063927 -0.29536200052892469525;0.34839842585927738305 -0.11393864585037191683 0.053396614344569319488 0.64215501408574471309 -0.4289189458813624789 -0.53816945638190261114 -0.30885581368048914408 0.063458309086681291555 -0.059271970374051956287 -0.59050795459404159526 -0.34476452797922602089 0.47481902434787881528 -0.11099899944332801416 0.63131363118791716804 0.3632928140822427876 -0.52860250318006241077 -0.62584798711995215381 0.086760724247337689397 0.23389089853624442372 0.17299146685549915414 0.22982178808110798052 0.69817775598336384579 -0.53580965563287885622 -0.59519281668866497181 -0.066298828119810249149 0.15570221698800543186 0.15767830740952662461 -0.7613521194983158269 0.16188489784360865498 -0.16746518607494556563;-0.34578051166034828867 -0.084953913111392082014 0.84876288188588588923 -0.50690388573853972787 0.084101073838940970662 0.50523953473457672292 0.5189903916073610457 -0.26351886364823423614 0.52588227954509048079 0.26736084299577994594 -0.68826484098330564798 -1.0839721310293846113 0.49955182810396425719 -0.064549949336293377389 -0.27802207635231662719 0.92688087522118933759 0.86448470038851055186 -1.4469255064503845354 -0.31271710140637881681 0.22505457515552976244 -0.19035167247016732128 -0.88722333905442551938 0.27293015721073021762 0.24971858809600619433 0.032674738380591601683 0.15144820807405945384 -0.072587965926782710424 1.2580094762522122664 0.054757429754808378819 0.49469681518745983739;-0.26186331746439073243 -0.34011707990307493699 -0.85516002525190581984 -0.079118194979465608641 0.025853580878625305461 -0.91178715038923840996 0.19661626551339633773 -1.1257534791285850329 -0.33689778265064862506 0.34039788545664051433 -0.46479931415443198617 0.39682405564963335598 0.091594755319178836062 -0.31403442793501673558 0.15008831083652404703 -0.19359770683515628575 -0.26400279007117793961 -0.34993194251062120781 -0.86049566222642825952 0.77072722485721267827 0.36137057831434643562 0.010872049353233687041 -0.72119288418448446176 0.02514336599746649567 0.031894994869939040372 -0.51075210293530126648 -0.18915396827495459253 -0.47291488770709300127 -0.14081324380545220953 -0.18461037140090286179;0.56472408014015584854 -1.1292592406832449026 0.66866260338613947578 -1.2827211937441027612 -0.19520927039074928433 0.11541581322609026361 0.42496244643733571689 -0.43788497866337738884 0.38965840526805772814 0.40663212840287010774 1.5710303022507132731 1.3185271795962907326 -0.47955795026281633486 -0.6229338938275819082 0.32367465863624167444 -0.79729274920492432255 0.13563131753525131673 0.5141365093550573917 0.65163061150881773642 0.24017100588523246363 0.30833158447675057534 -0.02733873248282328583 0.021418102896637588456 -0.14789224339179937728 0.14694562294561439031 -1.2912541810241700002 0.00080714183382876378281 -0.094102345767480888306 0.42741902662120967449 -0.0614001794499437481;0.93074958218484571404 -0.42008764898418399225 -0.29832414748837371432 -1.6558985521802951357 0.16360736904499076361 -0.50798089032024751344 0.057339893222508389603 0.0057538422344407969683 -0.96404329049396086937 -0.072251624188658325476 -0.12005476912190506111 0.74259552639862769219 0.052534623115761812373 -0.94284995058978504634 0.27168490646793191923 0.80834131909898132573 0.21235857003788161101 -0.51695690338315858359 -0.60970635330702904753 0.34810861772146528548 0.059152302889616807657 0.13534682422266133828 -0.35908983568171903844 1.2089623771659148144 0.55935550959167135154 0.30740994006175431652 0.30886610682078730061 0.056011045986132455832 -1.8011890782858406279 -0.23985363351227956263;0.58115628186910450736 0.14614095096915086236 -0.25800469614818910546 -1.2059841725131792423 -0.084446032597407322262 -0.87034348241414638547 -0.61966885253358172658 -0.12426567751565512077 0.17777810324861431646 0.55085714237487914957 0.99523051646234883538 -0.81483527524818022414 1.2569089574366765216 0.60126573989986265012 -0.41586369139332524103 -0.78408858483270638118 -0.056181126050119517545 -0.5131837788574368231 0.42340692535192814283 0.1391747431613390984 -0.75213443123589274197 0.65972951190559070422 -0.12208393509866444226 0.45466014329864706811 0.82682298564449807632 -1.2919939044766317604 -0.53903500413288152338 -0.098539232574845841972 0.21106274922122217341 0.13750015481255004057;-0.37820313500499352921 -0.93084892181398803945 -0.099383875226060347519 0.058005788562560570143 0.32163013629590275766 0.38346843494873494862 0.5015568307110505053 -0.4298180742962150469 0.37461575067533797734 -0.25323268578654550831 0.74887222403191477937 -0.21714065159293424734 -0.5294441236398786943 0.32908461535448979562 -0.11846277087443635168 -0.55155918896800892881 0.33513531136501117924 0.37644495781823172909 -0.30233215386619005649 0.021733545135850535629 -0.30905893833909225954 -0.36048523412305755187 0.33544316491148457038 -0.050537691551747837559 0.3288788912659754704 -0.7319553095071043014 0.0071462813096458549511 -0.13884831164216351884 0.21439712589496673356 -0.25401372717069264917];

% Layer 3
b3 = 0.60133768886152427768;
LW3_2 = [-2.2625014152587912264 -2.5192581116751671111 1.59999585947069356 1.8693803664216865901 1.2994991352887157454 -1.7418228866937115473 -1.1646190561021516618 1.8567409302963839846 -1.5384900451942482569 1.0057216945287230647];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.03830178109291;
y1_step1.xoffset = 7.47181919175367;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
