function [Y,Xf,Af] = ESPER_TA_9_Atl_1(X,~,~)
%ESPER_TA_9_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:02.
% 
% [Y] = ESPER_TA_9_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-0.2178;-143.241523403244;-0.12];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0479365703301392;0.00458552991639557;0.0145655815308426];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.4099166983821902477;1.5055766365618172831;-3.4787565579579173836;1.8159629842783666653;-3.7403432585813325417;-0.63062902651238572638;2.22333689590408623;1.4634497855230597096;-3.4956298844234914291;-2.1923423981882601552;-1.9992232425999332257;2.4523967927220287066;1.3226704748636060049;-1.1034721905565005873;2.110402430154272313;2.8645935162828362053;3.294093848828157256;-1.2776480305380129021;1.9487015197710377823;-3.5714842784277229804;9.1287950414297736046;3.7258680763331977204;-3.3355407464439617016;3.9565538715237722478;0.47572686708065181627;2.2251676614350754946;6.2211775396756543444;0.32130463347075333136;-3.7502408596739043034;2.117008566590087959;-0.63158338635635835612;-1.5849004930799388546;1.5293410017272845991;2.4115247817085432303;-1.1377120046315705171;4.0081921383326664099;2.3861563404455399251;1.6955699946076907558;1.5685936859626348205;-1.535860558364078976];
IW1_1 = [-2.0035353331843190894 1.785061052429352868 1.0238061412706453979 -1.706866502905709071 -3.2042777551602519281 0.040843047107463982537 -1.7766724455730082965 -0.4533279338595008201;-1.2361720966057816451 -3.2570499511872839093 -3.9954226034243731647 0.03029327298342686034 2.7148947236451119736 -1.4321173256252528461 0.71641732670106028635 1.8011165713951964307;0.79853968135219199898 -2.1166284497685587951 4.3665725187768904547 -0.23344112929082316832 0.79156534814709889059 0.14651329216495076468 0.46946987260224276595 -0.11510192468769045449;0.5955986931838647136 1.9678379172071402969 -0.65432051677568781045 0.021918259874428976108 0.40318367750022765517 0.20221770753029280621 -0.16632836923663571471 -0.1739755441102450173;1.0514539333708203817 -0.058175607692205213994 4.9175873836338350742 -0.056494571552465962239 1.2381638320094241479 0.38537128549555493828 0.20477778576379532249 -0.33973042017900867418;0.88535484293051813776 -1.8319381160432983702 -1.6650468863519756191 0.047969450686740008893 1.5456654492359400699 -0.29231036526371345641 0.00047803696591902731378 -0.082247802003139483529;0.10090740150888824478 -0.17987693830190226718 3.4663074984005568524 -0.11114369814930998015 -2.7769188553926880125 0.060472186288790148734 -0.09044605040479174185 0.13843485979623512683;0.24009360622651457207 -0.4811890150520731213 2.5498479803013678335 -0.10198662589479429164 -2.328961494101076557 -0.073073028127713435254 0.091692908498573713616 0.19893613054482267577;0.48703062675825486982 0.53862624382422619185 0.22034989171510876993 -2.5595497866651313323 5.1333992313168002042 -0.3651889931756827079 1.1099546185168331913 2.9869355351088140438;-1.0995296212482810194 -3.9673644135379144693 -0.66520277079013301336 -0.010509570237002701515 2.6883615454537399536 -0.57096793075044993682 0.80234705495787739249 0.22822833769513845015;-0.74336731556224744377 0.65645421983896679041 0.30977066760140525847 -0.66625257091866163517 4.1246770403832524465 0.0019867965800216278241 -0.43773024167798685324 -0.5428584424244262685;-1.6995161111734320425 -2.0777038871484792004 -4.7326142288336869868 0.50300724752893821723 2.8205945456568466412 -1.8847669905531536649 -5.6829830044972595715 -2.0933035195073901313;-1.2252620416240911361 -3.3018312742987991903 -3.7584213568465032473 0.026699066695103832597 2.6292534766880053532 -1.4066662615918108514 0.74548713408935507463 1.7251379152182069188;0.65063177969062280237 -0.35176938246487132744 -2.4839109688441234347 -0.17140572719662638956 -0.45937195904538552504 0.094894845227082955108 -0.22447512036244418598 0.12221520631358509523;2.2720696979161565388 -3.7101042092202445311 0.61502634993581739575 0.12343955418818461367 -3.5766649766543694433 -1.0918583017627492282 0.66182010861034423765 1.0656564498679224062;0.014114303127683377678 0.63889041695310033742 -2.2040287759495407194 -0.052540991208450217587 -2.6551246755914372777 0.15940999270828110079 -0.39253893375439108393 -0.26763237067574974226;-0.19427444809009969395 2.1616447844602206807 0.84456194933095041222 -0.072396179604100135974 -1.0556499085471757748 0.030727664915697783243 -0.3726141702253264465 -0.048182180516509576229;-0.036834326650702062245 0.85532577643845109083 -0.60671170782820627032 0.060332285824989902168 1.6204713879917731489 0.21573644317955167904 -0.28322540571182241997 -0.021756639694552618036;-0.23390125609979506294 0.075161722461436361598 2.7429665638242917147 -0.014882216529313143857 -1.4130176024144327496 -0.011176912888239746297 0.043892706872073472546 0.096584495900724959272;2.756707677345069829 -3.7213576414468652054 0.96173798403875088159 0.069323570304418880017 3.3069424863535923365 -0.25232944561714809595 0.38959255006415166589 0.78336024970803530554;1.1932954715019368219 1.6782419997747570761 0.88844540775751978945 -1.9652313009101121111 5.1064301913923015874 0.29331462984657408199 -0.2634562254365594991 10.155140764806901643;0.48186365453399249148 0.41779066327694619476 -0.17002812618502805009 -0.36874115663322276637 -5.6959490984388576607 -0.29946694078112018333 0.058333332448683578031 0.66678348319850444526;-0.95310412320967030642 1.1789776555003650405 7.2208775830220197633 0.069002770891053402669 -3.8624298306859206065 2.3730058239900153616 0.51100873193464757538 -0.90157752849797723194;0.64379776515387698854 0.49104428214980272438 -0.033177521344655860891 -0.22402643854232581755 -5.8138571986977085615 -0.20191252215199109732 -0.060870242227064247365 0.59804200347319746989;-0.50780343544028228031 -0.26658088473118091155 -1.3977141064171634266 0.91916427787955190531 0.040436353462441364248 -0.52837983102250785095 -3.5191723167741786327 3.357662944165854757;0.42245123596392664123 2.0238683829775330203 -0.67274270797619217799 -0.015334815478045655049 -0.0043468154547978976598 0.17796711937774736811 -0.20278883127392227648 -0.085219454884666520633;-2.3390832836286974405 4.8427272326236563416 -4.4536712815029000367 0.15772962824905062407 -0.70337001012504218878 0.32541565221344304071 -0.95747892418725422115 -0.36698080285464046435;0.38412873452997020607 -1.0390805092527208853 3.566890055204921417 -0.090422617873843744163 -2.4043164869380153625 -0.22676596660113670922 0.31436324213174876574 0.40040876730243740722;1.1476155905613718566 0.029685579250975164395 4.9966260797022954421 -0.057670938699371308844 1.2477764361716139341 0.41328889230044235648 0.1921112014876887597 -0.34412962796701501711;-0.49290354181365353403 -2.3182921620362515469 1.6599563690784193692 -0.71454703793170848414 -0.83854124179031819253 -0.51279919330640455488 -0.8377243224666617305 0.3655598676240601197;4.5655056716815698437 0.47463958463640060215 1.7524923854618799091 -0.1527164616074089265 -3.4247375067354832723 -0.86552576919891499596 -0.42584081549684321688 0.97201728589964586646;0.17559782527914968853 -3.4112726087692504251 0.55562200860943811165 -0.030868980633465391977 1.5587424895707602257 -0.44169618043264191609 0.52505955164707307503 0.28504079798915676891;0.70442075921401992034 2.5748854751923593298 -0.89392643458722054195 0.1061212833673852024 1.588449156687701036 0.32827892880108089368 -0.17601109441973472602 -0.5242302072227991161;0.8158955630274347115 0.88773924676916793342 0.67061144961379726137 -1.4024727387297870607 -0.055943076234460792362 0.36442274196540480613 0.11259672415226998354 -2.637163224109521753;0.27861252672490871563 0.52357328754657495029 1.041225513491697896 0.11199915607670772599 3.5247180561097581908 0.18284925439717369944 -0.38568833264188923104 -0.16612466749332335803;0.45359079420841330599 1.7391862232537327326 -1.2917340239504591093 -0.43162832399431905195 3.2702991613836696061 2.4167599924342142437 -1.4522457234065355713 -1.7315282270162735134;-0.25789836067717231138 0.41745046215098469133 3.4863962471575375979 -0.058138151783236655112 -1.8997380033487374362 0.22092334305391317373 -0.29001695162788898585 0.043486530208565812861;1.0772190098554408344 1.009601656700645167 0.1023840967751371428 -0.099701849185629937145 -2.5432977104643130772 -0.0065940263623410679678 -0.1237779825401664896 -0.37084092688537623195;0.32472414243735997497 -1.578764069090614397 1.1767593600541723653 -0.10023269775914470103 -1.8574111610036581066 -0.37517599922276773095 0.37996497742594070868 0.12725676763608539943;-0.52998388818414454704 0.9303362126552806588 2.8748673484261879629 -0.90843447325728643449 -6.0279755158760419675 -1.7951108611317592167 -0.89989236147590079273 -0.81945127816615426219];

% Layer 2
b2 = -0.51892634042964536079;
LW2_1 = [0.029878003048225243443 1.8127340056784722044 -0.14688992072253728716 -3.7939463177977343911 -1.1990842169035229592 0.35985524542510960444 -2.5452768410329187354 3.3863043717652585585 -0.020334893766431844792 0.13205612942419672762 -0.14247476275989742756 0.022833014492321820899 -1.9216987858682830215 -0.60184726225079498985 0.10255499802908291107 -0.38018419567500361111 -0.38158382784929317788 1.4676241045929421247 -2.0744420983081619525 -0.079470107153176761106 0.30478578970448860774 0.70411192114053189339 0.052200173097671533073 -0.67552415183966907364 -0.01937648544492123065 2.8058217424090163838 -0.10471827838871021477 -0.59880457522800367709 1.085605678291588605 -0.070405970485972038664 -0.028565419051060383232 -0.20807698266308299884 0.98473035146197396283 0.0064502404787924452409 0.25255538020062512361 0.8715493549712062249 1.5175243676751031252 0.1895454554482955134 0.94281827043513743991 -0.025772348174865487153];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
