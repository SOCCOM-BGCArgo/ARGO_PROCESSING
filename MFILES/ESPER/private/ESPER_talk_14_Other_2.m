function [Y,Xf,Af] = ESPER_talk_14_Other_2(X,~,~)
%ESPER_TALK_14_OTHER_2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:50.
% 
% [Y] = ESPER_talk_14_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3354558505778789;0.91301263755097783;-6.7206469594229885;1.7185315815399518;-0.16628514225389604;0.46683115462661368;-1.1542224293894428;-0.17230546956354045;-0.044304396056057634;1.2611611942258774;0.4417792942320784;-0.080437173902293407;1.1721838527773729;-2.6197400826783119;0.047965469222141635;0.046044339053317188;0.0088233076918313134;0.18509747264786486;-2.1057555245420789;0.71533916118983176];
IW1_1 = [-0.099492674125056926 -0.17613920366130784 0.99112521132464471 0.49523331386698594 4.0765211071931757 -2.9111186291453164;-0.0260726967271637 -0.14987541560578344 0.44856288883719325 0.44219857784419936 -1.3179281891454742 -0.56525902229361158;2.8147524288638262 -6.4617991357207512 2.1280526184418154 -2.0326312635992156 0.074697565229487728 -0.55204206837531966;-0.82144084933040307 0.030065272726922641 -0.99006536664062772 0.66360907146049164 0.27653881248609558 0.43507233002479956;-0.017187571233717058 -0.12741360843923111 0.23527274446876562 0.22046787340660237 -0.9490192000101475 0.051723759779172922;-0.84148433656689958 0.3902831997180562 -1.5022844211344444 0.069810590362236663 0.5049770442690672 0.33510577312193551;0.20311856182523039 -0.12808782740276817 1.8740659298920122 -1.6974784822714695 -2.1693419075703093 0.82087643510430286;-0.30296468091092393 -0.29568580386270371 0.73403432506821664 -0.5451473040536492 0.75038859115840817 0.11379653606968225;0.22846543771207575 0.14103657779858167 -1.0226987337978366 0.70110535312771183 -1.4648353459741772 -0.54408946613015619;-0.79847251581156642 0.41309125517162315 -0.67657273524457906 -0.65896042309830871 -1.0604067920757763 -0.80899114165746355;0.40840610329595178 -0.89990548677746851 0.44078493080345249 0.023125586737173021 -1.6346882467635184 -0.35542205912551883;0.12463794310183042 0.0043456231425964154 0.23863657170219765 0.83416217812033067 0.16553323281106092 0.92598982860165202;0.29215420753356702 -0.062983410119824071 -1.221429215034983 0.87967426682817729 -0.86670688845101918 0.12574429581535129;0.084626030219342951 -0.12606039782492939 -2.6111583529848992 -0.26451972669696511 -2.4799975322896231 -0.32014226330551454;-0.17310671864191346 0.51998789221292463 -0.13070398330759417 -0.3209702268391898 0.66833992994807701 0.11414767401825883;-0.099521285925865677 0.13447566456274357 -1.3120962933836939 0.48869353007071603 1.2090721112967198 0.41381539968546588;-0.15400759485941304 0.043443746149998429 0.63904060067005453 -0.12621498838131273 -0.60664967543253623 -0.0093858230426158724;-0.10899231665138123 0.082383710502036994 -1.1395744417615994 -0.59664330514017649 3.3243993350804995 -1.1042284000644274;0.098074080185457851 -0.019531365193791572 0.44204598440687631 0.92028313819190299 4.1131959105795186 1.4758002989887473;-0.27743886355730951 0.83301247176064575 -1.0729374769627777 -0.023142478687347631 0.78266198024458145 0.3933260789116319];

% Layer 2
b2 = [-6.4339089810981305;-3.7545463655648996;9.5225879763440204;-1.3966226716031642;5.1856071527598733;-3.9692029058999152;2.4235376189858053;1.1290461940225898;12.688451145951626;-0.39302461114967691;-3.6452353491627649;4.866344040564119;-1.5593750968802269;4.3374733414312292;-11.109857455165521;-5.922441078969884;4.1508287017864669;0.76245056069134076;3.1328533103357725;-1.1541185234379936];
LW2_1 = [-0.89603033224075412 1.1705887344015244 0.20275808124202371 1.9253431420837881 -5.5223198972475318 -2.9931539182160511 0.16592060303771367 0.66823977378146671 3.1448682514881297 1.2807483670938928 0.6046301922121522 -0.46999255860545402 0.074280963478186385 -4.3912771016201422 -2.5132501554173112 4.0682845675834649 6.514617119673586 -0.084286261502608692 -1.0759513331123827 1.5541053484152745;-0.58316478917937042 -1.6965378332555825 -0.8275306417266064 4.3309270713879862 -12.913023681769886 -4.5601697402390542 3.6745418305881294 2.6882335592059512 3.8022410285675541 2.7893183441559803 0.99001704496462195 -2.5844627130736941 3.5599647321640671 -1.2037092824978803 -2.8913501465175759 1.2380550253356475 11.591197013448722 4.1816987714331315 7.377073517413999 1.2293233878314529;0.69249726259236433 -0.84370306069237899 0.13458181440432446 -6.5070151043288842 12.20314850111169 5.5320780805892191 -0.59725517015345098 -0.83532083659136325 -2.4505598843908523 -0.99633176957858394 1.332387574574913 0.1441764231647964 -2.3206563081104363 3.4082316044646066 6.5313482733402326 0.32998089618102688 -4.0110202143351428 2.025061688900665 0.61316131050155465 -3.2687796961915456;-1.2215415357183081 12.069856080671038 -0.78505770477833281 -4.20178998414523 -4.4346072953813866 0.16273778086969903 3.5369257947248043 0.43181529242802363 -4.4807381679582097 2.3095936511420856 -1.5008583856580675 -1.2194127226259657 -4.2377875117582651 4.8974146102658249 -0.4551462461862007 4.3359295281798413 -10.671610270970669 -0.31181162481387581 -0.9021748382076592 3.3229126776943847;-0.20455732118669417 -2.3584504560094812 0.10606983061010064 -2.7461325551575633 -2.3543978394969369 1.6225659609519036 -0.29512010116463055 -0.16696478167253442 0.30408459462417681 2.5547411162789251 -0.32807653172068174 0.98457708421633305 -0.32202365412046147 0.1747467093585385 -2.8261572262338457 0.077923156006986183 4.3685677910686831 -1.3935365574072986 2.0103379277113609 -0.052768048090927694;2.0857672924342787 -0.065790342057592238 -0.024530472851330188 1.0316596209601865 1.524517088855869 -0.8071082131681836 -0.26730902330463896 2.039665482989975 0.28782280021862877 1.3846544649845887 -0.79357498936879756 2.1819196175135995 -0.036286735930465504 -0.39348676041439296 1.2784136801138184 -1.3197503286947831 -3.7871508141450017 0.74857900497424945 -0.023053089184069342 -1.449314711427319;0.68932559803956772 -5.3692562913685347 0.095255003271744881 2.1530136856513553 9.8992024181390921 -2.0684828581006847 -2.0344206502896869 -0.41875854617587244 1.4766770808358536 1.4313272554345589 0.25601714125298913 0.71619451868902162 -1.6358888525548385 -0.15800387563509027 1.698694275963712 -4.9989620142990612 -4.1150428465805087 1.9986601562292494 1.1693200658717549 0.7883161952994524;-0.24385760740797974 -0.85344953722415418 -0.01697086327462111 -2.7747284441501203 0.077927550864625467 2.5452210122780929 -0.12319576170490903 -1.6196362559263726 -0.54749967405078315 0.34442030923800188 1.4305435676004328 -0.1791304566808419 -2.2924300084829512 -0.75849160712271146 0.2549196659270056 2.4472987538392941 3.164146731107885 1.0391743543667531 0.39155931601070748 -0.91954686020408383;-2.4350252238489758 2.490185481346689 -1.4264499854017163 -11.602115770232665 -13.357233211551621 12.872180733208362 -2.3737583665005464 -7.0742355622692932 -2.3494157742976229 -0.65562284430499218 -2.5935190397677101 2.4159975395438416 0.81740468077969475 7.7526322546922302 -11.698323750752701 -1.9984161071965583 15.395051669156917 -2.3417334882304215 -3.7443923673045858 -6.1214138398244806;-1.6788901582186468 3.9027892275645275 -0.91539564088968384 -0.06786004036700452 4.3492532680585363 -0.29882935016888246 -0.50706555873474812 -0.82125283590270282 -2.6925508376835623 0.053683688382526337 -0.57520012379175234 -1.2572328907816757 -1.6895327699623459 -1.2818374971063715 0.031949067842831108 -1.3211334586578509 -1.0619460058321479 4.4034044590327808 0.43342765572496733 0.03078121022009251;0.0098730795164756469 1.5894159653945628 -0.25334513553310817 2.5918886596567852 7.4673266167195527 -0.81533003899182099 3.0957190778076638 0.79330741003105587 2.4308516737226897 8.2001103656948171 1.9192493419070726 -2.8202004353624965 -2.1377921704653109 0.88015458046392914 11.632919649874648 3.4149418814222963 -5.7213268693139918 -2.0722334175962991 5.3432565488431552 0.43449786136860025;1.7646709793358017 0.094789649459063041 0.65107194297045901 1.9587633285033133 4.454804653818135 -1.2620253151799694 0.48770215586949933 6.1416107657656509 0.87196386274297644 -6.827941388440566 -2.4507577221997079 0.98107649338138703 3.9268480711601139 1.4630073623518518 3.8825672025999527 -4.3725532948943755 -9.0114259913923043 1.2328140515512325 -0.8045359874842879 -2.0255328546213023;-0.30899035017465498 0.51481810951478579 0.1792580172712577 1.7293738544455524 1.3979460586208101 -1.6063247655646102 -0.77030004860405743 -1.8738104105314075 -0.35101507110077679 1.1805539450980855 -0.66685897179063036 0.13820862997452432 -2.2950013595573142 -1.6873376356673599 -5.7383509319447388 2.4081406021523661 4.0770835562554355 0.69504116458042409 -0.5104404735849627 2.6657527238837679;-0.28762042977929486 0.87598613531619607 0.013447101098497987 -2.1550532759937342 1.7251896292790005 -0.20108325202877569 -1.2728031786909244 2.1475026811921949 1.6750559861991405 3.0427444251152345 1.2358472205219739 2.8191526272475054 2.9666027951438885 2.9514603788800118 4.5780497420469519 -0.85364430376889544 2.0355691837755137 -0.31629253692051962 2.3629909048441591 -0.32787384864859481;2.6234896872591751 4.8261159651828764 -1.2958876374207691 9.4688067731493692 2.5943805012621937 -8.213534012090193 -0.43089734902156945 -4.6670102512091223 -8.2274426273602437 7.3872570248559573 -4.4880404365327209 -4.0469055901805966 0.036574371861209806 -4.8908608351818543 -11.497356701308025 4.0190047921934777 -2.0164813957150063 -5.1856582033603651 2.7380529595528005 -0.46138895574260197;5.463937359342582 -9.0959248105435986 -3.5871523000981824 -5.1438890155943637 20.814367236528927 8.1163052320379734 -1.5839689983974004 0.46491234174594392 -5.8455882851091481 -0.76042086260112018 -8.2257217604633084 -1.7208890194272737 6.19305259805851 -8.7197393929801343 4.9111648802136125 -10.704586207866557 -7.7204723866887592 -0.25633615856956127 3.9202690867934842 -13.702758651437676;-0.13683117632538011 6.9492038246700325 -10.969048867143577 -3.0152337095748138 -7.0762206085613375 12.856760042773592 3.5898044421136222 -3.0011735787619682 1.5840207029190931 -1.8066694243953667 -0.83176452640236931 5.8128837052591056 1.299354290636592 12.754954516920154 8.7174708746303278 -8.18413582435808 -4.5925017683425393 6.1858050620586553 -0.12976205187915923 -16.613443278474971;0.06678439649625123 -0.67141739928157973 -0.023534434550450754 -0.91877875058869574 -2.0736214040060732 0.18969685344348253 0.16833637590870043 1.7296442158236434 0.49721009642784897 -0.95216865718656729 0.12987962598630662 -0.049854512898192878 2.2330860092832996 1.6777332483247041 4.0649300211307002 -1.856128008429544 -2.2437375601202683 -0.85739012927598057 -0.35155920670408047 -1.7210605603414615;0.3321357071059996 0.54212680060636642 -0.46674458927305151 -0.30739602230025387 3.3153873782351213 -0.66322782783793643 -0.25843253776058439 0.046554883087530904 -1.2379837700183194 -0.32145559415068525 -2.4436602129703191 0.0079376286062033865 -0.55557384596228421 -0.45790959837325762 -3.3582121759911012 -1.9382075605184736 -2.9089478874740875 2.4079248950959173 0.33505520762233809 -0.79551251297847991;0.40991285507402753 4.7506168591795417 0.40246900174615041 -2.2455868485185642 4.309069107324933 5.0817871047025127 -2.6982395073954928 -5.050440632294146 -8.7930363622285181 -4.6845002335203301 -0.21029620978689362 2.666386802720671 -1.1585098235726252 6.6053230416603492 5.8745597501745159 -0.23894564588206726 -8.724105617653283 -3.4428960443995225 -11.670605486678562 -6.0405793457511283];

% Layer 3
b3 = 0.64789515218172355;
LW3_2 = [-0.4118768408034415 -0.087083271609727411 -0.26907392323888674 -0.041250934981272407 -0.37888679707441569 0.48854038320695736 -0.23589442158382631 0.4866646922216834 -0.043765530688813579 -0.22474171671542501 -0.026769371841566438 -0.11340092528235671 0.61421028600702954 0.15240001316526913 0.04136585945294291 -0.054129322560510125 -0.018088636406228743 0.79825045656394245 0.34069677031787365 -0.1160387083890724];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
