function [Y,Xf,Af] = ESPER_pH_13_Other_4(X,~,~)
%ESPER_PH_13_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_13_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-0.9;-133.803853032615];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0422119037568594;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.173883213911761203;3.6777214433390441606;2.6774772224558409661;-1.9298815247512806081;-1.0327426624075128903;3.8151936524170659837;3.1800210995088611377;0.62631733533270350645;0.12869296520014000818;-1.1825748504881470335;-1.200315462525609167;0.31168471721996565682;-1.9648293758945774012;1.2587538648437586186;1.0374836897084416254;-0.25624668500995945175;0.68582106194800385168;-1.4743578115340458812;4.1031033623427282109;-0.55083935678344797537;-0.090817320488508185283;-1.7844658034823170922;0.87706934285634974291;3.6003013695726200361;-0.9821074372455201873;1.6095617755382904956;-2.262642447108677235;3.9556353271737938471;-1.565255725603010406;-1.2323846229738348867];
IW1_1 = [0.018794105058724863699 0.33682873665176898959 4.2033149448214244259 0.72274791112581038277 -1.5369091681961097873 0.37609224511007571801 -0.3566754457911916476;-2.1046733142205913403 -3.3626005400539269452 2.0624273459671687014 0.095442766091548669749 1.717082874174391538 -0.52374743420076186329 0.46625135276600776502;-0.91133459394114046948 -0.12757062558156723187 1.3419910125386029787 -0.029695121542175819535 -1.1615961089105433235 -1.8228806620811097705 1.6735259117308498578;0.64828719959049174726 -0.051149152223545296669 -0.67872431527883436697 -0.083002623095171118583 1.1187242046601422185 -0.24565983380519926249 -0.89220411179236214227;0.45774915453230746731 0.022093461771591216269 -0.74065985926851807264 -0.6445153698172050305 0.73036038754960763697 -0.18473148344646314611 -0.69407072852025841758;0.43436528214343117504 -0.10560936430332917846 0.41330298585850372417 2.9395504357131998496 0.81608301159654028645 -0.005636856656230999213 0.32680105579147605832;-0.70313321178947618684 0.025683789920963109865 -3.5909003879831180583 2.9730203013267422207 1.6882117286838682624 0.18482259498269265618 2.030237352645037241;-1.5344604373256502949 0.24823421784248800304 -0.87292238715281345041 -0.21006530410679419285 -0.021546152190350553735 -0.76133385959021848688 0.1285962472001916379;0.9071607132246573002 1.1002146011973539252 1.9425365388892656959 1.9193999606055374141 -1.0186924218076542914 1.1100710863613709733 0.067928343182503667097;-0.019778786279932982634 -0.073006134144800463592 1.2171092771620146689 0.50067325825838915332 -0.6919860579323576788 -0.086401703164995541373 -0.46572361513991378246;5.2205657450991616031 -4.1044606694871603736 3.8674264236380522242 -0.25809161414246478694 2.0219055487899861845 1.193761084830306185 -3.3604534098218294957;-0.46815674555427949644 -1.1566864828726008962 -0.48155406148805052213 -1.0730958166144104471 3.7424115034520166745 -0.22859758055291506951 -0.09597609510589463766;-0.2982561130167546426 -0.35803742083471423729 -2.1643302890014139983 -0.41294407545431421891 1.5828507682450385641 -0.9960427375025626695 0.2370616704193234392;-0.92808614825969737439 -0.20223792338026219673 0.38702933556646818003 -0.021954124907104053538 -0.63302711431544700371 0.19078079708270506698 0.40888059946283233925;0.013544376210113727096 -0.74344063154474604449 -1.0615150184165251801 -1.6913822384799857002 -1.1079199412014957282 2.0231264153517614091 -2.4281153686584522333;0.14017439580447466074 -0.86930929655425337454 0.31969248904958741386 -0.10701042706028282558 2.2470957342097808151 0.99118551343453031865 -0.2072759736467320868;-0.15170978189152417581 -0.49830463063649221844 0.54080624525490961219 0.74601211090603869458 0.07237957391750263203 0.90217274405118152991 -0.96506607029127489117;-0.44188990831958341321 -0.16706396450168847778 1.1663115542764885824 0.25261198468537859885 -0.078938624049423103402 -0.39362328615091218831 -0.39796415246129263066;0.39389400750660275019 0.029375495600863946871 0.21489273890455221072 3.0437554103945072548 -0.065946197400301512226 0.51174853144983356579 0.86143319448386213022;0.003940256294941244658 0.52846422264954329151 -3.5507610934893576449 0.93768783692990897993 -0.57846484739088699367 -0.57056735993875717927 1.7581718216583710479;-0.28089688521634975649 0.14419148804561782162 -0.37672565189043205613 0.42670955963639861652 -1.8061142759977604211 0.44321574463692442469 0.78833947373978330297;-0.55630469118375358573 -0.046431499119720047453 -0.52659873691241532168 -0.9747171765909897756 0.9697588847587288452 -0.59231311210672221712 -1.0673589389629840607;0.92491349261295230377 -0.6552098567902446824 0.39118581565094995289 -0.23723695385751439324 0.12942505535833648267 -0.23418540148901950682 -1.0789868522067869172;-0.42457509564660850243 2.325320596645959359 0.31745807986182855709 0.73759207984198882357 -5.1212656305787556121 0.40429047478565727225 -1.3964575981747966438;0.90570548538769979352 -0.83701553629047120708 0.19988350869149154598 -0.4872537710879892292 -0.63880181623963794291 -1.1727468679186354716 2.3064826575050316748;0.456016061898991798 0.1915432122200192433 1.358448460233789401 0.29855999475037287016 0.71992001763998736408 -0.31200843266641836715 -1.1247614379093733294;-1.1550647448375097603 -0.99989246058894032387 -1.0182996028108852737 -0.28734126220768929638 -0.63469547968439199437 -0.28201765090083075194 0.87327916191503918153;1.8438896933941510969 -2.8530812504189126955 1.4448323497097612655 -0.34293972462524441314 2.8492558818390985031 -0.23432020819979185178 -0.18029468645926596815;0.2382333869633405099 1.4285564720611871881 0.7602721559527427786 1.261352236552374606 -1.5472280133614983999 0.4965980117734227206 0.18837588485609069178;-0.26794419098089033993 0.52730725368960351673 0.43152627446787733545 -0.64572459932962922302 0.55602796779945129479 -0.061613190027017275541 1.4398714468441662362];

% Layer 2
b2 = [-1.3780852596427579648;3.6574919767168032614;-4.4417511605669064423;0.81965382554194388121;0.44326855658115493775;3.8192002428748446086;0.26591498157732107455;1.3647482577058431819;4.0509445730209217018;3.5774873651174634581];
LW2_1 = [0.32524242131221742236 0.51792616862794715882 0.97650155676777561364 0.700374576047719688 0.8886230375864605513 0.31068450340772751916 0.45090516898275806446 -0.9015446964134707919 0.17755031729755202385 0.23483341996698031684 -0.071122094726005974374 0.28133488816788698728 -0.48070597956277855145 1.4914975216793331381 0.57085814796288358863 -0.15869696140174446852 -0.70292830085082214087 0.52447364380292205155 -0.815597082846156618 0.46290357809993587512 0.55386941406446532632 -0.43740009687870262667 -0.39612102477966915082 -0.25292550199816676848 -0.57765740029656609256 1.2341558068057860709 0.92428315240344505188 0.74553040966724293259 1.0329164235854997322 -0.49875586386759440671;0.22589204017807884561 -0.17923939185725390466 0.050275433621696834219 -0.019369586399445158642 0.87989428130085789448 -0.047712850420442293187 0.02809738058425686677 -0.37084789546398000404 0.2295254539691940765 0.45798960390771237261 0.0043736070430540254644 0.31336392725160139294 1.2176995734101847546 -0.70772704207730030568 0.35229867977623302577 -0.71950261553098293632 0.6881750603890692819 2.1399357698229515279 0.8320179398262160797 0.27278136129075403193 2.2103020309676422173 0.078651456160814717244 0.8532767528033389226 0.32300036702187046034 0.26007039021642874843 -0.69080821711657425244 -0.28202962873418097045 -0.65758693213668983901 0.68930081581349744724 0.80640362149297606376;-1.3212657043180320304 0.11771796917579659125 0.93818334464142805196 0.17690042694667815204 -1.1365609299546037825 -0.18285507136048007037 -0.45211016361202194247 0.37740311451150304611 0.20726095801288521581 1.8491765098607790829 -0.10658929751427577426 0.57296923788505493835 0.27949345366953382008 -0.9018490616150584005 -0.23540122492086681949 0.30840619725208756607 -1.0631518963305472969 -1.4440204188476604141 -0.795986356194501532 -1.3123823333266899649 0.48686172351140427628 -0.70578774618347672742 1.07218747712705742 -0.15702044445538412831 -0.59350906501221756262 0.20139335238864436439 0.72547645028105589571 3.4749875700078263208 0.76276915373660048036 0.35667731517982514955;-0.50682622698526347271 -0.02438408608159933072 0.73318872062362172581 0.60524956660530004893 0.17286454123702943431 0.43246428212597398666 0.092999454129544037451 -0.3026858792012894761 0.013192621600504621585 0.66426908689660302265 -0.083165146651347804374 0.075563261449005436621 -0.50836277960491493833 -0.1422146124754898322 0.25036997858245158 -0.31334354275274867163 0.44937208400545469722 -0.40749467607782580147 -0.2103375587804598712 0.3901561125217543613 -0.49741157841683120155 0.57526073615320350019 -0.51944970372527665692 0.071611224945939980224 0.0064763726447908077574 0.24986324691732658687 0.023974154655658691526 0.41609209893628557042 0.28523427249641808423 -0.3424997892271149369;0.22689057077422283837 -1.2587677286737397608 0.01662690282747621151 -0.51654958018424335098 -0.23184166481992057873 0.80410104232747903197 0.48842731518167559202 -0.38095910177975933486 -0.51993890825279431844 0.205932654033134932 -0.085486137211636739619 -1.710915765619942297 -0.054876961121578977931 -0.28476356992637102961 -0.73667716215830425508 -0.3036303918233183019 0.39588187561523480174 0.34783551528469675018 0.14514864372319308261 -0.33200848919078523869 -0.12469452378446876928 0.78891048814894926267 -0.67483849676624829694 0.23161723559833385933 0.43326404326892720142 0.1058166843652741107 0.21221236271806892537 1.073589719385175778 -2.3579393326206750103 0.041214016662242357325;-0.43644406217574271967 -0.9495879556382341713 0.62652632491342497012 0.97637073891136361148 -0.7037656860451446672 -0.41136440070347490838 -0.40786954700510502647 0.0098050758963494841214 -0.45632510467150749767 -0.0090295968547812067301 -0.12786276805055815653 -1.9611439193875992437 -0.80548920862555195566 -1.1416726091472562121 -0.94134331144542027214 0.72681091271186448743 0.78407584336586533258 1.782204801808918937 0.96774455364110356648 0.1873418870095372446 -0.81990384632682533628 1.5718211605151808374 -0.77566720236308517311 0.72393576536799664201 0.87940722543747773532 -0.63377727646326398325 -0.36429751569154134039 0.12094122514139314661 -2.6261501317926660981 0.081906297653994694641;-0.045345706361309690013 -1.425494470777981304 -0.069805909721385853151 0.36049866106081152051 0.025934189477806179891 0.87435611937511115155 -0.10345765305611090423 -0.93146709383293069262 -0.57222797161437199964 1.6541774439103860139 -0.1448032350852608563 -1.6762436967147862354 -0.090784377759387677176 1.185955385570043763 -0.6790428453827590527 -1.0221264402077299138 0.45387386854624384158 -2.1532062526448179085 0.67707283901851056385 -0.32550646946049677233 0.75498007743043316076 1.3306074079503045215 -0.19503316519013352837 0.042413423945193227949 0.43996248047386737889 0.55683703430304742898 0.4400742847356463594 1.4668851735385510793 -2.6212784187004944947 0.14038950826425941609;-1.3586547755623346045 0.25608214572417459243 0.10229330056762171719 0.68863355529515590803 0.070795802179598840698 3.8990469695530474148 -0.99456673519135208039 -1.9062230515200335734 -0.52395156244474405671 -0.039881648213014167514 0.12125134762451271475 -0.57235142225079282952 1.1641528577611948148 0.94559108240768408038 0.17044901522810820826 -1.6162194142070245295 0.70371197778780880672 -0.020428999499575221238 -1.7843297536074800291 -0.12404380459852829 2.2968328575547451997 0.9883361505246635037 3.1707454289587846397 -0.21023039000244070351 -0.28138029409835074723 0.92729784428673744934 0.94004564814662838756 -3.2275404638542388724 0.067682664513397092221 2.1954685646576406199;-0.34987192561883834196 -0.037891823226306693695 0.096112932462758343677 5.1670768338421506627 3.2514691288286532433 0.48796815524281350607 -0.59551492545584761018 -0.11218988316095931945 1.2262528442422113706 -3.4863825815469371427 -0.047130982830263165595 0.10870955134024766486 -0.72052953260374974498 4.2249354503944491768 -0.034339915674314963612 -0.50387866090113775375 -1.2758352576277813828 3.7478127503294533795 -1.0222679813097403922 -0.040928376575638414359 -1.2642251619410793673 -1.8211845706296942993 0.20214585344922325616 0.067261365288939514717 -0.24840753102340956682 2.0191827166696114659 2.6936946376043171547 -2.4417604814295987836 1.932953261703095782 0.74817404478346005714;0.31481093612803956461 -0.13124276183355088055 -0.68747461538333731745 -3.1030569046851157466 -0.12874091855952587982 0.23490005260199098291 0.59551530822906451057 0.50420399350659772519 -0.34038364452744840349 3.7396586726734932782 0.046796768862726857707 -0.24099439422019103274 0.36416163968274872786 -1.8505725980621547944 -0.43331656332679618915 0.1192805088758611548 0.68277437227530612951 1.1079052797231980776 0.15852118839446510679 -0.178616541192734124 -1.212047290069262262 -0.19977966553110981796 -1.075707673652515739 -0.25465594128362489812 0.27581361627038725182 0.75875573697591913724 0.5921414083869664946 0.12201452314459905468 -1.0457256740005467233 0.23819108384048301441];

% Layer 3
b3 = 4.272329055773729678;
LW3_2 = [-0.54333219927428699769 -0.47076441591033207912 2.7763881115504607244 1.0968453967893283529 1.0420357486662013002 -0.38115914246409843269 -0.83350318127198452789 3.5041175517875222667 -1.9378436547273449886 -1.1718515372902735816];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
