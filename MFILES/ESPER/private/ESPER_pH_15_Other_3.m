function [Y,Xf,Af] = ESPER_pH_15_Other_3(X,~,~)
%ESPER_PH_15_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:25.
% 
% [Y] = ESPER_pH_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-133.803853032615];
x1_step1.gain = [1.0000770825255;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3643955666651066405;1.364425980537083305;-1.7351175826056153273;-2.1127827444892721687;2.6178643802112300243;1.7974584681490657356;-6.5311344114117781956;2.0080114584714214843;0.90146490353543251572;-0.01377566297730743565;-0.52304739938035560431;1.0187936222463469527;-0.76738928544819884348;1.1281863776137968092;0.58153741827252192209;0.71169289045047046116;-1.3949611439759070919;-1.4685323213571428447;-0.65188523449996071957;-0.77697435962680061472;1.5548058774352979672;3.224213412190873207;7.3461573368803714246;-1.911375813156008352;3.4818635447773016445];
IW1_1 = [1.4262884165085403243 -0.2668787029296390001 -0.94930571293813159617 -0.026675977839297312227 -1.702218479180565458 0.3479670154174802077;-1.4824108569031944072 -1.1569855058327693786 -0.60905052708148499363 0.17614513814277735215 -0.0053932223948770247751 0.71165583697515299999;1.633641836052538876 -0.83297599301633895585 0.50299521660959456426 -0.54656556100944930776 -0.148238976830484398 -0.15714381217388112555;1.709403444089852897 -1.0591813538145398166 -0.14255453619107250063 -0.10395721708891224322 0.49066998841227138506 -1.4405637464806426706;-1.3877325179561295077 -2.6191421806308325948 -0.35259692563563388434 0.20256788045690488076 2.4864386320706621802 1.8030785898629815289;0.36241903657762025714 2.1138452992870067071 -1.5010141873318740835 0.99063064554342805668 -0.17770817313493850187 0.57760931487862632316;0.42565315970542455526 -0.26398806976824062964 0.63671533304386473962 -5.0321803420822819319 1.4416167389746763483 -1.9925525911542771862;-0.68102125736766450093 -0.29597159996388466841 -3.2894731315093763691 -0.61351976490179283008 0.70160850643152850026 0.40720625920165054445;0.33291299335241603119 0.4770286799498372754 -1.2018134329128074 0.82054189072240590885 -1.2430661012551702527 -0.24401318181413081398;-0.64490988806430638025 0.23953149426026426605 0.4130882659618650421 -0.050530660234110055806 0.074817339652154063456 -1.1462552262920782109;-0.60091044259109749337 0.092825431996634080734 0.29847670377146789944 -0.36321542094574754689 -0.99594779763088969737 -0.543941756674756971;-0.18362384212996707422 -0.81617373245481872335 -2.8495095054611256913 -0.82443265069474058748 -3.3244129388350258658 0.60525579756185998725;-0.49535719200441852283 -1.2814401758602764758 -1.5651123897922667449 -0.087672448294307647743 -0.33216276321079662992 -1.8824431864553332616;-0.89384081707144180662 -0.00099269812028685315217 2.6151639935574926277 -0.10190255415204459155 -1.2736389371446035224 0.41807475229759299973;0.18300531345538595396 0.34130413996700942336 0.18303204229297956318 -0.41332721743480349552 0.50644474649405279987 -0.94009707896960870155;-0.050346969432034122116 -0.75041183367931063586 0.41435646641321355332 -0.090920691379709497881 1.9125147263748383253 -0.79785679807003317965;0.39436732474762825618 2.9241734078293788457 1.6383599285227521403 -0.25461615391720160417 -0.39422270377495621796 -1.0723374725014520603;-1.8871548787084495569 -0.0019029266082504288533 -0.22071291649190574735 -0.1999735011480398561 2.056073518647649756 -0.44997604193014711926;-0.69119769763924032713 0.92179267485665639104 -0.56804433979371116159 1.2770750486604784957 -1.2890248880770165396 -0.71854440633029015295;0.10587410267327761193 -1.2353169503562726472 1.1352051182204014879 -0.34775947237529075684 -2.4247616990032176965 0.14867727347842607521;1.0322028565127983057 -0.011648504269472439651 -1.0603103614044362413 0.76839481642210227808 -0.92883496391639241985 -0.57408515106694890662;0.71351318798613572181 1.3136182702204981521 -0.32704686881773098461 1.7601592191723982594 0.97283961337832769445 0.46284187599064463559;0.059433225369246285574 -0.41019233199544269386 0.030707286677765146393 6.2690362677981905648 -0.47288476838335691266 2.9219008732512476989;-0.58653414179059693012 1.0217857567885499925 1.338367037435188367 -0.88848035291758098442 1.089891494845669051 1.2467756241174736687;-0.010556390493421989596 0.11466886433977778459 4.255816703764708997 0.81406036043474061525 -0.4891572557413145228 -1.6961625567001377135];

% Layer 2
b2 = [0.6041471721626920921;0.68267254693760359707;2.0447370286819581686;0.92755257397367085748;2.9379753389135556674;0.26153295971708151457;-1.6437125172958524377;-4.5763939338753720776;1.1285310385890672258;-1.246298600940139778;0.3853419904113832839;1.1955023111196614316;-1.6486146630502653831;-3.7576001585406149097;1.9193197363751068885];
LW2_1 = [0.16366868262671996348 0.35296930831915013238 0.10487242281650503706 -0.68854341571478905326 -0.014297132565480968197 0.32517867506374092956 0.7347671717404020697 0.20544886141067286722 0.90726680724314123783 0.36728186495639486564 -1.2372403592352572144 -0.20311170803390760087 -0.089737955775277850057 0.16370701442252935665 0.15354609591786139156 -0.23755458085301767168 -0.027477060542086373385 0.12230156016516319228 -0.03486562830736267965 1.0085942812060921803 -0.83908006671960821965 0.21735757738332106559 -0.0062431887468628131238 0.08529377226273099355 0.26858130860044970856;-0.44847745191271182197 0.4285505091039771286 -0.26500500965572432177 1.0377473418410732009 -0.26753423849332247375 0.52426710037807766618 0.20903054315658142759 0.6085528146471508304 -2.0386478537788628174 0.071661274839865340969 -1.7985275194355880846 0.27550206053216447222 0.45404872112517918881 0.046763778264705159471 1.3932700968694498034 -0.98008296913221171209 -0.17102776433111729903 0.93908554148443090792 -0.24689972314820196608 -0.43727220473178907145 2.2595688691117410407 -1.2031937938232726282 -0.055964254706467361777 0.40303377200006218484 -0.59392585224829474999;-1.7274066350869485831 -0.40478536496616984719 1.2057806319704329479 -1.9013629297734986334 0.83921201238344489415 0.076405378062476436707 -0.83575960409609717505 -3.0341837846544086332 1.6006081558882205851 0.062521707796928810419 -1.2636790493101364152 0.017202664373918777341 0.22389447805342038711 -0.93347355829346356781 -1.5655829853919542849 -0.57609986283632363957 -0.028844050088961032535 1.4833594287828240077 -1.7213625228169899817 0.62741079412709721552 1.0449937474967012641 1.0539342946384713251 0.032167663411367466986 -0.31933979921197913621 -0.34404899019738305332;0.13375187816347458569 -0.10953054009594066776 -0.25068868977761388228 0.21036417564993192819 -0.17161226696346562615 -0.39441157844294438828 -1.6861892238807734135 0.68724702417483429784 -0.06736369056447692738 -0.83480332415618763164 1.4713319411023788597 -0.27845301312825720963 -0.13117827046867752694 -0.54603005277052640842 -1.6095228767206177789 0.70632602579374470508 0.28679816628387577726 0.22207825835585950913 0.61443572906587407001 -0.9196598381415908019 -0.84290555447247772491 0.64866510611473671144 -0.69535985968731950368 -0.57089458669010628711 0.16947856415660805807;3.4492446374300014256 4.8207136659758713648 -0.78009168049787935839 0.72577189200118963353 0.1945726882586830131 1.3318009483904542645 -1.8442203038547777538 -2.1591626570091877468 -1.0472706883743376771 1.0231998767041043941 2.4484737477484519452 -0.27915833033536463503 1.2603492359075942897 0.13572098027184853475 1.0278585729215978795 1.3528145938442766028 1.2378793837996657778 -1.770488600543416835 -0.56246796152402034341 2.4407994602005649298 0.91086580365304747886 2.4089641367160248286 -0.24643116996466779556 -1.3275166932100797013 1.0636490328834622421;0.50323487497430574589 1.2232084171289514529 0.79803767953139237434 -2.3006935796833398733 -0.99396845239139464123 1.2280082570697516964 1.1888747485612165544 -0.50208214419424967989 1.853907874920108112 -0.63849626882277621398 -1.9364431897376923608 0.23176039327694969439 1.3058519998174962229 0.65282746171550010139 0.19895794138206057688 0.47433249464065946333 -0.42151160349775346203 0.18977320017343721203 0.54251798793842476165 0.3152819246973472822 -0.9382390841561599748 -0.73040529672796261629 -0.21832225051619930101 0.14387204060368161129 0.12059606070355381735;-0.58234834567911164527 1.0495980682126833106 0.86819362968275903825 -1.1037648958913943709 -0.30086287346084822358 -0.18379970667290862485 -0.21217796654119799871 1.0193040780679702983 1.4079505079473335627 -1.1403278423249603168 1.3081145715402986429 -0.22018348562853046202 -0.32150545581713746435 0.6845559613415873601 0.087534674891616509607 0.57343877353704764133 0.099329002336914634652 0.18609082163404414012 -0.1477987469251882402 -1.3360290786919717387 -0.18104066354944325923 -0.41477617056556220776 -0.50890425258465243896 -0.24573508613509745246 0.30989771751971945113;-0.73615755102042523816 0.17314002622306495782 -1.5669823896090830928 0.39491571986407136841 0.44527761519711051008 0.14522960684544483634 0.20842294445964046345 1.4088787472064778772 0.20421325568079937152 -4.3697392268668888704 2.0711793607873403289 -0.16468310482141271245 -0.41169165214514547024 -0.12992979040175436922 1.9702783512986261627 3.0492224473443116928 0.40313969260241666603 0.28722184026014641045 1.3779516584711475335 -0.55434207639189070349 0.66725210997738981789 0.83241304313024699901 0.40473661106432040624 -0.49155049668690448117 1.6326398470215457426;1.1533755132708680691 -0.5049749526286018142 -0.83528257892978097221 0.97330089616930604013 -0.40661098455427047149 -0.75325140790709432803 1.4238383309583493297 3.3351066990420514813 -0.053996910016078411565 -0.060833133782695308911 3.4699244375719104916 -0.11261514009089200472 -0.24830715280089657448 -0.36639453003871813586 -1.191629959831637553 0.073916854674573137518 -0.24169557066769520315 -0.71218423873438230221 0.17315545580991462127 -1.1102648637819130251 -0.26912976717681830197 -0.39668655858699525263 0.47668338949780353353 0.23197440998662172129 -0.049596507343548784652;-0.050162672249417263048 0.013216247727500083156 -1.0389991212941278587 -0.59583160498633658264 -0.01823767602024516099 0.60374613613765082398 1.8236265034803751384 -0.15594365262603532285 1.3638029961606115137 -0.69650826407014243546 -1.3685642873403345288 0.085954356100131731888 0.019821710971339247948 0.25136724913936259185 2.1498115439166629592 0.98530441397058965425 -0.05955785426176923858 0.29730068236665907477 0.63125600333896680905 1.6933777023852658594 -1.6577808876043966801 0.46563036579035727014 0.43526852244084984767 -0.2763256203336199035 -0.011195025795526824045;-0.39507609113556302338 -0.22691110358307342576 1.0309337986957207711 -0.24379242718702270887 -0.4940026923458734065 0.49532071053477222389 0.836637760045891965 1.9398306999054688582 -1.1313745807403841059 0.53260258130122506426 0.26620530973202932712 0.15659773932602016888 0.10151641128605375097 -0.38209021404574800007 0.72402544962277137763 -0.59444605752726187298 0.064794651244518289279 -0.34522663340354348138 0.69065913452111193926 -0.12707205323082818027 -0.30280258716133240382 -1.8891156510376232447 0.087373011362002456215 0.73164769481035951681 -0.47451499482198800095;-0.46383412293564502127 -0.83665043604058608739 1.2427182168851642619 0.45401390916301154199 0.53617043091746752204 -0.22675809793101053824 -1.5283988946162077038 -0.34099375612659948986 0.2899834683687356196 1.0071008273735739813 1.0056309957774973718 -0.3859202869094327526 -0.26195298864385341275 -0.29691972594103610561 -2.1840283577968238049 -0.86032755352830392326 0.14592189421279017081 -0.26574791378474277304 -0.72801032593999148723 0.29594988407543398878 -0.18178054146685670989 1.06562032419396302 -0.34694908104101812585 -0.22581761210652384619 0.24574309351555179148;-1.8301229760797428359 0.91008330049797503403 -0.18949757505685849157 0.36278206322641853854 -1.0485564936279296866 -0.19023026533927991921 1.5100481310885178754 2.7922912279341907116 -0.076395324821778312629 -1.3359094923519609921 3.1185566328540921255 -0.4670032092216860331 0.12114378321205672429 0.081458975092526919592 -0.064411541301780839142 0.53017244420990017328 -0.30251544979506916899 -0.36426287643539595473 0.35627899718366967674 0.17502168703589096599 -0.061841245479623954684 -0.40770228459261242948 0.46727837387087972632 0.0084196257498576464878 -0.67352078934505332786;0.84489504750899402374 1.4737671211439464791 1.2323417111678909297 -1.3151354761304734353 -0.40689330427337599971 0.41984293511991388481 -3.3298357380283314377 0.048372547050494825449 0.72479146805915439788 -1.5629139575351482794 -0.2997868315806095918 -1.0338468288246855931 1.3548158327648716082 0.84709780094461128996 0.082978750213058810603 0.56766488174603302319 -1.3034868873264899847 0.93974512774607710242 -0.50418349989743882489 1.7057850092503163975 0.27546860428373848295 -0.62858028688272316042 -1.6318610114075742246 0.18983984444472709607 0.48257870288505277934;0.26334455810101192741 -0.54569655923384774443 1.5909936620947673358 -1.5791803566391480196 -0.22392236270236540174 0.28049524621627502929 0.50193393259552809837 -0.45575442099750351765 1.5765590794496426863 -1.0892727872682959056 0.13080434696851644949 0.094542468513722360823 0.66588760340994701536 0.25464728569751976517 -0.46180798415616158836 0.42903920738571016402 -0.34283766222370687382 0.27766383426858520789 0.31457219649026835206 -0.66877964940694978324 -0.47328296872836111975 -0.60298232990605915571 0.34372384135801320459 0.14489429562750816283 0.13563944544891778921];

% Layer 3
b3 = 1.7354179125260515981;
LW3_2 = [-1.7955607892211364884 0.54121369212298509055 -1.0903320590887806141 -0.68254673513788644001 -1.1068778362915721036 0.33154949632952768201 0.83183980330839446538 -0.45437162582741202899 0.39077754381056917232 1.0037518853252549444 -1.8419698831328996658 0.73841518115376392206 -0.54518415422609567411 0.20543351274591886702 -0.65842887597231114505];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.90239167587468;
y1_step1.xoffset = 7.36300175998845;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
