function [Y,Xf,Af] = ESPER_TA_4_Other_2(X,~,~)
%ESPER_TA_4_OTHER_2 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:01.
% 
% [Y] = ESPER_TA_4_Other_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7198529812044454079;-6.9812745921347572065;2.1345386151011886966;6.0728960352869094663;0.02977728888647088179;0.52781474547594686708;0.055094866975670578335;0.50114470776233077665;-0.59922420305508772298;0.21354319414605474337;0.28596668465863506192;2.4542570378774972717;-0.46850384699836100655;1.5868152959433092786;0.6086853328411446773;0.79057275095732670867;-0.68381169255592688661;-1.5536937366664747007;-0.47048850552166276984;-1.5123617633901169643];
IW1_1 = [0.83750131742486444431 0.24527787994112115744 -2.3145197556069501132 -0.29513959066017630972 -0.14625413288565086711 -0.20220573235501382303 0.89975663804006589253;4.4481822021237826803 -2.6522510487803270252 -0.50777266880278870698 -0.0011800993444956095479 -0.35683065895917770449 0.059639391186715746962 1.0327625841529801676;-0.43464031728757995809 0.088879959806950972756 2.5931109650599797334 0.06640145523679734374 0.6161779232580228971 1.1468231916277575877 -0.55964540872483636846;-0.1157123607176518687 0.061165398851828964299 -0.20561527700655979345 4.3419264959432002371 -1.3388212840613471499 0.77258390643994689917 0.70572825578629339027;-0.18551582534324925766 0.21035878999260473887 -0.43963455461252126666 0.23067334853874135736 1.6328134415971622406 0.9220842970650380277 -0.66458058230592009785;-0.74403584725582383452 0.45554506650539594581 0.2590010394331767607 -0.18994551463364134358 1.7237872076654909836 1.2535308171805072952 -0.85241632476090234416;0.051871454134703801064 -0.19327064698252174879 0.16341053349389889071 0.3553641650707879962 0.62218718473051448647 1.4250234642172876498 -1.1803740722259548068;0.13794840002119970745 0.059089208641457065252 0.20908280577910196008 -0.41883155637366514812 -1.5445765566566207472 -0.33436392282349053362 0.14978088393125310596;0.33364988426461178461 0.11103468595439665301 -1.0335933335285922841 -0.44177451977225606905 2.1295948821105241677 -0.77396466719136491896 0.16026323314731361069;-0.65967660487095691746 -0.55947725823139837775 2.4828901412539892135 -0.1593232239429822894 -0.76761427916584945574 -0.35264747845349531108 -0.018882141932592588079;0.12283314459222462178 -0.074476929151971724141 -0.4918386056821563157 -0.098217490454781286591 0.1012612355827308408 0.26141473548843557895 -0.14364888335136491437;-0.31319156705490458492 0.21299916786203190733 -1.6962477428348223807 -0.52313700209713465128 -2.5915239549830255683 1.7642924925813237014 0.079977419997668150464;0.72927436996588967943 0.56497703558902878651 0.069809017182152086067 0.12511443858653967243 1.765658598247773492 -0.46195029294702377731 0.0098947085139466373072;-0.48856935996958017476 0.14255969966798345827 -0.63735521342191092664 0.37505238537930313258 1.1856860939392763754 -0.24693228193158148209 0.8996480488236906492;0.65869775670997110506 -0.76366097767677765251 -0.092149965026641675325 -0.0034979806146172532852 -1.8626609881758697806 0.27810154580284118797 -0.29283784944560747876;-0.16916333498554339543 -0.24132317011731829748 -0.81518831653864665121 -0.47994361545135405533 -0.66588924645945923864 -0.06776838013216943124 0.65714202424678880288;-0.19115467389691354061 -0.47109813765458508072 -0.37694607164116350484 -0.20212357886923146277 1.7162595669273470467 -0.55129232005898476388 0.1469476574007275993;0.8098847653163568916 -0.028786827215864417562 0.86204343590692678045 0.39805297554661894788 -0.95334941822144458889 -1.7599416264253502362 0.53165270926042651478;0.18402905068420713497 -0.18644084803039906451 0.47459851952139425757 -0.79493611527968000008 -1.191264127053038635 -1.9793579294138980984 -0.63424617096700297569;-0.36793430218305173129 -0.070036662830154236548 1.2477742241867559869 0.4469478009200383295 -0.96836477410810850586 -1.4246468108409631181 -0.60168239714948013042];

% Layer 2
b2 = [7.3926382042551770368;-1.6666660753761879388;0.43465485352594263047;3.8074247736091386685;3.0158920880239779017;-1.3982471181196345356;-2.3427959352417446759;-2.9260723069293432808;3.0182136534459078625;-2.9625898731331012925;-3.7796716645078256569;2.3746071202234237951;-1.6126368860206012901;2.5952253345381790517;-1.9403131839430809435;2.2919356163100164103;-1.5251097398030224461;-0.30012636324041869207;3.4094289490471059167;-5.0734685529076770649];
LW2_1 = [2.1062562557213291292 -1.5365409107087701912 0.001921516167843365791 -1.7837538463326367832 1.027485418435581277 -0.78709669638950841009 -1.5277403785957854865 -8.4984155573599071687 -0.023933834157469129067 0.072769543286610685606 -1.6706048169290479422 -1.8908782315824643749 -1.6775418203819929541 -5.1808666059861687714 0.52251042838244643463 0.0640388807221455858 -2.15251665665549341 1.0712500751479658856 3.9265283678943161405 -2.1216956542839473521;0.852435706435922258 -3.1832603122776150784 0.78508033408879651649 -0.68302464784943339726 -0.15883027868464374976 -0.63391988926559916795 1.0909965040469851161 0.1552886712962893434 0.68529251924507317284 -0.37093954179280341776 -3.5187715299204400665 1.3306352590224073129 0.1983995529839022165 -1.6703792198189924001 -0.34960903716152880172 0.028358245545606855509 -0.10303348593620757778 0.93902108362289560262 0.43617193520170294274 -0.24755699869333919194;0.30628533297752735809 -0.20735070176314529533 -0.22879453566026425326 -1.2418745513851998652 -3.4428100721971457432 0.56974704707463108555 0.58284132789725373591 -2.7867653503631593104 0.79167443586862418226 0.18027639603895659337 2.287518341266617572 -3.6084158476224357237 0.72030000543610128716 0.13461639155710219962 1.3939347503939010231 0.60780053491929797449 -1.5833887189805784246 -3.2583884122625370594 1.042115874461861047 -0.90226500421962041454;2.3174601355305393113 -3.4582410994866505938 0.1465209708377590847 -3.1736757349176207832 3.708784252012678806 -1.9110668483724766453 -1.9206516577278827107 -6.4494957178569869427 2.8718291292756097377 0.79513006557133125707 -10.859410669671643035 -1.596713738715626052 -3.8771688272952786747 -4.5550344391902752861 0.32439315947285918273 2.4916635829694264714 -3.4248025487123112676 -0.7558560434281474949 2.8805875684307555851 -1.6549425398627644057;-1.4160750105080699424 1.9625808973041545258 -2.1673510334739582994 0.36146368627920832939 -0.4368961363663764752 1.2998415609124871484 -0.1343523450846091094 -2.7102802795518137202 0.18988870396889395709 0.20027705207611792848 3.3731464958331587312 0.37509488958594494612 -1.5483521988552624293 1.1475343703769356196 0.53817658530237699743 -0.52330589756997425432 -1.5573311367274362826 1.7765135680177230881 1.9104670979345592663 1.1365479929577491092;-2.8102980312707348531 -7.0267518051097139775 1.0661941565394272846 -9.6249514562503666326 3.4091531732270983213 -4.1118964515644895741 -0.065569908807461302347 2.8534392396354384402 1.131624645962795439 6.7721891489829015853 -7.2409399448053601844 0.37199492925972221791 0.95233140273752703298 -4.2457574782893727772 1.562415151605305752 2.982184137046499206 1.6641636588836463684 5.9075868554527000143 1.8598601656606459365 -0.51687879981306594779;-1.3391055968489526951 -2.483599072992160206 -1.9272252966593963475 1.54106807763880993 0.64318079960692731145 -0.50262105397035738985 1.6062916317262834198 -1.1048905315232309121 0.96872705957313698377 0.014203509819932489538 -3.6174941298446028348 -1.3557276127772368568 0.21621711473195648345 -0.26305963786115638126 -0.46303652697394742654 2.1983156043129437052 -0.37907828973020252228 0.093178786067460689369 -0.25368154458587660605 -1.039829013539241398;-0.48039319812772179885 -2.2961651271338903157 0.41561175993808546769 -0.5798053957461861696 -0.60327783530850553895 -0.5759870238539460674 -0.25668385547375438538 -5.3907633161716947967 4.9638674465416450232 -0.58360005619823929202 0.09206895696306149901 0.055661384707030088503 0.098983505736290666732 -1.2386239593870864706 0.10097876926972083889 3.0200167717928771971 -1.7502631772441501479 0.29695718069849402765 2.8097131665322914174 5.0272594865340636261;1.9143130210860150875 0.43481621764493905147 0.41092258713043217089 -1.8142113521275240462 0.27682867762733515127 -0.1174225998211686911 1.0947307819335478918 1.1452800676998875495 2.4696629391294946387 -1.3970030018120467297 -2.8846426281373647171 -1.0700575508712364403 -3.07021061478652868 0.89490782723629891393 0.090963380282181191538 -3.4771473799964378593 -1.2875573430134077402 -0.64476869406286607678 -0.067774857067124105736 -1.0666388729582880757;-0.77765924756838722409 -0.95960548210391360957 -1.0582262832303503952 0.31809866737177727725 -0.029009026826696933388 0.82995930022076080945 -0.59623388473236305085 -1.2381242158852305835 -0.083243706938279329877 0.16585919432979645549 2.1330385826477513689 1.1345696413505259592 -0.94081621907661006077 1.8991024745489815118 0.52886719106739521479 -0.75919652143248916865 -0.57002032210409858681 0.66073884045031150425 0.64900133294800110839 0.12927866807795304616;0.00067381683920544541144 -4.9239084686899294852 -1.3700696605003883644 -0.45615579156875901701 2.3153798122767010881 -0.53442370313616094357 1.3935925131872586302 2.5055153804317651378 0.47311345579733637967 -0.26926059009534786259 -6.6821859270328669567 -0.87400557336250705998 0.71016877595722638361 1.5543467945082107828 0.042878876747680857995 3.4187422034910124324 0.50909402855434793267 0.97206513364558300161 -1.2910432287628788028 -1.2591128680156733477;-0.11620452818492457703 0.58220063520624132369 -0.10493815698198587227 0.091353509869775126329 -2.4179102777078922415 0.81043000839217516074 -0.37843856246044654812 -1.5903348324827972782 -1.0360414837625848694 -0.27018469299616609813 4.633214295971695762 0.013042713609611129855 -0.14368615240599239002 -1.3630398638704002146 -0.40612697039166822943 -0.96696897249052415901 -0.24449518344930942781 0.2487351465265499606 0.89944818312538221683 1.0391032755741673732;1.3126058973599015189 2.1583278760256363604 2.2603487676932592088 0.052533329247213877977 -3.0680413673874222802 2.3786008601158741271 0.57478462331981095002 2.6674547572932758577 -1.6469836869325464868 -0.58697825044052154286 -0.67391525047244571489 -0.23582332480494982985 0.93936908882111991304 3.257226334452157257 0.92222347044248798031 -0.21806460397307705912 1.7511766807608515339 -0.20586418401073722229 -2.2802024604150687992 -2.3404650398648874088;0.94568990800285746001 -0.84261742109854631533 1.3222813858931539155 -1.9269571892096255539 -2.0326141159678035031 -1.34324685248317377 -0.67017197041283782522 -4.2030772927591542043 -1.2944156149205900963 -0.38079905829054699895 1.2510179100910550076 0.75070260945593403346 -0.91926875804861751806 -2.5968868522346673089 -0.18075249297640091917 -1.3829233887198573161 -0.77447792687860250727 -2.3299012178321887312 0.78468430730260385619 -1.2784678314206934235;-0.6753514897912595849 0.65499850194027953165 -0.1485916204187280043 -1.8895342482045995869 3.9293495088524519332 -1.4065732301057034537 -0.19473106289483491094 4.5993555778345687202 0.52134310636883873791 0.40590142377220395087 1.3791362525813439799 0.068039698509352486422 -0.79933101226954250684 3.8081566215336462022 -0.43804990697471551941 0.32443934031316967737 -0.69192815841382593334 0.83369074561215894548 -0.66788440519059011358 1.2714527228911296497;0.12561962351373412439 0.50983245907645591277 0.50355526539724515533 -0.80420210175730311164 0.95246037588716947475 -0.82559424799926450778 -0.625012819768369976 0.0033326533866277745916 -0.0095186248487016938274 -0.009631616288810134624 -0.35141672543473684298 -0.69172485084333734662 0.009987311148647887854 -0.28719467097191703209 -0.081925358806680476098 -0.3921501731725624551 0.29642008686716508903 -0.87334510692101741114 -0.25980981075268194669 0.16585926717920732032;-7.2587498148351734528 2.9952911984497219144 -2.3384530976346571407 0.85954256126127392967 -1.6209987493771444989 -2.2332149774275475984 2.4361480636951018397 1.5123381281907311013 2.3740855803773799337 0.99028007977511556259 0.42901090241264205893 -1.2332439965936079496 -0.99688283912192809932 -1.3668610182546969689 -2.3510206428988151828 -0.58144056998875770503 -0.30254254542618047585 -0.75444159012262190789 -0.26090484736677627131 0.57901707337323737868;-0.73347259024706235042 -1.8014022025089451162 2.4273840080241093631 1.6869727844506907655 -1.0878981332547703609 -1.7603834118519205987 -0.1480011685923552367 1.6115168871292009367 2.6238994978881948761 -3.181045283546934499 -3.8859062382276841063 0.907066167595024897 -1.287623408857503593 -3.318237907764034933 0.67775105608633878784 -9.0564540191606077713 3.8227374548153174594 -3.3909818218818585933 0.52464517418516554148 1.3592217456026731703;2.8095997309744484838 -0.022129304712966809537 2.9776780410559360313 -1.2027519108689694871 2.9601100245207176975 -1.6633374667748839215 -0.20359344506533610941 -0.42003017842884737831 2.1024872295405154787 -0.97327271863200603974 -7.1819363092314549846 3.4339640433002540654 -1.7815388313559563649 0.40872711953948670516 0.93607144149449050818 -3.8660785870826255284 0.061820900171426301783 -0.45054597205700158691 2.1341277924108292829 0.42000330208817115984;2.0130016233426841765 -4.9717537273402596654 1.540166515424661986 -3.9736621807979686238 3.3938662273485293852 -2.764599254647888138 -3.7070842751857582265 -4.0860195139140529363 5.5030953380493405902 2.5669984532469523053 -5.1197628775713948102 0.80861058083785009032 -2.1009531746335641245 0.91468721086432669409 1.6450340433566355003 0.21068009878694743398 -3.6298737480811764655 -4.0900093722701136301 -0.70760299381936508922 0.54250907668514314341];

% Layer 3
b3 = -0.21334797686795514693;
LW3_2 = [0.06875165899407006953 0.52389309827022512156 0.074271576099431843576 -0.083320488521008775895 -0.31731030941589111194 -0.02090990367337167144 0.2256264236488396413 -0.24932103745563602426 -0.10680622899195574282 0.60957680342054643141 0.22504136808386598911 0.47051374932108575022 0.16102569305361372209 -0.16870478863311683115 -0.11449979775182855812 0.93697429339706650442 0.18005428025349032306 -0.040661957346443143579 0.10627872310578033443 0.060874482400053935016];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
