function [Y,Xf,Af] = ESPER_talk_7_Atl_3(X,~,~)
%ESPER_TALK_7_ATL_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:47.
% 
% [Y] = ESPER_talk_7_Atl_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999996490807;-0.999999999390765;-40;0;11.29;-1.99149636107278;-143.241523403244];
x1_step1.gain = [1.0000000017546;1.00031699124092;0.0153846153846154;0.000310077519379845;0.0705602618858232;0.0604107502911417;0.00458552991639557];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.1515057675966212;1.5958442959541774;0.39427097747476453;1.5624696121128534;-2.5807927897688798;4.7230050951908318;-2.0728598728470096;-2.8097656998640561;5.0164086969382229;-1.3752668868317777;-0.91362734176649918;-2.306832173675605;0.46366517042424515;2.4074426466441343;-1.5295604871592192;-0.21817515136496368;0.79405839077072482;1.6395208374554415;11.783167581234997;-2.5111945897995449;-0.82496059916381026;-1.5874725443774989;0.27409673009141483;1.7582268779002064;2.3988449761821773];
IW1_1 = [-0.86607782037913539 1.5558531568920513 -2.1617010402175869 0.75303200779898605 -1.5722144601112518 0.639101797915962 -0.413816696238134;2.7934144635912137 -4.7840908774604127 2.9369276927897165 -2.5906842454129246 3.7776449047961869 -1.7510247525953666 -6.386899448898478;-3.2743526149127784 1.5866636867618558 0.13025777318116183 -0.38918019692562639 5.9380049273541786 -0.4230685502503978 1.6163325764487124;-1.7691982278130318 -2.1202237493065357 -0.28719193056050046 -0.72997619261593505 0.27510068242140739 -0.50106335255183199 -0.029754139040450364;1.3037055461590243 -0.22380679830836286 0.69344474757381613 -0.042263444989512559 1.7872447341822857 -0.84379042002648375 -0.17074962827904372;-2.0090559912746753 1.055834193093284 1.743258236967776 0.42586904900819383 -2.6103928271667334 0.27341733185192574 -1.324938306300953;0.019148705327983847 -0.55838253754655731 1.7063847341895331 0.08233820781936288 -0.58042598565453252 -0.5701124019510635 -0.35725187198614228;0.80681279737984279 -0.17039762901632119 -0.79065246539700074 -1.4857346985455957 1.0166386416438427 -1.1494802972600386 -0.9570602361294247;-1.2398617240159142 -1.3932722293662221 0.30754445262888253 -0.66046427510045314 -3.9065503787164868 -0.19205918866051119 -0.26446411194162917;1.6834318131792414 0.80684764212701543 -0.45970788494566012 -1.5989473384369792 1.9755142297650694 0.74578504866820261 0.074358441113827917;0.78088633109224248 -0.0030134014212178616 0.47820334178065405 0.20664415788589069 0.74942515979715563 -0.21586214500716458 -0.10308167285247771;-0.47379852672076256 0.60810842222200112 2.9404439792917803 0.22056819369468186 1.3187816666657977 0.40716732149473078 -0.24042719091142678;-1.1580087689731182 0.75188407819036185 -0.36905583247679935 1.0497328388995804 -1.7258875447659239 -1.9094526561308962 1.1852586038505155;3.2432945970476101 2.0137722342669298 0.28608475886985513 -2.1805818404931032 -0.71434255716161987 1.049071554686525 1.6183208131239233;2.3088540792346164 1.7946816664213667 -0.40454319754327606 -1.7479936927019526 2.9357368121549485 -0.7946717886888347 0.21469700794481825;0.82199225264913356 -1.7652335518497675 2.8726440410893503 1.6369121583457165 1.3302340433562647 2.375161913700929 0.64597737963108415;0.17602236366459023 0.24377830994645069 -1.1788956561838093 -1.908108508591027 -2.6629102228948756 -0.29707018403253105 -1.9043834518601306;-0.49574220823634652 -1.364962872592858 0.31539261263419449 -0.13915770832779703 -3.0686508042800282 1.8266593825725188 0.17616735197963251;7.0423508479080956 -6.8411457837501946 2.434254918074799 -8.4490296457629501 -2.2257345809708289 -5.6339638814822406 -2.7870362952422307;-0.36385442720599503 -2.1372913633016637 -3.099599503257549 0.53617791291725281 0.051285012492300407 -1.367319797272575 -1.0272025323560279;-0.69769241820999439 -0.70140156902517337 0.90564630497875331 1.0058211072283709 2.2211386238525348 0.79697461308681239 0.64211711096248181;-1.096356544053362 -0.28952034228495893 -0.19601937952173648 -0.7814750355468445 -0.20798011695612337 0.57681103292618863 -0.018945532236990029;-0.49992332030671088 -0.60684220125864596 0.10521806184317192 -0.47143971256472766 1.7558030869484182 0.50319133101059632 0.19216597714643757;0.66741897993619148 0.83933530096549247 0.37033751960097688 -0.57539906356877724 0.7944363190817485 -1.2001537286513679 0.6432644600678471;-0.76887325902273729 1.7250440638655551 -0.12638375381465006 -0.63397859803831191 1.3131303993327825 -0.87803209199514731 0.59366598944126148];

% Layer 2
b2 = [1.4935631954024147;-4.7323524768509406;-0.13899448518151805;-1.6117607855882321;3.1921539110885728;-1.2085269130208522;-7.4029132271016831;0.91792039761252542;4.529735521582718;-2.3679031005643409;4.3683051842905503;-1.0215785396033517;-3.0179578706680332;-3.1239264153864057;-2.3506834276585327];
LW2_1 = [4.1326133382159114 2.0180884012958797 0.80922688611866478 1.5894331989618347 1.879622320022081 -0.89833453263822882 1.4128198461570696 -1.4805420809117995 -4.5517098610004476 -0.51239824066095341 -1.3513497650700714 -2.0304586985825752 -0.94339678524685322 -0.18764955080785048 -0.82805242091256537 0.46271397295005162 -0.56956475556634112 0.70769673475898986 -6.9485463872205724 -0.029000450759470477 -1.2496479093368926 -1.0837178652344555 2.1167472195776549 0.19730290401860379 -0.61238664221856143;-0.1048843330436872 2.9516853796265736 -0.67896904032419425 2.1026701262542731 -0.52300377944629584 0.77504799834927185 -1.842725414410797 1.2340653807917807 0.35145914195784084 0.17862569798804342 3.1172270161753031 2.2300467575083012 -3.8688088363397162 1.191417656366127 -1.9463955062145093 -3.4589500319322108 -2.4697930791466214 1.4326915015135164 -1.8411083458709969 -2.1805997241067474 -2.3221319194414929 -0.23800901215612999 -2.4407081328752556 -0.91423562030765637 2.1565968714477615;-0.67286686635755122 -0.50305367357628983 -0.783453122979067 1.0450630896079012 0.50880988028304108 1.2545126246851404 -2.2263109193667225 3.1966120988400415 -1.5120165345609926 1.3654035725535214 -0.14282219392425699 -0.094725293831799562 0.60115219288482025 0.7497979433361156 -1.1882534017224424 -1.3439945547497532 0.030014735257669439 -0.85109270955553107 1.3732269364003189 1.1068443428304093 0.49015369659840397 -0.87408751265612761 -2.7709718411538202 0.91986219619172382 2.1609856260350275;-0.41397495646570592 -4.7013886238458262 1.1225528109093021 4.8638050201974963 -2.9404097632738346 0.44062582177569354 -0.83695655519251788 -8.5328488296921972 2.4347939702140797 -2.4348656422917792 5.552591947261293 -4.4758500097485232 2.2236310782893924 -4.9694065679127544 -2.1937230411505748 2.4304862514794023 -1.4199450586350877 5.0001777115202017 -1.2072329470859882 0.63310855182100523 -0.25938327985127335 -6.2216513709770762 -4.5769446923624875 -1.6563652604348993 0.013834060297762173;0.97585546361920439 -1.3262701100090357 2.4186423228170995 2.0254908432875962 -1.0008184839228378 -0.2048802813407789 0.64418288541669733 1.9043304727190631 -2.2918714347932339 0.69116171922117586 1.8786101033443214 -1.7273816193164597 2.3642072583087503 0.94017186170884104 -0.69944755974992678 2.042459847030023 0.84941849375003642 -0.47562143258927492 0.80491893486704158 -1.6317814547709866 0.31941450231669027 -0.3330404164642034 -1.9284340985477122 -1.0114738561366785 -2.6989940845269187;0.4656732726705301 -2.1564165957532713 0.32750139844415344 1.8660387525856805 -1.2125797905951696 0.31844029944375152 -0.36625209591914154 1.4976577140155292 -0.83210606978936663 -0.76475078597255897 0.7708666114147793 0.90646535297418696 -0.44172857277373112 1.2423679063006527 -1.0121093531378018 -0.39204255916411984 -0.67039340290303373 0.67971348095002704 -1.2192122873949212 -0.49107283859640571 0.61540082446063793 -0.70344929578958515 2.0046613385466014 -1.3349793727464361 3.0820584010355825;0.42950013524855402 2.5906411835446819 -0.57921349938969147 -0.74092812629990645 -0.12038479670887159 -0.45988423650360977 -0.67773445860972825 0.31372112858478141 0.30651852149539505 -0.26690833480520892 0.64185925957663847 0.62705023039184415 0.28546096948997068 -0.054220524284472688 -0.21442728487288923 -0.34160808092704814 0.10600659143284426 0.17932019620513776 4.4983597556938069 -0.2682683647166153 0.81898112373903731 -1.2698516716849715 0.30662574226659067 -0.23922387689111879 0.88840699859486383;-1.1141441658698632 0.26406541475790729 -1.4887968902762296 0.60940836863456749 0.74803313625836232 0.78725374442527674 -9.4914284907103106 1.9545065160626798 -0.76885797944315526 0.37530470866287824 0.2946894267715261 -0.53372415502618775 1.3006863836457774 0.72292001622358271 -0.70130897575076745 -0.86501604029129608 -0.54939646768475525 -0.67813876176124133 0.69844664741459406 0.031375530303666188 0.6240909535995639 -1.7729471179098826 -1.5140610899275992 -9.3609085615617449 -2.288400920515933;0.7172277701778158 -4.4697562369968749 -0.49158699364554459 -0.80873931770156937 -1.960674455225075 -1.6868236976237676 1.6488432285284897 -1.3722673327572674 -1.4615095280892225 -0.028747334817679705 2.7249139920356535 -1.3275441115212538 -1.3064180207452873 -0.92706009521255317 0.26940838045400611 -1.9447167307171442 0.25483592405344646 1.8657344040350028 -0.81045895236085796 0.0061393923922275356 1.1363530700582716 -5.6632052930261709 -0.23497857066727112 2.468474581326932 -2.6092507577397992;1.9748598988613064 1.8546886282654216 -2.5334988412566304 0.770027842662802 0.014945003709676228 1.6200944712834651 0.074585927144012437 -1.9806083786839372 1.2508482830155863 -0.28803959998980821 -1.7532487038760032 0.55552255379190041 -0.28419851398257828 -2.7544109971673927 -2.0399628930439775 -0.99157270353485139 0.66117841816346101 0.78489468873821144 -4.1494759917362956 0.69034000243547655 0.93007160157021973 -1.0704503932603873 0.024197423597120925 -0.29575649291281553 3.3276948537090107;0.038640773795461054 -2.0208796071240247 0.0085524402465925152 2.3731562724193065 0.55771077020536108 -0.070560831245222694 -2.0308027443511372 1.8319985315444645 -3.7918121179740023 -0.95769543750210939 -1.0448331093750385 1.862640991784944 -0.089644255338710149 1.1222370533781405 -0.90465971383202437 -0.42814697220075926 -0.54349989368937901 0.89301390225485799 2.5651682968130771 -0.43943140189850766 1.0478345576779893 -0.38504747627404379 1.5994418654920481 -3.717460321636922 -0.78016291418227091;-2.7559845412443718 2.6032927572172269 -2.4808567605951231 1.1548658309721216 -2.3737684309476887 -1.2269928825763055 0.92180710888395634 -0.22423903253265917 -1.2847096621557745 -0.37954485518571712 0.37039802743639538 1.6422928541474875 0.68727387237620396 1.8214357576177325 0.4076278756806121 0.29140247583804796 -1.576951109190909 -0.41708705855378359 0.59590754014511937 0.48964067092906371 -0.33684897808347514 -1.0048372305447122 1.2030386987175323 -0.30196192704395503 -0.78251164171345233;2.3776577358854598 2.3062908993634865 1.3405894141894166 -0.45134640384924407 0.28271045797978128 0.84961292908862085 -0.011651431887907253 2.1646615142267311 -0.094719763311826327 0.30426568301165946 0.39621931097509888 -0.034703379132893078 -1.9665152703056565 -0.17907700770543492 -1.1114194973350924 0.25644134517064543 0.55773381517472009 0.90753519798317317 -3.2772762783849201 0.38102714202095678 1.4645968841145058 -3.5362995911003763 1.8575327358265514 -4.3669927768063763 0.29816494720756481;0.34190519203347042 2.4027766843274048 -0.6295552392816649 -0.48385105408749191 0.43292428986623566 -0.49631917496455008 -0.91686441101543348 0.22107409439351217 -0.15682772360544373 -0.29202981325100547 -0.13134723850705013 0.78976590831799554 0.29443205460901262 -0.013501891237293912 -0.28852710720161717 -0.31526478735641117 0.1491779968875942 0.24972543183015933 1.6832096514063919 -0.25519532520673416 0.72503160030821079 -1.489814865675722 -0.24080377749682638 0.10114818239956612 -0.23805767599888505;2.8902160250115791 0.57530734740374234 -0.30789723954582598 2.5368568474654132 -5.4224178697833878 -1.1850868940308783 6.6177915305071657 -0.53857095830067381 -3.3989172907010579 0.35701152436261752 2.1883173057854006 1.2180960338006681 0.98784490231637501 1.3367354689455644 -1.8968965571963161 0.20280505015834449 2.6569681106817877 0.53397490114432988 0.54472289435290111 1.4462813663514318 2.9056560804935181 -3.0918346300035053 0.95521755065766567 -0.84821934347829331 2.3637955637535581];

% Layer 3
b3 = 0.54082081434972651;
LW3_2 = [0.024026004453022873 -0.0090705795309702231 0.013417852271756958 0.00025030798308554446 0.0070844361165983347 -0.25492310172938082 1.5654532934756133 0.16443543551348117 -0.021467714701993022 -0.00061216894022584657 0.25192685066584752 0.0087324125231986703 -0.039596489897591049 -1.5719647270163908 0.0052306985126661472];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00111018595614765;
y1_step1.xoffset = 1025.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
