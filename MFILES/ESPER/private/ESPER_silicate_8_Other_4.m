function [Y,Xf,Af] = ESPER_silicate_8_Other_4(X,~,~)
%ESPER_SILICATE_8_OTHER_4 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:41.
% 
% [Y] = ESPER_silicate_8_Other_4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-2.18999082656054];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0582073296585987];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4215416524157715727;-3.4761619450709915213;7.5257612109194713668;4.2170660292786976697;3.3518295334016174891;3.243063250913473361;9.357411293635344407;-0.39364744807441270913;-3.0315607104275876793;1.5655924003134809031;0.20200890405926827387;1.6947027344763845313;-1.2950800611183881372;3.3842670072365286238;-0.69732736835636566219;1.3939578965993422166;0.73418531357843808127;-3.8567961629027163184;0.27842099119427060616;-3.7304848872088647305;-0.39226918873905736174;-0.028492385797144262338;0.65123752578828608684;-0.59948238128374331524;-0.096419545596938563414;0.7733925109255584962;1.4301475421822362755;0.2455566467253394447;0.31832057433210664277;1.2720456341372954334];
IW1_1 = [-0.11309112440637594799 0.30362416627289345872 -0.47629463830299539895 0.019231793815812116277 0.71272791979880034674 -0.48253170237941572784;0.98623634903373169625 -0.41016271150800154288 2.4004245757800832806 -2.9063136696225586597 -3.6586498955125814625 1.4212385086937597833;-0.26427103708043492292 0.057384861264096594102 2.6153482609322757924 -0.37162031276727625073 -3.8102415918875225387 7.2299600021382630644;-2.6790597390319801363 0.81007713027460925836 0.89220272763656216508 -1.0148790486408585387 1.3652452589705079689 3.5683982053734468742;-1.9963674259479931017 0.44963727502710398864 1.812816665245051917 1.1225324513690941863 -2.7908774884524421012 2.9420565088560377554;-0.046807828770168709298 -0.048555492096518562684 -0.43449511989060279893 -0.15594144080486577186 -1.8549094839273445601 3.4696498017442083395;-2.047744615795699108 0.10557572925973954248 7.3991986899635087127 0.26113425992267896847 1.6660798030189560848 1.7180948495995500558;-0.15512970711949461422 1.6982887267714796842 -2.1936913285786578953 -0.039394306165515903528 3.5768148775097672321 -2.04832545621868789;-0.5204658856916429821 0.12382475261320141646 3.8617790711143968885 -0.56191798099334611116 2.7524965720964296167 -0.19196132171594149085;-0.28292830645175459647 -0.59028303139110949171 0.29326961914109239693 -0.50006688788946562774 -4.5924711642552917823 2.178520882833942629;0.25090863717247369191 0.044964435779954514683 -1.7688296860513055275 0.80682287245939909859 0.9428661172494481324 1.3158123472676463983;0.72815779299640182032 -0.20339659352124517255 1.9345849839929230018 -0.13739903936704669918 -2.8374367810180536331 1.4644607595745431361;3.602078567874965831 -0.72088551577375814539 0.28524818138873575535 -2.7573284061090874708 9.3790614685487003754 -4.9041197360062227517;-0.041818229792911519593 -0.078212442667773759974 0.042512714923354309737 0.10594419165506310798 6.8113588830759193016 3.954725678048832016;0.20414644709558191216 0.10379811836965587013 0.1057580068906859988 1.1904782303092338314 -0.4312695295166436571 0.25049610825472928832;0.72743116484116965292 -0.25453977730179838668 2.0987189065352156447 -0.20760345003680755194 1.9160529089850932838 0.75957956647327840027;-0.034741183993496821403 0.77432359882958778918 0.14338445069332192428 0.10134088835786284055 1.9595205337985026617 0.21901260583883219724;-2.0992903116245540396 0.27358270984545635107 0.72912664743851196558 1.2527026433463717137 -5.1670951415913375371 -2.8551715902476977327;1.2873069034614579298 -0.27499075375708603719 1.1903843260775806012 1.7326430890304522769 3.7863572207533184866 -4.0254003568143197356;0.026658570860633341859 0.020834071212381236743 -0.099802768190699261974 -0.5741824119079638189 -8.437459381954074189 -3.3141865294391910091;-1.1843990520740914629 0.37115895977355772839 -0.035660490964177962714 0.22238965397264390256 1.6421363188975253156 0.57379293327381597489;0.26797499213809899965 0.030771766151897698288 0.362745942556153389 -0.70210686754766815643 -1.000267798702157096 1.2875956842257674229;0.50652637880140138904 0.38116073736918687498 0.55163597447184542499 -0.28558390495528335196 -0.43476509716154415619 1.6064338931771968699;0.9225650665528211114 -0.042568767197334211883 0.57027465206673666476 -0.49565452738293980239 0.0075364709179566932717 -0.84171878296831337263;0.14521626776820814597 -0.15530565683277458566 -0.93983181936296966708 0.24308150979793527457 0.15044963161848212696 -1.7309045108646976541;-0.27920271323266432351 0.18228182175403950804 -0.34065558905667397971 1.1275653397023368552 2.0537888813450395631 -0.95905979489567561025;0.7803006388653115355 0.41606286050745144856 1.1069357073783931966 -1.3279854781397748553 0.24460590804147253063 -0.72464862374949945423;-1.3548906281494317305 -0.95124124932245246455 -2.0575192102575785569 0.81553453173884504768 -1.4720194430662749685 1.9915381857882452632;-1.8564634328750719838 0.00716726443938911148 -0.39657435568584559205 0.35779493134301826318 -2.8100174642035868899 1.1149609484808731263;1.531504827693708215 -1.9427839774437205556 -0.25805567706851623155 -2.8289500759768286819 6.068830974517412713 0.29156731517824613364];

% Layer 2
b2 = [-1.0376977287014772511;-27.077802148469853449;4.2825871813135210076;-7.4742414104052308232;-0.38070697074346149247;6.3301358730676868802;-0.48806053088853956767;3.2270765792363715896;4.1770409108774018137;4.8126149457552509503];
LW2_1 = [-5.3142649025097803417 1.3328146082493907976 -0.021249810984403427749 0.35860201896639870567 -0.058856055061437699549 -3.2513764539373282147 0.029981235342877953637 -0.26951483045672980365 -0.63144467029969009175 -0.73379221770222435861 1.2766534491764114367 0.32733110701147427601 0.097993556755675767511 3.1397310965225289081 0.016159445589022262968 -0.5286311176754626695 -0.35962444835002965737 -0.1426227458827617478 -0.14847200649678896078 3.3970693022078748413 1.3965287435187867526 5.1699103782011039954 0.35449305017247784155 -0.69863039394145065586 3.3315999870947439199 3.3138716538613617324 2.0038542755174821863 -0.25069118044724575389 -0.11074639657210010035 -0.23701247859205701318;21.862416595969211386 -4.3749087691017152224 1.3712421274070427657 -4.8556944776784636275 -3.087054941398979846 14.706408960917475071 -1.3436466628489898145 -4.8386058073671804891 0.90175996087051801808 5.3181804479312964062 -9.0483643781700244801 0.05012616697271000954 1.3613637474006619055 -16.729255555614024331 -5.4614150313770100098 -1.2023455626388632744 28.975838293195582906 5.4079659052958346521 0.030589369657987773576 -28.688111817927858027 -6.4132114575514567179 -3.7280291702508123741 -0.79060205189192567232 -0.68320362341624585323 1.0209686211563722136 -7.1807897934285138675 -16.444230610456273212 -7.6241689657996252194 1.6619461853342210045 0.3335960634767700661;-0.22501331111186206879 -2.2375825987256567906 -0.67243140944894708166 -0.14902389463227877497 -1.507309001694695505 -3.6896716049490012601 1.7146642036498316308 -3.2194886634822195148 -3.4915235446721615276 -0.92749694305599317268 2.376443624503240315 2.0390879567471569267 0.64835662180181730108 -1.7646572428746865047 -0.72357842586478071656 -1.6174898863927305026 -6.7691234884253717041 1.9350220646160811722 -2.2948258744189402591 -1.4400732402313287661 4.3614819306475363092 8.3901649182775983604 7.2725806249010949145 -1.1194117110007932858 0.048713906639073704941 7.9691013698631714135 5.6669630055261910329 -0.56313444850846339218 -0.23552074881154860808 -0.44644986717315415792;-0.50871167032435971045 -1.3663046161985150651 0.077332287953066861097 0.71400441262785985241 0.24365674416522517531 -1.9474771562695818439 9.2880232969034324242 -0.025201834721894925129 -1.0927780775194124718 -0.56787889643091615799 0.90252022886546356961 -1.282032768560619429 -0.90263315133267540968 1.9050014540814412811 -1.9345381792752065486 0.21707753785601713314 -2.93182776254465427 -1.8234016213254009564 0.2750710570514758313 1.2177932095806875967 1.93801454520273575 -17.943678614212725364 7.0450286324422277673 2.4750502534294471779 -3.5314987190888942337 -9.8668364755353401563 -1.2076819998955030666 -0.39622262267196883823 2.6513958104985313469 0.36963223626591656945;4.5412094178244419851 -1.7036321482967791141 -0.12064231891737427216 -0.55154539437948102432 0.50994224177626656935 15.834231844498281916 -0.34780877913940189128 -0.49952403737373740622 0.49125909466466632924 -1.287434332605589038 -1.6363996376927978371 -2.7146082274715386262 -0.15522748013319118132 0.20078732293661827324 9.2416789331445556854 2.1194981191416628619 -1.7738545457072525391 6.1018355556979324561 0.60795195398593415703 -0.89717720169235370964 1.386036153014388983 -10.842945956350471093 2.4376276135817271928 1.2947022799404739324 -2.1766793019933716735 -5.6699785320341788974 7.3783946130109585582 -0.32807668725993943681 -0.0093387240329131648853 0.17811114054511506533;-3.78099612214151648 1.0217363849684450994 -0.085527354503838026734 0.29613795555948180249 -0.45239699655165338532 -1.4471992395812613985 -0.053645278134444120133 -0.47412674092479029087 6.0977528403874012852 1.9124903990305888168 0.14154151302064876816 -0.53429968900610680382 0.46350922754809292803 0.13918169160131371731 0.65442927431418929096 -0.28507277728701496677 1.5436774176920169399 -1.182359544122431938 -0.32897834146312143755 0.9966490033650762248 0.23026313673905141055 -0.037175763471347628153 2.7753325716856371841 -1.1887754401858872111 3.2030711728825327356 0.27954628506623946382 -1.8343476673964307366 -1.4005188204721299439 1.6077962465683719451 -0.30189237610746288976;-4.4084744995738960327 0.92396301162085592296 0.15738149144160423765 0.64621691010250104092 0.24770260596975302025 -5.2370623348264517816 -0.08809099817638683938 0.43567056049628016812 -0.65475278214767040907 0.47588110021779039815 2.4719846525006348159 0.39377272638489735357 0.20827326382844724151 2.6526219600864848758 -0.58432241605094725756 0.064782535887976361311 0.26159479890961917503 -0.22615869619459338935 -0.38161018958908521359 2.9872092898983142462 0.72756383740241559188 7.8593400128984090003 -2.1752161743567173247 -0.38644985326230302247 1.5871677583808379008 4.0209213989592358374 2.3488416620613605801 -0.098329372271122331139 -0.61322746287548413058 0.025689764242186101384;-1.0511825982534868107 -1.7941445522155137215 0.57925267064395025152 -0.28208573358743632697 -0.4996112003548122682 -1.3142137703931573434 -0.58447318694252881066 -0.66093355066280068399 -2.3339242000273805466 -3.0124893471691875924 -0.6664105463233581661 -1.2267066358165619189 -1.0782333813406588252 2.7416435044333140603 0.63693879513880147236 -0.10827937202180674958 -0.56904020044086889296 2.9172383567758100043 1.3037486744950099737 1.4557660205269722375 -0.1811384008685173741 -9.7173885261705699179 3.5666689359564629491 -0.058204668390772061615 -3.1387935281845624758 -6.209855221559118732 3.1227491513233069931 0.45684389327532459735 2.0819973287174722287 0.4538937798022988912;-7.0100848987242176946 2.3846923593086897242 0.48261213180370771125 1.2486659547898111278 -0.45524991863077585164 -1.7887979672438409917 0.087988386823857719921 -0.65068268789989369694 -1.3768956132415857141 -2.2101959400491204555 3.6672124905197023281 3.3244406557932824064 0.33784368149592186592 1.5159202556564113085 -0.65985554599355822347 -4.2674904819144501289 -2.2200399794107559259 0.61591600096748821969 -0.63446510304094194677 1.8030485254352299762 4.649150530638285872 9.5040901842949701006 0.60912873690747071365 3.1097874350828083045 6.0057364626219582604 6.0944267974898780338 -2.4861066245518697038 -0.50647061868368081772 1.0238713681832691815 -0.44626289116834699788;2.3384445870437842174 -0.20653773376170250775 0.59310921182723053136 0.16997151397443488463 -0.14645066736099837668 -2.8444459407232867143 -0.075596014633816210893 0.80462321322509611221 0.02557345005358884274 1.3962943209362570496 1.1883398143771457534 2.3701439395559957823 0.21522562295781377806 0.057333728338915423972 -1.2244857360594505469 -1.2845371553088449357 1.7258880782797105802 0.20916640662917113103 -0.22479763671619032439 0.057775764638735960244 -1.7089845530571798893 2.726948231086987473 -3.0938872958652221534 -1.1029492398923312901 -1.8716637091915120372 -0.39556233611744273659 -2.1680805683322730282 0.32665466028503759022 -1.0189549735164635802 0.25497741018811748148];

% Layer 3
b3 = 0.38478426074650567967;
LW3_2 = [-1.8234679738486436751 0.6639272346800393354 0.14728712968019291862 -0.34384721960307368382 -0.074591763677100117458 0.50075437324046623289 1.0234577583833222025 0.33454484258186362178 0.50787004787662692884 -1.1204887301881869544];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00819772922900357;
y1_step1.xoffset = -2.02;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
