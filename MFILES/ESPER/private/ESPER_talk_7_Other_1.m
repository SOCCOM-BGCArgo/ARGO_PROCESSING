function [Y,Xf,Af] = ESPER_talk_7_Other_1(X,~,~)
%ESPER_TALK_7_OTHER_1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:46.
% 
% [Y] = ESPER_talk_7_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.520645274835327;-3.5146828561177124;8.7439391721942883;0.62797949881657811;-4.4284894698396196;-0.29899405962788889;6.8766961711077759;8.370363910615529;16.513526470970056;16.029213146689067;-2.1345207084863427;2.9156657459503896;7.3284886506009501;1.9864484063414352;2.6885270729386503;0.9150706718761662;-0.52207673480877337;1.2213277924011043;0.52282399081494502;3.6971598567892165;-0.27161122785203234;3.3189371423186964;-11.154363800257681;2.6552266866985654;-1.5820270402513608;12.700712776938914;-0.51197417107881371;0.6136553196208594;-0.81544993414253841;-0.01153706582031622;-5.9629529763224314;1.0242799956487312;3.032458519889671;0.74722739209369526;1.0909981406705533;0.010936880305078549;0.64626795791229208;-2.3143914773080154;-11.078009529780596;1.1632764729949445];
IW1_1 = [0.022762914998321029 -0.14832174439019061 -0.40448194562129819 0.28987366951981752 -3.5838470525048405 3.3900870453353305 -1.2560088199739301;0.60829870456142654 -0.3957551051939191 0.84176285599843237 -1.61558593405067 -6.7734237366000434 -1.3263159645717963 2.1632685340843092;-0.56317632065927914 4.8147666096944608 5.185038750475564 -2.9956056493744141 -4.2533865660345267 8.7111679971159255 6.4811697154715331;0.95080509724108042 0.31661104266540407 0.42823577375091759 1.8799184067447763 3.7790720488909928 -1.2054443312184819 -2.3900433259632954;-1.0556381341791605 5.9814093066255811 3.7347010198194392 2.7213565365682881 -5.8131923093663724 -2.4669721521859036 0.36200150030695705;-0.01571284404856663 0.0068509714021483285 -0.024947795037563027 0.071842116937710115 -0.025290766972965544 -0.65099599062327052 -0.16273906603160715;0.24411026266978736 -1.1733535319722372 -2.9756614330224087 0.38641305157321215 -16.874345063502155 6.9605581616285734 -0.79456586225855241;2.6882220130176324 7.0445878822859544 -2.0445026458469386 2.9733517229484012 -24.759052903770645 16.445993277963765 20.494723453261013;9.9798331414887151 -2.9834756625606271 0.53403563282380007 5.5719423874551817 -4.8016789872436823 3.3755049631661094 -1.8818350429849442;-4.8479008930897551 1.0868556157778599 -11.918937014178546 19.764121155343101 -8.0204014711299614 6.0315514954434404 -1.0941865643057753;-0.038588607275159365 0.075208276277427266 1.2887622401210765 -0.58782927805333096 3.1434315402837885 -0.64444334078294419 1.2071430913968884;-2.353417917775273 -1.5859905208135023 -0.94314521160371512 -0.21147714839294293 -3.1333546709665763 3.3768288167906322 4.6816652631900713;-0.16986154961529767 0.093248161043094288 11.494408815834378 2.1738848261903749 0.46480901587311335 4.206216310278359 21.549227673094819;-0.22544473817207963 -0.053128190846599414 -0.52332409829720294 1.6863381564663875 2.8340213915336014 0.13380461449736675 0.94192909415641302;3.9231738529056863 -12.100270201346511 -5.5905558948913514 -4.3595118201596863 -13.334820531236385 -6.4893528477023468 5.7216153236762777;1.9482404727313316 0.55419875242162076 1.3438631311959708 0.15506865276948015 -2.6462274172387987 -2.2105962649577617 -0.20413142114165467;-5.4232477785424678 4.6411288804553763 10.155244635230192 -1.6882978195821423 -1.281088002578606 -1.756735034197942 8.2227632686886647;0.10195456181474596 0.38265894104777171 0.4060827259510002 -1.198544482037772 -3.5765433824221127 -0.39333080052756136 -0.87495376009905712;-4.9300364929239944 -2.6417412548186507 -0.070646396793898017 0.50771211636014624 -5.0024687764839815 0.49243345481978096 0.58378099106630521;0.0075136970063560118 -0.14463306040253618 -0.42016250224319135 0.45561032826124598 -3.4856190589763982 3.4458441437476259 -1.2806861050826384;0.085733188830990237 0.14700077548925022 0.4301596618693751 -0.24060362254650866 -1.9676733608407486 -0.21303241622856897 -0.51032808925306605;12.035867195550402 -11.212786269487987 -14.445687331952517 6.9139065858400812 12.324324861928996 6.2596778150831405 -7.7569794134073886;1.1878854402597305 0.94520927283521117 1.1267748755301379 -3.0930039652849808 15.556084808500632 -4.9349424166443381 -4.5016605502787748;-0.48021344984846148 -0.7059945208724846 1.8399596081625516 0.32630296082221377 1.9729502835594472 2.9150645969069342 -1.0730063404336392;0.061350343678620169 0.2246789298959401 -1.2621230691526308 0.29913223659940852 -0.90138116114586009 -0.41982247167478848 -1.8133249470386446;2.8069543436390947 1.6400804475935542 4.4580576740584101 9.1258473804359994 3.3508912144435148 3.9041683014297988 -3.4781806098596899;0.20929628405485506 0.010467342797055286 -0.46895966866963873 -1.055349676636461 -0.37594402246136932 -1.4373171102368556 -2.1703849891165476;-0.027651026704618845 0.041379345558057376 0.056762655569715437 -0.050741747299257373 0.096748017685591353 -1.4635562945884946 -0.4348371555023634;-0.34964616900536988 0.032779961344861108 -3.3140336943321449 -6.3277159707540687 -10.245831026164009 6.7305312549145508 3.0061140039298442;1.7998474885370541 0.58600301731450299 0.58799420555919069 -0.19954733162215663 2.3797964286489162 -0.6800452822517058 -1.2263452386484186;-3.8351350801539388 -0.64450213569857451 -16.960486356998551 -1.3284210062815522 -7.4196779786266225 6.8694348693180638 9.5898744584375581;2.0564748947979603 0.72033802371622735 1.6289276311504515 0.55456596750223519 -2.2116903538632644 -2.5749448727860824 -0.07497789215626284;-2.4248531263107944 -1.6359718477100187 -1.0013700720265202 -0.19018040781309922 -3.2802720578341344 3.5088833266977892 4.7817526876590613;0.88048864257075943 2.1723373311436727 2.0588777966370664 -0.76553924433663367 1.7537218106449965 -1.9294666590557676 2.3272792703425993;0.35081661428932082 0.17306654323796347 -0.24458437652680859 0.5285336569393192 -0.49109875737637959 -1.5555650635480995 -2.5685681400059925;-2.3914991584089575 -4.728755021066851 -16.481245431469134 2.3576994219225891 -4.445527103770587 6.3703074072613797 0.91477407908281994;0.045313224273861669 -0.016434863367376016 -0.055560282891410406 -0.20074296391536395 -0.046653872372516489 1.2143857952289536 0.24529273804036422;0.8008614762996491 -0.74365660384903298 -4.1745119161645725 -1.7864689794541146 1.8396302477225341 1.812785895854699 1.7804512745794774;3.9519043839556174 -8.8801094535556899 -2.5327634461635284 -8.2523863690481551 27.243906824322657 -7.0513818560148023 -1.7393754269495256;-0.16381749230448564 -0.10520367542829923 -0.0038570216343915562 1.2512287678069485 0.78179813677982479 2.1225594152495137 0.77635507138337112];

% Layer 2
b2 = -0.76928907066751029;
LW2_1 = [3.0842994825456729 -0.090849798162785364 -0.011145864012298758 -0.076778384140009232 0.019567455444495941 -9.0584753082403093 -0.022469617765200539 -0.0048698697549053515 -0.013242139089561707 -0.0036504322915273421 -0.22159708189438024 -1.2604660327664781 -0.0096057082887404076 -0.43088124696961588 0.0058760095889225086 -0.18519994130355247 0.0085551384782220352 -0.30580835240468685 0.027331454770463816 -3.0953520314910854 -1.0906858557761343 0.0039296831659325782 -0.028390509235962966 -0.1014468241856841 0.38518012959716424 0.01539262022007073 -0.43485234983211629 1.861953153038503 -0.02737293961148804 0.11757491003237525 0.0092900142879696595 0.15672465244679748 1.2128255219585289 -0.04088793557585696 0.33627352834735502 -0.0084424628718257188 -4.4338804330491346 -0.034505684245028229 0.0077300495488032712 -0.44293611275754929];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
