function [Y,Xf,Af] = ESPER_talk_3_Other_3(X,~,~)
%ESPER_TALK_3_OTHER_3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Jan-2021 17:03:44.
% 
% [Y] = ESPER_talk_3_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999540494077341;-75.751;0;29.715;-2.05132667284751;-133.803853032615;-0.1386];
x1_step1.gain = [1.00000001035699;1.00022983623563;0.0140762793578401;0.000302617642608564;0.251952632905014;0.0584431850247228;0.00432440760873659;0.00826143816767911];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.07940754184038068;-1.4430160881479157;-0.68783862770941206;-1.5381802101584603;-1.0621986672204573;-0.48068926132281414;0.41539518141725745;0.87396026804632487;0.36438488494951843;-3.9062410564093137;1.679170198864214;-6.4884229132624505;-3.6332962303398406;0.28364350925815246;0.45830333126229672;0.84009300247950991;0.41609842064014524;-0.62723346041095818;0.9531453886290886;0.16763258132063111;-0.57848232960556656;0.4928978579152874;-2.4964073753240532;3.4867396791542684;-2.9752243028808691];
IW1_1 = [0.018172891684385836 -0.36688427414126729 0.27270898053228299 0.54858724148587557 -1.8306108274318205 1.0263761968486296 0.29027472679405714 0.5212101358142982;0.023119216137888653 0.13732540507053395 -0.14995704229484139 0.09511442766014741 2.1950620703927326 -0.7381051363239175 -1.3345522012947417 0.72609338268642742;0.42653350049648864 0.50411021004711642 -0.66449177507823187 0.28524166250748789 1.7018021724174262 -0.75502913434975927 -0.49845843299027626 -0.97188364479544476;-0.068266442159014992 0.13814296329511452 -0.086340782917491823 0.10599529131960539 -0.030525699494940151 -0.66719014723219083 -0.45549752224227219 0.64227526240226063;-0.05490571899155753 0.12715147631377058 -0.12734886592528868 0.14055894228092003 1.2727756343365251 -0.43669463686577997 -0.94206803535452877 0.8191605202430865;0.89009567983293525 -0.7516144481255933 0.85830006810525927 0.49216476237144163 -0.36672867100999401 1.1135049447282717 0.22287690783737482 0.1501296307504732;-0.83187635474067789 -0.52594857768071357 0.40201570915325602 -0.016169910641813959 0.22396482517498673 0.8546252583963887 0.33819759230817426 -0.210809311608573;-0.57825047342512892 0.25339870287798016 0.060951111956351521 -0.4194415341291714 -1.1297454540178118 -0.43101389512927091 0.25888567721443428 -0.10970291767878119;-0.60650819593405259 0.31524527128511337 0.045568052472866966 -0.49023766560350701 -2.1912105802639825 -0.57771690374041929 -0.040016419687466602 -0.84358259500636845;-0.020717702526806492 0.15274567182501297 1.2172152725972871 0.6509315799504295 2.7477677359378823 -2.4413171285901618 1.2424500271551309 -0.6795205738125405;0.15374499261708724 0.33761201757911974 -1.2784849337309692 0.40806716529978893 -2.5834110439943858 0.82236798823028667 0.2920024658744742 0.1669772191067373;-0.28203760581842208 0.16461188502076327 1.1411915750836727 0.70638378577838778 7.9361196377451328 -5.2294835793285568 1.0524475336572972 -1.407097959087535;-0.10791310559745594 0.14647451860871319 2.3325312368691007 0.11527799905685304 6.0967831189779647 -4.2934389307820773 -0.86756562714964358 -0.39983245245972643;0.61424787697549399 0.43225748881075254 -1.2303412885670051 0.15678064467022465 0.83306953840409592 -0.45765859501234762 -0.53323646815920334 1.1689650114395975;-0.084762127167801571 -0.030233239735430514 0.022287309865571439 -0.21852800321374821 -1.218073848824853 0.11536569419435665 0.11144792577270143 -0.15075511405259776;-0.31994451823664699 0.41067046851723399 0.79329843238317499 0.080355480398415211 -0.35040254908125545 1.5363662593664187 1.2585429611644303 1.2662708400039999;-0.25714690415228214 0.36504986635113434 -0.91993832583536606 -1.2291654831282617 -2.7954342478321212 2.9759581773910155 0.60158841310452982 -0.22264477069558949;0.11289275549080197 -0.0051356639529380084 -1.4072434526703892 -0.45902530342121056 -0.81237563315327443 0.44990248596289445 -0.55952509247505056 0.16208450439730812;0.44024795561729207 0.043711653203688097 -0.82914533442356064 -0.51927299074179245 -2.0778795318771452 -0.033854399193498808 -0.21591013707715465 1.1848012043504292;0.022518997095460857 -0.082286720595379725 -0.70211950896174158 0.17800834888128486 1.0106784763295997 -0.18093384490499378 -0.45263094510982493 -0.10912895208720405;-0.70570183654393581 -0.10232849440092862 0.10699361222270037 0.33010159597777899 1.7617339881376377 0.48902810556708615 0.019576966375066066 -0.5240267879783872;-0.091788729100026806 -0.49766841374880277 -2.2220814461734233 -1.0003477093217363 0.36798340082312009 0.44699073811017453 0.42464930002248757 -0.25223662581751211;0.17809684743111617 -0.016590024019120662 -0.36807834531046396 -0.27653523004427721 1.6828938902436739 -0.30907108908403302 -0.89126574320025131 -0.13264198321145035;2.2266474314025606 1.1670520950359802 -1.244001685547937 0.053459746259334036 0.41728413932726294 -1.160837389638997 0.44973782415578201 -0.96007152096459858;-2.0892733473543781 -2.157895556899772 1.31441305740967 -1.0039521608425936 -0.13466052656513558 -0.94792919824250188 -2.6888875443076246 2.8872338612216129];

% Layer 2
b2 = [-2.5602846633208625;-15.694668127924849;4.4378834484552163;-19.405345707811044;14.58850436364971;16.606004012602082;-0.85821233626768711;3.249616974147564;-1.1679226604610631;-23.963893999404061;-3.678276658881948;20.289989381805444;2.097836111112942;1.5187337940066239;1.8815305594687548];
LW2_1 = [0.076949094678738367 -1.3083391986647221 0.46519298692149036 -6.5014887704198978 3.7756994601606717 0.87225540996320672 -0.50813607282906037 3.3791313363681419 -2.0929474003398583 -0.4590668558856737 -0.49231775169355046 0.64985174276701341 -0.35039413915762119 0.094721276658527503 5.7744673863500946 0.37159549524104246 -0.057074853158325195 -0.94236036240749899 0.32398433197045579 0.94159761848973234 0.24178803441936425 -0.50154381978623863 6.1408237044057916 1.3859431385709002 0.099873525132436039;2.7603313578308493 1.1001313381723858 0.27997944147205334 -7.6214611381184287 -1.0601376223520125 0.11824834535465743 -4.2084208887782593 -2.5425443305587008 2.5406424863958423 -2.3936746025527174 -0.91746930679890037 0.3604830958936312 -0.26732909026694024 -1.4470749808209971 -2.2948654003379616 1.12249611740596 -0.91970051229468897 1.1131717369801797 1.5083328703449672 -1.4853280825019963 3.6923666164798785 0.40222114709650403 -8.5315080980038989 5.1157895678883643 0.35361363393193512;1.3419051758724325 -0.91139393859829543 2.4078291107332244 0.85948199619330434 0.0073815253888410808 0.13113543032188871 2.358950302386392 1.4539555817218073 -2.1298962185357473 -0.78508918987402376 0.68467683526643164 1.2158947638117068 -0.73367504367683178 2.7597850071903252 2.8636121773477492 0.04016594872611863 -1.0568519830329994 1.5038467356208067 -3.7672854615599256 -3.2659282925434114 -3.0301706457562214 1.1963519046570235 3.3002444491094836 -1.0805680062376195 1.0948602980875508;7.9496036998604493 -12.922275484995309 -2.6983209991895016 -37.928994274913379 9.891630160937245 -3.2390527975335561 -7.4905111915243969 -4.4244647161922952 -6.8974009057521064 -0.22741483918657446 2.9168463271660952 6.3609479277783878 -1.2589145747472912 4.8039512437182275 14.563776586355154 2.3825662850214679 -4.4160152315302765 2.9038996706825357 -4.7304773264259339 -1.4975238068075103 8.1683657346614904 4.874486357624261 -5.8281120074501391 -13.100397221972715 0.48947802544150409;-17.833679832895307 4.7044699040525799 -2.7393078121078234 10.456791487895485 13.882134144586351 2.523694570902788 8.3457690639907423 10.268031544184881 -12.038865919027508 14.406655570851264 -14.166817293617152 -0.060625312895099079 0.78795627431603055 8.86695608160049 5.8507006197454325 1.6891742097834137 -0.92114992791151873 10.960306496395887 -20.742013410604635 -21.309256833744968 -11.677945017094656 18.196054623278691 -2.4569635079765533 15.375619087975963 -5.0606086041450666;-2.3483467032752237 -3.6337673570386224 0.49362635210234973 9.3979386195814509 0.16335294305454554 2.5485055043457825 0.92657149623427781 0.26077919417787748 0.065772623140112521 1.4817574943922167 1.0819862872190207 -0.44451790954474568 -0.56087933083395547 1.4358947136828939 0.88053341208482638 -0.6040809404155727 -0.21210438019788361 -1.406312267001288 -0.098646631336238605 -3.1524512679081074 0.84268315581236164 1.1597418716402152 7.7823508468430624 -3.6213607404515988 0.46355499304184761;-1.2305492233329507 -6.8124202445671385 -0.39308661737361694 -5.1805420982035821 8.9045567815579805 0.30503449908279917 -0.42051797963314846 -2.1185969348643017 0.53822896056030234 -1.5973918367217541 -0.21461926656658198 0.15069646264825756 -0.014764259985099172 0.4869705120828644 -1.7508130995032529 -0.20053067656108384 -0.6122594884575101 1.3963546731989021 -1.5106675233509566 -2.3024399730524223 -0.8411816130217985 0.21857099177951686 2.2072520623449723 1.505385705922696 0.070067356180959717;6.6703100808459022 2.6747091699078775 -3.5684849075123575 0.56151093340379454 4.2456630894699803 4.8078633181107833 -8.4590850909052104 5.7144253711463433 -4.9084556476287453 0.12258169659710003 4.4569767709123598 0.36426714361414941 5.2568658632045731 -4.2185297985667534 3.010962824543618 -9.5713253829840337 14.81838017239342 -5.9044457417300382 2.767002226114053 -3.4081118401318378 -7.6015999791051785 -2.0023197054602035 0.18173167620964056 -1.9108266132271654 -8.1475959837494205;0.86929444937986711 1.9467857678643321 -0.21767470703593406 0.15548004574538729 -4.1641519760591388 0.95161119334981659 -0.32324713298767005 -1.2861227889148845 -0.021241124474107354 3.6771277623051439 -0.67961660204391794 -1.6238166529875133 0.34091409087555813 0.35445371846309326 7.069107388089118 2.3981984557455029 0.077696650328836256 -2.9631448766690038 0.38660782021103995 7.1553800830516199 -0.73413295183790084 -0.27557303669371452 3.2538431871167042 2.9438954507183519 0.51594285141142127;-1.0356935461930401 -2.8137524663107523 -1.4364317878318686 5.7531074856241657 3.4429307106702471 -2.3218625549619754 -2.8017871662985505 1.6086906989568179 -1.9840007952655485 0.5219719076478837 4.4270942441311156 3.153441525482152 -0.22428630025343793 -0.91853840056416625 4.6838107025203062 0.39738090840219126 -0.053723321872831631 -0.089607273718578601 -2.7587811233638657 -2.2180619558750734 -5.1825385406213025 1.1639109859411065 5.6593372819678054 25.379860905144071 -1.1323582100416016;-1.6357061007674392 2.8163540595654566 0.61571631007383631 4.5851679873253248 -0.86440503901130872 0.095481347545264897 0.086244562663811961 0.37600753322525093 -0.2897018185576658 -1.1788030319185887 -0.23079114107011564 -0.84621850868148241 -0.054329255025733193 -0.047857336012165144 0.086853055728198056 -0.0082137988925982432 -0.21511130495282821 1.2200192579744009 -1.2387640221769196 -1.2751641779434861 -1.1533374673521175 -0.35211397761763508 -6.1063742024332299 2.6053727921197343 0.25230844693925075;-11.660235141352633 -1.3932569800558803 10.835972443851764 11.913888563691353 -5.7548218756133815 -14.491945158262842 1.8935762925609334 -0.24719474245863407 -6.5828912505311337 -0.42132787505265834 2.2231480296649413 7.2039678322899645 -2.9511136152254442 -5.0424153406871035 4.0042173219487696 -2.0885800937436261 -3.215965364303552 -3.3364049105061766 1.6097924444022493 -15.378920690952732 -4.1837416342373333 2.2762244680170269 33.549504406027552 -5.0444809290717867 1.1566434249773918;2.9476769182687685 -2.0674986875409784 0.54192022576464549 7.7208997107024917 -3.8548069761131312 -4.5411695039214974 0.61423135924642214 1.5788626835511121 0.85420776807421439 -0.0068472695462666522 0.10547664785551354 0.10097595342402153 -0.23153676310564267 -0.43306122142605313 -1.5628365813357281 0.42063662436236332 0.060954946733840498 -1.2491794842280886 -0.28438127564438931 2.4533525921063046 -2.0055065044134821 -0.81614717481725718 9.8779163812910777 4.3143535081327924 0.69679197204125554;0.10878470307475853 1.6065353997115939 -0.540719810827617 5.5412351408403824 -3.7039772980292467 -1.0210738977438749 0.46205983342545376 -3.794627727793217 2.0695266553785086 0.33328384881112155 0.43092647023321295 -0.59298746567013638 0.36560494491670859 -0.1350128442792603 -5.0495183672360771 -0.32567550897757364 0.056954488198938877 0.99172918736887317 -0.47055751570411097 -0.67772348898782031 -0.43576457805312052 0.41863800571391896 -6.5844849481173577 -1.2528039018034791 -0.13167679895313633;0.035608642075444029 -0.92189352561749316 -1.1781977820095075 5.4531338321997609 -1.7492742648107844 0.31183183619473787 -1.2823784711356341 -4.0364027058532042 1.9440414304497498 -3.0820941119363132 -2.3045747261286387 -2.3147825792477543 0.69422485045138138 -0.37132415263043161 -1.0536356412243246 0.61526883375266028 0.78299452185739271 -0.47176852470731689 -2.2588522811779583 1.9341571903127013 0.34202149627903083 -1.306225716818775 -3.8317092778365356 0.62309445811133457 -0.41396750554961231];

% Layer 3
b3 = 0.12723438321306654;
LW3_2 = [-2.4043557519179579 -0.079152756627465973 -0.12683128750143011 0.0075234742887803205 -0.0064296897429182145 -0.11419597422884217 0.26885696112441698 0.0035823347772993321 0.14899876569364101 -0.062375215493509571 -0.1658338181078414 0.0065014712769472282 -0.24945499004124258 -2.4969525316470982 -0.17803651912606513];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00492610837438424;
y1_step1.xoffset = 2075.6;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
