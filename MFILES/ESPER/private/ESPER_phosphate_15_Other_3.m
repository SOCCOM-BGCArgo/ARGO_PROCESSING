function [Y,Xf,Af] = ESPER_phosphate_15_Other_3(X,~,~)
%ESPER_PHOSPHATE_15_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 15-Feb-2021 18:30:31.
% 
% [Y] = ESPER_phosphate_15_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999984769129;-0.999998793562952;-77.961;0;29.715;-138.904784718693];
x1_step1.gain = [1.00003298043486;1.00000060321889;0.0138606862425759;0.000266418009857466;0.193068829037552;0.0042772329208737];
x1_step1.ymin = -1;

% Layer 1
b1 = [8.9079325005530396453;-1.6383668109729905282;-2.8966774822100100906;4.4806685150779275162;2.2069886562294502852;4.936204384623617436;-1.7635658980805177798;8.9999478990433647851;-0.30246419428912485472;-0.16793107041006247182;-13.630806517698708547;-0.39598703234269377882;2.6467128503654100413;-2.2796526493029984906;0.40832862474598941027;-0.98351399774479220106;2.9699269301261965737;2.9605360861442964193;-0.66913919739100569117;0.019277986259098978811;-12.825580881090964169;1.6381064469626362978;12.469562298699646163;-0.1174639223623401979;-0.37661453404823191926];
IW1_1 = [-4.3532467605947759992 1.2313380818031729458 5.0469101261544713211 0.26182884916297827216 4.277603302020501097 0.45245504516704426745;0.92068438824386911179 1.7537354969764153978 -4.1243331224214099251 0.38962662742912701486 9.7122457085066891125 0.0085077768031309279617;-0.50824958066301040294 0.051595661184940903865 -0.46060747790842820892 -1.6631811396782854029 0.63886951989179796563 -3.0570642610775387027;-0.71770663062992667847 -0.20300079774080495576 -2.1983966302115818259 2.0811029731633801099 1.4676374306272135239 1.3552453194084714827;-0.28334832466458892419 0.039556251135357024806 4.1926388375059460145 -0.16752695912626933139 4.5813781159738375948 -1.1513958175284255692;0.058719248860699568837 -0.030464644111773516583 -1.3864901427616660445 4.6021665204859321108 1.014148115373478376 -1.3648303833602795088;0.34780013070169590872 -0.03503285677656300251 -3.1820189472322626401 0.13019210727211150136 -0.043317600451994106581 1.2060798109634724984;-1.5552842505118660288 -0.16667538486699345901 -6.5913159240809147121 8.843280952857188737 -5.1561209951033184495 1.7654554276855070061;0.52545852713108831544 0.28148183042231744722 0.81757230183712503724 0.18564496326199708687 -0.91460226823342727354 0.22060224347196674688;-0.65448193777151841832 -0.63968530109575638676 -1.6471269335653349053 0.051826599651131489976 -4.3728697026421112781 0.23130806769788872512;-0.86303833791670325759 -0.55258585804664439589 6.6865302799912331722 -16.677612349432369143 5.0454026000849951927 -0.53682582858456184827;0.11940330311451455292 0.065367214512084159672 1.3762147163592319821 0.11217441209888828757 -0.038545258220979324026 0.81574637947039274621;-0.4537091992886740921 -0.36134389963515578525 -1.8127101634854929646 -0.061005260288324515694 1.009609871016666105 1.8373292925684678867;-0.78866644915836703333 -0.1526215589557113339 0.2377231749156989149 -1.5188628308707592396 3.6480773437261388992 -1.1047505710210947516;-1.7515085446104901035 -2.3248171453235575434 1.4824226313799133692 0.36727320303554017444 -3.0224470419331868065 2.428229961875175924;0.10180042817281206857 -0.1986138598604791361 -0.92958369768487947304 -0.031084966492012908179 -5.6481911019631318993 0.098143985456099078202;0.70807830593447607104 -0.11369874716241068491 1.2722268725387211319 1.5126124839281009926 -0.86666343774364462682 2.7505120146384860469;2.1015844235500478199 -3.688604340898619327 -2.434806285329818909 0.96388490952075811524 4.7970496781938747333 -0.11731457881070879445;-0.25884736377713801758 -0.2909087035950734812 0.17822718838717435674 -0.18096933933959641339 2.2195122112298824035 -0.77872857054566546608;0.34108449888440611764 0.49540691999436214932 1.3591892230617808046 0.020085323704359440977 1.3009646127358371892 -0.12076694049979992684;0.19759029955282908508 -0.63073265202514372518 3.9714947842286130175 -14.234569285332909772 -8.0146091028373263043 -0.69111650215711517564;0.21067411966826746217 0.40814112999330226517 0.081943689709761471929 -0.49363736398297286545 1.0745496774674467844 0.64252075100996852708;2.5858220912808094205 3.44372029551350467 -2.5170732508437043684 6.5447637170743870882 0.087659734061198091304 2.3830618799287419662;0.47308432525874527519 -0.077909762504758284241 2.6049000259494388132 0.079187189983158684514 -0.15144818532509707332 0.38574778779686280661;-0.048234950755717202753 0.032422399946833782569 0.78872666287735637702 0.0633141069474435908 0.358219511095326959 0.86118226430845712382];

% Layer 2
b2 = [3.6151836741171980982;-4.2843271039890078455;-4.5270486971161831846;-0.12802365012687441648;1.1640947893864272977;9.3118543363145569458;12.674067066220262134;-8.269890195473717398;-8.1694338727010329393;0.037286552134615409682;2.9002617740148251002;17.791051004439367489;31.402308176308483922;-8.0409951330185300833;28.055344687711826879];
LW2_1 = [0.31479577314874646055 -0.10426855349954278207 -1.8824589797166417782 2.8489523267893051006 1.8281499879552103316 0.35184048965956143951 1.7236763517314284133 -0.45317322208585930632 2.2763945069892015383 -0.28426176168370365094 0.089527820600146787444 -4.536254378920512309 -3.2548646623975501235 0.46943571104443593267 0.35585666102670154842 -0.07210534800774631714 -3.5192048834475859742 -0.27899183566151158908 0.29164118079807643813 -1.9556765092987440369 -0.28758739082792561526 1.5691374750022903939 -0.57104509603459907563 0.48953128839363196922 4.3055781356225519829;0.47641471464102663758 0.16891830020870998719 -0.20162725069664907962 3.6635534516569947527 0.9894573467598739569 0.083382160790948470219 1.1217370745598844728 -0.21858912757697138152 0.20860813378472761737 -0.07792871906746484667 0.14198171334538786659 2.7357795122860495418 -2.7895349131626421268 0.041040461374743278378 0.10976628811780018979 0.59794307789697564992 0.5450468263963901272 -0.030969626566989580385 -0.30760045014917025696 -0.46835316921264980028 0.17507650951535050354 2.4034416229716932811 0.18787380331190836613 -0.89318743328232552692 -1.0325732089544983339;-0.10857490035824939045 0.093497409587199598047 1.896043355802941921 -2.6690181388330045387 -1.3967258614391320215 -0.50432312718218619274 -1.7638465931568063638 0.43698896739898179797 -2.6591016006461791754 -0.48017266942360264936 -0.052144777127216886126 2.0779051867266464804 3.2735206015359730181 -0.27118849126042443576 -1.0869157459362008833 0.71191871939024353733 3.737381820920036013 0.30247704384539653155 -0.7693896327608290564 1.441312367139458317 0.15349314781033565613 -1.6776668629501700902 -0.17528154278482893647 0.38158608193728887903 -3.2915734897700423822;-0.21030668367685986797 -0.757631645821139732 -0.68706593708318353109 -7.4954749256609289887 0.56207394262965582055 -0.96731926754187491646 -0.53496278833474686376 0.36764060762253253367 -1.8839504342900001976 -0.61986494642992939763 -0.91303603502177665963 -14.937972473007727459 7.5621884497405540415 0.30844970540502336664 -0.67511899107125705743 0.18359972637790575312 -1.1162515573608036146 0.75014976319603532406 -3.1185104378686818727 3.3655514990622781291 -0.61251978522298633489 -3.4284214777678578834 0.35371216288543644302 3.5915094173157062762 9.9819535508647678768;-0.16414636302399177037 -0.54535750897489865263 -3.6516990258265016323 -3.6107195765274031629 -3.3983955055442178761 0.62505444645199170761 -4.6121303124633437065 -0.16711770229992958803 -1.2145236929041680618 -2.2262236711646674614 -0.0090449718362036763547 11.926921708546286638 -0.38469213103481392224 -0.12964523699786800748 -0.61817247845732159472 -1.4035544553688981129 -2.4699629419126449825 0.23356482546036427816 -2.0665946404234656342 -4.5514193574922821028 -0.79082760317650868664 2.1256872324569240362 -4.0919243779803196048 -3.5944483099418964578 -8.3757949428521314417;0.88815943011912534821 0.32334285002885415627 -3.7599415053542437626 -11.055808213733937961 0.039980304328157981186 -0.017348350906671507199 0.91911304133142301964 0.0034066916823777349324 0.94277039212572755211 2.1159555756882708621 0.19813399630578679145 -5.7505253422760471693 8.4616208044473300021 -2.8687115406346479496 0.013509331318108285663 0.55540820109914734726 -4.7972408614899757495 -0.012505981757133242602 3.6315282087286453461 3.812782991626874729 -0.45108954388567129579 -5.3813125606628471331 -1.2974776267012952946 -0.21294854120523182273 5.6953923815075278014;0.71538346042407963132 0.39664191252509495289 0.3850757997320973236 11.980156348725744309 -0.068090760441161232719 -0.031045768254962226307 0.12279153517570234877 0.042630257898037551834 0.10908354643640964798 1.6006995571513606968 0.045210820901361969959 4.3397474266767739337 -24.795704785791574665 0.52148977553319098011 0.086582821069381962764 0.95473481352796663035 1.0438295004367379448 0.02726945887355444742 0.86266574425904984924 2.6009852541481635058 0.52061396699740636329 -0.22994111742984824076 0.44966504174272919903 -0.52497517516928238202 -4.1090959882939825931;0.32682600843602815921 0.034309272213548118458 0.90953017318664863833 1.0862997791025443828 -3.2982846457731280765 -1.5758819449390522038 -1.5948846421750682012 -0.11981503472257400145 -0.92942209547359955213 0.6910533404654176648 1.3874254563585926014 6.8328984797693070874 -1.3256532292699960696 -0.58229428906979574521 -0.0076408735824690723892 -0.62816982670505183695 1.3100660223703466389 0.10982637600307756931 0.82790816255360122344 0.54323926013871703944 0.12653544617250817028 6.0529444431560035511 0.25034621671752826932 -2.0350953567905492037 -7.4681614278857457734;2.1490368893198343869 -0.058472286039152700232 0.89239651965451149973 14.613440651327564979 0.91821866791355732929 -2.219939285461513645 0.082218236950907255811 -0.3638707411632676747 -0.096267023537109350229 -2.6072027293779491686 -0.24845149047537587461 8.9917820573347686519 -14.631870082524709886 -0.85994774711077537344 -0.26547511264131928854 -0.28822091064061494681 1.6030002339605629036 -0.21441557555890713993 3.6093024971082958707 -4.9409502140932550773 0.083854840588970677717 10.397925035668556859 -2.8161135061367414956 -2.8959961092240154024 -9.0111736302188294445;0.20298843039777719754 0.75784971204823292634 0.71562951177490130572 7.1189985957739327915 -0.58903441433016634488 0.96808810262074473929 0.50029667208768902054 -0.36606939741651767228 1.9009585202796015491 0.63072611143143031409 0.9116725107754708457 14.914002505472108595 -7.1992605072574500369 -0.29443477898205494547 0.67585469042641421744 -0.18995706512514373698 1.1439426703033663824 -0.74396272843370603312 3.0980074062680929003 -3.3594751866348637748 0.61636511399060311955 3.5276978345795866332 -0.34363543251048794813 -3.5885948134063454518 -9.9630489565344486635;11.432042530515888146 0.73836025834160956549 5.4633904070904479866 -10.88014444971302197 -19.892421442940410259 -0.99320088227865099828 -1.5295666373430871765 -0.2900266211484126555 5.1651693848625850336 1.3991109160711225901 -0.2206892005563990955 -18.092006701162731019 17.468356028808024405 -3.5964367156170884421 0.13265605532508889519 -1.5526172125631452214 4.2049857757786064383 -0.26770636261941699319 4.3895187384037921419 -0.83756587402499049766 -0.90059999160727932654 0.052645303586338967894 1.3079311152537593799 4.1434004665496990683 13.280272433241087526;-0.75128493696010545388 -0.020808797120566161626 1.2407612151671212342 6.0539618310905654042 -0.2922436215655261349 -0.29211888154148368812 -0.81588026290121773432 0.32862792131631735071 0.20769381994877042508 0.11175983294158442494 -0.33820902535722907611 -6.2494614643300261392 -22.49691637539223521 1.1340819962430015444 0.011395038254267589317 0.87708055070295543043 1.9026185439593201743 0.01907679552509568624 -0.73443211507119843251 0.3874484699424894929 0.29604692248164177215 1.0474979262717398765 -1.5329323390000977323 2.220216633605843537 4.632520599508746173;0.033396474835550596372 -0.88631709586196905093 -0.15447251950228452211 -8.4662166303758716879 2.3173471495616122517 -0.97320365909502293267 0.17366603726330964719 -2.7509433743268303374 -2.2152196325415922651 -0.013254011279697955339 -1.2966397529571493941 -6.2771427646169559722 7.0833283740527024364 3.0349814336259068881 -1.698443413408860847 0.051107942190560584628 -0.44080883528786729553 -1.1216226068271359928 -5.2754213851899747212 -3.1074465312544856666 -0.65740755509787995869 -0.03664226213770858942 -26.853248575685324084 0.25826272038550124321 9.1382326004938132513;0.26666080071355963144 0.038362312310470825238 1.0666667848204354208 0.75961962041880937146 -3.0266034822234804125 -1.4911003673212626097 -1.5084333357523336261 -0.087292625846646404453 -1.0748275096121340244 0.5584656657930189283 1.275778110217862249 6.982314016044388616 -0.74368500421834626835 -0.53075752238175788467 -0.010398177600247407101 -0.54240779354172774518 1.4567026899199810863 0.10009440427655065531 0.49404434818774306537 0.41707042165042823578 0.12222427256477860769 5.2704562660512932482 0.31802072771595063516 -1.9690744807550391027 -7.5035613818017363741;-23.71592884640077159 1.5769097680040784493 -1.0032965862599296791 -2.4352408376737875173 8.9220054077907935408 2.3384612085457332498 3.72942271538069825 2.3363377432929572919 -8.9808217027374670494 -6.3601225306299555839 -2.580428633798296012 -1.4376378591394562978 3.7742573702629487187 2.1246643718707960424 -0.66712586010747942922 0.23423691376932195829 -2.1371906087592553725 -0.016381579369386875533 -12.630257684075505864 -4.7107499364151967924 -0.099917631553453192805 -10.484537495328206447 0.35201379999874510274 7.7702211802953815578 -1.4143877464437843994];

% Layer 3
b3 = -1.1585278878041469497;
LW3_2 = [-1.8699088821197871191 0.95282217615035091907 -1.4445980557361595142 -10.588022782314633119 0.1546708768563285763 0.20511017788566360265 -0.39313748417597044194 8.8968207019294407445 -0.15935828682228836417 -10.601552048938112094 0.29425692526108121472 0.49011955618841551718 -0.26387748757684253986 -10.351548564702673261 0.40035937785303399306];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.568038194888224;
y1_step1.xoffset = -0.04979;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
